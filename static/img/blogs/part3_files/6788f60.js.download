(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1573:function(t,e,n){t.exports={}},1664:function(t,e,n){t.exports={}},1670:function(t,e,n){t.exports={}},1671:function(t,e,n){t.exports={}},1672:function(t,e,n){t.exports={}},1675:function(t,e,n){t.exports={}},1681:function(t,e,n){t.exports={}},1694:function(t,e,n){t.exports={}},1700:function(t,e,n){t.exports={}},1701:function(t,e,n){t.exports={}},171:function(t,e,n){"use strict";n(19),n(11),n(12),n(13),n(8);var o=n(14),r=n(2),c=(n(6),n(16),n(31),n(49),n(24),n(4),n(43),n(21),n(77),n(7),n(26),n(1)),l=n(98),d=n(58),h=n(35),v=n.n(h),f=n(45),m=n(145),_=n(10),y=n(927),w=n(928),C=n(929),k=n(930),O=n(931),x=n(932),I=(n(18),n(50),n(22),n(39)),S=n(111),D=n(27),L=n(207),P=n(112),j=n(53);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={mixins:[f.a],components:{AdminTag:S.default,listCheckbox:L.default,ImgWaterFall:P.default,BaseAvatar:j.default},props:{item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},review:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},sysTag:{type:Object,default:function(){}}},data:function(){return{formatNumberForeign:_.p,timeFormat:_.U,collectDotReportInfo:{},deleteLoad:!1,cntShow:!0,itemShow:!1}},computed:T(T(T({},Object(c.c)("user",["isLoggedIn","accountSettingsData"])),Object(c.e)("user",["userInfo","adminOff"])),{},{setNsfwPlus:function(){return function(t){return!1}},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},showGreenCover:function(){return[2,"2"].includes(this.item.green)&&!["/personal"].includes(this.$route.path)&&this.greenMode}}),activated:function(){var video=this.$refs.mainVideo;video&&video.play&&video.play()},methods:{isVideoLink:_.G,handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=T(T({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:1})},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},onDelete:function(t){var e=this;this.$confirm(this.$t("postDeleteTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){e.deleteLoad||(e.deleteLoad=!0,Object(D.sb)({obj_id:t.id,obj_type:t.obj_type}).then((function(n){e.setWaterFallDeleteLits(t.id),e.$emit("resizeListener"),e.$message({type:"success",message:e.$t("deleteSuccess")})})).finally((function(){e.deleteLoad=!1})))})).catch((function(){}))},handleDetail:function(t,e){this.$logEvent("log_actions",{operation:"click_ai_vedio",behavior_info:"on_homepage_ai_vedio_tab",behavior_info_sub:e}),("IMG"===t.target.tagName||"VIDEO"===t.target.tagName||"cltpop"===t.target.className||t.target.className.includes("imgBox")||"ImgWaterFall"===t.target.className||"green-mode-div"===t.target.className)&&(this.showGreenCover&&!this.isLoggedIn?this.$EventBus.$emit("openLoginDialog"):this.$router.push(this.localePath("/ai-video/detail/"+e.id)))},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},tagChange:function(t){if("REVIEW"===t){var e=this.$route.params;return localStorage.setItem("reviewList",JSON.stringify(this.list)),void this.$router.push(this.localePath("/ai-video/detail/"+this.item.id+"?review=1&tag="+(null==e?void 0:e.tag)))}this.$emit("change")}}},R=(n(4689),n(0)),component=Object(R.a)(M,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_=this,y=_._self._c;return y("a",{attrs:{href:_.localePath("/ai-video/detail/"+_.item.id),target:"_blank"},on:{click:function(t){t.preventDefault(),!_.isCheck&&_.handleDetail(t,_.item)},mouseover:function(t){_.cntShow=!0}}},[y("div",{staticClass:"defBox marking-item",class:{"bg-nsfw":1===_.item.nsfw,boxItem:!_.setNsfwPlus(_.item)},style:{width:_.item.waterWidth+"px",height:_.item.waterHeight+"px"}},[_.isCheck&&_.item?y("listCheckbox",{on:{change:function(t){return _.$emit("checkChange")}},model:{value:_.item.isCheck,callback:function(t){_.$set(_.item,"isCheck",t)},expression:"item.isCheck"}}):_._e(),_._v(" "),_.item.sys_tag?y("div",{staticClass:"SysTag",style:{color:_.sysTag[_.item.sys_tag[0]].color,backgroundColor:_.sysTag[_.item.sys_tag[0]].bg}},[_._v("\n      "+_._s(_.$t(_.sysTag[_.item.sys_tag[0]].txt))+"\n    ")]):_._e(),_._v(" "),y("div",{directives:[{name:"show",rawName:"v-show",value:_.item.NSFWSHOW&&[2,"2"].includes(null===(t=_.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{opacity:null!==(e=_.item)&&void 0!==e&&e.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),_.item.nsfw_plus=!(null!==(e=_.item)&&void 0!==e&&e.nsfw_plus)}}},[y("i",{staticClass:"iconfont",class:null!==(n=_.item)&&void 0!==n&&n.nsfw_plus?"icon-work-show":"icon-work-hide"})]),_._v(" "),1===_.item.nsfw||_.isVideoLink(_.item.cover)?1!=_.item.nsfw?y("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:_.setNsfwPlus(_.item)?"blur(19px) saturate(160%)":""},attrs:{src:_.item.cover,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):_._e():y("ImgWaterFall",{class:_.isCheck?"":"cntImg",style:{transform:_.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:_.setNsfwPlus(_.item)?"blur(19px) saturate(160%)":""},attrs:{item:_.item}}),_._v(" "),y("div",{directives:[{name:"show",rawName:"v-show",value:_.greenMode,expression:"greenMode"}]},[y("div",{directives:[{name:"show",rawName:"v-show",value:_.showGreenCover,expression:"showGreenCover"}],staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:_.item.waterWidth+"px",height:_.item.waterHeight+"px"}})]),_._v(" "),y("div",{staticClass:"imgNum"},[y("span",[_._v(_._s(_.$t("episodeNum",{num:(null===(o=_.item.ai_video)||void 0===o?void 0:o.max_episode)||0})))])]),_._v(" "),3==_.item.status||4==_.item.status||2==_.item.status?y("div",{staticClass:"statusCnt"},[y("div",{staticClass:"statusZg"}),_._v(" "),y("div",{staticClass:"statusBox",style:{color:4==_.item.status||2==_.item.status?"#EF3B3B":"#ffffff"}},[y("i",{staticClass:"iconfont icon-statusBox"}),_._v(" "),y("div",[_._v("\n          "+_._s(4==_.item.status?_.$t("notApproved"):2==_.item.status?_.$t("Ban"):_.$t("underReview"))+"\n        ")])])]):_._e(),_._v(" "),y("div",{directives:[{name:"show",rawName:"v-show",value:3!=_.item.status&&_.$route.name.includes("Personal")&&_.userInfo.id==_.item.author.id,expression:"item.status != 3 && $route.name.includes('Personal') && userInfo.id == item.author.id"}],staticClass:"deleteBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.onDelete(_.item)}}},[y("i",{staticClass:"iconfont icon-postDelete"})]),_._v(" "),y("div",{staticClass:"foot-box"},[y("div",{staticClass:"num-video-look"},[y("i",{staticClass:"iconfont icon-icon_Views"}),_._v(" "),y("span",[_._v(_._s(_.formatNumberForeign(null===(r=_.item.stat)||void 0===r?void 0:r.num_of_view)))])]),_._v(" "),null!==(c=_.item.ai_video)&&void 0!==c&&c.duration?y("div",{staticClass:"times"},[_._v("\n        "+_._s(_.timeFormat(null===(l=_.item.ai_video)||void 0===l?void 0:l.duration))+"\n      ")]):_._e()])],1),_._v(" "),y("div",{staticClass:"objName",style:{width:_.item.waterWidth+"px"}},[_._v("\n    "+_._s(null===(d=_.item.ai_video)||void 0===d?void 0:d.title)+"\n  ")]),_._v(" "),y("div",{staticClass:"author",style:{width:_.item.waterWidth+"px"}},[y("div",{staticClass:"userBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.otherUser(_.item)}}},[y("BaseAvatar",{attrs:{userData:_.item.author,size:24}}),_._v(" "),y("div",{staticClass:"authorName"},[_._v(_._s(null===(h=_.item.author)||void 0===h?void 0:h.name))])],1),_._v(" "),_.cntShow?y("div",{staticClass:"numItem"},[y("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.setLike(_.item,"ai_video")}}},[y("i",{staticClass:"iconfont",class:_.setlikeData(_.item)}),_._v(" "),null!==(v=_.item.stat)&&void 0!==v&&v.num_of_like?y("span",[_._v(_._s(_.item.stat.num_of_like))]):_._e()])]):y("div",{staticClass:"numItem"},[y("div",{staticClass:"funItem"},[y("i",{staticClass:"iconfont",class:_.item.liked?"icon-like_selected":"icon-like"}),_._v(" "),null!==(f=_.item.stat)&&void 0!==f&&f.num_of_like?y("span",[_._v(_._s(_.item.stat.num_of_like))]):_._e()]),_._v(" "),y("div",{staticClass:"funItem"},[y("i",{staticClass:"iconfont",class:_.item.collect?"icon-collect_selected":"icon-collect-gpt"}),_._v(" "),null!==(m=_.item.stat)&&void 0!==m&&m.num_of_collection?y("span",[_._v(_._s(_.item.stat.num_of_collection))]):_._e()])])]),_._v(" "),y("admin-tag",{attrs:{id:_.item.id,item:_.item,type:"15",review:_.review},on:{change:_.tagChange}})],1)}),[],!1,null,"276dad00",null),A=component.exports;installComponents(component,{ImgWaterFall:n(112).default,BaseAvatar:n(53).default,AdminTag:n(111).default});var E=n(933),B=n(934),N=n(474),F=n(830),U=n(935),H=n(590),V=n(155),z={name:"NovelCard",mixins:[f.a],props:{item:{type:Object,default:function(){return{}}},logData:{type:Object,default:function(){return{}}},maxHomeData:{type:Object,default:function(){return{}}},renderList:{type:Array,default:function(){return[]}},imgW:{type:String,default:"340px"},imgH:{type:String,default:"130px"}},data:function(){return{formatNumberForeign:_.p}},computed:{isEmptyObj:function(){return 0===Object.keys(this.maxHomeData).length},cardLink:function(){var t=this.item.id;return this.localePath("/novel/detail/".concat(t))},getPosition:function(){if(this.isEmptyObj)return"";var t,e,n=this.maxHomeData.homeData,o=this.logData,r=null==this||null===(t=this.maxHomeData)||void 0===t||null===(t=t.homeConfigAllData)||void 0===t?void 0:t.items,c=Object(V.getMenuIndex)({list:r,id:n.id});return"home,".concat(n.id,",").concat(n.title,",").concat(c,",").concat(o.id,",").concat(o.title,",").concat(o.mIndex,",").concat(null!==(e=o.index)&&void 0!==e?e:"")},logExposureParams:function(){var t,e={type:this.item.obj_type,id:this.item.id,pt:this.item.pt||"",position:this.getPosition,index:null===(t=this.logData)||void 0===t?void 0:t.index};return JSON.stringify(e)}},methods:{goCardDetail:function(){var t=this.item.id,path=this.localePath("/novel/detail/".concat(t));this.$emit("onView",this.item),this.$router.push(path)},dotPushReport:function(){var t,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).action,n=this.item,o=n.obj_type,r=n.id,c=n.stat,l={items:[{action:e,batch_id:n.pt,category:"default",negative_ids:this.getNegativeIds(),obj_no:r,obj_type:o,view_domain:this.getViewDomain(),stat:c,vip:null==this||null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel}]};Object(I.i)(l)},getNegativeIds:function(){if(this.isEmptyObj)return[];var t=this.item.id,e=(null==this?void 0:this.renderList)||[],n=e.findIndex((function(e){return e.id===t}))||0;return e.filter((function(t,i){return i<n})).map((function(t){return t.id})).slice(0,10)},getViewDomain:function(){var t;if(this.isEmptyObj)return"";var e=(null===(t=this.maxHomeData)||void 0===t||null===(t=t.HyHomeFormsRef)||void 0===t?void 0:t.formData)||{};return"home_".concat(e.order_by)},goTagDetail:function(t){var e=t.id,path=this.localePath("/tagInfo/ai-novel/".concat(e));this.$router.push(path)},handleCancleCollect:function(){this.unFavorite(this.item,"ai_novel"),this.$emit("onCancleCollect",this.item)}}},W=z,G=(n(4696),Object(R.a)(W,(function(){var t,e,n,o,r,c,l,d=this,h=d._self._c;return h("div",{style:{width:d.imgW,height:d.imgH}},[h("a",{staticClass:"novel-card flex",attrs:{href:d.cardLink,target:"_blank"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),d.goCardDetail.apply(null,arguments)}}},[h("div",{staticClass:"left novel-coverbg",attrs:{"data-title":1===d.item.is_preset?null===(t=d.item)||void 0===t?void 0:t.title:""}},[h("img",{staticClass:"bg-image",attrs:{src:null===(e=d.item)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url,alt:(null===(n=d.item)||void 0===n?void 0:n.title)||"",loading:"lazy","log-exposure":d.logExposureParams}})]),d._v(" "),h("div",{staticClass:"right"},[h("div",{staticClass:"title line-one"},[d._v(d._s(null===(o=d.item)||void 0===o?void 0:o.title))]),d._v(" "),h("div",{staticClass:"tag-list flex"},d._l(null===(r=d.item)||void 0===r?void 0:r.tags,(function(t,e){return h("a",{key:t.id+e,staticClass:"tag-item",attrs:{href:d.localePath("/tagInfo/ai-novel/"+t.id)},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),d.goTagDetail(t)}}},[d._v("\n          "+d._s(t.name)+"\n        ")])})),0),d._v(" "),h("div",{staticClass:"desc line-two"},[d._v(d._s(d.item.sub_title))]),d._v(" "),h("div",{staticClass:"count-num-box flex_m"},[h("div",{staticClass:"item flex_m"},[h("span",{staticClass:"num"},[d._v(d._s(d.formatNumberForeign((null===(c=d.item)||void 0===c?void 0:c.count)||0)))]),d._v(" "),h("span",{staticClass:"num"},[d._v(d._s(d.$t("word")))])]),d._v(" "),h("div",{staticClass:"item flex_m"},[h("span",{staticClass:"iconfont icon-browse"}),d._v(" "),h("span",{staticClass:"num"},[d._v(d._s(d.formatNumberForeign(null===(l=d.item)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_view)))])]),d._v(" "),h("div",{staticClass:"collect-box"},[h("i",{staticClass:"iconfont icon-collect_selected",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),d.handleCancleCollect.apply(null,arguments)}}})])])])])])}),[],!1,null,"6d02fa42",null)),Y=G.exports,K=n(104);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Q=null,Z={inject:["app"],mixins:[f.a,m.a],components:{workItem:y.a,modelItem:w.a,bannerItem:C.a,toolItem:k.a,articleItem:O.a,portfolioItem:x.a,aiVideoItem:A,videoItem:E.a,paletteItem:B.a,comfyItem:N.a,cyberBarItem:F.a,aiAudioItem:U.a,NovelCard:H.default,novelItem:Y},props:{isOpen:{type:Boolean,default:!0},isOpenNewTab:{type:Boolean,default:!1},fromPage:{type:String,default:""},list:{type:Array,default:function(){return[]}},container:{type:String,require:!0},activateTab:{type:String,default:""},needHorizontal:{type:Boolean,default:!1},gap:{type:Number,default:16},cols:{type:Number,default:7},colAdd:{type:Number,default:0},review:{type:Boolean,default:!1},isTiemRow:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},checkMax:{type:Number,default:-1},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},isTrainLora:{type:Boolean,default:!1},resetHeight:{type:Boolean,default:!0},isDynamicList:{type:Boolean,default:!0},isShowNullRelatedImg:{type:Boolean,default:!1},activeName:{type:String,default:""},defaultMB:{type:Number,default:80},workAppParam:{type:Object,default:function(){return{isLogin:!0,height:912}}},row:{type:Number,default:1},boxId:{type:String,default:"container"},closeVirtualList:{type:Boolean,default:!0},isReverseLoad:{type:Boolean,default:!1},type:{type:String,default:""}},data:function(){var t=this;return{isDelete:!1,dataList:this.list,width:0,scrollTop:0,selfCols:6,openWatch:!0,resizeListener:Object(l.a)((function(){return t.resize(t.dataList)}),500),lastTime:null,checkList:{ids:[],collectIds:[],folderNos:[],url:[]},isCheckAll:!1,sysTag:{latest:{color:"#ffffff",bg:"#0ABF94",txt:"New"},essence:{color:"#ffffff",bg:"rgb(241,49,78)",txt:"essence"},exclusive:{color:"#744100",bg:"#F4D292",txt:"exclusive"},first:{color:"#744100",bg:"#F4D292",txt:"debut"},recommended:{color:"#ffffff",bg:"#0ABF94",txt:"Recommend"}},startIndex:0,lastScrollTop:0,isServer:!0,openWaterFall:!1,isTest:!1,resizeObserver:null}},computed:X(X(X({},Object(c.c)("user",["isLoggedIn","accountSettingsData"])),Object(c.e)("user",["userInfo"])),{},{renderList:function(){var t=this.$parent.$refs[this.container];if(!t||!this.closeVirtualList)return this.dataList;var e=this.scrollTop-t.offsetTop,n=e-window.innerHeight,o=e+window.innerHeight+1e3;if(e>this.lastScrollTop)for(;this.startIndex<this.dataList.length&&(null===(r=this.dataList[this.startIndex])||void 0===r?void 0:r.top)<=n;){var r;this.startIndex++}else for(;this.startIndex>0&&(null===(c=this.dataList[this.startIndex])||void 0===c?void 0:c.top)>=n;){var c;this.startIndex--}for(var l=this.startIndex;l<this.dataList.length&&(null===(d=this.dataList[l])||void 0===d?void 0:d.top)<=o;){var d;l++}this.lastScrollTop=e;var h=this.isDynamicList?this.dataList.slice(this.startIndex,l):this.dataList;return h=h.filter((function(t,e){return t}))},dataInfo:function(){return function(t){var e={id:t.id,type:t.obj_type,pt:t.pt};return JSON.stringify(e)}}}),watch:{isOpen:function(t){this.resizeListener()},cols:{handler:function(t){var e=this;this.$nextTick((function(){e.width=e.getWidth()}))},immediate:!0},list:{handler:function(t){var e=this;this.$nextTick((function(){var n=e.openWatch;e.width;if(n){e.width||(e.width=e.getWidth());var r=v()(t);if(e.dataList.length<100)e.$nextTick((function(){e.updateDataList(r,!1)}));else if(r.length>e.dataList.length){var c=Object(o.a)(r.slice(e.dataList.length));e.updateDataList(c,!0)}else r.length<e.dataList.length&&(e.dataList=[],e.startIndex=0,e.updateDataList(r,!1))}}))},immediate:!0},isCheck:{handler:function(t){this.isCheckAll=!1,this.dataList.forEach((function(t){t.isCheck=!1})),this.checkList={ids:[],collectIds:[],folderNos:[],url:[]},this.$emit("getChecList",this.checkList)}},WaterFallDeleteLits:{handler:function(t){this.isDelete=!0}},"app.showMenu":function(t){this.resizeListener()},isLoggedIn:function(t){!t&&this.resizeListener()}},activated:function(){var t=this;this.openWatch=!0,this.isDelete&&(this.resizeListener(),this.isDelete=!1),this.resizeObserver=new ResizeObserver((function(){t.resizeListener()}));var e=document.querySelector("#container");e&&this.resizeObserver.observe(e),window.addEventListener("scroll",Object(K.throttle)(this.lazyLoad,200),{passive:!0}),this.$nextTick((function(){window.scrollTo(0,t.scrollTop)}))},deactivated:function(){var t=this;this.openWatch=!1,this.resizeObserver=new ResizeObserver((function(){t.resizeListener()}));var e=document.querySelector("#container");e&&this.resizeObserver.observe(e),window.removeEventListener("scroll",Object(K.throttle)(this.lazyLoad,200))},mounted:function(){var t=this;this.resizeObserver=new ResizeObserver((function(){t.resizeListener()}));var e=document.querySelector("#container");e&&this.resizeObserver.observe(e),window.addEventListener("scroll",Object(K.throttle)(this.lazyLoad,200),{passive:!0}),this.isServer=!1},beforeDestroy:function(){var t=document.querySelector("#content");t&&this.resizeObserver.unobserve(t)},methods:X(X({},Object(c.b)("user",["getAccountInfo"])),{},{handleBox:function(t){this.isCheck&&this.selectCheck(t);var e=t.id,n=t.obj_type,o=t.ai_video,r=t.pt;n=o?n+"_"+(null==o?void 0:o.video_type):n,this.$logEvent("log_actions",{operation:"click",obj_type:n,behavior_info:e,behavior_info_sub:r})},moreActions:function(t,e){var n=this,o=e.id,r=void 0===o?"":o,c=e.obj_type;switch(t){case"delete":this.$logEvent("log_actions",{operation:"click_delete",behavior_info:"on_personal_center",behavior_info_sub:c});this.$confirm(this.$t({2:"model_delete_tips",4:"post_delete_tips",5:"post_delete_tips",9:"character_delete_tips",11:"palette_delete_tips",13:"comfyui_delete_tips",16:"audioDeledQuery"}[c]||"canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(D.l)({ids:[r],category:2,obj_type:c}).then((function(t){var e;1e4==(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&(n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.deleteItem(r))}))})).catch((function(t){console.log("err",t)}));break;case"pinOrNot":this.$logEvent("log_actions",{operation:"click_top_to_overview",behavior_info:"on_personal_center",behavior_info_sub:c});var l={obj_id:r,obj_type:c};null!=e&&e.isTop&&(l.up_type="down"),Object(D.bb)(l).then((function(t){var o;1e4==(null==t||null===(o=t.status)||void 0===o?void 0:o.code)&&(n.$message({message:n.$t(null!=e&&e.isTop?"UnpinSuccess":"PinSuccess"),type:"success"}),n.$set(e,"isTop",!e.isTop))}))}},deleteItem:function(t){var e=this.dataList.filter((function(e){return e.id!==t}));this.resize(e)},handleRefresh:function(){},getItemTime:function(t){var e=new Date(t),n=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0");return"".concat(n,"-").concat(o)},processTimeGroups:function(t){for(var i=0;i<t.length;i++){var e,n,o,r,c=t[i];if(null!=c&&null!==(e=c.folder_no)&&void 0!==e&&e.collect_at)if(this.getItemTime(null==c||null===(n=c.folder_no)||void 0===n?void 0:n.collect_at)!==this.lastTime)t.splice(i,0,{timeItem:this.getItemTime(null==c||null===(o=c.folder_no)||void 0===o?void 0:o.collect_at)}),this.lastTime=this.getItemTime(null==c||null===(r=c.folder_no)||void 0===r?void 0:r.collect_at)}return t},updateDataList:function(t,e){var n=this,o=this.WaterFallDeleteLits,r=this.width,c=this.isCheckAll,l=this.checkList,h=this.isTiemRow;r||(this.width=this.getWidth());var v=t.filter((function(t){return!o.includes(t.id)}));h&&(e||(this.lastTime=null),this.processTimeGroups(v));for(var i=0;i<v.length;i++){var f=v[i];if(f.stat&&(this.$set(f.stat,"num_of_like",f.stat.num_of_like>0?Object(_.p)(f.stat.num_of_like):0),this.$set(f.stat,"num_of_collection",f.stat.num_of_collection>0?Object(_.p)(f.stat.num_of_collection):0)),1==f.obj_type&&this.$set(f,"propS",!1),f.timeItem)f.waterWidth=r,f.waterHeight=30;else{var m,y,w;if(this.$set(f,"NSFWSHOW",(null==f?void 0:f.nsfw_plus)&&(null===(m=this.userInfo)||void 0===m?void 0:m.enable_nsfw_plus)),!c&&l.ids.includes(f.id)?this.$set(f,"isCheck",l.ids.includes(f.id)):this.$set(f,"isCheck",!!c),c&&!l.ids.includes(f.id))l.ids.push(f.id),null!=f&&null!==(y=f.collect)&&void 0!==y&&y.id&&l.collectIds.push(f.collect.id),null!=f&&null!==(w=f.folder_no)&&void 0!==w&&w.id&&l.folderNos.push(f.folder_no.id),null!=f&&f.cover&&l.url.push(f.cover);if(f.timeDiff=Object(d.d)(f.created_at,Date.now(),this.$t),f.waterWidth=r,this.isTiemRow)f.waterHeight=r;else{var C,k=this.getDimensions(f),O=k.intWidth,x=k.inHeight;f.waterHeight=parseInt(x*r/O),"feature"===this.activateTab&&9===f.obj_type&&(f.waterHeight+=60),isNaN(f.waterHeight)&&(f.waterHeight=320),this.needHorizontal&&5==f.obj_type&&(f.needRotate=!0,this.$EventBus.$emit("resetMediaSize",{width:this.width,height:f.waterHeight,resize:!1})),16==f.obj_type&&(f.waterHeight=257),4==f.obj_type&&"article"==(null==f||null===(C=f.portfolio)||void 0===C?void 0:C.sub_channel)&&(f.waterHeight=334),21==f.obj_type&&(f.waterHeight=130)}f.cover&&!f.replaceUrl&&(f.replaceUrl=Object(_.K)(f.cover,13==f.obj_type?"high":"low"))}}e?v.forEach((function(t){n.dataList.push(t)})):this.dataList=v,this.waterfall()},getDimensions:function(t){var e,n=t.cover_width?t.cover_width:308,o=t.cover_height?t.cover_height:308,r=1===(null==t||null===(e=t.ai_video)||void 0===e?void 0:e.video_type);switch(t.obj_type){case 13:n=319,o=411;break;case 2:n=337,o=476;break;case 9:n="feature"===this.activateTab?240:337,o="feature"===this.activateTab?340:620;break;case 5:n=this.needHorizontal?337:n,o=this.needHorizontal?193:o;break;case 15:n=r?337:n,o=r?193:o;break;case 16:n=236,o=256}return n/o<.2&&(o=300),{intWidth:n,inHeight:o}},selectCheck:function(t){-1==this.checkMax||this.checkList.ids.length<this.checkMax||t.isCheck?(this.checkList.ids.length==this.dataList.length&&(this.isCheckAll=!0),t.isCheck&&(this.isCheckAll=!1),t.isCheck=!t.isCheck):this.$message({message:this.$t("已超过最大选择上限"),type:"warning"})},checkAll:function(){var t=this;if(this.isCheck){var e=this.dataList.filter((function(t){return!t.timeItem}));this.checkList.ids.length<e.length?(e.forEach((function(e){e.isCheck=!0,t.checkChange(e)})),this.isCheckAll=!0):(e.forEach((function(e){e.isCheck=!1,t.checkChange(e)})),this.isCheckAll=!1)}},clearCheck:function(t){var e=this;t.forEach((function(t){e.dataList.forEach((function(e){t==e.id&&(e.isCheck=!1)})),e.checkList.ids.forEach((function(n,o){t!==n&&t.id!==n||(e.checkList.ids.splice(o,1),e.checkList.collectIds.splice(o,1),e.checkList.folderNos.splice(o,1),e.checkList.url.splice(o,1))}))})),this.$emit("getChecList",this.checkList)},checkChange:function(t){if(t.isCheck){var e,n,o;if(!this.checkList.ids.includes(t.id))this.checkList.ids.push(t.id),null!=t&&null!==(e=t.collect)&&void 0!==e&&e.id&&this.checkList.collectIds.push(t.collect.id),null!=t&&null!==(n=t.folder_no)&&void 0!==n&&n.id&&this.checkList.folderNos.push(t.folder_no.id),null!=t&&null!==(o=t.banner)&&void 0!==o&&o.url&&this.checkList.url.push(t.banner.url)}else{var r,c,l;if(-1==this.checkList.ids.indexOf(t.id))return;this.checkList.ids.splice(this.checkList.ids.indexOf(t.id),1),null!=t&&null!==(r=t.collect)&&void 0!==r&&r.id&&this.checkList.collectIds.splice(this.checkList.collectIds.indexOf(t.collect.id),1),null!=t&&null!==(c=t.folder_no)&&void 0!==c&&c.id&&this.checkList.folderNos.splice(this.checkList.folderNos.indexOf(t.folder_no.id),1),null!=t&&null!==(l=t.banner)&&void 0!==l&&l.url&&this.checkList.url.splice(this.checkList.url.indexOf(t.banner.url),1)}this.$emit("getChecList",this.checkList)},resize:function(t){var e,n=this;document.querySelector(".el-dialog")||this.openWatch&&((null===(e=this.$parent)||void 0===e||null===(e=e.$refs)||void 0===e||null===(e=e[this.container])||void 0===e?void 0:e.offsetWidth)<600||(this.dataList=v()(t).filter((function(t){return!n.WaterFallDeleteLits.includes(t.id)})),this.width=this.getWidth(),this.dataList.forEach((function(t){if(t.timeItem)t.waterWidth=n.width,t.waterHeight=30;else{if(t.timeDiff=Object(d.d)(t.created_at,Date.now(),n.$t),t.waterWidth=n.width,n.isTiemRow)t.waterHeight=n.width;else{var e,o=n.getDimensions(t),r=o.intWidth,c=o.inHeight;t.waterHeight=parseInt(c*n.width/r),isNaN(t.waterHeight)&&(t.waterHeight=320),n.needHorizontal&&5==t.obj_type&&(t.needRotate=!0,n.$EventBus.$emit("resetMediaSize",{width:n.width,height:t.waterHeight,resize:!0})),16==t.obj_type&&(t.waterHeight=257),4==t.obj_type&&"article"==(null==t||null===(e=t.portfolio)||void 0===e?void 0:e.sub_channel)&&(t.waterHeight=334),21==t.obj_type&&(t.waterHeight=130)}t.cover&&!t.replaceUrl&&(t.replaceUrl=Object(_.K)(t.cover,13==t.obj_type?"high":"low"))}})),this.waterfall()))},waterfall:function(){var t=this;try{this.openWaterFall=!1,this.heights=[];for(var e=function(){var e,n=t.dataList[i],o=n.waterHeight,r=6==n.obj_type?0:1==n.obj_type||7==n.obj_type?40:70;if((13==n.obj_type||2==n.obj_type||9==n.obj_type||14==n.obj_type||16==n.obj_type||4==n.obj_type&&"article"==(null==n||null===(e=n.portfolio)||void 0===e?void 0:e.sub_channel))&&(r=0),21==n.obj_type&&(r=64),n.timeItem){n.left=0;var c=t.getMaxIndex(t.heights);n.top=c>-1?t.heights[c]+t.gap:0,t.heights.forEach((function(e,c){t.heights[c]=n.top+o+r}))}else if(t.heights.length<t.selfCols)if(t.dataList[i-1]&&t.dataList[i-1].timeItem)if(n.left=0,n.top=t.dataList[i-1].top+t.dataList[i-1].waterHeight+t.gap,t.heights[0]){var l=t.heights[0]+o+r;t.heights=[l+t.gap]}else t.heights.push(n.top+o+r);else n.top=t.dataList[i-1]?t.dataList[i-1].top:0,n.left=t.heights.length*(t.width+t.gap),t.heights.push(n.top+o+r);else{if(i>=t.selfCols*t.row&&"videoPageList"===t.fromPage)return 1;var d=t.getMinIndex(t.heights),h=t.heights[d]+t.gap;n.top=h,n.left=d*(t.width+t.gap),t.heights[d]=h+o+r}},i=0;i<this.dataList.length&&!e();i++);this.setWaterFallRect(),this.$nextTick((function(){t.openWaterFall=!0}))}catch(t){}},getMinIndex:function(t){var e=Math.min.apply(null,t);return t.indexOf(e)},getMaxIndex:function(t){var e=Math.max.apply(null,t);return t.indexOf(e)},getWidth:function(){var t;this.selfCols=this.cols,"userPage"==this.fromPage&&(this.selfCols=6);var e=null===(t=this.$parent.$refs[this.container])||void 0===t?void 0:t.offsetWidth;if(e||"videoPageList"!==this.fromPage||(e=document.body.clientWidth-154),e){e<1900&&(this.selfCols=6),e<1600&&(this.selfCols=5),e<1300&&(this.selfCols=5),e<1e3&&(this.selfCols=3),e<700&&(this.selfCols=2),e<220&&(this.selfCols=1);var n="cyber_bar"===this.activateTab||"cyberpub"===this.activeName;n&&(this.selfCols=5),n&&e>1600&&(this.selfCols=6),n&&e<1240&&(this.selfCols=4),this.needHorizontal&&(this.selfCols=e<1600?4+this.colAdd:e>1900?6+this.colAdd:5+this.colAdd,this.$emit("setCols",this.selfCols));var o="ai_audio"===this.activateTab;o&&e>1600&&(this.selfCols=7),o&&e>1240&&e<1600&&(this.selfCols=6),o&&e<1240&&(this.selfCols=4),"ai_novel"===this.type&&(e>1600&&(this.selfCols=5),e<=1600&&(this.selfCols=4),e<=1440&&(this.selfCols=3),e<=1e3&&(this.selfCols=2));var r=~~((e-(this.selfCols-1)*this.gap)/this.selfCols);return r>180?r:180}},setWaterFallRect:function(){var t=this.$parent.$refs[this.container],e=Math.max.apply(null,this.heights),n=this.workAppParam,o=n.isLogin,r=n.height;this.list.length||!this.resetHeight?(t.style.height=o?e+"px":r+"px",t.style.marginBottom=this.defaultMB+"px"):t.style.height=0},lazyLoad:function(){var t=this.workAppParam.isLogin;if(this.openWatch&&t){var e=document.documentElement.scrollHeight,n=window.innerHeight;this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset,e-this.scrollTop-n<1.5*n&&this.$emit("load"),this.isReverseLoad&&this.reverseLoadFn()}},reverseLoadFn:function(){var t=this.$parent.$refs[this.container].querySelectorAll(".box"),e=t[t.length-1],n=e&&e.getBoundingClientRect(),o=window.innerHeight;e&&n.top<o&&this.$emit("onReverseLoad")},adminHandle:function(t){this.setWaterFallDeleteLits(t),this.resizeListener()},onVideoPlay:function(t){var e=t.fun;clearTimeout(Q),Q=setTimeout((function(){e()}),1e3)},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}})},tt=(n(4697),Object(R.a)(Z,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"homeList",class:{"server-list":t.isServer},attrs:{id:t.boxId}},[t._l(t.renderList,(function(n,o){var r;return e("div",{directives:[{name:"show",rawName:"v-show",value:"videoPageList"!==t.fromPage||o<t.selfCols*t.row,expression:"fromPage === 'videoPageList' ? index < selfCols * row : true"},{name:"observe-visibility",rawName:"v-observe-visibility",value:t.handleVisibility,expression:"handleVisibility"}],key:((null==n?void 0:n.top)||(null==n?void 0:n.id))+","+((null==n?void 0:n.left)||"list"),staticClass:"box marking-item",class:[t.activateTab+"-box"],style:{transform:t.openWaterFall?"translateX(".concat(n.left,"px) translateY(").concat(n.top,"px)"):null,width:n.waterWidth+"px",height:n.waterHeight+"px"},attrs:{"data-info":t.dataInfo(n)},on:{click:function(e){return t.handleBox(n)}}},[n.timeItem?e("div",{staticClass:"timeRow",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[t._v("\n      "+t._s(n.timeItem)+"\n    ")]):t._e(),t._v(" "),1==n.obj_type?e("workItem",{attrs:{item:n,list:t.dataList,dotReportInfo:t.dotReportInfo,review:t.review,sysTag:t.sysTag,fromPage:t.fromPage},on:{resizeListener:t.resizeListener,change:function(e){return t.adminHandle(n.id)},moreActions:t.moreActions}}):t._e(),t._v(" "),2==n.obj_type?e("modelItem",{attrs:{item:n,list:t.dataList,dotReportInfo:t.dotReportInfo,sysTag:t.sysTag,isTrainLora:t.isTrainLora,fromPage:t.fromPage},on:{change:function(e){return t.adminHandle(n.id)},deleteItem:t.deleteItem,moreActions:t.moreActions,useJewelrySuccess:t.handleUseJewelrySuccess}}):t._e(),t._v(" "),4==n.obj_type?["article"==(null==n||null===(r=n.portfolio)||void 0===r?void 0:r.sub_channel)?e("articleItem",{attrs:{item:n,list:t.dataList,review:t.review,isCheck:t.isCheck,sysTag:t.sysTag,fromPage:t.fromPage},on:{change:function(e){return t.adminHandle(n.id)},resizeListener:t.resizeListener,checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions,useJewelrySuccess:t.handleUseJewelrySuccess}}):e("portfolioItem",{attrs:{item:n,list:t.dataList,review:t.review,isCheck:t.isCheck,sysTag:t.sysTag,fromPage:t.fromPage},on:{change:function(e){return t.adminHandle(n.id)},resizeListener:t.resizeListener,checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions,useJewelrySuccess:t.handleUseJewelrySuccess}})]:t._e(),t._v(" "),15==n.obj_type?e("aiVideoItem",{attrs:{item:n,list:t.dataList,review:t.review,isCheck:t.isCheck,sysTag:t.sysTag},on:{change:function(e){return t.adminHandle(n.id)},resizeListener:t.resizeListener,checkChange:function(e){return t.checkChange(n)}}}):t._e(),t._v(" "),5==n.obj_type?e("videoItem",{attrs:{item:n,review:t.review,list:t.dataList,isCheck:t.isCheck,sysTag:t.sysTag,fromPage:t.fromPage},on:{change:function(e){return t.adminHandle(n.id)},resizeListener:t.resizeListener,checkChange:function(e){return t.checkChange(n)},onPlay:t.onVideoPlay,moreActions:t.moreActions,useJewelrySuccess:t.handleUseJewelrySuccess}}):t._e(),t._v(" "),11==n.obj_type?e("paletteItem",{attrs:{item:n,list:t.dataList,isCheck:t.isCheck,dotReportInfo:t.dotReportInfo,fromPage:t.fromPage},on:{change:function(e){return t.adminHandle(n.id)},checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions}}):t._e(),t._v(" "),13==n.obj_type||14==n.obj_type?e("comfyItem",{attrs:{isOpenNewTab:t.isOpenNewTab,item:n,list:t.dataList,isCheck:t.isCheck,dotReportInfo:t.dotReportInfo,fromPage:t.fromPage,review:t.review},on:{resizeListener:t.resizeListener,checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions,change:function(e){return t.adminHandle(n.id)},useJewelrySuccess:t.handleUseJewelrySuccess}}):t._e(),t._v(" "),9==n.obj_type?e("cyberBarItem",{attrs:{item:n,isCheck:t.isCheck,fromPage:t.fromPage,dotReportInfo:t.dotReportInfo,activateTab:t.activateTab,review:t.review},on:{checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions,change:function(e){return t.adminHandle(n.id)}}}):t._e(),t._v(" "),16==n.obj_type?e("aiAudioItem",{attrs:{item:n,isCheck:t.isCheck,fromPage:t.fromPage},on:{checkChange:function(e){return t.checkChange(n)},moreActions:t.moreActions,useJewelrySuccess:t.handleUseJewelrySuccess}}):t._e(),t._v(" "),6==n.obj_type?e("bannerItem",{attrs:{item:n}}):t._e(),t._v(" "),7==n.obj_type?e("toolItem",{attrs:{item:n}}):t._e(),t._v(" "),21==n.obj_type?e("novelItem",t._g({attrs:{item:n}},t.$listeners)):t._e()],2)})),t._v(" "),t.isShowNullRelatedImg?e("div",{staticClass:"null-data-container"},[e("img",{staticClass:"null-image",attrs:{src:n(500),alt:"null_related_image"},on:{load:function(e){return t.$emit("solveScrollbarStyle")}}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("NoRelatedWorks")))])]):t._e(),t._v(" "),e("div",{attrs:{id:"wraperBoxId"}})],2)}),[],!1,null,"431c7b9a",null));e.a=tt.exports},1780:function(t,e,n){t.exports={}},1837:function(t,e,n){t.exports={}},210:function(t,e,n){"use strict";var o={name:"auditConfirmDialog",props:{},computed:{},data:function(){return{dialogVisible:!1,isAgree:!1,confirmCallback:null}},mounted:function(){},methods:{showDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.dialogVisible=!0,this.isAgree=!1,this.confirmCallback=t},close:function(){this.dialogVisible=!1},handleConfirm:function(){this.isAgree&&(this.confirmCallback&&"function"==typeof this.confirmCallback&&this.confirmCallback(!1),this.$emit("confirm")),this.close()}}},r=o,c=(n(4059),n(4060),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"audit-dialog custom-dialog-canvas",attrs:{title:t.$t("Tip"),visible:t.dialogVisible,"modal-append-to-body":!0,"append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[e("div",{staticClass:"audit-content flex"},[e("div",{staticClass:"audit-icon flex-center"},[e("i",{staticClass:"iconfont icon-a-icon-PrivacyPolicy"})]),t._v(" "),e("div",{staticClass:"audit-words"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("agreement")))]),t._v(" "),e("div",{staticClass:"tip"},[t._v(t._s(t.$t("AuditDialogTip")))]),t._v(" "),e("div",{staticClass:"switch"},[e("span",[t._v(t._s(t.$t("Over18AndAgreeTerm")))]),t._v(" "),e("el-switch",{model:{value:t.isAgree,callback:function(e){t.isAgree=e},expression:"isAgree"}})],1)])]),t._v(" "),e("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.close}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{disabled:!t.isAgree},on:{click:function(e){return t.handleConfirm()}}},[t._v(t._s(t.$t("Save"))+" ")])],1)])}),[],!1,null,"c251b88c",null);e.a=component.exports},2118:function(t,e,n){t.exports={}},2119:function(t,e,n){t.exports={}},2120:function(t,e,n){t.exports={}},2121:function(t,e,n){t.exports={}},2122:function(t,e,n){t.exports={}},2123:function(t,e,n){t.exports={}},2124:function(t,e,n){t.exports={}},2125:function(t,e,n){t.exports={}},2126:function(t,e,n){t.exports={}},2127:function(t,e,n){t.exports={}},2128:function(t,e,n){t.exports={}},2129:function(t,e,n){t.exports={}},2130:function(t,e,n){t.exports={}},2131:function(t,e,n){t.exports={}},2132:function(t,e,n){t.exports={}},2133:function(t,e,n){t.exports={}},2134:function(t,e,n){t.exports={}},2135:function(t,e,n){t.exports={}},2194:function(t,e,n){t.exports={}},2195:function(t,e,n){t.exports={}},2196:function(t,e,n){t.exports={}},2197:function(t,e,n){t.exports={}},2198:function(t,e,n){t.exports={}},2199:function(t,e,n){t.exports={}},2200:function(t,e,n){t.exports={}},2201:function(t,e,n){t.exports={}},2202:function(t,e,n){t.exports={}},2203:function(t,e,n){t.exports={}},2204:function(t,e,n){t.exports={}},2205:function(t,e,n){t.exports={}},2206:function(t,e,n){t.exports={}},2207:function(t,e,n){t.exports={}},2208:function(t,e,n){t.exports={}},2209:function(t,e,n){t.exports={}},2213:function(t,e,n){t.exports={}},2214:function(t,e,n){t.exports={}},2215:function(t,e,n){t.exports={}},2216:function(t,e,n){t.exports={}},2217:function(t,e,n){t.exports={}},2218:function(t,e,n){t.exports={}},2219:function(t,e,n){t.exports={}},2221:function(t,e,n){t.exports={}},2222:function(t,e,n){t.exports={}},2223:function(t,e,n){t.exports={}},2224:function(t,e,n){t.exports={}},2227:function(t,e,n){t.exports={}},2228:function(t,e,n){t.exports={}},2229:function(t,e,n){t.exports={}},2232:function(t,e,n){t.exports={}},2233:function(t,e,n){t.exports={}},2236:function(t,e,n){t.exports={}},2237:function(t,e,n){t.exports={}},2238:function(t,e,n){t.exports={}},2239:function(t,e,n){t.exports={}},2240:function(t,e,n){t.exports={}},2241:function(t,e,n){t.exports={}},2258:function(t,e,n){t.exports={}},2259:function(t,e,n){t.exports={}},2260:function(t,e,n){t.exports={}},2262:function(t,e,n){t.exports={}},2263:function(t,e,n){t.exports={}},2264:function(t,e,n){t.exports={}},2265:function(t,e,n){t.exports={}},2266:function(t,e,n){t.exports={}},2267:function(t,e,n){t.exports={}},2268:function(t,e,n){t.exports={}},2269:function(t,e,n){t.exports={}},2270:function(t,e,n){t.exports={}},2271:function(t,e,n){t.exports={}},2272:function(t,e,n){t.exports={}},235:function(t,e,n){"use strict";var o={name:"SubFooter",props:{confirmDisabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{hasTwoBtns:function(){return this.$slots.cancel&&this.$slots.confirm}}},r=(n(5018),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"sub-footer btns-container flex justify-center items-center",class:{"more-padding":t.hasTwoBtns}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.$slots.cancel,expression:"$slots.cancel"}],staticClass:"close-btn btn flex justify-center items-center",on:{click:function(e){return t.$emit("handleCancel")}}},[t._t("cancel")],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.$slots.confirm,expression:"$slots.confirm"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"confirm-btn btn flex justify-center items-center",class:{disabled:t.confirmDisabled||t.loading},on:{click:function(e){return t.$emit("confirm")}}},[t._t("confirm")],2)])}),[],!1,null,"348a1694",null);e.a=component.exports},2374:function(t,e,n){t.exports={}},2422:function(t,e,n){t.exports={}},2423:function(t,e,n){t.exports={}},2424:function(t,e,n){t.exports={}},2426:function(t,e,n){t.exports={}},2427:function(t,e,n){t.exports={}},2428:function(t,e,n){t.exports={}},2429:function(t,e,n){t.exports={}},2430:function(t,e,n){t.exports={}},2431:function(t,e,n){t.exports={}},2432:function(t,e,n){t.exports={}},2435:function(t,e,n){t.exports={}},2436:function(t,e,n){t.exports={}},2437:function(t,e,n){t.exports={}},2440:function(t,e,n){t.exports={}},2441:function(t,e,n){t.exports={}},2442:function(t,e,n){t.exports={}},2444:function(t,e,n){t.exports={}},2445:function(t,e,n){t.exports={}},2446:function(t,e,n){t.exports={}},2447:function(t,e,n){t.exports={}},2448:function(t,e,n){t.exports={}},2449:function(t,e,n){t.exports={}},2450:function(t,e,n){t.exports={}},2451:function(t,e,n){t.exports={}},2452:function(t,e,n){t.exports={}},2453:function(t,e,n){t.exports={}},2454:function(t,e,n){t.exports={}},2455:function(t,e,n){t.exports={}},2456:function(t,e,n){t.exports={}},2457:function(t,e,n){t.exports={}},255:function(t,e,n){"use strict";n(24);var o=n(10),r={name:"DecorationsPruduct",components:{HyColorfulBorder:n(108).default},props:{productUrl:{type:String,default:""},decorationAppliqueUrl:{type:String,default:""},decorationUrl:{type:String,default:""},width:{type:Number,default:286},height:{type:Number,default:0},boxRaido:{type:Number,default:8},innerRaido:{type:Number,default:6},innerPadding:{type:Number,default:4},innerColor:{type:String,default:"#1e1f21"},lazy:{type:Boolean,default:!0}},methods:{isVideoLink:o.G}},c=(n(3889),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"product-wrap",style:{width:t.width+"px",height:t.height?t.height+"px":"auto"}},[e("HyColorfulBorder",{staticClass:"product-image-box",attrs:{photoFrame:t.decorationUrl,photoFrameDecor:t.decorationAppliqueUrl,borderRadius:t.boxRaido,boxHeight:t.height?t.height+"px":"auto",photoPadding:t.innerPadding}},[e("div",{staticClass:"product-image",style:{borderRadius:t.innerRaido+"px",backgroundColor:t.innerColor}},[t.productUrl?[t.isVideoLink(t.productUrl)?e("video",{attrs:{autoplay:"",loop:"",muted:"",playsinline:"",controls:!1,src:t.productUrl},domProps:{muted:!0},on:{click:function(t){t.preventDefault()}}}):e("el-image",{attrs:{src:t.productUrl,alt:"product",lazy:t.lazy}})]:t._e()],2)])],1)}),[],!1,null,"4ccee1ae",null);e.a=component.exports},2555:function(t,e,n){t.exports={}},2557:function(t,e,n){t.exports={}},2561:function(t,e,n){t.exports={}},2562:function(t,e,n){t.exports={}},2567:function(t,e,n){t.exports={}},2568:function(t,e,n){t.exports={}},257:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(4),n(26),n(38)),c=n(1);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={props:["aiChatId","skipRequest"],name:"AiChatReport",data:function(){return{isShowPopup:!1,remark:"",loading:!1,step:1}},methods:d(d({},Object(c.d)("user",["SET_REPORT_LIST"])),{},{report:function(t){""!==t?(this.remark=this.$t("AiChatReport"+t),this.submit()):this.step=2},open:function(){this.isShowPopup=!0},close:function(){var t=this;this.isShowPopup=!1,setTimeout((function(){t.step=1,t.remark="",t.loading=!1}),300)},submit:function(){var t=this;this.skipRequest?this.step=3:(this.$logEvent("log_actions",{operation:"report_submit",behavior_info:this.remark}),this.loading=!0,Object(r.Y)({id:this.aiChatId,remark:this.remark}).then((function(e){t.step=3,t.SET_REPORT_LIST(t.aiChatId),setTimeout((function(){t.$router.back()}),1e3)})).finally((function(){t.loading=!1})))}})},v=(n(4034),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog aichat-report",attrs:{visible:t.isShowPopup,"custom-class":"aichat-report-dialog",title:t.$t("Report"),"before-close":t.close,"append-to-body":!0},on:{"update:visible":function(e){t.isShowPopup=e}}},[e("div",{staticClass:"report-body"},[1===t.step?e("div",{staticClass:"report-reason"},[e("p",{staticClass:"title"},[t._v(t._s(t.$t("AiChatReportTitle1")))]),t._v(" "),e("div",{staticClass:"reason-list"},[t._l(6,(function(n){return e("p",{key:"reason_"+n,attrs:{"data-id":t.aiChatId,"data-info":JSON.stringify({reason:t.$t("AiChatReport"+n)})},on:{click:function(e){return t.report(n)}}},[t._v("\n          "+t._s(t.$t("AiChatReport"+n))+"\n        ")])})),t._v(" "),e("p",{on:{click:function(e){return t.report("")}}},[t._v(t._s(t.$t("other")))])],2)]):2===t.step?e("div",{staticClass:"report-remark"},[e("p",{staticClass:"title"},[t._v(t._s(t.$t("AiChatReportTitle2")))]),t._v(" "),e("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:7}},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1):3===t.step?e("div",{staticClass:"report-result"},[e("img",{attrs:{src:n(1032),alt:""}}),t._v(" "),e("p",{staticClass:"result-text"},[t._v(t._s(t.$t("AiChatReportResult1")))]),t._v(" "),e("p",{staticClass:"result-tips"},[t._v(t._s(t.$t("AiChatReportResult2")))])]):t._e()]),t._v(" "),2===t.step?e("div",{staticClass:"handle-btn",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",attrs:{type:"default"},on:{click:t.close}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"submit-btn",attrs:{type:"default",loading:t.loading},on:{click:t.submit}},[t._v(t._s(t.$t("Submit")))])],1):t._e()])}),[],!1,null,"3154eaa4",null);e.a=component.exports},2570:function(t,e,n){t.exports={}},2572:function(t,e,n){t.exports={}},2573:function(t,e,n){t.exports={}},2574:function(t,e,n){t.exports={}},2575:function(t,e,n){t.exports={}},2576:function(t,e,n){t.exports={}},2577:function(t,e,n){t.exports={}},2578:function(t,e,n){t.exports={}},2579:function(t,e,n){t.exports={}},258:function(t,e,n){"use strict";var o={name:"SubHead"},r=(n(5665),n(0)),component=Object(r.a)(o,(function(){return(0,this._self._c)("div",{staticClass:"head flex items-center"},[this._t("default")],2)}),[],!1,null,"56092247",null);e.a=component.exports},2580:function(t,e,n){t.exports={}},2581:function(t,e,n){t.exports={}},2582:function(t,e,n){t.exports={}},2583:function(t,e,n){t.exports={}},2584:function(t,e,n){t.exports={}},2585:function(t,e,n){t.exports={}},2587:function(t,e,n){t.exports={}},2588:function(t,e,n){t.exports={}},2589:function(t,e,n){t.exports={}},2590:function(t,e,n){t.exports={}},2591:function(t,e,n){t.exports={}},2592:function(t,e,n){t.exports={}},2593:function(t,e,n){t.exports={}},2594:function(t,e,n){t.exports={}},2595:function(t,e,n){t.exports={}},2596:function(t,e,n){t.exports={}},2597:function(t,e,n){t.exports={}},2598:function(t,e,n){t.exports={}},2599:function(t,e,n){t.exports={}},2600:function(t,e,n){t.exports={}},2602:function(t,e,n){t.exports={}},2603:function(t,e,n){t.exports={}},2604:function(t,e,n){t.exports={}},2605:function(t,e,n){t.exports={}},2606:function(t,e,n){t.exports={}},2607:function(t,e,n){t.exports={}},2608:function(t,e,n){t.exports={}},2609:function(t,e,n){t.exports={}},2610:function(t,e,n){t.exports={}},2611:function(t,e,n){t.exports={}},2612:function(t,e,n){t.exports={}},2613:function(t,e,n){t.exports={}},2614:function(t,e,n){t.exports={}},2615:function(t,e,n){t.exports={}},2616:function(t,e,n){t.exports={}},2617:function(t,e,n){t.exports={}},2618:function(t,e,n){t.exports={}},2619:function(t,e,n){t.exports={}},2683:function(t,e,n){t.exports={}},2684:function(t,e,n){t.exports={}},2685:function(t,e,n){t.exports={}},2686:function(t,e,n){t.exports={}},2687:function(t,e,n){t.exports={}},2688:function(t,e,n){t.exports={}},2689:function(t,e,n){t.exports={}},2690:function(t,e,n){t.exports={}},2691:function(t,e,n){t.exports={}},2692:function(t,e,n){t.exports={}},2693:function(t,e,n){t.exports={}},2694:function(t,e,n){t.exports={}},2695:function(t,e,n){t.exports={}},2696:function(t,e,n){t.exports={}},2697:function(t,e,n){t.exports={}},2698:function(t,e,n){t.exports={}},2699:function(t,e,n){t.exports={}},2700:function(t,e,n){t.exports={}},2701:function(t,e,n){t.exports={}},2702:function(t,e,n){t.exports={}},2703:function(t,e,n){t.exports={}},2704:function(t,e,n){t.exports={}},2705:function(t,e,n){t.exports={}},2706:function(t,e,n){t.exports={}},2707:function(t,e,n){t.exports={}},2708:function(t,e,n){t.exports={}},2709:function(t,e,n){t.exports={}},2710:function(t,e,n){t.exports={}},2711:function(t,e,n){t.exports={}},2712:function(t,e,n){t.exports={}},2713:function(t,e,n){t.exports={}},2714:function(t,e,n){t.exports={}},2715:function(t,e,n){t.exports={}},2716:function(t,e,n){t.exports={}},2717:function(t,e,n){t.exports={}},2718:function(t,e,n){t.exports={}},2719:function(t,e,n){t.exports={}},2720:function(t,e,n){t.exports={}},2721:function(t,e,n){t.exports={}},2722:function(t,e,n){t.exports={}},2723:function(t,e,n){t.exports={}},2724:function(t,e,n){t.exports={}},2725:function(t,e,n){t.exports={}},2726:function(t,e,n){t.exports={}},2727:function(t,e,n){t.exports={}},2728:function(t,e,n){t.exports={}},2729:function(t,e,n){t.exports={}},2730:function(t,e,n){t.exports={}},2731:function(t,e,n){t.exports={}},2732:function(t,e,n){t.exports={}},2733:function(t,e,n){t.exports={}},2734:function(t,e,n){t.exports={}},2735:function(t,e,n){t.exports={}},2736:function(t,e,n){t.exports={}},2738:function(t,e,n){t.exports={}},2739:function(t,e,n){t.exports={}},2740:function(t,e,n){t.exports={}},2741:function(t,e,n){t.exports={}},2742:function(t,e,n){t.exports={}},2743:function(t,e,n){t.exports={}},2744:function(t,e,n){t.exports={}},2745:function(t,e,n){t.exports={}},2747:function(t,e,n){t.exports={}},2748:function(t,e,n){t.exports={}},2749:function(t,e,n){t.exports={}},2750:function(t,e,n){t.exports={}},2751:function(t,e,n){t.exports={}},2752:function(t,e,n){t.exports={}},2753:function(t,e,n){t.exports={}},2754:function(t,e,n){t.exports={}},2755:function(t,e,n){t.exports={}},2756:function(t,e,n){t.exports={}},2757:function(t,e,n){t.exports={}},2758:function(t,e,n){t.exports={}},2759:function(t,e,n){t.exports={}},2760:function(t,e,n){t.exports={}},2761:function(t,e,n){t.exports={}},2762:function(t,e,n){t.exports={}},2763:function(t,e,n){t.exports={}},2764:function(t,e,n){t.exports={}},2765:function(t,e,n){t.exports={}},2766:function(t,e,n){t.exports={}},2767:function(t,e,n){t.exports={}},2768:function(t,e,n){t.exports={}},2769:function(t,e,n){t.exports={}},2770:function(t,e,n){t.exports={}},2771:function(t,e,n){t.exports={}},2772:function(t,e,n){t.exports={}},2773:function(t,e,n){t.exports={}},2774:function(t,e,n){t.exports={}},2775:function(t,e,n){t.exports={}},2776:function(t,e,n){t.exports={}},2777:function(t,e,n){t.exports={}},2778:function(t,e,n){t.exports={}},2779:function(t,e,n){t.exports={}},2780:function(t,e,n){t.exports={}},279:function(t,e,n){"use strict";var o={name:"AiChatCreateConfirm",props:{source:{type:String,default:"art_task"},fromPage:{type:String,default:""}},data:function(){return{bodyScrollTop:null,visible:!1}},methods:{show:function(){this.visible=!0,this.reportEvent({operation:"tavern_comfirm_pop_show",behavior_info:"on_tavern_create_comfirm_pop",behavior_info_sub:this.source})},hide:function(){this.visible=!1},handleConfirm:function(){this.reportEvent({operation:"click_comfirm",behavior_info:"on_tavern_create_comfirm_pop",behavior_info_sub:this.source}),this.$emit("confirm"),this.hide()},reportEvent:function(data){this.$logEvent("log_actions",{operation:data.operation,behavior_info:data.behavior_info,behavior_info_sub:data.behavior_info_sub})}}},r=(n(4053),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"create-digital-confirm-dialog",attrs:{visible:t.visible,title:t.$t("create_digital"),width:"462px","custom-class":"create-digital-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,"modal-append-to-body":!1,"append-to-body":""},on:{"update:visible":function(e){t.visible=e},close:t.hide},scopedSlots:t._u([{key:"footer",fn:function(){return[e("span",{staticClass:"dialog-footer"},[e("el-button",{staticClass:"btn cancel",on:{click:t.hide}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"btn query",class:["newTask"===t.fromPage&&"query-liner"],on:{click:t.handleConfirm}},[t._v(t._s(t.$t("Create")))])],1)]},proxy:!0}])},[e("div",{staticClass:"content-2"},[t._v("\n    "+t._s(t.$t("create_digital_human"))+"\n  ")])])}),[],!1,null,"62b8376e",null);e.a=component.exports},2817:function(t,e,n){t.exports={}},2818:function(t,e,n){t.exports={}},2819:function(t,e,n){t.exports={}},2820:function(t,e,n){t.exports={}},2821:function(t,e,n){t.exports={}},2822:function(t,e,n){t.exports={}},2823:function(t,e,n){t.exports={}},2829:function(t,e,n){t.exports={}},2912:function(t,e,n){t.exports={}},2960:function(t,e,n){t.exports={}},2961:function(t,e,n){t.exports={}},2969:function(t,e,n){t.exports={}},2977:function(t,e,n){t.exports={}},2978:function(t,e,n){t.exports={}},2979:function(t,e,n){t.exports={}},2982:function(t,e,n){t.exports={}},3002:function(t,e,n){t.exports={}},3011:function(t,e,n){t.exports={}},3039:function(t,e,n){t.exports={}},3082:function(t,e,n){t.exports={}},3083:function(t,e,n){t.exports={}},3084:function(t,e,n){t.exports={}},3085:function(t,e,n){t.exports={}},3086:function(t,e,n){t.exports={}},3087:function(t,e,n){t.exports={}},3088:function(t,e,n){t.exports={}},3089:function(t,e,n){t.exports={}},3090:function(t,e,n){t.exports={}},3091:function(t,e,n){t.exports={}},3092:function(t,e,n){t.exports={}},3093:function(t,e,n){t.exports={}},3189:function(t,e,n){"use strict";n.r(e);var o=n(3),r=n(2),c=(n(20),n(19),n(6),n(11),n(16),n(18),n(24),n(12),n(13),n(8),n(4),n(28),n(21),n(7),n(40),n(44),n(41),n(26),n(109),n(897)),l=n(209),d=n(93),h=n(790).a,v=(n(5145),n(0)),component=Object(v.a)(h,(function(){var t,e,o,r=this,c=r._self._c;return c("div",{staticClass:"aichat-head",class:{"left-collapsed":r.leftCollapsed,"right-collapsed":r.rightCollapsed,"all-collapsed":r.leftCollapsed&&r.rightCollapsed}},[r.leftCollapsed?c("div",{staticClass:"left-tabs"},[c("div",{staticClass:"back-icon flex-center",on:{click:r.goback}},[c("i",{staticClass:"el-icon-arrow-left"})]),r._v(" "),c("a",{staticClass:"web-logo",class:["release"!==r.envMark&&"canary"],attrs:{href:r.localePath("/"),"data-text":r.envMark},on:{click:function(t){return t.preventDefault(),r.toHome.apply(null,arguments)}}},[c("img",{staticClass:"logo",attrs:{src:r.logo,alt:"Avatar"}})]),r._v(" "),c("span",{directives:[{name:"show",rawName:"v-show",value:r.isCompanyAccount,expression:"isCompanyAccount"}],staticClass:"company-name"},[r._v("\n      "+r._s(r.$t("Enterprise"))+"\n    ")]),r._v(" "),c("div",{staticClass:"collapse-button left",on:{click:r.openLeft}},[c("i",{staticClass:"iconfont icon-a-arrowleft"})])]):r._e(),r._v(" "),r.rightCollapsed?c("div",{staticClass:"right-tabs flex-center"},[r.showVoiceIcon?c("div",{staticClass:"voice-status",on:{click:r.handleSelectSound}},[r._m(0),r._v(" "),c("span",{staticClass:"tip"},[r._v(r._s((null===(t=r.currentTimbreObj)||void 0===t?void 0:t.name)||r.$t("Pls_select")))]),r._v(" "),c("i",{staticClass:"el-icon-arrow-right"})]):r._e(),r._v(" "),c("div",{staticClass:"info-item asset-item flex-center",attrs:{title:r.getCoinTitle(r.coins[0]),"data-event":"ai_chat_credit_item"},on:{click:function(t){return r.toMall("?openTab=Credit&dotFrom=on_tavern_sidebar")}}},[c("img",{attrs:{src:n(205),alt:""}}),r._v(" "),c("span",[r._v(r._s(r._f("formatNumberForeign")(r.paymentInfo.calculateCoins)))])]),r._v(" "),c("div",{staticClass:"info-item asset-item flex-center",attrs:{title:r.getCoinTitle(r.coins[1]),"data-event":"ai_chat_stamina_item"},on:{click:function(t){return r.toMall("?openTab=Credit&dotFrom=on_tavern_sidebar")}}},[c("img",{attrs:{src:n(160),alt:""}}),r._v(" "),c("span",[r._v(r._s(r._f("formatNumberForeign")(r.paymentInfo.tempCoins)))])]),r._v(" "),c("div",{staticClass:"info-item vip-item",on:{click:function(t){return r.toMall("?dotFrom=on_tavern_sidebar")}}},[c("img",{attrs:{src:n(665),alt:""}})]),r._v(" "),c("div",{staticClass:"collapse-button right",on:{click:r.openRight}},[c("i",{staticClass:"iconfont icon-a-arrowleft"})])]):r._e(),r._v(" "),c("selectSoundModel",{ref:"selectSoundModel",attrs:{selectList:null!==(e=r.currentTimbreObj)&&void 0!==e&&e.id?[null===(o=r.currentTimbreObj)||void 0===o?void 0:o.id]:[]},on:{newChat:r.newChat,selectModel:r.selectModel}})],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"voice-icon"},[t("i",{staticClass:"iconfont icon-icon-video1"})])}],!1,null,"742a631b",null),f=component.exports,m=n(9),_=n(1);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"AiChatSearchResult",data:function(){return{formatTimestamp:m.V}},computed:w({},Object(_.c)("character",["showSearchResult","search_results"])),methods:w(w({},Object(_.d)("character",["SET_SHOW_SEARCH_RESULT"])),{},{handleClose:function(){this.SET_SHOW_SEARCH_RESULT(!1)},handleClickItem:function(t){console.log("点击搜索结果项:",t),t.url?window.open(t.url,"_blank"):this.$message.warning(this.$t("InvalidURL"))}})},k=(n(5146),Object(v.a)(C,(function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"slide-fade"}},[t.showSearchResult?e("div",{staticClass:"custom-drawer"},[e("div",{staticClass:"custom-drawer-header"},[e("span",{staticClass:"custom-drawer-title"},[t._v(t._s(t.$t("SearchResults")))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:t.handleClose}})]),t._v(" "),e("div",{staticClass:"ai-chat-search-result hide-scrollbar"},t._l(t.search_results,(function(n,o){return e("div",{key:o,staticClass:"ai-chat-search-result-item",on:{click:function(e){return t.handleClickItem(n)}}},[e("div",{staticClass:"ai-chat-search-result-item-1"},[e("div",{staticClass:"item-title-url",attrs:{title:n.url}},[t._v(t._s(n.url||""))]),t._v(" "),e("div",{staticClass:"item-title-time"},[t._v(t._s(t.formatTimestamp(n.published_at||new Date,"yyyy/mm/dd")))]),t._v(" "),e("div",{staticClass:"item-title-index"},[e("span",[t._v(t._s(o+1))])])]),t._v(" "),e("div",{staticClass:"ai-chat-search-result-item-2"},[t._v(t._s(n.title||""))]),t._v(" "),e("div",{staticClass:"ai-chat-search-result-item-3"},[t._v(t._s(n.snippet||""))])])})),0)]):t._e()])}),[],!1,null,"48a9631a",null).exports),O=n(116),x=n(30),I=n(14),S=(n(32),n(473)),D=n(38),L=n(35),P=n.n(L),j=n(941),$=n(612);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R={name:"AiChatSettingNew",inject:["aiChatIndex"],components:{AiChatModelSwitcher:S.a,AiChatCustomSlider:j.a,AiChatTalkPopup:$.a},watch:{characterSetting:{handler:function(t){if(t&&Object.keys(t).length>0){var e,n,o,r,c,l,d={temperature:.7,diversity:1,length_of_reply:600,enable_memory:2,enable_five_memory:2,enable_stream_chat:1,full_screen:1,hide_bg:2,gpt_model:"GPT-35-Turbo-1106",initiative_chat:1},h={temperature:null===(e=this.currentModel)||void 0===e?void 0:e.default_temperature,diversity:null===(n=this.currentModel)||void 0===n?void 0:n.default_diversity,length_of_reply:null===(o=this.currentModel)||void 0===o?void 0:o.default_length_of_reply,functionality_temperature:null===(r=this.currentModel)||void 0===r?void 0:r.default_temperature,functionality_diversity:null===(c=this.currentModel)||void 0===c?void 0:c.default_diversity,functionality_length_of_reply:null===(l=this.currentModel)||void 0===l?void 0:l.default_length_of_reply};this.handleConfig={temperature:t.temperature?t.temperature:h.temperature||d.temperature,diversity:t.diversity?t.diversity:h.diversity||d.diversity,length_of_reply:t.length_of_reply?t.length_of_reply:h.length_of_reply||d.length_of_reply,functionality_temperature:t.functionality_temperature?t.functionality_temperature:h.functionality_temperature||d.temperature,functionality_diversity:t.functionality_diversity?t.functionality_diversity:h.functionality_diversity||d.diversity,functionality_length_of_reply:t.functionality_length_of_reply?t.functionality_length_of_reply:h.functionality_length_of_reply||d.length_of_reply,enable_memory:t.enable_memory?t.enable_memory:d.enable_memory,enable_five_memory:t.enable_five_memory?t.enable_five_memory:d.enable_five_memory,enable_stream_chat:t.enable_stream_chat?t.enable_stream_chat:d.enable_stream_chat,full_screen:t.full_screen?t.full_screen:d.full_screen,hide_bg:t.hide_bg?t.hide_bg:d.hide_bg,gpt_model:this.isToolCharacter?t.functionality_gpt_model:t.gpt_model||d.gpt_model,initiative_chat:t.initiative_chat?t.initiative_chat:d.initiative_chat}}else this.handleConfig={temperature:.7,diversity:1,length_of_reply:600,enable_memory:2,enable_five_memory:2,enable_stream_chat:1,full_screen:1,hide_bg:2,gpt_model:"GPT-35-Turbo-1106",initiative_chat:1}},deep:!0,immediate:!0},currentModel:{handler:function(t){this.updateConfig(t)},immediate:!0,deep:!0},rememberChatValue:function(t){this.rememberChatSwitchValue=t}},data:function(){return{getModelListLoading:!0,paramsLoading:!0,visible:!1,models:{List:[],functionality_list:[],workflow:[]},loading:!1,handleConfig:{},resizeObserver:null,rememberChatSwitchValue:!1,rememberChatFiveSwitchValue:!1}},computed:M(M(M(M({},Object(_.e)("payment",["paymentInfo"])),Object(_.c)("user",["userInfo","isLoggedIn","characterSetting","isCompanyAccount"])),Object(_.c)("character",["characterInfo","isToolCharacter","isDigitalCharacter"])),{},{recommendModels:function(){var t,e,n=Array.isArray(null===(t=this.currentTalkModelObj)||void 0===t?void 0:t.recommend)?this.currentTalkModelObj.recommend:[],o=null===(e=this.currentTalkModelObj)||void 0===e?void 0:e.highly_recommend;return o?[].concat(Object(I.a)(n),[o]):n},currentModel:function(){var t,e,n=this;return this.isToolCharacter?(null===(t=this.models)||void 0===t||null===(t=t.functionality_list)||void 0===t?void 0:t.find((function(t){return t.gpt_model===n.defaultGptModel})))||{}:(null===(e=this.models)||void 0===e||null===(e=e.List)||void 0===e?void 0:e.find((function(t){return t.gpt_model===n.defaultGptModel})))||{}},isShowTalkModel:function(){var t,e;return(null===(t=this.models.workflow)||void 0===t?void 0:t.length)>0&&[0,2].includes(null===(e=this.characterInfo)||void 0===e?void 0:e.character_type)||!1},currentTalkModelObj:function(){var t=this;return this.models.workflow.find((function(e){return e.workflow_no===t.currentWorkflowId}))||{}},currentWorkflowId:function(){var t,e,n,o,r=(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.workflow_no)||!1,c=null===(n=this.userInfo)||void 0===n?void 0:n.character_setting;return 1===(null==c?void 0:c.is_set_workflow)||!r?(null==c?void 0:c.workflow_no)||this.defaultWorkflowNo||"":(null===(o=this.characterInfo)||void 0===o?void 0:o.workflow_no)||this.defaultWorkflowNo||""},defaultWorkflowNo:function(){var t,e;return(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)||(null===(e=this.models)||void 0===e||null===(e=e.workflow)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.workflow_no)||""},defaultGptModel:function(){var t,e,n,o,r,c,l=(null===(t=this.characterInfo)||void 0===t?void 0:t.gpt_model)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.gpt_model)||!1,d=null===(n=this.userInfo)||void 0===n?void 0:n.character_setting;return(this.isToolCharacter?1!==(null==d?void 0:d.is_set_functionality_model):1!==(null==d?void 0:d.is_set_companion_model))&&l||!this.isLoggedIn?this.isLoggedIn&&null!==(o=this.characterInfo)&&void 0!==o&&o.gpt_model&&"-"!==(null===(r=this.characterInfo)||void 0===r?void 0:r.gpt_model)?null===(c=this.characterInfo)||void 0===c?void 0:c.gpt_model:this.isToolCharacter?"Deepseek-v3":"GPT-35-Turbo-1106":this.isToolCharacter?null==d?void 0:d.functionality_gpt_model:null==d?void 0:d.gpt_model},rememberChatValue:{get:function(){return 1===this.handleConfig.enable_memory},set:function(t){this.updateRememberChat(t)}},rememberChatFiveValue:{get:function(){return 1===this.handleConfig.enable_five_memory},set:function(t){this.updateRememberChatFive(t)}},streamChatValue:{get:function(){return 1===this.handleConfig.enable_stream_chat},set:function(t){this.updateExportChat(t)}},fullScreenValue:{get:function(){return 1===this.handleConfig.full_screen},set:function(t){this.updateFullscreen(t)}},initiativeChatValue:{get:function(){return 1===this.handleConfig.initiative_chat},set:function(t){this.updateInitiativeChat(t)}},hideBgValue:{get:function(){return 1===this.handleConfig.hide_bg},set:function(t){this.updateHideBackground(t)}}}),mounted:function(){this.resizeObserver=new ResizeObserver(this.checkDialogHeight),window.addEventListener("resize",this.checkDialogHeight)},beforeDestroy:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.checkDialogHeight)},methods:M(M({},Object(_.d)("user",["SET_USER_INFO"])),{},{handleCloseWorkModel:function(){if(this.isDigitalCharacter){var t,e=null===(t=this.currentTalkModelObj)||void 0===t?void 0:t.highly_recommend,n=this.models.List.find((function(t){return t.gpt_model===e}));this.$EventBus.$emit("closeRecModelPopup"),this.$EventBus.$emit("openRecModelPopup",{highModelObj:n})}},updateConfig:function(t){var e=this;if(0!==Object.keys(t).length){var n=[["temperature","default_temperature"],["diversity","default_diversity"],["length_of_reply","default_length_of_reply"],["functionality_temperature","default_temperature"],["functionality_diversity","default_diversity"],["functionality_length_of_reply","default_length_of_reply"]].reduce((function(n,o){var r=Object(x.a)(o,2),c=r[0],l=r[1];return n[c]=void 0!==e.characterSetting[c]?e.characterSetting[c]:t[l],n}),{});this.isToolCharacter?(this.handleConfig.temperature=n.functionality_temperature,this.handleConfig.diversity=n.functionality_diversity,this.handleConfig.length_of_reply=n.functionality_length_of_reply):(this.handleConfig.temperature=n.temperature,this.handleConfig.diversity=n.diversity,this.handleConfig.length_of_reply=n.length_of_reply),setTimeout((function(){e.checkModelConfig(t)}),0)}},checkModelConfig:function(t){try{this.paramsLoading=!0,t.temperature_max<this.handleConfig.temperature&&(this.handleConfig.temperature=t.temperature_max),t.temperature_min>this.handleConfig.temperature&&(this.handleConfig.temperature=t.temperature_min),t.diversity_max<this.handleConfig.diversity&&(this.handleConfig.diversity=t.diversity_max),t.diversity_min>this.handleConfig.diversity&&(this.handleConfig.diversity=t.diversity_min),t.msg_len_max<this.handleConfig.length_of_reply&&(this.handleConfig.length_of_reply=t.msg_len_max),t.msg_len_min>this.handleConfig.length_of_reply&&(this.handleConfig.length_of_reply=t.msg_len_min)}catch(t){this.paramsLoading=!1,console.log("checkModelConfig-error",t)}this.paramsLoading=!1},updateSettings:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:{},!e.checkNeedLogin(o)||e.isLoggedIn){n.next=5;break}return e.$EventBus.$emit("openLoginDialog"),n.abrupt("return");case 5:if(r=M({},e.handleConfig),e.loading=!0,n.prev=7,e.handleConfig=M(M({},e.handleConfig),o),"full_screen"in o&&(e.handleConfig.hide_bg=2,o.hide_bg=2),"hide_bg"in o&&1===o.hide_bg&&(e.handleConfig.full_screen=1,o.full_screen=1),!e.isLoggedIn){n.next=21;break}return console.log("更新设置",o),n.next=15,Object(D.ab)(o);case 15:if(1e4===(null==(l=n.sent)||null===(c=l.status)||void 0===c?void 0:c.code)){n.next=18;break}throw new Error((null==l||null===(d=l.status)||void 0===d?void 0:d.message)||e.$t("taskOperateFailed"));case 18:h=P()(e.userInfo)||{},Object.keys(o).forEach((function(t){h.character_setting[t]=o[t]})),e.SET_USER_INFO(h);case 21:e.isLoggedIn||e.SET_USER_INFO({character_setting:{full_screen:o.full_screen,hide_bg:o.hide_bg}}),e.$message({type:"success",message:e.$t("OperateSuccess"),duration:2e3}),n.next=30;break;case 25:n.prev=25,n.t0=n.catch(7),e.handleConfig=r,e.$message({type:"error",message:n.t0.message||e.$t("taskOperateFailed"),duration:3e3}),console.error("更新设置失败:",n.t0);case 30:return n.prev=30,e.loading=!1,n.finish(30);case 33:case"end":return n.stop()}}),n,null,[[7,25,30,33]])})))()},checkNeedLogin:function(t){var e=["full_screen","hide_bg","style"];return!Object.keys(t).every((function(t){return e.includes(t)}))},updateTemperature:function(t){this.loading||(this.isToolCharacter?this.updateSettings({functionality_temperature:t}):this.updateSettings({temperature:t}))},updateDiversity:function(t){this.isToolCharacter?this.updateSettings({functionality_diversity:t}):this.updateSettings({diversity:t})},updateMaxLength:function(t){this.isToolCharacter?this.updateSettings({functionality_length_of_reply:t}):this.updateSettings({length_of_reply:t})},updateRememberChat:function(t){this.updateSettings({enable_memory:t?1:2})},updateRememberChatFive:function(t){this.updateSettings({enable_five_memory:t?1:2})},updateExportChat:function(t){this.updateSettings({enable_stream_chat:t?1:2})},updateFullscreen:function(t){this.updateSettings({full_screen:t?1:2})},updateHideBackground:function(t){this.updateSettings({hide_bg:t?1:2})},updateInitiativeChat:function(t){this.updateSettings({initiative_chat:t?1:2})},getModelList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,data,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getModelListLoading=!0,e.prev=1,e.next=4,Object(D.u)();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:o=e.t0,data=(r=o||{}).data,1e4===(null==(c=r.status)?void 0:c.code)&&(null==data||null===(n=data.List)||void 0===n?void 0:n.length)>0&&(t.models.functionality_list=(null==data?void 0:data.functionality_list)||[],t.models.List=(null==data?void 0:data.List)||[],t.models.workflow=(null==data?void 0:data.workflow_list)||[]),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(1),console.log("getModels-error",e.t1);case 15:return e.prev=15,t.getModelListLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})))()},changeModel:function(){this.$logEvent("log_actions",{operation:"click_change_model",behavior_info:"on_tarven_detail_page"}),this.$refs.aiChatModelSwitcher.show()},changeTalkModel:function(){this.$refs.aiChatTalkPopup.show()},show:function(){var t=this;this.visible=!0,this.rememberChatSwitchValue=this.rememberChatValue,this.rememberChatFiveSwitchValue=this.rememberChatFiveValue,this.$nextTick((function(){t.models.List.length?t.getModelListLoading=!1:t.getModelList()}))},hide:function(){this.visible=!1},handleDialogOpened:function(){var t=this;this.$nextTick((function(){t.resizeObserver&&t.$refs.settingsContainer&&t.resizeObserver.observe(t.$refs.settingsContainer),t.checkDialogHeight()}))},checkDialogHeight:function(){var t=this.$refs.settingsContainer;if(t){var e=window.innerHeight,n=e-.05*e-20-60;t.scrollHeight>n?(t.style.maxHeight="".concat(n,"px"),t.style.overflowY="auto",t.style.paddingRight="10px"):(t.style.maxHeight="none",t.style.overflowY="visible",t.style.paddingRight="0")}},handleLogEvent:function(t){return t?"off":"on"},handleOpenVip:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2x",n="2x"===e?"standard":"professional";"5x"===e&&3===(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)&&(n="master"),this.$EventBus.$emit("showBreakDialog","Long_Memory_Vip",n)},handleRememberChatSwitch:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(d=(l=e.length>1&&void 0!==e[1]?e[1]:{}).updateFunc,h=l.switchType,v=void 0===h?"2x":h,t){o.next=5;break}return d(t),o.abrupt("return");case 5:if(n.isLoggedIn){o.next=9;break}return"2x"===v?n.rememberChatSwitchValue=!1:n.rememberChatFiveSwitchValue=!1,n.$EventBus.$emit("openLoginDialog"),o.abrupt("return");case 9:if("2x"===v?(null===(r=n.paymentInfo)||void 0===r?void 0:r.productLevel)>=2:(null===(c=n.paymentInfo)||void 0===c?void 0:c.productLevel)>=3){o.next=14;break}return n.handleOpenVip(v),"2x"===v?n.rememberChatSwitchValue=!1:n.rememberChatFiveSwitchValue=!1,o.abrupt("return");case 14:n.$EventBus.$emit("showDialog",{name:"HyConfirmModal",data:{title:n.$t("Tip"),content:n.$t("Long_Memory"),confirmCallback:function(){d(t)},cancelCallback:function(){"2x"===v?n.rememberChatSwitchValue=!1:n.rememberChatFiveSwitchValue=!1}}});case 15:case"end":return o.stop()}}),o)})))()},handleRememberChatSwitch2:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.handleRememberChatSwitch(t,{updateFunc:e.updateRememberChat,switchType:"2x"});case 2:case"end":return n.stop()}}),n)})))()},handleRememberChatSwitch5:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.handleRememberChatSwitch(t,{updateFunc:e.updateRememberChatFive,switchType:"5x"});case 2:case"end":return n.stop()}}),n)})))()}})},A=R,E=(n(5147),n(5148),Object(v.a)(A,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.visible,title:t.$t("characterSettingChat"),top:"0","custom-class":"chat-settings-dialog","append-to-body":""},on:{"update:visible":function(e){t.visible=e},opened:t.handleDialogOpened}},[e("div",{ref:"settingsContainer",staticClass:"settings-container"},[e("section",{staticClass:"settings-section"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.$t("talk_model_setting")))]),t._v(" "),e("p",{staticClass:"section-subtitle"},[t._v(t._s(t.$t("talk_model_setting_desc1")))]),t._v(" "),e("p",{staticClass:"model-description"},[t._v(t._s(t.$t("talk_model_setting_desc2")))]),t._v(" "),t.isShowTalkModel?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.getModelListLoading,expression:"getModelListLoading"}],staticClass:"model-select"},[e("div",{staticClass:"model-info"},[e("span",[t._v(t._s(t.$t("current_talk_model"))+": "+t._s(t.$t(t.currentTalkModelObj.title_key)))]),t._v(" "),e("p",[t._v(t._s(t.$t(t.currentTalkModelObj.desc_key)))])]),t._v(" "),e("div",{staticClass:"change-model-btn",attrs:{"data-event":"ai-chat-change-talk-model-btn"},on:{click:t.changeTalkModel}},[t._v("\n          "+t._s(t.$t("characterSettingChange"))+"\n        ")])]):t._e(),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.getModelListLoading,expression:"getModelListLoading"}],staticClass:"model-select"},[e("div",{staticClass:"model-info"},[e("span",[t._v(t._s(t.$t("current_model"))+": "+t._s(t.$t(t.currentModel.title_key)||t.currentModel.title))]),t._v(" "),e("p",[t._v(t._s(t.$t(t.currentModel.lang_key)||t.currentModel.lang))])]),t._v(" "),e("div",{staticClass:"change-model-btn",attrs:{"data-event":"ai-chat-change-model-btn"},on:{click:t.changeModel}},[t._v("\n          "+t._s(t.$t("characterSettingChange"))+"\n        ")])])]),t._v(" "),e("section",{staticClass:"settings-section"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.$t("Params")))]),t._v(" "),e("div",{staticClass:"parameter-item"},[e("div",{staticClass:"parameter-item-content"},[e("div",{staticClass:"parameter-header"},[e("span",[t._v(t._s(t.$t("characterSettingTemperature")))]),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("characterSettingTemperatureDesc",{value:1}),placement:"top"}},[e("i",{staticClass:"icon-icon-xinxi iconfont"})])],1),t._v(" "),e("client-only",[e("AiChatCustomSlider",{attrs:{min:t.currentModel.temperature_min||0,max:t.currentModel.temperature_max||2,step:.01,decimal:2},on:{change:t.updateTemperature},model:{value:t.handleConfig.temperature,callback:function(e){t.$set(t.handleConfig,"temperature",e)},expression:"handleConfig.temperature"}})],1),t._v(" "),e("div",{staticClass:"temperature-desc"},[e("span",[t._v(t._s(t.$t("characterSettingHidebound")))]),t._v(" "),e("span",[t._v(t._s(t.$t("characterSettingCreativity")))])])],1),t._v(" "),e("div",{staticClass:"parameter-item-content"},[e("div",{staticClass:"parameter-header"},[e("span",[t._v(t._s(t.$t("characterSettingContent")))]),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("characterSettingContentDesc",{value:.8}),placement:"top"}},[e("i",{staticClass:"icon-icon-xinxi iconfont"})])],1),t._v(" "),e("AiChatCustomSlider",{attrs:{min:t.currentModel.diversity_min||0,max:t.currentModel.diversity_max||1,step:.01,decimal:2},on:{change:t.updateDiversity},model:{value:t.handleConfig.diversity,callback:function(e){t.$set(t.handleConfig,"diversity",e)},expression:"handleConfig.diversity"}}),t._v(" "),e("div",{staticClass:"temperature-desc"},[e("span",[t._v(t._s(t.$t("characterSettingRepetition")))]),t._v(" "),e("span",[t._v(t._s(t.$t("characterSettingVarious")))])])],1)])]),t._v(" "),e("section",{staticClass:"settings-section"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.$t("characterSettingGeneral")))]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.paramsLoading,expression:"!paramsLoading"}],staticClass:"parameter-item"},[e("div",{staticClass:"parameter-item-content"},[e("div",{staticClass:"parameter-header"},[e("span",[t._v(t._s(t.$t("characterSettingMaxMsg")))])]),t._v(" "),e("AiChatCustomSlider",{attrs:{min:t.currentModel.msg_len_min||0,max:t.currentModel.msg_len_max||2048,step:1,decimal:0},on:{change:t.updateMaxLength},model:{value:t.handleConfig.length_of_reply,callback:function(e){t.$set(t.handleConfig,"length_of_reply",e)},expression:"handleConfig.length_of_reply"}}),t._v(" "),e("div",{staticClass:"temperature-desc"},[e("span",[t._v(t._s(t.currentModel.msg_len_min))]),t._v(" "),e("span",[t._v(t._s(t.currentModel.msg_len_max))])])],1)]),t._v(" "),e("div",{staticClass:"switch-list"},[e("div",{staticClass:"switch-item"},[e("span",{staticClass:"switch-item-title"},[e("span",{staticClass:"switch-item-title-text"},[t._v("\n              "+t._s(t.$t("longmemory2"))+"\n            ")]),t._v(" "),e("img",{staticClass:"switch-item-title-icon",attrs:{src:n(375),alt:"seaArt.Ai"}})]),t._v(" "),e("el-switch",{attrs:{"data-event":"character-enable-memory-click","data-id":t.handleLogEvent(t.rememberChatSwitchValue)},on:{change:t.handleRememberChatSwitch2},model:{value:t.rememberChatSwitchValue,callback:function(e){t.rememberChatSwitchValue=e},expression:"rememberChatSwitchValue"}})],1),t._v(" "),e("div",{staticClass:"switch-item"},[e("span",{staticClass:"switch-item-title"},[e("span",{staticClass:"switch-item-title-text"},[t._v("\n              "+t._s(t.$t("longmemory5"))+"\n            ")]),t._v(" "),e("img",{staticClass:"switch-item-title-icon",attrs:{src:n(375),alt:"seaArt.Ai"}})]),t._v(" "),e("el-switch",{attrs:{"data-event":"character-enable-memory-click","data-id":t.handleLogEvent(t.rememberChatFiveSwitchValue)},on:{change:t.handleRememberChatSwitch5},model:{value:t.rememberChatFiveSwitchValue,callback:function(e){t.rememberChatFiveSwitchValue=e},expression:"rememberChatFiveSwitchValue"}})],1),t._v(" "),t.isDigitalCharacter?e("div",{staticClass:"switch-item"},[e("span",[t._v(t._s(t.$t("sendMsg")))]),t._v(" "),e("el-switch",{attrs:{"data-event":"character-initiative-chat-click","data-id":t.handleLogEvent(t.initiativeChatValue)},model:{value:t.initiativeChatValue,callback:function(e){t.initiativeChatValue=e},expression:"initiativeChatValue"}})],1):t._e(),t._v(" "),e("div",{staticClass:"switch-item"},[e("span",[t._v(t._s(t.$t("FullScreen")))]),t._v(" "),e("el-switch",{attrs:{"data-event":"character-full-screen-click","data-id":t.handleLogEvent(t.fullScreenValue)},model:{value:t.fullScreenValue,callback:function(e){t.fullScreenValue=e},expression:"fullScreenValue"}})],1),t._v(" "),e("div",{staticClass:"switch-item"},[e("span",[t._v(t._s(t.$t("HideBack")))]),t._v(" "),e("el-switch",{attrs:{"data-event":"character-hide-background-click","data-id":t.handleLogEvent(t.hideBgValue)},model:{value:t.hideBgValue,callback:function(e){t.hideBgValue=e},expression:"hideBgValue"}})],1)])])]),t._v(" "),e("AiChatModelSwitcher",{ref:"aiChatModelSwitcher",attrs:{recommendModels:t.recommendModels}}),t._v(" "),e("AiChatTalkPopup",{ref:"aiChatTalkPopup",on:{change:t.handleCloseWorkModel}})],1)}),[],!1,null,"4ba85990",null).exports),B=(n(50),n(49),n(43),n(77),n(211)),N=n(368),F=n(476);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var H={inject:["aiChatIndex"],components:{ConfirmModal:N.a,AiChatEditForm:F.a},name:"AiChatAllChatPopup",data:function(){return{formatTimestamp:m.V,formatMsg:B.a,editIndex:null,curHandle:"edit",loading:!1,list:[],isShowPopup:!1,editForm:{title:"",id:""}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(_.c)("character",["characterInfo","sessionId"])),filters:{DateFormat:function(t){var e=new Date(t),n=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return"".concat(n,"/").concat(o,"/").concat(r)},TimeFormat:function(t){var e=new Date(t);return e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")}},methods:{handleActions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("更多操作--",data);var e=data.session_id,n=void 0===e?"":e;switch(this.curHandle=t,this.$logEvent("log_actions",{operation:"click_".concat(t),behavior_info:"on_tarven_detail_page",behavior_info_sub:"last_chat"}),this.editIndex=this.list.findIndex((function(t){return t.session_id===n})),t){case"edit":this.editForm.title=data.session_title||Object(m.V)(data.create_at),this.editForm.id=n,this.$refs.confirmModal.show({title:this.$t("lastChatEditTitle"),customClose:!0});break;case"delete":this.editForm.id=n,this.$refs.confirmModal.show({subTitle:this.$t("lastChatDelTitle"),mainTitle:this.$t("lastChatDelMainTitle"),handleMethods:"Del"})}},resetForm:function(){var t;this.editIndex=null,null===(t=this.$refs.editFormComponent)||void 0===t||t.resetForm()},submitForm:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,title,h,v,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t.editForm)||void 0===n||!n.id||"delete"!==t.curHandle){e.next=6;break}return e.next=3,Object(D.l)({id:null===(r=t.editForm)||void 0===r?void 0:r.id});case 3:return l=e.sent,1e4===(null===(c=l.status)||void 0===c?void 0:c.code)&&(null!==t.editIndex&&(t.delChatHandle(t.editIndex),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose()),e.abrupt("return");case 6:return e.next=8,t.$refs.editFormComponent.validate();case 8:if(d=e.sent,title=(null===(o=t.$refs.editFormComponent.form)||void 0===o?void 0:o.title)||"",!d||!title||"edit"!==t.curHandle){e.next=15;break}return e.next=13,Object(D.q)({title:title,id:null===(h=t.editForm)||void 0===h?void 0:h.id});case 13:f=e.sent,1e4===(null===(v=f.status)||void 0===v?void 0:v.code)&&(null!==t.editIndex&&(console.log("title",title),t.$set(t.list[t.editIndex],"session_title",title),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose());case 15:case"end":return e.stop()}}),e)})))()},delChatHandle:function(t){var e=this.list[t].session_id;this.list.splice(t,1),e===this.sessionId&&this.changeChat(this.list.length?0:-1,this.list)},getLastChatList:function(){var t,e=this;this.loading=!0,Object(D.t)({page_size:100,with_latest_msg:1,character_id:null===(t=this.characterInfo)||void 0===t?void 0:t.id}).then((function(t){var n=(null==t?void 0:t.data).items;e.list=n||[]})).finally((function(){e.loading=!1}))},show:function(){this.getLastChatList(),this.isShowPopup=!0},close:function(){this.isShowPopup=!1},changeChat:function(i,t){var e=this.$route.params.id,n=void 0===e?m.a:e;if(i<0)this.$router.replace(this.localePath("/cyberPubPage/"+n));else{var o=t[i],r=o.session_id;o.character_id,o.name,o.cover;r!==this.sessionId&&(this.$router.replace(this.localePath({path:"/aiChat/"+n,query:{s_id:r||this.sessionId}})),this.close())}}}},V=H,z=(n(5149),Object(v.a)(V,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog allchat-popup",attrs:{visible:t.isShowPopup,"append-to-body":""},on:{"update:visible":function(e){t.isShowPopup=e}}},[e("div",{staticClass:"custom-header",attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"custom-header-left"},[e("span",{staticClass:"name"},[e("i18n",{attrs:{path:"AllChatTitle"},scopedSlots:t._u([{key:"name",fn:function(){var n,o;return[e("span",{staticClass:"name-inner"},[t._v(t._s((null===(n=t.characterInfo)||void 0===n?void 0:n.name)||(null===(o=t.characterInfo)||void 0===o?void 0:o.id)))])]},proxy:!0}])})],1)]),t._v(" "),e("i",{staticClass:"custom-header-right el-icon-close",on:{click:t.close}})]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"popup-body"},[e("div",{staticClass:"aichat-list"},t._l(t.list,(function(n,i){var o,r,c;return e("div",{key:n.session_id,staticClass:"aichat-item",class:{"aichat-item-active":n.session_id===t.sessionId}},[e("div",{staticClass:"aichat-head",style:{backgroundImage:"url(".concat(null==n||null===(o=n.cover)||void 0===o?void 0:o.cover,")")},on:{click:function(e){return t.changeChat(i,t.list)}}}),t._v(" "),e("div",{staticClass:"aichat-info"},[e("div",{staticClass:"aichat-info-1"},[e("div",{staticClass:"info-time",on:{click:function(e){return t.changeChat(i,t.list)}}},[n.session_title?e("p",{staticClass:"info-date"},[t._v(t._s(n.session_title))]):[e("p",{staticClass:"info-date"},[t._v(t._s(t._f("DateFormat")(n.create_at)))]),t._v(" "),e("p",{staticClass:"info-time"},[t._v(t._s(t._f("TimeFormat")(n.create_at)))])]],2),t._v(" "),e("div",{staticClass:"info-handle"},[e("i",{staticClass:"icon-icon-edit2 iconfont",on:{click:function(e){return e.stopPropagation(),t.handleActions("edit",n)}}}),t._v(" "),e("i",{staticClass:"icon-icon-delete iconfont",on:{click:function(e){return e.stopPropagation(),t.handleActions("delete",n)}}})])]),t._v(" "),e("el-popover",{attrs:{trigger:"hover",placement:"bottom","popper-class":"popover-information","append-to-body":!1,"visible-arrow":!1,width:"300"}},[e("div",{staticClass:"pop-content",domProps:{innerHTML:t._s(t.formatMsg(null===(r=n.latest_msg)||void 0===r?void 0:r.content))}}),t._v(" "),e("div",{staticClass:"info-name text-ellipsis",attrs:{slot:"reference"},domProps:{innerHTML:t._s(t.formatMsg(null===(c=n.latest_msg)||void 0===c?void 0:c.content))},slot:"reference"})])],1)])})),0),t._v(" "),e("del-chat-popup",{ref:"delChatPopup"}),t._v(" "),e("ConfirmModal",{ref:"confirmModal",attrs:{dialogWidth:"edit"===t.curHandle?560:462},on:{confirm:t.submitForm,cancel:t.resetForm}},["edit"===t.curHandle?e("template",{slot:"custom_content"},[e("AiChatEditForm",{ref:"editFormComponent",attrs:{formObj:t.editForm}})],1):t._e()],2)],1)])}),[],!1,null,"97e2b460",null).exports),W=n(257),G=n(45),Y=n(10),K=n(576);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Q={name:"AiChatRight",inject:["aiChatIndex"],mixins:[G.a],props:{isCollapsed:{type:Boolean,default:!1}},filters:{formatNumberForeign:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(Y.p)(t)}},components:{AiChatSettingNew:E,CmtComments:O.default,AiChatAllChatPopup:z,AiChatReport:W.a,AiChatSearchResult:k,ShareChatDialog:K.default},data:function(){return{dotReportInfo:{category:"default",view_domain:"details_one",batch_id:""},models:[],loading:!1,handleConfig:{},showTip:!1}},computed:X(X(X({},Object(_.c)("user",["isLoggedIn"])),Object(_.c)("character",["showSearchResult","characterInfo","isAgentCharacter","isDigitalCharacter"])),{},{renderCharacterName:function(){return Object(d.h)(this,this.characterInfo)}}),methods:X(X({},Object(_.d)("character",["SET_SHOW_SEARCH_RESULT"])),{},{handle:function(t){var e,n=this;switch(t){case"NEWCHAT":null===(e=this.aiChatIndex)||void 0===e||e.newChat();break;case"ALLCHAT":this.$refs.aiChatAllChatPopup.show();break;case"SETTING":this.$logEvent("log_actions",{operation:"click_chat_setting",behavior_info:"on_tarven_detail_page"}),this.$refs.aiChatSettingNew.show();break;case"REPORT":if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog",{callback:function(){return n.aiChatIndex.newChat()}});this.$refs.aiChatReport.open();break;case"INFORMATIONSETTING":this.$EventBus.$emit("openCardManage")}},toggleCollapse:function(){this.SET_SHOW_SEARCH_RESULT(!1),this.$emit("toggle-collapse",!this.isCollapsed)},toViewCharacter:function(){this.$router.push(this.localePath("/cyberPubPage/"+this.characterInfo.id))},share:function(){var t;this.$logEvent("log_actions",{operation:"tavern_on_detail_page",behavior_info:"click_share"});var e=location.host+this.localePath("/cyberPubPage/".concat(this.characterInfo.id)),n=this.renderCharacterName,o=this.characterInfo;this.$refs.shareChatDialog.show(e,null==o||null===(t=o.cover)||void 0===t?void 0:t.url,n,"".concat(n," seaart"))},handleUpdateCountNum:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.aiChatIndex.handleUpdateCountNum(t)},showReportTip:function(t){var e=this;t.stopPropagation(),this.showTip||(this.showTip=!0,setTimeout((function(){document.addEventListener("click",e.hideReportTip)}),0))},hideReportTip:function(t){t&&t.target.closest(".report-tip")||(this.showTip=!1,document.removeEventListener("click",this.hideReportTip))},hideEmojiPanel:function(t){t&&t.target.closest(".icon-emoji")||(this.$refs.cmtComments.showEmojiPanel=!1)},stopClickPropagation:function(t){t.stopPropagation()}}),mounted:function(){var t;document.addEventListener("click",this.hideEmojiPanel),null===(t=document.querySelector(".popover-editor .el-popover"))||void 0===t||t.addEventListener("click",this.stopClickPropagation)},beforeDestroy:function(){var t;document.removeEventListener("click",this.hideReportTip),document.removeEventListener("click",this.hideEmojiPanel),null===(t=document.querySelector(".popover-editor .el-popover"))||void 0===t||t.removeEventListener("click",this.stopClickPropagation)}},Z=Q,tt=(n(5150),Object(v.a)(Z,(function(){var t,e,n,o,r,c,l,d,h,v,f=this,m=f._self._c;return m("div",{staticClass:"sidebar",class:{"is-collapsed":f.isCollapsed},on:{dblclick:function(t){t.stopPropagation()}}},[m("div",{staticClass:"sidebar-header"},[m("div",{staticClass:"collapse-button",on:{click:f.toggleCollapse}},[m("i",{staticClass:"iconfont icon-a-arrowleft"})])]),f._v(" "),m("div",{staticClass:"sidebar-content"},[m("AiChatSearchResult"),f._v(" "),m("div",{staticClass:"comment-drawer-info"},[m("img",{staticClass:"comment-drawer-info-left",attrs:{src:null===(t=f.characterInfo)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.url,alt:null===(e=f.characterInfo)||void 0===e?void 0:e.name},on:{click:f.toViewCharacter}}),f._v(" "),m("div",{staticClass:"comment-drawer-info-right"},[m("h1",{staticClass:"name",on:{click:f.toViewCharacter}},[f._v(f._s(f.renderCharacterName))]),f._v(" "),m("div",{staticClass:"chat-bumber"},[m("i",{staticClass:"iconfont icon-users-solid"}),f._v(" "),m("span",[f._v(f._s(f._f("formatNumberForeign")(null===(n=f.characterInfo)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_token)))])])])]),f._v(" "),m("div",{staticClass:"comment-drawer-2"},[m("span",{staticClass:"comment-btn"},[m("i",{staticClass:"iconfont icon-browse"}),f._v(" "),m("span",{staticClass:"comment-btn-text"},[f._v(f._s(f._f("formatNumberForeign")(null===(o=f.characterInfo)||void 0===o||null===(o=o.stat)||void 0===o?void 0:o.num_of_view)))])]),f._v(" "),1===(null===(r=f.characterInfo)||void 0===r?void 0:r.publish_status)?m("span",{staticClass:"comment-btn",attrs:{"data-event":"ai-chat-collect-btn","data-id":null===(c=f.characterInfo)||void 0===c?void 0:c.id,"data-info":JSON.stringify({isCollection:"icon-collect-gpt"===f.setCollectData(f.characterInfo)})},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),f.setCollect(f.characterInfo,"character")}}},[m("i",{staticClass:"iconfont icon-browse",class:f.setCollectData(f.characterInfo)}),f._v(" "),m("span",{staticClass:"comment-btn-text"},[f._v(f._s(f._f("formatNumberForeign")(null===(l=f.characterInfo)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_collection)))])]):f._e(),f._v(" "),m("span",{staticClass:"comment-btn",attrs:{"data-event":"ai-chat-share-btn","data-id":null===(d=f.characterInfo)||void 0===d?void 0:d.id},on:{click:f.share}},[m("i",{staticClass:"iconfont icon-icon_share"}),f._v(" "),m("span",{staticClass:"comment-btn-text"},[f._v(f._s(f.$t("Share")))])]),f._v(" "),m("span",{staticClass:"comment-btn",attrs:{"data-event":"ai-chat-more-btn","data-id":null===(h=f.characterInfo)||void 0===h?void 0:h.id},on:{click:function(t){return t.stopPropagation(),f.showReportTip.apply(null,arguments)}}},[m("i",{staticClass:"iconfont icon-more"}),f._v(" "),f.showTip?m("div",{staticClass:"report-tip",attrs:{"data-event":"ai-chat-report-btn","data-id":null===(v=f.characterInfo)||void 0===v?void 0:v.id},on:{click:function(t){return t.stopPropagation(),f.handle("REPORT")}}},[m("i",{staticClass:"iconfont icon-icon_report"}),f._v(" "),m("span",[f._v(f._s(f.$t("Report")))])]):f._e()])]),f._v(" "),m("div",{staticClass:"comment-drawer-divider"}),f._v(" "),f.isAgentCharacter?f._e():m("div",{staticClass:"comment-drawer-setting-item chat-setting-btn",attrs:{"data-id":""},on:{click:function(t){return f.handle("SETTING")}}},[m("i",{staticClass:"iconfont icon-icons-setting1"}),f._v(" "),m("span",[f._v(f._s(f.$t("characterSettingChat")))])]),f._v(" "),f.isDigitalCharacter?m("div",{staticClass:"comment-drawer-setting-item info-setting-btn",attrs:{"data-id":""},on:{click:function(t){return f.handle("INFORMATIONSETTING")}}},[m("i",{staticClass:"iconfont icon-a-icon-SetasDefault"}),f._v(" "),m("span",[f._v(f._s(f.$t("aigf_h2_3_pic")))])]):f._e(),f._v(" "),f.characterInfo.id?m("div",{staticClass:"comment-drawer-content"},[m("CmtComments",{ref:"cmtComments",staticClass:"ai-chat-comments dot-group",attrs:{infos:f.characterInfo,type:9,dotReportInfo:f.dotReportInfo},on:{newChat:function(t){return f.handle("NEWCHAT")},updateCountNum:f.handleUpdateCountNum}})],1):f._e()],1),f._v(" "),m("AiChatSettingNew",{ref:"aiChatSettingNew"}),f._v(" "),m("AiChatAllChatPopup",{ref:"aiChatAllChatPopup",attrs:{characterInfo:f.characterInfo},on:{newChat:function(t){return f.handle("NEWCHAT")}}}),f._v(" "),m("AiChatReport",{ref:"aiChatReport",attrs:{aiChatId:f.characterInfo.id}}),f._v(" "),m("ShareChatDialog",{ref:"shareChatDialog"})],1)}),[],!1,null,"53fdf198",null)),et=tt.exports;installComponents(tt,{CmtComments:n(116).default,ShareChatDialog:n(576).default});var it=n(791).a,nt=(n(5151),Object(v.a)(it,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"sidebar",class:{"is-collapsed":t.isCollapsed},attrs:{"data-group":"ai-chat-left-sidebar"},on:{dblclick:function(t){t.stopPropagation()}}},[e("div",{staticClass:"sidebar-fixed-header"},[e("a",{staticClass:"web-logo",class:["release"!==t.envMark&&"canary"],attrs:{href:t.localePath("/"),"data-text":t.envMark},on:{click:function(e){return e.preventDefault(),t.toHome.apply(null,arguments)}}},[e("img",{staticClass:"logo",attrs:{src:t.logo,alt:"SeaArt AI"}})]),t._v(" "),e("div",{staticClass:"collapse-button",on:{click:t.toggleCollapse}},[e("i",{staticClass:"iconfont icon-a-arrowleft"})])]),t._v(" "),e("div",{staticClass:"sidebar-lists-container"},[e("div",{staticClass:"list-section",class:{collapsed:!t.isRecentChatsExpanded}},[e("div",{staticClass:"list-header-box"},[e("div",{staticClass:"list-header-1 list-header",attrs:{"data-event":"ai-chat-recent-chat-toggle"},on:{click:t.toggleRecentChats}},[e("div",{staticClass:"sidebar-title overflow-ellipsis"},[t._v(t._s(t.$t("recChat")))]),t._v(" "),e("i",{staticClass:"icon",class:[t.isRecentChatsExpanded?"el-icon-arrow-up":"el-icon-arrow-right"]})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isRecentChatsExpanded,expression:"isRecentChatsExpanded"}],ref:"chatList",staticClass:"list-content hide-scrollbar",class:{collapsed:!t.isRecentChatsExpanded},on:{scroll:t.handleRecSessionScroll}},[e("div",{staticClass:"new-chat-btn",attrs:{"data-id":""},on:{click:t.handleNewChat}},[t._m(0),t._v(" "),e("span",[t._v(t._s(t.$t("newChat")))])]),t._v(" "),t._l(t.groupedChats,(function(n,o){return[e("div",{key:o,staticClass:"time-group-title"},[t._v(t._s(n.title))]),t._v(" "),t._l(n.items,(function(n,o){var r,c;return e("div",{key:"lastAiChat_"+n.session_id+"_"+o,staticClass:"chat-item-chat",class:{active:n.session_id===t.sessionId},on:{click:function(e){return t.changeAiChat(n)}}},[n.session_title?e("div",{staticClass:"chat-preview overflow-ellipsis session_title"},[t._v("\n              "+t._s(n.session_title)+"\n            ")]):null!==(r=n.latest_msg)&&void 0!==r&&r.content?e("div",{staticClass:"chat-preview overflow-ellipsis session_title",domProps:{innerHTML:t._s(t.formatMsg(n.latest_msg.content,!0))}}):e("div",{staticClass:"chat-preview overflow-ellipsis session_title"},[t._v("\n              "+t._s(t.formatTimestamp(null===(c=n.latest_msg)||void 0===c?void 0:c.create_at))+"\n            ")]),t._v(" "),e("handle-popover",{staticClass:"handle-popover",attrs:{options:t.options,placement:"bottom-start"},on:{moreActions:function(e){return t.moreActions(e,n)}}})],1)}))]})),t._v(" "),t.recentChats.length>0?e("div",{staticClass:"load-more"},[t.loading?e("p",[t._v(t._s(t.$t("Loading"))+"...")]):t._e()]):t._e()],2)]),t._v(" "),t.recentCharacters.length?e("div",{staticClass:"list-section",class:{collapsed:!t.isRecentChatsExpanded}},[e("div",{staticClass:"list-header",on:{click:t.toggleCharacters}},[e("div",{staticClass:"sidebar-title overflow-ellipsis"},[t._v(t._s(t.$t("recentBots")))]),t._v(" "),t.characterUnReadNum?e("span",{staticClass:"title-badge cyber-pub-notification-badge"},[t._v("\n          "+t._s(t.characterUnReadNum)+"\n        ")]):t._e(),t._v(" "),e("i",{staticClass:"icon",class:[t.isCharactersExpanded?"el-icon-arrow-up":"el-icon-arrow-right"]})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isCharactersExpanded,expression:"isCharactersExpanded"}],ref:"characterList",staticClass:"list-content hide-scrollbar",class:{collapsed:!t.isCharactersExpanded},on:{scroll:t.handleCharacterScroll}},[t._l(t.recentCharacters,(function(n,i){var o,r,c,l,d,h,v,f;return e("div",{key:"character_"+i,staticClass:"chat-item",class:{"nsfw-restricted":t.isNsfw(n)},attrs:{"data-id":null==n?void 0:n.id},on:{click:function(e){return t.handleClickCharacter(n)}}},[e("div",{staticClass:"delete-btn",on:{click:function(e){return e.stopPropagation(),t.handleDeleteCharacter(n,i)}}},[e("i",{staticClass:"el-icon-delete"})]),t._v(" "),t.isNsfw(n)?e("div",{staticClass:"avatar nsfw-gradient"},[null!=n&&null!==(o=n.character)&&void 0!==o&&o.unread_num?e("span",{staticClass:"cyber-pub-notification-badge"},[t._v("\n              "+t._s(null==n||null===(r=n.character)||void 0===r?void 0:r.unread_num)+"\n            ")]):t._e()]):n.cover?e("div",{staticClass:"avatar",style:n.cover?{backgroundImage:"url(".concat(n.cover,")")}:{}},[null!=n&&null!==(c=n.character)&&void 0!==c&&c.unread_num?e("span",{staticClass:"cyber-pub-notification-badge"},[t._v("\n              "+t._s(null==n||null===(l=n.character)||void 0===l?void 0:l.unread_num)+"\n            ")]):t._e()]):e("div",{staticClass:"avatar default-avatar"},[t._v("\n            "+t._s(t.getFirstLetter((null===(d=n.character)||void 0===d?void 0:d.name)||(null===(h=n.character)||void 0===h?void 0:h.id)))+"\n          ")]),t._v(" "),e("div",{staticClass:"chat-details"},[e("div",{staticClass:"chat-header"},[t.isNsfw(n)?e("span",{staticClass:"chat-name nsfw-warning"},[t._v(t._s(t.$t("nsfw_content_warning")))]):e("span",{staticClass:"chat-name"},[t._v(t._s(t.renderName(n.character)))]),t._v(" "),e("span",{staticClass:"chat-time"},[t._v(t._s(t.formatTimestampCustom(null===(v=n.character)||void 0===v?void 0:v.latest_time)))])]),t._v(" "),t.isNsfw(n)?t._e():e("div",{staticClass:"chat-preview overflow-ellipsis"},[t._v("\n              "+t._s((null===(f=n.character)||void 0===f?void 0:f.evaluation)||"")+"\n            ")])])])})),t._v(" "),t.recentCharacters.length>0?e("div",{staticClass:"load-more"},[t.loading2?e("p",[t._v(t._s(t.$t("Loading"))+"...")]):t._e()]):t._e()],2)]):t._e()]),t._v(" "),e("ConfirmModal",{ref:"confirmModal",attrs:{dialogWidth:"edit"===t.curHandle?560:462},on:{confirm:t.handleFormSubmit,cancel:t.resetForm}},["edit"===t.curHandle?e("template",{slot:"custom_content"},[e("AiChatEditForm",{ref:"editFormComponent",attrs:{formObj:t.handleForm}})],1):t._e()],2)],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"icon-box"},[t("i",{staticClass:"iconfont icon-xinduihua"})])}],!1,null,"a5f9b9e6",null)),at=nt.exports,st={data:function(){return{isShowPopup:!1,loading:!1,submitEvent:null}},methods:{open:function(t){this.submitEvent=t,this.isShowPopup=!0},close:function(){this.isShowPopup=!1},submit:function(){var t=this;this.loading=!0,this.submitEvent&&this.submitEvent((function(e){t.loading=!1,e&&t.close()}))}}},ot=(n(5152),Object(v.a)(st,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog big-head-dialog allchat-popup reset-chat-popup",attrs:{visible:t.isShowPopup},on:{"update:visible":function(e){t.isShowPopup=e}}},[e("div",{staticClass:"popup-body"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("ResetAiChatTitle")))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:t.close}}),t._v(" "),e("div",{staticClass:"aichat-reset"},[t._v("\n      "+t._s(t.$t("ResetAiChatDesc"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"handle-btn",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",attrs:{type:"default"},on:{click:t.close}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"submit-btn",attrs:{type:"default",loading:t.loading},on:{click:t.submit}},[t._v(t._s(t.$t("ResetChat")))])],1)])}),[],!1,null,"45b8a3de",null).exports),ct=n(39),lt=n(206);n(72),n(89),n(69),n(73),n(22),n(31),n(185),n(218),n(140),n(92),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234);function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vt={name:"AiChatTalkModelSelect",components:{AiChatTalkPopup:$.a},data:function(){return{models:{functionality_list:[],List:[],workflow:[]}}},computed:ht(ht(ht({},Object(_.c)("user",["characterSetting"])),Object(_.c)("character",["characterInfo","isDigitalCharacter"])),{},{currentTalkModelObj:function(){var t=this;return this.models.workflow.find((function(e){return e.workflow_no===t.currentWorkflowId}))||{}},currentWorkflowId:function(){var t,e,n,o,r,c=(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.workflow_no)||!1;return 1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_workflow)&&c?(null===(o=this.characterInfo)||void 0===o?void 0:o.workflow_no)||this.defaultWorkflowNo||"":(null===(r=this.characterSetting)||void 0===r?void 0:r.workflow_no)||this.defaultWorkflowNo||""},defaultWorkflowNo:function(){var t,e;return(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)||(null===(e=this.models)||void 0===e||null===(e=e.workflow)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.workflow_no)||""}}),mounted:function(){this.getModelList()},methods:{handleCloseWorkModel:function(){var t=this,e=this.models.List.find((function(e){return e.gpt_model===t.currentTalkModelObj.highly_recommend}));this.$EventBus.$emit("closeRecModelPopup"),this.$EventBus.$emit("openRecModelPopup",{highModelObj:e})},handleOpenWorkModel:function(){this.$refs.aiChatTalkPopup.show()},getModelList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,data,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(D.u)();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:o=e.t0,data=(r=o||{}).data,1e4===(null==(c=r.status)?void 0:c.code)&&(null==data||null===(n=data.List)||void 0===n?void 0:n.length)>0&&(t.models.functionality_list=(null==data?void 0:data.functionality_list)||[],t.models.List=(null==data?void 0:data.List)||[],t.models.workflow=(null==data?void 0:data.workflow_list)||[]),e.next=14;break;case 11:e.prev=11,e.t1=e.catch(0),console.log("getModels-error",e.t1);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()}}},pt=(n(5153),Object(v.a)(vt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"send-handle-item1 digital-character-item",on:{click:t.handleOpenWorkModel}},[e("i",{staticClass:"digital-character-icon"}),t._v(" "),e("span",[t._v(t._s(t.$t(t.currentTalkModelObj.title_key)))]),t._v(" "),e("AiChatTalkPopup",{ref:"aiChatTalkPopup",on:{change:t.handleCloseWorkModel}})],1)}),[],!1,null,"2102cb40",null).exports),ft=n(696),mt=n(51),gt=n(61),_t=n(25);function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wt={inject:["aiChatBody"],name:"AiChatCardUpdatePopup",components:{CreaCharacterConfirmModal:n(3439).a},data:function(){var t=this;return{genderOption:[{key:"male",label:"informationDialog5"},{key:"femail",label:"informationDialog6"},{key:"anime",label:"informationDialog7"},{key:"other",label:"otherNoPeopel"}],loading:!1,coverImageLoading:!1,UPLOAD:new mt.a({type:51}),accept:".jpg,.jpeg,.png,.webp",isCoverLoading:!1,visible:!1,options:{title:"新增消息",syncTitle:"informationDialog13"},ruleForm:{username:"",like:"",is_default:"",gender:"",extra:"",dislike:"",avatar:{url:"",width:0,height:0},age:"",account_id:""},rules:{username:[{required:!0,message:this.$t("informationDialog19"),trigger:"blur"}],age:[{validator:function(e,n,o){Number(n<18)?o(new Error(t.$t("cardEditAgeError"))):o()},trigger:"blur"}]}}},computed:yt(yt({},Object(_.c)("user",["userInfo"])),Object(_.c)("character",["userCardInfo"])),props:{needSetDefaultUse:Boolean,dialogWidth:{type:Number,default:560}},methods:yt(yt(yt({},Object(_.d)("character",["SET_USER_CARD_INFO"])),Object(_.d)("user",["SET_USER_INFO"])),{},{changeDefault:function(t){var e;this.$logEvent("log_actions",{operation:"informationDialog13"===(null===(e=this.options)||void 0===e?void 0:e.syncTitle)?"click_defalut":"click_update_profile",behavior_info:"on_tarven_detail_page",behavior_info_sub:1===t?"open":"close"})},bindChat:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.$route.query)&&void 0!==n&&n.s_id&&t.aiChatBody.sessionId&&data.id){e.next=2;break}return e.abrupt("return");case 2:o={session_id:t.$route.query.s_id||t.aiChatBody.sessionId,data_card_id:data.id},Object(D.c)(o).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&t.SET_USER_CARD_INFO(data)}));case 4:case"end":return e.stop()}}),e)})))()},show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.resetData(),null!=t&&t.data&&(Object.assign(this.ruleForm,null==t?void 0:t.data),0===this.ruleForm.age&&(this.ruleForm.age=""),0===this.ruleForm.is_default&&(this.ruleForm.is_default="")),this.options=t,this.visible=!0},resetData:function(){this.resetForm(),this.options=null},handleClose:function(){this.resetData(),this.visible=!1},submitForm:function(t){var e=this;this.loading?this.$message.warning(this.$t("code_10405")):this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;var n;e.loading=!0,null!==(n=e.options)&&void 0!==n&&n.data?e.editnformationFn():e.addInformationFn()}))},resetForm:function(){this.ruleForm={username:"",like:"",is_default:"",gender:"",extra:"",dislike:"",avatar:{url:"",width:0,height:0},age:"",account_id:""},this.$refs.ruleForm&&this.$refs.ruleForm.resetFields()},handleDelAvatar:function(){this.ruleForm.avatar.url=""},handleRoleCoverBeforeUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/gif","image/webp"],!e.isCoverLoading){n.next=4;break}return n.abrupt("return");case 4:if(r.includes(t.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 7:if(!(c=t)||c.size){n.next=10;break}return n.abrupt("return",!1);case 10:if(!(t.size/1024/1024>10)){n.next=21;break}return n.prev=11,n.next=14,Object(gt.a)(t,10485760);case 14:c=n.sent,n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(11),console.error("Compression failed:",n.t0),n.abrupt("return");case 21:return n.next=23,e.checkImageSize(c);case 23:if(l=n.sent,e.ruleForm.avatar.url=l.url||"",e.ruleForm.avatar.width=l.realWidth||0,e.ruleForm.avatar.height=l.realHeight||0,!e.isCoverLoading){n.next=29;break}return n.abrupt("return");case 29:return e.isCoverLoading=!0,o.startUpload(c).then((function(t){e.isCoverLoading=!1,e.coverImageLoading=!0,e.ruleForm.avatar.url=t||""})).catch((function(t){e.isCoverLoading=!1,e.coverImageLoading=!1,e.ruleForm.avatar.url="",e.ruleForm.avatar.width=0,e.ruleForm.avatar.height=0,e.$message.error(e.$t("uploadError"))})),n.abrupt("return",!1);case 32:case"end":return n.stop()}}),n,null,[[11,17]])})))()},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},addInformationFn:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,data,v,f,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=Object(m.hb)(t.ruleForm)).account_id=null===(n=t.userInfo)||void 0===n?void 0:n.id,o.age&&(o.age=Number(o.age)),console.log("新增参数-",o),e.prev=4,e.next=7,Object(D.a)(o);case 7:if(c=e.sent,l=c.status,d=void 0===l?{}:l,h=c.data,data=void 0===h?{}:h,10619!==(null==d?void 0:d.code)){e.next=13;break}return t.$message.warning(t.$t("addMore")),t.loading=!1,e.abrupt("return");case 13:if(1e4!==(null==d?void 0:d.code)){e.next=23;break}if(t.$message.success(t.$t("informationDialog17")),!t.needSetDefaultUse){e.next=20;break}return v={id:data.id},Object.assign(v,o),e.next=20,t.bindChat(v);case 20:1===o.is_default&&((f=Object(_t.cloneDeep)(t.userInfo)).character_setting.default_card=data.id,t.SET_USER_INFO(f)),t.handleClose(),t.$emit("updateList");case 23:10618===(null==c||null===(r=c.status)||void 0===r?void 0:r.code)&&(t.errorSubTitle=t.handleChangeString(null==c||null===(_=c.status)||void 0===_?void 0:_.msg),t.$refs.CreaCharacterConfirmModal.show({subTitle:t.errorSubTitle,hideClose:!0})),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(4),console.log("资料卡新增错误-",e.t0);case 29:return e.prev=29,t.loading=!1,e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[4,26,29,32]])})))()},editnformationFn:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,v,f,_,y,w,C,k,O,x,I,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d="datacard"===(null===(n=t.options)||void 0===n?void 0:n.type)||!1,h=D.p,d&&(h=D.r),v=Object(m.hb)(t.ruleForm),f=d?{card:v,session_id:(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o?void 0:o.s_id)||t.aiChatBody.sessionId,sync_main_card:t.ruleForm.is_default||2}:v,null!==(r=t.options)&&void 0!==r&&r.hideAsync&&delete f.sync_main_card,f.age&&(f.age=Number(f.age)),null!==(c=f.card)&&void 0!==c&&c.age&&(f.card.age=Number(f.card.age)),f.account_id=null===(l=t.userInfo)||void 0===l?void 0:l.id,console.log("编辑参数-",f),e.prev=10,e.next=13,h(f);case 13:y=e.sent,w=y.status,C=void 0===w?{}:w,k=y.data,1e4===(null==C?void 0:C.code)&&(t.$message.success(t.$t("informationDialog17")),(null===(O=t.userCardInfo)||void 0===O?void 0:O.id)===(null===(x=f.card)||void 0===x?void 0:x.id)&&d&&t.SET_USER_CARD_INFO(f.card),1!==f.is_default||d||(console.log("手动进行新聊天默认的绑定",f.id),(I=Object(_t.cloneDeep)(t.userInfo)).character_setting.default_card=f.id,t.SET_USER_INFO(I)),t.handleClose(),t.$emit("updateList")),10618===(null==y||null===(_=y.status)||void 0===_?void 0:_.code)&&(t.errorSubTitle=t.handleChangeString(null==y||null===(S=y.status)||void 0===S?void 0:S.msg),t.$refs.CreaCharacterConfirmModal.show({subTitle:t.errorSubTitle,hideClose:!0})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(10),console.log("资料卡编辑错误-",e.t0);case 22:return e.prev=22,t.loading=!1,e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[10,19,22,25]])})))()},handleChangeString:function(t){var e=this;return t.split(",").map((function(t){var n=t.split(":"),o=Object(x.a)(n,1)[0];return"<p>".concat(e.$t("createCharacterTip2",{paramsKey:e.$t(m.O[o])||o}),"</p>")}))}})},Ct=wt,kt=(n(5155),Object(v.a)(Ct,(function(){var t,e,n,o,r,c=this,l=c._self._c;return l("el-dialog",{attrs:{top:"3vh","close-on-click-modal":!1,"close-on-press-escape":!1,visible:c.visible,"custom-class":"aichat-information-modal","lock-scroll":"","destroy-on-close":!1,"modal-append-to-body":"","append-to-body":"",width:c.dialogWidth+"px"},on:{"update:visible":function(t){c.visible=t}}},[l("div",{staticClass:"popup-content"},[l("div",{staticClass:"popup-content-header"},[l("div",{staticClass:"top"},[l("div",{staticClass:"popup-content-header-title overflow-ellipsis"},[c._v(c._s(null===(t=c.options)||void 0===t?void 0:t.title))]),c._v(" "),l("span",{staticClass:"popup-content-header-close",on:{click:function(t){return t.stopPropagation(),c.handleClose.apply(null,arguments)}}},[l("i",{staticClass:"el-icon-close"})])]),c._v(" "),l("div",{staticClass:"popup-content-header-description"},[c._v("\n        "+c._s(c.$t("informationDialog2"))+"\n      ")])]),c._v(" "),l("div",{directives:[{name:"loading",rawName:"v-loading",value:c.loading,expression:"loading"}],staticClass:"popup-content-form-box hide-scrollbar"},[l("el-form",{ref:"ruleForm",staticClass:"popup-content-form",attrs:{"label-position":"top",inline:"",model:c.ruleForm,rules:c.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{prop:"username"}},[l("template",{slot:"label"},[l("div",{staticClass:"custom-label"},[l("div",{staticClass:"symbol"},[c._v("*")]),c._v(" "),l("div",{staticClass:"label"},[l("span",[c._v(c._s(c.$t("informationDialog3")))]),c._v(" "),l("span",[c._v(c._s(c.$t("informationDialog18")))])])])]),c._v(" "),l("el-input",{attrs:{maxlength:"40",placeholder:c.$t("informationDialog19")},model:{value:c.ruleForm.username,callback:function(t){c.$set(c.ruleForm,"username",t)},expression:"ruleForm.username"}},[l("template",{slot:"append"},[c._v(c._s(c.ruleForm.username.length)+"/40")])],2)],2),c._v(" "),l("el-form-item",{attrs:{label:c.$t("informationDialog4")}},[l("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{maxlength:"40"},model:{value:c.ruleForm.avatar.url,callback:function(t){c.$set(c.ruleForm.avatar,"url",t)},expression:"ruleForm.avatar.url"}}),c._v(" "),null!==(e=c.ruleForm.avatar)&&void 0!==e&&e.url?l("div",{staticClass:"img-box"},[l("img",{staticClass:"avatar-img",attrs:{loading:"lazy",src:c.ruleForm.avatar.url,alt:null===(n=c.options)||void 0===n?void 0:n.title},on:{load:function(t){c.coverImageLoading=!1},error:function(t){c.coverImageLoading=!1}}}),c._v(" "),l("i",{staticClass:"del-icon el-icon-error",on:{click:function(t){return t.stopPropagation(),c.handleDelAvatar.apply(null,arguments)}}})]):l("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:c.isCoverLoading,expression:"isCoverLoading"}],key:"add-role-avatar",staticClass:"image-upload",attrs:{action:"#","before-upload":c.handleRoleCoverBeforeUpload,disabled:c.isCoverLoading,accept:c.accept,"http-request":function(){},"show-file-list":!1}},[l("div",{staticClass:"handle-upload",attrs:{slot:"trigger"},slot:"trigger"},[l("i",{staticClass:"iconfont icon-add-tag"})])])],1),c._v(" "),l("el-form-item",{attrs:{label:c.$t("gender"),prop:"gender"}},[l("el-radio-group",{model:{value:c.ruleForm.gender,callback:function(t){c.$set(c.ruleForm,"gender",t)},expression:"ruleForm.gender"}},c._l(c.genderOption,(function(t,e){return l("el-radio",{key:e,attrs:{label:t.key}},[c._v("\n              "+c._s(c.$t(t.label))+"\n            ")])})),1)],1),c._v(" "),l("el-form-item",{attrs:{label:c.$t("informationDialog8"),prop:"age"}},[l("el-input",{attrs:{placeholder:c.$t("inputAge"),maxlength:"8"},on:{input:function(t){c.ruleForm.age=t.replace(/[^\d]/g,"")}},model:{value:c.ruleForm.age,callback:function(t){c.$set(c.ruleForm,"age",t)},expression:"ruleForm.age"}},[l("template",{slot:"append"},[c._v(c._s(String(c.ruleForm.age).length||0)+"/8")])],2)],1),c._v(" "),l("el-form-item",{attrs:{label:c.$t("informationDialog9"),prop:"like"}},[l("el-input",{attrs:{autosize:"",type:"textarea",maxlength:"40","show-word-limit":"",placeholder:c.$t("pleaseEnte")},model:{value:c.ruleForm.like,callback:function(t){c.$set(c.ruleForm,"like",t)},expression:"ruleForm.like"}})],1),c._v(" "),l("el-form-item",{attrs:{label:c.$t("informationDialog10"),prop:"dislike"}},[l("el-input",{attrs:{autosize:"",type:"textarea",maxlength:"40","show-word-limit":"",placeholder:c.$t("pleaseEnte")},model:{value:c.ruleForm.dislike,callback:function(t){c.$set(c.ruleForm,"dislike",t)},expression:"ruleForm.dislike"}})],1),c._v(" "),l("el-form-item",{staticClass:"other-info-form-item",attrs:{label:c.$t("informationDialog11"),prop:"extra"}},[l("el-input",{attrs:{autosize:"",type:"textarea",placeholder:c.$t("informationDialog12"),maxlength:"3000","show-word-limit":""},model:{value:c.ruleForm.extra,callback:function(t){c.$set(c.ruleForm,"extra",t)},expression:"ruleForm.extra"}})],1)],1)],1)]),c._v(" "),l("div",{staticClass:"popup-footer"},[l("div",{staticClass:"default-box"},[null!==(o=c.options)&&void 0!==o&&o.hideAsync?c._e():l("el-checkbox",{attrs:{"true-label":1,"false-label":2,label:c.$t(null===(r=this.options)||void 0===r?void 0:r.syncTitle)},on:{change:c.changeDefault},model:{value:c.ruleForm.is_default,callback:function(t){c.$set(c.ruleForm,"is_default",t)},expression:"ruleForm.is_default"}})],1),c._v(" "),l("span",{staticClass:"popup-footer-btn popup-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),c.submitForm("ruleForm")}}},[c._v(c._s(c.$t("Save")))])]),c._v(" "),l("CreaCharacterConfirmModal",{ref:"CreaCharacterConfirmModal"})],1)}),[],!1,null,"09a6a51d",null)),Ot=kt.exports;function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St={name:"AiChatCardListPopup",components:{AiChatCardUpdatePopup:Ot,ConfirmModal:N.a},inject:["aiChatBody"],data:function(){return{modalWidth:740,useCardIdSelf:"",genderEnum:{male:"informationDialog5",femail:"informationDialog6",anime:"informationDialog7",other:"otherNoPeopel"},loading:!1,manageMenu:[{title:"Edit",icon:"icon-icon-edit2",key:"editCard"},{title:"informationListDialog3",icon:"icon-a-icon-Usethiscard",key:"useCard"},{title:"informationListDialog4",icon:"icon-a-icon-SetasDefault",key:"setDefaultCard"},{title:"Delete",icon:"icon-icon-delete",key:"deleteCard"}],visible:!1,options:{},curIndex:null}},watch:{$route:{handler:function(){}},useCardId:{handler:function(t){this.useCardIdSelf=t},immediate:!0},myCardList:{handler:function(t){t&&t.length>2&&(this.modalWidth=1088),t&&t.length<3&&(this.modalWidth=740)},deep:!0,immediate:!0}},computed:It(It(It({},Object(_.c)("user",["userInfo","isLoggedIn"])),Object(_.c)("character",["userCardInfo","myCardList"])),{},{useCardId:function(){var t;return(null===(t=this.userCardInfo)||void 0===t?void 0:t.id)||""},accountId:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.id},default_card_id:function(){var t;return(null===(t=this.userInfo)||void 0===t||null===(t=t.character_setting)||void 0===t?void 0:t.default_card)||""},titleComputed:function(){var t=this;return function(e){var n=e.action,o=e.item;return"icon-a-icon-SetasDefault"===n.icon?o.id===t.default_card_id?"informationListDialog5":"informationListDialog4":n.title}}}),methods:It(It(It({},Object(_.d)("user",["SET_USER_INFO"])),Object(_.d)("character",["SET_USER_CARD_INFO","SET_MY_CARD_LIST"])),{},{handleClickItem:function(t){this.useCardIdSelf=t},handleSave:function(){var t=this;if(this.useCardIdSelf!==this.useCardId){var e,n={data_card_id:this.useCardIdSelf,session_id:(null===(e=this.$route.query)||void 0===e?void 0:e.s_id)||this.aiChatBody.sessionId},data=this.myCardList.find((function(e){return e.id===t.useCardIdSelf}));this.bindChat(n,data)}this.handleClose()},bindChat:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&Object(D.c)(e).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("informationDialog17")),t.SET_USER_CARD_INFO(data))}))},setDefault:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";Object(D.ab)({default_card_id:e}).then((function(n){var o;if(1e4===(null===(o=n.status)||void 0===o?void 0:o.code)){t.$message.success(t.$t("informationDialog17"));var r=Object(_t.cloneDeep)(t.userInfo);r.character_setting.default_card="-"===e?"":e,t.SET_USER_INFO(r)}}))},confirm:function(data){console.log("confirm",data);var t=data.type,e=void 0===t?"":t,n=data.id,o=void 0===n?"":n;if("Del"===e)this.delInformationFn({id:o})},handleActions:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.key;if("icon-a-icon-SetasDefault"===e.icon)return data.id===this.default_card_id?void this.setDefault():data.id!==this.default_card_id?void this.setDefault(null==data?void 0:data.id):void 0;switch(n){case"editCard":this.$refs.AiChatCardUpdatePopup.show({data:data,title:this.$t("informationDialog20"),syncTitle:"informationDialog13",hideAsync:data.id===this.default_card_id});break;case"useCard":var o={data_card_id:null==data?void 0:data.id,session_id:(null===(t=this.$route.query)||void 0===t?void 0:t.s_id)||this.aiChatBody.sessionId};this.bindChat(o,data);break;case"deleteCard":this.$refs.confirmModal.show({subTitle:this.$t("delInformationDesc"),mainTitle:this.$t("delInformationTitle"),handleMethods:"Del",id:null==data?void 0:data.id})}},handleAdd:function(){this.$logEvent("log_actions",{operation:"click_create_new_profile",behavior_info:"on_tarven_detail_page"}),this.$refs.AiChatCardUpdatePopup.show({data:null,title:this.$t("informationDialog16"),syncTitle:"informationDialog13"})},delInformationFn:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Object(D.k)(t);case 4:o=n.sent,r=o.status,1e4===(null==(c=void 0===r?{}:r)?void 0:c.code)&&(e.getList(),e.$message.success(e.$t("informationDialog17")));case 7:case"end":return n.stop()}}),n)})))()},getList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,data,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.next=5,Object(D.L)({account_id:t.accountId});case 5:n=e.sent,o=n.status,r=void 0===o?{}:o,c=n.data,data=void 0===c?{}:c,1e4===(null==r?void 0:r.code)&&t.SET_MY_CARD_LIST((null==data||null===(l=data.items)||void 0===l?void 0:l.reverse())||[]),t.loading=!1;case 9:case"end":return e.stop()}}),e)})))()},show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.visible=!0,this.getList()},handleClose:function(){this.visible=!1}})},Dt=St,Lt=(n(5156),Object(v.a)(Dt,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{top:"5vh",visible:t.visible,"custom-class":"aichat-information-modal","lock-scroll":"","destroy-on-close":"","modal-append-to-body":"","append-to-body":"","close-on-press-escape":!1,"close-on-click-modal":!1,width:t.modalWidth+"px"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"popup-content-manage"},[e("div",{staticClass:"custom-header"},[e("i",{staticClass:"el-icon-close custom-header-close",on:{click:t.handleClose}}),t._v(" "),e("div",{staticClass:"custom-header-description",attrs:{"data-event":"ai-chat-infomation-modal-add-card"}},[e("span",{staticClass:"left"},[t._v(t._s(t.$t("informationListDialog1")))]),t._v(" "),e("span",{staticClass:"right",on:{click:t.handleAdd}},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",[t._v(t._s(t.$t("informationDialog16")))])])])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"conintar-box hide-scrollbar"},[t.myCardList.length?t._l(t.myCardList,(function(n,o){var r,c,l;return e("div",{key:o,staticClass:"item-box",class:{"item-box-active":n.id===t.useCardIdSelf},on:{click:function(e){return t.handleClickItem(n.id)}}},[e("div",{staticClass:"info-top"},[[null,void 0,""].includes(null==n||null===(r=n.avatar)||void 0===r?void 0:r.url)?e("span",{staticClass:"avatar name-avatar"},[t._v(" "+t._s(n.username.slice(0,1)))]):e("img",{staticClass:"avatar",attrs:{loading:"lazy",src:null==n||null===(c=n.avatar)||void 0===c?void 0:c.url,alt:null==n?void 0:n.username},on:{click:function(e){return t.handleClickItem(n.id)}}}),t._v(" "),[null,void 0,""].includes(null==n||null===(l=n.avatar)||void 0===l?void 0:l.url)?t._e():[e("div",{staticClass:"avatar-background",style:{backgroundImage:"url(".concat(n.avatar.url,")")}},[e("div",{staticClass:"gradient-overlay"})])],t._v(" "),e("div",{staticClass:"left"},[n.id===t.default_card_id&&n.id===t.useCardId?[n.id===t.default_card_id?e("span",{staticClass:"tag"},[t._v(t._s(t.$t("createModeType1")))]):t._e(),t._v(" "),n.id===t.useCardId?e("span",{staticClass:"tag tag-use"},[t._v(t._s(t.$t("useIng")))]):t._e()]:[n.id===t.default_card_id||n.id===t.useCardId?e("span",{staticClass:"tag",class:{"tag-use":n.id===t.useCardId}},[t._v("\n                  "+t._s(t.$t(n.id===t.default_card_id?"createModeType1":"useIng"))+"\n                ")]):t._e()]],2),t._v(" "),e("el-popover",{ref:"myPopover",refInFor:!0,attrs:{trigger:"hover",placement:"bottom-end","popper-class":"popover-information","append-to-body":!1,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"167"}},[e("div",{staticClass:"pop-btns"},t._l(t.manageMenu,(function(o){return e("div",{key:o.key,staticClass:"pop-btns-item",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.handleActions(o,n)}}},[e("i",{staticClass:"iconfont",class:o.icon}),t._v(" "),e("span",{staticClass:"pop-btns-text"},[t._v(t._s(t.$t(t.titleComputed({action:o,item:n}))))])])})),0),t._v(" "),e("i",{staticClass:"el-icon-more",attrs:{slot:"reference"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}},slot:"reference"})])],2),t._v(" "),e("div",{staticClass:"info-box"},[e("div",{staticClass:"info-box-1"},[e("div",{staticClass:"info-box-1-name"},[e("el-tooltip",{attrs:{content:n.username,"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[e("span",{staticClass:"name overflow-ellipsis"},[t._v(t._s(n.username))])])],1),t._v(" "),e("div",{staticClass:"info-box-1-dec"},[e("div",{staticClass:"info-box-1-dec-item"},[e("span",{staticClass:"gender"},[t._v(t._s(t.$t("gender")))]),t._v(" "),e("span",[t._v("\n                    "+t._s(t.genderEnum[n.gender]?t.$t(t.genderEnum[n.gender]):"-")+"\n                  ")])]),t._v(" "),e("div",{staticClass:"info-box-1-dec-item"},[e("span",{staticClass:"gender"},[t._v(t._s(t.$t("AI_person_age")))]),t._v(" "),e("span",[t._v(t._s(n.age||"-"))])])])]),t._v(" "),e("div",{staticClass:"info-box-2"},[e("div",{staticClass:"like-item"},[e("span",[t._v(t._s(t.$t("like")))]),t._v(" "),e("span",{staticClass:"txt txt-over2"},[t._v("\n                  "+t._s(n.like||"-")+"\n                ")])]),t._v(" "),e("div",{staticClass:"like-item like-item-2"},[e("span",[t._v(t._s(t.$t("disLike")))]),t._v(" "),e("span",{staticClass:"txt overflow-ellipsis"},[t._v("\n                  "+t._s(n.dislike||"-")+"\n                ")])])])])])})):t._e()],2)]),t._v(" "),e("div",{staticClass:"manage-list-popup-footer"},[e("span",{staticClass:"manage-list-popup-footer-btn",on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("span",{staticClass:"manage-list-popup-footer-btn manage-list-popup-footer-btn-confirm",on:{click:function(e){return e.stopPropagation(),t.handleSave()}}},[t._v("\n      "+t._s(t.$t("Save"))+"\n    ")])]),t._v(" "),e("AiChatCardUpdatePopup",{ref:"AiChatCardUpdatePopup",on:{updateList:t.getList}}),t._v(" "),e("ConfirmModal",{ref:"confirmModal",on:{confirm:t.confirm}})],1)}),[],!1,null,"29019836",null)),Pt=Lt.exports;function jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tt={name:"AiChatCardManagePopup",inject:["aiChatBody"],components:{ConfirmModal:N.a,AiChatCardUpdatePopup:Ot,AiChatCardListPopup:Pt},data:function(){return{isShowHandle:!1,manageMenu:[{title:"Edit",icon:"icon-icon-edit2"},{title:"Replace",icon:"icon-icon-replace"},{title:"Remove",icon:"icon-icon-Remove"}]}},computed:$t($t($t({},Object(_.c)("user",["userInfo","isLoggedIn"])),Object(_.c)("character",["userCardInfo","myCardList"])),{},{needSetDefaultUse:function(){return!this.myCardList.length},accountId:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.id}}),mounted:function(){this.getList()},methods:$t($t({},Object(_.d)("character",["SET_USER_CARD_INFO","SET_MY_CARD_LIST"])),{},{handleAddInformation:function(){this.myCardList.length?(console.log("挑选"),this.$refs.myInformationPopup.show()):(this.$logEvent("log_actions",{operation:"click_create_profile",behavior_info:"on_tarven_detail_page"}),console.log("新增！"),this.$refs.AiChatCardUpdatePopup.show({data:null,title:this.$t("informationDialog1"),syncTitle:"informationDialog13"}))},getList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,data,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(D.L)({account_id:t.accountId});case 4:n=e.sent,o=n.status,r=void 0===o?{}:o,c=n.data,data=void 0===c?{}:c,1e4===(null==r?void 0:r.code)&&t.SET_MY_CARD_LIST((null==data||null===(l=data.items)||void 0===l?void 0:l.reverse())||[]);case 7:case"end":return e.stop()}}),e)})))()},handleEditInformation:function(){var t,e=this;this.$logEvent("log_actions",{operation:"click_profile_tab",behavior_info:"on_tarven_detail_page"}),Object(D.d)({id:null===(t=this.userCardInfo)||void 0===t?void 0:t.id}).then((function(t){var n;10616===(null===(n=t.status)||void 0===n?void 0:n.code)?e.$refs.AiChatCardUpdatePopup.show({data:e.userCardInfo,title:e.$t("informationDialog14"),hideAsync:!0,type:"datacard"}):e.$refs.AiChatCardUpdatePopup.show({data:e.userCardInfo,title:e.$t("informationDialog14"),syncTitle:"informationDialog15",type:"datacard"})}))},confirm:function(t){var e=t.type;if("Remove"===(void 0===e?"":e))this.removeInformationFn()},handleClickManage:function(title){switch(title){case"Edit":this.$logEvent("log_actions",{operation:"click_edit_profile",behavior_info:"on_tarven_detail_page"}),this.handleEditInformation();break;case"Replace":this.$logEvent("log_actions",{operation:"click_replace_profile",behavior_info:"on_tarven_detail_page"}),this.$refs.myInformationPopup.show();break;case"Remove":this.$logEvent("log_actions",{operation:"click_remove_profile",behavior_info:"on_tarven_detail_page"}),this.$refs.confirmModal.show({subTitle:this.$t("removeInformationTipConfirm"),mainTitle:this.$t("removeInformationTip"),handleMethods:"Remove"})}},removeInformationFn:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.m)({session_id:(null===(n=t.$route)||void 0===n||null===(n=n.query)||void 0===n?void 0:n.s_id)||t.aiChatBody.sessionId});case 2:r=e.sent,1e4===(null===(o=r.status)||void 0===o?void 0:o.code)&&(t.$message.success(t.$t("informationDialog17")),t.SET_USER_CARD_INFO({}));case 4:case"end":return e.stop()}}),e)})))()},hideHandle:function(){this.isShowHandle=!1}})},Mt=(n(5157),Object(v.a)(Tt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideHandle,expression:"hideHandle"}],staticClass:"role-box"},[t.userCardInfo.id?e("div",{staticClass:"current-role",on:{click:t.handleEditInformation}},[e("span",{staticClass:"name overflow-ellipsis"},[t._v("\n      "+t._s(t.userCardInfo.username)+"\n    ")]),t._v(" "),e("div",{staticClass:"more-handle",on:{click:function(e){e.stopPropagation(),t.isShowHandle=!t.isShowHandle}}},[e("i",{staticClass:"el-icon-more"})])]):e("div",{staticClass:"add-tip",on:{click:t.handleAddInformation}},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",[t._v(t._s(t.$t("addInformation")))])]),t._v(" "),e("AiChatCardListPopup",{ref:"myInformationPopup"}),t._v(" "),e("AiChatCardUpdatePopup",{ref:"AiChatCardUpdatePopup",attrs:{needSetDefaultUse:t.needSetDefaultUse},on:{updateList:t.getList}}),t._v(" "),e("ConfirmModal",{ref:"confirmModal",on:{confirm:t.confirm}}),t._v(" "),t.isShowHandle?e("div",{staticClass:"handle-menu"},t._l(t.manageMenu,(function(n,o){return e("div",{key:o,staticClass:"handle-menu-item",on:{click:function(e){return t.handleClickManage(n.title)}}},[e("i",{staticClass:"iconfont",class:n.icon}),t._v(" "),e("span",[t._v(t._s(t.$t(n.title)))])])})),0):t._e()],1)}),[],!1,null,"2894c5be",null).exports),Rt=(n(769),n(65),n(298));function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Bt={name:"AgentHotWorks",components:{EasyTaskImageViewer:Rt.default},inject:["aiChatIndex"],computed:Et(Et({},Object(_.c)("character",["characterInfo"])),{},{isAllLoaded:function(){return!1},agentCharacterHotWorks:function(){var t;return(null===(t=this.characterInfo.agent_simple_image)||void 0===t?void 0:t.length)>0?this.characterInfo.agent_simple_image:[]}}),data:function(){return{bigImgDialogVisible:!1}},watch:{agentCharacterHotWorks:{handler:function(t){var e=this;t.length>0&&t.forEach((function(t,n){void 0===t.loaded&&e.$set(e.agentCharacterHotWorks[n],"loaded",!1)}))},immediate:!0,deep:!0}},methods:{viewBigImage:function(t,e){this.aiChatIndex.showViewImage(t.url)},closeViewBigImage:function(){this.bigImgDialogVisible=!1},handleHotWorkImageLoaded:function(t,e){this.$set(this.agentCharacterHotWorks[e],"loaded",!0)}}},Nt=(n(5158),Object(v.a)(Bt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"agent-character-hot-works"},[n("div",{staticClass:"agent-character-hot-works-title"},[n("i",{staticClass:"iconfont icon-hot_selected"}),e._v("\n    "+e._s(e.$t("agentCharacterHotWorks"))+"\n  ")]),e._v(" "),n("div",{staticClass:"agent-character-hot-works-content"},[e._l(e.agentCharacterHotWorks,(function(t,o){return n("div",{key:t.url+o,staticClass:"agent-character-hot-works-content-wrapper"},[t.loaded?e._e():n("div",{staticClass:"resource-loading-placeholder"},[n("div",{staticClass:"loading-wrapper"},[n("div",{staticClass:"loading-wrapper-inner"},[n("span",{staticClass:"spinner",attrs:{role:"img","aria-label":e.$t("Loading")}},[e._m(0,!0)])])])]),e._v(" "),n("img",{staticClass:"agent-character-hot-works-content-item",class:{"resource-loaded":t.loaded},attrs:{src:t.url,alt:"SeaArt.AI"},on:{click:function(n){return e.viewBigImage(t,o)},load:function(n){return e.handleHotWorkImageLoaded(t,o)}}})])})),e._v(" "),e.isAllLoaded?n("div",{staticClass:"agent-character-hot-works-content-wrapper"},[n("div",{staticClass:"agent-character-hot-works-content-item resource-loaded waiting-for-release"},[e._v("\n        "+e._s(e.$t("gpt_waiting"))+"\n      ")])]):e._e()],2),e._v(" "),e.bigImgDialogVisible?n("EasyTaskImageViewer",{staticClass:"message-img-viewer",attrs:{showChatBtn:!1,nsfw:(null===(t=e.item)||void 0===t?void 0:t.nsfw)||0,"on-close":e.closeViewBigImage,"initial-index":e.currentIndex,"show-operate-btn":!1,message:e.item,hoverBtnRenderList:e.bigImageBtns,"url-list":e.urlList,msgId:e.item.id},on:{imageOperate:e.handleImageOperate,handleAnimate:function(t){return e.handleClick("animGen")},onlyCloseViewer:e.closeViewBigImage}}):e._e()],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),this._v(" "),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"6aefa57c",null)),Ft=Nt.exports;installComponents(Nt,{EasyTaskImageViewer:n(298).default});n(122);function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Vt={name:"AiChatReChatPopup",inject:["aiChatBody"],data:function(){return{isFree:!0,aniLoading:!1,listData:[],loading:!1}},mounted:function(){this.getList()},computed:Ht(Ht({},Object(_.c)("user",["userInfo"])),Object(_.c)("character",["characterInfo","isToolCharacter","sendMessage","isAgentCharacter"])),methods:{handleEdit:function(text){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.aiChatBody.msgChange({text:text,isSend:t})},getList:function(){var t,e,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.listData=[],o&&this.$logEvent("log_actions",{operation:"click_switch",behavior_info:"on_tarven_detail_page"}),!this.ani&&!this.loading){this.aniLoading=o,this.loading=!0;var r={char_name:null===(t=this.characterInfo)||void 0===t?void 0:t.name,messages:this.sendMessage,user_name:this.userInfo.name||(null===(e=JSON.parse(localStorage.getItem("userInfo")))||void 0===e?void 0:e.name),character_type:this.isToolCharacter?2:1};(this.isAgentCharacter?D.X:D.V)(r).then((function(t){var e=t.status,o=void 0===e?{}:e,r=t.data,data=void 0===r?{}:r;if(1e4===o.code){var c;if(n.isAgentCharacter)n.listData=(null==data?void 0:data.map((function(t){return n.$t(t)})))||[];else n.listData=(null==data||null===(c=data.items)||void 0===c?void 0:c.map((function(t){return t.text})))||[];n.aiChatBody.scrollBottom("getReChat")}n.isFree=data.free_times>0,n.loading=!1,n.aniLoading=!1})).catch((function(t){console.log(t),n.loading=!1,n.aniLoading=!1,n.hidePopup()}))}},hidePopup:function(t){t&&t.preventDefault(),this.aiChatBody.closeRecommendMsg(),this.$nextTick((function(){var t=document.querySelector(".aichat-msg .msg-list");t&&(t.scrollTop=t.scrollHeight)}))}}},zt=Vt,Wt=(n(5159),Object(v.a)(zt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hidePopup,expression:"hidePopup"}],staticClass:"bottom-popup"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"inner-box"},[t.loading?t._e():e("i",{staticClass:"el-icon-close",attrs:{"data-event":"ai-chat-re-chat-close"},on:{click:t.hidePopup}}),t._v(" "),e("div",{staticClass:"inner-box-container"},[t.listData.length?e("div",{staticClass:"last-item"},[e("div",{staticClass:"last-item-inner",attrs:{"data-event":"ai-chat-re-chat-refresh"},on:{click:function(e){return t.getList(!0)}}},[e("i",{staticClass:"el-icon-refresh",class:{"ani-class":t.aniLoading}}),t._v(" "),e("span",[t._v(t._s(t.$t("changeit")))]),t._v(" "),t.isFree?e("span",{staticClass:"free"},[t._v(t._s("(".concat(t.$t("aiChatReTip"),")")))]):t._e()])]):t._e(),t._v(" "),t._l(t.listData,(function(n,o){return e("div",{key:o,staticClass:"inner-box-item"},[e("div",{staticClass:"left"},[e("i",{staticClass:"iconfont icon-icon-edit2",on:{click:function(e){return t.handleEdit(n)}}}),t._v(" "),e("div",{staticClass:"line"},[t._v("|")])]),t._v(" "),e("div",{staticClass:"right",on:{click:function(e){return t.handleEdit(n,!0)}}},[t._v("\n          "+t._s(n)+"\n        ")])])}))],2)])])}),[],!1,null,"4bafa3f6",null).exports),qt=n(208),Gt=n(46),Yt=n(85),Kt=n(210);function Jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qt={name:"AgentResourceItem",inject:["aiChatIndex"],props:{currentIndex:{type:Number,default:0},resources:{type:Array,default:function(){return[]}},item:{type:Object,default:function(){}},msgObj:{type:Object,default:function(){}}},components:{EasyTaskImageViewer:Rt.default,auditDialog:Kt.a},watch:{enableNsfwMode:{handler:function(t,e){e&&e!==t&&(this.flag=!0),this.isNsfwHandleMsg&&this.flag&&(this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode)},deep:!0,immediate:!0}},data:function(){return{bigImageBtns:[{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]}],bigImgDialogVisible:!1,dialogVisible:!1,moreActions:d.g,canViewNsfw:!1,flag:!0,hide:!1}},computed:Xt(Xt(Xt(Xt({},Object(_.c)("character",["secondInstructions"])),Object(_.e)("user",["cdnHost","userInfo"])),Object(_.c)("user",["isCompanyAccount","isLoggedIn"])),{},{urlList:function(){var t=this;return this.resources.filter((function(e){return t.isImage(e)})).map((function(t){return Object.assign(t,{url:t.content})}))},hasGeneratingResources:function(){return this.resources.some((function(t){return t.is_generating}))},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)},isNsfwHandleMsg:function(){return 2===this.msgObj.role},getNsfwPlaceholderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var t=this;return function(e){if(!e)return!1;var n="";return 1===e.nsfw||(n=t.checkIsShowViewNsfw&&t.isNsfwHandleMsg?t.handleShowNsfwImageUrl(e):e.content||"",t.getNsfwPlaceholderUrl===n)}},handleShowNsfwImageUrl:function(){var t=this;return function(e){return t.isNsfwPlus(e)&&!t.canViewNsfw?t.getNsfwPlaceholderUrl:e.content||""}},isShowNsfwIcon:function(){var t=this;return function(e){return t.checkIsShowViewNsfw&&t.isNsfwPlus(e)}}}),mounted:function(){this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode},methods:Xt(Xt({},Object(_.d)("user",["SET_USER_INFO"])),{},{handleImageOperate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.log("查看大图里的操作",t,e),"save"===t)return console.log(e,"info-----"),void this.handleVideoSave(e);this.$emit("imageOperate",t,e.operateNumber,e.url),this.closeViewBigImage()},handleVideoHoverBtnLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";switch(t){case"post":n="click_post";break;case"videoUpscale":n="click_superscore";break;case"save":n="click_save";break;case"download":n="click_download"}n&&this.$logEvent("log_actions",{operation:n,behavior_info:"detail"===e?"on_create_flow_work_detail_page":"on_video_create_flow_page"})},viewBigImage:function(t,e){console.log("查看大图",t,this.isShowNsfwBg(t),e),1===t.nsfw||this.isShowNsfwBg(t)||this.aiChatIndex.showViewImage(t.content)},closeViewBigImage:function(){this.bigImgDialogVisible=!1},isShowPopover:function(t){return!1},isImage:function(t){if(!t||!t.content)return!1;var e=Object(d.j)(t.content);return d.b.includes(e)||t.file_ext&&t.file_ext.includes("image")},isVideo:function(t){if(!t||!t.content)return!1;var e=Object(d.j)(t.content);return d.d.includes(e)||t.file_ext&&t.file_ext.includes("video")},previewVideo:function(t,e){console.log("预览视频",t,e)},handleMoreActions:function(t,e){console.log("显示更多操作",t,e);e.task_id,e.content;switch(t){case"AiVideoGeneration":console.log("AI视频生成等后端确认");break;case"Save":this.$message.info("保存等后端确认");break;case"Post":this.$message.info("投稿等后端确认");break;default:console.log("其他操作")}},saveToPersonalCenter:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={folder_no:"default",id:t.task_id},n.prev=1,n.next=4,Object(Gt.easyBatchSaveParams)(o);case 4:1e4===n.sent.status.code&&e.$message.success(e.$t("SaveSuccess")),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),e.$message.error(e.$t("SaveFailed"));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()},getAspectRatioClass:function(t){if(this.resources.length<=2)return"custom-ratio resource-count-".concat(this.resources.length);if(t.file_width&&t.file_height||t.width&&t.height){var e=t.file_width?t.file_width/t.file_height:t.width/t.height;return"custom-ratio ratio-value-".concat(e.toFixed(2))}return"custom-ratio"},handleImageLoaded:function(t,e){this.$emit("updateResourceStatus",{index:e,loaded:!0})},handleImageError:function(t,e){this.$emit("updateResourceStatus",{index:e,loaded:!0})},handleVideoLoaded:function(t,e){this.$emit("updateResourceStatus",{index:e,loaded:!0})},isNsfwPlus:function(t){return t&&t.is_nsfw_plus},settingViewNsfw:function(){var t,e;console.log("设置显示nsfw",this.enableNsfwMode,null===(t=this.userInfo)||void 0===t?void 0:t.is_audit),this.isNsfwHandleMsg&&(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog())},applyNsfw:function(){var t,e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(console.log("设置显示nsfw",n,this.enableNsfwMode,null===(t=this.userInfo)||void 0===t?void 0:t.is_audit),n){var o={};o.nsfw_plus=this.enableNsfwMode?2:1,o.mode=1,o.age_confirm=!0,Object(Yt.c)(o).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully"))})).finally((function(){e.flag=!1;var data=Object(_t.cloneDeep)(e.userInfo);data.is_audit=1,e.SET_USER_INFO(data),e.canViewNsfw=!e.canViewNsfw}))}else this.canViewNsfw=!this.canViewNsfw}})},Zt=Qt,te=(n(5160),Object(v.a)(Zt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"resource-item",class:[e.getAspectRatioClass(e.item)]},[e.item.is_generating?[n("div",{staticClass:"resource-loading-placeholder"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.item.is_generating,expression:"item.is_generating"}],staticClass:"loading-box"})])]:[!1===e.item.loaded?n("div",{staticClass:"resource-loading-placeholder"},[n("div",{staticClass:"loading-wrapper"},[n("div",{staticClass:"loading-wrapper-inner"},[n("span",{staticClass:"spinner",attrs:{role:"img","aria-label":e.$t("Loading")}},[e._m(0)])])])]):e._e(),e._v(" "),e.isImage(e.item)?n("img",{staticClass:"resource-image",class:{"resource-loaded":e.item.loaded,blurBackground:e.isShowNsfwBg(e.item)},attrs:{src:e.item.content,alt:"SeaArt AI"},on:{click:function(t){return e.viewBigImage(e.item,e.currentIndex)},load:function(t){return e.handleImageLoaded(e.item,e.currentIndex)},error:function(t){return e.handleImageError(e.item,e.currentIndex)}}}):e._e(),e._v(" "),e.isShowNsfwIcon(e.item)?n("div",{staticClass:"generate-view-nsfw-plus",on:{click:function(t){return t.stopPropagation(),e.settingViewNsfw.apply(null,arguments)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:e.canViewNsfw,expression:"canViewNsfw"}],staticClass:"iconfont icon-work-hide"}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:!e.canViewNsfw,expression:"!canViewNsfw"}],staticClass:"iconfont icon-work-show"})]):e._e(),e._v(" "),e.isVideo(e.item)?n("video",{staticClass:"resource-video",class:{"resource-loaded":e.item.loaded},attrs:{src:e.item.content,width:e.item.file_width,height:e.item.file_height,autoplay:"",loop:"",muted:"","x5-video-player-type":"h5",playsinline:"",controls:!1},domProps:{muted:!0},on:{click:function(t){return e.previewVideo(e.item,e.currentIndex)},loadeddata:function(t){return e.handleVideoLoaded(e.item,e.currentIndex)}}}):e._e()],e._v(" "),e.isShowPopover(e.item)?n("el-popover",{attrs:{placement:"bottom","popper-class":"user-msg-popover character-3-shandle-popover","visible-arrow":!1,trigger:"click"}},[n("div",{staticClass:"more-actions",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"el-icon-more"})]),e._v(" "),n("div",{staticClass:"pop-content flex"},e._l(e.moreActions,(function(t){return n("div",{key:t.key,staticClass:"pop-btns-item",on:{click:function(n){return e.handleMoreActions(t.key,e.item)}}},[n("span",{staticClass:"pop-btns-text"},[e._v(e._s(e.$t(t.i18nKey)))])])})),0)]):e._e(),e._v(" "),e.bigImgDialogVisible?n("EasyTaskImageViewer",{staticClass:"message-img-viewer",attrs:{showChatBtn:!1,nsfw:(null===(t=e.item)||void 0===t?void 0:t.nsfw)||0,"on-close":e.closeViewBigImage,"initial-index":e.currentIndex,"show-operate-btn":!1,message:e.item,hoverBtnRenderList:e.bigImageBtns,"url-list":e.urlList,msgId:e.item.id},on:{imageOperate:e.handleImageOperate,handleAnimate:function(t){return e.handleClick("animGen")},onlyCloseViewer:e.closeViewBigImage}}):e._e(),e._v(" "),n("auditDialog",{ref:"auditDialog",on:{confirm:e.applyNsfw}})],2)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),this._v(" "),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"62dd5cba",null)),ee=te.exports;installComponents(te,{EasyTaskImageViewer:n(298).default});var ie={name:"AgentResourceList",props:{resources:{type:Array,default:function(){return[]}},msgObj:{type:Object,default:function(){}}},components:{AgentResourceItem:ee},watch:{resources:{handler:function(t){var e=this;this.resourcesData=t,t.forEach((function(t,n){if(void 0===t.loaded&&(e.$set(e.resourcesData[n],"loaded",!1),t.content&&e.isImage(t))){var img=new Image;img.onload=function(){return e.handleResourceStatusUpdate({index:n,loaded:!0})},img.onerror=function(){return e.handleResourceStatusUpdate({index:n,loaded:!0})},img.src=t.content}}))},immediate:!0,deep:!0}},computed:{renderResources:function(){return this.resourcesData},hasGeneratingResources:function(){return this.resourcesData.some((function(t){return t.is_generating}))}},data:function(){return{resourcesData:[]}},methods:{handleResourceStatusUpdate:function(t){var e=t.index,n=t.loaded;this.$set(this.resourcesData[e],"loaded",n),this.addClass(e)},addClass:function(t){var e=this;this.$nextTick((function(){var n=e.$el.querySelectorAll(".resource-item");n[t]&&n[t].classList.add("has-loaded-resource")}))},isImage:function(t){if(!t||!t.content)return!1;var e=Object(d.j)(t.content);return d.b.includes(e)||t.file_ext&&t.file_ext.includes("image")}}},ne=(n(5161),Object(v.a)(ie,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"agent-resource-list",class:{"is-generating":t.hasGeneratingResources}},[e("div",{staticClass:"resource-grid",class:["resource-grid-".concat(Math.min(t.renderResources.length,4))],style:{textAlign:1===t.msgObj.role?"right":"left"}},t._l(t.renderResources,(function(n,o){return e("AgentResourceItem",{key:"resource-".concat((n.task_id||n.content)+o),attrs:{resources:t.renderResources,msgObj:t.msgObj,item:n,currentIndex:o},on:{updateResourceStatus:t.handleResourceStatusUpdate}})})),1)])}),[],!1,null,"ac319e0a",null).exports),ae=n(53);function se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?se(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var re={name:"AgentMsgItem",props:{msgIndex:{type:Number,default:0},msgList:{type:Array,default:function(){return[]}},msg:{type:Object,default:function(){return{}}}},components:{AgentResourceList:ne,LineLoading:qt.default,AiChatReChatPopup:Wt,BaseAvatar:ae.default},data:function(){return{formatMsg:B.a,lastClickTime:0,throttleTime:500}},computed:oe(oe(oe({},Object(_.c)("character",["characterInfo","secondInstructions","msgLoadingOver","userCardInfo"])),Object(_.c)("user",["isLoggedIn","userInfo"])),{},{isImage:function(){var t=this;if(this.msg.file_info&&this.msg.file_info.length>0){var e=["jpg","jpeg","png","webp","gif","bmp","svg"];return this.msg.file_info.some((function(n){var o;if(n.file_path){var r=t.getFileExtension(n.file_path);return e.includes(r)}return e.includes(null===(o=n.file_ext)||void 0===o?void 0:o.toLowerCase())}))}return!1},renderHandleList:function(){return d.a.filter((function(t){return"retry"===t.key})).concat(this.secondInstructions)},renderMsg:function(){var t=this;if(this.msg.json_content&&Array.isArray(this.msg.json_content)&&this.msg.json_content.length>0){var e=[],n=null;return this.msg.json_content.forEach((function(o){if(n&&n.type===o.type&&t.isText(o)){var r=n.type_content[0].content||"",c=o.type_content[0].content||"";n.type_content[0].content=r+c}else 1===t.msg.role&&o.role?e.unshift(JSON.parse(JSON.stringify(o))):e.push(JSON.parse(JSON.stringify(o)));n=e[e.length-1]})),e}return this.handleMsgToJson()},isThinking:function(){return this.msg.loading&&2===this.msg.role&&this.isLastMsg},generatingIng:function(){return!this.msgLoadingOver&&2===this.msg.role&&this.isLastMsg},isLastMsg:function(){return 0===this.msgIndex&&2===this.msg.role&&this.msgList.length>1},isShowHandleBox:function(){return 2===this.msg.role&&!this.generatingIng&&!this.isThinking&&!this.msg.is_first_msg&&this.isLoggedIn},sender:function(){var t={name:"",avatar:""};if(1===this.msg.role){var e=this.userCardInfo,n=e.username,o=void 0===n?"":n,r=e.avatar,c=void 0===r?{url:""}:r,l=this.userInfo,head=l.head,d=l.id,h=l.name;t.avatar=(null==c?void 0:c.url)||head,t.name=o||h||d}else{var v,f;t.avatar=null===(v=this.characterInfo)||void 0===v||null===(v=v.cover)||void 0===v?void 0:v.url,t.name=null===(f=this.characterInfo)||void 0===f?void 0:f.name}return t},userData:function(){var t,e;return(null===(t=this.sender)||void 0===t?void 0:t.name)===(null===(e=this.userInfo)||void 0===e?void 0:e.name)?this.userInfo:this.sender}}),methods:{renderResource:function(t){return t.role&&"file"===t.role?t.content?t.content.split(",").map((function(e){return{content:e,task_id:(new Date).getTime(),is_nsfw_plus:t.is_nsfw_plus||!1,nsfw:t.nsfw||0}})):[]:t.type_content},isText:function(t){return"text"===t.type||"text"===t.role},renderContent:function(t){return t.role&&"text"===t.role?t.content:t.type_content[0].content},isTextContent:function(t){var e,n;return t.role?"text"===t.role:this.isText(t)&&(null===(e=t.type_content)||void 0===e?void 0:e.length)>0&&(null===(n=t.type_content[0])||void 0===n?void 0:n.content)},isTextContentEmpty:function(t){var e,n;return t.role&&"text"===t.role?!t.content:this.isText(t)&&(null===(e=t.type_content)||void 0===e?void 0:e.length)>0&&!(null!==(n=t.type_content[0])&&void 0!==n&&n.content)},isResourceContent:function(t){return"resource"===t.type||"resource"===t.role||"file"===t.role},getFileExtension:function(t){return t?t.split("?")[0].split(".").pop().toLowerCase():""},handleItemClickThrottled:function(t,e){var n=(new Date).getTime();n-this.lastClickTime>this.throttleTime&&(this.lastClickTime=n,this.handleItemClick(t,e))},handleItemClick:function(t,e){console.log("点击操作项",t,e);var n=e.value,o=void 0===n?"":n;switch(t){case"retry":this.$emit("handle",{msg:this.msg,type:"KEEPSAY"});break;case"save":this.$message.info("保存等后端确认");break;case"post":this.$message.info("投稿等后端确认");break;case"custom_instruction":this.$emit("handle",{msg:this.msg,type:"CUSTOM_INSTRUCTION",inputValue:this.$t(o)})}},handleMsgToJson:function(){if(1===this.msg.role){if(this.msg.file_info&&this.msg.file_info.length>0){var t=[],e=this.msg.file_info.map((function(t){return{content:t.file_path,task_id:t.task_id,is_nsfw_plus:t.is_nsfw_plus||!1,nsfw:t.nsfw||0}}));return t.push({type:"resource",type_content:e}),this.msg.content&&t.push({type:"text",type_content:[{content:this.msg.content}]}),t}return[{type:"text",type_content:[{content:this.msg.content||""}]}]}if(console.log("格式化json格式的消息--",this.msg),!this.msg.file_info||!this.msg.file_info.length)return console.log("没有资源",this.msg),[{type:"text",type_content:[{content:this.msg.content}]}];for(var n,o=this.msg,content=o.content,r=o.file_info,c=[],l=/resource_index=(\d+)/g,d=[];null!==(n=l.exec(content));)d.push({index:n.index,length:n[0].length,position:parseInt(n[1])});if(0===d.length)return[{type:"text",type_content:[{content:content}]}];d.sort((function(a,b){return a.index-b.index}));for(var h=0,v=function(){var t=d[i];if(t.index>h){var e=content.substring(h,t.index);e.trim()&&c.push({type:"text",type_content:[{content:e}]})}var n=r.filter((function(e){return e.position===t.position}));if(n.length>0){var o=n.map((function(t){return{content:t.file_path,task_id:t.task_id,is_generating:t.is_generating||!1,nsfw:t.nsfw||0,is_nsfw_plus:t.is_nsfw_plus||!1}}));c.push({type:"resource",type_content:o})}h=t.index+t.length},i=0;i<d.length;i++)v();if(h<content.length){var f=content.substring(h);f.trim()&&c.push({type:"text",type_content:[{content:f}]})}return c}}},ce=(n(5162),Object(v.a)(re,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"agent-msg-item",class:{"agent-msg-item-my":1===t.msg.role,"agent-msg-item-recommend":t.msg.recommend},style:{paddingBottom:t.isLastMsg?"50px":0}},[t.msg.recommend?t._e():[t.isThinking||t.generatingIng?e("div",{staticClass:"thinking-box"},[t._v("\n      "+t._s(t.$t(t.isThinking?"thinking":"photography37"))+"\n      "),e("span",{staticClass:"thinking-box-time"},[t._v(t._s(t.isThinking?"":"..."))])]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isThinking,expression:"!isThinking"}],staticClass:"msg-render-box"},[e("div",{staticClass:"msg-sender",class:{"agent-avatar-bottom":2===t.msg.role}},[e("BaseAvatar",{attrs:{"user-data":t.userData,name:t.sender.name,size:28,theme:"dark"}})],1),t._v(" "),e("div",{staticClass:"msg-content-wrapper"},t._l(t.renderMsg,(function(n,o){return e("div",{key:n.type+"_"+o,staticClass:"msg-render-item",class:{"msg-render-item-text":t.isText(n)}},[t.isTextContent(n)?e("div",{staticClass:"msg-text",domProps:{innerHTML:t._s(t.formatMsg(t.renderContent(n)))}}):t._e(),t._v(" "),t.isTextContentEmpty(n)?e("div",{staticClass:"msg-text"},[t._v("\n            "+t._s(t.$t("audioCreateFail"))+"\n          ")]):t._e(),t._v(" "),t.isResourceContent(n)?e("AgentResourceList",{attrs:{msgObj:t.msg,resources:t.renderResource(n)}}):t._e()],1)})),0)])],t._v(" "),t.msg.recommend?[e("AiChatReChatPopup")]:t._e(),t._v(" "),t.isShowHandleBox?e("div",{staticClass:"handle-box"},t._l(t.renderHandleList,(function(n,o){return e("div",{key:n.key+"_"+o,staticClass:"handle-item",on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()},click:function(e){return e.stopPropagation(),t.handleItemClickThrottled(n.key,n)}}},[n.icon?e("i",{staticClass:"iconfont",class:n.icon}):t._e(),t._v(" "),e("span",[t._v(t._s(t.$t(n.i18nKey)))])])})),0):t._e()],2)}),[],!1,null,"9c3d9b82",null)),le=ce.exports;installComponents(ce,{BaseAvatar:n(53).default});var ue={name:"AiChatFileMsg",props:{hasContent:{type:Boolean,default:!0},fileMsgList:{type:Array,default:function(){return[]}}},data:function(){return{defaultFileIcon:n(244)}},computed:{maxHeight:function(){return this.fileMsgList.length>3}},methods:{getFileIcon:function(t){if(!t)return this.defaultFileIcon;var e=t.substring(t.lastIndexOf(".")+1).toLowerCase(),n=m.Q[e]||e||"unknown";return m.R[n]&&m.R[n].success?m.R[n].success:this.defaultFileIcon},formatFileSize:function(t){return t||0===t?t<1024?t+"B":t<1048576?(t/1024).toFixed(2)+"KB":(t/1048576).toFixed(2)+"MB":""},handleDownload:function(t){if(t.file_path){var link=document.createElement("a");link.href=t.file_path,link.download=t.file_name,link.target="_blank",document.body.appendChild(link),link.click(),document.body.removeChild(link)}else this.$message.error(this.$t("downloadFailed")||"Download failed: File path not available")}}},de=(n(5163),Object(v.a)(ue,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ai-chat-file-msg",class:{"ai-chat-file-msg-max-height":t.maxHeight,"no-content":!t.hasContent}},[e("div",{staticClass:"ai-chat-file-msg-list"},t._l(t.fileMsgList,(function(n){return e("div",{key:n.file_id,staticClass:"ai-chat-file-msg-item"},[e("img",{staticClass:"file-img",attrs:{src:t.getFileIcon(n.file_name),alt:"searArt.AI"}}),t._v(" "),e("div",{staticClass:"file-info"},[e("div",{staticClass:"file-name"},[t._v(t._s(n.file_name))]),t._v(" "),e("div",{staticClass:"file-size"},[t._v(t._s(t.formatFileSize(n.file_size)))])])])})),0)])}),[],!1,null,"a8aaf740",null).exports),he=n(411),ve=n(5164);function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var me={props:{hasSubMsg:{type:Boolean,default:!1},msg:{type:Object,default:function(){return{loading:!1}}},getVoiceParams:{type:Object,default:function(){return{}}}},watch:{"getVoiceParams.timbre_id":{handler:function(t){this.timbre_id=t,this.voiceUrl=""}},"msg.loading":{handler:function(t){t&&this.resetDuration()},immediate:!0}},data:function(){return{audioPlayer:null,duration:void 0,voiceLoading:!1,isPlaying:!1,customClass:"line-scale-audio",timbre_id:"",voiceUrl:null}},mounted:function(){var t=this;this.$EventBus.$on("stopAudio",(function(){console.log("BUS-stopAudio"),t.voiceUrl=null,t.stopAudio()}))},beforeDestroy:function(){this.$EventBus.$off("stopAudio"),this.stopAudio()},components:{LineLoading:qt.default,selectSoundModel:he.a},computed:fe(fe(fe(fe(fe({},Object(_.e)("payment",["paymentInfo"])),Object(_.c)("user",["cdnHostFun","isCompanyAccount","isLoggedIn"])),Object(_.e)("user",["token"])),Object(_.c)("character",["sessionId","characterInfo","currentTimbreObj"])),{},{playTime:function(){var t;return Math.floor(null===(t=this.audioPlayer)||void 0===t||null===(t=t.audioPlayer)||void 0===t?void 0:t.scheduledTime)||0},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},voiceDurationResult:function(){return this.duration||this.playTime}}),methods:fe(fe(fe({},Object(_.b)("payment",["getPaymentInfo"])),Object(ve.mapMutations)("character",["SET_CURRENT_TIMBRE_OBJ"])),{},{resetDuration:function(){this.duration=void 0},playAudio:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.voiceUrl){e.next=2;break}return e.abrupt("return");case 2:if(t.audioPlayer=t.$createAudioPlayer(t.voiceUrl,t.updateStatus),e.prev=3,!t.audioPlayer){e.next=7;break}return e.next=7,t.audioPlayer.start();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t.$message.warning(t.$t("soundPlayFail"));case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))()},stopAudio:function(){this.audioPlayer&&this.audioPlayer.stop()},updateStatus:function(t,e){if(console.log("updateStatus",t,e),"over"!==e&&"start"!==e&&"error"!==t&&"error"!==e||(this.voiceLoading=!1),"error"===t||"error"===e)return this.isPlaying=!1,void this.$message.warning(this.$t("soundPlayFail"));this.isPlaying=t},handleClickPlay:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$logEvent("log_actions",{operation:"click_audio_broadcast",behavior_info:"on_tavern_chat_page"}),t.isLoggedIn){e.next=4;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 4:if(!t.voiceLoading){e.next=8;break}return t.voiceLoading=!1,t.stopAudio(),e.abrupt("return");case 8:if(t.getVoiceParams.timbre_id){e.next=11;break}return null===(n=t.$refs.selectSoundModel)||void 0===n||n.openModal(),e.abrupt("return");case 11:if(!t.isPlaying){e.next=14;break}return t.stopAudio(),e.abrupt("return");case 14:if(!t.voiceUrl||t.hasSubMsg){e.next=19;break}t.voiceLoading=!0,t.playAudio(),e.next=21;break;case 19:return e.next=21,t.getTts();case 21:case"end":return e.stop()}}),e)})))()},updateTts:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.voiceUrl||(t.timbre_id=t.getVoiceParams.timbre_id),t.voiceUrl&&!t.isPlaying&&(t.timbre_id=t.getVoiceParams.timbre_id,t.voiceUrl="");case 2:case"end":return e.stop()}}),e)})))()},selectModel:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$refs.selectSoundModel.handleClose(),n.next=3,e.updateTimbreObj(t.timbre||{});case 3:return e.timbre_id=t.id,e.voiceUrl="",n.next=7,e.getTts();case 7:case"end":return n.stop()}}),n)})))()},updateTimbreObj:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===(o=e.currentTimbreObj)||void 0===o?void 0:o.id)!==t.id){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,e.bindVoiceToSeeion(t||{});case 4:case"end":return n.stop()}}),n)})))()},bindVoiceToSeeion:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isLoggedIn){n.next=3;break}return e.$EventBus.$emit("openLoginDialog"),n.abrupt("return");case 3:return n.next=5,Object(D.bb)({session_id:e.sessionId,timbre_id:t.id});case 5:e.SET_CURRENT_TIMBRE_OBJ(t.timbre);case 6:case"end":return n.stop()}}),n)})))()},getTts:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.voiceLoading=!0,e.prev=1,n=JSON.parse(JSON.stringify(t.getVoiceParams)),t.timbre_id&&(n.timbre_id=t.timbre_id),e.next=6,Object(D.db)(n);case 6:1e4===(o=e.sent).status.code?(t.voiceUrl=o.data.url||"",t.duration=o.data.duration,t.getPaymentInfo(),t.playAudio()):(r={70039:["showVipComputingDialog","vipDialogComputedTit2"],70010:["showBreakDialog","VipTip","basic"],80008:t.isVip?["showVipComputingDialog"]:["showNotVipComputingDialog"]},o.status.code&&r[o.status.code]&&(c=t.$EventBus).$emit.apply(c,Object(I.a)(r[o.status.code])),t.voiceLoading=!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.$message.warning(t.$t("soundPlayFail")),t.voiceLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()}})},ge=(n(5165),Object(v.a)(me,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"audio-player-fcc",attrs:{"data-id":n.msg.id},on:{click:n.handleClickPlay}},[o("div",{staticClass:"icon-container"},[n.msg.loading||n.voiceLoading?o("i",{staticClass:"el-icon-loading"}):[o("i",{directives:[{name:"show",rawName:"v-show",value:!n.isPlaying,expression:"!isPlaying"}],staticClass:"custom-play-btn"}),n._v(" "),o("line-loading",{directives:[{name:"show",rawName:"v-show",value:n.isPlaying,expression:"isPlaying"}],attrs:{customClass:n.customClass,count:7}}),n._v(" "),n.voiceDurationResult?o("div",{staticClass:"mill",style:{marginLeft:n.isPlaying?"21px":"11px"}},[o("span",[n._v(n._s(n.voiceDurationResult))]),n._v(" "),o("span",[n._v('"')])]):n._e()]],2),n._v(" "),o("selectSoundModel",{ref:"selectSoundModel",attrs:{selectList:null!==(t=n.getVoiceParams)&&void 0!==t&&t.timbre_id?[null===(e=n.getVoiceParams)||void 0===e?void 0:e.timbre_id]:[]},on:{selectModel:n.selectModel}})],1)}),[],!1,null,"70e5ee53",null).exports),_e=n(3473);function be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ye(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?be(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var we={components:{LineLoading:qt.default,AudioPlayer:ge,AiChatReChatPopup:Wt,BaseAvatar:ae.default,AiChatFileMsg:de},inject:["aiChatIndex","aiChatBody"],props:{isShowCheckModelBtn:Boolean,mainMsgContent:{type:Object,default:function(){return{id:""}}},msg:{type:Object,default:function(){return{}}},value:{type:String,default:""},isFirst:{type:Boolean,default:!1},isLastAi:{type:Boolean,default:!1},hasSubMsg:{type:Boolean,default:!1},currentSubMsgIndex:{type:Number,default:0}},data:function(){return{formatMsg:B.a,env:"production",msgText:"",contentWidth:0}},filters:{shortName:function(t){return t?t[0]:""}},computed:ye(ye(ye({},Object(_.c)("user",["isCompanyAccount","userInfo","isLoggedIn"])),Object(_.c)("character",["showSearchResult","characterInfo","isToolCharacter","userCardInfo"])),{},{isShowDeleteBtn:function(){return 1===this.msg.role&&this.msg.id&&this.isLoggedIn},isEditStatus:function(){return 1===this.msg.role?this.value===this.msg.id:this.value===this.msg.id&&this.msgList.length>1},isDisableMsg:function(){return 3===this.msg.status||this.msg.isDisabled},isShowThinking:function(){return this.msg.loading&&!this.isShowOnlineSearch&&this.isDeepSeekR1Model&&this.isLastAi},isShowDeepSeekTime:function(){var t;return!this.msg.loading&&this.msg.deepseek_time&&this.isLastAi&&!(null!==(t=this.msg.search_results)&&void 0!==t&&t.length)},isShowOnlineSearch:function(){var t;return!this.msg.loading&&(null===(t=this.msg.search_results)||void 0===t?void 0:t.length)},isShowMsgBody:function(){return 2===this.msg.role||""!==this.msg.content},isShowFileMsg:function(){var t;return(null===(t=this.msg.file_info)||void 0===t?void 0:t.length)&&1===this.msg.role&&1===this.msg.is_active_upload},renderedDsContent:function(){return Object(_e.a)(this.msg.content)},isDeepSeekMsg:function(){return 1!==this.msg.role&&1!==this.msg.is_first_msg&&this.isToolCharacter},isShowCheckModel:function(){return this.isShowCheckModelBtn&&!this.msg.isAbort},isDeepSeekR1Model:function(){return"Deepseek-R1"===this.aiChatBody.currentUseChatModel},showToolResult:function(){return this.isToolCharacter&&2===this.msg.role},bgImg:function(){var t,e=(null===(t=this.aiChatIndex.characterInfo)||void 0===t?void 0:t.vision)||{},n=e.bg,o=e.character;return(null==n?void 0:n.url)||(null==o?void 0:o.url)||""},isShowRegenerateBtn:function(){return this.isLastAi&&this.msg.id&&this.isLoggedIn},isShowEditBtn:function(){return 2===this.msg.role?this.msg.id&&this.value!==this.msg.id&&this.isLoggedIn&&this.isLastAi:this.msg.id&&this.value!==this.msg.id&&this.isLoggedIn},msgLoadingOver:function(){return this.aiChatBody.msgLoadingOver},isNeedPadding:function(){return this.isLastAi||1===this.msgList.length},msgList:function(){return this.aiChatBody.renderMsgList||[]},showVoiceIcon:function(){var t=void 0===this.msg.showVoice||this.msg.showVoice;return 2===this.msg.role&&!this.msg.isAbort&&t},sender:function(){var t={name:"",avatar:""};if(1===this.msg.role){var e=this.userCardInfo,n=e.username,o=void 0===n?"":n,r=e.avatar,c=void 0===r?{url:""}:r,l=this.userInfo,head=l.head,d=l.id,h=l.name;t.avatar=(null==c?void 0:c.url)||head,t.name=o||h||d}else{var v,f;t.avatar=null===(v=this.characterInfo)||void 0===v||null===(v=v.cover)||void 0===v?void 0:v.url,t.name=null===(f=this.characterInfo)||void 0===f?void 0:f.name}return t},isHandle:function(){var t=this.msg,e=t.loading,n=t.id;return!e&&"number"!=typeof n&&!this.isFirst&&this.msgLoadingOver&&!this.msg.content.includes("10403")&&!this.msg.isAbort&&this.isLoggedIn},userData:function(){var t,e;return(null===(t=this.sender)||void 0===t?void 0:t.name)===(null===(e=this.userInfo)||void 0===e?void 0:e.name)?this.userInfo:this.sender}}),methods:ye(ye({},Object(_.d)("character",["SET_SHOW_SEARCH_RESULT","SET_SEARCH_RESULTS"])),{},{openSearchList:function(){this.SET_SEARCH_RESULTS(this.msg.search_results),this.aiChatIndex.rightCollapsed=!1,this.SET_SHOW_SEARCH_RESULT(!0)},handleChangeModel:function(){this.$logEvent("log_actions",{operation:"click_switch_model",behavior_info:"on_tarven_detail_page"}),this.$emit("handleChangeModel")},copyMsg:function(){this.$logEvent("log_actions",{operation:"tavern_on_chat_detail_page",behavior_info:"click_copy"}),Object(Y.g)(this.msg.content),this.$message.success(this.$t("CopySuccess"))},delMsg:function(){this.$logEvent("log_actions",{operation:"tavern_on_chat_detail_page",behavior_info:"click_delete_chat"}),this.$emit("handle",{msg:this.msg,type:"DEL"})},changeMsgEdit:function(t){var e=this;if(console.log("changeMsgEdit",t),t){var n=this.$el.querySelector(".msg-content");n&&(this.contentWidth=n.clientWidth)}t===this.msg.id&&(this.msgText=this.msg.content),this.$emit("input",t),this.$nextTick((function(){if(t&&e.contentWidth){var textarea=e.$el.querySelector(".el-textarea__inner");textarea&&(textarea.style.width=e.contentWidth+"px")}}))},handleEditCancel:function(){this.contentWidth=0,this.$emit("input","")},editMsg:function(){var t,e,n,o,r=this;this.$logEvent("log_actions",{operation:"tavern_on_chat_detail_page",behavior_info:"click_edit"});var c={id:null!==(t=this.msg)&&void 0!==t&&null!==(t=t.sub_msg)&&void 0!==t&&t.length?null===(e=this.mainMsgContent)||void 0===e?void 0:e.id:null===(n=this.msg)||void 0===n?void 0:n.id,message:this.msgText,session_id:(null===(o=this.$route.query)||void 0===o?void 0:o.s_id)||this.aiChatBody.sessionId,parent_id:this.getParentId()};this.hasSubMsg&&(c.active_idx=this.currentSubMsgIndex),Object(D.o)(c).then((function(t){var e=JSON.parse(JSON.stringify(r.msg));e.content=r.msgText,r.changeMsgEdit(""),r.hasSubMsg&&(e.subMsgIndex=r.currentSubMsgIndex),r.$emit("handle",{msg:e,type:"EDIT"}),2===r.msg.role&&r.$refs.player&&r.$refs.player.updateTts()}))},getParentId:function(){var t,e,n=this,o=this.msgList.findIndex((function(t){return t.id===n.msg.id})),r=this.msg.id;if(1===(null===(t=this.msgList[o+1])||void 0===t?void 0:t.role))r=this.msgList[o+1].id;else if(null!==(e=this.msg.sub_msg)&&void 0!==e&&e.length){var c;r=null===(c=this.mainMsgContent)||void 0===c?void 0:c.id}return r},regenerateMsg:function(){var t=JSON.parse(JSON.stringify(this.msg));this.hasSubMsg&&(t.subMsgIndex=this.currentSubMsgIndex),this.$emit("handle",{msg:t,type:"REGENERATE"}),2===this.msg.role&&this.$refs.player&&this.$refs.player.updateTts()}})},Ce=(n(5166),Object(v.a)(we,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"msg-item-box",class:{"msg-item-box-padding":n.isNeedPadding}},[n.msg.coin?o("div",{staticClass:"msg-item-cost",class:{"msg-item-cost-right":1===n.msg.role}},[n._v("\n    "+n._s("Cost: - ".concat(n.msg.coin||"-"))+"\n    "),n.env.includes("production")?n._e():o("span",[n._v(n._s("Token: ".concat(n.msg.num_of_token||"-")))])]):n._e(),n._v(" "),n.isShowFileMsg?o("AiChatFileMsg",{attrs:{fileMsgList:n.msg.file_info,hasContent:""!==n.msg.content}}):n._e(),n._v(" "),o("div",{staticClass:"msg-item",class:{"my-msg":1===n.msg.role,"edit-item":n.isEditStatus}},[o("div",{staticClass:"msg-sender",class:{"sender-name":!(null!==(t=n.sender)&&void 0!==t&&t.avatar)},style:{marginTop:2===n.msg.role?"54px":"0"}},[o("BaseAvatar",{attrs:{"user-data":n.userData,name:n.sender.name,size:28,theme:"dark"}})],1),n._v(" "),o("div",{staticClass:"msg-body-box"},[o("div",{staticClass:"audio-model-box"},[n.showVoiceIcon?o("AudioPlayer",n._g(n._b({ref:"player",attrs:{hasSubMsg:n.hasSubMsg,getVoiceParams:{msg_id:n.msg.id||n.mainMsgContent.id,sub_msg_id:n.msg.sub_msg_id,timbre_id:n.characterInfo.timbre_id},msg:n.msg}},"AudioPlayer",n.$attrs,!1),n.$listeners)):n._e(),n._v(" "),n.isShowCheckModel?o("div",{staticClass:"audio-model-btn",attrs:{"data-id":n.msg.id},on:{click:n.handleChangeModel}},[o("i",{staticClass:"iconfont icon-a-changingmodel"}),n._v(" "),o("span",[n._v(n._s(n.$t("characterSettingModelChange")))])]):n._e(),n._v(" "),n.showToolResult?[n.isShowThinking?o("div",{staticClass:"audio-model-btn deepseek-time"},[o("i",{staticClass:"iconfont icon-sikao icon-sikao-animation"}),n._v(" "),o("div",[n._v(n._s(n.$t("thinking")))])]):n._e(),n._v(" "),n.isShowDeepSeekTime?o("div",{staticClass:"audio-model-btn deepseek-time"},[o("i",{staticClass:"iconfont icon-sikao"}),n._v(" "),o("div",[n._v(n._s(n.$t("hasThink",{time:n.msg.deepseek_time||0})))])]):n._e(),n._v(" "),n.isShowOnlineSearch?o("div",{staticClass:"audio-model-btn deepseek-time",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),n.openSearchList.apply(null,arguments)}}},[o("i",{staticClass:"iconfont icon-lianwang"}),n._v(" "),o("div",[n._v(n._s(n.$t("searchResults",{count:n.msg.search_results.length})))]),n._v(" "),o("i",{staticClass:"iconfont icon-jiantou1 icon-jiantou1-animation"})]):n._e()]:n._e()],2),n._v(" "),n.msg.recommend?[o("AiChatReChatPopup")]:[o("div",{staticClass:"msg-body"},[o("div",{staticClass:"sender-name"},[n._v(n._s(null===(e=n.sender)||void 0===e?void 0:e.name))]),n._v(" "),n.isHandle?o("span",{staticClass:"handle-icon"},[n.isShowRegenerateBtn?o("i",{staticClass:"el-icon-refresh",on:{click:n.regenerateMsg}}):n._e(),n._v(" "),n.isShowEditBtn?o("i",{staticClass:"el-icon-edit",on:{click:function(t){return n.changeMsgEdit(n.msg.id)}}}):n._e()]):n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isEditStatus,expression:"!isEditStatus"}],class:{"msg-content-disable":n.isDisableMsg,"msg-content":!n.isDeepSeekMsg,"msg-content-deepseek":n.isDeepSeekMsg},domProps:{innerHTML:n._s(n.isDeepSeekMsg?n.renderedDsContent:n.formatMsg(n.msg.content))}}),n._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:n.isEditStatus,expression:"isEditStatus"}],staticClass:"msg-textarea",attrs:{type:"textarea",autosize:{minRows:2,maxRows:10}},model:{value:n.msgText,callback:function(t){n.msgText=t},expression:"msgText"}}),n._v(" "),n.msg.loading?o("line-loading"):n._e()],1)]],2),n._v(" "),n.isHandle&&!n.isEditStatus?o("div",{staticClass:"msg-handle",style:{marginTop:"auto"}},[[o("span",{staticClass:"icon-box"},[o("i",{staticClass:"el-icon-copy-document",on:{click:n.copyMsg}})]),n._v(" "),n.isShowDeleteBtn?o("span",{staticClass:"icon-box"},[o("i",{staticClass:"el-icon-delete",on:{click:n.delMsg}})]):n._e()]],2):n._e(),n._v(" "),n.isHandle&&n.isEditStatus?o("div",{staticClass:"msg-handle msg-handle-edit",style:{marginTop:"auto"}},[[o("span",{staticClass:"icon-box success-icon"},[o("i",{staticClass:"el-icon-check",on:{click:n.editMsg}})]),n._v(" "),o("span",{staticClass:"icon-box"},[o("i",{staticClass:"el-icon-close",on:{click:function(t){return n.changeMsgEdit("")}}})])]],2):n._e()]),n._v(" "),n._t("extendedArea")],2)}),[],!1,null,"0b451322",null)),ke=Ce.exports;installComponents(Ce,{BaseAvatar:n(53).default});function Oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var xe={name:"AiChatFeedBackButtons",data:function(){return{btnOptions:[{label:"characterEvaluateBetter",score:5,icon:"icon-like1"},{label:"characterEvaluateSame",score:3,icon:"icon-generally"},{label:"characterEvaluateWorse",score:1,icon:"icon-a-nolike"}]}},props:{msg:{type:Object,default:function(){}},currentSubMsgIndex:{type:Number,default:1},id:{type:String,default:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(_.c)("user",["userInfo"])),mounted:function(){this.$emit("scrollBottom")},methods:{closeFeedback:function(){this.$emit("close",this.msg)},submitFeedback:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("提交评价！",null===(o=e.userInfo)||void 0===o||null===(o=o.character_setting)||void 0===o?void 0:o.gpt_model),n.next=3,Object(D.U)({idx:e.currentSubMsgIndex,message_id:e.id,model_id:null===(r=e.userInfo)||void 0===r||null===(r=r.character_setting)||void 0===r?void 0:r.gpt_model,score:t});case 3:l=n.sent,1e4===(null===(c=l.status)||void 0===c?void 0:c.code)?(e.$message.success(e.$t("OperateSuccess")),e.closeFeedback()):e.$message.error(e.$t("taskOperateFailed"));case 5:case"end":return n.stop()}}),n)})))()}}},Ie=xe,Se=(n(5167),Object(v.a)(Ie,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeFeedback,expression:"closeFeedback"}],staticClass:"feedback-container"},[e("div",{staticClass:"feedback-header"},[e("div",{staticClass:"feedback-title"},[t._v(t._s(t.$t("characterEvaluateModelHow")))]),t._v(" "),e("i",{staticClass:"feedback-close iconfont icon-close",on:{click:t.closeFeedback}})]),t._v(" "),e("div",{staticClass:"feedback-btns"},t._l(t.btnOptions,(function(n){return e("div",{key:n.score,staticClass:"feedback-btn",on:{click:function(e){return t.submitFeedback(n.score)}}},[e("i",{staticClass:"iconfont",class:n.icon}),t._v(" "),e("span",[t._v(t._s(t.$t(n.label)))])])})),0)])}),[],!1,null,"3bbd8346",null).exports);function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Pe={name:"MessageLike",inject:["aiChatBody"],props:{messageId:{type:[String,Number],required:!0},initialLikeState:{type:[String,Number],default:void 0},hasSubMsg:{type:Boolean,default:!1}},data:function(){return{localLikeStates:{}}},computed:Le(Le(Le({},Object(_.c)("user",["isLoggedIn"])),Object(_.c)("character",["isDigitalCharacter","formattedHistoryMessage","msgLoadingOver"])),{},{currentLikeState:function(){return this.localLikeStates[this.currentMsgId]||0},recentMsgIds:function(){var t,e=this,n=(null===(t=this.formattedHistoryMessage)||void 0===t?void 0:t.filter((function(t){return t.msg_id!==e.currentMsgId})))||[];return n.length?n.slice(-2).map((function(t){return t.msg_id})):[]},currentMsgId:function(){var t;return this.hasSubMsg&&null!==(t=this.aiChatBody)&&void 0!==t&&null!==(t=t.mainMsgContent)&&void 0!==t&&t.id?this.aiChatBody.mainMsgContent.id:this.messageId}}),watch:{initialLikeState:{handler:function(t){var e=this;void 0!==t&&t!==this.localLikeStates[this.currentMsgId]&&this.$nextTick((function(){e.$set(e.localLikeStates,e.currentMsgId,t);try{localStorage.setItem("aiChatLikeStates",JSON.stringify(e.localLikeStates))}catch(t){console.error("Error saving like states:",t)}}))},immediate:!0}},mounted:function(){var t=this;this.$EventBus.$on("cancelLike",(function(){t.handleLike(null,!0)})),this.initLocalLikeStates(),this.$xyLogEvent({front_operation:"exposure",entity_name:"like-btn-show",entity_type:"character-chat",obj_id:String(this.currentLikeState)})},beforeDestroy:function(){this.$EventBus.$off("cancelLike")},methods:{initLocalLikeStates:function(){var t=this,e=localStorage.getItem("aiChatLikeStates");if(e)try{var n=JSON.parse(e);Object.keys(n).forEach((function(e){t.$set(t.localLikeStates,e,n[e])}))}catch(t){console.error("Error loading like states:",t)}},handleLike:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]&&e[1],n.$xyLogEvent({front_operation:"click",entity_name:"like-btn-click",entity_type:"character-chat",obj_id:String(t)}),n.currentMsgId){o.next=4;break}return o.abrupt("return");case 4:if(n.isLoggedIn){o.next=7;break}return n.$EventBus.$emit("openLoginDialog",{callBack:function(){n.handleLike(t,r)}}),o.abrupt("return");case 7:return c=n.localLikeStates[n.currentMsgId]||0,l=c===t?3:t,r&&(l=3),o.prev=10,o.next=13,Object(D.K)({msg_id:n.currentMsgId,reaction_type:l,recent_msg_ids:n.recentMsgIds});case 13:n.$set(n.localLikeStates,n.currentMsgId,3===l?0:l);try{localStorage.setItem("aiChatLikeStates",JSON.stringify(n.localLikeStates))}catch(t){console.error("Error saving like states:",t)}o.next=20;break;case 17:o.prev=17,o.t0=o.catch(10),console.error("点赞消息失败:",o.t0);case 20:case"end":return o.stop()}}),o,null,[[10,17]])})))()}}},je=Pe,$e=(n(5168),Object(v.a)(je,(function(){var t=this,e=t._self._c;return t.isDigitalCharacter&&t.msgLoadingOver?e("div",{staticClass:"msg-like-box",class:{"has-sub-msg":t.hasSubMsg}},[e("div",{staticClass:"like-btn",class:{active:1===t.currentLikeState},on:{click:function(e){return t.handleLike(1)}}},[e("img",{staticClass:"dianzan-icon",attrs:{src:n(3450)("./"+(1===t.currentLikeState?"icon-dianzan-jihuo.png":"icon-dianzan.png"))}})]),t._v(" "),e("div",{staticClass:"like-btn dislike-btn",class:{active:2===t.currentLikeState},on:{click:function(e){return t.handleLike(2)}}},[e("img",{staticClass:"dianzan-icon",attrs:{src:n(3450)("./"+(2===t.currentLikeState?"icon-diancai-jihuo.png":"icon-diancai.png"))}})])]):t._e()}),[],!1,null,"bae8ed80",null).exports);function Te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Te(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Re={inject:["aiChatBody"],components:{AiChatMsgItem:ke,LineLoading:qt.default,AiChatModelSwitcher:S.a,AiChatFeedBackButtons:Se,AgentHotWorks:Ft,AgentMsgItem:le,MessageLike:$e},data:function(){return{formatEvaluation:d.e,lastMsg:null,editMsg:"",debounceHandleScroll:function(){},scrollTop:0,modelChangeCount:0,showRating:!1,currentSubMsgIndex:1,oldCurrentSubMsgIndex:1,modelList:[],currentRating:0,lastAutoScrollState:!1,isUserScrolling:!1,userScrollTimer:null,lastScrollTime:0,localLikeStates:{}}},watch:{isShowRating:{handler:function(t){var e=this;this.$nextTick((function(){t&&e.scrollBottom()}))},immediate:!0},currentSubMsgIndex:{handler:function(t,e){this.oldCurrentSubMsgIndex=e||t},deep:!0,immediate:!0},currentModel:{handler:function(t,e){this.currentRating=(null==t?void 0:t.score)||0,this.showRating=(null==t?void 0:t.gpt_model)!==(null==e?void 0:e.gpt_model)},immediate:!0,deep:!0},scrollTop:{handler:function(t){console.log("scrollTop--",t)},immediate:!0},msgList:{handler:function(t){var e=this;t&&t.length&&t.forEach((function(t){t.is_liked&&!e.localLikeStates[t.id]&&e.$set(e.localLikeStates,t.id,t.is_liked)}))},immediate:!0,deep:!0}},mounted:function(){this.debounceHandleScroll=Object(_t.debounce)(this.scrollLoad,200),this.getModelList()},beforeDestroy:function(){this.userScrollTimer&&(clearTimeout(this.userScrollTimer),this.userScrollTimer=null)},computed:Me(Me(Me({},Object(_.c)("user",["userInfo","isLoggedIn"])),Object(_.c)("character",["characterInfo","isAgentCharacter","pageLoading","isDigitalCharacter"])),{},{isShowAgentCharacterHotWorks:function(){var t,e;return(null===(t=this.characterInfo.agent_simple_image)||void 0===t?void 0:t.length)>0&&this.isAgentCharacter&&!this.pageLoading&&(null===(e=this.msgList)||void 0===e?void 0:e.length)%20!=0},curSubMsgIndex:function(){var t=this;return function(e){return t.currentSubMsgIndex||e.active_idx}},subMsgLength:function(){return function(t){return t.sub_msg&&Array.isArray(t.sub_msg)?t.sub_msg.some((function(t){return t.contain_sub_msg}))?t.sub_msg.length:t.sub_msg.length+1:0}},isDeepSeekCharacter:function(){return this.aiChatBody.isDeepSeekCharacter},mainMsgContent:function(){return this.aiChatBody.mainMsgContent||null},isShowEvaluation:function(){var t,e;return!this.laoding&&(null===(t=this.msgList)||void 0===t?void 0:t.length)%20!=0&&(null===(e=this.characterInfo)||void 0===e?void 0:e.evaluation)},isShowRating:function(){var t=this;return function(e){var n;return!(null==e||!e.sub_msg)&&!(null==e||null===(n=e.sub_msg[(t.currentSubMsgIndex||e.active_idx)-2])||void 0===n||!n.id)}},laoding:function(){return this.aiChatBody.loading||this.aiChatBody.optimizeIng},msgList:function(){return this.aiChatBody.renderMsgList||[]},isShowKeep:function(){return this.aiChatBody.isShowKeep&&this.isLoggedIn},isLastAi:function(){var t=this;return function(i){var e;return 0===i&&2===(null===(e=t.msgList[0])||void 0===e?void 0:e.role)&&t.msgList.length>1}},currentModel:function(){var t=this;return this.modelList.find((function(e){var n;return e.gpt_model===(null===(n=t.userInfo)||void 0===n||null===(n=n.character_setting)||void 0===n?void 0:n.gpt_model)}))||{}}}),methods:{handleLike:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=n.localLikeStates[t.id]||0,r=c===e?3:e,o.prev=2,o.next=5,Object(D.K)({msg_id:t.id,reaction_type:r});case 5:o.sent,n.$set(n.localLikeStates,t.id,3===r?0:r),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(2),console.error("点赞消息失败:",o.t0);case 12:case"end":return o.stop()}}),o,null,[[2,9]])})))()},getResource:function(t){return t.role&&"file"===t.role?t.content?t.content.split(",").map((function(t){return{content:t,task_id:(new Date).getTime()}})):[]:t.type_content},handleMouseWheel:function(t){var e=this,n=t.deltaY<0;this.isUserScrolling=!0;var o=this.$refs.msgListDom.scrollTop||0;n&&o<0&&!1!==this.lastAutoScrollState&&(this.lastAutoScrollState=!1,this.$emit("shouldAutoScroll",!1)),!n&&o>=0&&!0!==this.lastAutoScrollState&&(this.lastAutoScrollState=!0,this.$emit("shouldAutoScroll",!0)),this.userScrollTimer&&clearTimeout(this.userScrollTimer),this.userScrollTimer=setTimeout((function(){e.isUserScrolling=!1}),1e3)},handleMsg:function(t){this.$emit("handle",t)},getModelList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(D.u)();case 3:1e4===(null==(o=e.sent)||null===(n=o.status)||void 0===n?void 0:n.code)&&(t.modelList=(null==o||null===(r=o.data)||void 0===r?void 0:r.List)||[]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("获取模型列表失败:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},handleRatingChange:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(1!==n.currentSubMsgIndex){o.next=2;break}return o.abrupt("return");case 2:return c=null===(r=e.sub_msg)||void 0===r||null===(r=r[n.currentSubMsgIndex])||void 0===r?void 0:r.gpt_model,o.prev=3,o.next=6,Object(D.T)({idx:n.currentSubMsgIndex,message_id:e.id,model_id:c,rating:t});case 6:if(1e4===(null==(d=o.sent)||null===(l=d.status)||void 0===l?void 0:l.code)){o.next=9;break}throw new Error((null==d||null===(h=d.status)||void 0===h?void 0:h.message)||n.$t("taskOperateFailed"));case 9:n.currentRating=t,-1!==(v=n.modelList.findIndex((function(t){return t.gpt_model===c})))&&n.$set(n.modelList[v],"score",t),o.next=18;break;case 14:o.prev=14,o.t0=o.catch(3),console.error("评分失败:",o.t0),n.$message.error(o.t0.message||n.$t("taskOperateFailed"));case 18:case"end":return o.stop()}}),o,null,[[3,14]])})))()},setCurrentSubMsgIndex:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.mainMsgContent&&t){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Object(D.cb)({idx:t,message_id:null===(o=e.mainMsgContent)||void 0===o?void 0:o.id,parent_id:e.getParentId(e.msgList[0])});case 4:case"end":return n.stop()}}),n)})))()},prevMessage:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.mainMsgContent){n.next=2;break}return n.abrupt("return");case 2:if(!(e.currentSubMsgIndex>1)){n.next=15;break}return o=e.currentSubMsgIndex,n.prev=4,n.next=7,Object(D.cb)({idx:o-1,message_id:null===(r=e.mainMsgContent)||void 0===r?void 0:r.id,parent_id:e.getParentId(t)});case 7:e.currentSubMsgIndex--,e.$emit("handle",{type:"SWITCHMSG",msg:{subMsgIndex:e.currentSubMsgIndex}}),e.updateCurrentRating(t),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(4),console.log("切换到上一个消息失败",n.t0);case 15:case"end":return n.stop()}}),n,null,[[4,12]])})))()},nextMessage:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.mainMsgContent){n.next=2;break}return n.abrupt("return");case 2:if(e.lastMsg=null,!(e.currentSubMsgIndex<e.subMsgLength(t))){n.next=18;break}return o=e.currentSubMsgIndex,n.prev=5,n.next=8,Object(D.cb)({idx:o+1,message_id:null===(r=e.mainMsgContent)||void 0===r?void 0:r.id,parent_id:e.getParentId(t)});case 8:e.currentSubMsgIndex++,e.$emit("handle",{type:"SWITCHMSG",msg:{subMsgIndex:e.currentSubMsgIndex}}),e.updateCurrentRating(t),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),console.log("切换到下一个消息失败",n.t0);case 16:n.next=21;break;case 18:e.modelChangeCount=0,e.lastMsg=t,e.$emit("handle",{type:"ADDSUBMSG",msg:{id:t.id}});case 21:case"end":return n.stop()}}),n,null,[[5,13]])})))()},getParentId:function(t){var e,n;if(!t)return"";var o=this.msgList.findIndex((function(e){return e.id===t.id})),r=t.id;if(1===(null===(e=this.msgList[o+1])||void 0===e?void 0:e.role))r=this.msgList[o+1].id;else if(null!==(n=t.sub_msg)&&void 0!==n&&n.length){var c;r=null===(c=this.mainMsgContent)||void 0===c?void 0:c.id}return r},handleChangeModel:function(t){this.$refs.aiChatModelSwitcher.show(t),t.modelChangeCount||this.$set(t,"modelChangeCount",1)},handleModelChange:function(t){var e=t.model,n=t.msg;n&&(this.modelChangeCount++,this.$emit("handle",{type:"ADDSUBMSG",msg:{id:n.id,gpt_model:e}}))},handleKeepSay:function(t){this.modelChangeCount=0,this.$emit("handle",{type:"KEEPSAY",msg:{id:t.id}})},scrollBottom:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$nextTick((function(){var n=t.$refs.msgListDom;if(n){var o=n.scrollHeight;e||(t.lastAutoScrollState=!0,t.$emit("shouldAutoScroll",!0)),n.scrollTo({top:e?-o:o,behavior:"auto"}),t.lastScrollTime=Date.now()}}))},scrollLoad:function(){var t=this.$refs.msgListDom;if(t){var e=Date.now();if(e-this.lastScrollTime<300)console.log("忽略滚动加载，因为刚刚执行过scrollBottom",e-this.lastScrollTime);else if(this.scrollTop=Math.abs(t.scrollTop)||0,0!==t.scrollHeight)try{this.scrollTop+t.clientHeight>=t.scrollHeight-100&&(console.log("触发加载更多0",this.scrollTop),console.log("触发加载更多1",t.clientHeight),console.log("触发加载更多",this.scrollTop+t.clientHeight,t.scrollHeight-100),this.$emit("handle",{type:"LOADMORE"}))}catch(t){console.error("scrollLoad error:",t)}else console.log("scrollWrapper.scrollHeight为0，不执行加载更多")}},formatRating:function(t){return Number.isInteger(t)?"".concat(t,".0"):t.toFixed(1)},handleFeedbackClose:function(t){t.modelChangeCount=2},updateCurrentRating:function(t){var e,n,o;if(console.log("触发更新当前评分-msg!",t),console.log("触发更新当前评分-currentSubMsgIndex!",this.currentSubMsgIndex),console.log("触发更新当前评分-gpt_model!",null===(e=t.sub_msg)||void 0===e||null===(e=e[this.currentSubMsgIndex-2])||void 0===e?void 0:e.gpt_model),1!==this.currentSubMsgIndex&&this.isShowRating(t)){var r=(null===(n=t.sub_msg)||void 0===n||null===(n=n[this.currentSubMsgIndex-2])||void 0===n?void 0:n.gpt_model)||(null===(o=this.userInfo)||void 0===o||null===(o=o.character_setting)||void 0===o?void 0:o.gpt_model)||"",c=this.modelList.find((function(t){return t.gpt_model===r}));this.currentRating=(null==c?void 0:c.score)||0,console.log("更新评分",this.currentRating)}}}},Ae=Re,Ee=(n(5169),Object(v.a)(Ae,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"aichat-msg hide-scrollbar"},[n("div",{ref:"msgListDom",staticClass:"msg-list hide-scrollbar",on:{scroll:e.debounceHandleScroll,wheel:e.handleMouseWheel}},[e.isAgentCharacter?e._l(e.msgList,(function(t,o){return n("AgentMsgItem",{key:"agent_msg_"+t.id,attrs:{msg:t,msgIndex:o,msgList:e.msgList,resource:e.getResource(t)},on:{handle:e.handleMsg}})})):e._l(e.msgList,(function(t,i){var o,r;return n("AiChatMsgItem",{key:"msg_"+t.id+i,attrs:{currentSubMsgIndex:e.currentSubMsgIndex,hasSubMsg:(null===(o=t.sub_msg)||void 0===o?void 0:o.length)>0,isLastAi:e.isLastAi(i),isShowKeep:e.isShowKeep&&e.isLastAi(i),msg:t,isFirst:i===(null===(r=e.msgList)||void 0===r?void 0:r.length)-1,isShowCheckModelBtn:e.isLastAi(i)&&e.isShowKeep,mainMsgContent:e.mainMsgContent},on:{handleChangeModel:function(n){return e.handleChangeModel(t)},scrollBottom:e.scrollBottom,handle:e.handleMsg},scopedSlots:e._u([e.isLastAi(i)?{key:"extendedArea",fn:function(){var o,r;return[n("div",{staticClass:"extended-area"},[e.isShowKeep?n("div",{staticClass:"keep-say-box"},[null!==(o=t.sub_msg)&&void 0!==o&&o.length?n("div",{staticClass:"msg-switcher"},[n("div",{staticClass:"switcher-controls"},[n("div",{staticClass:"controls"},[n("i",{staticClass:"el-icon-arrow-left",class:{disabled:1===e.currentSubMsgIndex},on:{click:function(n){return e.prevMessage(t)}}}),e._v(" "),n("span",{staticClass:"page-info"},[e._v("\n                      "+e._s(e.curSubMsgIndex(t))+"\n                      "),n("span",[e._v("/")]),e._v("\n                      "+e._s(e.subMsgLength(t))+"\n                    ")]),e._v(" "),n("i",{staticClass:"el-icon-arrow-right",on:{click:function(n){return e.nextMessage(t)}}})]),e._v(" "),e._e()]),e._v(" "),e._e()],1):e._e(),e._v(" "),n("div",{staticClass:"keep-say-btn",attrs:{"data-event":"ai-chat-keep-say","data-id":t.id},on:{click:function(n){return e.handleKeepSay(t)}}},[n("div",{staticClass:"i-box"},[n("i",{staticClass:"iconfont icon-a-icon-keepon"})]),e._v(" "),n("span",[e._v(e._s(e.$t("keepSay")))])])]):e._e(),e._v(" "),e.isDigitalCharacter?n("MessageLike",{attrs:{messageId:t.id,initialLikeState:t.is_like,hasSubMsg:!(null===(r=t.sub_msg)||void 0===r||!r.length)}}):e._e()],1)]},proxy:!0}:null],null,!0),model:{value:e.editMsg,callback:function(t){e.editMsg=t},expression:"editMsg"}})})),e._v(" "),e.isShowAgentCharacterHotWorks?[n("AgentHotWorks")]:e._e(),e._v(" "),e.isShowEvaluation?n("div",{staticClass:"chat-desc"},[n("span",{staticClass:"tips"},[e._v(e._s(e.$t("tavern12"))+": ")]),e._v(" "),n("span",{staticClass:"evaluation-text",domProps:{innerHTML:e._s(e.formatEvaluation(null===(t=e.characterInfo)||void 0===t?void 0:t.evaluation))}})]):e._e()],2),e._v(" "),n("AiChatModelSwitcher",{ref:"aiChatModelSwitcher",attrs:{isDeepSeek:e.isDeepSeekCharacter,"character-info":e.characterInfo},on:{change:e.handleModelChange}})],1)}),[],!1,null,"1cd339c4",null).exports),Be=n(2601);function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ue={name:"AiChatFileUpload",props:{uploadType:{type:String,default:"any"},uploadCount:{type:Number,default:5}},computed:Fe(Fe({},Object(_.c)("character",["sessionId","on_line_search"])),{},{hasUploadFile:function(){var t;return!(null===(t=this.fileList)||void 0===t||!t.length)},allowedExtensions:function(){return"image"===this.uploadType?["png","jpg","jpeg"]:["png","jpg","jpeg","txt","pdf","doc","docx","json","md"]},accept:function(){return"image"===this.uploadType?".png,.jpg,.jpeg":".png,.jpg,.jpeg,.txt,.pdf,.doc,.docx,.json,.md"},maxHeight:function(){return this.fileList.length>3},successFileList:function(){return this.fileList.filter((function(t){return"success"===t.status}))||[]},isAnalyzingFile:function(){return this.fileList.some((function(t){return["Analyzing","uploading","UploadSuccess"].includes(t.status)}))||!1},cacheKey:function(){return"aiChat_fileList_".concat(this.sessionId)}}),data:function(){return{visible:!1,fileList:[],isUploading:!1,pollingInterval:null,pollingTime:3e3,defaultFileIconSuccess:n(244),defaultFileIconError:n(118)}},watch:{hasUploadFile:{handler:function(t){this.SET_HAS_UPLOAD_FILE(t)},immediate:!0},successFileList:{handler:function(t){this.SET_SUCCESS_FILE_LIST(t)},deep:!0,immediate:!0},isAnalyzingFile:{handler:function(t){this.$emit("updateIsAnalyzing",t)},immediate:!0},fileList:{handler:function(t){if(console.log("fileList---",t),!t.length)return this.stopPolling(),void(this.visible=!1);this.cacheFiles(t),this.visible=!0},deep:!0,immediate:!0},sessionId:{handler:function(t,e){t&&t!==e&&this.loadCachedFiles()},immediate:!0}},mounted:function(){var t=this;this.loadCachedFiles(),this.$EventBus.$on("clearSuccessFileList",(function(){t.clearSuccessFileList()}))},methods:Fe(Fe({},Object(_.d)("character",["SET_SUCCESS_FILE_LIST","SET_HAS_UPLOAD_FILE"])),{},{cacheFiles:function(t){if(this.sessionId){var e=t.filter((function(t){return"uploading"!==t.status}));if(e.length>0)try{sessionStorage.setItem(this.cacheKey,JSON.stringify(e)),console.log("缓存成功上传的文件",e.length)}catch(t){console.error("缓存文件失败",t)}}},loadCachedFiles:function(){var t=this;if(this.sessionId&&1!==this.on_line_search)try{var e=sessionStorage.getItem(this.cacheKey);if(e){var n=JSON.parse(e);if(Array.isArray(n)&&n.length>0&&0===this.fileList.length){var o=n;"image"===this.uploadType&&(o=n.filter((function(t){return["png","jpg","jpeg"].includes(t.type)}))),o=o.slice(0,this.uploadCount),this.fileList=o;var r=!1;this.fileList.forEach((function(e){var n;"UploadSuccess"===e.status&&null!==(n=e.url)&&void 0!==n&&n.file_id?t.parseFile(e,e.url):"Analyzing"===e.status&&(r=!0)})),r&&this.startPolling(),console.log("从缓存中恢复文件列表",n.length)}}else console.log("缓存中没有文件列表"),this.fileList=[]}catch(t){console.error("加载缓存文件失败",t)}},clearCachedFiles:function(){if(this.sessionId)try{sessionStorage.removeItem(this.cacheKey),console.log("清除缓存的文件列表")}catch(t){console.error("清除缓存文件失败",t)}},clearSuccessFileList:function(){this.fileList=this.fileList.filter((function(t){return"success"!==t.status})),this.clearCachedFiles()},startPolling:function(){var t=this;console.log("开始轮询文件状态"),this.pollingInterval&&this.stopPolling(),setTimeout((function(){t.checkFileProgress(),t.pollingInterval=setInterval((function(){t.checkFileProgress()}),t.pollingTime)}),500)},stopPolling:function(){console.log("停止轮询文件状态"),this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)},checkFileProgress:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.fileList.some((function(t){return"Analyzing"===t.status}))){e.next=5;break}return console.log("没有正在分析的文件，停止轮询"),t.stopPolling(),e.abrupt("return");case 5:if(0!==(n=t.fileList.filter((function(t){return"Analyzing"===t.status&&t.task_id})).map((function(t){return t.task_id}))).length){e.next=9;break}return console.log("没有有效的 task_id，等待下一次轮询"),e.abrupt("return");case 9:return e.prev=9,e.next=12,Object(D.O)({task_ids:n});case 12:o=e.sent,r=o.data.items,console.log("解析进度",r),r&&r.length>0&&(c=Object(I.a)(t.fileList),r.forEach((function(t){var e=c.findIndex((function(e){return e.task_id===t.task_id}));-1!==e&&(3===t.status?c[e]=Fe(Fe({},c[e]),{},{status:"success",statusDesc:t.status_desc||"Success"}):"systemTimeout"===t.status_desc&&4===t.status?c[e]=Fe(Fe({},c[e]),{},{status:"parseTimeout",statusDesc:t.status_desc}):4===t.status?c[e]=Fe(Fe({},c[e]),{},{status:"noTextFound",statusDesc:t.status_desc||"Error"}):c[e]=Fe(Fe({},c[e]),{},{statusDesc:t.status_desc||"Analyzing"}))})),t.fileList=c,t.fileList.some((function(t){return"Analyzing"===t.status}))||(console.log("所有文件解析完成，停止轮询"),t.stopPolling())),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(9),console.error("解析进度失败",e.t0);case 21:case"end":return e.stop()}}),e,null,[[9,18]])})))()},triggerUpload:function(){this.isUploading=!1,this.fileList.length>=this.uploadCount?this.$message.error(this.$t("image"===this.uploadType?"uploadImgMax":"exceedLimit")):(this.$refs.fileInput&&(this.$refs.fileInput.value=""),this.$refs.fileInput.click())},handleDelete:function(t){this.fileList.find((function(e){return e.id===t}));this.fileList=this.fileList.filter((function(e){return e.id!==t})),this.updateCachedFiles()},updateCachedFiles:function(){if(this.sessionId){var t=this.fileList.filter((function(t){return"uploading"!==t.status}));try{t.length>0?(sessionStorage.setItem(this.cacheKey,JSON.stringify(t)),console.log("更新缓存文件列表",t.length)):(sessionStorage.removeItem(this.cacheKey),console.log("清除缓存文件列表（无非上传中文件）"))}catch(t){console.error("更新缓存文件失败",t)}}},getFileIcon:function(t,e){console.log("getFileIcon---",t,e);var n=["error","noTextFound","chatSubUploadMax","irregularity"].includes(e);return m.R[t]?m.R[t][e]:n?this.defaultFileIconError:this.defaultFileIconSuccess},fileStatus:function(t){return{uploading:"uploading",UploadSuccess:"UploadSuccess",error:"uploadError",Analyzing:"Analyzing",success:"success",noTextFound:"noTextFound",chatSubUploadMax:"chatSubUploadMax",irregularity:"fileTypeError",parseTimeout:"parseTimeout"}[t]||t},getFileType:function(t){var e=t.name,n=e.substring(e.lastIndexOf(".")+1).toLowerCase();return m.pb[t.type]?m.pb[t.type]:m.Q[n]||n||"unknown"},getContentType:function(t,e){var n=t.name,o=n.substring(n.lastIndexOf(".")+1).toLowerCase();return m.P[o]?m.P[o]:m.P[e]?m.P[e]:t.type||"application/octet-stream"},handleFileUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("handleFileUpload---",e.isUploading),(r=t.target.files)&&0!==r.length){n.next=4;break}return n.abrupt("return");case 4:if(!(r.length>e.uploadCount)){n.next=8;break}return e.$message.error("image"===e.uploadType?e.$t("uploadImgMax"):e.$t("chatSubUploadMaxCount",{count:e.uploadCount})),t.target.value="",n.abrupt("return");case 8:if(!(e.fileList.length+r.length>e.uploadCount)){n.next=12;break}return e.$message.error(e.$t("image"===e.uploadType?"uploadImgMax":"exceedLimit")),t.target.value="",n.abrupt("return");case 12:e.isUploading=!0,c=0,l=0,d=regeneratorRuntime.mark((function n(){var d,h,v,f,m,_,y,w,C,k,O,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(d=r[i],h=d.name,v=h.substring(h.lastIndexOf(".")+1).toLowerCase(),e.allowedExtensions.includes(v)){n.next=11;break}return f=Date.now()+"_"+i,m={id:f,name:d.name,size:e.formatFileSize(d.size),originalSize:d.size,type:v||"unknown",status:"irregularity"},e.fileList.unshift(m),c++,r.length===c&&(e.isUploading=!1,t.target.value=""),n.abrupt("return",0);case 11:if(_=e.getFileType(d),!e.checkDuplicateFile(d)){n.next=19;break}return e.$message.warning(e.$t("audioUploadFileError3",{fileName:d.name})||'File "'.concat(d.name,'" has already been uploaded')),l++,c++,r.length===c&&(e.isUploading=!1,t.target.value=""),n.abrupt("return",0);case 19:if(y=["png","jpg","jpeg"].includes(_),w=5242880,y||!(d.size>w)){n.next=28;break}return C=Date.now()+"_"+i,k={id:C,name:d.name,size:e.formatFileSize(d.size),originalSize:d.size,type:_,status:"chatSubUploadMax"},e.fileList.unshift(k),c++,r.length===c&&(e.isUploading=!1,t.target.value=""),n.abrupt("return",0);case 28:if(!(y&&d.size>w)){n.next=42;break}return n.prev=29,n.next=32,Object(gt.a)(d,w);case 32:d=n.sent,n.next=42;break;case 35:return n.prev=35,n.t0=n.catch(29),console.error("Image compression failed:",n.t0),e.$message.error(e.$t("CompressionFailed")||"Image compression failed"),c++,r.length===c&&(e.isUploading=!1,t.target.value=""),n.abrupt("return",0);case 42:O=Date.now()+"_"+i,x={id:O,name:d.name,size:e.formatFileSize(d.size),originalSize:d.size,type:_,status:"uploading"},e.fileList.unshift(x),new mt.a({type:60}).startUpload(d,{name:d.name,type:_,category:60,size:d.size,contentType:e.getContentType(d,_)}).then(function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(o){var l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("上传成功",o),e.$emit("scrollBottom"),-1!==(l=e.fileList.findIndex((function(t){return t.id===O})))&&e.parseFile(e.fileList[l],o),c++,r.length===c&&(e.isUploading=!1,t.target.value="");case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){console.error("Upload error:",n),30005===n.code?e.$message.error(e.$t("uploadImageViolatesRules")||"Upload violates rules"):e.$message.error(e.$t("uploadError")||"Upload failed");var o=e.fileList.findIndex((function(t){return t.id===O}));-1!==o&&e.$set(e.fileList[o],"status","error"),c++,r.length===c&&(e.isUploading=!1,t.target.value="")}));case 47:case"end":return n.stop()}}),n,null,[[29,35]])})),i=0;case 17:if(!(i<r.length)){n.next=25;break}return n.delegateYield(d(),"t0",19);case 19:if(0!==n.t0){n.next=22;break}return n.abrupt("continue",22);case 22:i++,n.next=17;break;case 25:l===r.length&&r.length>0&&e.$message.warning(e.$t("AllFilesAlreadyUploaded")||"All selected files have already been uploaded");case 26:case"end":return n.stop()}}),n)})))()},parseFile:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,v,f,m;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t&&e){o.next=2;break}return o.abrupt("return");case 2:if(console.log("解析文件参数:",{fileItem:t,uploadRes:e}),-1===(r=n.fileList.findIndex((function(e){return e.id===t.id})))){o.next=12;break}if(n.$set(n.fileList[r],"status","UploadSuccess"),n.$set(n.fileList[r],"url",e),"image"!==n.uploadType){o.next=12;break}return c=n.fileList[r],l=c.file_width,d=c.file_height,n.$set(n.fileList[r],"status","success"),l&&d||n.getImageDimensionsFromUrl(e.url).then((function(t){n.$set(n.fileList[r],"file_width",t.width),n.$set(n.fileList[r],"file_height",t.height)})).catch((function(t){console.error("从URL获取图片尺寸失败",t)})),o.abrupt("return");case 12:if("image"!==n.uploadType){o.next=15;break}return-1!==r&&n.$set(n.fileList[r],"status","success"),o.abrupt("return");case 15:return h={byte:e.fileSize,name:e.fileName,url:e.url},o.prev=16,o.next=19,Object(D.N)(h);case 19:if(f=o.sent,m=(null==f||null===(v=f.data)||void 0===v?void 0:v.task_id)||"",-1===r||!m){o.next=30;break}return n.$set(n.fileList[r],"task_id",m),n.$set(n.fileList[r],"status","Analyzing"),console.log("文件解析任务ID设置成功:",m,"文件名:",e.fileName),o.next=27,n.$nextTick();case 27:n.pollingInterval||(console.log("启动轮询检查文件解析进度"),n.startPolling()),o.next=31;break;case 30:console.warn("无法设置文件解析任务ID:",m?"索引无效":"任务ID为空","文件名:",e.fileName);case 31:o.next=37;break;case 33:o.prev=33,o.t0=o.catch(16),console.error("解析文件失败",o.t0),-1!==r&&n.$set(n.fileList[r],"status","noTextFound");case 37:case"end":return o.stop()}}),o,null,[[16,33]])})))()},checkDuplicateFile:function(t){var e=this;return this.fileList.filter((function(t){return"success"===t.status})).some((function(n){return n.name===t.name&&(n.originalSize===t.size||e.parseFileSize(n.size)===t.size)}))},parseFileSize:function(t){if(!t)return 0;var e=t.slice(-2),n=parseFloat(t.slice(0,-2));switch(e){case"MB":return Math.round(1024*n*1024);case"KB":return Math.round(1024*n);case"B":return Math.round(n);default:return 0}},formatFileSize:function(t){return t<1024?t+"B":t<1048576?(t/1024).toFixed(2)+"KB":(t/1048576).toFixed(2)+"MB"},getFileList:function(){return this.fileList},clearFileList:function(){this.fileList=[]},setFileList:function(t){this.fileList=t}}),beforeDestroy:function(){this.$EventBus.$off("clearSuccessFileList"),this.stopPolling()}},He=Ue,Ve=(n(5170),Object(v.a)(He,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"ai-chat-file",class:{"ai-chat-file-max-height":t.maxHeight}},[e("div",{staticClass:"ai-chat-file-list"},t._l(t.fileList,(function(n){var o;return e("div",{key:n.id,staticClass:"ai-chat-file-list-item",class:{"ai-chat-file-list-item-img":"image"===t.uploadType}},["image"===t.uploadType?[["success","UploadSuccess","Analyzing"].includes(n.status)?e("img",{staticClass:"file-img",attrs:{src:null===(o=n.url)||void 0===o?void 0:o.url,alt:"SeaArt.AI"}}):["uploading"].includes(n.status)?e("div",{staticClass:"file-icon-box"},[e("i",{staticClass:"file-icon",class:t.getFileIcon(n.type,n.status)})]):e("img",{staticClass:"file-img",attrs:{src:t.getFileIcon(n.type,n.status),alt:"SeaArt.AI"}})]:t._e(),t._v(" "),"any"===t.uploadType?[["uploading","Analyzing"].includes(n.status)?e("i",{staticClass:"file-icon",class:t.getFileIcon(n.type,n.status)}):e("img",{staticClass:"file-img",attrs:{src:t.getFileIcon(n.type,n.status),alt:"searArt.AI"}}),t._v(" "),e("div",{staticClass:"file-info"},[e("div",{staticClass:"file-name"},[t._v(t._s(n.name))]),t._v(" "),"success"===n.status?e("div",{staticClass:"file-size"},[t._v("\n            "+t._s(n.size)+"\n          ")]):e("div",{staticClass:"file-size",class:{"file-size-error":["noTextFound","error","chatSubUploadMax","irregularity","parseTimeout"].includes(n.status)}},[t._v("\n            "+t._s(t.$t(t.fileStatus(n.status)))+"\n          ")])])]:t._e(),t._v(" "),e("div",{staticClass:"delete-box",class:{"error-state":["error","noTextFound","chatSubUploadMax","irregularity","parseTimeout"].includes(n.status)},on:{click:function(e){return t.handleDelete(n.id)}}},[e("i",{staticClass:"el-icon-close"})])],2)})),0),t._v(" "),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:t.accept,multiple:""},on:{change:t.handleFileUpload}})])}),[],!1,null,"af0fc336",null).exports),ze=n(34);function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?We(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ge={name:"AiChatRecModelPopup",data:function(){return{visible:!1,recommendModel:{}}},computed:qe(qe(qe({},Object(_.c)("character",["characterInfo","isToolCharacter"])),Object(_.c)("user",["isLoggedIn","characterSetting","userInfo"])),{},{defaultGptModel:function(){var t,e,n,o,r,c,l,d,h,v=(null===(t=this.characterInfo)||void 0===t?void 0:t.gpt_model)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.gpt_model)||!1;return(this.isToolCharacter?1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_functionality_model):1!==(null===(o=this.characterSetting)||void 0===o?void 0:o.is_set_companion_model))&&v||!this.isLoggedIn?this.isLoggedIn&&null!==(r=this.characterInfo)&&void 0!==r&&r.gpt_model&&"-"!==(null===(c=this.characterInfo)||void 0===c?void 0:c.gpt_model)?null===(h=this.characterInfo)||void 0===h?void 0:h.gpt_model:this.isToolCharacter?"Deepseek-v3":"GPT-35-Turbo-1106":this.isToolCharacter?null===(l=this.characterSetting)||void 0===l?void 0:l.functionality_gpt_model:null===(d=this.characterSetting)||void 0===d?void 0:d.gpt_model}}),mounted:function(){this.$EventBus.$on("openRecModelPopup",this.show),this.$EventBus.$on("closeRecModelPopup",this.handleClose)},beforeDestroy:function(){this.$EventBus.$off("openRecModelPopup",this.show),this.$EventBus.$off("closeRecModelPopup",this.handleClose)},methods:qe(qe(qe({},Object(_.b)("user",["getAccountInfo"])),Object(_.d)("user",["SET_USER_INFO"])),{},{show:function(data){var t=(data||{}).highModelObj,e=void 0===t?null:t;e&&e.gpt_model!==this.defaultGptModel&&this.isLoggedIn&&(this.recommendModel=e,this.visible=!0)},handleClose:function(){this.visible=!1,this.recommendModel={}},handleSave:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("确认使用推荐模型:",t.recommendModel),o=P()(t.userInfo)||{},t.isToolCharacter?o.character_setting.functionality_gpt_model=t.recommendModel.gpt_model:o.character_setting.gpt_model=t.recommendModel.gpt_model,t.SET_USER_INFO(o),r=t.isToolCharacter?{functionality_gpt_model:t.recommendModel.gpt_model}:{gpt_model:t.recommendModel.gpt_model},e.next=7,Object(D.ab)(r);case 7:if(1e4===(null==(c=e.sent)||null===(n=c.status)||void 0===n?void 0:n.code)){e.next=10;break}throw new Error((null==c||null===(l=c.status)||void 0===l?void 0:l.message)||t.$t("taskOperateFailed"));case 10:t.$message.success(t.$t("SaveSuccess")),t.getAccountInfo(o),t.handleClose();case 13:case"end":return e.stop()}}),e)})))()}})},Ye=(n(5171),Object(v.a)(Ge,(function(){var t,e=this,n=e._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"recommend-models-float"},[n("div",{staticClass:"recommend-models-header"},[e._v("\n    "+e._s(e.$t("Recommended_Model"))+"\n  ")]),e._v(" "),n("div",{staticClass:"recommend-models-content"},[e._v(e._s(e.$t((null===(t=e.recommendModel)||void 0===t?void 0:t.title_key)||"SeaArt Chat about models")))]),e._v(" "),n("div",{staticClass:"recommend-models-footer"},[n("div",{staticClass:"btn-cancel",on:{click:e.handleClose}},[e._v(e._s(e.$t("noUse")))]),e._v(" "),n("div",{staticClass:"btn-save",on:{click:e.handleSave}},[e._v(e._s(e.$t("workFlow46")))])])])}),[],!1,null,"7fe8cfb4",null).exports);function Ke(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return Je(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Je(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,c=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function Je(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function Xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xe(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ze={props:{isShowChat:{type:Boolean,default:!0}},provide:function(){return{aiChatBody:this}},inject:["aiChatIndex"],data:function(){return{currentInputMsg:"",chatCount:0,changeOnLineSearchLoading:!1,is_active_upload:2,shouldAutoScroll:!0,hasWatchedMsgList:!1,hasInitializedWithCache:!1,cachedContentLength:void 0,lastSessionMsg:{},continue_expend:[0,0,0,0],continue_response_msg:null,continue_user_msg:null,showMoreOptions:!1,streamFinish:!1,processedLength:0,characters:[],replyerMsgID:"",subMsgRefreshIndex:null,gpt_model:"",mainMsgContent:{content:"",coin:0,num_of_token:0,deepseek_time:0},subMsgUpdateObj:{content:"",loading:!1},getSubMsgObj:!1,contentQueue:[],isProcessing:!1,regenerateMsgCopy:"",handleRegenerateMsg:!1,typingSpeed:20,chatStreamClass:null,optimizeIng:!1,msg:"",msgList:[],hasMoreMessages:!0,loading:!1,messageStatus:new Map,params:{page_size:20,offset_to:0},currentModelMsg:null,modelSwitchCount:0,isInitializing:!0,scrollTimer:null,scrollLock:!1,scrollDebounceTimer:null,thisTimeSendMsgCount:0,lastScrollTime:0,SCROLL_THROTTLE:500,SCROLL_BATCH_SIZE:20,accumulatedChars:0,processQueueTimer:null}},components:{AiChatModelSwitcher:S.a,AiChatMsg:Ee,AiChatCardManagePopup:Mt,AiChatFileUpload:Ve,AiChatTalkModelSelect:pt,AiChatRecModelPopup:Ye},watch:{handleRegenerateMsg:function(t){t&&(console.log("刷新消息-取消点赞"),this.$EventBus.$emit("cancelLike"))},msgLoadingOver:{handler:function(t){this.SET_MSG_LOADING_OVER(t),this.handleLatestMessages()},immediate:!0},sendMessageParams:{handler:function(t){this.SET_SEND_MESSAGE(t)},immediate:!0,deep:!0},updateMsgList:{handler:function(t){t&&this.sessionId&&(console.log("更新消息列表啊啊",t),this.getMsgListByBus(this.sessionId),this.isInitializing=!0)},immediate:!0},shouldAutoScroll:{handler:function(t){console.log("shouldAutoScroll",t)},immediate:!0},is_active_upload_status:{handler:function(t){this.is_active_upload=t},immediate:!0},msgList:{handler:function(t){var e=t.find((function(t){return 2===t.role}));e&&e.active_idx&&!this.hasWatchedMsgList&&(this.$refs.aiChatMsg&&(this.$refs.aiChatMsg.currentSubMsgIndex=e.active_idx),this.updateMainMsg(e,"watchMsgList"),this.handleMsg({type:"SWITCHMSG",msg:{subMsgIndex:e.active_idx}}),this.hasWatchedMsgList=!0)},immediate:!0,deep:!0},msg:function(){var t=this;this.$nextTick((function(){t.scrollInputToBottom()}))}},computed:Qe(Qe(Qe(Qe({},Object(_.e)("payment",["paymentInfo"])),Object(_.c)("user",["isCompanyAccount","isLoggedIn","userInfo","characterSetting"])),Object(_.c)("character",["on_line_search","characterInfo","successFileList","updateMsgList","sessionId","isToolCharacter","hasUploadFile","userCardInfo","isAgentCharacter","pageLoading","lastChatRoleList","isDigitalCharacter","formattedHistoryMessage","historyMessageList"])),{},{isShowCardManage:function(){return this.userCardInfo.id&&!this.isAgentCharacter},onlineSearch:function(){return 1===this.on_line_search},file_id:function(){if(this.isAgentCharacter)return[];try{var t=this.successFileList.map((function(t){return t.task_id}))||[];if(t.length>0)return t;var e=new Set,n=[];return this.msgList&&this.msgList.length>0&&this.msgList.forEach((function(t){t&&1===t.role&&t.file_info&&Array.isArray(t.file_info)&&t.file_info.forEach((function(t){t&&t.task_id&&!e.has(t.task_id)&&e.size<5&&(e.add(t.task_id),n.unshift(t.task_id))}))})),n}catch(t){return console.error("Error extracting task_id:",t),[]}},file_url:function(){return this.isAgentCharacter?this.successFileList.map((function(t){var e;return null===(e=t.url)||void 0===e?void 0:e.url})):[]},is_active_upload_status:function(){return this.successFileList.length>0?1:2},fileInfo:function(){return this.successFileList.map((function(t){var e,n,o,r,c;return{file_width:t.file_width,file_height:t.file_height,task_id:t.task_id,file_id:null===(e=t.url)||void 0===e?void 0:e.file_id,file_name:null===(n=t.url)||void 0===n?void 0:n.fileName,file_size:null===(o=t.url)||void 0===o?void 0:o.fileSize,file_type:null===(r=t.url)||void 0===r?void 0:r.fileType,file_path:null===(c=t.url)||void 0===c?void 0:c.url}}))||[]},currentUseChatModel:function(){var t,e,n,o,r,c,l,d,h=(null===(t=this.characterInfo)||void 0===t?void 0:t.gpt_model)||!1;return(this.isToolCharacter?1!==(null===(e=this.characterSetting)||void 0===e?void 0:e.is_set_functionality_model):1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_companion_model))&&h||!this.isLoggedIn?this.isLoggedIn&&null!==(o=this.characterInfo)&&void 0!==o&&o.gpt_model&&"-"!==(null===(r=this.characterInfo)||void 0===r?void 0:r.gpt_model)?null===(d=this.characterInfo)||void 0===d?void 0:d.gpt_model:this.isToolCharacter?"Deepseek-v3":"GPT-35-Turbo-1106":this.isToolCharacter?null===(c=this.characterSetting)||void 0===c?void 0:c.functionality_gpt_model:null===(l=this.characterSetting)||void 0===l?void 0:l.gpt_model},subMsgCreateOrSwitchOrRefresh:function(){return this.getSubMsgObj||null!==this.subMsgRefreshIndex},isInputChat:function(){return!this.getSubMsgObj&&!this.subMsgRefreshIndex},isShowKeep:function(){return!this.pageLoading&&!this.sendLoading&&0!==this.msgList.length&&!this.isProcessing},msgLoadingOver:function(){return!this.sendLoading&&!this.isProcessing},isDisabledSend:function(){return!this.msg.trim()||this.sendLoading||this.maxInput||this.optimizeIng||this.isProcessing},renderMsgList:function(){var t,e=this.msgList.find((function(t){return"number"==typeof t.role&&2===t.role}));if(e){var n=this.msgList.indexOf(e);n===this.msgList.length-1&&(e.hasKeep=!0,this.msgList[n].hasKeep=!0)}var o=this.characterInfo,r=o.first_msg,c=o.id,l=o.create_at;return null!==(t=this.msgList)&&void 0!==t&&t.length||this.isLoggedIn?this.msgList:[{content:r,id:c,create_at:l,role:2}]},sendLoading:function(){return this.isProcessing||this.msgList.some((function(t){return t.loading}))},maxInput:function(){return this.msg.length>2e3},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},sendMessageParams:function(){var t=[];return this.msgList.length&&(t=this.getNewArray(this.msgList)),t},messageInput:{get:function(){return this.msg},set:function(t){this.msg=this.filterXss()(t)}}}),mounted:function(){var t=this;this.contentQueue=[],this.params.offset_to=0,this.hasMoreMessages=!0,this.SET_PAGE_LOADING(!1),document.addEventListener("visibilitychange",this.handleVisibilityChange),this.$EventBus.$on("openCardManage",(function(){t.$refs.aiChatCardManagePopup&&t.$refs.aiChatCardManagePopup.handleAddInformation()})),window.addEventListener("keydown",this.handleGlobalKeydown)},beforeDestroy:function(){console.log("aiChatBody-beforeDestroy"),this.$EventBus.$off("openCardManage"),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.scrollTimer&&clearTimeout(this.scrollTimer),this.cleanupResources(),this.scrollDebounceTimer&&clearTimeout(this.scrollDebounceTimer),this.lastScrollTime=0,this.accumulatedChars=0,this.processQueueTimer&&clearTimeout(this.processQueueTimer),window.removeEventListener("keydown",this.handleGlobalKeydown)},beforeUpdate:function(){console.log("aiChatBody-beforeUpdate")},methods:Qe(Qe(Qe(Qe(Qe(Qe({},Object(_.d)("character",["SET_SHOW_SEARCH_RESULT","SET_SEARCH_RESULTS","SET_SEND_MESSAGE","SET_UPDATE_MSG_LIST","SET_PAGE_LOADING","SET_MSG_LOADING_OVER","SET_LAST_CHAT_ROLE_LIST","ADD_HISTORY_MESSAGE","SET_HISTORY_MESSAGE_LIST"])),Object(_.d)("user",["SET_USER_INFO"])),Object(_.b)("payment",["getPaymentInfo"])),Object(_.b)("character",["updateOnLineSearch","initHistoryMessageList"])),Object(_.b)("user",["updateCharacterUnReadNum"])),{},{handleUpdateHistoryMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"replace",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,content=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";console.log("同步更新历史消息记录-history--",t,e,content);var n=Object(_t.cloneDeep)(this.historyMessageList)||[];if(n.length){var o;if("del"===t&&n.splice(e,2),"replace"===t)null!==(o=n[e])&&void 0!==o&&o.id&&(n[e].content=content||this.msgList[e].content,n[e].only_replace=!0);this.SET_HISTORY_MESSAGE_LIST(n)}},handleShouldAutoScroll:function(t){this.shouldAutoScroll=t},handleVisibilityChange:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.hidden){e.next=3;break}return e.next=3,t.checkStackingMsg(!0);case 3:case"end":return e.stop()}}),e)})))()},checkStackingMsg:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],r=t.length>1&&void 0!==t[1]&&t[1],c=t.length>2&&void 0!==t[2]?t[2]:0,l=t.length>3&&void 0!==t[3]?t[3]:3,e.isLoggedIn){n.next=6;break}return n.abrupt("return");case 6:return n.prev=6,n.next=9,Object(D.C)({session_id:e.sessionId});case 9:if(1e4!==(null==(h=n.sent)||null===(d=h.status)||void 0===d?void 0:d.code)){n.next=32;break}if(e.lastSessionMsg=(null==h?void 0:h.data)||{},!e.lastSessionMsg.x_response_msg_id){n.next=23;break}if(!o){n.next=20;break}if(console.log("切换网页",e.lastSessionMsg),n.t0=e.lastSessionMsg.msg_end&&e.msgList.length,!n.t0){n.next=19;break}return n.next=19,e.msgContinue(o);case 19:return n.abrupt("return");case 20:return e.msgList.length&&e.msgContinue(),r&&console.log("网络错误-不需要继续执行重试逻辑"),n.abrupt("return");case 23:if(!r){n.next=32;break}if(console.log("网络错误重试检查：需要重试",c+1),!(c<l)){n.next=30;break}return setTimeout((function(){e.checkStackingMsg(!1,!0,c+1,l)}),2e3),n.abrupt("return");case 30:console.log("已达到最大重试次数",l);case 31:e.cleanupResources();case 32:n.next=39;break;case 34:n.prev=34,n.t1=n.catch(6),e.lastSessionMsg={},console.error("获取续接消息状态失败",n.t1),r&&c<l&&setTimeout((function(){e.checkStackingMsg(!1,!0,c+1,l)}),2e3);case 39:case"end":return n.stop()}}),n,null,[[6,34]])})))()},handlePauseMsg:function(){this.$logEvent("log_actions",{operation:"click_stop_message",behavior_info:"on_tarven_detail_page"}),this.cleanupResources()},filterXss:function(){return function(t){return ze.default.prototype.xss(t)}},getMsgListByBus:function(){console.log("通过外部唤起获取消息列表"),this.cleanupResources(),this.getChatMsgLIst("outHandle")},handleClickOutside:function(){this.showMoreOptions&&(this.showMoreOptions=!1)},handleAction:function(t){var e=this;switch(t){case"uploadFile":if(this.$logEvent("log_actions",{operation:"click_upload_file",behavior_info:"on_tarven_detail_page"}),1===this.on_line_search)return;if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog",{callBack:function(){return e.aiChatIndex.newChat()}});this.$refs.aiChatFileList.triggerUpload();break;case"modelSetting":this.$logEvent("log_actions",{operation:"click_switch_model",behavior_info:"on_tavern_chat_page"}),this.$refs.aiChatModelSwitcher.show()}this.showMoreOptions=!1},handleShowMorePopup:function(){this.$logEvent("log_actions",{operation:"click_more",behavior_info:"on_tavern_chat_page"}),this.showMoreOptions=!this.showMoreOptions},handleSearch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasUploadFile){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoggedIn){e.next=5;break}return t.$EventBus.$emit("openLoginDialog",{callBack:function(){t.aiChatIndex.newChat()}}),e.abrupt("return");case 5:if(!t.changeOnLineSearchLoading){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,t.changeOnLineSearchLoading=!0,n=1===t.on_line_search?2:1,(o=Object(_t.cloneDeep)(t.userInfo)||{}).character_setting.on_line_search=n,t.SET_USER_INFO(o),e.next=15,t.updateOnLineSearch(n);case 15:t.changeOnLineSearchLoading=!1,e.next=24;break;case 18:e.prev=18,e.t0=e.catch(7),userInfoCopy.character_setting.on_line_search=t.on_line_search,t.SET_USER_INFO(userInfoCopy),t.changeOnLineSearchLoading=!1,console.error("Failed to update on line search:",e.t0);case 24:case"end":return e.stop()}}),e,null,[[7,18]])})))()},handleSetR1:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("设置为R1模型"),t.$logEvent("log_actions",{operation:"click_deepseek_r1",behavior_info:"on_tavern_chat_page"}),e.prev=2,t.handleGuest(),o=Object(_t.cloneDeep)(t.userInfo)||{},r=t.currentUseChatModel,c="Deepseek-R1"===t.currentUseChatModel?"Deepseek-v3":"Deepseek-R1",o.character_setting.functionality_gpt_model=c,t.SET_USER_INFO(o),e.next=11,Object(D.ab)({functionality_gpt_model:c});case 11:if(1e4!==(null==(l=e.sent)||null===(n=l.status)||void 0===n?void 0:n.code)){e.next=17;break}o.character_setting.is_set_functionality_model=1,t.SET_USER_INFO(o),e.next=20;break;case 17:throw o.character_setting.functionality_gpt_model=r,t.SET_USER_INFO(o),new Error((null==l||null===(d=l.status)||void 0===d?void 0:d.message)||t.$t("taskOperateFailed"));case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(2),console.error("保存失败:",e.t0),t.$message.error(e.t0.message||t.$t("taskOperateFailed"));case 26:return e.prev=26,t.saveLoading=!1,t.visible=!1,e.finish(26);case 30:case"end":return e.stop()}}),e,null,[[2,22,26,30]])})))()},appendWelcomeMessageIfEmpty:function(){if(this.characterInfo.first_msg&&0===this.msgList.length){var t={content:this.characterInfo.first_msg,create_at:(new Date).getTime(),id:"".concat((new Date).getTime(),"random"),is_first_msg:1,role:2,loading:!1};this.msgList.push(t)}},closeRecommendMsg:function(){var t;null!==(t=this.msgList[0])&&void 0!==t&&t.recommend&&this.msgList.shift()},msgChange:function(data){var text=data.text,t=data.isSend;this.closeRecommendMsg(),this.msg=text,t&&this.sendMsg(),this.scrollBottom("msgChange")},handleOptimizeChat:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$logEvent("log_actions",{operation:"click_polish",behavior_info:"on_tarven_detail_page"}),!t.optimizeIng&&!t.sendLoading){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,t.optimizeIng=!0,e.next=7,Object(D.M)({char_name:null===(n=t.characterInfo)||void 0===n?void 0:n.name,messages:t.sendMessageParams,user_name:t.userCardInfo.username||t.userInfo.name,text:t.msg});case 7:r=e.sent,1e4===(null===(o=r.status)||void 0===o?void 0:o.code)&&(t.msg=r.data.text),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error("Optimize error:",e.t0);case 14:return e.prev=14,t.optimizeIng=!1,t.scrollBottom("handleOptimizeChat"),e.finish(14);case 18:case"end":return e.stop()}}),e,null,[[3,11,14,18]])})))()},getNewArray:function(t){var e=(JSON.parse(JSON.stringify(t))||[]).filter((function(t){return!t.recommend}));return(e.length>=3?e.slice(0,3):e).map((function(t){return{role:2===t.role?"assistant":"user",text:t.content}}))},handleShowPopup:function(){this.$logEvent("log_actions",{operation:"ciick_reply_inspiringly",behavior_info:"on_tavern_chat_page",behavior_info_sub:this.isToolCharacter?"tool_assistant":"entertainment"}),this.$logEvent("log_actions",{operation:"recommend_reply",behavior_info:"on_tarven_detail_page"}),this.resetSubMsgStatus(),this.handleGuest(),this.aiChatIndex.checkStatus()||(this.createNewMsgObj("popup",!0),this.scrollBottom("handleShowPopup"))},scrollBottom:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown";if(this.$refs.aiChatMsg){var t=Date.now();if(!this.shouldAutoScroll&&!["sendMsg","handleKeepSay","regenerateMsg","initLoadMsg","createNewMsgObj","Abort"].includes(source))return void console.log("拦截自动滚动",source);if(t-this.lastScrollTime<this.SCROLL_THROTTLE&&!["handleStreamFinish","handleShowPopup","initLoadMsg","processQueue_batch","processQueue_end","handleOptimizeChat","getSubMsg","cleanupResources","initWithCache","switchSubMsg","clearSuccessFileList","uploadFile","sendMsg","containSSEFinishFn","handleKeepSay","createNewMsgObj","msgChange","getReChat","regenerateMsg","Abort","setSenderMsgRealId_error","setReplyerMsgRealId_error"].includes(source))return;this.lastScrollTime=t,this.$refs.aiChatMsg.scrollBottom()}},scrollTop:function(){var t=this;console.log("滚动到顶部"),this.$nextTick((function(){t.$refs.aiChatMsg&&t.$refs.aiChatMsg.scrollBottom(!0)}))},getChatMsgLIst:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:null,console.log("获取聊天记录列表",o),"outHandle"===o&&(e.cleanupResources(),e.contentQueue=[],e.params.offset_to=0,e.hasMoreMessages=!0,e.SET_PAGE_LOADING(!1),e.msgList=[]),!e.pageLoading){n.next=5;break}return n.abrupt("return");case 5:if(r=!1,n.prev=6,e.hasMoreMessages&&e.sessionId){n.next=9;break}return n.abrupt("return");case 9:return e.SET_PAGE_LOADING(!0),n.next=12,Object(D.v)(Qe(Qe({},e.params),{},{session_id:e.sessionId}));case 12:c=n.sent,l=c.data,d=l.has_more,h=l.items,v=l.offset,e.msgList=0===e.params.offset_to?h||[]:e.msgList.concat(h||[]),r=!d&&0===e.params.offset_to&&e.msgList.length<=1,e.hasMoreMessages=d,e.isInitializing=!1,r&&e.scrollTop(),!r&&0===e.params.offset_to&&e.scrollBottom("initLoadMsg"),e.params.offset_to=v,(f=e.msgList.find((function(t){return 2===t.role})))&&e.updateMainMsg(f,"getHistoryMsg"),e.checkStackingMsg(),n.next=32;break;case 29:n.prev=29,n.t0=n.catch(6),console.error("获取消息报错",n.t0);case 32:if(n.prev=32,e.formattedHistoryMessage.length){n.next=36;break}return n.next=36,e.initHistoryMessageList();case 36:return e.aiChatIndex.clearCharacterUnReadNum(e.characterInfo.id),e.updateCharacterUnReadNum(),e.updateHomeUnReadNum(),e.appendWelcomeMessageIfEmpty(),e.SET_UPDATE_MSG_LIST(!1),e.SET_PAGE_LOADING(!1),(m=localStorage.getItem("currentInputMsg"))&&e.isLoggedIn&&(e.msg=m,e.aiChatIndex.chatFreePermissionsFull=!1,localStorage.removeItem("currentInputMsg"),e.sendMsg()),n.finish(32);case 45:case"end":return n.stop()}}),n,null,[[6,29,32,45]])})))()},msgContinue:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],e.lastSessionMsg.session_id===e.sessionId){n.next=3;break}return n.abrupt("return");case 3:if(!(!e.checkMsgExistsById(e.lastSessionMsg.x_response_msg_id)||!e.lastSessionMsg.response_msg||o)){n.next=23;break}if(n.prev=5,e.initObjByLastSessionMsg(),!(e.lastSessionMsg.msg_end||!1)){n.next=16;break}e.cleanupResources(),e.initObjByLastSessionMsg(),(r=!e.lastSessionMsg.original_msg_id)&&e.pushMsgToList(),!r&&e.pushSubMsgToMsg(),n.next=18;break;case 16:return n.next=18,e.getSSEContain();case 18:n.next=23;break;case 20:n.prev=20,n.t0=n.catch(5),console.error("消息的续接处理-error",n.t0);case 23:case"end":return n.stop()}}),n,null,[[5,20]])})))()},pushMsgToList:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]&&t[0],n.prev=1,r=e.lastSessionMsg.msg_type,c=[],o&&(e.continue_response_msg.content=""),"keep_say_msg"!==r&&"refresh_msg"!==r||(c=[e.continue_response_msg]),"send_msg"===r&&(console.log("发送消息-消息列表追加最新的用户消息和回复消息",e.continue_response_msg,e.continue_user_msg),c=[e.continue_response_msg,e.continue_user_msg]),console.log("开始处理消息列表更新，当前消息类型:",r),l=Object(I.a)(e.msgList),d=new Set,h=!1,v=regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=m[f])&&e.id){t.next=4;break}return console.log("新消息无效或缺少ID，跳过匹配:",e),t.abrupt("return",1);case 4:-1!==(n=l.findIndex((function(t){return t.id===e.id})))&&(console.log("找到匹配的消息ID:",e.id,"，进行替换"),l[n]=e,d.add(e.id),h=!0);case 6:case"end":return t.stop()}}),t)})),f=0,m=c;case 13:if(!(f<m.length)){n.next=20;break}return n.delegateYield(v(),"t0",15);case 15:if(!n.t0){n.next=17;break}return n.abrupt("continue",17);case 17:f++,n.next=13;break;case 20:if(!((_=c.filter((function(t){return t&&t.id&&!d.has(t.id)}))).length>0)){n.next=26;break}console.log("有未匹配的消息需要追加，数量:",_.length),l=_.concat(l),n.next=29;break;case 26:if(h){n.next=29;break}return console.log("没有消息需要替换或追加，保持原消息列表不变"),n.abrupt("return");case 29:e.msgList=l,console.log("消息列表更新完成，当前消息数量:",e.msgList.length),n.next=35;break;case 33:n.prev=33,n.t1=n.catch(1);case 35:return n.prev=35,e.stopMsgLoading(),n.finish(35);case 38:case"end":return n.stop()}}),n,null,[[1,33,35,38]])})))()},pushSubMsgToMsg:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.lastSessionMsg.msg_type,-1!==(o=t.msgList.findIndex((function(e){return e.id===t.lastSessionMsg.original_msg_id})))){e.next=6;break}return console.log("找不到主消息，无法处理子消息，主消息ID:",t.lastSessionMsg.original_msg_id),e.abrupt("return");case 6:if(console.log("找到主消息，索引:",o,"主消息ID:",t.lastSessionMsg.original_msg_id),t.msgList[o].sub_msg||(console.log("主消息没有sub_msg数组，初始化为空数组"),t.$set(t.msgList[o],"sub_msg",[])),r=t.msgList[o].sub_msg,c=t.continue_response_msg,l=t.continue_user_msg,c&&c.id){e.next=14;break}return console.log("新子消息无效或缺少ID，无法处理"),e.abrupt("return");case 14:if(console.log("准备处理子消息，新子消息ID:",c.id),d=r.findIndex((function(t){return t.id===c.id})),h=r.findIndex((function(t){return t.id===l.id})),v=0,-1===h||"refresh_msg"!==n){e.next=27;break}return console.log("找到匹配的子消息，索引:",h,"新子消息ID:",c.id),t.$set(r,h,c),v=h+1,c.contain_sub_msg=!0,e.next=25,t.setActiveIdx(v,o,r);case 25:e.next=34;break;case 27:if(-1!==d){e.next=34;break}return console.log("没有找到匹配的回复子消息，追加到子消息数组"),v=r.length+1,c.contain_sub_msg=!0,r.push(c),e.next=34,t.setActiveIdx(v,o,r);case 34:e.next=38;break;case 36:e.prev=36,e.t0=e.catch(0);case 38:return e.prev=38,t.stopMsgLoading(),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[0,36,38,41]])})))()},setActiveIdx:function(t,e,n){var r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var c,content,l,d,h,v,f,m,_,y,w,C;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(D.cb)({idx:t,message_id:r.lastSessionMsg.original_msg_id});case 3:r.msgList[e].active_idx=t,r.$refs.aiChatMsg.currentSubMsgIndex=t,c=r.continue_response_msg,content=c.content,l=c.coin,d=c.num_of_token,h=c.think_duration,v=c.voice_duration,c.id,f=c.gpt_model,m=c.support_voice,_=c.status,y=c.create_at,w=c.role,C=c.search_results,r.msgList[e].content=content,r.msgList[e].coin=l,r.msgList[e].num_of_token=d,r.msgList[e].deepseek_time=h,r.msgList[e].voice_duration=v,r.msgList[e].gpt_model=f,r.msgList[e].support_voice=m,r.msgList[e].status=_,r.msgList[e].create_at=y,r.msgList[e].role=w,r.msgList[e].search_results=C,console.log("子消息处理完成，当前子消息数量:",n.length),o.next=23;break;case 20:o.prev=20,o.t0=o.catch(0),console.error("设置消息的激活索引失败",o.t0);case 23:case"end":return o.stop()}}),o,null,[[0,20]])})))()},initObjByLastSessionMsg:function(){this.continue_expend=[0,0,0,0],this.continue_response_msg=null,this.continue_user_msg=null;var t=this.lastSessionMsg,e=(t.session_id,t.x_msg_id),n=void 0===e?"":e,o=t.x_response_msg_id,r=void 0===o?"":o,c=(t.original_msg_id,t.user_msg),l=void 0===c?"":c,h=(t.msg_end,t.response_msg),v=void 0===h?"":h,f=t.create_at,m=void 0===f?0:f,_=t.support_voice,y=void 0===_?0:_,w=t.voice_duration,C=void 0===w?0:w,k=t.think_duration,O=void 0===k?0:k,I=t.status,S=void 0===I?1:I,D=t.gpt_model,L=void 0===D?"":D,P=t.file_info,j=void 0===P?[]:P,$=t.is_active_upload,T=void 0===$?2:$,M=t.search_results,R=void 0===M?[]:M,A=t.response_json_msg,E=void 0===A?[]:A,B=t.openai_msg,N=void 0===B?[]:B,F=v.match(/\[([^\]]*)\][^\[]*$/);this.continue_expend=F?JSON.parse(F[0]):[0,0,0,0];var U=Object(x.a)(this.continue_expend,4),H=U[0],V=void 0===H?0:H,z=U[1],W=void 0===z?0:z,G=U[2],Y=void 0===G?0:G,K=U[3],J=void 0===K?0:K;this.continue_response_msg={json_content:this.isAgentCharacter?E:[],content:Object(d.k)(v),id:r,role:2,loading:!1,create_at:m,support_voice:y,voice_duration:C,deepseek_time:O,status:S,gpt_model:L,coin:J,num_of_token:Y,search_results:R},this.continue_user_msg={json_content:this.isAgentCharacter?N:[],content:l,id:n,role:1,loading:!1,coin:W,num_of_token:V,file_info:j,is_active_upload:T}},updateHomeUnReadNum:function(){var t=this,e=Object(_t.cloneDeep)(this.lastChatRoleList),n=e.findIndex((function(e){return e.id===t.characterInfo.id}));-1!==n&&(e[n].character.unread_num=0),this.SET_LAST_CHAT_ROLE_LIST(e)},enterSend:function(t){var e=this;t.ctrlKey||t.shiftKey?(this.msg+="\n",this.$nextTick((function(){e.scrollInputToBottom()}))):(t.preventDefault(),this.sendMsg())},handleGuest:function(){var t=this;this.isLoggedIn||this.$EventBus.$emit("openLoginDialog",{callBack:function(){return t.sessionId?t.aiChatIndex.startChat():t.aiChatIndex.newChat()}})},handleKeepSay:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$logEvent("log_actions",{operation:"go_on_talk",behavior_info:"on_tarven_detail_page"}),t.resetSubMsgStatus(),t.handleGuest(),!t.aiChatIndex.checkStatus()){e.next=5;break}return e.abrupt("return");case 5:return t.resetStatus(),n=t.createNewMsgObj("",!1,"","continue"),e.next=9,t.startStream({content:"",session_id:t.sessionId,vip_only:t.characterInfo.vip_only,support_voice:t.characterInfo.support_voice,name:Object(d.h)(t,t.characterInfo)},n,!0);case 9:t.scrollBottom("handleKeepSay");case 10:case"end":return e.stop()}}),e)})))()},checkStatus:function(){if(1e4===this.characterCode)return!1;switch(this.characterCode){case 10610:this.$EventBus.$emit("openBannedMask","bannedTipCharter");break;case 10621:this.$message({type:"warning",message:this.$t("chatFail"),duration:5e3,offset:100})}return!0},loginContinueChat:function(){var t=this;this.isLoggedIn||this.$EventBus.$emit("openLoginDialog",{callBack:function(){console.log("登陆成功后继续聊天，并发送之前保存的消息"),t.currentInputMsg&&(t.chatCount=0,t.aiChatIndex.fetchCharacterDetail(!0),t.msg=t.currentInputMsg,t.sendMsg())}})},sendMsg:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.currentInputMsg=Object(_t.cloneDeep)(t.msg),!(t.chatCount>5||5===t.chatCount)){e.next=4;break}return t.loginContinueChat(),e.abrupt("return");case 4:if(t.scrollBottom("sendMsg"),t.resetSubMsgStatus(),!t.aiChatIndex.checkStatus()){e.next=8;break}return e.abrupt("return");case 8:if(!t.isDisabledSend){e.next=11;break}return console.warn("消息为空、发送中、输入过长、润色中-禁止发送消息"),e.abrupt("return");case 11:return t.resetStatus(),t.closeRecommendMsg(),n=Object(_t.cloneDeep)(t.msg),o=t.createNewMsgObj(n,!0),r=t.characterInfo,c=r.vip_only,l=r.name,e.next=18,t.startStream({content:n,session_id:t.sessionId,vip_only:c,support_voice:t.characterInfo.support_voice,name:l},o);case 18:t.msg="",t.thisTimeSendMsgCount++,2===t.thisTimeSendMsgCount&&t.$logEvent("log_actions",{operation:"real_view",behavior_info:9,behavior_info_sub:t.$route.params.id||m.a});case 21:case"end":return e.stop()}}),e)})))()},startStream:function(t,e){var n=arguments,r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var c,l,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n.length>2&&void 0!==n[2]&&n[2],l={data:t,url:r.isLoggedIn?"/api/stream/character/session/chat_new":"/api/stream/character/session/tourist_chat",isKeep:c,create_time:e},d=Object(_t.cloneDeep)(l),c||!r.isInputChat){o.next=6;break}return setTimeout((function(){d.replyerMsgID=r.createNewMsgObj("",""),r.sendStreamRequest(d)}),500),o.abrupt("return");case 6:return o.next=8,r.sendStreamRequest(d);case 8:case"end":return o.stop()}}),o)})))()},sendStreamRequest:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var data,o,r,c,l,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=t.data,o=t.isKeep,r=void 0!==o&&o,c=t.replyerMsgID,l=void 0===c?"":c,d=t.create_time,h=void 0===d?"":d,v=t.url,f=void 0===v?"":v,m=t.regenerateMsgId,_=void 0===m?"":m,e.scrollBottom("sendMsg"),e.removeCacheMsg(e.sessionId,"发送新消息"),n.prev=3,n.next=6,e.getSSE({url:f,isKeep:r,replyerMsgID:l,create_time:h,regenerateMsgId:_,sendParams:data});case 6:n.next=12;break;case 8:n.prev=8,n.t0=n.catch(3),console.log("sendStreamRequest-err流式:",n.t0),e.streamFinish=!0;case 12:case"end":return n.stop()}}),n,null,[[3,8]])})))()},getSSE:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m,_,y,w,C,k,O;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.characters=[],e.processedLength=0,o=t.url,r=t.isKeep,c=void 0!==r&&r,l=t.replyerMsgID,d=void 0===l?"":l,h=t.create_time,v=void 0===h?"":h,f=t.regenerateMsgId,m=void 0===f?"":f,_=t.sendParams,y=void 0===_?{}:_,console.log("SSE获取消息流--sendParams",y),w=Object.assign({},y),e.isToolCharacter&&(w.on_line_search=c?2:e.on_line_search),w.model=e.currentUseChatModel,w.refer="home"===e.$route.query.from?"home_button":"v1",w.stream=!0,w.messages=[],w.messages=[{role:"text",content:y.content}],e.isAgentCharacter&&c&&(console.log("智能体数字人-继续说场景新增字段last_continue_msg string上次用户对话内容",e.lastUserMsg),w.messages.push({role:"last_continue_msg",content:(null===(C=e.lastUserMsg)||void 0===C?void 0:C.content)||""})),e.file_url.length&&(k=Object(_t.cloneDeep)(e.file_url),w.messages.push({role:"file",content:k.join(",")})),e.file_id.length&&(O=Object(_t.cloneDeep)(e.file_id),w.messages.push({role:"file",content:O.join(",")}),m||(w.is_active_upload=e.is_active_upload)),(e.file_id.length||e.file_url.length)&&(e.$EventBus.$emit("clearSuccessFileList"),e.scrollBottom("clearSuccessFileList")),w.history_message=e.formattedHistoryMessage,o){n.next=18;break}return n.abrupt("return",Promise.reject(new Error("No url provided")));case 18:e.SET_SHOW_SEARCH_RESULT(!1),new Promise((function(t,n){var r,l=null,h=null,f=null,_=!!m,y={token:e.$cookies.get("T"),"Accept-Language":e.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-App-Id":"web_global_seaart","X-Ad-Id":window.$nuxt.$cookies.get("ad"),"X-Device-Id":null===(r=window)||void 0===r||null===(r=r.$nuxt)||void 0===r?void 0:r.$cookies.get("deviceId"),"X-Request-Id":Object(ft.a)()};e.isLoggedIn||delete y.token,e.chatStreamClass=new Be.a({url:o,sessionId:e.sessionId,method:"POST",body:w,headers:y,onUpdate:function(data){e.handleStreamUpdate(data,l)},onFinish:function(t){e.handleStreamFinish(t,{isKeep:c,senderMsgID:h,msgIndex:l,isRegenerate:_})},onError:function(t){e.streamFinish=!0,e.handleStreamError(t),n(t)},onResponseReceived:function(t){var n,o,r,_,y;e.replyerMsgID=null==t||null===(n=t.headers)||void 0===n?void 0:n.get("X-Response-Msg-Id");var w=null==t||null===(o=t.headers)||void 0===o?void 0:o.get("X-Status");if(h=null==t||null===(r=t.headers)||void 0===r?void 0:r.get("X-Msg-Id"),e.chatCount=null==t||null===(_=t.headers)||void 0===_?void 0:_.get("X-Tourist-Chated-Num"),e.handleRegenerateMsg=!1,w&&e.isErrorMsg(w)){if(console.log("handleStreamError--",w),e.subMsgCreateOrSwitchOrRefresh){e.$set(e.msgList[0],"loading",!1);var C=e.msgList[0].sub_msg.length-1;e.msgList[0].content=e.msgList[0].sub_msg[C].content,e.msgList[0].sub_msg.splice(C,1),e.cleanupResources(),e.stopMsgLoading(),e.setSenderMsgRealId(h,v,c)}return e.msgList.length&&e.stopMsgLoading(),!e.handleRegenerateMsg&&e.msgList.splice(0,1),e.handleRegenerateMsg&&(e.msgList[0].content=e.regenerateMsgCopy,e.handleRegenerateMsg=!1,e.regenerateMsgCopy=""),void e.cleanupResources()}e.subMsgCreateOrSwitchOrRefresh&&(e.subMsgUpdateObj.id=e.replyerMsgID,e.setReplyerMsgRealId(e.replyerMsgID,e.msgList.length-1),e.setSenderMsgRealId(h,v,c)),f=m||(c?v:d),-1===(l=e.msgList.findIndex((function(t){return t.id===f||t.create_at===f})))&&(l=0),2!==(null===(y=e.msgList[l])||void 0===y?void 0:y.role)||m||e.setReplyerMsgRealId(e.replyerMsgID,l),e.msgList[l]&&(e.$set(e.msgList[l],"showVoice",!1),e.stopMsgLoading(l)),e.setSenderMsgRealId(h,v,c)}}),e.chatStreamClass.fetchSSE()}));case 20:case"end":return n.stop()}}),n)})))()},getSSEContain:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.aiChatIndex.checkStatus()&&t.isLoggedIn){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.pushMsgToList(!0);case 5:t.cleanupResources(),t.resetStatus(),t.closeRecommendMsg(),t.$set(t.msgList[0],"loading",!0),n={session_id:t.lastSessionMsg.session_id||t.sessionId,history_message:t.formattedHistoryMessage},t.chatStreamClass=new Be.a({url:"/api/stream/character/session/msg/continue_new",sessionId:t.sessionId,method:"POST",body:n,headers:{token:t.$cookies.get("T"),"Accept-Language":t.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-App-Id":"web_global_seaart","X-Ad-Id":window.$nuxt.$cookies.get("ad"),"X-Request-Id":Object(ft.a)()},onUpdate:function(data){t.containSSEUpdateFn(data)},onFinish:function(e){t.containSSEFinishFn(e)},onError:function(e){t.streamFinish=!0,t.handleStreamError(e)},onResponseReceived:function(e){var n,o;t.replyerMsgID=null==e||null===(n=e.headers)||void 0===n?void 0:n.get("X-Response-Msg-Id");var r=null==e||null===(o=e.headers)||void 0===o?void 0:o.get("X-Status");if(t.handleRegenerateMsg=!1,r&&t.isErrorMsg(r))return console.log("handleStreamError--ErrorCode",r),void t.cleanupResources()}}),t.chatStreamClass.fetchSSE(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),t.stopMsgLoading();case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()},containSSEUpdateFn:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,content,o,r,c,l,d,h,v,f,m,_,y,w,C,k,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=data.content,content=void 0===n?"":n,o=data.originalMsg,r=void 0===o?"":o,c=data.sessionId,l=void 0===c?"":c,d=data.resource_results,(h=void 0===d?[]:d).length&&(v=[],h.forEach((function(t){v.push({file_path:t.url,task_id:t.resource_id,file_ext:t.extension,position:t.position,file_width:t.file_width||null,file_height:t.file_height||null,is_generating:t.is_generating||!1,is_nsfw_plus:t.is_nsfw_plus||!1,nsfw:t.nsfw||0})})),t.$set(t.msgList[0],"file_info",v)),f=localStorage.getItem("cacheMsg"),m="",f)try{_=JSON.parse(f),Array.isArray(_)&&(y=_.find((function(t){return t.session_id===l})))&&(m=y.msg)}catch(t){console.error("解析缓存消息失败",t),m=""}if(r&&(w=m?m.length:0,(!m||r.length>w)&&t.setCacheMsg(l,r)),!m||!t.msgList[0]){e.next=21;break}if(t.hasInitializedWithCache||!(m.length>0)){e.next=17;break}return t.hasInitializedWithCache=!0,t.$set(t.msgList[0],"content",m),t.cachedContentLength=m.length,e.next=14,t.$nextTick();case 14:return t.scrollBottom("initWithCache"),r&&r.length>m.length&&(C=r.substring(m.length)).length>0&&(t.contentQueue.push({content:C}),t.isProcessing||(t.isProcessing=!0,t.processQueue())),e.abrupt("return");case 17:if(!t.hasInitializedWithCache||void 0===t.cachedContentLength){e.next=21;break}return(k=r||t.msgList[0].content+content).length>t.cachedContentLength&&(O=k.substring(t.cachedContentLength)).length>0&&(t.contentQueue.push({content:O}),t.cachedContentLength=k.length,t.isProcessing||(t.isProcessing=!0,t.processQueue())),e.abrupt("return");case 21:if(t.contentQueue.push({content:content}),t.isProcessing){e.next=26;break}return t.isProcessing=!0,e.next=26,t.processQueue();case 26:case"end":return e.stop()}}),e)})))()},stopMsgLoading:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.msgList[t]&&this.msgList[t].loading&&this.$set(this.msgList[t],"loading",!1),this.subMsgUpdateObj&&this.subMsgUpdateObj.loading&&this.$set(this.subMsgUpdateObj,"loading",!1)},containSSEFinishFn:function(t){var e=this,n=t.originalMsg,o=t.expend,r=void 0===o?[]:o,c=t.thinkDuration,l=t.sessionId,h=t.search_results,v=void 0===h?[]:h;if(console.log("消息流结束回调-续接消息",n,r,c,v),this.removeCacheMsg(l,"流式结束"),this.scrollBottom("containSSEFinishFn"),this.streamFinish=!0,this.contentQueue||(this.contentQueue=[]),r.length){var f,m=Object(x.a)(r,4),_=m[0],y=m[1],w=m[2],C=m[3];if(this.lastSessionMsg.original_msg_id)return this.subMsgUpdateObj.coin=C,this.subMsgUpdateObj.num_of_token=w,this.subMsgUpdateObj.content=Object(d.k)(n),this.subMsgUpdateObj.sub_msg_id=this.lastSessionMsg.x_response_msg_id,this.subMsgUpdateObj.deepseek_time=c,this.subMsgUpdateObj.id=this.lastSessionMsg.x_response_msg_id,this.subMsgUpdateObj.search_results=v,this.$set(this.msgList[0],"coin",C),this.$set(this.msgList[0],"num_of_token",w),this.$set(this.msgList[0],"sub_msg_id",this.lastSessionMsg.x_response_msg_id),this.$set(this.msgList[0],"deepseek_time",c),this.$set(this.msgList[0],"search_results",v),void this.$nextTick((function(){e.updateSubMsg2(),e.getPaymentInfo()}));this.msgList[0]&&(this.$set(this.msgList[0],"coin",C),this.$set(this.msgList[0],"num_of_token",w),this.$set(this.msgList[0],"deepseek_time",c)),f=this.msgList.findIndex((function(t){return t.id===e.lastSessionMsg.x_msg_id})),this.msgList[f]&&(this.$set(this.msgList[f],"coin",y),this.$set(this.msgList[f],"num_of_token",_),this.$set(this.msgList[f],"deepseek_time",c))}this.getPaymentInfo()},handleStreamUpdate:function(data,t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,content,r,c,l,d,h,v,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=data.content,content=void 0===o?"":o,r=data.originalMsg,c=void 0===r?"":r,l=data.sessionId,d=void 0===l?"":l,h=data.resource_results,(v=void 0===h?[]:h).length&&(f=[],v.forEach((function(t){f.push({file_path:t.url,task_id:t.resource_id,file_ext:t.extension,position:t.position,file_width:t.file_width||null,file_height:t.file_height||null,is_generating:t.is_generating||!1,is_nsfw_plus:t.is_nsfw_plus||!1,nsfw:t.nsfw||0})})),e.$set(e.msgList[t],"file_info",f)),e.setCacheMsg(d,c),m=e.subMsgCreateOrSwitchOrRefresh?0:t,e.contentQueue.push({content:content,msgIndex:t}),e.isProcessing){n.next=9;break}return e.isProcessing=!0,n.next=9,e.processQueue(m);case 9:case"end":return n.stop()}}),n)})))()},processQueue:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,content,d,h,v,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:0,e.stopMsgLoading(o),r=null,n.prev=3,e.contentQueue&&0!==e.contentQueue.length){n.next=7;break}return e.isProcessing=!1,n.abrupt("return");case 7:if(e.streamFinish&&!(e.contentQueue.length>0)||!e.contentQueue){n.next=41;break}if(l=e.contentQueue.shift()){n.next=13;break}return n.next=12,e.wait(e.typingSpeed);case 12:return n.abrupt("continue",7);case 13:if(content=l.content,d=l.msgIndex,r=h=void 0===d?0:d,v=e.subMsgCreateOrSwitchOrRefresh?0:h,e.msgList[v]){n.next=18;break}return n.abrupt("continue",7);case 18:if(e.msgList[v].content){n.next=22;break}return e.$set(e.msgList[v],"content",""),n.next=22,e.$nextTick();case 22:if((f=document.createElement("div")).className="msg-content-deepseek",f.style.position="absolute",f.style.visibility="hidden",f.style.width=(null===(c=e.msgList[v].$el)||void 0===c||null===(c=c.querySelector(".msg-content-deepseek"))||void 0===c?void 0:c.offsetWidth)+"px",f.innerHTML=e.msgList[v].content+content,document.body.appendChild(f),e.$set(e.msgList[v],"content",e.msgList[v].content+content),document.body.removeChild(f),!(e.accumulatedChars>=e.SCROLL_BATCH_SIZE||0===e.contentQueue.length)){n.next=36;break}return n.next=34,e.$nextTick();case 34:e.shouldAutoScroll&&e.scrollBottom("processQueue_batch"),e.accumulatedChars=0;case 36:return e.accumulatedChars+=content.length,n.next=39,e.wait(e.typingSpeed);case 39:n.next=7;break;case 41:return e.streamFinish=!1,e.characters=[],e.processedLength=0,e.isProcessing=!1,e.hasInitializedWithCache=!1,e.cachedContentLength=void 0,null!==r&&(m=r,e.msgList[m]&&e.$set(e.msgList[m],"showVoice",!0)),n.next=50,e.$nextTick();case 50:n.next=56;break;case 52:n.prev=52,n.t0=n.catch(3),console.error("处理消息队列时出错:",n.t0),e.isProcessing=!1;case 56:return n.prev=56,e.shouldAutoScroll&&e.scrollBottom("processQueue_end"),n.finish(56);case 59:case"end":return n.stop()}}),n,null,[[3,52,56,59]])})))()},setSenderMsgRealId:function(t,e){if(t&&!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]))try{var n=this.msgList.findIndex((function(t){return t.create_at===e}));console.log("senderMsgID",t,"create_time",e,"senderMsgIndex",n),-1!==n&&(this.msgList[n].id=t)}catch(t){console.error("设置消息发送者的真实id-error:",t),this.scrollBottom("setSenderMsgRealId_error")}},setReplyerMsgRealId:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t)try{this.msgList[e].id=this.replyerMsgID}catch(t){console.error("设置数字人回复消息的真实id-error:",t),this.scrollBottom("setReplyerMsgRealId_error")}},setCacheMsg:function(t,e){if(e){var n=t,o=[],r=localStorage.getItem("cacheMsg");if(r)try{o=JSON.parse(r),Array.isArray(o)||(o=[])}catch(t){console.error("解析存储的消息数组失败",t),o=[]}var c=o.findIndex((function(t){return t.session_id===n}));-1!==c?o[c].msg=e:(o.push({session_id:n,msg:e}),o.length>4&&o.shift()),localStorage.setItem("cacheMsg",JSON.stringify(o))}},removeCacheMsg:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(console.log("清除缓存消息",t,e),t){var n=localStorage.getItem("cacheMsg");if(n)try{var o=JSON.parse(n);if(Array.isArray(o)){var r=o.filter((function(e){return e.session_id!==t}));0===r.length?localStorage.removeItem("cacheMsg"):r.length!==o.length&&localStorage.setItem("cacheMsg",JSON.stringify(r))}}catch(t){console.error("解析cacheOriginalMsg失败",t)}}},handleStreamFinish:function(t,e){var n=this;console.log("消息流结束回调--",t,e);var o=e.isKeep,r=void 0!==o&&o,c=e.senderMsgID,l=void 0===c?"":c,h=e.msgIndex,v=void 0===h?null:h,f=e.isRegenerate,m=void 0!==f&&f,_=t.originalMsg,y=t.expend,w=void 0===y?[]:y,C=t.thinkDuration,k=t.sessionId,O=t.search_results,I=void 0===O?[]:O;if(this.streamFinish=!0,this.contentQueue||(this.contentQueue=[]),this.removeCacheMsg(k,"流式结束"),this.scrollBottom("handleStreamFinish"),w.length){var S=Object(x.a)(w,4),D=S[0],L=S[1],P=S[2],j=S[3],$=null,T=Object(d.k)(_);if(this.subMsgCreateOrSwitchOrRefresh)return this.subMsgUpdateObj.coin=j,this.subMsgUpdateObj.num_of_token=P,this.subMsgUpdateObj.content=T,this.subMsgUpdateObj.sub_msg_id=this.replyerMsgID,this.subMsgUpdateObj.deepseek_time=C,this.subMsgUpdateObj.search_results=I,this.$set(this.msgList[0],"coin",j),this.$set(this.msgList[0],"num_of_token",P),this.$set(this.msgList[0],"sub_msg_id",this.replyerMsgID),this.$set(this.msgList[0],"deepseek_time",C),this.$set(this.msgList[0],"search_results",I),this.handleUpdateHistoryMessage("replace",0,T),void this.$nextTick((function(){n.updateSubMsg(),n.getPaymentInfo()}));this.msgList[v]&&(this.$set(this.msgList[v],"coin",j),this.$set(this.msgList[v],"num_of_token",P),this.$set(this.msgList[v],"deepseek_time",C),this.$set(this.msgList[v],"search_results",I)),!l||r||m||($=this.msgList.findIndex((function(t){return t.id===l})),console.log("handleStreamFinish--设置发送方的消息附属信息--",$),this.msgList[$]&&(this.$set(this.msgList[$],"coin",L),this.$set(this.msgList[$],"num_of_token",D),this.$set(this.msgList[$],"deepseek_time",C)))}this.getPaymentInfo()},updateSubMsg:function(){var t,e=this;if(this.subMsgUpdateObj.content&&!this.subMsgRefreshIndex||(this.subMsgUpdateObj.content=this.msgList[0].content),this.subMsgUpdateObj.gpt_model=this.gpt_model||(null===(t=this.characterSetting)||void 0===t?void 0:t.gpt_model),this.subMsgRefreshIndex){if(1===this.subMsgRefreshIndex)return this.$set(this.msgList[0],"content",this.subMsgUpdateObj.content),this.$set(this.msgList[0],"sub_msg_id",this.subMsgUpdateObj.id),this.$set(this.msgList[0],"search_results",this.subMsgUpdateObj.search_results),this.$set(this.msgList[0],"deepseek_time",this.subMsgUpdateObj.deepseek_time),void(this.subMsgRefreshIndex=null);var n=this.msgList[0].sub_msg[this.subMsgRefreshIndex-2];return this.$set(this.msgList[0],"content",this.subMsgUpdateObj.content),this.$set(this.msgList[0],"sub_msg_id",n.id),this.$set(this.msgList[0],"search_results",this.subMsgUpdateObj.search_results),this.$set(this.msgList[0],"deepseek_time",this.subMsgUpdateObj.deepseek_time),void(this.subMsgRefreshIndex=null)}console.log("setLastMsg--常规处理--push",this.subMsgUpdateObj,this.msgList[0].content);var o=Object(_t.cloneDeep)(this.msgList[0].sub_msg||[]);o.push(this.subMsgUpdateObj),this.$set(this.msgList[0],"sub_msg",o),this.$nextTick((function(){var t,n=null===(t=e.msgList[0].sub_msg)||void 0===t?void 0:t.findIndex((function(t){return t.id===e.subMsgUpdateObj.id}));console.log("setLastMsg--更新设置子消息索引--1",n),e.$refs.aiChatMsg.currentSubMsgIndex=n+2,n&&e.$refs.aiChatMsg.setCurrentSubMsgIndex(n+2),console.log("setLastMsg--更新设置子消息索引--2",n+2),e.$refs.aiChatMsg.updateCurrentRating(e.subMsgUpdateObj)}))},updateSubMsg2:function(){var t,e,n=this;if(this.msgList[0].sub_msg||(this.msgList[0].sub_msg=[]),this.subMsgUpdateObj.content&&"refresh_msg"!==this.lastSessionMsg.msg_type||(this.subMsgUpdateObj.content=this.msgList[0].content),this.subMsgUpdateObj.gpt_model=this.lastSessionMsg.gpt_model||this.gpt_model||(null===(t=this.characterSetting)||void 0===t?void 0:t.gpt_model),"refresh_msg"===this.lastSessionMsg.msg_type){var o,r=this.msgList[0].id===this.lastSessionMsg.x_msg_id;if(console.log("updateSubMsg2--刷新消息-- 对子消息自身的操作进行消息替换处理",r),r)return this.$set(this.msgList[0],"content",this.subMsgUpdateObj.content),void this.$set(this.msgList[0],"sub_msg_id",this.subMsgUpdateObj.id);var c=null===(o=this.msgList[0].sub_msg)||void 0===o?void 0:o.findIndex((function(t){return t.id===n.lastSessionMsg.x_msg_id}));return console.log("updateSubMsg2--操作子消息 并将主消息切换为子消息",c),void(this.msgList[0].sub_msg[c]&&(this.msgList[0].sub_msg[c].content=this.subMsgUpdateObj.content,this.$set(this.msgList[0],"content",this.msgList[0].sub_msg[c].content),this.$set(this.msgList[0],"sub_msg_id",this.msgList[0].sub_msg[c].id),this.$set(this.msgList[0],"deepseek_time",this.msgList[0].sub_msg[c].deepseek_time),this.$set(this.msgList[0],"search_results",this.msgList[0].sub_msg[c].search_results)))}console.log("setLastMsg--生成新的子消息",this.subMsgUpdateObj,this.msgList[0].content),null===(e=this.msgList[0].sub_msg)||void 0===e||e.push(this.subMsgUpdateObj),this.$nextTick((function(){var t,e=null===(t=n.msgList[0].sub_msg)||void 0===t?void 0:t.findIndex((function(t){return t.id===n.subMsgUpdateObj.id}));n.$refs.aiChatMsg.currentSubMsgIndex=e+2,e&&n.$refs.aiChatMsg.setCurrentSubMsgIndex(e+2),n.$refs.aiChatMsg.updateCurrentRating(n.subMsgUpdateObj)}))},handleStreamError:function(t){var e,n,o,r=this;console.error("流式错误统一处理:",null===(e=t.message)||void 0===e?void 0:e.toLowerCase()),["network"].includes(null===(n=t.message)||void 0===n?void 0:n.toLowerCase())?setTimeout((function(){console.log("网络中断-执行探针逻辑"),r.checkStackingMsg(!1,!0)}),1e3):["closed"].includes(null===(o=t.message)||void 0===o?void 0:o.toLowerCase())?this.checkStackingMsg():("SSE request aborted"===t&&console.log("流式中断"),this.cleanupResources("SSE request aborted"===t))},wait:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})))()},isErrorMsg:function(t){var e=this;console.log("isErrorMsg--",t);try{if("60003"===t)return this.aiChatIndex.chatFreePermissionsFull?(this.$EventBus.$emit("openLoginDialog",{callBack:function(){e.currentInputMsg&&localStorage.setItem("currentInputMsg",e.currentInputMsg),e.chatCount=0,e.aiChatIndex.initPage()}}),!0):(this.aiChatIndex.updateRecentChat(),this.msgList.shift(),this.loginContinueChat(),!0);var n,o={70039:["showVipComputingDialog","vipDialogComputedTit2"],70010:["showBreakDialog","VipTip","basic"],80008:this.isVip?["showVipComputingDialog"]:["showNotVipComputingDialog"],10200:"Failed to get message"};if(t&&o[t])return(n=this.$EventBus).$emit.apply(n,Object(I.a)(o[t])),!0}catch(t){return!1}},createNewMsgObj:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal";console.log("createMsg--",t,e,n);var r=(new Date).getTime(),c=e?Object(_t.cloneDeep)(this.fileInfo):[],l={content:t,create_at:r,role:e?1:2,id:n||r,coin:"",num_of_token:"",loading:!Boolean(e),isDisabled:!1,deepseek_time:0,recommend:"popup"===t,hasKeep:!1,showVoice:!0,file_info:c,gpt_model:this.currentUseChatModel,is_active_upload:1,search_results:[],scene:o};return this.scrollBottom("createNewMsgObj"),this.subMsgCreateOrSwitchOrRefresh?(this.subMsgUpdateObj=l,console.log("subMsgUpdateObj",this.subMsgUpdateObj),r):(this.msgList.unshift(l),r)},handleMsg:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m,_,y,content,w,C,k,O,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("消息操作--",t),e.$EventBus.$emit("stopAudio"),r=(o=t||{}).msg,c=void 0===r?{}:r,l=o.type,d=void 0===l?"":l,h=o.inputValue,v=void 0===h?"":h,m=(f=c||{}).id,_=void 0===m?"":m,y=f.content,content=void 0===y?"":y,w=f.subMsgIndex,C=void 0===w?"":w,k=f.gpt_model,O=void 0===k?"":k,x=e.msgList.findIndex((function(t){return t.id===_}))||0,e.SET_SHOW_SEARCH_RESULT(!1),n.t0=d,n.next="DEL"===n.t0?9:"EDIT"===n.t0?12:"REGENERATE"===n.t0?14:"ADDSUBMSG"===n.t0?16:"SWITCHMSG"===n.t0?19:"KEEPSAY"===n.t0?22:"LOADMORE"===n.t0?25:"CUSTOM_INSTRUCTION"===n.t0?30:32;break;case 9:return e.resetSubMsgStatus(),e.delMsg(x),n.abrupt("break",33);case 12:return e.editMsg(x,content,C,_),n.abrupt("break",33);case 14:return e.regenerateMsg(x,C),n.abrupt("break",33);case 16:return console.log("子消息新增操作"),e.getSubMsg(x,O),n.abrupt("break",33);case 19:return console.log("子消息切换查看操作",C),e.switchSubMsg(C),n.abrupt("break",33);case 22:return e.resetSubMsgStatus(),e.handleKeepSay(),n.abrupt("break",33);case 25:if(!e.isInitializing&&e.hasMoreMessages){n.next=27;break}return n.abrupt("return");case 27:return e.resetSubMsgStatus(),e.getChatMsgLIst(),n.abrupt("break",33);case 30:return e.msg=v,n.abrupt("break",33);case 32:return n.abrupt("break",33);case 33:case"end":return n.stop()}}),n)})))()},switchSubMsg:function(t){var e=this;if(console.log("切换消息--",t),this.gpt_model="",1===t)return console.log("switchSubMsg--切换为主消息",this.mainMsgContent),this.$set(this.msgList[0],"content",this.mainMsgContent.content),this.$set(this.msgList[0],"deepseek_time",this.mainMsgContent.deepseek_time),this.$set(this.msgList[0],"num_of_token",this.mainMsgContent.num_of_token),this.$set(this.msgList[0],"coin",this.mainMsgContent.coin),this.$set(this.msgList[0],"sub_msg_id",this.mainMsgContent.id),this.$set(this.msgList[0],"search_results",this.mainMsgContent.search_results),void this.handleUpdateHistoryMessage("replace",0,this.mainMsgContent.content);var n=t-2,o=this.msgList[0].sub_msg[n];this.$set(this.msgList[0],"content",o.content),this.$set(this.msgList[0],"num_of_token",o.num_of_token),this.$set(this.msgList[0],"coin",o.coin),this.$set(this.msgList[0],"sub_msg_id",o.id),this.$set(this.msgList[0],"deepseek_time",o.deepseek_time),this.$set(this.msgList[0],"search_results",o.search_results),this.handleUpdateHistoryMessage("replace",0,o.content),this.$nextTick((function(){e.scrollBottom("switchSubMsg")}))},updateMainMsg:function(t){var e,source=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",n=Object(_t.cloneDeep)(t);console.log("更新主消息---",n,"来源:",source);var o=n.content,content=void 0===o?"":o,r=n.coin,c=void 0===r?0:r,l=n.num_of_token,d=void 0===l?0:l,h=n.deepseek_time,v=void 0===h?0:h,f=n.id,m=void 0===f?"":f,_=n.sub_msg_id,y=void 0===_?"":_,w=n.active_idx,C=void 0===w?0:w,k=n.search_results,O=void 0===k?[]:k,x=n.role,I=void 0===x?2:x;this.mainMsgContent={content:content,coin:c,num_of_token:d,deepseek_time:v,id:m||(null===(e=this.mainMsgContent)||void 0===e?void 0:e.id)||"",sub_msg_id:y,active_idx:C,search_results:O,role:I}},getSubMsg:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,h,v,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]?e[1]:"",console.log("getSubMsg--",t),o.prev=2,-1!==t&&!n.sendLoading&&!n.optimizeIng){o.next=6;break}return n.$message.error(n.$t("ChapterLoading")),o.abrupt("return");case 6:return n.gpt_model=r,n.getSubMsgObj=!0,n.closeRecommendMsg(),n.msgList[t].sub_msg&&null!==(c=n.msgList[t].sub_msg)&&void 0!==c&&c.length||n.updateMainMsg(n.msgList[t],"getSubMsg"),n.msgList[t].sub_msg||n.$set(n.msgList[t],"sub_msg",[]),n.msgList[t].content="",n.$set(n.msgList[t],"loading",!0),h=(null===(l=n.msgList.find((function(t){return 1===t.role})))||void 0===l?void 0:l.content)||"",console.log("准备请求参数",t,n.msgList[t]),v={original_msg_id:n.mainMsgContent.id,content:h,session_id:n.sessionId,vip_only:n.characterInfo.vip_only,support_voice:n.characterInfo.support_voice,name:Object(d.h)(n,n.characterInfo)},f=n.createNewMsgObj("",!1),o.next=19,n.startStream(v,f,!1);case 19:o.next=27;break;case 21:o.prev=21,o.t0=o.catch(2),console.error("获取子消息失败:",o.t0,n.mainMsgContent),n.resetStatus(),-1!==t&&(n.$set(n.msgList[t],"loading",!1),n.msgList[t].content=n.mainMsgContent.content,n.msgList[t].coin=n.mainMsgContent.coin,n.msgList[t].num_of_token=n.mainMsgContent.num_of_token,n.msgList[t].sub_msg_id=n.mainMsgContent.id||n.mainMsgContent[t].sub_msg_id,n.msgList[t].deepseek_time=n.mainMsgContent.deepseek_time),n.$message.error(n.$t("Failed to get sub message"));case 27:return o.prev=27,n.scrollBottom("getSubMsg"),o.finish(27);case 30:case"end":return o.stop()}}),o,null,[[2,21,27,30]])})))()},resetStatus:function(){this.characters=[],this.processedLength=0,this.gpt_model="",this.updateMainMsg({coin:0,num_of_token:0,deepseek_time:0,sub_msg_id:"",active_idx:0},"resetStatus"),this.subMsgUpdateObj={content:"",loading:!1},this.getSubMsgObj=!1,this.isProcessing=!1,this.contentQueue=[],this.$refs.aiChatMsg.currentSubMsgIndex=this.$refs.aiChatMsg.oldCurrentSubMsgIndex||1,this.processQueueTimer&&clearTimeout(this.processQueueTimer)},regenerateMsg:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(console.log("重生成消息--",t,this.sessionId,e),!this.aiChatIndex.checkStatus()){this.getSubMsgObj=!1;var n=this.msgList.find((function(t){return 1===t.role}));if(console.log("重生成消息--",n.content),n){n.content;var o=n.id,r=this.msgList[t].id;if(o&&r){this.regenerateMsgCopy=this.msgList[t].content,this.msgList[t].content="",this.$set(this.msgList[t],"loading",!0),this.handleRegenerateMsg=!0;var c={data:{last_msg_id:"number"==typeof o?String(o):o,msg_id:r,session_id:this.sessionId,support_voice:this.characterInfo.support_voice},url:"/api/stream/character/session/msg/refresh_new",regenerateMsgId:r};e&&(c.data.active_idx=e,this.subMsgRefreshIndex=e),[null,void 0,""].includes(r)&&(delete c.data.msg_id,delete c.data.last_msg_id),this.file_id.length&&(c.data.file_id=Object(_t.cloneDeep)(this.file_id),this.clearSuccessFileList(),this.scrollBottom("clearSuccessFileList")),this.sendStreamRequest(c),this.scrollBottom("regenerateMsg")}else console.warn("重生成消息-参数缺失",o,r)}else console.warn("未找到用户消息")}},editMsg:function(t,content){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(console.log("编辑消息--",t,content,e),e&&1!==e)return this.msgList[t].sub_msg[e-2].content=content,this.switchSubMsg(e),void this.handleUpdateHistoryMessage("replace",0,content);this.updateMainMsg(this.msgList[t],"editMsg"),this.msgList[t].content=content;var o=this.historyMessageList.findIndex((function(t){return t.id===n}));this.handleUpdateHistoryMessage("replace",o,content)},delMsg:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,o=e.$refs.aiChatMsg&&e.$refs.aiChatMsg.$refs.msgListDom,r=o?o.scrollTop:0,2!==(c=e.msgList.slice(t-1,t+1).map((function(t){return null==t?void 0:t.id}))).length){n.next=7;break}return n.next=7,Object(D.j)({ids:c,session_id:e.sessionId,parent_id:e.msgList[t].id});case 7:e.msgList.splice(t-1,2),e.handleUpdateHistoryMessage("del",t-1),e.$nextTick((function(){o&&(o.scrollTop=r,console.log("删除消息后恢复滚动位置:",r))})),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.error("Error deleting messages:",n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))()},cleanupResources:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(console.log("触发清理资源--",t),this.contentQueue=[],this.resetSubMsgStatus(),this.SET_PAGE_LOADING(!1),this.lastScrollTime=0,this.accumulatedChars=0,this.characters=[],this.processedLength=0,this.replyerMsgID="",this.isProcessing=!1,this.msgList=this.msgList.filter((function(t){return!t.loading})),this.chatStreamClass&&(this.chatStreamClass.abort(),this.chatStreamClass=null),this.scrollTimer&&clearTimeout(this.scrollTimer),t)return console.log("流式中断",this.msgList[0]),this.$set(this.msgList[0],"loading",!1),this.$set(this.msgList[0],"isAbort",1),void this.scrollBottom("Abort");this.scrollBottom("cleanupResources")},resetSubMsgStatus:function(){this.subMsgCreateOrSwitchOrRefresh&&(this.getSubMsgObj=!1,this.subMsgRefreshIndex=null)},checkMsgExistsById:function(t){if(this.msgList.some((function(e){return e.id===t})))return!0;var e,n=Ke(this.msgList);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.sub_msg&&Array.isArray(o.sub_msg)&&o.sub_msg.some((function(e){return e.id===t})))return!0}}catch(t){n.e(t)}finally{n.f()}return!1},scrollInputToBottom:function(){var t,textarea=null===(t=this.$refs.aichatInput)||void 0===t||null===(t=t.$el)||void 0===t?void 0:t.querySelector("textarea");if(textarea){var e=textarea.selectionStart,n=textarea.selectionEnd;textarea.scrollTop=textarea.scrollHeight,textarea.setSelectionRange(e,n)}},handleLatestMessages:function(){var t=this;this.msgList&&this.msgList.length&&this.msgLoadingOver&&!this.subMsgCreateOrSwitchOrRefresh&&this.msgList.slice(0,2).forEach((function(e){e.sub_msg&&Array.isArray(e.sub_msg)&&t.mainMsgContent&&t.mainMsgContent.id&&t.mainMsgContent.role&&t.mainMsgContent.content?t.ADD_HISTORY_MESSAGE(t.mainMsgContent):t.ADD_HISTORY_MESSAGE(e)}))},handleGlobalKeydown:function(t){var e=this,n=document.activeElement;"INPUT"===n.tagName||"TEXTAREA"===n.tagName||"true"===n.contentEditable||n.closest(".el-input")||"Enter"!==t.key||t.shiftKey||t.altKey||t.ctrlKey||t.metaKey||(t.stopPropagation(),t.preventDefault(),this.$nextTick((function(){var t;null===(t=e.$refs)||void 0===t||null===(t=t.aichatInput)||void 0===t||t.focus()})))}})},ti=Ze,ei=(n(5172),n(5173),Object(v.a)(ti,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"aichat-body hide-scrollbar",class:{"has-file":t.successFileList.length,"hide-content":!t.isShowChat}},[e("AiChatMsg",{ref:"aiChatMsg",on:{handle:t.handleMsg,shouldAutoScroll:t.handleShouldAutoScroll}}),t._v(" "),e("div",{staticClass:"ai-chat-input-box flex-center"},[e("AiChatCardManagePopup",{directives:[{name:"show",rawName:"v-show",value:t.isShowCardManage,expression:"isShowCardManage"}],ref:"aiChatCardManagePopup"}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showMoreOptions,expression:"showMoreOptions"},{name:"click-outside",rawName:"v-click-outside",value:t.handleClickOutside,expression:"handleClickOutside"}],staticClass:"more-function-box"},[e("div",{staticClass:"more-function-close",on:{click:function(e){t.showMoreOptions=!1}}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"more-function-title"},[e("span",[t._v(t._s(t.$t("selectFun")))])]),t._v(" "),e("div",{staticClass:"more-function-item-box"},[t.isToolCharacter?e("div",{staticClass:"more-function-item",class:{disabled:t.onlineSearch},on:{click:function(e){return t.handleAction("uploadFile")}}},[e("el-tooltip",{staticClass:"item",attrs:{"visible-arrow":!1,"popper-class":"file-info-tooltip",effect:"dark",placement:"top"}},[e("div",{staticClass:"more-function-item-content"},[e("i",{staticClass:"iconfont icon-wenjian"}),t._v(" "),e("span",[t._v(t._s(t.$t("file")))])]),t._v(" "),e("div",{class:{disabled:t.onlineSearch},attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"tooltip-title"},[e("i",{staticClass:"iconfont icon-explanation"}),t._v(" "),e("span",{staticClass:"tooltip-title-text"},[t._v("\n                  "+t._s(t.onlineSearch?t.$t("searchNoUpload"):t.$t("uploadTextOnly"))+"\n                ")])]),t._v(" "),t.onlineSearch?t._e():e("div",{staticClass:"tooltip-content"},[t._v("\n                "+t._s(t.$t("supportFormat",{format:"PNG、JPG、TXT、PDF、Word、JSON、Markdown",max:"5M"}))+"\n              ")])])])],1):t._e(),t._v(" "),t.isAgentCharacter?e("div",{staticClass:"more-function-item",class:{disabled:t.onlineSearch},on:{click:function(e){return t.handleAction("uploadFile")}}},[e("i",{staticClass:"iconfont icon-a-addimg"}),t._v(" "),e("span",[t._v(t._s(t.$t("Image")))])]):t._e()])]),t._v(" "),t.isLoggedIn?e("AiChatRecModelPopup",{ref:"aiChatRecModelPopup"}):t._e(),t._v(" "),e("AiChatFileUpload",{ref:"aiChatFileList",attrs:{uploadType:t.isAgentCharacter?"image":"any",uploadCount:t.isAgentCharacter?2:5},on:{scrollBottom:function(){return t.scrollBottom("uploadFile")}}}),t._v(" "),e("div",{staticClass:"input-panel flex-center",class:{"max-input":t.maxInput}},[e("el-input",{ref:"aichatInput",attrs:{type:"textarea",placeholder:t.$t("gpt_input_placeholder_mobile"),autosize:{minRows:1,maxRows:6}},on:{focus:t.scrollInputToBottom},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.enterSend.apply(null,arguments))}},model:{value:t.messageInput,callback:function(e){t.messageInput=e},expression:"messageInput"}}),t._v(" "),e("div",{staticClass:"send-handle-box",class:{"send-handle-box-space-between":t.isToolCharacter||t.isDigitalCharacter}},[t.isDigitalCharacter?e("AiChatTalkModelSelect"):t._e(),t._v(" "),t.isToolCharacter?e("div",{staticClass:"send-handle-item1"},[e("div",{staticClass:"deep-seek-tool-item",class:{active:"Deepseek-R1"===t.currentUseChatModel},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSetR1.apply(null,arguments)}}},[e("i",{staticClass:"iconfont icon-sikao"}),t._v(" "),e("span",[t._v(t._s(t.$t("deepThinking",{tag:"(R1)"})))])]),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{disabled:!t.hasUploadFile,effect:"dark",placement:"top","visible-arrow":!1,"popper-class":"ai-chat-search-tooltip"}},[e("div",{staticClass:"deep-seek-tool-item search-tool-item",class:{active:1===t.on_line_search,disabled:t.hasUploadFile},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSearch.apply(null,arguments)}}},[e("i",{staticClass:"iconfont icon-lianwang"}),t._v(" "),e("span",[t._v(t._s(t.$t("webSearch")))])]),t._v(" "),e("template",{slot:"content"},[e("div",{staticClass:"tip-box"},[e("i",{staticClass:"iconfont icon-explanation"}),t._v("\n                "+t._s(t.$t("deleteFirst"))+"\n              ")])])],2)],1):t._e(),t._v(" "),e("div",{staticClass:"send-handle-item2"},[t.msgLoadingOver?[t.optimizeIng?e("i",{staticClass:"el-icon-loading"}):e("i",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"msg"}],staticClass:"iconfont icon-mofabang2",on:{click:t.handleOptimizeChat}})]:t._e(),t._v(" "),t.msgLoadingOver?e("div",{staticClass:"auto-chat-btn"},[e("i",{staticClass:"iconfont icon-linggan",on:{click:t.handleShowPopup}})]):t._e(),t._v(" "),t.isLoggedIn&&!t.isDigitalCharacter?e("div",{staticClass:"more-handle-box"},[e("i",{staticClass:"iconfont",class:[t.showMoreOptions?"icon-guanbi":"icon-tianjia"],on:{click:function(e){return e.stopPropagation(),t.handleShowMorePopup.apply(null,arguments)}}})]):t._e(),t._v(" "),t.msgLoadingOver?e("i",{staticClass:"iconfont icon-Send",class:{"icon-send-disabled":t.isDisabledSend},on:{click:t.sendMsg}}):e("i",{staticClass:"iconfont icon-zhongzhi",on:{click:t.handlePauseMsg}})],2)],1)],1)],1),t._v(" "),e("div",{staticClass:"risk-tip"},[t._v("\n    "+t._s(t.$t("riskaversion"))+"\n  ")]),t._v(" "),e("AiChatModelSwitcher",{ref:"aiChatModelSwitcher"})],1)}),[],!1,null,"58a3236e",null)),ii=ei.exports,ni={props:["url"],data:function(){return{}},methods:{imgLoad:function(){this.$emit("imgLoad")}}};n(5174);function ai(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function si(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ai(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var oi={name:"AiChatCenter",components:{AiChatBody:ii,AiChatFigure:Object(v.a)(ni,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"aichat-figure flex-center"},[e("img",{attrs:{src:t.url,alt:""},on:{load:t.imgLoad}})])}),[],!1,null,"3b497d5c",null).exports},inject:["aiChatIndex"],provide:function(){return{mainContent:this}},computed:si(si(si({},Object(_.c)("user",["userInfo","characterSetting","isLoggedIn"])),Object(_.c)("character",["on_line_search","characterInfo"])),{},{isCollapsed:function(){return this.aiChatIndex.isCollapsed||!1},isShowHead:function(){return this.aiChatIndex.isShowHead||!1},hideBackground:function(){return 0!==this.characterSetting.hide_bg&&1===this.characterSetting.hide_bg},isDim:function(){var t,e=(null===(t=this.aiChatIndex.characterInfo)||void 0===t?void 0:t.vision)||{},n=e.bg,o=e.character;return!(null!=o&&o.url&&null!=n&&n.url)},isFullPage:function(){return 2!==this.characterSetting.full_screen&&(0===this.characterSetting.full_screen||1===this.characterSetting.full_screen||!this.isLoggedIn)},bgImg:function(){var t,e=(null===(t=this.aiChatIndex.characterInfo)||void 0===t?void 0:t.vision)||{},n=e.bg,o=e.character;return(null==n?void 0:n.url)||(null==o?void 0:o.url)||""},figureImg:function(){var t,e=(null===(t=this.aiChatIndex.characterInfo)||void 0===t?void 0:t.vision)||{},n=e.bg,o=e.character;return(null==o?void 0:o.url)||(null==n?void 0:n.url)||""},showFigure:function(){var t=this.characterSetting.hide_bg;return this.aiChatIndex.imgReady&&1!==t},renderSetBoxList:function(){var t=this;return d.n.filter((function(e){return t.isShowChat?!["backChat","setBg"].includes(e.key):!["setBg"].includes(e.key)}))}}),watch:{isCollapsed:function(t){this.hideBackground||(this.isShowChat=!t)}},data:function(){return{isShowChat:!0}},methods:{handleSetBoxItem:function(t){switch(t){case"setBg":this.$emit("setBg");break;case"backChat":this.isShowChat=!0}},getChatBody:function(){return this.$refs.chatBody},clearMsg:function(){this.$refs.chatBody.msg=""}}},ri=(n(5175),Object(v.a)(oi,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content",class:{hideback:t.hideBackground,"full-page":t.isFullPage}},[e("div",{staticClass:"aichat-main",class:{"right-open":!t.aiChatIndex.rightCollapsed,"aichat-main-hide-after":!t.isShowChat}},[e("div",{staticClass:"ai-chat-bg",style:{backgroundImage:"url(".concat(t.bgImg,")")}},[e("div",{staticClass:"bg-overlay"})]),t._v(" "),e("div",{staticClass:"aichat-content"},[t.hideBackground?t._e():e("div",{staticClass:"set-box"},t._l(t.renderSetBoxList,(function(n){return e("div",{key:n.key,staticClass:"set-back-btn-item",on:{click:function(e){return t.handleSetBoxItem(n.key)}}},[e("div",{staticClass:"set-back-btn-item-icon iconfont",class:n.icon}),t._v(" "),e("div",{staticClass:"set-back-btn-item-text overflow-ellipsis"},[t._v(t._s(t.$t(n.i18nKey)))])])})),0),t._v(" "),e("ai-chat-figure",{class:{"show-img":t.showFigure},attrs:{url:t.figureImg},on:{imgLoad:function(e){return t.$emit("imgLoad")}}}),t._v(" "),e("ai-chat-body",{ref:"chatBody",attrs:{isShowChat:t.isShowChat}})],1)])])}),[],!1,null,"8ee0d416",null).exports),ci={name:"AiChatErrorPopup",data:function(){return{showOverlay:!1,overlayMessage:"bannedTipCharter"}},computed:{queryInfo:function(){return this.$t("Back")+this.$t("Home")}},methods:{showOverlayModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bannedTipCharter";this.overlayMessage=t,this.showOverlay=!0},hideOverlayModal:function(){this.showOverlay=!1;var t=this.localePath("/cyberPub");this.$router.replace(t)}}},ui=ci,di=(n(5176),Object(v.a)(ui,(function(){var t=this,e=t._self._c;return e("div",[t.showOverlay?e("div",{staticClass:"overlay"},[e("div",{staticClass:"modal"},[e("img",{staticClass:"null-image",attrs:{src:n(668),alt:"null_image"}}),t._v(" "),e("p",[t._v(t._s(t.$t(t.overlayMessage)))]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.hideOverlayModal}},[t._v(t._s(t.queryInfo))])],1)]):t._e()])}),[],!1,null,"12509510",null).exports),hi={name:"ChatGuideTip",props:{show:{type:Boolean,default:!1},autoHideDelay:{type:Number,default:3e4}},data:function(){return{visible:this.show,autoHideTimer:null}},watch:{show:function(t){this.visible=t,t?this.startAutoHideTimer():this.clearAutoHideTimer()}},mounted:function(){this.visible&&this.startAutoHideTimer()},beforeDestroy:function(){this.clearAutoHideTimer()},methods:{startAutoHideTimer:function(){var t=this;this.clearAutoHideTimer(),this.autoHideTimer=setTimeout((function(){t.handleClose()}),this.autoHideDelay)},clearAutoHideTimer:function(){this.autoHideTimer&&(clearTimeout(this.autoHideTimer),this.autoHideTimer=null)},handleClick:function(){this.$xyLogEvent({front_operation:"click",entity_type:"ai_chat_page",entity_name:"chat_guide_tip_click"}),this.clearAutoHideTimer(),this.visible=!1,this.$emit("jump")},handleClose:function(){this.clearAutoHideTimer(),this.visible=!1,this.$emit("close")},hide:function(){this.visible=!1}}},vi=(n(5177),Object(v.a)(hi,(function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"fade-slide-down"}},[t.visible?e("div",{staticClass:"chat-guide-tip"},[e("div",{staticClass:"tip-content"},[e("div",{staticClass:"character-avatar"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/web/character/newCharacterUserTip1.webp",alt:"Character"}})]),t._v(" "),e("div",{staticClass:"tip-text"},[e("i18n",{attrs:{path:"newCharacterUserTip",tag:"span"},scopedSlots:t._u([{key:"newCharacterUserTipMore",fn:function(){return[e("span",{staticClass:"tip-link",on:{click:t.handleClick}},[t._v(t._s(t.$t("newCharacterUserTipMore")))])]},proxy:!0}],null,!1,2862373789)})],1),t._v(" "),e("div",{staticClass:"close-btn",on:{click:t.handleClose}},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/web/character/newCharacterUserTip3.webp",alt:"SeaArt.AI"}})])])]):t._e()])}),[],!1,null,"e0a9c66e",null).exports);function pi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function fi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pi(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var mi={provide:function(){return{aiChatIndex:this}},beforeRouteEnter:function(t,e,n){n((function(t){t.historyStack.push(e.fullPath)}))},beforeRouteLeave:function(t,e,n){this.historyStack=this.historyStack.filter((function(path){return path!==e.fullPath})),"function"==typeof this.cleanupPageActiveLog&&this.cleanupPageActiveLog(),t.path.includes("/aiChat")||t.path.includes("/cyberPubPage")||this.allowDirectLeave||!this.isLoggedIn?n():this.$refs.aiChatFeedbackCollection.show(n)},name:"aiChat",components:{ViewImage:l.a,AiChatHead:f,AiChatReport:W.a,ResetChatPopup:ot,AiChatLeft:at,AiChatRight:et,AiChatCenter:ri,AiChatErrorPopup:di,AiChatFeedbackCollection:c.a,ChatGuideTip:vi},props:{defaultCharacter:Object,defaultCode:Number||String},data:function(){return{handleToggle:!0,chatFreePermissionsFull:!1,imgReady:!1,characterCode:1e4,isShowFree:!1,historyStack:[],first_msg_has_voice:!1,characterId:null,aiChatSessionId:null,layout:"center",characterInfo:{},leftCollapsed:!1,rightCollapsed:!1,isDetailLoading:!1,allowDirectLeave:!1}},computed:fi(fi(fi(fi(fi({},Object(_.c)("user",["isCompanyAccount","isLoggedIn"])),Object(_.c)("user",["userInfo"])),Object(_.c)("payment",["paymentInfo"])),Object(_.c)("character",["userCardInfo","currentTimbreObj","pageLoading","isAgentCharacter"])),{},{showChatGuideTip:function(){return"home"===this.$route.query.from&&"1"===this.$route.query.is_new_user},isCollapsed:function(){return this.leftCollapsed&&this.rightCollapsed&&!this.handleToggle},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)}}),watch:{currentTimbreObj:{handler:function(t){var e;this.characterInfo.timbre_id=(null==t?void 0:t.id)||(null===(e=this.characterInfo)||void 0===e?void 0:e.timbre_id)},immediate:!0},aiChatSessionId:{handler:function(t){this.SET_SESSION_ID(t),this.SET_HISTORY_MESSAGE_LIST([])},immediate:!0},characterInfo:{handler:function(t){var e=this;this.SET_CHARACTER_INFO(t),t&&t.nsfw_level>5&&this.$nextTick((function(){setTimeout((function(){e.showNsfwDialog()}),2e3)}))},deep:!0,immediate:!0},userInfo:{handler:function(t){var e;(console.log("userInfo",t),t&&this.isLoggedIn)&&this.SET_ON_LINE_SEARCH(null===(e=t.character_setting)||void 0===e?void 0:e.on_line_search)},deep:!0,immediate:!0},pageLoading:{handler:function(t){t&&this.SET_SHOW_SEARCH_RESULT(!1)},immediate:!0},$route:function(t,e){var n,o,r=this;if((null===(n=t.query)||void 0===n?void 0:n.s_id)!==(null===(o=e.query)||void 0===o?void 0:o.s_id)){var c=t.query.s_id,l=t.params.id,d=void 0===l?m.a:l;this.characterId=d,this.aiChatSessionId=c,this.$nextTick((function(){console.log("等待DOM更新后再重载消息",r.characterId),r.aiChatSessionId&&r.characterId&&r.startChat()})),this.reportView(d)}},rightCollapsed:{handler:function(t){this.$EventBus.$emit("toggleFloatingTools",t)},immediate:!0}},created:function(){this.defaultCharacter&&(this.characterInfo=this.defaultCharacter,this.characterCode=this.defaultCode)},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.initPage(),t.cleanupPageActiveLog=t.pageActiveLog(),t.$xyLogEvent({front_operation:"exposure",entity_name:"character-chat-page-show",entity_type:"character-page"});case 3:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){console.log("父页面销毁beforeDestroy"),this.$el.style.display="none","function"==typeof this.cleanupPageActiveLog&&this.cleanupPageActiveLog(),this.$EventBus.$emit("toggleFloatingTools",!0)},methods:fi(fi(fi(fi({},Object(_.d)("character",["SET_ON_LINE_SEARCH","SET_SHOW_SEARCH_RESULT","SET_CHARACTER_INFO","SET_SESSION_ID","SET_UPDATE_MSG_LIST","SET_USER_CARD_INFO","SET_CURRENT_TIMBRE_OBJ","SET_PAGE_LOADING","SET_HISTORY_MESSAGE_LIST"])),Object(_.d)("user",["SET_USER_INFO",""])),Object(_.b)("character",["getSecondInstructions"])),{},{clearCharacterUnReadNum:function(t){t&&this.$refs.aiChatLeft&&this.$refs.aiChatLeft.clearSelectedCharacterUnReadNum(t)},showViewImage:function(t){var e=this;this.$nextTick((function(){e.$refs.viewImage.show(t)}))},pageActiveLog:function(){var t=this,e=null,n=Date.now(),o=!0,r=!0,c=function(){n=Date.now(),r||(r=!0,console.log("用户重新活跃，恢复打点"))},l=function(){(o="visible"===document.visibilityState)?(console.log("页面可见，恢复打点"),n=Date.now()):console.log("页面不可见，暂停打点")};return["mousedown","keydown","touchstart","click","scroll"].forEach((function(t){document.addEventListener(t,c)})),document.addEventListener("visibilitychange",l),e&&clearInterval(e),e=setInterval((function(){Date.now()-n>3e4&&r&&(r=!1,console.log("用户超过30秒无操作，暂停打点")),o&&r&&(t.$logEvent("log_actions",{operation:"effective_exposure",behavior_info:"on_tarven_detail_page",behavior_info_sub:"stay_time_per_10s"}),console.log("页面停留打点上报"))}),1e4),function(){["mousedown","keydown","touchstart","click","scroll"].forEach((function(t){document.removeEventListener(t,c)})),document.removeEventListener("visibilitychange",l),e&&(clearInterval(e),e=null)}},openLeft:function(){this.handleToggle=!0,this.leftCollapsed=!this.leftCollapsed},openRight:function(){this.handleToggle=!0,this.rightCollapsed=!this.rightCollapsed},checkStatus:function(){if(1e4===this.characterCode)return!1;switch(this.characterCode){case 10616:this.$refs.chatErrorPopup.showOverlayModal("saveFailed");break;case 10610:this.$refs.chatErrorPopup.showOverlayModal("bannedTipCharter");break;case 10621:this.$message({type:"warning",message:this.$t("chatFail"),duration:5e3,offset:100});break;default:console.warn("Unhandled character code: ".concat(this.characterCode))}return!0},updateSession:function(t){console.log("切换会话",t);var e=t.character_id,n=t.session_id;t.name,t.banner;this.aiChatSessionId=n,this.characterId=e,this.$refs.aiChatCenter&&this.$refs.aiChatCenter.clearMsg(),this.updateUrlParams(n)},getVoiceDetail:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"+"!==(null===(n=t.characterInfo)||void 0===n?void 0:n.timbre_id)&&null!==(o=t.characterInfo)&&void 0!==o&&o.timbre_id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(D.G)({id:null===(r=t.characterInfo)||void 0===r?void 0:r.timbre_id});case 5:1e4===(c=e.sent).status.code&&t.SET_CURRENT_TIMBRE_OBJ(c.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("获取语音详情-err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},reportView:function(t){Object(ct.i)({items:[{action:"view",obj_no:t,obj_type:9}]})},imgLoad:function(){this.imgReady=!0},startChat:function(){var t=this;Object(D.eb)({session_id:this.aiChatSessionId,dft_timbre_id:this.characterInfo.timbre_id}).then((function(e){if(1e4===e.status.code){var n=e.data,o=n.timbre,r=void 0===o?null:o,c=n.isFree,l=void 0!==c&&c,d=n.card,h=void 0===d?{}:d,v=n.limit_tourist_chat;if(1===(void 0===v?2:v)&&!t.isLoggedIn)return t.chatFreePermissionsFull=!0,t.SET_PAGE_LOADING(!1),void t.$EventBus.$emit("openLoginDialog",{callBack:function(){return t.initPage()}});t.SET_CURRENT_TIMBRE_OBJ(r),t.characterInfo.timbre_id=r.id||t.characterInfo.timbre_id,t.isShowFree=l,t.SET_USER_CARD_INFO(h),t.SET_UPDATE_MSG_LIST(!0),t.isAgentCharacter&&t.getSecondInstructions()}})).catch((function(e){t.SET_PAGE_LOADING(!1),console.log("开始聊天-err",e)}))},newChat:function(){var t=this;console.log("开始新聊天！！"),this.checkStatus()?this.SET_PAGE_LOADING(!1):(this.isLoggedIn||this.SET_PAGE_LOADING(!1),Object(D.i)({character_id:this.characterId,mask:""}).then((function(e){if(60003===e.status.code)return t.chatFreePermissionsFull=!0,t.SET_PAGE_LOADING(!1),void t.$EventBus.$emit("openLoginDialog",{callBack:function(){return t.initPage()}});var n=e.data,o=n.session_id,r=n.support_voice,c=void 0===r?0:r;t.first_msg_has_voice=1===c,t.aiChatSessionId=o,t.updateUrlParams(o),t.$nextTick((function(){t.closeSideBar(),setTimeout((function(){t.$refs.aiChatLeft&&t.$refs.aiChatLeft.getLastChatList(!0),t.$refs.aiChatLeft&&t.$refs.aiChatLeft.getNewRecentCharacterList(!0)}),1e3)}))})).finally((function(){})))},closeSideBar:function(){this.rightCollapsed=!0,this.leftCollapsed=!0},updateUrlParams:function(t){var path="deepseekChat"===this.getRouteBaseName()?"/chat":"/aiChat/".concat(this.characterId),e=fi(fi({},this.$route.query),{},{s_id:t}),n=this.localePath("".concat(path,"?").concat(new URLSearchParams(e)));this.$router.replace(n).catch((function(t){t.name}))},handleUpdateCountNum:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.characterInfo=Object.assign({},this.characterInfo,t)},handleLeftToggle:function(t){this.leftCollapsed=t},handleRightToggle:function(t){this.rightCollapsed=t},handleDoubleClick:function(t){window.getSelection().removeAllRanges(),t.preventDefault(),t.target.closest(".sidebar")||(this.leftCollapsed||this.rightCollapsed?(this.leftCollapsed=!1,this.rightCollapsed=!1):(this.leftCollapsed=!0,this.rightCollapsed=!0),this.handleToggle=!1)},fetchCharacterDetail:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],n.prev=1,e.SET_PAGE_LOADING(!0),e.isDetailLoading=!0,r={id:e.characterId,check_session_id:e.aiChatSessionId},e.aiChatSessionId||delete r.check_session_id,!e.characterId){n.next=12;break}return n.next=9,Object(lt.f)(r);case 9:l=n.sent,e.characterCode=null===(c=l.status)||void 0===c?void 0:c.code,l.data&&(d=l.data.latest_session,h=void 0===d?[]:d,e.characterInfo=l.data,e.getVoiceDetail(),!e.aiChatSessionId&&h.length&&(console.log(' 如果当前没有聊过,使用详情中的最新会话来进行"继续聊天"'),e.aiChatSessionId=h[0].session_id,e.updateUrlParams(e.aiChatSessionId)),o&&e.$refs.aiChatLeft&&(e.$refs.aiChatLeft.getLastChatList(!0),e.$refs.aiChatLeft.getNewRecentCharacterList(!0)));case 12:n.next=18;break;case 14:n.prev=14,n.t0=n.catch(1),console.error("获取数字人详情失败:",n.t0),e.$message.error(e.$t("Failed to get character details"));case 18:return n.prev=18,e.isDetailLoading=!1,e.SET_PAGE_LOADING(!1),n.finish(18);case 22:case"end":return n.stop()}}),n,null,[[1,14,18,22]])})))()},updateRecentChat:function(){this.$refs.aiChatLeft&&(this.$refs.aiChatLeft.getLastChatList(!0),this.$refs.aiChatLeft.getNewRecentCharacterList(!0))},initPage:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.characterId=t.characterId||(null===(n=t.$route.params)||void 0===n?void 0:n.id)||(null===(o=t.characterInfo)||void 0===o?void 0:o.id)||m.a||"",t.aiChatSessionId=t.aiChatSessionId||(null===(r=t.$route.query)||void 0===r?void 0:r.s_id)||"",e.next=5,t.getVoiceDetail();case 5:if("deepseekChat"!==t.getRouteBaseName()||t.aiChatSessionId){e.next=9;break}return e.next=8,t.newChat();case 8:return e.abrupt("return");case 9:return e.next=11,t.handleCharacterInfo();case 11:if(!t.checkStatus()){e.next=13;break}return e.abrupt("return");case 13:return t.SET_PAGE_LOADING(!0),e.next=16,t.$nextTick();case 16:if(t.aiChatSessionId){e.next=21;break}return console.log("没有会话记录,开启新会话，不执行start会话"),e.next=20,t.newChat();case 20:return e.abrupt("return");case 21:return e.next=23,t.startChat();case 23:null!==(c=t.characterInfo)&&void 0!==c&&c.is_show_both_sidebar&&(t.closeSideBar(),t.$nextTick((function(){t.$refs.aiChatCenter&&(t.$refs.aiChatCenter.isShowChat=!0)}))),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.error("页面初始化失败:",e.t0);case 29:case"end":return e.stop()}}),e,null,[[0,26]])})))()},handleCharacterInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("处理数字人信息--",t.aiChatSessionId),null!==(n=t.characterInfo)&&void 0!==n&&n.id){e.next=3;break}return e.abrupt("return");case 3:if(t.aiChatSessionId||(t.aiChatSessionId=(null===(o=t.characterInfo.latest_session)||void 0===o?void 0:o.length)>0?t.characterInfo.latest_session[0].session_id:""),t.aiChatSessionId){e.next=8;break}return e.next=7,t.newChat();case 7:return e.abrupt("return");case 8:t.updateUrlParams(t.aiChatSessionId);case 9:case"end":return e.stop()}}),e)})))()},showNsfwDialog:function(){var t=this;this.$hyConfirm({title:this.$t("Tip"),content:this.$t("nsfw_content_warning"),btnList:["confirm"],attrs:{"close-on-click-modal":!1}}).then((function(){t.handleNsfwConfirm()})).catch((function(){t.handleNsfwConfirm()}))},handleNsfwConfirm:function(){this.allowDirectLeave=!0,this.$router.push(this.localePath("/cyberPub"))},handleGuideTipJump:function(){console.log("处理引导提示跳转事件"),this.$router.push(this.localePath("/cyberPub"))}}),head:function(){var t=this.characterInfo,e=t.cover,n=t.seo_session_title,o=t.seo_session_keywords,r=t.seo_session_description,c=Object(d.h)(this,this.characterInfo),title=n||this.$t("CyberPubChatTitle",{name:c}),l=r||this.$t("CyberPubChatDesc",{name:c});return{title:title,meta:[{hid:"description",name:"description",content:l},{hid:"keywords",name:"keywords",content:o||c},{hid:"og:title",property:"og:title",content:title},{hid:"og:description",property:"og:description",content:l},{hid:"og:image",property:"og:image",content:null==e?void 0:e.url}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,param,d,h,v,data,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,c=t.query,l=o.id||m.a,param={id:l,ss:D.f},c.s_id&&(param.check_session_id=c.s_id),e.prev=4,e.next=7,n.$post("/api/v1/character/detail",param);case 7:return v=e.sent,data=v.data,f=v.status,console.log("数字人聊天页面-> asyncData",data,f),e.abrupt("return",{characterInfo:data||{},characterCode:f.code,aiChatSessionId:c.s_id||(null==data||null===(d=data.latest_session)||void 0===d?void 0:d.length)&&(null==data||null===(h=data.latest_session[0])||void 0===h?void 0:h.session_id),characterId:null==data?void 0:data.id});case 14:e.prev=14,e.t0=e.catch(4),console.log("数字人聊天页面-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 18:case"end":return e.stop()}}),e,null,[[4,14]])})))()}},gi=mi,_i=(n(5178),Object(v.a)(gi,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ai-chat-page",class:{"left-collapsed":t.leftCollapsed,"right-collapsed":t.rightCollapsed},on:{dblclick:t.handleDoubleClick}},[t.pageLoading?e("div",{staticClass:"loading-mask"},[e("div",{staticClass:"loading-spinner"})]):t._e(),t._v(" "),e("AiChatHead",{attrs:{leftCollapsed:t.leftCollapsed,rightCollapsed:t.rightCollapsed},on:{openLeft:t.openLeft,openRight:t.openRight}}),t._v(" "),e("AiChatLeft",{ref:"aiChatLeft",attrs:{"data-group":"page-ai-chat-left","is-collapsed":t.leftCollapsed},on:{"toggle-collapse":t.handleLeftToggle,newChat:t.newChat}}),t._v(" "),e("AiChatCenter",{ref:"aiChatCenter",attrs:{"data-group":"page-ai-chat-content"},on:{imgLoad:t.imgLoad}}),t._v(" "),e("AiChatRight",{ref:"aiChatRight",attrs:{"data-group":"page-ai-chat-right","is-collapsed":t.rightCollapsed},on:{handleUpdateCountNum:t.handleUpdateCountNum,newChat:t.newChat,"toggle-collapse":t.handleRightToggle}}),t._v(" "),e("ViewImage",{ref:"viewImage"}),t._v(" "),e("AiChatErrorPopup",{ref:"chatErrorPopup"}),t._v(" "),t.isLoggedIn?e("AiChatFeedbackCollection",{ref:"aiChatFeedbackCollection"}):t._e(),t._v(" "),e("ChatGuideTip",{attrs:{show:t.showChatGuideTip},on:{jump:t.handleGuideTipJump}})],1)}),[],!1,null,"6e2a0f48",null));e.default=_i.exports},3193:function(t,e,n){"use strict";n(18),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(6),n(16),n(4),n(93)),c={data:function(){return{tagReplaceObj:{66:"aiapp",4:"Post",2:"motivatingTitle1",5:"Post",13:"aiapp",11:"Canvas",9:"digitalHuman",16:"AI_Audio"}}},props:{item:{type:Object,default:function(){}},name:{type:String,default:""}},computed:{isImg:function(t){return function(t){if(!t)return"";var e=t.split(".").pop();return["jpg","jpeg","png","webp","gif"].includes(e)}}}},l=(n(5129),n(0)),d=Object(l.a)(c,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"comfyUIitem"},[n("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"imgBox"},[e.tagReplaceObj[e.item.obj_type]?n("div",{staticClass:"tag-box"},[e._v("\n      "+e._s(e.$t(e.tagReplaceObj[e.item.obj_type]))+"\n    ")]):e._e(),e._v(" "),e.isImg(e.item.cover)?n("img",{attrs:{"data-src":e.item.cover,alt:e.name,loading:"lazy",width:"263",height:"219"}}):n("video",{attrs:{src:e.item.cover,autoplay:"",width:"263",height:"219",loop:"",muted:""},domProps:{muted:!0}})]),e._v(" "),n("div",{staticClass:"name overflow-ellipsis"},[e._v(e._s(e.$t((null===(t=e.item)||void 0===t?void 0:t.title)||e.name)))])])}),[],!1,null,"77d1da18",null).exports,h=n(112),v=n(10),f=n(257),m=n(45),_=n(1);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={components:{ImgWaterFall:h.default,AiChatReport:f.a,AIitemSameStyleItem:d},mixins:[m.a],props:{item:{type:Object,default:function(){}},isForYouPage:Boolean,outerClass:{type:String,default:"recList"}},data:function(){return{formatEvaluation:r.e,formatNumberForeign:v.p,styleObj:{},moreActions:[{label:"Report",type:"report",icon:"task-report-icon"},{label:"Edit",type:"edit",icon:"icon-icon-edit"},{label:"Delete",type:"del",icon:"icon-moveDelete"}]}},computed:w(w(w(w({},Object(_.e)("user",["token"])),Object(_.c)("user",["isLoggedIn"])),Object(_.e)("user",["userInfo"])),{},{renderMoreActions:function(){return"myAiChat"!=this.outerClass?this.moreActions.filter((function(t){return!["del","edit"].includes(t.type)})):this.moreActions},renderItem:function(){var t,e;return w(w({},this.item),{},{stat:(null===(t=this.item)||void 0===t||null===(t=t.character)||void 0===t?void 0:t.stat)||(null===(e=this.item)||void 0===e?void 0:e.stat)})}}),mounted:function(){this.getWH(),window.addEventListener("resize",this.getWH)},beforeDestroy:function(){window.removeEventListener("resize",this.getWH)},methods:{handleClickToDetails:function(){var t;this.$router.push(this.localePath("/cyberPubPage/".concat(null===(t=this.item)||void 0===t?void 0:t.id)))},goCreatedSame:function(t){if(t){var e=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));this.isLoggedIn?this.$router.push(this.localePath(e)):this.$EventBus.$emit("openLoginDialog",{redirect:e})}},getWH:function(){var t=document.getElementById(this.outerClass);if(t){var e=t.offsetWidth;if(!e)return;var n=e>1600?6:5;e<1240&&(n=4);var o=~~((e-48)/n),r=o>230?o:230,c=parseInt(620*r/337);this.styleObj={width:r+"px",height:c+"px"}}},goChat:function(){var t;this.$router.push(this.localePath("/aiChat/".concat(null===(t=this.item)||void 0===t?void 0:t.id)))},handleActions:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"report":try{this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_report"}),this.$refs.AiChatReport.open()}catch(t){}break;case"share":this.handleShare();break;case"edit":this.handleEdit();break;case"del":this.handleDel()}},handleShare:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_share"});var t=location.origin;Object(v.g)(t+"/cyberPubPage/".concat(this.item.id)),this.$message.success(this.$t("CopiedURLToClipboard"))},handleDel:function(){this.$emit("delete",this.item)},handleEdit:function(){var t;this.$router.push(this.localePath("/cyberPubPage/new-character?id="+(null===(t=this.item)||void 0===t?void 0:t.id)))},otherUser:function(t){var e,n,path="/user/"+encodeURIComponent(t.author.id);(null===(e=this.userInfo)||void 0===e?void 0:e.id)==(null===(n=t.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")}}},k=C,O=(n(5130),Object(l.a)(k,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y,w,C,k=this,O=k._self._c;return O("a",{attrs:{href:k.localePath("/cyberPubPage/".concat(null===(t=k.item)||void 0===t?void 0:t.id))},on:{click:function(t){return t.preventDefault(),k.goChat.apply(null,arguments)}}},[k.isForYouPage?O("AIitemSameStyleItem",{attrs:{name:null===(e=k.item.character)||void 0===e?void 0:e.name,item:k.item}}):O("div",{staticClass:"cyberBarItem",style:k.styleObj},[O("div",{staticClass:"name",attrs:{title:null===(n=k.item.character)||void 0===n?void 0:n.name},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),k.handleClickToDetails.apply(null,arguments)}}},[k._v("\n      "+k._s(null===(o=k.item.character)||void 0===o?void 0:o.name)+"\n    ")]),k._v(" "),O("div",{staticClass:"imgBox"},[k.item.nsfw?O("ImgWaterFall",{style:{transition:"all 0.3s ease-in-out"},attrs:{isHeight:!1,item:k.item}}):k._e(),k._v(" "),O("div",{staticClass:"imgBox-num"},[O("div",{staticClass:"imgBox-num-item"},[O("i",{staticClass:"iconfont icon-users-solid imgBox-num-item-icon"}),k._v(" "),O("span",{staticClass:"imgBox-num-item-text"},[k._v("\n            "+k._s(k.formatNumberForeign((null===(r=k.item)||void 0===r||null===(r=r.stat)||void 0===r?void 0:r.num_of_token)||(null===(c=k.item)||void 0===c||null===(c=c.character)||void 0===c||null===(c=c.stat)||void 0===c?void 0:c.num_of_token)||0))+"\n          ")])]),k._v(" "),O("div",{staticClass:"imgBox-num-item",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),k.setCollect(k.renderItem,"character")}}},[O("div",{staticClass:"imgBox-num-item-icon"},[O("i",{staticClass:"iconfont",class:k.setCollectData(k.renderItem)})]),k._v(" "),O("span",{staticClass:"imgBox-num-item-text"},[k._v("\n            "+k._s(k.formatNumberForeign((null===(l=k.renderItem)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_collection)||(null===(d=k.renderItem)||void 0===d||null===(d=d.character)||void 0===d||null===(d=d.stat)||void 0===d?void 0:d.num_of_collection)||0))+"\n          ")])])])],1),k._v(" "),O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[O("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[k._v("\n        "+k._s(null===(h=k.item.character)||void 0===h?void 0:h.evaluation)+"\n      ")]),k._v(" "),O("div",{staticClass:"desc",domProps:{innerHTML:k._s(k.formatEvaluation(null===(v=k.item.character)||void 0===v?void 0:v.evaluation))}})]),k._v(" "),O("div",{staticClass:"item-content-tags"},k._l(null===(f=k.item.character)||void 0===f?void 0:f.categories,(function(t){return O("span",{key:t.id,staticClass:"item-content-tags-item"},[k._v("\n        "+k._s(t.name)+"\n      ")])})),0),k._v(" "),O("div",{staticClass:"author",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[O("div",{staticClass:"author-box",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),k.otherUser(k.item)}}},[null!==(m=k.item.author)&&void 0!==m&&m.head?O("div",{staticClass:"authorHead"},[O("img",{directives:[{name:"webp",rawName:"v-webp",value:k.$imgL,expression:"$imgL"}],attrs:{src:null===(_=k.item.author)||void 0===_?void 0:_.head,alt:null===(y=k.item.author)||void 0===y?void 0:y.name}})]):O("div",{staticClass:"authorHead"},[k._v("\n          "+k._s(null===(w=k.item.author)||void 0===w?void 0:w.name[0])+"\n        ")]),k._v(" "),O("div",{staticClass:"authorName"},[O("span",[k._v(k._s(null===(C=k.item.author)||void 0===C?void 0:C.name))])])]),k._v(" "),O("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"msg-item-more-popover","visible-arrow":!1,width:"120",trigger:"hover"}},[O("div",{staticClass:"pop-btns flex"},k._l(k.renderMoreActions,(function(t){return O("button",{key:t.type,on:{click:function(e){return k.handleActions(t.type)}}},[O("span",{staticClass:"pop-btns-text"},[k._v(k._s(k.$t(t.label)))]),k._v(" "),O("span",{staticClass:"pop-btns-icon"},[O("i",{staticClass:"iconfont",class:t.icon})])])})),0),k._v(" "),O("div",{staticClass:"item-cover-operate",attrs:{slot:"reference"},slot:"reference"},[O("i",{staticClass:"iconfont icon-more"})])])],1)],1),k._v(" "),O("ai-chat-report",{ref:"AiChatReport",attrs:{"ai-chat-id":k.item.id}})],1)}),[],!1,null,"30355e1e",null));e.a=O.exports;installComponents(O,{ImgWaterFall:n(112).default})},3434:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var l={name:"BookCard",mixins:[n(45).a],props:{videoBookData:{type:Object,default:function(){}}},components:{},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(r.c)("user",["isLoggedIn"])),data:function(){return{}},methods:{goReading:function(){var t;this.$logEvent("log_actions",{operation:"click_continue_reading",behavior_info:"on_ai_video_detail_page",behavior_info_sub:this.$route.params.id}),this.$emit("closePlayer"),this.$router.push(this.localePath("/book/reading/".concat(null===(t=this.videoBookData)||void 0===t||null===(t=t.related_ebooks[0])||void 0===t?void 0:t.id)))}}},d=l,h=(n(5409),n(0)),component=Object(h.a)(d,(function(){var t,e,n,o,r,c,l=this,d=l._self._c;return d("div",{directives:[{name:"show",rawName:"v-show",value:!(null!==(t=l.videoBookData)&&void 0!==t&&t.related_ebooks[0]),expression:"!videoBookData?.related_ebooks[0]"}],staticClass:"book"},[d("div",{staticClass:"name"},[l._v(l._s(l.$t("Playing")))]),l._v(" "),d("div",{staticClass:"book-card"},[d("div",{staticClass:"content flex flex-col"},[d("div",{staticClass:"top flex"},[d("div",{staticClass:"left-img"},[null!==(e=l.videoBookData)&&void 0!==e&&null!==(e=e.related_ebooks[0])&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.url?d("img",{directives:[{name:"webp",rawName:"v-webp",value:l.$imgL,expression:"$imgL"}],attrs:{src:null===(n=l.videoBookData)||void 0===n||null===(n=n.related_ebooks[0])||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url,alt:"cover",loading:"lazy",width:"191",height:"107"}}):l._e()]),l._v(" "),d("div",{staticClass:"right-content flex flex-col"},[d("div",{staticClass:"right-top text-no-wrap"},[l._v(l._s(null===(o=l.videoBookData)||void 0===o||null===(o=o.related_ebooks[0])||void 0===o?void 0:o.name))]),l._v(" "),d("div",{staticClass:"right-middle flex flex-col"},[d("div",{staticClass:"text-no-wrap-2 desc"},[l._v(l._s(null===(r=l.videoBookData)||void 0===r||null===(r=r.related_ebooks[0])||void 0===r?void 0:r.desc))])])])]),l._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:null===(c=l.videoBookData)||void 0===c||null===(c=c.related_ebooks[0])||void 0===c?void 0:c.id,expression:"videoBookData?.related_ebooks[0]?.id"}],staticClass:"bottom flex"},[d("div",{staticClass:"btns-item",on:{click:l.goReading}},[l._v("\n          "+l._s(l.$t("continueRead"))+"\n        ")])])])])])}),[],!1,null,"210f1cf8",null);e.a=component.exports},367:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(16),n(1)),c=n(127),l=n(126),d=n(564),h=n(300),v=n(34);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"PaymentFormDialog",props:{},components:{RightPart:c.a,PaymentForm:l.a,StatisticsCard:d.default},computed:m({},Object(r.e)("payment",["paymentGrayInfo"])),inject:{parentTop:{from:"top",default:function(){return{dotFrom:""}}}},provide:function(){var t=this;return{top:Object(v.computed)((function(){var e;return{dotFrom:(null===(e=t.parentTop)||void 0===e?void 0:e.dotFrom)||t.dotFrom||""}}))}},data:function(){return{isShowDialog:!1,goodsId:"",currentQuantity:0,loading:!1,defaultOptions:{animationData:h},pageFrom:"",goodsInfo:{},dotFrom:""}},mounted:function(){},methods:{show:function(t){this.showPaymentFormDialog(t)},showPaymentFormDialog:function(t){this.goodsId=(null==t?void 0:t.cp_product_id)||(null==t?void 0:t.id),this.currentQuantity=(null==t?void 0:t.quantity)||0,this.goodsInfo=t,this.pageFrom=(null==t?void 0:t.pageFrom)||"",this.dotFrom=(null==t?void 0:t.dotFrom)||"",this.isShowDialog=!0},showLoading:function(t){this.loading=t},success:function(){this.$emit("success"),this.$EventBus.$emit("getMallGoodsData"),this.isShowDialog=!1},handleInPayBack:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.isShowDialog=!1,!e||["AwaitingOrderDialog","ExpiringRetainDialog","NotVipComputingStayDialogV2"].includes(this.pageFrom)||this.$refs.paymentForm.useTry)||this.$EventBus.$emit("showDialog",{name:"AwaitingOrderDialog",data:m(m({},this.goodsInfo),{},{quantity:this.currentQuantity,sourceDialog:"PaymentFormDialog",paymentFormProps:this.$refs.paymentForm.$options.propsData,dotFrom:(null===(t=this.parentTop)||void 0===t?void 0:t.dotFrom)||this.dotFrom||""})})}}},y=_,w=(n(4786),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"PaymentFormDialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},[t.loading?e("lottie",{staticClass:"loading-anime",attrs:{options:t.defaultOptions,height:110,width:110}}):t._e(),t._v(" "),t.isShowDialog?e("PaymentForm",t._g(t._b({ref:"paymentForm",attrs:{goodsId:t.goodsId,from:"mall",backToCheck:!0,purchParams:t.currentQuantity?{quantity:t.currentQuantity}:{}},on:{"in-pay-back":t.handleInPayBack,"pay-success":t.success,"in-loading":function(e){return t.showLoading(e)}}},"PaymentForm",t.$attrs,!1),t.$listeners),[e("div",{staticClass:"right-part"},[e("div",{staticClass:"info"},[e("StatisticsCard")],1)])]):t._e()],1)}),[],!1,null,"24a2f91e",null);e.default=component.exports;installComponents(component,{StatisticsCard:n(564).default})},368:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(24),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"creaCharacterConfirmModal",data:function(){return{visible:!1,options:null}},computed:l({},Object(r.c)("tavern",["editLoading"])),props:{dialogWidth:{type:Number,default:462}},methods:l(l({},Object(r.d)("tavern",["SET_EDIT_LOADING"])),{},{show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.resetData(),this.options=t,this.visible=!0},resetData:function(){this.options=null},handleClose:function(){this.visible=!1,this.$emit("cancel"),this.SET_EDIT_LOADING(!1)},handleConfirm:function(){var t,e,n;null!==(t=this.options)&&void 0!==t&&t.customClose||(this.visible=!1),this.editLoading||this.$emit("confirm",{type:null===(e=this.options)||void 0===e?void 0:e.handleMethods,id:(null===(n=this.options)||void 0===n?void 0:n.id)||""})}})},h=d,v=(n(4031),n(0)),component=Object(v.a)(h,(function(){var t,e,n,o=this,r=o._self._c;return r("el-dialog",{attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:o.visible,"custom-class":"common-confirm-modal custom-dialog","destroy-on-close":!1,"modal-append-to-body":"","append-to-body":"",width:o.dialogWidth+"px"},on:{"update:visible":function(t){o.visible=t}}},[r("div",{staticClass:"confirm-modal-header"},[r("div",{staticClass:"modal-header-title"},[o._v(o._s((null===(t=o.options)||void 0===t?void 0:t.title)||o.$t("Tip")))]),o._v(" "),r("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),o.handleClose()}}},[r("i",{staticClass:"el-icon-close"})])]),o._v(" "),o._t("custom_content",(function(){var t,e,n;return[r("div",{staticClass:"confirm-modal-content"},[r("div",{staticClass:"modal-content-left"},[r("div",{staticClass:"warning-icon-box"},[r("i",{staticClass:"iconfont icon-warn"})])]),o._v(" "),r("div",{staticClass:"modal-content-right"},[r("div",{staticClass:"modal-content-right-title"},[o._v(o._s((null===(t=o.options)||void 0===t?void 0:t.mainTitle)||o.$t("createCharacterTip")))]),o._v(" "),null!==(e=o.options)&&void 0!==e&&e.subTitle?[Array.isArray(o.options.subTitle)?o._l(o.options.subTitle,(function(t,e){return r("div",{key:e,staticClass:"modal-content-right-sub-title",domProps:{innerHTML:o._s(t)}})})):[r("div",{staticClass:"modal-content-right-sub-title"},[o._v("\n              "+o._s(null===(n=o.options)||void 0===n?void 0:n.subTitle)+"\n            ")])]]:o._e()],2)])]})),o._v(" "),r("div",{staticClass:"confirm-modal-footer"},[null!==(e=o.options)&&void 0!==e&&e.hideClose?o._e():r("span",{staticClass:"modal-footer-btn modal-footer-btn-cancel",on:{click:function(t){return t.stopPropagation(),o.handleClose()}}},[o._v(o._s(o.$t("Cancel")))]),o._v(" "),"ST"===(null===(n=o.options)||void 0===n?void 0:n.source)?[r("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",class:{"is-disabled":o.editLoading},on:{click:function(t){return t.stopPropagation(),o.handleConfirm()}}},[r("span",[o._v(o._s(o.$t("Confirm")))]),o._v(" "),o.editLoading?r("i",{staticClass:"el-icon-loading"}):o._e()])]:[r("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),o.handleConfirm()}}},[o._v(o._s(o.$t("Confirm")))])]],2)],2)}),[],!1,null,"131e1bc8",null);e.a=component.exports},369:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(18),n(24),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"DecorationsAvatar",props:{avatarUrl:{type:String,default:""},decorationUrl:{type:String,default:""},size:{type:Number,default:52}},computed:l(l({},Object(r.e)("user",["userInfo"])),{},{getNameFirst:function(){var t=this.userInfo||{},e=t.name,n=t.id;return(e?e[0]:n?n[0]:"V").toUpperCase()}})},h=(n(4779),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"avatar-wrap",style:{width:t.size+"px",height:t.size+"px"}},[t.avatarUrl||t.userInfo.head?e("img",{staticClass:"avatar",attrs:{src:t.avatarUrl||t.userInfo.head}}):e("div",{staticClass:"avatar-default"},[t._v(t._s(t.getNameFirst))]),t._v(" "),t.decorationUrl?e("img",{staticClass:"avatar-box",attrs:{src:t.decorationUrl}}):t._e()])}),[],!1,null,"6d7c5930",null);e.a=component.exports},3889:function(t,e,n){"use strict";n(1573)},4021:function(t,e,n){"use strict";n(1664)},4029:function(t,e,n){"use strict";n(1670)},4030:function(t,e,n){"use strict";n(1671)},4031:function(t,e,n){"use strict";n(1672)},4034:function(t,e,n){"use strict";n(1675)},4040:function(t,e,n){"use strict";n(1681)},4053:function(t,e,n){"use strict";n(1694)},4059:function(t,e,n){"use strict";n(1700)},4060:function(t,e,n){"use strict";n(1701)},411:function(t,e,n){"use strict";n(16),n(31),n(18),n(11),n(12),n(13),n(8);var o=n(14),r=n(30),c=n(3),l=n(2),d=(n(2284),n(47),n(959)),h=n.n(d),v=(n(20),n(19),n(6),n(32),n(22),n(49),n(4),n(21),n(7),n(82)),f=n(27),m=n(920),_=n(38),y=n(1),w=n(10),C=n(25),k=n(45),O=n(138),x=n(253),I=n(52),S=n(9),D=n(71);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var j={name:"SelectSoundModel",mixins:[k.a],components:{modelPayNum:O.default,changeVer:x.default,SwipeableList:I.default,AiChatSoundItem:m.a,ElAutocomplete:h.a},props:{selectList:{type:Array,default:function(){return["1fb5d6c22a1d6803519a62be8006c8b2"]}}},data:function(){return{soundsTypeInfo:S.ob,visible:!1,activeTab:"mine",timeName:"All",timeTypeOption:S.rb,tagIndex:"hot",typeOption:S.nb,tabList:[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],queryOptionsList:S.gb,replaceKeyArr:S.jb,queryParam:{order_by:"hot",keyword:""},filterQueryParams:{styles:[],model_types:[],list_b:[],list_a:[]},list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,page_size:60,total:0},debounceHandleScroll:null,gridNum:3,modalWidth:"1286px",debounceResize:null,itemScroll:null,queryType:"comprehensive",soundAttrSelectAll:[],isHideLoading:!1}},computed:P(P(P({},Object(y.c)("user",["isLoggedIn"])),{},{convertTabText:function(){return function(t){return t.title?t.title:this.$t(t.i18nKey)}}},Object(y.e)("user",["collectData","cdnHost","token"])),{},{showEmptyResult:function(){var t=!this.loading,e=!this.list.length&&!this.hotRecentUsedList.length;return t&&e},showRecommendText:function(){return!this.loading&&this.hotUsedList.length&&"mine"===this.activeTab&&"comprehensive"===this.queryType},isNoRecentUsed:function(){return!this.loading&&!this.list.length&&"recent"===this.queryType&&this.showRecommendText},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},activeTabClass:function(){return function(t){return t&&t===this.activeTab?"tab-active":""}},getImageUrl:function(){return function(t){var e="";return t.banner&&!["",null,void 0].includes(t.banner.url)?e=Object(w.K)(t.banner.url,this.$imgL):e}},activeSelectModel:function(){return function(t){return this.selectList.find((function(e){return t.id===e}))?"select-sound-active":""}},hotUsedList:function(){return this.hotRecentUsedList}}),beforeDestroy:function(){this.debounceHandleScroll=null},watch:{hotRecentUsedList:{handler:function(t){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var e=0;e<this.selectList.length;e++)this.selectList[e].id,this.hotRecentUsedList[i].id}},list:{handler:function(t){for(var i=0;i<this.list.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.list[i].id&&this.selectList[e].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[e].art_model_ver_no_name,this.list[i].banner.url=this.selectList[e].model_cover;break}}}},mounted:function(){var t=this;this.debounceHandleScroll=Object(C.debounce)(this.handleScroll,600),this.debounceResize=Object(C.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){t.handleResize()}))},methods:{newChat:function(){this.$emit("newChat")},querySearchAsync:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var o,r,c,l,data,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={except_num:10,nsfw_plus:1,prefix:n.queryParam.keyword,source_type:16},t.next=3,Object(v.e)(o);case 3:r=t.sent,c=r.status,l=r.data,data=void 0===l?{}:l,1e4===c.code&&(d=data.items.length?data.items.map((function(t){return{value:t.title}})):[],e(d));case 6:case"end":return t.stop()}}),t)})))()},isValueSelected:function(t,e){return this.soundAttrSelectAll.includes("".concat(t,":").concat(e))},handleFilterChange:function(t,e){if(!this.loading){this.$logEvent("log_actions",{operation:"click_select_params",behavior_info:"on_voice_select_pop",behavior_info_sub:e});var n="".concat(t,":").concat(e),o=this.soundAttrSelectAll.indexOf(n);-1!==o?this.soundAttrSelectAll.splice(o,1):this.soundAttrSelectAll.push(n),"recommend"===this.queryType&&(this.tagIndex="hot"),this.checkGetList()}},handleFilterReset:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.soundAttrSelectAll=[],this.filterQueryParams.list_a=[],this.filterQueryParams.list_b=[],this.filterQueryParams.styles=[],this.filterQueryParams.model_types=[],t||this.checkGetList())},getParamsForAttr:function(){var t=this;return this.filterQueryParams.list_a=[],this.filterQueryParams.list_b=[],this.filterQueryParams.styles=[],this.filterQueryParams.model_types=[],this.soundAttrSelectAll.forEach((function(e){var n=e.split(":"),o=Object(r.a)(n,2),c=o[0],l=o[1];t.filterQueryParams[c].includes(l)||t.filterQueryParams[c].push(l)})),this.filterQueryParams},loginAndChangeQuery:function(t){this.$emit("newChat"),this.changeQueryType(t)},changeQueryType:function(t){var e=this;this.$logEvent("log_actions",{operation:{collect:"click_my_collect",myAudio:"click_my_vioce",comprehensive:"click_recommendation",recent:"click_recent_use",recommend:"click_more_recommendation"}[t],behavior_info:"on_voice_select_pop"}),"myAudio"!==t&&"collect"!==t||this.isLoggedIn?(this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,page_size:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:""},this.checkGetList()):this.$EventBus.$emit("openLoginDialog",{callBack:function(){return e.loginAndChangeQuery(t)}})},checkGetList:function(){"comprehensive"!==this.queryType?"recent"===this.queryType?this.handleGetRecentUsed():this.handleSearch():this.handleGetComList()},handleGetComList:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,code,l,d,h,v,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("获取综合推荐",t.queryType),t.pageInfo.page=1,t.loading=!0,t.noMore=!1,t.loading=!0,{},n=t.getParamsForAttr(),e.prev=7,e.next=10,Object(_.W)(n);case 10:return o=e.sent,c=(r=o||{}).status.code,code=void 0===c?"":c,l=r.data,d=void 0===l?{}:l,[1e4,"10000"].includes(code)&&(h=Array.isArray(null==d?void 0:d.recently)?d.recently:[],t.noMore=!0,v=(h||[]).map((function(e){var n=(e||{}).nsfw;return[1,"1"].includes(void 0===n?0:n)&&(e.cover=t.nsfwUrl),e.timbre.cover=e.cover,e})),t.list="recent"===t.queryType?v.length<=10?v:v.slice(0,10):v,f=Array.isArray(null==d?void 0:d.items)&&"recent"!==t.queryType?d.items:[],m=t.list.map((function(t){return t.id})),t.hotRecentUsedList=(f||[]).filter((function(t){return!m.includes(t.id)})).map((function(e){var n=(e||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.cover=t.nsfwUrl);var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e.timbre.cover=e.cover,e}))),e.abrupt("return",t.list);case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[7,,14,17]])})))()},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.tagIndex===n.id&&(e=n.icon)})),e},handleCommand:function(t){this.tagIndex=t,this.queryParam.order_by=this.tagIndex,this.handleSearch()},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.start_at=t.startTime,this.queryParam.end_at=t.endTime,this.handleSearch()},changeScroll:function(){var t=this;this.$refs.listItem.forEach((function(e,n){e.classList.contains("tab-active")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))},getTag:function(){var t=this;Object(D.d)({show_area:"timbre"}).then((function(e){if(1e4===e.status.code){var n=e.data||[],r=[];n.forEach((function(e){e.title=e[S.r[t.$i18n.locale]],e.title&&r.push(e)})),console.log("resultArr",r),t.tabList=[].concat(Object(o.a)(t.tabList),r)}}))},changeType:function(t){this.list=[],this.pageInfo={page:1,page_size:60,total:0},this.handleSearch()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1286px",this.gridNum=3):(this.modalWidth="888px",this.gridNum=2)}catch(t){}},selectItem:function(t,e,n){var o,r;(e.model_ver_no=t.model_ver_id,e.version_name=t.version_no,e.base_model=t.base_model_name,e.modelTags=Array.isArray(null==t?void 0:t.tags)?null==t?void 0:t.tags:[],null!==(o=t.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?e.banner.url=null===(r=t.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url:e.banner.url="";n&&this.$emit("selectModel",e)},openModal:function(){var t=this;if(this.resetData(),this.tabList=[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],this.activeTab="mine",this.queryType="comprehensive",this.getTag(),!this.token)return this.checkGetList(),void(this.visible=!0);this.$nextTick((function(){t.handleGetComList().finally((function(){t.loading=!1,t.list.length&&t.list.length>=10?(t.activeTab="mine",t.queryType="recent"):(t.activeTab="mine",t.queryType="comprehensive")})),t.visible=!0}))},handleClose:function(){this.visible=!1,this.resetData()},resetData:function(){this.pageInfo={page:1,page_size:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:""},this.activeTab="mine",this.queryType="comprehensive",this.loading=!1,this.noMore=!1,this.hotRecentUsedList=[],this.list=[],this.filterQueryParams.list_a=[],this.filterQueryParams.list_b=[],this.filterQueryParams.model_types=[],this.filterQueryParams.styles=[]},handleViewMore:function(){this.activeTab="",this.handleTabClick("mine","recommend")},handleTabClick:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$logEvent("log_actions",{operation:"click_tab",behavior_info:"on_voice_select_pop",behavior_info_sub:t}),t===this.activeTab||this.loading||(this.activeTab=t,this.queryType="mine"===t?n||"comprehensive":"recommend",this.$nextTick((function(){e.changeScroll()})),this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,page_size:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:""},this.checkGetList())},handleSearch:function(){if(this.$route.name.includes("AIAudioCreate")?this.$logEvent("log_actions",{operation:"click_search",behavior_info:"on_choose_audio_popup"}):this.$logEvent("log_actions",{operation:"click_search",behavior_info:"on_voice_select_pop"}),this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.list=[],"recent"===this.queryType)return this.queryType="recommend",void this.handleGetComList();"comprehensive"===this.queryType&&(this.queryType="recommend"),this.getList()},handleScroll:function(){var t=this.$refs.scrollWrapper;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-30&&"recent"!==this.queryType&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(console.log("getList"),!this.loading&&!this.noMore){this.loading=!0;var n={page:this.pageInfo.page,page_size:this.pageInfo.page_size};["mine"].includes(this.activeTab)||(n.tag=this.activeTab),Object.assign(n,this.queryParam,this.getParamsForAttr());var o=_.H;"myAudio"===this.queryType&&(o=_.x),"collect"===this.queryType&&(o=f.c),this.queryParam.keyword&&(o=_.I),o(n).then((function(n){var o=n||{},r=o.status,c=void 0===r?{}:r,l=o.data,data=void 0===l?{}:l,d=c.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(e.noMore=!data.has_more,t){var h=e.list.map((function(t){return t.id})),v=(n.data.items||[]).filter((function(t){return!h.includes(t.id)})).map((function(t){var n=(t||{}).nsfw;return[1,"1"].includes(void 0===n?0:n)&&(t.cover=e.nsfwUrl),t.timbre.cover=t.cover,t}));e.list=e.list.concat(v)}else e.list=(n.data.items||[]).map((function(t){var n=(t||{}).nsfw;return[1,"1"].includes(void 0===n?0:n)&&(t.cover=e.nsfwUrl),t.timbre.cover=t.cover,t}));1===e.pageInfo.page&&(e.queryParam.time_to=n.data.time_ms),e.pageInfo.page++}})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))}},findSelectItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(t)){var e=this.selectList.find((function(e){return t.id===e.id}));return t=e||t}return null},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.$message.warning(this.$t("CannotSelectedRepeatedly")):this.$emit("selectModel",t)},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,this.handleGetComList()},handleDetail:function(t){(null==t?void 0:t.id)&&window.open("/models/detail/".concat(t.id))}}},$=j,T=(n(4999),n(5e3),n(0)),component=Object(T.a)($,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{ref:"styleModal",attrs:{title:n.$t("audioSelect"),visible:n.visible,width:n.modalWidth,height:"auto","custom-class":"c-style-modal c-style-modal-sound","modal-append-to-body":!1,"append-to-body":!0,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){n.visible=t},close:function(t){return n.handleFilterReset(!0)}}},[o("div",{staticClass:"style-content-wrapper-sound"},[o("div",{staticClass:"style-content__header"},[o("swipeable-list",{attrs:{scrollChange:n.itemScroll,top:"22px"}},[o("div",{staticClass:"style-content__header-tabs-sound"},n._l(n.tabList,(function(t,e){return o("div",{key:t.type+e},[o("div",{ref:"listItem",refInFor:!0,staticClass:"style-content__header-tabs-item-sound",class:[n.activeTabClass(t.id)],attrs:{"data-id":t.id},on:{click:function(e){return e.stopPropagation(),n.handleTabClick(t.id)}}},[n._v("\n              "+n._s(n.convertTabText(t))+"\n            ")])])})),0)])],1),n._v(" "),o("div",{staticClass:"style-content__search-box style-content__search-box-sound"},[o("div",{staticClass:"flex-a-center"},[o("el-autocomplete",{staticClass:"style-content__search-input-sound",attrs:{"popper-append-to-body":!1,"popper-class":"autocomplete-popper",placeholder:n.$t("searchMoreSounds"),"trigger-on-focus":!1,clearable:"","fetch-suggestions":n.querySearchAsync},on:{clear:n.handleSearch,select:n.handleSearch},model:{value:n.queryParam.keyword,callback:function(t){n.$set(n.queryParam,"keyword",t)},expression:"queryParam.keyword"}},[o("template",{slot:"prefix"},[o("i",{staticClass:"iconfont icon-search search-icon-sound",on:{click:n.handleSearch}})])],2),n._v(" "),o("div",{staticClass:"style-content__search-btn style-content__search-btn-gra-border",attrs:{"data-event":"ai-chat-sound-search"},on:{click:n.handleSearch}},[o("span",[n._v(n._s(n.$t("Search")))])])],1),n._v(" "),o("div",{staticClass:"search-right"},[o("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter page-ai-chat-sound dot-group",trigger:"hover"}},[o("div",{staticClass:"filterCnt"},[n._l(n.soundsTypeInfo,(function(t,e){return o("div",{key:e},[o("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[n._v("\n                "+n._s(n.$t(t.i18Key))+"\n              ")]),n._v(" "),o("div",{staticClass:"filterList"},n._l(t.value,(function(e,r){return o("div",{key:r,staticClass:"filterItem",class:{AfilterItem:n.isValueSelected(t.paramsKey,e.value)},attrs:{"data-id":e.value,"data-event":"ai-chat-sound-select-filter","data-desc":t.i18Key},on:{click:function(o){return n.handleFilterChange(t.paramsKey,e.value)}}},[n.isValueSelected(t.paramsKey,e.value)?o("i",{staticClass:"el-icon-check"}):n._e(),n._v(" "),o("span",[n._v(n._s(n.$t(e.i18Key)))])])})),0)])})),n._v(" "),o("div",{staticClass:"filterReset graBorder",on:{click:function(t){return n.handleFilterReset(!1)}}},[n._v("\n              "+n._s(n.$t("resetSelection"))+"\n            ")])],2),n._v(" "),o("el-badge",{staticClass:"item",attrs:{slot:"reference",value:null===(t=n.soundAttrSelectAll)||void 0===t?void 0:t.length,hidden:0==(null===(e=n.soundAttrSelectAll)||void 0===e?void 0:e.length)},slot:"reference"},[o("div",{staticClass:"filterBox"},[o("div",[o("i",{staticClass:"iconfont icon-a-filterIcon"}),n._v(" "),o("span",[n._v(n._s(n.$t("Filter")))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})])])],1),n._v(" "),"mine"===n.activeTab?o("el-select",{staticClass:"showType custom-select",class:n.$i18n.locale,attrs:{"popper-class":"custom-select page-ai-chat-sound dot-group","data-event":"ai-chat-sound-select-open","data-id":n.queryType},on:{change:n.changeQueryType},model:{value:n.queryType,callback:function(t){n.queryType=t},expression:"queryType"}},n._l(n.queryOptionsList,(function(t){return o("el-option",{key:t.value,attrs:{label:n.$t(t.i18nKey),value:t.value,"data-event":"ai-chat-sound-select-open","data-id":t.value}})})),1):n._e(),n._v(" "),["mine"].includes(n.activeTab)?n._e():o("div",{staticClass:"Screening"},[o("el-dropdown",{staticClass:"el-dropdown-sound",attrs:{trigger:"hover"},on:{command:n.handleTimeCommand}},[o("div",{staticClass:"el-dropdown-link selectTime"},[o("div",[o("i",{staticClass:"el-icon-time"}),n._v(" "),o("span",[n._v(n._s(n.$t(n.timeName)))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.timeTypeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t}},[o("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1),n._v(" "),o("el-dropdown",{staticClass:"el-dropdown-sound",attrs:{trigger:"hover"},on:{command:n.handleCommand}},[o("div",{staticClass:"el-dropdown-link"},[o("div",[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(n.setIcon())}),n._v(" "),o("span",[n._v(n._s(n.$t(n.tagIndex.charAt(0).toUpperCase()+n.tagIndex.slice(1))))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.typeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t.id}},[o("div",{staticClass:"el-dropdown-item"},[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),n._v(" "),o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1)],1)],1)]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"style-content__list-wrapper-sound",class:[n.isNoRecentUsed?"style-content__list-wrapper-no-margin":""],style:{gridTemplateColumns:"repeat(".concat(n.gridNum,", 1fr)")},on:{scroll:n.handleScroll}},[n.list.length?[n._l(n.list,(function(t){return o("AiChatSoundItem",{key:t.id,class:[n.activeSelectModel(t)],attrs:{item:t.timbre},on:{handleSelect:function(e){n.handleSelect(t,n.activeSelectModel(t))}}})})),n._v(" "),n.list.length>1&&n.list.length<9?n._l(9,(function(t){return o("div",{staticClass:"sound-item",attrs:{index:t}})})):n._e()]:n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showRecommendText,expression:"showRecommendText"}],staticClass:"recommend-text",style:{gridColumn:"span ".concat(n.gridNum)}},[o("div",{staticClass:"recommend-text-line"}),n._v(" "),o("div",{staticClass:"recommend-text-main"},[n._v(n._s(n.$t("hotSoundsForYou")))]),n._v(" "),o("div",{staticClass:"recommend-text-line"})]),n._v(" "),!n.loading&&n.hotUsedList.length&&"mine"===n.activeTab&&["comprehensive"].includes(n.queryType)?[n._l(n.hotUsedList,(function(t){return o("AiChatSoundItem",{key:t.id,class:[n.activeSelectModel(t)],attrs:{item:t.timbre},on:{newChat:n.newChat,handleSelect:function(e){n.handleSelect(t,n.activeSelectModel(t))}}})})),n._v(" "),o("div",{staticClass:"show-more-item",style:{gridColumn:"span ".concat(n.gridNum)}},[o("span",{staticClass:"show-more-item-btn",on:{click:function(t){return t.stopPropagation(),n.handleViewMore()}}},[o("span",{staticClass:"show-more-item-btn-text"},[n._v(n._s(n.$t("viewMore")))]),n._v(" "),o("i",{staticClass:"iconfont icon-icon-direction-down show-more-item-btn-icon"})])])]:n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),"mine"===n.activeTab&&["recent"].includes(n.queryType)&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n          "+n._s(n.$t("soundRecent"))+"\n        ")]:["collect"].includes(n.queryType)&&"mine"===n.activeTab&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n          "+n._s(n.$t("soundCollect"))+"\n        ")]:[n._v(n._s(n.$t("NoResultsFound")))]],2)],2)])])}),[],!1,null,"475c8383",null);e.a=component.exports;installComponents(component,{SwipeableList:n(52).default,SvgIcon:n(115).default})},4138:function(t,e,n){"use strict";n(1780)},4261:function(t,e,n){"use strict";n(1837)},4680:function(t,e,n){"use strict";n(2118)},4681:function(t,e,n){"use strict";n(2119)},4682:function(t,e,n){"use strict";n(2120)},4683:function(t,e,n){"use strict";n(2121)},4684:function(t,e,n){"use strict";n(2122)},4685:function(t,e,n){"use strict";n(2123)},4686:function(t,e,n){"use strict";n(2124)},4687:function(t,e,n){"use strict";n(2125)},4688:function(t,e,n){"use strict";n(2126)},4689:function(t,e,n){"use strict";n(2127)},4690:function(t,e,n){"use strict";n(2128)},4691:function(t,e,n){"use strict";n(2129)},4692:function(t,e,n){"use strict";n(2130)},4693:function(t,e,n){"use strict";n(2131)},4694:function(t,e,n){"use strict";n(2132)},4695:function(t,e,n){"use strict";n(2133)},4696:function(t,e,n){"use strict";n(2134)},4697:function(t,e,n){"use strict";n(2135)},473:function(t,e,n){"use strict";n(16),n(18),n(21),n(11),n(12),n(13),n(8);var o=n(3),r=n(14),c=n(2),l=(n(20),n(19),n(6),n(32),n(22),n(122),n(4),n(7),n(38)),d=n(1),h=n(35),v=n.n(h);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"AiChatModelSelect",props:{isToolCharacterProps:{type:Boolean,default:!1},recommendModels:{type:Array,default:function(){return[]}}},data:function(){return{isShowActivityTag:!1,isCreatePage:!1,currentMsg:null,loading:!0,dialogVisible:!1,activeTab:"basic",selectedModel:"",tabs:[{id:"basic",name:"BaseModel"},{id:"advanced",name:"characterSettingAdvModel"}],models:{basic:[],advanced:[],deepSeek:[]},trialArr:[]}},watch:{defaultGptModel:{handler:function(t){t&&t!==this.selectedModel&&(this.selectedModel=t||"GPT-35-Turbo-1106",this.autoSwitchTab())},immediate:!0}},computed:m(m(m(m(m({},Object(d.c)("user",["isLoggedIn","userInfo","characterSetting"])),Object(d.c)("payment",["paymentInfo"])),Object(d.e)("user",["cdnHost"])),Object(d.c)("character",["characterInfo","isToolCharacter","isDigitalCharacter"])),{},{isToolCharacterScope:function(){return this.isToolCharacter||this.isToolCharacterProps},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},defaultGptModel:function(){var t,e,n,o,r,c,l,d,h,v=(null===(t=this.characterInfo)||void 0===t?void 0:t.gpt_model)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.gpt_model)||!1;return(this.isToolCharacterScope?1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_functionality_model):1!==(null===(o=this.characterSetting)||void 0===o?void 0:o.is_set_companion_model))&&v||!this.isLoggedIn?this.isLoggedIn&&null!==(r=this.characterInfo)&&void 0!==r&&r.gpt_model&&"-"!==(null===(c=this.characterInfo)||void 0===c?void 0:c.gpt_model)?null===(h=this.characterInfo)||void 0===h?void 0:h.gpt_model:this.isToolCharacter?"Deepseek-v3":"GPT-35-Turbo-1106":this.isToolCharacterScope?null===(l=this.characterSetting)||void 0===l?void 0:l.functionality_gpt_model:null===(d=this.characterSetting)||void 0===d?void 0:d.gpt_model},currentModelObj:function(){var t=this;return this.currentModels.find((function(e){return e.gpt_model===t.selectedModel}))||{}},currentTalkModelObj:function(){var t,e=this;return(null===(t=this.models.workflow)||void 0===t?void 0:t.find((function(t){return t.workflow_no===e.currentWorkflowId})))||{}},currentWorkflowId:function(){var t,e,n,o,r,c=(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.workflow_no)||!1;return 1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_workflow)&&c?(null===(o=this.characterInfo)||void 0===o?void 0:o.workflow_no)||this.defaultWorkflowNo||"":(null===(r=this.characterSetting)||void 0===r?void 0:r.workflow_no)||this.defaultWorkflowNo||""},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},currentModels:function(){var t=this.sortedModels;return this.isToolCharacterScope?t.deepSeek:t[this.activeTab]||[]},sortedModels:function(){var t,e;if(!this.isDigitalCharacter)return this.models;var n=(null===(t=this.currentTalkModelObj)||void 0===t?void 0:t.highly_recommend)||"",o=(null===(e=this.currentTalkModelObj)||void 0===e?void 0:e.recommend)||[],c=function(a,b){return a.gpt_model===n?-1:b.gpt_model===n?1:o.includes(a.gpt_model)&&!o.includes(b.gpt_model)?-1:!o.includes(a.gpt_model)&&o.includes(b.gpt_model)?1:0};return m(m({},this.models),{},{basic:Object(r.a)(this.models.basic||[]).sort(c),advanced:Object(r.a)(this.models.advanced||[]).sort(c)})},currentVipLevel:function(){var t=["Member","ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][this.paymentInfo.productLevel]||"",e="basic";return t&&(["Member","ToB_beginnerPlan","StandardPlan"].includes(t)&&(e="professional"),["ToB_professionalPlan"].includes(t)&&(e="MasterPlan")),e}}),methods:m(m(m({},Object(d.b)("user",["getAccountInfo"])),Object(d.d)("user",["SET_USER_INFO"])),{},{isShowRecommendTag:function(t){return!!this.isDigitalCharacter&&this.recommendModels.includes(t)},handleTabClick:function(t){this.activeTab=t},handleModelClick:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$logEvent("log_actions",{operation:"click_change_model",behavior_info:"on_tarven_detail_page",behavior_info_sub:"choose_".concat(t.title_key)}),e.selectedModel=t.gpt_model,e.updateModelsSelection(t.gpt_model),n.next=5,e.handleSave();case 5:case"end":return n.stop()}}),n)})))()},updateModelsSelection:function(t){this.models.basic=this.models.basic.map((function(e){return m(m({},e),{},{isSelected:e.gpt_model===t})})),this.models.advanced=this.models.advanced.map((function(e){return m(m({},e),{},{isSelected:e.gpt_model===t})}))},show:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=(r=e.length>1&&void 0!==e[1]?e[1]:{}).isCreatePage,l=void 0!==c&&c,d=r.gpt_model,h=void 0===d?"":d,n.loading=!0,n.dialogVisible=!0,o.next=6,n.getModels();case 6:n.isCreatePage=l,h&&(n.selectedModel=h,n.updateModelsSelection(h)),t&&(n.currentMsg=t);case 9:case"end":return o.stop()}}),o)})))()},hide:function(){this.dialogVisible=!1},getModels:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,c,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,Object(l.u)();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:n=e.t0,data=(o=n||{}).data,1e4===(null==(r=o.status)?void 0:r.code)&&(t.trialArr=(null==data?void 0:data.vip_open_use_key)||[],t.isShowActivityTag=(null==data||null===(c=data.activity_item)||void 0===c?void 0:c.discount_activity)||!1,v=(null==data||null===(d=data.List)||void 0===d?void 0:d.filter((function(t){return!t.is_svip})))||[],f=(null==data||null===(h=data.List)||void 0===h?void 0:h.filter((function(t){return t.is_svip})))||[],m=(null==data?void 0:data.functionality_list)||[],_=(null==data?void 0:data.workflow_list)||[],v.forEach((function(e){e.isSelected=e.gpt_model===t.selectedModel})),f.forEach((function(e){e.isSelected=e.gpt_model===t.selectedModel})),m.forEach((function(e){e.isSelected=e.gpt_model===t.selectedModel})),t.models={basic:v,advanced:f,deepSeek:m,workflow:_},t.autoSwitchTab()),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(1),console.log("getModels-error",e.t1);case 15:t.loading=!1;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()},handleCancel:function(){this.selectedModel=this.defaultGptModel||this.selectedModel,this.dialogVisible=!1},handleSave:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,d,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=3;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 3:if(n=t.models.advanced.find((function(e){return e.gpt_model===t.selectedModel})),o=t.trialArr.includes(t.selectedModel),t.isVip||!n||o){e.next=8;break}return t.handleOpenVip(),e.abrupt("return");case 8:if(!t.isCreatePage||!t.currentModelObj){e.next=12;break}return t.$emit("selectModel",t.currentModelObj),t.dialogVisible=!1,e.abrupt("return");case 12:if(!t.isLoggedIn){e.next=24;break}return c=v()(t.userInfo)||{},t.isToolCharacterScope?c.character_setting.functionality_gpt_model=t.selectedModel:c.character_setting.gpt_model=t.selectedModel,t.SET_USER_INFO(c),d=t.isToolCharacterScope?{functionality_gpt_model:t.selectedModel}:{gpt_model:t.selectedModel},e.next=19,Object(l.ab)(d);case 19:if(1e4===(null==(h=e.sent)||null===(r=h.status)||void 0===r?void 0:r.code)){e.next=22;break}throw new Error((null==h||null===(f=h.status)||void 0===f?void 0:f.message)||t.$t("taskOperateFailed"));case 22:t.$message.success(t.$t("SaveSuccess")),t.getAccountInfo(c);case 24:t.$emit("change",{model:t.selectedModel,msg:t.currentMsg||null}),t.dialogVisible=!1;case 26:case"end":return e.stop()}}),e)})))()},handleOpenVip:function(){this.$EventBus.$emit("showBreakDialog","characterSettingVipDesc","basic")},autoSwitchTab:function(){var t=this;if(!this.isToolCharacterScope){var e=[].concat(Object(r.a)(this.models.basic),Object(r.a)(this.models.advanced)).find((function(e){return e.gpt_model===t.selectedModel}));e&&(this.activeTab=e.is_svip?"advanced":"basic")}}})},y=_,w=(n(5123),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("characterSettingModelChange"),visible:t.dialogVisible,"custom-class":"model-switcher-dialog","close-on-click-modal":!1,"append-to-body":"",top:"5vh"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleCancel}},[t.isShowActivityTag?e("div",{staticClass:"model-tabs-activity-tag"},[e("div",{staticClass:"activity-text"},[t._v("\n      "+t._s(t.$t("chatModelActivity",{count:70}))+"\n      "),e("div",{staticClass:"activity-discount",style:t.getBg},[t._v(t._s("70% Off"))])])]):t._e(),t._v(" "),t.isToolCharacterScope?t._e():e("div",{staticClass:"model-tabs"},t._l(t.tabs,(function(o){return e("div",{key:o.id,staticClass:"model-tab",class:{"model-tab-active":t.activeTab===o.id},attrs:{"data-event":"ai-chat-model-tab","data-id":o.id},on:{click:function(e){return t.handleTabClick(o.id)}}},[t._v("\n      "+t._s(t.$t(o.name))+"\n      "),"advanced"===o.id?e("img",{attrs:{src:n(375),alt:"searArt.AI"}}):t._e()])})),0),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"model-list"},[t.currentModels.length>0?t._l(t.currentModels,(function(n){return e("div",{key:n.gpt_model,staticClass:"model-list-item",class:{"model-list-item-is-checked":t.selectedModel===n.gpt_model},attrs:{"data-event":"ai-chat-model-checkbox","data-id":n.gpt_model,"data-info":JSON.stringify({model_type:t.activeTab})},on:{click:function(e){return t.handleModelClick(n)}}},[t.trialArr.includes(n.gpt_model)?e("div",{staticClass:"model-list-item-trial-tip"},[e("div",{staticClass:"model-list-item-trial-tip-btn"},[t._v(t._s(t.$t("limitedNonSVIPExperience")))])]):t._e(),t._v(" "),e("div",{staticClass:"model-list-item-header"},[e("div",{staticClass:"model-title"},[t._v("\n            "+t._s(t.$t(n.title_key)||n.title)+"\n            "),t._v(" "),n.is_new?e("span",{staticClass:"model-title-tag"},[t._v("New")]):t._e(),t._v(" "),t.isShowRecommendTag(n.gpt_model)?e("span",{staticClass:"model-title-tag model-title-tag-recommend"},[t._v("Recommend")]):t._e()]),t._v(" "),e("div",{staticClass:"model-handle"},[e("el-tooltip",{attrs:{content:t.$t("characterSettingEvaluateDesc"),placement:"top"}},[e("div",{staticClass:"model-rating"},[e("i",{staticClass:"star-icon icon-icon-star iconfont"}),t._v("\n                "+t._s(n.score)+"\n              ")])]),t._v(" "),e("div",{staticClass:"custom-checkbox",class:{"is-checked":n.gpt_model===t.selectedModel}},[e("i",{staticClass:"el-icon-check"})])],1)]),t._v(" "),e("div",{staticClass:"model-list-item-description"},[t._v(t._s(t.$t(n.lang_key)||n.lang))])])})):t._e(),t._v(" "),0!==t.currentModels.length||t.loading?t._e():[e("div",{staticClass:"model-list-no-data"},[t._v(t._s(t.$t("no_data")))])]],2)])}),[],!1,null,"3716d817",null);e.a=component.exports},474:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);n(16),n(18);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l=n(3),d=(n(20),n(19),n(50),n(22),n(31),n(113),n(21),n(39)),h=n(112),v=n(111),f=n(45),m=n(10),_=n(207),y=n(1),w=n(184),C=n(27),k=n(53),O=n(278),x=n(108);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={mixins:[f.a],components:{ImgWaterFall:h.default,listCheckbox:_.default,AdminTag:v.default,BaseAvatar:k.default,HyJewelryModal:O.default,HyColorfulBorder:x.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},isCheck:{type:Boolean,default:!1},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},isOpenNewTab:{type:Boolean,default:!1},review:{type:Boolean,default:!1}},data:function(){var t;return{isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,formatNumberForeign:m.p,cntShow:!0,deleteLoad:!1,hasHover:!1,videoBgShow:!0,jewelryModalVisible:!1}},computed:S(S(S({},Object(y.c)("user",["isLoggedIn"])),Object(y.e)("user",["userInfo"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},setNsfwPlus:function(){return function(t){return!1}}}),methods:{isVideoLink:m.G,isGifLink:function(){var link=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!link&&link.toLowerCase().endsWith(".gif")},onPlayFun:function(){this.$refs.myVideo&&(this.$refs.myVideo.play(),this.$refs.myVideo.style.opacity=1,this.$refs.myVideo.paused||(this.videoBgShow=!1)),!this.hasHover&&this.onPause()},onPlay:function(){this.hasHover=!0,this.onPlayFun()},onPause:function(){this.hasHover=!1,this.$refs.myVideo&&(this.$refs.myVideo.pause(),this.$refs.myVideo.currentTime=0,this.$refs.myVideo.style.opacity=0),this.videoBgShow=!0},moreActions:function(t){switch(t){case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item)}},handleReport:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(d.i)({items:[S(S({},this.dotReportInfo),{},{negative_ids:n,action:"view",obj_no:t.id,obj_type:t.obj_type})]})},handleMouseUp:function(t,e){2!==t.which&&1!==t.button||this.handleReport(e)},handleDetail:function(t,e){var n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:l="string"==typeof t.target.className&&(null===(r=t.target.className)||void 0===r?void 0:r.includes("boxItem")),d=["green-mode-div","ImgWaterFall","cnt","title","rate","numItem","user"],("IMG"===t.target.tagName||l||d.includes(t.target.className)||null!==(c=t.target.className)&&void 0!==c&&c.includes("jiedian"))&&(1!=(null===(h=e.comfy_ui)||void 0===h?void 0:h.type)&&2!=(null===(v=e.comfy_ui)||void 0===v?void 0:v.type)?(n.handleReport(e),n.isOpenNewTab?window.open("/workFlowAppDetail/"+e.id,"_blank"):n.$router.push(n.localePath("/workFlowAppDetail/"+e.id))):(n.handleReport(e),n.isOpenNewTab?window.open("/workFlowDetail/"+e.id,"_blank"):n.$router.push(n.localePath("/workFlowDetail/"+e.id))));case 3:case"end":return o.stop()}}),o)})))()},handleClick:function(t){var e,n;if(this.isLoggedIn)if(1!=(null===(e=t.comfy_ui)||void 0===e?void 0:e.type)&&2!=(null===(n=t.comfy_ui)||void 0===n?void 0:n.type))this.isOpenNewTab?window.open("/workFlowAppDetail/"+t.id,"_blank"):this.$router.push(this.localePath("/workFlowAppDetail/"+t.id));else{var o,r,source=4;this.userInfo&&(null===(o=this.userInfo)||void 0===o?void 0:o.id)==(null==t||null===(r=t.author)||void 0===r?void 0:r.id)&&(source=3),this.isOpenNewTab?window.open("/workflow?id=".concat(t.id,"&source=").concat(source),"_blank"):this.$router.push(this.localePath("/workflow?id="+t.id+"&source=".concat(source)));var c=t.id,l=t.obj_type,d=t.pt;this.$logEvent("log_actions",{operation:"same_create",behavior_info:c,obj_type:l,behavior_info_sub:d})}else this.$EventBus.$emit("openLoginDialog")},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},onDelete:function(t){var e=this;this.$confirm(this.$t("comfyDeleteErrTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){if(!e.deleteLoad){e.deleteLoad=!0;var n={id:t.id};Object(w.a)(n).then((function(n){if(1e4===n.status.code)e.setWaterFallDeleteLits(t.id),e.$emit("resizeListener"),e.$message({type:"success",message:e.$t("deleteSuccess")});else if(150006===n.status.code){var link="https://aihelp.net/questionnaire/#/?formId=9b11c5ac84f4482bae17e6a23df0ab37";"zhCN"==e.$i18n.locale&&(link="https://aihelp.net/questionnaire/#/?formId=9bc3744979f943dda31a09f7573f80d2"),window.open(link)}else e.$message.error(e.$t("ServerError"))})).finally((function(){e.deleteLoad=!1}))}})).catch((function(){}))},tagChange:function(){this.$emit("change")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(C.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},addContentDecoration:function(){this.jewelryModalVisible=!0},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}}},L=D,P=(n(4261),n(0)),component=Object(P.a)(L,(function(){var t,e,n,o,r,l,d,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L,P,j,$=this,T=$._self._c;return T("a",{attrs:{href:1!=(null===(t=$.item.comfy_ui)||void 0===t?void 0:t.type)&&2!=(null===(e=$.item.comfy_ui)||void 0===e?void 0:e.type)?$.localePath("/workFlowAppDetail/"+$.item.id):$.localePath("/workFlowDetail/"+$.item.id),target:"_blank"},on:{click:function(t){t.preventDefault(),!$.isCheck&&$.handleDetail(t,$.item)},mouseup:function(t){return $.handleMouseUp(t,$.item)},mouseover:function(t){$.cntShow=!0}}},[T("HyColorfulBorder",{attrs:{photoFrame:$.item.work_frame,borderRadius:16,boxHeight:"100%"}},[T("div",{staticClass:"defBox",class:{"bg-nsfw":1===$.item.nsfw,boxItem:!$.setNsfwPlus($.item)},style:{width:$.item.waterWidth+"px",height:$.item.waterHeight+"px"},on:{mouseenter:function(t){!$.isCheck&&$.onPlay()},mouseleave:function(t){!$.isCheck&&$.onPause()}}},[$.isCheck&&$.item?T("listCheckbox",{on:{change:function(t){return $.$emit("checkChange")}},model:{value:$.item.isCheck,callback:function(t){$.$set($.item,"isCheck",t)},expression:"item.isCheck"}}):$._e(),$._v(" "),T("div",{directives:[{name:"show",rawName:"v-show",value:$.item.NSFWSHOW&&[2,"2"].includes(null===(n=$.userInfo)||void 0===n||null===(n=n.settings)||void 0===n?void 0:n.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{right:null!==(o=$.item)&&void 0!==o&&o.nsfw_plus?"10px":"75px",opacity:null!==(r=$.item)&&void 0!==r&&r.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),$.item.nsfw_plus=!(null!==(e=$.item)&&void 0!==e&&e.nsfw_plus)}}},[T("i",{staticClass:"iconfont",class:null!==(l=$.item)&&void 0!==l&&l.nsfw_plus?"icon-work-show":"icon-work-hide"})]),$._v(" "),$.item.nsfw?T("ImgWaterFall",{directives:[{name:"show",rawName:"v-show",value:!$.isVideoLink(null===(d=$.item)||void 0===d||null===(d=d.comfy_ui)||void 0===d?void 0:d.cover)||$.isVideoLink(null===(h=$.item)||void 0===h||null===(h=h.comfy_ui)||void 0===h?void 0:h.cover)&&!$.hasHover&&$.videoBgShow,expression:"!isVideoLink(item?.comfy_ui?.cover) || (isVideoLink(item?.comfy_ui?.cover) && !hasHover && videoBgShow)"}],style:{transform:$.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:$.setNsfwPlus($.item)?"blur(19px) saturate(160%)":""},attrs:{item:c(c({},$.item||{}),{},{replaceUrl:$.isGifLink(null===(v=$.item)||void 0===v||null===(v=v.comfy_ui)||void 0===v?void 0:v.cover)?null===(f=$.item)||void 0===f||null===(f=f.comfy_ui)||void 0===f?void 0:f.cover:""})}}):$._e(),$._v(" "),$.item.nsfw&&$.isVideoLink(null===(m=$.item)||void 0===m||null===(m=m.comfy_ui)||void 0===m?void 0:m.cover)?T("video",{ref:"myVideo",style:{filter:$.setNsfwPlus($.item)?"blur(19px) saturate(160%)":""},attrs:{loop:"",muted:"",src:null===(_=$.item)||void 0===_||null===(_=_.comfy_ui)||void 0===_?void 0:_.cover,preload:"none"},domProps:{muted:!0}}):$._e(),$._v(" "),T("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),$.handleClick($.item)}}},[$._v($._s($.$t("Try")))]),$._v(" "),T("div",{directives:[{name:"show",rawName:"v-show",value:$.isLoggedIn,expression:"isLoggedIn"}],staticClass:"cltpop"}),$._v(" "),[1,2].includes(null===(y=$.item.comfy_ui)||void 0===y?void 0:y.type)&&1==(null===(w=$.item.comfy_ui)||void 0===w?void 0:w.run_available)?T("i",{staticClass:"iconfont icon-icon_jiedian boxItemjidian"}):$._e(),$._v(" "),T("div",{staticClass:"cnt"},[T("div",{staticClass:"user",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),$.otherUser($.item)}}},[T("BaseAvatar",{attrs:{userData:$.item.author,size:24}}),$._v(" "),T("span",{staticClass:"authorName"},[$._v($._s(null===(C=$.item.author)||void 0===C?void 0:C.name))])],1),$._v(" "),T("div",{staticClass:"title"},[$._v($._s(null===(k=$.item.comfy_ui)||void 0===k?void 0:k.name))]),$._v(" "),null!==(O=$.item)&&void 0!==O&&null!==(O=O.stat)&&void 0!==O&&O.rating?T("div",{staticClass:"rate"},[T("el-rate",{attrs:{disabled:""},model:{value:$.item.stat.rating,callback:function(t){$.$set($.item.stat,"rating",t)},expression:"item.stat.rating"}}),$._v(" "),T("span",[$._v($._s($.item.stat.rating))])],1):$._e(),$._v(" "),T("div",{staticClass:"numItem"},[T("div",{staticClass:"play",on:{click:function(t){t.stopPropagation(),t.preventDefault(),!$.isCheck&&$.handleClick($.item)}}},[T("i",{staticClass:"iconfont icon-play"}),$._v(" "),null!==(x=$.item.stat)&&void 0!==x&&x.num_of_task?T("span",[$._v($._s($.formatNumberForeign(null===(I=$.item.stat)||void 0===I?void 0:I.num_of_task)))]):$._e()]),$._v(" "),$.cntShow?T("div",{staticClass:"funItem",on:{click:function(t){var e,n;return t.stopPropagation(),t.preventDefault(),$.setCollect($.item,1!=(null===(e=$.item.comfy_ui)||void 0===e?void 0:e.type)&&2!=(null===(n=$.item.comfy_ui)||void 0===n?void 0:n.type)?"swtft_app":"workflow")}}},[T("i",{staticClass:"iconfont",class:$.setCollectData($.item)}),$._v(" "),null!==(S=$.item.stat)&&void 0!==S&&S.num_of_collection?T("span",[$._v($._s($.item.stat.num_of_collection))]):$._e()]):T("div",{staticClass:"funItem"},[T("i",{staticClass:"iconfont",class:$.item.collect?"icon-collect_selected":"icon-collect"}),$._v(" "),null!==(D=$.item.stat)&&void 0!==D&&D.num_of_collection?T("span",[$._v($._s($.item.stat.num_of_collection))]):$._e()]),$._v(" "),T("div",{staticClass:"funItem jiedian"},[T("i",{staticClass:"iconfont icon-icon_jiedian jiedian"}),$._v(" "),null!==(L=$.item.comfy_ui)&&void 0!==L&&L.node_num?T("span",{staticClass:"jiedian"},[$._v($._s($.formatNumberForeign(null===(P=$.item.comfy_ui)||void 0===P?void 0:P.node_num)))]):$._e()]),$._v(" "),$.isPersonal?T("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:$.handlePopoverShow}},[T("div",{staticClass:"pop-btns flex"},[T("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==$.fromPage&&$.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),$.addContentDecoration()}}},[$._v("\n                "+$._s($.$t("addContentDecoration"))+"\n              ")]),$._v(" "),T("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==$.fromPage&&$.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),$.moreActions("pinOrNot")}}},[$._v("\n                "+$._s($.$t(null!==(j=$.item)&&void 0!==j&&j.isTop?"UnpinOverview":"PinOverview"))+"\n              ")]),$._v(" "),T("button",{directives:[{name:"show",rawName:"v-show",value:3!=$.item.status&&$.isMine,expression:"item.status != 3 && isMine"}],on:{click:function(t){return t.preventDefault(),$.moreActions("delete")}}},[$._v("\n                "+$._s($.$t("Delete"))+"\n              ")])]),$._v(" "),T("div",{staticClass:"funItem more-btn-opacity",attrs:{slot:"reference"},slot:"reference"},[T("i",{staticClass:"iconfont icon-more"})])]):$._e()],1)])],1)]),$._v(" "),T("admin-tag",{attrs:{id:$.item.id,item:$.item,type:$.item.obj_type,review:$.review},on:{change:$.tagChange}}),$._v(" "),T("HyJewelryModal",{attrs:{artwork:$.item},on:{useSuccess:$.handleUseJewelrySuccess},model:{value:$.jewelryModalVisible,callback:function(t){$.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"2ceaa585",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,BaseAvatar:n(53).default,AdminTag:n(111).default})},4757:function(t,e,n){"use strict";n(2194)},4758:function(t,e,n){"use strict";n(2195)},4759:function(t,e,n){"use strict";n(2196)},476:function(t,e,n){"use strict";n(4);var o={name:"AiChatEditForm",props:{formObj:{type:Object,default:function(){return{}}}},data:function(){return{form:{title:this.formObj.title||"",id:this.formObj.id||""},rules:{title:[{required:!0,message:this.$t("enterName"),trigger:"blur"}]}}},methods:{validate:function(){var t=this;return new Promise((function(e){t.$refs.editForm.validate((function(t){e(!!t)}))}))},resetForm:function(){this.$refs.editForm.resetFields()}},watch:{formObj:{handler:function(t){this.form=t},immediate:!0,deep:!0}}},r=n(0),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("el-form",{ref:"editForm",staticClass:"ai-chat-edit-popup-form",attrs:{"label-position":"top",inline:"",model:t.form,rules:t.rules,"label-width":"500px"}},[e("el-form-item",{attrs:{label:t.$t("trainName"),prop:"title"}},[e("el-input",{attrs:{maxlength:"30"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1)}),[],!1,null,null,null);e.a=component.exports},4760:function(t,e,n){"use strict";n(2197)},4761:function(t,e,n){"use strict";n(2198)},4762:function(t,e,n){"use strict";n(2199)},4763:function(t,e,n){"use strict";n(2200)},4764:function(t,e,n){"use strict";n(2201)},4765:function(t,e,n){"use strict";n(2202)},4766:function(t,e,n){"use strict";n(2203)},4767:function(t,e,n){"use strict";n(2204)},4768:function(t,e,n){"use strict";n(2205)},4769:function(t,e,n){"use strict";n(2206)},4770:function(t,e,n){"use strict";n(2207)},4771:function(t,e,n){"use strict";n(2208)},4772:function(t,e,n){"use strict";n(2209)},4776:function(t,e,n){"use strict";n(2213)},4777:function(t,e,n){"use strict";n(2214)},4778:function(t,e,n){"use strict";n(2215)},4779:function(t,e,n){"use strict";n(2216)},4780:function(t,e,n){"use strict";n(2217)},4781:function(t,e,n){"use strict";n(2218)},4782:function(t,e,n){"use strict";n(2219)},4784:function(t,e,n){"use strict";n(2221)},4785:function(t,e,n){"use strict";n(2222)},4786:function(t,e,n){"use strict";n(2223)},4787:function(t,e,n){"use strict";n(2224)},4790:function(t,e,n){"use strict";n(2227)},4791:function(t,e,n){"use strict";n(2228)},4792:function(t,e,n){"use strict";n(2229)},4795:function(t,e,n){"use strict";n(2232)},4796:function(t,e,n){"use strict";n(2233)},4799:function(t,e,n){"use strict";n(2236)},4800:function(t,e,n){"use strict";n(2237)},4801:function(t,e,n){"use strict";n(2238)},4802:function(t,e,n){"use strict";n(2239)},4803:function(t,e,n){"use strict";n(2240)},4804:function(t,e,n){"use strict";n(2241)},4821:function(t,e,n){"use strict";n(2258)},4822:function(t,e,n){"use strict";n(2259)},4823:function(t,e,n){"use strict";n(2260)},4825:function(t,e,n){"use strict";n(2262)},4826:function(t,e,n){"use strict";n(2263)},4827:function(t,e,n){"use strict";n(2264)},4828:function(t,e,n){"use strict";n(2265)},4829:function(t,e,n){"use strict";n(2266)},4830:function(t,e,n){"use strict";n(2267)},4831:function(t,e,n){"use strict";n(2268)},4832:function(t,e,n){"use strict";n(2269)},4833:function(t,e,n){"use strict";n(2270)},4834:function(t,e,n){"use strict";n(2271)},4835:function(t,e,n){"use strict";n(2272)},4938:function(t,e,n){"use strict";n(2374)},4985:function(t,e,n){"use strict";n(2422)},4986:function(t,e,n){"use strict";n(2423)},4987:function(t,e,n){"use strict";n(2424)},4989:function(t,e,n){"use strict";n(2426)},4990:function(t,e,n){"use strict";n(2427)},4991:function(t,e,n){"use strict";n(2428)},4992:function(t,e,n){"use strict";n(2429)},4993:function(t,e,n){"use strict";n(2430)},4994:function(t,e,n){"use strict";n(2431)},4995:function(t,e,n){"use strict";n(2432)},4998:function(t,e,n){"use strict";n(2435)},4999:function(t,e,n){"use strict";n(2436)},5e3:function(t,e,n){"use strict";n(2437)},5003:function(t,e,n){"use strict";n(2440)},5004:function(t,e,n){"use strict";n(2441)},5005:function(t,e,n){"use strict";n(2442)},5007:function(t,e,n){"use strict";n(2444)},5008:function(t,e,n){"use strict";n(2445)},5009:function(t,e,n){"use strict";n(2446)},5010:function(t,e,n){"use strict";n(2447)},5011:function(t,e,n){"use strict";n(2448)},5012:function(t,e,n){"use strict";n(2449)},5013:function(t,e,n){"use strict";n(2450)},5014:function(t,e,n){"use strict";n(2451)},5015:function(t,e,n){"use strict";n(2452)},5016:function(t,e,n){"use strict";n(2453)},5017:function(t,e,n){"use strict";n(2454)},5018:function(t,e,n){"use strict";n(2455)},5019:function(t,e,n){"use strict";n(2456)},5020:function(t,e,n){"use strict";n(2457)},5123:function(t,e,n){"use strict";n(2555)},5125:function(t,e,n){"use strict";n(2557)},5129:function(t,e,n){"use strict";n(2561)},5130:function(t,e,n){"use strict";n(2562)},5135:function(t,e,n){"use strict";n(2567)},5136:function(t,e,n){"use strict";n(2568)},5138:function(t,e,n){"use strict";n(2570)},5140:function(t,e,n){"use strict";n(2572)},5141:function(t,e,n){"use strict";n(2573)},5142:function(t,e,n){"use strict";n(2574)},5143:function(t,e,n){"use strict";n(2575)},5144:function(t,e,n){"use strict";n(2576)},5145:function(t,e,n){"use strict";n(2577)},5146:function(t,e,n){"use strict";n(2578)},5147:function(t,e,n){"use strict";n(2579)},5148:function(t,e,n){"use strict";n(2580)},5149:function(t,e,n){"use strict";n(2581)},5150:function(t,e,n){"use strict";n(2582)},5151:function(t,e,n){"use strict";n(2583)},5152:function(t,e,n){"use strict";n(2584)},5153:function(t,e,n){"use strict";n(2585)},5155:function(t,e,n){"use strict";n(2587)},5156:function(t,e,n){"use strict";n(2588)},5157:function(t,e,n){"use strict";n(2589)},5158:function(t,e,n){"use strict";n(2590)},5159:function(t,e,n){"use strict";n(2591)},5160:function(t,e,n){"use strict";n(2592)},5161:function(t,e,n){"use strict";n(2593)},5162:function(t,e,n){"use strict";n(2594)},5163:function(t,e,n){"use strict";n(2595)},5165:function(t,e,n){"use strict";n(2596)},5166:function(t,e,n){"use strict";n(2597)},5167:function(t,e,n){"use strict";n(2598)},5168:function(t,e,n){"use strict";n(2599)},5169:function(t,e,n){"use strict";n(2600)},5170:function(t,e,n){"use strict";n(2602)},5171:function(t,e,n){"use strict";n(2603)},5172:function(t,e,n){"use strict";n(2604)},5173:function(t,e,n){"use strict";n(2605)},5174:function(t,e,n){"use strict";n(2606)},5175:function(t,e,n){"use strict";n(2607)},5176:function(t,e,n){"use strict";n(2608)},5177:function(t,e,n){"use strict";n(2609)},5178:function(t,e,n){"use strict";n(2610)},5179:function(t,e,n){"use strict";n(2611)},5180:function(t,e,n){"use strict";n(2612)},5181:function(t,e,n){"use strict";n(2613)},5182:function(t,e,n){"use strict";n(2614)},5183:function(t,e,n){"use strict";n(2615)},5184:function(t,e,n){"use strict";n(2616)},5185:function(t,e,n){"use strict";n(2617)},5186:function(t,e,n){"use strict";n(2618)},5187:function(t,e,n){"use strict";n(2619)},5254:function(t,e,n){"use strict";n(2683)},5255:function(t,e,n){"use strict";n(2684)},5256:function(t,e,n){"use strict";n(2685)},5257:function(t,e,n){"use strict";n(2686)},5258:function(t,e,n){"use strict";n(2687)},5259:function(t,e,n){"use strict";n(2688)},5260:function(t,e,n){"use strict";n(2689)},5261:function(t,e,n){"use strict";n(2690)},5262:function(t,e,n){"use strict";n(2691)},5263:function(t,e,n){"use strict";n(2692)},5264:function(t,e,n){"use strict";n(2693)},5265:function(t,e,n){"use strict";n(2694)},5266:function(t,e,n){"use strict";n(2695)},5267:function(t,e,n){"use strict";n(2696)},5268:function(t,e,n){"use strict";n(2697)},5269:function(t,e,n){"use strict";n(2698)},5270:function(t,e,n){"use strict";n(2699)},5271:function(t,e,n){"use strict";n(2700)},5272:function(t,e,n){"use strict";n(2701)},5273:function(t,e,n){"use strict";n(2702)},5274:function(t,e,n){"use strict";n(2703)},5275:function(t,e,n){"use strict";n(2704)},5276:function(t,e,n){"use strict";n(2705)},5277:function(t,e,n){"use strict";n(2706)},5278:function(t,e,n){"use strict";n(2707)},5279:function(t,e,n){"use strict";n(2708)},5280:function(t,e,n){"use strict";n(2709)},5281:function(t,e,n){"use strict";n(2710)},5282:function(t,e,n){"use strict";n(2711)},5283:function(t,e,n){"use strict";n(2712)},5284:function(t,e,n){"use strict";n(2713)},5285:function(t,e,n){"use strict";n(2714)},5286:function(t,e,n){"use strict";n(2715)},5287:function(t,e,n){"use strict";n(2716)},5288:function(t,e,n){"use strict";n(2717)},5289:function(t,e,n){"use strict";n(2718)},5290:function(t,e,n){"use strict";n(2719)},5291:function(t,e,n){"use strict";n(2720)},5292:function(t,e,n){"use strict";n(2721)},5293:function(t,e,n){"use strict";n(2722)},5294:function(t,e,n){"use strict";n(2723)},5295:function(t,e,n){"use strict";n(2724)},5296:function(t,e,n){"use strict";n(2725)},5297:function(t,e,n){"use strict";n(2726)},5298:function(t,e,n){"use strict";n(2727)},5299:function(t,e,n){"use strict";n(2728)},5301:function(t,e,n){"use strict";n(2729)},5302:function(t,e,n){"use strict";n(2730)},5303:function(t,e,n){"use strict";n(2731)},5304:function(t,e,n){"use strict";n(2732)},5305:function(t,e,n){"use strict";n(2733)},5306:function(t,e,n){"use strict";n(2734)},5307:function(t,e,n){"use strict";n(2735)},5308:function(t,e,n){"use strict";n(2736)},5311:function(t,e,n){"use strict";n(2738)},5312:function(t,e,n){"use strict";n(2739)},5313:function(t,e,n){"use strict";n(2740)},5314:function(t,e,n){"use strict";n(2741)},5315:function(t,e,n){"use strict";n(2742)},5316:function(t,e,n){"use strict";n(2743)},5317:function(t,e,n){"use strict";n(2744)},5318:function(t,e,n){"use strict";n(2745)},5321:function(t,e,n){"use strict";n(2747)},5322:function(t,e,n){"use strict";n(2748)},5323:function(t,e,n){"use strict";n(2749)},5324:function(t,e,n){"use strict";n(2750)},5325:function(t,e,n){"use strict";n(2751)},5326:function(t,e,n){"use strict";n(2752)},5327:function(t,e,n){"use strict";n(2753)},5328:function(t,e,n){"use strict";n(2754)},5329:function(t,e,n){"use strict";n(2755)},5331:function(t,e,n){"use strict";n(2756)},5332:function(t,e,n){"use strict";n(2757)},5333:function(t,e,n){"use strict";n(2758)},5334:function(t,e,n){"use strict";n(2759)},5335:function(t,e,n){"use strict";n(2760)},5336:function(t,e,n){"use strict";n(2761)},5337:function(t,e,n){"use strict";n(2762)},5338:function(t,e,n){"use strict";n(2763)},5341:function(t,e,n){"use strict";n(2764)},5342:function(t,e,n){"use strict";n(2765)},5343:function(t,e,n){"use strict";n(2766)},5344:function(t,e,n){"use strict";n(2767)},5345:function(t,e,n){"use strict";n(2768)},5346:function(t,e,n){"use strict";n(2769)},5347:function(t,e,n){"use strict";n(2770)},5348:function(t,e,n){"use strict";n(2771)},5349:function(t,e,n){"use strict";n(2772)},5350:function(t,e,n){"use strict";n(2773)},5351:function(t,e,n){"use strict";n(2774)},5352:function(t,e,n){"use strict";n(2775)},5353:function(t,e,n){"use strict";n(2776)},5354:function(t,e,n){"use strict";n(2777)},5355:function(t,e,n){"use strict";n(2778)},5357:function(t,e,n){"use strict";n(2779)},5358:function(t,e,n){"use strict";n(2780)},5395:function(t,e,n){"use strict";n(2817)},5396:function(t,e,n){"use strict";n(2818)},5397:function(t,e,n){"use strict";n(2819)},5398:function(t,e,n){"use strict";n(2820)},5401:function(t,e,n){"use strict";n(2821)},5402:function(t,e,n){"use strict";n(2822)},5403:function(t,e,n){"use strict";n(2823)},5409:function(t,e,n){"use strict";n(2829)},5495:function(t,e,n){"use strict";n(2912)},5543:function(t,e,n){"use strict";n(2960)},5544:function(t,e,n){"use strict";n(2961)},5553:function(t,e,n){"use strict";n(2969)},5561:function(t,e,n){"use strict";n(2977)},5562:function(t,e,n){"use strict";n(2978)},5563:function(t,e,n){"use strict";n(2979)},5566:function(t,e,n){"use strict";n(2982)},5586:function(t,e,n){"use strict";n(3002)},5595:function(t,e,n){"use strict";n(3011)},5623:function(t,e,n){"use strict";n(3039)},5665:function(t,e,n){"use strict";n(3082)},5666:function(t,e,n){"use strict";n(3083)},5667:function(t,e,n){"use strict";n(3084)},5668:function(t,e,n){"use strict";n(3085)},5669:function(t,e,n){"use strict";n(3086)},5670:function(t,e,n){"use strict";n(3087)},5671:function(t,e,n){"use strict";n(3088)},5672:function(t,e,n){"use strict";n(3089)},5673:function(t,e,n){"use strict";n(3090)},5674:function(t,e,n){"use strict";n(3091)},5675:function(t,e,n){"use strict";n(3092)},5676:function(t,e,n){"use strict";n(3093)},5718:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13);var o=n(14),r=n(30),c=n(3),l=n(2),d=(n(20),n(19),n(6),n(32),n(50),n(16),n(22),n(31),n(49),n(18),n(24),n(8),n(4),n(28),n(43),n(21),n(40),n(140),n(525),n(44),n(90),n(7),n(41),n(26),n(213)),h=n(1),v=n(29),f=n(316),m={name:"importImageModal",inject:["top"],data:function(){return{visible:!1,linkInput:"",uploading:!1}},mounted:function(){},methods:{openModal:function(){this.resetData(),this.visible=!0,document.removeEventListener("keydown",this.top.handleKeydown)},handleClose:function(){this.resetData(),document.addEventListener("keydown",this.top.handleKeydown),this.visible=!1},handleConfirm:function(){},resetData:function(){this.linkInput="",this.uploading=!1},handleLinkUpload:function(){var t=this;if(!this.linkInput||!this.linkInput.includes("explore/detail/"))return this.$message.warning(this.$t("workLinkError"));this.uploading=!0;var e=this.linkInput.split("explore/detail/")[1];Object(f.b)({id:e}).then((function(e){var n;e.data.meta.lora_models=(null===(n=e.data.models)||void 0===n?void 0:n.filter((function(t){return"LORA"===t.type})))||[];var o={art_model_no:e.data.model_id,meta:e.data.meta,width:e.data.width,height:e.data.height};t.$emit("imageChange",{url:e.data.banner.url,params:o}),t.handleClose()})).catch((function(e){return t.$message.warning(t.$t("workLinkError"))})).finally((function(){t.uploading=!1}))}}},_=(n(5254),n(0)),y=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],attrs:{title:t.$t("importWork"),visible:t.visible,width:"441px","custom-class":"c-import-image-modal custom-modal","append-to-body":"","before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"import-image-modal-describe"},[t._v(t._s(t.$t("importLink")))]),t._v(" "),e("div",{staticClass:"import-image-modal-input"},[e("el-input",{attrs:{placeholder:"https://seaart.com..."},model:{value:t.linkInput,callback:function(e){t.linkInput=e},expression:"linkInput"}})],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",on:{click:t.handleClose}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"confirm-btn",attrs:{type:"primary"},on:{click:t.handleLinkUpload}},[t._v(t._s(t.$t("Confirm")))])],1)])}),[],!1,null,null,null).exports,w=n(51),C=n(61),k={inject:["top"],components:{importImageModal:y},props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{UPLOAD:null}},watch:{"top.paintingBoardData.liveModel.show":{handler:function(t){var e=t?34:33;this.UPLOAD=new w.a({type:e})},immediate:!0}},mounted:function(){this.top.eventFn.uploadImg=this.uploadImg},methods:{uploadImg:function(t){var e=this,n=new FileReader,o=this.top.paintingBoardData.liveModel.show;this.top.processStep={step:"start",process:0,text:"uploading"},n.readAsDataURL(t.file),n.onload=Object(c.a)(regeneratorRuntime.mark((function r(){var c,l,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c="",l="",r.prev=2,r.next=5,e.top.addLayerItem({type:o?"liveImgLayer":"imgLayer",loading:!0,imgSrc:n.result});case 5:if(l=r.sent,!((d=t.file).size/1024/1024>5)){r.next=18;break}return r.prev=8,r.next=11,Object(C.a)(d,5242880);case 11:d=r.sent,r.next=18;break;case 14:return r.prev=14,r.t0=r.catch(8),console.error("Compression failed:",r.t0),r.abrupt("return",!1);case 18:return r.next=20,e.UPLOAD.startUpload(d);case 20:c=r.sent,e.top.setLayerImg(l,c),e.top.processStep.step="end",r.next=31;break;case 25:r.prev=25,r.t1=r.catch(2),e.delLayer(l),e.top.changeLoadingStatus(!1),console.error("error:",r.t1),e.top.processStep.step="end";case 31:if(c){r.next=34;break}return e.top.changeLoadingStatus(!1),r.abrupt("return");case 34:e.top.eventFn.setBoardYesDage(),e.top.eventFn.setViewYesDage(!1),e.$emit("onClick",{type:"selectEments"}),e.top.changeLoadingStatus(!1),e.$logEvent("log_actions",{operation:"click_importArimg_page_operation",behavior_info:"on_canvas_detail_page"});case 39:case"end":return r.stop()}}),r,null,[[2,25],[8,14]])}))),n.onerror=function(t){console.error("文件读取失败:",t.target.error),e.top.changeLoadingStatus(!1)}},delLayer:function(t){var e=this.top.paintingBoardData,n=e.elementList,o=e.liveLayerList,r=n.filter((function(e){return e.layerId!=t})),c=o.filter((function(e){return e.layerId!=t}));this.top.changeData("elementList",r),this.top.changeData("liveLayerList",c)},handleOpenImportModal:function(){this.$refs.importImageModal.openModal()},handleAddImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},param={type:this.top.paintingBoardData.liveModel.show?"liveImgLayer":"imgLayer",imgSrc:t.url||"",params:t.params};this.top.addLayerItem(param),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1),this.$emit("onClick",{type:"selectEments"}),this.$logEvent("log_actions",{operation:"click_linkArimg_page_operation",behavior_info:"on_canvas_detail_page"})}}},O=k,x=(n(5255),n(5256),Object(_.a)(O,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-item",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("el-popover",{attrs:{trigger:"click",disabled:t.isDisable}},[e("div",{staticClass:"top-select-list"},[e("div",{staticClass:"item flex_m"},[e("el-upload",{attrs:{accept:".jpeg, .png, .jpg, .bmp, .webp",action:"*","http-request":t.uploadImg,"show-file-list":!1}},[e("div",{staticClass:"upitem flex_m"},[e("i",{staticClass:"iconfont icon-icon_bendi"}),t._v(" "),e("p",[t._v(t._s(t.$t("canvas_import_tips")))])])])],1),t._v(" "),e("div",{staticClass:"item flex_m",on:{click:t.handleOpenImportModal}},[e("i",{staticClass:"iconfont icon-a-copylink"}),t._v(" "),e("p",[t._v(t._s(t.$t("canvas_SeaArt_tips")))])])]),t._v(" "),e("el-tooltip",{attrs:{slot:"reference",effect:"dark",content:t.$t("ImportImage"),placement:"bottom"},slot:"reference"},[e("div",{staticClass:"icon-box flex_c_m"},[e("i",{staticClass:"iconfont icon-icon_daoru"})])])],1),t._v(" "),e("import-image-modal",{ref:"importImageModal",on:{imageChange:t.handleAddImage}})],1)}),[],!1,null,"4fe232e2",null).exports);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={props:{placement:{type:String,default:"bottom"},content:{type:String,default:""},shortcutKey:{type:String,default:""},videoUrl:{type:String,default:""}},computed:S(S({},Object(h.c)("user",["cdnHostFun"])),{},{initVideoUrl:function(){if(this.videoUrl)return"https://".concat(this.cdnHostFun(),"/").concat(this.videoUrl)}})},L=(n(5257),n(5258),Object(_.a)(D,(function(){var t=this,e=t._self._c;return e("el-tooltip",{attrs:{effect:"dark",placement:t.placement,"open-delay":500}},[t._t("default"),t._v(" "),e("div",{staticClass:"tooltip-video",attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"tooltip-video-title"},[e("span",[t._v(t._s(t.$t(t.content)))]),t._v(" "),t.shortcutKey?e("span",{staticClass:"shortcut-key"},[t._v(t._s(t.shortcutKey))]):t._e()]),t._v(" "),t.videoUrl?e("video",{staticClass:"tooltip-video-item",attrs:{src:t.initVideoUrl,autoplay:"",loop:"",preload:"",muted:""},domProps:{muted:!0}}):t._e()])],2)}),[],!1,null,"0f4881b0",null).exports),P=n(55),j={components:{TopToolTips:L},inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{}},methods:{actBoard:function(){this.isDisable||(this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1),P.a.emit("setLiveMoveable",{draggable:!0}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.$emit("onClick",{type:"selectEments"}))}}},$=(n(5259),Object(_.a)(j,(function(){var t=this,e=t._self._c;return e("TopToolTips",{attrs:{content:"MoveSelect",shortcutKey:"V"}},[e("div",{staticClass:"action-item",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("div",{staticClass:"icon-box flex_c_m",attrs:{id:"event_selectEments"},on:{click:t.actBoard}},[e("i",{staticClass:"iconfont icon-a-icon_xuanzeStroke"})])])])}),[],!1,null,"35f0593b",null).exports),T={components:{TopToolTips:L},inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{}},methods:{setDragBoard:function(){this.isDisable||(this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!0),this.top.initLiveLayerActive(),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!0}),this.$emit("onClick",{type:"handBoardel"}))}}},M=(n(5260),Object(_.a)(T,(function(){var t=this,e=t._self._c;return e("TopToolTips",{attrs:{content:"HandTool",shortcutKey:"Space"}},[e("div",{staticClass:"action-item",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("div",{staticClass:"icon-box flex_c_m",attrs:{id:"event_handBoardel"},on:{click:t.setDragBoard}},[e("i",{staticClass:"iconfont icon-zhuashou-copy"})])])])}),[],!1,null,"685d9298",null).exports),R={components:{TopToolTips:L},inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{}},methods:{addImgAibox:function(){this.top.paintingBoardData.liveModel.show?this.$message.warning(this.$t("liveAiimgTips")):(this.initGanerateInfo(),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1),this.$emit("onClick",{type:"updateArimg"}))},initGanerateInfo:function(){var t=this.top.paintingBoardData.generateInfo;t.loading=!1,t.process=0}}},A=(n(5261),Object(_.a)(R,(function(){var t=this,e=t._self._c;return e("TopToolTips",{attrs:{content:"GenerateImage",shortcutKey:"G",videoUrl:"20240226/4a637f41-14d1-4755-b18c-d0d1710690db.mov"}},[e("div",{staticClass:"action-item",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("div",{staticClass:"icon-box flex_c_m",class:t.top.paintingBoardData.liveModel.show&&"disable-dom",attrs:{id:"event_updateArimg"},on:{click:t.addImgAibox}},[e("i",{staticClass:"iconfont icon-icon_shengtu"})])])])}),[],!1,null,"0e96447e",null).exports),E=(n(2659),n(47),n(1151)),B={inject:["top"],props:{type:{type:String,default:""},toolName:{type:String,default:"brushTool"},item:{type:Object,default:function(){return{}}},showColor:{type:Boolean,default:!0}},components:{ElColorPicker:n.n(E).a},data:function(){return{hasAct:"brush",sliderval:20,colorList:[{color:"#000000"},{color:"#E05634"},{color:"#FDA836"},{color:"#F7CF51"},{color:"#50AB64"},{color:"#4497F7"},{color:"#8D4BF6"},{color:"#FFFFFF"}],colorVal:"#409EFF",colorIndex:0}},mounted:function(){var t,e=this.top.paintingBoardData.topNav.tools[this.toolName],n=e&&(null===(t=e[this.type])||void 0===t?void 0:t.wide)||20;this.sliderval=n},computed:{isLiveMode:function(){return this.top.paintingBoardData.liveModel.show}},methods:{changVal:function(t){var e=isNaN(Number(t));this.sliderval=e?20:Number(t)>20?Number(t):20;var n="topNav.tools.".concat(this.toolName,".").concat(this.type,".wide");this.top.changeData(n,t)},changType:function(t){this.hasAct=t,"daubTool"===this.toolName&&this.isLiveMode&&"segment"===t&&(this.hasAct="brush"),"eraserTool"===this.toolName&&this.isLiveMode&&"eraser"===t&&(this.hasAct="brush");var e="topNav.tools.".concat(this.toolName,".").concat(this.type,".hasAct");this.top.changeData(e,this.hasAct),this.$emit("onChange",{type:t,toolName:this.type})},changeColor:function(t){var e="topNav.tools.".concat(this.toolName,".").concat(this.type,".color");this.top.changeData(e,t)},colorMark:function(){}}},N=(n(5262),n(5263),Object(_.a)(B,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"color-max-box"},[e("div",{staticClass:"top-item flex_c_m"},[e("div",{staticClass:"left flex"},["daubTool"===t.toolName?e("div",{staticClass:"item flex_c_m",class:"segment"===t.item.hasAct&&"act-item-top",on:{click:function(e){return t.changType("segment")}}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("canvas_auto_hover"),placement:"bottom"}},[e("i",{staticClass:"iconfont icon-jianyiban",class:t.isLiveMode&&"disable-dom"})])],1):t._e(),t._v(" "),e("div",{staticClass:"item flex_c_m",class:"brush"===t.item.hasAct&&"act-item-top",on:{click:function(e){return t.changType("brush")}}},[["brushTool","eraserTool","daubTool"].includes(t.toolName)?e("el-tooltip",{attrs:{effect:"dark",content:"eraserTool"===t.toolName?t.$t("canvas_manualerase_hover"):t.$t("canvas_draw_hover"),placement:"bottom"}},[e("i",{staticClass:"iconfont icon-Brushhuabi"})]):t._e()],1),t._v(" "),e("div",{staticClass:"item flex_c_m",class:"eraser"===t.item.hasAct&&"act-item-top",on:{click:function(e){return t.changType("eraser")}}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("canvas_erase_hover"),placement:"bottom"}},[["brushTool","daubTool"].includes(t.toolName)?e("i",{staticClass:"iconfont icon-a-xiangpicachuxiangpica"}):t._e()]),t._v(" "),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("canvas_auto_hover"),placement:"bottom"}},["eraserTool"===t.toolName?e("i",{staticClass:"iconfont icon-jianyiban",class:t.isLiveMode&&"disable-dom"}):t._e()])],1)]),t._v(" "),e("div",{staticClass:"right flex_m"},[t._m(0),t._v(" "),e("div",{staticClass:"slider-item"},[e("el-slider",{attrs:{min:20,max:256},on:{change:t.changVal},model:{value:t.sliderval,callback:function(e){t.sliderval=e},expression:"sliderval"}})],1),t._v(" "),e("div",{staticClass:"slider-input flex_c_m"},[e("el-input",{staticClass:"item",on:{input:t.changVal},model:{value:t.sliderval,callback:function(e){t.sliderval=e},expression:"sliderval"}})],1)])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showColor,expression:"showColor"}],staticClass:"color-box flex_m"},[e("div",{staticClass:"left flex"},t._l(t.colorList,(function(n){return e("div",{key:n.color,staticClass:"item",class:t.item.color===n.color&&"act-item-top",style:{background:n.color},on:{click:function(e){return t.changeColor(n.color)}}})})),0),t._v(" "),e("div",{staticClass:"right flex"},[e("el-color-picker",{staticClass:"color-picker",attrs:{size:"mini"},on:{change:t.changeColor},model:{value:t.colorVal,callback:function(e){t.colorVal=e},expression:"colorVal"}})],1)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"icon-huak flex_c_m"},[t("i",{staticClass:"iconfont icon-SVG1",attrs:{role:""}})])}],!1,null,"a4e3487a",null).exports),F={inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{visible:!1,brushType:"brushBoard",actItem:{}}},watch:{isAct:function(t){if(t){var e=this.top.paintingBoardData.topNav.tools.hasAct;this.brushType=e,this.actItem=this.top.paintingBoardData.topNav.tools.brushTool[e]}}},components:{ColorBoard:N,TopToolTips:L},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},hasAct:function(){var t=this.top.paintingBoardData.topNav.tools.hasAct;return"brushBoard"===t||"brushImg"===t}},methods:{imgBrush:function(t){this.visible=!1,this.brushType=t;var e=this.top.paintingBoardData.topNav.tools.brushTool.brushImg;this.actItem=e,this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),this.$emit("onClick",{type:"brushImg"})},imgBoard:function(t){this.visible=!1,this.brushType=t;var e=this.top.paintingBoardData.topNav.tools.brushTool.brushBoard;this.actItem=e,this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),this.$emit("onClick",{type:"brushBoard"})},changeTool:function(t){var e=t.type,n=t.toolName;"eraser"===e&&"brushBoard"===n&&(P.a.emit("openEasyEraser"),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1}))},handBrush:function(){if(!this.isDisable){this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1);this.top.changeData("topNav.tools.brushTool.brushBoard.hasAct","brush"),this.$emit("onClick",{type:this.brushType})}}}},U=(n(5264),n(5265),Object(_.a)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-item flex_c_m",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("i",{staticClass:"iconfont",class:"brushBoard"===t.brushType?"icon-icon_huabi":"icon-icon_gangbi",on:{click:t.handBrush}}),t._v(" "),e("el-popover",{attrs:{width:"196",trigger:"click",disabled:t.isDisable},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("div",{staticClass:"top-select-list"},[e("TopToolTips",{attrs:{placement:"right-end",content:"canvas_simple_pencil",shortcutKey:"P",videoUrl:"20240305/4c130217-6467-4ff5-b772-fb30d86d65be.mov"}},[e("div",{staticClass:"item flex_m",attrs:{id:"event_brushBoard"},on:{click:function(e){return t.imgBoard("brushBoard")}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:"brushBoard"===t.brushType,expression:"brushType === 'brushBoard'"}],staticClass:"iconfont icon-gou"}),t._v(" "),e("i",{staticClass:"iconfont icon-icon_huabi"}),t._v(" "),e("p",{staticClass:"flex_m"},[e("span",[t._v(t._s(t.$t("canvas_simple_pencil")))]),t._v(" "),e("span",{staticClass:"shortcut-key"},[t._v("P")])])])]),t._v(" "),e("TopToolTips",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{placement:"right-end",content:"canvas_draw_edit",shortcutKey:"".concat(t.top.isMacOs," + P"),videoUrl:"20240305/e06f2cb4-3178-4746-8b97-e1957ef8293c.mov"}},[e("div",{staticClass:"item flex_m",attrs:{id:"event_brushImg"},on:{click:function(e){return t.imgBrush("brushImg")}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:"brushImg"===t.brushType,expression:"brushType === 'brushImg'"}],staticClass:"iconfont icon-gou"}),t._v(" "),e("i",{staticClass:"iconfont icon-icon_gangbi"}),t._v(" "),e("p",{staticClass:"flex_m"},[e("span",[t._v(t._s(t.$t("canvas_draw_edit")))]),t._v(" "),e("span",{staticClass:"shortcut-key"},[t._v(t._s("".concat(t.top.isMacOs," + P"))+" ")])])])])],1),t._v(" "),e("div",{staticClass:"arrow-box flex_c_m",class:t.visible&&"icon-arrow_act",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"el-icon-arrow-down"})])]),t._v(" "),!t.visible&&t.hasAct?e("div",{staticClass:"brush-style-box"},[e("color-board",{attrs:{type:t.brushType,item:t.actItem,toolName:"brushTool"},on:{onChange:t.changeTool}})],1):t._e()],1)}),[],!1,null,"3637281a",null).exports),H={inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{visible:!1,brushType:"eraserBoard",actItem:{}}},watch:{isAct:function(t){if(t){var e=this.top.paintingBoardData.topNav.tools.hasAct;this.brushType=e,this.actItem=this.top.paintingBoardData.topNav.tools.eraserTool[e]}}},components:{ColorBoard:N,TopToolTips:L},computed:{hasAct:function(){var t=this.top.paintingBoardData.topNav.tools.hasAct;return"eraserBoard"===t||"eraserAiBoard"===t}},methods:{imgBrush:function(t){if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});this.visible=!1,this.brushType=t;var e=this.top.paintingBoardData.topNav.tools.eraserTool.eraserAiBoard;this.actItem=e,this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),this.top.changeData("topNav.tools.eraserTool.eraserBoard.hasAct","brush"),this.$emit("onClick",{type:"eraserAiBoard"}),this.$logEvent("log_actions",{operation:"click_smart_deletion",behavior_info:"on_canvas"}),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1})},imgBoard:function(t){this.visible=!1,this.brushType=t;var e=this.top.paintingBoardData.topNav.tools.eraserTool.eraserBoard;this.actItem=e,this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),this.top.changeData("topNav.tools.eraserTool.eraserAiBoard.hasAct","brush"),P.a.emit("openEasyEraser"),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.$emit("onClick",{type:"eraserBoard"})},changeTool:function(t){var e=t.type,n=t.toolName;"brush"===e&&"eraserBoard"===n&&(P.a.emit("openEasyEraser"),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1}))},handBrush:function(){this.isDisable||(this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),P.a.emit("openEasyEraser"),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.$emit("onClick",{type:this.brushType}))}}},V=(n(5266),n(5267),Object(_.a)(H,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-item flex_c_m"},[e("div",{staticClass:"action-item flex_c_m",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("i",{staticClass:"iconfont",class:"eraserBoard"===t.brushType?"icon-icon_zidongcachu":"icon-icon_zidongcachu1",on:{click:t.handBrush}})]),t._v(" "),e("el-popover",{attrs:{width:"196",trigger:"click"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("div",{staticClass:"top-select-list"},[e("TopToolTips",{attrs:{placement:"right-end",content:"easyEraser",shortcutKey:"E",videoUrl:"20240207/b4760699-c147-462c-bb69-92f0f97dfecf.mov"}},[e("div",{staticClass:"item flex_m",attrs:{id:"event_eraserBoard"},on:{click:function(e){return t.imgBoard("eraserBoard")}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:"eraserBoard"===t.brushType,expression:"brushType === 'eraserBoard'"}],staticClass:"iconfont icon-gou"}),t._v(" "),e("i",{staticClass:"iconfont icon-icon_zidongcachu"}),t._v(" "),e("p",{staticClass:"flex_m"},[e("span",[t._v(t._s(t.$t("easyEraser")))]),t._v(" "),e("span",{staticClass:"shortcut-key"},[t._v("E")])])])]),t._v(" "),e("TopToolTips",{attrs:{placement:"right-end",content:"aiEraser",shortcutKey:"".concat(t.top.isMacOs," + E"),videoUrl:"20240226/2ab1675f-a52f-498e-a03a-8ae903f71fb0.mov"}},[e("div",{staticClass:"item flex_m",attrs:{id:"event_eraserAiBoard"},on:{click:function(e){return t.imgBrush("eraserAiBoard")}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:"eraserAiBoard"===t.brushType,expression:"brushType === 'eraserAiBoard'"}],staticClass:"iconfont icon-gou"}),t._v(" "),e("i",{staticClass:"iconfont icon-icon_zidongcachu1"}),t._v(" "),e("p",{staticClass:"flex_m"},[e("span",[t._v(t._s(t.$t("aiEraser")))]),t._v(" "),e("span",{staticClass:"shortcut-key"},[t._v(t._s("".concat(t.top.isMacOs," + E"))+" ")])])])])],1),t._v(" "),e("div",{staticClass:"arrow-box flex_c_m",class:t.visible&&"icon-arrow_act",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"el-icon-arrow-down"})])]),t._v(" "),!t.visible&&t.hasAct?e("div",{staticClass:"brush-style-box"},[e("color-board",{attrs:{type:t.brushType,item:t.actItem,toolName:"eraserTool",showColor:!1},on:{onChange:t.changeTool}})],1):t._e()],1)}),[],!1,null,"fd864486",null).exports),z={inject:["top"],props:{isAct:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1}},data:function(){return{visible:!1,brushType:"redrawBoard",actItem:{}}},components:{ColorBoard:N,TopToolTips:L},computed:{hasAct:function(){return"daubBoard"===this.top.paintingBoardData.topNav.tools.hasAct}},methods:{addImgAibox:function(t){if(!this.isDisable){this.brushType=t;var e=this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard;this.actItem=e,this.top.eventFn.setBoardNoDage(),this.top.eventFn.setViewYesDage(!1),P.a.emit("setLiveMoveable",{draggable:!1}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.$emit("onClick",{type:"daubBoard"})}},onChangeType:function(t){"brush"===t.type&&P.a.emit("closeRedrawEraser"),"eraser"===t.type&&P.a.emit("openRedrawEraser")}}},W=(n(5268),Object(_.a)(z,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-item",class:[t.isAct&&"act-item",t.isDisable&&"disable-item"]},[e("TopToolTips",{attrs:{content:"PartialRedrawing",shortcutKey:"I",videoUrl:"20240206/041f5963-b551-4ddd-89e9-a0a03c1caa28.mov"}},[e("div",{staticClass:"icon-box flex_c_m",attrs:{id:"event_daubBoard"},on:{click:function(e){return t.addImgAibox("redrawBoard")}}},[e("i",{staticClass:"iconfont icon-icon_gangbi"})])]),t._v(" "),!t.visible&&t.hasAct?e("div",{staticClass:"brush-style-box"},[e("color-board",{attrs:{type:t.brushType,item:t.actItem,toolName:"daubTool",showColor:!1},on:{onChange:t.onChangeType}})],1):t._e()],1)}),[],!1,null,"462f2cd2",null).exports),G=n(622),Y=n(183),K={inject:["top"],data:function(){return{disableBtn:!1}},methods:{handleStepUndo:function(){var t=this;if(!this.disableBtn){var data=Y.a.cancel(),e=data.item.otherObj,n=void 0===e?{}:e;this.disableBtn=!0,this.top.paintingBoardData.liveLayerList=data.item.liveLayerList,this.top.paintingBoardData.liveModel=data.item.liveModel,this.top.initLiveLayerActive(),P.a.emit("hideLayerTopArea"),n.call&&n.call(),setTimeout((function(){P.a.emit("initBgCanvas")}),500),setTimeout((function(){t.disableBtn=!1}),1e3)}},handleStepRedo:function(){var t=this;if(!this.disableBtn){var data=Y.a.restore(),e=data.item.otherObj,n=void 0===e?{}:e;this.disableBtn=!0,this.top.paintingBoardData.liveLayerList=data.item.liveLayerList,this.top.paintingBoardData.liveModel=data.item.liveModel,this.top.initLiveLayerActive(),P.a.emit("hideLayerTopArea"),n.call&&n.call(),setTimeout((function(){P.a.emit("initBgCanvas")}),500),setTimeout((function(){t.disableBtn=!1}),1e3)}}}},J=(n(5269),Object(_.a)(K,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"reset-action flex"},[e("div",{staticClass:"item flex_c_m",class:t.disableBtn&&"disable-sta",attrs:{id:"handleStepUndoId"},on:{click:t.handleStepUndo}},[e("i",{staticClass:"iconfont icon-chehui1"})]),t._v(" "),e("div",{staticClass:"item flex_c_m",class:t.disableBtn&&"disable-sta",attrs:{id:"handleStepRedoId"},on:{click:t.handleStepRedo}},[e("i",{staticClass:"iconfont icon-SVG"})])])}),[],!1,null,"77b0a094",null).exports),X=n(360),Q=n(79),Z=n(35),tt=n.n(Z);function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nt={inject:["top"],data:function(){return{actTool:"",popovervisible:!1,currentStep:0,canvasSnapshot:[[]],modeType:"generate",modeList:[{label:this.$t("generateCanvas"),value:"generate"},{label:this.$t("realtimeCanvas"),value:"live"},{label:this.$t("designCanvas"),value:"poster"}]}},watch:{"top.paintingBoardData.topNav.tools.hasAct":{handler:function(t){this.actTool=t},immediate:!0},"top.paintingBoardData.liveModel.show":{handler:function(t){var e=t?"live":"generate";this.modeType=e},immediate:!0},eleAttrListener:function(t,e){if(this.top.normalUpdate)if(this.currentStep===this.canvasSnapshot.length-1){var n=tt()(t);this.canvasSnapshot.length>=25&&this.canvasSnapshot.shift(),this.canvasSnapshot.push(n),this.currentStep=this.canvasSnapshot.length-1}else{this.canvasSnapshot=this.canvasSnapshot.slice(0,this.currentStep+1);var o=tt()(t);this.canvasSnapshot.push(o),this.currentStep=this.canvasSnapshot.length-1}}},components:{ImportArimg:x,SelectEments:$,HandBoardel:M,UpdateArimg:A,BrushBoard:U,EraserBoard:V,DaubBoard:W,AddOrEditCanvas:G.a,UserPopover:X.a,StepAction:J},computed:it(it({},Object(h.e)("user",["userInfo"])),{},{isGenerateLoading:function(){var t,e,n="updateArimg"===(null==this||null===(t=this.top)||void 0===t||null===(t=t.paintingBoardData)||void 0===t||null===(t=t.topNav)||void 0===t||null===(t=t.tools)||void 0===t?void 0:t.hasAct),o=null==this||null===(e=this.top)||void 0===e||null===(e=e.paintingBoardData)||void 0===e||null===(e=e.generateInfo)||void 0===e?void 0:e.loading;return n&&o},getLabel:function(){var t=this;return function(e){return 1==e.type?t.$t("PrivateCanvas"):e.name}},eleAttrListener:function(){var t;return null===(t=this.top.paintingBoardData)||void 0===t?void 0:t.elementList.map((function(t){var e=t.layerId,n=t.imgSrc,o=t.width,r=t.height;return{layerId:e,imgSrc:n,renderWidth:t.renderWidth,renderHeight:t.renderHeight,width:o,height:r,x:t.x,y:t.y,z:t.z,zoom:t.zoom,rotate:t.rotate,show:t.show,lock:t.lock,cropping:t.cropping,freeDeformation:t.freeDeformation,flipHorizontal:t.flipHorizontal,flipVertical:t.flipVertical,opacity:t.opacity,hue:t.hue,saturation:t.saturation,brightness:t.brightness}}))},isLiveMode:function(){var t;return null==this||null===(t=this.top)||void 0===t||null===(t=t.paintingBoardData)||void 0===t||null===(t=t.liveModel)||void 0===t?void 0:t.show},showPublish:function(){var t,e=this.top.paintingBoardData.elementList,n=void 0===e?[]:e,o=null==this||null===(t=this.top)||void 0===t||null===(t=t.paintingBoardData)||void 0===t||null===(t=t.liveModel)||void 0===t?void 0:t.show,r=n.some((function(t){return t.active}));return o&&!r},handleBtnStyle:function(){var t=this.top.paintingBoardData.liveModel;return t.loading||!t.result}}),mounted:function(){this.actTool=this.top.paintingBoardData.topNav.tools.hasAct,this.canvasSnapshot[0]=tt()(this.top.paintingBoardData.elementList)},methods:{handleBack:function(){var t=this.top.fromPath;"Home"!==t&&"/"!==t&&t?this.$router.back():this.$router.push(this.localePath("/"))},getList:function(){this.$emit("getCanvasList")},selectedChange:function(t){if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});"add"!==t?this.$emit("changeCanvas",t):this.$refs.addOrEditCanvas.openDialog("add")},handleMoreOperation:function(t,e){var n=this;switch(t){case"edit":this.$refs.addOrEditCanvas.openDialog("edit",e);break;case"delete":this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){n.handleDeleteCanvas(e.id)}))}},handleDeleteCanvas:function(t){var e=this;Object(Q.l)({id:t}).then((function(){e.$message.success(e.$t("deleteSuccess")),e.top.currentCanvas==t?e.getList():e.$emit("frontendDelCanvas",t)}))},changeTool:function(t){var e=t.type;this.actTool=e;this.top.changeData("topNav.tools.hasAct",this.actTool),this.top.changeData("noMove",this.actTool),this.top.paintingBoardData.elementList.forEach((function(em,t){em.active=!1,em.hasDrawLine=!1,em.hasRedraw=!1})),"selectEments"!==e&&(document.querySelector("#layerBtnsId").style.left="0px",document.querySelector("#layerBtnsId").style.top="0px",this.top.initLayerActive(),this.top.initLiveLayerActive(),P.a.emit("hideLayerTopArea")),"eraserBoard"!==e&&P.a.emit("closeEasyEraser"),"daubBoard"!==e&&(this.top.changeData("liveModel.mask",""),this.top.changeData("liveModel.pmask","")),this.top.layerFooterRef.setPositionBox(),this.$logEvent("log_actions",{operation:"click_".concat(e,"_page_operation"),behavior_info:"on_canvas_detail_page"}),this.top.eventFn.controlNetDisable&&this.top.eventFn.controlNetDisable("daubBoard"===e)},changeModel:function(t){if(!this.top.token)return this.openLogin();var e=this.top.paintingBoardData.liveModel;e.show=!e.show,this.$logEvent("log_actions",{operation:"click_live_mode",behavior_info:"on_canvas",behavior_info_sub:e.show?"open":"close"}),e.show&&(this.top.initLayerActive(),e.active=!0),"updateArimg"===this.actTool&&e.show&&this.changeTool({type:"selectEments"}),t||(this.top.changeData("topNav.tools.hasAct","updateArimg"),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1))},handleStep:function(t){var e=this;if("undo"===t){if(!(this.currentStep>0))return;this.currentStep--}else{if(!(this.currentStep<this.canvasSnapshot.length-1))return;this.currentStep++}this.$logEvent("log_actions",{operation:"click_".concat(t),behavior_info:"on_canvas_detail_page"});var n=this.top.paintingBoardData.elementList,o=tt()(this.canvasSnapshot[this.currentStep]).map((function(t){var o=n.find((function(e){return e.layerId==t.layerId}));return it(o?it({},o):{name:e.$t("Layer"),type:"imgLayer",dragItem:{},conetent:"base64",params:{},cutUrl:"",prompt:"",mask:"",loading:!1,hasDrawLine:!1},t)}));this.top.changeData("elementList",o,"step"),this.top.initLayerActive(),this.$nextTick((function(){e.$EventBus.$emit("stepUpdate")}))},openLogin:function(){this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}})},submitPublish:function(){P.a.emit("hideLayerTopArea"),this.top.initLiveLayerActive(),this.top.eventFn.submitPublish()},toFeedback:function(){var map={zhCN:"https://aihelp.net/questionnaire/#/?formId=11a4d6a06c7c4fdd893e8e0e4d680d9b",zhTW:"https://aihelp.net/questionnaire/#/?formId=11a4d6a06c7c4fdd893e8e0e4d680d9b",en:"https://aihelp.net/questionnaire/#/?formId=6c101e48f801480eb2e97fd9d4fe5f0f",ja:"https://aihelp.net/questionnaire/#/?formId=09b048bd88484208bebfc1a820d4397c",pt:"https://aihelp.net/questionnaire/#/?formId=ed9956d92d614c36975c65a12aa4e6d8"},t=map[this.$i18n.locale]||map.en;window.open(t,"_blank")},changeModeType:function(t){if(!this.top.token)return this.openLogin();if(this.$logEvent("log_actions",{operation:"click_switch_type",behavior_info:"on_canvas_fuction_page",behavior_info_sub:t}),["live","generate"].includes(t)){var e="live"===t;this.top.changeData("liveModel.show",e);var n=this.top.paintingBoardData.liveModel;this.$logEvent("log_actions",{operation:"click_live_mode",behavior_info:"on_canvas",behavior_info_sub:n.show?"open":"close"}),n.show&&(this.top.initLayerActive(),n.active=!0),"updateArimg"===this.actTool&&n.show&&this.changeTool({type:"selectEments"}),"live"!==t&&(this.top.changeData("topNav.tools.hasAct","updateArimg"),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1))}if("poster"===t){var o=this.top.currentCanvas;this.$router.push({path:this.localePath("/posterBoard"),query:{id:o,live:"no"}})}},toTeach:function(){var t=this.$i18n.locale.includes("zh")?"https://kvrbeskjhpg.feishu.cn/docx/VqXBdza69olCYexouetcglKCn6e#part-XoyfdciaEoCUfTxzYQccI4Jinbb":"https://seaart.notion.site/Canvas-Guide-741024f4ee514bc799689504228df2f7";window.open(t,"_blank")}}},at=(n(5270),n(5271),Object(_.a)(nt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"topnav-box flex"},[e("div",{staticClass:"left flex"},[e("div",{staticClass:"back-icon flex_c_m",on:{click:t.handleBack}},[e("i",{staticClass:"iconfont icon-back"})]),t._v(" "),e("el-select",{staticClass:"custom-select-transparent my-el-select",attrs:{value:t.modeType,"popper-class":"painting-board-select select-canvas my-el-option"},on:{change:t.changeModeType}},t._l(t.modeList,(function(t){return e("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})})),1),t._v(" "),e("el-select",{staticClass:"custom-select-transparent",attrs:{value:t.top.currentCanvas,"popper-class":"painting-board-select select-canvas",placeholder:"","popper-append-to-body":!0},on:{change:t.selectedChange}},[e("el-option",{staticClass:"add-canvas-option",attrs:{value:"add"}},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",[t._v(t._s(t.$t("Canvas")))])]),t._v(" "),t._l(t.top.canvasList,(function(n){return e("el-option",{key:n.id,attrs:{label:t.getLabel(n),value:n.id}},[e("span",{staticClass:"label"},[t._v(t._s(t.getLabel(n)))]),t._v(" "),1!=n.type?e("el-dropdown",{staticClass:"more-btn",attrs:{trigger:"click"},on:{command:function(e){return t.handleMoreOperation(e,n)}}},[e("i",{staticClass:"el-icon-more more-icon",on:{click:function(t){t.stopPropagation()}}}),t._v(" "),e("el-dropdown-menu",{staticClass:"custom-dropdown-canvas",attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"edit"}},[t._v(t._s(t.$t("Edit")))]),t._v(" "),e("el-dropdown-item",{attrs:{command:"delete"}},[t._v(t._s(t.$t("Delete")))])],1)],1):t._e()],1)}))],2)],1),t._v(" "),e("div",{staticClass:"center flex_c_m"},[e("div",{staticClass:"options-list flex"},[e("import-arimg",{attrs:{isAct:"importArimg"===t.actTool,isDisable:t.isGenerateLoading},on:{onClick:t.changeTool}}),t._v(" "),e("select-ements",{attrs:{isAct:"selectEments"===t.actTool,isDisable:t.isGenerateLoading},on:{onClick:t.changeTool}}),t._v(" "),e("hand-boardel",{attrs:{isAct:"handBoardel"===t.actTool,isDisable:t.isGenerateLoading||t.isLiveMode},on:{onClick:t.changeTool}}),t._v(" "),e("update-arimg",{attrs:{isAct:"updateArimg"===t.actTool,isDisable:t.isLiveMode},on:{onClick:t.changeTool}}),t._v(" "),e("brush-board",{attrs:{isAct:"brushBoard"===t.actTool||"brushImg"===t.actTool,isDisable:t.isGenerateLoading},on:{onClick:t.changeTool}}),t._v(" "),e("eraser-board",{attrs:{isAct:"eraserBoard"===t.actTool||"eraserAiBoard"===t.actTool,isDisable:t.isGenerateLoading},on:{onClick:t.changeTool}}),t._v(" "),e("daub-board",{attrs:{isAct:"daubBoard"===t.actTool,isDisable:t.isGenerateLoading},on:{onClick:t.changeTool}})],1)]),t._v(" "),e("div",{staticClass:"right flex_m"},[t.isLiveMode?t._e():[e("div",{staticClass:"reset-action flex"},[e("div",{staticClass:"item flex_c_m",class:{forbidden:0===t.currentStep},on:{click:function(e){return t.handleStep("undo")}}},[e("i",{staticClass:"iconfont icon-chehui1"})]),t._v(" "),e("div",{staticClass:"item flex_c_m",class:{forbidden:t.currentStep===t.canvasSnapshot.length-1},on:{click:function(e){return t.handleStep("redo")}}},[e("i",{staticClass:"iconfont icon-SVG"})])])],t._v(" "),t.isLiveMode?[e("step-action")]:t._e(),t._v(" "),e("div",{staticClass:"feed-back flex_c_m",on:{click:t.toTeach}},[e("i",{staticClass:"iconfont icon-tagTips"}),t._v(" "),e("span",[t._v(t._s(t.$t("Guides")))])]),t._v(" "),e("div",{staticClass:"feed-back flex_c_m",on:{click:t.toFeedback}},[e("i",{staticClass:"iconfont icon-icon_wenjuan"}),t._v(" "),e("span",[t._v(t._s(t.$t("Feedback")))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showPublish,expression:"showPublish"}],staticClass:"publish-btn",class:{publish_disabled:t.handleBtnStyle},on:{click:t.submitPublish}},[e("i",{staticClass:"iconfont icon-share-icon"}),t._v(" "),e("span",[t._v(t._s(t.$t("releaseName")))])]),t._v(" "),t.top.token?e("UserPopover"):e("el-button",{staticClass:"login-btn",on:{click:t.openLogin}},[t._v("\n      "+t._s(t.$t("Login"))+"\n    ")])],2),t._v(" "),e("AddOrEditCanvas",{ref:"addOrEditCanvas",on:{updateList:t.getList}})],1)}),[],!1,null,"11a1dfc5",null).exports);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var ot={props:["value"],name:"ControlNetPopup",data:function(){return{visible:!1,module:2,modelInfo:null}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(h.c)("creation",["editBoardControlNetConfig"])),methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.resetData(),this.modelInfo=t||null,t&&(this.module=t.module),this.visible=!0},close:function(){this.visible=!1},changeModel:function(t){this.module=t;var e=null;this.modelInfo&&((e=JSON.parse(JSON.stringify(this.modelInfo))).module=t),this.$emit("inputChange",t,e),this.close()},resetData:function(){this.module=2,this.modelInfo=null}}},ct=ot,lt=(n(5272),n(5273),Object(_.a)(ct,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"controlnet-popup custom-dialog big-body-dialog",attrs:{visible:t.visible,"append-to-body":!0},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"controlnet-body"},[e("i",{staticClass:"el-icon-close",on:{click:t.close}}),t._v(" "),e("div",{staticClass:"controlnet-grid"},t._l(t.editBoardControlNetConfig,(function(n,i){return e("div",{key:"model_"+i,staticClass:"grid-item",class:{active:t.module===n.value},on:{click:function(e){return t.changeModel(n.value)}}},[e("div",{staticClass:"cover zoom-box",style:{"background-image":"url(".concat(null==n?void 0:n.cover,")")}},[e("span",{staticClass:"name"},[t._v(t._s(t.$t(n.name)))])]),t._v(" "),e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper controlnet",effect:"dark",content:t.$t(n.name+"_Tips"),placement:"top-start"}},[e("p",{staticClass:"tips-info ellipsis-text"},[t._v(t._s(t.$t(n.name+"_Tips")))])])],1)})),0)])])}),[],!1,null,"cc0538ca",null).exports),ut=n(25),ht=n(96);function vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ft={inject:["top"],props:["value"],components:{ControlNetPopup:lt,TopToolTips:L},data:function(){return{optionList:[],optionTemplate:{enable:!1,show:!1,module:"",id:0,weight:1,input_image:"",rawWidth:0,rawHeight:0,openPoseData:{people:[{pose_keypoints_2d:[]}]}},activeIndex:-1,defaultModule:2,isUploading:!1,accept:".jpg,.jpeg,.png,.webp",UPLOAD:new w.a({type:33}),imgUrl:"",hasDisable:!1}},computed:pt(pt({},Object(h.c)("creation",["editBoardControlNetConfig"])),{},{isDisableImageToImage:function(){var t,e=!this.isLiveMode,n=![3,"3"].includes(null==this||null===(t=this.top)||void 0===t?void 0:t.generateType),o="updateArimg"===this.top.paintingBoardData.topNav.tools.hasAct,r=this.getImageUrl;return e&&n&&o&&r},isLiveMode:function(){return this.top.paintingBoardData.liveModel.show},getControlNetMap:function(){var map={};return(this.editBoardControlNetConfig||[]).forEach((function(t){map[t.value]=t})),map},getModelCoverUrl:function(){var t=this;return function(e){var n;return t.getControlNetMap[e]?null===(n=t.getControlNetMap[e])||void 0===n?void 0:n.cover:""}},getModelDescribe:function(){var t=this;return function(e){var n,o=t.getControlNetMap[e]?null===(n=t.getControlNetMap[e])||void 0===n?void 0:n.name:"";return t.$t(o)}},getImageUrl:function(){var t;return(null===(t=this.top)||void 0===t||null===(t=t.paintingBoardData)||void 0===t||null===(t=t.imageToImage)||void 0===t?void 0:t.imgUrl)||""}}),mounted:function(){this.top.eventFn.controlNetDisable=this.controlNetDisable},methods:{handleDeleteImage:function(){this.imgUrl="",this.updateImageUrl("")},changeConfig:function(t,e){var n=JSON.parse(JSON.stringify(this.value)),o=n.activeIndex,r=n.controlnet_units;"activeIndex"!==e?r[(r||[]).findIndex((function(t){return t.id===o}))][e]=t:n.activeIndex=t;this.$emit("input",n)},showControlNetPopup:function(){this.$refs.controlNetPopup.openModal()},changeEnableStatus:function(t,e){var n=JSON.parse(JSON.stringify(this.value)),o=(this.value.controlnet_units||[]).findIndex((function(t){return t.id===e.id}));-1!==o&&(n.controlnet_units[o].enable=t),this.$emit("input",n)},changeActive:function(t){var e=t.id;this.value.activeIndex===t.id&&(e=""),this.changeConfig(e,"activeIndex"),this.top.hideOtherControlNet(t.id)},handleDelete:function(t){var e=JSON.parse(JSON.stringify(this.value)),n=(this.value.controlnet_units||[]).findIndex((function(e){return e.id===t.id}));if(-1!==n){var o=this.top.paintingBoardData.elementList.find((function(e){return(null==e?void 0:e.controlNetId)===t.id}));(null==o?void 0:o.layerId)&&this.top.deleteImageLayer(o.layerId),e.controlnet_units.splice(n,1),this.$emit("input",e)}},handleChangeOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultModule,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(JSON.stringify(this.value));if(e)(n.controlnet_units||[]).forEach((function(t){t.id===e.id&&(t.module=e.module)}));else{if(n.controlnet_units.length>=3)return;var o=JSON.parse(JSON.stringify(this.optionTemplate));o.module=t;var r=(n.controlnet_units||[]).map((function(t){return t.id}));o.id=this.generateNonConflictUniqueId(r),n.activeIndex=o.id,o.show=!1,o.enable=!0,n.controlnet_units.push(o)}this.$emit("input",n)},generateNonConflictUniqueId:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];do{t=Object(ut.uniqueId)("controlNetOption_")}while(e.includes(t));return t},handleBeforeUpload:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=["image/jpeg","image/png","image/jpg","image/webp"],!e.isUploading){n.next=3;break}return n.abrupt("return");case 3:if(o.includes(t.type)){n.next=6;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 6:if(!(r=t)||r.size){n.next=9;break}return n.abrupt("return",!1);case 9:if(!(r.size/1024/1024>5)){n.next=20;break}return n.prev=10,n.next=13,Object(C.a)(r,5242880);case 13:r=n.sent,n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(10),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 20:return n.next=22,e.checkImageSize(t);case 22:if(c=n.sent,e.imgUrl=c.url||"",!e.isUploading){n.next=26;break}return n.abrupt("return");case 26:return e.isUploading=!0,e.UPLOAD.startUpload(r,{category:33}).then((function(t){e.isUploading=!1,e.updateImageUrl(t,c.realWidth,c.realHeight)})).catch((function(t){e.isUploading=!1,e.imgUrl="",e.updateImageUrl("")})),n.abrupt("return",!1);case 30:case"end":return n.stop()}}),n,null,[[10,16]])})))()},updateImageUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.top.changeData("imageToImage.imgUrl",t)},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},controlNetDisable:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hasDisable=t}}},mt=ft,gt=(n(5274),Object(_.a)(mt,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"generate-panel",class:n.hasDisable&&"disable-panle"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isLiveMode,expression:"!isLiveMode"}],staticClass:"panel-item",class:[n.isDisableImageToImage&&"panel-item-disable"]},[o("div",{staticClass:"panel-item__title"},[n._v(n._s(n.$t("ImgToImg")))]),n._v(" "),o("div",{staticClass:"panel-item__subtitle"},[n._v("\n      "+n._s(n.$t("UploadOrSelectAsInspiration"))+"\n    ")]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.isUploading,expression:"isUploading"}],staticClass:"panel-item__upload-area"},[n.getImageUrl?n._e():o("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:n.isUploading,expression:"isUploading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":n.handleBeforeUpload,disabled:n.isUploading,accept:n.accept,"http-request":function(){},"show-file-list":!1}},[o("span",{staticClass:"el-icon-circle-plus-outline upload-area-box-icon",attrs:{slot:"trigger"},slot:"trigger"})]),n._v(" "),n.getImageUrl?o("img",{staticClass:"upload-area-result-image",class:[n.isDisableImageToImage&&"panel-item-disable-gray"],attrs:{src:n.getImageUrl,alt:""}}):n._e(),n._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:n.getImageUrl&&!n.isUploading,expression:"getImageUrl && !isUploading"}],staticClass:"image-operate-btn-box"},[n.getImageUrl&&!n.isUploading?o("span",{staticClass:"image-operate-btn el-icon-delete",on:{click:function(t){return t.stopPropagation(),n.handleDeleteImage()}}}):n._e()])],1)]),n._v(" "),o("div",{staticClass:"panel-item"},[o("div",{staticClass:"panel-item__title"},[n._v("\n      "+n._s(n.$t("ControlNet"))+"\n      "),o("top-tool-tips",{attrs:{content:"ControlNet",placement:"right",videoUrl:"20240322/9c9ea84b-c992-4ef4-9995-661182b2f896.mov"}},[o("i",{staticClass:"iconfont icon-help"})])],1),n._v(" "),o("div",{staticClass:"panel-item__subtitle"},[n._v("\n      "+n._s(n.$t("ControlGeneratedProperties"))+"\n    ")]),n._v(" "),o("div",{staticClass:"option-box"},[n._l((null===(t=n.value)||void 0===t?void 0:t.controlnet_units)||[],(function(t,e){return o("div",{key:t.id,staticClass:"option-box-item",class:n.value.activeIndex===t.id?"option-box-item-active":""},[o("div",{staticClass:"option-box-item-content",on:{click:function(e){return e.stopPropagation(),n.changeActive(t)}}},[o("div",{staticClass:"content-img-box"},[o("img",{attrs:{src:(null==t?void 0:t.input_image)||n.getModelCoverUrl(t.module),alt:""}})]),n._v(" "),o("span",{staticClass:"content-img-box-text"},[n._v(n._s(n.getModelDescribe(t.module)))])]),n._v(" "),o("span",{staticClass:"el-icon-delete",on:{click:function(e){return e.stopPropagation(),n.handleDelete(t)}}})])})),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:(null===(e=n.value)||void 0===e||null===(e=e.controlnet_units)||void 0===e?void 0:e.length)<3,expression:"value?.controlnet_units?.length < 3"}],staticClass:"option-box-item option-box-item-add",on:{click:n.showControlNetPopup}},[o("span",{staticClass:"el-icon-plus option-box-item-add-icon"}),n._v(" "),o("span",{staticClass:"option-box-item-add-text"},[n._v(n._s(n.$t("AddControl")))])])],2)]),n._v(" "),o("control-net-popup",{ref:"controlNetPopup",on:{inputChange:n.handleChangeOptions}})],1)}),[],!1,null,"94565d46",null).exports),_t=(n(151),n(10)),bt={name:"ReplaceTemplateDialog",inject:["top"],data:function(){return{isShowDialog:!1,templateId:null,isDrawSame:!1}},beforeDestroy:function(){clearTimeout()},methods:{openDialog:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.templateId=t,this.isShowDialog=!0,this.isDrawSame=e},handleRepelace:function(){this.top.getTplDetailHttp(this.templateId),this.isShowDialog=!1},handleSave:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isShowDialog=!1,t.top.changeLoadingStatus(!0),setTimeout((function(){Object(ht.a)({tagArea:{x:0,y:0,width:1920,height:800},hasDwon:!1,upload:!0}).then((function(e){t.savePublishBorad(1920,800,e)}))}),500);case 3:case"end":return e.stop()}}),e)})))()},savePublishBorad:function(t,e,n){var o=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c={name:Object(_t.O)((new Date).getTime()),category:"",intro:"",publish_type:3,type:3,cover:{width:t,height:e,uri:n},id:o.top.currentCanvas},r.next=3,Object(Q.F)(c);case 3:o.top.getTplDetailHttp(o.templateId),o.top.changeLoadingStatus(!1),o.isDrawSame&&o.top.changeLeftMenu("Template"),o.$emit("publishSuccess");case 7:case"end":return r.stop()}}),r)})))()},closed:function(){this.$route.query.remix_id&&this.top.clearRouterQuery()}}},yt=bt,wt=(n(5275),Object(_.a)(yt,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"add-or-edit-canvas custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",title:t.$t("Tip"),visible:t.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e},close:t.closed}},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("canvas_repelace_title")))]),t._v(" "),e("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleSave}},[t._v("\n      "+t._s(t.$t("canvas_save_repelace"))+"\n    ")]),t._v(" "),e("el-button",{on:{click:t.handleRepelace}},[t._v(t._s(t.$t("canvas_repelace")))])],1)])}),[],!1,null,"7862ddda",null).exports),Ct={props:{category:{type:Array,default:function(){return[]}},currentCategory:{type:String,default:"all"}},data:function(){return{categoryMoreName:"more"}},methods:{changeTag:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$emit("changeTag",t),this.categoryMoreName=n?null===(e=this.category.find((function(e){return e.value===t})))||void 0===e?void 0:e.label:"more"}}},kt=Ct,Ot=(n(5276),Object(_.a)(kt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"category"},[t._l(t.category.filter((function(t){return null==t?void 0:t.isMore})),(function(n){return e("div",{key:n.value,staticClass:"item-category flex-center",class:{active:t.currentCategory===n.value},on:{click:function(e){return t.changeTag(n.value,!1)}}},[t._v("\n    "+t._s(t.$t(n.label))+"\n  ")])})),t._v(" "),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.changeTag}},[e("div",{staticClass:"item-category flex-center",class:{active:"more"!=t.categoryMoreName}},[t._v("\n      "+t._s(t.$t("".concat(t.categoryMoreName)))+"\n    ")]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.category.filter((function(t){return!(null!=t&&t.isMore)})),(function(n){return e("el-dropdown-item",{key:n.value,attrs:{command:n.value}},[t._v("\n        "+t._s(t.$t(null==n?void 0:n.label))+"\n      ")])})),1)],1)],2)}),[],!1,null,"d507c6f4",null).exports);function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var It={components:{ReplaceTemplateDialog:wt,CategoryTags:Ot},inject:["top"],data:function(){return{typeList:[{label:"canvas_Official_Template",value:1},{label:"canvas_Personal_Template",value:2},{label:"canvas_Favorite_Template",value:4},{label:"canvas_Cache_Template",value:3}],currentType:"",templateList:[],currentTemplateId:null,categoryList:[],currentCategory:"all",paramsData:{ids:[],other_id:"",name:"",category:"",page:1,page_size:15,type:1,with_author:!1,with_palette:!1},isHaveMore:!1,loading:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(h.c)("user",["cdnHostFun"])),mounted:function(){this.top.isDrawSame&&(this.paramsData.type=3),this.getList(),this.getCategoryList()},methods:{handleCommand:function(t){this.paramsData.type=t,this.getList(),this.$logEvent("log_actions",{operation:"click_".concat(t,"_template"),behavior_info:"on_canvas_detail_page"})},chooseTml:function(t){if(1!==t.publish_type){if(!this.top.isChangeBoardData&&this.top.isAlreadyRepelaceTemplate||0===this.top.paintingBoardData.elementList.length)return this.top.getTplDetailHttp(t.id);this.$refs.replaceDialog.openDialog(t.id)}else{this.top.changeData("topNav.tools.hasAct","selectEments");var e=this.top.paintingBoardData.liveModel.show;this.top.addLayerItem({type:e?"liveImgLayer":"imgLayer",imgSrc:(null==t?void 0:t.cover)||""})}},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){try{Object(Q.m)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.templateList.splice(e,1)}))}catch(t){console.log(t)}})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},getList:function(){var t=arguments,e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],n.prev=1,e.top.token){n.next=4;break}return n.abrupt("return");case 4:return e.loading=!0,o||(e.paramsData.page=1),r=4===e.paramsData.type?Q.w:Q.D,n.next=9,r(e.paramsData);case 9:c=n.sent,l=c.data,d=l.has_more,h=l.items,v=void 0===h?[]:h,e.isHaveMore=d,e.templateList=o?e.templateList.concat(v):v;case 16:return n.prev=16,e.loading=!1,n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[1,,16,19]])})))()},getCategoryList:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Q.B)(t.paramsData);case 3:n=e.sent,o=n.data.Items,r=void 0===o?[]:o,t.categoryList=r.map((function(t,e){return{value:t,label:"canvas_".concat(t),isMore:e<5}})),t.categoryList.unshift({value:"all",label:"All",isMore:!0});case 8:return e.prev=8,t.loading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,,8,11]])})))()},changeTag:function(t){this.$logEvent("log_actions",{operation:"click_".concat(t,"_template"),behavior_info:"on_canvas_detail_page"}),this.currentCategory=t,this.paramsData.category="all"===t?"":t,this.paramsData.type=1,this.getList()},keywordsChange:function(t){!t.target.value&&(this.type="normal")},search:function(){this.getList()},clear:function(){this.paramsData.name="",this.paramsData.category="",this.templateList=[],this.getList()},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.templatePanel,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList(!0))}}}},St=It,Dt=(n(5277),Object(_.a)(St,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"templatePanel",staticClass:"template-panel",on:{scroll:t.isScrollBottom}},[e("div",{staticClass:"flex-center template-panel-search"},[e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[e("div",{staticClass:"icon-box flex-center"},[e("i",{staticClass:"icon-loudou iconfont"})]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.typeList,(function(n){return e("el-dropdown-item",{key:n.value,class:{"drop-active":n.value===t.paramsData.type},attrs:{command:n.value}},[t._v("\n          "+t._s(t.$t(null==n?void 0:n.label))+"\n        ")])})),1)],1),t._v(" "),e("div",{staticClass:"input-search"},[e("i",{staticClass:"iconfont icon-min-search",on:{click:t.search}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.paramsData.name,expression:"paramsData.name"}],attrs:{type:"text",placeholder:t.$t("minSearch")},domProps:{value:t.paramsData.name},on:{change:t.keywordsChange,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.paramsData,"name",e.target.value)}}}),t._v(" "),t.paramsData.name.length>0?e("i",{staticClass:"el-icon-close",on:{click:t.clear}}):t._e()])],1),t._v(" "),1===t.paramsData.type?e("CategoryTags",{attrs:{currentCategory:t.currentCategory,category:t.categoryList},on:{changeTag:t.changeTag}}):t._e(),t._v(" "),t.templateList.length>0?e("div",{staticClass:"template-panel-list"},t._l(t.templateList,(function(n,o){return e("div",{key:n.id,staticClass:"template-panel-list-item",on:{click:function(e){return t.chooseTml(n)}}},[e("div",{staticClass:"image flex-center"},[e("img",{attrs:{src:(null==n?void 0:n.cover)||"",alt:"image",align:"“center"}}),t._v(" "),[2,3].includes(t.paramsData.type)?e("div",{staticClass:"image-icon flex-center",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"iconfont icon-shanchu3"})]):t._e()]),t._v(" "),e("span",{staticClass:"template-panel-list-item-name"},[t._v("\n        "+t._s(n.name)+"\n      ")])])})),0):t._e(),t._v(" "),0!==t.templateList.length||t.loading?t._e():e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("NoSearchResultsTip")))])]),t._v(" "),e("ReplaceTemplateDialog",{ref:"replaceDialog",on:{publishSuccess:t.getList}})],1)}),[],!1,null,"67c440c4",null)),Lt=Dt.exports;function Pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $t={components:{CategoryTags:Ot},inject:["top"],data:function(){return{list:[],currentCategory:"all",category:[],categoryMoreName:"more",type:"normal",keywords:"",searchList:[],isHaveMore:!1,moreList:[],moreLoading:!1,paramsData:{page:1,page_size:50,category:"",type:1}}},mounted:function(){this.getList()},computed:jt(jt({},Object(h.c)("user",["cdnHostFun"])),{},{isShowClassify:function(){var t=this;return function(e){return(null==e?void 0:e.items.length)&&(t.currentCategory===e.category||"all"===t.currentCategory)}}}),methods:{getList:function(){var t=this;this.top.token&&(this.moreLoading=!0,Object(Q.y)({type:1}).then((function(e){var n=e.data.items,o=void 0===n?[]:n;t.list=o.map((function(e){return e.label=t.initCategoryName(e.category),e})),t.initCategory(o),t.moreLoading=!1})))},initCategory:function(t){this.category=t.map((function(t,e){return{value:t.category,label:null==t?void 0:t.label,isMore:e<4}})),this.category.unshift({value:"all",label:"All",isMore:!0})},changeTag:function(t){this.currentCategory=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_material"),behavior_info:"on_canvas_detail_page"})},getMore:function(t){var e=this;this.moreLoading=!0,this.type="more",t&&(this.paramsData.category=t.category),Object(Q.y)(this.paramsData).then((function(n){var data=n.data;e.isHaveMore?e.moreList=[{items:e.paramsData.page>1?e.moreList[0].items.concat(data):data,label:t?null==t?void 0:t.label:e.moreList[0].label}]:e.moreList=[{items:data,label:t.label}],e.isHaveMore=!(data.length<50),e.moreLoading=!1}))},closeSeeMore:function(){this.type="normal",this.moreList=[],this.paramsData.page=1,this.isHaveMore=!1},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.material,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getMore())}},initCategoryName:function(t){return"use"===t?"recentlyUsed":t.includes("/")?"canvas_".concat(t.split("/")[0]):"canvas_".concat(t)},keywordsChange:function(t){!t.target.value&&(this.type="normal")},search:function(){var t=this;this.keywords&&Object(Q.y)({type:1,name:this.keywords}).then((function(e){t.type="search",t.searchList=(null==e?void 0:e.data)||[]}))},clear:function(){this.keywords="",this.searchList=[],this.type="normal"},handleUse:function(t){var e,n=this;if(!t)return this.$message.error();var o=t.id,r=void 0===o?"":o,param={type:this.top.paintingBoardData.liveModel.show?"liveImgLayer":"imgLayer",imgSrc:(null==t?void 0:t.image)||""},c=null===(e=this.list.find((function(t){return"use"==t.category})))||void 0===e?void 0:e.items;c.find((function(t){return(null==t?void 0:t.id)==r}))?Object(Q.G)({id:r}).then((function(){n.top.changeData("topNav.tools.hasAct","selectEments"),n.top.addLayerItem(param);var e=c.filter((function(t){return(null==t?void 0:t.id)!=r}));e.unshift(t),n.$set(n.list[0],"items",e)})):Object(Q.G)({id:r}).then((function(){n.top.changeData("topNav.tools.hasAct","selectEments"),n.top.addLayerItem(param),c.unshift(t)})),P.a.emit("setLiveMoveable",{draggable:!0}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1)}}},Tt=(n(5278),Object(_.a)($t,(function(){var t=this,e=t._self._c;return e("div",{ref:"material",staticClass:"material-panel",on:{scroll:t.isScrollBottom}},[e("div",{directives:[{name:"show",rawName:"v-show",value:"more"!=t.type,expression:"type != 'more'"}],staticClass:"input-search"},[e("i",{staticClass:"iconfont icon-min-search",on:{click:t.search}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:t.$t("minSearch")},domProps:{value:t.keywords},on:{change:t.keywordsChange,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),t._v(" "),t.keywords.length>0?e("i",{staticClass:"el-icon-close",on:{click:t.clear}}):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"search"==t.type,expression:"type == 'search'"}],staticClass:"search-box"},[t.searchList.length?e("div",{staticClass:"search-content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("SearchResults")))]),t._v(" "),e("div",{staticClass:"content-box"},t._l(t.searchList,(function(n){return e("div",{key:null==n?void 0:n.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:(null==n?void 0:n.image)||"",alt:"image"}})])})),0)]):e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("NoSearchResultsTip")))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"more"==t.type,expression:"type == 'more'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("div",{staticClass:"classify-container"},t._l(t.moreList,(function(n){return e("div",{key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",{on:{click:t.closeSeeMore}},[e("i",{staticClass:"iconfont icon-back"}),t._v(t._s(t.$t(null==n?void 0:n.label)))])]),t._v(" "),e("div",{staticClass:"content-box"},t._l(n.items,(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"normal"==t.type,expression:"type == 'normal'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("CategoryTags",{attrs:{currentCategory:t.currentCategory,category:t.category},on:{changeTag:t.changeTag}}),t._v(" "),e("div",{staticClass:"classify-container"},t._l(t.list,(function(n,o){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowClassify(n),expression:"isShowClassify(classify)"}],key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",[t._v(t._s(t.$t(null==n?void 0:n.label)))]),t._v(" "),"use"!=n.category?e("span",{staticClass:"text",on:{click:function(e){return t.getMore(n,o)}}},[t._v(t._s(t.$t("viewMore")))]):t._e()]),t._v(" "),n.isHaveMore?t._e():e("div",{staticClass:"content-box"},t._l(n.items.filter((function(t){return null==t?void 0:t.id})),(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)],1)])}),[],!1,null,"11715257",null)),Mt=Tt.exports;function Rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var At={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:50,category:"mine",type:2},isHaveMore:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(h.c)("user",["cdnHostFun"])),mounted:function(){var t=this;this.top.token&&(this.getList(),this.$EventBus.$on("updateMine",(function(){setTimeout((function(){t.getList()}),1500)})))},beforeDestroy:function(){this.$EventBus.$off("updateMine")},methods:{getList:function(){var t=this;this.loading=!0,Object(Q.y)(this.paramsData).then((function(e){var data=e.data;t.list=t.paramsData.page>1?t.list.concat(data):data,t.isHaveMore=!(data.length<50),t.loading=!1}))},handleUse:function(t){var param={type:this.top.paintingBoardData.liveModel.show?"liveImgLayer":"imgLayer",imgSrc:t.image};this.top.changeData("topNav.tools.hasAct","selectEments"),P.a.emit("setLiveMoveable",{draggable:!0}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),this.top.addLayerItem(param),this.top.eventFn.setBoardYesDage(),this.top.eventFn.setViewYesDage(!1)},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){try{Object(Q.k)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))}catch(t){console.log(t)}})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.minematerial,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},Et=At,Bt=(n(5279),Object(_.a)(Et,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"minematerial",staticClass:"mine-panel",on:{scroll:t.isScrollBottom}},[t.list.length?e("div",{staticClass:"content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("All")))]),t._v(" "),e("div",{staticClass:"materials"},t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"item-material",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"item-material-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-close"})])])})),0)]):t._e(),t._v(" "),0!==t.list.length||t.loading?t._e():e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("no_data")))])])])}),[],!1,null,"0169c349",null).exports),Nt=(n(122),n(381));function Ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ft(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ht={inject:["top"],data:function(){return{}},computed:Ut(Ut({},Object(h.c)("user",["cdnHostFun"])),{},{operationBtns:function(){return[{type:"copy",hoverTips:"copy",icon:"el-icon-document-copy"},{type:"down",hoverTips:"MoveDown",icon:"el-icon-arrow-down",hide:1!=this.selectedLayer.length},{type:"up",hoverTips:"MoveUp",icon:"el-icon-arrow-up",hide:1!=this.selectedLayer.length},{type:"delete",hoverTips:"canvas_delete_hover",icon:"el-icon-delete"}]},renderLayer:function(){var t=this.top.paintingBoardData.elementList.filter((function(t){return["brushLayer","imgLayer"].includes(t.type)}))||[];return t.sort((function(a,b){return b.z-a.z})),t},getActiveList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.active}))||[]},selectedLayer:function(){return this.getActiveList.map((function(t){return t.layerId}))}}),methods:{showOrNot:function(t){t.show=!t.show},lockOrNot:function(t){t.lock=!t.lock},handleOperations:function(t){var e=this;switch(t){case"copy":var n=this.getActiveList.map((function(t){return t.z})),r=this.getActiveList.length?Math.max.apply(Math,Object(o.a)(n)):0,c=this.top.paintingBoardData.liveModel.show;this.getActiveList.forEach((function(t){var param={type:c?"liveImgLayer":"imgLayer",imgSrc:t.imgSrc||"",z:r+t.z};e.top.addLayerItem(param)}));break;case"down":this.handleOrder("down");break;case"up":this.handleOrder("up");break;case"delete":var l=this.top.paintingBoardData.elementList.filter((function(t){return!1===t.active}));this.top.changeData("elementList",l),document.querySelector("#layerBtnsId").style.left="0px",document.querySelector("#layerBtnsId").style.top="0px"}},handleOrder:function(t){var e=this;if(1==this.selectedLayer.length){var n=this.top.paintingBoardData.elementList,r=n.map((function(t){return t.z})),c=Math.max.apply(Math,Object(o.a)(r)),l=Math.min.apply(Math,Object(o.a)(r)),d=this.top.getEleInfo(this.selectedLayer[0],"z"),h=0,v=0,f=this.top.paintingBoardData.elementList.findIndex((function(t){return t.layerId==e.selectedLayer[0]}))||0;if("up"===t){if(h=(r=r.sort((function(a,b){return a-b}))).findIndex((function(t){return t==d})),d!=c){var m=r[h+1];v=n.findIndex((function(t){return t.z===m})),this.top.changeData("elementList[".concat(f,"].z"),m),this.top.changeData("elementList[".concat(v,"].z"),d)}}else if(h=(r=r.sort((function(a,b){return a-b}))).findIndex((function(t){return t==d})),d!=l){var _=r[h-1];v=n.findIndex((function(t){return t.z===_})),this.top.changeData("elementList[".concat(f,"].z"),_),this.top.changeData("elementList[".concat(v,"].z"),d)}}},handleClick:function(t){Object(Nt.a)("ctrlOrCmd").active?t.active=!t.active:(this.top.initLayerActive(),t.active=!0),this.top.eventFn.layerBtnsSetPoin()}}},Vt=(n(5280),Object(_.a)(Ht,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"layer-panel"},[null!==(t=e.renderLayer)&&void 0!==t&&t.length?n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("Layer")))]),e._v(" "),n("div",{staticClass:"layer-box"},e._l(e.renderLayer,(function(t,o){return n("div",{key:o,staticClass:"item-layer",class:{selected:e.selectedLayer.includes(t.layerId)},on:{click:function(n){return e.handleClick(t)}}},[n("div",{staticClass:"left"},[n("div",{staticClass:"eyes-box",on:{click:function(n){return n.stopPropagation(),e.showOrNot(t)}}},[n("i",{staticClass:"iconfont",class:t.show?"icon-work-show":"icon-work-hide"})]),e._v(" "),n("img",{staticClass:"layer",attrs:{src:t.imgSrc,alt:"layer"}}),e._v(" "),n("div",{staticClass:"name",attrs:{title:t.name}},[e._v(e._s(t.name))])]),e._v(" "),n("div",{staticClass:"right lock-box",on:{click:function(n){return n.stopPropagation(),e.lockOrNot(t)}}},[n("i",{class:t.lock?"el-icon-lock":"el-icon-unlock"})])])})),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.top.paintingBoardData.leftMenu.showLeftDrawer&&e.selectedLayer.length,expression:"top.paintingBoardData.leftMenu.showLeftDrawer && selectedLayer.length"}],staticClass:"bottom-btns"},e._l(e.operationBtns,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hide,expression:"!item.hide"}],key:t.type,staticClass:"item-btn",on:{click:function(n){return e.handleOperations(t.type)}}},[n("el-tooltip",{attrs:{effect:"dark",disabled:!t.hoverTips,content:e.$t(t.hoverTips)}},[n("i",{class:t.icon})])],1)})),0)]):n("div",{staticClass:"empty-box"},[n("img",{staticClass:"empty-img",attrs:{src:"https://".concat(e.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),e._v(" "),n("div",{staticClass:"empty-tip"},[e._v(e._s(e.$t("no_data")))])])])}),[],!1,null,"680bb77e",null).exports);function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Wt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var qt={inject:["top"],data:function(){return{}},computed:Wt(Wt({},Object(h.c)("user",["cdnHostFun"])),{},{operationBtns:function(){return[{type:"copy",hoverTips:"copy",icon:"el-icon-document-copy"},{type:"down",hoverTips:"MoveDown",icon:"el-icon-arrow-down",hide:1!=this.selectedLayer.length},{type:"up",hoverTips:"MoveUp",icon:"el-icon-arrow-up",hide:1!=this.selectedLayer.length},{type:"delete",hoverTips:"canvas_delete_hover",icon:"el-icon-delete"}]},renderLayer:function(){var t=this.top.paintingBoardData.liveLayerList.filter((function(t){return["liveBrushLayer","liveImgLayer"].includes(t.type)}))||[];return t.sort((function(a,b){return b.z-a.z})),t},getActiveList:function(){return this.top.paintingBoardData.liveLayerList.filter((function(t){return t.active}))||[]},selectedLayer:function(){return this.getActiveList.map((function(t){return t.layerId}))}}),methods:{showOrNot:function(t){t.show=!t.show,t.show||(t.active=!1,P.a.emit("hideLayerTopArea"))},lockOrNot:function(t){t.lock=!t.lock},handleOperations:function(t){var e=this;switch(t){case"copy":var n=this.getActiveList.map((function(t){return t.z})),r=this.getActiveList.length?Math.max.apply(Math,Object(o.a)(n)):0,c=this.top.paintingBoardData.liveModel.show;this.getActiveList.forEach((function(t){var param={type:c?"liveImgLayer":"imgLayer",imgSrc:t.imgSrc||"",z:r+t.z};e.top.addLayerItem(param)}));break;case"down":this.handleOrder("down");break;case"up":this.handleOrder("up");break;case"delete":var l=this.top.paintingBoardData.liveLayerList.filter((function(t){return!1===t.active}));this.top.changeData("liveLayerList",l),document.querySelector("#layerBtnsId").style.left="0px",document.querySelector("#layerBtnsId").style.top="0px"}},handleOrder:function(t){var e=this;if(1==this.selectedLayer.length){var n=this.top.paintingBoardData.liveLayerList,r=n.map((function(t){return t.z})),c=Math.max.apply(Math,Object(o.a)(r)),l=Math.min.apply(Math,Object(o.a)(r)),d=this.top.getEleInfo(this.selectedLayer[0],"z","liveLayerList"),h=0,v=0,f=n.findIndex((function(t){return t.layerId==e.selectedLayer[0]}))||0;if("up"===t){if(h=(r=r.sort((function(a,b){return a-b}))).findIndex((function(t){return t==d})),d!=c){var m=r[h+1];v=n.findIndex((function(t){return t.z===m})),this.top.changeData("liveLayerList[".concat(f,"].z"),m),this.top.changeData("liveLayerList[".concat(v,"].z"),d)}}else if(h=(r=r.sort((function(a,b){return a-b}))).findIndex((function(t){return t==d})),d!=l){var _=r[h-1];v=n.findIndex((function(t){return t.z===_})),this.top.changeData("liveLayerList[".concat(f,"].z"),_),this.top.changeData("liveLayerList[".concat(v,"].z"),d)}}},handleClick:function(t){Object(Nt.a)("ctrlOrCmd").active?t.active=!t.active:(this.top.initLiveLayerActive(),t.active=!0),P.a.emit("setLayerTopLocation")}}},Gt=(n(5281),Object(_.a)(qt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"layer-panel"},[null!==(t=e.renderLayer)&&void 0!==t&&t.length?n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("Layer")))]),e._v(" "),n("div",{staticClass:"layer-box"},e._l(e.renderLayer,(function(t,o){return n("div",{key:o,staticClass:"item-layer",class:{selected:e.selectedLayer.includes(t.layerId)},on:{click:function(n){return e.handleClick(t)}}},[n("div",{staticClass:"left"},[n("div",{staticClass:"eyes-box",on:{click:function(n){return n.stopPropagation(),e.showOrNot(t)}}},[n("i",{staticClass:"iconfont",class:t.show?"icon-work-show":"icon-work-hide"})]),e._v(" "),n("img",{staticClass:"layer",attrs:{src:t.imgSrc,alt:"layer"}}),e._v(" "),n("div",{staticClass:"name",attrs:{title:t.name}},[e._v(e._s(t.name))])]),e._v(" "),n("div",{staticClass:"right lock-box",on:{click:function(n){return n.stopPropagation(),e.lockOrNot(t)}}},[n("i",{class:t.lock?"el-icon-lock":"el-icon-unlock"})])])})),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.top.paintingBoardData.leftMenu.showLeftDrawer&&e.selectedLayer.length,expression:"top.paintingBoardData.leftMenu.showLeftDrawer && selectedLayer.length"}],staticClass:"bottom-btns"},e._l(e.operationBtns,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hide,expression:"!item.hide"}],key:t.type,staticClass:"item-btn",on:{click:function(n){return e.handleOperations(t.type)}}},[n("el-tooltip",{attrs:{effect:"dark",disabled:!t.hoverTips,content:e.$t(t.hoverTips)}},[n("i",{class:t.icon})])],1)})),0)]):n("div",{staticClass:"empty-box"},[n("img",{staticClass:"empty-img",attrs:{src:"https://".concat(e.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),e._v(" "),n("div",{staticClass:"empty-tip"},[e._v(e._s(e.$t("no_data")))])])])}),[],!1,null,"7988b68d",null).exports);function Yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Jt={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:20,category:"product",type:2},isHaveMore:!1,isUploading:!1,loopInterval:null,UPLOAD:new w.a({type:45})}},mounted:function(){this.top.token&&this.getList()},beforeDestroy:function(){clearInterval(this.loopInterval),this.loopInterval=null,clearTimeout()},methods:{getList:function(){var t=this;this.loading=!0,Object(Q.y)(this.paramsData).then((function(e){var data=e.data,n=t.paramsData,o=n.page,r=n.page_size;t.list=o>1?t.list.concat(data):data,t.isHaveMore=!(data.length<r),t.loading=!1}))},addProductImg:function(t){var e=this,image=t.image,n=this.top.paintingBoardData,o=n.liveModel,r=n.liveLayerList;null!=o&&o.show||this.top.changeData("liveModel.show",!0),this.$nextTick((function(){e.top.paintingBoardData.liveLayerList=r.filter((function(t){return t.z<1e4}));var param={type:"liveProductImgLayer",imgSrc:image,isProduct:!0};e.top.changeData("topNav.tools.hasAct","selectEments"),P.a.emit("setLiveMoveable",{draggable:!0}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),e.top.eventFn.setBoardYesDage(),e.top.eventFn.setViewYesDage(!1),e.top.addLayerItem(param)}))},handleUse:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var image,o,r,c,l,d,h,v,f,m,_,y,w,param,C;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return image=t.image,o=e.top.paintingBoardData,r=o.liveModel,c=o.liveLayerList,null!=r&&r.show||(e.top.changeData("liveModel.show",!0),e.top.setLiveLocal(),e.top.paintingBoardData.liveModel=Kt(Kt({},r),{},{width:1024,height:1024})),e.top.paintingBoardData.liveLayerList=c.filter((function(t){return t.z<1e4})),n.next=6,Object(_t.x)(image);case 6:return l=n.sent,d=l.width,h=l.height,v=e.top.paintingBoardData.liveModel,v.x,v.y,f=v.width,m=v.height,y=m-10>0?m-10:m,(d>(_=f-10>0?f-10:f)||h>y)&&(w=Math.min(_/d,y/h),d*=w,h*=w),e.top.paintingBoardData.liveModel.show,param={type:"liveProductImgLayer",imgSrc:image,isProduct:!0},e.top.changeData("topNav.tools.hasAct","selectEments"),P.a.emit("setLiveMoveable",{draggable:!0}),P.a.emit("setLiveViewer",{useMouseDrag:!1}),e.top.eventFn.setBoardYesDage(),e.top.eventFn.setViewYesDage(!1),n.next=22,e.top.addLayerItem(param);case 22:C=n.sent,e.top.paintingBoardData.liveModel.productLayerId=C,setTimeout((function(){null!=r&&r.show&&e.top.handleWatchLiveGenerate()}),500);case 25:case"end":return n.stop()}}),n)})))()},handleBeforeUpload:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.$logEvent("log_actions",{operation:"click_upload_product",behavior_info:"on_canvas"}),o=["image/jpeg","image/png","image/jpg","image/webp"],!e.isUploading){n.next=4;break}return n.abrupt("return");case 4:if(o.includes(t.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 7:if(!t||t.size){n.next=9;break}return n.abrupt("return",!1);case 9:if(!(t.size/1024/1024>5)){n.next=20;break}return n.prev=10,n.next=13,Object(C.a)(t,5242880);case 13:t=n.sent,n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(10),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 20:return n.prev=20,e.isUploading=!0,n.next=24,e.UPLOAD.startUpload(t);case 24:return r=n.sent,n.next=27,Object(Q.r)({image_url:r});case 27:c=n.sent,(l=c.data.id)&&e.loopGetResult(l),n.next=35;break;case 32:n.prev=32,n.t1=n.catch(20),e.isUploading=!1;case 35:return n.abrupt("return",!1);case 36:case"end":return n.stop()}}),n,null,[[10,16],[20,32]])})))()},loopGetResult:function(t){var e=this;this.loopInterval=setInterval(Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(v.batchFetchTaskProcess)({scene:1,task_ids:[t]});case 3:if(r=n.sent,null!=(c=r.data.items)&&c[0]){n.next=8;break}return e.isUploading=!1,n.abrupt("return");case 8:l=c[0],d=l.status_desc,h=l.img_uris,f=(null==h||null===(o=h[0])||void 0===o?void 0:o.url)||"",n.t0=d,n.next="finish"===n.t0?13:"sysCancelDesc"===n.t0?17:"sysTimeoutDesc"===n.t0?21:25;break;case 13:return e.saveToList(f),clearInterval(e.loopInterval),e.isUploading=!1,n.abrupt("break",26);case 17:return e.$message.warning(e.$t("systemCancel")),clearInterval(e.loopInterval),e.isUploading=!1,n.abrupt("break",26);case 21:return e.$message.warning(e.$t("systemTimeoutCancel")),clearInterval(e.loopInterval),e.isUploading=!1,n.abrupt("break",26);case 25:return n.abrupt("break",26);case 26:n.next=33;break;case 28:n.prev=28,n.t1=n.catch(0),e.isUploading=!1,clearInterval(e.loopInterval),console.log("error",n.t1);case 33:case"end":return n.stop()}}),n,null,[[0,28]])}))),3e3)},saveToList:function(image){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Q.I)({items:[{category:"product",image:image,name:""}]});case 2:e.sent&&(t.$message.success(t.$t("UploadSuccess")),setTimeout((function(){t.isUploading=!1,t.getList()}),1e3));case 4:case"end":return e.stop()}}),e)})))()},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){try{Object(Q.k)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))}catch(t){console.log(t)}})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},handleDownload:function(t){var img=new Image;img.crossOrigin="anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="product.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},this.$message.success(this.$t("OperateSuccess"))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.product,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},Xt=(n(5282),{components:{GeneratePanel:gt,TemplatePanel:Lt,MaterialPanel:Mt,MinePanel:Bt,LayerPanel:Vt,LayerLivePanel:Gt,Product:Object(_.a)(Jt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"product",staticClass:"product",on:{scroll:t.isScrollBottom}},[e("div",{staticClass:"product-tips"},[t._v(t._s(t.$t("canvas_product_tips")))]),t._v(" "),e("div",{staticClass:"product-list"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.isUploading,expression:"isUploading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"product-list-item",attrs:{action:"#","before-upload":t.handleBeforeUpload,disabled:t.isUploading,accept:".jpg, .jpeg, .png, .webp","http-request":function(){},"show-file-list":!1}},[e("div",{attrs:{slot:"trigger"},slot:"trigger"},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",{staticClass:"upload-text"},[t._v(t._s(t.$t("canvas_upload_product")))])])]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"product-list-item",on:{click:function(e){return t.addProductImg(n)}}},[e("img",{attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon right36",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-delete"})]),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownload(n.image)}}},[e("i",{staticClass:"el-icon-download"})])])}))],2)])}),[],!1,null,"47e7138c",null).exports},inject:["top"],props:{currentMenu:{type:String,default:""}},data:function(){return{}},computed:{showLiveLayer:function(){return"Layer"===this.currentMenu&&this.top.paintingBoardData.liveModel.show},showControLayer:function(){return"Layer"===this.currentMenu&&!this.top.paintingBoardData.liveModel.show}},methods:{showMenu:function(){this.top.changeData("leftMenu.showLeftDrawer",!0)},toggleMenuBard:function(){this.top.changeData("leftMenu.showLeftDrawer",!this.top.paintingBoardData.leftMenu.showLeftDrawer)},changeMenuToLayer:function(){this.$emit("changeMenu",{label:"Layer"})}}}),Qt=(n(5283),{components:{LeftDrawer:Object(_.a)(Xt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-drawer",class:t.top.paintingBoardData.leftMenu.showLeftDrawer?"show-menu":"hide-menu"},[e("div",{staticClass:"content"},[e("Product",{directives:[{name:"show",rawName:"v-show",value:"Product"===t.currentMenu,expression:"currentMenu === 'Product'"}]}),t._v(" "),e("GeneratePanel",{directives:[{name:"show",rawName:"v-show",value:"Generate"===t.currentMenu,expression:"currentMenu === 'Generate'"}],model:{value:t.top.paintingBoardData.controlNet,callback:function(e){t.$set(t.top.paintingBoardData,"controlNet",e)},expression:"top.paintingBoardData.controlNet"}}),t._v(" "),"Template"===t.currentMenu?e("TemplatePanel"):t._e(),t._v(" "),"Material"===t.currentMenu?e("MaterialPanel"):t._e(),t._v(" "),"Mine"===t.currentMenu?e("MinePanel"):t._e(),t._v(" "),t.showControLayer?e("LayerPanel"):t._e(),t._v(" "),t.showLiveLayer?e("LayerLivePanel"):t._e()],1),t._v(" "),e("div",{staticClass:"open-btn",on:{click:t.toggleMenuBard}},[e("i",{class:t.top.paintingBoardData.leftMenu.showLeftDrawer?"el-icon-arrow-left":"el-icon-arrow-right"})]),t._v(" "),e("div",{staticClass:"layer-btn",on:{click:t.changeMenuToLayer}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("Layer")}},[e("i",{staticClass:"iconfont icon-icon_tuceng"})])],1)])}),[],!1,null,"ba4fda26",null).exports},inject:["top"],data:function(){return{menuList:[{label:"Product",icon:"icon-tiaojiecanshu"},{label:"Generate",icon:"icon-tiaojiecanshu"},{label:"Template",icon:"icon-icon_moban"},{label:"Material",icon:"icon-icon_sucai"},{label:"Mine",icon:"icon-icon_wode"}],currentMenu:"Product"}},methods:{changeMenu:function(t){this.currentMenu=t.label,this.top.leftActiveTab=t.label,this.$refs.leftDrawer.showMenu()}}}),Zt=(n(5284),Object(_.a)(Qt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-menu-box"},[e("div",{staticClass:"menu-list"},t._l(t.menuList,(function(n){return e("div",{key:n.label,staticClass:"item",class:{active:t.currentMenu===n.label},on:{click:function(e){return t.changeMenu(n)}}},[e("div",{staticClass:"icon"},[e("i",{staticClass:"iconfont",class:n.icon})]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t(n.label)))])])})),0),t._v(" "),e("LeftDrawer",{ref:"leftDrawer",attrs:{currentMenu:t.currentMenu},on:{changeMenu:t.changeMenu}})],1)}),[],!1,null,"3539caaa",null).exports),te=n(303);function ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ee(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ne={name:"addOrEditParamsDialog",data:function(){return{isShowDialog:!1,btnLoading:!1,paramName:"",type:"",info:{}}},computed:{},methods:{openDialog:function(t,e){this.type=t,this.info=e,"edit"==t&&(this.paramName=(null==e?void 0:e.name)||""),this.isShowDialog=!0},closeDialog:function(){this.type="",this.info={},this.paramName="",this.isShowDialog=!1,this.btnLoading=!1},handleConfirm:function(){var t=this;if(this.btnLoading=!0,!this.paramName.length)return this.$message.warning(this.$t("ParamNameWarning")),void(this.btnLoading=!1);if("add"==this.type){var e=this.info.lora_models,n=void 0===e?[]:e;Object(Q.i)(ie(ie({},this.info),{},{lora_models:n,name:this.paramName})).then((function(e){var n,o=(null==e||null===(n=e.data)||void 0===n?void 0:n.id)||"";t.$message.success(t.$t("CreateSuccess")),t.closeDialog(),t.$emit("updateList",o)})).finally((function(){t.btnLoading=!1}))}else Object(Q.p)({id:this.info.value,name:this.paramName}).then((function(){t.$message.success(t.$t("SuccessfullyModified")),t.closeDialog(),t.$emit("updateList")})).finally((function(){t.btnLoading=!1}))}}},ae=(n(5285),Object(_.a)(ne,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"add-params custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",title:t.$t("add"==t.type?"AddPresetParam":"ModifyPresetParamName"),visible:t.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("ParamName")))]),t._v(" "),e("el-input",{staticClass:"canvas-name-input",attrs:{placeholder:"",maxlength:"15"},model:{value:t.paramName,callback:function(e){t.paramName=e},expression:"paramName"}}),t._v(" "),e("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDialog}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{loading:t.btnLoading},on:{click:t.handleConfirm}},[t._v("\n      "+t._s(t.$t("Confirm"))+"\n    ")])],1)],1)}),[],!1,null,"3909064e",null).exports);function se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?se(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var re={components:{StyleModal:te.default,addOrEditParamsDialog:ae},inject:["top"],props:{showCell:{type:Boolean,default:!1}},data:function(){return{extraSelectedModel:[],styleModalType:"Checkpoint",isHideAdvanced:!0,defParamsArr:[],defParamsValueArr:[],customizeParamsArr:[],baseModelArr:[],vaeArr:[],defSamplerMethodArr:[],liveSamplerMethodArr:[],defParams:{},defaultTemplate:{}}},mounted:function(){this.getConfig(),this.getRandomNumber(),this.getCusDefParams(),this.top.eventFn.submitPublish=this.submit},computed:oe(oe(oe({},Object(h.c)("payment",["paymentInfo"])),Object(h.c)("user",["isCompanyAccount"])),{},{isVipFun:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},isCheckPoint:function(){return"Checkpoint"===this.styleModalType},isLoRA:function(){return"LORA"===this.styleModalType},isSdModel:function(){var t;return!(null===(t=this.selectedModelInfo)||void 0===t||!t.base_model)&&(this.selectedModelInfo.base_model.includes("sdxl")||this.selectedModelInfo.base_model.includes("SDXL"))},renderModelList:function(){return this.extraSelectedModel.length?[].concat(Object(o.a)(this.baseModelArr),Object(o.a)(this.extraSelectedModel)):Object(o.a)(this.baseModelArr)},selectedModelInfo:function(){var t=this;return this.renderModelList.find((function(e){return e.id==t.advancedParams.modelInfo.id}))},styleModalSelectIds:function(){var t,e,n;return this.isCheckPoint?[{id:null===(t=this.selectedModelInfo)||void 0===t?void 0:t.id,art_model_ver_no_name:null===(e=this.selectedModelInfo)||void 0===e?void 0:e.model_ver_no,model_cover:null===(n=this.selectedModelInfo)||void 0===n?void 0:n.cover}]:[]},advancedParams:function(){return this.top.paintingBoardData.currentParams||{}},renderParamsList:function(){return[].concat(Object(o.a)(this.defParamsArr),Object(o.a)(this.customizeParamsArr))},isDefParams:function(){return this.defParamsValueArr.includes(this.top.paintingBoardData.selectedParams)},basicParams:function(){var t=this.top.paintingBoardData.basicParams;return t},disabledNum:function(){var t=this.top.paintingBoardData.topNav.tools.hasAct;return[1,2].includes(this.top.generateType)&&"updateArimg"===t},handleBtnStyle:function(){var t=this.top.paintingBoardData.liveModel;return t.loading||!t.result},showBrushWerght:function(){var t=this.top.paintingBoardData,e=t.liveLayerList,n=t.liveModel,o=t.topNav,r=e.some((function(t){return"liveBrushLayer"===t.type})),c=n.show,l="brushBoard"===o.tools.hasAct;return r&&c||l}}),watch:{isSdModel:{handler:function(){this.changeAdvancedParams([],"selectedLora")}}},methods:oe(oe({},Object(h.b)("creation",["setEditBoardGenerateOptions"])),{},{getConfig:function(){var t=this;this.top.token?(this.top.paramsLoading=!0,Object(Q.v)().then((function(e){var n,o=e.data,r=o.templates,c=o.base_model,l=o.vaes,d=o.ge_sampler,h=o.live_sampler,v=o.default_template;t.setEditBoardGenerateOptions(null==e?void 0:e.data),t.defaultTemplate=v,t.saveDefParams(v),t.baseModelArr=c.map((function(t){return oe({model_ver_no:"",model_ver_name:""},t)})),t.vaeArr=l,t.defSamplerMethodArr=d,t.liveSamplerMethodArr=h,t.defParamsArr=t.formatParams(r,"def");var f=(null==r||null===(n=r[0])||void 0===n?void 0:n.id)||"";t.changeData(f,"selectedParams");var m=t.renderParamsList.find((function(t){return(null==t?void 0:t.value)==f})),_=tt()(m.params);t.changeData(_,"currentParams"),setTimeout((function(){t.top.paramsLoading=!1}),200)}))):this.dataReady=!0},saveDefParams:function(t){var e=t.model_no,n=t.model_name,o=t.model_ver_name,r=t.model_ver_no,c=t.model_cover,l=t.base_model,d=void 0===l?"":l,h=t.prompt,v=t.negative_prompt,f=t.vae,m=t.ge_setting,_=m.sampler,y=m.steps,w=m.cfg_scale,C=t.live_setting,k=C.sampler,O=C.steps,x=C.cfg_scale;this.defParams={modelInfo:{id:e,name:n,model_ver_no:r,model_ver_name:o,cover:c,base_model:d},selectedLora:[],stylePrompt:h,negativePrompt:v,vae:f,samplerSettingsDefault:{samplingMethod:_,samplingSteps:y,upscaling:15,CFGScale:w},samplerSettingsLive:{samplingMethod:k,samplingSteps:O,CFGScale:x}}},getCusDefParams:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.top.token&&Object(Q.x)().then((function(n){var o=n.data.items;t.customizeParamsArr=t.formatParams(o),e&&t.changeData(e,"selectedParams")}))},formatParams:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!=t&&t.length?t.map((function(t){var o=t.name,r=t.id,c=t.model_no,l=t.model_name,d=t.model_ver_name,h=t.model_ver_no,v=t.model_cover,f=t.loras,m=t.prompt,_=t.negative_prompt,y=t.vae,w=t.ge_setting,C=w.sampler,k=w.steps,O=w.cfg_scale,x=t.live_setting,I=x.sampler,S=x.steps,D=x.cfg_scale,L={id:c,name:l,model_ver_no:h,model_ver_name:d,cover:v,base_model:(null==t?void 0:t.base_model)||""},P=f?f.map((function(t){return{cover:t.model_cover,id:t.model_no,name:t.model_name,model_ver_name:"",model_ver_no:t.model_ver_no,weights:t.weight}})):[];return"def"==n&&e.defParamsValueArr.push(r),!e.renderModelList.find((function(t){return t.id==c}))&&e.extraSelectedModel.push(L),{name:o,value:r,params:{modelInfo:L,selectedLora:P,stylePrompt:m,negativePrompt:_,vae:y,samplerSettingsDefault:{samplingMethod:C,samplingSteps:k,upscaling:15,CFGScale:O},samplerSettingsLive:{samplingMethod:I,samplingSteps:S,CFGScale:D}}}})):[]},changeUrl:function(t){return Object(_t.K)(t,"high")},handleAddOrEditParam:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case"add":this.$logEvent("log_actions",{operation:"click_new_addition",behavior_info:"on_canvas_parameters"});break;case"saveAs":this.$logEvent("log_actions",{operation:"click_save_as",behavior_info:"on_canvas_parameters"})}var n="saveAs"==t?"add":t;this.$refs.addOrEditParam.openDialog(n,e)},handleModifyParams:function(t){var e=this,n=this.top.paintingBoardData.selectedParams,o=this.customizeParamsArr.find((function(t){return t.value==n})),r=this.advancedParams,c=r.samplerSettingsDefault,l=c.CFGScale,d=c.samplingMethod,h=c.samplingSteps,v=r.samplerSettingsLive,f=v.CFGScale,m=v.samplingMethod,_=v.samplingSteps,y=r.modelInfo,w=y.id,C=y.model_ver_no,k=r.selectedLora,O=r.stylePrompt,x=r.negativePrompt,I=r.vae;k=k.map((function(t){return{model_id:t.id,model_ver_no:t.model_ver_no,weight:t.weights}}));var S={name:(null==o?void 0:o.name)||"",id:n,ge_setting:{cfg_scale:l,sampler:d,steps:h},live_setting:{cfg_scale:f,sampler:m,steps:_},model_no:w,model_ver_no:C,lora_models:k,prompt:O,negative_prompt:x,vae:I};"save"==t?(this.$logEvent("log_actions",{operation:"click_save",behavior_info:"on_canvas_parameters"}),Object(Q.o)(S).then((function(t){e.$message.success(e.$t("SaveSuccess")),e.getCusDefParams()}))):this.handleAddOrEditParam("saveAs",S)},handleDeletParam:function(t){var e=this;Object(Q.j)({id:t}).then((function(n){if(e.$message.success(e.$t("deleteSuccess")),e.top.paintingBoardData.selectedParams==t){var o,r=(null===(o=e.defParamsArr)||void 0===o?void 0:o[0])||{},c=r.value,l=r.params;e.changeData(c,"selectedParams");var d=tt()(l);e.changeData(d,"currentParams")}e.customizeParamsArr=e.customizeParamsArr.filter((function(e){return e.value!=t}))}))},selectModelChange:function(t){if("MoreModel"==t)this.openModelSelect("Checkpoint");else{var e=this.renderModelList.find((function(e){return e.id===t}));this.changeAdvancedParams(e,"modelInfo")}},openModelSelect:function(t){var e=this;this.styleModalType=t,this.$nextTick((function(){e.$refs.styleModal.openModal()}))},handleSelectModel:function(t){var e=t.banner.url,n=void 0===e?"":e,o=t.id,r=void 0===o?"":o,c=t.name,l=void 0===c?"":c,d=t.model_ver_no,h=void 0===d?"":d,v=t.version_name,f=void 0===v?"":v,m=t.base_model,_=void 0===m?"":m;if(this.isCheckPoint){!this.extraSelectedModel.find((function(t){return t.id==r}))&&this.extraSelectedModel.push({cover:n,id:r,model_ver_name:f,model_ver_no:h,name:l,base_model:_}),this.changeAdvancedParams(t,"modelInfo")}else{var y;if(!this.isVipFun&&(null===(y=this.advancedParams)||void 0===y||null===(y=y.selectedLora)||void 0===y?void 0:y.length)>=3)return void this.$EventBus.$emit("showBreakDialog","LoRALimit5TipWeb","basic");var w=this.advancedParams.selectedLora.find((function(t){return t.id==r})),C=this.advancedParams.selectedLora;w||(C.push({cover:n,id:r,model_ver_name:f,model_ver_no:h,name:l,weights:1}),this.changeAdvancedParams(C,"selectedLora"))}this.$refs.styleModal.handleClose()},deleteSelectedLora:function(t){var e=this.advancedParams.selectedLora.filter((function(e){return e.id!=t}));this.changeAdvancedParams(e,"selectedLora")},getRandomNumber:function(){var t=Math.floor(65538*Math.random())-1;this.changeData(t,"basicParams.randomSeed")},changeCurrentParams:function(t){this.changeData(t,"selectedParams");var e=this.renderParamsList.find((function(e){return(null==e?void 0:e.value)==t})),n=tt()(e.params);this.changeData(n,"currentParams")},handleResetParams:function(){var t=tt()(this.defParams);this.changeData(t,"currentParams")},changeWeights:function(t,e){e.weights=t},changeAdvancedParams:function(t,e){this.changeData(t,"currentParams.".concat(e))},changeData:function(t,e){this.top.changeData(e,t)},submit:function(){if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});var t=this.top.paintingBoardData.liveModel;t.params.taskId&&t.result&&!t.loading&&this.top.publishPop({width:t.width,height:t.height,url:t.result,task_id:t.params.taskId})}})},ce=re,le=(n(5286),Object(_.a)(ce,(function(){var t,e,n,o,r,c,l,d,h=this,v=h._self._c;return v("div",{staticClass:"right-params-page no-snapshot"},[v("div",{staticClass:"right-params-box"},[v("div",{staticClass:"basic-params"},[v("div",{staticClass:"denoising-strength item-param"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("DenoisingStrength")))]),h._v(" "),v("el-slider",{attrs:{value:null===(t=h.basicParams)||void 0===t?void 0:t.denoisingStrength,min:.01,max:1,step:.05,"show-input":!0,"show-input-controls":!1},on:{input:function(t){return h.changeData(t,"basicParams.denoisingStrength")}}})],1),h._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:h.showBrushWerght,expression:"showBrushWerght"}],staticClass:"denoising-strength item-param",staticStyle:{"margin-top":"8px"}},[v("div",{staticClass:"label brush-werght-name"},[h._v("\n            "+h._s(h.$t("ControlWeight"))+"\n            "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("controlWeightTipsRight"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("el-slider",{attrs:{value:null===(e=h.basicParams)||void 0===e?void 0:e.brushWeight,min:0,max:2,step:.1,"show-input":!0,"show-input-controls":!1},on:{input:function(t){return h.changeData(t,"basicParams.brushWeight")}}})],1),h._v(" "),v("div",{staticClass:"random-seed item-param l-r"},[v("div",{staticClass:"left"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("Seed")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("ASendCTOOARNG"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"right"},[v("el-input-number",{staticClass:"number",attrs:{value:null===(n=h.basicParams)||void 0===n?void 0:n.randomSeed,size:"mini",min:-1,max:65536,controls:!1},on:{input:function(t){return h.changeData(t,"basicParams.randomSeed")}}}),h._v(" "),v("i",{staticClass:"iconfont icon-dice-square dice",on:{click:h.getRandomNumber}})],1)]),h._v(" "),v("div",{staticClass:"images-number item-param l-r"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("QuantityOfImages")))]),h._v(" "),v("el-select",{staticClass:"custom-select-transparent",attrs:{value:null===(o=h.basicParams)||void 0===o?void 0:o.imagesNumber,"popper-class":"painting-board-select",disabled:h.disabledNum,"popper-append-to-body":!1},on:{change:function(t){return h.changeData(t,"basicParams.imagesNumber")}}},h._l(4,(function(t){return v("el-option",{key:"quantity-of-images"+t,attrs:{label:t,value:t}})})),1)],1)]),h._v(" "),v("div",{staticClass:"default-params item-param"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("DefaultParams")))]),h._v(" "),v("i",{staticClass:"el-icon-plus",on:{click:function(t){return h.handleAddOrEditParam("add",h.defaultTemplate)}}})]),h._v(" "),v("div",{staticClass:"bottom"},[v("el-select",{ref:"paramSelect",attrs:{value:h.top.paintingBoardData.selectedParams,"popper-class":"painting-board-select",placeholder:h.$t("PlsSelectDefaultParams"),"popper-append-to-body":!1},on:{change:h.changeCurrentParams}},h._l(h.renderParamsList,(function(t){return v("el-option",{key:t.value,attrs:{label:t.name,value:t.value}},[h.defParamsValueArr.includes(t.value)?v("div",{staticClass:"show-params-name"},[v("div",{staticClass:"param-name"},[h._v("\n                  "+h._s(t.name)+"\n                ")])]):v("div",{staticClass:"show-params-name"},[v("div",{staticClass:"param-name"},[h._v("\n                  "+h._s(t.name)+"\n                ")]),h._v(" "),v("div",{staticClass:"operations",class:{alwaysShow:t.value===h.top.paintingBoardData.selectedParams}},[v("i",{staticClass:"el-icon-edit",on:{click:function(e){return e.stopPropagation(),h.handleAddOrEditParam("edit",t)}}}),h._v(" "),v("i",{staticClass:"el-icon-delete",on:{click:function(e){return e.stopPropagation(),h.handleDeletParam(t.value)}}})])])])})),1)],1)]),h._v(" "),v("div",{staticClass:"advanced-params"},[v("div",{staticClass:"title",on:{click:function(t){h.isHideAdvanced=!h.isHideAdvanced}}},[v("div",{staticClass:"label"},[v("i",{staticClass:"iconfont icon-gaojishezhi"}),h._v("\n            "+h._s(h.$t("AdvancedConfig"))+"\n          ")]),h._v(" "),v("i",{staticClass:"el-icon-caret-bottom",class:{reverse:h.isHideAdvanced}})]),h._v(" "),v("div",{staticClass:"content",class:{hide:h.isHideAdvanced}},[v("div",{staticClass:"select-model item-param"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v("\n                "+h._s(h.$t("Model"))+"\n              ")]),h._v(" "),v("el-select",{staticClass:"custom-select-transparent",attrs:{value:h.advancedParams.modelInfo.id,placeholder:"","popper-class":"painting-board-select","popper-append-to-body":!1},on:{change:h.selectModelChange}},[h._l(h.renderModelList,(function(t,i){return v("el-option",{key:"model_"+i,attrs:{label:null==t?void 0:t.name,value:null==t?void 0:t.id}})})),h._v(" "),v("el-option",{attrs:{label:h.$t("selectMoreModel"),value:"MoreModel"}})],2)],1),h._v(" "),v("div",{staticClass:"bottom"},[null!==(r=h.selectedModelInfo)&&void 0!==r&&r.cover?v("el-image",{attrs:{src:h.changeUrl(null===(c=h.selectedModelInfo)||void 0===c?void 0:c.cover)}},[v("template",{slot:"placeholder"},[v("i",{staticClass:"el-icon-loading image-loading"})])],2):v("p",{staticClass:"empty-img"},[h._v(h._s(h.$t("EmptyBannerText")))]),h._v(" "),v("div",{staticClass:"name",attrs:{title:null===(l=h.selectedModelInfo)||void 0===l?void 0:l.name}},[h._v("\n                "+h._s(null===(d=h.selectedModelInfo)||void 0===d?void 0:d.name)+"\n              ")]),h._v(" "),v("div",{staticClass:"swap",on:{click:function(t){return h.openModelSelect("Checkpoint")}}},[v("i",{staticClass:"iconfont icon-select-model-icon"}),h._v(" "),v("span",{staticClass:"text"},[h._v(h._s(h.$t("switch")))])])],1)]),h._v(" "),v("div",{staticClass:"select-style item-param"},[v("div",{staticClass:"top",on:{click:function(t){return h.openModelSelect("LORA")}}},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("LoRA")))]),h._v(" "),v("i",{directives:[{name:"show",rawName:"v-show",value:h.advancedParams.selectedLora.length<5,expression:"advancedParams.selectedLora.length < 5"}],staticClass:"el-icon-circle-plus"})]),h._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:h.advancedParams.selectedLora.length,expression:"advancedParams.selectedLora.length"}],staticClass:"bottom"},h._l(h.advancedParams.selectedLora,(function(t){return v("div",{key:t.id,staticClass:"item-lora"},[t.cover?v("el-image",{attrs:{src:h.changeUrl(t.cover)}},[v("template",{slot:"placeholder"},[v("i",{staticClass:"el-icon-loading image-loading"})])],2):v("p",{staticClass:"empty-img"},[h._v(h._s(h.$t("EmptyBannerText")))]),h._v(" "),v("div",{staticClass:"right"},[v("div",{staticClass:"top"},[v("div",{staticClass:"name",attrs:{title:t.name}},[h._v(h._s(t.name))]),h._v(" "),v("i",{staticClass:"el-icon-delete",on:{click:function(e){return h.deleteSelectedLora(t.id)}}})]),h._v(" "),v("div",{staticClass:"bottom"},[v("el-slider",{attrs:{value:t.weights,min:-1,max:2,step:.05,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(e){return h.changeWeights(e,t)}}})],1)])],1)})),0)]),h._v(" "),v("div",{staticClass:"style-prompt item-param"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("Prompt")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("PromptTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-input",{staticClass:"style-prompt-input",attrs:{type:"textarea",value:h.advancedParams.stylePrompt},on:{input:function(t){return h.changeAdvancedParams(t,"stylePrompt")}}})],1)]),h._v(" "),v("div",{staticClass:"negative-prompt item-param"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("NegativePrompts")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("NegativePromptTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-input",{staticClass:"negative-prompt-input",attrs:{type:"textarea",value:h.advancedParams.negativePrompt},on:{input:function(t){return h.changeAdvancedParams(t,"negativePrompt")}}})],1)]),h._v(" "),v("div",{staticClass:"vae item-param"},[v("div",{staticClass:"left"},[v("div",{staticClass:"label"},[h._v("VAE")]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("newVaeTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"right"},[v("el-select",{staticClass:"custom-select-transparent",attrs:{value:h.advancedParams.vae,"popper-append-to-body":!1,"popper-class":"painting-board-select"},on:{change:function(t){return h.changeAdvancedParams(t,"vae")}}},h._l(h.vaeArr,(function(t,i){return v("el-option",{key:"method_"+i,attrs:{label:t,value:t}},[v("el-tooltip",{attrs:{content:t,placement:"left"}},[v("span",[h._v(h._s(t))])])],1)})),1)],1)]),h._v(" "),v("div",{staticClass:"default-type"},[v("div",{staticClass:"title"},[h._v(h._s(h.$t("SamplerSettingsDefault")))]),h._v(" "),v("div",{staticClass:"sampling-method item-param"},[v("div",{staticClass:"left"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("SamplingMethod")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("SamplingMethodDefaultTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"right"},[v("el-select",{staticClass:"custom-select-transparent",attrs:{value:h.advancedParams.samplerSettingsDefault.samplingMethod,"popper-append-to-body":!1,"popper-class":"painting-board-select"},on:{change:function(t){return h.changeAdvancedParams(t,"samplerSettingsDefault.samplingMethod")}}},h._l(h.defSamplerMethodArr,(function(t,i){return v("el-option",{key:"method_"+i,attrs:{label:t,value:t}},[v("el-tooltip",{attrs:{content:t,placement:"left"}},[v("span",[h._v(h._s(t))])])],1)})),1)],1)]),h._v(" "),v("div",{staticClass:"sampling-steps item-param t-b"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("SamplingSteps")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("SamplingStepsDefaultTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-slider",{attrs:{value:h.advancedParams.samplerSettingsDefault.samplingSteps,min:10,max:40,step:1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(t){return h.changeAdvancedParams(t,"samplerSettingsDefault.samplingSteps")}}})],1)]),h._v(" "),v("div",{staticClass:"cfg-scale item-param t-b"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("CFGScale")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("CFGScaleDefaultTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-slider",{attrs:{value:h.advancedParams.samplerSettingsDefault.CFGScale,min:3,max:15,step:1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(t){return h.changeAdvancedParams(t,"samplerSettingsDefault.CFGScale")}}})],1)])]),h._v(" "),v("div",{staticClass:"live-type"},[v("div",{staticClass:"title"},[h._v(h._s(h.$t("SamplerSettingsLive")))]),h._v(" "),v("div",{staticClass:"sampling-method item-param"},[v("div",{staticClass:"left"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("SamplingMethod")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("SamplingMethodLiveTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"right"},[v("el-select",{staticClass:"custom-select-transparent",attrs:{value:h.advancedParams.samplerSettingsLive.samplingMethod,"popper-append-to-body":!1,"popper-class":"painting-board-select"},on:{change:function(t){return h.changeAdvancedParams(t,"samplerSettingsLive.samplingMethod")}}},h._l(h.liveSamplerMethodArr,(function(t,i){return v("el-option",{key:"method_"+i,attrs:{label:t,value:t}},[v("el-tooltip",{attrs:{content:t,placement:"left"}},[v("span",[h._v(h._s(t))])])],1)})),1)],1)]),h._v(" "),v("div",{staticClass:"sampling-steps item-param t-b"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("SamplingSteps")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("SamplingStepsLiveTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-slider",{attrs:{value:h.advancedParams.samplerSettingsLive.samplingSteps,min:1,max:50,step:1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(t){return h.changeAdvancedParams(t,"samplerSettingsLive.samplingSteps")}}})],1)]),h._v(" "),v("div",{staticClass:"cfg-scale item-param t-b"},[v("div",{staticClass:"top"},[v("div",{staticClass:"label"},[h._v(h._s(h.$t("CFGScale")))]),h._v(" "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("CFGScaleLiveTip"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),v("div",{staticClass:"bottom"},[v("el-slider",{attrs:{value:h.advancedParams.samplerSettingsLive.CFGScale,min:.1,max:14,step:.1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(t){return h.changeAdvancedParams(t,"samplerSettingsLive.CFGScale")}}})],1)])])])]),h._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:!h.showCell,expression:"!showCell"}],staticClass:"bottom-btns"},[v("div",{staticClass:"reset",on:{click:h.handleResetParams}},[h._v("\n          "+h._s(h.$t("S_ResetPrompt"))+"\n        ")]),h._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:h.isDefParams,expression:"isDefParams"}],staticClass:"save",on:{click:function(t){return h.handleModifyParams("saveAs")}}},[h._v("\n          "+h._s(h.$t("SaveAs"))+"\n        ")]),h._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:!h.isDefParams,expression:"!isDefParams"}],staticClass:"save",on:{click:function(t){return h.handleModifyParams("save")}}},[h._v("\n          "+h._s(h.$t("Save"))+"\n        ")])]),h._v(" "),v("StyleModal",{ref:"styleModal",attrs:{inTask:!0,modelType:h.styleModalType,selectList:h.styleModalSelectIds,isPaintingBoard:!0,isSDXL:h.isSdModel&&h.isLoRA},on:{selectModel:h.handleSelectModel}}),h._v(" "),v("addOrEditParamsDialog",{ref:"addOrEditParam",on:{updateList:h.getCusDefParams}})],1)])}),[],!1,null,"7c4b4ba0",null).exports);function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var he={model:{prop:"modelvalue",event:"change"},props:{modelvalue:{type:Number,default:0},width:{type:Number,default:120},max:{type:Number,default:180},type:{type:String,default:"hue"},name:{type:String,default:"name"}},watch:{modelvalue:function(t){this.inputVal=t,this.getProgress()}},data:function(){return{isDragging:!1,progress:50,inputVal:this.modelvalue}},mounted:function(){this.inputVal=this.modelvalue,this.getProgress()},methods:{handleChange:function(t){this.inputVal=t||0,this.getProgress(),this.$emit("change",this.inputVal),this.$emit("changeItem",{value:this.inputVal,type:this.type})},startDrag:function(t){this.isDragging=!0,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.endDrag)},onDrag:function(t){if(this.isDragging){var e=this.$refs.adjustRef.getBoundingClientRect().left,n=t.clientX-e,o=parseInt(n/this.width*100);this.progress=o,o<0?this.progress=0:o>100&&(this.progress=100),this.getInputVal()}},endDrag:function(){this.isDragging=!1,this.$emit("change",this.inputVal),this.$emit("changeItem",{value:this.inputVal,type:this.type}),document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.endDrag)},clickDrag:function(t){this.isDragging=!0,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.endDrag),this.onDrag(t)},getInputVal:function(){var progress=this.progress,t=0,e=this.max/50;progress>50&&(t=parseInt((progress-50)*e)),progress<50&&(t=-parseInt((50-progress)*e)),50===progress&&(t=0),this.inputVal=t},getProgress:function(){var t=this.inputVal,e=0,n=this.max/50;if(t>0&&(e=parseInt(50+t/n)),t<0){var o=Math.abs(t);e=parseInt(50-o/n)}0===t&&(e=50),this.progress=e}}},ve=(n(5287),Object(_.a)(he,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"adjust-box flex_m"},[e("div",{staticClass:"left"},[e("span",[t._v(t._s(t.name))])]),t._v(" "),e("div",{staticClass:"center"},[e("div",{ref:"adjustRef",staticClass:"adjust-item",class:[t.type],style:{width:t.width+"px"},on:{mousedown:function(e){return e.preventDefault(),t.clickDrag.apply(null,arguments)}}},[e("div",{staticClass:"target-flag flex",style:{left:t.progress+"%"},on:{selectstart:function(t){t.preventDefault()},mousedown:function(e){return e.preventDefault(),t.startDrag.apply(null,arguments)}}},[e("i",{staticClass:"iconfont icon-a-Vector2900"})])])]),t._v(" "),e("div",{staticClass:"right"},[e("el-input-number",{staticClass:"my-el-input-number",attrs:{value:t.inputVal,min:-t.max,max:t.max,size:"mini"},on:{change:t.handleChange}})],1)])])}),[],!1,null,"8fd2974c",null));function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var me={components:{MyAdjust:ve.exports},data:function(){return{formData:{opacity:0,prompt:"",negative_prompt:"",hue:0,saturation:0,brightness:0},list:[{key:"cfg_scale",label:"CFGScale",value:""},{key:"sampler_name",label:"SamplingMethod",value:""},{key:"steps",label:"Steps",value:""},{key:"RandomSeed",label:"RandomSeed",value:""},{key:"widHeiRatio",label:"imageDimensions",value:""},{key:"denoising_strength",label:"DenoisingStrength",value:""},{key:"art_model_no",label:"Checkpoint",value:"",path:"https://aiart-openresty.dev.seaart.ai/models/detail/",flag:!0},{key:"lora_models",label:"OPS_style",value:"",path:"https://aiart-openresty.dev.seaart.ai/models/detail/",flag:!0}],isShow:!0}},props:{id:{type:[Number,String],default:""},paramsData:{type:Object,default:function(){return{}}},currentIndex:{type:Number,default:0},selectNum:{type:Number,default:0},showCell:{type:Boolean,default:!1}},inject:["top"],watch:{"paramsData.params":function(t){var e=this;if(this.list.forEach((function(t){t.value=""})),this.formData={opacity:0,prompt:"",negative_prompt:"",hue:0,saturation:0,brightness:0},this.selectNum>1){this.list.find((function(t){return"widHeiRatio"===t.key})).value=this.top.selectSize}else{var data={};data=null!=t&&t.meta?fe(fe({},t.meta),{},{art_model_no:t.art_model_no,art_model_ver_no:t.art_model_ver_no,taskId:t.taskId||"",widHeiRatio:this.paramsData.widHeiRatio}):{widHeiRatio:this.paramsData.widHeiRatio},this.isShow=data.taskId,this.formData.opacity=this.paramsData.opacity,this.formData.hue=this.paramsData.hue,this.formData.saturation=this.paramsData.saturation,this.formData.brightness=this.paramsData.brightness,this.formData.prompt=data.prompt,this.formData.negative_prompt=data.negative_prompt;var n=function(t){e.list.forEach((function(e){e.key===t&&(e.value="widHeiRatio"===e.key?data.widHeiRatio:data[t])}))};for(var o in fe(fe({},data),data.meta))n(o)}}},computed:{handleSelect:function(){return 1===this.selectNum},handleSize:function(){return this.selectSize},liveInfo:function(){return this.top.paintingBoardData.liveModel}},methods:{submit:function(){if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});if(this.selectNum>1||!this.paramsData.params.taskId){var t=this.selectNum>1?"canvas_publish_multiple_toast":"canvas_publish_toast";return this.$message.warning(this.$t(t))}this.top.publishPop({width:this.paramsData.realWidth,height:this.paramsData.realHeight,url:this.paramsData.imgSrc,task_id:this.paramsData.params.taskId})},handleOpacity:function(t){var e=this;if(this.top.paintingBoardData.liveModel.show){var n=this.top.paintingBoardData.liveLayerList.find((function(t){return t.active}));this.top.setEleItem({id:n.layerId,type:"liveLayerList",item:{opacity:t}},(function(){P.a.emit("filterColor",fe(fe({},n),{},{opacity:t})),Y.a.add(e.top.paintingBoardData)}))}else this.top.changeData("elementList[".concat(this.currentIndex,"].opacity"),t)},changeFilter:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.top.paintingBoardData.liveModel.show){var n=this.top.paintingBoardData.liveLayerList.find((function(t){return t.active}));this.top.setEleItem({id:n.layerId,type:"liveLayerList",item:Object(l.a)({},e.type,e.value)},(function(){P.a.emit("filterColor",fe(fe({},n),{},Object(l.a)({},e.type,e.value))),Y.a.add(t.top.paintingBoardData)}))}else this.top.changeData("elementList[".concat(this.currentIndex,"].").concat(e.type),e.value)},copyMsg:function(t){Object(_t.g)(this.formData[t]),this.$message.success(this.$t("CopySuccess"))},copyImg:function(){this.top.handleRightMenuClick("copy")},download:function(){this.top.handleRightMenuClick("download")},goPage:function(t){var path="";path="art_model_no"===t.key?t.path+t.value:t.path+(t.model_id||t.id),window.open(path,"_blank")},handleDownload:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.handleDownloadUrl(t);case 2:(o=n.sent).includes("http")?(r=document.getElementById("img-".concat(e.paramsData.layerId)),Object(_t.M)(o,e.paramsData.layerId,null,{target:r})):Object(_t.k)(o,e.paramsData.layerId);case 4:case"end":return n.stop()}}),n)})))()},handleDownloadUrl:function(t){return 100==this.paramsData.opacity?t:new Promise((function(e){var img=new Image;img.crossOrigin="Anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas"),n=canvas.getContext("2d");canvas.width=img.width,canvas.height=img.height,n.drawImage(img,0,0),t=canvas.toDataURL(),e(t)}}))}}},ge=me,_e=(n(5288),Object(_.a)(ge,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"selectParams no-snapshot"},[t.formData.prompt?e("div",{staticClass:"prompt common-bg"},[e("p",{staticClass:"line flex"},[e("span",{staticClass:"label"},[t._v(t._s(t.$t("Prompt")))]),t._v(" "),e("i",{staticClass:"iconfont icon-copy-template",on:{click:function(e){return t.copyMsg("prompt")}}})]),t._v(" "),e("el-input",{staticClass:"my-input",attrs:{type:"textarea",rows:2,disabled:!0},model:{value:t.formData.prompt,callback:function(e){t.$set(t.formData,"prompt",e)},expression:"formData.prompt"}})],1):t._e(),t._v(" "),t.formData.negative_prompt?e("div",{staticClass:"negative-prompt common-bg"},[e("p",{staticClass:"line flex"},[e("span",{staticClass:"label"},[t._v(t._s(t.$t("NegativePrompts")))]),t._v(" "),e("i",{staticClass:"iconfont icon-copy-template",on:{click:function(e){return t.copyMsg("negative_prompt")}}})]),t._v(" "),e("el-input",{staticClass:"my-input",attrs:{type:"textarea",rows:2,disabled:!0},model:{value:t.formData.negative_prompt,callback:function(e){t.$set(t.formData,"negative_prompt",e)},expression:"formData.negative_prompt"}})],1):t._e(),t._v(" "),e("div",{staticClass:"params common-bg"},[e("p",{staticClass:"params-title"},[t._v(t._s(t.$t("Params")))]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:o},[n.value&&"lora_models"!==n.key?e("p",{staticClass:"params-line"},[e("span",{staticClass:"label"},[t._v(" "+t._s(t.$t(n.label))+" ")]),t._v(" "),n.flag?e("span",{staticClass:"line_txt",on:{click:function(e){return t.goPage(n)}}},[t._v(t._s(n.value))]):e("span",{staticClass:"value"},[t._v("\n          "+t._s("widHeiRatio"===n.key&&t.selectNum>1?t.top.selectSize:n.value)+"\n        ")])]):t._e(),t._v(" "),"lora_models"===n.key&&n.value?t._l(n.value,(function(o,r){return e("p",{key:r,staticClass:"params-line"},[e("span",{staticClass:"label"},[t._v(" "+t._s(t.$t(n.label))+" ")]),t._v(" "),e("span",{staticClass:"line_txt",on:{click:function(e){return t.goPage(de(de({},o),{},{path:n.path}),r)}}},[t._v("\n            "+t._s(o.model_id||o.id)+"\n          ")])])})):t._e()],2)}))],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.handleSelect,expression:"handleSelect"}],staticClass:"hsv-bord"},[e("div",{staticClass:"title-name"},[t._v(t._s(t.$t("filterHsv")))]),t._v(" "),e("my-adjust",{attrs:{type:"hue",name:t.$t("hue"),max:180},on:{changeItem:t.changeFilter},model:{value:t.formData.hue,callback:function(e){t.$set(t.formData,"hue",e)},expression:"formData.hue"}}),t._v(" "),e("my-adjust",{attrs:{type:"saturation",name:t.$t("saturation"),max:100},on:{changeItem:t.changeFilter},model:{value:t.formData.saturation,callback:function(e){t.$set(t.formData,"saturation",e)},expression:"formData.saturation"}}),t._v(" "),e("my-adjust",{attrs:{type:"brightness",name:t.$t("brightness"),max:100},on:{changeItem:t.changeFilter},model:{value:t.formData.brightness,callback:function(e){t.$set(t.formData,"brightness",e)},expression:"formData.brightness"}}),t._v(" "),e("div",{staticClass:"sampling-steps common-bg"},[e("div",{staticClass:"top"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("canvas_opacity")))])]),t._v(" "),e("div",{staticClass:"bottom"},[e("el-slider",{attrs:{min:0,max:100,step:1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{change:t.handleOpacity},model:{value:t.formData.opacity,callback:function(e){t.$set(t.formData,"opacity",e)},expression:"formData.opacity"}})],1)])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.liveInfo.show&&!t.showCell,expression:"!liveInfo.show && !showCell"}],staticClass:"footer"},[e("i",{staticClass:"iconfont icon-copy-template copy pointer",on:{click:t.copyImg}}),t._v(" "),e("i",{staticClass:"iconfont icon-icon_xiazai download pointer",on:{click:t.download}}),t._v(" "),e("div",{staticClass:"confirm pointer",on:{click:t.submit}},[e("i",{staticClass:"iconfont icon-share-icon"}),t._v(" "),e("span",[t._v(t._s(t.$t("releaseName")))])])])])}),[],!1,null,"780c2dce",null).exports),be={inject:["top"],data:function(){return{min:20,max:200,step:10}},computed:{zoom:function(){var t=this.top.paintingBoardData.boardInfo.zoom;return parseInt(100*t)}},mounted:function(){var t=this;this.$nextTick((function(){t.initBordPoin()})),this.top.eventFn.initBordPoin=this.initBordPoin},methods:{initBordPoin:function(){var t=this.top.viewerClass,e=this.top.paintingBoardData.boardInfo,n=e.scrollLeft,o=e.scrollTop,r=e.zoom;t.setZoom(r),t.scrollTo(n,o)},handleBackCenter:function(){var t=this.top.viewerClass;if(0===(this.top.paintingBoardData.elementList.filter((function(t){return"imgLayer"===t.type}))||[]).length)return this.changeZoom(100),void t.scrollTo(0,0);var e=this.getViewAxis(),n=e.x,o=e.y,r=e.width,c=e.height,l=e.x2,d=e.y2;console.log("获取视图大容器信息:","x: "+n,"y: "+o,"width: "+r,"height: "+c,"x2: "+l,"y2: "+d),this.setBoardZoom(e),t.scrollTo(n,o)},setBoardZoom:function(t){var e=document.querySelector("#canvas-container").getBoundingClientRect(),n=e.width,o=e.height,r=t.width,c=t.height,l=1;l=(l=1/(l=r/c>1?r/(n-290):c/o))<.2?.2:l,l=10*parseInt(Math.ceil(10*l)),this.changeZoom(l)},getViewAxis:function(){var t=this.top.paintingBoardData.elementList,e=Number.MAX_VALUE,n=Number.MAX_VALUE,o=Number.MIN_VALUE,r=Number.MIN_VALUE;return t.forEach((function(element){var t=element.x,c=element.y,l=element.width,d=element.height;e=Math.min(e,t),n=Math.min(n,c),o=Math.max(o,t+l),r=Math.max(r,c+d)})),{x:e,y:n,width:o-e,height:r-n,x2:o,y2:r}},changeZoom:function(t){var e=this.top.viewerClass;t>this.max||t<this.min||(e.setZoom(t/100),this.top.changeData("boardInfo.zoom",e.getZoom()),this.$emit("onZoom",{val:t,zoom:e.getZoom()}))}}},ye=(n(5289),Object(_.a)(be,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-btn-box flex"},[e("div",{staticClass:"fitin-box flex_c_m",on:{click:function(e){return e.stopPropagation(),t.handleBackCenter.apply(null,arguments)}}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("canvas_self_hover")}},[e("i",{staticClass:"iconfont icon-Union2"})])],1),t._v(" "),e("div",{staticClass:"input-nuber"},[e("el-input-number",{staticClass:"my-input-number",attrs:{value:t.zoom,size:"mini",min:t.min,max:t.max,step:t.step,precision:0},on:{change:t.changeZoom}})],1)])}),[],!1,null,"08b358a0",null)),we=ye.exports,Ce={inject:["top"],data:function(){return{min:20,max:200,step:10,zoomVal:50}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel}},watch:{"liveInfo.zoom":{handler:function(t){t&&this.initBordPoin()}}},mounted:function(){var t=this;this.$nextTick((function(){t.initBordPoin()}))},methods:{initBordPoin:function(){var t=this.liveInfo,e=t.zoom,n=t.scrollLeft,o=t.scrollTop;P.a.emit("getViewerRef",(function(t){t&&(P.a.emit("setHasActiveHistory",!0),t.setZoom(e/100),t.scrollTo(n,o))}))},handleBackCenter:function(){P.a.emit("getViewerRef",(function(t){t.scrollTo(0,0)}))},changeZoom:function(t){t>this.max||t<this.min||(this.top.initLiveLayerActive(),Y.a.add(this.top.paintingBoardData),P.a.emit("liveCreateAiImg"))}}},ke=(n(5290),Object(_.a)(Ce,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"action-btn-box flex"},[e("div",{staticClass:"input-nuber"},[e("el-input-number",{staticClass:"my-input-number",attrs:{size:"mini",min:t.min,max:t.max,step:t.step,precision:0},on:{change:t.changeZoom},model:{value:t.top.paintingBoardData.liveModel.zoom,callback:function(e){t.$set(t.top.paintingBoardData.liveModel,"zoom",e)},expression:"top.paintingBoardData.liveModel.zoom"}})],1)])}),[],!1,null,"2c6098b7",null).exports),Oe={name:"right-params",inject:["top"],data:function(){return{paramsData:{},currentIndex:0,selectNum:0,showCell:!1}},props:{elementList:{type:Array,default:function(){return[]}}},components:{DefParams:le,SelectParams:_e,ZoomPoin:we,ZoomPoinLive:ke},computed:{handleRight:function(){var t=this,e=0,i=0;return this.elementList.forEach((function(n,o){n.active&&(t.paramsData=n,i=o,e++)})),this.currentIndex=i,this.selectNum=e,!(this.elementList.length<=0)&&this.elementList.some((function(t){return!0===t.active}))}},methods:{onZoom:function(t){this.$emit("onZoom",t)},toggleMenuBard:function(t){this.showCell=!t}}},xe=(n(5291),Object(_.a)(Oe,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-bard-box",class:t.showCell&&"hide-bard"},[e("DefParams",{directives:[{name:"show",rawName:"v-show",value:!t.handleRight,expression:"!handleRight"}],attrs:{showCell:t.showCell}}),t._v(" "),e("SelectParams",{directives:[{name:"show",rawName:"v-show",value:t.handleRight,expression:"handleRight"}],attrs:{paramsData:t.paramsData,currentIndex:t.currentIndex,selectNum:t.selectNum,showCell:t.showCell}}),t._v(" "),e("zoom-poin",{directives:[{name:"show",rawName:"v-show",value:!t.top.paintingBoardData.liveModel.show,expression:"!top.paintingBoardData.liveModel.show"}],on:{onZoom:t.onZoom}}),t._v(" "),e("div",{staticClass:"open-btn",on:{click:function(e){return t.toggleMenuBard(t.showCell)}}},[e("i",{class:t.showCell?"el-icon-arrow-left":"el-icon-arrow-right"})])],1)}),[],!1,null,"7b4bb890",null).exports),Ie=(n(69),n(3475)),Se=n(321),De=n(105),Le=(n(72),n(89),n(484),n(73),n(485),n(141),n(142),n(109),n(695)),Pe=n(282);function je(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return $e(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?$e(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,c=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function $e(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}var Te={name:"openPoseEditor",inject:["top"],props:{fromPage:{type:String,default:function(){return""}},uniqueId:{type:[Number,String],default:function(){return Object(ut.uniqueId)("openPoseEditor_")}},imgInfo:{type:Object,default:function(){return{}}},sourceInfo:{type:Object,default:function(){return{}}},openPoseData:{type:Object,default:function(){return{people:[]}}}},data:function(){return{svgId:"vis_".concat(this.uniqueId),PERSON_CONFIG:Le.b,pointIDPairs:Le.e,COLORS:Le.c,DOT_SIZE:6,LOCK_COLOR:"blue",lockPairs:Le.d,DEFAULTGROUPS:{},DEFAULTGROUPTOID:{head:[0,15,16,17,18],rfoot:[11],lfoot:[14],hips:[8,9,12]},lockEngaged:!1,lockId:-1,lockPairId:-1,lockLength:-1,pointData:[],svgRef:null,isDefaultGroup:!1,imgUrl:"",pointColor:"#409EFF",observer:null,debounceUpdate:null}},watch:{"sourceInfo.openPoseData":{handler:function(t){var e;t&&null!=t&&null!==(e=t.people)&&void 0!==e&&e.length},deep:!0}},mounted:function(){this.debounceUpdate=Object(ut.debounce)(this.saveImageUrl,400),"openPoseModal"===this.fromPage&&this.initObserver();var t=this.sourceInfo,e=t.rawWidth,n=t.rawHeight,o=t.width,r=t.height;if(!o&&"openPoseModal"===this.fromPage){var c=this.getImageInfo({rawWidth:e,rawHeight:n});if(o=null==c?void 0:c.width,r=null==c?void 0:c.height,!o)return;this.$emit("updateImageInfo",{width:o,height:r,rawWidth:e,rawHeight:n})}this.svgRef=Pe.c("#".concat(this.svgId)),this.init()},beforeDestroy:function(){this.svgRef=null,this.canvas2=null,this.bgCtx=null,this.observer=null,this.debounceUpdate=null},methods:{initObserver:function(){var t=this,e=this.sourceInfo,n=e.rawWidth,o=e.rawHeight;this.observer=new ResizeObserver((function(e){var r,c=je(e);try{for(c.s();!(r=c.n()).done;){var l=r.value.contentRect,d=l.width,h=l.height;if(0===d||0===h)return;if(!d)return;var v=t.getImageInfo({rawWidth:n,rawHeight:o}),f=null==v?void 0:v.width,m=null==v?void 0:v.height;t.$emit("updateImageInfo",{currentWidth:f,currentHeight:m,rawWidth:n,rawHeight:o}),t.init()}}catch(t){c.e(t)}finally{c.f()}})),this.observer.observe(this.$refs.viewBox)},init:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.pointData=t.loadPointData(),t.setBackground(),t.drawLines(),t.drawPoints(),t.initBgCanvas();case 5:case"end":return e.stop()}}),e)})))()},updatePointDataConfig:function(){var t=this,e=this.top.paintingBoardData.controlNet.controlnet_units.findIndex((function(e){var n;return(null===(n=t.sourceInfo)||void 0===n?void 0:n.id)&&e.id===t.sourceInfo.id})),n=this.sourceInfo,o=n.rawWidth,r=n.rawHeight,c=n.width;n.height;if(!c&&"openPoseModal"===this.fromPage){var l=this.getImageInfo({rawWidth:o,rawHeight:r});c=null==l?void 0:l.width,null==l?void 0:l.height}var d=this.imgInfo.width/this.imgInfo.rawWidth;if(isNaN(d)&&(d=c/o),-1!==e){var data=(this.pointData||[]).map((function(t){return[t.x/d,t.y/d,1]}));data=data.flat()}},getImageInfo:function(t){var e,n,o,r,c=t.rawWidth,l=t.rawHeight,d=document.querySelectorAll(".generation-frame-area-content")[0],h=null===(e=d)||void 0===e?void 0:e.offsetWidth,v=null===(n=d)||void 0===n?void 0:n.offsetHeight;h||(h=(null===(o=window)||void 0===o||null===(o=o.screen)||void 0===o?void 0:o.width)<=1440?470:570,v=(null===(r=window)||void 0===r||null===(r=r.screen)||void 0===r?void 0:r.width)<=1440?400:570);return d=null,this.getContainedSize({width:h,height:v,naturalWidth:c,naturalHeight:l})},getContainedSize:function(img){try{var t=img.naturalWidth/img.naturalHeight,e=img.height*t,n=img.height;return e>img.width&&(e=img.width,n=img.width/t),{width:e,height:n}}catch(t){}},handleGroup:function(){this.isDefaultGroup=!this.isDefaultGroup,this.DEFAULTGROUPS=this.isDefaultGroup?JSON.parse(JSON.stringify(Le.a)):{}},resetOpenPose:function(){this.saveImageUrl()},loadPointData:function(){var t=this.sourceInfo,e=t.rawWidth,n=t.rawHeight,o=t.width,r=t.height,c=this.imgInfo.width/this.imgInfo.rawWidth;if(!o&&"openPoseModal"===this.fromPage){var l=this.getImageInfo({rawWidth:e,rawHeight:n});o=null==l?void 0:l.width,r=null==l?void 0:l.height,this.$emit("updateImageInfo",{width:o,height:r,rawWidth:e,rawHeight:n})}isNaN(c)&&(c=o/e);for(var d=[],h=0,v=0,f=this.sourceInfo.openPoseData,m=(f=JSON.parse(JSON.stringify(f))).people[0].pose_keypoints_2d,i=0;i<m.length/3;i+=1){var _=3*i,y={x:m[_]*c+h,y:m[_+1]*c+v,id:i};d.push(y)}return d},setBackground:function(){var t="openPoseModal"===this.fromPage?"black":"transparent";this.svgRef.append("rect").attr("width","100%").attr("height","100%").attr("fill",t)},drawLines:function(){for(var t=this,e=[],i=0;i<this.pointIDPairs.length;i++){var n,o,r=this.pointIDPairs[i],c=[this.pointData[r[0]],this.pointData[r[1]]],l=0===(null===(n=c[0])||void 0===n?void 0:n.x)&&0===c[0].y,d=0===(null===(o=c[1])||void 0===o?void 0:o.x)&&0===c[1].y||!c[1];l||d||e.push(c)}this.svgRef.selectAll(".lines").data(e,(function(t){return t.id})).join((function(e){return e.append("line").attr("class","lines").attr("stroke",(function(e,i){return t.COLORS[i]})).attr("stroke-width",5).attr("x1",(function(t){return t[0].x})).attr("y1",(function(t){return t[0].y})).attr("x2",(function(t){return t[1].x})).attr("y2",(function(t){return t[1].y}))}))},drawPoints:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this;this.svgRef.selectAll(".points").data(this.pointData,(function(t){return t.id})).join((function(e){e.append("circle").attr("id",(function(t){return"circle_".concat(n.uniqueId)+t.id})).attr("class","points").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",t.DOT_SIZE).style("cursor","pointer").style("fill",n.pointColor).style("display",(function(t){var e="";return null!=t&&t.x||null!=t&&t.y||(e="none"),e})).on("click",(function(t){n.lockEngaged&&(n.lockId!=t.id?(n.lockId=t.id,n.lockLength=n.getLockLength(t.id),Pe.c(this).style("fill",n.LOCK_COLOR)):(Pe.c(this).style("fill",n.pointColor),n.lockId=-1,n.lockLength=-1))})).on("mouseover",(function(t){n.lockEngaged?Pe.c(this).style("fill",n.LOCK_COLOR):Pe.c(this).style("fill",n.COLORS[1])})).on("mouseout",(function(t){Pe.c(this).style("fill",n.pointColor)})).call(Pe.a().on("drag",n.dragCallback)),e.append("text").attr("class",(function(t){return"label"+t.id})).style("text-anchor","middle").style("user-select","none").attr("x",(function(t){return t.x-2*n.DOT_SIZE})).attr("y",(function(t){return t.y-n.DOT_SIZE})).style("stroke","white").style("opacity",0).text((function(t,i){return i}))}),(function(t){n.svgRef.selectAll(".points").attr("cx",(function(t){return!e&&n.updatePointInfo(t),t.x})).attr("cy",(function(t){return!e&&n.updatePointInfo(t),t.y})),n.svgRef.selectAll("text").attr("x",(function(t){return t.x-2*n.DOT_SIZE})).attr("y",(function(t){return t.y-n.DOT_SIZE})),t.raise()})),"function"==typeof this.debounceUpdate&&this.debounceUpdate()},initBgCanvas:function(){var t=this;this.canvas2=this.$refs["canvas_".concat(this.svgId)],this.bgCtx=this.canvas2.getContext("2d"),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height);var element=document.getElementById("".concat(this.svgId)),e=(new XMLSerializer).serializeToString(element),n=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=window.URL||window.webkitURL||window,r=o.createObjectURL(n),img=new Image;img.onload=function(){t.bgCtx.drawImage(img,0,0,t.canvas2.width,t.canvas2.height),t.imgUrl=t.canvas2.toDataURL("image/png",.05),t.updatePoseImage(t.imgUrl||""),o.revokeObjectURL(r),img=null},img.src=r},saveImageUrl:function(){this.initBgCanvas()},updatePoseImage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.top.paintingBoardData.controlNet.controlnet_units.findIndex((function(e){var n;return(null===(n=t.sourceInfo)||void 0===n?void 0:n.id)&&e.id===t.sourceInfo.id}));-1!==n&&this.top.changeData("controlNet.controlnet_units[".concat(n,"].input_image"),e)},updatePointInfo:function(){var t=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pointData.forEach((function(e){e.id===source.id&&(t.$set(e,"x",source.x),t.$set(e,"y",source.y))})),this.updatePointDataConfig()},getLockLength:function(t){return this.lockPairId=this.lockPairs[t],this.euclideanDist(this.pointData[this.lockPairId],this.pointData[t])},euclideanDist:function(a,b){return Math.pow(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2),.5)},dragCallback:function(t){var e=this;Pe.c("#circle_".concat(this.uniqueId)+t.id).attr("cx",(function(t){return e.dragGroupX(t)})).attr("cy",(function(t){return e.dragGroupY(t)})),Pe.c(".label"+t.id).attr("x",(function(t){return t.x-2*e.DOT_SIZE})).attr("y",(function(t){return t.y-e.DOT_SIZE})),e.drawLines(),e.drawPoints()},dragGroupX:function(t){var e=this.getTranslation(t).x;if(t.id in this.DEFAULTGROUPS){var n,o=this.DEFAULTGROUPS[t.id],r=je(this.DEFAULTGROUPTOID[o]);try{for(r.s();!(n=r.n()).done;){var c=n.value;this.pointData[c].x+=e}}catch(t){r.e(t)}finally{r.f()}return Pe.b.x}return t.x+=e,t.x},dragGroupY:function(t){var e=this.getTranslation(t).y;if(t.id in this.DEFAULTGROUPS){var n,o=this.DEFAULTGROUPS[t.id],r=je(this.DEFAULTGROUPTOID[o]);try{for(r.s();!(n=r.n()).done;){var c=n.value;this.pointData[c].y+=e}}catch(t){r.e(t)}finally{r.f()}return Pe.b.y}return t.y+=e,t.y},getTranslation:function(t){if(this.lockEngaged&&this.lockId===t.id){var e=this.pointData[this.lockPairId],n=this.euclideanDist(e,Pe.b),o=this.lockLength/n*(Pe.b.x-e.x)+e.x,r=this.lockLength/n*(Pe.b.y-e.y)+e.y;return{x:o-t.x,y:r-t.y}}return{x:Pe.b.x-t.x,y:Pe.b.y-t.y}}}},Me=Te,Re=(n(5292),Object(_.a)(Me,(function(){var t=this,e=t._self._c;return e("div",{ref:"viewBox",staticClass:"c-open-pose-editor"},[e("div",{staticClass:"open-pose-editor-wrap",style:{width:"".concat(t.imgInfo.width,"px")}},[e("svg",{staticClass:"open-pose-editor-svg",attrs:{id:t.svgId}})]),t._v(" "),e("canvas",{ref:"canvas_".concat(t.svgId),staticStyle:{display:"none"},attrs:{width:t.imgInfo.width,height:t.imgInfo.height}}),t._v(" "),t.imgUrl?e("img",{staticStyle:{display:"none"},attrs:{src:t.imgUrl,alt:""}}):t._e()])}),[],!1,null,"d6e792a4",null).exports),Ae=n(422),Ee=n(294);function Be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ne(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Be(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Fe={name:"generationFrame",inject:["top"],props:["value"],components:{SliderItem:De.default,ControlNetPopup:lt,openPoseEditor:Re},watch:{value:{handler:function(t){this.imgUrl=t.input_image||"",this.rawImgUrl=t.rawImgUrl||""},immediate:!0,deep:!0},list:{handler:function(t){var e;null!=this&&null!==(e=this.userInfo)&&void 0!==e&&e.id&&((t||[]).filter((function(t){return[1,2,"1","2"].includes(t.status)})).map((function(t){return t.id})).length&&this.mockProcessTask())},immediate:!0,deep:!0},userInfo:{handler:function(t){var e=(t||{}).id;!(void 0===e?"":e)&&this.endPoll()},immediate:!0,deep:!0},"top.paintingBoardData.liveModel.show":{handler:function(t){var e=t?34:33;this.UPLOAD=new w.a({type:e})},immediate:!0}},data:function(){return{imgUrl:"",rawImgUrl:"",imgInfo:{width:0,height:0,rawWidth:0,rawHeight:0},isUploading:!1,accept:".jpg,.jpeg,.png,.webp",UPLOAD:new w.a({type:2}),list:[]}},computed:Ne(Ne(Ne({},Object(h.e)("user",["userInfo"])),Object(h.c)("creation",["editBoardControlNetConfig"])),{},{getControlNetMap:function(){var map={};return(this.editBoardControlNetConfig||[]).forEach((function(t){map[t.value]=t})),map},getModelDescribe:function(){var t=this;return function(e){var n,o=t.getControlNetMap[e]?null===(n=t.getControlNetMap[e])||void 0===n?void 0:n.name:"";return t.$t(o)}},isLiveMode:function(){return this.top.paintingBoardData.liveModel.show},showOpenPoseEditor:function(){var t=!1;try{var e,n;t=null===(n=(null===(e=this.value)||void 0===e||null===(e=e.openPoseData)||void 0===e?void 0:e.people)[0])||void 0===n?void 0:n.pose_keypoints_2d.length}catch(e){t=!1}return t}}),beforeCreate:function(){var t=this;this.pollingMiddleware=new Ee.default(2e3,(function(){t.fetchTaskData()}))},beforeDestroy:function(){this.pollingMiddleware&&this.pollingMiddleware.stop(),this.pollingMiddleware=null},methods:{handleDeleteImage:function(){var t=this;this.list=[],this.endPoll(),this.imgUrl="",this.rawImgUrl="",this.isUploading=!1;var e=this.top.paintingBoardData.controlNet.controlnet_units.findIndex((function(e){return e.id===t.value.id}));this.top.changeData("controlNet.controlnet_units[".concat(e,"].input_image"),""),this.top.changeData("controlNet.controlnet_units[".concat(e,"].rawImgUrl"),""),this.top.changeData("controlNet.controlnet_units[".concat(e,"].openPoseData"),{people:{pose_keypoints_2d:[]}});var n=this.top.paintingBoardData.elementList.find((function(e){return(null==e?void 0:e.controlNetId)===t.value.id}));(null==n?void 0:n.layerId)&&this.top.deleteImageLayer(n.layerId)},changeConfig:function(t,e){var n,o=JSON.parse(JSON.stringify(this.value));"activeIndex"!==e?o[e]=t:(o.activeIndex=t,null==this||null===(n=this.top)||void 0===n||n.changeActiveControlNet(t));this.$emit("input",o)},handleChangeOptions:function(){var t=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(JSON.stringify(this.value));if(e){var o;if(n.module!==e.module)n.module=e.module,this.$emit("input",n),n.openPoseData={people:[{pose_keypoints_2d:[]}]},n.input_image="",this.imgUrl="",this.list=[],this.isUploading=!1,this.deleteControlNetLayer(),null!==(o=this.value)&&void 0!==o&&o.rawImgUrl&&(this.isUploading=!0,n.input_image=this.value.rawImgUrl,this.imgUrl=this.value.rawImgUrl,setTimeout((function(){t.handleUploadNext(t.value.rawImgUrl)}),0));n.module=e.module}this.$emit("input",n)},deleteControlNetLayer:function(){var t=this,e=this.top.paintingBoardData.elementList.find((function(e){return(null==e?void 0:e.controlNetId)===t.value.id}));(null==e?void 0:e.layerId)&&this.top.deleteImageLayer(e.layerId)},showControlNetPopup:function(){if(!this.isUploading){var t=JSON.parse(JSON.stringify(this.value));this.$refs.controlNetModal.openModal(t)}},handleBeforeUpload:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=["image/jpeg","image/png","image/jpg","image/webp"],!e.isUploading){n.next=3;break}return n.abrupt("return");case 3:if(o.includes(t.type)){n.next=6;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 6:if(!(r=t)||r.size){n.next=9;break}return n.abrupt("return",!1);case 9:if(!(r.size/1024/1024>5)){n.next=20;break}return n.prev=10,n.next=13,Object(C.a)(r,5242880);case 13:r=n.sent,n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(10),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 20:return n.next=22,e.checkImageSize(t);case 22:if(c=n.sent,e.imgUrl=c.url||"",e.imgInfo.rawWidth=c.realWidth||0,e.imgInfo.rawHeight=c.realHeight||0,e.updateImageUrl(e.imgUrl,c.realWidth,c.realHeight),!e.isUploading){n.next=29;break}return n.abrupt("return");case 29:return e.list=[],e.isUploading=!0,l=e.UPLOAD,d=e.top.paintingBoardData.liveModel.show?34:33,l.startUpload(r,{category:d}).then((function(t){return e.handleUploadNext(t)})).catch((function(t){e.isUploading=!1,e.imgUrl="",e.updateImageUrl("")})),n.abrupt("return",!1);case 35:case"end":return n.stop()}}),n,null,[[10,16]])})))()},addControlNetLayer:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.top.paintingBoardData.controlNet.activeIndex;t=this.value.id===n&&this.isLiveMode,this.top.addLayerItem({type:"controlNetLayer",imgSrc:e,customConfig:{controlNetId:this.value.id,show:t,realWidth:this.imgInfo.rawWidth,realHeight:this.imgInfo.rawHeight}})},handleUploadNext:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.rawImgUrl=e;var n=JSON.parse(JSON.stringify(this.value));n.rawImgUrl=e,this.$emit("input",n);var o=this.getProcessInfo(e),r=this.getControlNetMap[this.value.module]||1;if([2,"2"].includes(null==r?void 0:r.category))return Object(Ae.a)(o).then((function(e){var n=e.data.id||"";t.list.push({status:1,process:0,id:n})})).catch((function(t){}));this.isUploading=!1},getProcessInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e={};return e.image_url=t,e.preprocess_mode=this.value.module,e.mode=this.isLiveMode?2:1,e},updateImageUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=JSON.parse(JSON.stringify(this.value));o.input_image=t||"",o.rawWidth=e||0,o.rawHeight=n||0,t||(o.rawImgUrl="",this.rawImgUrl=""),this.$emit("input",o)},updateControlNetConfig:function(t,e){var n=JSON.parse(JSON.stringify(this.value));n[t]=e,this.$emit("input",n)},checkImageSize:function(t){var e=this;return new Promise((function(n,o){var r=new FileReader;r.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};e.getImageInfo({boxWidth:570,boxHeight:570,rawWidth:img.naturalWidth,rawHeight:img.naturalHeight}),t.url=r.result,n(t)},img.onerror=function(){o(!1)},img.src=t.target.result},r.readAsDataURL(t)}))},getImageInfo:function(t){var e=t.boxWidth,n=t.boxHeight,o=t.rawWidth,r=t.rawHeight,c=this.getContainedSize({width:e,height:n,naturalWidth:o,naturalHeight:r});this.imgInfo.width=c.width,this.imgInfo.height=c.height,this.imgInfo.rawWidth=o,this.imgInfo.rawHeight=r},getContainedSize:function(img){try{var t=img.naturalWidth/img.naturalHeight,e=img.height*t,n=img.height;return e>img.width&&(e=img.width,n=img.width/t),{width:e,height:n}}catch(t){}},mockProcessTask:function(){var t=this.list.filter((function(t){return[1,2,"1","2"].includes(t.status)})).map((function(t){return t.id}));t.length?this.startPoll(t):this.endPoll()},startPoll:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.pollingMiddleware&&this.pollingMiddleware.checkStart(t)},endPoll:function(){this.pollingMiddleware&&this.pollingMiddleware.stop()},fetchTaskData:function(){var t=this.list.filter((function(t){return[1,2,"1","2"].includes(t.status)})).map((function(t){return t.id}));t.length?this.getTaskInfo(t):this.endPoll()},getTaskInfo:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={};return n.task_ids=e,n.scene=1,Object(v.batchFetchTaskProcess)(n).then((function(e){var n=(e&&e.data?e.data:{}).items;((void 0===n?[]:n)||[]).forEach((function(e){if(e&&[3,4].includes(e.status)){var n;if(t.isUploading=!1,[3].includes(e.status))t.imgUrl=(null==e||null===(n=e.img_uris[0])||void 0===n?void 0:n.url)||"",t.updateImageUrl(t.imgUrl,t.imgInfo.rawWidth,t.imgInfo.rawHeight),(null==e?void 0:e.openpose)&&t.handleOpenPoseData((null==e?void 0:e.openpose)||[]);[4].includes(e.status)&&(t.$message.error(t.$t("uploadError")),t.imgUrl="",t.updateImageUrl(""),t.updateControlNetConfig("openPoseData",{people:{pose_keypoints_2d:[]}}))}t.updateData(e,e.task_id)}))}))},handleOpenPoseData:function(source){try{var t,e={people:[{pose_keypoints_2d:(null===(t=JSON.parse(source)[0])||void 0===t?void 0:t.people[0].pose_keypoints_2d)||[]}]};this.updateControlNetConfig("openPoseData",e)}catch(t){console.log(t)}},updateData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.list.forEach((function(o){if(n===o.id){if([4,"4"].includes(e.status)&&0===e.process)return void t.$set(o,"status",e.status);if(![0,100].includes(e.process)&&o.process>=e.process)return void t.$set(o,"status",e.status);t.$set(o,"process",e.process>100?100:e.process),t.$set(o,"status",e.status),t.$set(o,"img_uris",(e.img_uris||[]).filter((function(t){return null==t?void 0:t.url}))),t.$set(o,"openPoseData",(null==e?void 0:e.openpose)||[])}}))},updateImageInfo:function(t){var e=t.width,n=t.height,o=t.rawWidth,r=t.rawHeight;this.imgInfo.width=e,this.imgInfo.height=n,this.imgInfo.rawWidth=o,this.imgInfo.rawHeight=r}}},Ue=Fe,He=(n(5293),Object(_.a)(Ue,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"generation-frame no-snapshot",style:{transform:"translateX(".concat(null!==(t=e.top)&&void 0!==t&&t.paintingBoardData.leftMenu.showLeftDrawer?"340px":"40px",")")}},[n("div",{staticClass:"generation-frame-head"},[n("span",{staticClass:"head-title"},[e._v(e._s(e.$t("ControlNet")))]),e._v(" "),n("span",{staticClass:"el-icon-close head-close-btn",on:{click:function(t){return t.stopPropagation(),e.changeConfig("","activeIndex")}}})]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isUploading,expression:"isUploading"}],staticClass:"generation-frame-area"},[n("div",{staticClass:"generation-frame-area-content"},[n("el-upload",{directives:[{name:"show",rawName:"v-show",value:!e.imgUrl,expression:"!imgUrl"},{name:"loading",rawName:"v-loading",value:e.isUploading,expression:"isUploading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleBeforeUpload,disabled:e.isUploading,accept:e.accept,"http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("div",{staticClass:"upload-box-btn"},[e._v(e._s(e.$t("UploadImg")))])])]),e._v(" "),e.imgUrl?n("img",{directives:[{name:"show",rawName:"v-show",value:![8,"8"].includes(e.value.module)||[8,"8"].includes(e.value.module)&&!e.showOpenPoseEditor,expression:"![8, '8'].includes(value.module) || ([8, '8'].includes(value.module) && !showOpenPoseEditor)"}],staticClass:"generation-frame-area-content-image",attrs:{src:e.imgUrl,alt:""}}):e._e(),e._v(" "),n("div",{staticClass:"image-operate-btn-box"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.imgUrl,expression:"imgUrl"}],staticClass:"image-operate-btn el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleDeleteImage()}}})]),e._v(" "),e.imgUrl&&[8,"8"].includes(e.value.module)&&e.showOpenPoseEditor?n("open-pose-editor",{attrs:{uniqueId:e.value.id,"img-info":e.imgInfo,"source-info":e.value,fromPage:"openPoseModal"},on:{updateImageInfo:e.updateImageInfo}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"generation-frame-bottom"},[n("div",{staticClass:"generation-frame-bottom-item"},[n("div",{staticClass:"option-item-label"},[e._v("\n        "+e._s(e.$t("Type"))+"\n      ")]),e._v(" "),n("div",{staticClass:"option-item-content",on:{click:function(t){return t.stopPropagation(),e.showControlNetPopup.apply(null,arguments)}}},[n("div",{staticClass:"el-selects"},[n("span",[e._v(e._s(e.getModelDescribe(e.value.module)))]),e._v(" "),n("i",{staticClass:"el-icon-arrow-down"})])])]),e._v(" "),n("div",{staticClass:"generation-frame-bottom-item"},[n("slider-item",{attrs:{value:e.value.weight,min:0,max:2,step:.1,label:e.$t("ControlWeight"),tips:e.$t("ControlWeightTips")},on:{change:function(t){return e.changeConfig(t,"weight")}}})],1)]),e._v(" "),n("control-net-popup",{ref:"controlNetModal",on:{inputChange:e.handleChangeOptions}})],1)}),[],!1,null,"3688b877",null)),Ve=He.exports;installComponents(He,{SliderItem:n(105).default});var ze=n(215),We=null,qe={inject:["top"],data:function(){return{}},watch:{"top.paintingBoardData.topNav.tools.brushTool.brushBoard":{handler:function(t){We&&this.setBrushStyle(t)},deep:!0,immediate:!0}},mounted:function(){this.initBoard()},methods:{initBoard:function(){var t=document.querySelector("#boardMaxBox").offsetWidth,e=document.querySelector("#boardMaxBox").offsetHeight;We=new ze.fabric.Canvas("baseCanvasBox",{width:t,height:e});var n=this.top.paintingBoardData.topNav.tools.brushTool.brushBoard;We.isDrawingMode=!0,We.freeDrawingBrush.color=n.color,We.freeDrawingBrush.width=n.wide/10,this.brushToImg(We)},setBrushStyle:function(t){We.freeDrawingBrush.color=t.color,We.freeDrawingBrush.width=t.wide/10},brushToImg:function(canvas){var t,e=this,n=!1;canvas.on("mouse:down",(function(e){n=!0,t=canvas.getPointer(e.e)})),canvas.on("mouse:up",(function(){n=!1;var t=canvas.getObjects().filter((function(t){return t.isType("path")}));if(t.length>0){var o=new ze.fabric.Group(t),r=o.getBoundingRect(),c=document.createElement("canvas");e.top.paintingBoardData.boardInfo.zoom;c.width=r.width,c.height=r.height;var l=c.getContext("2d"),d=-r.left,h=-r.top;l.translate(d,h),o.render(l);var param={type:"brushLayer",imgSrc:c.toDataURL("image/png"),cursorX:r.left,cursorY:r.top};e.top.addLayerItem(param)}setTimeout((function(){canvas.clear()}),500)})),canvas.on("mouse:move",(function(e){if(n){var o=canvas.getPointer(e.e),path=new ze.fabric.Path("M ".concat(t.x," ").concat(t.y," L ").concat(o.x," ").concat(o.y));canvas.add(path),t={x:o.x,y:o.y}}}))}}},Ge=(n(5294),Object(_.a)(qe,(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"board-max-box",attrs:{"data-drag":"no",id:"boardMaxBox"}},[t("canvas",{staticClass:"base-canvas-box",attrs:{"data-drag":"no",id:"baseCanvasBox",width:"100%",height:"100%"}})])}],!1,null,"b2fe0192",null).exports),Ye=n(265);function Ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ke(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xe={inject:["top"],components:{VueMoveable:Ye.a},data:function(){return{}},computed:{liveItemBoxRef:function(){return this.top.paintingBoardData.liveModel.active?this.$refs.liveItemBoxRef:null},isDraggable:function(){var t=!0;return["daubBoard"].includes(this.top.paintingBoardData.topNav.tools.hasAct)&&(t=!1),t},liveItemInfo:function(){return this.top.paintingBoardData.liveModel},isChangeSize:function(){var t=this.liveItemInfo;return t.width+t.height}},mounted:function(){var t=this;this.$nextTick((function(){t.top.liveBoxRef=t.$refs.liveMoveable}))},methods:{resizeStart:function(t){t.setMin([256,256]),t.setMax([1024,1024])},handleDrag:function(t){var e=this.top.paintingBoardData,n=e.liveModel,o=(e.moveing,this.top.paintingBoardData.topNav.tools.hasAct);if("selectEments"===o||"updateArimg"===o){if(this.isDraggable){t.target.style.transform=t.transform;var c=t.translate||[],l=Object(r.a)(c,2),d=l[0],h=l[1];n.x=d,n.y=h,n.moveing=!0}}else t.stop()},dragEnd:function(t){if(this.isDraggable){var e=t.target.getBoundingClientRect();this.changeData(Je(Je({},this.transformInfo),{},{moveing:!1})),this.$emit("onDragEnd",{event:t,boxPoin:e})}},onResize:function(t){var e=t.width,n=t.height;t.target.style.width="".concat(e,"px"),t.target.style.height="".concat(n,"px"),t.target.style.transform=t.drag.transform;var o=Object(r.a)(t.drag.translate,2),c=o[0],l=o[1];this.changeData({width:e,height:n,x:c,y:l})},validZoom:function(t){var e=this.top.paintingBoardData.liveModel,n=e.width,o=e.min,r=e.max,c=o/n,l=r/n;return console.log(t,l,r,n),t<c?c:t>l?l:t},changeData:function(t){var e=this.top.paintingBoardData.liveModel;Object.keys(t).forEach((function(n){e[n]=t[n]}))}}};n(5295);function Qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var Ze={components:{LiveMove:Object(_.a)(Xe,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"live-max bel-item"},[e("div",{ref:"liveItemBoxRef",staticClass:"live-item-box bel-item",style:{zIndex:-999999},attrs:{id:"liveItemBox"}},[t._t("default")],2),t._v(" "),e("vue-moveable",{ref:"liveMoveable",attrs:{target:t.liveItemBoxRef,resizable:!0,draggable:t.isDraggable,origin:!1,keepRatio:!1,snappable:!0},on:{dragEnd:t.dragEnd,drag:t.handleDrag,resize:t.onResize,resizeStart:t.resizeStart}})],1)}),[],!1,null,null,null).exports},inject:["top"],props:{isPauseLiveGenerate:{type:Boolean,default:!1}},data:function(){return{oldVal:{elementList:[],liveModel:{}},oldParams:{}}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},watchInfo:function(){var t=this.top.paintingBoardData,e=t.liveModel,n=t.elementList;return{liveModel:{x:e.x,y:e.y,width:e.width,height:e.height,show:e.show,moveing:e.moveing},elementList:n.map((function(t){return{x:t.x,y:t.y,z:t.z,width:t.width,height:t.height,layerId:t.layerId,moveing:t.moveing}}))}},inverseStyle:function(){var t=this.liveInfo,e=t.zoom,n=t.width,o=t.height,c=e.split(","),l=Object(r.a)(c,2),d=l[0],h=l[1];return{right:(1-(d=Number(d)))*n+"px",top:-((1-(h=Number(h)))*o/2)+"px",width:(d>1?n*d:n)+"px"}},watchParams:function(){var t=this.top.paintingBoardData;return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qe(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({basicParams:t.basicParams},t.currentParams)}},watch:{watchInfo:{handler:function(t){this.watchLive(t)},deep:!0},watchParams:{handler:function(t){this.paramsChange(t)},deep:!0}},methods:{paramsChange:function(t){var e,n=this.isWhite(),o=this.getChangeType(t),r=this.top.paramsLoading,c=n&&"default"===o||!n&&"live"===o;this.oldParams=JSON.parse(JSON.stringify(t)),null!==(e=this.liveInfo)&&void 0!==e&&e.show&&(!c&&""!==o||r||this.cutImg())},getChangeType:function(t){var e=t.samplerSettingsDefault,n=t.samplerSettingsLive,o=this.oldParams||{},r=o.samplerSettingsDefault,c=o.samplerSettingsLive;return c?JSON.stringify(e)!==JSON.stringify(r)?"default":JSON.stringify(n)!==JSON.stringify(c)?"live":"":"first"},watchLive:function(t,e){if(!this.isPauseLiveGenerate){var n=this.getIsDetecte(t),o=this.isMoveing(),r=this.isWhite(),c=this.top.paintingBoardData,l=c.liveModel,d=c.elementList;if(e&&d.length)return this.cutImg();n&&!o&&d.length?this.cutImg():r&&!l.loading&&(l.result="",l.prompt=""),this.oldVal=JSON.parse(JSON.stringify(t))}},isWhite:function(){var t=this,e=this.top.paintingBoardData,n=e.liveModel;return e.elementList.every((function(e){return!t.isColliding(n,e)}))},isMoveing:function(){var t=this.top.paintingBoardData,e=t.liveModel;return t.elementList.some((function(t){return t.moveing}))||e.moveing},getActive:function(){var t=this.top.paintingBoardData,e=t.liveModel,n=t.elementList;e.active||(e.active=!0,n.forEach((function(t){t.active=!1})))},getIsDetecte:function(t){var e=this,n=t.elementList,o=t.liveModel,r=this.oldVal,c=r.elementList,l=r.liveModel;if(null==c||!c.length||null==o||!o.show||(null==c?void 0:c.length)>(null==n?void 0:n.length))return!1;var d=this.compareInfo(o,l),h=n.find((function(t,i){return e.compareInfo(t,c[i])})),v=d?o:h;return this.detecteChange(v)},compareInfo:function(t,e){return!(!t||!e)&&Object.keys(t).some((function(n){return t[n]!==e[n]}))},cutImg:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,v,f,m,_,y,canvas,w,C,k,O,x,I,S,D;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPauseLiveGenerate){e.next=2;break}return e.abrupt("return");case 2:if(o=t.top.paintingBoardData,r=o.liveModel,c=o.elementList,l=document.querySelector("#liveItemBox").getBoundingClientRect(),d=l.x,h=l.y,v=l.width,f=l.height,!r.loading){e.next=7;break}return e.abrupt("return");case 7:return r.loading=!0,e.prev=8,e.next=11,Object(ht.a)({tagArea:{x:d,y:h,width:v,height:f},upload:!1});case 11:if(!(m=e.sent)){e.next=16;break}return e.next=15,Object(ht.d)(m,r,!0);case 15:m=e.sent;case 16:r.cutUrl=m,console.log("截图上传成功~！时间： "+(new Date).getTime()),e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(8),r.loading=!1,e.abrupt("return");case 24:if(!(_=null===(n=t.top.paintingBoardData.liveModel)||void 0===n?void 0:n.productLayerId)){e.next=44;break}if(!(y=c.find((function(t){return t.layerId===_})))||!t.isColliding(y,r)){e.next=42;break}return canvas=document.querySelector("#".concat(_)),w=canvas.getBoundingClientRect(),C=w.width,k=w.height,O=w.x,x=w.y,I=O-d,S=x-h,r.mask=Object(ht.f)({width:v,height:f,b_w:C,b_h:k,b_x:I,b_y:S}),e.prev=33,e.next=36,Object(ht.s)(canvas.toDataURL());case 36:D=e.sent,r.product_image_url=D||"",e.next=42;break;case 40:e.prev=40,e.t1=e.catch(33);case 42:e.next=45;break;case 44:r.product_image_url="";case 45:t.top.generateTask("live",t.liveInfo);case 46:case"end":return e.stop()}}),e,null,[[8,20],[33,40]])})))()},detecteChange:function(t){var e=this;if(!t)return!1;var n=this.top.paintingBoardData.elementList,o=!1;return(o=t.layerId?this.isColliding(this.liveInfo,t):n.some((function(n){return e.isColliding(t,n)})))||this.initLiveView(),o},initLiveView:function(){var t=this.top.paintingBoardData.liveModel;t.cutUrl="",t.loading=!1},isColliding:function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y},changeSize:function(t,e){var n=t/this.liveInfo[e],o="width"===e?0:1,r=this.top.paintingBoardData.liveModel.zoom.split(",");r[o]=n,this.top.paintingBoardData.liveModel.zoom=r.toString()}}},ti=Ze,ei=(n(5296),Object(_.a)(ti,(function(){var t=this._self._c;return t("live-move",{ref:"liveMove"},[t("div",{staticClass:"live-panel",on:{click:this.getActive}},[t("div",{staticClass:"live-win",attrs:{"data-drag":"no"}})])])}),[],!1,null,"7b45af08",null).exports),ii={inject:["top"],data:function(){return{leftX:0,topY:0,width:"",list:[],size:"1024x1024"}},mounted:function(){this.top.eventFn.layerBtnsSetPoin=this.setPoin},computed:{isShow:function(){return this.top.paintingBoardData.elementList.some((function(t){return t.active}))},getActiveList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.active}))||[]},isShowClip:function(){return 1===this.getActiveList.length&&this.getActiveList[0].cropping}},methods:{handleEvent:function(t,e){"del"===t&&(this.leftX=0,this.topY=0),this.$emit("topBtnsClick",t,e)},setPoin:function(data){var t=this,e=this.top.paintingBoardData,n=(e.elementList,e.boardInfo.zoom);if(0===this.getActiveList.length)return this.leftX=0,void(this.topY=0);if(this.getActiveList.length>1)this.list=[{icon:"icon-icon_xiazai",type:"download",hoverTips:"Download"},{icon:"icon-icon_tushengtu",type:"imgToImg",hoverTips:"canvas_send_hover",size:"20px"},{icon:"icon-shanchu1",type:"del",hoverTips:"canvas_delete_hover"},{icon:"icon-icon_more",type:"more",hoverTips:""}],setTimeout((function(){var e=document.querySelector(".moveable-area").getBoundingClientRect();t.leftX=e.left,t.topY=e.top-50,t.top.handleSelectSize(parseInt(e.width/n),parseInt(e.height/n),"multiple")}),100),this.size="";else{var o=Object(r.a)(this.getActiveList,1)[0],c=document.querySelector("#img-"+o.layerId).getBoundingClientRect();this.list=[{icon:"icon-icon_xiazai",type:"download",hoverTips:"Download",size:"14px"},{icon:"icon-icon_qubeijing",type:"removeBg",hoverTips:"ai_tools_2"},{icon:"icon-icon_tushengtu",type:"imgToImg",hoverTips:"canvas_send_hover",size:"20px"},{icon:"icon-icon_caiqie",type:"clip",hoverTips:"canvas_tailor_hover"},{icon:"icon-shanchu1",type:"del",hoverTips:"canvas_delete_hover",size:"17px"},{icon:"icon-icon_more",type:"more",hoverTips:"",size:"14px"}],this.leftX=c.left,this.width=c.width,this.size=parseInt(c.width/n)+"x"+parseInt(c.height/n),this.top.handleSelectSize(parseInt(c.width/n),parseInt(c.height/n)),this.topY=c.top-50}},hideBtn:function(){this.leftX=0,this.topY=0},handleClipDone:function(){var t=this.getActiveList[0].layerId,e=document.querySelector("#img-".concat(t));this.getActiveList[0].clipPath=e.style.clipPath,this.getActiveList[0].cropping=!1}}},ni=(n(5297),Object(_.a)(ii,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"top-menu no-snapshot",class:t.width<290&&"no-sizetext",style:{top:t.topY+"px",left:t.leftX+"px",width:t.width+"px"},attrs:{id:"layerBtnsId","data-size":t.size}},[t.isShowClip?e("div",{staticClass:"clip-box"},[t._m(0),t._v(" "),e("div",{staticClass:"right",on:{click:t.handleClipDone}},[t._v(t._s(t.$t("Done")))])]):e("div",{staticClass:"top-action-nav"},[e("div",{staticClass:"action-list flex"},t._l(t.list,(function(n){return e("div",{key:n.icon,staticClass:"item flex_c_m",class:"top-btn-".concat(n.type),on:{click:function(e){return t.handleEvent(n.type,e)}}},[e("el-tooltip",{attrs:{effect:"dark",disabled:!n.hoverTips,content:t.$t(n.hoverTips),placement:"bottom"}},[e("i",{staticClass:"iconfont",class:n.icon,style:{fontSize:n.size}})])],1)})),0)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"left"},[t("i",{staticClass:"iconfont icon-icon_caiqie"})])}],!1,null,"a3a7ecac",null).exports),ai={inject:["top"],data:function(){return{title:"",leftX:-500,topY:-500,leftX1:-500,topY1:-500,zoomWidth:256,showSize:!1}},watch:{sizeInfo:{handler:function(t){this.initPoin()},deep:!0},"top.paintingBoardData.imageToImage.imgUrl":function(){this.setTitle()}},computed:{screenshotInfo:function(){var t;return(null===(t=this.top.paintingBoardData)||void 0===t?void 0:t.generateInfo)||{}},width:function(){var t;return(null===(t=this.screenshotInfo)||void 0===t?void 0:t.width)||256},height:function(){var t;return(null===(t=this.screenshotInfo)||void 0===t?void 0:t.height)||256},sizeInfo:function(){var t=this.screenshotInfo;return{width:t.width,height:t.height,x:t.x,y:t.y,zoom:this.top.paintingBoardData.boardInfo.zoom}}},mounted:function(){this.initPoin(),this.setTitle()},methods:{inputFocus:function(){this.top.paintingBoardData.elementList.forEach((function(t){return t.active=!1}))},changePrompt:function(t){this.top.paintingBoardData.generateInfo.prompt=t},initPoin:function(){var t=document.querySelector("#aiimgItemBoxId");if(t){var e=t.getBoundingClientRect();this.leftX=e.left-70,this.topY=e.top+e.height-30,this.zoomWidth=e.width,this.initTitlePoin(),this.setTitle()}},initTitlePoin:function(){var t=document.querySelector("#aiimgItemBoxId");if(t){var e=t.getBoundingClientRect(),n=e.left,o=e.top;this.leftX1=n-70,this.topY1=o-82,this.showSize=!1}},changSizeW:function(t){var e=document.querySelector("#aiimgItemBoxId"),n=this.top.paintingBoardData.generateInfo,o=t||256;e.style.width=o+"px",this.top.aiimgBoxRef.updateRect(),n.width=o},changSizeH:function(t){var e=this.top.paintingBoardData.generateInfo,n=t||256;document.querySelector("#aiimgItemBoxId").style.height=n+"px",this.top.aiimgBoxRef.updateRect(),e.height=n},setTitle:function(){var title=this.getTitle();this.title=title||this.$t("Txt2Img")},getTitle:function(){var t=this.top.paintingBoardData,e=t.elementList,n=t.imageToImage.imgUrl,o=this.isColliding(e);o=0===o&&n?3:o,this.top.updateAiImgStatus(o);var r=[2,1].includes(o);return this.top.eventFn.controlNetDisable&&this.top.eventFn.controlNetDisable(r),this.$t(["Txt2Img","Expansion","PartialRedrawing","ImgToImg"][o])},isColliding:function(t){var e=document.querySelector("#aiimgItemBoxId");if(!e)return 0;var n=e.getBoundingClientRect(),o=n.left,r=n.top,c=n.right,l=n.bottom,d=0;return t.forEach((function(t){var e=document.querySelector('[data-id="'+t.layerId+'"]'),n=(null==e?void 0:e.getBoundingClientRect())||{},h=n.left,v=n.top,f=n.right,m=n.bottom;d=(f<o||h>c||m<r||v>l)&&0===d?0:h<=o&&v<=r&&f>=c&&m>=l||2===d?2:1})),d},aiHtmlImg:function(t){if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});P.a.emit("$E_updateAiBoxSize"),this.$emit("onSubmit",t)}}},si=(n(5298),Object(_.a)(ai,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"prompt-panel"},[n("div",{staticClass:"edit-content",style:{top:e.topY+"px",left:e.leftX+"px"},attrs:{id:"aiImageTipsId"}},[n("div",{staticClass:"btn-input",attrs:{"data-drag":"no"}},[n("el-input",{attrs:{"data-drag":"no",type:"textarea",resize:"none",value:null===(t=e.screenshotInfo)||void 0===t?void 0:t.prompt},on:{focus:e.inputFocus,input:e.changePrompt},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.aiHtmlImg.apply(null,arguments))}}})],1),e._v(" "),n("div",{staticClass:"btn-box flex_m",attrs:{"data-drag":"no"}},[e.screenshotInfo.loading?n("el-button",{staticClass:"btn-item cancel-btn",attrs:{"data-drag":"no",size:"small",type:"primary"},on:{click:function(t){return e.aiHtmlImg("cancel")}}},[n("span",{attrs:{"data-drag":"no"}},[e._v(e._s(e.$t("Cancel")))])]):n("el-button",{staticClass:"btn-item",attrs:{"data-drag":"no",size:"small",type:"primary",loading:e.screenshotInfo.loading},on:{click:e.aiHtmlImg}},[n("span",{attrs:{"data-drag":"no"}},[e._v(e._s(e.title))])])],1)]),e._v(" "),n("div",{staticClass:"aibox-title-info flex",style:{top:e.topY1+"px",left:e.leftX1+"px",width:e.zoomWidth+"px"},attrs:{id:"aiboxTitleId"}},[n("div",{staticClass:"left"},[n("span",[e._v(e._s(e.title))])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.zoomWidth>160,expression:"zoomWidth > 160"}],staticClass:"right"},[e.showSize?e._e():n("span",{on:{click:function(t){e.showSize=!0}}},[e._v(e._s(parseInt(e.width))+"x"+e._s(parseInt(e.height)))]),e._v(" "),e.showSize?n("div",[n("el-input-number",{staticClass:"my-el-input-number",attrs:{value:parseInt(e.width),min:256,max:1024},on:{change:e.changSizeW}}),e._v(" "),n("span",[e._v("x")]),e._v(" "),n("el-input-number",{staticClass:"my-el-input-number",attrs:{value:parseInt(e.height),min:256,max:1024},on:{change:e.changSizeH}})],1):e._e()])])])}),[],!1,null,"96b43380",null)),oi=si.exports,ri={inject:["top"],data:function(){return{tipsVal:"",leftX:-500,topY:-500,currentItem:{}}},watch:{"top.paintingBoardData.boardInfo.zoom":{handler:function(){this.setPositionBox()}},"top.paintingBoardData.liveModel.show":{handler:function(t){t&&(this.leftX=-500,this.topY=-500)}}},mounted:function(){this.top.setLayerFooterRef(this)},methods:{setPositionBox:function(){var t=this.top.paintingBoardData.elementList.find((function(t){return t.hasDrawLine||t.hasRedraw}));if(!t)return this.leftX=-500,void(this.topY=-500);this.currentItem=t;var e=this.currentItem,n=document.querySelector("#img-"+e.layerId).getBoundingClientRect();this.leftX=n.left-70,this.topY=n.top+n.height-30},tipsSubmit:function(){this.$emit("onSubmit",this.tipsVal)}}},ci=(n(5299),Object(_.a)(ri,(function(){var t=this,e=t._self._c;return e("div",{ref:"layerFooterRef",staticClass:"edit-content no-snapshot",style:{top:t.topY+"px",left:t.leftX+"px"}},[e("div",{staticClass:"btn-input",attrs:{"data-drag":"no"}},[e("el-input",{attrs:{"data-drag":"no",type:"textarea",resize:"none"},model:{value:t.tipsVal,callback:function(e){t.tipsVal=e},expression:"tipsVal"}})],1),t._v(" "),e("div",{staticClass:"btn-box flex_m",attrs:{"data-drag":"no"}},[e("el-button",{staticClass:"btn-item",attrs:{"data-drag":"no",size:"small",type:"primary",loading:t.currentItem.loading},on:{click:t.tipsSubmit}},[e("span",{attrs:{"data-drag":"no"}},[t._v(t._s(t.$t("Submit")))])])],1)])}),[],!1,null,"c11fd762",null).exports);function ui(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function di(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ui(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var hi=n(5300),vi={components:{VueMoveable:Ye.a},props:{moveConfig:{type:Object,default:function(){return hi.a}}},data:function(){return{targetRef:null}},mounted:function(){this.targetRef=this.$refs.targetRef},methods:{handClick:function(){this.$emit("onClick",this.targetRef)},handDragStart:function(){this.$emit("onDragStart",this.targetRef)},handleDrag:function(t){var e=t.target,n=t.transform;e.style.transform=n},handleResize:function(t){var e=t.target,n=t.width,o=t.height,r=t.delta;r[0]&&(e.style.width="".concat(n,"px")),r[1]&&(e.style.height="".concat(o,"px"))},handleScale:function(t){var e=t.target,n=t.transform;t.scale;e.style.transform=n},handleRotate:function(t){var e=t.target,n=(t.dist,t.transform);e.style.transform=n},handleWarp:function(t){var e=t.target,n=t.transform;e.style.transform=n},handlePinch:function(t){t.target}}},pi=(n(5301),Object(_.a)(vi,(function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"targetRef",staticClass:"item-box"},[t._t("default")],2),t._v(" "),e("vue-moveable",t._b({attrs:{target:t.targetRef},on:{click:t.handClick,drag:t.handleDrag,dragStart:t.handDragStart,resize:t.handleResize,scale:t.handleScale,rotate:t.handleRotate,warp:t.handleWarp,pinch:t.handlePinch}},"vue-moveable",di(di({},t.moveConfig),t.$attrs),!1))],1)}),[],!1,null,null,null).exports);function fi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function mi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fi(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var gi={inject:["top"],props:{targets:{type:Array,default:function(){return[]}},selectoRef:{type:Object,default:function(){return{}}}},data:function(){return{moveableRef:null,draggable:!0,scalable:!0,rotatable:!0,resizable:!1,keepRatio:!1,clipRelative:!1,clipArea:!1,borderW:1,renderDirections:["nw","n","ne","w","e","sw","s","se"],translateInfo:{x:0,y:0},timer:null}},watch:{"top.paintingBoardData.boardInfo.zoom":{handler:function(t){var e=1/t;this.borderW=e},immediate:!0}},components:{VueSelecto:Se.a,VueMoveable:Ye.a},mounted:function(){this.moveableRef=this.$refs.moveableRef,this.top.moveableRef=this.$refs.moveableRef},computed:{getActiveList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.active}))||[]},clippable:function(){var t=Object(r.a)(this.getActiveList,1)[0],e=void 0===t?{}:t;return 1==this.getActiveList.length&&(this.keepRatio=!1,e.cropping)},warpable:function(){var t=Object(r.a)(this.getActiveList,1)[0],e=void 0===t?{}:t;return 1==this.getActiveList.length&&(this.scalable=!e.freeDeformation,e.freeDeformation)}},methods:{onClickGroup:function(t){this.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText})),this.$emit("renderGroup",t)},renderGroupEnd:function(t){var e=this,n=this.top.paintingBoardData.boardInfo.zoom;t.events.forEach((function(t){var o=t.target.getAttribute("data-id"),r=document.querySelector("#"+o).getBoundingClientRect(),c=t.transformObject,l=c.translate,d=c.scale,h=void 0===d?[1,1,1]:d,v=Object(ht.r)(t.transform).rotate,f=parseInt(r.width/n),m=parseInt(r.height/n),_={x:l[0],y:l[1],zoom:h,rotate:v,renderWidth:f,renderHeight:m};e.changeData(_,o)})),this.$emit("actionEnd",t)},onRender:function(t){t.target.style.cssText+=t.cssText},onScale:function(t){var e=this,n=Object(r.a)(t.drag.translate,2);n[0],n[1];t.target.style.transform=t.drag.transform;t.target.getAttribute("data-id");var o=t.scale||[];Object(r.a)(o,1)[0];this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){clearTimeout(e.timer),e.timer=null}),300),this.$emit("scale",t)},onResize:function(t){var e=t.target.getAttribute("data-id"),n=this.top.paintingBoardData.elementList,o=n.findIndex((function(em){return em.layerId===e}));this.top.changeData("elementList[".concat(o,"]"),mi(mi({},n[o]),{},{width:t.width,height:t.height}))},onRotate:function(t){t.target.style.transform=t.drag.transform},onRotateEnd:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=t.lastEvent.rotate;this.changeData({rotate:n},e)}},scaleStart:function(t){var e=t.direction.join("");this.keepRatio=["-1-1","1-1","11","-11"].includes(e);var n=t.target.getAttribute("data-id");this.top.getEleInfo(n,"lock")&&t.stop()},scaleGroupStart:function(t){var e=t.direction.join(""),n=this.targets.length>1;this.keepRatio=["-1-1","1-1","11","-11"].includes(e)&&n},scaleEnd:function(t){if(t.lastEvent){var e=this.top.paintingBoardData.boardInfo.zoom,n=t.lastEvent.scale||[],o=t.target.getAttribute("data-id"),r=document.querySelector("#"+o).getBoundingClientRect(),c=parseInt(r.width/e),l=parseInt(r.height/e),d={x:t.clientX,y:t.clientY,renderWidth:c,renderHeight:l,zoom:n};this.changeData(d,o),this.$emit("actionEnd",t)}},rotateStart:function(t){var e=t.target.getAttribute("data-id");this.top.getEleInfo(e,"lock")&&t.stop()},dragStart:function(t){if(t.target){var e=t.target.getAttribute("data-id");this.top.getEleInfo(e,"lock")&&t.stop()}},dragMove:function(t){this.$emit("drag",t)},clickItem:function(t){},dragEnd:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(r.a)(t.lastEvent.translate,2),o=n[0],c=void 0===o?0:o,l=n[1],d=void 0===l?0:l;this.changeData({x:c,y:d},e),this.$emit("actionEnd",t)}},warpEnd:function(t){var e=t.target.style.transform.match(/matrix3d\((.*?)\)/),n="";e&&e.length>1&&(n=e[1]);var o=t.target.getAttribute("data-id");this.changeData({x:t.clientX,y:t.clientY,matrix3d:n},o)},changeData:function(t,e){var n=this.top.paintingBoardData.elementList,o=n.findIndex((function(em){return em.layerId===e})),r=JSON.parse(JSON.stringify(n[o]));r=mi(mi({},r),t),this.top.changeData("elementList[".concat(o,"]"),r)}}},_i=Object(_.a)(gi,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"move-box bel-item"},[e("vue-moveable",{ref:"moveableRef",attrs:{target:t.targets,draggable:t.draggable,rotatable:t.rotatable,origin:!1,resizable:t.resizable,keepRatio:t.keepRatio,scalable:t.scalable,checkInput:!0,clippable:t.clippable,clipRelative:t.clipRelative,clipArea:t.clipArea,warpable:t.warpable,renderDirections:t.renderDirections,rotationPosition:"bottom",zoom:t.borderW},on:{dragStart:t.dragStart,scaleStart:t.scaleStart,scale:t.onScale,scaleEnd:t.scaleEnd,scaleGroupStart:t.scaleGroupStart,rotateStart:t.rotateStart,drag:t.dragMove,dragEnd:t.dragEnd,clickGroup:t.onClickGroup,render:t.onRender,renderGroup:t.onRenderGroup,renderGroupEnd:t.renderGroupEnd,rotate:t.onRotate,rotateEnd:t.onRotateEnd,resize:t.onResize,click:t.clickItem,warpEnd:t.warpEnd}}),t._v(" "),t._t("default")],2)}),[],!1,null,"6ba1cea1",null).exports,bi={data:function(){return{itemList:[{actItem:!1}],actIndex:-1}},components:{MoveItem:pi,Selecto:Se.a},methods:{handClick:function(t,e){this.actIndex=e,this.itemList.forEach((function(t){return t.actItem=!1})),t.actItem=this.actIndex===e}}},yi=Object(_.a)(bi,(function(){var t=this,e=t._self._c;return e("div",t._l(t.itemList,(function(n,o){return e("move-item",{key:o,attrs:{scalable:n.actItem,rotatable:n.actItem},on:{onDragStart:function(e){return t.handClick(n,o)}}},[e("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg"}})],1)})),1)}),[],!1,null,"602ab33b",null).exports,wi={components:{Moveable:Ye.a,Selecto:Se.a},data:function(){for(var t=[],i=0;i<30;++i)t.push(i);return{hitRate:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"],ratio:0,cubes:t,targets:[],moveableRef:null,selectoRef:null}},methods:{onClickGroup:function(t){this.$refs.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},onRender:function(t){t.target.style.cssText+=t.cssText},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText}))},onDragStart:function(t){var e=t.inputEvent.target;(this.$refs.moveableRef.isMoveableElement(e)||this.targets.some((function(t){return t===e||t.contains(e)})))&&t.stop()},onSelectEnd:function(t){this.targets=t.selected}},mounted:function(){this.moveableRef=this.$refs.moveableRef,this.selectoRef=this.$refs.selectoRef}},Ci=(n(5302),{data:function(){return{selectoRef:null,moveableRef:null,targets:[]}},components:{MoveItem:pi,MoveItems:_i,GroupMoveItem:yi,demo:Object(_.a)(wi,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"group-select-box moveable app"},[e("Moveable",{ref:"moveableRef",attrs:{target:t.targets,draggable:!0},on:{clickGroup:t.onClickGroup,render:t.onRender,renderGroup:t.onRenderGroup}}),t._v(" "),e("Selecto",{ref:"selectoRef",attrs:{dragContainer:".elements",selectableTargets:[".target"],hitRate:t.hitRate,selectByClick:t.selectByClick,selectFromInside:t.selectFromInside,toggleContinueSelect:t.toggleContinueSelect,ratio:t.ratio,keyContainer:t.window},on:{dragStart:t.onDragStart,selectEnd:t.onSelectEnd}}),t._v(" "),e("div",{staticClass:"elements selecto-area"},t._l(t.cubes,(function(i){return e("div",{key:i,staticClass:"cube target"})})),0),t._v(" "),e("div",{staticClass:"empty elements"})],1)}),[],!1,null,"e09722d8",null).exports,VueSelecto:Se.a,VueMoveable:Ye.a},mounted:function(){this.moveableRef=this.$refs.moveableRef,this.selectoRef=this.$refs.selectoRef},methods:{onDragStart:function(t){var e=t.inputEvent.target,n=this.$refs.moveableRef.isMoveableElement(e),o=this.targets.some((function(t){return t===e||t.contains(e)}));(n||o)&&t.stop()},onSelectEnd:function(t){this.targets=t.selected},onSelect:function(t){},onClickGroup:function(t){this.$refs.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},onRender:function(t){t.target.style.cssText+=t.cssText},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText}))}}}),ki=(n(5303),Object(_.a)(Ci,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"move-box"},[e("vue-selecto",{ref:"selectoRef",attrs:{dragContainer:".move-container",selectableTargets:[".move-item"],hitRate:0},on:{dragStart:t.onDragStart,selectEnd:t.onSelectEnd,select:t.onSelect}}),t._v(" "),e("vue-moveable",{ref:"moveableRef",attrs:{target:t.targets,draggable:!0,scalable:!0,rotatable:!0,origin:!1,keepRatio:!0},on:{clickGroup:t.onClickGroup,render:t.onRender,renderGroup:t.onRenderGroup}}),t._v(" "),t._m(0)],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"move-container flex_c_m"},[e("div",{staticClass:"move-item"},[t._v("1")]),t._v(" "),e("div",{staticClass:"move-item"},[t._v("2")]),t._v(" "),e("div",{staticClass:"move-item"},[t._v("3")]),t._v(" "),e("div",{staticClass:"move-item"},[t._v("4")]),t._v(" "),e("div",{staticClass:"move-item"},[t._v("5")])])}],!1,null,"4a1dd861",null).exports);function Oi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oi(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ii={inject:["top"],props:{item:{type:Object,default:function(){return{}}}},data:function(){return{brushCanvas:null}},mounted:function(){var t=this,e=this.item;this.$nextTick((function(){t.initBoard(e)}))},watch:{"top.paintingBoardData.topNav.tools":{handler:function(){this.brushCanvas?this.brushDraw():this.initBoard(this.item)},deep:!0}},methods:{initBoard:function(t){this.brushCanvas=new ze.fabric.Canvas("mack-"+t.layerId,{width:t.width,height:t.height,selectable:!1,evented:!1}),this.brushDraw()},brushDraw:function(){var t=this,e=this.top.paintingBoardData.topNav.tools,n=e.brushTool.brushImg,o=("brush"===n.hasAct&&e.hasAct,this.brushCanvas);if("brushImg"===e.hasAct){var r="source-over";o.freeDrawingBrush.color=n.color,o.freeDrawingBrush.width=n.wide/10,o.isDrawingMode=!0,"brush"===n.hasAct?(r="source-over",o.freeDrawingBrush.globalCompositeOperation=r):(r="destination-out",o.freeDrawingBrush.color="#000",o.freeDrawingBrush.globalCompositeOperation=r),o.on("path:created",(function(e){var n=null,c=t.top.paintingBoardData.elementList.map((function(em,e){return em.layerId===t.item.layerId&&(n=e),xi(xi({},em),{},{hasDrawLine:!1})}));t.top.paintingBoardData.liveModel.show||(c[n].hasDrawLine=!0),t.top.changeData("elementList",c),o.isDrawingMode&&(e.path.globalCompositeOperation=r),t.top.layerFooterRef.setPositionBox()}))}else o.isDrawingMode=!1,o.clear();o.selection=!1,o.forEachObject((function(t){t.selectable=!1,t.lockUniScaling=!0,t.lockRotation=!0}))}}},Si=(n(5304),Object(_.a)(Ii,(function(){var t=this._self._c;return t("div",{staticClass:"page-box"},[t("canvas",{attrs:{"data-drag":"no",id:"mack-"+this.item.layerId}})])}),[],!1,null,"5d03d03b",null).exports);function Di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Li(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Di(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Pi={inject:["top"],data:function(){return{leftX:-500,topY:-500}},watch:{"top.paintingBoardData.boardInfo.zoom":{handler:function(){this.initPoin()}},"top.paintingBoardData.liveModel.show":{handler:function(t){t&&(this.leftX=-500,this.topY=-500)}}},props:{item:{type:Object,default:function(){return{}}}},methods:{initPoin:function(){var t=this.item,e=document.querySelector("#img-"+t.layerId).getBoundingClientRect();this.leftX=e.left-70,this.topY=e.top-100},handleSubmit:function(){var t,e=this;null!==(t=this.item)&&void 0!==t&&t.loading||(this.item.loading=!0,this.top.generateTask("generate",this.item,(function(img){e.$emit("updateImageSize",img[0])}),"intelligentEraser"))},handleCancel:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.top.cancelTask(t.item);case 2:n=t.top.paintingBoardData.elementList.map((function(em,t){return Li(Li({},em),{},{hasEraserDraw:!1,mask:""})})),t.top.changeData("elementList",n),t.top.changeData("topNav.tools.eraserTool.eraserAiBoard.hasAct","brush");case 5:case"end":return e.stop()}}),e)})))()}}},ji=(n(5305),Object(_.a)(Pi,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"top-action-nav",style:{top:n.topY+"px",left:n.leftX+"px"},attrs:{id:"EraserBottonsId"}},[o("div",{staticClass:"action-list flex"},[o("div",{staticClass:"item flex_c_m"},[o("i",{staticClass:"iconfont",class:[n.item.loading?"el-icon-loading":"icon-icon_zidongcachu1"]})]),n._v(" "),null!==(t=n.item)&&void 0!==t&&t.loading?n._e():o("div",{staticClass:"item-btn flex_c_m",on:{click:n.handleSubmit}},[n._v("\n      "+n._s(n.$t("canvas_erase_hover"))+"\n    ")]),n._v(" "),null!==(e=n.item)&&void 0!==e&&e.loading?o("div",{staticClass:"item-btn item-btn-gray flex_c_m",on:{click:n.handleCancel}},[n._v("\n      "+n._s(n.$t("Cancel"))+"\n    ")]):n._e()])])}),[],!1,null,"bf93a95e",null).exports);function $i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ti(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$i(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Mi={name:"generateModeRedraw",inject:["top"],props:{sourceInfo:{type:Object,default:function(){return{}}}},watch:{toolsType:{handler:function(){this.setDrawType(),this.setCanvasStyle()}},eraserSize:{handler:function(){this.setCanvasStyle()}},brushSize:{handler:function(){this.setCanvasStyle()}},"sourceInfo.mask":{handler:function(t,e){t!==this.imgUrl&&!/^(http|https):\/\//.test(t)&&this.displayMaskToCanvas(t)},deep:!0}},computed:{toolsType:function(){return"eraser"===this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.hasAct?"ERASER":"PEN"},brushSize:function(){var t=this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.wide;return isNaN(t/4)?100:t/4},eraserSize:function(){var t=this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.wide;return isNaN(t/4)?100:t/4}},data:function(){return{canvasStyle:{},blankCanvas:"",brushColor:"rgb(255,255,255)",isDrawing:!1,lastX:0,lastY:0,blankBgCanvas:"",imageData:null,imgUrl:"",autoStyle:{width:500,height:500,rawWidth:500,rawHeight:500}}},mounted:function(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.initBgCanvas(),this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,document.addEventListener("mouseup",this.stopDrawing),this.canvas.addEventListener("mousedown",this.startDrawing),this.canvas.addEventListener("mousemove",this.draw),this.canvas.addEventListener("mouseup",this.stopDrawing),this.blankCanvas=this.canvas.toDataURL(),this.saveBackgroundCanvas()},beforeDestroy:function(){this.canvas.removeEventListener("mousedown",this.startDrawing),this.canvas.removeEventListener("mousemove",this.draw),this.canvas.removeEventListener("mouseup",this.stopDrawing),document.removeEventListener("mouseup",this.stopDrawing),this.clearMaskImg()},methods:{clearMaskImg:function(){this.imgUrl="",this.$emit("updateMask",this.imgUrl),this.displayMaskToCanvas("")},displayMaskToCanvas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.imgUrl=e;var img=new Image,n=this.ctx,o=this.canvas.width,r=this.canvas.height;if(["",null,void 0].includes(e))return n.clearRect(0,0,o,r),void(this.imgUrl="");img.onload=function(){n.clearRect(0,0,o,r),n.drawImage(img,0,0,o,r);for(var e=n.getImageData(0,0,o,r),data=e.data,i=0;i<data.length/4;i++){var c=4*i,l=data[c],g=data[c+1],b=data[c+2],d=(data[c+3],Math.max(l,g,b));data[c+3]=d,0==l&&0==g&&0==b&&(data[c+3]=0)}n.putImageData(e,0,0),t.updateBgMask()},img.onerror=function(t){},img.src=e},setCanvasStyle:function(){var t="ERASER"===this.toolsType?this.eraserSize:this.brushSize,e='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 ').concat(t," ").concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat(t/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),n=btoa(e),o="data:image/svg+xml;base64,".concat(n);this.canvasStyle={cursor:"url(".concat(o,") ").concat(t/2," ").concat(t/2,", auto")}},saveCurrentDraw:function(){this.imageData=this.canvas.toDataURL()},initBgCanvas:function(){this.canvas2=this.$refs.canvas2,this.bgCtx=this.canvas2.getContext("2d"),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height)},saveBackgroundCanvas:function(){try{this.bgCtx.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.drawImage(this.canvas,0,0,this.canvas2.width,this.canvas2.height),this.blankBgCanvas=this.canvas2.toDataURL("image/png",.05)}catch(t){}},setDrawType:function(){this.ctx&&(this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.globalCompositeOperation="ERASER"===this.toolsType?"destination-out":"source-over")},startDrawing:function(t){this.isDrawing=!0,this.setDrawType();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1],this.ctx.beginPath(),this.ctx.moveTo(t.offsetX,t.offsetY),this.setInputShowStatus()},setInputShowStatus:function(){var t=this,e=-1,n=this.top.paintingBoardData.elementList.map((function(em,n){var mask=em.mask||"";return em.layerId===t.sourceInfo.layerId&&(e=n),em.layerId!==t.sourceInfo.layerId&&(mask=""),Ti(Ti({},em),{},{hasRedraw:!1,mask:mask})}));n[e].hasRedraw=!0,this.top.changeData("elementList",n),this.top.layerFooterRef.setPositionBox()},draw:function(t){if(this.isDrawing){this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,this.ctx.strokeStyle=this.brushColor,this.ctx.lineTo(t.offsetX,t.offsetY),this.ctx.stroke();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1]}},stopDrawing:function(){this.isDrawing=!1,this.ctx.closePath();try{this.saveDrawingToBase64()}catch(t){}},clearCanvas:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},updateBgMask:function(){this.bgCtx.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.drawImage(this.canvas,0,0,this.canvas2.width,this.canvas2.height);var t=this.bgCtx.getImageData(0,0,this.canvas2.width,this.canvas2.height);this.bgCtx.putImageData(t,0,0);var e=this.canvas2.toDataURL("image/png",.1);this.imgUrl=e},saveDrawingToBase64:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=1,t.bgCtx.clearRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.fillRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.drawImage(t.canvas,0,0,t.canvas2.width,t.canvas2.height),n=t.bgCtx.getImageData(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.putImageData(n,0,0),o=t.canvas2.toDataURL("image/png",.1),t.canvas.toDataURL()!==t.blankCanvas){e.next=12;break}return t.imgUrl="",t.$emit("updateMask",t.imgUrl),e.abrupt("return");case 12:if(o!==t.blankBgCanvas){e.next=16;break}return t.imgUrl="",t.$emit("updateMask",t.imgUrl),e.abrupt("return");case 16:t.imgUrl=o,t.$emit("updateMask",t.imgUrl),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(1);case 22:case"end":return e.stop()}}),e,null,[[1,20]])})))()}}},Ri=Mi,Ai=(n(5306),Object(_.a)(Ri,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-generate-mode-redraw"},[e("canvas",{ref:"canvas",staticClass:"generate-mode-redraw-canvas",style:t.canvasStyle,attrs:{"data-drag":"no",width:t.sourceInfo.width,height:t.sourceInfo.height}}),t._v(" "),e("canvas",{ref:"canvas2",staticStyle:{display:"none"},attrs:{width:t.sourceInfo.realWidth,height:t.sourceInfo.realHeight}}),t._v(" "),t.imgUrl?e("img",{staticStyle:{display:"none"},attrs:{src:t.imgUrl,alt:""}}):t._e()])}),[],!1,null,"a87c105a",null).exports),Ei=n(104),Bi=n(121),Ni=n.n(Bi),Fi=n(1152);function Ui(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Hi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ui(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ui(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Vi={name:"segmentCmp",inject:["top"],props:["autoStyle","sourceInfo","segmentType"],mixins:[Fi.a],data:function(){return{selectList:[],blankCanvas:null,blankBgCanvas:null,maskList:[],imgSegmentUrlList:[],maskImg:"",hoverMaskUrl:"",imagesList:[],debounceHandleMouseMove:null,borderWidth:2,borderColor:"#fff",hasHover:!0,list:[],loading:!1,retryCount:0}},beforeDestroy:function(){this.debounceHandleMouseMove=null,this.loading=!1,this.list=[],this.retryCount=0,this.clearMaskImg()},created:function(){var t=this;this.pollingMiddleware=new Ee.default(2e3,(function(){t.fetchTaskData()})),this.debounceHandleMouseMove=Object(Ei.throttle)(this.handleMouseMove,300),this.initCallBack(this.handleLoadMaskData)},mounted:function(){},watch:{"sourceInfo.mask":{handler:function(t,e){t!==this.maskImg&&"eraser"!==(null==this?void 0:this.segmentType)&&!/^(http|https):\/\//.test(t)&&this.displayMaskToCanvas(t)},deep:!0}},computed:{enableRedraw:function(){return["daubBoard"].includes(this.top.paintingBoardData.topNav.tools.hasAct)||"eraser"===(null==this?void 0:this.segmentType)}},methods:{clearMaskImg:function(){this.maskImg="",this.$emit("updateMask",this.maskImg),this.displayMaskToCanvas("")},getSegmentMaskData:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,v,f,m,pattern;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading&&!t.imgSegmentUrlList.length){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.next=5,t.getCacheSegmentMaskData(null==t||null===(n=t.sourceInfo)||void 0===n?void 0:n.imgSrc);case 5:if(!(c=e.sent)||!c.imgSegmentUrlList.length){e.next=12;break}return d=(l=c||{}).imgSegmentUrlList,h=void 0===d?[]:d,v=l.imagesList,f=void 0===v?[]:v,t.imgSegmentUrlList=h,t.imagesList=f,t.loading=!1,e.abrupt("return");case 12:if(m={image_url:t.sourceInfo.imgSrc,width:null==t||null===(o=t.sourceInfo)||void 0===o?void 0:o.realWidth,height:null==t||null===(r=t.sourceInfo)||void 0===r?void 0:r.realHeight},pattern=/^(http|https):\/\//,m.image_url&&pattern.test(null==m?void 0:m.image_url)){e.next=17;break}return t.$message.error("图层图片未成功上传，无法使用此功能"),e.abrupt("return");case 17:Object(Ae.b)(m).then((function(e){var n=e.data.id||"";t.list.push({status:1,process:0,id:n})})).catch((function(e){t.loading=!1}));case 18:case"end":return e.stop()}}),e)})))()},handleLoadMaskData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";[3,"3"].includes(t)?this.loadJsonFile(e):this.$message.error(this.$t("ServerError"))},loadJsonFile:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch(e).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initCanvas(null==data?void 0:data.result);case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){console.error("There has been a problem with your fetch operation:",n),0===t.retryCount?(t.loadJsonFile(e).finally((function(){t.loading=!1})),t.retryCount++):t.$message.error(t.$t("ServerError"))}))},getCacheSegmentMaskData:function(){var t=arguments;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!["",null,void 0].includes(n=t.length>0&&void 0!==t[0]?t[0]:"")){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Ni.a.getItem("editBoardSegmentList");case 5:if(!(o=e.sent)||!o[n]){e.next=8;break}return e.abrupt("return",o[n]);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})))()},displayMaskToCanvas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",img=new Image,canvas=this.$refs.segmentCanvas3,n=canvas.getContext("2d"),o=(this.$refs.segmentCanvas3,this.autoStyle.width),r=this.autoStyle.height;if(["",null,void 0].includes(e))return n.clearRect(0,0,o,r),void(this.maskImg="");img.onload=function(){n.clearRect(0,0,o,r),n.drawImage(img,0,0,o,r);for(var e=n.getImageData(0,0,o,r),data=e.data,i=0;i<data.length/4;i++){var c=4*i,l=data[c],g=data[c+1],b=data[c+2],d=(data[c+3],Math.max(l,g,b));data[c+3]=d,0==l&&0==g&&0==b&&(data[c+3]=0)}n.putImageData(e,0,0),t.maskImg=canvas.toDataURL()},img.onerror=function(t){},img.src=e},initCanvas:function(){var t=arguments,e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var data,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=t.length>0&&void 0!==t[0]?t[0]:[],e.imgSegmentUrlList=data.map((function(t){return"data:image/png;base64,".concat(t.mask_png)})),n.next=4,e.loadAllMask(e.imgSegmentUrlList);case 4:if(e.imagesList=n.sent,!e.imagesList.length){n.next=13;break}return n.next=8,Ni.a.getItem("editBoardSegmentList");case 8:return o=n.sent,(r=Object.assign({},o||{}))[e.sourceInfo.imgSrc]={imgSegmentUrlList:e.imgSegmentUrlList,imagesList:e.imagesList},n.next=13,Ni.a.setItem("editBoardSegmentList",r);case 13:case"end":return n.stop()}}),n)})))()},loadAllMask:function(){var t=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.autoStyle||{},n=e.width,o=e.height,r=(source||[]).map((function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){return e(img)},img.onerror=function(t){return n(t)},img.src=t}))}));return Promise.all(r).then((function(e){for(var r=[],i=0;i<e.length;i++){var img=e[i],c=document.createElement("canvas");c.width=n,c.height=o;var l=c.getContext("2d");l.drawImage(img,0,0,t.autoStyle.width,t.autoStyle.height);for(var d=l.getImageData(0,0,t.autoStyle.width,t.autoStyle.height),data=d.data,h=0;h<data.length;h+=4)255===data[h]&&255===data[h+1]&&255===data[h+2]||(data[h+3]=0);l.putImageData(d,0,0);var v=c.toDataURL();t.$set(t.imgSegmentUrlList,i,v);var f=l.getImageData(0,0,t.autoStyle.width,t.autoStyle.height);r.push(f),c=null,l=null}return r}))},handleMouseEnter:function(t){this.hasHover=!0,!this.enableRedraw||this.loading||this.imgSegmentUrlList.length||this.getSegmentMaskData()},handleMouseLeave:function(t){this.hoverMaskUrl="",this.hasHover=!1},handleMouseDown:function(t){this.selectRegion(t)},handleMouseMove:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.iscoordinate(t.offsetX,t.offsetY,e.imagesList);case 2:-1==(o=n.sent)||e.hasHover&&e.setHoverMask(o);case 4:case"end":return n.stop()}}),n)})))()},setInputShowStatus:function(){var t=this,e=-1,n=this.top.paintingBoardData.elementList.map((function(em,n){var mask=em.mask||"";return em.layerId===t.sourceInfo.layerId&&(e=n),em.layerId!==t.sourceInfo.layerId&&(mask=""),Hi(Hi({},em),{},{hasRedraw:!1,mask:mask})}));n[e].hasRedraw=!0,this.top.changeData("elementList",n),this.top.layerFooterRef.setPositionBox()},setHoverMask:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0,-1].includes(t)){n.next=3;break}return e.hoverMaskUrl="",n.abrupt("return");case 3:(o=new Image).src=e.imgSegmentUrlList[t],r=e.borderWidth,l=e.borderColor,o.onload=Object(c.a)(regeneratorRuntime.mark((function t(){var n,c,d,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=e.$refs.segmentCanvas2,(c=n.getContext("2d")).clearRect(0,0,e.autoStyle.width,e.autoStyle.height),d=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<d.length;i+=2)c.drawImage(o,0+d[i]*r,0+d[i+1]*r,e.autoStyle.width,e.autoStyle.height);c.globalCompositeOperation="source-in",c.fillStyle=l,c.fillRect(0,0,e.autoStyle.width,e.autoStyle.height),c.globalCompositeOperation="source-over",c.drawImage(o,0,0,e.autoStyle.width,e.autoStyle.height),e.hoverMaskUrl=n.toDataURL(),c.clearRect(0,0,e.autoStyle.width,e.autoStyle.height);case 12:case"end":return t.stop()}}),t)})));case 8:case"end":return n.stop()}}),n)})))()},checkPixelTransparency:function(t,e,n){return 0!==t.data[4*(e+n*t.width)+3]},selectRegion:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("点击事件",t.offsetX,t.offsetY),e.setInputShowStatus(),n.next=4,e.iscoordinate(t.offsetX,t.offsetY,e.imagesList);case 4:-1==(o=n.sent)||e.selectSegmentMask(o);case 6:case"end":return n.stop()}}),n)})))()},selectSegmentMask:function(t){var e=this,n=new Image,canvas=this.$refs.segmentCanvas3,o=canvas.getContext("2d"),r=this.$refs.segmentCanvas2,c=r.getContext("2d"),l=this.autoStyle,d=l.width,h=l.height,v=l.realWidth,f=l.realHeight,m=this.borderWidth,_=this.borderColor;n.src=this.imgSegmentUrlList[t],n.onload=function(){c.clearRect(0,0,d,h);for(var t=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<t.length;i+=2)c.drawImage(n,0+t[i]*m,0+t[i+1]*m,d,h);if(c.globalCompositeOperation="source-in",c.fillStyle=_,c.fillRect(0,0,d,h),c.globalCompositeOperation="source-over",c.drawImage(n,0,0,d,h),"eraser"!==(null==e?void 0:e.segmentType)){o.drawImage(r,0,0,d,h),e.maskImg=canvas.toDataURL();var l=document.createElement("canvas"),y=l.getContext("2d");l.width=v,l.height=f,y.drawImage(canvas,0,0,l.width,l.height);var w=l.toDataURL();e.maskImg=w,e.$emit("updateMask",w)}else{var C=r.toDataURL();e.$emit("updateEraserMask",C)}}},iscoordinate:function(t,e,n){var o=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=o.detectClickedImage(t,e,n),r.abrupt("return",i);case 2:case"end":return r.stop()}}),r)})))()},detectClickedImage:function(t,e,n){n.width,n.height,n.data;for(var i=n.length-1;i>=0;i--){var o=n[i],r=t-0,c=e-0;if(r>=0&&c>=0&&r<o.width&&c<o.height&&this.checkPixelTransparency(o,r,c))return i}}}},zi=Vi,Wi=(n(5307),Object(_.a)(zi,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-segment-cmp"},[e("canvas",{ref:"segmentCanvas",staticClass:"segment-cmp-canvas",attrs:{width:t.autoStyle.width,height:t.autoStyle.height},on:{mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave,mousemove:t.debounceHandleMouseMove,mousedown:t.selectRegion}}),t._v(" "),e("canvas",{ref:"segmentCanvas2",staticClass:"segment-cmp-canvas",staticStyle:{display:"none"},attrs:{width:t.autoStyle.width,height:t.autoStyle.height}}),t._v(" "),e("canvas",{ref:"segmentCanvas3",staticClass:"segment-cmp-canvas",staticStyle:{display:"none"},attrs:{width:t.autoStyle.width,height:t.autoStyle.height}}),t._v(" "),t.hoverMaskUrl?e("img",{staticClass:"segment-image-draw-img-hover-mask",style:{width:"".concat(t.autoStyle.width,"px"),height:"".concat(t.autoStyle.height,"px")},attrs:{src:t.hoverMaskUrl}}):t._e(),t._v(" "),e("svg",{staticClass:"segment-cmp-svg",staticStyle:{filter:"opacity(60%) brightness(0) saturate(100%) invert(14%) sepia(81%) saturate(6216%) hue-rotate(352deg)"}},[e("g",{staticClass:"segment-cmp-g"},[e("image",{style:{width:"".concat(t.autoStyle.width,"px"),height:"".concat(t.autoStyle.height,"px")},attrs:{href:t.maskImg}}),t._v(" "),e("clipPath",[e("rect",{attrs:{x:"0",y:"0",width:t.autoStyle.width,height:t.autoStyle.height}})])])])])}),[],!1,null,"57ce2859",null).exports);function qi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Gi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qi(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yi={name:"imageRedrawTools",mixins:[Fi.a],inject:["top"],props:{sourceInfo:{type:Object,default:function(){return{}}},eraserSize:{type:[Number,String],default:function(){return 20}},brushSize:{type:[Number,String],default:function(){return 20}},toolsType:{type:String,default:"PEN"},brushType:{type:String,default:"brush"}},watch:{toolsType:{handler:function(){this.setDrawType(),this.setCanvasStyle()}},eraserSize:{handler:function(){this.setCanvasStyle()}},brushSize:{handler:function(){this.setCanvasStyle()}},brushType:{handler:function(t,e){["brush"].includes(t)&&this.displayMaskToCanvas(this.maskImg),["eraser"].includes(t)&&this.displayMaskSegmentToCanvas(this.imgUrl)}},"sourceInfo.mask":{handler:function(t,e){""===t&&!/^(http|https):\/\//.test(t)&&(this.displayMaskToCanvas(t),this.displayMaskSegmentToCanvas(t))},deep:!0}},data:function(){return{brushColor:"rgb(255,255,255)",canvasStyle:{},blankCanvas:"",isDrawing:!1,lastX:0,lastY:0,maskImg:null,imgUrl:"",hoverMaskUrl:"",debounceHandleMouseMove:null,imgSegmentUrlList:[],imagesList:[],borderWidth:2,borderColor:"#fff",hasHover:!0,list:[],loading:!1,retryCount:0}},created:function(){var t=this;this.pollingMiddleware=new Ee.default(2e3,(function(){t.fetchTaskData()})),this.debounceHandleMouseMove=Object(Ei.throttle)(this.handleMouseMove,300),this.initCallBack(this.handleLoadMaskData)},mounted:function(){this.initBrush()},beforeDestroy:function(){this.debounceHandleMouseMove=null,this.loading=!1,this.list=[],this.retryCount=0,this.canvas.removeEventListener("mousedown",this.startDrawing),this.canvas.removeEventListener("mousemove",this.draw),this.canvas.removeEventListener("mouseup",this.stopDrawing),document.removeEventListener("mouseup",this.stopDrawing),this.clearMaskImg()},methods:{displayMaskToCanvas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",img=new Image,n=this.ctx,canvas=this.$refs.segmentCanvas3,o=this.canvas.width,r=this.canvas.height;if(["",null,void 0].includes(e))return n.clearRect(0,0,o,r),void(this.imgUrl="");img.onload=function(){n.clearRect(0,0,o,r),n.drawImage(canvas,0,0,o,r);for(var e=n.getImageData(0,0,o,r),data=e.data,i=0;i<data.length/4;i++){var c=4*i,l=data[c],g=data[c+1],b=data[c+2],d=(data[c+3],Math.max(l,g,b));data[c+3]=d,0==l&&0==g&&0==b&&(data[c+3]=0)}n.putImageData(e,0,0),t.updateBgMask()},img.onerror=function(t){},img.src=e},displayMaskSegmentToCanvas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",img=new Image,canvas=this.$refs.segmentCanvas3,n=canvas.getContext("2d"),o=canvas.width,r=canvas.height;if(["",null,void 0].includes(e))return n.clearRect(0,0,o,r),void(this.maskImg="");img.onload=function(){n.clearRect(0,0,o,r),n.drawImage(t.canvas,0,0,o,r);for(var e=n.getImageData(0,0,o,r),data=e.data,i=0;i<data.length/4;i++){var c=4*i,l=data[c],g=data[c+1],b=data[c+2],d=(data[c+3],Math.max(l,g,b));data[c+3]=d,0==l&&0==g&&0==b&&(data[c+3]=0)}n.putImageData(e,0,0),t.maskImg=canvas.toDataURL()},img.onerror=function(t){},img.src=e},updateBgMask:function(){var t=this.canvas.width,e=this.canvas.height;this.bgCtx.clearRect(0,0,t,e),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,t,e),this.bgCtx.drawImage(this.canvas,0,0,t,e);var n=this.bgCtx.getImageData(0,0,t,e);this.bgCtx.putImageData(n,0,0);var o=this.canvas2.toDataURL("image/png",.1);this.imgUrl=o},clearMaskImg:function(){this.maskImg="",this.hoverMaskUrl="",this.$emit("updateMask",this.maskImg)},initBrush:function(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.initBgCanvas(),this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,document.addEventListener("mouseup",this.stopDrawing),this.canvas.addEventListener("mousedown",this.startDrawing),this.canvas.addEventListener("mousemove",this.draw),this.canvas.addEventListener("mouseup",this.stopDrawing),this.blankCanvas=this.canvas.toDataURL(),this.saveBackgroundCanvas(),this.setCanvasStyle()},startDrawing:function(t){this.isDrawing=!0,this.setDrawType();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1],this.ctx.beginPath(),this.ctx.moveTo(t.offsetX,t.offsetY),this.setInputShowStatus()},saveBackgroundCanvas:function(){try{this.bgCtx.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.drawImage(this.canvas,0,0,this.canvas2.width,this.canvas2.height),this.blankBgCanvas=this.canvas2.toDataURL("image/png",.05)}catch(t){}},setCanvasStyle:function(){var t="ERASER"===this.toolsType?this.eraserSize:this.brushSize,e='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 ').concat(t," ").concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat(t/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),n=btoa(e),o="data:image/svg+xml;base64,".concat(n);this.canvasStyle={cursor:"url(".concat(o,") ").concat(t/2," ").concat(t/2,", auto")}},setDrawType:function(){this.ctx&&(this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.globalCompositeOperation="ERASER"===this.toolsType?"destination-out":"source-over")},initBgCanvas:function(){this.canvas2=this.$refs.canvas2,this.bgCtx=this.canvas2.getContext("2d"),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height)},draw:function(t){if(this.isDrawing){this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,this.ctx.strokeStyle=this.brushColor,this.ctx.lineTo(t.offsetX,t.offsetY),this.ctx.stroke();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1]}},stopDrawing:function(){if(!["eraser"].includes(this.brushType)){this.isDrawing=!1,this.ctx.closePath();try{this.saveDrawingToBase64()}catch(t){}}},saveDrawingToBase64:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=1,t.bgCtx.clearRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.fillRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.drawImage(t.canvas,0,0,t.canvas2.width,t.canvas2.height),n=t.bgCtx.getImageData(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.putImageData(n,0,0),o=t.canvas2.toDataURL("image/png",.1),t.canvas.toDataURL()!==t.blankCanvas){e.next=12;break}return t.imgUrl="",t.$emit("updateMask",t.imgUrl),e.abrupt("return");case 12:if(o!==t.blankBgCanvas){e.next=16;break}return t.imgUrl="",t.$emit("updateMask",t.imgUrl),e.abrupt("return");case 16:t.imgUrl=o,t.$emit("updateMask",t.imgUrl),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(1);case 22:case"end":return e.stop()}}),e,null,[[1,20]])})))()},setHoverMask:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0,-1].includes(t)){n.next=3;break}return e.hoverMaskUrl="",n.abrupt("return");case 3:(o=new Image).src=e.imgSegmentUrlList[t],r=e.borderWidth,l=e.borderColor,o.onload=Object(c.a)(regeneratorRuntime.mark((function t(){var n,c,d,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=e.$refs.segmentCanvas2,(c=n.getContext("2d")).clearRect(0,0,e.sourceInfo.width,e.sourceInfo.height),d=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<d.length;i+=2)c.drawImage(o,0+d[i]*r,0+d[i+1]*r,e.sourceInfo.width,e.sourceInfo.height);c.globalCompositeOperation="source-in",c.fillStyle=l,c.fillRect(0,0,e.sourceInfo.width,e.sourceInfo.height),c.globalCompositeOperation="source-over",c.drawImage(o,0,0,e.sourceInfo.width,e.sourceInfo.height),e.hoverMaskUrl=n.toDataURL(),c.clearRect(0,0,e.sourceInfo.width,e.sourceInfo.height);case 12:case"end":return t.stop()}}),t)})));case 8:case"end":return n.stop()}}),n)})))()},handleMouseEnter:function(t){this.hasHover=!0,"eraser"!==this.brushType||this.loading||this.imgSegmentUrlList.length||this.getSegmentMaskData()},handleMouseLeave:function(t){this.hoverMaskUrl="",this.hasHover=!1},handleMouseDown:function(t){this.selectRegion(t)},handleMouseMove:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.checkCoordinate(t.offsetX,t.offsetY,e.imagesList);case 2:-1==(o=n.sent)||e.hasHover&&e.setHoverMask(o);case 4:case"end":return n.stop()}}),n)})))()},getSegmentMaskData:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,h,v,f,m,pattern;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading&&!t.imgSegmentUrlList.length){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.next=5,t.getCacheSegmentMaskData(null==t||null===(n=t.sourceInfo)||void 0===n?void 0:n.imgSrc);case 5:if(!(c=e.sent)||!c.imgSegmentUrlList.length){e.next=12;break}return d=(l=c||{}).imgSegmentUrlList,h=void 0===d?[]:d,v=l.imagesList,f=void 0===v?[]:v,t.imgSegmentUrlList=h,t.imagesList=f,t.loading=!1,e.abrupt("return");case 12:if(m={image_url:t.sourceInfo.imgSrc,width:null==t||null===(o=t.sourceInfo)||void 0===o?void 0:o.realWidth,height:null==t||null===(r=t.sourceInfo)||void 0===r?void 0:r.realHeight},pattern=/^(http|https):\/\//,m.image_url&&pattern.test(null==m?void 0:m.image_url)){e.next=17;break}return t.$message.error("图层图片未成功上传，无法使用此功能"),e.abrupt("return");case 17:Object(Ae.b)(m).then((function(e){var n=e.data.id||"";t.list.push({status:1,process:0,id:n})})).catch((function(e){t.loading=!1}));case 18:case"end":return e.stop()}}),e)})))()},initCanvas:function(){var t=arguments,e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var data,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=t.length>0&&void 0!==t[0]?t[0]:[],e.imgSegmentUrlList=data.map((function(t){return"data:image/png;base64,".concat(t.mask_png)})),n.next=4,e.loadAllMask(e.imgSegmentUrlList);case 4:if(e.imagesList=n.sent,!e.imagesList.length){n.next=13;break}return n.next=8,Ni.a.getItem("editBoardSegmentList");case 8:return o=n.sent,(r=Object.assign({},o||{}))[e.sourceInfo.imgSrc]={imgSegmentUrlList:e.imgSegmentUrlList,imagesList:e.imagesList},n.next=13,Ni.a.setItem("editBoardSegmentList",r);case 13:case"end":return n.stop()}}),n)})))()},loadAllMask:function(){var t=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.sourceInfo||{},n=e.width,o=e.height,r=(source||[]).map((function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){return e(img)},img.onerror=function(t){return n(t)},img.src=t}))}));return Promise.all(r).then((function(e){for(var r=[],i=0;i<e.length;i++){var img=e[i],c=document.createElement("canvas");c.width=n,c.height=o;var l=c.getContext("2d");l.drawImage(img,0,0,t.sourceInfo.width,t.sourceInfo.height);for(var d=l.getImageData(0,0,t.sourceInfo.width,t.sourceInfo.height),data=d.data,h=0;h<data.length;h+=4)255===data[h]&&255===data[h+1]&&255===data[h+2]||(data[h+3]=0);l.putImageData(d,0,0);var v=c.toDataURL();t.$set(t.imgSegmentUrlList,i,v);var f=l.getImageData(0,0,t.sourceInfo.width,t.sourceInfo.height);r.push(f),c=null,l=null}return r}))},handleLoadMaskData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";[3,"3"].includes(t)?this.loadJsonFile(e):this.$message.error(this.$t("ServerError"))},loadJsonFile:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch(e).then((function(t){if(!t.ok)throw new Error("Network response was not ok");return t.json()})).then(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initCanvas(null==data?void 0:data.result);case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){console.error("There has been a problem with your fetch operation:",n),0===t.retryCount?(t.loadJsonFile(e).finally((function(){t.loading=!1})),t.retryCount++):t.$message.error(t.$t("ServerError"))}))},getCacheSegmentMaskData:function(){var t=arguments;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!["",null,void 0].includes(n=t.length>0&&void 0!==t[0]?t[0]:"")){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Ni.a.getItem("editBoardSegmentList");case 5:if(!(o=e.sent)||!o[n]){e.next=8;break}return e.abrupt("return",o[n]);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})))()},selectRegion:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("点击事件",t.offsetX,t.offsetY),e.setInputShowStatus(),n.next=4,e.checkCoordinate(t.offsetX,t.offsetY,e.imagesList);case 4:-1===(o=n.sent)||e.selectSegmentMask(o);case 6:case"end":return n.stop()}}),n)})))()},selectSegmentMask:function(t){var e=this,n=new Image,canvas=this.$refs.segmentCanvas3,o=canvas.getContext("2d"),r=this.$refs.segmentCanvas2,c=r.getContext("2d"),l=this.sourceInfo,d=l.width,h=l.height,v=l.realWidth,f=l.realHeight,m=this.borderWidth,_=this.borderColor;n.src=this.imgSegmentUrlList[t],n.onload=function(){c.clearRect(0,0,d,h);for(var t=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<t.length;i+=2)c.drawImage(n,0+t[i]*m,0+t[i+1]*m,d,h);if(c.globalCompositeOperation="source-in",c.fillStyle=_,c.fillRect(0,0,d,h),c.globalCompositeOperation="source-over",c.drawImage(n,0,0,d,h),"eraser"!==(null==e?void 0:e.segmentType)){o.drawImage(r,0,0,d,h),e.maskImg=canvas.toDataURL();var l=document.createElement("canvas"),y=l.getContext("2d");l.width=v,l.height=f,y.drawImage(canvas,0,0,l.width,l.height);var w=l.toDataURL();e.maskImg=w,e.$emit("updateMask",w)}else{var C=r.toDataURL();e.$emit("updateEraserMask",C)}}},checkCoordinate:function(t,e,n){var o=this;return Object(c.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",o.detectClickedImage(t,e,n));case 1:case"end":return r.stop()}}),r)})))()},checkPixelTransparency:function(t,e,n){return 0!==t.data[4*(e+n*t.width)+3]},detectClickedImage:function(t,e,n){n.width,n.height,n.data;for(var i=n.length-1;i>=0;i--){var o=n[i],r=t-0,c=e-0;if(r>=0&&c>=0&&r<o.width&&c<o.height&&this.checkPixelTransparency(o,r,c))return i}},setInputShowStatus:function(){var t=this,e=-1,n=this.top.paintingBoardData.elementList.map((function(em,n){var mask=em.mask||"";return em.layerId===t.sourceInfo.layerId&&(e=n),em.layerId!==t.sourceInfo.layerId&&(mask=""),Gi(Gi({},em),{},{hasEraserDraw:!1,mask:mask})}));n[e].hasEraserDraw=!0,this.top.changeData("elementList",n)}}},Ki=Yi,Ji=(n(5308),Object(_.a)(Ki,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-image-redraw-tools"},[e("div",{directives:[{name:"show",rawName:"v-show",value:["brush"].includes(t.brushType),expression:"['brush'].includes(brushType)"}]},[e("canvas",{ref:"canvas",staticClass:"generate-mode-redraw-canvas",style:t.canvasStyle,attrs:{"data-drag":"no",width:t.sourceInfo.width,height:t.sourceInfo.height}}),t._v(" "),e("canvas",{ref:"canvas2",staticStyle:{display:"none"},attrs:{width:t.sourceInfo.realWidth,height:t.sourceInfo.realHeight}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:["eraser"].includes(t.brushType),expression:"['eraser'].includes(brushType)"}]},[e("canvas",{ref:"segmentCanvas",staticClass:"segment-cmp-canvas",attrs:{width:t.sourceInfo.width,height:t.sourceInfo.height},on:{mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave,mousemove:t.debounceHandleMouseMove,mousedown:t.selectRegion}}),t._v(" "),e("canvas",{ref:"segmentCanvas2",staticClass:"segment-cmp-canvas",staticStyle:{display:"none"},attrs:{width:t.sourceInfo.width,height:t.sourceInfo.height}}),t._v(" "),e("canvas",{ref:"segmentCanvas3",staticClass:"segment-cmp-canvas",staticStyle:{display:"none"},attrs:{width:t.sourceInfo.width,height:t.sourceInfo.height}}),t._v(" "),t.hoverMaskUrl?e("img",{staticClass:"segment-image-draw-img-hover-mask",style:{width:"".concat(t.sourceInfo.width,"px"),height:"".concat(t.sourceInfo.height,"px")},attrs:{src:t.hoverMaskUrl,alt:""}}):t._e(),t._v(" "),e("svg",{staticClass:"segment-cmp-svg",staticStyle:{filter:"opacity(60%) brightness(0) saturate(100%) invert(14%) sepia(81%) saturate(6216%) hue-rotate(352deg)"}},[e("g",{staticClass:"segment-cmp-g"},[e("image",{style:{width:"".concat(t.sourceInfo.width,"px"),height:"".concat(t.sourceInfo.height,"px")},attrs:{href:t.maskImg}}),t._v(" "),e("clipPath",[e("rect",{attrs:{x:"0",y:"0",width:t.sourceInfo.width,height:t.sourceInfo.height}})])])])])])}),[],!1,null,"009f63b6",null).exports),Xi=n(5309),Qi={inject:["top"],components:{SpinLoading:n(3396).default},props:{mode:{type:String,default:"normal"}},computed:{zoomv:function(){var t=this.mode;return"live"===t?2:"normal"===t?1/this.top.paintingBoardData.boardInfo.zoom:"no"===t?1:void 0}},data:function(){return{}}},Zi=(n(5311),Object(_.a)(Qi,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ai-loading-box flex_c_m"},[e("div",{staticClass:"loading-content",style:{transform:"scale(".concat(t.zoomv,")")}},[e("div",{staticClass:"spin-icon"},[e("spin-loading")],1),t._v(" "),"start"===t.top.processStep.step?[e("p",{staticClass:"text-str"},[t._v(t._s(t.$t(t.top.processStep.text))+"...")])]:[e("p",{staticClass:"text-str"},[t._v(t._s(t.top.processStep.process)+"%")])]],2)])}),[],!1,null,"4df0b063",null).exports);function tn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function en(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tn(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nn={inject:["top"],components:{openPoseEditor:Re,ImgMoveMack:Si,EraserBottons:ji,generateModeRedraw:Ai,segmentCmp:Wi,imageRedrawTools:Ji,AiLoading:Zi},props:{item:{type:Object,default:function(){return{}}},comKey:{type:String,default:""}},data:function(){return{tipsVal:"",canvas:null,uploading:!1,UPLOAD:null,loopInterval:null,base64Pattern:/^data:image\/\w+;base64,/}},watch:{"top.paintingBoardData.topNav.tools":{handler:function(t,pre){var e=this;(null==t?void 0:t.hasAct)!==(null==pre?void 0:pre.hasAct)&&this.resetDrawStatus(),this.canvas?this.brushDraw():this.initBoard(this.item),"brushImg"!==t.hasAct&&"daubBoard"!==t.hasAct||this.$nextTick((function(){var t=e.top.paintingBoardData.boardInfo.zoom;e.setTipSize(t)}))},deep:!0},"top.paintingBoardData.boardInfo.zoom":{handler:function(t){this.setTipSize(t)}},"top.paintingBoardData.liveModel.show":{handler:function(t){var e=t?34:33;this.UPLOAD=new w.a({type:e})},immediate:!0},"item.imgSrc":function(t,e){null!=e&&e.includes("data:image/")||this.initImg(t)},"item.flipHorizontal":{handler:function(t){var e=this;this.$nextTick((function(){e.flipHorizontalFn(t)}))},immediate:!0},"item.flipVertical":{handler:function(t){var e=this;this.$nextTick((function(){e.flipVerticalFn(t)}))},immediate:!0},"item.rotate":{handler:function(t){var e=this;this.$nextTick((function(){e.handleRotate(t)}))},immediate:!0},"item.opacity":function(t){this.filterColor({type:"opacity",val:t})},"item.hue":function(t){this.filterColor({type:"hue",val:t})},"item.saturation":function(t){this.filterColor({type:"saturation",val:t})},"item.brightness":function(t){this.filterColor({type:"brightness",val:t})},"item.clipPath":{handler:function(t){var e=this;this.$nextTick((function(){e.handleClip(t)}))},immediate:!0},"item.matrix3d":{handler:function(t){var e=this;this.$nextTick((function(){e.handleFreeDeformation(t)}))},immediate:!0}},computed:{showInputArea:function(){return[["brushImg"].includes(this.top.paintingBoardData.topNav.tools.hasAct)&&this.item.hasDrawLine,["daubBoard"].includes(this.top.paintingBoardData.topNav.tools.hasAct)&&this.item.hasRedraw].some((function(t){return t}))},showImageCanvas:function(){return["imgLayer","brushLayer","controlNetLayer"].includes(this.item.type)},showGenerateModeRedraw:function(){return["imgLayer","controlNetLayer"].includes(this.item.type)&&"daubBoard"===this.top.paintingBoardData.topNav.tools.hasAct&&!this.showOpenPose&&!this.isLiveMode},redrawBoardType:function(){return{eraser:"ERASER",brush:"PEN",segment:"SEGMENT"}[this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.hasAct]||""},showEraserSegment:function(){this.top.paintingBoardData.topNav.tools.eraserTool;var t=this.top.paintingBoardData.topNav.tools.hasAct,e=["imgLayer"].includes(this.item.type),n=["eraserBoard","eraserAiBoard"].includes(t);return e&&n},showEraserSegmentCmp:function(){var t,e=this.top.paintingBoardData.topNav.tools.eraserTool;return"eraser"===(null==e||null===(t=e.eraserBoard)||void 0===t?void 0:t.hasAct)},showEraserClear:function(){var t=this.top.paintingBoardData.topNav.tools.hasAct,e=["imgLayer"].includes(this.item.type),n=["eraserAiBoard"].includes(t);return e&&n},eraserClearBrush:function(){var t=this.top.paintingBoardData.topNav.tools.eraserTool.eraserAiBoard.wide;return isNaN(t/4)?100:t/4},eraserClearBrushType:function(){return this.top.paintingBoardData.topNav.tools.eraserTool.eraserAiBoard.hasAct},isLiveMode:function(){return this.top.paintingBoardData.liveModel.show},showOpenPose:function(){var t;return["controlNetLayer"].includes(this.item.type)&&[8,"8"].includes(null===(t=this.getControlNetInfo)||void 0===t?void 0:t.module)},getControlNetInfo:function(){var t=this.item.controlNetId||"";return this.top.paintingBoardData.controlNet.controlnet_units.find((function(e){return e.id===t}))},getImageInfo:function(){var t=this.getContainedSize({width:this.item.width,height:this.item.height,naturalWidth:this.item.realWidth,naturalHeight:this.item.realHeight});return{width:t.width,height:t.height,rawWidth:this.item.realWidth,rawHeight:this.item.realHeight}},showDrawTips:function(){var t="imgLayer"===this.item.type,e=["daubBoard","brushImg"].includes(this.top.paintingBoardData.topNav.tools.hasAct);return t&&e},showBrushCanvas:function(){var t="imgLayer"===this.item.type,e="brushImg"===this.top.paintingBoardData.topNav.tools.hasAct;return t&&e},eleIndex:function(){var t,e=this;return(null===(t=this.top.paintingBoardData)||void 0===t||null===(t=t.elementList)||void 0===t?void 0:t.findIndex((function(t){return t.layerId==e.item.layerId})))||0},layerItem:function(){var t;return null===(t=this.top.paintingBoardData)||void 0===t?void 0:t.elementList[this.eleIndex]},loading:function(){return this.uploading||this.layerItem.loading},getActiveList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.active}))||[]},isClip:function(){var t;return!!(null!==(t=this.item)&&void 0!==t&&t.clipPath?this.item.clipPath.match(/-?\d+(\.\d+)?/g).map(Number):[]).find((function(t){return t}))},process:function(){var t=this.layerItem.process;return t?t+"%":""},isGenerate:function(){var t=this.layerItem,e=t.loading,n=t.imgSrc;return e&&n.includes("https://")}},mounted:function(){var t=this,e=this.item,n=this.top.paintingBoardData.boardInfo.zoom;e&&this.showImageCanvas&&this.$nextTick((function(){t.initBoard(e),t.setTipSize(n)})),this.$EventBus.$on("stepUpdate",(function(){t.initLayerPoin(),t.initLayerZoom(),t.filterColor()})),this.filterColor()},beforeDestroy:function(){this.$EventBus.$off("stepUpdate"),clearInterval(this.loopInterval),this.loopInterval=null},methods:{resetDrawStatus:function(){var t=this,e=this.top.paintingBoardData.elementList.map((function(em,e){return em.layerId===t.item.layerId&&e,en(en({},em),{},{hasRedraw:!1,hasDrawLine:!1,hasEraserDraw:!1,mask:""})}));this.top.changeData("elementList",e)},getContainedSize:function(img){try{var t=img.naturalWidth/img.naturalHeight,e=img.height*t,n=img.height;return e>img.width&&(e=img.width,n=img.width/t),{width:e,height:n}}catch(t){}},initBoard:function(t){this.canvas=new ze.fabric.Canvas(t.layerId,{width:t.width,height:t.height,selectable:!1,selection:!1,crossOrigin:"anonymous"}),this.initEraser(),this.initLayerPoin(),this.initLayerZoom()},initImg:function(t){var canvas=this.canvas,e=this.item,n=e.width,o=e.height;canvas.clear(),canvas.setDimensions({width:n,height:o}),ze.fabric.Image.fromURL(t,(function(img){img.scaleToWidth(canvas.width),img.scaleToHeight(canvas.height),img.set({left:0,top:0,selectable:!1}),canvas.add(img),canvas.renderAll()}),{crossOrigin:""})},filterColor:function(){var t=this.item.layerId,e=document.querySelector("#"+t),style=Object(Xi.a)(this.item);e.style.filter=style},hdInit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.top.getEleInfo(this.item.layerId),n=t.img_uris[0],o=n.url,r=n.width,c=n.height,l=en(en({},e),{},{imgSrc:o,realWidth:r,realHeight:c});this.top.changeData("elementList[".concat(this.eleIndex,"]"),l)},removeBginit:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},canvas=this.canvas,n=e.img_uris[0],o=n.url,r=n.width,c=n.height,l=600,d=c/(r/600),h=en(en({},this.top.getEleInfo(this.item.layerId)),{},{imgSrc:o,width:l,height:d,renderWidth:l,renderHeight:d,realWidth:r,realHeight:c});ze.fabric.Image.fromURL(o,(function(img){img.scaleToWidth(l),img.scaleToHeight(d),canvas.setBackgroundImage(img,canvas.renderAll.bind(canvas)),canvas.setDimensions({width:l,height:d}),t.top.changeData("elementList[".concat(t.eleIndex,"]"),h),t.top.initLayerActive(!0)}))},updateOnEraser:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.top.getEleInfo(this.item.layerId),n=t.url,o=t.width,r=t.height,c=en(en({},e),{},{url:n,realWidth:o,realHeight:r,loading:!1,mask:""});this.top.changeData("elementList[".concat(this.eleIndex,"]"),c),this.initImg(n)},initEraser:function(){var t=this,canvas=this.canvas,e=this.item;e.canvasJson&&Object.keys(e.canvasJson).length?canvas.loadFromJSON(e.canvasJson,(function(){canvas.forEachObject((function(t){t.selectable=!1})),canvas.renderAll(),t.initImg(e.imgSrc)})):(this.initImg(e.imgSrc),this.brushDraw())},initLayerPoin:function(){var em=this.item,style="translate(".concat(em.x,"px, ").concat(em.y,"px)"),t=document.querySelector("#img-"+em.layerId);if(t){var e=t.style.transform.replace(/translate[XYZ3d]*\([^)]+\)\s*/g,"");t.style.transform=style+e}},initLayerZoom:function(){var t=this.item,e=t.layerId,n=t.zoom,o=Array.isArray(n)?n:[n,n],style="scale(".concat(o[0]||1,", ").concat(o[1]||1,")"),r=document.querySelector("#img-"+e);if(r){var c=r.style.transform.replace(/scale[XYZ3d]*\([^)]+\)\s*/g,"");r.style.transform=c+style}},brushDraw:function(){var t=this,e=this.top.paintingBoardData.topNav.tools,n=e.eraserTool.eraserBoard,o=e.brushTool.brushBoard,canvas=this.canvas,r="eraser"===e.brushTool.brushBoard.hasAct;"eraserBoard"===e.hasAct&&(canvas.isDrawingMode="imgLayer"===this.item.type),"brushBoard"===e.hasAct&&r&&(canvas.isDrawingMode="brushLayer"===this.item.type),"eraserBoard"===e.hasAct||"brushBoard"===e.hasAct&&r?(canvas.freeDrawingBrush.color="#000","eraserBoard"===e.hasAct&&(canvas.freeDrawingBrush.width=n.wide/10),"brushBoard"===e.hasAct&&r&&(canvas.freeDrawingBrush.width=o.wide/10),"brush"===n.hasAct||"brush"===o.hasAct?canvas.on("path:created",(function(t){t.path.globalCompositeOperation="destination-out"})):(canvas.isDrawingMode=!1,canvas.globalCompositeOperation="source-over")):canvas.isDrawingMode=!1,canvas.selection=!1,canvas.forEachObject((function(t){t.selectable=!1,t.lockUniScaling=!0,t.lockRotation=!0})),canvas.on("after:render",(function(){var e=canvas.toJSON(),n=t.getElementIndex();t.top.changeData("elementList[".concat(n,"].canvasJson"),e)}))},getElementIndex:function(){var t=this.item.layerId;return this.top.paintingBoardData.elementList.findIndex((function(e){return e.layerId===t}))},clickItem:function(t){this.$emit("onClick",{item:t})},topBtnsClick:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function o(){var r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r=n.item.imgSrc,o.t0=t,o.next="download"===o.t0?4:"removeBg"===o.t0?6:"imgToImg"===o.t0?8:"del"===o.t0?16:"clip"===o.t0?18:"more"===o.t0?20:22;break;case 4:return n.handleDownload(),o.abrupt("break",23);case 6:return n.handleRemoveBg(),o.abrupt("break",23);case 8:if(c=r,!n.isClip){o.next=13;break}return o.next=12,Object(ht.m)(r,n.item);case 12:c=o.sent;case 13:return n.top.changeLeftMenu("Generate"),n.top.changeData("imageToImage.imgUrl",c),o.abrupt("break",23);case 16:return n.delLayer(),o.abrupt("break",23);case 18:return n.toggleCropping(),o.abrupt("break",23);case 20:return n.showMore(e),o.abrupt("break",23);case 22:return o.abrupt("break",23);case 23:n.$logEvent("log_actions",{operation:"click_".concat(t,"_image_operation"),behavior_info:"on_canvas_detail_page"});case 24:case"end":return o.stop()}}),o)})))()},handleRemoveBg:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.top.token){e.next=2;break}return e.abrupt("return",t.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}}));case 2:if(n=t.top.getEleInfo(t.item.layerId,"imgSrc"),t.uploading=!0,!t.base64Pattern.test(n)){e.next=17;break}return o=Object(_t.d)(n,t.item.layerId),e.prev=6,e.next=9,t.UPLOAD.startUpload(o);case 9:r=e.sent,n=r||"",e.next=17;break;case 13:e.prev=13,e.t0=e.catch(6),console.log("error",e.t0),t.uploading=!1;case 17:t.top.processStep={step:"start",process:0,text:"TaskStatusPreparing"},Object(Q.r)({image_url:n,mode:1}).then((function(e){var n=e.data.id;n&&t.loopGetResult(n,"removeBg")}));case 19:case"end":return e.stop()}}),e,null,[[6,13]])})))()},delLayer:function(){var t=this,e=this.top.paintingBoardData.elementList.filter((function(e){return e.z>1e4&&e.active&&t.top.changeData("liveModel.productLayerId",null),!1===e.active}));this.top.changeData("elementList",e)},showMore:function(t){this.$emit("showRightMenu",t,"more")},closeRightMenu:function(){this.$emit("closeRightMenu")},toggleCropping:function(){var t=this,e=this.top.paintingBoardData.elementList,n=e.findIndex((function(e){return e.layerId===t.item.layerId})),o=e[n].cropping;this.top.changeData("elementList[".concat(n,"].cropping"),!o)},rightMenuClick:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m,_,y,param;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.item,r=o.imgSrc,c=o.layerId,l=o.freeDeformation,d=o.flipHorizontal,h=o.flipVertical,v=o.rotate,n.t0=t,n.next="saveToMyGallery"===n.t0?4:"upscale"===n.t0?11:"toTop"===n.t0?13:"toBottom"===n.t0?15:"moveUp"===n.t0?17:"moveDown"===n.t0?19:"lockImage"===n.t0?21:"unlockImage"===n.t0?23:"freeDeformation"===n.t0?25:"horizontalFlip"===n.t0?27:"verticalFlip"===n.t0?29:"clockwise90Deg"===n.t0?31:"counterclockwise90Deg"===n.t0?34:"restoreFaces"===n.t0?37:"copy"===n.t0?39:"download"===n.t0?43:"publish"===n.t0?45:47;break;case 4:if(f=r,!e.isClip){n.next=9;break}return n.next=8,Object(ht.m)(r,e.item);case 8:f=n.sent;case 9:return e.handleSaveMaterial(f,c),n.abrupt("break",48);case 11:return e.handleUpscale(r,c),n.abrupt("break",48);case 13:return e.handleLayer("top"),n.abrupt("break",48);case 15:return e.handleLayer("bottom"),n.abrupt("break",48);case 17:return e.handleLayer("up"),n.abrupt("break",48);case 19:return e.handleLayer("down"),n.abrupt("break",48);case 21:return e.top.changeData("elementList[".concat(e.eleIndex,"].lock"),!0),n.abrupt("break",48);case 23:return e.top.changeData("elementList[".concat(e.eleIndex,"].lock"),!1),n.abrupt("break",48);case 25:return e.top.changeData("elementList[".concat(e.eleIndex,"].freeDeformation"),!l),n.abrupt("break",48);case 27:return e.top.changeData("elementList[".concat(e.eleIndex,"].flipHorizontal"),!d),n.abrupt("break",48);case 29:return e.top.changeData("elementList[".concat(e.eleIndex,"].flipVertical"),!h),n.abrupt("break",48);case 31:return m=v+90,e.top.changeData("elementList[".concat(e.eleIndex,"].rotate"),m),n.abrupt("break",48);case 34:return _=v-90,e.top.changeData("elementList[".concat(e.eleIndex,"].rotate"),_),n.abrupt("break",48);case 37:return e.handleRestoreFaces(r,c),n.abrupt("break",48);case 39:return y=e.top.paintingBoardData.liveModel.show,param=en(en({type:y?"liveImgLayer":"imgLayer"},e.item),{},{x:e.item.x-10,y:e.item.y+10}),e.top.addLayerItem(param),n.abrupt("break",48);case 43:return e.handleDownload(),n.abrupt("break",48);case 45:return e.top.publishPop({width:e.item.realWidth,height:e.item.realHeight,url:e.item.imgSrc,task_id:e.item.params.taskId}),n.abrupt("break",48);case 47:return n.abrupt("break",48);case 48:e.$logEvent("log_actions",{operation:"click_".concat(t,"_image_operation"),behavior_info:"on_canvas_detail_page"}),!["adjustOrder","transformTool"].includes(t)&&e.closeRightMenu();case 50:case"end":return n.stop()}}),n)})))()},handleLayer:function(t){var e=this.top.paintingBoardData.elementList,n=e.map((function(t){return t.z})),r=Math.max.apply(Math,Object(o.a)(n)),c=Math.min.apply(Math,Object(o.a)(n)),l=this.top.getEleInfo(this.item.layerId,"z"),d=0;switch(t){case"top":this.top.changeData("elementList[".concat(this.eleIndex,"].z"),r+1);break;case"bottom":this.top.changeData("elementList[".concat(this.eleIndex,"].z"),c-1);break;case"up":if(d=(n=n.sort((function(a,b){return a-b}))).findIndex((function(t){return t==l})),l!=r){var h=n[d+1],v=e.findIndex((function(t){return t.z===h}));this.top.changeData("elementList[".concat(this.eleIndex,"].z"),h),this.top.changeData("elementList[".concat(v,"].z"),l)}break;case"down":if(d=(n=n.sort((function(a,b){return a-b}))).findIndex((function(t){return t==l})),l!=c){var f=n[d-1],m=e.findIndex((function(t){return t.z===f}));this.top.changeData("elementList[".concat(this.eleIndex,"].z"),f),this.top.changeData("elementList[".concat(m,"].z"),l)}}},handleRestoreFaces:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function o(){var r,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=t,n.uploading=!0,!n.base64Pattern.test(r)){o.next=15;break}return c=Object(_t.d)(r,e),o.prev=4,o.next=7,n.UPLOAD.startUpload(c);case 7:l=o.sent,r=l||"",o.next=15;break;case 11:o.prev=11,o.t0=o.catch(4),console.log("error",o.t0),n.uploading=!1;case 15:n.top.processStep={step:"start",process:0,text:"TaskStatusPreparing"},Object(Q.s)({image_url:r}).then((function(t){var e=t.data.id;e&&n.loopGetResult(e,"restoreFaces")}));case 17:case"end":return o.stop()}}),o,null,[[4,11]])})))()},handleUpscale:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,v,img;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=n.item,c=r.realHeight,l=r.realWidth,!(c>3072||l>3072)){o.next=4;break}return n.$message.warning(n.$t("ImageTooLarge")),o.abrupt("return");case 4:if(d=t,n.uploading=!0,!n.base64Pattern.test(t)){o.next=19;break}return h=Object(_t.d)(t,e),o.prev=8,o.next=11,n.UPLOAD.startUpload(h);case 11:v=o.sent,d=v||"",o.next=19;break;case 15:o.prev=15,o.t0=o.catch(8),console.log("error",o.t0),n.uploading=!1;case 19:(img=new Image).src=d,n.top.processStep={step:"start",process:0,text:"TaskStatusPreparing"},img.onload=function(){var t=img.width,e=img.height;Object(Q.q)({image_url:d,mode:1,width:t,height:e}).then((function(t){var e=t.data.id;e&&n.loopGetResult(e,"hd")})).catch((function(t){console.log("err",t),n.uploading=!1}))};case 23:case"end":return o.stop()}}),o,null,[[8,15]])})))()},loopGetResult:function(t,e){var n=this;this.loopInterval=setInterval(Object(c.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h,f,m,_;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(v.batchFetchTaskProcess)({scene:1,task_ids:[t]});case 3:if(c=o.sent,null!=(l=c.data.items)&&l[0]){o.next=7;break}return o.abrupt("return");case 7:d=l[0],h=d.status_desc,f=d.img_uris,m=d.process,_=(null==f||null===(r=f[0])||void 0===r?void 0:r.url)||"",o.t0=h,o.next="finish"===o.t0?12:"sysCancelDesc"===o.t0?19:"sysTimeoutDesc"===o.t0?24:"processing"===o.t0?29:31;break;case 12:return"restoreFaces"==e&&n.top.changeData("elementList[".concat(n.eleIndex,"].imgSrc"),_),"hd"==e&&n.hdInit(l[0]),"removeBg"==e&&n.removeBginit(l[0]),clearInterval(n.loopInterval),n.uploading=!1,n.top.processStep={step:"end",process:m,text:"TaskStatusPreparing"},o.abrupt("break",32);case 19:return clearInterval(n.loopInterval),n.$message.warning(n.$t("systemCancel")),n.uploading=!1,n.top.processStep={step:"end",process:m,text:"TaskStatusPreparing"},o.abrupt("break",32);case 24:return clearInterval(n.loopInterval),n.$message.warning(n.$t("systemTimeoutCancel")),n.uploading=!1,n.top.processStep={step:"end",process:m,text:"TaskStatusPreparing"},o.abrupt("break",32);case 29:return n.top.processStep={step:"ing",process:m,text:"TaskStatusPreparing"},o.abrupt("break",32);case 31:return o.abrupt("break",32);case 32:o.next=40;break;case 34:o.prev=34,o.t1=o.catch(0),console.log("error",o.t1),clearInterval(n.loopInterval),n.top.processStep={step:"end",process:0,text:"TaskStatusPreparing"},n.uploading=!1;case 40:case"end":return o.stop()}}),o,null,[[0,34]])}))),3e3)},handleSaveMaterial:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function o(){var r,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=t,!n.base64Pattern.test(t)){o.next=16;break}return c=Object(_t.d)(t,e),o.prev=3,n.uploading=!0,o.next=7,n.UPLOAD.startUpload(c);case 7:l=o.sent,r=l||"",n.uploading=!1,o.next=16;break;case 12:o.prev=12,o.t0=o.catch(3),n.uploading=!1,console.log("error",o.t0);case 16:Object(Q.I)({items:[{category:"mine",image:r,name:""}]}).then((function(t){n.$message.success(n.$t("SaveSuccess")),n.$EventBus.$emit("updateMine"),setTimeout((function(){n.top.changeLeftMenu("Mine")}),100)}));case 17:case"end":return o.stop()}}),o,null,[[3,12]])})))()},handleUpdateMask:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.top.paintingBoardData.elementList.findIndex((function(e){return e.layerId===t.item.layerId}));-1!==n&&this.top.changeData("elementList[".concat(n,"].mask"),e)},handleEraserClearMaskUrl:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.top.paintingBoardData.elementList.findIndex((function(e){return e.layerId===t.item.layerId}));-1!==n&&this.top.changeData("elementList[".concat(n,"].mask"),e)},handleUpdateEraserMask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(t)||this.clearMaskContent(t)},clearMaskContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",canvas=this.canvas;ze.fabric.Image.fromURL(t,(function(img){img.scaleToWidth(canvas.width),img.scaleToHeight(canvas.height),img.globalCompositeOperation="destination-out",canvas.add(img),canvas.renderAll(),img.on("rendered",(function(){canvas.remove(img)}))}),{})},handleMixGenerateMask:function(){},handleDownload:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.item,o=n.imgSrc,r=n.layerId,e.next=3,t.handleDownloadUrl(o,r);case 3:o=e.sent,t.base64Pattern.test(o)?Object(_t.k)(o,r):t.downloadCdnUrl(o,r);case 5:case"end":return e.stop()}}),e)})))()},handleDownloadUrl:function(t,e){var n=this,o=this.item,r=o.flipHorizontal,l=o.flipVertical,d=o.rotate,h=o.hue,v=o.saturation,f=o.brightness,m=document.querySelector("#"+e);return r||l||d%360!=0||this.isClip||0!==h||0!==v||0!==f?new Promise((function(e){var img=new Image;img.crossOrigin="Anonymous",img.src=t,img.onload=Object(c.a)(regeneratorRuntime.mark((function o(){var canvas,c,h,v,f,_;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(canvas=document.createElement("canvas"),c=canvas.getContext("2d"),canvas.width=img.width,canvas.height=img.height,c.filter=window.getComputedStyle(m).filter||"",c.drawImage(img,0,0),(r||l)&&(h=r?-1:1,v=l?-1:1,f=r?img.width:0,_=l?img.height:0,c.translate(f,_),c.scale(h,v),c.drawImage(img,0,0)),d%360!=0&&n.rotateImage(img,canvas,c,d),t=canvas.toDataURL(),!n.isClip){o.next=13;break}return o.next=12,Object(ht.m)(t,n.item);case 12:t=o.sent;case 13:e(t);case 14:case"end":return o.stop()}}),o)})))})):t},rotateImage:function(t,canvas,e,n){var o=n*Math.PI/180,r=Math.sin(o),c=Math.cos(o),l=t.naturalWidth,d=t.naturalHeight;canvas.width=Math.abs(c)*l+Math.abs(r)*d,canvas.height=Math.abs(r)*l+Math.abs(c)*d,e.translate(canvas.width/2,canvas.height/2),e.rotate(o),e.drawImage(t,-l/2,-d/2,l,d)},downloadCdnUrl:function(t,e){var img=new Image;img.crossOrigin="anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png"),n=document.createElement("a");n.href=t,n.download="".concat(e,".png"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},updateControlNetConfig:function(){if("controlNetLayer"===this.item.type)(this.item||{}).controlNetId},getDrawImg:function(t){var e=this;this.$nextTick((function(){var n,o=null===(n=e.$refs)||void 0===n||null===(n=n.imgMoveMackRef)||void 0===n?void 0:n.brushCanvas,r=e.canvas.toDataURL("image/jpeg"),c=null==o?void 0:o.toDataURL("image/jpeg"),canvas=document.createElement("canvas"),l=canvas.getContext("2d"),d=new Image,h=new Image;d.src=r,h.src=c,d.onload=function(){canvas.width=d.width,canvas.height=d.height,l.drawImage(d,0,0),o?h.onload=function(){l.drawImage(h,0,0);var n=canvas.toDataURL("image/jpeg");t&&t(e.showGenerateModeRedraw?r:n)}:t&&t(r)}}))},tipsSubmit:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=e.top.paintingBoardData.elementList[e.eleIndex]).loading){n.next=3;break}return n.abrupt("return");case 3:if(o.loading=!0,o.prompt=t||e.tipsVal,e.isLiveMode||!e.showGenerateModeRedraw){n.next=9;break}return o.cutUrl=o.imgSrc,e.top.generateTask("generate",o,(function(img){o.imgSrc=img[0].url,o.mask=""}),"layerRedraw"),n.abrupt("return");case 9:e.getDrawImg(function(){var t=Object(c.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ht.s)(n);case 2:r=t.sent,o.cutUrl=r,e.top.generateTask("generate",o,(function(img){o.imgSrc=img[0].url}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return n.stop()}}),n)})))()},flipHorizontalFn:function(t){var e=document.querySelector("#css-".concat(this.item.layerId)),n=e.style.transform.replace("scaleX(-1)","").replace("scaleX(1)","");e.style.cssText+="transform: ".concat(n," scaleX(").concat(t?"-1":"1",")")},flipVerticalFn:function(t){var e=document.querySelector("#css-".concat(this.item.layerId)),n=e.style.transform.replace("scaleY(-1)","").replace("scaleY(1)","");e.style.cssText+="transform: ".concat(n," scaleY(").concat(t?"-1":"1",")")},handleRotate:function(t){var e=document.querySelector("#img-".concat(this.item.layerId)),n=e.style.transform.replace(/rotate\([-+]?\d+(\.\d+)?deg\)/g,"");e.style.transform="".concat(n," rotate(").concat(t,"deg)"),this.top.changeData("elementList[".concat(this.eleIndex,"].active"),!1)},handleClip:function(t){document.querySelector("#img-".concat(this.item.layerId)).style.clipPath=t},handleFreeDeformation:function(t){var e=document.querySelector("#img-".concat(this.item.layerId)),n=e.style.transform.replace(/matrix3d\((.*?)\)/,"");e.style.transform="".concat(n," matrix3d(").concat(t,")")},setTipSize:function(t){var e=380,n=160,o=document.querySelector("#drawimg-".concat(this.item.layerId)),r=1/t;if(o){if(o.style.transform="scale(".concat(r,")"),1===t)return o.style.left="".concat(0,"px"),void(o.style.top="calc(100% + 10px)");if(t<1){var c=(e*r-e)/2,l=this.item.height+10*r+(n*r-n)/2;o.style.left="".concat(Math.abs(c),"px"),o.style.top="".concat(l,"px")}else{var d=(e-e*r)/2,h=this.item.height+10*r-(n-n*r)/2;o.style.left="".concat(-d,"px"),o.style.top="".concat(h,"px")}}}}},an=nn,sn=(n(5312),Object(_.a)(an,(function(){var t,e,n,o=this,r=o._self._c;return o.showImageCanvas?r("div",{staticClass:"bel-item img-move-page",class:[o.showOpenPose&&"no-snapshot"],style:{zIndex:o.item.z,width:o.item.width+"px",height:o.item.height+"px"},attrs:{id:"img-".concat(o.item.layerId),"data-id":o.item.layerId},on:{click:function(t){return o.clickItem(o.item)}}},[r("div",{staticClass:"img-content-box",style:{width:o.item.width+"px",height:o.item.height+"px"},attrs:{"data-drag":"no",id:"css-".concat(o.item.layerId)}},[o.showOpenPose?r("open-pose-editor",{attrs:{uniqueId:o.item.layerId,"img-info":o.getImageInfo,"source-info":o.getControlNetInfo}}):o._e(),o._v(" "),r("canvas",{directives:[{name:"show",rawName:"v-show",value:!o.showOpenPose,expression:"!showOpenPose"}],staticClass:"base-canvas",attrs:{"data-drag":"no",id:o.item.layerId}}),o._v(" "),o.showBrushCanvas?r("img-move-mack",{directives:[{name:"show",rawName:"v-show",value:!o.showOpenPose,expression:"!showOpenPose"}],ref:"imgMoveMackRef",staticClass:"mack-canvas",attrs:{item:o.item}}):o._e(),o._v(" "),o.showGenerateModeRedraw?[r("generate-mode-redraw",{directives:[{name:"show",rawName:"v-show",value:["ERASER","PEN"].includes(o.redrawBoardType),expression:"['ERASER', 'PEN'].includes(redrawBoardType)"}],staticClass:"mack-canvas",attrs:{"source-info":o.item},on:{updateMask:function(t){return o.handleUpdateMask(t,"redraw")}}}),o._v(" "),r("segment-cmp",{directives:[{name:"show",rawName:"v-show",value:"SEGMENT"===o.redrawBoardType,expression:"redrawBoardType === 'SEGMENT'"}],key:"redrawSegment_".concat(null===(t=o.item)||void 0===t?void 0:t.layerId),attrs:{"auto-style":o.item,"source-info":o.item},on:{updateMask:function(t){return o.handleUpdateMask(t,"segment")}}})]:o._e(),o._v(" "),o.showEraserSegment?[r("segment-cmp",{directives:[{name:"show",rawName:"v-show",value:o.showEraserSegmentCmp,expression:"showEraserSegmentCmp"}],key:"eraserSegment_".concat(null===(e=o.item)||void 0===e?void 0:e.layerId),attrs:{"auto-style":o.item,"source-info":o.item,"segment-type":"eraser"},on:{updateEraserMask:function(t){return o.handleUpdateEraserMask(t,"eraser")}}})]:o._e(),o._v(" "),o.showEraserClear?[r("image-redraw-tools",{key:"eraserAutoClear_".concat(null===(n=o.item)||void 0===n?void 0:n.layerId),attrs:{"eraser-size":o.eraserClearBrush,"brush-size":o.eraserClearBrush,"tools-type":"PEN","brush-type":o.eraserClearBrushType,"source-info":o.item},on:{updateMask:o.handleEraserClearMaskUrl}})]:o._e(),o._v(" "),r("ai-loading",{directives:[{name:"show",rawName:"v-show",value:o.loading,expression:"loading"}]})],2)]):o._e()}),[],!1,null,"21f5026d",null).exports),on={inject:["top"],components:{VueMoveable:Ye.a,AiLoading:Zi},props:{AiImageTipsRef:{type:Object,default:function(){return null}}},data:function(){return{aiimgItemBoxRef:null,editRef:null,aiImgBorder:{},borderW:1}},computed:{screenshotInfo:function(){var t;return(null===(t=this.top.paintingBoardData)||void 0===t?void 0:t.generateInfo)||{}},generateNum:function(){var t;return((null===(t=this.top.paintingBoardData)||void 0===t?void 0:t.basicParams)||{}).imagesNumber-1||0},width:function(){var t;return null===(t=this.screenshotInfo)||void 0===t?void 0:t.width},height:function(){var t;return null===(t=this.screenshotInfo)||void 0===t?void 0:t.height},process:function(){var t=this.screenshotInfo.process;return t?t+"%":""}},watch:{"top.paintingBoardData.boardInfo.zoom":{handler:function(t){this.setBorderw(t)},immediate:!0}},mounted:function(){var t=this;this.aiimgItemBoxRef=this.$refs.aiimgItemBoxRef,this.editRef=this.$refs.editRef,this.AiImageTipsRef&&this.AiImageTipsRef.initPoin(),this.$nextTick((function(){t.aiBoxPoin(),t.setBorderw(),t.top.aiimgBoxRef=t.$refs.aiimgBoxRef})),P.a.on("$E_updateAiBoxSize",this.updateAiBoxSize)},methods:{clearActive:function(){this.top.paintingBoardData.elementList.forEach((function(t){return t.active=!1}))},resizeStart:function(t){var e=0===this.top.generateType?[1024,1024]:[1536,1536];t.setMin([256,256]),t.setMax(e)},aiBoxPoin:function(){var t=this,e=this.top.paintingBoardData.generateInfo,n=e.width,o=e.height,r=this.top.paintingBoardData.boardInfo,c=r.viewW,l=r.viewH,d=r.scrollLeft,h=r.scrollTop,v=r.zoom,f=d+c/v/2-n/2,m=h+l/v/2-o/2,style="transform: translate(".concat(f,"px, ").concat(m,"px);width:").concat(n,"px;height:").concat(o,"px");e.x=f,e.y=m,document.querySelector("#aiimgItemBoxId").style.cssText+=style,this.$nextTick((function(){t.AiImageTipsRef&&t.AiImageTipsRef.initPoin()}))},updateAiBoxSize:function(){var t=this,e=this.top.paintingBoardData.generateInfo,n=this.top.generateType,o=document.querySelector("#aiimgItemBoxId");0===n&&e.width>1024&&(e.width=1024,o.style.width="".concat(e.width,"px")),0===n&&e.height>1024&&(e.height=1024,o.style.height="".concat(e.height,"px")),this.$nextTick((function(){t.$refs.aiimgBoxRef&&t.$refs.aiimgBoxRef.updateRect()}))},handleDrag:function(t){this.clearActive(),t.target.style.transform=t.transform;var e=t.translate||[],n=Object(r.a)(e,2),o=n[0],c=n[1],l=this.top.paintingBoardData.generateInfo;l.x=o,l.y=c},dragEnd:function(t){var e=t.target.getBoundingClientRect();this.aiImgBorder=e;var n=this.top.paintingBoardData.generateInfo,o=this.top.generateType;0===o&&n.width>1024&&(n.width=1024,t.target.style.width="".concat(n.width,"px")),0===o&&n.height>1024&&(n.height=1024,t.target.style.height="".concat(n.height,"px"))},onResize:function(t){var e=this.top.paintingBoardData.generateInfo,n=t.width,o=t.height;t.target.style.width="".concat(n,"px"),t.target.style.height="".concat(o,"px"),t.target.style.transform=t.drag.transform,e.width=n,e.height=o},resizeEnd:function(t){var e=this.top.paintingBoardData.generateInfo,n=this.top.generateType;0===n&&e.width>1024&&(e.width=1024,t.target.style.width="".concat(e.width,"px")),0===n&&e.height>1024&&(e.height=1024,t.target.style.height="".concat(e.height,"px"))},aiHtmlImg:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,d,h,v,f,m,_,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.top.paintingBoardData,r=o.generateInfo,c=o.boardInfo.zoom,l=o.imageToImage.imgUrl,"cancel"!==t){n.next=4;break}return e.top.cancelTask(r),n.abrupt("return");case 4:if(!r.loading){n.next=6;break}return n.abrupt("return");case 6:return d=null,r.loading=!0,h=e.$refs.aiimgItemBoxRef.getBoundingClientRect(),v=h.x,f=h.y,m=h.width,_=h.height,e.top.processStep={step:"start",process:0,text:"TaskStatusPreparing"},n.next=12,Object(ht.a)({tagArea:{x:v,y:f,width:m,height:_},scale:1/c});case 12:if(y=n.sent){n.next=18;break}return r.cutUrl=l,r.mask="",e.createTask(),n.abrupt("return");case 18:return n.next=20,Object(ht.b)(y,[255,255,255]);case 20:if(!n.sent){n.next=25;break}return n.next=24,Object(ht.h)(y,[255,255,255]);case 24:r.mask=n.sent;case 25:if(!(d=e.getIncludeLayer())){n.next=33;break}return n.next=29,Object(ht.d)(d.imgSrc,d,!0);case 29:r.cutUrl=n.sent,r.mask=e.getBoxMask(d),n.next=36;break;case 33:return n.next=35,Object(ht.s)(y);case 35:r.cutUrl=n.sent;case 36:e.createTask(d);case 37:case"end":return n.stop()}}),n)})))()},createTask:function(t){var e=this,n=this.top.paintingBoardData.generateInfo;this.top.generateTask("generate",n,(function(img){t?img[0].url&&(t.imgSrc=img[0].url):[0,3].includes(e.top.generateType)?e.addLayer(img):e.generateLayer(img[0].url)}),"aiProdImg")},generateLayer:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,h,v,f,m,_,y,w,C;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=e.top.paintingBoardData.generateInfo.params,l=e.getRelateLayer(),d=null===(r=e.top.paintingBoardData)||void 0===r?void 0:r.boardInfo,h=d.zoom,l=[].concat(Object(o.a)(l),[e.getGenerateImgBoxInfo(t)]),n.prev=4,n.next=7,Object(ht.n)(l,h);case 7:v=n.sent,f=v.width,m=v.height,_=v.base64,y=e.getCompositeImgInfo(l),w=y.x,C=y.y,Object(ht.s)(_).then((function(t){e.removeLayer(l),e.top.addLayerItem({x:w,y:C,width:f,height:m,imgSrc:t,params:c})})),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(4);case 15:case"end":return n.stop()}}),n,null,[[4,13]])})))()},removeLayer:function(t){var e=this.top.paintingBoardData.elementList;this.top.paintingBoardData.elementList=e.filter((function(e){return!t.some((function(t){return(null==t?void 0:t.layerId)===e.layerId}))}))},getCompositeImgInfo:function(t){var e={x:0,y:0};return t.forEach((function(t){var n=t.x,o=t.y,r=t._x,c=t._y,l=t.width,d=t.height,h=t.zoom;n=r||n,o=c||o,n=h?n+l*(1-h[0])/2:n,o=h?o+d*(1-h[1])/2:o,e.x=e.x?Math.min(e.x,r||n):r||n,e.y=e.y?Math.min(e.y,c||o):c||o})),e},getGenerateImgBoxInfo:function(t){var e=document.querySelector("#aiimgItemBoxId").getBoundingClientRect(),n=e.width,o=e.height,r=e.x,c=e.y,l=this.top.paintingBoardData,d=l.generateInfo,h=l.boardInfo.zoom;return{width:n,height:o,renderWidth:n/h,renderHeight:o/h,x:r,y:c,_x:d.x,_y:d.y,imgSrc:t,z:9999999999,id:"aiimgItemBoxId"}},getRelateLayer:function(){var t=this.top.paintingBoardData.elementList,e=document.querySelector("#aiimgItemBoxId").getBoundingClientRect(),n=e.x,o=e.y,r=e.width,c=e.height,l=t.filter((function(t){var e=document.querySelector('[data-id="'+t.layerId+'"]'),l=(null==e?void 0:e.getBoundingClientRect())||{},d=n>=l.x+l.width||n+r<=l.x,h=o>=l.y+l.height||o+c<=l.y;return!d&&!h}));return l.length?l:null},addLayer:function(t){var e=this,n=this.top.paintingBoardData.generateInfo,o=n.x,r=n.y,c=n.width,l=n.height,d=n.params,h=t.length;t.forEach((function(t,i){e.top.addLayerItem({x:(null==t?void 0:t.x)||o+(h>1?i*(c+10):0),y:(null==t?void 0:t.y)||r-(h>1?l:0),width:(null==t?void 0:t.width)||c,height:(null==t?void 0:t.height)||l,imgSrc:t.url,params:d})}))},getBoxMask:function(t){var e,n=this.top.paintingBoardData.boardInfo.zoom,o=document.querySelector("#aiimgItemBoxId").getBoundingClientRect(),r=o.left,c=o.top,l=o.width,d=o.height,h=document.querySelector('[data-id="'+t.layerId+'"]').getBoundingClientRect(),v=(null===(e=t.zoom)||void 0===e?void 0:e.length)>1?t.zoom:[1,1];return Object(ht.f)({width:parseInt(t.width*v[0]),height:parseInt(t.height*v[1]),b_x:(r-h.left)/n,b_y:(c-h.top)/n,b_w:parseInt(l/n),b_h:parseInt(d/n)})},getIncludeLayer:function(){var t=this.top.paintingBoardData.elementList,e=document.querySelector("#aiimgItemBoxId").getBoundingClientRect(),n=e.x,o=e.y,r=e.width,c=e.height,l=t.filter((function(t){var e=document.querySelector('[data-id="'+t.layerId+'"]').getBoundingClientRect(),l=n>e.x&&n+r<e.x+e.width;return o>e.y&&o+c<e.y+e.height&&l}));if(null==l||!l.length)return"";var d=l[0];return l.forEach((function(t){d.z<t.z&&(d=t)})),d},setBorderw:function(t){var e=1/(this.top.paintingBoardData.boardInfo||t).zoom;this.borderW=e;var n=document.querySelector("#aiimgItemBoxId");n&&(n.style.borderWidth=2*e+"px")}}},rn=(n(5313),Object(_.a)(on,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"aiimg-page-box bel-item no-snapshot",style:{zIndex:9999},on:{click:t.clearActive}},[e("div",{ref:"aiimgItemBoxRef",staticClass:"aiimg-box bel-item",attrs:{id:"aiimgItemBoxId"}},[e("div",{staticClass:"ai-content",attrs:{"data-drag":"no"}},[e("ai-loading",{directives:[{name:"show",rawName:"v-show",value:t.screenshotInfo.loading,expression:"screenshotInfo.loading"}]})],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.generateNum>0,expression:"generateNum > 0"}],staticClass:"result-list no-snapshot",attrs:{"data-drag":"no"}},t._l(t.generateNum,(function(n,i){return e("div",{key:"generateNum_"+i,staticClass:"result",style:{width:t.width+"px",height:t.height+"px"},attrs:{"data-drag":"no"}})})),0)]),t._v(" "),e("vue-moveable",{ref:"aiimgBoxRef",attrs:{target:t.aiimgItemBoxRef,resizable:!t.screenshotInfo.loading,scalable:!1,draggable:!t.screenshotInfo.loading,keepRatio:!1,origin:!1,checkInput:!0,minScale:.5,zoom:t.borderW},on:{dragEnd:t.dragEnd,drag:t.handleDrag,resize:t.onResize,resizeStart:t.resizeStart,resizeEnd:t.resizeEnd}})],1)}),[],!1,null,"6f56a00a",null).exports),cn={name:"liveModeRedraw",inject:["top"],props:{},watch:{toolsType:{handler:function(){this.setDrawType(),this.setCanvasStyle()}},eraserSize:{handler:function(){this.setCanvasStyle()}},brushSize:{handler:function(){this.setCanvasStyle()}}},computed:{toolsType:function(){return"eraser"===this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.hasAct?"ERASER":"PEN"},brushSize:function(){var t=this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.wide;return isNaN(t/4)?100:t/4},eraserSize:function(){var t=this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard.wide;return isNaN(t/4)?100:t/4},liveItemInfo:function(){return this.top.paintingBoardData.liveModel}},data:function(){return{canvasStyle:{},blankCanvas:"",brushColor:"rgb(255,255,255)",isDrawing:!1,lastX:0,lastY:0,blankBgCanvas:"",imageData:null,imgUrl:"",autoStyle:{width:500,height:500,rawWidth:500,rawHeight:500}}},mounted:function(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.initBgCanvas(),this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,document.addEventListener("mouseup",this.stopDrawing),this.canvas.addEventListener("mousedown",this.startDrawing),this.canvas.addEventListener("mousemove",this.draw),this.canvas.addEventListener("mouseup",this.stopDrawing),this.blankCanvas=this.canvas.toDataURL(),this.saveBackgroundCanvas()},beforeDestroy:function(){this.canvas.removeEventListener("mousedown",this.startDrawing),this.canvas.removeEventListener("mousemove",this.draw),this.canvas.removeEventListener("mouseup",this.stopDrawing),document.removeEventListener("mouseup",this.stopDrawing)},methods:{setCanvasStyle:function(){var t="ERASER"===this.toolsType?this.eraserSize:this.brushSize,e='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 ').concat(t," ").concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat(t/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),n=btoa(e),o="data:image/svg+xml;base64,".concat(n);this.canvasStyle={cursor:"url(".concat(o,") ").concat(t/2," ").concat(t/2,", auto")}},saveCurrentDraw:function(){this.imageData=this.canvas.toDataURL()},initBgCanvas:function(){this.canvas2=this.$refs.canvas2,this.bgCtx=this.canvas2.getContext("2d"),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height)},saveBackgroundCanvas:function(){try{this.bgCtx.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.drawImage(this.canvas,0,0,this.canvas2.width,this.canvas2.height),this.blankBgCanvas=this.canvas2.toDataURL("image/png",.05)}catch(t){}},setDrawType:function(){this.ctx&&(this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.globalCompositeOperation="ERASER"===this.toolsType?"destination-out":"source-over")},startDrawing:function(t){this.isDrawing=!0,this.setDrawType();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1],this.ctx.beginPath(),this.ctx.moveTo(t.offsetX,t.offsetY)},draw:function(t){if(this.isDrawing){this.ctx.lineWidth="ERASER"===this.toolsType?this.eraserSize:this.brushSize,this.ctx.strokeStyle=this.brushColor,this.ctx.lineTo(t.offsetX,t.offsetY),this.ctx.stroke();var e=[t.offsetX,t.offsetY];this.lastX=e[0],this.lastY=e[1]}},stopDrawing:function(){this.isDrawing=!1,this.ctx.closePath();try{this.saveDrawingToBase64()}catch(t){}},clearCanvas:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},saveDrawingToBase64:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=1,t.bgCtx.clearRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.fillStyle="black",t.bgCtx.fillRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.drawImage(t.canvas,0,0,t.canvas2.width,t.canvas2.height),n=t.bgCtx.getImageData(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.putImageData(n,0,0),o=t.canvas2.toDataURL("image/png",.1),t.canvas.toDataURL()!==t.blankCanvas){e.next=14;break}return t.imgUrl="",t.top.updateLiveModeMask(t.imgUrl),t.$emit("updateMask",""),e.abrupt("return");case 14:if(o!==t.blankBgCanvas){e.next=18;break}return t.imgUrl="",t.top.updateLiveModeMask(t.imgUrl),e.abrupt("return");case 18:t.imgUrl=o,t.top.updateLiveModeMask(t.imgUrl),e.next=24;break;case 22:e.prev=22,e.t0=e.catch(1);case 24:case"end":return e.stop()}}),e,null,[[1,22]])})))()}}},ln=(n(5314),Object(_.a)(cn,(function(){var t,e,n,o,r=this,c=r._self._c;return c("div",{staticClass:"c-live-mode-redraw no-snapshot",style:{width:(null===(t=r.liveItemInfo)||void 0===t?void 0:t.width)+"px",height:(null===(e=r.liveItemInfo)||void 0===e?void 0:e.height)+"px",transform:"translate(".concat(null===(n=r.liveItemInfo)||void 0===n?void 0:n.x,"px, ").concat(null===(o=r.liveItemInfo)||void 0===o?void 0:o.y,"px)")}},[c("canvas",{ref:"canvas",staticClass:"live-mode-redraw-canvas",style:r.canvasStyle,attrs:{"data-drag":"no",width:r.liveItemInfo.width,height:r.liveItemInfo.height}}),r._v(" "),c("canvas",{ref:"canvas2",staticStyle:{display:"none"},attrs:{width:r.liveItemInfo.width,height:r.liveItemInfo.height}}),r._v(" "),r.imgUrl?c("img",{staticStyle:{display:"none"},attrs:{src:r.imgUrl,alt:""}}):r._e()])}),[],!1,null,"11216639",null).exports),un=n(208),dn={inject:["top"],props:["liveRef"],components:{LineLoading:un.default},data:function(){return{styleInfo:{}}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},size:function(){var t=this.liveInfo,e=t.x,n=t.y,o=t.width,r=t.height,c=t.show;return{x:e,y:n,width:o,height:r,zoom:(this.top.paintingBoardData.boardInfo||{}).zoom,show:c}}},watch:{size:{handler:function(t){var e=this;this.$nextTick((function(){e.styleInfo=e.getStyle(t)}))},deep:!0,immediate:!0},"liveInfo.result":function(t){t&&this.setLoading(!0)}},methods:{changePrompt:function(t){this.top.paintingBoardData.liveModel.prompt=t},setLoading:function(t){this.top.paintingBoardData.liveModel.loading=t},generateTextToText:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.liveRef.cutImg();case 1:case"end":return e.stop()}}),e)})))()},saveLayer:function(){var t=this.liveInfo,e=t.x,n=t.y,o=t.width,r=t.height,c=t.result,l=t.params,data={type:this.top.paintingBoardData.liveModel.show?"liveImgLayer":"imgLayer",imgSrc:c,x:e,y:n,width:o,height:r,params:l};this.top.addLayerItem(data)},downloadImg:function(){var t=this.liveInfo.result;Object(_t.M)(t)},getStyle:function(){var t=document.querySelector("#liveItemBox"),e=(null==t?void 0:t.getBoundingClientRect())||{},n=e.x,o=e.y,r=e.width;return{left:n+r+15+"px",top:o+"px",width:r+"px",height:e.height+"px"}}}},hn=(n(5315),Object(_.a)(dn,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"live-view",style:e.styleInfo,attrs:{"data-title":e.$t("Preview"),"data-drag":"no"}},[n("div",{staticClass:"live-show"},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.liveInfo.result,expression:"liveInfo.result"}],staticClass:"result-img",attrs:{src:e.liveInfo.result,alt:""},on:{load:function(t){return e.setLoading(!1)}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.liveInfo.result,expression:"liveInfo.result"}],staticClass:"handle"},[n("el-tooltip",{attrs:{effect:"dark",content:e.$t("canvas_save_hover")}},[n("i",{staticClass:"iconfont icon-icon_yijianxintuceng",on:{click:e.saveLayer}})]),e._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:e.$t("Download")}},[n("i",{staticClass:"iconfont icon-icon_xiazai",on:{click:e.downloadImg}})])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.liveInfo.loading,expression:"liveInfo.loading"}],staticClass:"loading no-snapshot"},[n("line-loading")],1)]),e._v(" "),n("div",{staticClass:"live-prompt"},[n("el-input",{ref:"textarea",attrs:{type:"textarea",value:null===(t=e.liveInfo)||void 0===t?void 0:t.prompt,placeholder:e.$t("PromptNotEmpty"),rows:2,resize:"none"},on:{change:e.generateTextToText,input:e.changePrompt},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.generateTextToText.apply(null,arguments))}}})],1)])}),[],!1,null,"6ea7b650",null)),vn=hn.exports,pn={inject:["top"],props:{info:{type:Object,default:function(){return{width:0,height:0,min:256,max:1024}}},isRatio:{type:Boolean,default:!0},isPauseLiveGenerate:{type:Boolean,default:!1}},data:function(){return{styleInfo:{}}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},liveSize:function(){var t=this.liveInfo;return{x:t.x,y:t.y,width:t.width,height:t.height,zoom:(this.top.paintingBoardData.boardInfo||{}).zoom}}},watch:{liveSize:{handler:function(t){var e=this;this.$nextTick((function(){e.setStyle(t)}))},deep:!0,immediate:!0}},methods:{changeSize:function(t,e){var n=this;this.top.paintingBoardData.liveModel[e]=t,document.querySelector("#liveItemBox").style[e]=t+"px",this.top.changeData("liveModel."+e,t),this.$nextTick((function(){n.top.liveBoxRef.updateRect()}))},setStyle:function(t){var e=document.querySelector("#liveItemBox"),n=(null==e?void 0:e.getBoundingClientRect())||{},o=n.x,r=n.y,c=n.width;this.styleInfo={left:o-70+"px",top:r-82+"px",width:c+"px"}},pauseLiveGenerate:function(){this.$emit("pauseLiveGenerate")}}},fn=(n(5316),Object(_.a)(pn,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"live-size",style:t.styleInfo},[e("div",{staticClass:"width box"},[e("span",{staticClass:"words"},[t._v("W")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.liveInfo.width,step:1,precision:0,controls:!1,min:t.liveInfo.min,max:t.liveInfo.max},on:{change:function(e){return t.changeSize(e,"width")}}})],1),t._v(" "),e("div",{staticClass:"height box"},[e("span",{staticClass:"words"},[t._v("H")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.liveInfo.height,step:1,precision:0,controls:!1,min:t.liveInfo.min,max:t.liveInfo.max},on:{change:function(e){return t.changeSize(e,"height")}}})],1),t._v(" "),e("div",{staticClass:"box box-right"},[e("span",{staticClass:"box-tips"},[t._v(t._s(t.isPauseLiveGenerate?t.$t("canvas_stop"):t.$t("canvas_start")))]),t._v(" "),e("i",{staticClass:"iconfont",class:t.isPauseLiveGenerate?"icon-a-bofang1":"icon-a-zanting11",on:{click:t.pauseLiveGenerate}})])])}),[],!1,null,"4151b1f6",null).exports),mn={name:"RightClickMenu",inject:["top"],props:{needMenu:{type:Boolean,default:!0},layerList:{type:Array,default:function(){return[]}},actionType:{type:String,default:"elementList"}},data:function(){return{isShowMenu:!1,menuTop:0,menuLeft:0}},computed:{getMenuPosition:function(){return{top:"".concat(this.menuTop,"px"),left:"".concat(this.menuLeft,"px")}},getActiveList:function(){return this.layerList.filter((function(t){return t.active}))||[]},renderMenuList:function(){var t=!1,e=!1,n=!1;if(1==this.getActiveList.length){var o,r,c,l=(null===(o=this.getActiveList)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.layerId)||"";t=!!l&&this.top.getEleInfo(l,"lock",this.actionType),e=!!((null===(r=this.getActiveList)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.params)||void 0===r?void 0:r.taskId)||""),n=(null===(c=this.getActiveList)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.z)>1e4}var d=[{label:"SaveToMyGallery",value:"saveToMyGallery"},{label:"taskTabUpscale",value:"upscale"},{label:"AdjustOrder",value:"adjustOrder",rightIcon:"el-icon-arrow-right",children:[{label:"ToTop",value:"toTop"},{label:"ToBottom",value:"toBottom"},{label:"MoveUp",value:"moveUp"},{label:"MoveDown",value:"moveDown"}]},{label:"LockImage",value:"lockImage",hide:t},{label:"UnlockPicture",value:"unlockImage",hide:!t},{label:"TransformTool",value:"transformTool",rightIcon:"el-icon-arrow-right",children:[{label:"FreeDeformation",value:"freeDeformation",hide:n},{label:"HorizontalFlip",value:"horizontalFlip"},{label:"VerticalFlip",value:"verticalFlip"},{label:"Clockwise90Deg",value:"clockwise90Deg"},{label:"Counterclockwise90Deg",value:"counterclockwise90Deg"}]},{label:"RestoreFaces",value:"restoreFaces"},{label:"copy",value:"copy"},{label:"Download",value:"download"},{label:"Publish",value:"publish",hide:!e}];return this.getActiveList.length>1?[{label:"SaveToMyGallery",value:"saveToMyGallery"},{label:"copy",value:"copy"},{label:"Download",value:"download"}]:d}},mounted:function(){document.body.appendChild(this.$refs.menu),document.addEventListener("click",this.handleClickOutside)},beforeDestroy:function(){document.body.removeChild(this.$refs.menu),document.removeEventListener("click",this.handleClickOutside)},methods:{showMenu:function(t,e){var n=this.getActiveList.length>1;if(this.getActiveList.length>0)if(n){var o=document.querySelector(".moveable-area");this.isShowMenu=o.contains(t.target)}else{var r,c=null===(r=this.getActiveList)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.layerId,l=document.querySelector("#img-".concat(c)),d=document.querySelector("#live-layer-".concat(c)),h=l&&l.contains(t.target),v=d&&d.contains(t.target);this.isShowMenu=h||v}"more"==e&&(this.isShowMenu=!0),this.menuTop=t.pageY,this.menuLeft=t.pageX;this.$refs.menu;var f=t.clientX,m=t.clientY,_=n?212:418,y=window.innerWidth;f+_>y&&(this.menuLeft=y-_-20);var w=n?110:308,C=window.innerHeight;m+w>C&&(this.menuTop=C-w)},closeMenu:function(){this.isShowMenu=!1},handleClickOutside:function(t){var e,n=null===(e=document.getElementsByClassName("top-btn-more"))||void 0===e?void 0:e[0];this.$refs.menu.contains(t.target)||(n?!n.contains(t.target)&&(this.isShowMenu=!1):this.isShowMenu=!1)},handleMenuClick:function(t){if(!this.top.token&&["saveToMyGallery","upscale","restoreFaces"].includes(t))return this.$EventBus.$emit("openLoginDialog",{callBack:function(){window.location.reload()}});this.$emit("rightMenuClick",t)}}},gn=(n(5317),Object(_.a)(mn,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-click-menu-container",on:{contextmenu:function(e){return e.preventDefault(),t.showMenu(e)}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowMenu&&t.needMenu,expression:"isShowMenu && needMenu"}],ref:"menu",staticClass:"right-click-menu",style:t.getMenuPosition},t._l(t.renderMenuList,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:!n.hide,expression:"!item.hide"}],key:n.value,staticClass:"item-menu",class:{"have-children":n.children}},[e("div",{staticClass:"label",on:{click:function(e){return t.handleMenuClick(n.value)}}},[t._v("\n        "+t._s(t.$t(n.label))+"\n        "),e("i",{staticClass:"ri-icon",class:n.rightIcon})]),t._v(" "),n.children?e("div",{staticClass:"sub-menu"},t._l(n.children,(function(sub){return e("div",{directives:[{name:"show",rawName:"v-show",value:!sub.hide,expression:"!sub.hide"}],key:sub.value,staticClass:"item-sub-menu",on:{click:function(e){return t.handleMenuClick(sub.value)}}},[t._v("\n          "+t._s(t.$t(sub.label))+"\n        ")])})),0):t._e()])})),0),t._v(" "),t._t("default")],2)}),[],!1,null,"f1ea6072",null).exports);function _n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_n(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var yn=null,wn={components:{generationFrame:Ve,BaseCanvas:Ge,LiveBox:ei,MoveContainer:ki,VueSelecto:Se.a,MoveItems:_i,MoveItem:pi,ImgMove:sn,AiPordImg:rn,liveModeRedraw:ln,LayerBtns:ni,AiImageTips:oi,LayerFooter:ci,LiveView:vn,LiveSize:fn,RightClickMenu:gn,EraserBottons:ji},inject:["top"],data:function(){return{layerList:[],AiImageTipsRef:null,liveRef:null,isPauseLiveGenerate:!1,isGripper:!1}},watch:{},computed:{showControlNetModal:function(){var t=this;return function(e){if(!t.top.paintingBoardData.liveModel.show)return e.id===t.top.paintingBoardData.controlNet.activeIndex;var n=t.top.paintingBoardData.elementList.findIndex((function(t){return(null==t?void 0:t.controlNetId)===e.id}));return t.top.paintingBoardData.liveModel.show&&-1===n&&e.id===t.top.paintingBoardData.controlNet.activeIndex}},showLiveModeRedraw:function(){return this.top.paintingBoardData.liveModel.show&&"daubBoard"===this.top.paintingBoardData.topNav.tools.hasAct},hasAct:function(){return this.top.paintingBoardData.topNav.tools.hasAct},showCanvasBox:function(){var t,e=this.top.paintingBoardData.topNav.tools,n="brushBoard"===(null==e?void 0:e.hasAct),o="brush"===(null==e||null===(t=e.brushTool)||void 0===t||null===(t=t.brushBoard)||void 0===t?void 0:t.hasAct),r=this.top.paintingBoardData.liveModel.show;return n&&o&&!r},targets:function(){var t=this.top.paintingBoardData.elementList,e=[];return t.forEach((function(t){var n=t.active,o=t.layerId,r=document.querySelector('[data-id="'+o+'"]');n&&r&&e.push(r)})),e},liveInfo:function(){return this.top.paintingBoardData.liveModel},getActiveList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.active}))||[]},getDarwList:function(){return this.top.paintingBoardData.elementList.filter((function(t){return t.hasDrawLine||t.hasRedraw}))||[]},aiEraserItem:function(){return this.top.paintingBoardData.elementList.find((function(t){return t.hasEraserDraw}))},showEraserBtn:function(){var t=this,e=this.top.paintingBoardData.elementList.find((function(t){return t.hasEraserDraw}));if(!e)return!1;var n=this.top.paintingBoardData.topNav.tools.hasAct,o=["imgLayer","brushLayer"].includes(e.type),r=["eraserBoard","eraserAiBoard"].includes(n),c=e.hasEraserDraw,l=!["",null,void 0].includes(null==e?void 0:e.mask),d=o&&r&&c&&l;return this.$nextTick((function(){t.$refs.eraserBottonsRef&&t.$refs.eraserBottonsRef.initPoin()})),d}},mounted:function(){this.infiniteBoard(),this.dragimgTowork(),this.top.eventFn.setBoardNoDage=this.setBoardNoDage,this.top.eventFn.setBoardYesDage=this.setBoardYesDage,this.top.eventFn.setViewYesDage=this.setViewYesDage,this.AiImageTipsRef=this.$refs.AiImageTipsRef,this.liveRef=this.$refs.liveBox},beforeDestroy:function(){clearTimeout()},methods:{pauseLiveGenerate:function(){this.isPauseLiveGenerate=!this.isPauseLiveGenerate,this.isPauseLiveGenerate||this.handleWatchLiveGenerate();var t=this.isPauseLiveGenerate?"click_stop":"click_start";this.$logEvent("log_actions",{operation:t,behavior_info:"on_canvas"})},handleWatchLiveGenerate:function(){var t=this;setTimeout((function(){t.liveRef.watchLive(t.top.paintingBoardData.liveModel,!0)}),1e3)},infiniteBoard:function(){var t=this,e=document.querySelector("#canvas-container").offsetWidth,n=document.querySelector("#canvas-container").offsetHeight;yn=new Ie.e(document.querySelector("#canvas-container"),document.querySelector("#canvas"),{zoom:.5,useMouseDrag:!1,useWheelScroll:!0,useAutoZoom:!1,zoomRange:[.1,10],margin:0}),this.top.setViewer(yn),this.top.changeData("boardInfo.viewW",e),this.top.changeData("boardInfo.viewH",n),yn.on("scroll",(function(e){var n=Object(ht.l)(),o=n.x,r=n.y,c={zoom:e.zoomX,inViewX:o,inViewY:r,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop},l=t.top.paintingBoardData.boardInfo;t.top.changeData("boardInfo",bn(bn({},l),c)),document.querySelector("#layerBtnsId").style.left="0px",document.querySelector("#layerBtnsId").style.top="0px",t.$nextTick((function(){t.$refs.eraserBottonsRef&&t.$refs.eraserBottonsRef.initPoin(),t.top.layerFooterRef.setPositionBox()})),t.top.initLayerActive()}))},onDragStart:function(t){var e=t.inputEvent.target,n=this.$refs.moveRef.moveableRef.isMoveableElement(e),o=this.targets.some((function(t){return t===e||t.contains(e)})),r=e.getAttribute("data-drag"),c=e.className,l=e.tagName,d=this.top.paintingBoardData.topNav.tools.hasAct,h=["upper-canvas base-canvas-box","brushBoard","brushImg","eraserBoard","eraserAiBoard","daubBoard"];(yn.useMouseDrag||n||o||h.includes(c)||h.includes(l)||h.includes(d)||r&&"no"===r)&&t.stop()},onSelectEnd:function(t){var e=this.top.paintingBoardData.elementList,n=this.$refs.moveRef.moveableRef,o=Object(Nt.a)("ctrlOrCmd").active;if(t.isDragStart&&(t.inputEvent.preventDefault(),n.waitToChangeTarget().then((function(){n.dragStart(t.inputEvent)}))),o){var c=Object(r.a)(t.selected,1)[0];if(c){var l=c.getAttribute("data-id"),d=this.top.getEleInfo(l),h=e.findIndex((function(t){return t.layerId===l}));this.top.changeData("elementList[".concat(h,"].active"),!d.active)}else this.top.initLayerActive()}else this.top.initLayerActive(),t.selected.forEach((function(t){var n=t.dataset.id,o=e.find((function(t){return t.layerId===n}));o&&(o.active=!0)}));this.$refs.layerBtnsRef.setPoin()},onSelect:function(t){},clickLayerItem:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).item},setBoardNoDage:function(){this.$refs.moveRef.draggable=!1,this.$refs.moveRef.scalable=!1},setBoardYesDage:function(){this.$refs.moveRef.draggable=!0,this.$refs.moveRef.scalable=!0},setViewYesDage:function(t){yn.useMouseDrag=t,this.isGripper=t},handContainer:function(){var t=this.top.paintingBoardData.elementList.map((function(em){return bn(bn({},em),{},{active:!1})}));this.top.changeData("elementList",t)},dragMove:function(){this.$refs.layerBtnsRef.hideBtn()},scaleIng:function(){this.$refs.layerBtnsRef.hideBtn()},renderGroup:function(){this.$refs.layerBtnsRef.hideBtn()},actionEnd:function(){this.$refs.layerBtnsRef.setPoin()},handleGroup:function(t){var e=this;this.$logEvent("log_actions",{operation:"click_".concat(t,"_image_operation"),behavior_info:"on_canvas_detail_page"});var canvas=document.createElement("canvas"),n=window,o=n.innerWidth,r=n.innerHeight;canvas.width=o,canvas.height=r;var l=canvas.getContext("2d");this.imagesLoaded=0,this.getActiveList.sort((function(a,b){return a.z-b.z}));var d=this.getActiveList.map((function(t){return e.loadImage(t).then((function(img){return bn({img:img},t)}))}));Promise.all(d).then((function(n){var o=e.top.paintingBoardData.boardInfo.zoom;n.forEach(function(){var n=Object(c.a)(regeneratorRuntime.mark((function n(r){var c,d,h,v,f,m,_,rect,y,w,C,k,O,x,I,S,param;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=r.layerId,d=r.renderWidth,h=r.renderHeight,v=document.querySelector("#".concat(c)).getBoundingClientRect(),f=v.left,m=v.top,l.drawImage(r.img,f,m,d*o,h*o),e.imagesLoaded++,e.imagesLoaded!==e.getActiveList.length){n.next=35;break}return _=document.querySelector(".moveable-area"),rect=_.getBoundingClientRect(),y=rect.left,w=rect.top,C=_.offsetWidth,k=_.offsetHeight,O=l.getImageData(y,w,C,k),(x=document.createElement("canvas")).width=C*o,x.height=k*o,x.getContext("2d").putImageData(O,0,0),I=x.toDataURL(),n.next=20,Object(ht.s)(I);case 20:I=n.sent,n.t0=t,n.next="imgToImg"===n.t0?24:"saveToMyGallery"===n.t0?26:"download"===n.t0?28:"copy"===n.t0?30:34;break;case 24:return e.handleGroupImgToImg(I),n.abrupt("break",35);case 26:return e.handleGroupSaveToMine(I),n.abrupt("break",35);case 28:return e.handleGroupDownload(I),n.abrupt("break",35);case 30:return S=e.top.paintingBoardData.liveModel.show,param={type:S?"liveImgLayer":"imgLayer",imgSrc:I},e.top.addLayerItem(param),n.abrupt("break",35);case 34:return n.abrupt("break",35);case 35:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())})).catch((function(t){console.error("加载图像时出错：",t)}))},loadImage:function(t){return new Promise((function(e,n){var img=new Image;img.crossOrigin="Anonymous",img.onload=function(){e(img)},img.onerror=n,img.src=t.imgSrc}))},handleGroupImgToImg:function(t){this.top.changeLeftMenu("Generate"),this.top.changeData("imageToImage.imgUrl",t)},handleGroupSaveToMine:function(t){var e=this;Object(Q.I)({items:[{category:"mine",image:t,name:""}]}).then((function(t){e.$message.success(e.$t("SaveSuccess")),e.$EventBus.$emit("updateMine"),e.top.changeLeftMenu("Mine")}))},handleGroupDownload:function(t){var img=new Image;img.crossOrigin="anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="layer-group.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},topBtnsClick:function(t,e){var n=this;this.groupToOneImage(t)?this.handleGroup(t):this.getActiveList.forEach((function(o){var r=n.$refs.imgMoveRef.findIndex((function(t){return t.comKey===o.layerId}));n.$refs.imgMoveRef[r].topBtnsClick(t,e)}))},layerFooterBtn:function(t){var e=this;this.getDarwList.forEach((function(n){var o=e.$refs.imgMoveRef.findIndex((function(t){return t.comKey===n.layerId}));e.$refs.imgMoveRef[o].tipsSubmit(t)}))},rightMenuClick:function(t){var e=this;if(this.groupToOneImage(t))return this.handleGroup(t),void this.closeRightMenu();this.getActiveList.forEach((function(n){var o=e.$refs.imgMoveRef.findIndex((function(t){return t.comKey===n.layerId}));e.$refs.imgMoveRef[o].rightMenuClick(t)}))},groupToOneImage:function(t){return this.getActiveList.length>1&&!["del","more"].includes(t)},showRightMenu:function(t,e){this.$refs.rightClickMenu.showMenu(t,e)},closeRightMenu:function(){this.$refs.rightClickMenu.closeMenu()},dragimgTowork:function(){var t=this,e=document.getElementById("canvas-container");["dragenter","dragover","dragleave","drop"].forEach((function(t){e.addEventListener(t,(function(t){t.preventDefault(),t.stopPropagation()}),!1)})),e.addEventListener("drop",(function(e){var dt=e.dataTransfer,n=Array.from(dt.files)[0];n&&n.type.includes("image")&&t.top.eventFn.uploadImg({file:n})}),!1)},updateOnEraser:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.top.paintingBoardData.elementList.filter((function(t){return t.hasEraserDraw})).forEach((function(n){var o=t.$refs.imgMoveRef.findIndex((function(t){return t.comKey===n.layerId}));t.$refs.imgMoveRef[o].updateOnEraser(e)}))}}},Cn=wn,kn=(n(5318),Object(_.a)(Cn,(function(){var t=this,e=t._self._c;return e("RightClickMenu",{ref:"rightClickMenu",attrs:{layerList:t.top.paintingBoardData.elementList},on:{rightMenuClick:t.rightMenuClick}},[e("div",{staticClass:"board-page wh100"},[e("div",{staticClass:"wh100",class:("handBoardel"===t.hasAct||t.isGripper)&&"gripper",attrs:{id:"canvas-container"}},[e("div",{staticClass:"flex_c_m",attrs:{id:"canvas"}},[e("move-items",{ref:"moveRef",attrs:{targets:t.targets,selectoRef:t.$refs.selectoRef},on:{actionEnd:t.actionEnd,drag:t.dragMove,scale:t.scaleIng,renderGroup:t.renderGroup}},[t._l(t.top.paintingBoardData.elementList||[],(function(n){return[e("img-move",{directives:[{name:"show",rawName:"v-show",value:n.show,expression:"e.show"}],key:n.layerId,ref:"imgMoveRef",refInFor:!0,staticClass:"move-item",attrs:{item:n,comKey:n.layerId},on:{showRightMenu:t.showRightMenu,closeRightMenu:t.closeRightMenu,onClick:t.clickLayerItem}})]}))],2),t._v(" "),"updateArimg"!==t.hasAct||t.liveInfo.show?t._e():e("ai-pord-img",{ref:"aiPordImgRef",attrs:{AiImageTipsRef:t.AiImageTipsRef}})],1),t._v(" "),t.showCanvasBox?e("base-canvas"):t._e()],1),t._v(" "),e("vue-selecto",{ref:"selectoRef",attrs:{dragContainer:"#canvas-container",selectableTargets:[".move-item"],hitRate:0,ratio:0,hitTest:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"]},on:{dragStart:t.onDragStart,selectEnd:t.onSelectEnd,select:t.onSelect}}),t._v(" "),e("layer-btns",{ref:"layerBtnsRef",on:{topBtnsClick:t.topBtnsClick}}),t._v(" "),t.showEraserBtn?e("eraser-bottons",{ref:"eraserBottonsRef",staticClass:"no-snapshot",attrs:{item:t.aiEraserItem},on:{updateImageSize:t.updateOnEraser}}):t._e(),t._v(" "),e("ai-image-tips",{directives:[{name:"show",rawName:"v-show",value:"updateArimg"===t.hasAct&&!t.liveInfo.show,expression:"hasAct === 'updateArimg' && !liveInfo.show"}],ref:"AiImageTipsRef",on:{onSubmit:function(e){t.$refs.aiPordImgRef.aiHtmlImg(e)}}}),t._v(" "),t._l(t.top.paintingBoardData.controlNet.controlnet_units||[],(function(n,o){return e("generation-frame",{directives:[{name:"show",rawName:"v-show",value:t.showControlNetModal(n),expression:"showControlNetModal(item)"}],key:n.id,model:{value:t.top.paintingBoardData.controlNet.controlnet_units[o],callback:function(e){t.$set(t.top.paintingBoardData.controlNet.controlnet_units,o,e)},expression:"top.paintingBoardData.controlNet.controlnet_units[index]"}})})),t._v(" "),e("layer-footer",{on:{onSubmit:t.layerFooterBtn}})],2)])}),[],!1,null,"51367baa",null).exports),On=n(824),xn=n(1232),In=n(5319);function Sn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var Dn={data:function(){return{}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sn(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(h.c)("user",["cdnHostFun"])),methods:{handelClose:function(t){this.$emit("handelClose"),"neverRemind"!==t?localStorage.setItem("CanvasTeachVideo",(new Date).getTime()):localStorage.setItem("CanvasTeachVideo",t)}}},Ln=Dn,Pn=(n(5321),Object(_.a)(Ln,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"video-box flex-center"},[e("div",{staticClass:"video-box-item flex-center",style:{backgroundImage:"url(https://".concat(t.cdnHostFun(),"/static/upload/20240206/8011a9fd-b1ad-4885-81d5-53b6255605c0.png)")}},[e("video",{staticClass:"video",attrs:{src:"https://".concat(t.cdnHostFun(),"/20240227/6edef9af-7839-4e77-88b2-4ffb1b404720.mov"),autoplay:"",loop:"",preload:"",muted:"",width:"100%",height:"100%"},domProps:{muted:!0}})]),t._v(" "),e("div",{staticClass:"btn flex-center"},[e("div",{staticClass:"btn-item flex-center",on:{click:function(e){return t.handelClose("neverRemind")}}},[t._v("\n      "+t._s(t.$t("teach_video_tips"))+"\n    ")]),t._v(" "),e("div",{staticClass:"btn-item flex-center",on:{click:function(e){return t.handelClose("todayClose")}}},[t._v("\n      "+t._s(t.$t("Off_10"))+"\n    ")])])])}),[],!1,null,"eb2d15e0",null).exports),jn={inject:["top"],props:{switchLive:{type:Boolean,default:!1}},data:function(){return{styleInfo:{}}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},isShowText:function(){var t=this.liveInfo,e=t.height;return t.width/e>.52},isClearDisabled:function(){return 0===this.top.paintingBoardData.liveLayerList.length}},methods:{changeSize:function(t,e){this.top.changeData("liveModel.".concat(e),t),Y.a.add(this.top.paintingBoardData),P.a.emit("liveCreateAiImg")},toggleSwitch:function(){this.$emit("toggleSwitch")},showSizeInput:function(t){var e=document.querySelector("#liveSizeId");t<=this.liveInfo.min+250?e.style.display="none":e.style.display="block"},clearLiveBoard:function(){var t=this;this.isClearDisabled||(this.top.changeData("liveLayerList",[]),this.top.changeData("liveModel.prompt",""),this.top.changeData("liveModel.result",""),this.top.changeData("liveModel.product_image_url",""),this.top.changeData("liveModel.pmask",""),setTimeout((function(){Y.a.add(t.top.paintingBoardData)}),0))}}},$n=(n(5322),Object(_.a)(jn,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"live-size",style:t.styleInfo},[e("div",{staticClass:"box-left",attrs:{id:"liveSizeId"}},[e("div",{staticClass:"flex_m"},[e("div",{staticClass:"box"},[e("span",{staticClass:"words"},[t._v("W")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.liveInfo.width,step:1,precision:0,controls:!1,min:t.liveInfo.min,max:t.liveInfo.max},on:{change:function(e){return t.changeSize(e,"width")}}})],1),t._v(" "),e("div",{staticClass:"box",attrs:{id:"liveSizeHeightId"}},[e("span",{staticClass:"words"},[t._v("H")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.liveInfo.height,step:1,precision:0,controls:!1,min:t.liveInfo.min,max:t.liveInfo.max},on:{change:function(e){return t.changeSize(e,"height")}}})],1)])]),t._v(" "),e("div",{staticClass:"box box-right"},[e("div",{staticClass:"box-clear",class:{disabled:t.isClearDisabled},on:{click:t.clearLiveBoard}},[e("i",{staticClass:"iconfont icon-delete-gpt"}),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.isShowText,expression:"isShowText"}],staticClass:"box-tips"},[t._v(t._s(t.$t("workFlow13")))])]),t._v(" "),e("i",{staticClass:"iconfont",class:t.switchLive?"icon-a-bofang1":"icon-a-zanting11",on:{click:t.toggleSwitch}}),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.isShowText,expression:"isShowText"}],staticClass:"box-tips"},[t._v(t._s(t.switchLive?t.$t("canvas_stop"):t.$t("canvas_start")))])])])}),[],!1,null,"2bf58fd7",null).exports),Tn=n(5330),Mn={inject:["top"],props:{item:{type:Object,default:function(){return{}}}},data:function(){return{baseCanvas:null,mask:""}},watch:{eraserAiBoard:{handler:function(t){this.baseCanvas&&this.setBrushStyle(t)},deep:!0,immediate:!0},"item.loading":function(t){t||this.baseCanvas.clear()}},computed:{eraserAiBoard:function(){return this.top.paintingBoardData.topNav.tools.eraserTool.eraserAiBoard}},mounted:function(){this.initBoard()},methods:{initBoard:function(){var t=this,e=this.item,n=document.querySelector("#aiEraserBox_"+e.layerId);this.baseCanvas=new ze.fabric.Canvas("aiEraserCanvas_"+e.layerId,{width:n.offsetWidth,height:n.offsetHeight});var o=this.eraserAiBoard,r=this.baseCanvas;r.isDrawingMode=!0,r.freeDrawingBrush.color="#fff",r.freeDrawingBrush.width=o.wide/5,r.on("path:created",(function(){setTimeout((function(){var n=r.lowerCanvasEl.toDataURL();t.updateMask(n,(function(n){t.top.setEleItem({id:e.layerId,type:"liveLayerList",item:{hasEraserDraw:!0}}),t.mask=n,t.$emit("drawEnd",{mask:n,item:e})}))}),100)}))},setBrushStyle:function(t){var e=this.baseCanvas;e.freeDrawingBrush.color="#fff",e.freeDrawingBrush.width=t.wide/5},updateMask:function(t,e){var n=this.item,o=n.realWidth,r=n.realHeight,img=new Image,canvas=document.createElement("canvas"),c=canvas.getContext("2d");canvas.width=o,canvas.height=r,img.src=t,img.onload=function(){c.drawImage(img,0,0,o,r);var t=canvas.toDataURL();e&&e(t)}}}},Rn=(n(5323),{inject:["top"],components:{AiEraserBox:Object(_.a)(Mn,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"board-max-box",attrs:{"data-drag":"no",id:"aiEraserBox_".concat(t.item.layerId)}},[e("canvas",{staticClass:"base-canvas-box",attrs:{"data-drag":"no",id:"aiEraserCanvas_".concat(t.item.layerId),width:"100%",height:"100%"}})])}),[],!1,null,"54026c0e",null).exports,LineLoading:un.default,AiLoading:Zi},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{canvas:null}},computed:{matrix3dVal:function(){return this.item.matrix3d||"1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1"},scaleFn:function(){var t=this.item.zoom;return Array.isArray(t)?t.join():[t,t].join()},showAiEraser:function(){var t=this.top.paintingBoardData.topNav.tools,e="eraserAiBoard"===t.hasAct,n="brush"===t.eraserTool.eraserAiBoard.hasAct;return e&&n}},watch:{"top.paintingBoardData.topNav.tools.brushTool.brushBoard":{handler:function(t){this.canvas&&this.setBrushStyle(t)},deep:!0,immediate:!0}},mounted:function(){var t=this;this.initBgCanvas(),P.a.on("openEasyEraser",this.openEasyEraser),P.a.on("closeEasyEraser",this.closeEasyEraser),P.a.on("filterColor",this.filterColor),P.a.on("initBgCanvas",this.initBgCanvas),window.addEventListener("focus",(function(){t.initBgCanvas()}))},methods:{initBgCanvas:function(){var t=this,e=this.item,n=e.layerId,o=e.width,r=e.height,c=e.canvasJson,l=c&&Object.keys(c).length;this.canvas||(this.canvas=new ze.fabric.Canvas("live-bgcanvas-".concat(n),{width:o,height:r,selectable:!1,selection:!1,crossOrigin:"anonymous"})),l&&this.canvas.loadFromJSON(c,(function(){t.noPperateCanvas(),t.canvas.renderAll()})),this.initImg({hasProdImg:!1}),this.filterColor()},initImg:function(){var canvas=this.canvas,t=this.item.imgSrc;ze.fabric.Image.fromURL(t,(function(img){canvas.setBackgroundImage(img,canvas.renderAll.bind(canvas),{scaleX:canvas.width/img.width,scaleY:canvas.height/img.height})}),{crossOrigin:"anonymous"})},openEasyEraser:function(){var t=this,canvas=this.canvas,e=this.item.layerId,n=this.top.paintingBoardData.topNav.tools.brushTool.brushBoard.wide;canvas.isDrawingMode=!0,canvas.freeDrawingBrush.color="#000",canvas.freeDrawingBrush.width=n/5,canvas.on("path:created",(function(n){n.path.globalCompositeOperation="destination-out";var o=canvas.toJSON();t.top.setEleItem({id:e,type:"liveLayerList",item:{canvasJson:o}}),Y.a.add(t.top.paintingBoardData),P.a.emit("liveCreateAiImg")})),this.noPperateCanvas()},setBrushStyle:function(t){console.log(t),this.canvas.freeDrawingBrush.width=t.wide/5},closeEasyEraser:function(){var canvas=this.canvas;canvas.isDrawingMode=!1,canvas.globalCompositeOperation="source-over",this.noPperateCanvas()},filterColor:function(data){var t=data||this.item,e=t.layerId,n=document.querySelector("#live-bgcanvas-"+e),style=Object(ht.i)(t);n&&(n.style.filter=style)},noPperateCanvas:function(){this.canvas.forEachObject((function(t){t.selectable=!1,t.lockUniScaling=!0,t.lockRotation=!0}))},aiEraserDrawEnd:function(t){t.item;var mask=t.mask;P.a.emit("setAiEraserLocation",{theItem:this.item,mask:mask})}}}),An=Rn,En=(n(5324),Object(_.a)(An,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.item.show,expression:"item.show"}],staticClass:"live-layer-box",style:{zIndex:t.item.z,width:t.item.width+"px",height:t.item.height+"px",transform:"translate(".concat(t.item.x,"px, ").concat(t.item.y,"px) rotate(").concat(t.item.rotate,"deg) scale(").concat(t.scaleFn,") matrix3d(").concat(t.matrix3dVal,")"),clipPath:t.item.clipPath},attrs:{id:"live-layer-".concat(t.item.layerId),"data-id":t.item.layerId,"data-type":t.item.type}},[e("div",{staticClass:"base-canvas-bg"},[e("canvas",{attrs:{id:"live-bgcanvas-".concat(t.item.layerId)}})]),t._v(" "),t.showAiEraser?e("div",{staticClass:"ai-eraser-box"},[e("ai-eraser-box",{attrs:{item:t.item},on:{drawEnd:t.aiEraserDrawEnd}})],1):t._e(),t._v(" "),e("ai-loading",{directives:[{name:"show",rawName:"v-show",value:t.item.loading,expression:"item.loading"}],attrs:{mode:"live"}})],1)}),[],!1,null,"07bc183e",null).exports),Bn=null,Nn={inject:["top"],data:function(){return{}},watch:{"top.paintingBoardData.topNav.tools.brushTool.brushBoard":{handler:function(t){Bn&&this.setBrushStyle(t)},deep:!0,immediate:!0}},mounted:function(){this.initBoard()},methods:{initBoard:function(){var t=document.querySelector("#liveBoardMaxBox").offsetWidth,e=document.querySelector("#liveBoardMaxBox").offsetHeight;Bn=new ze.fabric.Canvas("liveBaseCanvasBox",{width:t,height:e});var n=this.top.paintingBoardData.topNav.tools.brushTool.brushBoard;Bn.isDrawingMode=!0,Bn.freeDrawingBrush.color=n.color,Bn.freeDrawingBrush.width=n.wide/5,this.brushToImg(Bn)},setBrushStyle:function(t){Bn.freeDrawingBrush.color=t.color,Bn.freeDrawingBrush.width=t.wide/5},brushToImg:function(canvas){var t,e=this,n=!1;canvas.on("mouse:down",(function(e){n=!0,t=canvas.getPointer(e.e)})),canvas.on("mouse:up",(function(){n=!1;var t=canvas.getObjects().filter((function(t){return t.isType("path")}));if(t.length>0){var o=new ze.fabric.Group(t),r=o.getBoundingRect(),c=document.createElement("canvas");e.top.paintingBoardData.boardInfo.zoom;c.width=r.width,c.height=r.height;var l=c.getContext("2d"),d=-r.left,h=-r.top;l.translate(d,h),o.render(l);var v=c.toDataURL("image/png"),param={type:e.top.paintingBoardData.liveModel.show?"liveBrushLayer":"brushLayer",imgSrc:v,cursorX:r.left,cursorY:r.top};e.top.addLayerItem(param)}setTimeout((function(){canvas.clear()}),500)})),canvas.on("mouse:move",(function(e){if(n){var o=canvas.getPointer(e.e),path=new ze.fabric.Path("M ".concat(t.x," ").concat(t.y," L ").concat(o.x," ").concat(o.y));canvas.add(path),t={x:o.x,y:o.y}}}))}}},Fn=(n(5325),Object(_.a)(Nn,(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"board-max-box",attrs:{"data-drag":"no",id:"liveBoardMaxBox"}},[t("canvas",{staticClass:"base-canvas-box",attrs:{"data-drag":"no",id:"liveBaseCanvasBox",width:"100%",height:"100%"}})])}],!1,null,"73b6892e",null).exports),Un={inject:["top"],data:function(){return{leftX:-5e3,topY:-5e3,width:0,activeList:[]}},mounted:function(){P.a.on("setLayerTopLocation",this.setLocation),P.a.on("hideLayerTopArea",this.hideArea)},methods:{setLocation:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,o=void 0===n?"live":n,c=e.eleKey,l=void 0===c?"liveLayerList":c,d=(this.top.paintingBoardData.boardInfo.zoom,this.top.paintingBoardData[l]);this.activeList=d.filter((function(t){return t.active}))||[];var h=this.activeList;if(0!==h.length){if(1===h.length){var v=Object(r.a)(this.activeList,1)[0],f=document.querySelector("#".concat({general:"img-",live:"live-layer-"}[o]).concat(v.layerId));if(f){var m=f.getBoundingClientRect();this.leftX=m.left,this.topY=m.top-50,this.width=m.width}}h.length>1&&setTimeout((function(){var e=document.querySelector(".moveable-area").getBoundingClientRect();t.leftX=e.left,t.topY=e.top-50,t.width=e.width}),100)}else this.hideArea()},hideArea:function(){this.leftX=-5e3,this.topY=-5e3},setAreaTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.topY=this.topY-t}}},Hn=Un,Vn=(n(5326),Object(_.a)(Hn,(function(){var t=this;return(0,t._self._c)("div",{staticClass:"layer-top-area",style:{top:t.topY+"px",left:t.leftX+"px",width:t.width+"px"}},[t._t("default",null,{item:{width:t.width,activeList:t.activeList}})],2)}),[],!1,null,"0de4d2cc",null).exports),zn=n(3187),Wn={inject:["top"],props:{areaItem:{type:Object,default:function(){return{}}}},data:function(){return{size:"1024x1024"}},computed:{list:function(){var t=this.areaItem.activeList.length,e=zn.a;return t>1&&(e=zn.a.filter((function(t){return t.show.includes("multiple")}))),e}},watch:{areaItem:{handler:function(){this.sizeText()},deep:!0}},methods:{handleEvent:function(t,e){var n=this.areaItem.activeList;this.$emit("topBtnsClick",{event:e,type:t,list:n})},sizeText:function(){var t=this,e=this.top.paintingBoardData.liveModel.zoom,n=this.areaItem.activeList;if(n.length>1){var o=e/100;setTimeout((function(){var e=document.querySelector(".moveable-area").getBoundingClientRect(),n=parseInt(e.width/o),r=parseInt(e.height/o);t.size="".concat(n," * ").concat(r),t.top.actLayerSize=[n,r],t.top.handleSelectSize(n,r,"multiple")}),100)}if(1===n.length){var c=Object(r.a)(n,1)[0],l=parseInt(c.renderWidth),d=parseInt(c.renderHeight);this.size="".concat(l," * ").concat(d),this.top.actLayerSize=[l,d],this.top.handleSelectSize(l,d)}}}},qn=(n(5327),Object(_.a)(Wn,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"top-action-nav flex"},[e("div",{staticClass:"action-list flex",attrs:{"data-active":"no"}},t._l(t.list,(function(n){return e("div",{key:n.icon,staticClass:"item-box",attrs:{"data-active":"no"}},[e("div",{staticClass:"item flex_c_m",class:"top-btn-".concat(n.type),attrs:{"data-active":"no"},on:{click:function(e){return t.handleEvent(n.type,e)}}},[e("el-tooltip",{attrs:{effect:"dark",disabled:!n.hoverTips,content:t.$t(n.hoverTips),placement:"bottom"}},[e("i",{staticClass:"iconfont",class:n.icon,style:{fontSize:n.size},attrs:{"data-active":"no"}})])],1)])})),0)])])}),[],!1,null,"4b9fceef",null).exports),Gn={props:{icon:{type:String,default:"icon-icon_caiqie"},areaItem:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{handleClipDone:function(){var t=this.areaItem.activeList;this.$emit("topConfirm",{list:t,type:"clipOk"})}}},Yn=(n(5328),Object(_.a)(Gn,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"clip-box"},[e("div",{staticClass:"left"},[e("i",{staticClass:"iconfont",class:t.icon})]),t._v(" "),e("div",{staticClass:"right",on:{click:t.handleClipDone}},[t._v(t._s(t.$t("Done")))])])])}),[],!1,null,"76462d2c",null).exports),Kn={inject:["top"],props:{icon:{type:String,default:"icon-icon_caiqie"}},data:function(){return{leftX:-5e3,topY:-5e3,mask:"",drawItem:{},loading:!1,taskId:""}},mounted:function(){P.a.on("setAiEraserLocation",this.setLocation),P.a.on("hideAiEraserTopArea",this.hideArea),P.a.on("setEraserLoading",this.setEraserLoading),P.a.on("setEraserTaskId",this.setEraserTaskId)},methods:{setLocation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.type,n=void 0===e?"live":e,o=t.theItem,mask=t.mask,r=o.layerId,c=document.querySelector("#".concat({general:"img-",live:"live-layer-"}[n]).concat(r)).getBoundingClientRect();this.leftX=c.left,this.topY=c.top-50,this.width=c.width,this.drawItem=o,this.mask=mask},setEraserLoading:function(t){this.loading=t,!t&&this.hideArea()},setEraserTaskId:function(t){this.taskId=t},hideArea:function(){this.leftX=-5e3,this.topY=-5e3},handleSubmit:function(){this.$emit("onSubmit",{item:this.drawItem,maskUrl:this.mask})},handleCancel:function(){var t=this,e={action:5,task_id:this.taskId},n=this.drawItem.layerId;this.loading=!1,this.top.setEleItem({id:n,type:"liveLayerList",item:{loading:!1}}),this.hideArea(),Object(Q.h)(e).finally((function(){t.$emit("onCancel",{item:t.drawItem,maskUrl:t.mask})}))}}},Jn=Kn,Xn=(n(5329),Object(_.a)(Jn,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-aieraser-area",style:{top:t.topY+"px",left:t.leftX+"px"}},[e("div",{staticClass:"clip-box"},[e("div",{staticClass:"left"},[e("i",{staticClass:"iconfont",class:[t.loading?"el-icon-loading":"icon-icon_zidongcachu1"]})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"right btn-init",on:{click:t.handleSubmit}},[t._v("\n      "+t._s(t.$t("canvas_erase_hover"))+"\n    ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"right btn-gray",on:{click:t.handleCancel}},[t._v("\n      "+t._s(t.$t("Cancel"))+"\n    ")])])])}),[],!1,null,"16d248eb",null).exports),Qn=n(98),Zn=n(216);function ta(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ea(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ta(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ta(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ia={inject:["top"],components:{VueInfiniteViewer:Tn.a,Moveable:Ye.a,Selecto:Se.a,ImgLayer:En,RightClickMenu:gn,LayerTopArea:Vn,LayerTopBtns:qn,LayerTopConfirm:Yn,TopAiEraserConfirm:Xn,MaxCanvas:Fn},props:{width:{type:String,default:"128px"},height:{type:String,default:"128px"}},data:function(){return{viewerScrollFn:Object(Qn.a)(this.viewerScrollEnd,200),viewerProps:{useMouseDrag:!1,useWheelScroll:!0,useAutoZoom:!1,zoomRange:[.1,10],margin:0},moveableProps:{draggable:!0,rotatable:!0,origin:!1,scalable:!0,resizable:!1,rotationPosition:"bottom"},keepRatio:!1,navSizeInfo:{x:0,y:0},moveableRef:null,selectoRef:null,loopInterval:null}},computed:{targets:function(){var t=this.top.paintingBoardData.liveLayerList,e=[];return t.forEach((function(t){var n=t.active,o=t.layerId,r=document.querySelector("#live-layer-".concat(o));n&&r&&e.push(r)})),e},liveInfo:function(){return this.top.paintingBoardData.liveModel},getActiveList:function(){return this.top.paintingBoardData.liveLayerList.filter((function(t){return t.active}))||[]},showTopBtn:function(){return this.getActiveList.every((function(t){return!t.cropping}))},clippable:function(){var t=Object(r.a)(this.getActiveList,1)[0],e=void 0===t?{}:t;return 1==this.getActiveList.length&&(this.keepRatio=!1,e.cropping)},showAiEraser:function(){var t=this.top.paintingBoardData.topNav.tools,e="eraserAiBoard"===t.hasAct,n="brush"===t.eraserTool.eraserAiBoard.hasAct,o=this.top.paintingBoardData.liveModel.show;return e&&n&&o},warpable:function(){var t=Object(r.a)(this.getActiveList,1)[0],e=void 0===t?{}:t;return 1==this.getActiveList.length&&(this.moveableProps.scalable=!e.freeDeformation,e.freeDeformation)},showLiveMaxCanvas:function(){var t,e=this.top.paintingBoardData.topNav.tools,n="brushBoard"===(null==e?void 0:e.hasAct),o="brush"===(null==e||null===(t=e.brushTool)||void 0===t||null===(t=t.brushBoard)||void 0===t?void 0:t.hasAct),r=this.top.paintingBoardData.liveModel.show;return n&&o&&r}},mounted:function(){this.eventAdd()},beforeDestroy:function(){clearInterval(this.loopInterval),this.loopInterval=null},methods:{initBoard:function(){var t=this;this.moveableRef=this.$refs.moveableRef,this.selectoRef=this.$refs.selectoRef,this.$nextTick((function(){t.setLiveViewer()}))},eventAdd:function(){P.a.on("setLiveMoveable",this.setLiveMoveable),P.a.on("setLiveViewer",this.setLiveViewer)},setLiveMoveable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.top.paintingBoardData.liveModel.show){var e=this.moveableProps;this.moveableProps=ea(ea({},e),t)}},setLiveViewer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.top.paintingBoardData.liveModel.show){var e=this.viewerProps;this.viewerProps=ea(ea({},e),t)}},viewerScroll:function(t){var e=this.top.paintingBoardData.liveModel,n=t.currentTarget._viewportElement,o=Object(ht.l)(n),r={inViewX:o.x,inViewY:o.y,scrollLeft:t.scrollLeft,scrollTop:t.scrollTop};this.top.initLiveLayerActive(),this.$refs.liveRightClickMenu.closeMenu(),P.a.emit("hideLayerTopArea");var c=ea(ea({},e),r);this.viewerScrollFn({liveInfo:c})},viewerScrollEnd:function(t){this.top.changeData("liveModel",t.liveInfo),this.top.hasActiveHistory},onSelectStart:function(t){var e=this.top.paintingBoardData.topNav,n=this.$refs.moveableRef,o=t.inputEvent.target,r=n.isMoveableElement(o),c=this.targets.some((function(t){return t===o||t.contains(o)})),l=["selectEments"].includes(e.tools.hasAct);(r||c||!l)&&t.stop()},onSelectEnd:function(t){var e=this.$refs.moveableRef,n=Object(Nt.a)("ctrlOrCmd").active,o=this.top.paintingBoardData.liveLayerList;t.isDragStart&&(t.inputEvent.preventDefault(),e.waitToChangeTarget().then((function(){e.dragStart(t.inputEvent)}))),"no"===t.inputEvent.target.getAttribute("data-active")||(!n&&this.top.initLiveLayerActive(),t.selected.forEach((function(t){var e=t.getAttribute("data-id"),r=o.find((function(t){return t.layerId===e}));n?r&&(r.active=!r.active):r&&(r.active=!0)})),P.a.emit("setLayerTopLocation"))},onClickGroup:function(t){this.$refs.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText})),P.a.emit("hideLayerTopArea"),this.$refs.liveRightClickMenu.closeMenu()},renderGroupEnd:function(t){var e=this.top.paintingBoardData.liveLayerList,n=this.liveInfo.zoom/100,o=t.events.map((function(t){var e=t.target.getAttribute("data-id"),o=document.querySelector("#live-layer-"+e).getBoundingClientRect(),c=Object(ht.r)(t.transform),l=c.translate,d=c.rotate,h=c.scale,v=Object(r.a)(l,2);return{layerId:e,x:v[0],y:v[1],rotate:d,zoom:h,renderWidth:parseInt(o.width/n),renderHeight:parseInt(o.height/n)}})),c=e.map((function(t){var e=o.find((function(em){return em.layerId===t.layerId}));return ea(ea({},t),e)}));P.a.emit("setLayerTopLocation"),this.top.changeData("liveLayerList",c),P.a.emit("liveCreateAiImg"),t.isDrag&&Y.a.add(this.top.paintingBoardData)},onDragStart:function(t){if(t.target){var e=t.target.getAttribute("data-id");this.top.getEleInfo(e,"lock","liveLayerList")&&t.stop()}},onDrag:function(t){t.target.style.transform=t.transform,this.$refs.liveRightClickMenu.closeMenu(),P.a.emit("hideLayerTopArea")},onDragEnd:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(r.a)(t.lastEvent.translate,2),o=n[0],c=n[1];this.top.setEleItem({id:e,type:"liveLayerList",item:{x:o,y:c}}),P.a.emit("setLayerTopLocation"),P.a.emit("liveCreateAiImg"),Y.a.add(this.top.paintingBoardData)}},scaleGroupStart:function(t){var e=t.direction.join(""),n=this.targets.length>1;this.keepRatio=["-1-1","1-1","11","-11"].includes(e)&&n},onScaleStart:function(t){var e=t.direction.join("");this.keepRatio=["-1-1","1-1","11","-11"].includes(e);var n=t.target.getAttribute("data-id");this.top.getEleInfo(n,"lock","liveLayerList")&&t.stop()},onScale:function(t){t.target.style.transform=t.drag.transform,P.a.emit("hideLayerTopArea"),this.$refs.liveRightClickMenu.closeMenu()},onScaleEnd:function(t){if(t.lastEvent){var e=this.liveInfo.zoom,n=t.target.getAttribute("data-id"),o=t.lastEvent.scale||[],c=document.querySelector("#live-layer-"+n).getBoundingClientRect(),l=Object(r.a)(Object(ht.r)(t.lastEvent.afterTransform).translate,2),d=l[0],h=l[1],v=parseInt(c.width/(e/100)),f=parseInt(c.height/(e/100));this.top.setEleItem({id:n,type:"liveLayerList",item:{renderWidth:v,renderHeight:f,x:d,y:h,zoom:o}}),P.a.emit("setLayerTopLocation"),P.a.emit("liveCreateAiImg"),Y.a.add(this.top.paintingBoardData)}},rotateStart:function(t){var e=t.target.getAttribute("data-id");this.top.getEleInfo(e,"lock","liveLayerList")&&t.stop()},onRotate:function(t){t.target.style.transform=t.drag.transform,P.a.emit("hideLayerTopArea"),this.$refs.liveRightClickMenu.closeMenu()},onRotateEnd:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=t.lastEvent.rotate,o=Object(r.a)(Object(ht.r)(t.lastEvent.transform).translate,2),c=o[0],l=o[1];this.top.setEleItem({id:e,type:"liveLayerList",item:{rotate:n,x:c,y:l}}),P.a.emit("setLayerTopLocation"),P.a.emit("liveCreateAiImg"),Y.a.add(this.top.paintingBoardData)}},onClip:function(t){t.target.style.clipPath=t.clipStyle},onWarp:function(t){t.target.style.transform=t.transform},onWarpEnd:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(ht.r)(t.lastEvent.transform).matrix3d;this.top.setEleItem({id:e,type:"liveLayerList",item:{matrix3d:n}}),P.a.emit("liveCreateAiImg"),Y.a.add(this.top.paintingBoardData)}},topBtnsClick:function(){var t=this,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=data.event,n=data.type,o=data.list,r=!0,c=this;"more"===n&&(this.$refs.liveRightClickMenu.showMenu(e,n),setTimeout((function(){t.$refs.liveRightClickMenu.isShowMenu=!0}),0)),"del"===n&&(Zn.delLayer({that:c,isLive:r,list:o}),P.a.emit("hideLayerTopArea"),this.$refs.liveRightClickMenu.closeMenu()),"download"===n&&Zn.downLayerImg({list:o,event:e,isLive:r}),"removeBg"===n&&Zn.removeLayerBg({that:c,list:o,event:e,isLive:r}),"clip"===n&&Zn.toggleCropping({that:c,list:o,event:e,isLive:r})},topConfirm:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=data.type,e=data.list,n=!0;"clipOk"===t&&(Zn.toggleCropping({that:this,list:e,isLive:n}),Zn.croppingOk({that:this,list:e,isLive:n}))},aiEraserSubmit:function(t){Zn.aiEraserSubmit({that:this,theitem:t,isLive:!0})},aiEraserCancel:function(t){Zn.aiEraserCancel({that:this,theitem:t,isLive:!0})},rightMenuClick:function(t){var e=this.getActiveList,n=!0,o=this;"saveToMyGallery"===t&&Zn.handleSaveMaterial({that:o,list:e,isLive:n}),"upscale"===t&&Zn.handleUpscale({that:o,list:e,isLive:n}),"lockImage"===t&&Zn.toggleLockImage({that:o,list:e,isLive:n,lock:!0}),"unlockImage"===t&&Zn.toggleLockImage({that:o,list:e,isLive:n,lock:!1}),"restoreFaces"===t&&Zn.handleRestoreFaces({that:o,list:e,isLive:n}),"copy"===t&&Zn.copyLayer({that:o,list:e,isLive:n}),"freeDeformation"===t&&Zn.freeDeformation({that:o,list:e,isLive:n});["horizontalFlip","verticalFlip","clockwise90Deg","counterclockwise90Deg"].includes(t)&&(Zn.changeRunLayer({that:o,list:e,isLive:n,rightType:t}),P.a.emit("hideLayerTopArea"));["toTop","toBottom","moveUp","moveDown"].includes(t)&&Zn.changOrderLayer({that:o,list:e,isLive:n,rightType:t}),"download"===t&&Zn.downLayerImg({list:e,isLive:n}),["adjustOrder","transformTool"].includes(t)||this.$refs.liveRightClickMenu.closeMenu()},handleWheel:function(t){var e=t.ctrlKey,n=t.metaKey;t.deltaY;if(e||n){t.preventDefault()}},handleChangeZoom:function(t){var e=this.liveInfo.zoom;t?e-=10:e+=10,this.top.changeData("liveModel.zoom",e)}}},na=ia,aa=(n(5331),Object(_.a)(na,(function(){var t=this,e=t._self._c;return e("div",{style:{width:t.width,height:t.height,position:"relative"},on:{wheel:t.handleWheel}},[e("RightClickMenu",{ref:"liveRightClickMenu",attrs:{layerList:t.top.paintingBoardData.liveLayerList,actionType:"liveLayerList"},on:{rightMenuClick:t.rightMenuClick}},[e("div",{staticClass:"works-max-box",attrs:{id:"viewerAmxBoxId"}},[e("div",{staticClass:"viewport-box",attrs:{id:"viewportCanvasId"}},[t._l(t.top.paintingBoardData.liveLayerList||[],(function(n){return[["liveImgLayer","liveBrushLayer","liveProductImgLayer"].includes(n.type)?e("img-layer",{key:n.layerId,staticClass:"live-layer-item",attrs:{item:n}}):t._e()]}))],2),t._v(" "),t.showLiveMaxCanvas?e("max-canvas"):t._e()],1),t._v(" "),e("Moveable",t._b({ref:"moveableRef",attrs:{target:t.targets,keepRatio:t.keepRatio,clippable:t.clippable,warpable:t.warpable},on:{clickGroup:t.onClickGroup,renderGroup:t.onRenderGroup,renderGroupEnd:t.renderGroupEnd,dragStart:t.onDragStart,drag:t.onDrag,dragEnd:t.onDragEnd,scaleStart:t.onScaleStart,scale:t.onScale,scaleEnd:t.onScaleEnd,scaleGroupStart:t.scaleGroupStart,rotateStart:t.rotateStart,rotate:t.onRotate,rotateEnd:t.onRotateEnd,clip:t.onClip,warp:t.onWarp,warpEnd:t.onWarpEnd}},"Moveable",t.moveableProps,!1))],1),t._v(" "),e("Selecto",{ref:"selectoRef",attrs:{dragContainer:"#viewerAmxBoxId",selectableTargets:[".viewport-box .live-layer-item"],hitRate:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"],ratio:0},on:{dragStart:t.onSelectStart,selectEnd:t.onSelectEnd}}),t._v(" "),e("layer-top-area",{directives:[{name:"show",rawName:"v-show",value:t.showTopBtn,expression:"showTopBtn"}],scopedSlots:t._u([{key:"default",fn:function(n){var o=n.item;return[e("layer-top-btns",{attrs:{areaItem:o},on:{topBtnsClick:t.topBtnsClick}})]}}])}),t._v(" "),e("layer-top-area",{directives:[{name:"show",rawName:"v-show",value:t.clippable,expression:"clippable"}],scopedSlots:t._u([{key:"default",fn:function(n){var o=n.item;return[e("layer-top-confirm",{attrs:{areaItem:o,icon:"icon-icon_caiqie"},on:{topConfirm:t.topConfirm}})]}}])}),t._v(" "),e("top-ai-eraser-confirm",{directives:[{name:"show",rawName:"v-show",value:t.showAiEraser,expression:"showAiEraser"}],attrs:{icon:"icon-icon_caiqie"},on:{onSubmit:t.aiEraserSubmit,onCancel:t.aiEraserCancel}})],1)}),[],!1,null,"4cd43d18",null).exports),sa=null,oa={inject:["top"],data:function(){return{}},watch:{redrawBoard:{handler:function(t){sa&&this.setBrushStyle(t)},deep:!0,immediate:!0}},computed:{redrawBoard:function(){return this.top.paintingBoardData.topNav.tools.daubTool.redrawBoard}},mounted:function(){this.initBoard(),P.a.on("openRedrawEraser",this.openRedrawEraser),P.a.on("closeRedrawEraser",this.closeRedrawEraser)},methods:{initBoard:function(){var t=this,e=document.querySelector("#RedrawingAreaId").offsetWidth,n=document.querySelector("#RedrawingAreaId").offsetHeight;sa=new ze.fabric.Canvas("liveRedrawingBox",{width:e,height:n});var o=this.redrawBoard;sa.isDrawingMode=!0,sa.freeDrawingBrush.color="#fff",sa.freeDrawingBrush.width=o.wide/5,"eraser"===o.hasAct?this.openRedrawEraser():this.closeRedrawEraser(),sa.on("after:render",(function(e){setTimeout((function(){var e=sa.lowerCanvasEl.toDataURL("image/png");Object(ht.q)(e,(function(e){var n=e.replace("data:image/png;base64,","");t.top.paintingBoardData.liveModel.product_image_url?t.top.changeData("liveModel.pmask",n):t.top.changeData("liveModel.mask",n),P.a.emit("getProductMask")}))}),0)}))},openRedrawEraser:function(){sa.on("path:created",(function(t){t.path.globalCompositeOperation="destination-out"}))},closeRedrawEraser:function(){sa.on("path:created",(function(t){t.path.globalCompositeOperation="source-over"}))},setBrushStyle:function(t){sa.freeDrawingBrush.color="#fff",sa.freeDrawingBrush.width=t.wide/5}}},ra=(n(5332),Object(_.a)(oa,(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"board-max-box",attrs:{"data-drag":"no",id:"RedrawingAreaId"}},[t("canvas",{staticClass:"base-canvas-box",attrs:{"data-drag":"no",id:"liveRedrawingBox",width:"100%",height:"100%"}})])}],!1,null,"56e167c4",null).exports);function ca(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var la={inject:["top"],components:{AiLoading:Zi},data:function(){return{oldParams:{}}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},size:function(){var t=this.liveInfo,e=t.x,n=t.y,o=t.width,r=t.height,c=t.show;return{x:e,y:n,width:o,height:r,zoom:(this.top.paintingBoardData.boardInfo||{}).zoom,show:c}},liveLoading:function(){return this.top.liveProdLoading},watchParams:function(){var t=this.top.paintingBoardData;return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ca(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ca(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({basicParams:t.basicParams},t.currentParams)}},watch:{"liveInfo.result":function(t){t&&this.setLoading(!0)},watchParams:{handler:function(t){this.paramsChange(t)},deep:!0}},methods:{paramsChange:function(t){var e,n=this.getChangeType(t),o=this.top.paramsLoading,r="default"===n||"live"===n||""===n;this.oldParams=JSON.parse(JSON.stringify(t)),null!==(e=this.liveInfo)&&void 0!==e&&e.show&&r&&!o&&(P.a.emit("setHasActiveHistory",!1),P.a.emit("liveCreateAiImg"))},getChangeType:function(t){var e=t.samplerSettingsDefault,n=t.samplerSettingsLive,o=this.oldParams||{},r=o.samplerSettingsDefault,c=o.samplerSettingsLive;return c?JSON.stringify(e)!==JSON.stringify(r)?"default":JSON.stringify(n)!==JSON.stringify(c)?"live":"":"first"},setLoading:function(t){this.top.liveProdLoading=t},saveLayer:function(){var t=this.liveInfo,e=t.width,n=t.height,o=t.result,data={type:this.top.paintingBoardData.liveModel.show?"liveImgLayer":"imgLayer",imgSrc:o,width:e,height:n,aiCreateImg:!1};this.top.addLayerItem(data)},downloadImg:function(){var t=this.liveInfo.result;Object(_t.M)(t)},layerActiveFalse:function(){P.a.emit("hideLayerTopArea"),this.top.initLiveLayerActive()}}},ua=la,da=(n(5333),Object(_.a)(ua,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"live-result-box"},[e("div",{staticClass:"resultimg-box",on:{click:t.layerActiveFalse}},[e("img",{directives:[{name:"show",rawName:"v-show",value:t.liveInfo.result,expression:"liveInfo.result"}],staticClass:"result-img",attrs:{src:t.liveInfo.result,alt:"",draggable:"false"},on:{load:function(e){return t.setLoading(!1)},error:function(e){return t.setLoading(!1)}}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.liveInfo.result,expression:"liveInfo.result"}],staticClass:"handle"},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("canvas_save_hover")}},[e("i",{staticClass:"iconfont icon-icon_yijianxintuceng",on:{click:t.saveLayer}})]),t._v(" "),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("Download")}},[e("i",{staticClass:"iconfont icon-icon_xiazai",on:{click:t.downloadImg}})])],1),t._v(" "),e("ai-loading",{directives:[{name:"show",rawName:"v-show",value:t.liveLoading,expression:"liveLoading"}],attrs:{mode:"no"}})],1)}),[],!1,null,"3b0d9224",null).exports),ha=n(3476),va=n(3188);function pa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function fa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pa(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ma={inject:["top"],components:{LiveSize:$n,Moveable:Ye.a,LiveBoard:aa,RedrawingArea:ra,ResultImg:da,LineLoading:un.default},data:function(){return{liveTargetRef:null,resultImgRef:null,drawLiveLeftRef:null,loopInterval:null,liveCreateAiImgFn:Object(Qn.a)(this.liveCreateAiImg,500),stopLiveProd:!1,screenshotIng:!1,liveY:0}},computed:{liveInfo:function(){return this.top.paintingBoardData.liveModel},liveW:function(){var t=this.top.paintingBoardData.liveModel.width,e=this.getRatio(),n=parseInt(t/e);return"".concat(n,"px")},liveH:function(){var t=this.top.paintingBoardData.liveModel.height,e=this.getRatio(),n=parseInt(t/e);return"".concat(n,"px")},showLiveRedrawing:function(){var t=this.top.paintingBoardData.topNav.tools,e="daubBoard"===(null==t?void 0:t.hasAct),n=this.top.paintingBoardData.liveModel.show;return e&&n}},watch:{"liveInfo.width":function(){this.updateRect()},"liveInfo.height":function(){this.updateRect()}},mounted:function(){this.liveTargetRef=this.$refs.liveTargetRef,this.resultImgRef=this.$refs.resultImgRef,this.drawLiveLeftRef=this.$refs.drawLiveLeftRef,P.a.on("liveCreateAiImg",this.liveCreateAiImgFn),P.a.on("setScreenshotIng",this.setScreenshotIng),P.a.on("getProductMask",this.getProductMask),document.addEventListener("keydown",this.handleKeydown),document.addEventListener("keyup",this.handleKeyUp),this.setLiveY(),this.stopLiveProd="yes"===window.localStorage.getItem("stopLiveProd")},beforeDestroy:function(){clearInterval(this.loopInterval),this.loopInterval=null,document.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("keyup",this.handleKeyUp)},methods:{setLiveY:function(){var t=document.querySelector("#liveMaxboxId").clientHeight,e=(document.querySelector("#liveModelViewId").clientHeight-t)/2;this.liveY=e},getRatio:function(){var t=this.top.paintingBoardData.liveModel,e=t.width,n=t.height;return Math.max.apply(Math,[e,n])/568},onResizeStart:function(t){var e=this.liveInfo,n=parseInt(e.min/this.top.liveBoxRatio),o=parseInt(e.max/this.top.liveBoxRatio);t.setMin([n,n]),t.setMax([o,o]),this.top.initLiveLayerActive()},onResize:function(t){var e=t.width,n=t.height,o="".concat(e,"px"),r="".concat(n,"px");t.target.style.width=o,t.target.style.height=r,this.resultImgRef.style.width=o,this.resultImgRef.style.height=r,this.drawLiveLeftRef.style.width=o,this.$refs.liveSizeRef.showSizeInput(parseInt(e*this.top.liveBoxRatio))},updateRect:function(){var t=this;this.$nextTick((function(){t.$refs.liveMaxMoveableRef.updateRect()}))},onResizeEnd:function(t){if(t.lastEvent){var e=t.lastEvent,n=e.width,o=e.height;this.top.changeData("liveModel.width",parseInt(n*this.top.liveBoxRatio)),this.top.changeData("liveModel.height",parseInt(o*this.top.liveBoxRatio)),Y.a.add(this.top.paintingBoardData),this.liveCreateAiImgFn()}},prodAiImg:function(){Y.a.add(this.top.paintingBoardData),this.liveCreateAiImgFn()},toggleSwitch:function(){this.stopLiveProd=!this.stopLiveProd;var t=this.stopLiveProd?"yes":"no";window.localStorage.setItem("stopLiveProd",t),this.stopLiveProd||this.liveCreateAiImg()},setScreenshotIng:function(t){this.screenshotIng=t},whereProdImg:function(t){var meta=t.meta,e=Q.t;return t.product_image_url&&!meta.inpaint_mask&&(e=Q.d),t.product_image_url&&meta.inpaint_mask&&(e=Q.e),!t.product_image_url&&meta.mask&&(e=Q.f),((this.top.paintingBoardData.liveLayerList||[]).filter((function(t){return"liveBrushLayer"===t.type}))||[]).length&&(e=Q.c),e},liveCreateAiImg:function(){var t=this,e=this.stopLiveProd;if(!e){var n=this.top.paintingBoardData.liveLayerList,o=this.top,r=o.liveProdLoading,l=o.hasActiveHistory,d=r||l||e,h=this.liveInfo;if(!d){this.top.liveProdLoading=!0,this.top.processStep={step:"start",process:0,text:"TaskStatusPreparing"};var v=document.querySelector("#viewerAmxBoxId");Object(ht.e)({element:v,openSize:!0},(function(e){var o={width:h.width,height:h.height,imgUrl:e};Object(ht.o)(o,function(){var o=Object(c.a)(regeneratorRuntime.mark((function o(r){var c,l,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(ht.s)(r);case 2:return c=o.sent,t.top.paintingBoardData.liveModel.cutUrl=c,l=t.getParams(),o.next=7,t.handleParamsMask(l,t.liveInfo);case 7:return o.next=9,Object(ht.c)(e);case 9:if(d=o.sent,h=t.whereProdImg(l),d&&(h=Q.u,l.image_url=""),v=n.some((function(t){return"liveImgLayer"===t.type})),f=n.some((function(t){return"liveBrushLayer"===t.type})),!v||!f){o.next=22;break}return o.next=17,t.getBrushMaskFn();case 17:return m=o.sent,o.next=20,Object(ht.s)(m);case 20:_=o.sent,l.brush_url=_;case 22:if(!d||t.liveInfo.prompt){o.next=25;break}return t.top.liveProdLoading=!1,o.abrupt("return");case 25:h(l).then((function(e){var data=e.data;t.liveInfo.params=fa(fa({},l),{},{taskId:data.id}),t.liveInfo.taskId=data.id,Object(ha.b)({task_id:data.id,that:t},{success:function(data){t.liveInfo.result=data.img_uris[0].url,t.top.liveProdLoading=!1},error:function(){t.top.liveProdLoading=!1}})})).catch((function(){t.top.liveProdLoading=!1}));case 26:case"end":return o.stop()}}),o)})));return function(t){return o.apply(this,arguments)}}())}))}}},getBrushMaskFn:function(){var t=this.top.paintingBoardData,e=t.liveLayerList,n=t.liveModel,o=e.filter((function(t){return"liveBrushLayer"===t.type}));return Object(ht.g)(o,n)},getParams:function(){var t=this.top.paintingBoardData,e=t.selectedParams,n=t.currentParams,o=t.basicParams,r=o.denoisingStrength,c=o.imagesNumber,l=o.randomSeed,d=o.brushWeight,h=t.imageToImage.imgUrl,v=n.modelInfo,f=v.id,m=v.model_ver_no,_=n.selectedLora,y=n.stylePrompt,w=n.negativePrompt,C=n.vae;this.getProductMask();var k=this.liveInfo,O=(null==k?void 0:k.cutUrl)||h,x=n.samplerSettingsLive,I=x.CFGScale,S=x.samplingSteps,D=x.samplingMethod,L=this.getLoraParams(_),mask=null==k?void 0:k.mask,P=null==k?void 0:k.pmask,j={width:parseInt(k.width),height:parseInt(k.height)},$=this.getPrompt(y,k),T=mask?[]:this.getControlNetParams(),M={template_id:e,art_model_no:f,art_model_ver_no:m,mode:2,product_image_url:null==k?void 0:k.product_image_url,brush_url:"",meta:fa({control_nets:T,cfg_scale:I,denoising_strength:r,brush_weight:d,lora_models:L,mask:mask,inpaint_mask:P,n_iter:c,negative_prompt:w,prompt:$,sampler_name:D,steps:S,vae:C,seed:l},j)};return O&&(M.image_url=O),M},getLoraParams:function(t){return null!=t&&t.length?t.map((function(t){return{model_id:t.id,model_ver_no:t.model_ver_no,weight:t.weights}})):[]},getPrompt:function(t,e){return(null==t?void 0:t.includes("{prompt}"))?t.replace("{prompt}",null==e?void 0:e.prompt):null!=e&&e.prompt?t+","+e.prompt:t},getControlNetParams:function(){var t=this.top.paintingBoardData.controlNet.controlnet_units||[];return"Generate"!==this.top.leftActiveTab?[]:t.filter((function(t){return t.enable&&t.input_image})).map((function(t){return{image_url:t.input_image,mode:t.module,strength:t.weight,id:t.id}}))},handleParamsMask:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.meta.control_nets,r=[],o.forEach((function(t){var e=t.image_url,o=t.id;e.startsWith("data:image")?r.push(Object(ht.s)(e).then((function(e){t.image_url=e,n.uploadControlNets(o,e),delete t.id}))):delete t.id})),e.abrupt("return",Promise.all(r));case 4:case"end":return e.stop()}}),e)})))()},uploadControlNets:function(t,e){var n=this.top.paintingBoardData.controlNet.controlnet_units.find((function(e){return e.id===t}));n&&(n.image_url=e)},getProductMask:function(){var t=this.top.paintingBoardData,e=t.liveLayerList,n=t.liveModel,o=e.find((function(t){return"liveProductImgLayer"===t.type}));n.width,n.height,n.zoom;if(o){var r=document.querySelector("#viewerAmxBoxId").getBoundingClientRect(),c=document.querySelector("#live-layer-"+o.layerId).getBoundingClientRect(),l=c.left-r.left,d=c.top-r.top,param={width:r.width,height:r.height,b_w:c.width,b_h:c.height,b_x:l,b_y:d},mask=Object(ht.f)(param).replace("data:image/png;base64,","");this.top.changeData("liveModel.product_image_url",o.imgSrc),this.top.changeData("liveModel.mask",mask)}},handleKeydown:function(t){var param={that:this,event:t,RM:Zn,EventEmitterNew:P.a};Object(va.b)(param)},handleKeyUp:function(t){if(this.liveInfo.show){var param={that:this,event:t,RM:Zn,EventEmitterNew:P.a};Object(va.a)(param)}},focusPrompt:function(){P.a.emit("hideLayerTopArea"),this.top.initLiveLayerActive()},clickMask:function(){P.a.emit("hideLayerTopArea"),this.top.initLiveLayerActive()},goPosterPage:function(){var t=this.top.currentCanvas;this.$logEvent("log_actions",{operation:"click_add_text",behavior_info:"on_canvas_fuction_page"}),this.$router.push({path:this.localePath("/posterBoard"),query:{id:t,live:"yes"}})},handleMouseWheel:function(t){t.preventDefault(),t.deltaY<0?this.liveY+=50:this.liveY-=50}}},ga=ma,_a=(n(5334),Object(_.a)(ga,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"live-model-box flex_c",attrs:{id:"liveModelViewId"},on:{wheel:t.handleMouseWheel}},[e("div",{staticClass:"mask-box",class:{"mask-box-black":t.top.paintingBoardData.liveModel.show},on:{click:t.clickMask}}),t._v(" "),e("div",{staticClass:"live-box",style:{top:t.liveY+"px"},attrs:{id:"liveMaxboxId"}},[e("div",{staticClass:"head-nav flex"},[e("div",{staticClass:"left"},[e("live-size",{ref:"liveSizeRef",attrs:{switchLive:t.stopLiveProd},on:{toggleSwitch:t.toggleSwitch}})],1),t._v(" "),e("div",{staticClass:"right flex_lr_m"},[e("div",{staticClass:"left"},[e("span",{staticClass:"title"},[t._v(t._s(t.$t("preview")))])]),t._v(" "),e("div",{staticClass:"right flex"},[e("div",{staticClass:"item flex_m",on:{click:t.goPosterPage}},[t._m(0),t._v(" "),e("span",[t._v(t._s(t.$t("addText")))])])])])]),t._v(" "),e("div",{staticClass:"draw-canvas-box flex"},[e("div",{ref:"drawLiveLeftRef",staticClass:"left",style:{width:t.liveW}},[e("div",{ref:"liveTargetRef",staticClass:"live-canvas-box",style:{width:t.liveW,height:t.liveH}},[e("live-board",{attrs:{width:t.liveW,height:t.liveH}}),t._v(" "),t.showLiveRedrawing?e("redrawing-area"):t._e()],1),t._v(" "),e("div",{staticClass:"live-prompt"},[e("el-input",{attrs:{type:"textarea",placeholder:t.$t("PromptNotEmpty"),rows:2,resize:"none"},on:{focus:t.focusPrompt,change:t.prodAiImg,blur:t.prodAiImg},model:{value:t.liveInfo.prompt,callback:function(e){t.$set(t.liveInfo,"prompt",e)},expression:"liveInfo.prompt"}})],1),t._v(" "),e("line-loading",{directives:[{name:"show",rawName:"v-show",value:t.screenshotIng,expression:"screenshotIng"}],staticClass:"screenshot-lod"})],1),t._v(" "),e("div",{staticClass:"line"}),t._v(" "),e("div",{ref:"resultImgRef",staticClass:"right",style:{width:t.liveW,height:t.liveH}},[e("result-img")],1)])]),t._v(" "),e("Moveable",{ref:"liveMaxMoveableRef",attrs:{resizable:!0,keepRatio:!1,origin:!1,throttleResize:1},on:{resizeStart:t.onResizeStart,resize:t.onResize,resizeEnd:t.onResizeEnd}})],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"add-icon flex_c_m"},[t("i",{staticClass:"el-icon-plus"})])}],!1,null,"0a148982",null).exports);function ba(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ya(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ba(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ba(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wa={components:{LoadingStatus:d.default,TopNav:at,LeftMenu:Zt,RightParams:xe,BoardBox:kn,ReplaceTemplateDialog:wt,TeachViedoPop:Pn,LiveModel:_a},provide:function(){return{top:this}},data:function(){return{dataReady:!1,paramsLoading:!0,dataUpdated:!0,isChangeBoardData:!1,isAlreadyRepelaceTemplate:!1,currentCanvas:"",canvasList:[],viewerClass:null,layerFooterRef:null,eventFn:{setBoardNoDage:null,setBoardYesDage:null,setViewYesDage:null,uploadImg:null,layerBtnsSetPoin:null,initBordPoin:null,submitPublish:null,controlNetDisable:null},paintingBoardData:ya({},On.b),pollingTimer:null,canvasLoading:!1,normalUpdate:!0,loopInterval:null,loopTime:0,isVipExpired:!1,liveBoxRef:null,moveableRef:null,aiimgBoxRef:null,isDrawSame:!1,selectSize:"",isShowTeachVideo:!1,generateType:-1,oldImgNum:0,fromPath:"",liveProdLoading:!1,hasActiveHistory:!1,actLayerSize:[0,0],liveBoxRatio:2.7,processStep:{step:"start",process:0,text:"TaskStatusPreparing"},leftActiveTab:"Product",token:""}},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPath=e.name}))},computed:ya(ya({},Object(h.c)("user",["cdnHostFun"])),{},{isMacOs:function(){return navigator.platform.includes("Mac")?"⇧":"Shift"},rightElementList:function(){var t=this.paintingBoardData.liveModel.show;return this.paintingBoardData[t?"liveLayerList":"elementList"]},NEZoom:function(){return 1/this.paintingBoardData.boardInfo.zoom}}),mounted:function(){var t=this;this.token=this.$cookies.get("T"),this.getIsShowTeachVideo();var e=this.$route.query.id,n=void 0===e?"":e,o="";n&&(o=n,this.clearRouterQuery()),this.token,this.getCanvasList(o),this.loopInterval=setInterval((function(){t.loopTime++,360==t.loopTime&&t.saveCanvasCover(),t.saveCanvas()}),5e3),document.addEventListener("keydown",this.handleKeydown),document.addEventListener("keyup",this.handleKeyUp),P.a.on("setHasActiveHistory",this.setHasActiveHistory)},beforeDestroy:function(){clearInterval(this.loopInterval),this.loopInterval=null,clearTimeout(),document.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("keyup",this.handleKeyUp),Object(Nt.b)()},watch:{dataReady:function(t){var e=this;t&&this.$nextTick((function(){e.init()}))},paintingBoardData:{handler:function(t){this.dataUpdated=!0,this.isChangeBoardData=!0,this.isAlreadyRepelaceTemplate=!1},deep:!0},"paintingBoardData.liveModel.show":{handler:function(t){this.changeControlNetShowStatus(t),this.checkRedrawStatus(t)}}},methods:ya(ya({},Object(h.b)("creation",["getTaskOptionsInfo"])),{},{sameStyleGenerate:function(t){Object(Q.H)({tpl_id:t}).then((function(t){}))},checkRedrawStatus:function(t){this.paintingBoardData.topNav.tools.hasAct;var e=this.paintingBoardData.topNav.tools.daubTool.redrawBoard.hasAct;t?(this.paintingBoardData.elementList||[]).forEach((function(t){t.mask="",t.hasRedraw=!1})):this.paintingBoardData.liveModel.mask="",t&&["segment"].includes(e)&&this.changeData("topNav.tools.daubTool.redrawBoard.hasAct","brush")},clearRouterQuery:function(){var t=window.location.href.split("?")[0],path=this.$route.path;this.$router.replace(path),window.history.replaceState(null,"",t)},frontendDelCanvas:function(t){this.canvasList=this.canvasList.filter((function(e){return e.id!=t}))},getCanvasList:function(t){var e=this;if(!this.token)return this.dataReady=!0,void(this.canvasList=[{id:"",locking:!1,name:"default",select:!1,type:1}]);var n=this.$route.query.remix_id,o=void 0===n?"":n;Object(Q.A)({id:t}).then((function(t){var n=t.data.items;e.canvasList=n||[],e.currentCanvas=n.find((function(t){return o?"default"===t.name:t.select})).id,1===n.length&&n[0].use_template?e.getTplDetailHttp(n[0].use_template):e.getCanvasDetail(e.currentCanvas)}))},getCanvasDetail:function(t){var e,n=this;this.dataReady=!1,this.currentCanvas=t,this.isVipExpired=null===(e=this.canvasList.find((function(e){return t===e.id})))||void 0===e?void 0:e.locking,Object(Q.z)({id:t}).then((function(t){var e=t.data.json_str;n.repalceCanvasJsonStr(e),n.fromDrawSame()}))},repalceCanvasJsonStr:function(t){var e,n=this,o="string"==typeof t?JSON.parse(t):t,r=ya(ya({},On.b),o);r.liveLayerList=r.liveLayerList||[],r.topNav.tools.hasAct=r.liveModel.show?"selectEments":"updateArimg",Object(xn.b)(r.liveModel),Object(xn.a)(r),r.basicParams.brushWeight=null!==(e=o.basicParams.brushWeight)&&void 0!==e?e:1,this.paintingBoardData=r,Y.a.add(r),this.dataReady=!0,this.$forceUpdate(),setTimeout((function(){n.isChangeBoardData=!1,n.isAlreadyRepelaceTemplate=!0,n.eventFn.setBoardYesDage&&(n.eventFn.setBoardYesDage(),n.eventFn.setViewYesDage(!1))}),500)},fromDrawSame:function(){var t=this.$route.query,e=t.remix_id,n=void 0===e?"":e,o=t.publish_type,r=void 0===o?"":o;if(n){if(this.isDrawSame=!1,this.sameStyleGenerate(n),1==r||0===this.paintingBoardData.elementList.length)return this.getTplDetailHttp(n);this.$refs.replaceDialog.openDialog(n,!0)}},getTplDetailHttp:function(t){var e=this;this.paramsLoading=!0;var n=this.paintingBoardData.liveModel.show;Object(Q.C)({id:t}).then((function(t){var o=t.data,r=o.json_str,c=o.publish_type,l=o.cover;if(1===c)e.changeData("topNav.tools.hasAct","selectEments"),e.addLayerItem({type:n?"liveImgLayer":"imgLayer",imgSrc:l});else if(r){var d=Object(xn.c)(t);e.repalceCanvasJsonStr(d),e.$nextTick((function(){e.init()}))}else e.$message.error("模板暂不可用");e.$route.query.remix_id&&e.clearRouterQuery(),e.dataReady=!0}))},getIsShowTeachVideo:function(){var t=localStorage.getItem("CanvasTeachVideo");if(!t)return this.isShowTeachVideo=!0;if("neverRemind"!==t&&t){var e=(new Date).getTime();this.isShowTeachVideo=e-t>864e5}},saveCanvas:function(){var t=this;this.token&&this.dataUpdated&&Object(Q.J)({id:this.currentCanvas,json_str:this.handleSaveData(this.paintingBoardData)}).then((function(){t.dataUpdated=!1}))},saveCanvasCover:function(){var t=this,element=document.querySelector("#canvas-box"),e=window,o=e.innerWidth,r=e.innerHeight;n(634)(element,{width:o,height:r,useCORS:!0,allowTaint:!1}).then(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(canvas){var n,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=canvas.toDataURL(),c=n,e.prev=2,e.next=5,Object(ht.s)(n);case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("error",e.t0);case 11:return e.abrupt("return",Object(Q.J)({id:t.currentCanvas,cover:{uri:c,width:o,height:r}}));case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()).then((function(){t.loopTime=0})).catch((function(e){console.log("err",e),t.loopTime=0}))},handleSaveData:function(data){var t=JSON.parse(JSON.stringify(data)),e=t.liveModel,n=t.elementList,o=t.generateInfo;return e.loading=!1,o.loading=!1,e.active=!1,t.elementList=n.map((function(t){return t.loading=!1,t})),JSON.stringify(t)},init:function(){var t,e=(null===(t=this.paintingBoardData)||void 0===t?void 0:t.liveModel)||{};e.x,e.y;this.getTaskOptionsInfo(),localStorage.removeItem("uploadPathList")},setLiveLocal:function(t){var e=this,n=this.paintingBoardData,o=n.liveModel,r=n.boardInfo,c=r.scrollLeft,l=r.scrollTop,d=r.zoom,h=(r.inViewX,r.inViewY,o.width),v=o.height,f=o.x,m=o.y,_=document.getElementById("canvas-container");if(_){var y=_.offsetWidth,w=_.offsetHeight,C=document.querySelector("#liveItemBox");f=t?(y/d-h)/2+c-290:f,m=t?(w/d-v)/2+l:m,o.x=f,o.y=m,C.style="transform: translate(".concat(f,"px, ").concat(m,"px); width: ").concat(h,"px; height:").concat(v,"px;z-index: -9999"),this.$nextTick((function(){var t;null===(t=e.liveBoxRef)||void 0===t||t.updateRect()}))}},changeActiveControlNet:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.paintingBoardData.controlNet.activeIndex=t},changeControlNetShowStatus:function(t){var e=this,n=this.paintingBoardData.controlNet.controlnet_units.map((function(t){return t.id})).filter((function(t){return!!t})),o=this.paintingBoardData.controlNet.activeIndex||"";(n||[]).forEach((function(t){e.paintingBoardData.elementList.forEach((function(n){if(n&&n.controlNetId&&n.controlNetId===t){var r=n.controlNetId===o&&e.paintingBoardData.liveModel.show;e.$set(n,"show",r)}}))}))},hideOtherControlNet:function(t){var e=this,n=this.paintingBoardData.controlNet.controlnet_units.map((function(t){return t.id})).filter((function(t){return!!t})),o=this.paintingBoardData.controlNet.activeIndex||"";(n||[]).forEach((function(n){e.paintingBoardData.elementList.forEach((function(r){if(r&&r.controlNetId&&r.controlNetId===n){var c=r.controlNetId===t&&e.paintingBoardData.liveModel.show&&r.controlNetId===o;e.$set(r,"show",c)}}))}))},deleteImageLayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.paintingBoardData.elementList.findIndex((function(e){return e.layerId===t}));this.normalUpdate=!0,-1!==e&&this.paintingBoardData.elementList.splice(e,1)},changeData:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";if(this.normalUpdate="normal"===n,"string"==typeof t)if(t.includes(".")){var o=t.split(".");this.recursionModify(o,this.paintingBoardData,e)}else{var c=Object.keys(this.paintingBoardData);if(t.includes("[")){var l=this.splitString(t,"["),d=Object(r.a)(l,2),h=d[0],v=d[1],f=c.includes(h),m=v.match(/\d+/g),_=0;m?_=Number(m[0]):this.logError("paintingBoardData没有该属性"),f?this.$set(this.paintingBoardData[h],_,e):this.logError("paintingBoardData没有该属性")}else{c.includes(t)?this.$set(this.paintingBoardData,t,e):this.logError("paintingBoardData没有该属性")}}else this.logError("key必须是字符串")},recursionModify:function(t,data,e){var n=t.shift(),o=Object.keys(data);if(n.includes("[")){var c=this.splitString(n,"["),l=Object(r.a)(c,2),d=l[0],h=l[1],v=o.includes(d),f=h.match(/\d+/g),m=0;return f?(m=Number(f[0]),v?0===t.length?void(data[d][m]=e):this.recursionModify(t,data[d][m],e):void this.logError("key中子属性错误")):void this.logError("key中子属性错误")}return o.includes(n)?0===t.length?void(data[n]=e):this.recursionModify(t,data[n],e):void this.logError("key中子属性错误")},splitString:function(t,e){var n=t.indexOf(e);return-1!==n?[t.slice(0,n),t.slice(n)]:[t,""]},logError:function(t){},updateLayerList:function(t){this.normalUpdate=!0,this.paintingBoardData.elementList=t},brushMax:function(t){var e=1;e=this.paintingBoardData.liveModel.show?this.paintingBoardData.liveModel.zoom/100:this.paintingBoardData.boardInfo.zoom;var n=0;return t<1&&(n=t+(t-t*e)),t>1&&(n=t/e),n},addLayerItem:function(){var t=arguments,e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L,j,$,T,M,R,A,E,B,N,F,U,H,V,z,W,G,K,J,X,Q,Z;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=(r=t.length>0&&void 0!==t[0]?t[0]:{}).type,l=void 0===c?"imgLayer":c,d=r.imgSrc,h=void 0===d?"":d,v=r.cursorX,f=r.cursorY,m=r.x,_=r.y,y=r.z,w=void 0===y?"":y,C=r.width,k=r.height,O=r.zoom,x=void 0===O?1:O,I=r.customConfig,S=void 0===I?{}:I,D=r.loading,L=void 0!==D&&D,j=r.params,$=void 0===j?{}:j,T=r.isProduct,M=void 0!==T&&T,R=r.aiCreateImg,A=void 0===R||R,E=t.length>1?t[1]:void 0,B=[],N=["liveImgLayer","liveBrushLayer","liveProductImgLayer"].includes(l),B=N?e.paintingBoardData.liveLayerList||[]:e.paintingBoardData.elementList||[],n.next=7,Object(_t.x)(h);case 7:return F=n.sent,U=F.width,H=F.height,V={width:C||U,height:k||H,realWidth:U,realHeight:H,renderWidth:C||0,renderHeight:k||0},C||(V=e.getLayerSize(l,ya(ya({},V),{},{width:U,height:H}))),z=e.paintingBoardData[N?"liveModel":"boardInfo"],W=Object(ht.k)(ya(ya({},z),{},{type:l,cursorX:v,cursorY:f,imgW:V.width,imgH:V.height})),G=W.layerX,K=W.layerY,J=B.map((function(t){return t.z})),J=M?J.filter((function(t){return t>1e4})):J.filter((function(t){return t<1e4})),X=B.length&&J.length?Math.max.apply(Math,Object(o.a)(J)):M?1e4:0,Q=X+1,Z=ya(ya(ya(ya({},On.a),{},{type:l,imgSrc:h,layerId:Object(ht.j)(),name:e.$t("Layer")+Q,z:w||Q},V),{},{mask:""},S),{},{x:void 0!==m?m:G,y:void 0!==_?_:K,loading:L,params:$,zoom:x,moveing:!1}),e.normalUpdate=!0,["liveImgLayer","liveBrushLayer","liveProductImgLayer"].includes(l)?(e.$set(e.paintingBoardData.liveLayerList,B.length,Z),e.$nextTick((function(){Y.a.add(e.paintingBoardData),A&&P.a.emit("liveCreateAiImg")}))):e.$set(e.paintingBoardData.elementList,B.length,Z),E&&E(Z),n.abrupt("return",Z.layerId);case 23:case"end":return n.stop()}}),n)})))()},setLayerImg:function(t,e){var n=this.paintingBoardData.liveModel.show?"liveLayerList":"elementList",o=this.paintingBoardData[n].find((function(e){return e.layerId===t}));o.imgSrc=e,o.loading=!1},getLayerSize:function(t,e){var n=e.width,o=e.height,r=this.paintingBoardData.liveModel.show?600:800,c=["imgLayer","controlNetLayer","liveImgLayer","liveProductImgLayer"].includes(t)?r:this.brushMax(n),l=["imgLayer","controlNetLayer","liveImgLayer","liveProductImgLayer"].includes(t)?o/(n/r):this.brushMax(o);return ya(ya({},e),{},{width:c,height:l,renderWidth:c,renderHeight:l})},setViewer:function(data){this.viewerClass=data},handleParamsMask:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function o(){var r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t.meta.control_nets,c=[],e.mask&&e.mask.startsWith("data:image")&&(t.meta.mask=e.mask.split("data:image/png;base64,")[1]),r.forEach((function(t){var e=t.image_url,o=t.id;e.startsWith("data:image")?c.push(Object(ht.s)(e).then((function(e){t.image_url=e,n.uploadControlNets(o,e),delete t.id}))):delete t.id})),o.abrupt("return",Promise.all(c));case 5:case"end":return o.stop()}}),o)})))()},uploadControlNets:function(t,e){var n=this.paintingBoardData.controlNet.controlnet_units.find((function(e){return e.id===t}));n&&(n.image_url=e)},generateTask:function(t,e,n){var o=arguments,r=this;return Object(c.a)(regeneratorRuntime.mark((function c(){var l,d,h,v,f,m;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=o.length>3&&void 0!==o[3]?o[3]:"",d=r.getParams(t,e,l),c.next=4,r.handleParamsMask(d,e,l);case 4:return h=d.image_url||d.meta.mask?Q.t:Q.u,"intelligentEraser"===l&&(h=Ae.c,d={image_url:(null===(v=d)||void 0===v?void 0:v.image_url)||(null==e?void 0:e.imgSrc),mask:d.meta.mask,width:(null==e?void 0:e.renderWidth)||d.meta.width,height:(null==e?void 0:e.renderHeight)||d.meta.height}),"aiProdImg"===l&&1===r.generateType&&(h=Q.g),"aiProdImg"===l&&2===r.generateType&&(h=Q.f),"layerRedraw"===l&&(h=Q.f),r.processStep={step:"start",process:0,text:"TaskStatusPreparing"},c.prev=10,c.next=13,h(d);case 13:f=c.sent,m=f.data.id,e.params=ya(ya({},d),{},{taskId:m}),e.taskId=m,r.pollingTask(m,e,n),c.next=23;break;case 20:c.prev=20,c.t0=c.catch(10),r.clearPolltime(e);case 23:case"end":return c.stop()}}),c,null,[[10,20]])})))()},pollingTask:function(t,e,n){var o=this,r=1===e.params.mode?3e3:1e3;this.pollingTimer=setTimeout((function(){Object(v.batchFetchTaskProcess)({task_ids:[t],scene:1}).then((function(r){o.handlePollResult(r.data.items[0],t,e,n)})).catch((function(t){o.processStep={step:"end",process:0,text:"TaskStatusPreparing"},o.clearPolltime(e)}))}),r)},getControlNetParams:function(){var t=this.paintingBoardData.controlNet.controlnet_units||[];return"Generate"!==this.leftActiveTab?[]:t.filter((function(t){return t.enable&&t.input_image})).map((function(t){return{image_url:t.input_image,mode:t.module,strength:t.weight,id:t.id}}))},handlePollResult:function(t,e,n,o){var r=t.status,c=t.process,l=t.img_uris;n.process=c,r<3?(this.processStep={step:"ing",process:c,text:"TaskStatusPreparing"},this.pollingTask(e,n,o)):3===r?(n.result=l[0].url,null!=n&&n.layerId&&(n.imgSrc=n.result),this.processStep={step:"end",process:c,text:"TaskStatusPreparing"},o&&o(l),this.clearPolltime(n)):(this.processStep={step:"end",process:0,text:"TaskStatusPreparing"},this.clearPolltime(n),this.$message.error(this.$t("ServerError")))},clearPolltime:function(t){clearTimeout(this.pollingTimer),this.pollingTimer=null,t.loading=!1,t.process=0,t.taskId="",null!=t&&t.layerId&&(this.normalUpdate=!0)},getParams:function(t,e){var n=this.paintingBoardData,o=n.selectedParams,r=n.currentParams,c=n.basicParams,l=c.denoisingStrength,d=c.imagesNumber,h=c.randomSeed,v=n.imageToImage.imgUrl,f=r.modelInfo,m=f.id,_=f.model_ver_no,y=r.selectedLora,w=r.stylePrompt,C=r.negativePrompt,k=r.vae,O=(null==e?void 0:e.cutUrl)||("live"!==t?v:""),x=r["live"===t&&O?"samplerSettingsLive":"samplerSettingsDefault"],I=x.CFGScale,S=x.samplingSteps,D=x.samplingMethod,L=this.getLoraParams(y),mask=null==e?void 0:e.mask,P=this.getParamsSize(t,e),j=this.getPrompt(w,e),$=mask?[]:this.getControlNetParams(),T={template_id:o,art_model_no:m,art_model_ver_no:_,mode:"live"===t&&O?2:1,product_image_url:null==e?void 0:e.product_image_url,meta:ya({control_nets:$,cfg_scale:I,denoising_strength:l,lora_models:L,mask:mask,n_iter:d,negative_prompt:C,prompt:j,sampler_name:D,steps:S,vae:k,seed:h},P)};return O&&(T.image_url=O),T},getPrompt:function(t,e){return(null==t?void 0:t.includes("{prompt}"))?t.replace("{prompt}",null==e?void 0:e.prompt):null!=e&&e.prompt?t+","+e.prompt:t},getParamsSize:function(t,e){var n=null==e?void 0:e.zoom,o=e.width,r=e.height,c={width:parseInt(o),height:parseInt(r)};return"live"!==t&&n&&(c.width=parseInt(n*o),c.height=parseInt(n*r)),c},cancelTask:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.taskId){n.next=3;break}return e.clearPolltime(t),n.abrupt("return");case 3:return n.abrupt("return",Object(v.operateTask)({action:5,task_id:t.taskId}).then((function(n){t.loading=!1,e.clearPolltime(t)})));case 4:case"end":return n.stop()}}),n)})))()},updateLiveModeMask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$set(this.paintingBoardData.liveModel,"mask",t)},getLoraParams:function(t){return null!=t&&t.length?t.map((function(t){return{model_id:t.id,model_ver_no:t.model_ver_no,weight:t.weights}})):[]},validParams:function(t){return!1},getEleInfo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"elementList",o=this.paintingBoardData[n].find((function(em){return em.layerId===t})),r=e?o[e]:o;return null==r?{}:r},setEleItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=t.type,o=void 0===n?"elementList":n,r=t.item,c=arguments.length>1?arguments[1]:void 0,l=this.paintingBoardData[o]||[],d=0,h=l.find((function(em,t){return d=t,em.layerId===e}));h&&(this.changeData("".concat(o,"[").concat(d,"]"),ya(ya({},h),r)),c&&c())},initLayerActive:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.paintingBoardData,n=e.elementList,o=e.liveModel;this.normalUpdate=t,n.forEach((function(t){(t.active=!1,t.cropping)&&(document.querySelector("#img-".concat(t.layerId)).style.clipPath=t.clipPath,t.cropping=!1);t.freeDeformation=!1})),o.active=!1},initLiveLayerActive:function(){var t=this.paintingBoardData.liveLayerList;t.filter((function(t){return t.active})).length>0&&t.forEach((function(t){(t.active=!1,t.freeDeformation=!1,t.cropping)&&(document.querySelector("#live-layer-".concat(t.layerId)).style.clipPath=t.clipPath,t.cropping=!1)}))},changeLoadingStatus:function(t){this.canvasLoading=t},publishPop:function(t){var e=this;In.a.open({type:"./PublishPop",options:ya(ya({},t),{},{id:this.currentCanvas,$t:function(text){return e.$t(text)},copySuccess:function(){e.$message.success(e.$t("CopySuccess"))}})})},handleWheel:function(t){var e=t.ctrlKey,n=t.metaKey,o=t.deltaY;if(e||n){var r=o>0,c=o<0;this.handleChangeZoom(r,c),t.preventDefault()}},handleChangeZoom:function(t,e){var n=this.paintingBoardData.boardInfo.zoom;if(!this.paintingBoardData.liveModel.show&&!(2===n&&t||.2===n&&e)){n=t?(10*n+1)/10:(10*n-1)/10;var o=this.viewerClass;o.setZoom(n),this.changeData("boardInfo.zoom",o.getZoom())}},handleKeydown:function(t){if(!this.paintingBoardData.liveModel.show){var e=t.key,n=t.keyCode,o=t.target;if("INPUT"!==o.tagName&&"TEXTAREA"!==o.tagName&&!o.isContentEditable){var r=t.ctrlKey||t.metaKey,c=t.shiftKey;if(r&&"c"===e)this.copyLayer();else if(r&&c&&("z"===e||"Z"===e))this.revocation("redo");else if(r&&"x"===e);else if(r&&"z"===e)this.revocation("undo");else if("Delete"===e||"Backspace"===e&&!t.target.isContentEditable&&!["INPUT","TEXTAREA"].includes(t.target.tagName))this.delLayer(),t.preventDefault();else if(r&&[187,189].includes(n)){var l=187===n,d=189===n;this.handleChangeZoom(l,d),t.preventDefault()}else if(c&&80==n)document.getElementById("event_brushImg").click();else if(c&&69==n)document.getElementById("event_eraserAiBoard").click();else{var h={86:"selectEments",32:"handBoardel",71:"updateArimg",80:"brushBoard",69:"eraserBoard",73:"daubBoard"};if(Object.keys(h).includes(n.toString())){if(t.repeat)return;if(32===n){if("daubBoard"===this.paintingBoardData.topNav.tools.hasAct)return;return this.eventFn.setBoardNoDage(),this.eventFn.setViewYesDage(!0),void t.preventDefault()}return document.getElementById("event_".concat(h[n])).click()}switch(e){case"ArrowUp":this.moveLayer("y",-1),t.preventDefault();break;case"ArrowDown":this.moveLayer("y",1),t.preventDefault();break;case"ArrowLeft":this.moveLayer("x",-1),t.preventDefault();break;case"ArrowRight":this.moveLayer("x",1),t.preventDefault()}}var v=!("Meta"!==t.key&&"Control"!==t.key||t.altKey||t.shiftKey);Object(Nt.c)("ctrlOrCmd",v)}}},handleKeyUp:function(t){var e=t.keyCode;if([91,17].includes(e)&&Object(Nt.c)("ctrlOrCmd",!1),32===e){if("daubBoard"===this.paintingBoardData.topNav.tools.hasAct)return;this.eventFn.setViewYesDage(!1);var n=this.paintingBoardData.topNav.tools.hasAct;document.getElementById("event_".concat(n)).click()}},getActiveLayer:function(t){var e=this,n=this.paintingBoardData,o=n.elementList,r=n.liveModel,c=o.filter((function(t){return t.z>1e4&&t.active&&e.changeData("liveModel.productLayerId",null),t.active}));return t&&r.active&&(c=[r]),c},delLayer:function(){var t=this,e=this.paintingBoardData.elementList;this.getActiveLayer().forEach((function(n){var o=n.layerId,r=e.findIndex((function(t){return t.layerId===o}));r>-1&&e.splice(r,1),n.z>1e4&&n.active&&t.changeData("liveModel.productLayerId",null)})),this.normalUpdate=!0},copyLayer:function(){var t=this,e=this.getActiveLayer(),n=this.paintingBoardData.liveModel.show;e.forEach((function(e){var o=e.imgSrc,r=e.x,c=e.y,l=e.zoom;t.addLayerItem({type:n?"liveImgLayer":"imgLayer",x:r-10,y:c+10,active:!0,imgSrc:o,params:e.params,zoom:l})})),this.normalUpdate=!0},revocation:function(t){this.$refs.topNav.handleStep(t)},moveLayer:function(t,e){var n=this;this.getActiveLayer(!0).forEach((function(o){var r=o.layerId?'[data-id="'.concat(o.layerId,'"]'):"#liveItemBox",c=document.querySelector(r);o[t]=Number(o[t])+e,c.style.transform="translate(".concat(o.x,"px, ").concat(o.y,"px) scale(").concat(o.zoom,", ").concat(o.zoom,")"),n.$nextTick((function(){(o.layerId?n.moveableRef:n.liveBoxRef).updateRect()}))}))},changeLeftMenu:function(t){this.$refs.leftMenu.changeMenu({label:t})},handleRightMenuClick:function(t){this.$refs.boardBox.rightMenuClick(t)},handleWatchLiveGenerate:function(){this.$refs.boardBox.handleWatchLiveGenerate()},handleSelectSize:function(t,e,n){var o=this.paintingBoardData.liveModel.show?"liveLayerList":"elementList";if("multiple"===n)this.selectSize=t+"x"+e;else{var r=this.paintingBoardData[o];if(1===this.getActiveLayer().length){var c=r.findIndex((function(t){return t.active}));return void(r[c].widHeiRatio=t+"x"+e)}}},updateAiImgStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.paintingBoardData.basicParams;t!==this.generateType&&([1,2].includes(t)?(this.oldImgNum=[1,2].includes(this.generateType)?this.oldImgNum:e.imagesNumber,e.imagesNumber=1):this.oldImgNum&&(e.imagesNumber=this.oldImgNum),this.generateType=t)},setLayerFooterRef:function(data){this.layerFooterRef=data},setHasActiveHistory:function(t){this.hasActiveHistory=t}}),head:function(){return{title:this.$t("editBoardTitle"),meta:[{hid:"description",name:"description",content:this.$t("editBoardDesc")},{hid:"og:title",name:"og:title",content:this.$t("editBoardTitle")},{hid:"og:description",name:"og:description",content:this.$t("editBoardDesc")}]}}},Ca=wa,ka=(n(5335),n(5336),Object(_.a)(Ca,(function(){var t=this,e=t._self._c;return e("div",{on:{wheel:t.handleWheel}},[t.dataReady?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.canvasLoading,expression:"canvasLoading"}],staticClass:"canvas",attrs:{id:"canvas-box"}},[t.isVipExpired?e("div",{staticClass:"vip-mask"},[e("img",{attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240202/5ac2a22a-4711-465b-a814-4df904ccac36.png"),alt:"image"}}),t._v(" "),e("span",{domProps:{innerHTML:t._s(t.$t("canvas_expired"))},on:{click:function(e){t.$router.push(t.localePath("/mall"))}}})]):t._e(),t._v(" "),e("div",{staticClass:"top-nav-box no-snapshot",class:{"z-index1000":!t.isVipExpired}},[e("top-nav",{ref:"topNav",on:{getCanvasList:t.getCanvasList,frontendDelCanvas:t.frontendDelCanvas,changeCanvas:t.getCanvasDetail}})],1),t._v(" "),e("div",{staticClass:"content-box flex"},[e("div",{staticClass:"left-menu no-snapshot"},[e("left-menu",{ref:"leftMenu"})],1),t._v(" "),e("div",{staticClass:"board-box"},[e("board-box",{ref:"boardBox"})],1)]),t._v(" "),e("right-params",{attrs:{elementList:t.rightElementList}})],1):e("LoadingStatus",{attrs:{bgColor:"#02050e"}}),t._v(" "),e("ReplaceTemplateDialog",{ref:"replaceDialog",staticClass:"no-snapshot"}),t._v(" "),t.paintingBoardData.liveModel.show?e("live-model"):t._e()],1)}),[],!1,null,"9892fd30",null));e.default=ka.exports;installComponents(ka,{LoadingStatus:n(213).default})},5721:function(t,e,n){"use strict";n.r(e);n(22),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(5339),n(47),n(5340)),c=n.n(r),l=(n(1691),n(812)),d=n.n(l),h=(n(763),n(456)),v=n.n(h),f=(n(764),n(457)),m=n.n(f),_=(n(28),n(44),n(1)),y=n(290),w=n(146);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={props:{visible:{type:Boolean,default:!1}},components:{BackIcon:y.default},data:function(){return{isAgree:!0,loading:!1}},computed:k(k(k({},Object(_.e)("user",["userInfo"])),Object(_.b)("user",["getAccountInfo"])),{},{panelList:function(){var t,e=[{img:"https://image.cdn2.seaart.ai/static/upload/20240226/eb384efc-8fd7-466d-ac4c-bb7781987cf9.png",path:"/swift_app",idx:4,i18nKey:"aiapply"},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/6d65cddf-c6ab-4c51-bc5b-98a22deeaece.png",path:"/cyberPub",isHide:!(null!==(t=this.userInfo)&&void 0!==t&&t.enable_tavern),idx:0,i18nKey:"digitalHuman"},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/8191e010-883e-4ba6-96fe-74b53a521753.png",path:"/model",idx:1,i18nKey:"motivatingTitle1"}];return e},btnAgreeLink:function(){var t=this.$isChinaSite?"https://image.cdn2.seaart.ai/private/creator_bonus_cn.html":"https://image.cdn2.seaart.ai/private/creator_bonus.html";return this.$t("motivatingBtnAgree").replace("{ATTR}",'href="'.concat(t,'" target="_blank"'))}}),methods:{joinPlan:function(){var t=this;this.isAgree?(this.loading=!0,Object(w.k)().then((function(e){t.loading=!1,t.$emit("update:visible",!1),t.getAccountInfo()})),this.$logEvent("log_actions",{operation:"click_join_Incentive_program"})):this.$message.warning(this.$t("JoinPlanAgreeTips"))},goPage:function(path){path?this.$router.push(this.localePath(path)):this.$message.warning(this.$t("gpt_waiting"))}}},x=(n(5341),n(0)),component=Object(x.a)(O,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"introduce-dialog",attrs:{visible:t.visible,fullscreen:!0,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.visible=e}}},[e("BackIcon"),t._v(" "),e("div",{staticClass:"motivating-task"},[e("div",{staticClass:"title"},[t._v("\n      "+t._s(t.$t("motivatingTitle"))+"\n    ")]),t._v(" "),e("div",{staticClass:"content"},[e("p",{staticClass:"paragraph-title"},[t._v(t._s(t.$t("CreationCenterIntroduce1")))]),t._v(" "),e("p",[t._v("\n        "+t._s(t.$t("CreationCenterIntroduce2"))+t._s(t.$t("CreationCenterIntroduce3"))+t._s(t.$t("CreationCenterIntroduce4"))+"\n      ")]),t._v(" "),e("p",{staticClass:"paragraph-title"},[t._v(t._s(t.$t("CreationCenterIntroduce5")))]),t._v(" "),e("p",[t._v("\n        "+t._s(t.$t("CreationCenterIntroduce6",{model:t.$t("CreationCenterIntroduce6Model"),aiApp:t.$t("CreationCenterIntroduce6AiApp"),numberPeople:t.$t("CreationCenterIntroduce6NumberPeople")}))+"\n      ")]),t._v(" "),e("p",{staticClass:"paragraph-title"},[t._v(t._s(t.$t("CreationCenterIntroduce7")))]),t._v(" "),e("p",[t._v(t._s(t.$t("CreationCenterIntroduce8")))]),t._v(" "),e("p",{staticClass:"paragraph-title"},[t._v(t._s(t.$t("CreationCenterIntroduce9")))]),t._v(" "),e("p",{staticClass:"list-item"},[t._v(t._s(t.$t("CreationCenterIntroduce10")))]),t._v(" "),e("p",{staticClass:"list-item"},[t._v(t._s(t.$t("CreationCenterIntroduce11")))]),t._v(" "),e("p",{staticClass:"list-item"},[t._v(t._s(t.$t("CreationCenterIntroduce12")))]),t._v(" "),e("p",{staticClass:"list-item"},[t._v(t._s(t.$t("CreationCenterIntroduce13")))]),t._v(" "),e("p",{staticClass:"tips"},[t._v(t._s(t.$t("CreationCenterIntroduce14")))])]),t._v(" "),e("div",{staticClass:"panel-list"},[t._l(t.panelList,(function(n,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:!n.isHide,expression:"!panel.isHide"}],key:"panel_"+i,staticClass:"panel-item",on:{click:function(e){return t.goPage(n.path)}}},[e("img",{attrs:{src:n.img,alt:""}}),t._v(" "),e("p",[t._v(t._s(t.$t(n.i18nKey)))])])})),t._v(" "),e("div",{staticClass:"panel-item wait"},[t._v("\n        "+t._s(t.$t("gpt_waiting"))+"\n      ")])],2),t._v(" "),e("div",{staticClass:"join-btn"},[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.joinPlan}},[t._v(t._s(t.$t("CreationCenterIntroduce15")))]),t._v(" "),e("div",[e("el-checkbox",{model:{value:t.isAgree,callback:function(e){t.isAgree=e},expression:"isAgree"}},[e("p",{domProps:{innerHTML:t._s(t.btnAgreeLink)}})])],1)],1)])],1)}),[],!1,null,"27d20f86",null),I=component.exports;installComponents(component,{BackIcon:n(290).default});n(19),n(18);var S=n(30),D=n(3),L=(n(20),n(569)),P=n(567),j=n(382),$=(n(72),n(2106),n(554)),T=n.n($),M=(n(24),{components:{ElTooltip:T.a},props:{icon:{type:String,default:""},title:{type:String,default:""},value:{type:[String,Number],default:""},description:{type:String,default:""}}}),R=(n(5342),Object(x.a)(M,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"long-card"},[e("div",{staticClass:"icon"},[e("Icon",{attrs:{name:t.icon,size:"24"}})],1),t._v(" "),e("span",{staticClass:"title"},[t._v(t._s(t.title)+":")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.value))]),t._v(" "),e("el-tooltip",{attrs:{effect:"dark",content:t.description,placement:"top"}},[e("Icon",{directives:[{name:"show",rawName:"v-show",value:t.description,expression:"description"}],staticClass:"description-icon",attrs:{name:"explanation",size:"16",color:"#9a9fa5"}})],1)],1)}),[],!1,null,"1d50a14c",null).exports),A={props:{color:{type:String,default:""},icon:{type:String,default:""},title:{type:String,default:""},value:{type:Number,default:0}}},E=(n(5343),Object(x.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"points-card",style:{backgroundColor:"rgba(".concat(t.color,",0.1)"),borderBottom:"1px solid rgba(".concat(t.color,")")}},[e("div",{staticClass:"value-line"},[e("div",{staticClass:"points-value",attrs:{title:t.value}},[t._v(t._s(t.value))]),t._v(" "),e("span",{staticClass:"points-icon",style:{backgroundColor:"rgba(".concat(t.color,")")}},[e("Icon",{attrs:{name:t.icon,size:"20"}})],1)]),t._v(" "),e("div",{staticClass:"points-title",attrs:{title:t.title}},[t._v(t._s(t.title))])])}),[],!1,null,"5174cfca",null).exports);function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var F={components:{ModelCreateDialog:L.default,TwinkleStars:P.default,LongCard:R,ColorfulCard:E},mounted:function(){this.initCreatorInfo(),this.initCreatorStat(),this.initPoints(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-home"})},data:function(){return{creatorInfoLoading:!1,creatorStatLoading:!1,creatorStat:{},isModelCreateDialogVisible:!1,modelCreateEntryList:[{id:"train_model_btn",icon:"xunlianmoxing",title:this.$t("trainMode"),clickFn:function(){return window.open("/loraTrainingEdit?DSType=0","_blank")},logEventOperation:"train_model_btn_click"},{id:"upload_model_btn",icon:"shangchuan2",title:this.$t("UploadModels"),clickFn:function(){return window.open("/modelEditStep","_blank")},logEventOperation:"upload_model_btn_click"},{id:"quick_import_model_btn",icon:"kuaisudaoru",title:this.$t("quick_import_model"),clickFn:function(){return window.open("/modelImport","_blank")},logEventOperation:"quick_import_model_btn_click"}],pointsInfo:null}},computed:N(N({},Object(_.e)("user",["userInfo","creatorInfo"])),{},{createEntryList:function(){var t=this;return[{id:"create_and_post",isHide:!1,title:this.$t("create_and_post"),desc:this.$t("create_and_post_desc"),icon:n(1449),bgImage:n(741),bgLightHaloRGB:"165, 91, 211",clickFn:function(){t.$EventBus.$emit("openContribution")}},{id:"publish_model",isHide:!1,title:this.$t("publish_model"),desc:this.$t("publish_model_desc"),icon:n(1450),bgImage:n(742),bgLightHaloRGB:"91, 106, 211",clickFn:function(){t.isModelCreateDialogVisible=!0}},{id:"publish_comfy_ui_and_app",isHide:!1,title:this.$t("publish_comfy_ui_and_app"),desc:this.$t("publish_comfy_ui_and_app_desc"),icon:n(1451),bgImage:n(741),bgLightHaloRGB:"165, 91, 211",clickFn:function(){t.$router.push("/workflow")}},{id:"publish_character",isHide:!this.creatorInfo.enable_character,title:this.$t("publish_character"),desc:this.$t("publish_character_desc"),icon:n(1452),bgImage:n(742),bgLightHaloRGB:"91, 106, 211",clickFn:function(){t.$router.push("/cyberPubPage/new-character")}}].filter((function(t){return!t.isHide}))},dataOverviewList:function(){return[{isHide:!1,label:this.$t("Work"),numValue:this.creatorStat.num_of_artwork||0},{isHide:!1,label:this.$t("post_n"),numValue:this.creatorStat.num_of_post||0},{isHide:!1,label:this.$t("Model"),numValue:this.creatorStat.num_of_model||0},{isHide:!this.creatorInfo.enable_character,label:this.$t("CreationCenterIntroduce6NumberPeople"),numValue:this.creatorStat.num_of_character||0},{isHide:!1,label:this.$t("WorkflowAIAPP"),numValue:this.creatorStat.num_of_comfy_ui||0},{isHide:!1,label:this.$t("Follows"),numValue:this.creatorStat.num_of_following||0},{isHide:!1,label:this.$t("Followers"),numValue:this.creatorStat.num_of_fans||0},{isHide:!1,label:this.$t("comment"),numValue:this.creatorStat.num_of_comment||0},{isHide:!1,label:this.$t("Views"),numValue:this.creatorStat.number_of_view||0},{isHide:!1,label:this.$t("Collects"),numValue:this.creatorStat.num_of_collected||0}].filter((function(t){return!t.isHide}))},pointsCardList:function(){var t;return[{key:"prev.total_score",icon:"a-zongjifen1",color:"225,80,137",i18nIdx:0},{key:"now.total_score",icon:"benqijifen",color:"223,154,77",i18nIdx:1},{key:"now.comfy_ui",icon:"a-icon-menu-quicktool-selected",color:"104,173,128",i18nIdx:7},{key:"now.model",icon:"icon-Menu-model-selected",color:"77,154,171",i18nIdx:3},{key:"now.character",icon:"icon-Menu-Cyberpub-selected",color:"66,86,174",isHide:!(null!==(t=this.userInfo)&&void 0!==t&&t.enable_tavern),i18nIdx:2}]},incomeDescription:function(){var t,e,n;return this.$t("CreationCenterModelIncome")+": "+(null===(t=this.pointsInfo)||void 0===t||null===(t=t.now)||void 0===t?void 0:t.model_earnings)+" | "+this.$t("CreationCenterNumberPeopleIncome")+": "+(null===(e=this.pointsInfo)||void 0===e||null===(e=e.now)||void 0===e?void 0:e.character_earnings)+" | "+this.$t("CreationCenterAiAppIncome")+": "+(null===(n=this.pointsInfo)||void 0===n||null===(n=n.now)||void 0===n?void 0:n.comfy_ui_earnings)}}),methods:{initCreatorInfo:function(){var t=this;this.creatorInfoLoading=!0,Object(w.e)().then((function(e){t.$store.commit("user/SET_CREATOR_INFO",e.data||{})})).finally((function(){t.creatorInfoLoading=!1}))},initCreatorStat:function(){var t=this;this.creatorStatLoading=!0,Object(w.f)().then((function(e){t.creatorStat=e.data||{}})).finally((function(){t.creatorStatLoading=!1}))},initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},getPointsNum:function(t){var e=t.split("."),n=Object(S.a)(e,2),o=n[0],r=n[1];return!this.pointsInfo||this.pointsInfo[o][r]<=0?0:this.pointsInfo[o][r]},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite)},openCreatorPlan:function(){this.$logEvent("log_actions",{operation:"click_incentive_program_entry",behavior_info:"on_creator_revenue_center"});var t=this.$cookies.get("lang")||this.$i18n.locale||"en",e="https://www.seaart.ai/articleDetail/cuneoede878c73ed7gsg";"zhCN"===t&&(e="https://www.seaart.ai/articleDetail/cune91de878c73eaj9mg"),"ja"===t&&(e="https://www.seaart.ai/articleDetail/cunehnle878c73ec3fmg"),window.open(e,"_blank")}}},U=(n(5344),Object(x.a)(F,(function(){var t,e=this,n=e._self._c;return n("div",[n("section",{staticClass:"user-info"},[n("div",{staticClass:"user-avatar",style:{backgroundImage:"url(".concat(e.creatorInfo.head,")")}}),e._v(" "),n("div",{staticClass:"user-base-info"},[n("div",{staticClass:"row"},[n("div",{staticClass:"bolder-text"},[e._v(e._s(e.creatorInfo.name||"-"))]),e._v(" "),n("div",{staticClass:"split-line"}),e._v(" "),n("div",[n("span",{staticClass:"lighter-text"},[e._v("UserID: ")]),e._v(" "),n("span",{staticClass:"lighter-text"},[e._v(e._s(e.creatorInfo.account_no))])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.creatorInfo.intro,expression:"creatorInfo.intro"}],staticClass:"split-line"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.creatorInfo.intro,expression:"creatorInfo.intro"}],staticClass:"lighter-text user-profile"},[e._v(e._s(e.creatorInfo.intro))])]),e._v(" "),n("div",{staticClass:"row"},[n("div",[n("span",{staticClass:"lighter-text"},[e._v(e._s(e.$t("Follows")))]),e._v(" "),n("span",{staticClass:"bolder-text"},[e._v(e._s(e.creatorStat.num_of_following||0))])]),e._v(" "),n("div",{staticClass:"split-line"}),e._v(" "),n("div",[n("span",{staticClass:"lighter-text"},[e._v(e._s(e.$t("Followers")))]),e._v(" "),n("span",{staticClass:"bolder-text"},[e._v(e._s(e.creatorStat.num_of_fans||0))])]),e._v(" "),n("div",{staticClass:"split-line"}),e._v(" "),n("div",[n("span",{staticClass:"lighter-text"},[e._v(e._s(e.$t("like_and_collect_count")))]),e._v(" "),n("span",{staticClass:"bolder-text"},[e._v(e._s(e.creatorStat.num_of_collected||0))])])])]),e._v(" "),n("div",{staticClass:"what-incentive-btn",attrs:{"data-event":"creation-center_what-incentive-btn_click"},on:{click:e.openCreatorPlan}},[n("div",{staticClass:"btn-text"},[e._v(e._s(e.$t("CreationCenterWhatCreatorPlan")))]),e._v(" "),n("div",{staticClass:"btn-icon"},[n("Icon",{attrs:{name:"a-Truckright",size:"20",color:"#fff"}})],1)])]),e._v(" "),n("section",{staticClass:"create-new-entry"},[n("div",{staticClass:"section-inside-title"},[e._v(e._s(e.$t("new_creation")))]),e._v(" "),n("div",{staticClass:"entry-list"},e._l(e.createEntryList,(function(t){return n("div",{key:t.id,staticClass:"entry-item",style:{backgroundImage:"url(".concat(t.bgImage,")")},attrs:{"data-event":"creation-center_create-new-entry_click","data-id":t.id},on:{click:t.clickFn}},[n("TwinkleStars",{staticClass:"twinkle-stars",attrs:{areaWidth:160,areaHeight:40}}),e._v(" "),n("div",{staticClass:"light-halo",style:{backgroundImage:"radial-gradient(ellipse 200px 80px at center bottom, rgba(".concat(t.bgLightHaloRGB,", 0.2) 0%, rgba(").concat(t.bgLightHaloRGB,", 0.1) 30%, rgba(").concat(t.bgLightHaloRGB,", 0) 60%)")}}),e._v(" "),n("div",{staticClass:"entry-icon",style:{backgroundImage:"url(".concat(t.icon,")")}}),e._v(" "),n("div",{staticClass:"entry-text-info"},[n("div",{staticClass:"text-title"},[e._v(e._s(t.title))]),e._v(" "),n("div",{staticClass:"text-desc"},[e._v(e._s(t.desc))])])],1)})),0)]),e._v(" "),n("section",{staticClass:"data-overview"},[n("div",{staticClass:"section-inside-title"},[n("div",{staticClass:"title-text"},[e._v(e._s(e.$t("data_overview")))]),e._v(" "),n("el-tooltip",{attrs:{effect:"dark",placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n          "+e._s(e.$t("data_overview_work_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_post_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_model_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_character_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_app_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_follow_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_fans_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_comment_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_view_desc"))+"\n          "),n("br"),e._v("\n          "+e._s(e.$t("data_overview_collect_desc"))+"\n        ")]),e._v(" "),n("Icon",{staticClass:"title-icon",attrs:{name:"explanation",size:"20",color:"#9a9fa5"}})],1)],1),e._v(" "),n("div",{staticClass:"data-card-list"},e._l(e.dataOverviewList,(function(t){return n("div",{key:t.label,staticClass:"card-item"},[n("div",{staticClass:"card-label"},[e._v(e._s(t.label))]),e._v(" "),n("div",{staticClass:"card-num-value"},[e._v(e._s(t.numValue))])])})),0)]),e._v(" "),n("section",{staticClass:"profits-info"},[n("div",{staticClass:"profits-list"},[n("LongCard",{attrs:{title:e.$t("CumulativeIncome"),value:e.changePrice(null===(t=e.pointsInfo)||void 0===t?void 0:t.earnings),icon:"a-shouyi11",description:e.incomeDescription}})],1)]),e._v(" "),n("div",{staticClass:"section-title"},[e._v(e._s(e.$t("CreationCenterMyPoints")))]),e._v(" "),n("section",{staticClass:"my-points"},[n("div",{staticClass:"points-list"},e._l(e.pointsCardList,(function(t){return n("ColorfulCard",{directives:[{name:"show",rawName:"v-show",value:!t.isHide,expression:"!card.isHide"}],key:t.key,attrs:{color:t.color,icon:t.icon,title:e.$t("CreationCenterCard"+t.i18nIdx),value:e.getPointsNum(t.key)}})})),1)]),e._v(" "),n("ModelCreateDialog",{attrs:{visible:e.isModelCreateDialogVisible,createEntryList:e.modelCreateEntryList},on:{"update:visible":function(t){e.isModelCreateDialogVisible=t}}})],1)}),[],!1,null,"3ff536b8",null)),H=U.exports;installComponents(U,{TwinkleStars:n(567).default,ModelCreateDialog:n(569).default});n(552);var V=n(383),z=n.n(V),W=(n(553),n(384)),G=n.n(W),Y=(n(31),n(43),n(77),{methods:{getDateRange:function(){var t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(new Date(e,t.getMonth()+1,0).getDate()).padStart(2,"0");return 2025===e&&"02"===n?"2025.02.17-2025.02.".concat(o):"".concat(e,".").concat(n,".01-").concat(e,".").concat(n,".").concat(o)}}}),K=Object(x.a)(Y,(function(){var t=this,e=t._self._c;return e("el-tooltip",{attrs:{effect:"dark",content:t.$t("CreationCenterModelOverviewDescription",{dateRange:t.getDateRange()}),placement:"top"}},[e("Icon",{attrs:{name:"warning",size:"16",color:"#9a9fa5"}})],1)}),[],!1,null,null,null).exports,J={components:{ElTable:G.a,ElTableColumn:z.a,LongCard:R,ColorfulCard:E,DataDescriptionIcon:K},data:function(){return{pointsInfo:null,dataInfo:null,tableTop:457}},computed:{pointsList:function(){var t,e,n,o;return[{title:this.$t("CreationCenterViewCount"),value:(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.num_of_view)||0,icon:"chakanshu",color:"223, 154, 77"},{title:this.$t("CreationCenterUsageCount"),value:(null===(e=this.dataInfo)||void 0===e||null===(e=e.date)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.num_of_task)||0,icon:"shiyongcishu",color:"77, 154, 171"},{title:this.$t("CreationCenterCollectCount"),value:(null===(n=this.dataInfo)||void 0===n||null===(n=n.date)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.num_of_collect)||0,icon:"collect_selected1",color:"223, 78, 95"},{title:this.$t("CreationCenterDownloadCount"),value:(null===(o=this.dataInfo)||void 0===o||null===(o=o.date)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.num_of_download)||0,icon:"xiazaishu",color:"104, 173, 128"}]},tableData:function(){var t,e;return(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t?void 0:t.length)>0?(null===(e=this.dataInfo)||void 0===e?void 0:e.date.slice(1)).map((function(t){var e,n,o,r,c,l;return{date:"".concat(null===(e=t.date)||void 0===e||null===(e=e.toString())||void 0===e?void 0:e.substring(0,4),"-").concat(null===(n=t.date)||void 0===n||null===(n=n.toString())||void 0===n?void 0:n.substring(4,6),"-").concat(null===(o=t.date)||void 0===o||null===(o=o.toString())||void 0===o?void 0:o.substring(6,8)," - ").concat(null===(r=t.date)||void 0===r||null===(r=r.toString())||void 0===r?void 0:r.substring(0,4),"-").concat(null===(c=t.date)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.substring(8,10),"-").concat(null===(l=t.date)||void 0===l||null===(l=l.toString())||void 0===l?void 0:l.substring(10,12)),viewCount:t.num_of_view,taskCount:t.num_of_task,collectCount:t.num_of_collect,downloadCount:t.num_of_download}})):[]}},methods:{initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},initSimulateListStat:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.h)({obj_type:2});case 2:n=e.sent,t.dataInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},updateTableTopHeight:function(){var t=this;this.$nextTick((function(){t.tableTop=t.$refs.historyDataRef.getBoundingClientRect().top,console.log("this.tableTop",t.tableTop)}))}},mounted:function(){this.initPoints(),this.initSimulateListStat(),this.updateTableTopHeight(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-data-center-model"})}},X=(n(5345),Object(x.a)(J,(function(){var t,e=this,o=e._self._c;return o("div",[o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("AIModel")))]),e._v(" "),o("div",{staticClass:"update-description"},[e._v(e._s(e.$t("CreationCenterUpdateDataFrequency")))])]),e._v(" "),o("section",{staticClass:"profits-list"},[o("LongCard",{attrs:{title:e.$t("CreationCenterCurrentPoints"),value:(null===(t=e.pointsInfo)||void 0===t||null===(t=t.now)||void 0===t?void 0:t.model)||0,icon:"benqijifen"}})],1),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterOverview")))]),e._v(" "),o("DataDescriptionIcon")],1),e._v(" "),o("section",{staticClass:"my-points"},[o("div",{staticClass:"points-list"},e._l(e.pointsList,(function(t){return o("ColorfulCard",{key:t.title,attrs:{title:t.title,value:t.value,icon:t.icon,color:t.color}})})),1)]),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterHistoryData")))])]),e._v(" "),o("section",{ref:"historyDataRef",staticClass:"history-data",style:"height: calc(100vh - ".concat(e.tableTop+38,"px)")},[o("el-table",{attrs:{data:e.tableData}},[o("template",{slot:"empty"},[o("div",{staticClass:"empty-block"},[o("img",{attrs:{src:n(542),alt:""}}),e._v(" "),o("p",[e._v(e._s(e.$t("CreationCenterNoHistoryData")))])])]),e._v(" "),o("el-table-column",{attrs:{prop:"date",label:e.$t("Time"),width:"300"}}),e._v(" "),o("el-table-column",{attrs:{prop:"viewCount",label:e.$t("CreationCenterViewCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"taskCount",label:e.$t("CreationCenterUsageCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"collectCount",label:e.$t("CreationCenterCollectCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"downloadCount",label:e.$t("CreationCenterDownloadCount")}})],2)],1)])}),[],!1,null,"2f7cd97c",null).exports),Q={components:{ElTable:G.a,ElTableColumn:z.a,LongCard:R,ColorfulCard:E,DataDescriptionIcon:K},data:function(){return{pointsInfo:null,dataInfo:null,tableTop:457}},computed:{pointsList:function(){var t,e,n,o;return[{title:this.$t("CreationCenterViewCount"),value:(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.num_of_view)||0,icon:"chakanshu",color:"223, 154, 77"},{title:this.$t("CreationCenterTaskCount"),value:(null===(e=this.dataInfo)||void 0===e||null===(e=e.date)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.num_of_token)||0,icon:"chat",color:"77, 154, 171"},{title:this.$t("CreationCenterCollectCount"),value:(null===(n=this.dataInfo)||void 0===n||null===(n=n.date)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.num_of_collect)||0,icon:"collect_selected1",color:"223, 78, 95"},{title:this.$t("CreationCenterShareCount"),value:(null===(o=this.dataInfo)||void 0===o||null===(o=o.date)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.num_of_share)||0,icon:"fenxiang",color:"104, 173, 128"}]},tableData:function(){var t,e;return(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t?void 0:t.length)>0?(null===(e=this.dataInfo)||void 0===e?void 0:e.date.slice(1)).map((function(t){var e,n,o,r,c,l;return{date:"".concat(null===(e=t.date)||void 0===e||null===(e=e.toString())||void 0===e?void 0:e.substring(0,4),"-").concat(null===(n=t.date)||void 0===n||null===(n=n.toString())||void 0===n?void 0:n.substring(4,6),"-").concat(null===(o=t.date)||void 0===o||null===(o=o.toString())||void 0===o?void 0:o.substring(6,8)," - ").concat(null===(r=t.date)||void 0===r||null===(r=r.toString())||void 0===r?void 0:r.substring(0,4),"-").concat(null===(c=t.date)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.substring(8,10),"-").concat(null===(l=t.date)||void 0===l||null===(l=l.toString())||void 0===l?void 0:l.substring(10,12)),viewCount:t.num_of_view,tokenCount:t.num_of_token,collectCount:t.num_of_collect,shareCount:t.num_of_share}})):[]}},methods:{initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},initSimulateListStat:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.h)({obj_type:9});case 2:n=e.sent,t.dataInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},updateTableTopHeight:function(){var t=this;this.$nextTick((function(){t.tableTop=t.$refs.historyDataRef.getBoundingClientRect().top,console.log("this.tableTop",t.tableTop)}))}},mounted:function(){this.initPoints(),this.initSimulateListStat(),this.updateTableTopHeight(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-data-center-character"})}},Z=(n(5346),Object(x.a)(Q,(function(){var t,e=this,o=e._self._c;return o("div",[o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("Tavern")))]),e._v(" "),o("div",{staticClass:"update-description"},[e._v(e._s(e.$t("CreationCenterUpdateDataFrequency")))])]),e._v(" "),o("section",{staticClass:"profits-list"},[o("LongCard",{attrs:{title:e.$t("CreationCenterCurrentPoints"),value:(null===(t=e.pointsInfo)||void 0===t||null===(t=t.now)||void 0===t?void 0:t.character)||0,icon:"benqijifen"}})],1),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterOverview")))]),e._v(" "),o("DataDescriptionIcon")],1),e._v(" "),o("section",{staticClass:"my-points"},[o("div",{staticClass:"points-list"},e._l(e.pointsList,(function(t){return o("colorful-card",{key:t.title,attrs:{title:t.title,value:t.value,icon:t.icon,color:t.color}})})),1)]),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterHistoryData")))])]),e._v(" "),o("section",{ref:"historyDataRef",staticClass:"history-data",style:"height: calc(100vh - ".concat(e.tableTop+38,"px)")},[o("el-table",{attrs:{data:e.tableData}},[o("template",{slot:"empty"},[o("div",{staticClass:"empty-block"},[o("img",{attrs:{src:n(542),alt:""}}),e._v(" "),o("p",[e._v(e._s(e.$t("CreationCenterNoHistoryData")))])])]),e._v(" "),o("el-table-column",{attrs:{prop:"date",label:e.$t("Time"),width:"300"}}),e._v(" "),o("el-table-column",{attrs:{prop:"viewCount",label:e.$t("CreationCenterViewCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"tokenCount",label:e.$t("CreationCenterTaskCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"collectCount",label:e.$t("CreationCenterCollectCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"shareCount",label:e.$t("CreationCenterShareCount")}})],2)],1)])}),[],!1,null,"47d3e9c9",null).exports),tt={components:{ElTable:G.a,ElTableColumn:z.a,LongCard:R,ColorfulCard:E,DataDescriptionIcon:K},data:function(){return{pointsInfo:null,dataInfo:null,tableTop:457}},computed:{pointsList:function(){var t,e,n,o;return[{title:this.$t("CreationCenterViewCount"),value:(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.num_of_view)||0,icon:"chakanshu",color:"223, 154, 77"},{title:this.$t("CreationCenterUsageCount"),value:(null===(e=this.dataInfo)||void 0===e||null===(e=e.date)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.num_of_task)||0,icon:"shiyongcishu",color:"77, 154, 171"},{title:this.$t("CreationCenterCollectCount"),value:(null===(n=this.dataInfo)||void 0===n||null===(n=n.date)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.num_of_collect)||0,icon:"collect_selected1",color:"223, 78, 95"},{title:this.$t("CreationCenterShareCount"),value:(null===(o=this.dataInfo)||void 0===o||null===(o=o.date)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.num_of_share)||0,icon:"fenxiang",color:"104, 173, 128"}]},tableData:function(){var t,e;return(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t?void 0:t.length)>0?(null===(e=this.dataInfo)||void 0===e?void 0:e.date.slice(1)).map((function(t){var e,n,o,r,c,l;return{date:"".concat(null===(e=t.date)||void 0===e||null===(e=e.toString())||void 0===e?void 0:e.substring(0,4),"-").concat(null===(n=t.date)||void 0===n||null===(n=n.toString())||void 0===n?void 0:n.substring(4,6),"-").concat(null===(o=t.date)||void 0===o||null===(o=o.toString())||void 0===o?void 0:o.substring(6,8)," - ").concat(null===(r=t.date)||void 0===r||null===(r=r.toString())||void 0===r?void 0:r.substring(0,4),"-").concat(null===(c=t.date)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.substring(8,10),"-").concat(null===(l=t.date)||void 0===l||null===(l=l.toString())||void 0===l?void 0:l.substring(10,12)),viewCount:t.num_of_view,taskCount:t.num_of_task,collectCount:t.num_of_collect,shareCount:t.num_of_share}})):[]}},methods:{initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},initSimulateListStat:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.h)({obj_type:14});case 2:n=e.sent,t.dataInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},updateTableTopHeight:function(){var t=this;this.$nextTick((function(){t.tableTop=t.$refs.historyDataRef.getBoundingClientRect().top,console.log("this.tableTop",t.tableTop)}))}},mounted:function(){this.initPoints(),this.initSimulateListStat(),this.updateTableTopHeight(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-data-center-ai-app"})}},et=(n(5347),Object(x.a)(tt,(function(){var t,e=this,o=e._self._c;return o("div",[o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("Swtft_App")))]),e._v(" "),o("div",{staticClass:"update-description"},[e._v(e._s(e.$t("CreationCenterUpdateDataFrequency")))])]),e._v(" "),o("section",{staticClass:"profits-list"},[o("LongCard",{attrs:{title:e.$t("CreationCenterCurrentPoints"),value:(null===(t=e.pointsInfo)||void 0===t||null===(t=t.now)||void 0===t?void 0:t.comfy_ui)||0,icon:"benqijifen"}})],1),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterOverview")))]),e._v(" "),o("DataDescriptionIcon")],1),e._v(" "),o("section",{staticClass:"my-points"},[o("div",{staticClass:"points-list"},e._l(e.pointsList,(function(t){return o("ColorfulCard",{key:t.title,attrs:{title:t.title,value:t.value,icon:t.icon,color:t.color}})})),1)]),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterHistoryData")))])]),e._v(" "),o("section",{ref:"historyDataRef",staticClass:"history-data",style:"height: calc(100vh - ".concat(e.tableTop+38,"px)")},[o("el-table",{attrs:{data:e.tableData}},[o("template",{slot:"empty"},[o("div",{staticClass:"empty-block"},[o("img",{attrs:{src:n(542),alt:""}}),e._v(" "),o("p",[e._v(e._s(e.$t("CreationCenterNoHistoryData")))])])]),e._v(" "),o("el-table-column",{attrs:{prop:"date",label:e.$t("Time"),width:"300"}}),e._v(" "),o("el-table-column",{attrs:{prop:"viewCount",label:e.$t("CreationCenterViewCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"taskCount",label:e.$t("CreationCenterUsageCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"collectCount",label:e.$t("CreationCenterCollectCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"shareCount",label:e.$t("CreationCenterShareCount")}})],2)],1)])}),[],!1,null,"cf53f8a4",null).exports),it={components:{ElTable:G.a,ElTableColumn:z.a,LongCard:R,ColorfulCard:E,DataDescriptionIcon:K},data:function(){return{pointsInfo:null,dataInfo:null,tableTop:457}},computed:{pointsList:function(){var t,e,n,o;return[{title:this.$t("CreationCenterViewCount"),value:(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.num_of_view)||0,icon:"chakanshu",color:"223, 154, 77"},{title:this.$t("CreationCenterUsageCount"),value:(null===(e=this.dataInfo)||void 0===e||null===(e=e.date)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.num_of_task)||0,icon:"shiyongcishu",color:"77, 154, 171"},{title:this.$t("CreationCenterCollectCount"),value:(null===(n=this.dataInfo)||void 0===n||null===(n=n.date)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.num_of_collect)||0,icon:"collect_selected1",color:"223, 78, 95"},{title:this.$t("CreationCenterDownloadCount"),value:(null===(o=this.dataInfo)||void 0===o||null===(o=o.date)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.num_of_download)||0,icon:"xiazaishu",color:"104, 173, 128"}]},tableData:function(){var t,e;return(null===(t=this.dataInfo)||void 0===t||null===(t=t.date)||void 0===t?void 0:t.length)>0?(null===(e=this.dataInfo)||void 0===e?void 0:e.date.slice(1)).map((function(t){var e,n,o,r,c,l;return{date:"".concat(null===(e=t.date)||void 0===e||null===(e=e.toString())||void 0===e?void 0:e.substring(0,4),"-").concat(null===(n=t.date)||void 0===n||null===(n=n.toString())||void 0===n?void 0:n.substring(4,6),"-").concat(null===(o=t.date)||void 0===o||null===(o=o.toString())||void 0===o?void 0:o.substring(6,8)," - ").concat(null===(r=t.date)||void 0===r||null===(r=r.toString())||void 0===r?void 0:r.substring(0,4),"-").concat(null===(c=t.date)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.substring(8,10),"-").concat(null===(l=t.date)||void 0===l||null===(l=l.toString())||void 0===l?void 0:l.substring(10,12)),viewCount:t.num_of_view,taskCount:t.num_of_task,collectCount:t.num_of_collect,downloadCount:t.num_of_download}})):[]}},methods:{initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},initSimulateListStat:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.h)({obj_type:13});case 2:n=e.sent,t.dataInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},updateTableTopHeight:function(){var t=this;this.$nextTick((function(){t.tableTop=t.$refs.historyDataRef.getBoundingClientRect().top,console.log("this.tableTop",t.tableTop)}))}},mounted:function(){this.initPoints(),this.initSimulateListStat(),this.updateTableTopHeight(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-data-center-comfyui"})}},nt=(n(5348),Object(x.a)(it,(function(){var t,e=this,o=e._self._c;return o("div",[o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("WorkFlow")))]),e._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:e.$t("creation_center_comfyui_profits_desc"),placement:"top"}},[o("Icon",{attrs:{name:"warning",size:"16",color:"#9a9fa5"}})],1),e._v(" "),o("div",{staticClass:"update-description"},[e._v(e._s(e.$t("CreationCenterUpdateDataFrequency")))])],1),e._v(" "),o("section",{staticClass:"profits-list"},[o("LongCard",{attrs:{title:e.$t("CreationCenterCurrentPoints"),value:(null===(t=e.pointsInfo)||void 0===t||null===(t=t.now)||void 0===t?void 0:t.comfy_ui_workflow)||0,icon:"benqijifen"}})],1),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterOverview")))]),e._v(" "),o("DataDescriptionIcon")],1),e._v(" "),o("section",{staticClass:"my-points"},[o("div",{staticClass:"points-list"},e._l(e.pointsList,(function(t){return o("ColorfulCard",{key:t.title,attrs:{title:t.title,value:t.value,icon:t.icon,color:t.color}})})),1)]),e._v(" "),o("div",{staticClass:"section-title"},[o("span",[e._v(e._s(e.$t("CreationCenterHistoryData")))])]),e._v(" "),o("section",{ref:"historyDataRef",staticClass:"history-data",style:"height: calc(100vh - ".concat(e.tableTop+38,"px)")},[o("el-table",{attrs:{data:e.tableData}},[o("template",{slot:"empty"},[o("div",{staticClass:"empty-block"},[o("img",{attrs:{src:n(542),alt:""}}),e._v(" "),o("p",[e._v(e._s(e.$t("CreationCenterNoHistoryData")))])])]),e._v(" "),o("el-table-column",{attrs:{prop:"date",label:e.$t("Time"),width:"300"}}),e._v(" "),o("el-table-column",{attrs:{prop:"viewCount",label:e.$t("CreationCenterViewCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"taskCount",label:e.$t("CreationCenterUsageCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"collectCount",label:e.$t("CreationCenterCollectCount")}}),e._v(" "),o("el-table-column",{attrs:{prop:"downloadCount",label:e.$t("CreationCenterDownloadCount")}})],2)],1)])}),[],!1,null,"cb16c0b0",null).exports),at=n(466),st=n(58),ot={props:{tableData:{type:Array,default:function(){return[]}}},components:{ElTable:G.a,ElTableColumn:z.a},computed:{},filters:{timestampToTime:function(t){return Object(st.i)(t,"yyyy/MM/dd")}},data:function(){return{timestampToTime:st.i}},methods:{incomeDescription:function(t){return this.$t("CreationCenterModelIncome")+": "+t.model_earnings+" | "+this.$t("CreationCenterNumberPeopleIncome")+": "+t.character_earnings+" | "+this.$t("CreationCenterAiAppIncome")+": "+t.comfy_ui_earnings},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite)}}},ct=(n(5349),Object(x.a)(ot,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:""}},[e("el-table-column",{attrs:{prop:"date",width:"50%",label:t.$t("WAITIncomeTableHead1")},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",[e("p",{staticClass:"date-text"},[t._v(t._s(t.$t("IncomeTableKey"))+": "+t._s(n.row.date))]),t._v(" "),e("span",{staticClass:"order-no-text"},[t._v(t._s(t.$t("OrderNo"))+": "+t._s(n.row.order_no))])])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"update_at",width:"35%",label:t.$t("WAITIncomeTableHead2")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("timestampToTime")(e.row.update_at))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"earnings",width:"15%",label:t.$t("WAITIncomeTableHead3")+t.$t(t.$isChinaSite?"IncomeTableHeadTips":"")},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",{staticClass:"income-amount-cols"},[e("span",[t._v(t._s(t.changePrice(n.row.earnings)))]),t._v(" "),e("el-tooltip",{attrs:{effect:"dark",content:t.incomeDescription(n.row),placement:"top"}},[e("Icon",{staticClass:"description-icon",attrs:{name:"explanation",size:"16",color:"#9a9fa5"}})],1)],1)]}}])})],1)],1)}),[],!1,null,"736e7a90",null).exports),lt={props:{tableData:{type:Array,default:function(){return[]}}},components:{ElTable:G.a,ElTableColumn:z.a},computed:{},filters:{timestampToTime:function(t){return Object(st.i)(t,"yyyy/MM/dd")}},data:function(){return{timestampToTime:st.i}},methods:{withdrawAccount:function(t){return(null==t?void 0:t.withdraw_account)||{account_type:3,third_account:" - "}},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite)}}},ut=(n(5350),Object(x.a)(lt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:""}},[e("el-table-column",{attrs:{prop:"order_no",width:"50%",label:t.$t("WAITIncomeTableHead1")},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",[e("p",{},[t._v(t._s(t.$t("HISTORYIncomeTableHead1"))+": "+t._s(n.row.order_no))])])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"update_at",width:"35%",label:t.$t("WAITIncomeTableHead2")},scopedSlots:t._u([{key:"default",fn:function(n){var o;return[1===(null===(o=n.row)||void 0===o?void 0:o.status)?e("div",[e("p",{staticClass:"date-text"},[t._v(t._s(t._f("timestampToTime")(n.row.update_at)))]),t._v(" "),e("span",{staticClass:"withdraw-account-text"},[t._v(t._s(t.$t("IncomeTableKey"+t.withdrawAccount(n.row).account_type))+"\n            "+t._s(t.withdrawAccount(n.row).third_account)+"\n          ")])]):e("div",[e("p",[t._v("-")])])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"earnings",width:"15%",label:t.$t("WAITIncomeTableHead3")+t.$t(t.$isChinaSite?"IncomeTableHeadTips":"")},scopedSlots:t._u([{key:"default",fn:function(n){var o,r,c;return[e("div",{staticClass:"income-amount-cols"},[e("p",[t._v(t._s(t.changePrice(null===(o=n.row)||void 0===o?void 0:o.current_amount)))]),t._v(" "),e("span",{staticClass:"income-status",class:"status"+(null===(r=n.row)||void 0===r?void 0:r.status)},[t._v(t._s(t.$t("IncomeStatus"+(null===(c=n.row)||void 0===c?void 0:c.status))))])])]}}])})],1)],1)}),[],!1,null,"f00d802a",null).exports),ht={props:["total"],components:{STooltip:at.default,WaitIncomeTable:ct,HistoryIncomeTable:ut},data:function(){return{activeTab:"WAIT",tableData:{WAIT:[],HISTORY:[]},updateTab:["WAIT","HISTORY"],tableTop:424}},computed:{totalNum:function(){return"HISTORY"===this.activeTab?this.total:this.getWithdrawTotal(this.tableData.WAIT)},isShowTips:function(){return this.$isChinaSite&&"HISTORY"===this.activeTab}},mounted:function(){this.initList(),this.updateTableTopHeight()},methods:{initList:function(){this.tableData={WAIT:[],HISTORY:[]},this.handleClickWait()},changeTab:function(t){this.activeTab=t,this.tableData[this.activeTab].length||("HISTORY"===t?this.handleClickHistory():this.handleClickWait())},handleClickHistory:function(){var t=this;Object(w.i)().then((function(e){t.tableData.HISTORY=(null==e?void 0:e.data)||[]}))},handleClickWait:function(){var t=this;Object(w.j)().then((function(e){t.tableData.WAIT=(null==e?void 0:e.data)||[]}))},getWithdrawTotal:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tableData.WAIT;return e.length?e.reduce((function(e,n){return e+=n.earnings,t.roundToDecimalPlace(e,2)}),0):0},roundToDecimalPlace:function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite)},updateTableTopHeight:function(){var t=this;this.$nextTick((function(){t.tableTop=t.$refs.incomeTableRef.getBoundingClientRect().top}))}}},vt=ht,pt=(n(5351),Object(x.a)(vt,(function(){var t=this,e=t._self._c;return e("div",{ref:"incomeTableRef",staticClass:"income-table",style:"height: calc(100vh - ".concat(t.tableTop+38,"px)")},[e("div",{staticClass:"table-tabs"},[e("div",{staticClass:"tab-item",class:{active:"WAIT"===t.activeTab},on:{click:function(e){return t.changeTab("WAIT")}}},[e("i",{staticClass:"iconfont icon-a-tixianjilu11"}),t._v("\n      "+t._s(t.$t("IncomeTab1"))+"\n    ")]),t._v(" "),e("div",{staticClass:"tab-item",class:{active:"HISTORY"===t.activeTab},on:{click:function(e){return t.changeTab("HISTORY")}}},[e("i",{staticClass:"iconfont icon-a-tixianjiluicon1"}),t._v("\n      "+t._s(t.$t("IncomeTab2"))+"\n    ")])]),t._v(" "),t.tableData[t.activeTab].length>0?e("div",{staticClass:"table-content"},["WAIT"===t.activeTab?e("wait-income-table",{attrs:{tableData:t.tableData[t.activeTab]}}):t._e(),t._v(" "),"HISTORY"===t.activeTab?e("history-income-table",{attrs:{tableData:t.tableData[t.activeTab]}}):t._e()],1):e("div",{staticClass:"empty-panel"},[e("div",{staticClass:"empty-content-wrapper"},[e("img",{attrs:{src:n(1052),alt:""}}),t._v(" "),e("p",[t._v(t._s(t.$t("IncomeEmpty")))])])]),t._v(" "),e("div",{staticClass:"table-bottom"},[e("span",{staticClass:"tips"},[t._v(t._s(t.$t(t.activeTab+"IncomeTableTips")))]),t._v(" "),e("div",{staticClass:"total-info"},[e("s-tooltip",{directives:[{name:"show",rawName:"v-show",value:t.isShowTips,expression:"isShowTips"}],attrs:{info:t.$t("IncomeTotalTips"),icon:"iconfont el-icon-warning-outline"}}),t._v("\n      "+t._s(t.$t(t.activeTab+"IncomeTableTotal"))+": "+t._s(t.changePrice(t.totalNum))+"\n    ")],1)])])}),[],!1,null,"03bfd4b9",null).exports),ft=(n(92),n(26),n(153)),mt=n(27),gt=n(10);function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var yt={data:function(){return{isShow:!1,isEdit:!1,loading:!1,countdown:0,isIncomplete:!0,formData:{p0:"",p1:"",p2:"",p3:"",p4:"",p5:"",p6:"",p7:"",p8:"",p9:"",verify_code:""},captchaToken:""}},props:{type:{type:String,default:"bank"}},computed:{isPaypal:function(){return"paypal"===this.type},formLeng:function(){return this.isPaypal?2:this.$isChinaSite?4:10},paramsLangKey:function(){var t=this,e={paypal:["BindPaypalKey0","BindPaypalKey1"],china:["RealName","IdCard","phone","BindAccountKey5"],other:["BindAccountKey0","BindAccountKey1","BindAccountKey6","BindAccountKey7","BindAccountKey2","BindAccountKey8","BindAccountKey9","BindAccountKey10","BindAccountKey3","BindAccountKey4"]};return this.isPaypal?e.paypal.map((function(e){return t.$t(e)})):(this.$isChinaSite?e.china:e.other).map((function(e){return t.$t(e)}))},rules:function(){for(var t=this.formLeng,e=this.isPaypal?1:this.$isChinaSite?3:0,n={verify_code:[{required:!0,message:this.$t("VerifiCodeError")}]},i=0;i<t;i++){var o=i==e,r=[{required:!0,message:this.getValidMsg(i)}];o&&r.push({validator:this.validateBind(i),trigger:"blur"}),n["p"+i]=r}return n},paramsKey:function(){var t={paypal:["name","third_account"],china:["name","id_num","phone","third_account"],other:["third_account","bank_account_name","bank_name","bank_address","swift_code","country","zip_code","city","address","email"]};return this.isPaypal?t.paypal:this.$isChinaSite?t.china:t.other},params:function(){var t=this,e=this.paramsKey,n={};return Object.keys(this.formData).forEach((function(o,i){"verify_code"!==o?e[i]&&(n[e[i]]=t.formData[o]):n.verify_code=t.formData[o]})),n},isFormComplete:function(){for(var i=0;i<this.formLeng;i++)if(!this.formData["p"+i])return!1;return!(!this.isPaypal&&!this.formData.verify_code)}},methods:{getValidMsg:function(i){return this.paramsLangKey[i]+this.$t("BindAccountWarn1")},validateBind:function(i){var t=this;return function(){var e=Object(D.a)(regeneratorRuntime.mark((function e(n,o,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=8;break}return e.next=3,Object(w.m)({third_account:o});case 3:c=e.sent,c.data.has?r(new Error(t.$t("BindAccountWarn0"))):r(),e.next=9;break;case 8:r(new Error(t.$t("gptRulesSpace")));case 9:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}()},show:function(t,e){var n=this;this.isShow=!0,this.isEdit=!!t,this.isIncomplete=this.isPaypal?4===(null==t?void 0:t.account_type)&&(null==t?void 0:t.third_account)&&!(null!=t&&t.name):4!==(null==t?void 0:t.account_type)&&((null==t?void 0:t.third_account)&&!(null!=t&&t.bank_name)&&!this.$isChinaSite||!(null!=t&&t.country)),this.isIncomplete&&e&&this.$message.warning(this.$t("BindAccountError10"));var o=this.isPaypal?4===(null==t?void 0:t.account_type):4!==(null==t?void 0:t.account_type);t&&o&&this.initParams(t),this.$nextTick((function(){var t;null===(t=n.$refs.bindForm)||void 0===t||t.clearValidate()}))},close:function(){var t=this;this.isShow=!1,this.$refs.bindForm.resetFields(),Object.keys(this.formData).forEach((function(e,i){t.formData[e]=""})),this.$emit("close")},initParams:function(t){var e=this;Object.keys(this.formData).forEach((function(n,i){e.formData["p"+i]=t[e.paramsKey[i]]}))},sendCode:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.countdown,e.t0){e.next=5;break}return e.next=4,t.validParams();case 4:e.t0=e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,t.updateCaptcha();case 9:n=t.$isChinaSite?mt.zb:w.l,o=t.params,r=o.third_account,c=o.email,l=t.$isChinaSite?{phone_number:"86-"+r,g_recaptcha_token:t.captchaToken}:{email:c},n(l).then((function(e){t.sendCodeDown(),t.$message.success(t.$t("VerifiCodeSend"))}));case 13:case"end":return e.stop()}}),e)})))()},updateCaptcha:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=window)||void 0===n||!n.grecaptcha||null===(o=window)||void 0===o||null===(o=o.grecaptcha)||void 0===o||!o.enterprise){e.next=5;break}return e.next=3,t.getToken();case 3:e.next=15;break;case 5:return e.prev=5,e.next=8,t.loadCaptcha();case 8:return e.next=10,t.getToken();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log("Google Captcha failed to load or execute",e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})))()},loadCaptcha:function(){return Object(D.a)(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(e=window)||void 0===e||!e.grecaptcha||null===(n=window)||void 0===n||null===(n=n.grecaptcha)||void 0===n||!n.enterprise){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(gt.I)("https://www.recaptcha.net/recaptcha/enterprise.js?render=".concat("6LfuV2wqAAAAAJ83QW1gae0CmT7GrgzzecQbFpJ5"));case 5:return t.next=7,new Promise((function(t,e){var n,o;null!==(n=window)&&void 0!==n&&n.grecaptcha&&null!==(o=window)&&void 0!==o&&null!==(o=o.grecaptcha)&&void 0!==o&&o.enterprise?grecaptcha.enterprise.ready(t):e(new Error("grecaptcha.enterprise not available"))}));case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log("Google Captcha failed to load or execute",t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})))()},getToken:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=window)&&void 0!==n&&null!==(n=n.grecaptcha)&&void 0!==n&&n.enterprise){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,grecaptcha.enterprise.execute("6LfuV2wqAAAAAJ83QW1gae0CmT7GrgzzecQbFpJ5",{action:"LOGIN"});case 5:t.captchaToken=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Error executing recaptcha:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))()},validParams:function(){var t=this;return new Promise((function(e,n){var o=t.$isChinaSite?3:4;t.$refs.bindForm.validateField("p"+o,(function(t){e(!!t)}))}))},sendCodeDown:function(){var t=this;this.countdown=60;var e=setInterval((function(){t.countdown--,t.countdown<=0&&(clearInterval(e),e=null)}),1e3)},bindAccount:function(){var t=this;this.$refs.bindForm.validate((function(e){e&&t.submitBindInfo()}))},submitBindInfo:function(){var t=this,e=bt(bt({},this.params),{},{account_type:this.isPaypal?4:this.$isChinaSite?1:3});this.loading=!0,(this.isEdit?w.c:w.b)(e).then((function(n){t.$message.success(t.$t("BindSuccess")),t.$emit("change",bt(bt({},e),{},{isEdit:!t.isIncomplete&&t.isEdit})),t.close()})).finally((function(){t.loading=!1}))},openServices:function(){window.SUHelpSupport?SUHelpSupport.show():Object(ft.a)((function(){setTimeout((function(){SUHelpSupport.show()}),2e3)}))},handleBlur:function(i){this.formData["p"+i]=this.formData["p"+i].trim()}}},wt=yt,Ct=(n(5352),Object(x.a)(wt,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog big-head-dialog bind-account",class:{"paypal-dialog":t.isPaypal},attrs:{visible:t.isShow,"before-close":t.close,"z-index":"1000"},on:{"update:visible":function(e){t.isShow=e}}},[e("div",{staticClass:"dialog-body"},[e("i",{staticClass:"el-icon-close close-btn",on:{click:t.close}}),t._v(" "),t.isPaypal?[e("h1",{staticClass:"title is-paypal"},[t._v(t._s(t.$t("BindPaypalLb5")))])]:[e("h1",{staticClass:"title"},[t._v(t._s(t.$t("BindAccount")))]),t._v(" "),e("p",{staticClass:"tips"},[t._v(t._s(t.$t("BindAccountTips"+(t.$isChinaSite?"1":"2"))))])],t._v(" "),e("el-form",{ref:"bindForm",staticClass:"custom-form",attrs:{model:t.formData,rules:t.rules}},[t._l(t.formLeng,(function(n,i){return e("el-form-item",{key:"formLeng_"+i,attrs:{prop:"p"+i}},[e("el-input",{attrs:{placeholder:t.paramsLangKey[i],maxlength:"100"},on:{blur:function(e){return t.handleBlur(i)}},model:{value:t.formData["p"+i],callback:function(e){t.$set(t.formData,"p"+i,e)},expression:"formData['p' + i]"}})],1)})),t._v(" "),t.isPaypal?t._e():e("el-form-item",{attrs:{prop:"verify_code"}},[e("el-input",{attrs:{placeholder:t.$t("VerifiCodePls"),maxlength:"10"},model:{value:t.formData.verify_code,callback:function(e){t.$set(t.formData,"verify_code",e)},expression:"formData.verify_code"}},[e("span",{staticClass:"send-btn",attrs:{slot:"append"},on:{click:function(e){return e.stopPropagation(),t.sendCode.apply(null,arguments)}},slot:"append"},[t._v("\n            "+t._s(t.countdown?t.countdown+"s":t.$t("VerifiCodeGet"))+"\n          ")])])],1)],2),t._v(" "),e("el-button",{staticClass:"bind-btn",class:{disabled:!t.isFormComplete},attrs:{type:"primary",loading:t.loading,disabled:!t.isFormComplete},on:{click:t.bindAccount}},[t._v("\n      "+t._s(t.$t("BindAccountSubmitBtn"))+"\n    ")]),t._v(" "),e("p",{staticClass:"bind-tips"},[t._v("\n      "+t._s(t.$t("BindAccountTips3"))),e("span",{on:{click:t.openServices}},[t._v(t._s(t.$t("BindAccountTips4")))])])],2)])}),[],!1,null,"f403c2d2",null)),kt=Ct.exports,Ot={props:{bindInfo:{type:Object,default:function(){return{third_account:"-"}}}},data:function(){return{isShow:!1,withdrawTotal:"0.00",loading:!1,selectedAccountType:"bank",BANK_ICON:{active:"https://image.cdn2.seaart.me/static/upload/20250422/86e93b9f-da72-4f2d-9d68-72a7689fbcdd.png",inactive:"https://image.cdn2.seaart.me/static/upload/20250422/2f5acb61-b85e-4a66-b448-fe5ae323e73b.png"},PAYPAL_ICON:{active:"https://image.cdn2.seaart.me/static/upload/20250422/9ee68558-1c3a-447e-b019-188b1eac16db.png",inactive:"https://image.cdn2.seaart.me/static/upload/20250422/3e2b8ed2-72ca-4dd6-9b57-60051504bbe8.png"}}},computed:{incomeTips:function(){var t=this.$t("IncomePopupTips3"),e=this.$isChinaSite?"https://image.cdn2.seaart.ai/private/creator_bonus_cn.html":"https://image.cdn2.seaart.ai/private/creator_bonus.html";return t.replace("{ATTR}",'href="'.concat(e,'" target="_blank"'))},accountInfo:function(){var t,e,n,o="paypal"===this.selectedAccountType,r=null===(t=this.bindInfo)||void 0===t?void 0:t.account_type;return{isBound:(null===(e=this.bindInfo)||void 0===e?void 0:e.third_account)&&"-"!==this.bindInfo.third_account&&(o?4===r:4!==r),third_account:(null===(n=this.bindInfo)||void 0===n?void 0:n.third_account)||"-"}}},methods:{show:function(t,e){this.withdrawTotal=t,this.isShow=!0,this.selectedAccountType=e||"bank"},close:function(){this.isShow=!1},selectMethod:function(t){this.selectedAccountType=t},handleBindClick:function(){var t=this;if(this.bindInfo&&0!==Object.keys(this.bindInfo).length){if(!(this.bindInfo.edit_month!==this.getNowDate()))return void this.$message.warning(this.$t("BindPaymentWarning"));this.$confirm(this.$t("BindAccountTips"),this.$t("BindAccountPopupTitle"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"custom-confirm"}).then(Object(D.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),e.next=3,t.$nextTick();case 3:t.$emit("bind-account",t.selectedAccountType);case 4:case"end":return e.stop()}}),e)}))))}else this.$emit("bind-account",this.selectedAccountType),this.close()},withdrawing:function(){var t=this;if(this.withdrawTotal<100){var e=this.$t("ApplyWithdrawWarning",{price:this.changePrice(100)});this.$message.warning(e)}else this.loading=!0,Object(w.a)().then((function(e){t.$message.success(t.$t("ApplyWithdrawSuccess")),t.close(),t.$emit("change")})).finally((function(){t.loading=!1}))},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite,!0)},getNowDate:function(){var t=new Date,e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(e).concat(n)}}};n(5353);function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St={components:{LongCard:R,IncomeTable:pt,BindAccount:kt,IncomePopup:Object(x.a)(Ot,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"big-head-dialog income-popup",attrs:{visible:t.isShow,"before-close":t.close},on:{"update:visible":function(e){t.isShow=e}}},[e("div",{staticClass:"dialog-body"},[e("i",{staticClass:"el-icon-close close-btn",on:{click:t.close}}),t._v(" "),e("div",{staticClass:"dialog-bg-image"}),t._v(" "),e("img",{staticClass:"popup-icon",attrs:{src:n(1053),alt:""}}),t._v(" "),e("p",{staticClass:"title"},[t._v(t._s(t.$t("IncomePopupTitle")))]),t._v(" "),e("p",{staticClass:"price"},[t._v(t._s(t.changePrice(t.withdrawTotal)))]),t._v(" "),e("p",{staticClass:"tips"},[t._v(t._s(t.$t("IncomePopupTips",{price:t.changePrice(100)})))]),t._v(" "),e("div",{staticClass:"section-type-box"},[e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("BindPaypalLb1")))]),t._v(" "),e("div",{staticClass:"method-selection"},[e("div",{class:["method-box",{active:"bank"===t.selectedAccountType}],on:{click:function(e){return t.selectMethod("bank")}}},[e("div",{staticClass:"method-icon"},[e("img",{directives:[{name:"show",rawName:"v-show",value:"bank"===t.selectedAccountType,expression:"selectedAccountType === 'bank'"}],attrs:{src:t.BANK_ICON.active,alt:""}}),t._v(" "),e("img",{directives:[{name:"show",rawName:"v-show",value:"bank"!==t.selectedAccountType,expression:"selectedAccountType !== 'bank'"}],attrs:{src:t.BANK_ICON.inactive,alt:""}})]),t._v(" "),e("span",{staticClass:"method-name"},[t._v(t._s(t.$t("BindPaypalLb3")))]),t._v(" "),e("div",{staticClass:"check-icon-wrapper"},["bank"===t.selectedAccountType?e("i",{staticClass:"el-icon-check checked-icon"}):e("span",{staticClass:"unchecked-circle"})])]),t._v(" "),e("div",{class:["method-box",{active:"paypal"===t.selectedAccountType}],on:{click:function(e){return t.selectMethod("paypal")}}},[e("div",{staticClass:"method-icon"},[e("img",{directives:[{name:"show",rawName:"v-show",value:"paypal"===t.selectedAccountType,expression:"selectedAccountType === 'paypal'"}],attrs:{src:t.PAYPAL_ICON.active,alt:""}}),t._v(" "),e("img",{directives:[{name:"show",rawName:"v-show",value:"paypal"!==t.selectedAccountType,expression:"selectedAccountType !== 'paypal'"}],attrs:{src:t.PAYPAL_ICON.inactive,alt:""}})]),t._v(" "),e("span",{staticClass:"method-name"},[t._v("PayPal")]),t._v(" "),e("div",{staticClass:"check-icon-wrapper"},["paypal"===t.selectedAccountType?e("i",{staticClass:"el-icon-check checked-icon"}):e("span",{staticClass:"unchecked-circle"})])])]),t._v(" "),e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("BindPaypalLb2")))]),t._v(" "),e("div",{staticClass:"account-info-box",on:{click:t.handleBindClick}},[t.accountInfo.isBound?e("span",{staticClass:"account-display"},[t._v("\n          "+t._s(t.accountInfo.third_account)+"\n        ")]):e("span",{staticClass:"unbind-tip"},[t._v(t._s(t.$t("BindPaypalLb4")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-right arrow-icon"})])]),t._v(" "),e("el-button",{staticClass:"income-btn",attrs:{type:"primary",loading:t.loading,disabled:!t.accountInfo.isBound},on:{click:t.withdrawing}},[t._v("\n      "+t._s(t.$t("IncomePopupBtn"))+"\n    ")]),t._v(" "),e("p",{staticClass:"income-tips",domProps:{innerHTML:t._s(t.incomeTips)}})],1)])}),[],!1,null,"01520cfa",null).exports},data:function(){return{bindAccountInfo:null,bindAccountLoading:!0,pointsInfo:null,selectedAccountType:""}},computed:{pointsList:function(){var t,e,n,o;return[{title:this.$t("CumulativeIncome"),value:this.changePrice(null===(t=this.pointsInfo)||void 0===t?void 0:t.earnings),icon:"a-shouyi11"},{title:this.$t("CreationCenterModelIncome"),value:this.changePrice(null===(e=this.pointsInfo)||void 0===e||null===(e=e.now)||void 0===e?void 0:e.model_earnings),icon:"icon-Menu-model-selected"},{title:this.$t("CreationCenterNumberPeopleIncome"),value:this.changePrice(null===(n=this.pointsInfo)||void 0===n||null===(n=n.now)||void 0===n?void 0:n.character_earnings),icon:"icon-Menu-Cyberpub-selected"},{title:this.$t("CreationCenterAiAppIncome"),value:this.changePrice(null===(o=this.pointsInfo)||void 0===o||null===(o=o.now)||void 0===o?void 0:o.comfy_ui_earnings),icon:"a-icon-menu-quicktool-selected"}]}},methods:{initBindInfo:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.bindAccountLoading=!0,e.next=3,Object(w.d)();case 3:n=e.sent,t.bindAccountInfo=n.data,t.bindAccountLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},initPoints:function(){var t=this;return Object(D.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.g)();case 2:n=e.sent,t.pointsInfo=n.data;case 4:case"end":return e.stop()}}),e)})))()},handleBindAccount:function(t){var e=this;this.selectedAccountType=t,this.$nextTick((function(){e.showBindPopup()}))},showBindPopup:function(){this.$refs.bindAccountPopup.show(this.bindAccountInfo)},showIncomePopup:function(t){if(this.$logEvent("log_actions",{operation:"click_withdraw_cash",behavior_info:"on_creator_revenue_center"}),this.bindAccountInfo){var e=this.bindAccountInfo,n=e.bank_name,o=e.country;if(!(4===e.account_type||this.$isChinaSite||o&&n))return void this.$refs.bindAccountPopup.show(this.bindAccountInfo,!0)}var r=this.$refs.incomeTable.getWithdrawTotal();this.$refs.incomePopup.show(r,t)},getNowDate:function(){var t=new Date,e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(e).concat(n)},changeBindInfo:function(t){this.bindAccountInfo=It(It({},t),{},{edit_month:t.isEdit?this.getNowDate():""}),this.selectedAccountType=4===t.account_type?"paypal":"bank",this.showIncomePopup(this.selectedAccountType)},closeBindPopup:function(){this.showIncomePopup(this.selectedAccountType)},changePrice:function(t){return Object(j.a)(t,this.$isChinaSite)},updateList:function(){this.$refs.incomeTable.initList()}},mounted:function(){this.initBindInfo(),this.initPoints(),this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-income-center-points"})}},Dt=(n(5354),Object(x.a)(St,(function(){var t,e=this,n=e._self._c;return n("div",[n("div",{staticClass:"section-title"},[e._v(e._s(e.$t("CreationCenterMyPointsIncome")))]),e._v(" "),n("section",{staticClass:"page-header"},[n("div",{staticClass:"profits-list"},e._l(e.pointsList,(function(t){return n("LongCard",{key:t.title,attrs:{title:t.title,value:t.value,icon:t.icon}})})),1)]),e._v(" "),n("section",{staticClass:"withdraw"},[n("div",{staticClass:"operation-wrapper"},[n("el-button",{staticClass:"operation-btn primary-btn",on:{click:function(t){return e.showIncomePopup("bank")}}},[e._v("\n        "+e._s(e.$t("Withdraw"))+"\n      ")])],1),e._v(" "),n("IncomeTable",{ref:"incomeTable",attrs:{total:null===(t=e.pointsInfo)||void 0===t?void 0:t.earnings_take}})],1),e._v(" "),n("BindAccount",{ref:"bindAccountPopup",attrs:{type:e.selectedAccountType},on:{change:e.changeBindInfo,close:e.closeBindPopup}}),e._v(" "),n("IncomePopup",{ref:"incomePopup",attrs:{bindInfo:e.bindAccountInfo},on:{change:e.updateList,"bind-account":e.handleBindAccount}})],1)}),[],!1,null,"68fc6570",null).exports),Lt={props:{courseInfo:{type:Object,default:function(){return{articleId:"",imgCover:"",title:"",authorIcon:"",authorName:"",likeCount:0,collectCount:0}}}},methods:{goDetail:function(){this.$router.push({path:"/articleDetail/".concat(this.courseInfo.articleId)})}}},Pt=(n(5355),Object(x.a)(Lt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"course-card",on:{click:t.goDetail}},[e("div",{staticClass:"course-img",style:{backgroundImage:"url('".concat(t.courseInfo.imgCover,"')")}}),t._v(" "),e("div",{staticClass:"course-title"},[t._v(t._s(t.courseInfo.title))]),t._v(" "),e("div",{staticClass:"course-footer"},[e("div",{staticClass:"author-info"},[e("img",{staticClass:"author-icon",attrs:{src:t.courseInfo.authorIcon}}),t._v(" "),e("div",{staticClass:"author-name"},[t._v(t._s(t.courseInfo.authorName))])]),t._v(" "),e("div",{staticClass:"data-info"},[e("div",{staticClass:"data-item"},[e("Icon",{attrs:{name:"like1",size:"14",color:"#b6b6b9"}}),t._v(" "),e("div",{staticClass:"data-count"},[t._v(t._s(t.courseInfo.likeCount))])],1),t._v(" "),e("div",{staticClass:"data-item"},[e("Icon",{attrs:{name:"a-dianzan2",size:"14",color:"#b6b6b9"}}),t._v(" "),e("div",{staticClass:"data-count"},[t._v(t._s(t.courseInfo.collectCount))])],1)])])])}),[],!1,null,"f0b36a18",null).exports),jt=n(5356),$t={components:{CourseCard:Pt},mounted:function(){this.$xyLogEvent({front_operation:"exposure",entity_name:"creation-center-page",entity_type:"page-creative-school"})},data:function(){return{courseList:jt.a}},computed:{},methods:{}},Tt=(n(5357),Object(x.a)($t,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("CreationCenterCreativeSchool")))]),t._v(" "),e("section",{staticClass:"creative-school"},[e("div",{staticClass:"course-list"},t._l(t.courseList,(function(t){return e("CourseCard",{key:t.articleId,attrs:{courseInfo:t}})})),1)])])}),[],!1,null,"6a8ca7c4",null).exports);function Mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var At={components:{BackIcon:y.default,IntroduceDialog:I,ElMenu:m.a,ElMenuItem:v.a,ElSubmenu:d.a,ElMenuItemGroup:c.a,home:H,dataCenterModel:X,dataCenterCharacter:Z,dataCenterAiApp:et,dataCenterWorkflow:nt,incomeCenterPoints:Dt,creativeSchool:Tt},data:function(){return{isShowIntroduceDialog:!1,activeIndex:this.$route.params.index||"home",menuList:[{index:"home",title:this.$t("CreationCenterHome"),icon:"icon-menu-home-selected"},{index:"dataCenter",title:this.$t("CreationCenterDataCenter"),icon:"a-datacenter",children:[{index:"dataCenterModel",title:this.$t("Model")},{index:"dataCenterCharacter",title:this.$t("Tavern")},{index:"dataCenterAiApp",title:this.$t("Swtft_App")},{index:"dataCenterWorkflow",title:this.$t("WorkFlow")}]},{index:"incomeCenter",title:this.$t("CreationCenterIncomeCenter"),icon:"a-tixianjiluicon1",children:[{index:"incomeCenterPoints",title:this.$t("CreationCenterPointsIncome")}]},{index:"eventCenter",title:this.$t("Event_Center"),icon:"icon-huodong-hover"},{index:"creativeSchool",title:this.$t("CreationCenterCreativeSchool"),icon:"a-SchoolCreative-selected"}]}},computed:Rt(Rt({},Object(_.e)("user",["userInfo"])),{},{fqaUrl:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/6-permanent-events/creator-incentive-program-faq":"https://docs.seaart.ai/guide-1/ri-ben-yu/6-naibento/kuritpuroguramufaq"},notEnteredNewVersion:function(){var t;return 2!==(null===(t=this.userInfo)||void 0===t?void 0:t.join_stimulate)}}),methods:{goTabPage:function(t){if("eventCenter"===t.index)window.open("/event-center","_blank");else if(t.index!==this.$route.params.index){var e=this.$route.path.replace("/".concat(this.$route.params.index),"/".concat(t.index));this.$router.replace(e)}}},mounted:function(){this.notEnteredNewVersion&&(this.isShowIntroduceDialog=!0)}},Et=(n(5358),Object(x.a)(At,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"creation-center"},[e("BackIcon"),t._v(" "),e("IntroduceDialog",{attrs:{visible:t.isShowIntroduceDialog},on:{"update:visible":function(e){t.isShowIntroduceDialog=e}}}),t._v(" "),e("div",{staticClass:"left-menu"},[e("el-menu",{staticClass:"menu-list",attrs:{"default-active":t.activeIndex,"default-openeds":t.menuList.map((function(t){return t.index})),"background-color":"#11131F","text-color":"#6f767e","active-text-color":"#fcfcfc"}},t._l(t.menuList,(function(n){return e("div",{key:n.index},[n.children?[e("el-submenu",{attrs:{index:n.index}},[e("template",{slot:"title"},[e("Icon",{attrs:{name:n.icon,size:"24"}}),t._v(" "),e("span",[t._v(t._s(n.title))])],1),t._v(" "),t._l(n.children,(function(n){return e("el-menu-item",{key:n.index,attrs:{index:n.index,"data-event":"creation-center-left-menu-click","data-id":n.index},on:{click:function(e){return t.goTabPage(n)}}},[e("span",[t._v(t._s(n.title))])])}))],2)]:[e("el-menu-item",{attrs:{index:n.index,"data-event":"creation-center-left-menu-click","data-id":n.index},on:{click:function(e){return t.goTabPage(n)}}},[e("Icon",{attrs:{name:n.icon,size:"24"}}),t._v(" "),e("span",[t._v(t._s(n.title))])],1)]],2)})),0),t._v(" "),e("a",{staticClass:"fqa",attrs:{href:t.fqaUrl,target:"_blank"}},[e("i",{staticClass:"el-icon-warning-outline"}),t._v("\n      "+t._s(t.$t("FrequentlyAskedQuestions"))+"\n    ")])],1),t._v(" "),e(t.activeIndex,{tag:"component",staticClass:"right-content"})],1)}),[],!1,null,"3536a590",null));e.default=Et.exports;installComponents(Et,{BackIcon:n(290).default})},5723:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1),c=(n(19),n(32),n(77),n(567)),l=(n(31),n(18),n(65),n(3)),d=(n(20),n(10)),h=n(36),v="month",f="day",m={name:"RankTimeFilter",props:{modelValue:{type:String,required:!0}},data:function(){return{TIME_TYPE_LISTS:[{tabIndex:0,value:v,title_label:"last_num_days",num:30},{tabIndex:1,value:f,title_label:"last_num_hours",num:24}]}},emits:["update:modelValue","timeChange"],mounted:function(){console.log(this.modelValue)},methods:{getTimeLabel:function(t){return{MONTH:this.$t("last_num_days",{num:30}),DAY:this.$t("last_num_hours",{num:24})}[t]||t},handleTimeChange:function(t){console.log("value",t),this.$emit("update:modelValue",t),this.$emit("timeChange",t)}}},_=(n(4757),n(0)),y=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"time-filter"},t._l(t.TIME_TYPE_LISTS,(function(n,o){return e("div",{key:o,staticClass:"time-btn",class:{active:t.modelValue===n.value},on:{click:function(e){return t.handleTimeChange(n.value)}}},[e("span",{staticClass:"time-btn-text"},[t._v(t._s(t.$t(n.title_label,{num:n.num})))])])})),0)}),[],!1,null,"faffe364",null).exports,w={name:"RankTimePeriod",props:{dataRange:{type:String,default:""}},data:function(){return{}},mounted:function(){},methods:{}},C=(n(4758),Object(_.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"time-filter"},[e("div",{staticClass:"time-btn"},[e("span",{staticClass:"time-btn-text"},[t._v(t._s(t.dataRange))])])])}),[],!1,null,"7439f9fd",null).exports),k={name:"RankPostHeroes",components:{RankTimeFilter:y,RankTimePeriod:C},props:{},data:function(){return{NUM_DECIMAL:2,formatNumberForeign:d.p,localRankList:[],localLoading:!1,timeValue:"day",refreshTime:"",dataRange:this.$t("last_num_hours",{num:24})}},watch:{timeValue:function(t){this.timeValue=t,this.getHeroesRankList()}},methods:{getNameFirst:function(t){var e=t||{},n=e.name,o=e.id;return(n?n[0]:this.name?this.name.slice(0,1):o?o[0]:"V").toUpperCase()},handleClick:function(t){var e;console.log("item",t);var n=(null==t||null===(e=t.author)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n),o=this.localePath(path),r=this.$router.resolve({path:o});window.open(r.href,"_blank")},onTimeChange:function(t){this.timeValue=t,console.log("this.timeValue",this.timeValue)},getRankList:function(){this.getHeroesRankList()},getHeroesRankList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.localRankList=[],t.localLoading=!0,n={time_type:t.timeValue},e.prev=3,e.next=6,Object(h.rankDetailPostHeroes)(n);case 6:(o=e.sent)&&o.data&&(t.localRankList=o.data.list||[],t.refreshTime=o.data.refresh_at,t.getComponentData());case 8:return e.prev=8,t.localLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})))()},getComponentData:function(){this.$emit("getCurrentComponentData",{rankList:this.localRankList,timeValue:this.timeValue,loading:this.localLoading,refreshTime:this.refreshTime})}},activated:function(){this.hasLoaded||this.getHeroesRankList()}},O=(n(4759),Object(_.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rank"},[e("RankTimePeriod",{attrs:{dataRange:t.dataRange}}),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localLoading,expression:"localLoading"}],staticClass:"rank-list rank-list-heroes"},t._l(t.localRankList,(function(o,r){var c,l;return e("div",{key:r,class:["rank-item",{top1:0===r,top2:1===r,top3:2===r,"rank-item-large":r<3,"rank-item-normal":r>=3}]},[e("div",{staticClass:"rank-num"},[r<3?e("span",{class:["medal","medal-"+(r+1)]},[e("span",0===r?{staticClass:"medal-1-text"}:1===r?{staticClass:"medal-2-text"}:{staticClass:"medal-3-text"},[t._v(t._s(r+1))])]):e("span",{staticClass:"rank-num-text"},[t._v(t._s(r+1))])]),t._v(" "),[e("div",{staticClass:"user-avatar",class:{"avatar-border-1":0===r,"avatar-border-2":1===r,"avatar-border-3":2===r,"avatar-large-margin":r<3,"avatar-normal-margin":r>=3},attrs:{"data-group":"ranking_post_heroes_module","data-event":"rank_post_heroes_click_"+(null==o||null===(c=o.author)||void 0===c?void 0:c.id)},on:{click:function(e){return t.handleClick(o)}}},[e("div",{staticClass:"avatar-border"},[o.author.head?e("img",{class:{"avatar-large":r<3,"avatar-normal":r>=3},attrs:{src:o.author.head,alt:"avatar"}}):e("div",{staticClass:"base-text",class:{"base-text-large":r<3,"base-text-normal":r>=3}},[t._v("\n              "+t._s(t.getNameFirst(o.author))+"\n            ")])]),t._v(" "),0===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(501)}}):t._e(),t._v(" "),1===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(502)}}):t._e(),t._v(" "),2===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(503)}}):t._e()]),t._v(" "),e("div",{staticClass:"user-info",attrs:{"data-group":"ranking_post_heroes_module","data-event":"rank_post_heroes_click_"+(null==o||null===(l=o.author)||void 0===l?void 0:l.id)},on:{click:function(e){return t.handleClick(o)}}},[e("div",{staticClass:"user-name"},[t._v("\n            "+t._s(o.author.name||o.author.id)+"\n            "),o.badges&&o.badges.length>0?[t._l(o.badges.slice(0,6),(function(i,t){return[e("img",{staticClass:"user-badge-icon",attrs:{src:i.uri,alt:""}})]})),t._v(" "),o.badges.length>6?e("span",{staticClass:"badge-ellipsis"},[t._v("...")]):t._e()]:t._e()],2),t._v(" "),e("div",{staticClass:"user-stats"},[e("span",{staticClass:"stat"},[e("i",{staticClass:"iconfont icon-tougao1"}),t._v(" "),e("span",{staticClass:"stat-text"},[t._v(t._s(t.formatNumberForeign(o.number_of_post)))])]),t._v(" "),e("span",{staticClass:"stat"},[e("i",{staticClass:"iconfont icon-redu"}),t._v(" "),e("span",{staticClass:"stat-text"},[t._v(t._s(t.formatNumberForeign(o.num_of_be_collection)))])]),t._v(" "),e("span",{staticClass:"stat"},[e("i",{staticClass:"iconfont icon-guanzhu4"}),t._v(" "),e("span",{staticClass:"stat-text"},[t._v(t._s(t.formatNumberForeign(o.number_of_fans)))])]),t._v(" "),e("span",{staticClass:"stat"},[e("i",{staticClass:"iconfont icon-huojiang"}),t._v(" "),e("span",{staticClass:"stat-text"},[t._v(t._s(t.formatNumberForeign(o.num_of_activity_award)))])])])])],t._v(" "),e("div",{staticClass:"user-score"},[e("span",{staticClass:"score",class:{"score-1":0===r,"score-2":1===r,"score-3":2===r}},[t._v("\n          "+t._s(o.score.toFixed(t.NUM_DECIMAL))+"\n        ")]),t._v(" "),e("span",{staticClass:"score-label"},[t._v(t._s(t.$t("post_score")))])])],2)})),0)],1)}),[],!1,null,"1904fcc1",null).exports),x={name:"RankHottestModels",components:{RankTimeFilter:y,RankTimePeriod:C},props:{rankList:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{NUM_DECIMAL:2,localRankList:[],localLoading:!1,timeValue:"day",refreshTime:"",dataRange:this.$t("last_num_hours",{num:24})}},watch:{timeValue:function(t){this.timeValue=t,this.getModelsRankList()}},computed:{fontColor:function(){return"#e9eef8"}},methods:{getNameFirst:function(t){var e=t||{},n=e.name,o=e.id;return(n?n[0]:this.name?this.name.slice(0,1):o?o[0]:"V").toUpperCase()},handleUserClick:function(t){var e;console.log("item",t);var n=(null==t||null===(e=t.author)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n),o=this.localePath(path),r=this.$router.resolve({path:o});window.open(r.href,"_blank")},handleModelClick:function(t){console.log("item",t),console.log("item",t);var e=(null==t?void 0:t.id)||"",path="/models/detail/"+encodeURIComponent(e),n=this.localePath(path),o=this.$router.resolve({path:n});window.open(o.href,"_blank")},onTimeChange:function(t){this.timeValue=t},getRankList:function(){this.getModelsRankList()},getModelsRankList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.localRankList=[],t.localLoading=!0,n={time_type:t.timeValue},e.prev=3,e.next=6,Object(h.rankDetailHottestModels)(n);case 6:(o=e.sent)&&o.data&&(t.localRankList=o.data.list||[],t.refreshTime=o.data.refresh_at,t.getComponentData());case 8:return e.prev=8,t.localLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})))()},getComponentData:function(){this.$emit("getCurrentComponentData",{rankList:this.localRankList,timeValue:this.timeValue,loading:this.localLoading,refreshTime:this.refreshTime})}},activated:function(){this.hasLoaded||this.getModelsRankList()}},I=(n(4760),Object(_.a)(x,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rank"},[e("RankTimePeriod",{attrs:{dataRange:t.dataRange}}),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localLoading,expression:"localLoading"}],staticClass:"rank-list rank-list-earnings"},t._l(t.localRankList,(function(o,r){var c;return e("div",{key:r,class:["rank-item",{top1:0===r,top2:1===r,top3:2===r,"rank-item-large":r<3,"rank-item-normal":r>=3}]},[e("div",{staticClass:"rank-num"},[r<3?e("span",{class:["medal","medal-"+(r+1)]},[e("span",0===r?{staticClass:"medal-1-text"}:1===r?{staticClass:"medal-2-text"}:{staticClass:"medal-3-text"},[t._v(t._s(r+1))])]):e("span",{staticClass:"rank-num-text"},[t._v(t._s(r+1))])]),t._v(" "),e("div",{staticClass:"model-avatar-wrap",on:{click:function(e){return t.handleModelClick(o)}}},[e("img",{class:["model-avatar",{"model-avatar-large":r<3,"model-avatar-normal":r>=3},0===r?"model-avatar-1":"",1===r?"model-avatar-2":"",2===r?"model-avatar-3":""],attrs:{src:o.cover.cover}}),t._v(" "),0===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(501)}}):t._e(),t._v(" "),1===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(502)}}):t._e(),t._v(" "),2===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(503)}}):t._e()]),t._v(" "),e("div",{staticClass:"user-info"},[e("div",{staticClass:"user-title-wrap",on:{click:function(e){return t.handleModelClick(o)}}},[e("span",{staticClass:"user-title"},[t._v(t._s(o.model_name))]),t._v(" "),e("span",{staticClass:"model-tag"},[t._v(t._s(o.model_type)+" model")])]),t._v(" "),e("div",{staticClass:"user-name",attrs:{"data-group":"ranking_hottest_models_module","data-event":"rank_hottest_models_click_"+(null==o||null===(c=o.author)||void 0===c?void 0:c.id)},on:{click:function(e){return t.handleUserClick(o)}}},[o.author.head?e("img",{staticClass:"user-name-avatar",attrs:{src:o.author.head}}):e("div",{staticClass:"base-text"},[t._v("\n            "+t._s(t.getNameFirst(o))+"\n          ")]),t._v("\n          "+t._s(o.author.name||o.author.id)+"\n        ")])]),t._v(" "),e("div",{staticClass:"user-score"},[e("span",{staticClass:"score",class:{"score-1":0===r,"score-2":1===r,"score-3":2===r}},[t._v("\n          "+t._s(o.score.toFixed(t.NUM_DECIMAL))+"\n        ")]),t._v(" "),e("span",{staticClass:"score-label"},[t._v(t._s(t.$t("model_score")))])]),t._v(" "),e("div",{staticClass:"user-trend"},[0!==o.score_trend?[e("span",{staticClass:"trend-value",class:o.score_trend>0?"trend-up":"trend-down"},[t._v("\n            "+t._s(o.score_trend>0?"↑":"↓")+t._s(Math.abs(o.score_trend).toFixed(t.NUM_DECIMAL))+"%\n          ")])]:[e("div",{staticClass:"trend-divider"})],t._v(" "),e("span",{staticClass:"trend-label"},[t._v(t._s(t.$t("rank_compare_last_period")))])],2)])})),0)],1)}),[],!1,null,"2f0931c9",null).exports),S={name:"RankCreatorEarnings",components:{RankTimePeriod:C},props:{rankList:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{NUM_DECIMAL:2,localRankList:[],localLoading:!1,timeValue:"month",refreshTime:"",startDate:"",endDate:"",dataRange:""}},watch:{timeValue:function(t){this.timeValue=t,this.getEarningsRankList()}},methods:{getNameFirst:function(t){var e=t||{},n=e.name,o=e.id;return(n?n[0]:this.name?this.name.slice(0,1):o?o[0]:"V").toUpperCase()},handleUserClick:function(t){var e;console.log("item",t);var n=(null==t||null===(e=t.author)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n),o=this.localePath(path),r=this.$router.resolve({path:o});window.open(r.href,"_blank")},onTimeChange:function(t){this.timeValue=t,console.log("this.timeValue",this.timeValue)},getRankList:function(){this.getEarningsRankList()},getDateRange:function(){var t=new Date(this.startDate),e=new Date(this.endDate),n=function(t){var e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(e,"/").concat(n)};return"".concat(n(t),"--").concat(n(e))},getEarningsRankList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.localRankList=[],t.localLoading=!0,n={time_type:t.timeValue},e.prev=3,e.next=6,Object(h.rankDetailCreatorEarnings)(n);case 6:(o=e.sent)&&o.data&&(t.localRankList=o.data.list||[],t.refreshTime=o.data.refresh_at,t.startDate=o.data.start_at,t.endDate=o.data.end_at,t.getComponentData(),t.dataRange=t.getDateRange());case 8:return e.prev=8,t.localLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})))()},getComponentData:function(){this.$emit("getCurrentComponentData",{rankList:this.localRankList,timeValue:this.timeValue,loading:this.localLoading,refreshTime:this.refreshTime})}},activated:function(){this.hasLoaded||this.getEarningsRankList()}},D=(n(4761),Object(_.a)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rank"},[e("RankTimePeriod",{attrs:{dataRange:t.dataRange}}),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localLoading,expression:"localLoading"}],staticClass:"rank-list rank-list-earnings"},t._l(t.localRankList,(function(o,r){var c,l;return e("div",{key:r,class:["rank-item",{top1:0===r,top2:1===r,top3:2===r,"rank-item-large":r<3,"rank-item-normal":r>=3}]},[e("div",{staticClass:"rank-num"},[r<3?e("span",{class:["medal","medal-"+(r+1)]},[0===r?e("span",{staticClass:"medal-1-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),1===r?e("span",{staticClass:"medal-2-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),2===r?e("span",{staticClass:"medal-3-text"},[t._v(t._s(r+1))]):t._e()]):e("span",{staticClass:"rank-num-text"},[t._v(t._s(r+1))])]),t._v(" "),e("div",{staticClass:"user-avatar",class:{"avatar-border-1":0===r,"avatar-border-2":1===r,"avatar-border-3":2===r,"avatar-large-margin":r<3,"avatar-normal-margin":r>=3},attrs:{"data-group":"ranking_creator_earnings_module","data-event":"rank_creator_earnings_click_"+(null==o||null===(c=o.author)||void 0===c?void 0:c.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"avatar-border"},[o.author.head?e("img",{class:{"avatar-large":r<3,"avatar-normal":r>=3},attrs:{src:o.author.head,alt:"avatar"}}):e("div",{staticClass:"base-text",class:{"base-text-large":r<3,"base-text-normal":r>=3}},[t._v("\n            "+t._s(t.getNameFirst(o.author))+"\n          ")])]),t._v(" "),0===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(501)}}):t._e(),t._v(" "),1===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(502)}}):t._e(),t._v(" "),2===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(503)}}):t._e()]),t._v(" "),e("div",{staticClass:"user-info",attrs:{"data-group":"ranking_creative_pioneer_module","data-event":"rank_creative_pioneer_click_"+(null==o||null===(l=o.author)||void 0===l?void 0:l.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"user-name"},[t._v("\n          "+t._s(o.author.name||o.author.id)+"\n          "),o.badges&&o.badges.length>0?[t._l(o.badges.slice(0,6),(function(i,t){return[e("img",{staticClass:"user-badge-icon",attrs:{src:i.uri,alt:""}})]})),t._v(" "),o.badges.length>6?e("span",{staticClass:"badge-ellipsis"},[t._v("...")]):t._e()]:t._e()],2)]),t._v(" "),e("div",{staticClass:"user-score"},[e("span",{staticClass:"score",class:{"score-1":0===r,"score-2":1===r,"score-3":2===r}},[t._v("\n          $ "+t._s(o.score.toFixed(t.NUM_DECIMAL))+"\n        ")])])])})),0)],1)}),[],!1,null,"45466e40",null).exports),L={name:"RankNoData"},P=(n(4762),Object(_.a)(L,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rank-no-data"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/web/rank-no-data.png",alt:"no-data"}}),t._v(" "),e("div",{staticClass:"model-list-no-data"},[t._v(t._s(t.$t("no_data")))])])}),[],!1,null,"68e0ba37",null).exports),j={name:"RankShiningStar",components:{RankNoData:P},props:{rankList:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{NUM_DECIMAL:2,localRankList:[],localLoading:!0,timeValue:"month",refreshTime:"",startDate:"",endDate:"",dataRange:""}},watch:{timeValue:function(t){this.timeValue=t,this.getEarningsRankList()}},methods:{getNameFirst:function(t){var e=t||{},n=e.name,o=e.id;return(n?n[0]:this.name?this.name.slice(0,1):o?o[0]:"V").toUpperCase()},handleUserClick:function(t){var e,n=(null==t||null===(e=t.author)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n),o=this.localePath(path),r=this.$router.resolve({path:o});window.open(r.href,"_blank")},onTimeChange:function(t){this.timeValue=t},getRankList:function(){this.getShiningStarRankList()},getDateRange:function(){var t=new Date(this.startDate),e=new Date(this.endDate),n=function(t){var e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(e,"/").concat(n)};return"".concat(n(t),"--").concat(n(e))},getShiningStarRankList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.localRankList=[],t.localLoading=!0,n={time_type:t.timeValue},e.prev=3,e.next=6,Object(h.rankDetailShiningStar)(n);case 6:(o=e.sent)&&o.data&&(t.refreshTime=o.data.refresh_at,t.startDate=o.data.start_at,t.endDate=o.data.end_at,t.getComponentData(),t.dataRange=t.getDateRange());case 8:return e.prev=8,t.localLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})))()},getComponentData:function(){this.$emit("getCurrentComponentData",{rankList:this.localRankList,timeValue:this.timeValue,loading:this.localLoading,refreshTime:this.refreshTime})}},activated:function(){this.hasLoaded||this.getEarningsRankList()}},$=(n(4763),Object(_.a)(j,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localLoading,expression:"localLoading"}],staticClass:"rank"},[t.localRankList.length>0?e("div",{staticClass:"rank-list rank-list-earnings"},t._l(t.localRankList,(function(o,r){var c,l,d,h,v,f,m;return e("div",{key:r,class:["rank-item",{top1:0===r,top2:1===r,top3:2===r,"rank-item-large":r<3,"rank-item-normal":r>=3}]},[e("div",{staticClass:"rank-num"},[r<3?e("span",{class:["medal","medal-"+(r+1)]},[0===r?e("span",{staticClass:"medal-1-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),1===r?e("span",{staticClass:"medal-2-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),2===r?e("span",{staticClass:"medal-3-text"},[t._v(t._s(r+1))]):t._e()]):e("span",{staticClass:"rank-num-text"},[t._v(t._s(r+1))])]),t._v(" "),e("div",{staticClass:"user-avatar",class:{"avatar-border-1":0===r,"avatar-border-2":1===r,"avatar-border-3":2===r,"avatar-large-margin":r<3,"avatar-normal-margin":r>=3},attrs:{"data-group":"ranking_shining_star_module","data-event":"rank_shining_star_click_"+(null==o||null===(c=o.author)||void 0===c?void 0:c.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"avatar-border"},[null!=o&&null!==(l=o.author)&&void 0!==l&&l.head?e("img",{class:{"avatar-large":r<3,"avatar-normal":r>=3},attrs:{src:o.author.head,alt:"avatar"}}):e("div",{staticClass:"base-text",class:{"base-text-large":r<3,"base-text-normal":r>=3}},[t._v("\n            "+t._s(t.getNameFirst(o.author))+"\n          ")])]),t._v(" "),0===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(501)}}):t._e(),t._v(" "),1===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(502)}}):t._e(),t._v(" "),2===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(503)}}):t._e()]),t._v(" "),e("div",{staticClass:"user-info",attrs:{"data-group":"ranking_shining_star_module","data-event":"rank_shining_star_click_"+(null==o||null===(d=o.author)||void 0===d?void 0:d.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"user-name"},[t._v("\n          "+t._s((null==o||null===(h=o.author)||void 0===h?void 0:h.name)||(null==o||null===(v=o.author)||void 0===v?void 0:v.id))+"\n          "),(null==o||null===(f=o.badges)||void 0===f?void 0:f.length)>0?[t._l(o.badges.slice(0,6),(function(i,t){return[e("img",{staticClass:"user-badge-icon",attrs:{src:i.uri,alt:""}})]})),t._v(" "),o.badges.length>6?e("span",{staticClass:"badge-ellipsis"},[t._v("...")]):t._e()]:t._e()],2)]),t._v(" "),e("div",{staticClass:"user-score"},[e("span",{staticClass:"score",class:{"score-1":0===r,"score-2":1===r,"score-3":2===r}},[t._v("\n          "+t._s(null==o||null===(m=o.score)||void 0===m?void 0:m.toFixed(t.NUM_DECIMAL))+"\n        ")])])])})),0):t._e(),t._v(" "),0!==t.localRankList.length||t.localLoading?t._e():e("RankNoData")],1)}),[],!1,null,"25008ca8",null).exports),T={name:"RankCreativePioneer",components:{RankTimePeriod:C,RankNoData:P},props:{rankList:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{NUM_DECIMAL:2,localRankList:[],localLoading:!0,timeValue:"month",refreshTime:"",startDate:"",endDate:"",dataRange:""}},methods:{getNameFirst:function(t){var e=t||{},n=e.name,o=e.id;return(n?n[0]:this.name?this.name.slice(0,1):o?o[0]:"V").toUpperCase()},handleUserClick:function(t){var e,n=(null==t||null===(e=t.author)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n),o=this.localePath(path),r=this.$router.resolve({path:o});window.open(r.href,"_blank")},onTimeChange:function(t){this.timeValue=t},getRankList:function(){this.getPortfolioStarRankList()},getDateRange:function(){var t=new Date(this.startDate),e=new Date(this.endDate),n=function(t){var e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(e,"/").concat(n)};return"".concat(n(t),"--").concat(n(e))},getPortfolioStarRankList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.localRankList=[],t.localLoading=!0,n={time_type:t.timeValue},e.prev=3,e.next=6,Object(h.rankDetailPortfolioStar)(n);case 6:(o=e.sent)&&o.data&&(t.localRankList=o.data.list||[],t.refreshTime=o.data.refresh_at,t.startDate=o.data.start_at,t.endDate=o.data.end_at,t.getComponentData(),t.dataRange=t.getDateRange());case 8:return e.prev=8,t.localLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})))()},getComponentData:function(){this.$emit("getCurrentComponentData",{rankList:this.localRankList,timeValue:this.timeValue,loading:this.localLoading,refreshTime:this.refreshTime})}},activated:function(){this.hasLoaded||this.getRankList()}},M=(n(4764),Object(_.a)(T,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localLoading,expression:"localLoading"}],staticClass:"rank"},[e("RankTimePeriod",{attrs:{dataRange:t.dataRange}}),t._v(" "),t.localRankList.length>0?e("div",{staticClass:"rank-list rank-list-earnings"},t._l(t.localRankList,(function(o,r){var c,l,d,h,v,f,m,_,y;return e("div",{key:r,class:["rank-item",{top1:0===r,top2:1===r,top3:2===r,"rank-item-large":r<3,"rank-item-normal":r>=3}]},[e("div",{staticClass:"rank-num"},[r<3?e("span",{class:["medal","medal-"+(r+1)]},[0===r?e("span",{staticClass:"medal-1-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),1===r?e("span",{staticClass:"medal-2-text"},[t._v(t._s(r+1))]):t._e(),t._v(" "),2===r?e("span",{staticClass:"medal-3-text"},[t._v(t._s(r+1))]):t._e()]):e("span",{staticClass:"rank-num-text"},[t._v(t._s(r+1))])]),t._v(" "),e("div",{staticClass:"user-avatar",class:{"avatar-border-1":0===r,"avatar-border-2":1===r,"avatar-border-3":2===r,"avatar-large-margin":r<3,"avatar-normal-margin":r>=3},attrs:{"data-group":"ranking_creative_pioneer_module","data-event":"rank_creative_pioneer_click_"+(null==o||null===(c=o.author)||void 0===c?void 0:c.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"avatar-border"},[null!=o&&null!==(l=o.author)&&void 0!==l&&l.head?e("img",{class:{"avatar-large":r<3,"avatar-normal":r>=3},attrs:{src:null==o||null===(d=o.author)||void 0===d?void 0:d.head,alt:"avatar"}}):e("div",{staticClass:"base-text",class:{"base-text-large":r<3,"base-text-normal":r>=3}},[t._v("\n            "+t._s(t.getNameFirst(null==o?void 0:o.author))+"\n          ")])]),t._v(" "),0===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(501)}}):t._e(),t._v(" "),1===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(502)}}):t._e(),t._v(" "),2===r?e("img",{staticClass:"rank-model-icon",attrs:{src:n(503)}}):t._e()]),t._v(" "),e("div",{staticClass:"user-info",attrs:{"data-group":"ranking_creative_pioneer_module","data-event":"rank_creative_pioneer_click_"+(null==o||null===(h=o.author)||void 0===h?void 0:h.id)},on:{click:function(e){return t.handleUserClick(o)}}},[e("div",{staticClass:"user-name"},[t._v("\n          "+t._s((null==o||null===(v=o.author)||void 0===v?void 0:v.name)||(null==o||null===(f=o.author)||void 0===f?void 0:f.id))+"\n          "),(null==o||null===(m=o.badges)||void 0===m?void 0:m.length)>0?[t._l(o.badges.slice(0,6),(function(i,t){return[e("img",{staticClass:"user-badge-icon",attrs:{src:i.uri,alt:""}})]})),t._v(" "),(null==o||null===(_=o.badges)||void 0===_?void 0:_.length)>6?e("span",{staticClass:"badge-ellipsis"},[t._v("...")]):t._e()]:t._e()],2)]),t._v(" "),e("div",{staticClass:"user-score"},[e("span",{staticClass:"score",class:{"score-1":0===r,"score-2":1===r,"score-3":2===r}},[t._v("\n          "+t._s(null==o||null===(y=o.score)||void 0===y?void 0:y.toFixed(t.NUM_DECIMAL))+"\n        ")])])])})),0):t._e(),t._v(" "),0!==t.localRankList.length||t.localLoading?t._e():e("RankNoData")],1)}),[],!1,null,"7e8c8214",null).exports),R=(n(24),{name:"RankBadge",props:{value:{type:[String,Number],default:""},max:{type:Number,default:0}},computed:{showValue:function(){return this.max&&"number"==typeof this.value&&this.value>this.max?"".concat(this.max,"+"):this.value}}}),A=(n(4765),Object(_.a)(R,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rank-badge"},[e("div",{staticClass:"new-tab"},[t._v(t._s(t.showValue))])])}),[],!1,null,"48038b07",null).exports),E="HEROES",B="MODELS",N="EARNINGS",F="CREATIVE_PIONEER",U={components:{RankPostHeroes:O,RankHottestModels:I,RankCreatorEarnings:D,RankTimeFilter:y,TwinkleStars:c.default,RankShiningStar:$,RankCreativePioneer:M,RankBadge:A},data:function(){return{tabVale:0,rankList:[],rankListLoading:!1,refreshTime:"",RANK_CONSTS:{RANK_TYPE_LISTS:[{tabIndex:0,value:E,title_label:"post_heros_title",sort_label:"post_heros_sort_rules",sort_query:{num1:1,num2:.8,num3:.8,num4:.8,num5:.5,num6:.05,num7:.01},component:"RankPostHeroes",getDataFuc:"getHeroesRankList",entityType:"ranking_module",entityName:"RANKING_POST_HEROES_TAB"},{tabIndex:1,value:B,title_label:"hottest_models_title",sort_label:"hottest_models_sort_rules",sort_query:{num1:1,num2:.5,num3:.2},component:"RankHottestModels",getDataFuc:"getModelsRankList",entityType:"ranking_module",entityName:"RANKING_HOT_MODEL_TAB"},{tabIndex:2,value:N,title_label:"creator_earnings_title",sort_label:"creator_earnings_sort_rules",component:"RankCreatorEarnings",getDataFuc:"getEarningsRankList",entityType:"ranking_module",entityName:"RANKING_CREATIVE_INCOME_TAB"},{tabIndex:4,value:F,title_label:"creative_pioneer",sort_label:"creative_pioneer_sort_rules",component:"RankCreativePioneer",getDataFuc:"getCreativePioneerRankList",isNewTab:!0,entityType:"ranking_module",entityName:"RANKING_PORTFOLIO_STAR_TAB"}]}}},computed:{tooltipContent:function(){var t=this,e=this.RANK_CONSTS.RANK_TYPE_LISTS.find((function(e){return e.tabIndex===t.tabVale}));return this.$t(e.sort_label,e.sort_query)},currentRankComponent:function(){var t=this;return this.RANK_CONSTS.RANK_TYPE_LISTS.find((function(e){return e.tabIndex===t.tabVale})).component}},mounted:function(){this.handleTabChange(this.RANK_CONSTS.RANK_TYPE_LISTS[0])},methods:{formatTime:function(t){if(!t)return"";var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),c=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0");return"".concat(n,"-").concat(o,"-").concat(r," ").concat(c,":").concat(l)},handleTabChange:function(t){var e=this;this.tabVale=t.tabIndex,this.$nextTick((function(){e.$refs.currentRankComponent.getRankList()})),this.$xyLogEvent({front_operation:"click",entity_name:t.entityName,entity_type:t.entityType})},getCurrentComponentData:function(t){console.log("val",t),this.refreshTime=this.formatTime(t.refreshTime)},fetchCurrentRankList:function(){}}},H=(n(4766),Object(_.a)(U,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"leaderboard-bg"},[e("div",{staticClass:"leaderboard-header"},[e("div",{staticClass:"header-left"},[e("span",{staticClass:"header-title"},[t._v("🏆 "),e("span",{staticClass:"header-title-text"},[t._v(t._s(t.$t("leaderboard")))])]),t._v(" "),e("span",{staticClass:"header-refresh"},[t._v("\n        "+t._s(t.$t("update_at_time",{time:t.refreshTime}))+" · "+t._s(t.$t("sort_rules"))+"\n        "),e("el-tooltip",{attrs:{content:t.tooltipContent,placement:"bottom"}},[e("i",{staticClass:"iconfont icon-icon-information1"})])],1),t._v(" "),e("div",{staticClass:"header-tabs"},t._l(t.RANK_CONSTS.RANK_TYPE_LISTS,(function(n,o){return e("button",{key:o,staticClass:"tab",class:{active:t.tabVale===n.tabIndex},on:{click:function(e){return t.handleTabChange(n)}}},[t._v("\n          "+t._s(t.$t(n.title_label))+"\n          "),n.isNewTab?e("RankBadge",{attrs:{value:"NEW"}}):t._e()],1)})),0)])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.rankListLoading,expression:"rankListLoading"}],staticClass:"leaderboard-card-shadow"},[e("TwinkleStars",{staticClass:"twinkle-stars"}),t._v(" "),e("div",{staticClass:"leaderboard-card-outer"},[e("div",{staticClass:"light-effect"}),t._v(" "),e("div",{staticClass:"leaderboard-card"},[e(t.currentRankComponent,{ref:"currentRankComponent",tag:"component",on:{getCurrentComponentData:t.getCurrentComponentData}})],1)])],1),t._v(" "),e("div",{staticClass:"rank-mask"})])}),[],!1,null,"0a516cde",null)),V=H.exports;installComponents(H,{TwinkleStars:n(567).default});n(16),n(21),n(50),n(22),n(49),n(26);var z=n(56),W=n(163);function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var K={name:"EventRegistrationModelDialog",data:function(){return{dialogVisible:!1,loading:!1,imgLoading:!1,btnLoading:!1,listParams:{publish_status:1,model_type:"ALL",page:1,page_size:60,type:"user_upload",in_match_page:!0},hasMore:!1,modelListData:[],selectedModels:[],agreeRules:!1,activeTab:"my_model",contestModelListData:[]}},computed:Y(Y({},Object(r.e)("user",["userInfo","cdnHost"])),{},{getModelUrl:function(){return function(t){var e=t.banner,o=e.nsfw,r=e.url;return 1===o?n(217):Object(d.K)(r,"low")}},getParticipatingModelUrl:function(){return function(t){var e=t.uri;return Object(d.K)(e,"low")}},selected:function(){var t=this;return function(e){return t.selectedModels.some((function(t){return t.id===e}))}}}),methods:{showDialog:function(){this.dialogVisible=!0,this.getList(),this.getContestList()},closedDialog:function(){this.dialogVisible=!1,this.loading=!1,this.imgLoading=!1,this.btnLoading=!1,this.listParams={publish_status:1,model_type:"ALL",page:1,page_size:60,type:"user_upload",in_match_page:!0},this.hasMore=!1,this.modelListData=[],this.selectedModels=[],this.agreeRules=!1,this.activeTab="my_model",this.contestModelListData=[]},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,Object(z.s)(this.listParams).then((function(n){var o,r=n.data,c=r.items,l=r.has_more,d=r.time_ms;t.listParams.time_to=d,t.hasMore=l,t.loading=!1,c=c.filter((function(t){return 1===t.status&&2===t.primary&&t.banner.url})),t.modelListData=e?t.modelListData.concat(c||[]):c,(null===(o=t.modelListData)||void 0===o||!o.length)&&(t.imgLoading=!0),t.hasMore&&setTimeout((function(){t.addScrollEvent()}),1500)})).catch((function(e){t.loading=!1,console.log("err",e)}))},getContestList:function(){var t=this;Object(W.f)({account_id:this.userInfo.id,type:2}).then((function(e){var n=e.data.items;t.contestModelListData=n}))},showActivityRules:function(){this.$EventBus.$emit("openActivityRulesDialog")},handleModelItemClick:function(t){var e=this.selectedModels.findIndex((function(e){return e.id===t.id}));if(e>-1)this.selectedModels.splice(e,1);else{if(this.selectedModels.length>=5)return void this.$message.warning(this.$t("Limit5Models"));this.selectedModels.push(t)}},addScrollEvent:function(){var t=document.querySelector(".model-list");t&&(t.removeEventListener("scroll",this.scrollFun),t.addEventListener("scroll",this.scrollFun))},scrollFun:function(){var t=document.querySelector(".model-list");t.scrollHeight-t.scrollTop<=t.clientHeight+250&&!this.loading&&this.hasMore&&(this.listParams.page++,this.getList(!0))},handleConfirm:function(){var t,e,n=this;if(!this.agreeRules||null===(t=this.selectedModels)||void 0===t||!t.length)return null!==(e=this.selectedModels)&&void 0!==e&&e.length?this.agreeRules?void 0:void this.$message.warning(this.$t("PleaseAgreeRules")):void this.$message.warning(this.$t("NullSelectedTips"));this.btnLoading=!0;var o=this.selectedModels.map((function(t){return t.id}));Object(W.b)({type:2,ids:o}).then((function(){n.$message.success(n.$t("RegistrationSuccess")),n.closedDialog()})).catch((function(t){console.log("err",t),n.btnLoading=!1}))}}},J=K,X=(n(4767),Object(_.a)(J,(function(){var t,e,n,o,r=this,c=r._self._c;return c("el-dialog",{staticClass:"event-registration",attrs:{visible:r.dialogVisible,width:"1076px",top:"50px","modal-append-to-body":!1,"close-on-click-modal":!1,"destroy-on-close":!0,"custom-class":"SaDialog"},on:{"update:visible":function(t){r.dialogVisible=t},closed:r.closedDialog}},[c("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[c("span",[r._v("\n      "+r._s(r.$t("EventRegistration"))+"\n    ")]),r._v(" "),c("el-tooltip",{attrs:{content:r.$t("EventRegistrationTip"),placement:"top"}},[c("i",{staticClass:"el-icon-info"})])],1),r._v(" "),c("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading||r.imgLoading,expression:"loading || imgLoading"}],staticClass:"event-registration-container"},[c("div",{staticClass:"top-div"},[c("div",{staticClass:"header"},[c("div",{staticClass:"tabs-container"},[c("div",{staticClass:"tab-item",class:{active:"my_model"===r.activeTab},on:{click:function(t){r.activeTab="my_model"}}},[r._v("\n            "+r._s(r.$t("MyModel"))+"\n          ")]),r._v(" "),c("div",{staticClass:"tab-item",class:{active:"participating_model"===r.activeTab},on:{click:function(t){r.activeTab="participating_model"}}},[r._v("\n            "+r._s(r.$t("participating_model"))+"\n          ")])]),r._v(" "),"my_model"===r.activeTab?c("el-button",{staticClass:"btn",attrs:{loading:r.btnLoading},on:{click:r.handleConfirm}},[r._v("\n          "+r._s(r.$t("Confirm"))+"\n        ")]):r._e()],1),r._v(" "),"my_model"===r.activeTab?c("div",{staticClass:"checkbox-div"},[c("div",{staticClass:"select-num"},[c("span",[r._v(r._s(null===(t=r.selectedModels)||void 0===t?void 0:t.length)+" / 5")])]),r._v(" "),c("div",{staticClass:"agree-rules"},[c("el-checkbox",{model:{value:r.agreeRules,callback:function(t){r.agreeRules=t},expression:"agreeRules"}}),r._v(" "),c("span",[r._v("\n            "+r._s(r.$t("JoinTipsFront"))+"\n          ")]),r._v(" "),c("span",{staticClass:"activity-rules",on:{click:r.showActivityRules}},[r._v("\n            "+r._s(r.$t("ActivityRules"))+"\n          ")])],1)]):r._e()]),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"my_model"===r.activeTab,expression:"activeTab === 'my_model'"}],staticClass:"model-list"},[null!==(e=r.modelListData)&&void 0!==e&&e.length?r._l(r.modelListData,(function(t){return c("div",{key:t.id,staticClass:"model-item",class:{selected:r.selected(t.id)},on:{click:function(e){return r.handleModelItemClick(t)}}},[c("div",{staticClass:"model-item-container"},[c("img",{staticClass:"model-img",attrs:{alt:"model image",src:r.getModelUrl(t)}}),r._v(" "),c("div",{staticClass:"bottom-name"},[c("div",{staticClass:"name",attrs:{title:t.name}},[r._v("\n                "+r._s(t.name)+"\n              ")])])])])})):r._e(),r._v(" "),r.loading||null!==(n=r.modelListData)&&void 0!==n&&n.length?r._e():c("div",{staticClass:"no-picture"},[c("img",{attrs:{src:"https://".concat(r.cdnHost,"/static/upload/20230617/804ae1a7-d655-4a59-a93b-775bfe4ebb5d.png"),alt:"no-picture"},on:{load:function(t){r.imgLoading=!1}}}),r._v(" "),c("div",{staticClass:"tip"},[r._v("\n          "+r._s(r.$t("NoModelPictureTip"))+"\n        ")])])],2),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"participating_model"===r.activeTab,expression:"activeTab === 'participating_model'"}],staticClass:"participating-model-list"},[c("div",{directives:[{name:"show",rawName:"v-show",value:"participating_model"===r.activeTab,expression:"activeTab === 'participating_model'"}],staticClass:"participating-tip"},[c("i",{staticClass:"iconfont icon-mall-desc tip"}),r._v("\n        "+r._s(r.$t("ParticipatingModelTip"))+"\n      ")]),r._v(" "),null!==(o=r.contestModelListData)&&void 0!==o&&o.length?r._l(r.contestModelListData,(function(t){return c("div",{key:t.id,staticClass:"model-item"},[c("div",{staticClass:"model-item-container"},[c("div",{staticClass:"tip",class:2!==t.audit_status?"competing":"not-pass"},[r._v("\n              "+r._s(r.$t(2!==t.audit_status?"Competing":"notApproved"))+"\n            ")]),r._v(" "),c("img",{staticClass:"model-img",attrs:{alt:"model image",src:r.getParticipatingModelUrl(t)}}),r._v(" "),c("div",{staticClass:"bottom-name"},[c("div",{staticClass:"name",attrs:{title:t.model_name}},[r._v("\n                "+r._s(t.model_name)+"\n              ")])])])])})):c("div",{staticClass:"no-picture"},[c("img",{attrs:{src:"https://".concat(r.cdnHost,"/static/upload/20230617/804ae1a7-d655-4a59-a93b-775bfe4ebb5d.png"),alt:"no-picture"},on:{load:function(t){r.imgLoading=!1}}}),r._v(" "),c("div",{staticClass:"tip"},[r._v("\n          "+r._s(r.$t("NoContestModelPictureTip"))+"\n        ")])])],2)])])}),[],!1,null,null,null).exports);function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt={name:"EventRegistrationArtworkDialog",data:function(){return{dialogVisible:!1,loading:!1,imgLoading:!1,btnLoading:!1,listParams:{page:1,page_size:60,type:"bookmarks",order_by:"hot",keyword:"",start_at:0,end_at:0,after:0,artwork_types:[1,3],category:2,in_match_page:!0},hasMore:!1,workListData:[],selectedWorks:[],agreeRules:!1,activeTab:"my_artwork",contestWorklListData:[]}},computed:Z(Z({},Object(r.e)("user",["userInfo","cdnHost"])),{},{getArtworkUrl:function(){return function(t){var e=t.banner,o=e.nsfw,r=e.url;return 1===o?n(217):Object(d.K)(r,"low")}},getParticipatingArtworkUrl:function(){return function(t){var e=t.uri;return Object(d.K)(e,"low")}},selected:function(){var t=this;return function(e){return t.selectedWorks.some((function(t){return t.id===e}))}}}),methods:{showDialog:function(){this.dialogVisible=!0,this.getList(),this.getContestList()},closedDialog:function(){this.dialogVisible=!1,this.loading=!1,this.imgLoading=!1,this.btnLoading=!1,this.listParams={page:1,page_size:60,type:"bookmarks",order_by:"hot",keyword:"",start_at:0,end_at:0,after:0,artwork_types:[1,3],category:2,in_match_page:!0},this.hasMore=!1,this.workListData=[],this.selectedWorks=[],this.agreeRules=!1,this.activeTab="my_artwork",this.contestWorklListData=[]},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,Object(h.artworkList)(this.listParams).then((function(n){var o,r=n.data,c=r.items,l=r.has_more,d=r.time_ms;t.listParams.time_to=d,t.hasMore=l,t.loading=!1,c=c.filter((function(t){return 1===t.status&&2===t.primary&&t.banner.url})),t.workListData=e?t.workListData.concat(c||[]):c,(null===(o=t.workListData)||void 0===o||!o.length)&&(t.imgLoading=!0),t.hasMore&&setTimeout((function(){t.addScrollEvent()}),1500)})).catch((function(e){t.loading=!1,console.log("err",e)}))},getContestList:function(){var t=this;Object(W.f)({account_id:this.userInfo.id,type:1}).then((function(e){var n=e.data.items;t.contestWorklListData=n}))},showActivityRules:function(){this.$EventBus.$emit("openActivityRulesDialog")},handleModelItemClick:function(t){var e=this.selectedWorks.findIndex((function(e){return e.id===t.id}));if(e>-1)this.selectedWorks.splice(e,1);else{if(this.selectedWorks.length>=5)return void this.$message.warning(this.$t("Limit5Models"));this.selectedWorks.push(t)}},addScrollEvent:function(){var t=document.querySelector(".model-list");t&&(t.removeEventListener("scroll",this.scrollFun),t.addEventListener("scroll",this.scrollFun))},scrollFun:function(){var t=document.querySelector(".model-list");t.scrollHeight-t.scrollTop<=t.clientHeight+250&&!this.loading&&this.hasMore&&(this.listParams.page++,this.getList(!0))},handleConfirm:function(){var t,e,n=this;if(!this.agreeRules||null===(t=this.selectedWorks)||void 0===t||!t.length)return null!==(e=this.selectedWorks)&&void 0!==e&&e.length?this.agreeRules?void 0:void this.$message.warning(this.$t("PleaseAgreeRules")):void this.$message.warning(this.$t("NullSelectedTips"));this.btnLoading=!0;var o=this.selectedWorks.map((function(t){return t.id}));Object(W.b)({type:1,ids:o}).then((function(){n.$message.success(n.$t("RegistrationSuccess")),n.closedDialog()})).catch((function(t){console.log("err",t),n.btnLoading=!1}))}}},et=tt,it=(n(4768),Object(_.a)(et,(function(){var t,e,n,o,r=this,c=r._self._c;return c("el-dialog",{staticClass:"event-registration",attrs:{visible:r.dialogVisible,width:"1076px",top:"50px","modal-append-to-body":!1,"close-on-click-modal":!1,"destroy-on-close":!0,"custom-class":"SaDialog"},on:{"update:visible":function(t){r.dialogVisible=t},closed:r.closedDialog}},[c("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[c("span",[r._v("\n      "+r._s(r.$t("EventRegistration"))+"\n    ")]),r._v(" "),c("el-tooltip",{attrs:{content:r.$t("EventRegistrationTip"),placement:"top"}},[c("i",{staticClass:"el-icon-info"})])],1),r._v(" "),c("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading||r.imgLoading,expression:"loading || imgLoading"}],staticClass:"event-registration-container"},[c("div",{staticClass:"top-div"},[c("div",{staticClass:"header"},[c("div",{staticClass:"tabs-container"},[c("div",{staticClass:"tab-item",class:{active:"my_artwork"===r.activeTab},on:{click:function(t){r.activeTab="my_artwork"}}},[r._v("\n            "+r._s(r.$t("MyArtworks"))+"\n          ")]),r._v(" "),c("div",{staticClass:"tab-item",class:{active:"participating_artwork"===r.activeTab},on:{click:function(t){r.activeTab="participating_artwork"}}},[r._v("\n            "+r._s(r.$t("contest_artwork"))+"\n          ")])]),r._v(" "),"my_artwork"===r.activeTab?c("el-button",{staticClass:"btn",attrs:{loading:r.btnLoading},on:{click:r.handleConfirm}},[r._v("\n          "+r._s(r.$t("Confirm"))+"\n        ")]):r._e()],1),r._v(" "),"my_artwork"===r.activeTab?c("div",{staticClass:"checkbox-div"},[c("div",{staticClass:"select-num"},[c("span",[r._v(r._s(null===(t=r.selectedWorks)||void 0===t?void 0:t.length)+" / 5")])]),r._v(" "),c("div",{staticClass:"agree-rules"},[c("el-checkbox",{model:{value:r.agreeRules,callback:function(t){r.agreeRules=t},expression:"agreeRules"}}),r._v(" "),c("span",[r._v("\n            "+r._s(r.$t("JoinTipsFront"))+"\n          ")]),r._v(" "),c("span",{staticClass:"activity-rules",on:{click:r.showActivityRules}},[r._v("\n            "+r._s(r.$t("ActivityRules"))+"\n          ")])],1)]):r._e()]),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"my_artwork"===r.activeTab,expression:"activeTab === 'my_artwork'"}],staticClass:"model-list"},[null!==(e=r.workListData)&&void 0!==e&&e.length?r._l(r.workListData,(function(t){return c("div",{key:t.id,staticClass:"model-item",class:{selected:r.selected(t.id)},on:{click:function(e){return r.handleModelItemClick(t)}}},[c("div",{staticClass:"model-item-container"},[c("img",{staticClass:"model-img",attrs:{alt:"model image",src:r.getArtworkUrl(t)}})])])})):r._e(),r._v(" "),r.loading||null!==(n=r.workListData)&&void 0!==n&&n.length?r._e():c("div",{staticClass:"no-picture"},[c("img",{attrs:{src:"https://".concat(r.cdnHost,"/static/upload/20230617/804ae1a7-d655-4a59-a93b-775bfe4ebb5d.png"),alt:"no-picture"},on:{load:function(t){r.imgLoading=!1}}}),r._v(" "),c("div",{staticClass:"tip"},[r._v("\n          "+r._s(r.$t("NoWorkTip"))+"\n        ")])])],2),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"participating_artwork"===r.activeTab,expression:"activeTab === 'participating_artwork'"}],staticClass:"participating-artwork-list"},[c("div",{staticClass:"participating-tip"},[c("i",{staticClass:"iconfont icon-mall-desc tip"}),r._v("\n        "+r._s(r.$t("ParticipatingArtworkTip"))+"\n      ")]),r._v(" "),null!==(o=r.contestWorklListData)&&void 0!==o&&o.length?r._l(r.contestWorklListData,(function(t){return c("div",{key:t.id,staticClass:"model-item"},[c("div",{staticClass:"model-item-container"},[c("div",{staticClass:"tip",class:2!==t.audit_status?"competing":"not-pass"},[r._v("\n              "+r._s(r.$t(2!==t.audit_status?"Competing":"notApproved"))+"\n            ")]),r._v(" "),c("img",{staticClass:"model-img",attrs:{alt:"model image",src:r.getParticipatingArtworkUrl(t)}})])])})):c("div",{staticClass:"no-picture"},[c("img",{attrs:{src:"https://".concat(r.cdnHost,"/static/upload/20230617/804ae1a7-d655-4a59-a93b-775bfe4ebb5d.png"),alt:"no-picture"},on:{load:function(t){r.imgLoading=!1}}}),r._v(" "),c("div",{staticClass:"tip"},[r._v("\n          "+r._s(r.$t("NoContestModelPictureTip"))+"\n        ")])])],2)])])}),[],!1,null,null,null).exports),nt=n(937),at=n(53);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct={components:{EventRegistrationModelDialog:X,EventRegistrationArtworkDialog:it,ClaimDialog:nt.a,BaseAvatar:at.default},props:{type:{type:String,default:""},needTimeSelection:{type:Boolean,default:!0},needPop:{type:Boolean,default:!0},intList:{type:Array,default:function(){return[]}},isOver:{type:Boolean,default:!1}},data:function(){return{formatNumberForeign:d.p,list:[],formData:{rank_type:"",time_type:"day"},options:[{value:"day",label:this.$t("Daily")},{value:"week",label:this.$t("Weekly")}],loading:!1,modelCreatorIcon:n(1064),inRank:!1}},watch:{intList:{handler:function(t){this.list=t}},list:{handler:function(t){var e=this;if(["mcl_m8","pcl_m8","inul_m8"].includes(this.type)){var n,o="mcl_m8"===this.type?20:10;n=(null==t?void 0:t.length)<=o?t:t.slice(0,o),this.inRank=!!n.find((function(t){return t.id===e.userInfo.id}))}},deep:!0}},created:function(){this.intList&&this.intList.length>0&&(this.list=this.intList)},computed:ot(ot({},Object(r.e)("payment",["paymentInfo"])),Object(r.e)("user",["userInfo"])),methods:{openClaimDialog:function(){this.$refs.claimDialog.showDialog()},setTitle:function(){var t="";switch(this.type){case"ah":t=this.$t("popularityValue");break;case"cre":t=this.$t("creativeList");break;case"mh":t=this.$t("hottestModels");break;case"mc":t=this.$t("ModelCollection");break;case"mcl_m8":t=this.$t("ModelCreatorsList");break;case"pcl_m8":t=this.$t("CreativeWorks");break;case"inul_m8":t=this.$t("PopularStar")}return t},setRankNumColor:function(t){var e="#787d82";switch(t){case 1:e="#FF6600";break;case 2:e="#FAA90E"}return e},goPage:function(t){var e,n,path="/user/"+(null==t||null===(e=t.item_info)||void 0===e?void 0:e.id);"mh"!=this.type&&"mc"!=this.type||(path="/models/detail/"+(null==t||null===(n=t.item_info)||void 0===n?void 0:n.id));window.open(path,"_blank")},getData:function(){var t=this;this.loading||(this.loading=!0,this.list=[],this.formData.rank_type=this.type,Object(h.rankDetail)(this.formData).then((function(e){1e4==e.status.code&&(t.list=e.data||[])})).finally((function(){t.loading=!1})))},handleJoin:function(){switch(this.type){case"mcl_m8":this.$refs.eventRegistrationModelDialog.showDialog();break;case"pcl_m8":this.$refs.eventRegistrationArtworkDialog.showDialog();break;case"inul_m8":window.open("/incentiveTask")}},toMall:function(){this.isCompanyAccount||(this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:location.href}),this.$router.push(this.localePath("/mall")))},goPlan:function(){this.$router.push(this.localePath("/creationCenter"))}}},lt=(n(4770),n(4771),Object(_.a)(ct,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rankDelsList",class:{"no-pop":!t.needPop}},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.setTitle()))]),t._v(" "),t.needTimeSelection?e("el-select",{attrs:{"popper-class":"custom-select"},on:{change:t.getData},model:{value:t.formData.time_type,callback:function(e){t.$set(t.formData,"time_type",e)},expression:"formData.time_type"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1):[t.isOver?e("div",[t.inRank?e("div",{staticClass:"aceept",on:{click:t.openClaimDialog}},[t._v("\n          "+t._s(t.$t("Claim"))+"\n          "),e("i",{staticClass:"el-icon-d-arrow-right"})]):e("div",{staticClass:"end"},[t._v("\n          "+t._s(t.$t("EndedOver"))+"\n        ")])]):e("div",{staticClass:"join",on:{click:t.handleJoin}},[t._v("\n        "+t._s(t.$t("JoinNow"))+"\n        "),e("i",{staticClass:"el-icon-d-arrow-right"})])]],2),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list"},t._l(t.list,(function(o,r){var c,l,d,h,v,f,m,_,y;return e("div",{key:r,staticClass:"item",on:{click:function(e){return t.goPage(o)}}},[e("div",{staticClass:"left"},[e("div",{staticClass:"info"},[e("div",{staticClass:"rankNum"},[0==r?e("img",{attrs:{src:n(1477),alt:""}}):e("span",{style:{color:t.setRankNumColor(r)}},[t._v(t._s(r>8?r+1:"0"+(r+1)))])]),t._v(" "),"mh"==t.type||"mc"==t.type?e("div",{staticClass:"imgs imgsModel",class:1===(null==o||null===(c=o.item_info)||void 0===c?void 0:c.nsfw)?"bg-nsfw":"",style:{width:0==r?"105px":null,height:0==r?"105px":null}},[null!=o&&null!==(l=o.item_info)&&void 0!==l&&null!==(l=l.banner)&&void 0!==l&&l.url&&2===(null==o||null===(d=o.item_info)||void 0===d||null===(d=d.banner)||void 0===d?void 0:d.nsfw)?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null==o||null===(h=o.item_info)||void 0===h||null===(h=h.banner)||void 0===h?void 0:h.url,alt:""}}):t._e()]):e("div",{staticClass:"imgs",style:{width:0==r?"70px":null,height:0==r?"70px":null}},[e("BaseAvatar",{attrs:{userData:null==o?void 0:o.item_info,size:0===r?70:36}})],1),t._v(" "),e("div",{staticClass:"txt"},[e("div",{staticClass:"name"},[e("div",{staticClass:"name-text"},[t._v(t._s(null==o||null===(v=o.item_info)||void 0===v?void 0:v.name))]),t._v(" "),null!=o&&null!==(f=o.item_info)&&void 0!==f&&f.is_active?e("div",{staticClass:"vip-icon",on:{click:t.toMall}},[e("img",{attrs:{src:n(136),alt:"vip-icon"}})]):t._e(),t._v(" "),null!=o&&null!==(m=o.item_info)&&void 0!==m&&m.join_stimulate?e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:t.$t("CreationCenterName"),placement:"top-start"}},[e("img",{staticClass:"creator-badge",attrs:{src:n(1041),alt:"badge-icon"},on:{click:t.goPlan}})]):t._e(),t._v(" "),!["mh","mc"].includes(t.type)&&null!=o&&null!==(_=o.item_info)&&void 0!==_&&_.is_model_creator?e("div",{staticClass:"text-content-main-image"},[e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:t.$t("ModelCreator"),placement:"top-start"}},[e("img",{attrs:{src:t.modelCreatorIcon,alt:t.$t("ModelCreator")}})])],1):t._e()],1),t._v(" "),"mcl_m8"==t.type?e("div",{staticClass:"create-and-collect"},[e("div",{staticClass:"create"},[e("i",{staticClass:"iconfont icon-play"}),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(null==o?void 0:o.num_of_cre))])]),t._v(" "),e("div",{staticClass:"collect"},[e("i",{staticClass:"iconfont icon-collect"}),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(null==o?void 0:o.num_of_coll))])])]):t._e(),t._v(" "),["ah","cre","pcl_m8","inul_m8"].includes(t.type)?e("div",{staticClass:"followers"},[t._v("\n              "+t._s(t.formatNumberForeign(null==o||null===(y=o.item_info)||void 0===y?void 0:y.follower_cnt))+" "+t._s(t.$t("Follower"))+"\n            ")]):t._e()])]),t._v(" "),e("div",{staticClass:"quan"},["ah"==t.type||"mh"==t.type||"mcl_m8"==t.type?e("i",{staticClass:"iconfont icon-hot",staticStyle:{color:"#ef4444"}}):t._e(),t._v(" "),"cre"==t.type?e("i",{staticClass:"iconfont icon-play"}):t._e(),t._v(" "),"mc"==t.type?e("i",{staticClass:"iconfont icon-collect"}):t._e(),t._v(" "),"pcl_m8"==t.type?e("i",{staticClass:"iconfont icon-like"}):t._e(),t._v(" "),"inul_m8"==t.type?e("i",{staticClass:"iconfont icon-ranks-user ranks-user"}):t._e(),t._v(" "),e("span",[t._v(t._s(t.formatNumberForeign(o.score)))])])]),t._v(" "),t.needPop?e("div",{staticClass:"pop"},[e("div",{staticClass:"popNum"},[e("span",[t._v(t._s(0!=o.trend?Math.abs(o.trend):"-"))]),t._v(" "),0!=o.trend?e("svg-icon",{attrs:{"icon-class":o.trend>0?"rank-up":"rank-down"}}):t._e()],1),t._v(" "),e("div",{staticClass:"popTxt"},[t._v(t._s(t.$t("Popularity")))])]):t._e()])})),0),t._v(" "),e("event-registration-model-dialog",{ref:"eventRegistrationModelDialog"}),t._v(" "),e("event-registration-artwork-dialog",{ref:"eventRegistrationArtworkDialog"}),t._v(" "),e("claim-dialog",{ref:"claimDialog",attrs:{type:t.type}})],1)}),[],!1,null,"e3367550",null)),ut=lt.exports;installComponents(lt,{BaseAvatar:n(53).default,SvgIcon:n(115).default});var ht={name:"ActivityRulesDialog",data:function(){return{dialogVisible:!1,language:""}},created:function(){var t=this;this.$EventBus.$on("openActivityRulesDialog",(function(){t.showDialog()}))},mounted:function(){this.language=this.$i18n.locale||"en";this.language=["zhCN","en"].includes(this.language)?this.language:"en"},beforeDestroy:function(){this.$EventBus.$off("openActivityRulesDialog")},methods:{showDialog:function(){this.dialogVisible=!0}}},vt=(n(4772),Object(_.a)(ht,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"activity-rules",attrs:{title:t.$t("ResultAnnouncement"),visible:t.dialogVisible,width:"1076px",top:"50px","modal-append-to-body":!0,"close-on-click-modal":!1,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.language&&"zhCN"===t.language?e("pre",{staticClass:"zh-CN"},[t._v("亲爱的SeaArt AI创作者们：\n绘游未来-游戏主题创作活动已经圆满结束，在过去的几周里，我们看到了各位参赛者的无限创意与热情，经过激烈角逐，各个榜单的获胜者已火热出炉！让我们看看本\n次大赛又有哪些优秀的创作者脱颖而出呢？\n\n模型大咖奖\n第一名：\n5000元现金奖励+VIP季卡\n@Cecily cc\n\n第二名~第三名：\n2000元现金奖励+VIP月卡\n@Dương Nguyễn @zail \n\n第四名~第十名：\n500元现金奖励+VIP月卡\n@演绎 @MngYou @阿尔法狗 @mulidi @溜zi @烟火 @Xi  \n\n第十一名~第二十名：\n200元现金奖励+VIP月卡\n@ColeR @花剌子模信使 @toynya @岳说 @xiaolxl @KK official @懿展 @zaqws001 @wslmbb @L大风起兮傻飞扬 \n\n第二十一名~第三十名：\nVIP月卡\n@Mia @阿童木的小蝴蝶 @根叔在画了 @NekoCat @wuhabai @圣诞又至 @凤冠霞帔-新娘 @QX8W6X大风起兮 @月月AI \n\n创意之星奖：\n第一名：\n800元现金奖励+VIP季卡\n@懿展\n\n第二名~第三名：\n500元现金奖励+VIP月卡\n@wslmbb @Spatika\n\n第四名~第十名：\n100元现金奖励+VIP月卡\n@hougege @Dương Nguyễn @呆宝 @烟火 @阿尔法狗 @Xi  @溜zi   \n\n第十一名~第三十名：\nVIP月卡\n@Emotta @mkbk @岳说 @zail @MngYou @Rocket @兴趣使然的光头 @DOGLike @兔塔狸天王 @阿童木的小蝴蝶 @MOCKU @圣诞又至 @SuperAnna @NekoCat\n@Cecily cc @zaqws001 @花剌子模信使   @Partner Stroi @久境 heben @W8XV2J \n\n宣传大使奖：\n第一名：\n800元现金奖励+VIP季卡\n@Y.\n\n第二名~第三名：\n500元现金奖励+VIP月卡\n@Ty @Saidigen22 \n\n第四名~第十名：\n100元现金奖励+VIP月卡\n@苏博号 @Spatika @kepun lala @BackdoorBarry @B-1732 @riri @小逸檬\n \n\n第十一名~第三十名：\nVIP月卡\n@Canal Porq-On @LST @狗头人 @Pham Haru @mame @AI Protagonist @Mustafa Faisal @炸鸡 @popopon @AIporuru @R3PN0U @chrisbrigido\n@Paul567 2nd @Ryosan43 @拇指的帽子 @QNKIR8 @ZA NE @Coelllho @luanping liu  @yu18 \n\n奖励发放\n现金奖励：请在活动参与页面的网页内提交获奖认领信息，提交成功后工作人员将在公示期结束后与您取得联系\nVIP及算力奖励：提交获奖认领信息后，将在公示期结束后统一为您进行发放\n\n*详细获奖名单与排名情况见活动页内【绘游未来排名】，公示期为9月5日~9月11日，如有任何疑问或举报，请联系社区管理员，经核实后我们将会把作弊的参与者数据\n 清零\n*公示发布后请于7日内前往活动页完成收集，逾期视为自动放弃。（作弊导致数据清零的参与者不予发放奖励，排名向后顺延）\n\n感谢大家对SeaArt AI的支持和陪伴，绘游未来活动虽已经结束，但SeaArt AI社区的创作热情会持续燃烧，我们也期待能够看到更多的精彩创意作品~\n未来我们还会推出更多有意思的活动与更加丰厚的福利，请及时关注我们的社区以免错过重要情报哦！\n        ")]):t._e(),t._v(" "),t.language&&"en"===t.language?e("pre",{staticClass:"en"},[t._v('No Paint, No Game - Game Theme Design Contest Winners Announcement\n\nDear SeaArt creators,\nOur "No Paint, No Game - Game Theme Design Contest" has successfully concluded. Over the past few weeks, we have witnessed the participants\'\ncreativity and passion. After a fierce competition, the winners of each category have been determined! Let\'s see which excellent creators stood out in this\ncontest.\n\nModel Master Awards\n1st Place:\n$689.99 Cash + 90-Day VIP Card\n@Cecily cc\n\n2nd-3rd Place:\n$289.99 Cash + 30-Day VIP Card\n@Dương Nguyễn @zail \n\n4th-10th Place:\n$69.99 Cash + 30-Day VIP Card\n@演绎 @MngYou @阿尔法狗 @mulidi @溜zi @烟火 @Xi  \n\n11th-20th Place:\n$29.99 Cash + 30-Day VIP Card\n@ColeR @花剌子模信使 @toynya @岳说 @xiaolxl @KK official @懿展 @zaqws001 @wslmbb @L大风起兮傻飞扬 \n\n21st-30th Place:\n30-Day VIP Card\n@Mia @阿童木的小蝴蝶 @根叔在画了 @NekoCat @wuhabai @圣诞又至 @凤冠霞帔-新娘 @QX8W6X大风起兮 @月月AI \n\nCreative Star Awards:\n1st Place:\n$109.99 Cash + 90-Day VIP Card\n@懿展\n\n2nd-3rd Place:\n$69.99 Cash + 30-Day VIP Card\n@wslmbb @Spatika \n\n4th-10th Place:\n$14.99 Cash + 30-Day VIP Card\n@hougege @Dương Nguyễn @呆宝 @烟火 @阿尔法狗 @Xi  @溜zi   \n\n11th-30th Place:\n30-Day VIP Card\n@Emotta @mkbk @岳说 @zail @MngYou @Rocket @兴趣使然的光头 @DOGLike @兔塔狸天王 @阿童木的小蝴蝶 @MOCKU @圣诞又至 @SuperAnna @NekoCat\n@Cecily cc @zaqws001 @花剌子模信使   @Partner Stroi @久境 heben @W8XV2J \n\nStar Ambassador Awards:\n1st Place:\n$109.99 Cash + 90-Day VIP Card\n@Y.\n\n2nd-3rd Place:\n$69.99 Cash + 30-Day VIP Card\n@Ty @Saidigen22 \n\n4th-10th Place:\n$14.99 Cash + 30-Day VIP Card\n@苏博号 @Spatika @kepun lala @BackdoorBarry @B-1732 @riri @小逸檬\n\n11th-30th Place:\n30-Day VIP Card\n @Canal Porq-On @LST @狗头人 @Pham Haru @mame @AI Protagonist @Mustafa Faisal @炸鸡 @popopon @AIporuru @R3PN0U @chrisbrigido\n @Paul567 2nd @Ryosan43 @拇指的帽子 @QNKIR8 @ZA NE @Coelllho @luanping liu  @yu18 \n\nReward Distribution\nCash Rewards: Please submit the Award Claim Info on the event page. After the successful submission, we will contact you once the publicity period ends.\nVIP Card and Credit Rewards: Please submit the Award Claim Info on the event page. After the successful submission, the rewards will be distributed once\nthe publicity period ends.\n\n* Please check the [No Paint, No Game Rankings] on the event page for the complete winner list and rankings. The publicity period is from Sep 5th to\n  Sep 11th. If you have any questions or need to report any violations, please contact our community administrator. After verification, we will reset the data of\n  any participants who have cheated.\n* Please submit the Award Claim Info on the event page within 7 days after this announcement is posted. Missing the deadline will result in automatic\n  forfeiture of the rewards. Participants whose data is reset due to cheating will not be eligible for rewards, and other participants\' rankings may be adjusted\n  accordingly.\n\nThank you for supporting and being with us on SeaArt.AI. Our "No Paint, No Game" event may have ended, but the passion will continue burning in the\nSeaArt community, and we are looking forward to more wonderful creative works!\n\nPlease follow our community and stay tuned for more exciting events and rewards!\n        ')]):t._e()])}),[],!1,null,null,null).exports),pt={name:"ActivityRank",components:{WaterFall:n(201).default},data:function(){return{list:[],queryParam:{page:1,page_size:60,order_by:"hot",model_type:"",type:"activity"},inReq:!1,hasMore:!0,activeTab:"contest_model",renderBtns:[{name:this.$t("Hot"),value:"hot",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("New"),value:"new",color:"#8E9CB1",activeColor:"#e9b942"}],activeButton:"hot"}},mounted:function(){this.getList()},methods:{resetData:function(){this.inReq=!1,this.hasMore=!0,this.list=[],this.queryParam.page=1,this.queryParam.page_size=60,delete this.queryParam.time_to},getList:function(){var t=this;if(!this.inReq&&this.hasMore){var e;switch(this.inReq=!0,this.activeTab){case"contest_model":default:this.queryParam.model_type="",e=z.s;break;case"contest_artwork":delete this.queryParam.model_type,e=h.artworkList}e(this.queryParam).then((function(e){var n=e.data,o=n.has_more,r=n.items,c=n.time_ms;1e4===e.status.code&&(t.hasMore=o,t.list=t.list.concat(r),t.inReq=!1,t.queryParam.time_to=c,t.queryParam.page++)})).catch((function(e){t.inReq=!1,console.log("err",e)}))}},handleTabChange:function(t){this.activeTab=t,this.resetData(),this.getList()},handleTagChange:function(button){this.activeButton=button.value,this.resetData(),this.queryParam.order_by=button.value,this.getList()}}},ft=(n(4776),Object(_.a)(pt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"activity-rank"},[e("div",{staticClass:"tabs-container"},[e("div",{staticClass:"tab-item",class:{active:"contest_model"===t.activeTab},on:{click:function(e){return t.handleTabChange("contest_model")}}},[t._v("\n      "+t._s(t.$t("contest_model"))+"\n    ")]),t._v(" "),e("div",{staticClass:"tab-item",class:{active:"contest_artwork"===t.activeTab},on:{click:function(e){return t.handleTabChange("contest_artwork")}}},[t._v("\n      "+t._s(t.$t("contest_artwork"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"tags-container"},t._l(t.renderBtns,(function(button){return e("button",{key:button.value,staticClass:"filter-button",class:{active:t.activeButton===button.value},on:{click:function(e){return t.handleTagChange(button)}}},[e("i",{staticClass:"iconfont filter-button-icon",class:"icon-".concat(button.value),style:{color:t.activeButton===button.value?button.activeColor:button.color}}),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(button.name))])])})),0),t._v(" "),e("div",{ref:"wraper",staticClass:"rank"},[e("WaterFall",{ref:"WaterFallVue",attrs:{type:"activity",cols:7,container:"wraper",list:t.list,lazy:!0,gap:16},on:{load:t.getList}})],1)])}),[],!1,null,null,null)),mt=ft.exports;installComponents(ft,{WaterFall:n(201).default});var gt={components:{rankDelsList:ut,ActivityRulesDialog:vt,ActivityRank:mt},data:function(){return{tabList:[{name:this.$t("creatorsRank"),value:"play"},{name:this.$t("modelRank"),value:"model"}],tabVale:"play",dataAll:{}}},created:function(){var t;switch(null===(t=this.$route.query)||void 0===t?void 0:t.type){case"1":case"2":default:this.tabVale="play";break;case"3":case"4":this.tabVale="model"}},mounted:function(){var t;"true"==((null===(t=this.$route.query)||void 0===t?void 0:t.openActivity)||!1)&&this.openActivityRulesDialog(),this.getDataAll()},computed:{getRankTitle:function(){return location.href.includes("haiyiai.com")?"SeaArt AI":"SeaArt.AI"}},methods:{getDataAll:function(){var t=this;Object(h.rankDetailAll)().then((function(e){1e4==e.status.code&&(t.dataAll=e.data)})).finally((function(){}))},openActivityRulesDialog:function(){this.$refs.activityRulesDialog.showDialog()}},head:function(){var title=this.$t("ranking_tag_title"),desc=this.$t("ranking_tag_desc");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}}};n(4777);function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var yt={name:"RankDetailAll",components:{RankNewDetail:V,RankDetail:Object(_.a)(gt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rankDetail"},[e("div",{staticClass:"bg"},["activity"==t.tabVale?e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]):t._e(),t._v(" "),e("div",{staticClass:"cnt"},[e("div",{staticClass:"tabsBox"},[e("div",{staticClass:"tabs"},t._l(t.tabList,(function(n,o){return e("div",{key:o,staticClass:"tabItem",class:{tabItemActivate:t.tabVale==n.value},on:{click:function(e){t.tabVale=n.value}}},[t._v("\n            "+t._s(n.name)+"\n          ")])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"play"==t.tabVale,expression:"tabVale == 'play'"}],staticClass:"ranks"},[e("rankDelsList",{attrs:{type:"ah",intList:t.dataAll.ah}}),t._v(" "),e("rankDelsList",{attrs:{type:"cre",intList:t.dataAll.cre}})],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"model"==t.tabVale,expression:"tabVale == 'model'"}],staticClass:"ranks"},[e("rankDelsList",{attrs:{type:"mh",intList:t.dataAll.mh}}),t._v(" "),e("rankDelsList",{attrs:{type:"mc",intList:t.dataAll.mc}})],1),t._v(" "),"activity"==t.tabVale?e("div",{staticClass:"ranks activity"},[e("div",{staticClass:"activityRules",on:{click:t.openActivityRulesDialog}},[e("span",{staticClass:"words"},[t._v(t._s(t.$t("ResultAnnouncement")))]),t._v(" "),e("i",{staticClass:"iconfont icon-tagTips"})]),t._v(" "),e("div",{staticClass:"rankContainer"},[e("rankDelsList",{attrs:{type:"mcl_m8",intList:t.dataAll.mcl_m8,isOver:t.dataAll.is_over,needTimeSelection:!1,needPop:!1}}),t._v(" "),e("rankDelsList",{attrs:{type:"pcl_m8",intList:t.dataAll.pcl_m8,isOver:t.dataAll.is_over,needTimeSelection:!1,needPop:!1}}),t._v(" "),e("rankDelsList",{attrs:{type:"inul_m8",intList:t.dataAll.inul_m8,isOver:t.dataAll.is_over,needTimeSelection:!1,needPop:!1}})],1),t._v(" "),e("activity-rank")],1):t._e()])],1),t._v(" "),e("activity-rules-dialog",{ref:"activityRulesDialog"})],1)}),[],!1,null,"86075436",null).exports},computed:bt(bt({},Object(r.e)("app",["ABInfo"])),{},{showRankDetail:function(){var t;return"A"===(null===(t=this.ABInfo)||void 0===t?void 0:t.leaderboard_rank_traffic_control)||!1}}),mounted:function(){}},wt=Object(_.a)(yt,(function(){var t=this._self._c;return t("div",[this.showRankDetail?t("RankDetail"):t("RankNewDetail")],1)}),[],!1,null,"9fdac98e",null);e.default=wt.exports},5725:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(2),r=(n(19),n(16),n(22),n(8),n(4),n(26),n(1)),c=n(58),l=n(10),d=n(1122),h=n(3),v=(n(20),n(65),n(21),n(367)),f=n(14),m=(n(32),n(484),n(485),n(177),n(40),n(41),n(297)),_=n(87);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"UpOrDownDialog",props:{language:{type:String,default:"en"},nowPlan:{type:String,default:""},SubscriptionType:{type:String,default:""},paymentData:{type:Object,default:function(){}}},components:{PaymentFormDialog:v.default},data:function(){return{isShowDialog:!1,type:"upgrade",effectiveMode:"",priceObj:{amount:0,balance:0,newPrice:0,unit:""},confirmBtnLoading:!1,paymentDlgUpgrade:!1}},computed:w(w({},Object(r.e)("payment",["paymentInfo","activeSvipInfo","subThirdType"])),{},{getStyle:function(){return{height:this.isNowEffective?"72px":"44px"}},getTime:function(){var t,e=(new Date).getTime();return this.isNowEffective?Object(c.i)(e,"yyyy.MM.dd"):Object(c.i)(null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime,"yyyy.MM.dd")},getOriginPrice:function(){if(this.isNowEffective)return this.priceObj.balance;var t,data=this.activeSvipInfo,e=(null==data||null===(t=data.local_price_web)||void 0===t?void 0:t.price)||0;return this.isYearly?(12*e).toFixed(2):e.toFixed(2)},getNowPrice:function(){if(this.isNowEffective)return this.priceObj.newPrice;var t,e=(null===(t=this.paymentData)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.price)||0;return this.isYearly?(12*e).toFixed(2):e.toFixed(2)},getAmount:function(){if(this.isNowEffective)return this.priceObj.amount;var t,e=(null===(t=this.paymentData)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.price)||0;return this.isYearly?(12*e).toFixed(2):e.toFixed(2)},getUnit:function(){var t;return(null===(t=this.priceObj)||void 0===t?void 0:t.unit)||"$"},isSubscription:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)},isNowEffective:function(){return"now"===this.effectiveMode},isUpgrade:function(){return"upgrade"===this.type},isShowNext:function(){return!this.isUpgrade||this.isSubscription},isYearly:function(){return"yearly"===this.SubscriptionType},originPlay:function(){var t;return["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)-1]}}),methods:w(w(w({},Object(r.b)("payment",["getSubUrlAndThirdType","setAdyenFailed"])),Object(r.b)("unsubscribe",["getUserStatus"])),{},{showDialog:function(t){this.isShowDialog=!0,this.type=t,this.effectiveMode=this.isUpgrade?"now":"next",this.isUpgrade&&this.getPrices(),this.subThirdType||this.getSubUrlAndThirdType()},getPrices:function(){var t=this;Object(_.k)({is_cn:"zhCN"===this.language,product_id:this.paymentData.id,type:this.isSubscription?"sub":"base"}).then((function(e){var n=e.data,o=n.balance_local,r=n.new_price_local,c=n.price_local,l=n.currency;t.priceObj.balance=o,t.priceObj.newPrice=r,t.priceObj.amount=c,t.priceObj.unit=l}))},handleConfirm:function(){var t=this;if(console.log("this.subThirdType",this.subThirdType),this.isSubscription){if(8==this.subThirdType)return void this.$message.warning(this.$t("bandStripe"));this.confirmBtnLoading=!0,Object(_.q)({change_type:"now"===this.effectiveMode?1:2,cp_product_id:this.paymentData.id,third_plat_type:this.subThirdType}).then((function(e){var n=e.data,o=n.PaymentUrl;n.ThirdOrderId;12!==t.subThirdType&&o?window.open(o):(t.$message.success(t.$t("OperateSuccess")),t.isShowDialog=!1,"now"===t.effectiveMode&&setTimeout((function(){location.reload()}),3e3))})).catch((function(e){if(console.log("res",e),80213===(null==e?void 0:e.code)){t.setAdyenFailed(),t.paymentDlgUpgrade=!0;var n=setTimeout((function(){t.$refs.paymentFormDialog.showPaymentFormDialog(t.paymentData),clearTimeout(n)}),1e3)}})).finally((function(){t.confirmBtnLoading=!1}))}else this.$refs.paymentFormDialog.showPaymentFormDialog(this.paymentData)},paymentSuccess:function(){this.isShowDialog=!1,this.getUserStatus()}})},k=(n(5003),n(0)),O=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"up-or-down-dialog custom-dialog",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("div",{staticClass:"container"},[e("i",{staticClass:"el-icon-close close-icon",on:{click:function(e){t.isShowDialog=!1}}}),t._v(" "),e("div",{staticClass:"title"},[t._v("\n        "+t._s(t.$t(t.isUpgrade?"UpgradePlan":"DowngradePlan"))+"\n      ")]),t._v(" "),e("div",{staticClass:"desc"},[e("div",{staticClass:"select-time"},[t._v(t._s(t.$t("SelectTimeRange")))]),t._v(" "),e("div",{staticClass:"tip"},[t._v(t._s(t.$t("SelectTimeRangeTip")))])]),t._v(" "),e("div",{staticClass:"select-area"},[t.isUpgrade?e("div",{staticClass:"right-now",on:{click:function(e){t.effectiveMode="now"}}},[t._v("\n          "+t._s(t.$t("RightNowEffective"))+"\n          "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isNowEffective,expression:"isNowEffective"}],staticClass:"icon el-icon-check"})]):t._e()]),t._v(" "),e("div",{staticClass:"detail"},[e("div",{staticClass:"origin-plan",style:t.getStyle},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word"},[t._v(t._s(t.$t("taskRankFrom")))]),t._v(" "),e("span",{staticClass:"plan"},[t._v(t._s(t.$t(t.originPlay)))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isNowEffective,expression:"isNowEffective"}],staticClass:"line-two"},[t._v("\n              "+t._s(t.$t("NotUseDays"))+"\n            ")])]),t._v(" "),e("div",{staticClass:"right"},[t._v(t._s(t.getUnit)+t._s(t.getOriginPrice))])]),t._v(" "),e("div",{staticClass:"now-plan",style:t.getStyle},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word"},[t._v(t._s(t.$t("SubscribeTo")))]),t._v(" "),e("span",{staticClass:"plan"},[t._v(t._s(t.$t(t.nowPlan)))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isNowEffective,expression:"isNowEffective"}],staticClass:"line-two"},[t._v("\n              "+t._s(t.$t("PlanPrice"))+"\n            ")])]),t._v(" "),e("div",{staticClass:"right"},[t._v(t._s(t.getUnit)+t._s(t.getNowPrice))])])]),t._v(" "),e("div",{staticClass:"payment-info"},[e("div",{staticClass:"amount"},[t._v(t._s(t.$t("DealWith"))+": "+t._s(t.getUnit)+t._s(t.getAmount))]),t._v(" "),e("div",{staticClass:"time"},[t._v(t._s(t.getTime))])]),t._v(" "),e("div",{staticClass:"bottom"},[e("el-button",{staticClass:"cancel",on:{click:function(e){t.isShowDialog=!1}}},[t._v("\n          "+t._s(t.$t("Cancel"))+"\n        ")]),t._v(" "),e("el-button",{staticClass:"confirm",attrs:{loading:t.confirmBtnLoading},on:{click:t.handleConfirm}},[t._v(t._s(t.$t("Confirm")))])],1),t._v(" "),e("PaymentFormDialog",{ref:"paymentFormDialog",attrs:{initMount:!0,upgrade:t.paymentDlgUpgrade,isSubscription:!1},on:{"pay-success":t.paymentSuccess}})],1)])}),[],!1,null,null,null).exports,x=n(385);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={primary:1,standard:2,professional:3,master:4},L={name:"SubscriptionItem",inject:["top"],props:{content:{type:Object,default:function(){}},SubscriptionType:{type:String,default:""},paymentData:{type:Object,default:function(){}},language:{type:String,default:"en"}},components:{HelpTip:m.default,UpOrDownDialog:O,PaymentFormDialog:v.default,VideoExplainPopover:x.a},data:function(){return{btnLoading:!1,useFree:!1,executedSubType:!0}},computed:S(S(S(S(S({},Object(r.e)("payment",["paymentInfo","subThirdType","subscriptionUrl","halfDiscountCountdown"])),Object(r.c)("unsubscribe",["userCancelStatus","prevPlanId","userFreeTryStatus","userPauseStatus","unsubTime"])),Object(r.c)("user",["isLoggedIn"])),Object(r.e)("user",["cdnHost"])),{},{inSale:function(){var t;return null===(t=this.paymentData)||void 0===t?void 0:t.discount},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},isFreeTry:function(){var t;return null===(t=this.paymentData)||void 0===t?void 0:t.with_trial},getLanguage:function(){return{"zh-CN":"zhCN"===this.language,en:"en"===this.language}},isMonthly:function(){return"month"===this.SubscriptionType},isYearly:function(){return"year"===this.SubscriptionType},isWeek:function(){return"week"===this.SubscriptionType},isSubscription:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)},getOriginalAmount:function(){var t,e=null===(t=this.paymentData)||void 0===t?void 0:t.local_price_web;if(e){var n=null==e?void 0:e.currency,o=null==e?void 0:e.price_old;return"".concat(n).concat(o)}return""},getPriceTips:function(){return this.content.isFree?this.$t("newShopTips14"):this.isWeek?this.$t("SubscriptionWeeklyTip"):this.isYearly?this.$t("SubscriptionYearlyTip"):this.$t("SubscriptionMonthlyTip")},getNowAmount:function(){var t,e=null===(t=this.paymentData)||void 0===t?void 0:t.local_price_web;if(e){var n=null==e?void 0:e.currency,o=null==e?void 0:e.price;return"".concat(n).concat(o)}return""},getStamina:function(){var t=this.isWeek?7:30,e=this.paymentData.every_day_temp_coins*t;return"".concat(e," ").concat(this.$t("tempCoins"))},getStaminaDay:function(){return"(".concat(this.paymentData.every_day_temp_coins," ").concat(this.$t("newShopTips15"),")")},getSubscriptionBtnDisabled:function(){var t=this.paymentInfo,e=t.payRange,n=t.productLevel;return!(!t.svipActiveState||this.inCancelSub)&&(!(3!==e||!this.isMonthly&&!this.isWeek)||(!(2!==e||!this.isWeek)||D[this.content.value]<n))},getBtnName:function(){var t;return 2!==this.userFreeTryStatus&&!this.userPauseStatus||(null===(t=this.paymentData)||void 0===t?void 0:t.id)!==this.prevPlanId?this.inCancelSub?this.$t("SubscribeNow"):this.isRenewal?this.$t("Renewal"):this.isUpgradePlan?this.$t("UpgradePlan"):this.$t("SubscribeNow"):this.$t("PlanRecoveryNow")},isRenewal:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.productLevel;return e&&this.getMatch&&D[this.content.value]===n},isUpgradePlan:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.productLevel,o=t.payRange;if(!e)return!1;var r=D[this.content.value];return 4===o&&this.isWeek||2===o&&this.isMonthly||3===o&&this.isYearly?r>n:4===o?(this.isMonthly||this.isYearly)&&r>=n:2===o&&(this.isYearly&&r>=n)},getMatch:function(){var t=this.paymentInfo.payRange,e=void 0===t?0:t,n=4===e&&this.isWeek,o=2===e&&this.isMonthly,r=3===e&&this.isYearly;return n||o||r},txtWithHtml:function(){var t=this;return function(e){return e.param?t.$t(e.i18nKey,{param:e.param}):t.$t(e.i18nKey)}},itemName:function(){var t;return{1:"beginner",2:"standard",3:"professional",4:"master"}[null===(t=this.paymentData)||void 0===t?void 0:t.level]||""},inCancelSub:function(){var t,e;return this.unsubTime&&((null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState))}}),methods:S(S({},Object(r.b)("payment",["setSubscriptionUrl","setSubThirdType","getSubUrlAndThirdType"])),{},{handleSwitch:function(){this.$emit("changeMethods",this.isYearly?"monthly":"yearly")},handlePurchase:function(){var t=this;return Object(h.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=3;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 3:if(n={operation:"svip_card_page",behavior_info:"".concat({primary:"starter",standard:"standard",professional:"profession",master:"master"}[t.content.value],"_button"),behavior_info_sub:""},t.subThirdType){e.next=8;break}return e.next=8,t.getSubUrlAndThirdType();case 8:t.inCancelSub?t.openSubscrptionPayment():t.isRenewal?(n.behavior_info_sub="click_subscribe_button",t.handleMangeSubs()):t.isUpgradePlan?(n.behavior_info_sub="click_up_button",t.$refs.upOrDownDialog.showDialog("upgrade")):t.openSubscrptionPayment(),n.behavior_info_sub&&t.$logEvent("log_actions",n);case 10:case"end":return e.stop()}}),e)})))()},handleMangeSubs:function(){var t;this.openSubscrptionPayment(1==(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType))},openSubscrptionPayment:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log("this.paymentData",this.paymentData,this.SubscriptionType),this.executedSubType=t,this.$refs.paymentFormDialog.showPaymentFormDialog(this.paymentData),this.$logEvent("log_actions",{operation:"click_card_page",behavior_info:this.itemName+"_button",behavior_info_sub:"click_subscribe_button"})}})},P=L,j=(n(5004),Object(k.a)(P,(function(){var t,e,o,r,c=this,l=c._self._c;return c.paymentData?l("div",{staticClass:"subscription-item"},[l("div",{staticClass:"header"},[l("div",{directives:[{name:"show",rawName:"v-show",value:c.isFreeTry,expression:"isFreeTry"}],staticClass:"free-try"},[c._v("\n        "+c._s(c.$t("FreeToTry"))+"\n      ")]),c._v(" "),c.inSale?l("div",{staticClass:"half-discount flex-center",style:c.getBg},[c._v(c._s("".concat(null===(t=c.paymentData)||void 0===t?void 0:t.discount,"% OFF")))]):c._e(),c._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:c.inSale&&c.halfDiscountCountdown,expression:"inSale && halfDiscountCountdown"}],staticClass:"countdown-box flex-center"},[l("span",[c._v(c._s(null===(e=c.halfDiscountCountdown)||void 0===e?void 0:e.hours))]),c._v(" "),l("span",[c._v(":")]),c._v(" "),l("span",[c._v(c._s(null===(o=c.halfDiscountCountdown)||void 0===o?void 0:o.minutes))]),c._v(" "),l("span",[c._v(":")]),c._v(" "),l("span",[c._v(c._s(null===(r=c.halfDiscountCountdown)||void 0===r?void 0:r.seconds))])]),c._v(" "),l("div",{staticClass:"category"},[l("span",{staticClass:"category-tag"},[c._v(c._s(c.$t(c.content.label)))])]),c._v(" "),l("div",{staticClass:"price",class:c.getLanguage},[l("span",{staticClass:"now-amount"},[c._v("\n          "+c._s(c.getNowAmount)+"\n        ")]),c._v(" "),l("span",[c._v("/")]),c._v(" "),l("span",{staticClass:"type"},[c._v("\n          "+c._s(c.$t(this.isWeek?"week":"Month"))+"\n        ")])]),c._v(" "),c.isYearly&&!c.content.isFree?l("div",{staticClass:"original-amount"},[c._v("\n        "+c._s(c.getOriginalAmount)+"\n      ")]):c._e(),c._v(" "),l("div",{staticClass:"tip"},[c._v("\n        "+c._s(c.getPriceTips)+"\n      ")]),c._v(" "),l("el-button",{directives:[{name:"show",rawName:"v-show",value:!c.content.isFree,expression:"!content.isFree"}],staticClass:"subscription-btn",attrs:{disabled:c.getSubscriptionBtnDisabled,loading:c.btnLoading},on:{click:c.handlePurchase}},[c._v("\n        "+c._s(c.getBtnName)+"\n      ")])],1),c._v(" "),l("div",{staticClass:"explanation"},[c.paymentData.is_first?l("div",{staticClass:"discount"},[l("div",{staticClass:"words"},[c._v(c._s(c.$t("FirstChargePresent")))]),c._v(" "),l("div",{staticClass:"number"},[c._v("\n          "+c._s(c.paymentData.first_give_calculate_coins)+"\n          "),l("img",{staticClass:"icon",attrs:{alt:"credits",src:n(169)}})])]):c._e(),c._v(" "),l("div",{staticClass:"top"},[l("div",{staticClass:"stamina"},[l("div",{staticClass:"stamina-text"},[c._v("\n            "+c._s(c.getStamina)+"\n          ")]),c._v(" "),l("div",{staticClass:"stamina-day"},[l("span",{staticClass:"stamina-day-text"},[c._v("\n              "+c._s(c.getStaminaDay)+"\n            ")]),c._v(" "),l("HelpTip",{staticClass:"help",attrs:{color:"rgba(255, 255, 255, 0.6)",content:c.$t("newShopTips13")}})],1)])]),c._v(" "),l("div",{staticClass:"content"},[c._l(c.content.benefits,(function(t){return[l("div",{key:t.i18nKey,staticClass:"item-terms"},[l("div",{staticClass:"icon-div"},[l("i",{staticClass:"icon",class:t.correct?"el-icon-check":"el-icon-close"})]),c._v(" "),l("div",{staticClass:"words-div"},[l("span",{domProps:{innerHTML:c._s(c.txtWithHtml(t))}}),c._v(" "),t.comingSoon?l("span",{staticClass:"coming-soon"},[c._v(" ("+c._s(c.$t("ComingSoon"))+") ")]):c._e()]),c._v(" "),t.helpI18nKey?l("div",{staticClass:"help-div"},[l("HelpTip",{staticClass:"help",attrs:{color:"rgba(177, 183, 204,0.6)",content:c.$t(t.helpI18nKey)}})],1):c._e(),c._v(" "),t.popover?l("VideoExplainPopover",{key:t.popover,staticClass:"mall-explain-popup",attrs:{type:t.popover,isVideoModel:"",showBtn:!1}},[l("span",{attrs:{slot:"reference"},slot:"reference"},[l("i",{staticClass:"iconfont icon-help-icon",staticStyle:{color:"rgba(177, 183, 204, 0.6)",cursor:"pointer"}})])]):c._e()],1)]}))],2)]),c._v(" "),l("el-button",{directives:[{name:"show",rawName:"v-show",value:!c.content.isFree,expression:"!content.isFree"}],staticClass:"subscription-btn",attrs:{disabled:c.getSubscriptionBtnDisabled,loading:c.btnLoading},on:{click:c.handlePurchase}},[c._v("\n      "+c._s(c.getBtnName)+"\n    ")]),c._v(" "),l("PaymentFormDialog",{ref:"paymentFormDialog",attrs:{initMount:!0,isSubscription:c.executedSubType,isFreeTry:c.isFreeTry}}),c._v(" "),l("up-or-down-dialog",{ref:"upOrDownDialog",attrs:{language:c.language,paymentData:c.paymentData,nowPlan:c.content.label,SubscriptionType:c.SubscriptionType}})],1):c._e()}),[],!1,null,null,null)),$=j.exports;installComponents(j,{HelpTip:n(297).default});var T=n(1149),M=n(9);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={name:"Subscription",components:{SubscriptionItem:$},data:function(){return{language:"",activeTab:"year",subscriptionTypes:["year","month","week"],yearlData:[],monthData:[],weekData:[],contents:T.a,btnLoading:!1,showYear:!0,showMonth:!0,showWeek:!1}},created:function(){var t=this;this.$EventBus.$on("getMallGoodsData",Object(h.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[t.getGoodsData()],t.isLoggedIn&&n.push(t.getSubUrlAndThirdType()),e.next=5,Promise.all(n);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to get mall goods data:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),this.fetchGrayInfo()},beforeDestroy:function(){this.$EventBus.$off("getMallGoodsData")},mounted:function(){this.getPaymentInfo();this.language=["zhCN","en"].includes(this.$i18n.locale)?localStorage.getItem("language")||this.$i18n.locale:"en",this.getGoodsData(),this.isLoggedIn&&this.getSubUrlAndThirdType()},computed:A(A(A(A({},Object(r.e)("payment",["paymentInfo","subThirdType","subscriptionUrl"])),Object(r.e)("user",["userInfo"])),Object(r.c)("user",["isLoggedIn"])),{},{getDiscount:function(){var t="SubsDiscount",e=this.yearlData.filter((function(t){return null==t?void 0:t.discount})).map((function(t){return t.discount}));if(null!=e&&e.length){var n=Math.max.apply(Math,Object(f.a)(e));t="SubsDiscount".concat(n)}return this.$t(t)},isSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.purchaseType;return e&&2===n},getSubLevel:function(){var t,e=null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel;return this.$t(["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][e-1])},isT1Country:function(){var t;return M.qb.includes(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},filteredContents:function(){return this.contents},filteredYearlData:function(){return this.yearlData},filteredMonthData:function(){return this.monthData},filteredWeekData:function(){return this.weekData}}),methods:A(A({},Object(r.b)("payment",["getPaymentInfo","getSubUrlAndThirdType","setActiveSvipInfo"])),{},{changeMethods:function(t){this.activeTab=t,this.$logEvent("log_actions",{operation:"click_sku_subscribe",behavior_info:"on_".concat(t)})},getPaymentData:function(t){switch(this.activeTab){case"year":return this.filteredYearlData[t];case"month":return this.filteredMonthData[t];case"week":return this.filteredWeekData[t];default:return null}},getGoodsData:function(){var t=this;Object(_.n)().then((function(e){var n=e.data,o=void 0===n?{}:n,r=o.month,c=void 0===r?[]:r,l=o.year,d=void 0===l?[]:l,h=o.week,v=void 0===h?[]:h,f=o.free_daily_coins,m=void 0===f?130:f;localStorage.setItem("goodsInfo",JSON.stringify((null==e?void 0:e.data)||""));var _=A(A({},JSON.parse(JSON.stringify(c[0]))),{},{id:"Free",title:"Free",type:3,is_big_vip:!1,level:1,price:0,with_trial:!1,is_first:!1,every_day_temp_coins:m,local_price_web:A(A({},c[0].local_price_web),{},{price:0,price_old:0})});c.unshift(_),d.unshift(_),v.unshift(_),t.weekData=v,t.monthData=c,t.yearlData=d.map((function(t,e){return A(A({},t),{},{original_price:c[e].price,original_price_cn:c[e].price_cn})}));var y=t.paymentInfo,w=y.svipActiveState,C=y.recentPlan,k=(y.payRange,Object.values((null==e?void 0:e.data)||{}).flat().find((function(sub){return sub.id===C})));w&&t.setActiveSvipInfo(k)}))},handleManage:function(){this.subscriptionUrl&&9!==this.subThirdType&&window.open(this.subscriptionUrl,"_blank"),9===this.subThirdType&&this.$message({message:this.$t("Contact_customer"),type:"warning"})},fetchGrayInfo:function(){var t=this;return Object(h.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(_.g)();case 3:o=e.sent,null!=(r=(null==o||null===(n=o.data)||void 0===n?void 0:n.sub_type)||[])&&r.length&&(t.showWeek=null==r?void 0:r.includes("week"),t.showMonth=null==r?void 0:r.includes("month"),t.showYear=null==r?void 0:r.includes("year")),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),t.showWeek=!1,t.showMonth=!0,t.showYear=!0,console.error("Failed to fetch gray info:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})))()}})},B=(n(5005),Object(k.a)(E,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"subscription"},[e("div",{staticClass:"top"},[e("div",{staticClass:"subscription-methods"},[t.showYear?e("div",{staticClass:"yearly",class:{active:"year"===t.activeTab},on:{click:function(e){return t.changeMethods("year")}}},[t._v("\n          "+t._s(t.$t("PayYearly"))+"\n          "),e("div",{staticClass:"discount"},[t._v("\n            "+t._s(t.getDiscount)+"\n            "),e("img",{staticClass:"img",attrs:{src:n(755),alt:"fire"}})])]):t._e(),t._v(" "),t.showMonth?e("div",{staticClass:"monthly",class:{active:"month"===t.activeTab},on:{click:function(e){return t.changeMethods("month")}}},[t._v("\n          "+t._s(t.$t("PayMonthly"))+"\n        ")]):t._e(),t._v(" "),t.showWeek?e("div",{staticClass:"weekly",class:{active:"week"===t.activeTab},on:{click:function(e){return t.changeMethods("week")}}},[t._v("\n          "+t._s(t.$t("PayWeekly"))+"\n        ")]):t._e()])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"subscription-contents"},[t._l(t.filteredContents,(function(content,n){return[e("subscription-item",{key:n,attrs:{content:content,SubscriptionType:t.activeTab,language:t.language,paymentData:t.getPaymentData(n)},on:{changeMethods:t.changeMethods}})]}))],2)])])}),[],!1,null,null,null).exports),N=n(607),F=n(826);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V={name:"GoodsContainer",components:{Subscription:B,PaymentFormDialog:v.default,NumberTransition:N.default,DecorationsView:F.a},props:{type:{type:String,default:"Credit"},language:{type:String,default:"en"},goodsData:{type:Object,default:function(){}}},data:function(){return{showFirstCalculate:!1}},mounted:function(){var t=this;this.initItemsQuantity(),this.fetchGrayInfo(),this.$nextTick((function(){t.applyGradientTextStyles()}))},computed:H(H(H(H({},Object(r.e)("payment",["paymentInfo"])),Object(r.c)("user",["userInfo","isLoggedIn"])),Object(r.e)("user",["cdnHost"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},inCreditsActivity:function(){var t;return!(null===(t=this.goodsData)||void 0===t||!t.data)&&this.goodsData.data.some((function(t){return t.discount>0}))},isT1Country:function(){var t;return t1Countries.includes(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)}}),watch:{"goodsData.data":{handler:function(t){var e=this;t&&t.length&&(this.initItemsQuantity(),this.$nextTick((function(){e.applyGradientTextStyles()})))},deep:!0}},methods:{getItemBaseCredits:function(t){return t?(t.calculate_coins-t.give_calculate_coins)*t.quantity:0},getItemBonusCredits:function(t){return t?t.give_calculate_coins*t.quantity:0},getItemTotalCredits:function(t){return t?t.calculate_coins*t.quantity:0},applyGradientTextStyles:function(){document.querySelectorAll(".gradient-text").forEach((function(element){var t=element.querySelector(".number-transition");t&&(t.style.background="inherit",t.style.backgroundClip="text",t.style.webkitBackgroundClip="text",t.style.color="transparent")}))},initItemsQuantity:function(){var t,e=this;null!==(t=this.goodsData)&&void 0!==t&&null!==(t=t.data)&&void 0!==t&&t.length&&this.goodsData.data.forEach((function(t){void 0===t.quantity&&e.$set(t,"quantity",1)}))},handleQuantityChange:function(t){var e=this;t.quantity<1?t.quantity=1:t.quantity>99&&(t.quantity=99),this.$nextTick((function(){e.applyGradientTextStyles()}))},getPrice:function(t){var e,n,o=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency,r=null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price;return o+(parseFloat(r)*t.quantity).toFixed(2)},getPriceOld:function(t){var e,n,o=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency,r=null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price_old;return o+(parseFloat(r)*t.quantity).toFixed(2)},handlePurchase:function(t){var e=this;if(this.isLoggedIn){var n=H(H({},t),{},{quantity:t.quantity||1});this.$refs.paymentFormDialog.showPaymentFormDialog(n),this.$logEvent("log_actions",{operation:"click_calculation_page",behavior_info:null==t?void 0:t.calculate_coins,behavior_info_sub:"click_calculation_button"})}else this.$EventBus.$emit("openLoginDialog",{callBack:function(){e.$nextTick((function(){e.handlePurchase(t)}))}})},fetchGrayInfo:function(){var t=this;return Object(h.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(_.g)();case 3:o=e.sent,t.showFirstCalculate=!(null==o||null===(n=o.data)||void 0===n||!n.show_first_calculate),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.showFirstCalculate=!0,console.error("Failed to fetch gray info:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}},z=(n(5007),Object(k.a)(V,(function(){var t,e,o=this,r=o._self._c;return r("div",{staticClass:"goods-container",class:["Credit"===o.type?"goods-container-spacial":""]},[r("div",{directives:[{name:"show",rawName:"v-show",value:"Credit"===o.type,expression:"type === 'Credit'"}],staticClass:"old-mall"},[r("div",{staticClass:"top-desc"},[r("i",{staticClass:"iconfont icon-mall-desc tip"}),o._v(" "),r("span",{staticClass:"words"},[o._v(o._s(o.$t(null===(t=o.goodsData)||void 0===t?void 0:t.describe)))])]),o._v(" "),r("div",{staticClass:"goods"},[o._l(null===(e=o.goodsData)||void 0===e?void 0:e.data,(function(t,e){var c;return["Credit"!==o.type||!o.showFirstCalculate&&0===e?o._e():r("div",{key:t.id,staticClass:"item-goods-wrapper"},[3===e||e===(null===(c=o.goodsData)||void 0===c?void 0:c.data.length)-1?r("div",{staticClass:"best-tag"},[r("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250227/fa67164f-33d0-48e0-bc64-0ee685599106.png",alt:"best tag"}}),o._v(" "),r("div",{staticClass:"best-tag-text",class:{"two-lines":3===e}},[3===e?[o._v(o._s(o.$t("bestSeller")))]:[o._v(o._s(o.$t("bestValue")))]],2)]):o._e(),o._v(" "),"Credit"===o.type?r("div",{directives:[{name:"show",rawName:"v-show",value:t.give_calculate_coins||0===e,expression:"item.give_calculate_coins || index === 0"}],staticClass:"discount-simple",class:{"in-activity":o.inCreditsActivity}},[r("span",[o._v("+"+o._s(null==t?void 0:t.web_give_ratio)+"%")])]):o._e(),o._v(" "),r("div",{staticClass:"item-goods",on:{click:function(e){return e.preventDefault(),o.handlePurchase(t)}}},[r("div",{staticClass:"goods-info",class:o.type},["Credit"===o.type?r("div",{staticClass:"mall-Credit"},[r("div",{staticClass:"words flex-center"},[o._v("\n                  "+o._s(o.getItemTotalCredits(t))+"\n                ")]),o._v(" "),r("div",{staticClass:"detail flex-center"},[r("span",{staticClass:"num-1"},[o._v("\n                    "+o._s(o.getItemBaseCredits(t))+"\n                  ")]),o._v(" "),r("span",[o._v("+")]),o._v(" "),r("span",{staticClass:"num-2"},[o._v("\n                    "+o._s(o.getItemBonusCredits(t))+"\n                  ")])]),o._v(" "),r("img",{staticClass:"icon",attrs:{src:n(5699)("./".concat(t.iconUrl)),alt:o.type}})]):o._e()]),o._v(" "),r("div",{staticClass:"quantity-control",on:{click:function(t){t.stopPropagation()}}},[r("el-input-number",{attrs:{min:1,max:99,size:"medium"},on:{change:function(e){return o.handleQuantityChange(t)}},model:{value:t.quantity,callback:function(e){o.$set(t,"quantity",e)},expression:"item.quantity"}})],1),o._v(" "),r("el-button",{staticClass:"purchase-btn",attrs:{loading:t.btnLoad},on:{click:function(e){return e.stopPropagation(),o.handlePurchase(t)}}},[r("span",{directives:[{name:"show",rawName:"v-show",value:t.discount,expression:"item.discount"}],staticClass:"price-old"},[o._v(o._s(o.getPriceOld(t)))]),o._v(" "),r("span",{staticClass:"price-new"},[o._v(o._s(o.getPrice(t)))])])],1)])]}))],2)]),o._v(" "),r("Subscription",{directives:[{name:"show",rawName:"v-show",value:"Subscription"===o.type,expression:"type === 'Subscription'"}]}),o._v(" "),"Decorations"===o.type?r("div",{staticClass:"decorations-box"},[r("DecorationsView",{attrs:{"is-mall":""}})],1):o._e(),o._v(" "),r("PaymentFormDialog",{ref:"paymentFormDialog",attrs:{initMount:!0,upgrade:!1,isSubscription:!1}})],1)}),[],!1,null,"68ae9e27",null).exports),W={name:"MemberBenefits",props:{},data:function(){return{container:["FREE","VIP LITE","VIP"],benefitTermsArr:["GetStaminaPerDay","SubsBottomTerms2","SameTimeTaskQueue","daily_rights_2","characterSettingAdvancedModel","WorkPrivacyRights","WorkBatchDownload","BenefitTaskHistory","Paintboard","daily_rights_15","Use5LoRAs","modelTrainLimit","daily_rights_14","GetCreditsGive","AiVideoAllPlay"],notVipTerms:[1,3,5,6,9,10,11,12,13,14],notVipLiteTerms:[3,12,14],notVipCardTerms:[12,14],needParamTerms:[{key:0,params_free:150,params_vip_lite:300,params_vip:700},{key:2,params_free:2,params_vip_lite:5,params_vip:5},{key:7,params_free:14,params_vip_lite:30,params_vip:30},{key:8,params_free:1,params_vip_lite:2,params_vip:5}]}},computed:{getIcon:function(){return function(t){return n("VIP"===t?136:1077)}},getTermIconClass:function(){var t=this;return function(e,n){var o;switch(e){case"FREE":o=t.notVipTerms.includes(n)?"el-icon-close":"el-icon-check";break;case"VIP LITE":o=t.notVipLiteTerms.includes(n)?"el-icon-close":"el-icon-check";break;case"VIP":o=t.notVipCardTerms.includes(n)?"el-icon-close":"el-icon-check";break;default:o="el-icon-close"}return o}},getI18nKey:function(){var t=this;return function(e,n,o){var r=t.needParamTerms.find((function(t){return t.key===o}));return r?t.$t(n,{param:r[{FREE:"params_free","VIP LITE":"params_vip_lite",VIP:"params_vip"}[e]]}):t.$t(n)}}},methods:{}},G=(n(5008),Object(k.a)(W,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"member-benefits"},[e("div",{staticClass:"tip"},[e("i",{staticClass:"iconfont icon-mall-desc icon"}),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(t.$t("MemberBenefitsTip")))])]),t._v(" "),e("div",{staticClass:"benefits-container"},t._l(t.container,(function(n){return e("div",{key:n,staticClass:"item-container",class:n},[e("div",{staticClass:"sloganBg"},["FREE"!=n?e("img",{staticClass:"vip-icon",attrs:{src:t.getIcon(n),alt:"vip-icon"}}):t._e(),t._v(" "),e("div",{staticClass:"words"},[t._v(t._s(n))])]),t._v(" "),e("div",{staticClass:"terms-container"},[t._l(t.benefitTermsArr,(function(o,r){return[e("div",{key:r,staticClass:"item-term"},[e("i",{staticClass:"term-icon",class:t.getTermIconClass(n,r)}),t._v(" "),e("span",{staticClass:"term-words"},[t._v("\n              "+t._s(t.getI18nKey(n,o,r))+"\n            ")])])]}))],2)])})),0)])}),[],!1,null,null,null).exports),Y=(n(777),n(47),n(511)),K=n.n(Y),J=(n(778),n(512)),X=n.n(J);n(90);function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt={name:"CommonQuestions",components:{ElCollapse:X.a,ElCollapseItem:K.a},props:{language:{type:String,default:"en"}},data:function(){return{collapseActiveArr:[],collapses:[{title:"SubsCollapseTitle1",content:"SubsCollapseContent1"},{title:"SubsCollapseTitle2",content:"SubsCollapseContent2"},{title:"SubsCollapseTitle3",content:"SubsCollapseContent3"},{title:"SubsCollapseTitle4",content:"SubsCollapseContent4_new"},{title:"SubsCollapseTitle14",content:"SubsCollapseContent14"},{title:"SubsCollapseTitle18",content:"SubsCollapseContent18"},{title:"SubsCollapseTitle5",content:"SubsCollapseContent5_latest",needFreeDailyCoins:!0},{title:"SubsCollapseTitle15",content:"SubsCollapseContent15"},{title:"SubsCollapseTitle7",content:"SubsCollapseContent7"},{title:"SubsCollapseTitle8",content:"SubsCollapseContent8_latest",needFreeDailyCoins:!0},{title:"SubsCollapseTitle9",content:"SubsCollapseContent9_new"},{title:"SubsCollapseTitle12",content:"SubsCollapseContent12_new"},{title:"SubsCollapseTitle13",content:"SubsCollapseContent13"}],activityCollaspesLen:0,freeDailyCoins:0}},computed:Z(Z(Z({},Object(r.e)("payment",["cachedSubscriptions"])),Object(r.c)("user",["isLoggedIn"])),{},{getEmail:function(){var t;return null!==(t=this.language)&&void 0!==t&&t.startsWith("zh")?"customer@haiyiai.com":"customer@seaart.ai"}}),mounted:function(){this.getGoodsData()},methods:Z(Z({},Object(r.b)("payment",["getSubscriptionList"])),{},{handleCollapseChange:function(t){var e=t.length>this.activityCollaspesLen;if(this.activityCollaspesLen=t.length,e){var n=t[t.length-1];this.$logEvent("log_actions",{operation:"click_mall_Q&A",behavior_info:"Q"+n})}},getGoodsData:function(){var t=this;return Object(h.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList({isSaveData:t.isLoggedIn});case 3:n=e.sent,t.freeDailyCoins=n.data.free_daily_coins,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch subscription list:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}})},et=(n(5009),Object(k.a)(tt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"common-questions"},[e("h2",{staticClass:"title"},[t._v("\n    "+t._s(t.$t("FrequentlyAskedQuestions"))+"\n  ")]),t._v(" "),e("p",{staticClass:"sub-title"},[t._v("\n    "+t._s(t.$t("FrequentlyAskedQuestionsTip"))+"\n  ")]),t._v(" "),e("el-collapse",{staticClass:"collapse",on:{change:t.handleCollapseChange},model:{value:t.collapseActiveArr,callback:function(e){t.collapseActiveArr=e},expression:"collapseActiveArr"}},[t._l(t.collapses,(function(n,o){return[e("el-collapse-item",{key:o,attrs:{name:o}},[e("template",{slot:"title"},[e("p",{staticClass:"collapse-title"},[t._v("\n            "+t._s(t.$t(n.title))+"\n          ")])]),t._v(" "),e("p",{staticClass:"content"},[n.needFreeDailyCoins?[t._v("\n            "+t._s(t.$t(n.content,{num:t.freeDailyCoins}))+"\n          ")]:n.needParams?[t._v("\n            "+t._s(t.$t(n.content,{email:t.getEmail}))+"\n          ")]:[t._v("\n            "+t._s(t.$t(n.content))+"\n          ")]],2)],2)]}))],2)],1)}),[],!1,null,null,null)),it=et.exports,nt=(n(1120),n(680)),at={name:"PurchaseRecordDialog",components:{ElPagination:n.n(nt).a},props:{language:{type:String,default:"en"}},data:function(){return{timestampToTime:c.i,isShowDialog:!1,tableDate:{page:1,page_size:6},total:0,recordData:[],loading:!1}},computed:{getIconSrc:function(){return function(t){if(t)return n(1571)("./".concat({2:"purchase-record-vip",3:"purchase-record-vip",4:"purchase-record-vip",5:"purchase-record-vip",6:"diamond_2x",7:"credits_2x"}[t],".png"))}},getStatusText:function(){var t=this;return function(e){return{1:t.$t("inEffect"),2:t.$t("PendingEffective"),3:t.$t("expired"),4:t.$t("Completed")}[e]||"--"}},getConsumptionInfo:function(){return function(t){if([1,24].includes(t.source)){var e,n,o=null===(e=t.product_info)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.currency,r=null===(n=t.product_info)||void 0===n||null===(n=n.local_price_web)||void 0===n?void 0:n.price;return"".concat(o," ").concat(r)}return t.product_info.buy_paid_coins}},getVIPCardName:function(){var t=this;return function(e){return t.$t(t.isLite(e)?"vip_lite_card_name":"vip_card_name",{number:e.product_info.day_num})}},getSVIPCardName:function(){var t=this;return function(e){var n=e.product_info,o=n.level,r=n.type,c=2===r?"Month":4===r?"week":"year";return"".concat(t.$t(["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][o-1])," /\n\t\t\t\t").concat(t.$t(c))}},isLite:function(){return function(t){var e;return null==t||null===(e=t.product_info)||void 0===e?void 0:e.id.includes("lite")}}},methods:{showDialog:function(){this.getData(),this.isShowDialog=!0},closed:function(){this.isShowDialog=!1},wordsCopy:function(t){Object(l.g)(t),this.$message.success(this.$t("CopySuccess"))},getData:function(){var t=this;this.loading=!0,Object(_.l)(this.tableDate).then((function(e){var n=e.data,o=n.items,r=n.total;t.loading=!1,t.total=r,t.recordData=null==o?void 0:o.filter((function(t){return[2,3,4,5,6,7].includes(t.product_info.type)}))})).catch((function(e){t.loading=!1}))},pageChange:function(t){this.tableDate.page=t,this.getData()}}},st=(n(5010),Object(k.a)(at,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"purchase-record-dialog custom-dialog",attrs:{width:"900px",title:e.$t("PurchaseRecord"),visible:e.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowDialog=t},closed:e.closed}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container"},[null!==(t=e.recordData)&&void 0!==t&&t.length?o("ul",{staticClass:"rows"},[o("li",{staticClass:"row row-header"},[o("div",{staticClass:"goods-name"},[e._v(e._s(e.$t("ProductName")))]),e._v(" "),o("div",{staticClass:"goods-consumption"},[e._v(e._s(e.$t("Price")))]),e._v(" "),o("div",{staticClass:"goods-number"},[e._v(e._s(e.$t("OrderNumber")))]),e._v(" "),o("div",{staticClass:"goods-status"},[e._v(e._s(e.$t("status")))]),e._v(" "),o("div",{staticClass:"goods-time"},[e._v(e._s(e.$t("Time")))])]),e._v(" "),e._l(e.recordData,(function(t){return[o("li",{key:t.id,staticClass:"row"},[o("div",{staticClass:"goods-name"},[o("img",{staticClass:"icon",class:{"vip-icon":5===t.product_info.type},attrs:{src:e.getIconSrc(t.product_info.type),alt:"icon"}}),e._v(" "),o("span",{staticClass:"star"},[e._v("*")]),e._v(" "),5===t.product_info.type?o("span",{staticClass:"words"},[e._v("\n              "+e._s(e.getVIPCardName(t))+"\n            ")]):[2,3,4].includes(t.product_info.type)?o("span",{staticClass:"words"},[e._v("\n              "+e._s(e.getSVIPCardName(t))+"\n            ")]):o("span",{staticClass:"number"},[e._v("\n              "+e._s(6===t.product_info.type?t.product_info.paid_coins:t.product_info.calculate_coins)+"\n            ")])]),e._v(" "),o("div",{staticClass:"goods-consumption"},[17===t.source?o("img",{staticClass:"icon",attrs:{src:n(743),alt:"diamond"}}):e._e(),e._v(" "),o("span",{staticClass:"words",class:{cash:1===t.source}},[e._v("\n              "+e._s(e.getConsumptionInfo(t))+"\n            ")])]),e._v(" "),o("div",{staticClass:"goods-number"},[e._v("\n            "+e._s(t.order_sn)+"\n            "),o("i",{staticClass:"iconfont icon-copy copy-icon",on:{click:function(n){return e.wordsCopy(t.order_sn)}}})]),e._v(" "),o("div",{staticClass:"goods-status"},[null!=t&&t.sub_status?o("span",[e._v("\n              "+e._s(e.getStatusText(t.sub_status))+"\n            ")]):o("span",[e._v("--")])]),e._v(" "),o("div",{staticClass:"goods-time"},[e._v("\n            "+e._s(e.timestampToTime(t.create_at,"yyyy-MM-dd hh:mm:ss"))+"\n          ")])])]}))],2):o("div",{staticClass:"no-data-tip"},[e._v("\n      "+e._s(e.$t("no_data"))+"\n    ")]),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",background:"","page-size":7,"current-page":e.tableDate.page,total:e.total},on:{"update:currentPage":function(t){return e.$set(e.tableDate,"page",t)},"update:current-page":function(t){return e.$set(e.tableDate,"page",t)},"current-change":e.pageChange}})],1)])}),[],!1,null,null,null).exports),ot=n(147);function ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ut={name:"MallCheckinDialog",props:{},data:function(){return{isShowDialog:!1,checkinBtnLoading:!1,checkinArrs:[{title:"FirstDay"},{title:"SecondDay"},{title:"ThirdDay"},{title:"FourthDay"},{title:"FifthDay"},{title:"SixthDay"},{title:"SeventhDay"}],renderCheckinArrs:[],activityTime:""}},mounted:function(){},methods:lt(lt({},Object(r.b)("payment",["getPaymentInfo"])),{},{getData:function(){var t=this;Object(ot.i)().then((function(e){var n=e.data,o=n.list,r=n.activity_time;null!=o&&o.length&&(t.activityTime=r,o.forEach((function(e,n){var o=Object.assign({},e,t.checkinArrs[n]);o=lt(lt({},o),{},{icon:"mall-checkin-".concat(1===e.assets_type?"credit":"vipcard",".png"),expired_icon:"mall-checkin-".concat(1===e.assets_type?"credit":"vipcard","-expired.png"),desc:"x".concat(1===e.assets_type?e.num:e.num+"day")}),t.renderCheckinArrs.push(o)})))})).catch((function(t){console.log("err",t)}))},showDialog:function(){this.getData(),this.isShowDialog=!0},close:function(){localStorage.setItem("MALL_DIALOG_SHOW_2",!0),this.isShowDialog=!1,this.renderCheckinArrs=[],this.checkinBtnLoading=!1,this.activityTime=""},checkIn:function(){var t=this;this.checkinBtnLoading=!0,Object(ot.k)().then((function(e){t.$message.success(t.$t("SignInSuccess")),t.getPaymentInfo(),t.isShowDialog=!1,t.checkinBtnLoading=!1})).catch((function(e){console.log("err",e),t.checkinBtnLoading=!1}))}})},ht=(n(5011),Object(k.a)(ut,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"mall-checkin-dialog",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!0},on:{"update:visible":function(e){t.isShowDialog=e},close:t.close}},[t.renderCheckinArrs.length?e("div",{staticClass:"container"},[e("i",{staticClass:"el-icon-close close-icon",on:{click:function(e){t.isShowDialog=!1}}}),t._v(" "),e("div",{staticClass:"title"},[e("span",{staticClass:"words"},[t._v(t._s(t.$t("DayCheckIn")))])]),t._v(" "),e("div",{staticClass:"desc"},[e("div",{staticClass:"line-one"},[e("div",[t._v("\n          "+t._s(t.$t("AnniversarySpecialEvents"))+"\n        ")]),t._v(" "),e("div",[e("span",{staticClass:"symbol-one"},[t._v(">")]),t._v(" "),e("span",{staticClass:"symbol-two"},[t._v(">")]),t._v(" "),e("span",{staticClass:"symbol-three"},[t._v(">")])])]),t._v(" "),e("div",{staticClass:"line-two"},[t._v(t._s(t.$t("AnniversarySpecialEventsDesc")))])]),t._v(" "),e("div",{staticClass:"checkin-container"},[t._l(t.renderCheckinArrs,(function(o){return[e("div",{key:o.id,staticClass:"item-checkin",class:{"is-current":o.current,received:o.is_sign,"not-received":o.is_over&&!o.is_sign}},[o.is_sign?e("div",{staticClass:"received-mask"},[e("img",{staticClass:"received-icon",attrs:{src:n(1059),alt:"received icon"}})]):t._e(),t._v(" "),e("div",{staticClass:"top"},[e("img",{staticClass:"img",attrs:{src:n(499)("./".concat(o.is_over&&!o.is_sign?o.expired_icon:o.icon))}}),t._v(" "),e("div",{staticClass:"goods-desc"},[t._v("\n              "+t._s(o.desc)+"\n            ")])]),t._v(" "),e("div",{staticClass:"title"},[t._v(t._s(t.$t(o.title)))])])]}))],2),t._v(" "),e("div",{staticClass:"btn"},[e("el-button",{staticClass:"btn-div",attrs:{loading:t.checkinBtnLoading},on:{click:t.checkIn}},[t._v("\n        "+t._s(t.$t("CheckInNow"))+"\n      ")])],1)]):t._e()])}),[],!1,null,null,null).exports),vt=(n(31),n(300)),pt=n(558);function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var gt={name:"PaymentStatusDialog",inject:["top"],data:function(){return{isShowDialog:!1,isLoading:!0,intervalId:null,paymentData:{},third_type:1,defaultOptions:{animationData:vt},confettiTimer:null,confettiCount:0}},mounted:function(){var t=this;this.$EventBus.$on("openPaymentStatusDialog",(function(e){t.isShowDialog=!0,t.isLoading=!1,t.paymentData=e}))},beforeDestroy:function(){this.$EventBus.$off("openPaymentStatusDialog"),this.confettiTimer&&(clearTimeout(this.confettiTimer),this.confettiTimer=null),pt.a.reset()},computed:{getContainerStyle:function(){return{height:this.isLoading?"248px":"400px"}},getExpiryTime:function(){return Object(c.i)(this.paymentData.payment_at,"yyyy-MM-dd hh:mm:ss")},getVIPCardName:function(){var t;return this.$t(this.isLite?"vip_lite_card_name":"vip_card_name",{number:null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.day_num})},getSVIPCardName:function(){var t=this;return function(e){var n=e.Product,o=n.level,r=n.type,c=2===r?"Month":4===r?"week":"year";return"".concat(t.$t(["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][o-1])," /\n\t\t\t\t").concat(t.$t(c))}},isLite:function(){var t;return null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t||null===(t=t.cp_product_id)||void 0===t?void 0:t.includes("lite")},isPhoto:function(){var t;return null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t||null===(t=t.cp_product_id)||void 0===t?void 0:t.includes("ai_photo")},getPhotoName:function(){if(this.isPhoto){var t,e=((null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.cp_product_id)||"").slice(-2);return this.$t("aiAvatarNumber",{num:e})}return""},getPrice:function(){var t;if(null!==(t=this.paymentData)&&void 0!==t&&null!==(t=t.Product)&&void 0!==t&&t.local_price_web){var e,n,o,r=null===(e=this.paymentData)||void 0===e?void 0:e.Product;return(null==r||null===(n=r.local_price_web)||void 0===n?void 0:n.currency)+(null==r||null===(o=r.local_price_web)||void 0===o?void 0:o.price)}return""}},methods:mt(mt({},Object(r.b)("payment",["getPaymentInfo"])),{},{playConfettiAnimation:function(){var t=this;this.confettiCount=0,this.confettiTimer&&(clearTimeout(this.confettiTimer),this.confettiTimer=null);var e=document.querySelector(".payment-status-dialog .el-dialog");if(e){var n=e.getBoundingClientRect(),o=window.innerHeight,r=window.innerWidth,c=n.top/o,l=n.left/r,d=(n.left+n.width)/r,h=function e(){if(t.confettiCount>=5||!t.isShowDialog||t.isLoading)t.confettiTimer=null;else{var n=function(t,e){return Math.random()*(e-t)+t};Object(pt.a)({particleCount:n(50,100),angle:n(55,125),spread:n(50,70),origin:{y:Math.max(.25,c+.1),x:n(l+.1,d-.1)},colors:["#FF5252","#FFD740","#40C4FF","#69F0AE","#FF4081","#7C4DFF"],startVelocity:n(25,45),gravity:1.2,ticks:400,shapes:["circle","square"],zIndex:9999,disableForReducedMotion:!0}),t.confettiCount++;var o=n(200,500);t.confettiTimer=setTimeout(e,o)}};h(),setTimeout((function(){t.isShowDialog&&!t.isLoading&&t.confettiCount<5&&h()}),50),setTimeout((function(){t.isShowDialog&&!t.isLoading&&t.confettiCount<5&&h()}),100)}},close:function(){this.isShowDialog=!1,this.isLoading=!0,this.paymentData={},this.third_type=1,clearInterval(this.intervalId),this.confettiTimer&&(clearTimeout(this.confettiTimer),this.confettiTimer=null),pt.a.reset();var t=window.location.href.split("?")[0];window.history.replaceState(null,"",t)},showDialog:function(t,e){this.third_type=t,this.isShowDialog=!0,this.pollGetPaymentStatus(t,e)},pollGetPaymentStatus:function(t,e){var n=this,o=0;this.intervalId=setInterval(Object(h.a)(regeneratorRuntime.mark((function r(){var c,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,o++,r.next=4,Object(_.j)({third_type:t,order_id:e});case 4:c=r.sent,null!=(data=c.data)&&data.is_paid?(clearInterval(n.intervalId),n.isLoading=!1,n.paymentData=data,n.$nextTick((function(){n.playConfettiAnimation()})),null!=data&&data.renewal_sub_url&&window.open(data.renewal_sub_url),n.getPaymentInfo(),n.top.getGoodsList(),n.top.getLimitDiscounts({is_first:!1}),n.$EventBus.$emit("getMallGoodsData"),localStorage.removeItem("half_discount_end_time")):o>=10&&(n.close(),n.$message.warning(n.$t("PurchaseFailed"))),r.next=15;break;case 9:r.prev=9,r.t0=r.catch(0),n.close(),n.$message.warning(n.$t("PurchaseFailed")),clearInterval(n.intervalId),console.log("error",r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,9]])}))),2e3)},handleDone:function(){this.$logEvent("web_purchase");gtag("event","purchase",{transaction_id:this.paymentData.order_no,affiliation:{1:"payermax",4:"alipay",5:"wechatpay",6:"paypal",8:"stripe"}[this.third_type],value:this.paymentData.Product.price,currency:"USD"}),this.isShowDialog=!1}})},_t=(n(5012),Object(k.a)(gt,(function(){var t,e,o,r=this,c=r._self._c;return c("el-dialog",{staticClass:"payment-status-dialog",attrs:{top:"calc(50vh - 168px)",width:"350px",visible:r.isShowDialog,"destroy-on-close":!0,modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){r.isShowDialog=t},closed:r.close}},[!r.isLoading&&null!==(t=r.paymentData)&&void 0!==t&&t.is_paid?c("div",{staticClass:"confetti-container"}):r._e(),r._v(" "),c("div",{staticClass:"payment-status-dialog-container",style:r.getContainerStyle},[!r.isLoading&&null!==(e=r.paymentData)&&void 0!==e&&e.is_paid?c("div",{staticClass:"ribbon-decoration"},[c("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250218/d24155c9-5b89-40ad-93dc-fa2a8a4491a4.png",alt:"ribbon"}})]):r._e(),r._v(" "),r.isLoading?r._e():c("div",{staticClass:"celebration-icon"},[c("img",{attrs:{src:n(541),alt:"celebrate"}})]),r._v(" "),r.isLoading?c("div",{staticClass:"loading"},[c("lottie",{attrs:{options:r.defaultOptions,height:110,width:110}}),r._v(" "),c("div",{staticClass:"words"},[r._v("\n          "+r._s(r.$t("CheckingPaymentResult"))+"\n        ")]),r._v(" "),c("el-button",{staticClass:"cancel-btn",on:{click:function(t){r.isShowDialog=!1}}},[r._v("\n          "+r._s(r.$t("Cancel"))+"\n        ")])],1):c("div",{staticClass:"finish"},[c("div",{staticClass:"tip"},[r._v(r._s(r.$t("PaymentSuccessful"))+" !")]),r._v(" "),c("div",{staticClass:"name"},[5===r.paymentData.Product.type?c("div",{staticClass:"vipcard detail-div"},[r._v("\n            "+r._s(r.getVIPCardName)+"\n            "),c("img",{staticClass:"icon",attrs:{src:n(754),alt:"vip icon"}})]):[2,3,4].includes(r.paymentData.Product.type)?c("div",{staticClass:"svip-text"},[r._v("SVIP")]):r.isPhoto?c("div",{staticClass:"photo"},[r._v("\n            "+r._s(r.getPhotoName)+"\n          ")]):0===(null===(o=r.paymentData)||void 0===o||null===(o=o.Product)||void 0===o?void 0:o.type)?c("div",{staticClass:"game"}):c("div",{staticClass:"credits detail-div"},[r._v("\n            "+r._s(r.paymentData.Product.calculate_coins)+"\n            "),c("img",{staticClass:"icon",attrs:{src:n(169),alt:"credits icon"}})])]),r._v(" "),c("div",{staticClass:"content"},[c("div",{staticClass:"item-content total"},[c("div",{staticClass:"label"},[r._v(r._s(r.$t("Total"))+":")]),r._v(" "),c("div",{staticClass:"detail"},[r._v("\n              "+r._s(r.getPrice)+"\n              "),[2,3,4].includes(r.paymentData.Product.type)?c("span",{staticClass:"type"},[r._v("\n                "+r._s(r.getSVIPCardName(r.paymentData))+"\n              ")]):r.isPhoto?c("span",{staticClass:"type"},[r._v("\n                "+r._s(r.getPhotoName)+"\n              ")]):r._e()])]),r._v(" "),c("div",{staticClass:"item-content order-number"},[c("div",{staticClass:"label"},[r._v(r._s(r.$t("OrderNumber"))+":")]),r._v(" "),c("div",{staticClass:"detail"},[r._v("\n              "+r._s(r.paymentData.order_no)+"\n            ")])]),r._v(" "),c("div",{staticClass:"item-content payment-time"},[c("div",{staticClass:"label"},[r._v(r._s(r.$t("PaymentTime"))+":")]),r._v(" "),c("div",{staticClass:"detail"},[r._v("\n              "+r._s(r.getExpiryTime)+"\n            ")])])]),r._v(" "),c("el-button",{staticClass:"done-btn",on:{click:r.handleDone}},[r._v("\n          "+r._s(r.$t("Done"))+"\n        ")])],1)])])}),[],!1,null,null,null).exports);function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wt={name:"DiscountDialog",props:{discountData:{type:Object,default:function(){}},times:{type:Object,default:function(){}},language:{type:String,default:"en"}},data:function(){return{isShowDialog:!1}},methods:{showDialog:function(){this.isShowDialog=!0},close:function(){this.isShowDialog=!1},buyGoods:function(){var t=yt(yt({},this.discountData.product_info),{},{cp_product_id:this.discountData.product_info.id});location.href.includes("haiyiai.com")?this.$EventBus.$emit("showHaiyiPaymentMethodDialog",t,"Credit"):this.$EventBus.$emit("showSeaartPaymentMethodDialog",t,"Credit")}}},Ct=(n(5013),Object(k.a)(wt,(function(){var t,e,n,o,r=this,c=r._self._c;return c("el-dialog",{staticClass:"discount-dialog",attrs:{visible:r.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){r.isShowDialog=t},close:r.close}},[c("div",{staticClass:"container"},[c("i",{staticClass:"el-icon-close close-icon",on:{click:function(t){r.isShowDialog=!1}}}),r._v(" "),c("div",{staticClass:"title"},[r._v("\n      "+r._s(r.$t("LimitedTimeBenefits"))+"\n    ")]),r._v(" "),c("div",{staticClass:"number"},[c("div",{staticClass:"number-new"},[r._v("\n        "+r._s(null===(t=r.discountData)||void 0===t||null===(t=t.product_info)||void 0===t?void 0:t.calculate_coins)+"\n      ")]),r._v(" "),c("div",{staticClass:"number-old"},[r._v("\n        "+r._s(null===(e=r.discountData)||void 0===e||null===(e=e.product_info)||void 0===e?void 0:e.calculate_coins_old)+"\n      ")])]),r._v(" "),c("div",{staticClass:"remaining"},[c("div",{staticClass:"words"},[r._v("\n        "+r._s(r.$t("ValidTimeRemaining"))+"\n      ")]),r._v(" "),c("div",{staticClass:"times"},[c("div",{staticClass:"hours"},[r.times.hours<10?c("span",[r._v("0")]):r._e(),r._v("\n          "+r._s(r.times.hours)+"\n        ")]),r._v(" "),c("span",{staticClass:"colon"},[r._v(":")]),r._v(" "),c("div",{staticClass:"minutes"},[r.times.minutes<10?c("span",[r._v("0")]):r._e(),r._v("\n          "+r._s(r.times.minutes)+"\n        ")]),r._v(" "),c("span",{staticClass:"colon"},[r._v(":")]),r._v(" "),c("div",{staticClass:"second"},[r.times.seconds<10?c("span",[r._v("0")]):r._e(),r._v("\n          "+r._s(r.times.seconds)+"\n        ")])])]),r._v(" "),c("div",{staticClass:"btn",on:{click:r.buyGoods}},[r._v("\n      "+r._s("en"===r.language?"$ ".concat(null===(n=r.discountData)||void 0===n||null===(n=n.product_info)||void 0===n?void 0:n.price):"￥ ".concat(null===(o=r.discountData)||void 0===o||null===(o=o.product_info)||void 0===o?void 0:o.price_cn))+"\n    ")])])])}),[],!1,null,null,null).exports),kt=n(27),Ot=n(559);n(18),n(73);function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St={name:"MallTopBar",data:function(){return{formatNumberForeign:l.p,logoUrl:n(275),vipIconUrl:n(665),coins:[{name:"credit",icon:n(205),type:"calculateCoins",desc:"new_credit_desc"},{name:"stamina",icon:n(160),type:"tempCoins",desc:"new_stamina_desc"}]}},computed:It(It(It(It(It({},Object(r.e)("payment",["paymentInfo","activeState","liteActiveState","subThirdType","subscriptionUrl"])),Object(r.e)("user",["userInfo"])),Object(r.c)("user",["isLoggedIn"])),Object(r.c)("unsubscribe",["userCancelStatus","userFreeTryStatus","userPauseStatus"])),{},{isSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.purchaseType;return e&&2===n&&!this.userCancelStatus&&this.isAllowSubscription||2===this.userFreeTryStatus||this.userPauseStatus},isAllowSubscription:function(){return[8,9,12].includes(this.subThirdType)},isVip:function(){return this.activeState||this.liteActiveState},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}}}),methods:It(It(It({},Object(r.b)("user",["getAccountInfo"])),Object(r.d)("user",["SET_USER_INFO"])),{},{handleBack:function(){window.opener?this.$router.push(this.localePath("/")):history.length>1?this.$router.back():this.$router.push(this.localePath("/"))},handleManage:function(){this.subscriptionUrl&&8===this.subThirdType?window.open(this.subscriptionUrl,"_blank"):this.$EventBus.$emit("showManageSub")},toHome:function(){this.$router.push(this.localePath("/"))},openLogin:function(){this.$EventBus.$emit("openLoginDialog")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")},handleOpenRecord:function(){this.$emit("openRecord")}})},Dt=(n(5014),Object(k.a)(St,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-mall-top-bar"},[e("div",{staticClass:"mall-top-bar-left"},[e("div",{staticClass:"back-preview-btn",on:{click:function(e){return e.stopPropagation(),t.handleBack.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("a",{staticClass:"mall-top-bar-logo",attrs:{href:t.localePath("/")},on:{click:function(e){return e.preventDefault(),t.toHome.apply(null,arguments)}}},[e("img",{staticClass:"nav-logo-img",attrs:{src:n(315),alt:"SeaArt AI"}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoggedIn,expression:"isLoggedIn"}],staticClass:"mall-top-bar-right"},[e("div",{staticClass:"mall-top-bar-info"},[e("div",{staticClass:"vip-info"},[t._l(t.coins,(function(n){return[e("div",{key:n.name,staticClass:"item-coin",class:n.name,attrs:{title:t.getCoinTitle(n)}},[e("img",{staticClass:"icon",attrs:{src:n.icon,alt:n.name}}),t._v(" "),e("div",{staticClass:"number"},[t._v("\n              "+t._s(t.formatNumberForeign(t.paymentInfo[n.type])||0)+"\n            ")])])]}))],2)]),t._v(" "),e("div",{staticClass:"mall-top-btn award-btn",on:{click:function(e){return t.$router.push("/event-center/award")}}},[e("div",{staticClass:"award-btn-wrapper"},[t._v("\n        "+t._s(t.$t("Credit_Details"))+"\n      ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isSubscription,expression:"isSubscription"}],staticClass:"mall-top-btn",on:{click:t.handleManage}},[t._v(t._s(t.$t("ManageSubscription")))]),t._v(" "),e("div",{staticClass:"mall-top-btn",on:{click:function(e){return t.handleOpenRecord()}}},[t._v(t._s(t.$t("PurchaseRecord")))])])])}),[],!1,null,"656c4c53",null)),Lt=Dt.exports;function Pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $t={name:"Unsub",props:{},components:{Unsub1Select:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5879))},Unsub2Confirm:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(183)]).then(n.bind(null,5880))},Unsub3Advice:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5881))},Unsub4Pause:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5882))},Unsub4PauseConfirm:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5883))},Unsub5FreeTry:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5884))},Unsub5FreeTryConfirm:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5885))},Unsub6Discount:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(174)]).then(n.bind(null,5763))},Unsub7:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5886))}},computed:jt(jt(jt({},Object(r.e)("user",["cdnHost"])),Object(r.c)("unsubscribe",["userPauseStatus","userFreeTryStatus"])),{},{currentStepComponent:function(){return this.steps[this.currentStep]},currentImage:function(){var t={manageSub:"/20241209/dc25c5e5-ec43-4c21-acb1-5fedc57e95d0_high.webp",confirmUnsub:"/20241209/82b86f02-9018-4170-a7cc-92ad92aa606c_high.webp",advice:"/20241209/81a97a9f-5977-4615-833e-76bf5499e1f3_high.webp",pause:"/20241209/e4619622-680e-4b75-a468-707123a8be63_high.webp",pauseConfirm:"/20241209/8defb0e7-cfb2-4526-8432-df79b6250cfe_high.webp",freeTry:"/20241209/82b86f02-9018-4170-a7cc-92ad92aa606c_high.webp",freeTryConfirm:"/20241209/8defb0e7-cfb2-4526-8432-df79b6250cfe_high.webp",unsubFinal:"/20241209/81a97a9f-5977-4615-833e-76bf5499e1f3_high.webp"}[this.currentStep];return t?"https://".concat(this.cdnHost).concat(t):""},manageIcon:function(){return"https://".concat(this.cdnHost,"/static/upload/20241211/320ae730-6256-4971-bcba-740c92abc18e.png")}}),created:function(){this.$EventBus.$on("showManageSub",this.showUnsubDialog)},mounted:function(){this.getAccountSubStatus()},data:function(){return{isShowDialog:!1,currentStep:"manageSub",selectedMonths:"",steps:{manageSub:"Unsub1Select",confirmUnsub:"Unsub2Confirm",advice:"Unsub3Advice",pause:"Unsub4Pause",pauseConfirm:"Unsub4PauseConfirm",freeTry:"Unsub5FreeTry",freeTryConfirm:"Unsub5FreeTryConfirm",discount:"Unsub6Discount",unsubFinal:"Unsub7"}}},methods:jt(jt({},Object(r.b)("unsubscribe",["getUserStatus"])),{},{showUnsubDialog:function(){this.userPauseStatus&&[0,3].includes(this.userFreeTryStatus)?(this.$message.warning(this.$t("pauseNoManage")),this.$EventBus.$emit("showManageCancelDlg","pause")):(this.getAccountSubStatus(),this.isShowDialog=!0)},nextStep:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log("nextStep",e);var o=e[0],r=e[1];console.log("stepName",o,"stepData",r),"pauseConfirm"===o&&(console.log("确认暂停",r),this.selectedMonths=r||""),this.steps[o]&&(this.currentStep=o)},resetData:function(){this.currentStep="manageSub"},handleClose:function(){this.close()},close:function(){this.isShowDialog=!1},getAccountSubStatus:function(){var t=this;return Object(h.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getUserStatus();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.$message.error(t.$t("error.getStatus"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()}}),errorCaptured:function(t,e,n){return console.error(t),this.$message.error(this.$t("error.component")),!1},beforeDestroy:function(){this.resetData(),this.close(),this.$EventBus.$off("showManageSub")}},Tt=$t,Mt=(n(5015),n(5016),Object(k.a)(Tt,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"unsub-dialog",attrs:{visible:t.isShowDialog,"append-to-body":"","destroy-on-close":!0,"close-on-click-modal":!1,top:"discount"===t.currentStep?"2vh":"10vh"},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.resetData}},[e("div",{staticClass:"close-icon",on:{click:t.close}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"unsub-main flex"},[t.currentImage?e("div",{staticClass:"left-img"},[t.currentImage?e("img",{staticClass:"example-image",attrs:{src:t.currentImage,loading:"lazy",width:"260",height:"669",alt:"example-image"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}}):t._e(),t._v(" "),e("div",{staticClass:"logo-container"},[e("img",{attrs:{src:t.manageIcon,width:"79",height:"79",alt:"manage-icon",loading:"lazy"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}}),t._v(" "),e("div",{staticClass:"manage"},[t._v(t._s(t.$t("SubManage")))]),t._v(" "),e("div",{staticClass:"colors-text-3"},[t._v(t._s(t.$t("Subscription")))])])]):t._e(),t._v(" "),e("div",{staticClass:"right-component"},[e(t.currentStepComponent,{tag:"component",attrs:{selectedMonths:t.selectedMonths},on:{"next-step":t.nextStep,"click-close":t.handleClose}})],1)])])}),[],!1,null,"862519c0",null).exports),Rt=n(479);function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Bt={name:"MallSubTip",computed:Et(Et(Et({},Object(r.c)("unsubscribe",["userPauseStatus","userFreeTryStatus","userCancelStatus","willDiscountUpgrade","pauseConfig","freeTryConfig","nextConfig"])),Object(r.c)("payment",["paymentInfo"])),{},{percentages:function(){var t;return null!==(t=this.nextConfig)&&void 0!==t&&t.nextPlan?this.nextConfig.nextPlan.includes("sub_monthly")?10:30:10}}),data:function(){return{getPlan:Rt.a,timestampToTime:c.i}},methods:{cancelAction:function(t){this.$logEvent("log_actions",{operation:"click_cancel_the_"+t,behavior_info:"on_unsubscribe_page"}),this.$EventBus.$emit("showManageCancelDlg",t)}}},Nt=(n(5017),Object(k.a)(Bt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-tab flex-center flex-col"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.userFreeTryStatus&&t.userPauseStatus,expression:"!userFreeTryStatus && userPauseStatus"}],staticClass:"tag-title pause-content flex items-center justify-between"},[e("div",{staticClass:"left-text flex-center"},[e("i",{staticClass:"el-icon-info"}),t._v("\n      "+t._s(t.$t("mallPauseTip",{planLevel:t.$t(t.getPlan(t.paymentInfo.recentPlan)),planYearOrMonth:t.$t(t.getPlan(t.paymentInfo.recentPlan,"range")),startDate:t.pauseConfig?t.timestampToTime(t.pauseConfig.pause_start_at,"yyyy.MM.dd"):0,endDate:t.pauseConfig?t.timestampToTime(t.pauseConfig.pause_end_at,"yyyy.MM.dd"):0}))+"\n    ")]),t._v(" "),e("el-button",{staticClass:"btn-item",attrs:{type:"text"},on:{click:function(e){return t.cancelAction("pause")}}},[t._v("\n      "+t._s(t.$t("cancelPause"))+"\n    ")])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.userFreeTryStatus,expression:"userFreeTryStatus"}],staticClass:"tag-title try-content flex items-center justify-between"},[e("div",{staticClass:"left-text flex-center"},[e("i",{staticClass:"el-icon-info"}),t._v("\n      "+t._s(t.$t("mallFreePlanTip",{planLevel:t.$t("ToB_beginnerPlan"),startDate:t.freeTryConfig?t.timestampToTime(t.freeTryConfig.free_month_start_at,"yyyy.MM.dd"):0,endDate:t.freeTryConfig?t.timestampToTime(t.freeTryConfig.free_month_end_at,"yyyy.MM.dd"):0}))+"\n    ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.willDiscountUpgrade,expression:"willDiscountUpgrade"}],staticClass:"tag-title discount-content flex items-center justify-between"},[e("div",{staticClass:"left-text flex-center"},[e("i",{staticClass:"el-icon-info"}),t._v("\n      "+t._s(t.$t("mallDiscountTip",{num:t.percentages,date:t.nextConfig?t.timestampToTime(t.nextConfig.nextActiveTime,"yyyy.MM.dd"):0,planLevel:t.nextConfig&&t.$t(t.getPlan(t.nextConfig.nextPlan))||""}))+"\n    ")]),t._v(" "),e("el-button",{staticClass:"btn-item",attrs:{type:"text"},on:{click:function(e){return t.cancelAction("discount")}}},[t._v(t._s(t.$t("cancelChange")))])],1)])}),[],!1,null,"9b21ea4c",null).exports),Ft=(n(1098),n(323));function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Vt={name:"UnsubCancelDialog",components:{SubFooter:n(235).a,PaymentFormDialog:v.default},computed:Ht(Ht(Ht({},Object(r.c)("unsubscribe",["userPauseStatus","userFreeTryStatus","userCancelStatus","willDiscountUpgrade","pauseConfig","freeTryConfig","nextConfig","prevPlanId"])),Object(r.c)("payment",["paymentInfo","payRange"])),{},{title:function(){return"pause"===this.dialogType?{main:this.$t("cancelPause"),sub:this.$t("cancelPauseDlgTitle")}:{main:this.$t("cancelChange"),sub:this.$t("cancelChangeDlgTitle")}},inPausedNow:function(){var t,e=null===(t=this.pauseConfig)||void 0===t?void 0:t.pause_start_at;return this.userPauseStatus&&e&&Date.now()>e},isPauseNowAndUpgradeSpecial:function(){return"pause"===this.dialogType&&this.inPausedNow&&!this.effectiveNow&&this.willDiscountUpgrade},fromPlan:function(){var t,e="pause"===this.dialogType?this.prevPlanId:null===(t=this.nextConfig)||void 0===t?void 0:t.nextPlan;if(e)return Object(Rt.a)(e,"all")},toPlan:function(){var t,e=this.prevPlanId;this.isPauseNowAndUpgradeSpecial&&(e=null===(t=this.nextConfig)||void 0===t?void 0:t.nextPlan);if(e)return Object(Rt.a)(e,"all")},fromPlanText:function(){var t,e,n,o,r="pause"===this.dialogType?"pauseFrom":"cancelFrom",l="pause"===this.dialogType?null===(t=this.pauseConfig)||void 0===t?void 0:t.pause_start_at:null===(e=this.nextConfig)||void 0===e?void 0:e.nextActiveTime;return this.$t(r,{date:l?Object(c.i)(l,"yyyy.MM.dd"):0,planLevel:this.$t(null===(n=this.fromPlan)||void 0===n?void 0:n._levelName),planYearOrMonth:this.$t(null===(o=this.fromPlan)||void 0===o?void 0:o._range)})},toPlanText:function(){var t,e,n="pause"===this.dialogType?"recoveryPlan":"cancelStay";return this.$t(n,{planLevel:this.$t(null===(t=this.toPlan)||void 0===t?void 0:t._levelName),planYearOrMonth:this.$t(null===(e=this.toPlan)||void 0===e?void 0:e._range)})},effectTime:function(){var t,e,n;return"pause"===this.dialogType?this.inPausedNow?this.effectiveNow?Date.now():null===(t=this.pauseConfig)||void 0===t?void 0:t.pause_end_at:null===(e=this.pauseConfig)||void 0===e?void 0:e.pause_start_at:"discount"===this.dialogType?null===(n=this.nextConfig)||void 0===n?void 0:n.nextActiveTime:void 0},effectPrice:function(){var t,e=this.prevPlanId;this.isPauseNowAndUpgradeSpecial&&(e=null===(t=this.nextConfig)||void 0===t?void 0:t.nextPlan);var n=Object(Rt.a)(e,"all"),o=null==n?void 0:n._unit,r=null==n?void 0:n._price;return"".concat(o," ").concat(r)}}),data:function(){return{getPlan:Rt.a,timestampToTime:c.i,isShowDialog:!1,dialogType:"pause",effectiveNow:!0}},created:function(){this.$EventBus.$on("showManageCancelDlg",this.showSubCancelDialog)},beforeDestroy:function(){this.$EventBus.$off("showManageCancelDlg",this.showSubCancelDialog)},methods:Ht(Ht({},Object(r.b)("unsubscribe",["getUserStatus"])),{},{showSubCancelDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&("pause"===t&&this.inPausedNow&&(this.effectiveNow=!0),this.dialogType=t,this.isShowDialog=!0)},handleCancel:function(){"discount"===this.dialogType&&this.$message.success(this.$t("cancelDiscount")),this.close()},handleConfirm:function(){console.log("handleConfirm"),"pause"===this.dialogType?this.runCancelPause():this.runCancelDiscount()},runCancelPause:function(){this.inPausedNow&&this.effectiveNow?this.$refs.paymentFormDialog.showPaymentFormDialog({id:this.prevPlanId}):this.cancelPause()},cancelPause:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(Ft.e)({renew:!0}).then((function(n){var o;1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)&&(e&&t.$message.success(t.$t("cancelPauseDlgTitle")),t.updateStatus())}))},runCancelDiscount:function(){var t=this;Object(Ft.a)().then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("cancelDiscount")),t.updateStatus())}))},updateStatus:function(){var t=this,e=setTimeout((function(){t.getUserStatus(),clearTimeout(e)}),300);this.close()},close:function(){this.$logEvent("log_actions",{operation:"click_keep_the_change",behavior_info:"on_unsubscribe_page"}),this.isShowDialog=!1},resetData:function(){}})},zt=Vt,Wt=(n(5019),Object(k.a)(zt,(function(){var t,e,n,o,r,c=this,l=c._self._c;return l("el-dialog",{staticClass:"unsub-cancel-dialog",attrs:{visible:c.isShowDialog,modal:!1,"append-to-body":!0,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){c.isShowDialog=t},closed:c.resetData}},[l("div",{staticClass:"close-icon",on:{click:c.close}},[l("i",{staticClass:"el-icon-close"})]),c._v(" "),l("div",{staticClass:"unsub-main flex flex-col"},[l("div",{staticClass:"head flex items-center"},[c._v(c._s(c.title.main))]),c._v(" "),l("div",{staticClass:"main"},[l("div",{staticClass:"title-top"},[c._v(c._s(c.title.sub))]),c._v(" "),l("div",{staticClass:"detail"},[l("div",{staticClass:"plan from-plan"},[l("div",{staticClass:"left"},[l("div",{staticClass:"line-one"},[l("span",{staticClass:"word",domProps:{innerHTML:c._s(c.fromPlanText)}})])]),c._v(" "),l("div",{staticClass:"right"},[c._v("\n            "+c._s(null===(t=c.fromPlan)||void 0===t?void 0:t._unit)+c._s("pause"===this.dialogType?0:null===(e=c.fromPlan)||void 0===e?void 0:e._price)+"\n            "),l("span",{staticClass:"per-month"},[c._v("/"+c._s(c.$t("Month")))])])]),c._v(" "),l("div",{staticClass:"plan to-plan"},[l("div",{staticClass:"left"},[l("div",{staticClass:"line-one"},[l("span",{staticClass:"word"},[c._v(c._s(c.toPlanText))])])]),c._v(" "),l("div",{staticClass:"right"},[c._v("\n            "+c._s(null===(n=c.toPlan)||void 0===n?void 0:n._unit)+c._s(null===(o=c.toPlan)||void 0===o?void 0:o._price)+"\n            "),l("span",{staticClass:"per-month"},[c._v("/"+c._s("planTypeWeek"===(null===(r=c.toPlan)||void 0===r?void 0:r._range)?c.$t("week"):c.$t("Month")))])])])]),c._v(" "),l("div",{staticClass:"effect flex justify-between items-center"},[l("div",{staticClass:"effect-time"},[c._v("\n          "+c._s(c.effectTime?c.$t("tryDlgConfirmStart",{formDate:c.timestampToTime(c.effectTime,"yyyy.MM.dd")}):"")+"\n        ")]),c._v(" "),l("div",{staticClass:"effect-price"},[c._v(c._s(c.effectPrice))])])]),c._v(" "),l("div",{staticClass:"btns-container flex justify-center items-center"},[l("div",{staticClass:"close-btn btn flex justify-center items-center",on:{click:c.handleCancel}},[c._v("\n        "+c._s(c.$t("Cancel"))+"\n      ")]),c._v(" "),l("div",{staticClass:"confirm-btn btn flex justify-center items-center",on:{click:c.handleConfirm}},[c._v("\n        "+c._s(c.$t("Confirm"))+"\n      ")])])]),c._v(" "),l("PaymentFormDialog",{ref:"paymentFormDialog",attrs:{initMount:!0},on:{success:c.updateStatus}})],1)}),[],!1,null,"3b3dad20",null).exports);function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yt={name:"Mall",components:{GoodsContainer:z,MemberBenefits:G,CommonQuestions:it,PurchaseRecordDialog:st,MallCheckinDialog:ht,PaymentStatusDialog:_t,DiscountDialog:Ct,Banner:Ot.default,MallTopBar:Lt,Unsub:Mt,MallSubTip:Nt,UnsubCancelDialog:Wt},provide:function(){return{top:this}},head:function(){return{title:this.$t("price_title"),meta:[{hid:"description",name:"description",content:this.$t("price_desc")},{hid:"og:title",name:"og:title",content:this.$t("price_title")},{hid:"og:description",name:"og:description",content:this.$t("price_desc")}]}},data:function(){return{formatNumberForeign:l.p,language:"",dataAlready:!1,coins:[{name:"credits",icon:n(169),type:"calculateCoins",desc:"credit_desc"},{name:"stamina",icon:n(397),type:"tempCoins",desc:"new_stamina_desc"}],currentTab:"Subscription",goodsData:{VIP_Card:{describe:"vip_card_desc",data:[]},Credit:{describe:"credit_recharge_desc",data:[]}},discountData:{},times:{hours:0,minutes:0,seconds:0},timer:null,endTime:0,currentTime:0,intervalTime:0,showCheckin:!1,isShowBanner:!1,isShowActivity:!1,dotFrom:"",paymentMethods:[],isShowVipCard:!0,maxDiscount:""}},mounted:function(){var t;this.dotFrom=(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.dotFrom)||"",this.getPaymentInfo(),this.getGoodsList(),this.isShowPaymentStatusDialog();this.language=["zhCN","en"].includes(this.$i18n.locale)?localStorage.getItem("language")||this.$i18n.locale:"en";var e=this.$route.query;null!=e&&e.openTab&&this.changeTab({key:null==e?void 0:e.openTab}),this.setBannerHidden(),this.getPaymentMethods()},beforeDestroy:function(){clearInterval(this.timer)},computed:Gt(Gt(Gt(Gt(Gt({},Object(r.e)("user",["cdnHost"])),Object(r.e)("payment",["paymentInfo","maxRecharge"])),Object(r.c)("user",["isCompanyAccount","userInfo","isLoggedIn"])),Object(r.c)("activity",["isShowActivityBanner"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},tabs:function(){return[{key:"Subscription",label:"subscription_tab",icon:n(1263)},{key:"Credit",label:"credits_recharge",icon:n(1262)},{key:"Decorations",label:"personalized_decoration",icon:"https://image.cdn2.seaart.me/20250607/0413ac4d-342e-41d2-a35d-bac56602af9e_high.webp"}]},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},isShowDiscount:function(){return Object.keys(this.discountData).length&&this.discountData.is_show},getExpiryTime:function(){var t;return Object(c.i)(null===(t=this.paymentInfo)||void 0===t?void 0:t.expiryTime,"yyyy-MM-dd hh:mm:ss")},getLiteExpiryTime:function(){var t;return Object(c.i)(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteExpiryTime,"yyyy-MM-dd hh:mm:ss")},getSVIPExpiryTime:function(){var t;return Object(c.i)(null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime,"yyyy-MM-dd hh:mm:ss")},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}},getReady:function(){return!this.isLoggedIn||this.dataAlready}}),watch:{maxRecharge:{handler:function(t){var e="computingPower"==this.$route.query.dotFrom;e?this.$logEvent("log_actions",{operation:"mall_page_show",behavior_info:"calculate"}):this.$logEvent("log_actions",{operation:"mall_page_show",behavior_info:"svip"}),t&&(e&&(this.currentTab="Credit"),console.log(this.currentTab),this.getLimitDiscounts({is_first:e}))},immediate:!0},isCompanyAccount:function(t){this.setBannerHidden()},isLoggedIn:function(t,e){t&&!e&&this.refreshDataAfterLogin()}},methods:Gt(Gt({},Object(r.b)("payment",["getPaymentInfo"])),{},{refreshDataAfterLogin:function(){this.getPaymentInfo(),this.getGoodsList(),this.$EventBus.$emit("getMallGoodsData"),this.getPaymentMethods(),this.setBannerHidden()},setBannerHidden:function(){var t=localStorage.getItem("HideTopBanner"),e=localStorage.getItem("HideTopBannerTime");(e||(e=Date.now()),this.isShowBanner)||(t?Date.now()-e>864e5&&(this.isShowBanner=!this.isCompanyAccount&&!this.isVip&&!this.isShowActivityBanner,localStorage.removeItem("HideTopBanner")):this.isShowBanner=!this.isCompanyAccount&&!this.isVip&&!this.isShowActivityBanner);this.isShowActivity=!this.isCompanyAccount&&!localStorage.getItem("HideActivityBanner")&&this.isShowActivityBanner},closeBanner:function(){this.isShowActivity?(this.isShowActivity=!1,this.isShowBanner=!1,localStorage.setItem("HideActivityBanner",!0)):(this.isShowBanner=!1,localStorage.setItem("HideTopBanner",!0),localStorage.setItem("HideTopBannerTime",Date.now()))},backTo:function(){history.length>1?this.$router.back():this.$router.push(this.localePath("/"))},showPurchaseRecordDialog:function(){this.$refs.purchaseRecordDialog.showDialog()},changeTab:function(t){var e=t.key;this.currentTab=e;null==this||this.$logEvent("log_actions",{operation:"mall_page_show",behavior_info:{Subscription:"svip",Credit:"calculate",VIP_Card:"vip",Decorations:"decorations"}[e]})},getLimitDiscounts:function(t){var e=this;Object(_.h)(t).then((function(n){var data=n.data;e.discountData=data||{},data.is_show&&(e.timer=setInterval(e.getRemainingTime,1e3),e.endTime=data.end_at,e.currentTime=data.current_at,e.intervalTime=e.endTime-e.currentTime,t.is_first&&e.$refs.discountDialog.showDialog())})).catch((function(t){}))},getGoodsList:function(){var t=this;Object(_.f)().then((function(e){var n=e.data,o=n.day,r=n.calculate,c=(n.paid_coins,n.can_sign),l=n.show_old_vip;t.isShowVipCard=l,t.showCheckin=c,t.goodsData.VIP_Card.data=o.map((function(t){return Gt(Gt({},t),{},{btnLoad:!1,bgUrl:"mall/mall-vip-bg.webp"})})),t.goodsData.Credit.data=r.map((function(t){var e,n=t.cp_product_id,o={calculate1:"mall_credit_1.webp",calculate4:"mall_credit_2.webp",calculate5:"mall_credit_3.webp",calculate7:"mall_credit_4.webp",calculate10:"mall_credit_5.webp",calculate11:"mall_credit_5.webp",calculate7_discount:"mall_credit_4.webp",calculate10_discount:"mall_credit_5.webp",calculate11_discount:"mall_credit_5.webp"};return e=(null==o?void 0:o[n])||"mall_credit_1.webp",Gt(Gt({},t),{},{btnLoad:!1,bgUrl:"mall/vip-credit-bg-new.webp",iconUrl:e})})),t.getMaxDiscounts(),t.dataAlready=!0})).catch((function(e){t.dataAlready=!0}))},openCheckinDialog:function(){this.$refs.mallCheckinDialog.showDialog()},isShowPaymentStatusDialog:function(){var t=window.location.href,e=Object(d.a)(t),n=e.x_type,o=e.outTradeNo,r=e.token,c=e.out_trade_no,l=e.ba_token,h=e.session_id,v=e.adyen_order_id,f=e.orderNo,m=e["supplierChannel&orderNo"],_=e.merchantTxnId,y=o||l||r||c||h||v||f||m||_,w=0;o&&(w=1),(l||r)&&(w=6),c&&(w=4),h&&(w=8),v&&(w=9),(f||m)&&(w=10),_&&(w=12),"change-sub"!==n?w&&this.openPaymentStatusDialog(w,y):this.$message.success(this.$t("ChangeSubSuccess"))},openPaymentStatusDialog:function(t,e){this.$refs.paymentStatusDialog.showDialog(t,e)},openDiscountDialog:function(){this.$refs.discountDialog.showDialog()},getRemainingTime:function(){if(this.intervalTime-=1e3,this.intervalTime>0){var t=Math.floor(this.intervalTime%864e5/36e5),e=Math.floor(this.intervalTime%36e5/6e4),n=Math.floor(this.intervalTime%6e4/1e3);this.times.hours=t,this.times.minutes=e,this.times.seconds=n}else clearInterval(this.timer)},getPaymentMethods:function(){var t=this,e={},n=this.userInfo.invite_user_code;e.target_host="".concat(window.location.origin,"/"),e.url="".concat(window.location.origin,"/login?u_code=").concat(n),Object(kt.u)(e).then((function(e){var n;t.paymentMethods=(null==e||null===(n=e.data)||void 0===n?void 0:n.payment_method)||[]}))},getMaxDiscounts:function(){var t,e=null===(t=this.goodsData)||void 0===t||null===(t=t.Credit)||void 0===t?void 0:t.data;if(null!=e&&e.length){var n=e.reduce((function(t,e){return Math.max(t,e.discount)}),0);this.maxDiscount=n?"".concat(n,"0% OFF"):""}}})},Kt=(n(5020),Object(k.a)(Yt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.getReady,expression:"getReady"}],staticClass:"seaart-mall",class:[t.isShowBanner||t.isShowActivity?"seaart-mall-pd50":""]},[t.isShowBanner||t.isShowActivity?e("banner",{attrs:{fixed:!0},on:{close:t.closeBanner}}):t._e(),t._v(" "),e("mall-top-bar",{on:{openRecord:t.showPurchaseRecordDialog}}),t._v(" "),e("div",{staticClass:"container"},[t.showCheckin?e("div",{staticClass:"checkin-btn",on:{click:t.openCheckinDialog}},[e("img",{staticClass:"icon",attrs:{src:n(1057),alt:"checkin btn"}}),t._v(" "),e("div",{staticClass:"words"},[t._v("\n          "+t._s(t.$t("CheckIn"))+"\n        ")])]):t._e(),t._v(" "),t.isShowDiscount?e("div",{staticClass:"discount-btn",on:{click:t.openDiscountDialog}},[e("img",{staticClass:"icon",attrs:{src:n(1058),alt:"discount btn"}}),t._v(" "),e("div",{staticClass:"words"},[t._v("\n          "+t._s(t.$t("vip_invite_dialog_limit"))+"\n        ")]),t._v(" "),e("div",{staticClass:"times"},[e("div",{staticClass:"hours"},[t.times.hours<10?e("span",[t._v("0")]):t._e(),t._v("\n            "+t._s(t.times.hours)+"\n          ")]),t._v(" "),e("span",{staticClass:"colon"},[t._v(":")]),t._v(" "),e("div",{staticClass:"minutes"},[t.times.minutes<10?e("span",[t._v("0")]):t._e(),t._v("\n            "+t._s(t.times.minutes)+"\n          ")]),t._v(" "),e("span",{staticClass:"colon"},[t._v(":")]),t._v(" "),e("div",{staticClass:"second"},[t.times.seconds<10?e("span",[t._v("0")]):t._e(),t._v("\n            "+t._s(t.times.seconds)+"\n          ")])])]):t._e(),t._v(" "),e("div",{staticClass:"goods-tabs",class:{"decorations-tabs":"Decorations"===t.currentTab}},[e("div",{staticClass:"goods-type-tab-box"},[t._l(t.tabs,(function(n){return[e("div",{key:n.key,staticClass:"goods-type-tab",class:{active:t.currentTab===n.key,"tab-credit":"Credit"===n.key},on:{click:function(e){return t.changeTab(n)}}},[e("img",{staticClass:"goods-type-tab-icon",attrs:{src:null==n?void 0:n.icon,alt:t.$t(n.label)}}),t._v(" "),e("span",{staticClass:"goods-type-tab-text"},[t._v(t._s(t.$t(n.label)))]),t._v(" "),"VIP_Card"===n.key?e("div",{staticClass:"tag"},[t._v(t._s(t.$t("delist")))]):t._e()])]}))],2)]),t._v(" "),e("client-only",[t.isLoggedIn?e("MallSubTip"):t._e()],1),t._v(" "),"Decorations"!==t.currentTab?e("h1",{staticClass:"goods-slogan",class:{"guest-padding":!t.isLoggedIn}},[e("span",{staticClass:"goods-slogan-main"},[t._v(t._s(t.$t("mall1")))]),t._v(" "),e("span",{staticClass:"goods-slogan-sub"},[t._v(t._s(t.$t("SeaArt")))])]):t._e(),t._v(" "),e("div",{staticClass:"goods-content"},[e("goods-container",{attrs:{type:t.currentTab,language:t.language,goodsData:t.goodsData[t.currentTab]}})],1)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"VIP_Card"==t.currentTab,expression:"currentTab == 'VIP_Card'"}],staticClass:"comparison-of-membership-benefits"},[e("member-benefits")],1),t._v(" "),e("div",{staticClass:"common-questions-container"},[e("common-questions",{attrs:{language:t.language}})],1),t._v(" "),e("purchase-record-dialog",{ref:"purchaseRecordDialog",attrs:{language:t.language}}),t._v(" "),e("mall-checkin-dialog",{ref:"mallCheckinDialog"}),t._v(" "),e("payment-status-dialog",{ref:"paymentStatusDialog",attrs:{language:t.language}}),t._v(" "),e("discount-dialog",{ref:"discountDialog",attrs:{discountData:t.discountData,times:t.times,language:t.language}}),t._v(" "),e("client-only",[t.isLoggedIn?[e("Unsub"),t._v(" "),e("UnsubCancelDialog")]:t._e()],2)],1)}),[],!1,null,null,null));e.default=Kt.exports;installComponents(Kt,{Banner:n(559).default})},5738:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(19),n(18),n(90),n(113),n(24),n(152),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"ActivityHome",props:{galleryIndex:{type:Number,default:0}},computed:l(l({},Object(r.c)("user",["cdnHostFun"])),{},{langKey:function(){return this.$i18n.locale.startsWith("zh")?"zh":this.$i18n.locale.startsWith("ja")?"jp":"en"},imgList:function(){var t,e=this[["homeBgMap","detailBgMap","resultBgMap"][this.galleryIndex]||"homeBgMap"],n=this.langKey;return(null==e||null===(t=e[n])||void 0===t?void 0:t.contents)||[]},homeBgMap:function(){return{en:{contents:this.generateUrls("en",2,3)},zh:{contents:this.generateUrls("zh",2,3)},jp:{contents:this.generateUrls("jp",2,3)}}},detailBgMap:function(){return{en:{contents:[]},zh:{contents:[]},jp:{contents:[]}}},resultBgMap:function(){return{en:{contents:this.generateUrls("en",1,2,"/static/fluxsecondresult/")},zh:{contents:this.generateUrls("zh",1,2,"/static/fluxsecondresult/")},jp:{contents:this.generateUrls("jp",1,2,"/static/fluxsecondresult/")}}},downloadArea:function(){var path=this.localePath("/models/detail/5073e7d38c3bb4376c201ec297b60261");return{imgUrl:this.generateUrls(this.langKey,6,6),link:path}},downloadAreaRight:function(){var path=this.localePath("/models/detail/7e66a2f311f4b593a51a54234fc37c3d");return{imgUrl:this.generateUrls(this.langKey,7,7),link:path}},firstBg:function(){var path="https://docs.seaart.ai/guide-1/2-seaart-ai-basic-function/flux-lora-training";return this.$isChinaSite&&(path="https://kvrbeskjhpg.feishu.cn/docx/VqXBdza69olCYexouetcglKCn6e#GI4JdNsozouBEWx79CccpBzdnOg"),{imgUrl:this.generateUrls(this.langKey,5,5),link:path}}}),data:function(){return{}},methods:{generateUrls:function(t){for(var e=arguments.length>2?arguments[2]:void 0,path=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/static/fluxsecond/",n=[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;i<=e;i++)n.push("https://".concat(this.cdnHostFun()).concat(path).concat(t,"/web").concat(i,".png"));return n},download:function(t){null!=t&&t.link&&window.open(null==t?void 0:t.link,"_blank")}}},h=d,v=(n(5179),n(0)),f=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("el-row",{staticClass:"activity-home-content"},t._l(t.imgList,(function(n,o){return e("div",{key:"ac_home_img_".concat(o),staticClass:"item-row"},[n?e("img",{attrs:{src:n,alt:"activity_img"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}}):t._e(),t._v(" "),n.endsWith("web2.png")&&0===t.galleryIndex?[t.firstBg.imgUrl?e("img",{staticClass:"first-bg-area",class:"top"+t.langKey,attrs:{src:t.firstBg.imgUrl,alt:"first-bg-btn"},on:{click:function(e){return t.download(t.firstBg)}}}):t._e()]:t._e(),t._v(" "),n.endsWith("web3.png")&&0===t.galleryIndex?[t.downloadArea.imgUrl?e("img",{staticClass:"download-area",class:"top"+t.langKey,attrs:{src:t.downloadArea.imgUrl,alt:"download-btn"},on:{click:function(e){return t.download(t.downloadArea)}}}):t._e(),t._v(" "),t.downloadAreaRight.imgUrl?e("img",{staticClass:"download-area download-area-right",class:"top"+t.langKey,attrs:{src:t.downloadAreaRight.imgUrl,alt:"download-btn"},on:{click:function(e){return t.download(t.downloadAreaRight)}}}):t._e()]:t._e()],2)})),0)}),[],!1,null,"4ce86942",null).exports,m=(n(378),n(171)),_=n(163);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"ActivityWaterfall",props:{type:{type:String,default:"model"},order:{type:String,default:"hot"}},components:{homeList:m.a},computed:{},data:function(){return{loading:!1,noMore:!1,pageInfo:{page:1,limit:20,total:0},queryParam:{page:1,page_size:35,order_by:"hot"},list:[]}},mounted:function(){console.log("mounted comfyui"),this.getList()},methods:{refresh:function(){console.log("refresh"),this.pageInfo.page=1,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getList()},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n=_.e,o=w(w({},this.queryParam),{},{page:this.pageInfo.page,page_size:this.pageInfo.limit,type:"model"===this.type?2:4,order_by:"model"===this.type?"new":this.order});this.queryParam.time_to&&(o.time_to=this.queryParam.time_to),n(o).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,c,l,d,h;if(e.noMore=!(null!==(r=n.data)&&void 0!==r&&r.has_more),t)e.list=e.list.concat((null===(l=n.data)||void 0===l?void 0:l.items)||[]);else e.list=(null===(d=n.data)||void 0===d?void 0:d.items)||[];if(1===e.pageInfo.page&&null!==(c=n.data)&&void 0!==c&&c.time_ms)e.queryParam.time_to=null===(h=n.data)||void 0===h?void 0:h.time_ms;e.pageInfo.page++}})).finally((function(){e.getReady=!0,e.loading=!1}))}}}},k=(n(5180),Object(v.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"activity-waterfall"},[e("div",{ref:"activityList",staticClass:"activity-waterfall__list"},[e("homeList",{attrs:{fromPage:"activityPage",isOpen:!0,isOpenNewTab:!0,list:t.list,container:"activityList"},on:{load:function(e){return t.getList(!0)}}}),t._v(" "),0===t.list.length?e("div",{staticClass:"at-bottom"},[e("div",{staticClass:"dashed-line"}),t._v(" "),e("div",{staticClass:"tips"},[t._v(t._s(t.$t("NoMoreData")))]),t._v(" "),e("div",{staticClass:"dashed-line"})]):t._e()],1)])}),[],!1,null,"44f88138",null).exports),O=(n(22),n(16),n(14)),x=(n(50),n(31),n(21),n(10)),I=n(98),S=n(35),D=n.n(S),L=n(58),P=n(39),j=n(45),$=n(53);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R={mixins:[j.a],components:{BaseAvatar:$.default},inject:["activityOver"],props:{list:{type:Array,default:function(){return[]}},container:{type:String,require:!0},gap:{type:Number,default:16},topGap:{type:Number,default:40},lazy:{type:Boolean,default:!1},type:{type:String,default:""},actived:{type:Boolean,default:!0},cols:{type:Number,default:7},fromPage:{type:String,default:""},isFromRelated:{type:Boolean,default:!1},isShowNullRelatedImg:{type:Boolean,default:!1},alreadyNoMoreData:{type:Boolean,default:!1},noSearchData:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},dislikeShow:{type:Boolean,default:!1},hidethumbup:{type:Boolean,default:!1},hidecollect:{type:Boolean,default:!1},hoverShow:{type:Boolean,default:!1},imgQuality:{type:String,default:"low"},isTiemRow:{type:Boolean,default:!1},openWin:{type:Boolean,default:!1},checkMax:{type:Number,default:-1},category:{type:Boolean,default:!1},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},contentType:{type:String,default:"model"}},data:function(){var t=this;return{formatNumberForeign:x.p,copyTextToClipboard:x.g,saveImg:x.M,width:0,heights:[],dataList:[],resizeListener:Object(I.a)((function(){return t.resize(t.dataList)}),500),selfCols:4,isCollecting:!1,imagePopoverVisible:!1,reportLoading:!1,openWatch:!0,isDelete:!1,sharevisible:!1,popTime:0,itemShow:!1,itemShowId:"",checkList:{ids:[],collectIds:[],folderNos:[],url:[]},scrollTop:0,lastTime:null,appeaData:{obj_no:"",obj_type:1,remark:""},appealShow:!1,errorCodeMap:{40202:"voteOver",40204:"voteDid",40205:"voteForbidden",40206:"voteSelf"}}},watch:{appealShow:{handler:function(t){t||(this.appeaData={obj_no:"",obj_type:1,remark:""})}},list:{handler:function(t,e){var n=this.openWatch,o=this.width;if(n){o&&0!=o||(this.width=this.getWidth());var r=D()(t);if(this.dataList.length<100)this.updateDataList(r,!1);else if(r.length>this.dataList.length){var c=Object(O.a)(r.slice(this.dataList.length));this.updateDataList(c,!0)}else r.length<=this.dataList.length&&(this.dataList=[],this.updateDataList(r,!1))}}},WaterFallDeleteLits:{handler:function(t){this.isDelete=!0}}},computed:M(M(M({},Object(r.c)("user",["isLoggedIn","accountSettingsData"])),Object(r.e)("user",["userInfo","adminOff"])),{},{greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},enableGreenMode:function(){return this.greenMode&&!["/personal"].includes(this.$route.path)},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)},isShowNsfw:function(){return function(t){return this.category&&this.checkIsShowViewNsfw&&!this.enableNsfwMode&&1!==t.nsfw&&(null==t?void 0:t.is_nsfw_plus)}},isPC:function(){return"PC"===localStorage.getItem("visitFrom")}}),created:function(){},activated:function(){var t=this;this.openWatch=!0,this.resizeListener(),window.addEventListener("resize",this.resizeListener),this.lazy&&document.addEventListener("scroll",this.lazyLoad),this.$nextTick((function(){window.scrollTo(0,t.scrollTop)}))},deactivated:function(){this.openWatch=!1,window.removeEventListener("resize",this.resizeListener),window.removeEventListener("scroll",this.lazyLoad)},mounted:function(){window.addEventListener("resize",this.resizeListener),this.lazy&&document.addEventListener("scroll",this.lazyLoad)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeListener),window.removeEventListener("scroll",this.lazyLoad)},methods:M(M({},Object(r.b)("user",["getAccountInfo"])),{},{voteFun:function(t){var e=this;if(!this.activityOver)if(this.isLoggedIn){var n={item_id:t.id,item_type:4};Object(_.j)(n).then((function(n){var o,code=null==n||null===(o=n.status)||void 0===o?void 0:o.code,r=(null==n?void 0:n.data)||1;1e4===code?(e.$message({message:e.$t("voteDone"),type:"success"}),t.rank_score+=r):Object.keys(e.errorCodeMap).includes(String(code))?e.$message.error(e.$t(e.errorCodeMap[code])):e.$message.error(e.$t("ServerError"))}))}else this.$EventBus.$emit("openLoginDialog")},goToDetail:function(t){"model"===this.contentType?window.open("/models/detail/".concat(t.id),"_blank"):window.open("/explore/detail/".concat(t.id),"_blank")},goToPersonal:function(t){var e,n=t.author.id,o=null===(e=this.userInfo)||void 0===e?void 0:e.id,path="/user/"+encodeURIComponent(n);o==n&&(path="/personal"),window.open(path,"_blank")},dynamicList:function(t){var e=this.$parent.$refs[this.container];if(!e)return t;var n=this.scrollTop-e.offsetTop;return t.filter((function(t){return n-t.top<2e3&&t.top-n<2e3}))},updateDataList:function(t,e){var n=this,o=this.dataList,r=this.checkList,c=this.WaterFallDeleteLits,l=this.width;t.forEach((function(t){o.forEach((function(e){t.id==e.id&&(t.collect=e.collect,t.liked=e.liked)}))}));var d,h,v=t.filter((function(t){return!c.includes(t.id)}));this.isTiemRow&&(e||(this.lastTime=null));for(var i=0;i<v.length;i++){var f=v[i];if(f.timeItem)f.waterWidth=l,f.waterHeight=30;else{var m,_,y,w,C;if(this.$set(f,"hoverd",!1),this.$set(f,"propS",!1),this.$set(f,"rowIndex",-1),!r.ids.includes(f.id))r.ids.push(f.id),null!=f&&null!==(y=f.collect)&&void 0!==y&&y.id&&r.collectIds.push(f.collect.id),null!=f&&null!==(w=f.folder_no)&&void 0!==w&&w.id&&r.folderNos.push(f.folder_no.id),null!=f&&null!==(C=f.banner)&&void 0!==C&&C.url&&r.url.push(f.banner.url);f.timeDiff=Object(L.d)(f.created_at,Date.now()),f.waterWidth=l,this.isTiemRow||"gallery"===this.type?f.waterHeight=l:(d=f.banner&&f.banner.width?f.banner.width:308,h=f.banner&&f.banner.height?f.banner.height:308,f.waterHeight=parseInt(h*l/d),isNaN(f.waterHeight)&&(f.waterHeight=320)),null===(m=f.banner)||void 0===m||!m.url||null!==(_=f.banner)&&void 0!==_&&_.replaceUrl||(f.banner.replaceUrl=Object(x.K)(f.banner.url,this.imgQuality||"low")),f.errorTime=0}}e?v.forEach((function(t){n.dataList.push(t)})):this.dataList=v,this.waterfall()},handleContextMenu:function(t,e){1===e.nsfw&&t.preventDefault()},handleClick:function(t,e,n){if(this.isLoggedIn){var o=this.list.findIndex((function(i){return i.id===t.id})),r=(o<10?this.list.slice(0,o):this.list.slice(o-10,o)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));switch(e){case"创作":Object(P.i)({items:[M(M({},this.dotReportInfo),{},{negative_ids:r,action:"task"})]});var c=Object.assign({},t);"model"===this.type&&["explore","personal"].includes(this.fromPage)&&(c.taskSource=1),this.$EventBus.$emit("openGenerate",{action:1,data:{source:c}});break;case"收藏":Object(P.i)({items:[M(M({},this.dotReportInfo),{},{negative_ids:r,action:"collection"})]}),this.setCollect(t,n)}}else this.$EventBus.$emit("openLoginDialog")},handleDetail:function(t,e){if(this.$logEvent("log_actions",{operation:{artwork:"click_image",model:"click_model",gallery:"click_gallery"}[this.type],behavior_info:e.id}),"activity"!==this.type)if("IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className||"model"!==this.type)if("IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className&&"green-mode-div"!==t.target.className||"artwork"!==this.type)"IMG"!==t.target.tagName&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className||"gallery"!==this.type||(Object(P.i)({items:[{action:"view",obj_no:e.id,obj_type:4}]}),this.$router.push(this.localePath("/explore/detail/"+e.id)));else{var n=this.list.findIndex((function(i){return i.id===e.id})),o=(n<10?this.list.slice(0,n):this.list.slice(n-10,n)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(P.i)({items:[M(M({},this.dotReportInfo),{},{negative_ids:o,action:"view",obj_no:e.id,obj_type:1})]}),this.openWin?window.open("/explore/detail/"+e.id,"_blank"):this.$router.push(this.localePath("/explore/detail/"+e.id))}else 3==e.status||4==e.status?this.$router.push(this.localePath("/models/detail/".concat(e.id,"?type=other"))):this.$router.push(this.localePath("/models/detail/".concat(e.id)))},imgError:function(t){t.errorTime++,t.errorTime>=2||(this.$refs[t.id][0].src=t.banner.url)},waterfall:function(){var t=this;try{this.heights=[];for(var e=function(){var e=t.dataList[i],n=e.waterHeight;if(e.timeItem){e.left=0;var o=t.getMaxIndex(t.heights);e.top=o>-1?t.heights[o]+t.gap:0,t.heights.forEach((function(o,r){t.heights[r]=e.top+n}))}else if(t.heights.length<t.selfCols)if(t.dataList[i-1]&&t.dataList[i-1].timeItem)if(e.left=0,e.top=t.dataList[i-1].top+t.dataList[i-1].waterHeight+t.gap,t.heights[0]){var r=t.heights[0]+n;t.heights=[r+t.gap]}else t.heights.push(e.top+n);else e.top=t.dataList[i-1]?t.dataList[i-1].top:0,e.left=t.heights.length*(t.width+t.gap),t.heights.push(e.top+n);else{var c=t.getMinIndex(t.heights),l=t.heights[c]+t.topGap;e.top=l,e.left=c*(t.width+t.gap),t.heights[c]=l+n}},i=0;i<this.dataList.length;i++)e();this.setWaterFallRect()}catch(t){}},getWidth:function(){this.selfCols=this.cols;var t=this.$parent.$refs[this.container].offsetWidth;if(t){t<1700&&(this.selfCols=6),t<1500&&(this.selfCols=5),t<1240&&(this.selfCols=4),t<980&&(this.selfCols=3),t<730&&(this.selfCols=2),t<500&&this.isPC&&(this.selfCols=1);var e=~~((t-this.selfCols*this.gap-this.gap+32)/this.selfCols);return this.isPC?e>233?e:233:e>176?e:176}},setWaterFallRect:function(){var t=this.$parent.$refs[this.container],e=Math.max.apply(null,this.heights);this.list.length?(t.style.height=e+"px",t.style.marginBottom="130px"):t.style.height="0px"},getMinIndex:function(t){var e=Math.min.apply(null,t);return t.indexOf(e)},getMaxIndex:function(t){var e=Math.max.apply(null,t);return t.indexOf(e)},resize:function(t){var e=this;this.openWatch&&(this.$parent.$refs[this.container].offsetWidth<600||(this.dataList=D()(t).filter((function(t){return!e.WaterFallDeleteLits.includes(t.id)})),this.width=this.getWidth(),this.dataList.forEach((function(t){if(t.timeItem)t.waterWidth=e.width,t.waterHeight=30;else{var n,o;if(e.$set(t,"hoverd",!1),t.timeDiff=Object(L.d)(t.created_at,Date.now()),t.waterWidth=e.width,e.isTiemRow||"gallery"===e.type)t.waterHeight=e.width;else null!=t&&null!==(o=t.banner)&&void 0!==o&&o.width&&(t.waterHeight=parseInt(e.width/(t.banner.width/t.banner.height))),isNaN(t.waterHeight)&&(t.waterHeight=320);null!=t&&null!==(n=t.banner)&&void 0!==n&&n.replaceUrl&&(t.banner.replaceUrl=Object(x.K)(t.banner.url,e.imgQuality||"low")),t.errorTime=0}})),this.waterfall()))},lazyLoad:function(){if(this.actived&&this.openWatch){var t=document.documentElement.scrollHeight,e=window.innerHeight;this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset,t-this.scrollTop-e<1.5*e&&this.$emit("load")}},otherUser:function(t,e){var path=e?"/user/"+encodeURIComponent(t.author.id)+"?type=gather":"/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal?tab=gather"),this.openWin?window.open(path,"_blank"):this.$router.push(this.localePath(path))},getPersonalInfoUrl:function(t){var path="/user/"+encodeURIComponent(t.author.id);return this.userInfo.id==t.author.id&&(path="/personal"),path}})},A=(n(5181),Object(v.a)(R,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"waterfall-container"},[t._l(t.dynamicList(t.dataList),(function(n,o){var r,c,l;return e("a",{key:n.top+","+n.left+","+o,staticClass:"waterfall-item",style:{top:n.top+"px",left:n.left+"px"},attrs:{href:"model"===t.contentType?"/models/detail/"+n.id:"/explore/detail/"+n.id,target:"_blank"},on:{click:function(e){return e.preventDefault(),t.handleDetail(e,n)},contextmenu:function(e){return t.handleContextMenu(e,n)}}},[n.timeItem?e("div",{staticClass:"timeRow",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[t._v("\n      "+t._s(n.timeItem)+"\n    ")]):e("div",{staticClass:"listCnt",class:[1===n.banner.nsfw||t.isShowNsfw(n.banner)?"bg-nsfw":""]},[[2,"2"].includes(n.green)&&t.enableGreenMode?e("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}}):t._e(),t._v(" "),e("div",{staticClass:"img-content",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[e("img",{ref:n.id,refInFor:!0,staticClass:"cntImg",style:{visibility:1===(null==n||null===(r=n.banner)||void 0===r?void 0:r.nsfw)||t.isShowNsfw(n.banner)?"hidden":"visible"},attrs:{decoding:"async",src:1===(null==n||null===(c=n.banner)||void 0===c?void 0:c.nsfw)||t.isShowNsfw(n.banner)?"":null==n||null===(l=n.banner)||void 0===l?void 0:l.replaceUrl},on:{error:function(e){return t.imgError(n)},dragstart:function(t){t.preventDefault()}}})]),t._v(" "),"activity"===t.type?e("div",{staticClass:"activity",class:{langger:n.name},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToDetail(n)}}},[e("div",{staticClass:"top-container"},[e("div",{staticClass:"points"},[t._v(t._s(((null==n?void 0:n.rank_score)||0)+" "+t.$t("voteUnit")))])]),t._v(" "),e("div",{staticClass:"personal-info"},[e("div",{staticClass:"left-info",style:{width:n.name?"100%":"calc(100% - 68px)"}},[n.author?e("BaseAvatar",{staticStyle:{"margin-right":"6px"},attrs:{"user-data":n.author,size:26},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToPersonal(n)}}}):t._e(),t._v(" "),e("span",{staticClass:"ellipsis-text",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToPersonal(n)}}},[t._v("\n              "+t._s(n.author.name||n.author.id)+"\n            ")])],1),t._v(" "),e("div",{staticClass:"right-btn",class:{disabled:t.activityOver},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.voteFun(n)}}},[t._v("\n            "+t._s(t.$t("vote"))+"\n          ")])])]):t._e()])])})),t._v(" "),t.alreadyNoMoreData?e("div",{staticClass:"at-bottom"},[e("div",{staticClass:"dashed-line"}),t._v(" "),e("div",{staticClass:"tips"},[t._v(t._s(t.$t("NoMoreData")))]),t._v(" "),e("div",{staticClass:"dashed-line"})]):t._e(),t._v(" "),t.noSearchData?e("div",{staticClass:"no-search-data-container"},[e("img",{staticClass:"no-search-image",attrs:{src:n(504),alt:"no search data"}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("NoSearchData")))])]):t._e()],2)}),[],!1,null,"a7aa3d98",null)),E=A.exports;function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(A,{BaseAvatar:n(53).default});var F={name:"ActivityGallery",props:{type:{type:String,default:"model"},order:{type:String,default:""}},components:{AWaterFall:E},computed:{},data:function(){return{isLock:!1,isReq:!1,modelParam:{page:1,page_size:60,order_by:"hot",model_type:"",type:"activity"},galleryParam:{page:1,page_size:60,order_by:"hot"},list:[]}},mounted:function(){this.getList()},methods:{refresh:function(){this.galleryParam.page=1,this.isLock=!1,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var param=N(N({},this.galleryParam),{},{type:4,order_by:this.order});(0,_.e)(param).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,c;e.isLock=!(null!=n&&null!==(r=n.data)&&void 0!==r&&r.has_more);var l,d,h=[];if((null==n||null===(c=n.data)||void 0===c||null===(c=c.items)||void 0===c?void 0:c.length)>0)h=null==n||null===(l=n.data)||void 0===l?void 0:l.items.map((function(t){return N(N({},t),{},{banner:{url:t.cover,nsfw:t.nsfw,width:(null==t?void 0:t.cover_width)||0,height:(null==t?void 0:t.cover_height)||0}})}));if(t?e.list=e.list.concat(h||[]):(e.list=[],e.$nextTick((function(){e.list=h}))),e.isReq=!1,1===e.galleryParam.page)e.galleryParam.time_to=null==n||null===(d=n.data)||void 0===d?void 0:d.time_ms;e.galleryParam.page++}else e.isLock=!0})).catch((function(){e.isReq=!1}))}}}},U=(n(5182),Object(v.a)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"activity-waterfall"},[e("div",{ref:"wraper",staticClass:"wraper"},[e("AWaterFall",{ref:"AWaterFall",attrs:{type:"activity",contentType:t.type,topGap:60,cols:7,container:"wraper",list:t.list,lazy:!0,hidecollect:!0,hoverShow:!0,imgQuality:"high",alreadyNoMoreData:t.isLock},on:{load:function(e){return t.getList(!0)}}})],1)])}),[],!1,null,"128f8dc2",null).exports),H=(n(32),n(28),n(151),n(56));function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var W={name:"tabBtns",components:{ClaimDialog:n(937).a},props:{btns:{type:Array,default:function(){return[]}},order:{type:String,default:"new"}},computed:z(z(z(z({},Object(r.c)("activity",["isInActivity"])),Object(r.e)("user",["userInfo"])),Object(r.c)("user",["isLoggedIn"])),{},{getBtnName:function(){var t;return this.$t("actvtyModel"===(null===(t=this.active)||void 0===t?void 0:t.name)?"actvtyModel":"actvtyImgGallery")},inShowResultTime:function(){return Date.now()>17295552e5},isShowClaimBtn:function(){var t="production".includes("production");if(console.log("isShowClaimBtn","production",this.isLoggedIn,this.inShowResultTime),!t&&this.isLoggedIn&&this.inShowResultTime)return!0;if(this.inShowResultTime&&Date.now()<17312544e5&&t){return this.userInfo.id&&["jiuchen1","xiaogua","chaochao","longdamiao","1d236c248c47a125f6915ec2165cb67a","5690f702d7871bd3e34c268102badef7","fa6c65cd4a4edc21234b2eaa6a109499","3c939b92b2514df581dfaa8e27f89cc7","c21b73e5524935e42f7bcef072b6a984","4a8bd4a44dadca93c34893f6eee0bb5d","b726608a0462d77414a8a3f7eac56e83","3aa2932a0aa02f6e5152d94abce261d3","2e67b050a0a36fc6aaea0e2ae533d5fb"].includes(this.userInfo.id)}}}),data:function(){return{active:{name:"actvtyInfo",label:"actvtyInfo"},search:{name:"actvtyInfo",order:"new"},orders:[{name:"New",value:"new",icon:"new1"},{name:"actvtyPoint",value:"hot",icon:"icon-jilijihua"}],inModelRank:!1,inGalleryRank:!1}},mounted:function(){this.getTop10List()},methods:{openClaimDialog:function(){this.$refs.claimDialog.showDialog()},getTop10List:function(){var t=this;Object(_.g)({order_by:"hot",page:1,page_size:10}).then((function(e){var n=e||{},o=n.status,r=(void 0===o?{}:o).code,code=void 0===r?"":r,c=n.data,l=(void 0===c?{}:c).list,d=void 0===l?[]:l;1e4===code&&(t.inGalleryRank=!!d.find((function(e){var n;return(null==e||null===(n=e.data)||void 0===n||null===(n=n.author)||void 0===n?void 0:n.id)===t.userInfo.id})))}))},changeTab:function(t){console.log("changeTab",t.name),this.active=t,this.search.name=t.name,this.$emit("change",z(z({},this.search),{},{changed:!1}))},changeSort:function(t){console.log("changeSort",t.value);var e=t.value,n=this.search.order!==e;this.search.order=e,this.$emit("change",z(z({},this.search),{},{changed:n}))}}},G=(n(5183),Object(v.a)(W,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"tab-btns flex"},[o("div",{staticClass:"tab-content flex"},n._l(n.btns,(function(t,e){return o("div",{directives:[{name:"show",rawName:"v-show",value:3!==e||n.inShowResultTime,expression:"index !== 3 || inShowResultTime"}],key:"tab_".concat(e),staticClass:"tab-btn",class:{active:n.active.name===t.name},on:{click:function(e){return n.changeTab(t)}}},[n._v("\n      "+n._s(null!=t&&t.label_name?n.$t(t.label,{name:n.$t(null==t?void 0:t.label_name)}):n.$t(t.label))+"\n    ")])})),0),n._v(" "),o("div",{staticClass:"right"},[null!==(t=n.active)&&void 0!==t&&t.showSort?o("div",{staticClass:"order-content flex items-center"},n._l(n.orders,(function(t,e){return o("div",{key:"order_".concat(e),staticClass:"order-btn",class:{active:n.order===t.value},on:{click:function(e){return n.changeSort(t)}}},[o("i",{staticClass:"iconfont",class:"icon-".concat(t.icon)}),n._v(" "+n._s(n.$t(t.name))+"\n      ")])})),0):n._e(),n._v(" "),n.isShowClaimBtn?o("div",{staticClass:"claim-btn",on:{click:n.openClaimDialog}},[n._v(n._s(n.$t("vip_invite_dialog_btn"))+" "),o("i",{staticClass:"el-icon-d-arrow-right"})]):n._e()]),n._v(" "),o("claim-dialog",{ref:"claimDialog",attrs:{type:"actvtyImgGallery"===(null===(e=n.active)||void 0===e?void 0:e.name)?1:2}})],1)}),[],!1,null,"0d0e7708",null).exports),Y=(n(27),n(36));function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var X={name:"joinDialog",props:{},computed:J(J({},Object(r.e)("user",["userInfo"])),{},{clickItem:function(){var t=this;return function(e){var n,o;return"model"===t.type?(null===(n=t.clickedmodel)||void 0===n?void 0:n.id)===(null==e?void 0:e.id):(null===(o=t.clickedGallery)||void 0===o?void 0:o.id)===(null==e?void 0:e.id)}}}),data:function(){return{dialogVisible:!1,loading:!1,type:"gallery",noMoreGalllery:!1,noMoreModel:!1,clickedmodel:{},clickedGallery:{},joinedmodel:{},joinedGallery:{},modelList:[],galleryList:[],comfyuiList:[],modelParam:{page:1,page_size:20,keyword:"",order_by:"new",publish_status:1,model_types:["LORA"],base_models:[],sub_channel:"activity"},galleryParam:{page:1,page_size:35,after:0,type:"bookmarks",order_by:"new",category:2,sub_type:"activity"}}},mounted:function(){},methods:{showDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gallery";this.getJoined(),this.type=t,console.log("showDialog",t),"model"===t?this.getModelList():this.getGalleryList(),this.dialogVisible=!0},closeDialog:function(){this.galleryParam.page=1,this.modelParam.page=1,this.galleryParam.time_to=0,this.galleryParam.after=0,this.dialogVisible=!1,this.clickedmodel={},this.clickedGallery={},Reflect.deleteProperty(this.modelParam,"time_to")},getJoined:function(){var t=this;Object(_.h)().then((function(e){var n,o,r;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.joinedmodel=(null==e||null===(o=e.data)||void 0===o?void 0:o.model)||{},t.joinedGallery=(null==e||null===(r=e.data)||void 0===r?void 0:r.artwork)||{})}))},submitApply:function(){var t,e,n=this,data={type:"model"===this.type?2:4,item_id:"model"===this.type?null===(t=this.clickedmodel)||void 0===t?void 0:t.id:null===(e=this.clickedGallery)||void 0===e?void 0:e.id};console.log("参与参数",data),data.item_id?Object(_.c)(data).then((function(t){var e;1e4===(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&(n.$message({message:n.$t("Participated"),type:"success"}),n.getJoined())})):this.$message.info(this.$t("Pls_select"))},changeType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gallery";this.type=t,"model"===this.type?!this.modelList.length&&this.getModelList():!this.galleryList.length&&this.getGalleryList()},getModelList:function(){var t,e=this;this.loading||this.noMoreModel||(this.loading=!0,this.modelParam.account_no=null===(t=this.userInfo)||void 0===t?void 0:t.id,Object(H.m)(this.modelParam).then((function(t){var n,o,r;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var c;if(e.modelList=e.modelList.concat((null==t||null===(o=t.data)||void 0===o?void 0:o.items)||[]),console.log("获取模型",e.modelList),1===e.modelParam.page)e.modelParam.time_to=null==t||null===(c=t.data)||void 0===c?void 0:c.time_ms;e.modelParam.page++,null!=t&&null!==(r=t.data)&&void 0!==r&&r.has_more||(e.noMoreModel=!0)}})).finally((function(){e.loading=!1})))},getGalleryList:function(){var t=this;this.loading||this.noMoreGalllery||(this.loading=!0,Object(Y.artworkList)(this.galleryParam).then((function(e){var n,o,r;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var c;if(t.galleryList=t.galleryList.concat((null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[]),1===t.galleryParam.page&&e.data.time_ms&&(t.galleryParam.time_to=e.data.time_ms),e.data.items.length>0)t.galleryParam.after=null===(c=e.data.items[e.data.items.length-1])||void 0===c||null===(c=c.folder_no)||void 0===c?void 0:c.collect_at;t.galleryParam.page++,null!=e&&null!==(r=e.data)&&void 0!==r&&r.has_more||(t.noMoreGalllery=!0)}})).finally((function(){t.loading=!1})))},handleScroll:function(){var content=this.$refs.scrollContent,t=this.$refs.scrollItems;content.scrollTop+content.clientHeight>=t.clientHeight&&("model"===this.type?this.getModelList():this.getGalleryList())},handleClickItem:function(t){"model"===this.type?this.clickedmodel=t:this.clickedGallery=t},handleSubmit:function(){var t,e,n=this;("model"===this.type?null===(t=this.joinedmodel)||void 0===t?void 0:t.id:null===(e=this.joinedGallery)||void 0===e?void 0:e.id)?"model"===this.type?this.submitApply():this.$confirm(this.$t("actvtyReplaceTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"ai-face-swap-confirm"}).then((function(){n.submitApply()})):this.submitApply()},goCreate:function(){this.dialogVisible=!1,"model"===this.type?window.open(this.localePath("/loraTrainingEdit?defaultType=FLUX"),"_blank"):this.$EventBus.$emit("openGenerate",{action:1,data:{source:{id:"5c4f26337a770760d2d6d2288d7e4698",name:"FLUX",nsfw:0,cover:"https://image2.cdn.seaart.me/static/cc6b8368cf3e511874abdeb8c3c4e4ad/1722959506726/aaab49023af1f1abbc75687dac463baa.jpeg",cover_width:832,cover_height:1216,desc:"",base_model:"Flux.1 D",model_ver_no:"86f5b35dcf257ab74b9fa00a8bbf0da3",model_ver_nos:[{id:"86f5b35dcf257ab74b9fa00a8bbf0da3",version_name:"Dev",same:{primary:1,train_model_no:""}},{id:"ea3e7ba4a5525c1b57abb644a61a92c2",version_name:"Schnell",same:{primary:1,train_model_no:""}}],version_name:"Dev",type:"Checkpoint",ver:"Dev",samples:[{id:"419a117bbf4642b8e7cc9f5f4a9a22a5",url:"https://image2.cdn.seaart.me/static/cc6b8368cf3e511874abdeb8c3c4e4ad/1722959506726/aaab49023af1f1abbc75687dac463baa.jpeg",nsfw:2,width:832,height:1216,meta:{extra_prompt:"",prompt:'a digital illustration of a movie poster titled "Finding Emo", finding nemo parody poster, featuring a depressed cartoon clownfish with black emo hair, eyeliner, and piercings, bored expression, swimming in a dark underwater scene, in the background, movie title in a dripping, grungy font, moody blue and purple color palette',width:832,height:1216,steps:25,sampler_name:"Euler",seed:419750308183444,lora_models:null,hi_res_arg:null,smart_edit:null,guidance_scale:0,left_margin:0,up_margin:0,image:"",images:null,vae:"None",refiner_mode:0,lcm_mode:0,embeddings:null,generate:null},generation_process:"",collect:null,task_operation:{is_make_variations:!0,is_img_2_img:!1,is_upscale:!1,is_extra_upscale:!0,is_remove_background:!0,is_animation:!1},green:1}],create_at:1724250509247,update_at:1724472739064,meta:null,stat:{num_of_like:0,num_of_collection:52,num_of_task:19516,num_of_view:309,rating:0,num_of_download:17,num_of_comment:1},tags:[{id:"base model",title:"Base Model",cover:"",is_collect:!1,show_in:0},{id:"flux.1",title:"flux.1",cover:"",is_collect:!1,show_in:0},{id:"flux",title:"FLUX",cover:"",is_collect:!1,show_in:0},{id:"flux",title:"FLUX",cover:"",is_collect:!1,show_in:0}],categories:null,trained_words:null,author:{id:"4381edef94419e64163cacd019f70ac8",head:"",is_follow:!1,name:"CheemsAI",status:1,follower_cnt:4,is_active:!1,join_stimulate:0},collect:null,refer:"https://civitai.com/models/618692",channel:5,file_id:"12698f6ab4a2d63e65dc1b15e749d6f7",publish_status:1,status:1,audit_status:null,origin_model:null,download:1,commercial:2,mix:2,allow_use_in_haiyi:1,allow_sell:1,allow_resell:2,is_agency_fee:!1,agency_fee:0,payment_way:0,allow_creation:0,interaction:{rating:0,rating_time:0},train_param:{epoch:0,step:0,clip_skip:0}}}})}}},Q=X;n(5184);function Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var et={name:"activityIndex",components:{ActivityHome:f,ActivityModels:k,ActivityGallery:U,TabBtns:G,joinDialog:Object(v.a)(Q,(function(){var t,e,n,o,r,c,l,d,h=this,v=h._self._c;return h.dialogVisible?v("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:h.loading,expression:"loading"}],staticClass:"active-join-dialog custom-dialog",attrs:{visible:h.dialogVisible,title:h.$t("actvtyJoin"),width:"1124px","close-on-click-modal":!1,"before-close":h.closeDialog,"destroy-on-close":!0},on:{"update:visible":function(t){h.dialogVisible=t}}},[v("div",{staticClass:"select flex"},[v("el-button",{staticClass:"tab-btn",class:{"tab-active":"model"!==h.type},attrs:{type:"text"},on:{click:function(t){return h.changeType("gallery")}}},[h._v("\n      "+h._s(h.$t("actvtyUseKey",{name:h.$t("Image")}))+"\n    ")]),h._v(" "),v("el-button",{staticClass:"tab-btn",class:{"tab-active":"model"===h.type},attrs:{type:"text"},on:{click:function(t){return h.changeType("model")}}},[h._v("\n      "+h._s(h.$t("actvtyUseKey",{name:h.$t("LoRA")}))+"\n    ")])],1),h._v(" "),v("div",{staticClass:"info flex items-center"},[v("span",{staticClass:"title"},[h._v("\n      "+h._s("model"===h.type?h.$t("selecKey",{name:h.$t("LoRA")}):h.$t("selecKey",{name:h.$t("Image")}))+"\n    ")]),h._v(" "),v("span",{staticClass:"txt flex items-center"},[v("i",{staticClass:"iconfont icon-warningTip icon"}),h._v("\n      "+h._s("model"===h.type?h.$t("actvtySelectTip3",{name:h.$t("LoRA")}):h.$t("actvtySelectTip"))+"\n    ")])]),h._v(" "),v("div",{ref:"scrollContent",staticClass:"select-content",on:{scroll:h.handleScroll}},[v("div",{ref:"scrollItems",staticClass:"select-items flex flex-wrap"},[v("div",{staticClass:"create-item item flex flex-col justify-center items-center",on:{click:h.goCreate}},[[v("i",{staticClass:"iconfont icon-add-icon icon"}),h._v(" "),v("span",{staticClass:"txt"},[h._v(h._s("model"===h.type?h.$t("Create"):h.$t("Generate")))])]],2),h._v(" "),[v("div",{directives:[{name:"show",rawName:"v-show",value:(null===(t=h.joinedmodel)||void 0===t?void 0:t.id)&&"model"===h.type,expression:"joinedmodel?.id && type === 'model'"}],staticClass:"model-item item flex flex-col items-center"},[null!==(e=h.joinedmodel)&&void 0!==e&&e.uri?v("img",{directives:[{name:"webp",rawName:"v-webp"}],staticClass:"item-cover",attrs:{src:null===(n=h.joinedmodel)||void 0===n?void 0:n.uri,alt:"model_cover"}}):h._e(),h._v(" "),v("div",{staticClass:"added-btn"},[h._v("\n            "+h._s(h.$t("Competing"))+"\n          ")]),h._v(" "),v("div",{staticClass:"text text-no-wrap"},[h._v(h._s(h.joinedmodel.model_name))])]),h._v(" "),h._l(h.modelList,(function(t,e){var n,o,r;return v("div",{directives:[{name:"show",rawName:"v-show",value:"model"===h.type&&h.modelList.length,expression:"type === 'model' && modelList.length"}],key:"model-item_".concat(e),staticClass:"model-item item flex flex-col items-center",class:{"joined-hidden":(null===(n=h.joinedmodel)||void 0===n?void 0:n.id)===(null==t?void 0:t.id),clicked:h.clickItem(t)},on:{click:function(e){return h.handleClickItem(t)}}},[null!=t&&t.cover?v("img",{directives:[{name:"webp",rawName:"v-webp"}],staticClass:"item-cover",attrs:{src:null==t?void 0:t.cover,alt:"model_cover"}}):h._e(),h._v(" "),null!=t&&null!==(o=t.art_model)&&void 0!==o&&o.name?v("div",{staticClass:"text text-no-wrap"},[h._v(h._s(null==t||null===(r=t.art_model)||void 0===r?void 0:r.name))]):h._e()])}))],h._v(" "),[v("div",{directives:[{name:"show",rawName:"v-show",value:(null===(o=h.joinedGallery)||void 0===o?void 0:o.id)&&"gallery"===h.type,expression:"joinedGallery?.id && type === 'gallery'"}],staticClass:"gallery-item item flex flex-col items-center"},[null!==(r=h.joinedGallery)&&void 0!==r&&r.uri?v("img",{directives:[{name:"webp",rawName:"v-webp"}],staticClass:"item-cover",attrs:{src:null===(c=h.joinedGallery)||void 0===c?void 0:c.uri,alt:"gallery_cover"}}):h._e(),h._v(" "),v("div",{staticClass:"added-btn"},[h._v("\n            "+h._s(h.$t("Competing"))+"\n          ")])]),h._v(" "),h._l(h.galleryList,(function(t,e){var n,o,r;return v("div",{directives:[{name:"show",rawName:"v-show",value:"gallery"===h.type&&h.galleryList.length,expression:"type === 'gallery' && galleryList.length"}],key:"gallery-item_".concat(e),staticClass:"gallery-item item flex flex-col items-center",class:{"joined-hidden":(null===(n=h.joinedGallery)||void 0===n?void 0:n.id)===(null==t?void 0:t.id),clicked:h.clickItem(t)},on:{click:function(e){return h.handleClickItem(t)}}},[null!=t&&null!==(o=t.banner)&&void 0!==o&&o.url?v("img",{directives:[{name:"webp",rawName:"v-webp"}],staticClass:"item-cover",attrs:{src:null==t||null===(r=t.banner)||void 0===r?void 0:r.url,alt:"gallery_cover"}}):h._e(),h._v(" "),null!=t&&t.name?v("div",{staticClass:"text flex items-center text-no-wrap"},[h._v(h._s(t.name))]):h._e()])}))]],2)]),h._v(" "),v("div",{staticClass:"submit-content"},["model"===h.type?v("div",{staticClass:"submit-btn",on:{click:h.handleSubmit}},[h._v("\n      "+h._s(null!==(l=h.joinedmodel)&&void 0!==l&&l.id?h.$t("actvtyReplaceBtn2",{name:h.$t("LoRA")}):h.$t("actvtySubmitBtn"))+"\n    ")]):v("div",{staticClass:"submit-btn",on:{click:h.handleSubmit}},[h._v("\n      "+h._s(null!==(d=h.joinedGallery)&&void 0!==d&&d.id?h.$t("actvtyReplaceBtn"):h.$t("actvtySubmitBtn"))+"\n    ")])])]):h._e()}),[],!1,null,"32665706",null).exports},props:{},computed:tt(tt(tt({},Object(r.c)("user",["cdnHostFun","isLoggedIn"])),Object(r.e)("user",["cdnHost"])),{},{langKey:function(){return console.log("this.$i18n.locale",this.$i18n.locale),this.$i18n.locale.startsWith("zh")?"zh":this.$i18n.locale.startsWith("ja")?"jp":"en"},topImg:function(){return"https://".concat(this.cdnHost,"/static/fluxsecond/").concat(this.langKey,"/web1.png")},activityOver:function(){return new Date>17294688e5},getBtnBG:function(){return"https://".concat(this.cdnHost,"/static/fluxsecond/").concat(this.langKey,"/web4.png")}}),provide:function(){return{activityOver:this.activityOver}},data:function(){return{active:"actvtyInfo",threshold:0,order:"new",tabs:[{name:"actvtyInfo",label:"actvtyInfo"},{name:"actvtyImgGallery",label:"contest_artwork",showSort:!0},{name:"actvtyModel",label:"contest_key",label_name:"LoRA"},{name:"actvtyResult",label:"actvtyResult"}]}},mounted:function(){var t=this;window.addEventListener("scroll",this.onScroll),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("scroll",t.onScroll)}))},methods:{changeTabs:function(data){var t=this,e=data.name,n=data.order,o=data.changed;this.active=e||this.active,this.order=n||this.order,console.log("changeTabs",this.active,this.order,"changed:",o),this.$nextTick((function(){"actvtyModel"===t.active&&o?t.$refs.model.refresh():"actvtyImgGallery"===t.active&&o&&t.$refs.gallery.refresh()}))},onScroll:function(){var t,e,n=this.$refs["sticky-ele"],rect=null===(t=this.$refs.outer)||void 0===t?void 0:t.getBoundingClientRect();if(n&&rect){var o=null==n||null===(e=n.getBoundingClientRect())||void 0===e?void 0:e.top;if(n){var r="sticky";o-72<=0&&rect.top<=-416?n.classList.add(r):n.classList.remove(r)}}},handleJoinBtnClick:function(){if(!this.activityOver)if(this.isLoggedIn){var t="actvtyModel"===this.active?"model":"gallery";this.$refs["join-dialog"].showDialog(t)}else this.$EventBus.$emit("openLoginDialog")}}},it=(n(5185),Object(v.a)(et,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"activity-index"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{ref:"outer",staticClass:"top"},[e("div",{staticClass:"top-img"},[t.topImg?e("img",{attrs:{src:t.topImg,alt:"topImg"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}}):t._e()]),t._v(" "),e("div",{ref:"sticky-ele",staticClass:"join-btn-content flex"},[e("div",{staticClass:"join-btn flex justify-center items-center",class:{disabled:t.activityOver},style:{backgroundImage:"url("+t.getBtnBG+")"},on:{click:t.handleJoinBtnClick}})])]),t._v(" "),e("div",{ref:"sticky-ele",staticClass:"tab-content w-full"},[e("tab-btns",{attrs:{btns:t.tabs,order:t.order},on:{change:function(e){return t.changeTabs(e)}}})],1),t._v(" "),e("ActivityHome",{directives:[{name:"show",rawName:"v-show",value:"actvtyInfo"===t.active,expression:"active === 'actvtyInfo'"}],attrs:{galleryIndex:0}}),t._v(" "),e("ActivityHome",{directives:[{name:"show",rawName:"v-show",value:"actvtyResult"===t.active,expression:"active === 'actvtyResult'"}],attrs:{galleryIndex:2}}),t._v(" "),"actvtyModel"===t.active?e("ActivityModels",{ref:"model",attrs:{type:"model",order:t.order}}):t._e(),t._v(" "),"actvtyImgGallery"===t.active?e("ActivityGallery",{ref:"gallery",attrs:{type:"gallery",order:t.order}}):t._e(),t._v(" "),e("joinDialog",{ref:"join-dialog"})],1)}),[],!1,null,"37aaf0ba",null));e.default=it.exports},5742:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(8),n(7);var o=n(3),r=n(2),c=(n(20),n(19),n(6),n(22),n(18),n(4),n(28),n(43),n(44),n(3395)),l=n(10),d=n(38),h=n(39),v=n(1),f=n(409),m=n(14),_=(n(50),n(16),n(49),n(21),n(90),n(9)),y=n(368),w=n(476);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"AiChatLastList",components:{ConfirmModal:y.a,AiChatEditForm:w.a},props:{characterId:{type:String,default:""},historyStack:{type:Array,default:function(){return[]}},onlyBack:{type:Boolean,default:!1},fromPage:{type:String,default:""}},data:function(){return{formatTimestamp:_.V,editIndex:null,curHandle:"edit",isShowLast:!1,editForm:{title:"",id:""},manageMenu:[{title:"Edit",icon:"icon-icon-edit2",key:"edit"},{title:"Delete",icon:"icon-icon-delete",key:"delete"}]}},computed:k(k({},Object(v.c)("character",["characterInfo"])),{},{lastChatList:{get:function(){var t;return(null===(t=this.characterInfo)||void 0===t?void 0:t.latest_session)||[]},set:function(t){this.characterInfo&&(this.characterInfo.latest_session=t)}}}),methods:{handleActions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("更多操作--",data);var e=data.session_id,n=void 0===e?"":e;switch(this.curHandle=t,this.$logEvent("log_actions",{operation:"click_".concat(t),behavior_info:"on_tarven_detail_page",behavior_info_sub:"last_chat"}),this.editIndex=this.lastChatList.findIndex((function(t){return t.session_id===n})),t){case"edit":this.editForm.title=data.name||data.session_title||this.formatTimestamp(data.latest_at),this.editForm.id=data.session_id,this.$refs.confirmModal.show({title:this.$t("lastChatEditTitle"),customClose:!0});break;case"delete":this.editForm.id=data.session_id,this.$refs.confirmModal.show({subTitle:this.$t("lastChatDelTitle"),mainTitle:this.$t("lastChatDelMainTitle"),handleMethods:"Del"})}},submitForm:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,h,title,v,f,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t.editForm)||void 0===n||!n.id||"delete"!==t.curHandle){e.next=6;break}return e.next=3,Object(d.l)({id:null===(r=t.editForm)||void 0===r?void 0:r.id});case 3:return l=e.sent,1e4===(null===(c=l.status)||void 0===c?void 0:c.code)&&(null!==t.editIndex&&(t.delChatHandle(t.editIndex),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose()),e.abrupt("return");case 6:return e.next=8,t.$refs.editFormComponent.validate();case 8:if(h=e.sent,title=(null===(o=t.$refs.editFormComponent.form)||void 0===o?void 0:o.title)||"",!h||!title||"edit"!==t.curHandle){e.next=15;break}return e.next=13,Object(d.q)({title:title,id:null===(v=t.editForm)||void 0===v?void 0:v.id});case 13:_=e.sent,1e4===(null===(f=_.status)||void 0===f?void 0:f.code)&&(null!==t.editIndex&&((y=Object(m.a)(t.characterInfo.latest_session))[t.editIndex]=k(k({},y[t.editIndex]),{},{session_title:title}),t.$set(t.characterInfo,"latest_session",y),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose());case 15:case"end":return e.stop()}}),e)})))()},delChatHandle:function(t){if(console.log("delChatHandle",t),this.$route.query.s_id===this.lastChatList[t].session_id)if(1===this.lastChatList.length){var e=Object(m.a)(this.characterInfo.latest_session);e.splice(t,1),this.$set(this.characterInfo,"latest_session",e),this.$emit("updateSession",{character_id:this.characterId,session_id:""}),this.isShowLast=!1}else{var n=Object(m.a)(this.characterInfo.latest_session);n.splice(t,1),this.$set(this.characterInfo,"latest_session",n),this.changeAiChat(this.lastChatList[0])}},resetForm:function(){var t;this.editIndex=null,null===(t=this.$refs.editFormComponent)||void 0===t||t.resetForm()},handleClickNewChat:function(){this.$logEvent("log_actions",{operation:"click_create_new_chat",behavior_info:"on_tarven_detail_page"}),this.isShowLast=!1,this.$route.name.startsWith("CharacterDetail")?this.$parent.goChat(-1):this.$parent.newChat()},goback:function(){if(1!==window.history.length){var t=this.historyStack.pop();if(this.onlyBack)this.$router.go(-1);else if(t){var e=t.split("/")[3]||"",n=/\d/.test(e);if(t.includes("source=work"))return this.$router.replace(this.localePath("/cyberPub")),!1;if(t.includes("?quickChat=true"))return this.$router.go(-2),!1;if(e)return n?this.$router.go(-1):this.$router.go(-2),!1;this.$router.go(-1)}else this.$router.go(-1)}else{var o=this.localePath("/");this.$router.push(o)}},changeAiChat:function(t){var e=this.characterInfo.id,n=t.session_id;"chatDetail"===this.fromPage?this.$logEvent("log_actions",{operation:"click_last_chat",behavior_info:"on_tavern_detail_page"}):this.$logEvent("log_actions",{operation:"tavern_on_chat_detail_page",behavior_info:"click_recent_chat"}),this.isShowLast=!1,this.$emit("updateSession",{character_id:e,session_id:n})}}},x=O,I=(n(5135),n(0)),component=Object(I.a)(x,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"aichat-last"},[n("i",{staticClass:"el-icon-back",on:{click:function(t){return t.stopPropagation(),e.goback.apply(null,arguments)}}}),e._v(" "),n("div",{staticClass:"last-panel",class:{"off-panel":e.isShowLast}},[n("div",{staticClass:"last-title flex-between",on:{click:function(t){e.isShowLast=!e.isShowLast}}},[e._v("\n      "+e._s(e.$t("LastChat"))+"\n      "),n("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),e.isShowLast&&null!==(t=e.lastChatList)&&void 0!==t&&t.length?n("div",{staticClass:"last-list"},[n("div",{staticClass:"inner-last-list start-new-chat",on:{click:e.handleClickNewChat}},[n("i",{staticClass:"new-chat-btn iconfont icon-icon_xinjianshuziren"}),e._v(" "),n("span",[e._v(e._s(e.$t("StartNewChat")))])]),e._v(" "),e._l(e.lastChatList,(function(t,i){var o,r;return n("div",{key:"lastAiChat_"+i,staticClass:"inner-last-list",class:{"inner-last-list-active":t.session_id===(null===(o=e.$route.query)||void 0===o?void 0:o.s_id)}},[n("span",{staticClass:"avatar",style:{backgroundImage:"url(".concat(null===(r=e.characterInfo)||void 0===r||null===(r=r.cover)||void 0===r?void 0:r.url,")")},on:{click:function(n){return e.changeAiChat(t)}}}),e._v(" "),n("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[n("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[e._v("\n            "+e._s(t.session_title||t.name||e.formatTimestamp(t.latest_at))+"\n          ")]),e._v(" "),n("span",{staticClass:"time overflow-ellipsis",on:{click:function(n){return e.changeAiChat(t)}}},[e._v("\n            "+e._s(t.session_title||t.name||e.formatTimestamp(t.latest_at))+"\n          ")])]),e._v(" "),n("el-popover",{ref:"myPopover",refInFor:!0,attrs:{trigger:"hover",placement:"top-start","popper-class":"popover-information","append-to-body":!1,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"167"}},[n("div",{staticClass:"pop-btns"},e._l(e.manageMenu,(function(o){return n("div",{key:o.key,staticClass:"pop-btns-item",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),e.handleActions(o.key,t)}}},[n("i",{staticClass:"iconfont",class:o.icon}),e._v(" "),n("span",{staticClass:"pop-btns-text"},[e._v(e._s(e.$t(o.title)))])])})),0),e._v(" "),n("div",{staticClass:"el-icon-more-box",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"el-icon-more"})])])],1)}))],2):e._e()]),e._v(" "),n("ConfirmModal",{ref:"confirmModal",attrs:{dialogWidth:"edit"===e.curHandle?560:462},on:{confirm:e.submitForm,cancel:e.resetForm}},["edit"===e.curHandle?n("template",{slot:"custom_content"},[n("AiChatEditForm",{ref:"editFormComponent",attrs:{formObj:e.editForm}})],1):e._e()],2)],1)}),[],!1,null,"4c1055b6",null),S=component.exports,D=n(45),L=n(93);function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={name:"FigureImg",computed:j(j({},Object(v.c)("character",["characterInfo"])),{},{isFigureImgFull:function(){var t;return(null===(t=this.characterInfo)||void 0===t||null===(t=t.vision)||void 0===t||null===(t=t.bg)||void 0===t?void 0:t.url)||!1}}),data:function(){return{imgLoading:!1}},methods:{handleImgLoad:function(){this.imgLoading=!0}}},T=(n(5136),Object(I.a)($,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"figure-img flex-center",class:{"show-img":n.imgLoading}},[null!==(t=n.characterInfo)&&void 0!==t&&null!==(t=t.vision)&&void 0!==t&&null!==(t=t.character)&&void 0!==t&&t.url?o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgH,expression:"$imgH"}],attrs:{src:null===(e=n.characterInfo)||void 0===e||null===(e=e.vision)||void 0===e||null===(e=e.character)||void 0===e?void 0:e.url,alt:n.categories+","+n.characterInfo.evaluation},on:{load:n.handleImgLoad}}):n._e()])}),[],!1,null,"f6a64892",null).exports),M=(n(77),n(63)),R=n(1186),A=n(257),E=n(206),B={name:"AiChatDelChatPopup",data:function(){return{isShowPopup:!1,loading:!1,submitEvent:null,session_id:""}},methods:{open:function(t,e){this.submitEvent=e,this.session_id=t,this.isShowPopup=!0},close:function(){this.isShowPopup=!1},submit:function(){var t=this;this.loading=!0,Object(E.d)({id:this.session_id}).then((function(e){t.submitEvent&&t.submitEvent(e),t.$message.success(t.$t("deleteSuccess")),t.close()})).finally((function(){t.loading=!1}))}}},N=(n(5138),Object(I.a)(B,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog delchat-popup",attrs:{visible:t.isShowPopup,"append-to-body":!0,"before-close":t.close},on:{"update:visible":function(e){t.isShowPopup=e}}},[e("div",{staticClass:"popup-body"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-Vector"}),t._v(t._s(t.$t("DelAiChatTitle")))]),t._v(" "),e("div",{staticClass:"popup-desc"},[t._v("\n      "+t._s(t.$t("DelAiChatDesc1"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"handle-btn",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",attrs:{type:"default"},on:{click:t.close}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"submit-btn",attrs:{type:"default",loading:t.loading},on:{click:t.submit}},[t._v(t._s(t.$t("Confirm")))])],1)])}),[],!1,null,"0d28393a",null).exports),F=n(58),U=n(576);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z={name:"FigureInfo",mixins:[D.a],components:{AiChatReport:A.a,AiChatDelChatPopup:N,CommentDrawer:R.default,CollectPopover:M.default,ShareChatDialog:U.default},filters:{formatNumberForeign:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(l.p)(t)},TimeFormat:function(t){var e=new Date(t),n=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),r=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0");return"".concat(n,"/").concat(o," ").concat(r,":").concat(c)}},data:function(){return{lastOff:!1,formatEvaluation:L.e,loading:!1,formatNumberForeign:l.p,typeKey:"character"}},computed:V(V(V({},Object(v.c)("character",["characterInfo"])),Object(v.c)("user",["userInfo"])),{},{renderCharacterName:function(){return Object(L.h)(this,this.characterInfo)},isOwner:function(){var t,e,n,o;return!(null===(t=this.characterInfo)||void 0===t||null===(t=t.author)||void 0===t||!t.id||null===(e=this.userInfo)||void 0===e||!e.id)&&(null===(n=this.characterInfo)||void 0===n||null===(n=n.author)||void 0===n?void 0:n.id)===(null===(o=this.userInfo)||void 0===o?void 0:o.id)},createTime:function(){var t;return Object(F.h)(null===(t=this.characterInfo)||void 0===t?void 0:t.create_at)},tagUrl:function(){var t=this;return function(e){return t.localePath("/tagInfo/".concat(e))}},authorUrl:function(){var t=(this.characterInfo||{}).author;return this.isOwner?this.localePath("/personal"):this.localePath("/user/".concat(null==t?void 0:t.id))},isPrivate:function(){return 2===this.characterInfo.publish_status},isNext:function(){var t=this.characterInfo.latest_session;return Boolean(null==t?void 0:t.length)}}),methods:V(V({},Object(v.d)("character",["SET_CHARACTER_INFO"])),{},{share:function(){var t;Object(h.i)({items:[{action:"share",obj_no:this.characterInfo.id,obj_type:9}]}),this.$logEvent("log_actions",{operation:"tavern_on_detail_page",behavior_info:"click_share"});var e=this.renderCharacterName,n=this.characterInfo;this.$refs.shareChatDialog.show(location.href,null==n||null===(t=n.cover)||void 0===t?void 0:t.url,e,"".concat(e," seaart"))},handleUpdateCountNum:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this.characterInfo,t);this.SET_CHARACTER_INFO(e)},openReport:function(){this.$logEvent("log_actions",{operation:"tavern_on_detail_page",behavior_info:"click_report"}),this.$refs.aiChatReport.open()},edit:function(){var t;this.$router.push(this.localePath("/cyberPubPage/new-character?id="+(null===(t=this.characterInfo)||void 0===t?void 0:t.id)))},openDelPopup:function(t){var e=this,n=this.characterInfo.latest_session[t].session_id;this.$refs.delChatPopup.open(n,(function(){e.characterInfo.latest_session.splice(t,1)}))},removeRole:function(t){var e=this;Object(E.c)({id:t.id}).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){try{var o;null===(o=e.$refs.lastChat)||void 0===o||o.goback()}catch(t){}e.$message.success(e.$t("deleteSuccess"))}}))},handleDelete:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm(this.$t("DelAiChatDesc"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.removeRole(e)}))},handleMark:function(){this.isLoggedIn?(this.logEvent("click_collect"),"icon-collect_selected"===this.setCollectData(this.characterInfo)?(this.$refs.collectPopover.visible=!1,this.setCollect(this.characterInfo,this.typeKey)):this.$refs.collectPopover.visible=!0):this.$EventBus.$emit("openLoginDialog")},logEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"on_tavern_detail_page";this.$logEvent("log_actions",{operation:t,behavior_info:e})},openCommentModal:function(){var t;console.log("openCommentModal",this.characterInfo),this.logEvent("click_chat"),null===(t=this.$refs.commentDrawer)||void 0===t||t.openModal(this.characterInfo)},goToCreationCenter:function(){this.$logEvent("log_actions",{operation:"click_creator_revenue_center",behavior_info:location.href}),this.$router.push("/creationCenter")},goChat:function(t){console.log("goChat-figureInfo",t),this.$emit("goChat",t)}})},W=z,G=(n(5140),Object(I.a)(W,(function(){var t,e,n,o,r,c,l,d,h,v,f,m=this,_=m._self._c;return _("div",{staticClass:"figure-info"},[_("div",{staticClass:"info-panel"},[_("div",{staticClass:"info-title"},[_("h1",{attrs:{title:m.renderCharacterName}},[m._v(m._s(m.renderCharacterName))])]),m._v(" "),_("div",{staticClass:"info-by"},[_("div",{directives:[{name:"show",rawName:"v-show",value:"import"!==(null===(t=m.characterInfo)||void 0===t?void 0:t.source),expression:"characterInfo?.source !== 'import'"}],staticClass:"original-tag",on:{click:m.goToCreationCenter}},[_("svg-icon",{attrs:{"icon-class":"modelOriginal"}}),m._v(" "),_("div",{staticClass:"txt"},[m._v(m._s(m.$t("Original")+" - "+m.$t("motivatingTitle")))])],1),m._v(" "),_("span",{staticClass:"author-name"},[m._v("\n        @\n        "),_("a",{staticClass:"author-name-link",attrs:{href:m.authorUrl,target:"_blank"}},[m._v(m._s(null===(e=m.characterInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.name))])])]),m._v(" "),_("div",{staticClass:"info-num"},[_("i",{staticClass:"iconfont icon-users-solid info-num-icon"}),m._v("\n      "+m._s(m._f("formatNumberForeign")((null===(n=m.characterInfo)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_token)||0))+"\n      "),_("span",{directives:[{name:"show",rawName:"v-show",value:m.createTime,expression:"createTime"}],staticClass:"info-num-time"},[m._v(m._s(m.$t("createdOn"))+m._s(m.createTime))])]),m._v(" "),_("div",{staticClass:"info-tag"},m._l(null===(o=m.characterInfo)||void 0===o?void 0:o.categories,(function(t){return _("a",{key:"tag_"+t.id,attrs:{href:m.tagUrl(t.id),target:"_blank"}},[m._v(m._s(t.name))])})),0),m._v(" "),_("div",{staticClass:"info-desc hide-scrollbar",domProps:{innerHTML:m._s(m.formatEvaluation(null===(r=m.characterInfo)||void 0===r?void 0:r.evaluation))}}),m._v(" "),_("div",{staticClass:"info-handle"},[_("span",{staticClass:"comment-btn"},[_("i",{staticClass:"iconfont icon-browse comment-btn-icon"}),m._v(" "),_("span",{staticClass:"comment-btn-text"},[m._v(m._s(m._f("formatNumberForeign")(null===(c=m.characterInfo)||void 0===c||null===(c=c.stat)||void 0===c?void 0:c.num_of_view)))])]),m._v(" "),_("span",{staticClass:"comment-btn",on:{click:function(t){return t.stopPropagation(),m.openCommentModal.apply(null,arguments)}}},[_("i",{staticClass:"iconfont icon-comment comment-btn-icon"}),m._v(" "),_("span",{staticClass:"comment-btn-text"},[m._v(m._s(m._f("formatNumberForeign")(null===(l=m.characterInfo)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_comment)))])]),m._v(" "),1===(null===(d=m.characterInfo)||void 0===d?void 0:d.publish_status)?_("span",{staticClass:"comment-btn collect-btn",on:{click:function(t){return t.stopPropagation(),m.handleMark.apply(null,arguments)}}},[_("client-only",[_("CollectPopover",{ref:"collectPopover",attrs:{triggerMode:"click",hideBtn:!0,type:m.typeKey,folder:m.characterInfo}},[_("span",{staticClass:"comment-btn-icon iconfont",class:"".concat(m.setCollectData(m.characterInfo))})])],1),m._v(" "),_("span",{staticClass:"comment-btn-text"},[m._v(m._s(m._f("formatNumberForeign")(null===(h=m.characterInfo)||void 0===h||null===(h=h.stat)||void 0===h?void 0:h.num_of_collection)))])],1):m._e(),m._v(" "),_("client-only",[_("el-popover",{attrs:{"popper-class":"popper-ai-chat-cover",placement:"bottom",width:"120",trigger:"hover"}},[_("div",{staticClass:"pop-btns flex"},[m.isOwner?_("button",{on:{click:m.edit}},[m._v("\n              "+m._s(m.$t("Edit"))+"\n            ")]):m._e(),m._v(" "),m.isOwner?_("button",{on:{click:function(t){return m.handleDelete(m.characterInfo)}}},[m._v("\n              "+m._s(m.$t("Delete"))+"\n            ")]):m._e(),m._v(" "),_("button",{on:{click:m.openReport}},[m._v("\n              "+m._s(m.$t("Report"))+"\n            ")])]),m._v(" "),_("div",{staticClass:"more-box",attrs:{slot:"reference"},slot:"reference"},[_("i",{staticClass:"el-icon-more"})])])],1)],1)]),m._v(" "),_("div",{staticClass:"handle-btn"},[_("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("Share"),placement:"top-start"}},[_("i",{directives:[{name:"show",rawName:"v-show",value:!m.isPrivate,expression:"!isPrivate"}],staticClass:"iconfont icon-icon_share",on:{click:m.share}})]),m._v(" "),_("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("Edit"),placement:"top-start"}},[m.isOwner?_("i",{staticClass:"el-icon-edit",on:{click:m.edit}}):m._e()]),m._v(" "),!m.isPrivate||m.isOwner?_("div",{staticClass:"start-btn",class:{"next-btn":m.isNext,"off-btn":m.lastOff},on:{click:function(t){return t.preventDefault(),m.goChat(0)}}},[m._v("\n      "+m._s(m.loading?"":m.$t(m.isNext?"NextAiChat":"StartChat"))+"\n      "),m.loading?_("dot-loading"):m._e(),m._v(" "),m.isNext?_("span",{staticClass:"zoom",on:{click:function(t){t.stopPropagation(),t.preventDefault(),m.lastOff=!m.lastOff}}},[_("i",{staticClass:"el-icon-arrow-down"})]):m._e(),m._v(" "),m.isNext?_("div",{staticClass:"last-list"},[_("div",{staticClass:"list-scroll hide-scrollbar"},m._l(null===(v=m.characterInfo)||void 0===v?void 0:v.latest_session,(function(t,i){return _("div",{key:t.session_id,staticClass:"last-item overflow-ellipsis",on:{click:function(t){return t.stopPropagation(),m.goChat(i)}}},[t.name?_("span",[m._v(m._s(t.name))]):_("span",[m._v(m._s(m._f("TimeFormat")(t.create_at)))]),m._v(" "),_("i",{staticClass:"el-icon-error",on:{click:function(t){return t.stopPropagation(),m.openDelPopup(i)}}})])})),0),m._v(" "),_("div",{staticClass:"last-item",on:{click:function(t){return t.stopPropagation(),m.goChat(-1)}}},[_("i",{staticClass:"el-icon-plus"}),m._v("\n          "+m._s(m.$t("StartNewChat"))+"\n        ")])]):m._e()],1):m._e()],1),m._v(" "),_("client-only",[_("AiChatReport",{ref:"aiChatReport",attrs:{aiChatId:null===(f=m.characterInfo)||void 0===f?void 0:f.id}}),m._v(" "),_("AiChatDelChatPopup",{ref:"delChatPopup"}),m._v(" "),_("CommentDrawer",{ref:"commentDrawer",on:{updateCountNum:m.handleUpdateCountNum}}),m._v(" "),_("ShareChatDialog",{ref:"shareChatDialog"})],1)],1)}),[],!1,null,"43fe7a18",null)),Y=G.exports;installComponents(G,{SvgIcon:n(115).default,CollectPopover:n(63).default,CommentDrawer:n(1186).default,ShareChatDialog:n(576).default});n(31),n(24),n(26);var K={name:"CreateCharacterLoading",components:{CircularLoading:f.default},props:{value:{type:Boolean,default:!1},characterId:{type:[String,Number],default:""}},data:function(){return{showCreatChatMask:this.value,creatCharacterFail:!1,timer:null,canChat:!0,process:0}},watch:{value:function(t){this.showCreatChatMask=t},showCreatChatMask:function(t){this.$emit("input",t),t||this.resetState()}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{handleClickBack:function(){this.$emit("back")},handleClickRetry:function(){this.timer&&clearInterval(this.timer),this.creatCharacterFail=!1,this.showCreatChatMask=!0,this.creatCharacterFn()},creatCharacterFn:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("createParams")?JSON.parse(localStorage.getItem("createParams")):null,console.log("创建数字人---",n),n){e.next=4;break}return e.abrupt("return");case 4:return t.canChat=!1,t.$emit("update:canChat",!1),e.prev=6,e.next=9,Object(d.Q)({cover:{id:n.id,url:n.url,width:n.width,height:n.height},source_id:n.id,source_account_id:n.source_account_id,channel:n.channel||"artwork"});case 9:if(r=e.sent,c=r.status,data=r.data,10618!==c.code){e.next=20;break}return t.$message.warning(t.$t("createChatFailByCover")),t.showCreatChatMask=!0,t.process=0,t.canChat=!1,t.creatCharacterFail=!0,t.timer&&clearInterval(t.timer),t.$emit("update:canChat",!1),e.abrupt("return");case 20:null!=data&&data.character_id?(t.canChat=!0,t.$emit("update:canChat",!0),t.$emit("update:characterId",null==data?void 0:data.character_id),t.handleChatReady(null==data?void 0:data.character_id)):(t.showCreatChatMask=!0,t.canChat=!1,t.$emit("update:canChat",!1),t.timer=setInterval(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCreatProgressFn(null==data?void 0:data.task_id);case 2:case"end":return e.stop()}}),e)}))),2e3)),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(6),console.error("创建数字人失败",e.t0),t.handleCreateFail();case 27:case"end":return e.stop()}}),e,null,[[6,23]])})))()},getCreatProgressFn:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,h,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:null){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,Object(d.R)({task_id:o});case 6:r=n.sent,c=r.status,l=void 0===c?{}:c,h=r.data,data=void 0===h?{}:h,1e4===(null==l?void 0:l.code)&&(e.process=null==data?void 0:data.progress,5===(null==data?void 0:data.status)&&e.handleCreateFail(),100===(null==data?void 0:data.progress)&&1===(null==data?void 0:data.status)&&null!=data&&data.character_id&&(e.$emit("update:characterId",null==data?void 0:data.character_id),e.canChat=!0,e.$emit("update:canChat",!0),e.timer&&clearInterval(e.timer),e.handleChatReady(null==data?void 0:data.character_id))),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(3),console.log("error",n.t0),e.handleCreateFail();case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))()},handleCreateFail:function(){this.process=0,this.canChat=!1,this.$emit("update:canChat",!1),this.creatCharacterFail=!0,this.timer&&clearInterval(this.timer)},handleChatReady:function(t){this.$emit("chat-ready",t),this.showCreatChatMask=!1},resetState:function(){this.process=0,this.creatCharacterFail=!1,this.timer&&clearInterval(this.timer)},startCreate:function(){this.showCreatChatMask=!0,this.creatCharacterFn()}}},J=K,X=(n(5141),Object(I.a)(J,(function(){var t=this,e=t._self._c;return t.showCreatChatMask?e("div",{staticClass:"loading-overlay"},[t.creatCharacterFail?t._e():e("div",{staticClass:"create-loading"},[e("CircularLoading",{attrs:{font:16,process:t.process,circleWH:78}}),t._v(" "),e("div",{staticClass:"loading-tip"},[100===t.process?e("span",[t._v(t._s(t.$t("aboutToStart")))]):[e("span",[t._v(t._s(t.$t("createChartacterLoading").slice(0,t.$t("createChartacterLoading").indexOf("..."))))]),t._v(" "),e("span",{staticClass:"loading-tip-animo"})]],2)],1),t._v(" "),t.creatCharacterFail?e("div",{staticClass:"create-err"},[e("svg-icon",{attrs:{"icon-class":"create-chat-fail"}}),t._v(" "),e("span",{staticClass:"tip"},[t._v(t._s(t.$t("createChartacterFail")))]),t._v(" "),e("div",{staticClass:"btn-box custom-btn-create"},[e("el-button",{on:{click:function(e){return e.stopPropagation(),t.handleClickBack.apply(null,arguments)}}},[t._v(t._s(t.$t("Return")))]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleClickRetry.apply(null,arguments)}}},[t._v(t._s(t.$t("up_retry")))])],1)],1):t._e()]):t._e()}),[],!1,null,"c8e8fb2a",null)),Q=X.exports;function Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(X,{SvgIcon:n(115).default});var et={name:"CharacterDetail",mixins:[D.a],components:{DotLoading:c.default,CircularLoading:f.default,AiChatLastList:S,FigureImg:T,FigureInfo:Y,CreateCharacterLoading:Q},data:function(){var t=this.$route.params.id;return{characterId:void 0===t?"":t,characterCode:1e4,loading:!1,characterInfo:{},task_id:null,showCreatChatMask:!1,canChat:!0,createdLoading:!1,historyStack:[]}},watch:{currentTimbreObj:{handler:function(t){this.characterInfo.timbre_id=(null==t?void 0:t.id)||this.characterInfo.timbre_id||""},immediate:!0},characterInfo:{handler:function(t){this.SET_CHARACTER_INFO(t)},deep:!0,immediate:!0},$route:function(t,e){var n;this.characterId=null===(n=t.params)||void 0===n?void 0:n.id,this.getAiChatInfoFn()}},computed:tt(tt(tt(tt(tt({},Object(v.c)("user",["isLoggedIn"])),Object(v.e)("user",["token","userInfo"])),Object(v.e)("payment",["paymentInfo"])),Object(v.c)("character",["currentTimbreObj"])),{},{categories:function(){var t=this.characterInfo.categories;return t.map((function(t){return t.name})).toString()}}),beforeRouteEnter:function(t,e,n){n((function(t){t.historyStack.push(e.fullPath)}))},beforeRouteLeave:function(t,e,n){this.historyStack=this.historyStack.filter((function(path){return path!==e.fullPath})),n()},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initData();case 2:t.dotReportFn();case 3:case"end":return e.stop()}}),e)})))()},methods:tt(tt({},Object(v.d)("character",["SET_CHARACTER_INFO"])),{},{initData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("true"!==t.$route.query.quickChat){e.next=4;break}return t.showCreatChatMask=!0,t.$nextTick((function(){t.$refs.createLoading&&t.$refs.createLoading.startCreate()})),e.abrupt("return");case 4:return t.characterId=null===(n=t.$route)||void 0===n||null===(n=n.params)||void 0===n?void 0:n.id,e.next=7,t.updateBgInfo();case 7:case"end":return e.stop()}}),e)})))()},handleClickBack:function(){this.$router.replace(this.localePath("/cyberPub"))},updateBgInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.characterInfo)&&void 0!==n&&n.id){e.next=4;break}return e.next=3,t.getAiChatInfoFn();case 3:return e.abrupt("return");case 4:o=t.characterInfo||{},r=o.vision,c=r.bg,l=r.character,t.updateBg(null!=c&&c.url?c:l);case 6:case"end":return e.stop()}}),e)})))()},checkStatus:function(){if(1e4===this.characterCode)return!1;switch(this.characterCode){case 10610:this.$EventBus.$emit("openBannedMask","bannedTipCharter");break;case 10621:this.$message({type:"warning",message:this.$t("chatFail"),duration:5e3,offset:100});break;default:console.warn("Unhandled character code: ".concat(this.characterCode))}return!0},updateSession:function(t){if(!this.checkStatus()){var e=t.character_id,n=t.session_id,o=this.localePath("/aiChat/".concat(e,"?s_id=").concat(n));this.$router.push(o)}},dotReportFn:function(){Object(h.i)({items:[{action:"view",obj_type:9,obj_no:this.characterId}]})},creatCharacterFn:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.showCreatChatMask=!0,e.next=3,t.$nextTick();case 3:t.$refs.createLoading?t.$refs.createLoading.startCreate():console.error("createLoading组件引用不存在");case 4:case"end":return e.stop()}}),e)})))()},handleChatReady:function(t){this.characterId=t,this.goChat(0)},goCreatedSame:function(t){if(t){var e=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));this.isLoggedIn?this.$router.push(e):this.$EventBus.$emit("openLoginDialog",{redirect:e})}},updateBg:function(t){console.log("updateBg",t),this.$emit("updateBg",{backgroundUrl:Object(l.K)(null==t?void 0:t.url,"high"),width:null==t?void 0:t.width,height:null==t?void 0:t.height})},getAiChatInfoFn:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,data,h,v,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:e.characterId,r=t.length>1&&void 0!==t[1]&&t[1],e.loading=!0,n.prev=3,n.next=6,Object(d.s)({id:o});case 6:if(c=n.sent,l=c.status,data=c.data,e.characterCode=l.code||1e4,e.characterInfo=data,h=c.data.vision,v=h.bg,f=h.character,!r&&e.updateBg(null!=v&&v.url?v:f),n.t0=r,!n.t0){n.next=16;break}return n.next=16,e.goChat(0);case 16:n.next=21;break;case 18:n.prev=18,n.t1=n.catch(3),console.log("getAiChatInfoFn错误啦：",n.t1);case 21:if(n.prev=21,null===(m=e.characterInfo)||void 0===m||!m.id){n.next=25;break}return n.next=25,e.updateBgInfo();case 25:return e.loading=!1,e.checkStatus(),n.finish(21);case 28:case"end":return n.stop()}}),n,null,[[3,18,21,28]])})))()},goChat:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("goChat-index",t),n.prev=1,e.canChat||"true"!==e.$route.query.quickChat){n.next=5;break}return e.$message.warning(e.$t("createChartacterFail")),n.abrupt("return");case 5:if(o=e.characterId,r=e.characterInfo.latest_session,c=void 0===r?[]:r,!(t>-1&&c.length&&c[t])){n.next=11;break}return h=null===(l=c[t])||void 0===l?void 0:l.session_id,e.toAiChat(o,h),n.abrupt("return");case 11:if(-1!==t){n.next=16;break}return console.log("开始新聊天"),e.loading=!0,Object(d.i)({character_id:o,mask:""}).then((function(t){var n=t.data.session_id;e.toAiChat(o,n),e.showCreatChatMask=!1})).finally((function(){e.loading=!1})),n.abrupt("return");case 16:e.toAiChat(o,""),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(1),console.log("goChat错误啦：",n.t0);case 22:case"end":return n.stop()}}),n,null,[[1,19]])})))()},toAiChat:function(t,e){var n=this.localePath("/cyberPubPage/".concat(t));this.$router.replace({path:n,query:{}}),this.$router.push(this.localePath({path:"/aiChat/"+t,query:e?{s_id:e}:{}}))}}),head:function(){var t=this.characterInfo,e=(t.id,t.evaluation),n=t.categories,o=t.cover,r=t.vision,c=t.seo_title,l=t.seo_description,d=t.seo_keywords,h=Object(L.h)(this,this.characterInfo),v=r||{},f=n?n.map((function(t){return t.name})).toString():"",title=c||this.$t("CyberPubDetailsTitle",{name:h}),m=l||this.$t("CyberPubDetailsDesc",{name:h,desc:e});return{title:title,meta:[{hid:"description",name:"description",content:m},{hid:"keywords",name:"keywords",content:d||"".concat(h,",").concat(f)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:m},{hid:"og:image",name:"og:image",content:(null==o?void 0:o.url)||(null==v?void 0:v.url)}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,param,h,data,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$axios,o=t.params,r=t.error,c=t.query,l=o.id,param={id:l,ss:d.f},e.prev=3,"true"!==c.quickChat){e.next=8;break}return e.abrupt("return",{characterInfo:{},characterCode:1e4});case 8:return e.next=10,n.$post("/api/v1/character/detail",param);case 10:return h=e.sent,data=h.data,v=h.status,console.log("数字人详情页面-> asyncData数据啦：",data),e.abrupt("return",{characterInfo:data||{},characterCode:v.code});case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),console.log("数字人详情页面-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 21:case"end":return e.stop()}}),e,null,[[3,17]])})))()}},it=et,nt=(n(5142),n(5143),Object(I.a)(it,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"aichat-details"},[t.$route.query.quickChat?t._e():e("AiChatLastList",{ref:"lastChat",attrs:{historyStack:t.historyStack,characterId:t.characterId,"only-back":!0,fromPage:"chatDetail"},on:{updateSession:t.updateSession}}),t._v(" "),e("FigureImg"),t._v(" "),t.showCreatChatMask?t._e():e("FigureInfo",{on:{goChat:t.goChat}}),t._v(" "),e("client-only",[e("CreateCharacterLoading",{ref:"createLoading",attrs:{characterId:t.characterId,canChat:t.canChat},on:{"update:characterId":function(e){t.characterId=e},"update:character-id":function(e){t.characterId=e},"update:canChat":function(e){t.canChat=e},"update:can-chat":function(e){t.canChat=e},back:t.handleClickBack,"chat-ready":t.handleChatReady},model:{value:t.showCreatChatMask,callback:function(e){t.showCreatChatMask=e},expression:"showCreatChatMask"}})],1)],1)}),[],!1,null,"69c99be1",null));e.default=nt.exports},5748:function(t,e,n){"use strict";n.r(e);n(16),n(21);var o=n(3),r=n(2),c=n(14),l=(n(679),n(47),n(416)),d=n.n(l),h=(n(20),n(11),n(19),n(6),n(12),n(13),n(8),n(7),n(18),n(4),n(177),n(28),n(44),n(26),n(1)),v=n(81),f=n(54),m=n(10),_=(n(1113),n(453)),y=n.n(_),w=(n(1114),n(454)),C=n.n(w),k=(n(768),n(386)),O=n.n(k),x=(n(674),n(325)),I=n.n(x),S=(n(22),n(64));function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P={props:{rollBox:{type:String,default:""},activityDetail:{type:Object,default:function(){}}},components:Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},I.a.name,I.a),O.a.name,O.a),C.a.name,C.a),y.a.name,y.a),"HyWaterfallFlowList",S.default),mounted:function(){var t=this;this.initWaterfallList(),window.addEventListener("resize",this.updatePositions),this.$EventBus.$on("onContributionSuccess",(function(){t.getInitWaterfallList()}))},beforeDestroy:function(){window.removeEventListener("resize",this.updatePositions),this.$EventBus.$off("onContributionSuccess")},data:function(){return{isWaterfallLoading:!1,waterfallList:[],isWaterfallEnd:!1,waterfallParam:{activity_type:1,activity_id:"",page:1,size:35,order_by:"hot",is_award:!1,participation_type_limits:[]},waterfallListWithPosition:[],waterfallSort:"hot",waterfallSortOptions:[{value:"hot",label:"Hot"},{value:"create_at",label:"New"},{value:"assets",label:"award_work"}],waterfallFilterCategory:"",waterfallFilterCategoryOptions:[]}},watch:{"waterfallParam.order_by":{handler:function(){this.getInitWaterfallList()}},waterfallSort:{handler:function(t){"assets"===t?(this.waterfallFilterCategory="all",this.waterfallParam.order_by="hot",this.waterfallParam.size=void 0,this.waterfallParam.is_award=!0,this.getInitWaterfallList()):(this.waterfallParam.order_by=t,this.waterfallParam.size=35,this.waterfallParam.is_award=!1,this.getInitWaterfallList())}},waterfallFilterCategory:{handler:function(t){if("all"===t)this.waterfallParam.participation_type_limits=[],this.waterfallParam.post_type=void 0;else if(t.includes("".concat(f.CONTRIBUTION_TYPE_ENUM.WORK,","))){var e;this.waterfallParam.participation_type_limits=[f.CONTRIBUTION_TYPE_ENUM.WORK],this.waterfallParam.post_type=null===(e=t.split(","))||void 0===e?void 0:e[1]}else this.waterfallParam.participation_type_limits=[t],this.waterfallParam.post_type=void 0;this.getInitWaterfallList()}}},methods:{initWaterfallList:function(){var t=this;this.waterfallParam.activity_id=this.activityDetail.id,this.waterfallParam.order_by="hot",this.waterfallFilterCategory="all";var e=[{value:"all",label:"All"}];f.CONTRIBUTION_TYPE_LIST.filter((function(e){return t.activityDetail.participation_type_limits.includes(e.value)})).forEach((function(option){var n,o,r;option.value===f.CONTRIBUTION_TYPE_ENUM.WORK?null!==(n=t.activityDetail)&&void 0!==n&&null!==(n=n.post_sub_type)&&void 0!==n&&n.length?(null!==(o=t.activityDetail)&&void 0!==o&&null!==(o=o.post_sub_type)&&void 0!==o&&o.includes(1)&&e.push({value:"".concat(f.CONTRIBUTION_TYPE_ENUM.WORK,",image"),label:t.$t("Work")+"/"+t.$t("Image")}),null!==(r=t.activityDetail)&&void 0!==r&&null!==(r=r.post_sub_type)&&void 0!==r&&r.includes(2)&&e.push({value:"".concat(f.CONTRIBUTION_TYPE_ENUM.WORK,",video"),label:t.$t("Work")+"/"+t.$t("Video")})):e.push(option):e.push(option)})),this.waterfallFilterCategoryOptions=e},getInitWaterfallList:function(){var t=this;this.waterfallParam.page=1,this.waterfallList=[],this.waterfallListWithPosition=[],this.isWaterfallLoading=!0,this.isWaterfallEnd=!1,Object(v.n)(this.waterfallParam).then((function(e){t.waterfallList=e.data.items||[],t.updatePositions()})).finally((function(){t.isWaterfallLoading=!1}))},getMoreWaterfallList:function(){var t=this;"assets"!==this.waterfallSort&&(this.isWaterfallEnd||(this.waterfallParam.page++,this.isWaterfallLoading=!0,Object(v.n)(this.waterfallParam).then((function(e){var n;null!==(n=e.data.items)&&void 0!==n&&n.length?t.waterfallList=t.waterfallList.concat(e.data.items||[]):t.isWaterfallEnd=!0})).finally((function(){t.isWaterfallLoading=!1}))))},updatePositions:function(){var t=this;"assets"===this.waterfallSort&&setTimeout((function(){var e=t.$refs.waterfallList.$el.children;t.waterfallListWithPosition=t.waterfallList.map((function(n,o){var r=e[o];if(!r)return L({},n);var rect=r.getBoundingClientRect(),c=t.$refs.waterfallWrapperRef.getBoundingClientRect();return L(L({},n),{},{top:rect.top-c.top-4,left:rect.left-c.left+296})})),console.log(t.waterfallListWithPosition)}),1e3)}}},j=(n(4822),n(4823),n(0)),component=Object(j.a)(P,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"section-waterfall"},[o("div",{staticClass:"section-waterfall-header"},[o("h2",{staticClass:"title"},[n._v(n._s(n.$t("contest_artwork")))]),n._v(" "),o("div",{staticClass:"filter-widget"},[o("div",{staticClass:"category"},[o("el-select",{attrs:{"popper-class":"event-center-official-activity-waterfall-category-popper"},model:{value:n.waterfallSort,callback:function(t){n.waterfallSort=t},expression:"waterfallSort"}},n._l(n.waterfallSortOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:n.$t(t.label),value:t.value}})})),1)],1),n._v(" "),o("div",{staticClass:"category"},[o("el-select",{attrs:{"popper-class":"event-center-official-activity-waterfall-category-popper"},model:{value:n.waterfallFilterCategory,callback:function(t){n.waterfallFilterCategory=t},expression:"waterfallFilterCategory"}},n._l(n.waterfallFilterCategoryOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:n.$t(t.label),value:t.value}})})),1)],1)])]),n._v(" "),o("div",{staticClass:"section-waterfall-content"},[o("div",{directives:[{name:"show",rawName:"v-show",value:n.isWaterfallLoading||(null===(t=n.waterfallList)||void 0===t?void 0:t.length),expression:"isWaterfallLoading || waterfallList?.length"}],ref:"waterfallWrapperRef",staticClass:"waterfall-wrapper"},[o("HyWaterfallFlowList",{ref:"waterfallList",attrs:{list:n.waterfallList,container:"waterfallWrapperRef",rollBox:n.rollBox,waterAllListFn:function(){return n.waterfallList}},on:{load:n.getMoreWaterfallList}}),n._v(" "),n._l(n.waterfallListWithPosition,(function(t){return o("div",{directives:[{name:"show",rawName:"v-show",value:"assets"===n.waterfallSort,expression:"waterfallSort === 'assets'"}],key:t.id,staticClass:"float-icon-wrapper",style:{top:"".concat(t.top,"px"),left:"".concat(t.left,"px")}},[o("svg-icon",{directives:[{name:"show",rawName:"v-show",value:1===t.rank,expression:"item.rank === 1"}],staticClass:"float-icon",attrs:{"icon-class":"ranking_1"}}),n._v(" "),o("svg-icon",{directives:[{name:"show",rawName:"v-show",value:2===t.rank,expression:"item.rank === 2"}],staticClass:"float-icon",attrs:{"icon-class":"ranking_2"}}),n._v(" "),o("svg-icon",{directives:[{name:"show",rawName:"v-show",value:3===t.rank,expression:"item.rank === 3"}],staticClass:"float-icon",attrs:{"icon-class":"ranking_3"}})],1)})),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.isWaterfallLoading,expression:"isWaterfallLoading"}],staticClass:"waterfall-loading"})],2),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!(n.isWaterfallLoading||null!==(e=n.waterfallList)&&void 0!==e&&e.length),expression:"!isWaterfallLoading && !waterfallList?.length"}],staticClass:"no-content"},[o("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),n._v(" "),o("div",{staticClass:"no-content-text"},[n._v(n._s(n.$t("no_data")))])],1)])])}),[],!1,null,"2e9d1d18",null),$=component.exports;installComponents(component,{SvgIcon:n(115).default});var T=n(569),M=n(636);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={props:{visible:{type:Boolean,default:!1},activityId:{type:String,default:""}},emits:["update:visible"],components:{OfficialActivityWaterfall:$,ModelCreateDialog:T.default},activated:function(){this.updateScrollTop(),this.visible&&Object(m.J)()},deactivated:function(){Object(m.V)()},data:function(){return{CONTRIBUTION_TYPE_ENUM:f.CONTRIBUTION_TYPE_ENUM,isActivityDetailLoading:!1,activityDetail:{},isShowMore:!1,scrollWrapperId:"official-activity-waterfall-scroll-wrapper",savedScrollTop:0,isModelCreateDialogVisible:!1,createEntryList:[{id:"train_model_btn",icon:"xunlianmoxing",title:this.$t("trainMode"),clickFn:function(){return window.open("/loraTrainingEdit?DSType=0","_blank")},logEventOperation:"train_model_btn_click"},{id:"upload_model_btn",icon:"shangchuan2",title:this.$t("UploadModels"),clickFn:function(){return window.open("/modelEditStep","_blank")},logEventOperation:"upload_model_btn_click"},{id:"quick_import_model_btn",icon:"kuaisudaoru",title:this.$t("quick_import_model"),clickFn:function(){return window.open("/modelImport","_blank")},logEventOperation:"quick_import_model_btn_click"}],modelCheckpointCreateEntryIdList:["upload_model_btn","quick_import_model_btn"],modelLoraCreateEntryIdList:["train_model_btn","upload_model_btn","quick_import_model_btn"]}},computed:A(A({},Object(h.c)("user",["isLoggedIn"])),{},{computedCreateEntryList:function(){var t,e,n=this;return null!==(t=this.activityDetail)&&void 0!==t&&null!==(t=t.theme_activity)&&void 0!==t&&null!==(t=t.participation_type_limits)&&void 0!==t&&t.includes(f.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT)?this.createEntryList.filter((function(t){return n.modelCheckpointCreateEntryIdList.includes(t.id)})):null!==(e=this.activityDetail)&&void 0!==e&&null!==(e=e.theme_activity)&&void 0!==e&&null!==(e=e.participation_type_limits)&&void 0!==e&&e.includes(f.CONTRIBUTION_TYPE_ENUM.MODEL_LORA)?this.createEntryList.filter((function(t){return n.modelLoraCreateEntryIdList.includes(t.id)})):[]}}),watch:{visible:{handler:function(t,e){var n;t&&!e?(this.isShowMore=!1,this.initActivityDetail(),this.addScrollListener(),Object(m.J)(),this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_activity_center_page_page",behavior_info_sub:null===(n=this.activityDetail.theme_activity)||void 0===n?void 0:n.id})):(Object(m.V)(),this.removeScrollListener())}},"$route.path":{handler:function(t){var e=document.body.querySelector(".v-modal");e&&(e.style.display=t.includes("/event-center")?"block":"none")}}},methods:{initActivityDetail:function(){var t=this;this.activityDetail={},this.isActivityDetailLoading=!0,Object(v.l)({activity_id:this.activityId,activity_type:1}).then((function(e){var n;null!==(n=e.data)&&void 0!==n&&null!==(n=n.theme_activity)&&void 0!==n&&n.id?t.activityDetail=e.data:(t.$router.replace({params:{activityId:void 0}}).catch((function(){})),t.$emit("update:visible",!1),t.$message.error(t.$t("activity_no_exist")))})).catch((function(e){t.$router.replace({params:{activityId:void 0}}).catch((function(){})),t.$emit("update:visible",!1),t.$message.error(t.$t("activity_no_exist"))})).finally((function(){t.isActivityDetailLoading=!1}))},handleClose:function(){this.$route.params.activityId&&this.$router.replace({params:{activityId:void 0}}).catch((function(){})),this.$emit("update:visible",!1)},onGoCreateClick:function(){var t,e;if(null!==(t=this.activityDetail)&&void 0!==t&&null!==(t=t.theme_activity)&&void 0!==t&&null!==(t=t.participation_type_limits)&&void 0!==t&&t.length)for(var n=this.activityDetail.theme_activity.participation_type_limits,i=0;i<n.length;i++){if([f.CONTRIBUTION_TYPE_ENUM.WORK,f.CONTRIBUTION_TYPE_ENUM.ARTICLE].includes(n[i])){var o;new M.a(this.$EventBus).openByParams(null===(o=this.activityDetail.limit_items)||void 0===o?void 0:o[0]);break}if([f.CONTRIBUTION_TYPE_ENUM.CHARACTER].includes(n[i])){if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog");this.$router.push(this.localePath("/cyberPubPage/new-character"));break}if([f.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT,f.CONTRIBUTION_TYPE_ENUM.MODEL_LORA].includes(n[i])){if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog");this.isModelCreateDialogVisible=!0;break}}else this.$EventBus.$emit("openGenerate",{action:1,data:""});this.$logEvent("log_actions",{operation:"click_create_now",behavior_info:"on_activity_center_page_page",behavior_info_sub:null===(e=this.activityDetail.theme_activity)||void 0===e?void 0:e.id})},onGoSubmitClick:function(){var t,e;this.$EventBus.$emit("openContribution",{types:null===(t=this.activityDetail.theme_activity)||void 0===t?void 0:t.participation_type_limits,linkActivity:this.activityDetail.theme_activity}),this.$logEvent("log_actions",{operation:"click_post",behavior_info:"on_activity_center_page_page",behavior_info_sub:null===(e=this.activityDetail.theme_activity)||void 0===e?void 0:e.id})},onShowMoreClick:function(){this.isShowMore=!0},calcRemainingTime:function(t){var e=(new Date).getTime(),n=new Date(t).getTime()-e;if(n<=0)return this.$t("HttpErrorCode_130000");var o=Math.floor(n/864e5),r=Math.floor(n%864e5/36e5);return this.$t("submit_countdown",{num1:o,num2:r})},calcDateStr:function(t){if(!t)return"";var e=new Date(t),n=e.getFullYear(),o=e.getMonth()+1,r=e.getDate();return"".concat(n,"/").concat(o,"/").concat(r)},addScrollListener:function(){var t=this;this.$nextTick((function(){t.$refs.scrollWrapper&&t.$refs.scrollWrapper.addEventListener("scroll",t.handleScroll)}))},removeScrollListener:function(){this.$refs.scrollWrapper&&this.$refs.scrollWrapper.removeEventListener("scroll",this.handleScroll)},updateScrollTop:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.$refs.scrollWrapper&&t.savedScrollTop>0&&(t.$refs.scrollWrapper.scrollTop=t.savedScrollTop)}),10)}))},handleScroll:function(t){this.savedScrollTop=t.target.scrollTop}}},B=(n(4825),Object(j.a)(E,(function(){var t,e,n,o,r,c,l,d,h,v,f,m=this,_=m._self._c;return _("el-dialog",{staticClass:"official-activity-dialog",attrs:{visible:m.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"lock-scroll":!0},on:{"update:visible":function(t){m.visible=t}}},[_("div",{staticClass:"close-btn",on:{click:m.handleClose}},[_("Icon",{attrs:{name:"guanbi1",size:"12",color:"#fff"}})],1),m._v(" "),_("div",{staticClass:"section-header"},[m.isActivityDetailLoading?m._e():[_("div",{staticClass:"title-line"},[_("div",{staticClass:"title-wrapper"},[_("div",{staticClass:"title"},[m._v(m._s(null===(t=m.activityDetail.theme_activity)||void 0===t?void 0:t.title))]),m._v(" "),_("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=m.activityDetail.theme_activity)||void 0===e||null===(e=e.participation_type_limits)||void 0===e?void 0:e.includes(m.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT),expression:"\n              activityDetail.theme_activity?.participation_type_limits?.includes(\n                CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT\n              )\n            "}],staticClass:"activity-type"},[_("div",{staticClass:"tag-name",staticStyle:{color:"#26c7e3","border-color":"#26c7e3"}},[m._v("Checkpoint Contest")])]),m._v(" "),_("div",{directives:[{name:"show",rawName:"v-show",value:null===(n=m.activityDetail.theme_activity)||void 0===n||null===(n=n.participation_type_limits)||void 0===n?void 0:n.includes(m.CONTRIBUTION_TYPE_ENUM.MODEL_LORA),expression:"\n              activityDetail.theme_activity?.participation_type_limits?.includes(CONTRIBUTION_TYPE_ENUM.MODEL_LORA)\n            "}],staticClass:"activity-type"},[_("div",{staticClass:"tag-name",staticStyle:{color:"#d15bd3","border-color":"#d15bd3"}},[m._v("LoRA Contest")])])]),m._v(" "),_("div",{directives:[{name:"show",rawName:"v-show",value:2===(null===(o=m.activityDetail.theme_activity)||void 0===o?void 0:o.activity_status),expression:"activityDetail.theme_activity?.activity_status === 2"}],staticClass:"operation"},[_("div",{staticClass:"operation-btn create-btn",attrs:{"data-event":"click_create_btn_dialog","data-id":null===(r=m.activityDetail.theme_activity)||void 0===r?void 0:r.id},on:{click:m.onGoCreateClick}},[m._v("\n            "+m._s(m.$t("create_immediately"))+"\n          ")]),m._v(" "),_("div",{staticClass:"operation-btn submit-btn",attrs:{"data-event":"click_submit_btn_dialog","data-id":null===(c=m.activityDetail.theme_activity)||void 0===c?void 0:c.id},on:{click:m.onGoSubmitClick}},[m._v("\n            "+m._s(m.$t("activity_submit"))+"\n          ")])])]),m._v(" "),_("div",{staticClass:"sub-title-line"},[_("div",{staticClass:"countdown"},[_("Icon",{attrs:{name:"icon-event-time",size:"14",color:"#93A2B6"}}),m._v(" "),_("span",{staticClass:"countdown-text"},[m._v(m._s(m.calcRemainingTime(null===(l=m.activityDetail.theme_activity)||void 0===l?void 0:l.end_time)))])],1),m._v(" "),_("div",{staticClass:"date-range"},[_("span",[m._v("\n            "+m._s("".concat(m.$t("activityTime")," ").concat(m.calcDateStr(null===(d=m.activityDetail.theme_activity)||void 0===d?void 0:d.start_time),"-").concat(m.calcDateStr(null===(h=m.activityDetail.theme_activity)||void 0===h?void 0:h.end_time)))+"\n          ")])])])]],2),m._v(" "),_("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper",attrs:{id:m.scrollWrapperId}},[_("div",{directives:[{name:"loading",rawName:"v-loading",value:m.isActivityDetailLoading,expression:"isActivityDetailLoading"}],staticClass:"section-rich-text"},[_("div",{staticClass:"rich-text-wrapper",style:{height:m.isShowMore?"auto":"340px"}},[_("div",{domProps:{innerHTML:m._s(null===(v=m.activityDetail.theme_activity)||void 0===v?void 0:v.rule)}})]),m._v(" "),_("div",{staticClass:"show-more",style:m.isShowMore||m.isActivityDetailLoading?{display:"none"}:{}},[_("div",{staticClass:"show-more-btn",on:{click:m.onShowMoreClick}},[m._v(m._s(m.$t("Unfold")))])])]),m._v(" "),_("div",{staticClass:"divider"}),m._v(" "),m.visible&&!m.isActivityDetailLoading&&null!==(f=m.activityDetail)&&void 0!==f&&null!==(f=f.theme_activity)&&void 0!==f&&f.id?_("OfficialActivityWaterfall",{attrs:{rollBox:m.scrollWrapperId,activityDetail:m.activityDetail.theme_activity||{}}}):m._e()],1),m._v(" "),_("ModelCreateDialog",{attrs:{visible:m.isModelCreateDialogVisible,createEntryList:m.computedCreateEntryList},on:{"update:visible":function(t){m.isModelCreateDialogVisible=t}}})],1)}),[],!1,null,"ac4b73a0",null)),N=B.exports;installComponents(B,{ModelCreateDialog:n(569).default});n(31);var F=n(52),U=n(464),H={name:"FeatureEntries",components:{SwipeableList:F.default,BaseCard:U.default},data:function(){return{isActivityPostListLoading:!1,activityPostList:[]}},mounted:function(){this.getFeatureEntries()},methods:{getFeatureEntries:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v.k)({});case 3:r=e.sent,t.activityPostList=((null==r||null===(n=r.data)||void 0===n?void 0:n.items)||[]).slice(0,12),t.isActivityPostListLoading=!1,t.scene=null==r||null===(o=r.data)||void 0===o?void 0:o.scene,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t.isActivityPostListLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}}},V=(n(4826),Object(j.a)(H,(function(){var t,e,n=this,o=n._self._c;return(null===(t=n.activityPostList)||void 0===t?void 0:t.length)>0?o("section",{staticClass:"section-latest-submission"},[o("div",{staticClass:"section-header"},[o("h2",{staticClass:"title"},[n._v(n._s(n.$t("title_featured_entries")))])]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.isActivityPostListLoading,expression:"isActivityPostListLoading"}],staticClass:"section-content"},[o("SwipeableList",{attrs:{listGap:"16px",top:"0"}},n._l(n.activityPostList,(function(t,e){return o("BaseCard",{key:(t.id||"-")+e,attrs:{item:t,isWater:!1,imgW:"260px",imgH:"346px"}})})),1),n._v(" "),n.isActivityPostListLoading||null!==(e=n.activityPostList)&&void 0!==e&&e.length?n._e():o("div",{staticClass:"no-content"},[o("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),n._v(" "),o("div",{staticClass:"no-content-text"},[n._v(n._s(n.$t("no_data")))])],1)],1)]):n._e()}),[],!1,null,"16e782d8",null)),z=V.exports;function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}installComponents(V,{SwipeableList:n(52).default,SvgIcon:n(115).default});var G={name:"TabActivity",components:{ElAvatar:d.a,FeatureEntries:z,OfficialActivityDialog:N},activated:function(){this.initOfficialActivityList(),this.initOfficialActivityDialog(),this.initScrollListener(),this.inTabActivityHome(this.$route)&&this.restoreScrollTop()},mounted:function(){this.initOfficialActivityList(),this.initOfficialActivityDialog(),this.initScrollListener()},deactivated:function(){this.clearScrollListener()},beforeDestroy:function(){this.clearScrollListener()},beforeRouteLeave:function(t,e,n){this.inTabActivityHome(e)&&this.saveScrollTop(),n()},head:function(){var title=this.$t("EventCenterActivityTitle"),desc=this.$t("EventCenterActivityDes");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},data:function(){return{CONTRIBUTION_TYPE_ENUM:f.CONTRIBUTION_TYPE_ENUM,isHeaderFixed:!1,headerOffset:0,scrollMarginTop:110,sectionHeaderOffsetTop:86,resizeObserver:null,savedScrollTop:0,officialActivityStatus:2,isOfficialActivityListLoadingForInProgress:!1,isOfficialActivityListLoadingForInEnd:!1,officialActivityListInProgress:[],officialActivityListInEnd:[],officialActivityParticipationTypeLimit:"all",officialActivityParticipationTypeLimitOptions:[{value:"all",label:"All"}].concat(Object(c.a)(f.CONTRIBUTION_TYPE_LIST)),currentOfficialActivityId:"",officialActivityDialogVisible:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(h.c)("user",["isLoggedIn"])),watch:{officialActivityParticipationTypeLimit:{handler:function(){this.initOfficialActivityList()}},"$route.params.activityId":{handler:function(t,e){t&&!e&&this.$route.path.includes("/activity")&&(this.currentOfficialActivityId=t||"",this.officialActivityDialogVisible=!!t)}},$route:{handler:function(t,e){this.inTabActivityHome(t)&&this.restoreScrollTop(),this.inTabActivityHome(e)&&this.inTabActivity(t)&&this.saveScrollTop()}}},methods:{initOfficialActivityList:function(){var t=this;this.isOfficialActivityListLoadingForInProgress=!0,Object(v.m)({activity_type:1,activity_status:2,size:1e3,participation_type_limit:"all"===this.officialActivityParticipationTypeLimit?[]:[this.officialActivityParticipationTypeLimit]}).then((function(e){t.officialActivityListInProgress=e.data.items||[]})).finally((function(){t.isOfficialActivityListLoadingForInProgress=!1})),this.isOfficialActivityListLoadingForInEnd=!0,Object(v.m)({activity_type:1,activity_status:3,size:1e3,participation_type_limit:"all"===this.officialActivityParticipationTypeLimit?[]:[this.officialActivityParticipationTypeLimit]}).then((function(e){t.officialActivityListInEnd=e.data.items||[]})).finally((function(){t.isOfficialActivityListLoadingForInEnd=!1}))},initOfficialActivityDialog:function(){this.$route.path.includes("/activity")&&(this.currentOfficialActivityId=this.$route.params.activityId||"",this.officialActivityDialogVisible=!!this.$route.params.activityId)},initScrollListener:function(){var t=this;this.$nextTick((function(){var e=document.querySelector(".top-banner");t.scrollMarginTop=e&&"none"!==window.getComputedStyle(e).display?110:64,t.$refs.inProgressListHeaderRef&&(t.headerOffset=t.$refs.inProgressListHeaderRef.getBoundingClientRect().top+window.scrollY,t.updateHeaderOffset(),window.addEventListener("scroll",t.handleScroll),t.initResizeObserver())}))},initResizeObserver:function(){var t=this;this.resizeObserver=new ResizeObserver((function(){return t.updateHeaderOffset()})),this.resizeObserver.observe(document.body)},clearScrollListener:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("scroll",this.handleScroll)},updateHeaderOffset:function(){this.$refs.inProgressListHeaderRef&&(this.headerOffset=this.$refs.inProgressListHeaderRef.getBoundingClientRect().top+window.scrollY)},handleScroll:function(){if(this.$refs.inProgressListHeaderRef){var t=window.scrollY,e=this.headerOffset-t,n=this.$refs.inEndListRef.offsetTop-this.scrollMarginTop-this.sectionHeaderOffsetTop;if(this.officialActivityStatus=t>=n?3:2,e<=this.scrollMarginTop&&!this.isHeaderFixed){this.isHeaderFixed=!0,this.$refs.inProgressListHeaderRef.style.position="fixed",this.$refs.inProgressListHeaderRef.style.top="".concat(this.scrollMarginTop,"px"),this.$refs.inProgressListHeaderRef.style.zIndex="10",this.$refs.inProgressListHeaderRef.style.width=this.$refs.inProgressListHeaderRef.parentNode.offsetWidth+"px";var o=document.createElement("div");o.style.height=this.$refs.inProgressListHeaderRef.offsetHeight+"px",o.id="header-placeholder",this.$refs.inProgressListHeaderRef.parentNode.insertBefore(o,this.$refs.inProgressListHeaderRef.nextSibling)}else if(e>this.scrollMarginTop&&this.isHeaderFixed){this.isHeaderFixed=!1,this.$refs.inProgressListHeaderRef.style.position="static",this.$refs.inProgressListHeaderRef.style.top="auto",this.$refs.inProgressListHeaderRef.style.zIndex="auto",this.$refs.inProgressListHeaderRef.style.width="auto";var r=document.getElementById("header-placeholder");r&&r.parentNode.removeChild(r)}}},restoreScrollTop:function(){var t=this;this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.savedScrollTop>0)){e.next=4;break}return e.next=3,new Promise((function(t){return setTimeout(t,0)}));case 3:window.scrollTo(0,t.savedScrollTop);case 4:case"end":return e.stop()}}),e)}))))},saveScrollTop:function(){this.savedScrollTop=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0},inTabActivityHome:function(t){return t.name.includes("EventCenterActivity")&&Object.values(t.params).every((function(t){return!t}))},inTabActivity:function(t){return t.name.includes("EventCenterActivity")},toggleOfficialActivityStatus:function(t){switch(t){case 2:this.$logEvent("log_actions",{operation:"click_hot_tab",behavior_info:"on_activity_center_page"}),window.scrollTo({top:this.$refs.inProgressListRef.offsetTop-this.scrollMarginTop-this.sectionHeaderOffsetTop,behavior:"smooth"});break;case 3:this.$logEvent("log_actions",{operation:"click_past_events",behavior_info:"on_activity_center_page"}),window.scrollTo({top:this.$refs.inEndListRef.offsetTop-this.scrollMarginTop-this.sectionHeaderOffsetTop,behavior:"smooth"})}},onOfficialActivityItemClick:function(t){this.$logEvent("log_actions",{operation:"click_activity",behavior_info:"on_activity_center_page",behavior_info_sub:t.id}),this.$router.replace({params:{activityId:t.id}}).catch((function(){}))},calcRemainingTime:function(t){var e=(new Date).getTime(),n=new Date(t.end_time).getTime()-e;if(n<=0)return t.number_of_award>0?this.$t("awarded"):this.$t("awarding");var o=Math.floor(n/864e5),r=Math.floor(n%864e5/36e5);return this.$t("submit_countdown",{num1:o,num2:r})}}},Y=G,K=(n(4827),n(4828),Object(j.a)(Y,(function(){var t,e,o=this,r=o._self._c;return r("div",{staticClass:"tab-event",attrs:{"data-group":"activity_center_tab_event_component"}},[r("FeatureEntries",{staticClass:"section-feature-entries"}),o._v(" "),r("section",{staticClass:"section-official-theme"},[r("div",{ref:"inProgressListHeaderRef",staticClass:"section-header"},[r("div",{staticClass:"section-header-wrapper"},[r("div",{staticClass:"title"},[r("div",{staticClass:"activity-tabs"},[r("div",{staticClass:"activity-tab",class:{active:2===o.officialActivityStatus},attrs:{"data-event":"click_hot_tab"},on:{click:function(t){return o.toggleOfficialActivityStatus(2)}}},[o._v("\n              "+o._s(o.$t("hot_progress"))+"\n            ")]),o._v(" "),r("div",{staticClass:"activity-tab",class:{active:3===o.officialActivityStatus},attrs:{"data-event":"click_past_events_tab"},on:{click:function(t){return o.toggleOfficialActivityStatus(3)}}},[o._v("\n              "+o._s(o.$t("PastEvents"))+"\n            ")])])]),o._v(" "),r("div",{staticClass:"filter-widget"},[r("div",{staticClass:"category"},[r("el-select",{attrs:{"popper-class":"event-center-tab-activity-official-activity-list-category-popper"},model:{value:o.officialActivityParticipationTypeLimit,callback:function(t){o.officialActivityParticipationTypeLimit=t},expression:"officialActivityParticipationTypeLimit"}},o._l(o.officialActivityParticipationTypeLimitOptions,(function(t){return r("el-option",{key:t.value,attrs:{value:t.value,label:o.$t(t.label)}})})),1)],1)])])]),o._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isOfficialActivityListLoadingForInProgress,expression:"isOfficialActivityListLoadingForInProgress"}],ref:"inProgressListRef",staticClass:"section-content"},[r("div",{staticClass:"official-activity-list"},o._l(o.officialActivityListInProgress,(function(t){var e,c;return r("div",{key:t.id,staticClass:"official-activity-item",attrs:{"data-event":"click_official_activity_item","data-id":t.id},on:{click:function(e){return o.onOfficialActivityItemClick(t)}}},[r("div",{staticClass:"header-image",style:{backgroundImage:"url(".concat(t.cover,")")}},[r("div",{staticClass:"first-label"},[r("div",{staticClass:"countdown"},[r("Icon",{staticClass:"countdown-icon",attrs:{name:"icon-event-time",size:"12",color:"#fff"}}),o._v(" "),r("span",{staticClass:"countdown-text"},[o._v(o._s(o.calcRemainingTime(t)))])],1),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=t.participation_type_limits)||void 0===e?void 0:e.includes(o.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT),expression:"item.participation_type_limits?.includes(CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT)"}],staticClass:"activity-type",staticStyle:{color:"#26c7e3"}},[o._v("\n                Checkpoint\n              ")]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:null===(c=t.participation_type_limits)||void 0===c?void 0:c.includes(o.CONTRIBUTION_TYPE_ENUM.MODEL_LORA),expression:"item.participation_type_limits?.includes(CONTRIBUTION_TYPE_ENUM.MODEL_LORA)"}],staticClass:"activity-type",staticStyle:{color:"#d15bd3"}},[o._v("\n                LoRA\n              ")])])]),o._v(" "),r("div",{staticClass:"main-content"},[r("div",{staticClass:"title"},[o._v(o._s(t.title))]),o._v(" "),r("div",{staticClass:"description"},[o._v(o._s(t.desc))])]),o._v(" "),r("div",{staticClass:"footer"},[r("div",{directives:[{name:"show",rawName:"v-show",value:1===t.total_reward_type,expression:"item.total_reward_type === 1"}],staticClass:"info-item award-info",staticStyle:{color:"#a55bd3"}},[r("img",{staticClass:"img-icon",attrs:{src:n(205)}}),o._v(" "),r("span",[o._v(o._s(o.$t("win_x_credits",{num:t.total_reward_pool})))])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2===t.total_reward_type,expression:"item.total_reward_type === 2"}],staticClass:"info-item award-info",staticStyle:{color:"#ffeaad"}},[r("img",{staticClass:"img-icon",attrs:{src:n(160)}}),o._v(" "),r("span",[o._v(o._s(o.$t("win_x_stamina",{num:t.total_reward_pool})))])]),o._v(" "),r("div",{staticClass:"info-item submission-info"},[r("Icon",{attrs:{name:"a-fuzhi1",size:"14"}}),o._v(" "),r("span",[o._v(o._s(t.virtual_participate_num+t.real_participate_num))])],1)])])})),0),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!(o.isOfficialActivityListLoadingForInProgress||null!==(t=o.officialActivityListInProgress)&&void 0!==t&&t.length),expression:"!isOfficialActivityListLoadingForInProgress && !officialActivityListInProgress?.length"}],staticClass:"no-content"},[r("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),o._v(" "),r("div",{staticClass:"no-content-text"},[o._v(o._s(o.$t("no_data")))])],1)]),o._v(" "),r("div",{staticClass:"section-header"},[r("div",{staticClass:"section-header-wrapper"},[r("div",{staticClass:"title"},[o._v(o._s(o.$t("PastEvents")))])])]),o._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isOfficialActivityListLoadingForInEnd,expression:"isOfficialActivityListLoadingForInEnd"}],ref:"inEndListRef",staticClass:"section-content"},[r("div",{staticClass:"official-activity-list"},o._l(o.officialActivityListInEnd,(function(t){return r("div",{key:t.id,staticClass:"official-activity-item",attrs:{"data-event":"click_official_activity_item","data-id":t.id},on:{click:function(e){return o.onOfficialActivityItemClick(t)}}},[r("div",{staticClass:"header-image",style:{backgroundImage:"url(".concat(t.cover,")")}},[r("div",{staticClass:"first-label"},[r("div",{staticClass:"countdown"},[r("Icon",{directives:[{name:"show",rawName:"v-show",value:!t.number_of_award,expression:"!item.number_of_award"}],staticClass:"countdown-icon",attrs:{name:"icon-event-time",size:"12",color:"#fff"}}),o._v(" "),r("span",{staticClass:"countdown-text"},[o._v(o._s(o.calcRemainingTime(t)))])],1)])]),o._v(" "),r("div",{staticClass:"main-content"},[r("div",{staticClass:"title"},[o._v(o._s(t.title))]),o._v(" "),r("div",{staticClass:"description"},[o._v(o._s(t.desc))])]),o._v(" "),r("div",{staticClass:"footer"},[r("div",{directives:[{name:"show",rawName:"v-show",value:1===t.total_reward_type,expression:"item.total_reward_type === 1"}],staticClass:"info-item award-info",staticStyle:{color:"#a55bd3"}},[r("img",{staticClass:"img-icon",attrs:{src:n(205)}}),o._v(" "),r("span",[o._v(o._s(o.$t("win_x_credits",{num:t.total_reward_pool})))])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2===t.total_reward_type,expression:"item.total_reward_type === 2"}],staticClass:"info-item award-info",staticStyle:{color:"#ffeaad"}},[r("img",{staticClass:"img-icon",attrs:{src:n(160)}}),o._v(" "),r("span",[o._v(o._s(o.$t("win_x_stamina",{num:t.total_reward_pool})))])]),o._v(" "),r("div",{staticClass:"info-item submission-info"},[r("Icon",{attrs:{name:"a-fuzhi1",size:"14"}}),o._v(" "),r("span",[o._v(o._s(t.virtual_participate_num+t.real_participate_num))])],1)])])})),0),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!(o.isOfficialActivityListLoadingForInEnd||null!==(e=o.officialActivityListInEnd)&&void 0!==e&&e.length),expression:"!isOfficialActivityListLoadingForInEnd && !officialActivityListInEnd?.length"}],staticClass:"no-content"},[r("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),o._v(" "),r("div",{staticClass:"no-content-text"},[o._v(o._s(o.$t("no_data")))])],1)])]),o._v(" "),r("keep-alive",[r("OfficialActivityDialog",{attrs:{visible:o.officialActivityDialogVisible,activityId:o.currentOfficialActivityId},on:{"update:visible":function(t){o.officialActivityDialogVisible=t}}})],1),o._v(" "),r("el-backtop",{attrs:{bottom:30,right:30}},[r("i",{staticClass:"el-icon-top"})])],1)}),[],!1,null,"65214606",null));e.default=K.exports;installComponents(K,{SvgIcon:n(115).default})},5754:function(t,e,n){"use strict";n.r(e);n(16),n(21),n(11),n(12),n(13);var o=n(30),r=n(120),c=n(3),l=n(2),d=(n(20),n(19),n(6),n(32),n(22),n(18),n(8),n(4),n(28),n(40),n(77),n(44),n(7),n(41),n(107)),h=n(36),v=n(39),f=n(1),m=n(250),_=n(3398),y=n(3192),w=n(3399),C=n(3400),k=n(3402),O=n(3404),x=n(609),I=n(595),S=n(64),D=(n(31),n(50),n(49),n(35)),L=n.n(D),P=n(10),j=n(112),$=n(93);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R={components:{ImgWaterFall:j.default},data:function(){return{formatEvaluation:$.e,formatNumberForeign:P.p,timeAgo:P.T,dialogVisible:!1,lastChatParams:{page:1,page_size:20},isHaveMore:!1,isDone:!1,loading:!1}},computed:M(M(M({},Object(f.e)("user",["cdnHost","userInfo"])),Object(f.c)("character",["lastChatRoleList"])),{},{isNsfw:function(){return function(t){return t.nsfw_level>5}}}),methods:M(M({},Object(f.d)("character",["SET_LAST_CHAT_ROLE_LIST"])),{},{renderName:function(t){return Object($.h)(this,t)},openModel:function(){this.dialogVisible=!0,this.lastChatParams.page=1,this.getRecentChatList(!0)},handleDel:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$EventBus.$emit("showDialog",{name:"HyConfirmModal",data:{title:this.$t("Tip"),content:this.$t("tavern1"),confirmCallback:function(){t.removeRole(e),localStorage.removeItem("translate_".concat(e.session_id))}}})},removeRole:function(t){var e=this;Object(h.delRecentChatList)({character_id:t.character.id}).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r=e.lastChatRoleList.findIndex((function(e){return e.character.id===t.character.id}));if(-1!==r){var c=L()(e.lastChatRoleList);c.splice(r,1),e.SET_LAST_CHAT_ROLE_LIST(c),e.$message.success(e.$t("deleteSuccess"))}}}))},handleClose:function(){this.isDone=!1,this.dialogVisible=!1},handleEdit:function(){this.isDone=!this.isDone,this.$logEvent("log_actions",{operation:"click_edit",behavior_info:"on_tavern_page"})},handleNsfwClick:function(){this.$hyConfirm({content:this.$t("chara_chat_rej_hint"),btnList:["confirm"]})},handelChat:function(t){this.isDone||(this.handleClose(),this.$router.push(this.localePath("/aiChat/".concat(null==t?void 0:t.id))))},getRecentChatList:function(){var t=arguments,e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.length>0&&void 0!==t[0]&&t[0]&&e.SET_LAST_CHAT_ROLE_LIST([]),e.loading=!0,n.next=5,Object(h.getNewRecentChatList)(e.lastChatParams);case 5:o=n.sent,r=o.data.items,(c=void 0===r?[]:r).forEach((function(t){var e;t.stat=null==t||null===(e=t.character)||void 0===e?void 0:e.stat,1===t.nsfw&&(t.cover="https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp")})),e.loading=!1,l=L()(e.lastChatRoleList),e.SET_LAST_CHAT_ROLE_LIST(e.lastChatParams.page_size>1?l.concat(c):c),e.isHaveMore=c.length===e.lastChatParams.page_size;case 13:case"end":return n.stop()}}),n)})))()},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.cyberBarRecentlyBody,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.lastChatParams.page+=1,this.getRecentChatList())}}})},A=R,E=(n(5543),n(0)),component=Object(E.a)(A,(function(){var t=this,e=t._self._c;return e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cyberBar-dialog",attrs:{"close-on-click-modal":!1,title:"",visible:t.dialogVisible,top:"10px","show-close":!1,"append-to-body":!0,"destroy-on-close":""},on:{"update:visible":function(e){t.dialogVisible=e},"before-close":t.handleClose}},[e("div",{staticClass:"cyberBar-recently-pop-header"},[e("div",{staticClass:"btn",on:{click:t.handleEdit}},[e("i",{class:t.isDone?"el-icon-check":"el-icon-edit"}),t._v(" "),e("span",[t._v(t._s(t.$t(t.isDone?"Done":"Edit")))])]),t._v(" "),e("div",{staticClass:"title"},[t._v(t._s(t.$t("LastChat")))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:t.handleClose}})]),t._v(" "),e("div",{ref:"cyberBarRecentlyBody",staticClass:"cyberBar-recently-pop-body",on:{scroll:t.isScrollBottom}},t._l(t.lastChatRoleList,(function(n,o){var r,c,l,d,h,v,f,m;return e("div",{key:n.id+o,staticClass:"role-item",class:{"nsfw-restricted":t.isNsfw(n)}},[e("div",{staticClass:"role-item-header"},[t._v("\n        "+t._s(t.renderName(n.character))+"\n      ")]),t._v(" "),t.isNsfw(n)?e("div",{staticClass:"nsfw-overlay",on:{click:t.handleNsfwClick}},[t.isDone?e("div",{staticClass:"delete-icon flex-center",on:{click:function(e){return e.stopPropagation(),t.handleDel(n)}}},[e("i",{staticClass:"el-icon-close"})]):t._e()]):e("div",{staticClass:"role-item-content"},[t.isDone?e("div",{staticClass:"delete-icon flex-center",on:{click:function(e){return t.handleDel(n)}}},[e("i",{staticClass:"el-icon-close"})]):t._e(),t._v(" "),e("div",{staticClass:"role-item-left"},[e("div",{staticClass:"role-item-left-img"},[n.nsfw?e("ImgWaterFall",{style:{transition:"all 0.3s ease-in-out"},attrs:{isHeight:!1,item:n}}):t._e(),t._v(" "),null!=n&&null!==(r=n.character)&&void 0!==r&&r.unread_num?e("span",{staticClass:"cyber-pub-notification-badge"},[t._v("\n              "+t._s(null==n||null===(c=n.character)||void 0===c?void 0:c.unread_num)+"\n            ")]):t._e()],1),t._v(" "),e("div",{staticClass:"role-item-left-info"},[null!=n&&null!==(l=n.character)&&void 0!==l&&l.latest_time?e("div",{staticClass:"role-item-left-info-time"},[e("i",{staticClass:"el-icon-time"}),t._v(" "),e("span",[t._v(t._s(t.timeAgo(null==n||null===(d=n.character)||void 0===d?void 0:d.latest_time)))])]):t._e(),t._v(" "),e("div",{staticClass:"role-item-left-info-stat"},[e("i",{staticClass:"iconfont icon-users-solid imgBox-num-item-icon"}),t._v(" "),e("span",[t._v(t._s(t.formatNumberForeign((null==n||null===(h=n.stat)||void 0===h?void 0:h.num_of_token)||(null==n||null===(v=n.character)||void 0===v||null===(v=v.stat)||void 0===v?void 0:v.num_of_token)||0)))])])])]),t._v(" "),e("div",{staticClass:"role-item-right"},[e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[e("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},domProps:{innerHTML:t._s(t.formatEvaluation(null===(f=n.character)||void 0===f?void 0:f.evaluation))},slot:"content"}),t._v(" "),e("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.formatEvaluation(null===(m=n.character)||void 0===m?void 0:m.evaluation))}})]),t._v(" "),e("div",{staticClass:"role-item-right-btn flex-center",class:{disabled:t.isDone}},[e("div",{on:{click:function(e){return t.handelChat(n)}}},[t._v("\n              "+t._s(t.$t("Continue"))+"\n            ")])])],1)])])})),0)])}),[],!1,null,"285bf187",null),B=component.exports;function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(component,{ImgWaterFall:n(112).default});var U={mixins:[n(45).a],props:{},components:{CyberBarRecentlyPop:B,ImgWaterFall:j.default},data:function(){return{formatNumberForeign:P.p,lastChatParams:{page:1,page_size:40},isHaveMore:!1,stickyStyle:{}}},computed:F(F(F(F(F({},Object(f.c)("user",["isLoggedIn","characterUnReadNum"])),Object(f.e)("user",["userInfo"])),Object(f.e)("app",["topBanner"])),Object(f.c)("character",["lastChatRoleList"])),{},{isNsfw:function(){return function(t){return t.nsfw_level>5}},homeLastChatRoleList:function(){var t=L()(this.lastChatRoleList);return t.length>5?t.slice(0,5):t},renderCharacterUnReadNum:function(){if(!this.characterUnReadNum)return 0;var t=this.homeLastChatRoleList.reduce((function(t,e){var n;return t+((null==e||null===(n=e.character)||void 0===n?void 0:n.unread_num)||0)}),0);return this.characterUnReadNum-t}}),mounted:function(){this.getRecentChatList()},watch:{$route:function(){document.querySelectorAll(".el-popover").forEach((function(t){t.style.display="none"}))},isLoggedIn:function(t){t&&this.getRecentChatList()}},methods:F(F({},Object(f.d)("character",["SET_LAST_CHAT_ROLE_LIST"])),{},{renderName:function(t){return Object($.h)(this,t)},addScrollListener:function(){(document.documentElement.scrollTop||document.body.scrollTop)>=180?this.stickyStyle={position:"fixed",top:this.topBanner?"120px":"75px",right:"15px"}:this.$set(this,"stickyStyle",{})},getRecentChatList:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$route.params.ptype,!t.isLoggedIn||"cyberPub"!==n){e.next=10;break}return e.next=4,Object(h.getNewRecentChatList)(t.lastChatParams);case 4:o=e.sent,r=o.data.items,(c=void 0===r?[]:r).forEach((function(t){var e;t.stat=null==t||null===(e=t.character)||void 0===e?void 0:e.stat,1===t.nsfw&&(t.cover="https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp")})),t.SET_LAST_CHAT_ROLE_LIST(c),t.isHaveMore=c.length>5;case 10:case"end":return e.stop()}}),e)})))()},handleClickToDetails:function(t){this.$router.push(this.localePath("/cyberPubPage/".concat(t)))},goChat:function(t){this.$router.push(this.localePath("/aiChat/".concat(t)))},addCyber:function(){this.$router.push(this.localePath("/cyberPubPage/new-character")),this.$logEvent("log_actions",{operation:"click_navtoolnew",behavior_info:"on_tavern_page"})},getMore:function(){this.$refs.cyberBarRecentlyPop.openModel(),this.$logEvent("log_actions",{operation:"click_navtoolmore",behavior_info:"on_tavern_page"})},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.character.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},handleNsfwClick:function(){this.$hyConfirm({content:this.$t("chara_chat_rej_hint"),btnList:["confirm"]})}}),beforeDestroy:function(){}},H=(n(5544),Object(E.a)(U,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"cyberBarRecently",style:{top:"120px"}},[e("div",{staticClass:"cyberBarRecently-box"},[e("el-tooltip",{attrs:{effect:"light",content:t.$t("NewDigitalPerson"),placement:"top-start"}},[e("i",{staticClass:"el-icon-circle-plus icon",on:{click:t.addCyber}})]),t._v(" "),t.homeLastChatRoleList&&t.homeLastChatRoleList.length>0?e("el-tooltip",{attrs:{effect:"light",content:t.$t("recently"),placement:"top-start"}},[e("span",{staticClass:"cyberBarRecently-box-text"},[t._v("\n        "+t._s(t.$t("recently"))+"\n      ")])]):t._e(),t._v(" "),t._l(t.homeLastChatRoleList,(function(n,o){var r,c,l,d,h,v,f,m,_,y,w,C;return e("div",{key:n.id+o,staticClass:"cyberBarRecently-box-item",class:{"nsfw-restricted":t.isNsfw(n)}},[null!=n&&null!==(r=n.character)&&void 0!==r&&r.unread_num?e("span",{staticClass:"cyber-pub-notification-badge"},[t._v("\n        "+t._s(null==n||null===(c=n.character)||void 0===c?void 0:c.unread_num)+"\n      ")]):t._e(),t._v(" "),t.isNsfw(n)?[e("div",{staticClass:"cyberBarRecently-box-item-img nsfw-gradient",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleNsfwClick.apply(null,arguments)}}})]:e("el-popover",{attrs:{width:"335","popper-class":"custom-popver",placement:"right",trigger:"hover"}},[e("div",{staticClass:"cyberBarRecently-box-item-img",attrs:{slot:"reference"},slot:"reference"},[e("img",{attrs:{src:null==n?void 0:n.cover,alt:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.goChat(n.id)}}})]),t._v(" "),e("div",{staticClass:"cyberBarRecently-hover",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.goChat(n.id)}}},[e("div",{staticClass:"imgBox"},[n.nsfw?e("ImgWaterFall",{style:{transition:"all 0.3s ease-in-out"},attrs:{isHeight:!1,item:n}}):t._e(),t._v(" "),e("div",{staticClass:"imgBox-num"})],1),t._v(" "),e("div",{staticClass:"name",attrs:{title:t.renderName(n.character)},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleClickToDetails(n.id)}}},[t._v("\n            "+t._s(t.renderName(n.character))+"\n          ")]),t._v(" "),e("div",{staticClass:"info"},[e("div",{staticClass:"bottom"},[e("div",{staticClass:"author"},[e("div",{staticClass:"author-box",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.otherUser(n)}}},[null!==(l=n.author)&&void 0!==l&&l.head?e("div",{staticClass:"authorHead"},[e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null===(d=n.author)||void 0===d?void 0:d.head,alt:null===(h=n.author)||void 0===h?void 0:h.name}})]):e("div",{staticClass:"authorHead"},[t._v("\n                    "+t._s(null===(v=n.author)||void 0===v?void 0:v.name[0])+"\n                  ")]),t._v(" "),e("div",{staticClass:"authorName"},[e("span",[t._v(t._s(null===(f=n.author)||void 0===f?void 0:f.name))])])]),t._v(" "),e("div",{staticClass:"imgBox-num-item",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.setCollect(n,"character")}}},[e("div",{staticClass:"imgBox-num-item-icon"},[e("i",{staticClass:"iconfont",class:t.setCollectData(n)})]),t._v(" "),e("span",{staticClass:"imgBox-num-item-text"},[t._v("\n                    "+t._s(t.formatNumberForeign((null===(m=n.character)||void 0===m||null===(m=m.stat)||void 0===m?void 0:m.num_of_collection)||(null==n||null===(_=n.character)||void 0===_||null===(_=_.stat)||void 0===_?void 0:_.num_of_collection)||0))+"\n                  ")])])]),t._v(" "),e("div",{staticClass:"item-content-tags"},t._l(null===(y=n.character)||void 0===y?void 0:y.categories,(function(n){return e("span",{key:n.id,staticClass:"item-content-tags-item"},[t._v("\n                  "+t._s(n.name)+"\n                ")])})),0)]),t._v(" "),e("div",{staticClass:"top"},[e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[e("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[t._v("\n                  "+t._s(null===(w=n.character)||void 0===w?void 0:w.evaluation)+"\n                ")]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(null===(C=n.character)||void 0===C?void 0:C.evaluation))])])],1)])])])],2)})),t._v(" "),t.homeLastChatRoleList&&t.homeLastChatRoleList.length>0?e("el-tooltip",{attrs:{effect:"light",content:t.$t("recentlyUsedTips"),placement:"top-start"}},[e("div",{staticClass:"cyberBarRecently-box-more",on:{click:t.getMore}},[e("i",{staticClass:"icon-a-arrowleft iconfont"}),t._v(" "),t.renderCharacterUnReadNum?e("span",{staticClass:"cyber-pub-notification-badge",on:{click:t.getMore}},[t._v("\n          "+t._s(t.renderCharacterUnReadNum)+"\n        ")]):t._e()])]):t._e()],2),t._v(" "),e("CyberBarRecentlyPop",{ref:"cyberBarRecentlyPop"})],1)}),[],!1,null,"8a200cca",null)),V=H.exports;installComponents(H,{ImgWaterFall:n(112).default});var z=n(3437),W=n(3405),G=n(3406),Y=n(3407),K=n(3409),J=n(48),X=n(3411);function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt={name:"HyShortcutPanel",mixins:[n(5552).a],data:function(){return{shortcutList:[{title:"imageGeneration",desc:"home_short_panel_desc1",btnText:"Generate",icon:"https://image.cdn2.seaart.me/images/home/shortcutIcon1.webp",bg:"https://image.cdn2.seaart.me/image/home/shortcutBg1.webp",value:"imageGeneration"},{title:"videoGeneration",desc:"home_short_panel_desc2",btnText:"Generate",icon:"https://image.cdn2.seaart.me/images/home/shortcutIcon2.webp",bg:"https://image.cdn2.seaart.me/image/home/shortcutBg2.webp",value:"videoGeneration"},{title:"Tavern",desc:"home_short_panel_desc3",btnText:"ChatNow",icon:"https://image.cdn2.seaart.me/images/home/shortcutIcon3.webp",bg:"https://image.cdn2.seaart.me/image/home/shortcutBg3.webp",value:"tavern"},{title:"Swtft_App",desc:"home_short_panel_desc4",btnText:"Generate",icon:"https://image.cdn2.seaart.me/images/home/shortcutIcon8.webp",bg:"https://image.cdn2.seaart.me/image/home/shortcutBg4.webp",value:"Swtft_App"}]}},computed:Z(Z({},Object(f.e)("app",["ABInfo"])),{},{isHome:function(){return"recommendPage"===this.getRouteBaseName()},list:function(){var t=this;return this.shortcutList.filter((function(e){var n=e.value;return"tavern"===n?!t.$isChinaSite&&!Object(J.a)(t):"Swtft_App"!==n||t.$isChinaSite}))}}),components:{StarFlow:X.default},methods:{handleClick:function(t){var e=t.value;this.$logEvent("log_actions",{operation:"click_"+e,behavior_info:"on_homepage",behavior_info_sub:"top_navigation_bar"}),"tavern"===e?this.mix_jumpCharacter(this.mix_characterId):"Swtft_App"===e?this.$router.push(this.localePath("/swift_app")):this.$EventBus.$emit("openGenerate",{action:1,data:{portalParams:{targetTab:"imageGeneration"===e?"generateImage":"generateVideo"}}})}}},et=(n(5553),Object(E.a)(tt,(function(){var t,e=this,n=e._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:"A"===(null===(t=e.ABInfo)||void 0===t?void 0:t.home_shortcut)&&e.isHome,expression:"ABInfo?.home_shortcut === 'A' && isHome"}],staticClass:"hy-shortcut-panel"},e._l(e.list,(function(t){return n("div",{key:t.title,staticClass:"panel-item",style:{backgroundImage:"url(".concat(t.bg,")")},attrs:{"data-id":t.value},on:{click:function(n){return e.handleClick(t)}}},[n("div",{staticClass:"item-title"},[e._v("\n      "+e._s(e.$t(t.title))+"\n    ")]),e._v(" "),n("div",{staticClass:"item-desc"},[e._v("\n      "+e._s(e.$t(t.desc))+"\n    ")]),e._v(" "),n("div",{staticClass:"item-btns"},[n("div",{staticClass:"btn"},[e._v("\n        "+e._s(e.$t(t.btnText))+"\n      ")])]),e._v(" "),n("div",{staticClass:"right-icon",class:{"tavern-icon":"tavern"===t.value}},[n("img",{attrs:{src:t.icon,alt:"icon"}}),e._v(" "),n("star-flow")],1)])})),0)}),[],!1,null,"6dc3f412",null).exports),it=n(1187),nt=n(864),at=n(3412),st=n(3414),ot=n(145),ct=n(81),lt=["content"];function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vt={inject:["app"],provide:function(){return{homePageApp:this}},name:"Home",mixins:[ot.a],components:{PageSeo:m.a,HyTagList:_.default,HyBannerList:y.default,HyQuickAppList:w.default,HyBlockList:C.default,HyEffectsList:k.default,HyRecentlyUsed:O.default,HyFeaturedList:x.default,HyHomeForms:I.default,HyWaterfallFlowList:S.default,CyberBarRecently:V,RecentlyRead:z.a,HyRankingGroup:W.default,HyRankingSingle:G.default,HyUserList:Y.default,HyWorkList:K.default,HyShortcutPanel:et,BottomFloatBtn:it.default,HyBannerCard:nt.default,HyTagBlockList:at.default,HyCreateInput:st.default},data:function(){return{hasInitialized:!1,isReq:!1,homeData:{},homeConfigAllData:{},queryParam:{offset:"",page:2,page_size:35},pageSEO:{title:"",meta_description:"",key_words:"",tempList:[]},pageSEOSwitch:!1,waterList:[],checkDialogTimer:null}},computed:ht(ht(ht(ht({},Object(f.c)("user",["isLoggedIn","token"])),Object(f.e)("user",["adminOff"])),Object(f.e)("app",["ABInfo","bottomFloatBtnOffsetBottom"])),{},{isShowPageSEO:function(){var t;return(null===(t=this.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)&&!this.isLoggedIn},tagList:function(){return(this.homeData||{}).tag_items},runderComponent:function(){return function(t){return d.c[t]}},thePage:function(){var t=this.$route.params.ptype,e=this.$route.query.waterfall,n=d.m[e];return t||n||"/"},bottomFloatBtnCurrentLocationKey:function(){if(this.$route.name.includes("homePage")||this.$route.name.includes("recommendPage")){var t=this.$route.params.ptype;if("post"===t)return"home_post";if("cyberPub"===t)return"home_character";if(!t)return"home"}return""},isShowCyberBarRecently:function(){return"cyberPub"===this.thePage&&this.isLoggedIn},isShowWaterfall:function(){return(this.homeData||{}).content_type},isShowCreateInput:function(){var t;return"B"===(null===(t=this.ABInfo)||void 0===t?void 0:t.homepage_quick_task_gen)}}),watch:{"$route.query":{handler:function(t,e){var n=this.$route.query,o=n.openLoginDialog,r=n.u_code,c=n.chan_id,l=n.redirect;"undefined"!==String(r)&&this.updateUCode(r),c&&localStorage.setItem("channelInviteCode",c),"1"===o&&(this.isLoggedIn?this.$router.push(this.localePath(l||"/")):this.$EventBus.$emit("openLoginDialog",{redirect:l||"/"}))},immediate:!0},isLoggedIn:{handler:function(t){this.checkPagePermission(this.homeConfigAllData,this)}}},mounted:function(){this.getHomeViewerData(),this.locaConfigData(),this.getHomeViewerData()},activated:function(){this.locaConfigData()},deactivated:function(){this.hasInitialized=!1,this.clearDailyStaminaDialogTimer()},beforeDestroy:function(){this.hasInitialized=!1,this.clearDailyStaminaDialogTimer()},methods:{checkPagePermission:J.c,updateUCode:function(code){code&&Object(J.A)(code)},locaConfigData:function(){var t=this;if(!this.hasInitialized){this.hasInitialized=!0;var e=this.$cookies.get("isDeadline"),n=localStorage.getItem("homeConfigData"),o=(this.$route.params||{}).ptype,r=void 0===o?"/":o;if(0===Object.keys(this.homeConfigAllData).length&&(!n||n.length<10)){var c={parent_id:this.token?"home":"home_visitor",type:"page",active_id:r};Object(v.l)(c).then((function(e){var n=e.data.items.find((function(e){return t.isCurrentRoute(e.route)}))||{};localStorage.setItem("homeConfigData",JSON.stringify(e.data)),t.homeData=n,t.homeConfigAllData=e.data,t.app.getHomeConfig(t.homeConfigAllData),t.setPageData(),t.checkPagePermission(t.homeConfigAllData,t)}))}else{if(e){var l=JSON.stringify(this.homeConfigAllData);localStorage.setItem("homeConfigData",l),this.checkPagePermission(this.homeConfigAllData,this)}var d=localStorage.getItem("homeConfigData")||"{}";Object.keys(this.homeConfigAllData).length||(this.homeConfigAllData=JSON.parse(d),this.checkPagePermission(this.homeConfigAllData,this)),this.app.getHomeConfig(this.homeConfigAllData),this.setPageData()}var h=!this.waterList.length,f=2===this.queryParam.page;h&&f&&(this.queryParam.page=1,this.queryParam.offset="",this.getWaterfallList())}},setPageData:function(){var t=this,e=(this.homeConfigAllData||{}).items,n=void 0===e?[]:e,o=n.find((function(e){return t.isCurrentRoute(e.route)})),r=n.find((function(t){return"/"===t.route})),c=o||r||{};this.homeData=c,o?this.getElInfoFill():this.$router.replace(this.localePath("/"))},isCurrentRoute:function(t){var e=this.$route.params.ptype,n=void 0===e?"/":e;return"/"===n?"/"===t:t.includes(n)},getModulesFill:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).nextFn,n=JSON.parse(JSON.stringify(this.homeData)),o=n.modules,r=(void 0===o?[]:o).filter((function(t){return!t.elList})).map((function(t){return t.id}));if(r.length){var c={module_ids:r};Object(v.n)(c).then((function(e){var o,r,c=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[];n.modules.forEach((function(t){var e=c.find((function(sub){return sub.id===t.id}));e&&(t.elList=(null==e?void 0:e.items)||[])})),t.homeData=n,((null===(r=t.homeConfigAllData)||void 0===r?void 0:r.items)||[]).forEach((function(t){n.id===t.id&&(t.modules=n.modules)})),localStorage.setItem("homeConfigData",JSON.stringify(t.homeConfigAllData)),t.checkPagePermission(t.homeConfigAllData,t)}))}else e&&e()},getElInfoFill:function(){this.updateHomeConfigData()},updateHomeConfigData:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,v,f,param,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,o=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0"),l="".concat(o,"-").concat(r,"-").concat(c),e.next=7,Object(ct.l)({date:l});case 7:d=e.sent,v=t.homeData||{},f=v.modules,param=[],m=["account_followers","account_favorited","account_views"],(void 0===f?[]:f).forEach((function(em){var e=(null==em?void 0:em.elList)||[],n=[11,"11",12,"12"].includes(em.content_type);e.forEach((function(sub){if(n){var e=sub.metric_type,o=sub.child,r=void 0===o?[]:o,c=m.includes(e);r.forEach((function(t){var e={obj_id:(t||{}).id,obj_type:c?8:65};param.push(e)}))}else if(t.isDailyChallenge(sub))try{var data=d.data;sub.title=data.theme_activity.title,sub.sub_title=data.theme_activity.desc,sub.cover.url=data.theme_activity.cover}catch(t){console.log("error",t)}else if(t.isSingleActivityLink(sub)){var l=sub.id.split("/")||[],h={obj_id:l[l.length-1]||sub.id,obj_type:69};param.push(h)}else{var v=sub||{},f=v.id,_=v.obj_type,y={obj_id:f,obj_type:_};![60,61,6].includes(_)&&param.push(y)}}))})),h.getElinfoDynamic({items:param}).then((function(e){var n=((null==e?void 0:e.data)||{}).items,o=void 0===n?[]:n,r=JSON.parse(JSON.stringify(t.homeData)),c=function(t){var e=o.find((function(e){return e.id===t.id||t.id.includes(e.id)&&69===e.obj_type}))||{},n=t;return e&&(n.stat=e.stat||{},n.liked=e.liked||!1,n.followed=e.followed||!1,n.collect=e.collect||{}),n};r.modules.forEach((function(t){var e=(null==t?void 0:t.elList)||[];t.elList=e.map((function(t){var e,n=c(t);return null!==(e=n.child)&&void 0!==e&&e.length&&(n.child=n.child.map(c)),n}))})),t.homeData=r}));case 13:case"end":return e.stop()}}),e)})))()},isDailyChallenge:function(sub){if(null==sub||!sub.id)return!1;return sub.id.includes("event-center/daily")},isSingleActivityLink:function(sub){if(null==sub||!sub.id)return!1;var t=(sub.id.split("/")||[]).filter((function(t){return""!==t}));return 3===t.length&&"event-center"===t[0]&&""!==t[t.length-1]&&61===sub.obj_type},changeTags:function(t){this.$router.push(this.localePath(null==t?void 0:t.path))},getHomeViewerData:function(){var t,e=this,n=(null==this||null===(t=this.$route)||void 0===t?void 0:t.query).tpid;if(n){var o={page_id:n};h.getHomeViewerData(o).then((function(t){var n=(null==t?void 0:t.data)||{};e.homeData=n;var o=n.content_type,r=void 0===o?"squareMixRecommend":o,c=d.m[r],l=d.j[c];(0,h[l])({offset:"",page:1,page_size:35}).then((function(t){e.waterList=t.data.items||[]}))}))}},screenWaterList:function(){var t=this;this.isReq=!1,this.queryParam.page=1,this.queryParam.offset="",this.getWaterfallList({afterCall:function(){t.waterList=[]}})},getWaterfallList:function(){var t,e,n=this,o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).afterCall,r=null===(t=this.ABInfo)||void 0===t?void 0:t.home_waterfall_show;if(this.isShowWaterfall){var c=(null==this||null===(e=this.$route)||void 0===e?void 0:e.query).tpid;if(!this.isReq&&!c){this.isReq=!0;var l=this.$refs.HyHomeFormsRef.formData,d=this.$refs.HyHomeFormsRef.citemObj,param=ht(ht({},this.queryParam),l);-1!==this.adminOff&&(param.is_reviewer=1);var v=h[d[l.order_by]]||h.getWaterRecommend,f=this.$route.params.ptype,m=void 0===f?"/":f;"/"!==m||this.isLoggedIn||(v="recommend"===param.order_by?"A"===r?h.getWaterRecommend:h.getWaterArtworkRecommend:h.getWaterfallPost),"novel"===this.thePage&&delete param.offset,param.order_by=param.order_by_time||param.order_by,"ai-video"===m&&(param.artwork_types=[7]),v(param).then((function(t){o&&o(),n.queryParam.page++,n.queryParam.offset=t.data.has_more&&t.data.offset||"",n.waterList=n.waterList.concat(Object(P.o)(t.data.items,l.order_by)||[]),n.isReq=!1})).catch((function(){n.isReq=!1}))}}},switchPageSEO:function(){this.pageSEOSwitch=!this.pageSEOSwitch},clearDailyStaminaDialogTimer:function(){this.checkDialogTimer&&(clearTimeout(this.checkDialogTimer),this.checkDialogTimer=null)}},asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var n,c,l,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L,j,title,$,T,M,R,A,E,B,N,F,U,H,V,z,W,G,Y,K,J,X;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.store,c=t.$axios,l=t.app,h=t.params,v=t.error,t.req,f=t.redirect,e.prev=1,_=l.$cookies.get("T"),y=(new Date).getTime(),w=y+3e5,C=l.$cookies.get("locaExpire")||0,k=null===(m=n.state.app.ABInfo)||void 0===m?void 0:m.home_waterfall_show,O="undefined"===(O=(null==h?void 0:h.ptype)||"/")?"/":O,x={},I={name:d.h[O]||"recommendPage"},S=null,_){e.next=22;break}return e.next=16,c.$post("/api/v1/fast_ai/detail",I);case 16:D=e.sent,L=D.data,title=(j=L||{}).title,$=j.meta_description,T=j.key_words,M=j.module,R=(void 0===M?[]:M).map((function(t){var content=t.content;return ht(ht({},Object(r.a)(t,lt)),{},{content:JSON.parse(content)})})),S={tempList:R||[],title:title,meta_description:$,key_words:T},x.pageSEO=S;case 22:if(!(y<C&&_)){e.next=27;break}return l.$cookies.set("isDeadline",!1),e.abrupt("return",x);case 27:return l.$cookies.set("locaExpire",w),l.$cookies.set("isDeadline",!0),e.next=31,Promise.all([c.$post("/api/v1/square/component/config-v2",{parent_id:_?"home":"home_visitor",type:"page",active_id:O})]);case 31:if(A=e.sent,E=Object(o.a)(A,1),B=E[0].data,N=(B||{}).items,F="/"===O?"/":"/"+O,(U=(void 0===N?[]:N).find((function(t){return"home"===t.parent_id&&("/"!==t.route?t.route.includes(F):"/"===F)})))||"/"===O){e.next=39;break}return e.abrupt("return",f("/"));case 39:return H=d.m[U.content_type]||"/",V=d.i[H],"/"!==O||_||"B"!==k||(V="/api/v1/square/v3/post/list"),z=_?d.f[H]:d.g[H],k&&"/"===O&&!_&&(z="A"===k?d.f["/"]:d.g["/"]),W=z.order_by_time||z.order_by,G=d.k[H]||"",Y={page:1,page_size:35,order_by:W,time_from:z.time_from,time_to:z.time_to,offset:"",artwork_types:z.artwork_types},G&&(Y.ss=G),e.next=50,c.$post(V,Y);case 50:return K=e.sent,J=Object(P.o)(K.data.items,z.order_by)||[],X={offset:K.data.has_more&&K.data.offset||"",page:2,page_size:35},x={homeConfigAllData:B,homeData:U,waterList:J,queryParam:X},S&&(x.pageSEO=S),e.abrupt("return",x);case 56:e.next=62;break;case 58:e.prev=58,e.t0=e.catch(1),console.log("首页配置 -> asyncData错误啦：",e.t0),v({statusCode:404,message:e.t0});case 62:case"end":return e.stop()}}),e,null,[[1,58]])})))()},head:function(){var t=this.pageSEO,title=t.title,e=t.meta_description,n=t.key_words;title=this.$t(title||"newHomeTitle");var desc=this.$t(e||"newHomeDesc");return{title:title||"newHomeTitle",meta:[{hid:"description",name:"description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(n)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}}},pt=vt,ft=(n(5561),Object(E.a)(pt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"assemble-home-page",class:[["cyberPub","swift_app"].includes(e.thePage)&&"main-cyber",e.app.showMenu&&e.isLoggedIn&&"main-collect"]},[e.isShowCreateInput?e._e():n("HyShortcutPanel"),e._v(" "),e.$route.path.includes("novel")?n("RecentlyRead"):e._e(),e._v(" "),e._l(e.homeData.modules,(function(t,o){return n("div",{key:t.id},[e.isShowCreateInput&&[28,"28"].includes(t.content_type)?n("HyCreateInput",{attrs:{temp:t}}):e._e(),e._v(" "),[25,"25"].includes(t.content_type)?n("HyBannerCard",{attrs:{info:t}}):e._e(),e._v(" "),[6,"6"].includes(t.content_type)?n("HyTagList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}},on:{onChange:e.changeTags}}):e._e(),e._v(" "),[7,"7"].includes(t.content_type)?n("HyQuickAppList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[8,"8"].includes(t.content_type)?n("HyBannerList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[9,"9"].includes(t.content_type)?n("HyBlockList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[13,"13"].includes(t.content_type)?n("HyEffectsList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[11,"11"].includes(t.content_type)?n("HyRankingGroup",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[12,"12"].includes(t.content_type)?n("HyRankingSingle",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[21,"21"].includes(t.content_type)?n("HyUserList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[22,"22"].includes(t.content_type)?n("HyWorkList",{staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),[26,27,"26","27"].includes(t.content_type)?n("HyTagBlockList",{staticClass:"module-box dot-group",attrs:{displayType:"27"===t.content_type||27===t.content_type?"inner":"outer",temp:t,indexes:o,maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}}):e._e(),e._v(" "),n(e.runderComponent(t.content_type),{tag:"component",staticClass:"module-box dot-group",attrs:{temp:t,indexes:o,entityType:"class_module-box",maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData}}})],1)})),e._v(" "),n("HyHomeForms",{directives:[{name:"show",rawName:"v-show",value:e.isShowWaterfall,expression:"isShowWaterfall"}],ref:"HyHomeFormsRef",on:{onScreen:e.screenWaterList}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowWaterfall,expression:"isShowWaterfall"}],ref:"wraper",staticClass:"wraper"},[n("HyWaterfallFlowList",{ref:"HyWaterfallFlowListRef",attrs:{isNovel:"novel"===e.thePage,list:e.waterList,container:"wraper",maxHomeData:{homeConfigAllData:e.homeConfigAllData,homeData:e.homeData,HyHomeFormsRef:e.$refs.HyHomeFormsRef},waterAllListFn:function(){return e.waterList}},on:{load:e.getWaterfallList}}),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isReq,expression:"isReq"}],staticClass:"loadBox"})],1),e._v(" "),n("el-backtop",{style:{transition:"all 0.3s ease",marginBottom:"".concat(e.bottomFloatBtnOffsetBottom,"px")},attrs:{bottom:30,right:30}},[n("i",{staticClass:"el-icon-top"})]),e._v(" "),n("BottomFloatBtn",{attrs:{currentLocationKey:e.bottomFloatBtnCurrentLocationKey}}),e._v(" "),n("CyberBarRecently",{directives:[{name:"show",rawName:"v-show",value:e.isShowCyberBarRecently,expression:"isShowCyberBarRecently"}]}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowPageSEO,expression:"isShowPageSEO"}],staticClass:"page-info",class:{"open-info":e.pageSEOSwitch}},[n("div",{staticClass:"page-switch"},[n("i",{staticClass:"iconfont icon-icon-arrow3",on:{click:e.switchPageSEO}})]),e._v(" "),n("page-seo",{attrs:{tempList:null===(t=e.pageSEO)||void 0===t?void 0:t.tempList}})],1)],2)}),[],!1,null,"65a625db",null));e.default=ft.exports;installComponents(ft,{BottomFloatBtn:n(1187).default})},5760:function(t,e,n){"use strict";n.r(e);var o=n(30),r=n(3),c=(n(20),n(4),n(40),n(41),n(613)),l=n(430),d={props:{bList:{type:Array,default:function(){return[]}}},data:function(){return{bannerList:this.bList||[]}},mounted:function(){},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.a)();case 3:n=e.sent,o=n.data.items,r=void 0===o?[]:o,t.bannerList=r;case 7:return e.prev=7,t.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})))()},goDetail:function(t){this.$router.push(this.localePath("/blog/".concat(t.id)))}}},h=(n(5396),n(0)),v=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("el-carousel",{attrs:{"indicator-position":"outside",height:"420px",arrow:"never"}},t._l(t.bannerList,(function(n){return e("el-carousel-item",{key:n.id},[e("a",{staticClass:"banner",attrs:{href:t.localePath("/blog/".concat(n.seo_url))}},[e("div",{staticClass:"banner-left"},[e("img",{attrs:{src:n.cover,alt:n.title}})]),t._v(" "),e("div",{staticClass:"banner-right"},[e("span",{staticClass:"banner-right-top"},[t._v("\n          "+t._s(n.post_title)+"\n        ")]),t._v(" "),e("span",{staticClass:"banner-right-content"},[t._v("\n          "+t._s(n.meta_desc)+"\n        ")]),t._v(" "),e("div",{staticClass:"banner-right-bottom"},[e("div",[e("span",[t._v(t._s(n.author))])]),t._v(" "),e("div",[e("i",{staticClass:"el-icon-time"}),t._v(" "),e("span",[t._v(t._s(n.reading_duration)+" "+t._s(t.$t("blog_read")))])])])])])])})),1)}),[],!1,null,"66c8abc5",null).exports,f=(n(32),{components:{SwipeableList:n(52).default},props:{bList:{type:Array,default:function(){return[]}},cList:{type:Array,default:function(){return[]}}},data:function(){return{blogList:this.bList||[],categroyList:this.cList||[],tagList:[{icon:"icon-icon_All_",label:"All",value:"all",i18nKey:"blog_all"},{icon:"icon-a-icon_AIArtGuide_",label:"AI Art Guide",value:"aiArtGuide",i18nKey:"blog_aiArtGuide"},{icon:"icon-a-icon_AIVideoGuide_",label:"AI Video Guide",value:"aiVideoGuide",i18nKey:"blog_aiVideoGuide"},{icon:"icon-a-icon_TrainingGuide_",label:"Training Guide",value:"trainingGuide",i18nKey:"blog_trainingGuide"},{icon:"icon-icon_news_",label:"News",value:"news",i18nKey:"blog_news"},{icon:"icon-a-icon_AITools_",label:"AI Tools",value:"aiTools",i18nKey:"blog_aiTools"},{icon:"icon-icon-blog-voice_",label:"AI语音指南",value:"aiVoiceGuide",i18nKey:"blog_aiVoiceGuide"},{icon:"icon-icon-blog-tip_",label:"指南与技巧",value:"guides&tips",i18nKey:"blog_guides&tips"},{icon:"icon-icon-blog-review_",label:"评测",value:"review",i18nKey:"blog_review"}],currentIndex:0,paramsData:{keyword:"",category:"",page:1,page_size:30},loading:!1,itemScrollLeft:null}},computed:{getI18nKey:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.tagList.find((function(e){return e.value===t}));return e?e.i18nKey:"blog_".concat(t)}}},watch:{"paramsData.keyword":{handler:function(t){t&&!this.loading&&this.getBlogList()}}},mounted:function(){},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.b)({page:1,page_size:30});case 3:n=e.sent,o=n.data.categories,r=void 0===o?[]:o,t.categroyList=r;case 7:return e.prev=7,t.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})))()},getBlogList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(l.c)(t.paramsData);case 4:n=e.sent,o=n.data.items,r=void 0===o?[]:o,t.blogList=r;case 8:return e.prev=8,t.loading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,,8,11]])})))()},chooseTag:function(t,e){this.currentIndex=e,this.paramsData.category=t,this.getBlogList()},goDetail:function(t){this.$router.push(this.localePath("/blog/".concat(t.id)))},getAuthorName:function(t){return t?t.split("@")[0]:""}}}),m=f,_=(n(5397),Object(h.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"categroy"},[e("div",{staticClass:"categroy-title"},[e("div",{staticClass:"categroy-title-content"},[t._v("\n      "+t._s(t.$t("RecentPosts"))+"\n      "),e("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:t.$t("Search"),"suffix-icon":"el-icon-search"},model:{value:t.paramsData.keyword,callback:function(e){t.$set(t.paramsData,"keyword",e)},expression:"paramsData.keyword"}})],1)]),t._v(" "),e("div",{staticClass:"tag-list"},[e("SwipeableList",{attrs:{top:"0px",height:"50px",bntTop:"0px",listAlignItems:"flex-end",listGap:"14px",scrollLeftnum:t.itemScrollLeft}},t._l(t.tagList,(function(n,o){return e("div",{key:n.value,staticClass:"tag-list-item",class:{active:t.currentIndex===o},on:{click:function(e){return t.chooseTag(n.value,o)}}},[e("i",{staticClass:"iconfont",class:t.currentIndex===o?"".concat(null==n?void 0:n.icon,"selected"):"".concat(null==n?void 0:n.icon,"default")}),t._v(" "),e("span",[t._v(t._s(t.$t("".concat(n.i18nKey))))])])})),0)],1),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"categroy-list"},t._l(t.blogList,(function(n,o){return e("a",{key:o,staticClass:"categroy-list-item",attrs:{href:t.localePath("/blog/".concat(n.seo_url))}},[e("img",{staticClass:"categroy-list-item-img",attrs:{src:n.cover,alt:n.title}}),t._v(" "),e("span",{staticClass:"categroy-list-item-top"},[t._v("\n        "+t._s(t.$t("".concat(t.getI18nKey(null==n?void 0:n.category))))+"\n      ")]),t._v(" "),e("span",{staticClass:"categroy-list-item-content"},[t._v("\n        "+t._s(n.post_title)+"\n      ")]),t._v(" "),e("div",{staticClass:"categroy-list-item-bottom"},[e("div",[e("span",[t._v(t._s(t.getAuthorName(n.author)))])]),t._v(" "),e("div",[e("i",{staticClass:"el-icon-time"}),t._v(" "),e("span",[t._v(t._s(n.reading_duration)+" "+t._s(t.$t("blog_read")))])])])])})),0),t._v(" "),0!==t.blogList.length||t.loading?t._e():e("div",{staticClass:"defBox"},[e("img",{attrs:{src:n(753),alt:""}}),t._v(" "),e("span",[t._v(t._s(t.$t("no_data")))])])])}),[],!1,null,"3cf43910",null)),y=_.exports;installComponents(_,{SwipeableList:n(52).default});var w={components:{BlogHeader:c.a,FeaturedPosts:v,RecentPosts:y},data:function(){return{blogList:[],categroyList:[],bannerList:[]}},methods:{},head:function(){var title=this.$t("blog_title"),desc=this.$t("blog_decription");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,l,d,data,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,r=t.error,e.prev=1,e.next=4,Promise.all([n.$post("/api/v1/blog/category",{page:1,page_size:100}),n.$post("/api/v1/blog/home",{keyword:"",category:"",page:1,page_size:100}),n.$post("/api/v1/blog/banner",{})]);case 4:return c=e.sent,l=Object(o.a)(c,3),d=l[0].data,data=l[1].data,h=l[2].data,e.abrupt("return",{categroyList:(null==d?void 0:d.categories)||[],blogList:(null==data?void 0:data.items)||[],bannerList:(null==h?void 0:h.items)||[]});case 12:e.prev=12,e.t0=e.catch(1),console.log("blog -> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}},C=(n(5398),Object(h.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog"},[e("BlogHeader"),t._v(" "),e("div",{staticClass:"blog-title"},[e("span",{staticClass:"blog-title-content"},[t._v(t._s(t.$t("FeaturedPosts")))])]),t._v(" "),e("FeaturedPosts",{attrs:{bList:t.bannerList}}),t._v(" "),e("RecentPosts",{attrs:{bList:t.blogList,cList:t.categroyList}})],1)}),[],!1,null,"654388eb",null));e.default=C.exports},5763:function(t,e,n){"use strict";n.r(e);n(26),n(11),n(12),n(13),n(7);var o=n(2),r=(n(6),n(50),n(16),n(31),n(8),n(4),n(28),n(21),n(44),n(5710),n(1)),c=n(3),l=(n(20),n(19),n(297)),d=n(87);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={primary:1,standard:2,professional:3,master:4},m={name:"DiscountSubscriptionItem",props:{content:{type:Object,default:function(){}},SubscriptionType:{type:String,default:""},paymentData:{type:Object,default:function(){}},language:{type:String,default:"en"}},components:{HelpTip:l.default},data:function(){return{btnLoading:!1,useFree:!1}},computed:v(v({},Object(r.e)("payment",["paymentInfo","subThirdType"])),{},{isFreeTry:function(){var t;return null===(t=this.paymentData)||void 0===t?void 0:t.with_trial},getLanguage:function(){return{"zh-CN":"zhCN"===this.language,en:"en"===this.language}},isMonthly:function(){return"monthly"===this.SubscriptionType},isYearly:function(){return"yearly"===this.SubscriptionType},isSubscription:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)},getOriginalAmount:function(){var t,e=null===(t=this.paymentData)||void 0===t?void 0:t.local_price_web;if(e){var n=null==e?void 0:e.currency,o=null==e?void 0:e.price_old;return"".concat(n).concat(o)}return""},getNowAmount:function(){var t,e=null===(t=this.paymentData)||void 0===t?void 0:t.local_price_web;if(e){var n=null==e?void 0:e.currency,o=null==e?void 0:e.price;return"".concat(n).concat(o)}return""},getStamina:function(){var t=30*this.paymentData.every_day_temp_coins;return"".concat(t).concat(this.$t("tempCoins"))},getStaminaDay:function(){return"(".concat(this.paymentData.every_day_temp_coins).concat(this.$t("newShopTips15"),")")},getSubscriptionBtnDisabled:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.payRange;return!(2!==n||!this.isYearly||!e)||!(3!==n||!this.isMonthly||!e)},getBtnName:function(){return this.$t("acceptPrice")},isManageSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.productLevel;return e&&this.getMatch&&this.isSubscription&&f[this.content.value]===n},isUpgradePlan:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.productLevel;return e&&this.getMatch&&n<f[this.content.value]},isDowngradePlan:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.productLevel;return e&&this.getMatch&&n>f[this.content.value]},getMatch:function(){var t=this.paymentInfo.payRange,e=void 0===t?0:t,n=2===e&&this.isMonthly,o=3===e&&this.isYearly;return n||o},txtWithHtml:function(){var t=this;return function(e){return e.param?t.$t(e.i18nKey,{param:e.param}):t.$t(e.i18nKey)}}}),methods:v(v({},Object(r.b)("unsubscribe",["getUserStatus"])),{},{handlePurchase:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handlePurchase",t.paymentData),t.$logEvent("log_actions",{operation:"click_accept_the_quote",behavior_info:"on_unsubscribe_page"}),Object(d.q)({change_type:2,cp_product_id:t.paymentData.id,third_plat_type:t.subThirdType}).then((function(e){var n;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){t.$message.success(t.$t("discountUpdateSuccess",{planLevel:t.$t(t.content.label)})),t.$emit("updateSuccess");var o=setTimeout((function(){t.getUserStatus(),clearTimeout(o)}),300)}}));case 3:case"end":return e.stop()}}),e)})))()}})},_=(n(5673),n(0)),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return t.paymentData?e("div",{staticClass:"subscription-item"},[e("div",{staticClass:"header"},[e("div",{staticClass:"category"},[e("span",{staticClass:"category-tag"},[t._v(t._s(t.$t(t.content.label)))])]),t._v(" "),e("div",{staticClass:"price",class:t.getLanguage},[e("span",{staticClass:"now-amount"},[t._v("\n        "+t._s(t.getNowAmount)+"\n      ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n        "+t._s(t.$t("Month"))+"\n      ")])]),t._v(" "),e("div",{staticClass:"original-amount"},[t._v("\n      "+t._s(t.getOriginalAmount)+"\n    ")]),t._v(" "),e("div",{staticClass:"tip"},[t._v("\n      "+t._s(t.$t(t.isYearly?"SubscriptionYearlyTip":"SubscriptionMonthlyTip"))+"\n    ")]),t._v(" "),e("el-button",{staticClass:"subscription-btn",attrs:{loading:t.btnLoading},on:{click:t.handlePurchase}},[t._v("\n      "+t._s(t.getBtnName)+"\n    ")])],1),t._v(" "),e("div",{staticClass:"explanation"},[e("div",{staticClass:"top"},[e("div",{staticClass:"stamina"},[e("div",{staticClass:"stamina-text"},[t._v("\n          "+t._s(t.getStamina)+"\n        ")]),t._v(" "),e("div",{staticClass:"stamina-day"},[e("span",{staticClass:"stamina-day-text"},[t._v("\n            "+t._s(t.getStaminaDay)+"\n          ")]),t._v(" "),e("HelpTip",{staticClass:"help",attrs:{color:"rgba(255, 255, 255, 0.6)",content:t.$t("newShopTips13")}})],1)])]),t._v(" "),e("div",{staticClass:"content"},[t._l(t.content.benefits,(function(n){return[e("div",{key:n.i18nKey,staticClass:"item-terms"},[e("div",{staticClass:"icon-div"},[e("i",{staticClass:"icon",class:n.correct?"el-icon-check":"el-icon-close"})]),t._v(" "),e("div",{staticClass:"words-div"},[e("span",{domProps:{innerHTML:t._s(t.txtWithHtml(n))}}),t._v(" "),n.comingSoon?e("span",{staticClass:"coming-soon"},[t._v(" ("+t._s(t.$t("ComingSoon"))+") ")]):t._e()]),t._v(" "),n.helpI18nKey?e("div",{staticClass:"help-div"},[e("HelpTip",{staticClass:"help",attrs:{color:"rgba(177, 183, 204,0.6)",content:t.$t(n.helpI18nKey)}})],1):t._e()])]}))],2)])]):t._e()}),[],!1,null,"94116eec",null),y=component.exports;installComponents(component,{HelpTip:n(297).default});var w=n(1149);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"DiscountSubscription",components:{DiscountSubscriptionItem:y},data:function(){return{language:"",activeTab:"yearly",yearlData:[],monthData:[],btnLoading:!1,slicedIndex:0}},mounted:function(){this.getPaymentInfo();this.language=["zhCN","en"].includes(this.$i18n.locale)?localStorage.getItem("language")||this.$i18n.locale:"en",this.getGoodsData(),this.getSubUrlAndThirdType()},computed:k(k(k(k({},Object(r.e)("payment",["paymentInfo","subThirdType","subscriptionUrl"])),Object(r.c)("payment",["payRange"])),Object(r.c)("unsubscribe",["prevPlanId"])),{},{isSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.purchaseType;return e&&2===n},contents:function(){var t,e=w.a.filter((function(t){return!t.isFree}));return 1===(null===(t=this.monthData)||void 0===t?void 0:t.length)?e.slice(-1):e.slice(this.slicedIndex+1)}}),methods:k(k({},Object(r.b)("payment",["getPaymentInfo","getSubUrlAndThirdType","getSubscriptionList"])),{},{changeMethods:function(t){this.activeTab=t},getGoodsData:function(){var t=this,e=localStorage.getItem("goodsInfo");if(e){var n,data=JSON.parse(e);if(null==data||null===(n=data.discount_year)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.local_price_web)return void this.handleSubscribeData(data)}this.getSubscriptionList().then((function(e){t.handleSubscribeData(e.data)}))},handleSubscribeData:function(data){var t=this,e=data.discount_month,n=void 0===e?[]:e,o=data.discount_year,r=void 0===o?[]:o;if(["sub_yearly4","sub_monthly4"].includes(this.prevPlanId))this.monthData=[n.at(-1)],this.yearlData=[r.at(-1)];else{var c=0;if(2===this.payRange)c=n.findIndex((function(e){return e.id.includes(t.prevPlanId)}));else if(3===this.payRange)c=r.findIndex((function(e){return e.id.includes(t.prevPlanId)}));else if(4===this.payRange){c=(parseInt(this.prevPlanId.replace(/\D/g,""))||1)-1}this.slicedIndex=4===this.payRange?c:c+1,this.monthData=n.slice(this.slicedIndex),this.yearlData=r.slice(this.slicedIndex)}}})},x=(n(5674),Object(_.a)(O,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"subscription"},[e("div",{staticClass:"top"},[e("div",{staticClass:"subscription-methods"},[e("div",{staticClass:"yearly",class:{active:"yearly"===this.activeTab},on:{click:function(e){return t.changeMethods("yearly")}}},[t._v("\n        "+t._s(t.$t("PayYearly"))+"\n        "),e("div",{staticClass:"discount"},[t._v("\n          "+t._s(t.$t("SubsDiscount2"))+"\n          "),e("img",{staticClass:"img",attrs:{src:n(755),alt:"fire",loading:"lazy"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.payRange||4===t.payRange,expression:"payRange === 2 || payRange === 4"}],staticClass:"monthly",class:{active:"monthly"===this.activeTab},on:{click:function(e){return t.changeMethods("monthly")}}},[t._v("\n        "+t._s(t.$t("PayMonthly"))+"\n        "),e("div",{staticClass:"discount"},[t._v("\n          "+t._s(t.$t("SubsDiscount"))+"\n        ")])])])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"subscription-contents"},[t._l(t.contents,(function(content,n){return[e("DiscountSubscriptionItem",t._g({key:n,attrs:{content:content,SubscriptionType:t.activeTab,language:t.language,paymentData:"yearly"===t.activeTab?t.yearlData[n]:t.monthData[n]}},t.$listeners))]}))],2)])])}),[],!1,null,"a2508eb4",null).exports),I=n(258),S={name:"Unsub6Discount",components:{SubFooter:n(235).a,SubHead:I.a,DiscountSubscription:x},methods:{handleNext:function(){this.$emit("next-step","unsubFinal")},updateSuccess:function(){var t=this;this.$emit("click-close");var e=setTimeout((function(){t.$EventBus.$emit("showManageCancelDlg","discount"),clearTimeout(e)}),500)}}},D=(n(5675),Object(_.a)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-discount flex flex-col"},[e("SubHead",[t._v(t._s(t.$t("wannaDiscount")))]),t._v(" "),e("div",{staticClass:"main"},[e("DiscountSubscription",{on:{updateSuccess:t.updateSuccess}})],1),t._v(" "),e("SubFooter",{on:{confirm:t.handleNext},scopedSlots:t._u([{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("noAndUnsub"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"4892d187",null));e.default=D.exports},5764:function(t,e,n){"use strict";n.r(e);n(16),n(28),n(44);var o=n(3),r=n(2),c=(n(1113),n(47),n(453)),l=n.n(c),d=(n(1114),n(454)),h=n.n(d),v=(n(768),n(386)),f=n.n(v),m=(n(674),n(325)),_=n.n(m),y=(n(679),n(416)),w=n.n(y),C=(n(20),n(19),n(6),n(11),n(32),n(22),n(18),n(12),n(13),n(8),n(4),n(7),n(43),n(21),n(77),n(26),n(1)),k=n(81),O=n(36),x=n(116),I=n(52),S=n(464),D=n(64),L={name:"ActivityRulesDialog",props:{visible:{type:Boolean,default:!1},ruleContent:{type:String,default:""}},methods:{onCloseClick:function(){this.$emit("close")}}},P=(n(4829),n(0)),j=Object(P.a)(L,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"activity-rules-dialog",attrs:{visible:e.visible,width:"826px",top:"20vh","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"title-line"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("ActivityRules")))]),e._v(" "),n("div",{staticClass:"close-btn",on:{click:e.onCloseClick}},[n("Icon",{attrs:{name:"close",size:"16",color:"#ffffff"}})],1)]),e._v(" "),n("div",{staticClass:"rules-content",domProps:{innerHTML:e._s(null===(t=e.ruleContent)||void 0===t?void 0:t.replace(/\n/g,"<br><br>"))}})])}),[],!1,null,"9da331e8",null).exports,$=n(54),T=n(3183),M=n(636);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={name:"TabDaily",components:Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({ElAvatar:w.a},_.a.name,_.a),f.a.name,f.a),h.a.name,h.a),l.a.name,l.a),"CmtComments",x.default),"SwipeableList",I.default),"BaseCard",S.default),"HyWaterfallFlowList",D.default),"ActivityRulesDialog",j),mounted:function(){this.initActivityList(),this.initCountdownTimer()},beforeDestroy:function(){this.clearCountdownTimer()},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,data,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$axios,t.app,o=t.params,r=t.error,t.query,c=o.activityId,e.prev=2,!c){e.next=13;break}return e.next=6,n.$post("/api/v1/theme-activity/list",{size:1e3});case 6:if(l=e.sent,data=l.data,1e4===l.status.code){e.next=11;break}return e.abrupt("return");case 11:return d=data.items.find((function(t){return t.id===c})),e.abrupt("return",{activityName:(null==d?void 0:d.title)||""});case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.log("活动中心每日挑战-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))()},head:function(){var t=this.activeActivity.title||this.activityName,title=this.$t("EventCenterDailyTitle",{name:t}),desc=this.$t("EventCenterDailyDes",{name:t});return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},data:function(){return{scene:"",activityPostListStatus:"",isActivityListLoading:!1,activityList:[],activeActivity:{},activityName:"",activityRulesVisible:!1,countdownTimer:null,nowDate:new Date,isActivityDetailLoading:!1,activityDetail:{},isActivityPostListLoading:!1,activityPostList:[],commentTotal:0,isCommentShow:!0,isWaterfallLoading:!1,waterfallList:[],waterfallParam:{page:1,page_size:35,order_by:"day_hot",tag_ids:[]},waterfallHasMore:!0,waterfallFilterCategory:"",waterfallFilterCategoryOptions:[],waterfallFilterCategoryBaseOptions:[{value:4,label:this.$t("Explore"),httpFn:O.getWaterfallPost},{value:9,label:this.$t("Tavern"),httpFn:O.getWaterCharacter}]}},computed:A(A({},Object(C.c)("user",["isLoggedIn"])),{},{countdownText:function(){var t,e;if(null===(t=this.activeActivity)||void 0===t||!t.is_current||null===(e=this.activeActivity)||void 0===e||!e.date)return"00:00:00";var n=new Date(this.activeActivity.date),o=new Date(n.setDate(n.getDate()+1)).getTime()-this.nowDate.getTime();if(o<=0)return"00:00:00";var r=Math.floor(o/36e5),c=Math.floor(o%36e5/6e4),l=Math.floor(o%6e4/1e3);return"".concat(r.toString().padStart(2,"0"),":").concat(c.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"))},activityTitle:function(){var t,e=null===(t=this.activeActivity)||void 0===t?void 0:t.title;return{excellent:this.$t("featured_entries",{name:e}),award:this.$t("winning_entries",{name:e}),new:this.$t("Latest_Entries",{num:e})}[this.scene]||e},contributionTypes:function(){var t,e={4:$.CONTRIBUTION_TYPE_ENUM.WORK,9:$.CONTRIBUTION_TYPE_ENUM.CHARACTER};return(null===(t=this.activeActivity)||void 0===t||null===(t=t.post_type)||void 0===t?void 0:t.map((function(t){return e[t]})))||[]}}),watch:{activeActivity:{handler:function(t){var e=this;this.$router.replace({params:{activityId:t.id}}).catch((function(){})),this.isCommentShow=!1,this.$nextTick((function(){e.initActivityPostList(),e.initWaterfallList(),e.isCommentShow=!0}))}},"waterfallParam.order_by":{handler:function(){this.getInitWaterfallList()}},waterfallFilterCategory:{handler:function(){this.getInitWaterfallList()}}},methods:{initActivityList:function(){var t=this;this.isActivityListLoading=!0,Object(k.m)({size:1e3}).then((function(e){t.activityList=e.data.items||[],t.activeActivity=t.activityList.find((function(e){return e.id===t.$route.params.activityId}))||t.activityList.find((function(t){return t.is_current}))||{},t.getActivityDetail()})).finally((function(){t.isActivityListLoading=!1}))},initCountdownTimer:function(){var t=this;this.clearCountdownTimer(),this.countdownTimer=setInterval((function(){t.nowDate=new Date}),1e3)},clearCountdownTimer:function(){this.countdownTimer&&clearInterval(this.countdownTimer)},initActivityPostList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isActivityPostListLoading=!0,o={theme_activity_date:null===(n=t.activeActivity)||void 0===n?void 0:n.date,size:20,is_curated:!0},e.prev=2,e.next=5,Object(k.n)(o);case 5:l=e.sent,t.activityPostList=(null==l||null===(r=l.data)||void 0===r?void 0:r.items)||[],t.isActivityPostListLoading=!1,t.scene=null==l||null===(c=l.data)||void 0===c?void 0:c.scene,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),t.isActivityPostListLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()},initWaterfallList:function(){var t,e,n=this;this.waterfallHasMore=!0,this.waterfallParam.tag_ids=null!==(t=this.activeActivity)&&void 0!==t&&t.hide_tag_id?[this.activeActivity.hide_tag_id]:[],this.waterfallParam.order_by="day_hot",this.waterfallFilterCategory="",this.waterfallFilterCategoryOptions=this.waterfallFilterCategoryBaseOptions.filter((function(t){var e;return null===(e=n.activeActivity)||void 0===e||null===(e=e.post_type)||void 0===e?void 0:e.includes(t.value)})),null!==(e=this.waterfallFilterCategoryOptions)&&void 0!==e&&e.length&&this.$nextTick((function(){n.waterfallFilterCategory=n.waterfallFilterCategoryOptions[0].value}))},getInitWaterfallList:function(){var t,e,n,o=this;null!==(t=this.waterfallFilterCategoryOptions)&&void 0!==t&&t.length&&this.waterfallFilterCategory&&(this.waterfallParam.page=1,this.waterfallHasMore=!0,this.isWaterfallLoading=!0,null===(e=this.waterfallFilterCategoryOptions.find((function(t){return t.value===o.waterfallFilterCategory})))||void 0===e||e.httpFn(A(A({},this.waterfallParam),{},{order_by:"day_hot"===this.waterfallParam.order_by&&Object(T.a)(null===(n=this.activeActivity)||void 0===n?void 0:n.date)?"hot":this.waterfallParam.order_by})).then((function(t){var e,n;o.waterfallList=(null===(e=t.data)||void 0===e?void 0:e.items)||[],o.waterfallHasMore=null===(n=t.data)||void 0===n?void 0:n.has_more})).finally((function(){o.isWaterfallLoading=!1})))},getMoreWaterfallList:function(){var t,e,n,o=this;null!==(t=this.waterfallFilterCategoryOptions)&&void 0!==t&&t.length&&this.waterfallFilterCategory&&this.waterfallHasMore&&(this.waterfallParam.page++,this.isWaterfallLoading=!0,null===(e=this.waterfallFilterCategoryOptions.find((function(t){return t.value===o.waterfallFilterCategory})))||void 0===e||e.httpFn(A(A({},this.waterfallParam),{},{order_by:"day_hot"===this.waterfallParam.order_by&&Object(T.a)(null===(n=this.activeActivity)||void 0===n?void 0:n.date)?"hot":this.waterfallParam.order_by})).then((function(t){var e;o.waterfallList=o.waterfallList.concat(t.data.items||[]),o.waterfallHasMore=null===(e=t.data)||void 0===e?void 0:e.has_more})).finally((function(){o.isWaterfallLoading=!1})))},getActivityDetail:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.activeActivity)&&void 0!==n&&n.id){e.next=2;break}return e.abrupt("return");case 2:return t.isActivityDetailLoading=!0,e.prev=3,e.next=6,Object(k.l)({date:t.activeActivity.id});case 6:o=e.sent,t.activityDetail=o.data,t.isActivityDetailLoading=!1,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),t.isActivityDetailLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))()},onGoCreateClick:function(){var t,e;switch(null===(t=this.contributionTypes)||void 0===t?void 0:t[0]){case $.CONTRIBUTION_TYPE_ENUM.WORK:new M.a(this.$EventBus).openByParams(null===(e=this.activityDetail.limit_items)||void 0===e?void 0:e[0]);break;case $.CONTRIBUTION_TYPE_ENUM.CHARACTER:if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog");this.$router.push(this.localePath("/cyberPubPage/new-character"))}},onGoSubmitClick:function(){var t;null!==(t=this.activeActivity)&&void 0!==t&&t.is_current&&(this.isLoggedIn?this.$EventBus.$emit("openContribution",{types:this.contributionTypes,linkActivity:this.activeActivity}):this.$EventBus.$emit("openLoginDialog"))},onSeeMoreClick:function(){var t=this.$refs.waterfallRef.getBoundingClientRect().top+window.pageYOffset+-104;window.scrollTo({top:t,behavior:"smooth"})},handleCommentEnd:function(){this.$message({message:this.$t("commentSuc"),type:"success"})}}},B=(n(4830),n(4831),Object(P.a)(E,(function(){var t,e,o,r,c,l,d,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L,P,j,$,T,M=this,R=M._self._c;return R("div",{staticClass:"tab-event",attrs:{"data-group":"daily_center_tab_event_component"}},[R("section",{staticClass:"section-daily-theme"},[R("div",{staticClass:"section-header"},[R("p",{staticClass:"description"},[M._v(M._s(M.$t("Daily_Theme_D")))])]),M._v(" "),R("div",{directives:[{name:"loading",rawName:"v-loading",value:M.isActivityListLoading,expression:"isActivityListLoading"}],staticClass:"section-content"},[R("div",{staticClass:"date-selector"},M._l(M.activityList,(function(t){var e;return R("div",{key:t.id,staticClass:"date-selector-item",class:t.date===(null===(e=M.activeActivity)||void 0===e?void 0:e.date)?"active":"",attrs:{"data-event":"click_daily_theme_item"},on:{click:function(e){M.activeActivity=t}}},[R("div",{staticClass:"date-selector-item-wrapper"},[R("div",{staticClass:"theme-date"},[M._v(M._s(t.date))]),M._v(" "),R("div",{staticClass:"theme-name"},[R("svg-icon",{directives:[{name:"show",rawName:"v-show",value:t.is_current,expression:"item.is_current"}],attrs:{"icon-class":"fire"}}),M._v(" "),R("span",[M._v(M._s(t.title))])],1)])])})),0),M._v(" "),R("div",{staticClass:"theme-banner",style:{backgroundImage:"url(".concat(null===(t=M.activeActivity)||void 0===t?void 0:t.cover,")")}},[R("div",{staticClass:"theme-banner-wrapper"},[R("div",{staticClass:"rule-btn",on:{click:function(t){M.activityRulesVisible=!0}}},[M._v(M._s(M.$t("ActivityRules")))]),M._v(" "),R("div",{staticClass:"theme-title"},[R("span",{directives:[{name:"show",rawName:"v-show",value:null===(e=M.activeActivity)||void 0===e?void 0:e.title,expression:"activeActivity?.title"}]},[M._v("\n              "+M._s(M.$t("Todays_Theme",{num:null===(o=M.activeActivity)||void 0===o?void 0:o.title}))+"\n            ")])]),M._v(" "),R("div",{staticClass:"theme-description",domProps:{innerHTML:M._s(null===(r=M.activeActivity)||void 0===r||null===(r=r.desc)||void 0===r?void 0:r.replace(/\n/g,"<br>"))}}),M._v(" "),R("div",{staticClass:"btn-line"},[R("div",{directives:[{name:"show",rawName:"v-show",value:null===(c=M.activeActivity)||void 0===c?void 0:c.is_current,expression:"activeActivity?.is_current"},{name:"loading",rawName:"v-loading",value:M.isActivityDetailLoading,expression:"isActivityDetailLoading"}],staticClass:"go-create-btn",attrs:{"data-event":"click_create_btn"},on:{click:M.onGoCreateClick}},[R("div",{staticClass:"go-create-btn-wrapper"},[R("div",{staticClass:"text-wrapper"},[M._v(M._s(M.$t("toCreate")))])])]),M._v(" "),R("div",{staticClass:"go-submit-btn",class:null!==(l=M.activeActivity)&&void 0!==l&&l.is_current?"":"disabled",attrs:{"data-event":"click_submit_btn"},on:{click:M.onGoSubmitClick}},[R("div",{staticClass:"submit-btn-text"},[M._v(M._s(M.$t("Submit_Entries")))]),M._v(" "),R("div",{staticClass:"submit-btn-description"},[R("span",[M._v(M._s(M.$t("Participation_Rewards")))]),M._v(" "),1===(null===(d=M.activeActivity)||void 0===d?void 0:d.activity_status)?R("span",[M._v("？？？")]):[R("span",{directives:[{name:"show",rawName:"v-show",value:1===(null===(h=M.activeActivity)||void 0===h?void 0:h.reward_type),expression:"activeActivity?.reward_type === 1"}],staticClass:"submit-btn-award"},[R("el-avatar",{attrs:{size:18,shape:"square",src:n(205)}}),M._v("\n                    "+M._s(null===(v=M.activeActivity)||void 0===v?void 0:v.reward_num)+"\n                  ")],1),M._v(" "),R("span",{directives:[{name:"show",rawName:"v-show",value:2===(null===(f=M.activeActivity)||void 0===f?void 0:f.reward_type),expression:"activeActivity?.reward_type === 2"}],staticClass:"submit-btn-award"},[R("el-avatar",{attrs:{size:18,shape:"square",src:n(160)}}),M._v("\n                    "+M._s(null===(m=M.activeActivity)||void 0===m?void 0:m.reward_num)+"\n                  ")],1)]],2),M._v(" "),R("div",{directives:[{name:"show",rawName:"v-show",value:[1,2].includes(null===(_=M.activeActivity)||void 0===_?void 0:_.excellent_reward_type)&&(null===(y=M.activeActivity)||void 0===y?void 0:y.excellent_reward_num)>0,expression:"\n                  [1, 2].includes(activeActivity?.excellent_reward_type) && activeActivity?.excellent_reward_num > 0\n                "}],staticClass:"indicator",class:{"indicator-active":2===(null===(w=M.activeActivity)||void 0===w?void 0:w.activity_status)}},[R("div",{staticClass:"indicator-content"},[R("span",{staticClass:"indicator-text"},[R("span",[M._v(M._s(M.$t("excellent_reward")))]),M._v(" "),R("span",[M._v("\n                      "+M._s(1===(null===(C=M.activeActivity)||void 0===C?void 0:C.activity_status)?"？？？":null===(k=M.activeActivity)||void 0===k?void 0:k.excellent_reward_num)+"\n                    ")])]),M._v(" "),1!==(null===(O=M.activeActivity)||void 0===O?void 0:O.activity_status)?[R("img",{directives:[{name:"show",rawName:"v-show",value:1===(null===(x=M.activeActivity)||void 0===x?void 0:x.excellent_reward_type),expression:"activeActivity?.excellent_reward_type === 1"}],staticClass:"indicator-icon",attrs:{src:n(205)}}),M._v(" "),R("img",{directives:[{name:"show",rawName:"v-show",value:2===(null===(I=M.activeActivity)||void 0===I?void 0:I.excellent_reward_type),expression:"activeActivity?.excellent_reward_type === 2"}],staticClass:"indicator-icon",attrs:{src:n(160)}})]:M._e()],2),M._v(" "),R("div",{staticClass:"indicator-arrow"})])])]),M._v(" "),R("div",{directives:[{name:"show",rawName:"v-show",value:1!==(null===(S=M.activeActivity)||void 0===S?void 0:S.activity_status),expression:"activeActivity?.activity_status !== 1"}],staticClass:"countdown"},[R("div",{staticClass:"countdown-title"},[M._v(M._s(M.$t("Submission_Countdown")))]),M._v(" "),R("div",{staticClass:"countdown-time"},[M._v(M._s(M.countdownText))])])])])])]),M._v(" "),R("section",{staticClass:"section-latest-submission"},[R("div",{staticClass:"section-header"},[R("h2",{staticClass:"title"},[M._v(M._s(M.activityTitle))]),M._v(" "),R("div",{staticClass:"see-more",on:{click:M.onSeeMoreClick}},[M._v(M._s(M.$t("more"))+" >")])]),M._v(" "),R("div",{directives:[{name:"loading",rawName:"v-loading",value:M.isActivityPostListLoading,expression:"isActivityPostListLoading"}],staticClass:"section-content"},[R("SwipeableList",{attrs:{listGap:"16px",top:"0"}},M._l(M.activityPostList,(function(t,e){return R("BaseCard",{key:(t.id||"-")+e,attrs:{item:t,isWater:!1,imgW:"260px",imgH:"346px"}})})),1),M._v(" "),M.isActivityPostListLoading||null!==(D=M.activityPostList)&&void 0!==D&&D.length?M._e():R("div",{staticClass:"no-content"},[R("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),M._v(" "),R("div",{staticClass:"no-content-text"},[M._v(M._s(M.$t("no_data")))])],1)],1)]),M._v(" "),R("section",{staticClass:"section-comments"},[R("div",{staticClass:"section-header"},[R("h2",{staticClass:"title"},[M._v(M._s(M.$t("Discussions_on",{num1:null===(L=M.activeActivity)||void 0===L?void 0:L.title,num2:M.commentTotal})))])]),M._v(" "),M.isCommentShow?R("div",{staticClass:"section-content comment-list"},[R("CmtComments",{attrs:{infos:{id:null===(P=M.activeActivity)||void 0===P?void 0:P.date},type:22,inputPosition:"top"},on:{updateCountNum:function(t){return M.commentTotal=t},onCommentEnd:M.handleCommentEnd}})],1):M._e()]),M._v(" "),R("section",{ref:"waterfallRef",staticClass:"section-all-submission"},[R("div",{staticClass:"section-header"},[R("h2",{staticClass:"title"},[M._v(M._s(M.$t("All_Entries",{num:null===(j=M.activeActivity)||void 0===j?void 0:j.title})))]),M._v(" "),R("div",{staticClass:"filter-widget"},[R("div",{staticClass:"sort"},[R("el-radio-group",{model:{value:M.waterfallParam.order_by,callback:function(t){M.$set(M.waterfallParam,"order_by",t)},expression:"waterfallParam.order_by"}},[R("el-radio-button",{attrs:{label:"day_hot"}},[M._v(M._s(M.$t("Hot")))]),M._v(" "),R("el-radio-button",{attrs:{label:"new"}},[M._v(M._s(M.$t("New")))])],1)],1),M._v(" "),R("div",{staticClass:"category"},[R("el-select",{attrs:{"popper-class":"event-center-waterfall-category-popper"},model:{value:M.waterfallFilterCategory,callback:function(t){M.waterfallFilterCategory=t},expression:"waterfallFilterCategory"}},M._l(M.waterfallFilterCategoryOptions,(function(t){return R("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])]),M._v(" "),M.isActivityListLoading?M._e():R("div",{staticClass:"section-content"},[R("div",{ref:"waterfallWrapperRef"},[R("HyWaterfallFlowList",{attrs:{list:M.waterfallList,container:"waterfallWrapperRef",waterAllListFn:function(){return M.waterfallList}},on:{load:M.getMoreWaterfallList}}),M._v(" "),R("div",{directives:[{name:"loading",rawName:"v-loading",value:M.isWaterfallLoading,expression:"isWaterfallLoading"}]})],1),M._v(" "),M.isActivityPostListLoading||null!==($=M.activityPostList)&&void 0!==$&&$.length?M._e():R("div",{staticClass:"no-content"},[R("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),M._v(" "),R("div",{staticClass:"no-content-text"},[M._v(M._s(M.$t("no_data")))])],1)])]),M._v(" "),R("ActivityRulesDialog",{attrs:{visible:M.activityRulesVisible,ruleContent:null===(T=M.activeActivity)||void 0===T?void 0:T.rule},on:{close:function(t){M.activityRulesVisible=!1}}}),M._v(" "),R("el-backtop",{attrs:{bottom:30,right:30}},[R("i",{staticClass:"el-icon-top"})])],1)}),[],!1,null,"780e1e70",null));e.default=B.exports;installComponents(B,{SvgIcon:n(115).default,SwipeableList:n(52).default,CmtComments:n(116).default})},5765:function(t,e,n){"use strict";n.r(e);var o=n(3),r=n(2),c=(n(679),n(47),n(416)),l=n.n(c),d=(n(20),n(19),n(6),n(22),n(31),n(18),n(11),n(12),n(13),n(8),n(7),n(4),n(43),n(77),n(34)),h=n(1),v=n(147),f=n(163),m=n(317),_=n(10),y={name:"InvitationRecordDialog",props:{visible:{type:Boolean,default:!1}},data:function(){return{inviteList:[],inviteListLoading:!1}},watch:{visible:function(t){t&&this.getInviteList()}},methods:{getInviteList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.inviteListLoading=!0,e.next=3,Object(v.h)();case 3:n=e.sent,t.inviteList=n.data.List,t.inviteListLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},onCloseClick:function(){this.$emit("close")},formatTimestamp:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),c=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0");return"".concat(n,"-").concat(o,"-").concat(r," ").concat(c,":").concat(l)}}},w=(n(4832),n(0)),component=Object(w.a)(y,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"invitation-record-dialog",attrs:{visible:e.visible,width:"558px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"title-line"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("Invitation_Records")))]),e._v(" "),n("div",{staticClass:"close-btn",on:{click:e.onCloseClick}},[n("Icon",{attrs:{name:"close",size:"16",color:"#ffffff"}})],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.inviteListLoading,expression:"inviteListLoading"}],staticClass:"invite-list"},[null!==(t=e.inviteList)&&void 0!==t&&t.length||e.inviteListLoading?e._e():n("div",{staticClass:"invite-empty"},[n("svg-icon",{staticClass:"empty-icon",attrs:{"icon-class":"invitation-empty"}}),e._v(" "),n("div",{staticClass:"empty-text"},[e._v(e._s(e.$t("no_data")))])],1),e._v(" "),e._l(e.inviteList,(function(t){var o,r;return n("div",{key:t.id,staticClass:"invite-item"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:null==t||null===(o=t.to_account_info)||void 0===o?void 0:o.avatar,alt:""}})]),e._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"top-line"},[n("div",{staticClass:"user-name"},[e._v(e._s(null==t||null===(r=t.to_account_info)||void 0===r?void 0:r.name))]),e._v(" "),n("div",{staticClass:"time"},[e._v(e._s(e.formatTimestamp(null==t?void 0:t.create_at)))])]),e._v(" "),n("div",{staticClass:"user-line"},[n("span",[e._v("UserID: ")]),e._v(" "),n("span",[e._v(e._s(null==t?void 0:t.to_account_id))])])])])}))],2)])}),[],!1,null,"7627367e",null),C=component.exports;installComponents(component,{SvgIcon:n(115).default});var k=n(167);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I={name:"TabTask",components:{ElAvatar:l.a,InviteDialog:m.default,InvitationRecordDialog:C},head:function(){var title=this.$t("EventCenterTaskTitle"),desc=this.$t("EventCenterTaskDes");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},activated:function(){this.initActivityCheckInInfo(),this.initTaskList(),this.getPaymentInfo(),this.initWaitTakeNum()},mounted:function(){localStorage.getItem("userInfo")?this.SET_USER_INFO(JSON.parse(localStorage.getItem("userInfo"))):this.SET_USER_INFO({}),this.initActivityCheckInInfo(),this.initTaskList(),this.getPaymentInfo(),this.initWaitTakeNum()},data:function(){return{TASK_CATEGORY_TYPE:k.a,TASK_PROGRESS_STATUS:k.b,checkInList:[],checkInListLoading:!1,taskList:[],taskListLoading:!1,invitationRecordDialogVisible:!1}},computed:x(x(x(x(x({},Object(h.e)("app",["ABInfo"])),Object(h.e)("user",["userInfo","cdnHost"])),Object(h.e)("payment",["paymentInfo"])),Object(h.c)("user",["isLoggedIn"])),{},{canClaim:function(){var t=new Date,e="".concat(t.getUTCFullYear()).concat((t.getUTCMonth()+1).toString().padStart(2,"0")).concat(t.getUTCDate().toString().padStart(2,"0"));return this.checkInList.some((function(t){return t.date===e&&!t.is_finish}))},inviteTaskList:function(){return this.taskList.slice(0,4).map((function(t){return Object(d.reactive)(x(x({},t),{},{isLoading:!1}))}))},otherTaskList:function(){return this.taskList.slice(4).map((function(t){return Object(d.reactive)(x(x({},t),{},{isLoading:!1}))}))},cumulativeInviteNum:function(){var t;return(null===(t=this.inviteTaskList)||void 0===t||null===(t=t[3])||void 0===t||null===(t=t.finish_info)||void 0===t?void 0:t.finish_num)||0},cumulativeInviteIncome:function(){return this.inviteTaskList.filter((function(t){return Object(k.d)(t).id===k.b.alreadyTake.id})).reduce((function(t,e){return t+e.award_num}),0)},inviteProgressPercent:function(){var t=this.inviteTaskList.filter((function(t){return Object(k.d)(t).id===k.b.alreadyTake.id}));return 0===t.length?"0%":1===t.length?"22%":2===t.length?"50%":3===t.length?"78%":4===t.length?"100%":void 0},shareUrl:function(){var t=(this.userInfo.name||this.userInfo.id)+" "+this.$t("shareText"),e="".concat(window.location.origin,"/u/").concat(this.userInfo.invite_user_code);return"".concat(t,"\r\n").concat(e)}}),watch:{isLoggedIn:function(){this.initActivityCheckInInfo(),this.initTaskList()}},methods:x(x(x({},Object(h.d)("user",["setOpenEdit","setWaitTakeNum","SET_USER_INFO"])),Object(h.b)("payment",["getPaymentInfo"])),{},{calcTaskCategoryType:k.c,calcTaskProgressStatus:k.d,formatNumberForeign:_.p,initActivityCheckInInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=2;break}return e.abrupt("return");case 2:return t.checkInListLoading=!0,e.next=5,Object(f.d)();case 5:n=e.sent,t.checkInList=n.data.week_item_list,t.checkInListLoading=!1;case 8:case"end":return e.stop()}}),e)})))()},initTaskList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.taskListLoading=!0,e.next=3,Object(v.e)();case 3:n=e.sent,t.taskList=n.data,t.taskListLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},initWaitTakeNum:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.n)();case 2:1e4===(n=e.sent).status.code&&t.setWaitTakeNum(n.data.num);case 4:case"end":return e.stop()}}),e)})))()},onClaimClick:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.canClaim){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoggedIn){e.next=5;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 5:return t.$logEvent("log_actions",{operation:"click_claim",behavior_info:"activity_center_tasklist_popup",behavior_info_sub:"check_in"}),t.checkInListLoading=!0,e.next=9,Object(f.a)();case 9:return e.next=11,t.initActivityCheckInInfo();case 11:t.checkInListLoading=!1,t.initWaitTakeNum(),t.getPaymentInfo();case 14:case"end":return e.stop()}}),e)})))()},onInviteNowClick:function(){if(this.isLoggedIn){var t=Math.floor(8*Math.random())+1,e="https://".concat(this.cdnHost,"/Invite-images/invite_poster_").concat(t,".png"),n="".concat(window.location.origin)+this.localePath("/?u_code="+this.userInfo.invite_user_code);this.$logEvent("web_invite_click"),this.$refs.inviteDialogRef.show(this.shareUrl,e,n)}else this.$EventBus.$emit("openLoginDialog")},onTaskCardOperateBtnClick:function(t){Object(k.d)(t).id!==k.b.alreadyTake.id&&(Object(k.d)(t).id===k.b.waitTake.id&&this.handleAwardTake(t),Object(k.d)(t).id===k.b.waitComplete.id&&this.handleGoCompleteTask(t))},handleAwardTake:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isLoading=!0,n.prev=1,n.next=4,Object(v.c)({award_id:t.id});case 4:if(1e4===(o=n.sent).status.code){n.next=13;break}if(40009!==o.status.code){n.next=11;break}return e.$message.error(e.$t("error_code_40009")),n.abrupt("return");case 11:return(null==o||null===(r=o.status)||void 0===r?void 0:r.msg)&&e.$message.error(o.status.msg),n.abrupt("return");case 13:e.$message.success(e.$t("ClaimSucceess")),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(1),console.error(n.t0);case 19:return n.prev=19,e.initWaitTakeNum(),e.getPaymentInfo(),e.initTaskList(),t.isLoading=!1,n.finish(19);case 25:case"end":return n.stop()}}),n,null,[[1,16,19,25]])})))()},handleGoCompleteTask:function(t){var e=this;if(this.isLoggedIn)switch(this.$logEvent("log_actions",{operation:"click_go_to_finish",behavior_info:"on_task_center_page"}),t.go_type){case"page":"/personal"==t.go_url&&this.setOpenEdit(1),this.$router.push(this.localePath(t.go_url));break;case"popup":this.handlePopupTypeTask(t.go_url);break;case"view":this.$router.push(this.localePath("/?makeTask=1"));break;case"show_ad":this.$EventBus.$emit("showRewardsModel",{call:this.initTaskList});break;case"link":window.open(t.go_url),t.isLoading=!0,Object(v.l)().then((function(t){1e4===t.status.code&&e.initTaskList()})).finally((function(){t.isLoading=!1}))}else this.$EventBus.$emit("openLoginDialog")},handlePopupTypeTask:function(t){if("task_artwork"===t)this.$EventBus.$emit("openGenerate",{action:1,data:""});else this.$EventBus.$emit("openContribution")}})},S=(n(4833),Object(w.a)(I,(function(){var t,e=this,o=e._self._c;return o("div",{staticClass:"tab-task",attrs:{"data-group":"task_center_tab_event_component"}},[o("div",{staticClass:"data-line"},[o("div",{staticClass:"data-item"},[o("el-avatar",{attrs:{size:44,shape:"square",src:n(205)}}),e._v(" "),o("span",{staticClass:"value"},[e._v(e._s(e.formatNumberForeign(e.paymentInfo.calculateCoins)||0))])],1),e._v(" "),o("div",{staticClass:"data-item"},[o("el-avatar",{staticStyle:{"margin-right":"-8px"},attrs:{size:44,shape:"square",src:n(160)}}),e._v(" "),o("span",{staticClass:"value"},[e._v(e._s(e.formatNumberForeign(e.paymentInfo.tempCoins)||0))])],1),e._v(" "),o("div",{staticClass:"go-recharge",attrs:{"data-event":"click_go_recharge"},on:{click:function(t){return e.$router.push("/mall?openTab=Credit")}}},[o("Icon",{attrs:{name:"a-Group48022",size:"20",color:"#f3b363"}})],1)]),e._v(" "),o("div",{staticClass:"title-line"},[o("div",{staticClass:"title"},[e._v(e._s(e.$t("Welcome_RewardCenter")))]),e._v(" "),o("div",{staticClass:"upgrade"},[o("span",{staticClass:"upgrade-description"},[e._v(e._s(e.$t("Become_SVIP")))]),e._v(" "),o("span",{staticClass:"upgrade-btn",attrs:{"data-event":"click_upgrade_btn"},on:{click:function(t){return e.$router.push("/mall?openTab=Subscription")}}},[e._v(e._s(e.$t("Upgrade"))+" >")])])]),e._v(" "),o("div",{staticClass:"task-content"},[o("div",{directives:[{name:"show",rawName:"v-show",value:"B"===(null===(t=e.ABInfo)||void 0===t?void 0:t.checkin_traffic_control)&&e.isLoggedIn,expression:"ABInfo?.checkin_traffic_control === 'B' && isLoggedIn"}],staticClass:"claim-card"},[o("div",{staticClass:"title-line"},[o("div",{staticClass:"title"},[e._v(e._s(e.$t("activity_daily_free_award")))]),e._v(" "),o("div",{staticClass:"sub-title"},[e._v(e._s(e.$t("claim_d")))])]),e._v(" "),o("div",{staticClass:"content-line"},[o("div",{staticClass:"day-list"},e._l(e.checkInList,(function(t,r){return o("div",{key:r,staticClass:"day-item",class:{claimed:t.is_finish}},[o("div",{staticClass:"day-value"},[o("span",[e._v("+"+e._s(t.reward_value))]),e._v(" "),t.is_finish?[o("i",{staticClass:"iconfont icon-a-Group48048 icon-check"})]:[o("img",{attrs:{src:n(160)}})]],2),e._v(" "),o("div",{staticClass:"day-text"},[e._v(e._s(e.$t("day_n",{n:r+1})))])])})),0),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.checkInListLoading,expression:"checkInListLoading"}],staticClass:"claim-button",class:{disabled:!e.canClaim},on:{click:e.onClaimClick}},[e._v("\n          "+e._s(e.canClaim?e.$t("activity_claim"):e.$t("activity_claimed"))+"\n        ")])])]),e._v(" "),e.cumulativeInviteNum<=50?o("div",{staticClass:"invite-card",class:{"invite-card-nologin":!e.isLoggedIn}},[o("div",{staticClass:"grid-item title-line"},[o("div",{staticClass:"title"},[e._v(e._s(e.$t("invitation_reward")))]),e._v(" "),o("div",{staticClass:"sub-title",attrs:{title:e.$t("Task_Invitation_D")}},[e._v(e._s(e.$t("Task_Invitation_D")))])]),e._v(" "),o("div",{staticClass:"grid-item"},[o("div",{staticClass:"invited-line"},[o("span",{staticClass:"title"},[e._v(e._s(e.$t("Invited")))]),e._v(" "),o("span",{staticClass:"num",on:{click:function(t){e.invitationRecordDialogVisible=!e.invitationRecordDialogVisible}}},[e._v("\n            "+e._s(e.cumulativeInviteNum)+"\n          ")])]),e._v(" "),o("div",{staticClass:"income-line"},[o("el-avatar",{attrs:{size:20,shape:"square",src:n(205)}}),e._v(" "),o("span",{staticClass:"income-num"},[e._v("x "+e._s(e.cumulativeInviteIncome))])],1)]),e._v(" "),o("div",{staticClass:"grid-item progress-step-list"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!e.taskListLoading,expression:"!taskListLoading"}],staticClass:"progress-line"},[o("div",{staticClass:"progress-percent",style:{width:e.inviteProgressPercent}})]),e._v(" "),e._l(e.inviteTaskList,(function(t,r){return o("div",{key:r,staticClass:"progress-step"},[o("div",{staticClass:"progress-card",style:e.calcTaskProgressStatus(t).id===e.TASK_PROGRESS_STATUS.alreadyTake.id?{backgroundColor:"#302537"}:{}},[o("div",{staticClass:"award-num",style:e.calcTaskProgressStatus(t).id===e.TASK_PROGRESS_STATUS.alreadyTake.id?{color:"#fff"}:{}},[e._v("\n              +"+e._s(t.award_num)+"\n            ")]),e._v(" "),o("el-avatar",{attrs:{size:28,shape:"square",src:n(205)}})],1),e._v(" "),o("div",{staticClass:"card-bottom"},[e.calcTaskProgressStatus(t).id===e.TASK_PROGRESS_STATUS.alreadyTake.id?o("div",{staticClass:"status-line"},[o("Icon",{attrs:{name:"a-Group48048",size:"18",color:"#34C759"}})],1):o("div",{staticClass:"status-line"},[o("span",{staticClass:"target-num"},[e._v(e._s(t.max_plan))]),e._v(" "),o("Icon",{attrs:{name:"Vector2",size:"18",color:"#a55bd3"}})],1)])])}))],2),e._v(" "),o("div",{staticClass:"grid-item invite-now-btn",attrs:{"data-event":"click_invite_now_btn"},on:{click:e.onInviteNowClick}},[o("div",{staticClass:"invite-now-btn-wrapper"},[o("div",{staticClass:"text-line-1"},[e._v(e._s(e.$t("Invite_Now")))]),e._v(" "),o("div",{staticClass:"text-line-2"},[e._v(e._s(e.userInfo.invite_user_code))])])])]):e._e()]),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.taskListLoading,expression:"taskListLoading"}],staticClass:"task-list"},e._l(e.otherTaskList,(function(t,r){return o("div",{key:r,staticClass:"task-list-item",style:{opacity:e.calcTaskProgressStatus(t).id===e.TASK_PROGRESS_STATUS.alreadyTake.id?.4:1}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.calcTaskCategoryType(t,r+4).id===e.TASK_CATEGORY_TYPE.dailyTask.id,expression:"calcTaskCategoryType(item, index + 4).id === TASK_CATEGORY_TYPE.dailyTask.id"}],staticClass:"daily-tag"},[e._v("\n        "+e._s(e.$t("Daily_Task"))+"\n      ")]),e._v(" "),o("div",{staticClass:"task-item-top"},[o("div",{staticClass:"title-line"},[o("div",{staticClass:"title"},[e._v(e._s(e.$t(t.title_key)))]),e._v(" "),o("div",{staticClass:"award-num"},[o("el-avatar",{directives:[{name:"show",rawName:"v-show",value:2===t.award_type,expression:"item.award_type === 2"}],attrs:{size:44,shape:"square",src:n(205)}}),e._v(" "),o("el-avatar",{directives:[{name:"show",rawName:"v-show",value:4===t.award_type,expression:"item.award_type === 4"}],staticStyle:{"margin-right":"-8px"},attrs:{size:44,shape:"square",src:n(160)}}),e._v(" "),o("span",{staticClass:"value"},[e._v("+ "+e._s(t.award_num))])],1)]),e._v(" "),o("div",{staticClass:"description"},[e._v(e._s(e.$t(t.title)))])]),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"item.isLoading"}],staticClass:"bottom-operate-btn",class:e.calcTaskProgressStatus(t).className,attrs:{"data-event":"click_task_card_operate_btn","data-id":t.id},on:{click:function(n){return e.onTaskCardOperateBtnClick(t)}}},[e._v("\n        "+e._s(e.$t(e.calcTaskProgressStatus(t).btnText))+"\n      ")])])})),0),e._v(" "),o("InviteDialog",{ref:"inviteDialogRef",attrs:{type:"task"}}),e._v(" "),o("InvitationRecordDialog",{attrs:{visible:e.invitationRecordDialogVisible},on:{close:function(t){e.invitationRecordDialogVisible=!1}}})],1)}),[],!1,null,"cf1bbfbc",null));e.default=S.exports;installComponents(S,{InviteDialog:n(317).default})},5768:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(8);var o=n(3),r=n(2),c=(n(20),n(19),n(6),n(16),n(22),n(4),n(378),n(28),n(44),n(7),n(379)),l=n(201),d=n(36),h=n(56),v=(n(1245),n(1)),f=n(798),m=n(794),video=n(683);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={components:{VideoItem:m.default},data:function(){return{videoList:[],loading:!1,isEnd:!1,params:{page:1,page_size:30},noSearchData:!1}},mounted:function(){this.addScrollEvent(),this.getList()},watch:{greenMode:{handler:function(t,e){t!==e&&(this.params.page=1,this.isEnd=!1,this.loading=!1,this.videoList=[],this.getList())},deep:!0}},computed:y(y(y({},Object(v.e)("user",["userInfo"])),Object(v.e)("app",["homeType"])),{},{greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},loadingText:function(){return!this.isEnd&&this.loading?"Loading":this.isEnd&&this.params.page>1?"NoMoreData":""}}),methods:{search:function(t){this.params=t,this.isEnd=!1,this.loading=!1,this.videoList=[],this.getList(!0)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("video"===this.homeType){this.loading=!0;var n=Object.assign({},this.params,{green:this.greenMode?1:2});Object(video.c)(n).then((function(n){var o=n.data,r=o.has_more,c=o.items,l=o.total,d=void 0===l?0:l;t.videoList=t.videoList.concat(c),t.isEnd=!r,t.loading=!1,t.noSearchData=!(null!=c&&c.length),e&&t.$emit("changeSearchNum",d)})).catch((function(e){t.loading=!1}))}},addScrollEvent:function(){var t=this,e=document.documentElement;window.addEventListener("scroll",(function(){!(e.scrollTop+e.clientHeight>=e.scrollHeight-250)||t.loading||t.isEnd||(t.params.page++,t.getList())}))},toVideoDetails:function(t){this.$router.push(this.localePath("/video/"+t))},changeTab:function(t){console.log("changeTab: "+t),this.videoList=this.videoList.filter((function(e){return e.id!==t}))}}},C=w,k=(n(4985),n(0)),component=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"video-list"},[t.noSearchData?e("div",{staticClass:"no-search-data-container"},[e("img",{staticClass:"no-search-image",attrs:{src:n(504),alt:"no search data"}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("NoSearchData")))])]):e("div",{staticClass:"list"},t._l(t.videoList,(function(video,n){return e("a",{key:"video_"+n,staticClass:"item",attrs:{href:"/video/"+(null==video?void 0:video.id)},on:{click:function(e){return e.preventDefault(),t.toVideoDetails(video.id)}}},[e("video-item",{staticStyle:{width:"100%"},attrs:{video:video,type:"explore"},on:{change:t.changeTab}})],1)})),0),t._v(" "),e("div",{staticClass:"bottom-loading"},[t._v("\n    "+t._s(t.$t(t.loadingText))+"\n  ")])])}),[],!1,null,"c3136082",null),O=component.exports;installComponents(component,{VideoItem:n(794).default});var x=n(10);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={name:"ExploreDetail",components:{FilterComponent:f.default,TagList:c.default,WaterFallVue:l.default,VideoList:O},data:function(){return{noSearchData:!1,batchNum:1,queryParam:{page:1,page_size:35,order_by:"hot",type:"recommend",tags:[]},searchAction:"filter",inTagSearch:!1,activeName:"artwork",activeTag:"",followingList:[],list:[],firstList:[],isLock:!1,isReq:!1,filterChange:!1,isShowHomeTypeSelect:!0,filterBtns:[{name:this.$t("Recommend"),value:"recommend",color:"#8E9CB1",activeColor:"#255EFB"},{name:this.$t("Following"),value:"following",color:"#8E9CB1",activeColor:"#26A06F"},{name:this.$t("Hot"),value:"hot",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("New"),value:"new1",color:"#8E9CB1",activeColor:"#e9b942"},{name:this.$t("Top"),value:"top",color:"#8E9CB1",activeColor:"#fa6929"}],isFirstGetList:!1,dotReportInfo:{category:"default",view_domain:"recommend",batch_id:""},searchContent:"",searchNumber:0,getListNum:0,homeType:"work",isClient:!0}},computed:S(S(S(S({},Object(v.c)("user",["userInfo"])),Object(v.e)("app",["userHomeType"])),Object(v.e)("user",["adminOff"])),{},{renderFilter:function(){return this.inTagSearch?this.filterBtns.filter((function(t){return-1===["recommend","following"].indexOf(t.value)})):this.filterBtns},showTags:function(){return!["follows"].includes(this.queryParam.type)},defaultButton:function(){return"work"!=this.homeType?this.$t("Hot"):this.$t("Recommend")},filterCopBtn:{get:function(){return this.$refs.filterComponent.activeButton},set:function(t){this.$refs.filterComponent.activeButton=t}},btnMoreforRecommend:function(){return"recommend"===this.queryParam.type&&this.isLock&&this.queryParam.page>1}}),mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.initList(),o=null===(n=t.$route.params)||void 0===n?void 0:n.tag,t.activeTag=o,t.dotReportInfo.category=t.activeTag||"default",t.activeTag&&(t.queryParam.tags=[t.activeTag],t.queryParam.type="community",t.searchAction="tags",t.inTagSearch=!0);case 5:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.$EventBus.$off("homeList"),this.$EventBus.$off("topTextSearch")},methods:S(S(S({},Object(v.d)("app",["setHomeType"])),Object(v.b)("user",["setAdminOff"])),{},{initList:function(){var t=this.list;null!=t&&t.length&&(this.list=t.map((function(t){var e=t.banner;return null==e||!e.url||null!=e&&e.replaceUrl||(t.banner.replaceUrl=Object(x.K)(e.url,"low")),t})))},handleSwitch:function(t){switch(t){case"work":default:this.activeName="artwork";break;case"Checkpoint":case"LORA":this.activeName="model";break;case"gallery":this.activeName="gallery";break;case"video":break;case"User":this.activeName={work:"artwork",Checkpoint:"model",LORA:"model",gallery:"gallery"}[this.userHomeType]}},changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},addEvent:function(){var t=this;this.$EventBus.$on("homeList",(function(){t.$nextTick((function(){t.$refs.backtop.handleClick()})),t.queryParam.page=1,t.isLock=!1,t.getList()})),sessionStorage.getItem("promptSearch")&&(this.$EventBus.$emit("promptSearch",sessionStorage.getItem("promptSearch")),sessionStorage.removeItem("promptSearch")),this.$nextTick((function(){var e,n,o,r;if(null!==(e=t.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.modelType){var c;if(null!==(n=t.$route)&&void 0!==n&&n.query.modelType&&t.$route.query.tag)return t.activeName="model",null==t||null===(c=t.$refs)||void 0===c||c.filterComponent.changeType("Checkpoint",{order_by:"new"}),void t.$router.replace({path:location.pathname});null==t||null===(o=t.$refs)||void 0===o||o.filterComponent.changeType(null===(r=t.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.modelType),t.$router.replace({path:location.pathname})}}))},changeTags:function(t){if(this.queryParam.tags=t.id?[t.id]:[],this.queryParam.tags.length>0&&this.activeTag!==t.id){this.activeTag="",this.dotReportInfo.category=t.id;var e=this.filterCopBtn;["recommend","following"].includes(e.value)&&(this.filterCopBtn=this.filterBtns[3]),this.inTagSearch=!0;var n=this.filterCopBtn.value;this.filterSearch("tags",{tag_type:2,order_by:n})}else{this.queryParam.tags=[],this.activeTag="",this.dotReportInfo.category="default",this.$refs.tagList.selectItem={},this.inTagSearch=!1,!this.filterChange&&(this.filterCopBtn=this.filterBtns[0]);var o=this.filterCopBtn.value;this.filterSearch("filter",{order_by:o})}},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){if(this.userInfo.tags&&this.userInfo.tags.length>0&&"filter"===this.searchAction)this.queryParam.tags=[],["recommend"].includes(this.queryParam.type)?(this.userInfo.tags.forEach((function(element){e.queryParam.tags.push(element.id)})),this.queryParam.batch?this.queryParam.batch:this.queryParam.batch=1,this.queryParam.tag_type=2):delete this.queryParam.batch;else if(1===this.queryParam.tags.length&&["tags","filter"].includes(this.searchAction))this.searchAction="tags",this.queryParam.tag_type=2,this.queryParam.type="community",delete this.queryParam.batch;else{var n;if(null!==(n=this.$route.params)&&void 0!==n&&n.tag)return this.searchAction="tags",this.queryParam.tag_type=2,this.queryParam.type="community",void delete this.queryParam.batch;"recommend"===this.queryParam.type?this.queryParam.batch?this.queryParam.batch:this.queryParam.batch=1:delete this.queryParam.batch}this.isReq=!0;var o=h.s;"artwork"===this.activeName&&(o=d.artworkList),"following"===this.queryParam.order_by&&(o=d.artworkList,this.queryParam.order_by="new",this.queryParam.type="follows"),"gallery"===this.activeName&&(o=d.portfolioSearch),["Checkpoint","LORA"].includes(this.homeType)||"User"===this.homeType&&["Checkpoint","LORA"].includes(this.userHomeType)?this.queryParam=S(S({},this.queryParam),{},{model_type:this.homeType}):delete this.queryParam.model_type;var r=this.queryParam;console.log("httpParams: ",r),o(r).then((function(n){if(n.status&&1e4===n.status.code){var o,c,l,d,h;if(e.searchNumber=(null==n||null===(o=n.data)||void 0===o?void 0:o.total)||0,e.isLock=!n.data.has_more,"artwork"===e.activeName&&(e.dotReportInfo.batch_id=(null==n||null===(c=n.data)||void 0===c?void 0:c.batch_id)||""),t)"gallery"===e.activeName?e.list=e.list.concat(n.data.list||[]):e.list=e.list.concat(n.data.items||[]);else{var v=[];v="gallery"===e.activeName?n.data.list||[]:n.data.items||[],e.list=[],e.$nextTick((function(){e.list=v})),e.getFirstHot(e.queryParam,e.list)}if(e.isReq=!1,e.isFirstGetList=!0,1===r.page&&(r.time_to=n.data.time_ms),r.page++,"gallery"===e.activeName)e.noSearchData=!(t||null!=n&&null!==(l=n.data)&&void 0!==l&&null!==(l=l.list)&&void 0!==l&&l.length);else e.noSearchData=!(t||null!=n&&null!==(d=n.data)&&void 0!==d&&null!==(d=d.items)&&void 0!==d&&d.length),(null===(h=n.data)||void 0===h||!h.items||n.data.items.length<15)&&e.getListNum<3?(e.getListNum++,e.getList(!0)):e.getListNum=0}else n.status&&150002===n.status.code?(e.isReq=!1,e.isLock=!0,e.noSearchData=!0):(e.isReq=!1,e.isLock=!0,e.noSearchData=!1)})).catch((function(t){var code=t.code;e.noSearchData=150002===code,e.isReq=!1})).finally((function(){Reflect.deleteProperty(e.queryParam,"r"),e.btnMoreforRecommend&&e.recommendMore(),e.isShowHomeTypeSelect=!0}))}},getFirstHot:function(t,e){if(e.length>0&&"artwork"===this.activeName&&1===t.page&&"hot"===t.order_by){if(this.firstList.length>0&&"recommend"!==t.type)return;this.firstList=e;var n=e.map((function(t){return t.prompt}));localStorage.setItem("RandomPrompt",JSON.stringify(n))}},getFollowingList:function(){var t=this;Object(d.artworkList)({page:1,page_size:40,order_by:"new",type:"follows"}).then((function(e){1e4===e.status.code&&(t.followingList=e.data.items)}))},dealTypeAndOrder:function(t,e){this.filterChange=!1,"following"===t?(this.queryParam.type="follows",this.queryParam.order_by="new"):"recommend"===t?(this.queryParam.type="recommend",this.queryParam.order_by="hot",this.queryParam.batch=1):(this.filterChange=!0,this.searchAction=this.inTagSearch?"tags":"filter",this.queryParam.type="community",this.queryParam.order_by=t)},filterSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if(this.dotReportInfo.view_domain=(null==e?void 0:e.order_by)||"hot",this.searchAction=t,null!=e&&e.showType&&(this.homeType=e.showType),"filter"===t){var n=e.order_by;this.dealTypeAndOrder(n)}else if("tags"===t){var o=e.order_by;this.searchAction=this.inTagSearch?"tags":"filter",this.queryParam.type="community",this.queryParam.order_by=o}if(this.homeType&&this.handleSwitch(this.homeType),this.homeType&&"work"===this.homeType&&e.isFromHomeType){var r=e.order_by;this.dealTypeAndOrder(r)}if(this.homeType&&"work"!==this.homeType&&e.isFromHomeType&&(this.queryParam.type="community"),"recommend"===e.order_by){if(this.queryParam.batch=++this.batchNum,this.isReq)return}else this.queryParam.batch=1;if(this.isLock=!1,this.isReq=!1,delete this.queryParam.time_to,this.queryParam.page=1,this.list=[],this.followingList=[],"recommend"===this.queryParam.type)try{var c=this.$refs.tagList.selectItem;null!=c&&c.id&&(this.queryParam.type="community")}catch(t){}this.getList()},tabChange:function(t){this.queryParam.order_by=t.order_by,this.activeName=t.type,this.filterSearch("tab"),this.followingList=[],"artwork"===this.activeName&&this.getFollowingList()},goAll:function(){this.$router.push(this.localePath("/personal?tab=follows"))},recommendMore:function(){this.queryParam.page=1,this.queryParam.r=!0,this.queryParam.batch?this.queryParam.batch++:this.queryParam.batch=1,this.isLock=!1,this.isReq=!1,this.getList(!0)},handlePromptSearch:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null===(t=this.$refs)||void 0===t||null===(t=t.searchTextarea)||void 0===t||t.fillText(e)},changeSearchNum:function(t){this.searchNumber=t}}),head:function(){return{title:this.$t("ExploreTitle"),meta:[{hid:"description",name:"description",content:this.$t("ExploreDesc")},{hid:"keywords",name:"keywords",content:this.$t("ExploreKeyword")},{hid:"og:title",name:"og:title",content:this.$t("ExploreTitle")},{hid:"og:description",name:"og:description",content:this.$t("ExploreDesc")}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,data,l,d,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,o=t.error,e.prev=1,r={batch:1,page:1,page_size:50,order_by:"hot",type:"recommend",tags:[]},e.next=5,n.$post("/api/v1/artwork/list",r);case 5:return c=e.sent,data=c.data,d=(l=data||{}).items,h=l.time_ms,v=l.has_more,r.page++,r.time_to=h,r.batch=v?1:2,e.abrupt("return",{list:d,queryParam:r});case 14:e.prev=14,e.t0=e.catch(1),console.log("广场页-> asyncData错误啦：",e.t0),o({statusCode:404,message:e.t0});case 18:case"end":return e.stop()}}),e,null,[[1,14]])})))()}},L=D,P=(n(4986),n(4987),Object(k.a)(L,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"explore"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),t.searchContent?e("div",{staticClass:"search-result"},[e("span",{staticClass:"content"},[t._v(' "'+t._s(t.searchContent)+'" ')]),t._v(" "),e("span",{staticClass:"tip"},[t._v(t._s(t.$t("SearchResult",{number:t.searchNumber})))])]):t._e(),t._v(" "),t.showTags?e("tag-list",{ref:"tagList",attrs:{active:t.activeTag},on:{changeTags:t.changeTags}}):t._e(),t._v(" "),e("filter-component",{ref:"filterComponent",attrs:{top:"0",showTitle:!1,showTabs:!1,showModelType:!1,showWorkOrModel:!0,defaultButton:t.defaultButton,buttons:t.renderFilter,isShowHomeTypeSelect:t.isShowHomeTypeSelect},on:{change:function(e){return t.filterSearch("filter",e)}}}),t._v(" "),"artwork"===t.activeName&&t.followingList&&t.followingList.length>0?e("div",{staticClass:"following"},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.$t("Following")))]),t._v(" "),e("span",{staticStyle:{"font-size":"16px"},on:{click:t.goAll}},[t._v(t._s(t.$t("ShowALL")))])]),t._v(" "),e("follow-work-list",{attrs:{type:"artwork",list:t.followingList}})],1):t._e(),t._v(" "),e("div",{ref:"wraper",staticClass:"wraper",class:{"server-list":!t.isClient}},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{dotReportInfo:t.dotReportInfo,noSearchData:t.noSearchData,alreadyNoMoreData:t.isLock,type:"artwork"===t.activeName?"artwork":"gallery"===this.activeName?"gallery":"model",cols:7,container:"wraper",list:t.list,lazy:!0,dislikeShow:!0,"from-page":"explore",needGridSource:!0},on:{load:function(e){return t.getList(!0)}}})],1),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isReq&&t.isFirstGetList,expression:"isReq && isFirstGetList"}],staticClass:"loading"})],1)}),[],!1,null,"62158471",null));e.default=P.exports;installComponents(P,{TagList:n(379).default,FilterComponent:n(798).default})},5769:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(11),n(72),n(19),n(73),n(22),n(31),n(18),n(4),n(28),n(44),n(26),n(39)),video=n(683),c=n(915),l=n(916),d=n(917),h=n(918),v=n(10),f=n(318),m=n(971),_={components:{MyPlayer:f.default},props:["video"],data:function(){return{replaceImageType:v.K,player:null,videoConfig:{id:"lookbookVideoId",url:"",autoplay:!0,width:"100%",height:"100%",dynamicBg:{disable:!1,mode:"firstframe"}},expandField:{durationNum:8e3,videoProdType:5,relatedWh:{w:221,h:128}},currentPlayTime:0}},beforeDestroy:function(){var t;this.player&&(null===(t=this.player)||void 0===t||t.reset())},methods:{playerReady:function(t){var e=this,n=t.player,o=t.Events,r=t.expandAttrs;this.player=n;var c=this.video.video,l=c.dash_url,d=c.hls_url,h=c.url;this.$nextTick((function(){var t={dash:l,hls:d,other:h},path=Object(m.outputPath)(t).path;n.switchURL(path),n.playNext({url:path}),n.on(o.LOADED_DATA,(function(data){e.handleDataReport(0,"beginning")})),n.on(o.DESTROY,(function(){e.handleDataReport(Math.floor(e.currentPlayTime),"exit")})),n.on(o.USER_ACTION,(function(data){var t=data.action,n=data.currentTime,o={click:"drag",change_definition:"clarity",switch_play_pause:"stop"};o[t]&&e.handleDataReport(Math.floor(n),o[t])})),n.on(o.ENDED,(function(){e.$emit("playerEnd",{player:n,expandAttrs:r})}))}))},timeUpdate:function(data){var t=data.currentTime;this.currentPlayTime=t,this.handleDataReport(Math.floor(t),"tens")},handleDataReport:function(t){var e,n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=this.video.video_type,l=((null===(e=this.$refs)||void 0===e||null===(e=e.MyPlayerRef)||void 0===e?void 0:e.getPlayerInfo())||{}).definition;this.$logEvent("log_vedio_time",{duration:t,resolution:(null==l?void 0:l.definition)||"",vedio_id:(null===(n=this.$route)||void 0===n||null===(n=n.params)||void 0===n?void 0:n.id)||"",video_source:["post","swift","dance"][c],report_type:r,is_selected:!(null===(o=this.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.isRecommend)})},handRelatedItem:function(data){this.$emit("onRelatedItem",data)},destroyMyPlayer:function(){this.$refs.MyPlayerRef.expandAttrs.destroyMyPlayer()}}},y=_,w=(n(4994),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"play-video"},[e("MyPlayer",{ref:"MyPlayerRef",attrs:{config:t.videoConfig,expandField:t.expandField,onReady:t.playerReady,loading:!1},on:{onTimeUpdate:t.timeUpdate,onRelatedItem:t.handRelatedItem}})],1)}),[],!1,null,"0afb3e4a",null),C=component.exports;installComponents(component,{MyPlayer:n(318).default});var k={name:"allVidoes",props:{},components:{VideoInfo:c.a,VideoComments:l.a,VideoAiPerson:d.a,VideoRelated:h.a,VideoPlayer:C},computed:{videoType:function(){var t;return null===(t=this.videoData)||void 0===t?void 0:t.video_type}},data:function(){return{videoId:"",videoData:null,child2MarginTop:20,previousScrollY:0,isScrollingUp:!1,nextVideoId:"",realViewTimer:null}},mounted:function(){var t=this;this.getVideoInfo("init"),this.realViewTimer=setTimeout((function(){t.$logEvent("log_actions",{operation:"real_view",behavior_info:5,behavior_info_sub:t.$route.params.id})}),5e3)},beforeDestroy:function(){this.$refs.VideoPlayerRef.destroyMyPlayer(),this.realViewTimer&&clearTimeout(this.realViewTimer)},methods:{getVideoInfo:function(t){var e,n=this;this.videoId=this.$route.params.id;var source=(null===(e=this.$route.query)||void 0===e?void 0:e.source)||"";if(this.videoId){var o={id:this.videoId};source&&(o.source=source),this.viewVideoDot(),this.loading=!0,Object(video.b)(o).then((function(t){var e;n.videoData=null==t?void 0:t.data,null===(e=n.$refs)||void 0===e||null===(e=e.relatedVideo)||void 0===e||e.getVideoRelated()})).catch((function(t){console.log("getVideoDetails",t)})).finally((function(){n.loading=!1}))}else this.$router.push(this.localePath("/"))},viewVideoDot:function(){Object(r.i)({items:[{action:"view",obj_no:this.$route.params.id,obj_type:5}]})},backTo:function(){history.length>1?this.$router.back():this.$router.push(this.localePath("/"))},handleAutoPlay:function(t){var e=this,n=t.expandAttrs;if(this.nextVideoId){var o=this.$refs.relatedVideo.videoList[0],r={id:o.id,cover:o.cover,duration:o.look_book.duration,name:o.look_book.name};n.nextPlayVideo({params:r,call:function(){e.$router.replace({path:e.localePath("/video/".concat(e.nextVideoId))})}})}},handRelatedItem:function(data){var t=data.id;this.$router.replace({path:this.localePath("/video/".concat(t))})},handleScroll:function(){var t=this.$refs.child1,e=this.$refs.child2,n=t.getBoundingClientRect().bottom,o=window.innerHeight,r=window.scrollY;if(this.isScrollingUp=r<this.previousScrollY,n<=o&&!this.isScrollingUp){var c=o-n;this.child2MarginTop=Math.min(c,e.scrollHeight-o)}else if(this.isScrollingUp&&this.child2MarginTop>0){var l=this.previousScrollY-r;this.child2MarginTop=Math.max(this.child2MarginTop-l,0)}this.previousScrollY=r}},head:function(){var t=this.videoData,e=t.name,n=t.description,o=t.tag,r=t.cover.url,c=t.create_at,l=t.video,d=l.url,h=l.duration,v=t.author,f=t.stat,m=o.map((function(t){return t.title})).join(","),_=parseInt(h/60),s=h%60,y=(null==n?void 0:n.length)>200?n.slice(0,200)+"...":n;return{title:e,meta:[{hid:"description",name:"description",content:y},{hid:"keywords",name:"keywords",content:m},{hid:"og:title",name:"og:title",content:e},{hid:"og:description",name:"og:description",content:y},{hid:"og:image",name:"og:image",content:r}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"VideoObject",name:e,description:y,thumbnailUrl:r,uploadDate:c?new Date(c).toISOString():"",contentUrl:d,duration:"PT00H".concat(_,"M").concat(0===s?1:s,"S"),interactionStatistic:{"@type":"InteractionCounter",interactionType:{"@type":"WatchAction"},userInteractionCount:(null==f?void 0:f.num_of_view)||0},creator:{name:null==v?void 0:v.name,"@type":"Person"}}}],__dangerouslyDisableSanitizers:["script"]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,o=t.$axios,r=t.error,c=null==n?void 0:n.id,e.prev=2,e.next=5,o.$post("/api/v1/lookbook/detail",{id:c});case 5:return l=e.sent,data=l.data,e.abrupt("return",{videoData:data});case 10:e.prev=10,e.t0=e.catch(2),console.log("lookbook视频详情页-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()}},O=(n(4995),Object(w.a)(k,(function(){var t,e,n,o,r,c,l,d=this,h=d._self._c;return h("div",{staticClass:"all-vidoes"},[h("div",{staticClass:"all-vidoes-back",on:{click:d.backTo}},[h("i",{staticClass:"el-icon-back"})]),d._v(" "),h("div",{ref:"child1",staticClass:"all-vidoes-left"},[null!==(t=d.videoData)&&void 0!==t&&t.id?h("VideoPlayer",{ref:"VideoPlayerRef",attrs:{video:d.videoData},on:{playerEnd:d.handleAutoPlay,onRelatedItem:d.handRelatedItem}}):d._e(),d._v(" "),null!==(e=d.videoData)&&void 0!==e&&null!==(e=e.author)&&void 0!==e&&e.id?h("VideoInfo",{attrs:{authorInfo:null===(n=d.videoData)||void 0===n?void 0:n.author,videoType:d.videoType,tags:(null===(o=d.videoData)||void 0===o?void 0:o.tag)||[],info:d.videoData}}):d._e(),d._v(" "),h("VideoComments",{attrs:{videoType:d.videoType,videoInfo:d.videoData}})],1),d._v(" "),h("div",{ref:"child2",staticClass:"all-vidoes-right",style:{marginTop:d.child2MarginTop+"px"}},[null!==(r=d.videoData)&&void 0!==r&&null!==(r=r.related_characters)&&void 0!==r&&r.length?h("VideoAiPerson",{attrs:{personData:null===(c=d.videoData)||void 0===c?void 0:c.related_characters}}):d._e(),d._v(" "),h("VideoRelated",{ref:"relatedVideo",attrs:{videoType:d.videoType,objType:5,objId:null===(l=d.videoData)||void 0===l?void 0:l.id},on:{nextVideo:function(t){d.nextVideoId=t}}})],1)])}),[],!1,null,"bec5478c",null));e.default=O.exports},5787:function(t,e,n){"use strict";n.r(e);var o={name:"Decorations",components:{DecorationsView:n(826).a},data:function(){return{}}},r=(n(4804),n(0)),component=Object(r.a)(o,(function(){var t=this._self._c;return t("div",{staticClass:"decorations-page-box dot-group"},[t("DecorationsView")],1)}),[],!1,null,"5d8559d3",null);e.default=component.exports},5790:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(12),n(13),n(7);var o=n(3),r=n(2),c=(n(20),n(19),n(6),n(16),n(8),n(4),n(28),n(21),n(44),n(1)),l=n(78),d=n(36);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"EventCenter",created:function(){this.initRouteQuery()},mounted:function(){this.latestUpdateDialogCheck()},data:function(){return{tabList:[{name:this.$t("daily_challenge"),value:"daily",logEventField:"click_activity_center"},{name:this.$t("creative_activity"),value:"activity",logEventField:"click_activity_center"},{name:this.$t("TaskList"),value:"task",logEventField:"click_task_list"},{name:this.$t("Credit_Details"),value:"award",logEventField:"click_calculation_power_detail"}],tabValue:"",show:!1}},computed:v(v(v({},Object(c.e)("user",["waitTakeNum"])),Object(c.e)("payment",["popupStatusInfo"])),{},{taskMsgNum:function(){return this.waitTakeNum>9?"'9+'":this.waitTakeNum>0?"'".concat(this.waitTakeNum,"'"):0}}),watch:{"$route.path":function(t,e){t!==e&&t.includes("/event-center")&&this.initRouteQuery()},popupStatusInfo:{handler:function(){this.latestUpdateDialogCheck()}}},methods:v(v({},Object(c.d)("eventCenter",["SET_LATEST_UPDATE_TABS"])),{},{latestUpdateDialogCheck:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,h,data,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Date,o="".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate()),r="eventCenterLatestUpdate_"+o,!t.popupStatusInfo||localStorage.getItem(r)){e.next=10;break}return e.next=6,Object(d.getFacePopupModuleList)({});case 6:h=e.sent,data=h.data,(v=(null==data||null===(c=data.items)||void 0===c?void 0:c.filter((function(t){return t.latest_content_id})))||[]).length>0&&(t.SET_LATEST_UPDATE_TABS(v),l.b.requestPopupDisplay(l.a.EVENT_CENTER_LATEST_UPDATE),localStorage.setItem(r,"1"));case 10:case"end":return e.stop()}}),e)})))()},initRouteQuery:function(){var t;if((null===(t=this.$route.matched)||void 0===t?void 0:t.length)>=2){var e=this.$route.matched[1].path.substring(this.$route.matched[0].path.length).split("/");this.tabValue=e[1]}else this.tabValue=this.tabList[0].value;Object.keys(this.$route.params).length>0?this.$router.replace({path:this.$route.path,query:v({},this.$route.query||{})}).catch((function(){})):this.$router.replace({path:"/event-center/".concat(this.tabValue),query:v({},this.$route.query||{})}).catch((function(){}))},onTabClick:function(t){this.tabValue=t.value,this.$router.replace("/event-center/".concat(this.tabValue)).catch((function(){})),this.$logEvent("log_actions",{operation:t.logEventField,behavior_info:"on_activity_center_page"})},handleCloseLatestUpdateDialog:function(){this.$emit("close",l.a.EVENT_CENTER_LATEST_UPDATE)}})},m=(n(4821),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"event-center",attrs:{"data-group":"activity_center_page"}},[e("div",{staticClass:"tabs"},t._l(t.tabList,(function(n,o){return e("div",{key:o,staticClass:"tab-item",class:{"tab-item-activate":t.tabValue===n.value},style:"task"===n.value?{"--task-msg":t.taskMsgNum}:{},attrs:{"data-event":"click_tab_item","data-id":n.value},on:{click:function(e){return t.onTabClick(n)}}},[t._v("\n      "+t._s(n.name)+"\n    ")])})),0),t._v(" "),e("keep-alive",[e("router-view")],1)],1)}),[],!1,null,"38e99756",null);e.default=component.exports},5791:function(t,e,n){"use strict";n.r(e);n(19),n(16);var o=[function(){var t=this._self._c;return t("div",{staticClass:"coinBox",staticStyle:{"margin-top":"10px"}},[t("img",{staticClass:"coinImg",attrs:{src:n(1076),alt:""}})])}],r=(n(1120),n(47),n(680)),c=n.n(r),l=(n(4),n(147)),d=n(58),h=n(10),v=n(9),f={name:"TabAward",components:{ElPagination:c.a},head:function(){var title=this.$t("EventCenterCreditTitle"),desc=this.$t("EventCenterCreditDes");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},data:function(){return{getTimeDiff2:d.e,headList:[this.$t("Type"),this.$t("Quantity"),this.$t("Source"),this.$t("Details"),this.$t("Time")],list:[],isLoading:!1,numData:{},formData:{type:"award",page:1,page_size:5,source:1},replaceImageType:h.K}},activated:function(){this.getAwardTakelog()},mounted:function(){this.getAwardTakelog()},methods:{formatNumberToK:v.T,setCoinImg:function(t){var e=n(169);if(1==t.award_type)switch(t.coins_type){case 1:e=n(397);break;case 3:e=n(743);break;case 4:e=n(169)}else e=n(1076);return e},formatTime:function(t){var e=Math.floor(t/1e3);if(e<60)return"".concat(e," ").concat(this.$t("seconds"));var n=Math.floor(e/60),o=e%60;return"".concat(n," ").concat(this.$t("minutes")," ").concat(o," ").concat(this.$t("seconds"))},setType:function(t){var e="";switch(t.source){case 10:case 9:e=this.$t("PaidImagePortfolio");break;case 7:case 8:case 15:case 25:case 26:case 27:case 30:case 31:case 35:case 37:case 38:case 39:case 40:case 42:case 43:case 46:case 48:case 52:case 53:e=this.$t("expend");break;case 1:case 13:case 36:case 5:case 12:case 14:case 28:case 29:case 3:case 6:case 41:e=this.$t("Addition")}return e},setSoure:function(t){var e,n,o="";switch(t.source){case 1:o=this.$t("credits_recharge");break;case 46:o=this.$t("AudioNovel");break;case 6:case 36:o=this.$t("IncentiveTesk");break;case 7:o="AI "+this.$t("OPS_painting");break;case 3:o=this.$t("activityRewards");break;case 9:o=1==(null===(e=t.portfolio_remark)||void 0===e?void 0:e.type)?this.$t("unlockImageortfolio"):this.$t("unlockCreativeParameters");break;case 10:o=1==(null===(n=t.portfolio_remark)||void 0===n?void 0:n.type)?this.$t("unlockImageortfolio"):this.$t("unlockCreativeParameters");break;case 8:case 14:o=this.$t("paidModel");break;case 12:o=this.$t("VIPEarnings");break;case 13:o=this.$t("RechargeEarningse");break;case 15:o=this.$t("trainModel");break;case 25:case 26:case 27:o=this.$t("ai_tools_10");break;case 28:o=this.$t("returnToCreator");break;case 29:o=this.$t("modelUsageRollback");break;case 30:o=this.$t("modelPerformanceReturns");break;case 31:case 42:case 43:o=this.$t("AIHumanChat");break;case 35:o=this.$t("AI_Chat");break;case 5:o=this.$t("welfare");break;case 37:o=this.$t("aiVideName");break;case 38:case 39:case 40:case 41:o=this.$t("AIAudio");break;case 48:o=this.$t("fileAnalyze");break;case 52:o=this.$t("ST_Expend");break;case 53:o=this.$t("Styleshop")}return o},handleCurrentChange:function(t){this.formData.page=t,this.getAwardTakelog()},tabChange:function(t){this.formData.page=1,this.formData.type=t,this.getAwardTakelog()},getAwardTakelog:function(){var t=this;this.isLoading||(this.isLoading=!0,Object(l.d)(this.formData).then((function(e){1e4==e.status.code&&(t.numData=e.data,t.list=e.data.list||[])})).finally((function(){t.isLoading=!1})))}}},m=(n(4834),n(0)),component=Object(m.a)(f,(function(){var t,e,o,r,c,l,d=this,h=d._self._c;return h("div",{staticClass:"awardRecordlist"},[h("div",{staticClass:"topBar"},[null!==(t=d.numData)&&void 0!==t&&null!==(t=t.count)&&void 0!==t&&t.count_gain_of_calculate||0==(null===(e=d.numData)||void 0===e||null===(e=e.count)||void 0===e?void 0:e.count_gain_of_calculate)?h("div",{staticClass:"topItem",style:{backgroundImage:"award"==d.formData.type?"url(".concat(n(1074),")"):"url(".concat(n(1073),")")},on:{click:function(t){return d.tabChange("award")}}},[h("div",{staticClass:"topCnt",style:{color:"award"==d.formData.type?"#7B542B":null}},[h("div",[d._v(d._s(d.formatNumberToK(null===(o=d.numData)||void 0===o||null===(o=o.count)||void 0===o?void 0:o.count_gain_of_calculate)))]),d._v(" "),h("div",[d._v(d._s(d.$t("accumulatedAcquisition")))])])]):d._e(),d._v(" "),null!==(r=d.numData)&&void 0!==r&&null!==(r=r.count)&&void 0!==r&&r.count_expend_of_calculate||0==(null===(c=d.numData)||void 0===c||null===(c=c.count)||void 0===c?void 0:c.count_expend_of_calculate)?h("div",{staticClass:"topItem",style:{backgroundImage:"expend"==d.formData.type?"url(".concat(n(1074),")"):"url(".concat(n(1073),")"),marginLeft:"78px"},on:{click:function(t){return d.tabChange("expend")}}},[h("div",{staticClass:"topCnt",style:{color:"expend"==d.formData.type?"#7B542B":null}},[h("div",[d._v(d._s(d.formatNumberToK(null===(l=d.numData)||void 0===l||null===(l=l.count)||void 0===l?void 0:l.count_expend_of_calculate)))]),d._v(" "),h("div",[d._v(d._s(d.$t("AccumulatedConsumption")))])])]):d._e()]),d._v(" "),h("div",{staticClass:"head"},d._l(d.headList,(function(t,e){return h("div",{key:e,staticClass:"headItem"},[d._v("\n      "+d._s(t)+"\n    ")])})),0),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.isLoading,expression:"isLoading"}],staticClass:"list"},d._l(d.list,(function(t,e){var o,r,c,l,v,f,m;return h("div",{key:e,staticClass:"row"},[h("div",{staticClass:"cell"},[d._v(d._s(d.setType(t)))]),d._v(" "),h("div",{staticClass:"cell"},["unlock_auto_pub_community"==t.source_key?h("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:n(1480),alt:""}}):15==t.coins_type?h("div",[h("el-tooltip",{attrs:{content:d.$t("stamina_desc"),placement:"top"}},[h("div",{staticClass:"coinBox",staticStyle:{"margin-bottom":"5px"}},[h("img",{staticClass:"coinImg",attrs:{src:n(397),alt:""}}),d._v(" "),h("span",{staticClass:"coinNum"},[d._v("X "+d._s(t.change_coins_info.free))])])]),d._v(" "),h("div",{staticClass:"coinBox"},[h("img",{staticClass:"coinImg",attrs:{src:n(169),alt:""}}),d._v(" "),h("span",{staticClass:"coinNum"},[d._v("X "+d._s(t.change_coins_info.calculate))])])],1):16==t.coins_type?h("div",[h("div",{staticClass:"coinBox"},[h("img",{staticClass:"coinImg",attrs:{src:n(169),alt:""}}),d._v(" "),h("span",{staticClass:"coinNum"},[d._v("X "+d._s(t.change_coins_info.calculate))])]),d._v(" "),d._m(0,!0)]):h("el-tooltip",{attrs:{disabled:![1,4].includes(t.coins_type),content:1==t.coins_type?"".concat(d.$t("tempCoins"),"：").concat(d.$t("new_stamina_desc")):"".concat(d.$t("calculateCoins"),"：").concat(d.$t("new_credit_desc")),placement:"top"}},[h("div",{staticClass:"coinBox"},[h("img",{staticClass:"coinImg",attrs:{src:d.setCoinImg(t),alt:""}}),d._v(" "),1==t.award_type?h("span",{staticClass:"coinNum"},[d._v("X "+d._s(t.number)+" "+d._s(1==t.award_type?"":d.$t("days")))]):d._e()])])],1),d._v(" "),h("div",{staticClass:"cell"},[d._v(d._s(d.setSoure(t)))]),d._v(" "),h("div",{staticClass:"cell"},[4!=t.source&&7!=t.source&&8!=t.source||!t.source_artwork_info?14==t.source&&t.source_obj_info?h("div",{staticClass:"detailImg"},[h("el-image",{attrs:{fit:"contain",src:d.replaceImageType(null===(c=t.source_obj_info)||void 0===c?void 0:c.image,"low"),"preview-src-list":[null===(l=t.source_obj_info)||void 0===l?void 0:l.image]}})],1):15==t.source&&t.source_obj_info?h("div",{staticClass:"detailImg",on:{click:function(e){d.$router.push(d.localePath("/models/detail/"+t.source_obj_info.obj_id))}}},[null!==(v=t.source_obj_info)&&void 0!==v&&v.image?h("el-image",{attrs:{fit:"contain",src:d.replaceImageType(null===(f=t.source_obj_info)||void 0===f?void 0:f.image,"low")}}):d._e(),d._v(" "),h("div",{staticClass:"modelName"},[d._v(d._s(null===(m=t.source_obj_info)||void 0===m?void 0:m.obj_name))])],1):9!=t.source&&10!=t.source||!t.portfolio_artwork_info?h("span",[d._v(d._s(t.detail))]):h("div",{staticClass:"detailImg",on:{click:function(e){d.$router.push(d.localePath("/artWorkDetail/"+t.portfolio_artwork_info.id))}}},[h("img",{attrs:{src:d.replaceImageType(t.portfolio_artwork_info.image,"low"),alt:""}})]):h("div",{staticClass:"detailImg"},[h("el-image",{attrs:{fit:"contain",src:d.replaceImageType(null===(o=t.source_artwork_info)||void 0===o?void 0:o.image,"low"),"preview-src-list":[null===(r=t.source_artwork_info)||void 0===r?void 0:r.image]}})],1)]),d._v(" "),h("div",{staticClass:"cell"},[d._v(d._s(d.getTimeDiff2(t.update_at)))])])})),0),d._v(" "),h("div",{staticClass:"pagination"},[h("el-pagination",{attrs:{background:"","page-size":5,layout:"total, prev, pager, next, jumper","current-page":d.formData.page,total:d.numData.total},on:{"current-change":d.handleCurrentChange,"update:currentPage":function(t){return d.$set(d.formData,"page",t)},"update:current-page":function(t){return d.$set(d.formData,"page",t)}}})],1)])}),o,!1,null,"134a96c9",null);e.default=component.exports},5810:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1),c=n(900),l=n(39);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={components:{Header:c.a},data:function(){return{toolsCurrentTab:"AIFilter",videoSrc:"",modelImgUrl:"",isShowLoginCard:!0}},mounted:function(){var t=this;this.$EventBus.$on("loginPopupStatus",(function(e){t.isShowLoginCard=!e})),this.token&&this.$router.push(this.localePath("/")),this.getData()},beforeDestroy:function(){this.$EventBus.$off("loginPopupStatus")},computed:h(h(h({},Object(r.c)("user",["cdnHostFun"])),Object(r.e)("user",["cdnHost","token"])),{},{toolsTabs:function(){return[{name:"AIFilter",tabTitle:"ai_tools_4",tabDesc:"ai_tools_8",video:"https://".concat(this.cdnHost,"/static/video/AITool/AIFilterv2.mp4"),img:n(740),title:"ai_tools_4",desc:"PublicizeToolsDescFour"},{name:"HDRepair",tabTitle:"taskTabUpscale",tabDesc:"ai_tools_5",video:"https://".concat(this.cdnHost,"/static/video/AITool/HDrepair.mp4"),img:n(737),title:"taskTabUpscale",desc:"PublicizeToolsDescOne"},{name:"DraftIntoDrawing",tabTitle:"ai_tools_3",tabDesc:"ai_tools_7",video:"https://".concat(this.cdnHost,"/static/video/AITool/draftToImgv2.mp4"),img:n(739),title:"ai_tools_3",desc:"PublicizeToolsDescThree"},{name:"RemoveBackground",tabTitle:"RemoveBackground",tabDesc:"ai_tools_6",video:"https://".concat(this.cdnHost,"/static/video/AITool/removeBackgroundv2.mp4"),img:n(738),title:"RemoveBackground",desc:"PublicizeToolsDescTwo"}]},getPageFiveStyle:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20231120/a1c58da3-3116-47b8-93f7-d0a3863fef7e.webp)")}}}),methods:{getData:function(){var t=this;Object(l.m)().then((function(e){var n=(e||{}).data,o=void 0===n?{demo_video:"",recommend_model_img:""}:n,r=o.demo_video,c=o.recommend_model_img;t.videoSrc=r,t.modelImgUrl=c}))},btnClick:function(t){var e=this;switch(this.$logEvent("log_actions",{operation:"click_start_free_trial_button",behavior_info:"visitor_landing_page",behavior_info_sub:["first_page","second_page","third_page","fourth_page"][t-1]}),t){case 1:this.$EventBus.$emit("openGenerate",{action:1,data:{}});break;case 2:this.$EventBus.$emit("openLoginDialog",{redirect:"/home?toModel=1"});break;case 3:this.$EventBus.$emit("openLoginDialog",{callBack:function(){e.$EventBus.$emit("openGenerate",{action:1,data:{openType:"SIMPLE"}})}});break;case 4:this.$EventBus.$emit("openLoginDialog",{redirect:"/fastTools"})}}}},f=(n(5144),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"landing-page"},[e("Header"),t._v(" "),e("div",{staticClass:"page-one"},[e("div",{staticClass:"top"},[e("div",{staticClass:"title"},[e("span",{staticClass:"words"},[t._v(t._s(t.$t("LandingPage1Title")))])]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("LandingPage1SubTitle")))])]),t._v(" "),e("div",{staticClass:"video-box"},[e("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:"",src:t.videoSrc},domProps:{muted:!0}})]),t._v(" "),e("el-button",{staticClass:"btn",on:{click:function(e){return t.btnClick(1)}}},[t._v("\n      "+t._s(t.$t("StartFreeTrial"))+"\n      "),e("i",{staticClass:"el-icon-right"})])],1),t._v(" "),e("div",{staticClass:"page-two"},[e("div",{staticClass:"left"},[e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("LandingPage2Title")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("LandingPage2SubTitle")))]),t._v(" "),e("el-button",{staticClass:"btn",on:{click:function(e){return t.btnClick(2)}}},[t._v("\n          "+t._s(t.$t("StartFreeTrial"))+"\n          "),e("i",{staticClass:"el-icon-right"})])],1)]),t._v(" "),e("div",{staticClass:"right"},[e("img",{staticClass:"img",attrs:{src:t.modelImgUrl,alt:"models"}})])]),t._v(" "),e("div",{staticClass:"page-three"},[e("div",{staticClass:"img-box"},[e("img",{staticClass:"img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20231118/d776404c-16d9-40ea-b7e1-cda4badfc4de.png"),alt:"models"}})]),t._v(" "),e("div",{staticClass:"content"},[e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("LandingPage3Title")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("LandingPage3SubTitle")))]),t._v(" "),e("el-button",{staticClass:"btn",on:{click:function(e){return t.btnClick(3)}}},[t._v("\n          "+t._s(t.$t("StartFreeTrial"))+"\n          "),e("i",{staticClass:"el-icon-right"})])],1)])]),t._v(" "),e("div",{staticClass:"page-four"},[e("div",{staticClass:"tabs"},t._l(t.toolsTabs,(function(n){return e("div",{key:n.name,staticClass:"item-tab",class:{active:t.toolsCurrentTab===n.name},on:{click:function(e){t.toolsCurrentTab=n.name}}},[e("div",{staticClass:"content"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t(n.tabTitle)))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t(n.tabDesc)))])])])})),0),t._v(" "),t._l(t.toolsTabs,(function(n){return[e("div",{directives:[{name:"show",rawName:"v-show",value:t.toolsCurrentTab===n.name,expression:"toolsCurrentTab === item.name"}],key:n.name,staticClass:"content",class:{animate:t.toolsCurrentTab===n.name}},[e("div",{staticClass:"left"},[e("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:"",src:n.video},domProps:{muted:!0}})]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t(n.title)))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t(n.desc)))]),t._v(" "),e("el-button",{staticClass:"btn",on:{click:function(e){return t.btnClick(4)}}},[t._v("\n            "+t._s(t.$t("StartFreeTrial"))+"\n            "),e("i",{staticClass:"el-icon-right"})])],1)])]}))],2),t._v(" "),e("div",{staticClass:"page-five",style:t.getPageFiveStyle},[e("div",{staticClass:"mask"},[e("LoginCard",{directives:[{name:"show",rawName:"v-show",value:t.isShowLoginCard,expression:"isShowLoginCard"}],attrs:{redirect:"/home",isShowCloseIcon:!1,isAutoFoucs:!1}})],1)])],1)}),[],!1,null,"40b30510",null);e.default=component.exports;installComponents(component,{LoginCard:n(513).default})},5811:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(120),r=n(30),c=n(3),l=n(2),d=(n(20),n(22),n(8),n(4),n(40),n(41),n(38)),h=n(1),v=n(3189),f=n(250),m=n(9),_=["content"];function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"ChatAI",components:{PageSeo:f.a,AiChat:v.default},watch:{characterInfo:{handler:function(t){this.SET_CHARACTER_INFO(t)},deep:!0,immediate:!0}},data:function(){return{pageSeo:{title:"",meta_description:"",key_words:"",tempList:[]},characterInfo:{},characterCode:""}},computed:w(w({},Object(h.e)("user",["userInfo","token"])),Object(h.c)("user",["isLoggedIn"])),head:function(){var t=this.pageSeo,title=t.title,e=t.meta_description,n=t.key_words;title=this.$t(title||"chat_tag_title");var desc=this.$t(e||"chat_tag_desc");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(n)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var n,c,l,h,v,f,y,C,k,O,x,I,title,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,c=t.error,t.route,l=m.a,e.prev=3,e.next=6,Promise.all([n.$post("/api/v1/fast_ai/detail",{name:"ai-chat"}),n.$post("/api/v1/character/detail",{id:l,ss:d.f})]);case 6:return v=e.sent,f=Object(r.a)(v,2),y=f[0],C=f[1],k=y.data,O=k.module,x=k.key_words,I=k.meta_description,title=k.title,S=null!=O&&O.length?null===(h=y.data)||void 0===h?void 0:h.module.map((function(t){var content=t.content;return w(w({},Object(o.a)(t,_)),{},{content:JSON.parse(content)})})):[],e.abrupt("return",{pageSeo:{title:title,meta_description:I,key_words:x,tempList:S},characterInfo:C.data||{},characterCode:C.status.code});case 15:e.prev=15,e.t0=e.catch(3),console.log("aiChat详情页-> asyncData错误啦：",e.t0),c({statusCode:404,message:e.t0});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})))()},methods:w({},Object(h.d)("character",["SET_CHARACTER_INFO"]))},k=C,O=(n(5186),n(0)),component=Object(O.a)(k,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"chat-gpt flex"},[o("ai-chat",{key:"chat-page-instance",attrs:{defaultCharacter:n.characterInfo,defaultCode:n.characterCode}}),n._v(" "),null!==(t=n.pageSeo)&&void 0!==t&&t.tempList.length?o("page-seo",{attrs:{tempList:null===(e=n.pageSeo)||void 0===e?void 0:e.tempList}}):n._e()],1)}),[],!1,null,"553835aa",null);e.default=component.exports},5812:function(t,e,n){"use strict";n.r(e);n(16),n(28),n(21),n(44),n(11),n(6),n(12),n(13),n(4),n(7);var o=n(120),r=n(3),c=n(2),l=(n(20),n(22),n(8),n(1)),d=n(36),h=n(250),v=["content"];function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _=n(505),y={name:"downloadApp",components:{PageSeo:h.a},computed:m(m(m({},Object(l.e)("user",["downloadUrl","cdnHost","token"])),Object(l.c)("user",["cdnHostFun"])),{},{linkMap:{get:function(){return{remark:"hjgjhgkhllkhlj;j;j;",version:"v1.2.4",download_url:"https://".concat(this.cdnHost,"/download/SeaArt_Prod_China_08242249.apk"),gp_play:"https://".concat(this.cdnHost,"/download/SeaArt_Prod_China_08242249.apk"),app_store:"https://".concat(this.cdnHost,"/download/SeaArt_Prod_China_08242249.apk")}},set:function(t){return t}},imgArr:function(){return{zh:{logo:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/logo-zh.png"),phoneImg:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/main-zh-new.png")},ja:{logo:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/logo-other-lang.png"),phoneImg:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/main-ja-new.png")},en:{logo:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/logo-other-lang.png"),phoneImg:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/main-en-new.png")}}},renderImg:function(){var t={},e=Object.keys(this.imgArr);try{for(var n=0,o=e;n<o.length;n++){var r=o[n];this.$route.path.includes(r)&&(t=this.imgArr[r])}0===Object.keys(t).length&&(t=this.imgArr.en)}catch(e){t=this.imgArr.en}return m(m({},t),{},{iosBtn:"https://".concat(this.cdnHostFun(),"/static/upload/20240902/11ab1310-1814-48df-91cd-ba38fb85da4f.png"),googleBtn:"https://".concat(this.cdnHostFun(),"/static/upload/20240902/4fd5aaab-dbfd-475b-b436-9edf958a6290.png"),androidBtn:"https://".concat(this.cdnHostFun(),"/static/upload/20240902/bb65bf9f-ca50-479a-b5b0-06d0080aaa60.png")})},commonImg:function(){return{leftBg:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/download-left-bg.png"),rightBg:"https://".concat(this.cdnHostFun(),"/static/upload/image/download/download-right-bg.png")}},isShowSEO:function(){var t;return(null===(t=this.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)>0&&!this.token}}),data:function(){return{androidUrl:"",iosUrl:"",apkUrl:"https://seeart-guanwang.onelink.me/J0hw/uz4c00w9",pageSEO:{title:"",meta_description:"",key_words:"",tempList:[]}}},mounted:function(){this.getAppLinks(),this.appendQrCode(),this.$logEvent("log_actions",{operation:"download_page_show",behavior_info:"on_homepage_hover_page"})},methods:{appendQrCode:function(){var t=this.$refs.linkCode,e=window.location.href+"?scanQRCodes=1";new _(t,{text:e,width:this.$route.path.includes("ja")?136:114,height:this.$route.path.includes("ja")?136:114})},getAppLinks:function(){var t=this;Object(d.appDownloadUrl)().then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.androidUrl=e.data.google_store_url,t.iosUrl=e.data.ios_url)}))},goStore:function(t){this.$logEvent("log_actions",{operation:2===t?"click_download_ios_app":"click_download_android_app",behavior_info:"on_homepage_hover_page"});var e=null,n="android";1==t&&(e=this.androidUrl),2==t&&(e=this.iosUrl,n="ios"),3==t&&(e=this.apkUrl,n="apk"),e?(window.open(e),this.$logEvent("log_actions",{operation:"click_go_to_app",behavior_info:"on_app_download_page",behavior_info_sub:n})):this.$message(this.$t("downloadAPPTip"))}},head:function(){var t=this.pageSEO,title=t.title,e=t.meta_description,n=t.key_words;title=this.$t(title);var desc=this.$t(e);return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(n)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,data,l,d,title,h,f,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,r=t.error,t.route,e.prev=1,e.next=4,n.$post("/api/v1/fast_ai/detail",{name:"downloadApp"});case 4:return c=e.sent,data=c.data,d=(l=data||{}).module,title=l.title,h=l.meta_description,f=l.key_words,_=null!=d&&d.length?d.map((function(t){var content=t.content;return m(m({},Object(o.a)(t,v)),{},{content:JSON.parse(content)})})):[],y={tempList:_||[],title:title,meta_description:h,key_words:f},e.abrupt("return",{pageSEO:y});case 12:e.prev=12,e.t0=e.catch(1),console.log("下载APP页-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}},w=y,C=(n(5187),n(0)),component=Object(C.a)(w,(function(){var t,e,o,r,c=this,l=c._self._c;return l("div",[l("div",{staticClass:"download-app"},[l("div",{staticClass:"left-box",style:{backgroundImage:"url(".concat(c.commonImg.leftBg,")")}},[l("div",{staticClass:"img-title",on:{click:function(t){c.$router.replace(c.localePath("/"))}}},[l("img",{attrs:{src:null===(t=c.renderImg)||void 0===t?void 0:t.logo,alt:""}})]),c._v(" "),l("div",{staticClass:"text-imgs"},[l("h1",{domProps:{innerHTML:c._s(c.$t("DownloadApp_Title"))}}),c._v(" "),l("p",[c._v(c._s(c.$t("DownloadApp_SubTitle")))]),c._v(" "),l("p",[c._v(c._s(c.$t("DownloadApp_text1")))]),c._v(" "),l("p",[c._v(c._s(c.$t("DownloadApp_text2")))])]),c._v(" "),l("div",{staticClass:"cnt"},[l("div",{ref:"linkCode",staticClass:"code",class:{"code-has-code-tip":!c.$route.path.includes("ja")}},[l("img",{staticClass:"code-logo",attrs:{src:n(745),alt:""}})]),c._v(" "),l("div",{staticClass:"btns"},[l("div",[l("a",{staticClass:"btn-content",attrs:{href:c.androidUrl},on:{click:function(t){return t.preventDefault(),c.goStore(1)}}},[l("img",{attrs:{src:null===(e=c.renderImg)||void 0===e?void 0:e.googleBtn,alt:"google button"}})])])])])]),c._v(" "),l("div",{staticClass:"right-box",style:{backgroundImage:"url(".concat(c.commonImg.rightBg,")")}},[l("img",{attrs:{src:null===(o=c.renderImg)||void 0===o?void 0:o.phoneImg,alt:""}})])]),c._v(" "),l("page-seo",{directives:[{name:"show",rawName:"v-show",value:c.isShowSEO,expression:"isShowSEO"}],attrs:{tempList:null===(r=c.pageSEO)||void 0===r?void 0:r.tempList}})],1)}),[],!1,null,"6ec6221a",null);e.default=component.exports},5815:function(t,e,n){"use strict";n.r(e);n(16),n(18),n(8);var o=n(3),r=n(2),c=(n(20),n(19),n(11),n(6),n(12),n(13),n(7),n(4),n(28),n(44),n(26),n(362)),l=n(201),d=n(63),h=n(172),v=n(79),f=n(372),m=n(10),_=n(1),y=n(681),w=n(45),C=n(635),k=(n(25),n(48)),O=n(359),x=n(317),I=n(240),S=n(58),D=n(116),L=n(427),P=n(39),j=n(171);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={name:"ExploreDetail",mixins:[y.a,w.a,C.taskMixin],components:{FrameDtl:L.default,MetaTooltipVue:c.default,WaterFallVue:l.default,CollectPopover:d.default,ElImageViewer:h.a,AppealDialog:O.default,InviteDialog:x.default,Author:I.default,CmtComments:D.default,homeList:j.a},props:{escClose:{type:Boolean,default:!1}},data:function(){return{loading:!1,parseTime:S.f,copyTextToClipboard:m.g,saveImg:m.M,imgError:m.D,bigImgDialogVisible:!1,scrollContainer:{},waterfallContainer:{},activeIndex:0,activeImg:{},parentInfo:{},imgList:[],noMoreRelated:!1,list:[],followed:!1,showParent:!1,popovervisible:!1,infovisible:!1,imgLoading:!0,cols:7,page:1,relatedLoading:!0,copied:!1,isI18nToggled:!1,time_to:0,imgHeight:0,imgNaturalWidth:0,imgNaturalHeight:0,globalLoading:!1,paymentInfo:null,isShowNullRelatedImg:!1,alreadyNoMoreData:!1,fromPath:"Home",appeaData:{obj_no:"",obj_type:1,remark:""},appealShow:!1,singleImgQuickOperateButtons:[{name:"originality-upscale",icon:"work-originality-upscale",title:this.$t("OriginalityUpscale")},{name:"extra-upscale",icon:"upload-image-icon",title:this.$t("ExtraUpscale")},{name:"variation",icon:"work-variation",title:this.$t("WorkVariations")},{name:"picture-create-picture",icon:"work-picture-create-picture",title:this.$t("UsePicturesForNewCreations")},{name:"remove-background",icon:"work-remove-background",title:this.$t("RemoveBackground")},{name:"animGen",icon:"AnimGenIcon",title:this.$t("AnimGen")},{name:"work-hide-show",icon:"work-show",title:this.$t("PublishOrHideWork")},{name:"work-post",icon:"post-icon2",title:this.$t("GraphicSubmission")},{name:"work-delete",icon:"work-delete",title:this.$t("Delete")}],fourImgsQuickOperateButtons:[{name:"V1",buttonType:"V",buttonNum:1,icon:"",title:this.$t("WorkVariations")},{name:"V2",buttonType:"V",buttonNum:2,icon:"",title:this.$t("WorkVariations")},{name:"V3",buttonType:"V",buttonNum:3,icon:"",title:this.$t("WorkVariations")},{name:"V4",buttonType:"V",buttonNum:4,icon:"",title:this.$t("WorkVariations")},{name:"U1",buttonType:"U",buttonNum:1,icon:"",title:this.$t("WorkUpscale")},{name:"U2",buttonType:"U",buttonNum:2,icon:"",title:this.$t("WorkUpscale")},{name:"U3",buttonType:"U",buttonNum:3,icon:"",title:this.$t("WorkUpscale")},{name:"U4",buttonType:"U",buttonNum:4,icon:"",title:this.$t("WorkUpscale")},{name:"extra-upscale1",buttonType:"extra-upscale",buttonNum:1,icon:"upload-image-icon",title:this.$t("ExtraUpscale")},{name:"extra-upscale2",buttonType:"extra-upscale",buttonNum:2,icon:"upload-image-icon",title:this.$t("ExtraUpscale")},{name:"extra-upscale3",buttonType:"extra-upscale",buttonNum:3,icon:"upload-image-icon",title:this.$t("ExtraUpscale")},{name:"extra-upscale4",buttonType:"extra-upscale",buttonNum:4,icon:"upload-image-icon",title:this.$t("ExtraUpscale")},{name:"remove-background",buttonType:"remove-background",icon:"work-remove-background",title:this.$t("RemoveBackground")},{name:"work-hide-show",icon:"work-show",title:this.$t("ShowOrHide")},{name:"work-delete",icon:"work-delete",title:this.$t("Delete")}],isNewPage:!1,dotReportInfo:{category:"default",view_domain:"details_one",batch_id:""}}},activated:function(){var video=this.$refs.mainVideo;video&&video.paused&&video.play()},mounted:function(){this.paymentInfo=JSON.parse(localStorage.getItem("paymentInfo")),this.isI18nToggled=!this.accountSettingsData.is_off_localization,this.getList()},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPath=e.name,t.setImagePageFromPath(e.path)}))},beforeDestroy:function(){this.list=null,document.body.style.overflow=""},computed:T(T(T(T(T({},Object(_.e)("app",["imagePageFromPath"])),Object(_.c)(["isSupportWebp"])),Object(_.c)("user",["isLoggedIn","userInfo","accountSettingsData","isCompanyAccount"])),Object(_.e)("user",["adminOff"])),{},{imgWidth:function(){var t=window.innerHeight-90;if(this.activeImg){var e,n,img=this.activeImg;if(null!=img&&null!==(e=img.meta)&&void 0!==e&&e.width&&null!=img&&null!==(n=img.meta)&&void 0!==n&&n.height){var o,r,c=t*(null==img||null===(o=img.meta)||void 0===o?void 0:o.width)/(null==img||null===(r=img.meta)||void 0===r?void 0:r.height);return c>850?850:c<440?440:c}}return 440},convertMode:function(){var t,e={1:"createModeType1",2:"createModeType2",6:"createModeType6",4:"createModeType4",5:"createModeType5",7:"studio"},n={v5:1,v6:2,4:4,sdxl:5,hy21:6,studio:7}[null===(t=this.activeImg)||void 0===t?void 0:t.channel]||1;return e[n]?this.$t("".concat(e[n])):""},isSdModel:function(){var t,e;return[5,"5","sdxl"].includes(null==this||null===(t=this.activeImg)||void 0===t?void 0:t.channel)||[5,"5","sdxl"].includes(null==this||null===(e=this.activeImg)||void 0===e?void 0:e.category)},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},enableGreenMode:function(){return this.greenMode},imgCanUpscale:function(){var t,e;return[null===(t=this.activeImg)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.width,null===(e=this.activeImg)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.height].every((function(t){return 2*t<=4096}))},setI18nPrompt:function(){var t=this.activeImg.meta?this.activeImg.meta.prompt:"",e=this.activeImg.local_prompt;return this.isI18nToggled?e:t},imgIsHide:function(){var t;return!(null==this||null===(t=this.activeImg)||void 0===t||!t.status||1==this.activeImg.status)||!this.determineSelfWork&&1==this.activeImg.primary},quickButtonsIsDisplay:function(){return!this.imgIsHide&&1!=this.activeImg.nsfw},isSinglePicture:function(){return 2!=this.activeImg.type}}),methods:T(T(T({},Object(_.d)("app",["setImagePageFromPath"])),Object(_.b)("user",["setAdminOff"])),{},{changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},openAppealShow:function(){this.appeaData.obj_no=this.activeImg.id,this.appealShow=!0,this.popovervisible=!1},operateButtonMouseEnter:function(t){void 0!==t.showToolTip&&!0!==t.showToolTip||this.$set(t,"showToolTip",!1)},operateButtonMouseLeave:function(t){t.showToolTip||this.$set(t,"showToolTip",!0)},imgLoaded:function(t){var img=t.target,e=img.naturalHeight,n=img.naturalWidth;this.imgNaturalWidth=img.naturalWidth,this.imgNaturalHeight=img.naturalHeight,this.imgHeight=508*e/n,this.imgLoading=!1},viewBigImage:function(){this.bigImgDialogVisible=!0},closeViewBigImage:function(){this.bigImgDialogVisible=!1},wordsCopy:function(){var t=this;this.copied=!0;var e=this.activeImg.meta?this.activeImg.meta.prompt:"",n=this.activeImg.local_prompt;this.copyTextToClipboard(this.isI18nToggled?n:e),setTimeout((function(){t.copied=!1}),1e3)},backTo:function(){this.$refs.frameDtl?this.$refs.frameDtl.backTo():this.$router.back()},handleWorkHideOrShow:function(){var t,e,n=this;if(this.paymentInfo.show_auto_pub_switch){var o={id:(null===(t=this.activeImg)||void 0===t?void 0:t.id)||"",is_visible:1==(null===(e=this.activeImg)||void 0===e?void 0:e.primary)};this.hidePopover(),this.globalLoading=!0,Object(f.b)(o).then((function(t){var e,o,r;1e4==(null==t||null===(e=t.status)||void 0===e?void 0:e.code)?(n.$message({message:n.$t("".concat(1==(null===(o=n.activeImg)||void 0===o?void 0:o.primary)?"WorksPublished":"WorksHidden")),type:"success"}),n.$set(n.activeImg,"primary",1==n.activeImg.primary?2:1),n.$set(n.isSinglePicture?n.singleImgQuickOperateButtons[6]:n.fourImgsQuickOperateButtons[13],"icon",1==n.activeImg.primary?"work-hide":"work-show")):n.$message({message:(null==t||null===(r=t.status)||void 0===r?void 0:r.msg)||n.$t("ServerError"),type:"error"})})).finally((function(){n.globalLoading=!1}))}else this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic")},handleWorkDelete:function(){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e={id:t.activeImg.id};t.globalLoading=!0,Object(f.a)(e).then((function(e){var n,o;1e4==(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?(t.$message({message:t.$t("deleteSuccess"),type:"success"}),t.setWaterFallDeleteLits(t.activeImg.id),t.$router.back()):t.$message({message:(null==e||null===(o=e.status)||void 0===o?void 0:o.msg)||t.$t("ServerError"),type:"error"})})).finally((function(){t.globalLoading=!1}))})).catch((function(t){console.log("err",t)}))},reset:function(){this.$refs.mainImage&&(this.$refs.mainImage.src=""),this.activeImg={},this.page=1,this.bigImgDialogVisible=!1,this.imgLoading=!0,this.globalLoading=!1,this.relatedLoading=!0,this.showParent=!1,this.hidePopover(),this.parentInfo={},this.noMoreRelated=!1,this.copied=!1,this.isShowNullRelatedImg=!1,this.alreadyNoMoreData=!1,this.time_to=0,this.imgHeight=0,document.body.style.overflow=""},imgDetail:function(){var t=this;this.loading=!0;var e=this.$route.params.id;e?Object(v.C)({id:e,with_author:!0}).then((function(e){e.data.banner={url:e.data.cover},t.activeImg=e.data})).finally((function(){t.loading=!1})):this.$router.push(this.localePath("/"))},solveScrollbarStyle:function(){var t=document.getElementsByClassName("imgpage-inner")[0],e=(null==t?void 0:t.offsetHeight)<=window.innerHeight;document.body.style.overflow=this.isShowNullRelatedImg&&e?"hidden":"auto"},getList:function(){var t,e,n=this;if(null==this||null===(t=this.activeImg)||void 0===t||!t.id||1==this.activeImg.nsfw||this.noMoreRelated)return this.relatedLoading=!1,void(!this.noMoreRelated&&(this.isShowNullRelatedImg=!0));var o={page:this.page,page_size:20,id:null==this||null===(e=this.activeImg)||void 0===e?void 0:e.id,time_to:this.time_to};this.relatedLoading=!0,Object(v.n)(o).then((function(t){var e;if(null===(e=t.data)||void 0===e||!e.items)return n.noMoreRelated=!0,n.isShowNullRelatedImg=!0,void n.solveScrollbarStyle();!0===t.data.has_more?(n.noMoreRelated=!1,n.page+=1):(n.alreadyNoMoreData=!0,n.noMoreRelated=!0);var o=t.data.items||[];n.time_to=t.data.time_ms,n.list=n.list.concat(o)})).finally((function(){n.relatedLoading=!1}))},goModelDtl:function(t){var e,n={action:"view",obj_no:t,obj_type:2,category:"default",batch_id:"",negative_ids:[],view_domain:"details_one"};(Object(P.i)({items:[n]}),t)&&(null===(e=window)||void 0===e||e.open(this.localePath("/models/detail/".concat(t)),"_blank"))},handlePlay:function(){this.isLoggedIn?this.goBorad():this.$EventBus.$emit("openLoginDialog")},goHome:function(){this.$router.replace(this.localePath("/"))},goBorad:function(path){var t=this.activeImg,e=t.id,n=t.palette;this.$router.push(this.localePath("/editBoard?remix_id=".concat(e,"&publish_type=").concat(null==n?void 0:n.publish_type)))},report:function(){var t=this,e=this.activeImg.id;Object(P.s)({id:e,obj_type:7}).then((function(e){t.popovervisible=!1,t.$message({message:t.$t("ReportSuccess"),type:"success",duration:5e3})}))}}),watch:{appealShow:{handler:function(t){t||(this.appeaData={obj_no:"",obj_type:1,remark:""})}},accountSettingsData:{handler:function(t){this.isI18nToggled=!t.is_off_localization},deep:!0},$route:function(t,e){this.reset(),t.path.indexOf("explore/")>-1&&t.params.id!==e.params.id&&this.imgDetail()},"$route.query":{handler:function(t){var e=t.u_code;e&&Object(k.A)(e)},immediate:!0},bigImgDialogVisible:function(t){document.body.style.overflow=t?"hidden":"auto"}},head:function(){var t=(null==this?void 0:this.activeImg)||{},e=t.author,n=void 0===e?{}:e,o=t.local_prompt,r=void 0===o?"":o,c=t.cover,l=t.name,d=t.intro,h=t.id,v=r||"",f=d||l?(d||l)+" - SeaArt AI":this.$t("newHomeTitle"),m="https://image.cdn2.seaart.ai/static/upload/20240105/74f78417-21a7-457b-ac87-eafcaf8abf61.webp",_=h?"https://www.seaart.ai/editBoard/detail/".concat(h):"https://www.seaart.ai";return{title:f,meta:[{hid:"description",name:"description",content:v},{hid:"og:title",name:"og:title",content:f},{hid:"og:description",name:"og:description",content:v},{hid:"og:image",name:"og:image",content:c||m},{hid:"og:site_name",name:"og:site_name",content:"SeaArt"},{hid:"og:url",name:"og:url",content:_},{hid:"twitter:url",property:"twitter:url",content:_},{hid:"twitter:image",property:"twitter:image",content:c||m},{hid:"twitter:title",name:"twitter:title",content:f},{hid:"twitter:description",name:"twitter:description",content:v},{hid:"twitter:site",name:"twitter:site",content:"@SeaArt_Ai"},{hid:"twitter:creator",name:"twitter:creator",content:(null==n?void 0:n.name)||"@SeaArt_Ai"},{hid:"twitter:card",name:"twitter:card",content:"summary_large_image"}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"ImageObject",acquireLicensePage:"https://image6.cdn.seaart.me/20230808/9598893d-2207-4b30-9036-bf5b026232bf.html",contentUrl:c||m,creator:{name:(null==n?void 0:n.name)||"SeaArt","@type":"Person"},creditText:(null==n?void 0:n.name)||"SeaArt",copyrightNotice:(null==n?void 0:n.name)||"SeaArt",license:"https://image6.cdn.seaart.me/20230808/9598893d-2207-4b30-9036-bf5b026232bf.html"}}],__dangerouslyDisableSanitizers:["script"]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.params,r=t.error,c=o.id,e.prev=2,e.next=5,n.$post("/api/v1/palette/tpl-detail",{id:c,with_author:!0});case 5:return l=e.sent,data=l.data,e.abrupt("return",{activeImg:data||{}});case 10:e.prev=10,e.t0=e.catch(2),console.log("画板品详情页-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()}},R=(n(5337),n(5338),n(0)),component=Object(R.a)(M,(function(){var t,e,o,r,c,l,d=this,h=d._self._c;return h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.globalLoading,expression:"globalLoading"}],ref:"image-gallery",staticClass:"image-gallery"},[h("el-backtop",{attrs:{bottom:30,right:30}},[h("i",{staticClass:"el-icon-top"})]),d._v(" "),h("div",{staticClass:"mobile-back-to",on:{"~click":function(t){return t.stopPropagation(),d.backTo.apply(null,arguments)}}},[h("i",{staticClass:"el-icon-back"})]),d._v(" "),null!==(t=d.activeImg)&&void 0!==t&&t.id?h("div",{staticClass:"imgpage-content flex",on:{click:d.hidePopover}},[h("div",{staticClass:"imgpage-inner"},[h("FrameDtl",{ref:"frameDtl",attrs:{imgIsHide:d.imgIsHide,type:"work"}},[h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.imgLoading,expression:"imgLoading"}],staticClass:"imgpage-image flex",style:{width:d.imgWidth+"px"}},[h("div",{staticClass:"image-container flex"},[h("img",{ref:"mainImage",class:{"blur-img":[2,"2"].includes(d.activeImg.green)&&d.enableGreenMode},attrs:{alt:d.activeImg.local_prompt,src:"".concat(d.getImagUrl(null===(e=d.activeImg)||void 0===e?void 0:e.cover,d.$imgH)||"")},on:{load:function(t){return d.imgLoaded(t)},error:function(t){var e;return d.imgError(null===(e=d.activeImg)||void 0===e?void 0:e.cover,d.$refs.mainImage)}}})])]),d._v(" "),h("h1",{staticClass:"prompt",staticStyle:{display:"none"}},[d._v(d._s(d.activeImg.local_prompt))]),d._v(" "),h("div",{staticClass:"imgpage-info",staticStyle:{width:"450px",padding:"0 24px"}},[h("Author",{attrs:{type:"palette",activeImg:d.activeImg}},[3!=(null===(o=d.activeImg)||void 0===o?void 0:o.type)?h("button",{staticClass:"right-btn button-try",class:d.isLoggedIn?"":"disabled",on:{click:function(t){return d.handlePlay("work")}}},[d._v("\n              "+d._s(d.$t("Remix"))+"\n            ")]):d._e()]),d._v(" "),null!==(r=d.activeImg)&&void 0!==r&&r.id?h("CmtComments",{attrs:{infos:d.activeImg,type:11,dotReportInfo:d.dotReportInfo},scopedSlots:d._u([{key:"cmtInner",fn:function(){var t,e,o,r,c,l,v,f,m,_,y,w,C;return[d.activeImg.prompt||d.activeImg.meta?h("div",{staticClass:"description"},[h("div",{staticClass:"header"},[h("div",{staticClass:"header-left"},[h("div",{staticClass:"title"},[d._v(d._s(d.$t("Prompt")))]),d._v(" "),h("div",{staticClass:"header-copy"},[h("div",{staticClass:"prompt-copy",class:{copied:d.copied},on:{click:function(t){return d.wordsCopy()}}},[h("i",{directives:[{name:"show",rawName:"v-show",value:d.copied,expression:"copied"}],staticClass:"iconfont icon-success"}),d._v(" "),h("i",{directives:[{name:"show",rawName:"v-show",value:!d.copied,expression:"!copied"}],staticClass:"iconfont icon-copy"}),d._v("\n                        "+d._s(d.$t("CopyPrompts"))+"\n                      ")])]),d._v(" "),h("div",{staticClass:"header-trans",on:{click:function(t){d.isI18nToggled=!d.isI18nToggled}}},[h("i",{staticClass:"iconfont icon-i18n_prompt",staticStyle:{color:"#93a2b6"}})])])]),d._v(" "),h("div",{ref:"promptContainer",staticClass:"prompt-container"},[h("div",{staticClass:"prompt"},[d._v(d._s(d.setI18nPrompt))])])]):d._e(),d._v(" "),null!==(t=d.activeImg)&&void 0!==t&&t.meta&&Object.keys(d.activeImg.meta).length?h("div",{staticClass:"model-info"},[h("div",{staticClass:"header flex items-center"},[h("div",{staticClass:"title"},[d._v(d._s(d.$t("INFO")))]),d._v(" "),null!==(e=d.activeImg)&&void 0!==e&&e.meta&&Object.keys(d.activeImg.meta).length?h("span",{on:{click:function(t){t.stopPropagation(),d.infovisible=!d.infovisible}}},[h("el-popover",{staticStyle:{padding:"0"},attrs:{"popper-class":"metaPoper",placement:"right","visible-arrow":!1,trigger:"hover"},on:{click:function(t){t.stopPropagation(),t.preventDefault()}},model:{value:d.infovisible,callback:function(t){d.infovisible=t},expression:"infovisible"}},[h("MetaTooltipVue",{attrs:{sourceFrom:"imageDetail",category:null===(o=d.activeImg)||void 0===o?void 0:o.channel,meta:null===(r=d.activeImg)||void 0===r?void 0:r.meta,model:(null===(c=d.activeImg)||void 0===c?void 0:c.model_id)||(null===(l=d.activeImg)||void 0===l?void 0:l.artwork_no),"model-name":null===(v=d.activeImg)||void 0===v?void 0:v.model_name},on:{copyGenerationData:d.goBorad}}),d._v(" "),h("span",{staticClass:"carousel-icon",attrs:{slot:"reference"},slot:"reference"},[h("i",{staticClass:"iconfont icon-work-tips work-tips"})])],1)],1):d._e()]),d._v(" "),h("el-row",{staticClass:"meta-content flex flex-col",attrs:{type:"flex"}},[h("div",{staticClass:"info flex"},[h("span",{staticClass:"item"},[h("div",{staticClass:"name"},[d._v(d._s(d.$t("Size")))]),d._v(" "),h("div",{staticClass:"value"},[d._v("\n                        "+d._s(d.activeImg.meta.width+"X"+d.activeImg.meta.height)+"\n                      ")])]),d._v(" "),h("span",{staticClass:"item"},[h("div",{staticClass:"name"},[d._v(d._s(d.$t("Date")))]),d._v(" "),h("div",{staticClass:"value"},[d._v(d._s(d.formatDate(d.activeImg.create_at)))])]),d._v(" "),h("span",{directives:[{name:"show",rawName:"v-show",value:d.convertMode,expression:"convertMode"}],staticClass:"item"},[h("div",{staticClass:"name"},[d._v(d._s(d.$t("createModeTitle")))]),d._v(" "),h("div",{staticClass:"value"},[d._v(d._s(d.convertMode))])]),d._v(" "),h("span",{staticClass:"item"},[h("div",{staticClass:"name"},[d._v(d._s(d.$t("Type")))]),d._v(" "),h("div",{staticClass:"value"},[d._v("\n                        "+d._s(d.activeImg.type&&1!=d.activeImg.type&&3!=d.activeImg.type?"grid":"upscale")+"\n                      ")])])])]),d._v(" "),null!==(f=d.activeImg)&&void 0!==f&&f.models&&(null===(m=d.activeImg)||void 0===m||null===(m=m.models)||void 0===m?void 0:m.length)>0?h("div",{staticClass:"models flex flex-wrap"},d._l(null===(_=d.activeImg)||void 0===_?void 0:_.models,(function(t,i){var e,o,r;return h("a",{key:"model_".concat(i),staticClass:"model-item flex items-center",attrs:{href:d.localePath("/models/detail/".concat(t.id))},on:{click:function(e){return e.preventDefault(),d.goModelDtl(t.id)}}},[null!=t&&null!==(e=t.cover)&&void 0!==e&&e.url&&1!==(null==t||null===(o=t.cover)||void 0===o?void 0:o.nsfw)?h("img",{ref:"modelCover".concat(i),refInFor:!0,staticClass:"model-cover",attrs:{src:"".concat(d.getImagUrl(null==t||null===(r=t.cover)||void 0===r?void 0:r.url,d.$imgL)||""),alt:t.name},on:{error:function(e){return d.imgError(null==t?void 0:t.cover,d.$refs["modelCover".concat(i)])}}}):h("img",{staticClass:"model-cover",attrs:{src:n(217),alt:""}}),d._v(" "),h("div",{staticClass:"model-cont flex flex-col"},[h("div",{staticClass:"model-type"},[h("span",{class:{isLora:"Checkpoint"!==(null==t?void 0:t.type)}},[d._v(d._s(null==t?void 0:t.type))])]),d._v(" "),h("div",{staticClass:"model-name text-no-wrap-2"},[d._v(d._s(t.name))])])])})),0):d._e(),d._v(" "),null!==(y=d.activeImg)&&void 0!==y&&y.tags&&(null===(w=d.activeImg)||void 0===w||null===(w=w.tags)||void 0===w?void 0:w.length)>0?h("div",{staticClass:"tag-items flex flex-wrap"},d._l(null===(C=d.activeImg)||void 0===C?void 0:C.tags,(function(t,i){return h("div",{key:"tag_".concat(i),staticClass:"tag-item"},[t.id?[h("a",{attrs:{target:"_self",href:"/tagInfo/"+t.id+"?id="+t.id},on:{click:function(e){return e.preventDefault(),d.goTagDtl(t,"work_detials")}}},[d._v("#"+d._s(null==t?void 0:t.title))])]:d._e()],2)})),0):d._e()],1):d._e()]},proxy:!0},{key:"cmtMore",fn:function(){return[d.isCompanyAccount?d._e():h("button",{staticClass:"commFunNum",on:{click:function(t){return t.stopPropagation(),d.share("palette")}}},[h("i",{staticClass:"iconfont icon-share-icon"})]),d._v(" "),h("button",{staticClass:"commFunNum",on:{click:function(t){return t.stopPropagation(),d.moreActions({type:"save"})}}},[h("i",{staticClass:"iconfont icon-icon-Download"})]),d._v(" "),h("div",{staticClass:"commFunNum",on:{click:function(t){t.stopPropagation(),d.popovervisible=!d.popovervisible}}},[h("el-popover",{ref:"myPopover",attrs:{placement:"top-start","popper-class":"my-popover","visible-arrow":!1,width:"100",trigger:"manual"},model:{value:d.popovervisible,callback:function(t){d.popovervisible=t},expression:"popovervisible"}},[h("div",{staticClass:"pop-btns flex"},[h("button",{on:{click:d.report}},[d._v("\n                      "+d._s(d.$t("Report"))+"\n                    ")])]),d._v(" "),h("button",{staticStyle:{color:"#ffffff"},attrs:{slot:"reference"},slot:"reference"},[h("i",{staticClass:"iconfont icon-more"})])])],1)]},proxy:!0}],null,!1,1701641617)}):d._e()],1)]),d._v(" "),h("div",{staticClass:"imgpage-related"},[h("div",{staticClass:"title-div"},[h("span",{staticClass:"title"},[d._v(d._s(d.$t("ExploreRelated")))])]),d._v(" "),h("div",{ref:"wraper",staticClass:"wraper"},[h("homeList",{attrs:{list:d.list,container:"wraper",dotReportInfo:d.dotReportInfo,isTrainLora:!1},on:{load:d.getList}}),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.relatedLoading,expression:"relatedLoading"}],staticClass:"loading-div"})],1)]),d._v(" "),d.bigImgDialogVisible?h("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":d.closeViewBigImage,"url-list":[d.getImagUrl(null===(c=d.activeImg)||void 0===c?void 0:c.cover)]}}):d._e()],1)]):d._e(),d._v(" "),d.appealShow?h("AppealDialog",{attrs:{"appeal-data":d.appeaData,"is-appealing":d.isAppealLoading,"submit-callback":d.setResourceAppeal,"dialog-visible":d.appealShow},on:{"update:dialogVisible":function(t){d.appealShow=t},"update:dialog-visible":function(t){d.appealShow=t}}}):d._e(),d._v(" "),h("invite-dialog",{ref:"inviteDialog",attrs:{type:"artwork",workId:null===(l=d.activeImg)||void 0===l?void 0:l.id}})],1)}),[],!1,null,"5f34845a",null);e.default=component.exports;installComponents(component,{Author:n(240).default,CmtComments:n(116).default,FrameDtl:n(427).default,AppealDialog:n(359).default,InviteDialog:n(317).default})},5816:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),{components:{ArticleDetail:n(829).a},data:function(){return{detailData:{}}},head:function(){var t=this.detailData,e=t.title,title=void 0===e?"":e,n=t.meta_desc,o=void 0===n?"":n,r=t.author,c=void 0===r?"":r,l=t.cover,d=void 0===l?"":l,h=t.create_at,v=void 0===h?0:h,f=t.update_at,m=void 0===f?0:f;return{title:title,meta:[{hid:"description",name:"description",content:o},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:o}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"NewsArticle",headline:title,image:[d],datePublished:new Date(v).toISOString(),dateModified:new Date(m).toISOString(),author:[{"@type":"Person",name:c}]}}],__dangerouslyDisableSanitizers:["script"]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,e.prev=1,c={seo_url:o.id},e.next=5,n.$post("/api/v1/blog/detail",c);case 5:if(l=e.sent,data=l.data){e.next=9;break}throw new Error("获取数据失败");case 9:return e.abrupt("return",{detailData:data||{}});case 12:e.prev=12,e.t0=e.catch(1),console.log("blog -> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}}),c=n(0),component=Object(c.a)(r,(function(){return(0,this._self._c)("ArticleDetail",{attrs:{type:"blog",detailData:this.detailData}})}),[],!1,null,null,null);e.default=component.exports},5818:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(120),c=n(3),l=(n(20),n(11),n(6),n(22),n(12),n(13),n(8),n(4),n(7),n(250)),d=["content"];function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={components:{PageSeo:l.a},data:function(){return{SEOInfo:{tempList:{},pageInfo:{}}}},head:function(){var t,e=(null===(t=this.pageSEO)||void 0===t?void 0:t.pageInfo)||{},title=e.title,n=e.key_words,o=e.meta_description,r=this.$t(title),desc=this.$t(o);return{title:r,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:r},{hid:"og:description",name:"og:description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(n)}]}},asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,c,l,h,data,f,m,title,_,y,w,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,c=t.error,t.route,e.prev=1,l=null==o?void 0:o.id,e.next=5,n.$post("/api/v1/fast_ai/detail",{name:l,cat:2});case 5:if(h=e.sent,data=h.data,m=(f=data||{}).module,title=f.title,_=f.meta_description,y=f.key_words,data){e.next=10;break}return e.abrupt("return",c({statusCode:404,message:"Not Found"}));case 10:return w=null!=m&&m.length?m.map((function(t){var content=t.content;return v(v({},Object(r.a)(t,d)),{},{content:JSON.parse(content)})})):[],C={tempList:w,pageInfo:{title:title,meta_description:_,key_words:y}},e.abrupt("return",{pageSEO:C});case 15:e.prev=15,e.t0=e.catch(1),console.log("快捷AI详情页-> asyncData错误啦：",e.t0),c({statusCode:404,message:e.t0});case 19:case"end":return e.stop()}}),e,null,[[1,15]])})))()}},m=f,_=n(0),component=Object(_.a)(m,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"custom-page"},[null!==(t=n.pageSEO)&&void 0!==t&&null!==(t=t.tempList)&&void 0!==t&&t.length?o("page-seo",{attrs:{tempList:null===(e=n.pageSEO)||void 0===e?void 0:e.tempList}}):n._e()],1)}),[],!1,null,"3cc9217b",null);e.default=component.exports},5822:function(t,e,n){"use strict";n.r(e);n(16),n(21);var o="https://online.fliphtml5.com/seaart/zzxd/",r="https://online.fliphtml5.com/seaart/qpgb/",c="https://online.fliphtml5.com/seaart/oewl/",l={name:"AnnualReport2024",data:function(){return{height:0}},computed:{src:function(){var t=this.$i18n.locale;return"ja"===t?o:t.includes("zh")?r:c}},mounted:function(){this.getHeight()},methods:{getHeight:function(){var t=document.documentElement.clientHeight;this.height=t}}},d=(n(5495),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"annual-report-container",style:{height:t.height+"px"}},[e("iframe",{staticClass:"annual-report-iframe",attrs:{src:t.src,seamless:"seamless",scrolling:"no",frameborder:"0",allowtransparency:"true",allowfullscreen:"true"}})])}),[],!1,null,"1e69e423",null);e.default=component.exports},5856:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(16),n(4),n(26),n(1)),c=n(153),l=n(9),d=n(85);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"langDialog",props:{},computed:v(v({},Object(r.c)("user",["isLoggedIn","accountSettingsData"])),Object(r.e)("user",["token"])),data:function(){return{languageList:l.ab,dialogVisible:!1,language:"en"}},mounted:function(){var t,e=(null===(t=this.accountSettingsData)||void 0===t?void 0:t.lang_code)||this.$i18n.locale;this.language=e||"en",this.init()},methods:v(v(v(v(v({},Object(r.b)("app",["setLang"])),Object(r.b)("user",["getAccountInfo","updateAccountSettings","logout","getCollectTags"])),Object(r.b)("chatgpt",["getMainMessage"])),Object(r.d)("home",["setAllUpdateStatus"])),{},{init:function(){var t=this;this.initLang(),this.$EventBus.$on("openLangDialog",(function(){t.initLang(),t.dialogVisible=!0}))},initLang:function(){var t=this.$cookies.get("lang")||this.$i18n.locale;this.language=t||"en"},handleChangeLang:function(t){var e=this;if(this.$cookies.set("locaExpire",0),this.$cookies.set("isDeadline",!0),this.$cookies.set("enable_tavern",!1),localStorage.removeItem("homeConfigData"),this.setAllUpdateStatus(!0),this.language=t.value,this.$i18n.locale!==this.language){var n={lang:this.language};this.isLoggedIn?(this.getMainMessage(),Object(d.b)(n).then((function(t){var o=(t||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(e.loading=!1,e.changeLang(),e.$message.success(e.$t("SaveSuccess")),e.updateAccountSettings(n))})).finally((function(){e.loading=!1}))):this.changeLang()}},changeLang:function(){var t=this;Object(c.b)(this.language),localStorage.setItem("language",this.language),this.$cookies.set("lang",this.language),this.token&&this.getCollectTags(this.language),this.$i18n.setLocale(this.language),setTimeout((function(){t.close()}),1500)},close:function(){this.dialogVisible=!1}})},m=(n(5562),n(5563),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"lang-dialog",attrs:{title:t.$t("Language"),visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){t.dialogVisible=!1}}},[e("div",{staticClass:"lang-content flex flex-col"},t._l(t.languageList,(function(n,i){return e("div",{key:"lang_".concat(i),staticClass:"lang-item flex justify-between",on:{click:function(e){return t.handleChangeLang(n)}}},[e("div",{staticClass:"name",class:{active:n.value===t.language}},[t._v(t._s(t.$t(n.name)))]),t._v(" "),n.value===t.language?e("i",{staticClass:"el-icon-check"}):t._e()])})),0)])}),[],!1,null,"15aa8620",null);e.default=component.exports},5858:function(t,e,n){"use strict";n.r(e);n(19),n(16);var o={name:"BusinessTransformationDialog",data:function(){return{isShowDialog:!1,isCredits:!0,showSubscribe:!1,limitTypes:{vip:"",createModeType2:"createModeType2",createModeType6:"createModeType6",studio:"seaartStudio",trainLora:"LoRATrain",LoRATrainQue:"LoRATrainQue",UnlimitedQueue:"UnlimitedQueue",SubsBottomTerms2:"SubsBottomTerms2",privateWork:"SubsBottomTerms6",downloadLimit:"WorkBatchDownload",LoRALimit5:"LoRALimit5",computingPower:"InsufficientBalanceTip",aiToolsPhoto:"ai_tools_10",aiToolsFilter:"ai_tools_4",aiPersonExclusive:"aiPersonExclusive",aiPersonVipRole:"aiPersonVipRole",AiChatSendNotCoin:"AiChatSendNotCoin",AiChatSendVipNotCoin:"AiChatSendVipNotCoin",trainLoraNoVip:"modelTrainLimit"},limitType:"vip",isVipBig:!1}},mounted:function(){var t=this;window.$EventBus=this.$EventBus,this.$EventBus.$on("showBusinessTransformation",(function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.isShowDialog=!0,t.limitType=e,t.isVipBig=n;t.$logEvent("log_actions",{operation:"vip_pop_show",behavior_info:n?"forced_pop":{SubsBottomTerms2:"new_user_fourth_try_quick",computingPower:"insufficient_computing_power",createModeType2:"seaart_20",createModeType6:"seaart_21",studio:"laboratory",UnlimitedQueue:"infinite_queue",LoRATrainQue:"style_training",aiToolsPhoto:"ai_photo_without_vip",aiToolsFilter:"ai_filter_without_vip",LoRALimit5:"lora_limitation"}[e]||""})}))},beforeDestroy:function(){this.$EventBus.$off("showBusinessTransformation")},computed:{getHtml1:function(){return this.$t("VIPTransformationTerm1")},getHtml2:function(){return this.$t("VIPTransformationTerm5")},limitContent:function(){if("computingPower"===this.limitType&&!this.isVipBig)return{title:this.$t("InsufficientBalance"),desc:this.$t("InsufficientBalanceTip"),btn:this.$t("GoRecharge"),btnMini:this.$t("Sale")};if("AiChatMsg"===this.limitType&&!this.isVipBig)return{title:this.$t("InsufficientBalance"),desc:this.$t("AiChatNoCoinMsg"),btn:this.$t("GoRecharge"),btnMini:this.$t("Sale")};if("AiChatSendNotCoin"===this.limitType&&!this.isVipBig)return{title:this.$t("InsufficientBalance"),desc:this.$t("AiChatSendNotCoin"),btn:this.$t("GoRecharge"),btnMini:this.$t("Sale")};if("AiChatSendVipNotCoin"===this.limitType&&!this.isVipBig)return{title:this.$t("InsufficientBalance"),desc:this.$t("AiChatSendVipNotCoin"),btn:this.$t("GoRecharge"),btnMini:this.$t("Sale")};if(this.limitTypes[this.limitType]&&!this.isVipBig){var t=this.limitTypes[this.limitType],e={title:this.$t("BusinessTransformationDialog2"),desc:this.$t("vipLimitContent",{type:this.$t(t)}),btn:this.$t("SubscribeNow"),btnMini:this.$t("Sale")};return"privateWork"===this.limitType&&(e.desc=this.$t("vipLimitContent",{type:this.$t(t),txt:this.$t("DialogVipPrivateTxt")})),e}return{title:this.$t("RightsActivation"),desc:this.$t("RightsActivationTip"),btn:this.$t("GoActivate"),btnMini:this.$t("Sale")}}},methods:{toMall:function(){if(this.isShowDialog=!1,["AiChatSendVipNotCoin","computingPower"].includes(this.limitType))this.$logEvent("log_actions",{operation:"click_popup_to_pay",behavior_info:"credits_not_enough"}),this.$router.push(this.localePath({path:"/mall",query:{dotFrom:this.limitType}}));else{this.$logEvent("log_actions",{operation:"click_popup_to_pay",behavior_info:"not_VIP"});var t="".concat(location.origin).concat(this.localePath("/mall?dotFrom=".concat(this.limitType)));window.open(t,"_blank")}},close:function(){var t=(new Date).getTime()+1728e5;t=new Date(t).setHours(0,0,0,0),localStorage.setItem("bannerPopupTime",new Date(t).getTime()),this.isShowDialog=!1}}},r=o,c=(n(5566),n(0)),component=Object(c.a)(r,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"business-transformation-dialog",class:{"vip-dialog":e.isVipBig},attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowDialog=t}}},[e.isVipBig?[o("div",{staticClass:"container-vip"},[o("i",{staticClass:"el-icon-close close-icon",on:{click:e.close}}),e._v(" "),o("div",{staticClass:"left-img"},[o("div",{staticClass:"content"},[o("div",{staticClass:"img-box"},[o("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}})]),e._v(" "),o("div",{staticClass:"words-top"},[e._v(e._s(e.$t("VIPTransformationIMGDesc1")))]),e._v(" "),o("div",{staticClass:"words-bottom"},[o("span",[e._v(e._s(e.$t("VIPTransformationIMGDesc2")))])])])]),e._v(" "),o("div",{staticClass:"right-content"},[o("div",{staticClass:"title"},[e._v("SeaArt VIP")]),e._v(" "),o("div",{staticClass:"desc"},[e._v(e._s(e.$t("VIPTransformationDesc")))]),e._v(" "),o("div",{staticClass:"terms"},[o("div",{staticClass:"item-term term-one"},[o("i",{staticClass:"icon el-icon-check"}),e._v(" "),o("span",{staticClass:"before",domProps:{innerHTML:e._s(e.getHtml1)}}),e._v(" "),o("span",{staticClass:"point"},[e._v("·")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("VIPTransformationTerm2")))])]),e._v(" "),o("div",{staticClass:"item-term term-two"},[o("i",{staticClass:"icon el-icon-check"}),e._v(" "),o("span",{staticClass:"before"},[e._v(e._s(e.$t("SubsBottomTerms2")))]),e._v(" "),o("span",{staticClass:"point"},[e._v("·")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("VIPTransformationTerm3")))])]),e._v(" "),o("div",{staticClass:"item-term term-three"},[o("i",{staticClass:"icon el-icon-check"}),e._v(" "),o("span",{staticClass:"before"},[e._v(e._s(e.$t("UnlimitedQueue")))]),e._v(" "),o("span",{staticClass:"point"},[e._v("·")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("VIPTransformationTerm4")))])]),e._v(" "),o("div",{staticClass:"item-term term-four"},[o("i",{staticClass:"icon el-icon-check"}),e._v(" "),o("span",{staticClass:"before",domProps:{innerHTML:e._s(e.getHtml2)}}),e._v(" "),o("span",{staticClass:"point"},[e._v("·")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("GetCreditsGive")))])])]),e._v(" "),o("div",{staticClass:"privilege"},[o("img",{staticClass:"img",attrs:{src:"https://image4.cdn.seaart.me/static/upload/20231104/55b08adf-957c-4c5d-aca3-9492bf828598.png",alt:"vip icon"}}),e._v(" "),o("div",{staticClass:"title"},[o("span",[e._v(e._s(e.$t("VIPTransformationPrivilegeTitle")))])]),e._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"item-privilege"},[o("span",{staticClass:"before"},[e._v(e._s(e.$t("vip_dlg_tit4")))]),e._v(" "),o("span",{staticClass:"line"},[e._v("——")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("HigherQuality")))])]),e._v(" "),o("div",{staticClass:"item-privilege"},[o("span",{staticClass:"before"},[e._v(e._s(e.$t("ImagePrivacyGeneration")))]),e._v(" "),o("span",{staticClass:"line"},[e._v("——")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("ImagePrivacyViewing")))])]),e._v(" "),o("div",{staticClass:"item-privilege"},[o("span",{staticClass:"before"},[e._v(e._s(e.$t("ModelTrainingQueue")))]),e._v(" "),o("span",{staticClass:"line"},[e._v("——")]),e._v(" "),o("span",{staticClass:"after"},[e._v(e._s(e.$t("ThreeModelTrainingTasks")))])])])]),e._v(" "),o("div",{staticClass:"footer"},[o("el-button",{staticClass:"cancel",on:{click:e.close}},[e._v("\n              "+e._s(e.$t("ReminderLater"))+"\n            ")]),e._v(" "),o("el-button",{staticClass:"to-mall",on:{click:e.toMall}},[o("div",{staticClass:"desc"},[e._v("\n                "+e._s(e.$t("FreeForNow"))+"\n              ")]),e._v("\n              "+e._s(e.$t("ActivateNow"))+"\n            ")])],1)])])]:o("div",{staticClass:"container-credits"},[o("i",{staticClass:"el-icon-close close-icon",on:{click:e.close}}),e._v(" "),o("div",{staticClass:"top"}),e._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"title"},[e._v("\n          "+e._s(e.limitContent.title)+"\n        ")]),e._v(" "),o("div",{staticClass:"desc"},[e._v("\n          "+e._s(e.limitContent.desc)+"\n        ")])]),e._v(" "),o("div",{staticClass:"btn container-credits-btn",on:{click:e.toMall}},[o("div",{directives:[{name:"show",rawName:"v-show",value:null===(t=e.limitContent)||void 0===t?void 0:t.btnMini,expression:"limitContent?.btnMini"}],staticClass:"desc",attrs:{title:e.limitContent.btnMini}},[e._v("\n          "+e._s(e.limitContent.btnMini)+"\n        ")]),e._v("\n        "+e._s(e.limitContent.btn)+"\n      ")])])],2)}),[],!1,null,null,null);e.default=component.exports},5864:function(t,e,n){"use strict";n.r(e);var o=[function(){var t=this._self._c;return t("div",{staticClass:"img-box"},[t("img",{attrs:{src:n(1047),alt:"seaArt.AI"}})])}],r=(n(11),n(6),n(12),n(13),n(8),n(4),n(7),n(3)),c=n(2),l=(n(20),n(38)),d=n(25),h=n(1);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"AiChatSexDialog",data:function(){return{visible:!1,selectSex:"",options:[{i18nkey:"informationDialog6",url:"female.webp",value:"female"},{i18nkey:"informationDialog5",url:"male.webp",value:"male"},{i18nkey:"informationDialog7",url:"gener-non_binary.png",value:"non_binary"}]}},computed:f({},Object(h.c)("user",["userInfo"])),methods:f(f({},Object(h.d)("user",["SET_USER_INFO"])),{},{handleSex:function(t){this.$logEvent("log_actions",{operation:"click_choose_gender",behavior_info:"on_digital_human_gender_choose_page",behavior_info_sub:t}),this.selectSex=t,this.handleClose()},show:function(){this.visible=!0,document.body.style.overflow="hidden"},handleClose:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.overflow="",t.selectSex||(t.selectSex=""),t.$EventBus.$emit("updateSexList",t.selectSex),t.visible=!1,null!=(n=Object(d.cloneDeep)(t.userInfo)||{})&&n.character_setting?n.character_setting.gender=t.selectSex:n.character_setting={gender:t.selectSex},t.SET_USER_INFO(n),e.prev=7,e.next=10,Object(l.ab)({gender:t.selectSex});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),console.log("setAiChatConfig gener error",e.t0);case 15:localStorage.setItem("aiChatSexDialogShow",!0);case 16:case"end":return e.stop()}}),e,null,[[7,12]])})))()}}),beforeDestroy:function(){document.body.style.overflow=""}},_=(n(5586),n(0)),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"sex-dialog-wrapper"},[e("div",{staticClass:"sex-dialog-mask"}),t._v(" "),e("div",{staticClass:"sex-dialog"},[e("div",{staticClass:"modal-header-close",on:{click:function(e){return e.stopPropagation(),t.handleClose()}}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"modal-header-title"},[e("div",{staticClass:"modal-header-title-big"},[t._v(t._s(t.$t("characterSexTitle2")))])]),t._v(" "),e("div",{staticClass:"modal-header-sex"},t._l(t.options,(function(o,r){return e("div",{key:r,staticClass:"modal-header-sex-item",on:{click:function(e){return e.stopPropagation(),t.handleSex(o.value)}}},[2===r?[e("div",{staticClass:"modal-header-sex-item modal-header-sex-item-other"},[t._m(0,!0),t._v(" "),e("span",{staticClass:"label"},[t._v(t._s(t.$t(o.i18nkey)))])])]:[e("img",{attrs:{src:n(499)("./".concat(o.url)),alt:"seaArt.AI"}}),t._v(" "),e("span",{staticClass:"label"},[t._v(t._s(t.$t(o.i18nkey)))])]],2)})),0)])]):t._e()}),o,!1,null,"193279d9",null);e.default=component.exports},5869:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),r=n(2),c=(n(20),n(32),n(22),n(4),n(26),n(145)),l=n(36),d=n(1);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"LatestUpdateDialog",mixins:[c.a],data:function(){return{dialogVisible:!0,tabActiveIndex:0,sliderTop:0,sliderHeight:0,timer:null,tabContentList:[],tabContent:{},activeTabId:"",autoSwitchTimer:null,isAnimating:!1,loading:!0}},computed:v(v({},Object(d.e)("eventCenter",["latestUpdateTabs"])),{},{sliderStyle:function(){return{height:this.sliderHeight+"px",transform:"translateY(".concat(this.sliderTop,"px)")}}}),mounted:function(){this.getFacePopupModuleList(),this.$nextTick(this.updateSlider),window.addEventListener("resize",this.updateSlider),this.$xyLogEvent({front_operation:"exposure",entity_name:"latestUpdateDialog-show",entity_type:"latestUpdateDialog",obj_id:"ec_face_popup_show"})},beforeDestroy:function(){window.removeEventListener("resize",this.updateSlider),clearInterval(this.timer)},methods:{getFacePopupModuleList:function(){var t;this.activeTabId=(null===(t=this.latestUpdateTabs[0])||void 0===t?void 0:t.latest_content_id)||"",this.getFacePopupContentInfo()},getFacePopupContentInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={content_ids:t.latestUpdateTabs.map((function(t){return t.latest_content_id}))},e.next=3,Object(l.getFacePopupContent)(n);case 3:o=e.sent;try{data=o.data,t.tabContentList=data.items,t.getContentInfo(),t.startAutoSwitch()}catch(t){console.error("getFacePopupContentInfo error",t)}finally{t.$nextTick((function(){t.loading=!1}))}case 5:case"end":return e.stop()}}),e)})))()},show:function(){return!0},handleClose:function(){this.$emit("close"),this.$xyLogEvent({front_operation:"click",entity_name:"eventCenter-latestUpdateDialog-close",entity_type:"latestUpdateDialog",obj_id:"ec_face_popup_click_close"})},handleTabClick:function(t){this.tabActiveIndex=t,this.activeTabId=this.latestUpdateTabs[t].latest_content_id,this.getContentInfo(),this.$nextTick(this.updateSlider),this.$xyLogEvent({front_operation:"click",entity_name:"latestUpdateDialog-tabClick",entity_type:"latestUpdateDialog",obj_id:"ec_face_popup_click_nav",obj_info:{target_page:t,latest_content_id:this.activeTabId}})},getContentInfo:function(){var t=this,e=this.tabContentList.find((function(e){return e.content_id===t.activeTabId}));this.tabContent=(null==e?void 0:e.content)||{}},updateSlider:function(){var t=this.$refs.tabItems;if(t&&t[this.tabActiveIndex]){var e=Array.isArray(t)?t[this.tabActiveIndex]:t;this.sliderTop=e.offsetTop,this.sliderHeight=e.offsetHeight}},startAutoSwitch:function(){var t=this;this.timer&&clearInterval(this.timer);var e=this.latestUpdateTabs[this.tabActiveIndex].duration;"number"==typeof e&&e>=2&&e<=15?e*=1e3:e=7e3,this.timer=setTimeout((function(){t.tabActiveIndex=(t.tabActiveIndex+1)%t.latestUpdateTabs.length,t.activeTabId=t.latestUpdateTabs[t.tabActiveIndex].latest_content_id,t.getContentInfo(),t.$nextTick((function(){t.scrollTabIntoView(t.tabActiveIndex)})),t.startAutoSwitch()}),e)},scrollTabIntoView:function(t){var e=this.$refs.tabItems;e&&e[t]&&(Array.isArray(e)?e[t]:e).scrollIntoView({behavior:"smooth",block:"nearest"})},resetAutoSwitch:function(){clearInterval(this.timer)},handleReceive:function(){window.open(this.tabContent.button_link,"_blank"),this.$xyLogEvent({front_operation:"click",entity_name:"latestUpdateDialog-receive",entity_type:"latestUpdateDialog",obj_id:"ec_face_popup_click_cta",obj_info:{latest_content_id:this.activeTabId,target_url:this.tabContent.button_link}})}},watch:{tabActiveIndex:function(){this.$nextTick(this.updateSlider)}}},m=(n(5595),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,"custom-class":"latest-update-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"content",on:{click:t.resetAutoSwitch}},[e("div",{staticClass:"content-left"},[e("div",{staticClass:"content-left-title"},[t._v("\n        "+t._s(t.$t("latest_updates_title"))+"\n      ")]),t._v(" "),e("div",{staticClass:"content-left-content"},[t._l(t.latestUpdateTabs,(function(n,o){return e("div",{key:n.content_id,ref:"tabItems",refInFor:!0,staticClass:"content-left-content-item",class:{"content-left-content-item-active":o===t.tabActiveIndex},on:{click:function(e){return t.handleTabClick(o)}}},[e("div",{staticClass:"content-left-content-item-label"},[t._v(t._s(n.title))])])})),t._v(" "),e("div",{staticClass:"tab-slider",style:t.sliderStyle})],2)]),t._v(" "),t.loading?t._e():e("div",{staticClass:"content-right"},[t.tabContent.cover_url?e("transition",{attrs:{name:"fade-slide",mode:"out-in"}},[e("img",{key:t.tabActiveIndex,staticClass:"content-right-img",attrs:{src:t.tabContent.cover_url,alt:"latestUpdate_1"}})]):t._e(),t._v(" "),e("transition",{attrs:{name:"fade-slide",mode:"out-in"}},[e("div",{key:t.tabActiveIndex,staticClass:"content-right-content"},[t.tabContent.title?e("p",{staticClass:"content-right-content-title"},[t._v(t._s(t.tabContent.title))]):t._e(),t._v(" "),t.tabContent.content?e("p",{staticClass:"content-right-content-desc",domProps:{innerHTML:t._s(t.tabContent.content)}}):t._e()])]),t._v(" "),e("transition",{attrs:{name:"fade-slide",mode:"out-in"}},[e("div",{key:t.tabActiveIndex,staticClass:"content-right-bottom"},[t.tabContent.button_text?e("button",{staticClass:"content-right-bottom-btn",on:{click:t.handleReceive}},[t._v("\n            "+t._s(t.tabContent.button_text)+"\n          ")]):t._e()])])],1),t._v(" "),e("Icon",{staticClass:"content-right-close",attrs:{name:"close",size:"12",color:"#fff"},nativeOn:{click:function(e){return t.handleClose.apply(null,arguments)}}})],1)])}),[],!1,null,"491a8078",null);e.default=component.exports},5873:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(8),n(7);var o=n(3),r=n(14),c=n(2),l=(n(679),n(47),n(416)),d=n.n(l),h=(n(20),n(19),n(6),n(32),n(22),n(31),n(4),n(43),n(77),n(34)),v=n(1),f=n(163),m=n(81),_=n(147),y=n(810),w=n(167);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"ActivityClaimDialog",components:{ElAvatar:d.a},data:function(){return{TASK_CATEGORY_TYPE:w.a,calcTaskCategoryType:w.c,TASK_PROGRESS_STATUS:w.b,calcTaskProgressStatus:w.d,dialogVisible:!1,checkInList:[],checkInListLoading:!1,dailyActivityList:[],dailyActivityListLoading:!1,officialActivityList:[],officialActivityListLoading:!1,taskList:[],taskListLoading:!1}},computed:k(k({},Object(v.c)("user",["isLoggedIn"])),{},{canClaim:function(){var t=new Date,e="".concat(t.getUTCFullYear()).concat((t.getUTCMonth()+1).toString().padStart(2,"0")).concat(t.getUTCDate().toString().padStart(2,"0"));return this.checkInList.some((function(t){return t.date===e&&!t.is_finish}))},claimBtnText:function(){var t,e,n=this.canClaim||this.checkInListLoading?this.$t("CheckInNow"):this.$t("activity_claimed"),o=(this.canClaim?null===(t=this.checkInList)||void 0===t||null===(t=t.find((function(t){return!t.is_finish})))||void 0===t?void 0:t.reward_value:null===(e=Object(r.a)(this.checkInList))||void 0===e||null===(e=e.reverse())||void 0===e||null===(e=e.find((function(t){return t.is_finish})))||void 0===e?void 0:e.reward_value)||"???",c=this.$t("tempCoins");return"".concat(n," + ").concat(o," ").concat(c)},claimedPercent:function(){var t,e,n=null===(t=this.checkInList)||void 0===t?void 0:t.filter((function(t){return t.is_finish}));return(null==n?void 0:n.length)/(null===(e=this.checkInList)||void 0===e?void 0:e.length)*100},currentDailyActivity:function(){var t;return(null===(t=this.dailyActivityList)||void 0===t?void 0:t.find((function(t){return t.is_current})))||{}},currentOfficialActivity:function(){var t,e=(new Date).getUTCDate(),n=new y.a(e).randomInt(0,this.officialActivityList.length-1);return(null===(t=this.officialActivityList)||void 0===t?void 0:t[n])||{}},dailyTaskList:function(){return this.taskList.slice(4).filter((function(t,e){return Object(w.c)(t,e+4).id===w.a.dailyTask.id})).map((function(t){return Object(h.reactive)(k(k({},t),{},{isLoading:!1}))}))}}),watch:{dialogVisible:function(t){t&&(this.initActivityCheckInInfo(),this.initActivityList(),this.initTaskList(),this.getPaymentInfo(),this.initWaitTakeNum())}},methods:k(k(k({},Object(v.d)("user",["setOpenEdit","setWaitTakeNum"])),Object(v.b)("payment",["getPaymentInfo"])),{},{show:function(){this.dialogVisible=!0},hide:function(){this.dialogVisible=!1},initActivityCheckInInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.checkInListLoading=!0,e.next=3,Object(f.d)();case 3:n=e.sent,t.checkInList=n.data.week_item_list,t.checkInListLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},initActivityList:function(){var t=this;this.dailyActivityListLoading=!0,Object(m.m)({activity_type:0,size:1e3}).then((function(e){var n;t.dailyActivityList=(null===(n=e.data)||void 0===n?void 0:n.items)||[]})).finally((function(){t.dailyActivityListLoading=!1})),this.officialActivityListLoading=!0,Object(m.m)({activity_type:1,activity_status:2,is_filter_no_participated:1,size:1e3}).then((function(e){var n;t.officialActivityList=(null===(n=e.data)||void 0===n?void 0:n.items)||[]})).finally((function(){t.officialActivityListLoading=!1}))},initTaskList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.taskListLoading=!0,e.next=3,Object(_.e)();case 3:n=e.sent,t.taskList=n.data,t.taskListLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},initWaitTakeNum:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.n)();case 2:1e4===(n=e.sent).status.code&&t.setWaitTakeNum(n.data.num);case 4:case"end":return e.stop()}}),e)})))()},onClaimClick:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.canClaim){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoggedIn){e.next=5;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 5:return t.$logEvent("log_actions",{operation:"click_claim",behavior_info:"on_createflow_page_popup",behavior_info_sub:"check_in"}),t.checkInListLoading=!0,e.next=9,Object(f.a)();case 9:return e.next=11,t.initActivityCheckInInfo();case 11:t.checkInListLoading=!1,t.getPaymentInfo();case 13:case"end":return e.stop()}}),e)})))()},calcRemainingTime:function(t){var e=(new Date).getTime(),n=new Date(t.end_time).getTime()-e;if(n<=0)return t.number_of_award>0?this.$t("awarded"):this.$t("awarding");var o=Math.floor(n/864e5),r=Math.floor(n%864e5/36e5);return this.$t("submit_countdown",{num1:o,num2:r})},onActivityItemClick:function(t){var e={0:"/event-center/daily/".concat(t.id),1:"/event-center/activity/".concat(t.id)};this.hide(),window.open(e[t.activity_type],"_blank")},onTaskCardOperateBtnClick:function(t){Object(w.d)(t).id!==w.b.alreadyTake.id&&(Object(w.d)(t).id===w.b.waitTake.id&&this.handleAwardTake(t),Object(w.d)(t).id===w.b.waitComplete.id&&this.handleGoCompleteTask(t))},handleAwardTake:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isLoading=!0,n.prev=1,n.next=4,Object(_.c)({award_id:t.id});case 4:if(1e4===(o=n.sent).status.code){n.next=13;break}if(40009!==o.status.code){n.next=11;break}return e.$message.error(e.$t("error_code_40009")),n.abrupt("return");case 11:return(null==o||null===(r=o.status)||void 0===r?void 0:r.msg)&&e.$message.error(o.status.msg),n.abrupt("return");case 13:e.$message.success(e.$t("ClaimSucceess")),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(1),console.error(n.t0);case 19:return n.prev=19,e.initWaitTakeNum(),e.getPaymentInfo(),e.initTaskList(),t.isLoading=!1,n.finish(19);case 25:case"end":return n.stop()}}),n,null,[[1,16,19,25]])})))()},handleGoCompleteTask:function(t){if(this.isLoggedIn)switch(this.$logEvent("log_actions",{operation:"click_go_to_finish",behavior_info:"on_task_center_page"}),this.hide(),t.go_type){case"page":"/personal"==t.go_url&&this.setOpenEdit(1),window.open(this.localePath(t.go_url),"_blank");break;case"popup":this.handlePopupTypeTask(t.go_url)}else this.$EventBus.$emit("openLoginDialog")},handlePopupTypeTask:function(t){if("task_artwork"===t);else this.$EventBus.$emit("openContribution")},onShowMoreBtnClick:function(){this.hide(),window.open("/event-center/task","_blank")}})},x=O,I=(n(5623),n(0)),component=Object(I.a)(x,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,"custom-class":"activity-claim-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"close-btn",on:{click:t.hide}},[e("Icon",{attrs:{name:"close",size:"12",color:"#fff"}})],1),t._v(" "),e("div",{staticClass:"section-left"},[e("div",{staticClass:"section-left-wrapper"},[e("div",{staticClass:"title-line"},[e("div",{staticClass:"title"},[e("Icon",{attrs:{name:"icon-checkin",size:"20"}}),t._v(" "),e("span",{staticClass:"title-text"},[t._v(t._s(t.$t("sign_in")))])],1),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("continuous_claim_assist_ai")))])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.checkInListLoading,expression:"checkInListLoading"}],staticClass:"day-list"},t._l(t.checkInList,(function(o,r){return e("div",{key:r,staticClass:"day-item"},[e("div",{staticClass:"day-value",class:{claimed:o.is_finish}},[e("span",[t._v("+"+t._s(o.reward_value))]),t._v(" "),o.is_finish?[e("Icon",{attrs:{name:"a-Group48048",size:"14",color:"#34C759"}})]:[e("img",{attrs:{src:n(160)}})]],2),t._v(" "),e("div",{staticClass:"day-text",class:{claimed:o.is_finish}},[t._v("\n            "+t._s(t.$t("day_n",{n:r+1}))+"\n          ")])])})),0),t._v(" "),e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-bar-wrapper"},[e("div",{staticClass:"progress-bar-inner",style:{width:"".concat(t.claimedPercent,"%")}})])]),t._v(" "),e("div",{staticClass:"claim-button",class:{disabled:!t.canClaim},on:{click:t.onClaimClick}},[t._v("\n        "+t._s(t.claimBtnText)+"\n      ")])])]),t._v(" "),e("div",{staticClass:"section-right"},[e("div",{staticClass:"section-right-top"},[e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("join_activity_win_award")))]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dailyActivityListLoading||t.officialActivityListLoading,expression:"dailyActivityListLoading || officialActivityListLoading"}],staticClass:"activity-list"},[e("div",{staticClass:"activity-item",attrs:{"data-event":"claim_dialog_activity_daily_click_btn"},on:{click:function(e){return t.onActivityItemClick(t.currentDailyActivity)}}},[e("div",{staticClass:"activity-cover",style:{backgroundImage:"url(".concat(t.currentDailyActivity.cover,")")}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.currentDailyActivity.title,expression:"currentDailyActivity.title"}],staticClass:"activity-info"},[e("div",{staticClass:"title-info"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("DailyChallenge")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("today_activity_is",{title:t.currentDailyActivity.title})))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.currentDailyActivity.reward_type,expression:"currentDailyActivity.reward_type === 1"}],staticClass:"award"},[e("img",{staticClass:"img-icon",attrs:{src:n(205)}}),t._v(" "),e("span",{staticClass:"award-text"},[t._v(t._s(t.$t("win_x_credits",{num:t.currentDailyActivity.reward_num})))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.currentDailyActivity.reward_type,expression:"currentDailyActivity.reward_type === 2"}],staticClass:"award"},[e("img",{staticClass:"img-icon",attrs:{src:n(160)}}),t._v(" "),e("span",{staticClass:"award-text"},[t._v(t._s(t.$t("win_x_stamina",{num:t.currentDailyActivity.reward_num})))])])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.currentOfficialActivity.id,expression:"currentOfficialActivity.id"}],staticClass:"activity-item",attrs:{"data-event":"claim_dialog_activity_official_click_btn"},on:{click:function(e){return t.onActivityItemClick(t.currentOfficialActivity)}}},[e("div",{staticClass:"activity-cover",style:{backgroundImage:"url(".concat(t.currentOfficialActivity.cover,")")}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.currentOfficialActivity.title,expression:"currentOfficialActivity.title"}],staticClass:"activity-info"},[e("div",{staticClass:"title-info"},[e("div",{staticClass:"title"},[t._v(t._s(t.currentOfficialActivity.title))]),t._v(" "),e("div",{staticClass:"sub-title"},[e("Icon",{directives:[{name:"show",rawName:"v-show",value:!t.currentOfficialActivity.number_of_award,expression:"!currentOfficialActivity.number_of_award"}],staticClass:"countdown-icon",attrs:{name:"icon-event-time",size:"12",color:"#fff"}}),t._v(" "),e("span",{staticClass:"countdown-text"},[t._v(t._s(t.calcRemainingTime(t.currentOfficialActivity)))])],1)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.currentOfficialActivity.total_reward_type,expression:"currentOfficialActivity.total_reward_type === 1"}],staticClass:"award"},[e("img",{staticClass:"img-icon",attrs:{src:n(205)}}),t._v(" "),e("span",{staticClass:"award-text"},[t._v("\n                "+t._s(t.$t("win_x_credits",{num:t.currentOfficialActivity.total_reward_pool}))+"\n              ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.currentOfficialActivity.total_reward_type,expression:"currentOfficialActivity.total_reward_type === 2"}],staticClass:"award"},[e("img",{staticClass:"img-icon",attrs:{src:n(160)}}),t._v(" "),e("span",{staticClass:"award-text"},[t._v("\n                "+t._s(t.$t("win_x_stamina",{num:t.currentOfficialActivity.total_reward_pool}))+"\n              ")])])])])])]),t._v(" "),e("div",{staticClass:"section-right-bottom"},[e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("do_task_win_award")))]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.taskListLoading,expression:"taskListLoading"}],staticClass:"task-list"},t._l(t.dailyTaskList,(function(o,r){return e("div",{key:r,staticClass:"task-list-item",style:{opacity:t.calcTaskProgressStatus(o).id===t.TASK_PROGRESS_STATUS.alreadyTake.id?.4:1}},[e("div",{staticClass:"left-info"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t(o.title_key)))]),t._v(" "),e("div",{staticClass:"award-num"},[e("el-avatar",{directives:[{name:"show",rawName:"v-show",value:2===o.award_type,expression:"item.award_type === 2"}],attrs:{size:18,shape:"square",src:n(205)}}),t._v(" "),e("el-avatar",{directives:[{name:"show",rawName:"v-show",value:4===o.award_type,expression:"item.award_type === 4"}],staticStyle:{"margin-right":"-4px"},attrs:{size:18,shape:"square",src:n(160)}}),t._v(" "),e("span",{staticClass:"value"},[t._v("+ "+t._s(o.award_num))])],1)]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isLoading,expression:"item.isLoading"}],staticClass:"operate-btn",class:t.calcTaskProgressStatus(o).className,on:{click:function(e){return t.onTaskCardOperateBtnClick(o)}}},[t._v("\n            "+t._s(t.$t(t.calcTaskProgressStatus(o).btnText))+"\n          ")])])})),0),t._v(" "),e("div",{staticClass:"show-more-btn",attrs:{"data-event":"claim_dialog_task_show_more_click_btn"},on:{click:t.onShowMoreBtnClick}},[t._v("\n        "+t._s(t.$t("show_more_task_award"))+" >>\n      ")])])])])}),[],!1,null,"1deaaf93",null);e.default=component.exports},5879:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1),c=n(258),l=n(235);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"UnsubSelect",components:{SubHead:c.a,SubFooter:l.a},computed:h(h({},Object(r.e)("payment",["paymentInfo","subThirdType","subscriptionUrl"])),{},{showUpdate:function(){return!1}}),methods:{toUpdate:function(){window.open(this.subscriptionUrl,"_blank")},continueCancel:function(){this.$emit("next-step","confirmUnsub")}}},f=(n(5666),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-select unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("ManageSubscription")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("unsubQuestion")))]),t._v(" "),e("div",{staticClass:"options flex flex-col"},[e("div",{staticClass:"option",on:{click:t.continueCancel}},[t._v(t._s(t.$t("unsubscribe"))),e("i",{staticClass:"el-icon-arrow-right"})])])]),t._v(" "),e("SubFooter",{on:{handleCancel:function(e){return t.$emit("click-close")}},scopedSlots:t._u([{key:"cancel",fn:function(){return[t._v("\n      "+t._s(t.$t("close"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"4e31c940",null);e.default=component.exports},5880:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(258),c=n(235),l=n(58),d=n(1);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"UnsubConfirm",components:{SubFooter:c.a,SubHead:r.a},computed:v(v({},Object(d.c)("payment",["paymentInfo"])),{},{expireDate:function(){var t;return null!==(t=this.paymentInfo)&&void 0!==t&&t.svipExpiryTime?Object(l.i)(this.paymentInfo.svipExpiryTime,"yyyy/MM/dd"):""}}),data:function(){return{features:["break_rigths_1","break_rigths_2","daily_rights_4","break_rigths_4","WorkPrivacyRights","sureDlgLine"]}},methods:{continueCancel:function(){this.$emit("next-step","advice")}}},m=(n(5667),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-confirm unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("RUsure")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"description flex flex-col"},[e("div",{staticClass:"line1",domProps:{innerHTML:t._s(t.$t("sureDlgTitle",{day:t.expireDate}))}}),t._v(" "),e("div",{staticClass:"line2",domProps:{innerHTML:t._s(t.$t("sureDlgSubTitle"))}})]),t._v(" "),e("div",{staticClass:"feature-list flex flex-col"},t._l(t.features,(function(o,r){return e("div",{key:"feature"+r,staticClass:"feature flex items-center"},[e("div",{staticClass:"icon flex items-center justify-center"},[e("img",{staticClass:"icon-image",attrs:{src:n(5709)("./sure_dlg_".concat(r,".png")),alt:"icon",loading:"lazy",width:"24",height:"24"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t(o)))])])})),0)]),t._v(" "),e("SubFooter",{on:{handleCancel:function(e){return t.$emit("click-close")},confirm:t.continueCancel},scopedSlots:t._u([{key:"cancel",fn:function(){return[t._v("\n      "+t._s(t.$t("thinkAbout"))+"\n    ")]},proxy:!0},{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("yesUnsub"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"34834fca",null);e.default=component.exports},5881:function(t,e,n){"use strict";n.r(e);var o=n(258),r=n(235),c=n(323),l={name:"UnsubAdvice",components:{SubFooter:r.a,SubHead:o.a},data:function(){return{adviceList:[],textarea:""}},methods:{handleSelect:function(t){},handleNext:function(){this.$logEvent("log_actions",{operation:"click_go_on",behavior_info:"on_unsubscribe_page"}),this.submitAdvice(),this.$emit("next-step","pause")},submitAdvice:function(){var t={category:JSON.stringify(this.adviceList),content:this.textarea};Object(c.c)(t).then((function(t){console.log("res",t)}))}}},d=(n(5668),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-advice unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("suggestion")))]),t._v(" "),e("div",{staticClass:"main"},[e("el-checkbox-group",{staticClass:"checkbox-group flex flex-col",on:{change:function(e){return t.handleSelect(e)}},model:{value:t.adviceList,callback:function(e){t.adviceList=e},expression:"adviceList"}},[e("el-checkbox",{attrs:{label:"neverUse"}},[t._v(t._s(t.$t("neverUse")))]),t._v(" "),e("el-checkbox",{attrs:{label:"tooExpensive"}},[t._v(t._s(t.$t("tooExpensive")))]),t._v(" "),e("el-checkbox",{attrs:{label:"missingFeature"}},[t._v(t._s(t.$t("missingFeature")))]),t._v(" "),e("el-checkbox",{attrs:{label:"dislikeVip"}},[t._v(t._s(t.$t("disLikeVip")))]),t._v(" "),e("el-checkbox",{attrs:{label:"other"}},[t._v(t._s(t.$t("other")))])],1),t._v(" "),e("div",{staticClass:"share-title"},[t._v(t._s(t.$t("otherSuggestions")))]),t._v(" "),e("el-input",{attrs:{type:"textarea",rows:"8",placeholder:t.$t("otherSuggestionsHold"),maxlength:"1000","show-word-limit":""},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1),t._v(" "),e("SubFooter",{on:{confirm:t.handleNext},scopedSlots:t._u([{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("Continue"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"0b6956c2",null);e.default=component.exports},5882:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(16),n(21),n(1)),c=n(258);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"Unsub4Pause",components:{SubFooter:n(235).a,SubHead:c.a},computed:d(d(d({},Object(r.e)("payment",["paymentInfo","payRange"])),Object(r.c)("unsubscribe",["userFreeTryStatus","prevPlanId","in3daysTrial","nextConfig"])),{},{allowPause:function(){return 1!==this.userFreeTryStatus&&2!==this.userFreeTryStatus&&!this.in3daysTrial},neverTryed:function(){return 0===this.userFreeTryStatus},isMonthly:function(){return 2===this.payRange},isMasterDiscount:function(){var t;return null===(t=this.prevPlanId)||void 0===t?void 0:t.includes("4_discount")},nextIsDiscount:function(){var t;return null===(t=this.nextConfig)||void 0===t||null===(t=t.nextPlan)||void 0===t?void 0:t.includes("discount")}}),data:function(){return{options:[{value:"1",label:this.$t("numMonths",{num:1})},{value:"2",label:this.$t("numMonths",{num:2})},{value:"3",label:this.$t("numMonths",{num:3})}],pauseMonth:"1"}},methods:{handleNext:function(){this.$logEvent("log_actions",{operation:"click_keep_on_cancelling",behavior_info:"on_unsubscribe_page"}),this.neverTryed&&this.isMonthly&&!this.in3daysTrial&&!this.nextIsDiscount?(console.log("in Pause, Try for free"),this.$emit("next-step","freeTry")):this.isMasterDiscount?this.$emit("next-step","unsubFinal"):(console.log("in Pause, Continue unsubscribe"),this.$emit("next-step","discount"))},handlePauseSub:function(){if(this.$logEvent("log_actions",{operation:"click_stop_subscribing",behavior_info:"on_unsubscribe_page",behavior_info_sub:this.pauseMonth+"_month"}),this.allowPause)console.log("handlePauseSub",this.pauseMonth),this.$emit("next-step","pauseConfirm",this.pauseMonth);else{var t=this.in3daysTrial?"freeTryNoPause2":"freeTryNoPause";this.$message.warning(this.$t(t))}}}},v=(n(5669),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-pause unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("pauseDlgTitle")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"description flex flex-col"},[e("div",{staticClass:"line1",domProps:{innerHTML:t._s(t.$t("pauseDlgLine1"))}}),t._v(" "),e("div",{staticClass:"line2"},[t._v(t._s(t.$t("pauseDlgLine2")))])]),t._v(" "),e("el-select",{attrs:{placeholder:t.$t("Pls_select"),"popper-class":"custom-select","popper-append-to-body":!0,disabled:!t.allowPause},model:{value:t.pauseMonth,callback:function(e){t.pauseMonth=e},expression:"pauseMonth"}},t._l(t.options,(function(t){return e("el-option",{key:"month"+t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("SubFooter",{attrs:{confirmDisabled:!t.allowPause},on:{confirm:t.handleNext,handleCancel:t.handlePauseSub},scopedSlots:t._u([{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("unSubBtnStill"))+"\n    ")]},proxy:!0},{key:"cancel",fn:function(){return[t._v("\n      "+t._s(t.$t("unSubBtnPause"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"f6bb84fa",null);e.default=component.exports},5883:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(3),r=n(2),c=(n(20),n(32),n(484),n(485),n(65),n(8),n(4),n(177),n(26),n(58)),l=n(1),d=n(323),h=n(258),v=n(235);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"Unsub4PauseConfirm",props:{selectedMonths:{type:String,default:"1"}},components:{SubFooter:v.a,SubHead:h.a},computed:m(m(m({},Object(l.e)("payment",["activeSvipInfo"])),Object(l.c)("payment",["paymentInfo","recentPlan","payRange"])),{},{getSVIPExpiryTime:function(){var t;return Object(c.b)(null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime,this.$i18n.locale)},originPlan:function(){var t;return["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)-1]},planYearOrMonth:function(){return{2:"planTypeMonth",3:"planTypeYear",4:"planTypeWeek"}[this.payRange]||""},getUnit:function(){var t,e=null===(t=this.mySubData)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency;return e||"$"},getOriginPrice:function(){var t,data=this.activeSvipInfo||this.mySubData;return((null==data||null===(t=data.local_price_web)||void 0===t?void 0:t.price)||0).toFixed(2)},getNowPrice:function(){return 0},mySubData:function(){var t=this;if(!this.allSubData||!this.recentPlan)return null;var e=Object.values(this.allSubData).flat().find((function(sub){return sub.id===t.recentPlan}));return console.log("mySubData",e),e}}),data:function(){return{allSubData:null,loading:!1}},mounted:function(){this.getAllSubs()},methods:m(m(m({},Object(l.b)("unsubscribe",["getUserStatus"])),Object(l.b)("payment",["getSubscriptionList"])),{},{getAllSubs:function(){try{var t,e=localStorage.getItem("goodsInfo"),n=e?JSON.parse(e):null;n&&null!=n&&null!==(t=n.month)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t.local_price_web?this.getMySubData(n):this.updateGoodsData()}catch(t){console.error("解析 goodsInfo 时出错:",t),this.updateGoodsData()}},getMySubData:function(t){this.allSubData=t},updateGoodsData:function(){var t=this;this.getSubscriptionList().then((function(e){var n=e.data,data=void 0===n?{}:n;t.getMySubData(data)}))},pauseSubConfirm:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.prev=3,o={pause_month:+t.selectedMonths,renew:!1,use_free_month:0},e.next=7,Object(d.e)(o);case 7:1e4===(null==(r=e.sent)||null===(n=r.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("PauseSuccess")),c=setTimeout((function(){t.getUserStatus(),clearTimeout(c)}),300),t.$emit("click-close")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0);case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()}})},y=(n(5670),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-pause-confirm unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("unSubBtnPause")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"title flex flex-col"},[t._v("\n      "+t._s(t.$t("pauseDlgDesc",{endDate:t.getSVIPExpiryTime,numPause:t.selectedMonths}))+"\n    ")]),t._v(" "),e("div",{staticClass:"detail"},[e("div",{staticClass:"plan origin-plan"},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word",domProps:{innerHTML:t._s(t.$t("fromPlan",{planLevel:t.$t(t.originPlan),planYearOrMonth:t.$t(t.planYearOrMonth)}))}})])]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n          "+t._s(t.getUnit)+t._s(t.getOriginPrice)+"\n          "),e("span",{staticClass:"per-month"},[t._v("/"+t._s("planTypeWeek"===t.planYearOrMonth?t.$t("week"):t.$t("Month")))])])]),t._v(" "),e("div",{staticClass:"plan now-plan"},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word"},[t._v(t._s(t.$t("toStopPlan",{num:t.selectedMonths,planLevel:t.$t(t.originPlan),planYearOrMonth:t.$t(t.planYearOrMonth)})))])])]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n          "+t._s(t.getUnit)+t._s(t.getNowPrice)+"\n          "),e("span",{staticClass:"per-month"},[t._v("/"+t._s(t.$t("Month")))])])])]),t._v(" "),e("div",{staticClass:"end-date flex-between"},[e("div",{staticClass:"time"},[t._v(t._s(t.getSVIPExpiryTime))]),t._v(" "),e("div",{staticClass:"currency"},[t._v(t._s(t.getUnit)+" "+t._s("0"))])])]),t._v(" "),e("SubFooter",{attrs:{loading:t.loading},on:{handleCancel:function(e){return t.$emit("click-close")},confirm:t.pauseSubConfirm},scopedSlots:t._u([{key:"cancel",fn:function(){return[t._v("\n      "+t._s(t.$t("thinkAbout"))+"\n    ")]},proxy:!0},{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("unSubBtnPause"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"77fa259e",null);e.default=component.exports},5884:function(t,e,n){"use strict";n.r(e);var o=n(258),r={name:"Unsub5FreeTry",components:{SubFooter:n(235).a,SubHead:o.a},methods:{handleTry:function(){console.log("in FreeTry, try for free"),this.$logEvent("log_actions",{operation:"click_accept_the_offer",behavior_info:"on_unsubscribe_page"}),this.$emit("next-step","freeTryConfirm")},handleNext:function(){console.log("in FreeTry, Continue unsubscribe"),this.$emit("next-step","discount")}}},c=(n(5671),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-free-try unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("tryDlgTitle")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"description flex flex-col"},[e("div",{staticClass:"line1",domProps:{innerHTML:t._s(t.$t("tryDlgLine1"))}}),t._v(" "),e("div",{staticClass:"line2"},[t._v(t._s(t.$t("tryDlgLine2")))])]),t._v(" "),e("div",{staticClass:"btn-accept-offer flex justify-center items-center",on:{click:t.handleTry}},[t._v("\n      "+t._s(t.$t("tryDlgTryBtn"))+"\n    ")])]),t._v(" "),e("SubFooter",{on:{confirm:t.handleNext},scopedSlots:t._u([{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("noAndUnsub"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"5e3513d8",null);e.default=component.exports},5885:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(3),r=n(2),c=(n(20),n(32),n(484),n(485),n(65),n(8),n(4),n(177),n(26),n(58)),l=n(1),d=n(258),h=n(235),v=n(323);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"Unsub5FreeTryConfirm",components:{SubFooter:h.a,SubHead:d.a},computed:m(m(m({},Object(l.e)("payment",["activeSvipInfo"])),Object(l.c)("payment",["paymentInfo","recentPlan","payRange"])),{},{getSVIPExpiryTime:function(){var t;return Object(c.b)(null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime,this.$i18n.locale)},getFryEndTime:function(){var t;return Object(c.b)((null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime)+2592e6,this.$i18n.locale)},planYearOrMonth:function(){return{2:"planTypeMonth",3:"planTypeYear",4:"planTypeWeek"}[this.payRange]||""},getUnit:function(){var t,e=null===(t=this.mySubData)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency;return e||"$"},getOriginPrice:function(){var t,data=this.activeSvipInfo;return((null==data||null===(t=data.local_price_web)||void 0===t?void 0:t.price)||0).toFixed(2)},getNowPrice:function(){return 0},mySubData:function(){var t=this;if(!this.allSubData||!this.recentPlan)return null;var e=Object.values(this.allSubData).flat().find((function(sub){return sub.id===t.recentPlan}));return console.log("mySubData",e),e}}),data:function(){return{allSubData:null,loading:!1}},mounted:function(){this.getAllSubs()},methods:m(m({},Object(l.b)("unsubscribe",["getUserStatus","getSubscriptionList"])),{},{getAllSubs:function(){try{var t,e=localStorage.getItem("goodsInfo"),n=e?JSON.parse(e):null;n&&null!=n&&null!==(t=n.month)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t.local_price_web?this.getMySubData(n):this.updateGoodsData()}catch(t){console.error("解析 goodsInfo 时出错:",t),this.updateGoodsData()}},getMySubData:function(t){this.allSubData=t},updateGoodsData:function(){var t=this;this.getSubscriptionList().then((function(e){var n=e.data,data=void 0===n?{}:n;t.getMySubData(data)}))},handleFreeTry:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.prev=3,o={use_free_month:1},e.next=7,Object(v.e)(o);case 7:1e4===(null==(r=e.sent)||null===(n=r.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("PauseSuccess")),c=setTimeout((function(){t.getUserStatus(),clearTimeout(c)}),300),t.$emit("click-close")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0);case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()}})},y=(n(5672),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub-free-try-confirm unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("tryDlgConfirmTitle")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"title flex flex-col"},[t._v("\n      "+t._s(t.$t("tryDlgConfirmSub"))+"\n    ")]),t._v(" "),e("div",{staticClass:"detail"},[e("div",{staticClass:"plan now-plan"},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word"},[t._v(t._s(t.$t("tryDlgConfirmDesc",{formDate:t.getSVIPExpiryTime,toDate:t.getFryEndTime})))])])]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n          "+t._s(t.getUnit)+t._s(t.getNowPrice)+"\n          "),e("span",{staticClass:"per-month"},[t._v("/"+t._s(t.$t("Month")))])])])]),t._v(" "),e("div",{staticClass:"end-date flex-between"},[e("div",{staticClass:"time"},[t._v(t._s(t.$t("tryDlgConfirmStart",{formDate:t.getSVIPExpiryTime})))]),t._v(" "),e("div",{staticClass:"currency"},[t._v(t._s(t.getUnit)+" "+t._s("0"))])])]),t._v(" "),e("SubFooter",{attrs:{loading:t.loading},on:{confirm:t.handleFreeTry},scopedSlots:t._u([{key:"confirm",fn:function(){return[t._v("\n      "+t._s(t.$t("Confirm"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,"5b5cc6ed",null);e.default=component.exports},5886:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(3),r=n(2),c=(n(20),n(65),n(8),n(26),n(58)),l=n(1),d=(n(87),n(323)),h=n(258),v=n(235),f=n(479);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"Unsub7",components:{SubFooter:v.a,SubHead:h.a},computed:_(_(_(_({},Object(l.e)("payment",["activeSvipInfo"])),Object(l.c)("payment",["paymentInfo","payRange","recentPlan"])),Object(l.c)("unsubscribe",["prevPlanId"])),{},{getSVIPExpiryTime:function(){var t;return Object(c.b)(null===(t=this.paymentInfo)||void 0===t?void 0:t.svipExpiryTime,this.$i18n.locale)},originPlan:function(){var t;return["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)-1]},planYearOrMonth:function(){return{2:"planTypeMonth",3:"planTypeYear",4:"planTypeWeek"}[this.payRange]||""},getUnit:function(){var t,e=null===(t=this.mySubData)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency;return e||"$"},getOriginPrice:function(){var t,data=this.activeSvipInfo||this.mySubData;return((null==data||null===(t=data.local_price_web)||void 0===t?void 0:t.price)||0).toFixed(2)},getNowPrice:function(){return 0},mySubData:function(){var t=this.prevPlanId;if(t)return Object(f.a)(t,"all")}}),data:function(){return{allSubData:null,loading:!1}},mounted:function(){this.getAllSubs()},methods:_(_(_({},Object(l.b)("unsubscribe",["getUserStatus"])),Object(l.b)("payment",["getPaymentInfo"])),{},{getAllSubs:function(){var t,e=localStorage.getItem("goodsInfo");if(e&&null!=e&&null!==(t=e.discount_month)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t.local_price_web){var n=JSON.parse(e);this.getMySubData(n)}else console.log("localStorage no longer exists")},getMySubData:function(t){this.allSubData=t},unsubConfirm:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.prev=3,e.next=6,Object(d.b)();case 6:1e4===(null==(o=e.sent)||null===(n=o.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("UnsubSuccess")),r=setTimeout((function(){t.getUserStatus(),t.getPaymentInfo(),clearTimeout(r)}),500),t.$emit("click-close")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0);case 13:return e.prev=13,t.loading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()}})},w=(n(5676),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"unsub7-confirm dot-group unsub-dlg-left-part"},[e("SubHead",[t._v(t._s(t.$t("confirmUnsub")))]),t._v(" "),e("div",{staticClass:"main"},[e("div",{staticClass:"tag-title flex items-center"},[e("i",{staticClass:"el-icon-info"}),t._v(" "+t._s(t.$t("confirmUnsubDlgTip",{date:t.getSVIPExpiryTime}))+"\n    ")]),t._v(" "),e("div",{staticClass:"title flex flex-col"},[t._v("\n      "+t._s(t.$t("confirmUnsubDlgLine1"))+"\n    ")]),t._v(" "),e("div",{staticClass:"detail"},[e("div",{staticClass:"plan origin-plan"},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word",domProps:{innerHTML:t._s(t.$t("fromPlan",{planLevel:t.$t(t.originPlan),planYearOrMonth:t.$t(t.planYearOrMonth)}))}})])]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n          "+t._s(t.getUnit)+t._s(t.getOriginPrice)+"\n          "),e("span",{staticClass:"per-month"},[t._v("/"+t._s("planTypeWeek"===t.planYearOrMonth?t.$t("week"):t.$t("Month")))])])]),t._v(" "),e("div",{staticClass:"plan now-plan"},[e("div",{staticClass:"left"},[e("div",{staticClass:"line-one"},[e("span",{staticClass:"word",domProps:{innerHTML:t._s(t.$t("toFreeUser"))}})])]),t._v(" "),e("div",{staticClass:"right"},[t._v("\n          "+t._s(t.getUnit)+t._s(t.getNowPrice)+"\n          "),e("span",{staticClass:"per-month"},[t._v("/"+t._s(t.$t("Month")))])])])]),t._v(" "),e("div",{staticClass:"end-date flex-between"},[e("div",{staticClass:"time"},[t._v(t._s(t.getSVIPExpiryTime))]),t._v(" "),e("div",{staticClass:"currency"},[t._v(t._s(t.getUnit)+" "+t._s("0"))])])]),t._v(" "),e("SubFooter",{attrs:{loading:t.loading},on:{handleCancel:function(e){return t.$emit("click-close")},confirm:t.unsubConfirm},scopedSlots:t._u([{key:"cancel",fn:function(){return[e("div",{staticClass:"w-full h-full flex-center",attrs:{"data-event":"click-unsub7-cancel","data-desc":"点击取消取消订阅"}},[t._v("\n        "+t._s(t.$t("Cancel"))+"\n      ")])]},proxy:!0},{key:"confirm",fn:function(){return[e("div",{staticClass:"w-full h-full flex-center",attrs:{"data-event":"click-unsub7-confirm","data-desc":"点击确认取消订阅"}},[t._v("\n        "+t._s(t.$t("Confirm"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"1c966b4e",null);e.default=component.exports},612:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8);var o=n(3),r=n(2),c=(n(20),n(32),n(22),n(4),n(7),n(38)),l=n(1),d=n(35),h=n.n(d);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"AiChatTalkPopup",data:function(){return{isCreatePage:!1,currentMsg:null,loading:!0,dialogVisible:!1,selectedModel:"",models:{}}},watch:{currentWorkflowId:{handler:function(t){var e;t&&t!==this.selectedModel&&(this.selectedModel=t||(null===(e=this.currentWorkflowObj)||void 0===e?void 0:e.workflow_no)||"")},immediate:!0}},computed:f(f(f(f(f({},Object(l.c)("user",["isLoggedIn","userInfo","characterSetting"])),Object(l.c)("payment",["paymentInfo"])),Object(l.e)("user",["cdnHost"])),Object(l.c)("character",["characterInfo"])),{},{defaultWorkflowNo:function(){var t;return(null===(t=this.models)||void 0===t||null===(t=t.workflow)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.workflow_no)||""},currentWorkflowId:function(){var t,e,n,o,r,c=(null===(t=this.characterInfo)||void 0===t?void 0:t.workflow_no)&&"-"!==(null===(e=this.characterInfo)||void 0===e?void 0:e.workflow_no)||!1;return 1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_workflow)&&c?(null===(o=this.characterInfo)||void 0===o?void 0:o.workflow_no)||this.defaultWorkflowNo||"":(null===(r=this.characterSetting)||void 0===r?void 0:r.workflow_no)||this.defaultWorkflowNo||""},currentWorkflowObj:function(){var t=this;return this.currentModels.find((function(e){return e.workflow_no===t.selectedModel}))||{}},currentModels:function(){return this.models.workflow||[]}}),methods:f(f(f({},Object(l.b)("user",["getAccountInfo"])),Object(l.d)("user",["SET_USER_INFO"])),{},{handleModelClick:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$logEvent("log_actions",{operation:"click_change_model",behavior_info:"on_tarven_detail_page",behavior_info_sub:t.workflow_no}),e.selectedModel=t.workflow_no,e.updateModelsSelection(t.workflow_no),n.next=5,e.handleSave();case 5:case"end":return n.stop()}}),n)})))()},updateModelsSelection:function(t){this.models.workflow=this.models.workflow.map((function(e){return f(f({},e),{},{isSelected:e.workflow_no===t})}))},show:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,l,d,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=(r=e.length>1&&void 0!==e[1]?e[1]:{}).isCreatePage,l=void 0!==c&&c,d=r.workflow_no,h=void 0===d?"":d,n.loading=!0,n.dialogVisible=!0,o.next=6,n.getModels();case 6:n.isCreatePage=l,h&&(n.selectedModel=h,n.updateModelsSelection(h)),t&&(n.currentMsg=t);case 9:case"end":return o.stop()}}),o)})))()},hide:function(){this.dialogVisible=!1},getModels:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,Object(c.u)();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:n=e.t0,data=(o=n||{}).data,1e4===(null==(r=o.status)?void 0:r.code)&&((l=(null==data?void 0:data.workflow_list)||[]).forEach((function(e){e.isSelected=e.workflow_no===t.selectedModel})),t.models={workflow:l}),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(1),console.log("getModels-error",e.t1);case 15:t.loading=!1;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()},handleCancel:function(){this.selectedModel=this.currentWorkflowId||this.selectedModel,this.dialogVisible=!1},handleSave:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=3;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 3:if(!t.isCreatePage||!t.currentWorkflowObj){e.next=7;break}return t.$emit("selectModel",t.currentWorkflowObj),t.dialogVisible=!1,e.abrupt("return");case 7:if(!t.isLoggedIn){e.next=18;break}return(o=h()(t.userInfo)||{}).character_setting.workflow_no=t.selectedModel,t.SET_USER_INFO(o),e.next=13,Object(c.ab)({workflow_no:t.selectedModel});case 13:if(1e4===(null==(r=e.sent)||null===(n=r.status)||void 0===n?void 0:n.code)){e.next=16;break}throw new Error((null==r||null===(l=r.status)||void 0===l?void 0:l.message)||t.$t("taskOperateFailed"));case 16:t.$message.success(t.$t("SaveSuccess")),t.getAccountInfo(o);case 18:t.$emit("change",{model:t.selectedModel,msg:t.currentMsg||null}),t.dialogVisible=!1;case 20:case"end":return e.stop()}}),e)})))()}})},_=m,y=(n(5125),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("select_talk_model"),visible:t.dialogVisible,"custom-class":"model-switcher-dialog","close-on-click-modal":!1,"append-to-body":"",top:"5vh"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleCancel}},[e("div",{staticClass:"title-desc"},[t._v(t._s(t.$t("select_talk_model_will_be_nice")))]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"model-list"},[t.currentModels.length>0?t._l(t.currentModels,(function(n){return e("div",{key:n.workflow_no,staticClass:"model-list-item",class:{"model-list-item-is-checked":t.selectedModel===n.workflow_no},attrs:{"data-id":n.workflow_no},on:{click:function(e){return t.handleModelClick(n)}}},[e("div",{staticClass:"model-list-item-header"},[e("div",{staticClass:"model-title"},[t._v(t._s(t.$t(n.title_key)||n.title))]),t._v(" "),e("div",{staticClass:"model-handle"},[e("div",{staticClass:"custom-checkbox",class:{"is-checked":n.workflow_no===t.selectedModel},attrs:{"data-event":"ai-chat-talk-model-checkbox"}},[e("i",{staticClass:"el-icon-check"})])])]),t._v(" "),e("div",{staticClass:"model-list-item-description"},[t._v(t._s(t.$t(n.desc_key)||n.lang))])])})):t._e(),t._v(" "),0!==t.currentModels.length||t.loading?t._e():[e("div",{staticClass:"model-list-no-data"},[t._v(t._s(t.$t("no_data")))])]],2)])}),[],!1,null,"5e4f78aa",null);e.a=component.exports},613:function(t,e,n){"use strict";n(16);var o={props:{isDetail:{type:Boolean,default:!1},type:{type:String,default:"blog",validator:function(t){return["blog","news"].includes(t)}}},data:function(){return{isShow:!1}},computed:{getTitle:function(){return"blog"===this.type?this.isDetail?this.$t("blog_title_tips"):this.$t("blog"):this.isDetail?this.$t("news_title_2"):this.$t("blog_news")},getIntro:function(){return"blog"===this.type?this.isDetail?this.$t("blog_title_sub"):this.$t("blog_tips"):this.isDetail?this.$t("news_intro_2"):this.$t("news_intro_1")},getBtnKey:function(){return"blog"===this.type?"blog_try":"news_btn"}},methods:{handleClick:function(){this.$EventBus.$emit("openGenerate",{action:1,data:""})}}},r=(n(5395),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-header"},[e("div",{staticClass:"blog-header-top"}),t._v(" "),e("div",{staticClass:"flex"},[e("div",{staticClass:"blog-header-left"},[e("div",{staticClass:"blog-header-left-title"},[e("div",{staticClass:"text-top"},[e("span",{staticClass:"text-top-gradient"},[t._v(t._s(t.$t("SeaArt")))]),t._v(" "),e("span",[t._v(" "+t._s(t.getTitle))])]),t._v(" "),e("div",{staticClass:"text-tips"},[t._v("\n          "+t._s(t.getIntro)+"\n        ")]),t._v(" "),e("div",{staticClass:"text-btn",on:{click:t.handleClick}},[t._v(t._s(t.$t(t.getBtnKey)))])])]),t._v(" "),e("div",{staticClass:"blog-header-video",on:{click:function(e){t.isShow=!0}}},[e("img",{staticClass:"video",attrs:{src:"https://image.cdn2.seaart.ai/static/upload/20240228/bc964c0d-2bbd-42ae-a81c-e8fb8efbc2fd.webp",alt:t.$t("top_image_alt")}}),t._v(" "),t._m(0)])]),t._v(" "),t.isShow?e("div",{staticClass:"dialog"},[e("iframe",{attrs:{width:"784",height:"441",src:"https://www.youtube.com/embed/X64TBs6ZeRU?si=DtxDnLt4aQMk14WS",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""}}),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:function(e){t.isShow=!1}}})]):t._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"blog-header-video-play"},[t("i",{staticClass:"iconfont icon-a-Vector2900"})])}],!1,null,"d22e9ffe",null);e.a=component.exports},620:function(t,e,n){"use strict";var o=n(3),r=(n(20),n(70)),c=n(173),l=n(621),d=n(255),h={name:"DecorationsDialog",components:{DecorationsInfo:l.a,DecorationsProduct:d.a},data:function(){return{visible:!1,type:r.i.avatarBox,navConfig:r.h,navType:r.i,decorationsList:[],loading:!1}},created:function(){this.model=new c.a,this.$EventBus.$on("goAndGetDecoration",this.handleClose)},beforeDestroy:function(){this.$EventBus.$off("goAndGetDecoration",this.handleClose)},methods:{open:function(t){this.visible=!0,this.type=t||r.i.avatarBox,this.decorationsList=[],this.getList()},getList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,null===(n=t.model)||void 0===n?void 0:n.getDecorationsList({type:t.type,is_self:!0});case 4:t.decorationsList=e.sent;case 5:return e.prev=5,t.loading=!1,e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[1,,5,8]])})))()},onUseSuccess:function(t){var e;this.decorationsList=null===(e=this.model)||void 0===e?void 0:e.useSuccessUpdateList(this.decorationsList,t),this.$emit("useSuccess",t)},onUnloadSuccess:function(t){var e;this.decorationsList=null===(e=this.model)||void 0===e?void 0:e.unloadSuccessUpdateList(this.decorationsList,t),this.$emit("unloadSuccess",t)},handleNavClick:function(t){this.type=t,this.getList()},handleDecorationsClick:function(t){var e;null===(e=this.$refs.decorationsInfoRef)||void 0===e||e.open(t)},handleClose:function(){this.visible=!1}}},v=(n(4796),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"decorations-dialog-box"},[e("el-dialog",{staticClass:"decorations-dialog",attrs:{visible:t.visible,width:"1048px","modal-append-to-body":"","append-to-body":"","data-group":"popup-decoration-dialog"}},[e("div",{staticClass:"decorations-dialog-content"},[e("div",{staticClass:"decorations-dialog-header"},[e("div",{staticClass:"decorations-dialog-header-title"},[t._v("\n          "+t._s(t.$t("all_decorations"))+"\n        ")]),t._v(" "),e("i",{staticClass:"iconfont icon-guanbi1",attrs:{"data-event":"click-decoration-dialog-close","data-desc":"点击关闭装饰品弹窗"},on:{click:t.handleClose}})]),t._v(" "),e("div",{staticClass:"decorations-dialog-nav"},t._l(t.navConfig,(function(n){return e("div",{key:n.key,staticClass:"nav-item",class:{active:t.type===n.key},attrs:{"data-event":n.dataEvent,"data-desc":n.dataEventDesc},on:{click:function(e){return t.handleNavClick(n.key)}}},[t._v("\n          "+t._s(t.$t(n.i18nKey))+"\n        ")])})),0),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"decorations-container"},t._l(t.decorationsList,(function(n){return e("div",{key:n.id,staticClass:"decorations-item",class:{active:n.is_wearing,disabled:!n.is_owned},attrs:{"data-event":"click-decoration-info","data-id":n.id,"data-desc":"点击打开饰品详情"},on:{click:function(e){return t.handleDecorationsClick(n)}}},[n.type===t.navType.avatarBox?e("img",{staticClass:"decorations-item-img",attrs:{src:n.image}}):e("DecorationsProduct",{staticClass:"decorations-item-img",attrs:{boxRaido:4,innerRaido:2,innerColor:"transparent",width:56,height:56,decorationUrl:n.image}})],1)})),0)])]),t._v(" "),e("DecorationsInfo",{ref:"decorationsInfoRef",on:{unloadSuccess:t.onUnloadSuccess,useSuccess:t.onUseSuccess}})],1)}),[],!1,null,"2953e4b6",null);e.a=component.exports},621:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),c=(n(20),n(173)),l=n(70),d=n(371),h=n(1),v=n(255),f=n(891),m=n(369);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"DecorationsInfo",components:{DecorationsProduct:v.a,HySelectWorkModal:f.default,DecorationsAvatar:m.a},data:function(){return{visible:!1,decoration:{},navType:l.i,loading:!1,isSelf:!0,previewProduct:{},bindProduct:{},imageLoading:!1}},created:function(){this.model=new c.a},computed:{productUrl:function(){var t,e,n=null===(t=this.bindProduct.cover)||void 0===t?void 0:t.url,o=null===(e=this.previewProduct.banner)||void 0===e?void 0:e.url;return this.imageLoading?"":n||o},dataInfo:function(){return JSON.stringify({decoration_status:this.decoration.is_wearing?1:this.decoration.is_owned?2:3,observe_type:this.isSelf?1:2})}},methods:y(y(y({},Object(h.b)("user",["setUserAvaterDecoration"])),Object(h.b)("decorations",["setGoPersonelOpenSetting","setGoDecorationsId"])),{},{open:function(t){this.decoration=t||{},this.isSelf=this.decoration.isSelf,this.visible=!0,this.bindProduct={},this.decoration.type===l.i.productionBox&&(this.getPreviewProduct(),this.getBindProduct()),this.$xyLogEvent({front_operation:"exposure",entity_type:"decoration_info_pop",entity_name:"decoration_info_show",obj_id:this.decoration.id,obj_info:{decoration_status:this.decoration.is_wearing?1:this.decoration.is_owned?2:3,observe_type:this.isSelf?1:2}})},getBindProduct:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.imageLoading=!0,e.prev=1,e.next=4,null===(n=t.model)||void 0===n?void 0:n.getProductDecorationsBindProduct(t.decoration.id);case 4:t.bindProduct=e.sent,console.log(t.bindProduct);case 6:return e.prev=6,t.imageLoading=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})))()},getPreviewProduct:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.previewProduct.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,null===(n=t.model)||void 0===n?void 0:n.getProductRecommendProduct();case 5:t.previewProduct=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))()},handleUse:function(){this.isSelf?this.decoration.is_wearing?this.handleUnload():this.decoration.is_owned?this.handleWear():this.handleGoAndGet():this.decoration.is_owned?this.handleGoAndSee():this.handleGoAndGet()},handleUnload:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t.loading=!0,e.next=6,null===(n=t.model)||void 0===n?void 0:n.unloadDecorations(t.decoration.id);case 6:t.$message({message:t.$t("unload_success")+"!",type:"success",customClass:"bottom-show-message"}),t.$emit("unloadSuccess",t.decoration),t.decoration.type===l.i.avatarBox&&t.setUserAvaterDecoration(""),t.handleClose();case 10:return e.prev=10,t.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[2,,10,13]])})))()},handleWear:function(){var t;this.decoration.type===l.i.avatarBox?this.confirmUse():null===(t=this.$refs.HySelectWorkModalRef)||void 0===t||t.open(this.handleSelectImg)},handleGoAndGet:function(){this.handleClose(),this.setGoDecorationsId(this.decoration.id),this.$router.push({path:this.localePath(d.a.decorations)}),this.$emit("goGet",this.decoration),this.$EventBus.$emit("goAndGetDecoration",this.decoration)},handleGoAndSee:function(){this.handleClose(),this.setGoPersonelOpenSetting(!0),this.$router.push({path:this.localePath(d.a.personal)})},handleSelectImg:function(data,t){data.length>0&&this.confirmUse(data[0].id,t)},confirmUse:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:"",r=t.length>1?t[1]:void 0,!e.loading){n.next=4;break}return n.abrupt("return");case 4:return e.loading=!0,n.prev=5,n.next=8,null===(c=e.model)||void 0===c?void 0:c.useProductDecorations({id:e.decoration.id,workId:o,type:r});case 8:d=n.sent,h=d.cancelDecorationId,e.$message({message:e.$t("use_success")+"!",type:"success",customClass:"bottom-show-message"}),e.$emit("useSuccess",y(y({},e.decoration),{},{cancelDecorationId:h})),e.decoration.type===l.i.avatarBox&&e.setUserAvaterDecoration(e.decoration.image),e.handleClose();case 14:return n.prev=14,e.loading=!1,n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[5,,14,17]])})))()},handleClose:function(){this.visible=!1}})},C=w,k=(n(4795),n(0)),component=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{staticClass:"decorations-info-dialog",class:{"decorations-not-owned-dialog":!t.decoration.is_owned,"decorations-wearing-dialog":t.decoration.is_wearing,"decorations-owned-other-dialog":!t.isSelf&&t.decoration.is_owned,"decorations-product-dialog":t.decoration.type===t.navType.productionBox},attrs:{visible:t.visible,width:"374px","append-to-body":"","modal-append-to-body":"","data-group":"popup-decoration-info"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"decorations-info-content"},[e("div",{staticClass:"decorations-status"},[t._v(t._s(t.$t(t.decoration.statusTextKey)))]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.imageLoading,expression:"imageLoading"}],staticClass:"decorations-info"},[t.decoration.type===t.navType.avatarBox?e("DecorationsAvatar",{attrs:{decorationUrl:t.decoration.image,size:130}}):e("DecorationsProduct",{attrs:{width:136,height:204,decorationUrl:t.decoration.image,decorationAppliqueUrl:t.decoration.bg_image,lazy:!1,productUrl:t.productUrl}})],1),t._v(" "),e("div",{staticClass:"decorations-title",attrs:{alt:t.$t(t.decoration.title_key)}},[t._v(t._s(t.$t(t.decoration.title_key)))]),t._v(" "),e("div",{staticClass:"decorations-description text-no-wrap-2",attrs:{alt:t.$t(t.decoration.description_key)}},[t._v("\n        "+t._s(t.$t(t.decoration.description_key))+"\n      ")]),t._v(" "),t.decoration.soldNumber?e("div",{staticClass:"decorations-sale-no"},[t._v("NO."+t._s(t.decoration.soldNumber))]):t._e(),t._v(" "),t.decoration.buyTime?e("div",{staticClass:"decorations-buy-time"},[t._v(t._s(t.decoration.buyTime))]):t._e()]),t._v(" "),t.decoration.type===t.navType.productionBox&&t.decoration.is_wearing?e("div",{staticClass:"use-btn-wrap double-btn"},[e("el-button",{staticClass:"use-btn",attrs:{loading:t.loading,"data-event":"click-decoration-info-use","data-desc":"点击".concat(t.$t(t.decoration.useTextKey),"按钮"),"data-id":t.decoration.id,"data-info":t.dataInfo},on:{click:t.handleUse}},[t._v(t._s(t.$t(t.decoration.useTextKey)))]),t._v(" "),e("el-button",{staticClass:"change-btn",attrs:{loading:t.loading,"data-event":"click-decoration-info-replace-wear","data-desc":"点击更换作品框按钮","data-id":t.decoration.id,"data-info":t.dataInfo},on:{click:t.handleWear}},[t._v(t._s(t.$t("replace_wear")))])],1):e("div",{staticClass:"use-btn-wrap"},[e("el-button",{staticClass:"use-btn",attrs:{loading:t.loading,"data-event":"click-decoration-info-use","data-desc":"点击".concat(t.$t(t.decoration.useTextKey),"按钮"),"data-id":t.decoration.id,"data-info":t.dataInfo},on:{click:t.handleUse}},[t._v(t._s(t.$t(t.decoration.useTextKey)))])],1),t._v(" "),e("img",{staticClass:"clsoe-icon",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/fe10381e-ccd2-4d78-92ef-bb37006835b1.png","data-event":"click-decoration-info-close","data-desc":"点击关闭饰品详情弹窗"},on:{click:t.handleClose}})]),t._v(" "),e("HySelectWorkModal",{ref:"HySelectWorkModalRef"})],1)}),[],!1,null,"663e5f0f",null);e.a=component.exports},622:function(t,e,n){"use strict";n(18),n(4);var o=n(79),r={name:"AddOrEditCanvas",data:function(){return{type:"add",isShowDialog:!1,canvasName:"",canvasId:"",btnLoading:!1}},computed:{},methods:{openDialog:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type=t,this.canvasId=e.id||"",this.canvasName=e.name||"",this.isShowDialog=!0},closeDialog:function(){this.isShowDialog=!1},handleConfirm:function(){this.btnLoading=!0,"add"===this.type?this.addCanvas():this.editCanvas()},addCanvas:function(){var t=this;if(!this.canvasName.length)return this.$message.warning(this.$t("CanvasNameWarning")),void(this.btnLoading=!1);Object(o.a)({name:this.canvasName}).then((function(){t.$message.success(t.$t("CreateSuccess")),t.closeDialog(),t.$emit("updateList")})).finally((function(){t.btnLoading=!1}))},editCanvas:function(){var t=this;if(!this.canvasName.length)return this.$message.warning(this.$t("CanvasNameWarning")),void(this.btnLoading=!1);Object(o.J)({id:this.canvasId,name:this.canvasName}).then((function(){t.$message.success(t.$t("SuccessfullyModified")),t.closeDialog(),t.$emit("updateList")})).finally((function(){t.btnLoading=!1}))}}},c=r,l=(n(4938),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"add-or-edit-canvas custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",title:t.$t("add"===t.type?"AddCanvas":"EditCanvas"),visible:t.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("CanvasName")))]),t._v(" "),e("el-input",{staticClass:"canvas-name-input",attrs:{placeholder:"",maxlength:"15"},model:{value:t.canvasName,callback:function(e){t.canvasName=e},expression:"canvasName"}}),t._v(" "),e("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDialog}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{loading:t.btnLoading},on:{click:t.handleConfirm}},[t._v(t._s(t.$t("Confirm"))+" ")])],1)],1)}),[],!1,null,"1bb0a08a",null);e.a=component.exports},790:function(t,e,n){"use strict";(function(t){n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),c=(n(20),n(16),n(28),n(21),n(44),n(411)),l=n(10),d=n(1),h=n(38);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.a={components:{selectSoundModel:c.a},inject:["aiChatIndex"],props:{leftCollapsed:{type:Boolean,default:!1},rightCollapsed:{type:Boolean,default:!1},onlyBack:{type:Boolean,default:!1}},data:function(){return{logo:n(315),envMark:"",coins:[{name:"credit",icon:n(205),type:"calculateCoins",desc:"new_credit_desc"},{name:"stamina",icon:n(160),type:"tempCoins",desc:"new_stamina_desc"}]}},computed:f(f(f(f(f({},Object(d.c)("user",["isLoggedIn","isCompanyAccount"])),Object(d.e)("payment",["paymentInfo"])),Object(d.e)("user",["userInfo"])),Object(d.c)("character",["characterInfo","sessionId","currentTimbreObj"])),{},{isShowBackBtn:function(){return this.aiChatIndex.leftCollapsed},historyStack:function(){return this.aiChatIndex.historyStack||[]},showVoiceIcon:function(){var t;return 1===(null===(t=this.characterInfo)||void 0===t?void 0:t.support_voice)},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}}}),filters:{formatNumberForeign:l.p},methods:f(f({},Object(d.d)("character",["SET_CURRENT_TIMBRE_OBJ"])),{},{checkPrevRouteInSite:function(){var t=this.historyStack,e=this.$router,n=t.length;return(0===n||1===n&&"/"===t[0])&&(e.push(this.localePath("/cyberPub")),!0)},goback:function(){if(!this.checkPrevRouteInSite()){if(1===window.history.length)return console.log("window.history.length === 1"),void this.$router.push(this.localePath("/"));if(!this.historyStack.length)return console.log("historyStack.length === 0"),void this.$router.go(-1);var t=this.historyStack.pop();if(t.includes("book/reading"))this.$router.go(-1);else{if(this.onlyBack)return console.log("onlyBack"),void this.$router.go(-1);if(t){if(t.includes("source=work"))return void this.$router.replace(this.localePath("/cyberPub"));if(t.includes("?quickChat=true"))return void this.$router.go(-2);var e=t.split("/")[3]||"",n=/\d/.test(e);if(e)return void(n?this.$router.go(-1):this.$router.go(-2));console.log("默认返回上一页"),this.$router.go(-1)}else console.log("无历史记录时返回上一页"),this.$router.go(-1)}}},toHome:function(){this.$router.push(this.localePath("/"))},openLeft:function(){this.$emit("openLeft")},openRight:function(){this.$emit("openRight")},newChat:function(){var t;null===(t=this.aiChatIndex)||void 0===t||t.newChat()},selectModel:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$refs.selectSoundModel.handleClose(),n.next=3,e.updateTimbreObj(t.timbre||{});case 3:case"end":return n.stop()}}),n)})))()},updateTimbreObj:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===(o=e.currentTimbreObj)||void 0===o?void 0:o.id)!==t.id){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,e.bindVoiceToSeeion(t||{});case 4:case"end":return n.stop()}}),n)})))()},bindVoiceToSeeion:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isLoggedIn){n.next=3;break}return e.$EventBus.$emit("openLoginDialog"),n.abrupt("return");case 3:return n.next=5,Object(h.bb)({session_id:e.sessionId,timbre_id:t.id});case 5:e.SET_CURRENT_TIMBRE_OBJ(t);case 6:case"end":return n.stop()}}),n)})))()},handleSelectSound:function(){this.$logEvent("log_actions",{operation:"vioce_select",behavior_info:"on_tarven_detail_page"}),this.$logEvent("log_actions",{operation:"voice_select_pop_show",behavior_info:"on_voice_select_pop"}),this.$refs.selectSoundModel.openModal()},toMall:function(t){var e=this;if(this.$logEvent("log_actions",{operation:"click_mall",behavior_info:"on_tavern_sidebar"}),this.isLoggedIn){var n=this.localePath("/mall");window.open(n+t,"_blank")}else this.$EventBus.$emit("openLoginDialog",{callBack:function(){var t;return null===(t=e.aiChatIndex)||void 0===t?void 0:t.newChat()}})},openSetting:function(){this.$emit("openSetting"),this.$logEvent("log_actions",{operation:"click_sidebar",behavior_info:"on_chat_detail_page"})},toggleMenu:function(){this.$EventBus.$emit("$_toggleLeftMenu")}}),mounted:function(){this.envMark=t.version||""}}}).call(this,n(245))},791:function(t,e,n){"use strict";(function(t){n(11),n(12),n(13),n(8);var o=n(14),r=n(3),c=n(2),l=(n(20),n(19),n(6),n(50),n(22),n(31),n(49),n(18),n(4),n(177),n(28),n(218),n(40),n(44),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(7),n(41),n(93)),d=n(9),h=n(368),v=n(476),f=n(36),m=n(211),_=n(38),y=n(936),w=n(1),C=n(25);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.a={name:"AiChatLeft",inject:["aiChatIndex"],props:{isCollapsed:{type:Boolean,default:!1}},components:{HandlePopover:y.a,ConfirmModal:h.a,AiChatEditForm:v.a},data:function(){return{throttledHandleRecSessionScroll:null,throttledHandleCharacterScroll:null,formatTimestamp:d.V,options:[{i18nKey:"Edit",type:"edit",icon:"iconfont icon-bianji1"},{i18nKey:"Delete",type:"delete",icon:"iconfont icon-postDelete"}],envMark:"",logo:n(315),formatMsg:m.a,recentChats:[],recentCharacters:[],page:1,pageSize:20,noMore:!1,loading:!1,page2:1,pageSize2:20,noMore2:!1,loading2:!1,scrollThreshold:10,lastScrollTime:0,SCROLL_THROTTLE:300,isRecentChatsExpanded:!0,isCharactersExpanded:!0,handleForm:{title:"",id:""},editIndex:null,curHandle:"edit"}},computed:O(O(O({},Object(w.c)("user",["isLoggedIn","characterUnReadNum"])),Object(w.c)("character",["sessionId"])),{},{characterId:function(){return this.aiChatIndex.characterId},isNsfw:function(){return function(t){return t.nsfw_level>5}},groupedChats:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),n=e-6048e5,o=e-2592e6,r={today:{title:this.$t("today"),items:[]},sevenDays:{title:this.$t("lastWeek"),items:[]},thirtyDays:{title:this.$t("lastMonth"),items:[]}};return this.recentChats.forEach((function(t){var c,l=null===(c=t.latest_msg)||void 0===c?void 0:c.create_at;if(l){var d=new Date(l).getTime();d>=e?r.today.items.push(t):d>=n?r.sevenDays.items.push(t):d>=o&&r.thirtyDays.items.push(t)}})),Object.values(r).filter((function(t){return t.items.length>0}))}}),watch:{characterId:{handler:function(t){t&&this.getLastChatList(!0)},immediate:!0}},mounted:function(){this.isLoggedIn&&this.getNewRecentCharacterList(),this.envMark=t.version||"",this.throttledHandleRecSessionScroll=Object(C.throttle)(this.handleRecSessionScrollImpl,300),this.throttledHandleCharacterScroll=Object(C.throttle)(this.handleCharacterScrollImpl,300)},methods:{renderName:function(t){return Object(l.h)(this,t)},handleNewChat:function(){this.isLoggedIn?this.$emit("newChat"):this.$EventBus.$emit("openLoginDialog")},handleClickCharacter:function(t){this.isNsfw(t)?this.$hyConfirm({content:this.$t("chara_chat_rej_hint"),btnList:["confirm"]}):this.$router.replace(this.localePath("/aiChat/"+(null==t?void 0:t.id)))},handleFormSubmit:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,l,d,title,h,v,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=3;break}return t.$EventBus.$emit("openLoginDialog",{callback:function(){return t.$EventBus.$emit("newChat")}}),e.abrupt("return");case 3:if(null===(n=t.handleForm)||void 0===n||!n.id||"delete"!==t.curHandle){e.next=9;break}return e.next=6,Object(_.l)({id:null===(r=t.handleForm)||void 0===r?void 0:r.id});case 6:return l=e.sent,1e4===(null===(c=l.status)||void 0===c?void 0:c.code)&&(null!==t.editIndex&&(t.delChatHandle(t.editIndex),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose()),e.abrupt("return");case 9:return e.next=11,t.$refs.editFormComponent.validate();case 11:if(d=e.sent,title=(null===(o=t.$refs.editFormComponent.form)||void 0===o?void 0:o.title)||"",!d||!title||"edit"!==t.curHandle){e.next=18;break}return e.next=16,Object(_.q)({title:title,id:null===(h=t.handleForm)||void 0===h?void 0:h.id});case 16:f=e.sent,1e4===(null===(v=f.status)||void 0===v?void 0:v.code)&&(null!==t.editIndex&&(console.log("title",title),t.$set(t.recentChats[t.editIndex],"session_title",title),console.log("recentChats--",t.recentChats[t.editIndex]),t.editIndex=null),t.$message.success(t.$t("OperateSuccess")),t.$refs.confirmModal.handleClose());case 18:case"end":return e.stop()}}),e)})))()},delChatHandle:function(t){var e=this.recentChats[t].session_id;this.recentChats.splice(t,1),e===this.sessionId&&this.changeChat(this.recentChats.length?0:-1,this.recentChats)},resetForm:function(){var t;this.editIndex=null,null===(t=this.$refs.editFormComponent)||void 0===t||t.resetForm()},moreActions:function(t,e){var n;console.log("更多操作",t,e),this.curHandle=t;var o=e.session_title,r=e.session_id;switch(this.editIndex=this.recentChats.findIndex((function(t){return t.session_id===r})),t){case"edit":this.handleForm.title=(o||Object(m.a)((null===(n=e.latest_msg)||void 0===n?void 0:n.content)||"",!0)||this.formatTimestamp(e.create_at)).slice(0,30),this.handleForm.id=r,this.$refs.confirmModal.show({title:this.$t("lastChatEditTitle"),customClose:!0});break;case"delete":this.handleForm.id=r,this.$refs.confirmModal.show({subTitle:this.$t("lastChatDelTitle"),mainTitle:this.$t("lastChatDelMainTitle"),handleMethods:"Del"})}},formatTimestampCustom:function(t){if(!t)return"";var e=new Date,n=new Date(t),o=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),r=o-864e5;return t>=o?n.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1}):t>=r?this.$t("yesterday"):n.toLocaleDateString("zh-CN",{month:"numeric",day:"numeric"}).replace("/","/")},toHome:function(){this.$router.push(this.localePath("/"))},changeChat:function(i,t){if(i<0)this.$router.replace(this.localePath("/cyberPubPage/"+this.characterId));else{var e=t[i],n=e.session_id;e.character_id,e.name,e.cover;n!==this.sessionId&&this.$router.replace(this.localePath({path:"/aiChat/"+this.characterId,query:{s_id:n||this.sessionId}}))}},changeAiChat:function(t){var e=t.session_id,n=t.character_id;"chatDetail"===this.fromPage?this.$logEvent("log_actions",{operation:"click_last_chat",behavior_info:"on_tavern_detail_page"}):this.$logEvent("log_actions",{operation:"tavern_on_chat_detail_page",behavior_info:"click_recent_chat"}),this.aiChatIndex.updateSession({character_id:n,session_id:e})},handleRecSessionScroll:function(t){this.throttledHandleRecSessionScroll(t)},handleRecSessionScrollImpl:function(t){if(console.log("处理最近聊天列表的滚动",this.loading,this.noMore),!this.loading&&!this.noMore){var e=t.target,n=e.scrollHeight,o=e.scrollTop,r=e.clientHeight;n-(o+r)<this.scrollThreshold&&(console.log("加载更多聊天列表",n,o,r,"---",n-(o+r)),this.loadMoreSession())}},handleCharacterScroll:function(t){this.throttledHandleCharacterScroll(t)},handleCharacterScrollImpl:function(t){if(!this.loading2&&!this.noMore2){var e=t.target,n=e.scrollHeight,o=e.scrollTop,r=e.clientHeight;n-(o+r)<this.scrollThreshold&&(console.log("加载更多数字人",n,o,r,"---",n-(o+r)),this.loadMoreCharacters())}},loadMoreCharacters:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading2&&!t.noMore2){e.next=2;break}return e.abrupt("return");case 2:return t.page2+=1,e.next=5,t.getNewRecentCharacterList(!1);case 5:case"end":return e.stop()}}),e)})))()},getNewRecentCharacterList:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!(t.length>0&&void 0!==t[0])||t[0],e.isLoggedIn){n.next=3;break}return n.abrupt("return");case 3:return r&&(e.page2=1,e.noMore2=!1),e.loading2=!0,n.prev=5,n.next=8,Object(f.getNewRecentChatList)({page:e.page2,page_size:e.pageSize2,with_latest_msg:1});case 8:c=n.sent,l=null==c?void 0:c.data,d=l.items,l.has_more||(e.noMore2=!0),d&&d.length>0&&(r?e.recentCharacters=d:(h=new Set(e.recentCharacters.map((function(t){return t.id}))),v=d.filter((function(t){return!h.has(t.id)})),e.recentCharacters=[].concat(Object(o.a)(e.recentCharacters),Object(o.a)(v)))),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(5),console.error("获取数字人列表失败:",n.t0);case 17:return n.prev=17,e.loading2=!1,n.finish(17);case 20:case"end":return n.stop()}}),n,null,[[5,14,17,20]])})))()},clearSelectedCharacterUnReadNum:function(t){if(t){var e=this.recentCharacters.findIndex((function(e){return e.id===t}));console.log("clearSelectedCharacterUnReadNum--",t,e),-1!==e&&this.$set(this.recentCharacters[e].character,"unread_num",0)}},loadMoreSession:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading&&!t.noMore){e.next=2;break}return e.abrupt("return");case 2:return t.page+=1,e.next=5,t.getLastChatList(!1);case 5:case"end":return e.stop()}}),e)})))()},getLastChatList:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=!(t.length>0&&void 0!==t[0])||t[0])&&(e.page=1,e.noMore=!1),e.loading=!0,n.prev=3,n.next=6,Object(_.t)({character_id:e.characterId,page:e.page,page_size:e.pageSize,with_latest_msg:1});case 6:c=n.sent,l=null==c?void 0:c.data,d=l.items,l.has_more||(e.noMore=!0),d&&d.length>0&&(r?e.recentChats=d:(h=new Set(e.recentChats.map((function(t){return t.session_id}))),v=d.filter((function(t){return!h.has(t.session_id)})),e.recentChats=[].concat(Object(o.a)(e.recentChats),Object(o.a)(v)))),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(3),console.error("获取聊天列表失败:",n.t0);case 15:return n.prev=15,e.loading=!1,n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[3,12,15,18]])})))()},toggleCollapse:function(){this.$emit("toggle-collapse",!this.isCollapsed)},toggleRecentChats:function(){this.isRecentChatsExpanded=!this.isRecentChatsExpanded},toggleCharacters:function(){this.isCharactersExpanded=!this.isCharactersExpanded},getFirstLetter:function(t){return t?t.charAt(0).toUpperCase():""},handleDeleteCharacter:function(t,e){var n=this;this.$hyConfirm({content:this.$t("tavern1")}).then(Object(r.a)(regeneratorRuntime.mark((function o(){var r,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(f.delRecentChatList)({character_id:t.character.id});case 3:if(1e4!==(null==(c=o.sent)||null===(r=c.status)||void 0===r?void 0:r.code)){o.next=9;break}n.recentCharacters.splice(e,1),n.$message.success(n.$t("deleteSuccess")),o.next=10;break;case 9:throw new Error((null==c||null===(l=c.status)||void 0===l?void 0:l.message)||n.$t("taskOperateFailed"));case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(0),n.$message.error(o.t0.message||n.$t("taskOperateFailed"));case 15:case"end":return o.stop()}}),o,null,[[0,12]])}))))},handleEdit:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(_.q)({session_id:t.session_id,name:t.name});case 3:if(1e4!==(null==(r=n.sent)||null===(o=r.status)||void 0===o?void 0:o.code)){n.next=9;break}e.$message({type:"success",message:e.$t("OperateSuccess")}),e.getLastChatList(),n.next=10;break;case 9:throw new Error((null==r||null===(c=r.status)||void 0===c?void 0:c.message)||e.$t("taskOperateFailed"));case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),e.$message({type:"error",message:n.t0.message||e.$t("taskOperateFailed")});case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))()}}}}).call(this,n(245))},826:function(t,e,n){"use strict";var o=n(3),r=n(2),c=(n(20),n(185),n(24),n(4),n(40),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(11),n(6),n(12),n(13),n(8),n(7),n(41),n(26),n(25)),l=n(70),d=(n(32),n(173)),h=n(255),v=n(10),f={name:"PreviewProduct",components:{DecorationsPruduct:h.a},props:{decoration:{type:Object,default:function(){return{}}}},data:function(){return{productUrl:"",selectList:[],selected:{},loading:!1}},created:function(){this.model=new d.a,this.initData()},methods:{isVideoLink:v.G,initData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,null===(n=t.model)||void 0===n?void 0:n.initSelectProductList();case 4:t.selectList=e.sent,t.selected=t.selectList[0],t.$emit("selectProduct",t.selected),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:t.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},handleSelect:function(t){this.selected=t,this.$emit("selectProduct",this.selected)}}},m=(n(4778),n(0)),_=Object(m.a)(f,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"preview-product"},[n("DecorationsPruduct",{staticClass:"preview-product-mt",attrs:{width:286,height:436,productUrl:null===(t=e.selected.banner)||void 0===t?void 0:t.url,decorationUrl:e.decoration.image,decorationAppliqueUrl:e.decoration.bg_image}}),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"product-select"},e._l(e.selectList,(function(t){var o,r,c;return n("div",{key:t.id,staticClass:"product-select-item",class:{active:e.selected.id===t.id},attrs:{"data-event":"click-decoration-preview-product","data-desc":"预览作品款选择作品","data-id":t.id},on:{click:function(n){return e.handleSelect(t)}}},[e.isVideoLink(null===(o=t.banner)||void 0===o?void 0:o.url)?n("video",{attrs:{autoplay:"",loop:"",muted:"",playsinline:"",controls:!1,src:null===(r=t.banner)||void 0===r?void 0:r.url},domProps:{muted:!0},on:{click:function(t){t.preventDefault()}}}):n("img",{attrs:{src:null===(c=t.banner)||void 0===c?void 0:c.url}})])})),0)],1)}),[],!1,null,"64ab2c22",null).exports,y=(n(19),n(18),n(1)),w=n(369);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"SelfCenter",components:{DecorationsAvatar:w.a},props:{decoration:{type:Object,default:function(){return{}}},decorationList:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{previewAvatarDataConfig:l.j}},computed:k(k({},Object(y.e)("user",["userInfo"])),{},{getNumberByKey:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.userInfo&&this.userInfo[t]>0?this.userInfo[t]:0;return Object(v.p)(e)||0}}})},x=O,I=(n(4780),Object(m.a)(x,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"self-center",attrs:{"data-group":"feature-decoration-preview-avatar-self-center"}},[e("div",{staticClass:"self-info"},[e("div",{staticClass:"self-info-default"},[e("DecorationsAvatar",{attrs:{decorationUrl:t.decoration.image,size:64}}),t._v(" "),e("div",{staticClass:"self-info-name"},[e("div",{staticClass:"user-name"},[e("span",[t._v(t._s(t.userInfo.name))]),t._v(" "),e("i",{staticClass:"iconfont icon-icon-event-seemore"})]),t._v(" "),e("div",{staticClass:"user-id"},[t._v("User ID: "+t._s(t.userInfo.id))])])],1),t._v(" "),e("div",{staticClass:"self-info-detail"},t._l(t.previewAvatarDataConfig,(function(n){return e("div",{key:n.key,staticClass:"self-info-detail-item"},[e("div",{staticClass:"self-info-detail-item-value"},[t._v(t._s(t.getNumberByKey(n.key)))]),t._v(" "),e("div",{staticClass:"self-info-detail-item-title"},[t._v(t._s(t.$t(n.i18nKey)))])])})),0)]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"avatar-decoration-box"},t._l(t.decorationList,(function(n,o){return e("div",{key:"".concat(n.id,"-").concat(o),staticClass:"avatar-decoration-item",class:{active:t.decoration.id===n.id},attrs:{"data-event":"click-decoration-preview-avatar-self-center-select-decoration","data-desc":"预览头像装饰品个人中心点击选择装饰品","data-id":n.id},on:{click:function(e){return t.$emit("selectDecoration",n)}}},[e("div",{staticClass:"avatar-decoration-item-wrap"},[e("img",{attrs:{src:n.image,alt:"decoration"}})])])})),0)])}),[],!1,null,"6b389039",null).exports);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var D={name:"Recommend",components:{DecorationsAvatar:w.a},props:{decoration:{type:Object,default:function(){return{}}},recommendProduct:{type:Object,default:function(){return{}}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(y.e)("user",["userInfo"])),methods:{isVideoLink:v.G}},L=D,P=(n(4781),Object(m.a)(L,(function(){var t,e,n,o=this,r=o._self._c;return r("div",{staticClass:"recommend"},[o._m(0),o._v(" "),r("div",{staticClass:"recommend-item"},[o.isVideoLink(null===(t=o.recommendProduct.banner)||void 0===t?void 0:t.url)?r("video",{staticClass:"recommend-image",attrs:{autoplay:"",loop:"",muted:"",playsinline:"",controls:!1,src:null===(e=o.recommendProduct.banner)||void 0===e?void 0:e.url},domProps:{muted:!0},on:{click:function(t){t.preventDefault()}}}):r("img",{staticClass:"recommend-image",attrs:{src:null===(n=o.recommendProduct.banner)||void 0===n?void 0:n.url,alt:""}}),o._v(" "),r("div",{staticClass:"recommend-item-info"},[r("DecorationsAvatar",{attrs:{decorationUrl:o.decoration.image,size:40}}),o._v(" "),r("div",{staticClass:"recommend-item-name"},[o._v(o._s(o.userInfo.name))])],1)]),o._v(" "),o._m(1)])}),[function(){var t=this._self._c;return t("div",{staticClass:"recommend-item"},[t("img",{staticClass:"recommend-default-image",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/25d3c299-a7a5-41ec-9203-3d6cb8679045.png"}})])},function(){var t=this._self._c;return t("div",{staticClass:"recommend-item"},[t("img",{staticClass:"recommend-default-image",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/06a2a70c-914a-4b37-9c1c-8b64caed0760.png"}})])}],!1,null,"7788bd50",null).exports),j=(n(50),n(49),n(809)),$=n(162),T=n(34),M={name:"Comment",components:{DecorationsAvatar:w.a},props:{decoration:{type:Object,default:function(){return{}}},commentList:{type:Array,default:function(){return[]}}},computed:{filterXss:function(){return function(t){return T.default.prototype.xss(t)}}},methods:{formatCommentTime:function(t){return Object(j.a)(t,this.$t.bind(this))},formatNumberForeign:v.p,handleTransfer:function(t,e,n){null!=t&&t.showTranslation?t.showTranslation=!1:null!=t&&t.translationTxt?t.showTranslation=!0:this.translateContent(t),"number"==typeof n?this.commentList[e].comment.splice(n,1,t):this.commentList.splice(e,1,t),this.$emit("changeData",this.commentList)},handleReplyChange:function(t){var e=this.item.comment.findIndex((function(e){return e.id===t.id}));-1!==e&&(this.item.comment.splice(e,1,t),this.$emit("changeData",this.item))},translateContent:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=t.content,r=localStorage.getItem("translate_language")||e.$i18n.locale,r=(null==(c={zhCN:"zh-cn",zhTW:"zh-tw"})?void 0:c[r])||r,t.isLoading=!0,n.next=8,Object($.a)(o,{to:r});case 8:l=n.sent,text=l.text,t.isLoading=!1,text&&(t.translationTxt=text,t.showTranslation=!0),n.next=20;break;case 14:throw n.prev=14,n.t0=n.catch(0),t.isLoading=!1,localStorage.removeItem("translate_".concat(e.sessionId)),console.error("谷歌翻译报错",n.t0),new n.t0("谷歌翻译报错",n.t0);case 20:case"end":return n.stop()}}),n,null,[[0,14]])})))()}}},R=(n(4782),Object(m.a)(M,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment",attrs:{"data-group":"feature-decoration-comment"}},t._l(t.commentList,(function(n,o){return e("div",{key:n.id,staticClass:"comment-item"},[e("DecorationsAvatar",{attrs:{avatarUrl:n.avatar,decorationUrl:t.decoration.image,size:32}}),t._v(" "),e("div",{staticClass:"comment-item-content"},[e("div",{staticClass:"comment-item-content-name"},[e("span",[t._v(t._s(n.name))]),t._v(" "),e("i",{staticClass:"el-icon-more"})]),t._v(" "),e("div",{staticClass:"comment-item-content-text"},[t._v("\n        "+t._s(t.filterXss(null!=n&&n.showTranslation?(null==n?void 0:n.translationTxt)||"":n.content))+"\n      ")]),t._v(" "),e("div",{staticClass:"comment-item-handle"},[e("span",{staticClass:"comment-item-handle-time"},[t._v(t._s(t.formatCommentTime(n.time)))]),t._v(" "),e("div",{staticClass:"comment-item-handle-transfer",attrs:{"data-event":"click-decoration-comment-transfer","data-desc":"点击评论翻译按钮","data-id":n.id},on:{click:function(e){return t.handleTransfer(n,o)}}},[e("span",{directives:[{name:"loading",rawName:"v-loading",value:null==n?void 0:n.isLoading,expression:"item?.isLoading"}]},[t._v("\n            "+t._s(t.$t(null!=n&&n.showTranslation?"ViewOriginal":"ViewTranslation"))+"\n          ")])])]),t._v(" "),e("div",{staticClass:"comment-item-handle-fun"},[e("div",{staticClass:"fun-num"},[e("i",{staticClass:"iconfont",class:[n.isLike?"icon-like_selected":"icon-like"]}),t._v(" "),n.like>0?e("span",[t._v(t._s(t.formatNumberForeign(n.like)))]):e("span",[t._v(t._s(t.$t("CmtCommentsLike")))])]),t._v(" "),e("div",{staticClass:"fun-num"},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),e("span",[t._v(t._s(t.$t("CmtCommentsReply")))])])]),t._v(" "),t._l(n.comment,(function(r,c){return e("div",{key:r.id,staticClass:"comment-item comment-item-sub"},[e("DecorationsAvatar",{attrs:{avatarUrl:r.avatar,size:32}}),t._v(" "),e("div",{staticClass:"comment-item-content"},[e("div",{staticClass:"comment-item-content-name"},[e("span",[t._v(t._s(r.name))]),t._v(" "),e("i",{staticClass:"el-icon-more"})]),t._v(" "),e("div",{staticClass:"comment-item-content-text"},[t._v("\n            "+t._s(t.filterXss(null!=r&&r.showTranslation?(null==r?void 0:r.translationTxt)||"":r.content))+"\n          ")]),t._v(" "),e("div",{staticClass:"comment-item-handle"},[e("span",{staticClass:"comment-item-handle-time"},[t._v(t._s(t.formatCommentTime(r.time)))]),t._v(" "),e("div",{staticClass:"comment-item-handle-transfer",on:{click:function(e){return t.handleTransfer(r,o,c)}}},[e("span",{directives:[{name:"loading",rawName:"v-loading",value:null==r?void 0:r.isLoading,expression:"subItem?.isLoading"}]},[t._v("\n                "+t._s(t.$t(null!=r&&r.showTranslation?"ViewOriginal":"ViewTranslation"))+"\n              ")])])]),t._v(" "),e("div",{staticClass:"comment-item-handle-fun"},[e("div",{staticClass:"fun-num like-fun"},[e("i",{staticClass:"iconfont",class:[r.isLike?"icon-like_selected":"icon-like"]}),t._v(" "),n.like>0?e("span",[t._v(t._s(t.formatNumberForeign(r.like)))]):e("span",[t._v(t._s(t.$t("CmtCommentsLike")))])]),t._v(" "),e("div",{staticClass:"fun-num"},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),e("span",[t._v(t._s(t.$t("CmtCommentsReply")))])])])])],1)}))],2)],1)})),0)}),[],!1,null,"52780730",null).exports),A=(n(16),n(22),n(890));function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N={name:"RecommendDetail",components:{DecorationsAvatar:w.a,HyWordHigh:A.default},props:{decoration:{type:Object,default:function(){return{}}},recommendProduct:{type:Object,default:function(){return{}}}},computed:B(B(B({},Object(y.e)("user",["userInfo"])),Object(y.c)("user",["accountSettingsData"])),{},{isI18nToggled:function(){return!this.accountSettingsData.is_off_localization},comfyuitType:function(){var t=this.this.recommendProduct,e=t.channel,n=t.creativity,o=void 0===n?{}:n;return"comfyui"!=e||1===(null==o?void 0:o.type)?"":2===(null==o?void 0:o.type)?"workflow":"app"},appTypeText:function(){var t=this.recommendProduct.creativity.type;return[7].includes(t)?"app":[6].includes(t)?this.$t("VideoEffect"):this.comfyuitType},prompt:function(){var t=this.recommendProduct.meta&&this.recommendProduct.meta.prompt||"",e=this.recommendProduct.local_prompt||"";return this.isI18nToggled?e:t},convertMode:function(){var t;if(!this.recommendProduct.id)return"";var e={1:"createModeType1",2:"createModeType2",6:"createModeType6",4:"createModeType4",5:"createModeType5",7:"studio",8:"ModelFitting"},n={v5:1,v6:2,4:4,sdxl:5,hy21:6,studio:7,model_beautify:8}[null===(t=this.recommendProduct)||void 0===t?void 0:t.channel]||1;return e[n]?this.$t("".concat(e[n])):""},handleType:function(){if(!this.recommendProduct.id)return"";var t=this.recommendProduct,e=t.type,n=t.channel,o=void 0===n?"":n,r=t.sub_channel,c=void 0===r?"":r,l=t.creativity;if(7===(void 0===l?{}:l).type)return"AI Apps";if(this.isAIVideo)return"Video";if("comfyui"===o){if(!c)return"Workflow";if("comf_sys_app"===c||"comf_user_app"===c)return"AI Apps";if(["ai_filter_video","ai_filter"].includes(c))return"ai filter"}return"studio"===o&&4===e||2===e&&"sdxl"===o||4===e&&"sdxl"===o?"cell":6===e?"animate":"upscale"},getModelList:function(){var t;return((null===(t=this.recommendProduct)||void 0===t?void 0:t.models)||[]).map((function(t){return B(B({},t),{},{type:"LoCon"===(null==t?void 0:t.type)?"LyCORIS":"TextualInversion"===(null==t?void 0:t.type)?"embedding1":(null==t?void 0:t.type)||"LORA"})}))}}),methods:{isVideoLink:v.G,formatDate:function(t){var e=new Date(t),n=new Date;if(e.toDateString()===n.toDateString())return"Today"+e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},getImagUrl:function(t,e){var o,r=n(217);return 1==(null===(o=this.recommendProduct)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.nsfw)?r:Object(v.K)(t,e)||t},imgError:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mainImage";e&&"IMG"===e.tagName&&(e.src=n(217))}}},F=N;n(4784);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var H={name:"PreviewAvatar",components:{SelfCenter:I,Recommend:P,Comment:R,RecommendDetail:Object(m.a)(F,(function(){var t,e,o,r,c,l,d,h,v,f,m,_=this,y=_._self._c;return y("div",{staticClass:"recommend-detail"},[y("div",{staticClass:"detail-left"},[_.isVideoLink(null===(t=_.recommendProduct.banner)||void 0===t?void 0:t.url)?y("video",{attrs:{autoplay:"",loop:"",muted:"",playsinline:"",controls:!1,src:null===(e=_.recommendProduct.banner)||void 0===e?void 0:e.url},domProps:{muted:!0},on:{click:function(t){t.preventDefault()}}}):y("img",{attrs:{src:null===(o=_.recommendProduct.banner)||void 0===o?void 0:o.url}})]),_._v(" "),y("div",{staticClass:"detail-right"},[y("div",{staticClass:"detail-right-head"},[y("DecorationsAvatar",{attrs:{decorationUrl:_.decoration.image,size:35}}),_._v(" "),y("p",{staticClass:"detail-right-head-name"},[_._v(_._s(_.userInfo.name))]),_._v(" "),y("el-button",{staticClass:"same-button"},[_._v(_._s(_.$t("Remix")))])],1),_._v(" "),y("div",{staticClass:"detail-right-prompt"},[y("span",[_._v(_._s(_.$t("Prompt")))]),_._v(" "),y("i",{staticClass:"iconfont icon-copy"}),_._v(" "),y("span",{staticClass:"copy-text"},[_._v(_._s(_.$t("CopyPrompts")))])]),_._v(" "),y("div",{staticClass:"prompt-container"},[y("HyWordHigh",{attrs:{text:_.prompt}})],1),_._v(" "),y("div",{staticClass:"info-tip"},[y("span",{staticClass:"title"},[_._v(_._s(_.$t("INFO")))]),_._v(" "),y("i",{staticClass:"iconfont icon-work-tips work-tips"})]),_._v(" "),y("div",{staticClass:"info-line"}),_._v(" "),y("div",{staticClass:"info-tag-wrap"},[y("div",{staticClass:"info-tag"},[y("div",{staticClass:"tag-title"},[_._v(_._s(_.$t("Size")))]),_._v(" "),y("div",{staticClass:"tag-value"},[_._v("\n          "+_._s(((null===(r=_.recommendProduct.banner)||void 0===r?void 0:r.width)||0)+"X"+((null===(c=_.recommendProduct.banner)||void 0===c?void 0:c.height)||0))+"\n        ")])]),_._v(" "),y("div",{staticClass:"info-tag"},[y("div",{staticClass:"tag-title"},[_._v(_._s(_.$t("Date")))]),_._v(" "),y("div",{staticClass:"tag-value"},[_._v(_._s(_.formatDate(_.recommendProduct.created_at)))])]),_._v(" "),y("div",{staticClass:"info-tag"},[y("div",{staticClass:"tag-title"},[_._v(_._s(_.$t("createModeTitle")))]),_._v(" "),y("div",{staticClass:"tag-value"},[_._v(_._s(_.convertMode))])]),_._v(" "),y("div",{staticClass:"info-tag"},[y("div",{staticClass:"tag-title"},[_._v(_._s(_.$t("Type")))]),_._v(" "),y("div",{staticClass:"tag-value"},[_._v(_._s(_.handleType))])])]),_._v(" "),(null===(l=_.getModelList)||void 0===l?void 0:l.length)>0&&"comfyui"!=_.recommendProduct.channel?y("div",{staticClass:"models flex flex-wrap"},_._l(_.getModelList,(function(t,i){var e,o,r;return y("a",{key:"model_".concat(i),staticClass:"model-item flex items-center"},[null!=t&&null!==(e=t.cover)&&void 0!==e&&e.url&&1!==(null==t||null===(o=t.cover)||void 0===o?void 0:o.nsfw)?y("img",{ref:"modelCover".concat(i),refInFor:!0,staticClass:"model-cover",attrs:{src:"".concat(_.getImagUrl(null==t||null===(r=t.cover)||void 0===r?void 0:r.url,_.$imgL)||""),alt:t.name},on:{error:function(e){return _.imgError(null==t?void 0:t.cover,_.$refs["modelCover".concat(i)])}}}):y("img",{staticClass:"model-cover",attrs:{src:n(217),alt:""}}),_._v(" "),y("div",{staticClass:"model-cont flex flex-col"},[y("div",{staticClass:"model-type"},[y("span",{class:{isLora:"Checkpoint"!==(null==t?void 0:t.type)}},[_._v(_._s(_.$t(null==t?void 0:t.type)))])]),_._v(" "),y("div",{staticClass:"model-name text-no-wrap-2"},[_._v(_._s(t.name))])])])})),0):_._e(),_._v(" "),"comfyui"===_.recommendProduct.channel&&null!==(d=_.recommendProduct)&&void 0!==d&&null!==(d=d.creativity)&&void 0!==d&&d.id?y("div",{staticClass:"models flex flex-wrap"},[y("div",{staticClass:"model-item flex items-center"},["image"===_.sourceType?[y("img",{staticClass:"model-cover",attrs:{src:"".concat(_.getImagUrl(null===(h=_.recommendProduct)||void 0===h||null===(h=h.creativity)||void 0===h||null===(h=h.cover)||void 0===h?void 0:h.url,_.$imgL)||""),alt:null===(v=_.recommendProduct)||void 0===v||null===(v=v.creativity)||void 0===v?void 0:v.name}})]:_._e(),_._v(" "),"video"===_.sourceType?[y("video",{staticClass:"model-cover",attrs:{src:null===(f=_.recommendProduct)||void 0===f||null===(f=f.creativity)||void 0===f||null===(f=f.cover)||void 0===f?void 0:f.url,autoplay:"",loop:"",controls:!1,muted:""},domProps:{muted:!0}})]:_._e(),_._v(" "),y("div",{staticClass:"model-cont flex flex-col"},[y("div",{staticClass:"model-type"},[y("span",[_._v("\n              "+_._s(_.appTypeText)+"\n            ")])]),_._v(" "),y("div",{staticClass:"model-name text-no-wrap-2"},[_._v(_._s(null===(m=_.recommendProduct)||void 0===m||null===(m=m.creativity)||void 0===m?void 0:m.name))])])],2)]):_._e()])])}),[],!1,null,"74045914",null).exports},props:{decoration:{type:Object,default:function(){return{}}}},data:function(){return{previewAvatarNavConfig:l.k,previewAvatarNavType:l.l,activeNav:l.l.slefCenter,decorationList:[],recommendProduct:{},recommendProductDetail:{},loading:!1,commentList:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(y.e)("user",["userInfo"])),created:function(){this.model=new d.a,this.initData()},methods:{initNav:function(){this.activeNav=l.l.slefCenter},initData:function(){this.getDecorationList(),this.getRecommendProduct(),this.getCommentList()},getDecorationList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,null===(n=t.model)||void 0===n?void 0:n.getDecorationAvatarRecommendList(t.decoration.id);case 4:t.decorationList=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:t.loading=!1;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getRecommendProduct:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.model)||void 0===n?void 0:n.getProductRecommendProduct();case 2:t.recommendProduct=e.sent,t.getRecommendProductDetail(t.recommendProduct.id);case 4:case"end":return e.stop()}}),e)})))()},getRecommendProductDetail:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(o=e.model)||void 0===o?void 0:o.getProductDetail(t);case 2:e.recommendProductDetail=n.sent;case 3:case"end":return n.stop()}}),n)})))()},getCommentList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.model)||void 0===n?void 0:n.getNewCommentList();case 2:t.commentList=e.sent;case 3:case"end":return e.stop()}}),e)})))()},changeComment:function(data){this.commentList=data},handleNavClick:function(t){this.activeNav=t}}},V=H,z=(n(4785),Object(m.a)(V,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview-avatar"},[e("div",{staticClass:"preview-nav"},t._l(t.previewAvatarNavConfig,(function(n){return e("div",{key:n.key,staticClass:"preview-nav-item",class:{active:t.activeNav===n.key},attrs:{"data-event":n.dataEvent,"data-desc":n.dataEventDesc},on:{click:function(e){return t.handleNavClick(n.key)}}},[t._v("\n      "+t._s(t.$t(n.i18nKey))+"\n    ")])})),0),t._v(" "),t.activeNav===t.previewAvatarNavType.slefCenter?e("SelfCenter",{attrs:{decoration:t.decoration,decorationList:t.decorationList,loading:t.loading},on:{selectDecoration:function(e){return t.$emit("selectDecoration",e)}}}):t.activeNav===t.previewAvatarNavType.recommend?e("Recommend",{attrs:{decoration:t.decoration,recommendProduct:t.recommendProduct}}):t.activeNav===t.previewAvatarNavType.detail?e("RecommendDetail",{attrs:{decoration:t.decoration,recommendProduct:t.recommendProductDetail}}):t.activeNav===t.previewAvatarNavType.comments?e("Comment",{attrs:{decoration:t.decoration,commentList:t.commentList},on:{changeData:t.changeComment}}):t._e()],1)}),[],!1,null,"4188a61a",null).exports);n(73),n(65);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y={name:"RechargeDialog",components:{PaymentFormDialog:n(367).default},data:function(){return{visible:!1,rechargeList:[],loading:!1,dotFrom:"non_calculate_by_jewelry",decoration:{}}},computed:G(G(G({},Object(y.c)("payment",["paymentInfo"])),Object(y.c)("user",["isLoggedIn"])),{},{calculateAmount:function(){return function(t){var e,n=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.price;return(parseFloat(n)*t.quantity).toFixed(2)}},calculateTotal:function(){return function(t){var e=t.totalValue;return(parseFloat(e)*t.quantity).toFixed(0)}},calculateValueText:function(){return function(t){var e=t.originValue,n=t.giveValue;return"".concat((parseFloat(e)*t.quantity).toFixed(0)," + ").concat((parseFloat(n)*t.quantity).toFixed(0))}}}),created:function(){this.model=new d.a},methods:G(G({},Object(y.b)("payment",["getPaymentInfo"])),{},{open:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.visible=!0,e.loading=!0,n.prev=2,n.next=5,null===(o=e.model)||void 0===o?void 0:o.getRechargeList(t.price);case 5:e.rechargeList=n.sent;case 6:return n.prev=6,e.loading=!1,n.finish(6);case 9:e.decoration=t,e.$xyLogEvent({front_operation:"exposure",entity_name:"non_calculate_by_jewelry",entity_type:"to_pay_pop_show",obj_id:e.decoration.id,obj_info:{calculate_type:e.rechargeList.map((function(t){return t.product_id})).join(",")}});case 11:case"end":return n.stop()}}),n,null,[[2,,6,9]])})))()},handleClose:function(){this.visible=!1,this.$xyLogEvent({front_operation:"exposure",entity_name:"non_calculate_by_jewelry",entity_type:"to_pay_pop_close",obj_id:this.decoration.id,obj_info:{calculate_type:this.rechargeList.map((function(t){return t.product_id})).join(",")}})},handleSub:function(t){t.num<=1||(t.num--,t.quantity=t.num)},handleAdd:function(t){t.num++,t.quantity=t.num},handlePurchase:function(t){var e;if(this.isLoggedIn){var n=G(G({},t),{},{quantity:t.quantity||1});null===(e=this.$refs.paymentFormDialogRef)||void 0===e||e.showPaymentFormDialog(n)}else this.$EventBus.$emit("openLoginDialog")},onPaySuccess:function(){this.getPaymentInfo(),this.visible=!1},handleFocus:function(t){t.preNum=t.num},handleBlur:function(t){(!Number(t.num)||t.num<=0)&&(t.num=t.preNum),t.quantity=t.num}})},K=(n(4787),Object(m.a)(Y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"recharge-dialog-container"},[e("el-dialog",{attrs:{visible:t.visible,width:"1080px","close-on-click-modal":!1,"close-on-press-escape":!1,"data-group":"popup-decoration-recharge"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"recharge-content"},[e("div",{staticClass:"recharge-header"},[e("div",{staticClass:"recharge-header-title"},[e("p",[t._v(t._s(t.$t("insufficient_credits")))]),t._v(" "),e("div",{staticClass:"now-coins"},[e("img",{attrs:{src:n(1033)}}),t._v(" "),e("span",[t._v(t._s(t.paymentInfo.calculateCoins||0))])])]),t._v(" "),e("i",{staticClass:"iconfont icon-guanbi1 recharge-header-close",attrs:{"data-event":"click-decoration-recharge-close","data-desc":"点击关闭充值弹窗"},on:{click:t.handleClose}})]),t._v(" "),e("p",{staticClass:"recharge-tip"},[t._v(t._s(t.$t("insufficient_credits_tip")))]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recharge-body"},t._l(t.rechargeList,(function(o,r){return e("div",{key:o.product_id,staticClass:"recharge-body-item",class:{active:0===r}},[e("img",0===r?{staticClass:"item-image",attrs:{src:n(1267)}}:1===r?{staticClass:"item-image",attrs:{src:n(1266)}}:2===r?{staticClass:"item-image",attrs:{src:n(1265)}}:{staticClass:"item-image",attrs:{src:n(1264)}}),t._v(" "),e("div",{staticClass:"item-price"},[e("p",{staticClass:"item-price-total"},[e("span",[t._v(t._s(t.$t("total")))]),t._v(" "),e("span",{staticClass:"item-price-total-number"},[t._v(t._s(t.calculateTotal(o)))])]),t._v(" "),e("p",{staticClass:"item-price-discount"},[t._v(t._s(t.calculateValueText(o)))])]),t._v(" "),e("div",{staticClass:"item-num"},[e("div",{staticClass:"item-num-sub",class:{disabled:o.quantity<=1},attrs:{"data-event":"click-decoration-recharge-sub","data-desc":"点击减少数量按钮","data-id":o.product_id},on:{click:function(e){return t.handleSub(o)}}}),t._v(" "),e("el-input",{staticClass:"item-num-input",attrs:{min:1},on:{blur:function(e){return t.handleBlur(o)},focus:function(e){return t.handleFocus(o)}},model:{value:o.num,callback:function(e){t.$set(o,"num",e)},expression:"item.num"}}),t._v(" "),e("div",{staticClass:"item-num-add",attrs:{"data-event":"click-decoration-recharge-add","data-desc":"点击增加数量按钮","data-id":o.product_id},on:{click:function(e){return t.handleAdd(o)}}})],1),t._v(" "),e("div",{staticClass:"item-value"},[t._v(t._s(o.currency)+t._s(t.calculateAmount(o)))]),t._v(" "),e("el-button",{staticClass:"item-button",attrs:{"data-event":"click-decoration-recharge-pick","data-desc":"点击选择充值按钮","data-id":t.decoration.id,"data-info":JSON.stringify({calculate_type:o.product_id})},on:{click:function(e){return t.handlePurchase(o)}}},[t._v(t._s(t.$t("pick_it")))])],1)})),0)])]),t._v(" "),e("PaymentFormDialog",{ref:"paymentFormDialogRef",attrs:{initMount:!0,upgrade:!1,isSubscription:!1},on:{success:t.onPaySuccess}})],1)}),[],!1,null,"f9428d36",null).exports),J=n(891);function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z={name:"BuySuccess",components:{DecorationsAvatar:w.a,DecorationsPruduct:h.a,HySelectWorkModal:J.default},data:function(){return{visible:!1,decoration:{},product:{},navType:l.i,type:l.i.avatarBox,loading:!1}},created:function(){this.model=new d.a},methods:Q(Q({},Object(y.b)("user",["setUserAvaterDecoration"])),{},{open:function(data,t){this.decoration=data||{},this.type=data.type||l.i.avatarBox,this.product=t||{},this.visible=!0,this.$xyLogEvent({front_operation:"exposure",entity_name:"popup-decoration-buy-success-show",entity_type:"popup-decoration-buy-success",obj_id:this.decoration.id})},handleUse:function(){this.type===l.i.avatarBox?this.confirmUse():this.$refs.HySelectWorkModalRef.open(this.handleSelectImg)},confirmUse:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:"",r=t.length>1?t[1]:void 0,e.loading=!0,n.prev=3,n.next=6,null===(c=e.model)||void 0===c?void 0:c.useProductDecorations({id:e.decoration.id,workId:o,type:r});case 6:d=n.sent,h=d.cancelDecorationId,e.$message({message:e.$t("use_success")+"!",type:"success",customClass:"bottom-show-message"}),e.$emit("useSuccess",Q(Q({},e.decoration),{},{cancelDecorationId:h})),e.decoration.type===l.i.avatarBox&&e.setUserAvaterDecoration(e.decoration.image),e.handleClose();case 12:return n.prev=12,e.loading=!1,n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[3,,12,15]])})))()},handleSelectImg:function(data,t){data.length>0&&this.confirmUse(data[0].id,t)},handleClose:function(){this.visible=!1}})},tt=Z;n(4790);function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nt={name:"DecorationsPreview",components:{PreviewProduct:_,PreviewAvatar:z,RechargeDialog:K,BuySuccess:Object(m.a)(tt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"buy-decoration-success-container"},[n("el-dialog",{attrs:{visible:e.visible,width:"608px","data-group":"popup-decoration-buy-success","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"buy-decoration-success"},[n("div",{staticClass:"success-title"},[e._v("\n        "+e._s(e.$t("get_success"))+"\n      ")]),e._v(" "),n("div",{staticClass:"success-content"},[n("div",{staticClass:"content-top-bar"}),e._v(" "),n("div",{staticClass:"content-body-border"},[n("div",{staticClass:"content-body"},[e.decoration.type===e.navType.avatarBox?n("DecorationsAvatar",{attrs:{decorationUrl:e.decoration.image,size:170}}):n("DecorationsPruduct",{attrs:{decorationUrl:e.decoration.image,decorationAppliqueUrl:e.decoration.bg_image,productUrl:null===(t=e.product.banner)||void 0===t?void 0:t.url,width:136,height:204}}),e._v(" "),n("div",{staticClass:"decorations-title",attrs:{alt:e.$t(e.decoration.title_key)}},[e._v(e._s(e.$t(e.decoration.title_key)))]),e._v(" "),n("div",{staticClass:"decorations-sale-no"},[e._v("NO."+e._s(e.decoration.soldNumber))])],1)])]),e._v(" "),n("el-button",{staticClass:"use-btn",attrs:{loading:e.loading,"data-event":"click-decoration-wear","data-id":e.decoration.id,"data-desc":"点击佩戴饰品按钮"},on:{click:e.handleUse}},[e._v(e._s(e.$t("wear")))]),e._v(" "),n("img",{staticClass:"clsoe-icon",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/fe10381e-ccd2-4d78-92ef-bb37006835b1.png","data-event":"click-decoration-buy-success-close","data-desc":"点击关闭购买饰品成功弹窗"},on:{click:e.handleClose}})],1)]),e._v(" "),n("HySelectWorkModal",{ref:"HySelectWorkModalRef"})],1)}),[],!1,null,"0406a390",null).exports,DecorationsProduct:h.a},data:function(){return{visible:!1,navType:l.i,type:0,decoration:{},loading:!1,selectProduct:{}}},created:function(){this.model=new d.a},computed:{title:function(){var t,e=this;return(null===(t=l.h.find((function(t){return t.key===e.type})))||void 0===t?void 0:t.i18nKey)||""},dialogWidth:function(){return this.type===l.i.avatarBox?"882px":"748px"}},methods:it(it({},Object(y.b)("payment",["getPaymentInfo"])),{},{open:function(t){var e=this;this.decoration=t||{},this.visible=!0,this.type=t.type,this.$nextTick((function(){var t;null===(t=e.$refs.previewAvatarRef)||void 0===t||t.initNav()})),this.$xyLogEvent({front_operation:"exposure",entity_name:"popup-decoration-preview-show",entity_type:"popup-decoration-preview",obj_id:this.type===l.i.avatarBox?"1":"2",obj_info:{decoration_id:t.id}})},handleClose:function(){this.type=0,this.visible=!1},handleBuy:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,data,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:if(!t.decoration.is_owned){e.next=5;break}return t.$message({message:t.$t("decoration_has_tip")+"!",type:"warning",customClass:"bottom-show-message"}),e.abrupt("return");case 5:if(!t.decoration.isSoldOut){e.next=8;break}return t.$message({message:t.$t("decoration_sold_out_tip")+"!",type:"warning",customClass:"bottom-show-message"}),e.abrupt("return");case 8:return t.loading=!0,e.prev=9,e.next=12,null===(n=t.model)||void 0===n?void 0:n.buyDecorations(t.decoration);case 12:(data=e.sent).success?(null===(o=t.$refs.buySuccessRef)||void 0===o||o.open(it(it({},t.decoration),{},{soldNumber:data.sold}),t.type===l.i.productionBox?t.selectProduct:null),t.handleClose(),t.$emit("buySuccess",t.decoration),t.getPaymentInfo()):data.notCoin&&(null===(r=t.$refs.rechargeDialogRef)||void 0===r||r.open(t.decoration));case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[9,,14,17]])})))()},onChangeDecoration:function(data){this.decoration=data},onSelectPruduct:function(data){this.selectProduct=data}})},at=(n(4791),Object(m.a)(nt,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y=this,w=y._self._c;return w("div",{staticClass:"decorations-preview-container"},[w("el-dialog",{class:["decorations-preview-dialog",null!==(t=y.decoration.decorationStyle)&&void 0!==t&&t.previewBorder?"decorations-preview-dialog-border":""],style:{"--preview-border":null!==(e=y.decoration.decorationStyle)&&void 0!==e&&e.previewBorder?"url(".concat(null===(n=y.decoration.decorationStyle)||void 0===n?void 0:n.previewBorder,")"):"none"},attrs:{visible:y.visible,width:y.dialogWidth,"close-on-click-modal":!1,"data-group":"popup-decoration-preview"},on:{"update:visible":function(t){y.visible=t}}},[w("div",{staticClass:"decorations-preview-box",class:{"decorations-preview-avatar-box":y.type===y.navType.avatarBox}},[w("div",{staticClass:"preview-left",style:{backgroundImage:null!==(o=y.decoration.decorationStyle)&&void 0!==o&&o.previewLeftBg?"url(".concat(null===(r=y.decoration.decorationStyle)||void 0===r?void 0:r.previewLeftBg,")"):""}},[w("div",{staticClass:"preview-left-title"},[y._v(y._s(y.$t(y.title)))]),y._v(" "),w("div",{staticClass:"decorations-image-title"},[y.type===y.navType.avatarBox?w("img",{staticClass:"decorations-image",attrs:{src:y.decoration.image}}):w("DecorationsProduct",{staticClass:"decorations-image",attrs:{innerColor:"transparent",width:156,height:156,decorationUrl:y.decoration.image,decorationAppliqueUrl:y.decoration.bg_image}}),y._v(" "),w("div",{staticClass:"decorations-title",attrs:{alt:y.$t(y.decoration.title_key)}},[y._v(y._s(y.$t(y.decoration.title_key)))]),y._v(" "),null!==(c=y.decoration.decorationStyle)&&void 0!==c&&c.previewIcon?w("img",{class:["decorations-level-icon",y.decoration.type===y.navType.avatarBox?"decorations-level-icon-avatar":""],attrs:{src:null===(l=y.decoration.decorationStyle)||void 0===l?void 0:l.previewIcon}}):y._e()],1),y._v(" "),w("div",{staticClass:"decorations-buy",class:{"decorations-buy-no-bg-color":null===(d=y.decoration.decorationStyle)||void 0===d?void 0:d.previewBuyBtnBg},attrs:{"data-event":"click-decoration-buy","data-desc":"点击购买饰品按钮","data-id":y.decoration.id},on:{click:y.handleBuy}},[null!==(h=y.decoration.decorationStyle)&&void 0!==h&&h.previewBuyBtnBg?w("div",{staticClass:"decorations-buy-bg",style:{backgroundImage:"url(".concat(null===(v=y.decoration.decorationStyle)||void 0===v?void 0:v.previewBuyBtnBg,")")}}):y._e(),y._v(" "),w("div",{staticClass:"decorations-buy-content"},[w("span",{directives:[{name:"loading",rawName:"v-loading",value:y.loading,expression:"loading"}]}),y._v(" "),w("span",{staticClass:"decorations-buy-text"},[y._v(y._s(y.$t(y.decoration.buyTextKey)))]),y._v(" "),w("span",{staticClass:"decorations-buy-price"},[w("i",{staticClass:"iconfont icon-a-physicalstrength"}),y._v(" "),w("span",{staticClass:"decorations-buy-price-num"},[y._v(y._s(y.decoration.priceText))])])])]),y._v(" "),y.type===y.navType.productionBox?w("div",{staticClass:"decorations-preview-tip"},[w("i",{staticClass:"iconfont icon-warning-error"}),y._v("\n          "+y._s(y.$t("decoration_preview_production_left_tip"))+"\n        ")]):y._e()]),y._v(" "),w("div",{staticClass:"preview-right",style:{backgroundImage:null!==(f=y.decoration.decorationStyle)&&void 0!==f&&f.previewRightBg?"url(".concat(null===(m=y.decoration.decorationStyle)||void 0===m?void 0:m.previewRightBg,")"):""}},[w("div",{staticClass:"preview-right-top"},[w("div",{staticClass:"preview-right-title"},[y._v(y._s(y.$t("preview")))]),y._v(" "),w("img",{attrs:{src:null===(_=y.decoration.decorationStyle)||void 0===_?void 0:_.previewCloseIcon,"data-event":"click-decoration-close","data-desc":"点击关闭预览饰品弹窗"},on:{click:y.handleClose}})]),y._v(" "),y.type===y.navType.productionBox?w("PreviewProduct",{attrs:{decoration:y.decoration},on:{selectProduct:y.onSelectPruduct}}):y._e(),y._v(" "),y.type===y.navType.avatarBox?w("PreviewAvatar",{ref:"previewAvatarRef",attrs:{decoration:y.decoration},on:{selectDecoration:y.onChangeDecoration}}):y._e()],1)])]),y._v(" "),w("RechargeDialog",{ref:"rechargeDialogRef"}),y._v(" "),w("BuySuccess",{ref:"buySuccessRef",on:{useSuccess:function(t){return y.$emit("useSuccess",t)}}})],1)}),[],!1,null,"6c902b8e",null).exports);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var ot={name:"DecorationsItem",components:{DecorationsProduct:h.a},props:{decoration:{type:Object,default:function(){return{}}}},data:function(){return{navType:l.i}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(y.c)("user",["isLoggedIn"])),methods:{handlePreview:function(){this.isLoggedIn?this.$emit("preview",this.decoration):this.$EventBus.$emit("openLoginDialog")}}},ct=ot,lt=(n(4792),Object(m.a)(ct,(function(){var t,e,o,r,c,l,d,h,v=this,f=v._self._c;return f("div",{staticClass:"decorations-content-item",class:{"decorations-content-item-mask":v.decoration.isSoldOut||v.decoration.is_owned||!v.isLoggedIn},attrs:{"data-decoration-id":v.decoration.id}},[null!==(t=v.decoration.decorationStyle)&&void 0!==t&&t.itemBorder?f("div",{staticClass:"decorations-level-border",style:{backgroundImage:"url(".concat(null===(e=v.decoration.decorationStyle)||void 0===e?void 0:e.itemBorder,")"),boxShadow:null===(o=v.decoration.decorationStyle)||void 0===o?void 0:o.itemShadow}}):v._e(),v._v(" "),f("div",{staticClass:"decorations-item-top",attrs:{"data-event":"click-decoration-image","data-desc":"点击装饰图片","data-id":v.decoration.id}},[v.decoration.type===v.navType.avatarBox?f("el-image",{staticClass:"decorations-image",attrs:{src:v.decoration.image,lazy:""}}):f("DecorationsProduct",{staticClass:"decorations-image",attrs:{innerColor:"transparent",width:120,height:120,decorationUrl:v.decoration.image,decorationAppliqueUrl:v.decoration.bg_image}}),v._v(" "),f("div",{staticClass:"decorations-stock"},[v._v("\n      "+v._s(v.$t("decoration_stock"))+": "),f("span",[v._v(v._s(v.decoration.stock))])])],1),v._v(" "),f("div",{staticClass:"decorations-bottom"},[f("div",{staticClass:"decorations-price"},[f("img",{attrs:{src:n(1033),alt:"credit"}}),v._v(" "),f("span",[v._v(v._s(v.decoration.price))])]),v._v(" "),f("div",{staticClass:"decorations-bottom-content"},[f("div",{staticClass:"decorations-title-box"},[null!==(r=v.decoration.decorationStyle)&&void 0!==r&&r.icon?f("img",{staticClass:"decorations-level-icon",attrs:{src:null===(c=v.decoration.decorationStyle)||void 0===c?void 0:c.icon,alt:"icon"}}):v._e(),v._v(" "),f("div",{staticClass:"decorations-title",attrs:{alt:v.$t(v.decoration.title_key)}},[v._v("\n          "+v._s(v.$t(v.decoration.title_key))+"\n        ")])]),v._v(" "),f("div",{staticClass:"decorations-description text-no-wrap-2",attrs:{alt:v.$t(v.decoration.description_key)}},[v._v("\n        "+v._s(v.$t(v.decoration.description_key))+"\n      ")])]),v._v(" "),f("div",{class:["decorations-preview-btn",null!==(l=v.decoration.decorationStyle)&&void 0!==l&&l.previewBtnBg?"decorations-preview-no-bg":""],attrs:{"data-event":"click-decoration-preview","data-desc":"点击预览按钮","data-id":v.decoration.id},on:{click:v.handlePreview}},[null!==(d=v.decoration.decorationStyle)&&void 0!==d&&d.previewBtnBg?f("div",{staticClass:"decorations-preview-btn-bg",style:{backgroundImage:"url(".concat(null===(h=v.decoration.decorationStyle)||void 0===h?void 0:h.previewBtnBg,")")}}):v._e(),v._v(" "),f("p",{staticClass:"decorations-preview-btn-text"},[v._v("\n        "+v._s(v.$t("preview"))+"\n      ")])])])])}),[],!1,null,"ff362d10",null).exports),ut=n(892),ht=n(752),vt=n.n(ht),pt={name:"DecorationsLevelSelect",data:function(){return{decorationLevelConfig:l.d,curLevel:"",levelIcon:vt.a}},computed:{curLevelStyle:function(){var t=this;return l.d.find((function(e){return e.key===t.curLevel}))||{}}},methods:{handleChange:function(t){if(!t||0===t)return this.curLevel="",void this.$emit("change","",{});this.$emit("change",t,l.d.find((function(e){return e.key===t}))||{})},handleClear:function(){this.$emit("change","",{})}}},ft=(n(4799),n(4800),Object(m.a)(pt,(function(){var t=this,e=t._self._c;return e("el-select",{staticClass:"decorations-level-select",attrs:{placeholder:t.$t("decoration_level"),"popper-class":"decorations-level-select-popper",clearable:""},on:{change:t.handleChange,clear:t.handleClear},model:{value:t.curLevel,callback:function(e){t.curLevel=e},expression:"curLevel"}},[e("img",{staticClass:"decorations-level-selected-icon",attrs:{slot:"prefix",src:t.curLevelStyle.icon||t.levelIcon,alt:"icon"},slot:"prefix"}),t._v(" "),t._l(t.decorationLevelConfig,(function(n){return e("el-option",{key:n.key,attrs:{label:t.$t(n.i18nKey),value:n.key,"data-event":n.dataEvent,"data-desc":n.dataEventDesc,"data-id":n.key}},[e("img",{staticClass:"decorations-level-select-icon",attrs:{src:n.icon,alt:"icon"}}),t._v(" "),e("p",{staticClass:"decorations-level-select-text"},[t._v(t._s(t.$t(n.i18nKey)))]),t._v(" "),e("el-popover",{attrs:{placement:"top",width:"200",trigger:"hover"}},[e("p",{staticClass:"decorations-level-select-tip"},[t._v(t._s(t.$t(n.tipI18nKey)))]),t._v(" "),e("i",{staticClass:"iconfont icon-icon-information",attrs:{slot:"reference"},slot:"reference"})])],1)})),t._v(" "),e("el-option",{staticClass:"decorations-level-select-unlimited",attrs:{label:t.$t("decoration_level_unlimited"),value:0,"data-event":"select-decoration-level-unlimited","data-desc":"选择装饰品框等级"}},[e("img",{staticClass:"decorations-level-select-icon",attrs:{src:n(752),alt:"icon"}}),t._v(" "),e("p",{staticClass:"decorations-level-select-text"},[t._v(t._s(t.$t("decoration_level_unlimited")))])])],2)}),[],!1,null,"723d1542",null).exports),mt=(n(4801),Object(m.a)({},(function(){var t=this,e=t._self._c;return e("el-button",{staticClass:"decorations-btn",attrs:{type:"primary","data-event":"click-decoration-wear","data-desc":"点击装扮按钮"},on:{click:function(e){return t.$emit("useDecorations")}}},[e("div",{staticClass:"decorations-btn-content"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250607/240ec587-eeed-47e9-93cd-0d24ea4b6820.png",alt:"edit"}}),t._v(" "),e("span",[t._v(t._s(t.$t("decoration")))])])])}),[],!1,null,"7d82f7d3",null).exports),gt={name:"DecorationDefault",props:{loading:{type:Boolean,default:!1},hasData:{type:Boolean,default:!1}}},_t=(n(4802),Object(m.a)(gt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasData||t.loading,expression:"!hasData || loading"}]},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"},{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"decorations-content-loading"}),t._v(" "),t.hasData||t.loading?t._e():e("div",{staticClass:"decorations-content-no"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250613/d2399f5b-79b7-4cd5-a6f5-06f9924689b7.png",alt:"no"}}),t._v(" "),e("p",[t._v("暂无数据")])])])}),[],!1,null,"434d1314",null).exports);function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wt={name:"DecorationsView",components:{DecorationsPreview:at,DecorationsItem:lt,SettingDialog:ut.default,DecorationsLevelSelect:ft,DecorationsBtn:mt,DecorationDefault:_t},props:{isMall:{type:Boolean,default:!1}},data:function(){return{navType:l.i,navConfig:l.h,activeNav:l.i.productionBox,decorationsProductList:[],decorationsAvatarist:[],isFixed:!1,lastScrollTop:0,navOffsetTop:0,containerLeft:0,lockScrollChangeNav:!1,loading:!1,topSpace:0}},created:function(){this.model=new d.a,this.initData(),this.$EventBus.$on("goAndGetDecoration",this.scrollToDecoration)},mounted:function(){var t=this;window.addEventListener("scroll",this.handleScroll),this.initFixedSize(),this.$nextTick((function(){t.observeContainerPosition()})),this.$xyLogEvent({front_operation:"exposure",entity_name:"page-decoration-show",entity_type:"page-decoration",obj_id:this.isMall?"2":"1"})},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll),this.$EventBus.$off("goAndGetDecoration",this.scrollToDecoration),this.elObserver&&(this.elObserver.forEach((function(t){t.disconnect()})),this.elObserver=null)},computed:yt(yt(yt({},Object(y.c)("decorations",["goDecorationsNavType","goDecorationsId"])),Object(y.c)("user",["isLoggedIn"])),{},{scrollTargetOffsetDiff:function(){var t=this.isMall?110:170;return this.isFixed&&(t-=64),t}}),methods:yt(yt({},Object(y.b)("decorations",["setGoPersonelOpenSetting","setGoDecorationsNavType","setGoDecorationsId"])),{},{initData:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading=!0,n.prev=1,n.next=4,null===(o=e.model)||void 0===o?void 0:o.getList(t);case 4:r=n.sent,c=r.decorationsProductList,l=r.decorationsAvatarist,e.decorationsProductList=c,e.decorationsAvatarist=l,e.scrollToDecoration(),n.next=14;break;case 12:n.prev=12,n.t0=n.catch(1);case 14:e.loading=!1;case 15:case"end":return n.stop()}}),n,null,[[1,12]])})))()},initFixedSize:function(){var t=this;this.$nextTick((function(){if(t.isMall){var e=document.querySelector(".top-banner");t.topSpace=(null==e?void 0:e.offsetHeight)||0}else{var n=document.querySelector(".el-header");t.topSpace=(null==n?void 0:n.offsetHeight)||0}var o=t.$refs.decorationsNavContainer;t.navOffsetTop=(null==o?void 0:o.offsetTop)||0}))},handleChangeLevel:function(t){this.initData(t)},onBuySuccess:function(t){var e,n;t.type===l.i.avatarBox?this.decorationsAvatarist=null===(e=this.model)||void 0===e?void 0:e.buySuccessUpdateList(this.decorationsAvatarist,t):this.decorationsProductList=null===(n=this.model)||void 0===n?void 0:n.buySuccessUpdateList(this.decorationsProductList,t)},onUseSuccess:function(t){t.type===l.i.avatarBox?this.decorationsAvatarist=this.model.useSuccessUpdateList(this.decorationsAvatarist,t):this.decorationsProductList=this.model.useSuccessUpdateList(this.decorationsProductList,t)},handelToUseDecorations:function(){var t;this.isLoggedIn?null===(t=this.$refs.settingDialog)||void 0===t||t.show():this.$EventBus.$emit("openLoginDialog")},handleChangeNav:function(t){var e=this;this.activeNav=t;var n=document.documentElement.scrollHeight-window.innerHeight;this.lockScrollChangeNav=!0,this.$nextTick((function(){if(t===l.i.productionBox)window.scrollTo({top:0,behavior:"smooth"});else{if(n<window.innerHeight/2)return;var o=e.$refs.scrolltargerRef;if(o){var r=o.offsetTop-e.scrollTargetOffsetDiff;window.scrollTo({top:r,behavior:"smooth"})}}})),setTimeout((function(){e.lockScrollChangeNav=!1}),1e3)},handlePreview:function(t){this.loading||this.$refs.decorationsPreviewDialog.open(t)},handleScroll:Object(c.throttle)((function(){var t=window.pageYOffset||document.documentElement.scrollTop,e=t<this.lastScrollTop;if(t>this.lastScrollTop&&t>this.navOffsetTop?(this.isFixed||this.getEloffset(!0),this.isFixed=!0):e&&t<=this.navOffsetTop&&(this.isFixed&&this.getEloffset(!1),this.isFixed=!1),!this.lockScrollChangeNav){var n=document.documentElement.scrollHeight-window.innerHeight,o=this.$refs.scrolltargerRef;if(o&&n>window.innerHeight/2){var r=o.offsetTop-280;this.activeNav=t>r?l.i.avatarBox:l.i.productionBox}}this.lastScrollTop=t}),200),getEloffset:function(t){var e=this.$refs.decorationsNavContainer,n=this.$refs.decorationsBannerRef;e&&n&&(t?(e.style.width=n.clientWidth+"px",e.style.left=n.getBoundingClientRect().left+"px",e.style.top=this.topSpace+"px"):(e.style.width="100%",e.style.left="0",e.style.top="0"))},scrollToDecoration:function(){var t=this;this.goDecorationsNavType&&this.$nextTick((function(){t.handleChangeNav(Number(t.goDecorationsNavType)),t.setGoDecorationsNavType(0)})),this.goDecorationsId&&this.$nextTick((function(){var e=document.querySelector('[data-decoration-id="'.concat(t.goDecorationsId,'"]'));if(e){var n=e.offsetTop-200;window.scrollTo({top:n,behavior:"smooth"}),t.setGoDecorationsId(0)}}))},handleResize:Object(c.throttle)((function(){var t=this;this.isFixed&&this.$nextTick((function(){t.getEloffset(!0)}))}),200),observeContainerPosition:function(){var t=this;if(window.ResizeObserver){this.elObserver=new Map;var e=document.querySelector(".top-banner");if(e){var n=new MutationObserver((function(o){o.forEach((function(o){"attributes"===o.type&&o.target===e&&(t.initFixedSize(),t.handleResize()),"childList"===o.type&&o.removedNodes.forEach((function(o){o===e&&(t.initFixedSize(),t.handleResize(),n.disconnect(),t.elObserver.delete(e))}))}))}));n.observe(e,{attributes:!0,attributeFilter:["style","class"]});var o=e.parentNode;o&&n.observe(o,{childList:!0}),this.elObserver.set(e,n)}var r=document.querySelector(".el-container.body-container");if(r){var c=new ResizeObserver((function(e){t.handleResize()}));c.observe(r),this.elObserver.set(r,c)}}}})},Ct=(n(4803),Object(m.a)(wt,(function(){var t=this,e=t._self._c;return e("div",{ref:"decorationsContainerRef",staticClass:"decorations-container",class:{"is-mall":t.isMall}},[e("img",{directives:[{name:"show",rawName:"v-show",value:!t.isFixed,expression:"!isFixed"}],staticClass:"decorations-container-bg",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/25319ac7-f9d4-4bf4-a047-816d179738e1.png"}}),t._v(" "),e("div",{staticClass:"decorations-top",attrs:{"data-group":"page-decoration-header"}},[e("div",{staticClass:"decorations-top-left"},[e("div",{staticClass:"decorations-title"},[t._v("\n        "+t._s(t.$t("SeaArt_ersonalized_decoration"))+"\n      ")]),t._v(" "),e("div",{staticClass:"decorations-description"},[t._v("\n        "+t._s(t.$t("personalized_decoration_description"))+"\n      ")])]),t._v(" "),e("DecorationsBtn",{on:{useDecorations:t.handelToUseDecorations}})],1),t._v(" "),e("div",{ref:"decorationsNavContainer",class:["decorations-nav-container",{fixed:t.isFixed}]},[e("img",{directives:[{name:"show",rawName:"v-show",value:t.isFixed,expression:"isFixed"}],staticClass:"decorations-nav-bg",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250603/25319ac7-f9d4-4bf4-a047-816d179738e1.png"}}),t._v(" "),e("div",{staticClass:"decorations-nav"},t._l(t.navConfig,(function(n){return e("div",{key:n.key,class:["decorations-nav-item",t.activeNav===n.key?"active":""],attrs:{"data-event":n.dataEvent,"data-desc":n.dataEventDesc},on:{click:function(e){return t.handleChangeNav(n.key)}}},[t._v("\n        "+t._s(t.$t(n.i18nKey))+"\n      ")])})),0),t._v(" "),e("div",{staticClass:"decorations-nav-right"},[e("DecorationsLevelSelect",{on:{change:t.handleChangeLevel}}),t._v(" "),e("DecorationsBtn",{directives:[{name:"show",rawName:"v-show",value:t.isFixed,expression:"isFixed"}],on:{useDecorations:t.handelToUseDecorations}})],1)]),t._v(" "),e("div",{ref:"decorationsBannerRef",staticClass:"decorations-banner"},[e("div",{staticClass:"decorations-banner-tip"},[t._v(t._s(t.$t(t.navConfig[0].bannerTipI18nKey)))])]),t._v(" "),t.decorationsProductList.length>0?e("div",{staticClass:"decorations-content",attrs:{"data-group":"page-decoration-production-content"}},t._l(t.decorationsProductList,(function(n){return e("DecorationsItem",{key:n.id,attrs:{decoration:n},on:{preview:t.handlePreview}})})),1):t._e(),t._v(" "),e("DecorationDefault",{attrs:{loading:t.loading,hasData:t.decorationsProductList.length>0}}),t._v(" "),e("div",{ref:"scrolltargerRef",staticClass:"decorations-banner"},[e("div",{staticClass:"decorations-banner-tip"},[t._v(t._s(t.$t(t.navConfig[1].bannerTipI18nKey)))])]),t._v(" "),t.decorationsAvatarist.length>0?e("div",{staticClass:"decorations-content",attrs:{"data-group":"page-decoration-avatar-content"}},t._l(t.decorationsAvatarist,(function(n){return e("DecorationsItem",{key:n.id,attrs:{decoration:n},on:{preview:t.handlePreview}})})),1):t._e(),t._v(" "),e("DecorationDefault",{attrs:{loading:t.loading,hasData:t.decorationsAvatarist.length>0}}),t._v(" "),e("DecorationsPreview",{ref:"decorationsPreviewDialog",on:{buySuccess:t.onBuySuccess,useSuccess:t.onUseSuccess}}),t._v(" "),e("SettingDialog",{ref:"settingDialog"})],1)}),[],!1,null,"3cf533c4",null));e.a=Ct.exports},829:function(t,e,n){"use strict";n(5399),n(47);var o=n(3477),r=n.n(o),c=(n(5400),n(3478)),l=n.n(c),d=(n(19),n(6),n(32),n(16),n(4),n(28),n(21),n(44),n(92),n(7),n(613)),h=n(58),v=n(3),f=(n(20),n(26),n(10)),m={props:{fileName:{type:String,default:""}},data:function(){return{url:"",scale:1,translateX:0,translateY:0,originX:50,originY:50,isShow:!1,dragging:!1,lastX:0,lastY:0,clickTime:0,width:0,height:0,realWidth:0,realHeight:0,initInfo:{width:0,height:0,x:0,y:0}}},computed:{imageStyle:function(){return{transform:"translate3d(".concat(this.translateX,"px, ").concat(this.translateY,"px, 0) scale3d(").concat(this.scale,", ").concat(this.scale,", 1) "),transformOrigin:"".concat(this.originX,"% ").concat(this.originY,"%"),width:this.width+"px",height:this.height+"px"}},imageClass:function(){return{"move-mouse":1!==this.scale}}},mounted:function(){window.addEventListener("resize",this.handleResize),document.addEventListener("keydown",this.handleEscKey)},methods:{handleEscKey:function(t){"Escape"!==t.key&&27!==t.keyCode||this.hide()},handleResize:function(t){2!==this.scale&&this.initFull()},initFull:function(t){var e=window.innerWidth,n=window.innerHeight,o=this.realWidth,r=this.realHeight,c=o/r,l=e,d=n;c>=1?d=(l=o>e?e:o)/c:l=(d=r>n?n:r)*c,this.width=l,this.height=d,this.translateX=(e-l)/2,this.translateY=(n-d)/2},show:function(t,e){var n=arguments,o=this;return Object(v.a)(regeneratorRuntime.mark((function r(){var c,l,d,h,v,f,m,_,y;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=n.length>2&&void 0!==n[2]?n[2]:1,o.url=t,e&&(l=e.getBoundingClientRect(),d=l.width,h=l.height,v=l.x,f=l.y,o.initInfo={width:d,height:h,x:v,y:f},o.init()),r.next=5,o.getImageSize();case 5:m=r.sent,_=m.width,y=m.height,o.realWidth=_,o.realHeight=y,o.isShow=!0,setTimeout((function(){o.scale=c,o.initFull()}),100);case 12:case"end":return r.stop()}}),r)})))()},hide:function(){var t=this;this.init(),setTimeout((function(){t.isShow=!1}),100)},getImageSize:function(){var t=this;return new Promise((function(e,n){var img=new Image;img.src=t.url,img.onload=function(){t.realWidth=img.width,t.realHeight=img.height,e({width:img.width,height:img.height})},img.onerror=function(){n()}}))},init:function(){var t=this.initInfo,e=t.width,n=t.height,o=t.x,r=t.y;this.width=e,this.height=n,this.translateX=o,this.translateY=r,this.scale=1,this.originX=50,this.originY=50},imgLoad:function(){},onWheel:function(t,e){if(t.preventDefault(),1!==this.scale){var n=t.deltaY;this.translateY-=n,this.resetPosition()}},zoom:function(t,e){var n=this.$refs.imageContainer.getBoundingClientRect(),o=n.width,r=n.height;this.scale=1===this.scale?2:1,this.originX=2===this.scale&&t?t/o*100:50,this.originY=2===this.scale&&e?e/r*100:50,this.translateX=(window.innerWidth-this.width)/2,this.translateY=(window.innerHeight-this.height)/2},handle:function(t){switch(t){case"ZOOM":this.$logEvent("log_actions",{operation:"click_resizing",behavior_info:"on_work_detail_page"}),this.zoom(0,0);break;case"DOWNLOAD":this.download();break;case"CLOSE":this.hide()}},download:function(){var t=this.fileName||(new Date).getTime()+".png";Object(f.M)(this.url,t)},onMouseDown:function(t){this.startDragging(t)},startDragging:function(t){this.dragging=!0,this.clickTime="",this.lastX=t.clientX,this.lastY=t.clientY,2===this.scale&&this.$refs.imageBox.classList.add("grabbing"),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseMove:function(t){if(this.dragging&&1!==this.scale){this.clickTime=(new Date).getTime();var e=t.clientX-this.lastX,n=t.clientY-this.lastY,o=this.translateX+e,r=this.translateY+n;this.translateX=o,this.translateY=r,this.lastX=t.clientX,this.lastY=t.clientY}},onMouseUp:function(t){this.dragging=!1,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),this.$refs.imageBox.classList.remove("grabbing"),this.clickTime?this.resetPosition():this.handleScale(t)},resetPosition:function(){var t=this.$refs.imageBox.getBoundingClientRect(),e=t.width,n=t.height;if(1!==this.scale){var o=(50-this.originX)*this.width/100,r=(50-this.originY)*this.height/100;if(console.log(e,n,window.innerWidth,window.innerHeight,this.width,this.height,"this.originY: "+this.originY,"this.originX: "+this.originX),e<window.innerWidth)this.translateX=(window.innerWidth-e/2)/2;else{var c=-(e-window.innerWidth-e/4),l=this.width>window.innerWidth?-e/4:c,d=e/4;l-=o,d-=o;var h=this.translateX<l?l:this.translateX>d?d:this.translateX;this.translateX=h}if(n<window.innerHeight)this.translateY=(window.innerHeight-n/2)/2;else{var v=-(n-window.innerHeight-n/4),f=this.height>window.innerHeight?-n/4:v,m=n/4;f-=r,m-=r;var _=this.translateY<f?f:this.translateY>m?m:this.translateY;this.translateY=_}}},handleScale:function(t){var e=this.$refs.imageContainer.getBoundingClientRect(),n=e.left,o=e.top,r=t.clientX-n,c=t.clientY-o;this.zoom(r,c)}},beforeDestroy:function(){document.removeEventListener("keydown",this.handleEscKey)}},_=m,y=(n(5401),n(0)),w=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal-fade"}},[t.isShow?e("div",{ref:"imageContainer",staticClass:"view-image",on:{wheel:t.onWheel}},[e("img",{ref:"imageBox",class:t.imageClass,style:t.imageStyle,attrs:{src:t.url,alt:"",draggable:"false"},on:{load:t.imgLoad,mousedown:t.onMouseDown}}),t._v(" "),e("div",{staticClass:"handle-btns"},[e("span",{staticClass:"btn-box download-btn",on:{click:function(e){return t.handle("DOWNLOAD")}}},[e("i",{staticClass:"iconfont icon-modelDownload"})]),t._v(" "),e("span",{staticClass:"btn-box zoom-btn",on:{click:function(e){return t.handle("ZOOM")}}},[e("i",{staticClass:"iconfont",class:1===t.scale?"icon-icon-enlarge":"icon-a-icon-Zoomout"})]),t._v(" "),e("span",{staticClass:"btn-box delete-btn",on:{click:function(e){return t.handle("CLOSE")}}},[e("i",{staticClass:"iconfont icon-close"})])])]):t._e()])}),[],!1,null,"32bb1fba",null).exports,C={name:"BlogRelatedList",components:{SwipeableList:n(52).default},props:{list:{type:Array,default:function(){return[]}},type:{type:String,default:"blog"}},data:function(){return{centerContentStyle:{width:"100%",display:"flex",justifyContent:"center"}}},computed:{shouldCenterList:function(){return this.list.length<4}},methods:{}},k=(n(5402),Object(y.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"related-blogs"},[e("h2",{staticClass:"related-blogs-title"},[t._v(t._s(t.$t("article_rec")))]),t._v(" "),e("swipeable-list",{attrs:{iconBntWidth:32,moveLeng:291,listGap:"12px",contentStyle:t.shouldCenterList?t.centerContentStyle:{},needInScroll:t.shouldCenterList}},[e("ul",{staticClass:"list-cnt",class:{centered:t.shouldCenterList}},t._l(t.list,(function(n){return e("li",{key:n.id,staticClass:"list-item"},[e("nuxt-link",{attrs:{to:t.localePath("/".concat(t.type,"/").concat(n.url))}},[e("div",{staticClass:"blog-card"},[e("div",{staticClass:"blog-card-image"},[e("img",{attrs:{src:n.cover,alt:"blog image"}}),t._v(" "),e("div",{staticClass:"blog-card-overlay"},[e("h3",{staticClass:"blog-card-title"},[t._v(t._s(n.post_title))]),t._v(" "),e("p",{staticClass:"blog-card-desc"},[t._v(t._s(n.meta_desc))])])])])])],1)})),0)])],1)}),[],!1,null,"ba5ad508",null)),O=k.exports;installComponents(k,{SwipeableList:n(52).default});var x={components:{BlogHeader:d.a,ElBreadcrumb:l.a,ElBreadcrumbItem:r.a,ViewImage:w,RelatedList:O},props:{type:{type:String,default:"blog",validator:function(t){return["blog","news"].includes(t)}},detailData:{type:Object,default:function(){}}},data:function(){return{tagList:[{icon:"icon-icon_All_",label:"All",value:"all",i18nKey:"blog_all"},{icon:"icon-a-icon_AIArtGuide_",label:"AI Art Guide",value:"aiArtGuide",i18nKey:"blog_aiArtGuide"},{icon:"icon-a-icon_AIVideoGuide_",label:"AI Video Guide",value:"aiVideoGuide",i18nKey:"blog_aiVideoGuide"},{icon:"icon-a-icon_TrainingGuide_",label:"Training Guide",value:"trainingGuide",i18nKey:"blog_trainingGuide"},{icon:"icon-icon_news_",label:"News",value:"news",i18nKey:"blog_news"},{icon:"icon-a-icon_AITools_",label:"AI Tools",value:"aiTools",i18nKey:"blog_aiTools"},{icon:"icon-icon-blog-voice_",label:"AI语音指南",value:"aiVoiceGuide",i18nKey:"blog_aiVoiceGuide"},{icon:"icon-icon-blog-tip_",label:"指南与技巧",value:"guides&tips",i18nKey:"blog_guides&tips"},{icon:"icon-icon-blog-review_",label:"评测",value:"review",i18nKey:"blog_review"}],catalogZoom:!1}},computed:{typeInfo:function(){var t={blog:{path:"/blog",i18nKey:"blog",apiType:""},news:{path:"/news",i18nKey:"blog_news",apiType:"aiNews"}};return t[this.type]||t.blog},time:function(){var t;return Object(h.h)(null===(t=this.detailData)||void 0===t?void 0:t.update_at)},getCategoryKey:function(){var t=this;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("news"===t.type)return"news_".concat(e);var n=t.tagList.find((function(t){return t.value===e}));return n?n.i18nKey:"blog_".concat(e)}},authorUrl:function(){var t,e=(null===(t=this.detailData.author.split("@"))||void 0===t?void 0:t[1])||"";return e?e.includes("www")?e:"".concat("https://www.seaart.ai","/user/").concat(e):"https://www.seaart.ai"},authorName:function(){return this.detailData.author.split("@")[0]},blogContent:function(){var t,content=(null===(t=this.detailData)||void 0===t?void 0:t.content)||"";return(content=this.processCodeBlocks(content)).replace(/<a\s+(?![^>]*href="[^"]*seaart\.ai[^"]*")([^>]*)>/gi,'<a $1 rel="nofollow noopener">')},catalogList:function(){for(var t,e,content=(null===(t=this.detailData)||void 0===t?void 0:t.content)||"",n=/<h2[^>]*>(.*?)<\/h2>/gi,o=[];null!==(e=n.exec(content));){var r=e[1].replace(/<[^>]*>/g,"");o.push(r)}return o},relatedList:function(){var t,e=(null===(t=this.detailData)||void 0===t?void 0:t.related_post_data)||[];return e.filter((function(t){return t.post_title}))}},mounted:function(){"news"===this.type&&this.$logEvent("log_actions",{operation:"enter_news_detail_page",behavior_info:"on_news_detail_page"}),this.addIdsToHeadings(),this.setImagesStyle()},updated:function(){var t=this;this.$nextTick((function(){t.addIdsToHeadings(),t.setImagesStyle()}))},methods:{addIdsToHeadings:function(){var t=this,e=this.$el.querySelector(".blog-detail-content-html");e&&e.querySelectorAll("h2").forEach((function(h2){var text=h2.textContent.trim(),e=t.decodeHtmlEntities(text);h2.id=e}))},scrollToHeading:function(t){var e=this.decodeHtmlEntities(t),element=document.getElementById(e);element&&element.scrollIntoView({behavior:"smooth",block:"start"})},decodeHtmlEntities:function(text){return(new DOMParser).parseFromString("<!doctype html><body>".concat(text,"</body>"),"text/html").body.textContent},handleImageClick:function(t){if("IMG"===t.target.tagName){var img=t.target,e=img.getAttribute("data-href");if(e)window.open(e,"_blank","noopener,noreferrer");else{var n=img.getAttribute("src");n&&this.$refs.viewImage&&this.$refs.viewImage.show(n)}}},setImagesStyle:function(){var t=document.querySelector(".blog-detail-content-html");t&&(t.removeEventListener("click",this.handleImageClick),t.addEventListener("click",this.handleImageClick),t.querySelectorAll("img").forEach((function(img){var t=img.getAttribute("data-href");img.style.cursor=t?"pointer":"zoom-in"})),this.handleAnchorLinks())},decodeHtmlToRaw:function(t){if(!t)return"";var e=document.createElement("textarea");return e.innerHTML=t,e.value},processCodeBlocks:function(content){return content?content.replace(/<code>([\s\S]*?)<\/code>/gi,(function(t,e){var n=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ");return"<code>".concat(n,"</code>")})):""},handleAnchorLinks:function(){var t=this,e=document.querySelector(".blog-detail-content-html");e&&e.querySelectorAll('a[href^="#"]').forEach((function(link){link.removeEventListener("click",t.handleAnchorClick),link.addEventListener("click",t.handleAnchorClick)}))},handleAnchorClick:function(t){t.preventDefault();var e=t.currentTarget.getAttribute("href");if(e&&"#"!==e){var n=e.substring(1),o=document.getElementById(n);o&&o.scrollIntoView({behavior:"smooth",block:"start"})}}}},I=x,S=(n(5403),Object(y.a)(I,(function(){var t,e,n,o,r,c=this,l=c._self._c;return l("div",{staticClass:"blog-detail"},[l("BlogHeader",{attrs:{isDetail:!0,type:c.type}}),c._v(" "),l("div",{staticClass:"blog-detail-content"},[l("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[l("a",{attrs:{href:c.localePath("/")}},[c._v(c._s(c.$t("blog_home")))])]),c._v(" "),l("el-breadcrumb-item",{attrs:{to:{path:c.typeInfo.path}}},[l("a",{attrs:{href:c.localePath(c.typeInfo.path)}},[c._v(c._s(c.$t(c.typeInfo.i18nKey)))])]),c._v(" "),null!==(t=c.detailData)&&void 0!==t&&t.category?l("el-breadcrumb-item",[c._v("\n        "+c._s(c.$t(c.getCategoryKey(null===(e=c.detailData)||void 0===e?void 0:e.category)))+"\n      ")]):c._e()],1),c._v(" "),null!==(n=c.detailData)&&void 0!==n&&n.post_title?l("h1",[c._v(c._s(c.detailData.post_title))]):c._e(),c._v(" "),null!==(o=c.detailData)&&void 0!==o&&o.author?l("div",{staticClass:"tips"},[l("div",[l("a",{staticClass:"author",attrs:{href:c.authorUrl,target:"_blank"}},[c._v(c._s(c.authorName))]),c._v(" "),l("time",{staticClass:"time",attrs:{datetime:c.time}},[c._v(" "+c._s(c.$t("blog_updated"))+" "+c._s(c.time)+" ")])]),c._v(" "),l("div",{staticClass:"time"},[l("i",{staticClass:"el-icon-time"}),c._v(" "),l("span",[c._v(c._s(c.detailData.reading_duration)+" "+c._s(c.$t("blog_read")))])])]):c._e(),c._v(" "),null!==(r=c.detailData)&&void 0!==r&&r.meta_desc?l("div",{staticClass:"meta"},[c._v("\n      "+c._s(c.detailData.meta_desc)+"\n    ")]):c._e(),c._v(" "),c.blogContent?l("div",{staticClass:"blog-detail-content-html",domProps:{innerHTML:c._s(c.blogContent)}}):c._e(),c._v(" "),c.relatedList.length?l("RelatedList",{attrs:{list:c.relatedList,type:c.type}}):c._e()],1),c._v(" "),l("div",{staticClass:"catalog",class:{"catalog-zoom":c.catalogZoom}},[l("p",[c._v(c._s(c.$t("catalogue")))]),c._v(" "),l("ul",c._l(c.catalogList,(function(t,e){return l("li",{key:e+"_catalog_"+t},[l("a",{attrs:{href:"javascript:void(0)"},domProps:{innerHTML:c._s(t)},on:{click:function(e){return c.scrollToHeading(t)}}})])})),0),c._v(" "),l("Icon",{attrs:{name:"send2"},nativeOn:{click:function(t){c.catalogZoom=!c.catalogZoom}}})],1),c._v(" "),l("view-image",{ref:"viewImage"})],1)}),[],!1,null,"6d4184f7",null));e.a=S.exports},830:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(112),c=n(207),l=n(111),d=n(10),h=n(257),v=n(1),f=n(45),m=n(27),_={props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},isCheck:{type:Boolean,default:!1},isMine:{type:Boolean,default:!1}},data:function(){return{}},methods:{handlePopoverShow:function(){this.$emit("handlePopoverShow")},moreActions:function(t){this.$emit("moreActions",t)}}},y=(n(4692),n(0)),component=Object(y.a)(_,(function(){var t,e=this,n=e._self._c;return n("el-popover",{directives:[{name:"show",rawName:"v-show",value:!e.isCheck,expression:"!isCheck"}],ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:e.handlePopoverShow}},[n("div",{staticClass:"pop-btns flex"},["userPage"==e.fromPage&&e.isMine?n("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("pinOrNot")}}},[e._v("\n      "+e._s(e.$t(null!==(t=e.item)&&void 0!==t&&t.isTop?"UnpinOverview":"PinOverview"))+"\n    ")]):e._e(),e._v(" "),e.isMine?n("button",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.moreActions("edit")}}},[e._v("\n      "+e._s(e.$t("Edit"))+"\n    ")]):e._e(),e._v(" "),n("button",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.moreActions("report")}}},[n("span",{staticClass:"pop-btns-text"},[e._v(e._s(e.$t("Report")))]),e._v(" "),n("span",{staticClass:"pop-btns-icon"},[n("svg-icon",{attrs:{"icon-class":"task-report-icon"}})],1)]),e._v(" "),e.isMine?n("button",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.moreActions("delete")}}},[e._v("\n      "+e._s(e.$t("Delete"))+"\n    ")]):e._e()]),e._v(" "),n("div",{staticClass:"item-cover-operate",attrs:{slot:"reference"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}},slot:"reference"},[n("i",{staticClass:"iconfont icon-more"})])])}),[],!1,null,"32172a49",null),w=component.exports;installComponents(component,{SvgIcon:n(115).default});var C={components:{HandlePopover:w},props:{name:{type:String,default:""},desc:{type:String,default:""}}},k=(n(4693),Object(y.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"hover-mask"},[e("div",{staticClass:"mask-head"},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.name,expression:"name"}]},[t._v(t._s(t.name))]),t._v(" "),t._t("default")],2),t._v(" "),e("div",{staticClass:"mask-info"},[t._v("\n    "+t._s(t.desc)+"\n  ")])])}),[],!1,null,"b4e53b72",null).exports),O=n(25),x=n(39),I=n(53),S=n(93);function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P={components:{ImgWaterFall:r.default,AiChatReport:h.a,listCheckbox:c.default,HandlePopover:w,HoverMask:k,AdminTag:l.default,BaseAvatar:I.default},mixins:[f.a],props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},isCheck:{type:Boolean,default:!1},activateTab:{type:String,default:""},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},review:{type:Boolean,default:!1}},data:function(){return{formatNumberForeign:d.p,formatEvaluation:S.e}},computed:L(L(L({},Object(v.e)("user",["token","userInfo"])),Object(v.e)("payment",["productLevel"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},isLoggedIn:function(){return this.token},isRecommend:function(){return"feature"===this.activateTab},itemStyle:function(){return{width:this.item.waterWidth+"px",height:this.item.waterHeight+"px"}},boxStyle:function(){var t=this.item.waterHeight;return this.isRecommend?{height:t-60+"px"}:{}},renderItem:function(){if(1===this.item.nsfw){var t=Object(O.cloneDeep)(this.item);return t.cover="https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp",t.replaceUrl="https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp",t}return this.item}}),methods:{renderName:function(t){return Object(S.h)(this,t)},handleClickToDetails:function(){var t;this.$logEvent("log_actions",{operation:"click_tavern",behavior_info:this.item.id,behavior_info_sub:"Home"}),this.$router.push(this.localePath("/cyberPubPage/".concat(null===(t=this.item)||void 0===t?void 0:t.id)))},goChat:function(){var t,e=this.item,n=e.id,o=e.obj_type,r=e.pt,c=e.stat;this.isCheck||(this.$logEvent("log_actions",{operation:"click_tavern",behavior_info:this.item.id,behavior_info_sub:"Home"}),Object(x.i)({items:[L(L({},this.dotReportInfo),{},{action:"view",obj_no:n,obj_type:o,batch_id:r,stat:c},this.productLevel&&{vip:this.productLevel})]}),this.$router.push(this.localePath("/aiChat/".concat(null===(t=this.item)||void 0===t?void 0:t.id))))},moreActions:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.item.obj_type;switch(e){case"edit":this.$logEvent("log_actions",{operation:"click_edit",behavior_info:"on_personal_center",behavior_info_sub:n}),this.$router.push(this.localePath("/cyberPubPage/new-character?id="+(null===(t=this.item)||void 0===t?void 0:t.id)));break;case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item);break;case"report":try{this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_report"}),this.$refs.AiChatReport.open()}catch(t){}break;case"share":this.$logEvent("log_actions",{operation:"click_share",behavior_info:"on_personal_center",behavior_info_sub:n}),this.handleShare()}},handleShare:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_share"});var t=location.origin;Object(d.g)(t+"/cyberPubPage/".concat(this.item.id)),this.$message.success(this.$t("CopiedURLToClipboard"))},otherUser:function(t){var e,n,path="/user/"+encodeURIComponent(t.author.id);(null===(e=this.userInfo)||void 0===e?void 0:e.id)==(null===(n=t.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},tagChange:function(){this.$emit("change")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(m.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}}}},j=P,$=(n(4694),Object(y.a)(j,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_=this,y=_._self._c;return y("a",{class:{"recommend-cyberpub":_.isRecommend},attrs:{href:_.localePath("/cyberPubPage/".concat(null===(t=_.item)||void 0===t?void 0:t.id))},on:{click:function(t){return t.preventDefault(),_.goChat.apply(null,arguments)}}},[y("div",{staticClass:"cyberBarItem",style:_.itemStyle,attrs:{"data-tag":_.$t("digitalHuman")}},[_.isCheck&&_.item?y("listCheckbox",{on:{change:function(t){return _.$emit("checkChange")}},model:{value:_.item.isCheck,callback:function(t){_.$set(_.item,"isCheck",t)},expression:"item.isCheck"}}):_._e(),_._v(" "),_.isRecommend?_._e():y("div",{staticClass:"name",attrs:{title:_.renderName(_.item.character)},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.handleClickToDetails.apply(null,arguments)}}},[_._v("\n      "+_._s(_.renderName(_.item.character))+"\n    ")]),_._v(" "),y("div",{staticClass:"imgBox",style:_.boxStyle},[_.item.nsfw?y("ImgWaterFall",{style:{transition:"all 0.3s ease-in-out",transform:_.item.isCheck?"scale(0.85)":null},attrs:{isLazyload:!1,isHeight:!1,item:_.renderItem}}):_._e(),_._v(" "),y("div",{staticClass:"imgBox-num"},[y("div",{staticClass:"imgBox-num-item"},[y("i",{staticClass:"iconfont icon-users-solid imgBox-num-item-icon"}),_._v(" "),y("span",{staticClass:"imgBox-num-item-text"},[_._v("\n            "+_._s(_.formatNumberForeign((null===(e=_.item)||void 0===e||null===(e=e.stat)||void 0===e?void 0:e.num_of_token)||(null===(n=_.item)||void 0===n||null===(n=n.character)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_token)||0))+"\n          ")])]),_._v(" "),y("div",{staticClass:"imgBox-num-item",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.setCollect(_.item,"character")}}},[y("div",{staticClass:"imgBox-num-item-icon"},[y("i",{staticClass:"iconfont",class:_.setCollectData(_.item)})]),_._v(" "),y("span",{staticClass:"imgBox-num-item-text"},[_._v("\n            "+_._s(_.formatNumberForeign((null===(o=_.item)||void 0===o||null===(o=o.stat)||void 0===o?void 0:o.num_of_collection)||(null===(r=_.item)||void 0===r||null===(r=r.character)||void 0===r||null===(r=r.stat)||void 0===r?void 0:r.num_of_collection)||0))+"\n          ")])])]),_._v(" "),y("client-only",[_.isRecommend?y("hover-mask",{attrs:{name:null===(c=_.item.character)||void 0===c?void 0:c.name,desc:null===(l=_.item.character)||void 0===l?void 0:l.evaluation}},[y("handle-popover",{attrs:{fromPage:_.fromPage,isCheck:_.isCheck,isMine:_.isMine,item:_.item},on:{handlePopoverShow:_.handlePopoverShow,moreActions:_.moreActions}})],1):_._e(),_._v(" "),_.isRecommend?y("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),_.goChat.apply(null,arguments)}}},[_._v("\n          "+_._s(_.$t("gpt_tab_chat"))+"\n        ")]):_._e()],1),_._v(" "),y("admin-tag",{attrs:{id:_.item.id,item:_.item,type:"9",review:_.review},on:{change:_.tagChange}})],1),_._v(" "),_.isRecommend?_._e():[y("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[y("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},domProps:{innerHTML:_._s(_.formatEvaluation(null===(d=_.item.character)||void 0===d?void 0:d.evaluation))},slot:"content"}),_._v(" "),y("div",{staticClass:"desc",domProps:{innerHTML:_._s(_.formatEvaluation(null===(h=_.item.character)||void 0===h?void 0:h.evaluation))}})]),_._v(" "),y("div",{staticClass:"item-content-tags"},_._l(null===(v=_.item.character)||void 0===v?void 0:v.categories,(function(t,e){return y("span",{key:e+t.id,staticClass:"item-content-tags-item"},[_._v("\n          "+_._s(t.name)+"\n        ")])})),0)],_._v(" "),_.isRecommend?y("div",{staticClass:"cyberpub-name"},[_._v(_._s(null===(f=_.item.character)||void 0===f?void 0:f.name))]):_._e(),_._v(" "),y("div",{staticClass:"author",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[y("div",{staticClass:"author-box",on:{click:function(t){return _.otherUser(_.item)}}},[y("BaseAvatar",{staticStyle:{"margin-right":"5px"},attrs:{userData:_.item.author,size:24}}),_._v(" "),y("div",{staticClass:"authorName"},[y("span",[_._v(_._s(null===(m=_.item.author)||void 0===m?void 0:m.name))])])],1),_._v(" "),_.isRecommend?_._e():y("handle-popover",{attrs:{fromPage:_.fromPage,isCheck:_.isCheck,isMine:_.isMine,item:_.item},on:{handlePopoverShow:_.handlePopoverShow,moreActions:_.moreActions}})],1)],2),_._v(" "),y("ai-chat-report",{ref:"AiChatReport",attrs:{"ai-chat-id":_.item.id}})],1)}),[],!1,null,"6366289e",null));e.a=$.exports;installComponents($,{ImgWaterFall:n(112).default,AdminTag:n(111).default,BaseAvatar:n(53).default})},897:function(t,e,n){"use strict";n(16),n(8),n(21),n(11),n(12),n(13);var o=n(30),r=n(2),c=(n(19),n(6),n(50),n(73),n(122),n(49),n(243),n(4),n(177),n(7),n(26),n(93)),l=n(38),d=n(1);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"AiChatFeedbackCollection",props:{isPermanent:{type:Boolean,default:!1}},computed:v(v({},Object(d.c)("character",["characterInfo","sessionId","formattedHistoryMessage","msgLoadingOver"])),{},{isGetQuestionnaire:function(){return!(!(this.formattedHistoryMessage.length>1&&this.sessionId)||this.msgLoadingOver)||!!this.isPermanent},notice:function(){var t,e=(this.questionnaireSurvey.introduction_content||[]).findIndex((function(t){return"Notice"===t.filed_id}));return-1!==e?null===(t=this.questionnaireSurvey.introduction_content[e])||void 0===t?void 0:t.desc:""},title:function(){var t,e=(this.questionnaireSurvey.introduction_content||[]).findIndex((function(t){return"Title"===t.filed_id}));return-1!==e?null===(t=this.questionnaireSurvey.introduction_content[e])||void 0===t?void 0:t.desc:""},desc:function(){var t,e=(this.questionnaireSurvey.introduction_content||[]).findIndex((function(t){return"Prologue"===t.filed_id}));return-1!==e?null===(t=this.questionnaireSurvey.introduction_content[e])||void 0===t?void 0:t.desc:""},hasInput:function(){var t=!1,e=!1;return!(!this.formData||0===Object.keys(this.formData).length)&&(Object.entries(this.formData).forEach((function(n){var r=Object(o.a)(n,2),c=r[0],l=r[1];(Array.isArray(l)?l.length>0:!!l)&&(c.includes("Email")?t=!0:e=!0)})),!(t&&!e)&&Object.values(this.formData).some((function(t){return Array.isArray(t)?t.length>0:!!t})))}}),watch:{isGetQuestionnaire:{handler:function(t){t&&!this.hasRequest&&(this.isPermanent?this.getPermanentQuestionnaireInfoFn():this.getQuestionnaireInfoFn())},immediate:!0},sessionId:{handler:function(t){t&&this.isPermanent&&!this.questionnaireInfo.resident_questionnaire_addr&&!this.hasRequest&&this.getPermanentQuestionnaireInfoFn()},immediate:!0}},data:function(){return{hasRequest:!1,hasApi:!1,loading:!1,next:null,htmlToPlainText:c.l,questionnaireInfo:{questionnaire_addr:"",questionnaire_type:0},questionnaireSurvey:{},dialogVisible:!1,formData:{},QUICK_INPUT_ITEMS:c.c,MAX_LENGTH:1e3}},methods:{labelShow:function(t){return"checkbox"===t.field_type?"MultipleChoice":"radio"===t.field_type?"SingleChoice":t.is_required?"Required":"Optional"},getQuestionnaireInfoFn:function(){var t=this;if(this.hasRequest||this.questionnaireInfo.questionnaire_addr||!this.sessionId)switch(!0){case this.hasRequest:console.warn("重复请求拦截");break;case this.questionnaireInfo.questionnaire_addr:console.warn("已有问卷拦截");break;case!this.sessionId:console.warn("没有sessionId拦截")}else this.hasRequest=!0,Object(l.z)({session_id:this.sessionId}).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&e.data&&(t.questionnaireInfo=e.data,e.data.questionnaire_addr&&t.getQuestionnaireSurveyFn())}))},getPermanentQuestionnaireInfoFn:function(){var t=this;if(this.hasRequest||this.questionnaireInfo.resident_questionnaire_addr||!this.sessionId)switch(!0){case this.hasRequest:console.warn("重复请求拦截");break;case this.questionnaireInfo.resident_questionnaire_addr:console.warn("已有问卷拦截");break;case!this.sessionId:console.warn("没有sessionId拦截")}else this.hasRequest=!0,Object(l.z)({session_id:this.sessionId}).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&e.data&&(t.questionnaireInfo=e.data,e.data.resident_questionnaire_addr&&t.getQuestionnaireSurveyFn())}))},getQuestionnaireSurveyFn:function(){var t=this,e=this.isPermanent?this.questionnaireInfo.resident_questionnaire_addr:this.questionnaireInfo.questionnaire_addr;Object(l.A)({questionnaire_survey_addr:e}).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&e.data&&(t.questionnaireSurvey=e.data,t.initFormData())}))},initFormData:function(){var t={};this.questionnaireSurvey.collection_content&&this.questionnaireSurvey.collection_content.length&&this.questionnaireSurvey.collection_content.forEach((function(e){"checkbox"===e.field_type?t[e.filed_id]=[]:(e.field_type,t[e.filed_id]="")})),this.formData=t},getOptionsById:function(t){return this.questionnaireSurvey.options&&this.questionnaireSurvey.options.length?this.questionnaireSurvey.options.filter((function(option){return option.filed_id===t})).sort((function(a,b){return(a.sort||0)-(b.sort||0)})):[]},show:function(t){this.next=t,this.questionnaireInfo.questionnaire_addr||this.isPermanent&&this.questionnaireInfo.resident_questionnaire_addr?this.dialogVisible=!0:this.next&&this.next()},handleDialogClosed:function(){this.initFormData(),this.$refs.feedbackForm&&this.$refs.feedbackForm.resetFields(),this.isPermanent||this.tellApiNotShow(),this.next&&this.next(),this.dialogVisible=!1},tellApiNotShow:function(){var t=this;if(!this.hasApi&&this.questionnaireInfo.questionnaire_addr){var e={questionnaire_addr:this.questionnaireInfo.questionnaire_addr,options:this.questionnaireSurvey.options,qus_type:1};this.characterInfo.id&&(e.character_id=this.characterInfo.id),Object(l.fb)(e).catch((function(t){console.error("通知后端不再弹框失败",t)})).finally((function(){t.hasApi=!0}))}},validateForm:function(){var t=this,e=!0;return this.questionnaireSurvey.collection_content.forEach((function(n){if(n.is_required){var o=t.formData[n.filed_id];("checkbox"!==n.field_type||o&&0!==o.length)&&("radio"!==n.field_type&&"input"!==n.field_type&&"textarea"!==n.field_type||o)||(e=!1)}})),e},submitFeedback:function(){var t=this;if(this.hasInput)if(this.loading)this.$message.warning(this.$t("error_code_10601"));else if(this.validateForm()){var e=[];this.questionnaireSurvey.collection_content&&this.questionnaireSurvey.collection_content.length&&this.questionnaireSurvey.collection_content.forEach((function(n){var o=t.formData[n.filed_id];void 0!==o&&""!==o&&e.push({answer_val:Array.isArray(o)?o.join(","):String(o),desc:n.desc,field_type:n.field_type,filed_id:n.filed_id,is_required:n.is_required})}));var n={questionnaire_addr:this.isPermanent?this.questionnaireInfo.resident_questionnaire_addr:this.questionnaireInfo.questionnaire_addr,collection_content:e,options:this.questionnaireSurvey.options,qus_type:this.isPermanent?3:1};this.characterInfo.id&&(n.character_id=this.characterInfo.id),this.loading=!0,Object(l.fb)(n).then((function(e){var n;1e4===(null===(n=e.status)||void 0===n?void 0:n.code)&&t.$message.success(t.$t("aiChatSubSuccess"))})).catch((function(e){console.error("提交反馈失败",e),t.$message.error(t.$t("SaveFailed"))})).finally((function(){t.hasApi=!0,t.loading=!1,t.dialogVisible=!1,t.next&&t.next()}))}else this.$message.warning(this.$t("tavern33"));else this.$message.warning(this.$t("pleaseEnte"))},handleCheckboxClick:function(t,e){var n=this.formData[t].indexOf(e);-1===n?this.formData[t].push(e):this.formData[t].splice(n,1)},handleQuickInput:function(t){var e=Object.keys(this.formData)[0];e&&(this.formData[e].length+t.length+2>this.MAX_LENGTH||(this.formData[e]=""===this.formData[e]?t:"".concat(this.formData[e],", ").concat(t),this.$nextTick((function(){var t,textarea=null===(t=document)||void 0===t?void 0:t.querySelector(".permanent-textarea .el-textarea__inner");if(textarea){var e=new Event("input",{bubbles:!0});textarea.dispatchEvent(e),setTimeout((function(){textarea.focus(),textarea.setSelectionRange(textarea.value.length,textarea.value.length),textarea.scrollTop=textarea.scrollHeight}),0)}}))))}}},m=(n(4021),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{visible:t.dialogVisible,width:"729px","custom-class":t.isPermanent||1===t.questionnaireInfo.questionnaire_type?"feedback-dialog feedback-quest-jian-yi":"feedback-dialog","close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,"append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.handleDialogClosed},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{staticClass:"dialog-title"},[e("span",{staticClass:"title-text"},[t._v(t._s(t.title))]),t._v(" "),e("i",{staticClass:"close-btn el-icon-close",on:{click:function(e){t.dialogVisible=!1}}})])]},proxy:!0}])},[t._v(" "),Object.keys(t.questionnaireSurvey).length?e("div",{staticClass:"dialog-content"},[t.desc?e("div",{staticClass:"thank-text"},[t._v("\n        "+t._s(t.htmlToPlainText(t.desc))+"\n      ")]):t._e(),t._v(" "),e("el-form",{ref:"feedbackForm",attrs:{model:t.formData,"label-position":"top"}},t._l(t.questionnaireSurvey.collection_content,(function(n,o){return e("div",{key:"question-"+o,staticClass:"question-item"},[e("div",{class:["label",n.is_required?"required":"",n.filed_id.includes("Email")?"email-label":""]},[t._v("\n            "+t._s(n.desc||"")+"\n            "),t._v(" "),e("span",{staticClass:"multiple-tag",class:{"multiple-tag-email":n.filed_id.includes("Email")}},[t._v("["+t._s(t.$t("".concat(t.labelShow(n))))+"]")])]),t._v(" "),"radio"===n.field_type&&n.options.length?e("el-radio-group",{model:{value:t.formData[n.filed_id],callback:function(e){t.$set(t.formData,n.filed_id,e)},expression:"formData[item.filed_id]"}},t._l(n.options,(function(option){return e("div",{key:option.filed_id,staticClass:"option-item radio-wrapper"},[e("el-radio",{attrs:{label:option.filed_id}},[t._v(t._s(option.desc))])],1)})),0):"checkbox"===n.field_type&&n.options.length?e("el-checkbox-group",{model:{value:t.formData[n.filed_id],callback:function(e){t.$set(t.formData,n.filed_id,e)},expression:"formData[item.filed_id]"}},t._l(n.options,(function(option){return e("div",{key:option.filed_id,staticClass:"option-item checkbox-wrapper"},[e("el-checkbox",{attrs:{label:option.filed_id}},[t._v(t._s(option.desc))])],1)})),0):["input","textarea"].includes(n.field_type)?e("el-input",{class:{"permanent-textarea":t.isPermanent},attrs:{placeholder:t.$t("pleaseEnte"),type:n.field_type||"text",autosize:{minRows:t.isPermanent?5:3,maxRows:t.isPermanent?5:4},maxlength:t.isPermanent?t.MAX_LENGTH:void 0,"show-word-limit":t.isPermanent},model:{value:t.formData[n.filed_id],callback:function(e){t.$set(t.formData,n.filed_id,e)},expression:"formData[item.filed_id]"}}):t._e()],1)})),0),t._v(" "),t.notice?e("div",{staticClass:"privacy-notice"},[t._v("\n        "+t._s(t.notice)+"\n      ")]):t._e(),t._v(" "),t.isPermanent?e("div",{staticClass:"quick-input-container"},[e("p",{staticClass:"quick-input-title"},[t._v(t._s(t.$t("szr_fb_title01")))]),t._v(" "),e("div",{staticClass:"quick-input-box"},t._l(t.QUICK_INPUT_ITEMS,(function(n){return e("span",{key:n.key,on:{click:function(e){t.handleQuickInput(t.$t(n.label))}}},[t._v("\n            "+t._s(t.$t(n.label))+"\n          ")])})),0)]):t._e()],1):t._e(),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{class:{"cancel-btn-jianyi":t.isPermanent},attrs:{type:t.isPermanent?"primary":"cancel"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{class:{"btn-jianyi":1===t.questionnaireInfo.questionnaire_type||t.isPermanent,"has-input":t.hasInput},attrs:{type:"primary",disabled:!t.hasInput},on:{click:t.submitFeedback}},[t._v(t._s(t.$t("Submit")))])],1)])],1)}),[],!1,null,null,null);e.a=component.exports},900:function(t,e,n){"use strict";var o=n(48),r={props:{isSkip:{type:Boolean,default:!0}},data:function(){return{}},mounted:function(){},computed:{isZhCN:function(){return"zhCN"===this.$i18n.locale}},methods:{login:function(t){var e="login"===t?"click_login_button":"click_register_button";this.logEvent(e),Object(o.q)()?window.open("/home","_self"):this.$EventBus.$emit("openLoginDialog",{redirect:this.isSkip?"/home":""})},toDiscord:function(){this.logEvent("click_dc_button"),window.open("https://discord.com/invite/gUHDU644vU","_blank")},toEnterprise:function(){this.logEvent("click_pro_button"),window.open("/businessPage","_self")},openChatDialog:function(){this.logEvent("click_qqwx_button"),this.$EventBus.$emit("openJoinGroupModal","")},logEvent:function(t){this.$logEvent("log_actions",{operation:t,behavior_info:"visitor_landing_page"})}}},c=(n(4138),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"landing-page-header"},[e("div",{staticClass:"left-container"},[e("img",{staticClass:"logo",attrs:{src:n(275),alt:"SeaArt AI"}}),t._v(" "),e("span",{staticClass:"slogan"},[t._v(t._s(t.$t("SeaArt")))]),t._v(" "),e("span",{staticClass:"ai"},[t._v(".AI")])]),t._v(" "),e("div",{staticClass:"right-container"},[t.isZhCN?e("div",{staticClass:"chat-app",on:{click:t.openChatDialog}},[e("i",{staticClass:"iconfont icon-users-solid"}),t._v(" "),e("span",{staticClass:"words"},[t._v("QQ、微信交流")])]):e("div",{staticClass:"discord",on:{click:t.toDiscord}},[e("img",{staticClass:"discord-icon",attrs:{alt:"discord-icon",src:n(744)}}),t._v(" "),e("span",{staticClass:"words"},[t._v("Discord")])]),t._v(" "),e("el-button",{staticClass:"sign-up",on:{click:function(e){return t.login("register")}}},[t._v("\n      "+t._s(t.$t("Register"))+"\n    ")]),t._v(" "),e("el-button",{staticClass:"log-in",on:{click:function(e){return t.login("login")}}},[t._v("\n      "+t._s(t.$t("Login"))+"\n    ")])],1)])}),[],!1,null,"51a2a04e",null);e.a=component.exports},910:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),c=(n(20),n(19),n(16),n(26),n(48)),l=n(38),d=n(279),h=n(1);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"AiChatByDetails",components:{AiChatCreateConfirm:d.a},props:{chatObj:{type:Object,default:function(){return{}}}},data:function(){return{invitationTitle:"chatTip".concat(this.getRandomNumber()),showChatTip:!1,hideChatTip:!1,timer:null,hide:!1}},computed:f(f(f({},Object(h.c)("user",["isLoggedIn","isCompanyAccount"])),Object(h.e)("user",["userInfo"])),{},{showIconAlways:function(){var t,e;return!this.isLoggedIn||!Object(c.a)(this)&&(null===(t=this.chatObj)||void 0===t?void 0:t.id)&&!this.hideIcon&&!this.isCompanyAccount&&1!==(null===(e=this.chatObj)||void 0===e?void 0:e.nsfw)},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},hideIcon:function(){var t;return this.greenMode&&[2,"2"].includes(null===(t=this.chatObj)||void 0===t?void 0:t.green)}}),watch:{showChatTip:function(t){var e=this;this.timer&&clearTimeout(this.timer),this.timer2&&clearTimeout(this.timer2),this.timer2=t?setTimeout((function(){e.showChatTip=!1,e.hideChatTip=!0,e.timer2&&clearTimeout(e.timer2)}),5e3):null}},methods:{handleConfirm:function(){this.startCreateChater()},getRandomNumber:function(){return Math.floor(20*Math.random())+1},isExceedance:function(){var t=localStorage.getItem("lastTriggerTime"),e=(new Date).getTime();(!t||e-t>864e5)&&(localStorage.setItem("lastTriggerTime",e),localStorage.setItem("triggerCount",0));var n=parseInt(localStorage.getItem("triggerCount"));n<3&&(this.initMsgBox(),n++,localStorage.setItem("triggerCount",n))},initMsgBox:function(){var t,e=this;null!==(t=this.chatObj)&&void 0!==t&&t.id&&(this.invitationTitle="chatTip".concat(this.getRandomNumber()),this.timer=setTimeout((function(){e.showChatTip=!0}),3e3))},isCanChat:function(){var t;null!==(t=this.chatObj)&&void 0!==t&&t.id},handleClickChat:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$logEvent("log_actions",{operation:"go_to_one_click_chat",behavior_info:"on_work_detail_page"}),n.next=3,Object(l.S)({channel:"artwork",source_id:null===(o=e.chatObj)||void 0===o?void 0:o.id});case 3:r=n.sent,c=(null==r?void 0:r.data)||{},d=c.character_id,(h=void 0===d?"":d)?e.startCreateChater(h):e.$refs.aiChatCreateConfirm.show(),t&&t(null==r?void 0:r.data);case 7:case"end":return n.stop()}}),n)})))()},startCreateChater:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c,d,h,v,f,m,_,y,w,C,k,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.chatObj)&&void 0!==n&&n.id){e.next=3;break}return e.abrupt("return");case 3:return y={height:(null===(o=t.chatObj)||void 0===o?void 0:o.cover_height)||(null===(r=t.chatObj)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.height),width:(null===(c=t.chatObj)||void 0===c?void 0:c.cover_width)||(null===(d=t.chatObj)||void 0===d||null===(d=d.banner)||void 0===d?void 0:d.width),id:null===(h=t.chatObj)||void 0===h?void 0:h.id,url:(null===(v=t.chatObj)||void 0===v?void 0:v.cover)||(null===(f=t.chatObj)||void 0===f||null===(f=f.banner)||void 0===f?void 0:f.url),source_account_id:null===(m=t.chatObj)||void 0===m||null===(m=m.author)||void 0===m?void 0:m.id},e.next=6,Object(l.S)({channel:"artwork",source_id:y.id});case 6:if(w=e.sent,C=(null==w?void 0:w.data)||{},k=C.can,2!==(void 0===k?2:k)){e.next=11;break}return t.$message.warning(t.$t("chatFail")),e.abrupt("return");case 11:if(localStorage.setItem("createParams",JSON.stringify(y)),O="/cyberPubPage/".concat(null===(_=t.chatObj)||void 0===_?void 0:_.id,"?quickChat=true&redirect=").concat(t.$route.fullPath),t.isLoggedIn){e.next=18;break}return t.$EventBus.$emit("openLoginDialog",{redirect:t.localePath(O)}),e.abrupt("return");case 18:t.$router.push(t.localePath(O));case 19:t.$emit("onConfirm");case 20:case"end":return e.stop()}}),e)})))()}},beforeDestroy:function(){this.timer&&clearTimeout(this.timer),this.timer2&&clearTimeout(this.timer2)},mounted:function(){this.isExceedance()}},_=(n(4835),n(0)),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.showIconAlways,expression:"showIconAlways"}],staticClass:"ai-chat-by-details"},[e("div",{staticClass:"ai-chat-by-details-btn",on:{click:function(e){return e.stopPropagation(),t.handleClickChat.apply(null,arguments)}}},[e("img",{staticClass:"bubble",attrs:{src:n(1043),alt:"chatIcon"}}),t._v(" "),e("div",{staticClass:"msg-box",class:{"fade-in":t.showChatTip,"fade-out":t.hideChatTip}},[t._v(t._s(t.$t(t.invitationTitle)))])]),t._v(" "),e("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",on:{confirm:t.handleConfirm}})],1)}),[],!1,null,"5f0bd20e",null);e.a=component.exports},915:function(t,e,n){"use strict";n(16),n(18),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(11),n(72),n(19),n(24),n(65),n(21),n(1)),c=n(63),l=n(45),d=n(10),h=n(58),v=n(39),f=n(53);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"VideoInfo",mixins:[l.a],props:{authorInfo:{type:Object,default:function(){}},videoType:{type:Number,default:0},info:{type:Object,default:function(){}},tags:{type:Array,default:function(){return[]}}},components:{CollectPopover:c.default,BaseAvatar:f.default},computed:_(_(_(_({},Object(r.e)("user",["userInfo","token"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.c)("payment",["paymentInfo"])),{},{inviteCode:function(){var t;return(null===(t=this.userInfo)||void 0===t?void 0:t.invite_user_code)||""},determineSelfWork:function(){var t,e;return(null===(t=this.authorInfo)||void 0===t?void 0:t.id)===(null===(e=this.userInfo)||void 0===e?void 0:e.id)},allFollows:function(){if(this.authorInfo.follower_cnt)return this.authorInfo.follower_cnt>999?(this.authorInfo.follower_cnt/1e3).toFixed(1)+"k":this.authorInfo.follower_cnt},showReport:function(){return[0,1,2].includes(this.videoType)},videoTypeKey:function(){return 9===this.videoType?"ai_video":"lookbook"},videoDesc:function(){var t,e;return(null===(t=this.info)||void 0===t?void 0:t.description)||(null===(e=this.info)||void 0===e?void 0:e.desc)||""}}),filters:{formatNumberForeign:d.p},data:function(){return{formatTime:h.c,formatNumberForeign:d.p,popovervisible:!1,dotReportInfo:{view_domain:"",batch_id:"",action:"",obj_no:"",obj_type:5,negative_ids:[],category:"default"}}},mounted:function(){},methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.authorInfo)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))},handleFollow:function(){if(this.token){var t={0:"post",9:"ai_video"}[this.videoType]||"lookbook";this.setFollow(this.info,t)}else this.$EventBus.$emit("openLoginDialog")},handleLike:function(){this.$emit("infoDot","click_like"),this.setLike(this.info,this.videoTypeKey)},handleShare:function(){this.$emit("infoDot","click_share");var t=location.href+(this.inviteCode?"?u_code=".concat(this.inviteCode):"");this.$message.success(this.$t("CopiedURLToClipboard")),Object(d.g)(t)},handleMark:function(){this.isLoggedIn?this.setCollectData(this.videoData).includes("collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.videoData,this.videoTypeKey)):this.$refs.collectPopover.visible=!0:this.$EventBus.$emit("openLoginDialog")},handleTry:function(){if(this.isLoggedIn){var t={},path="",e=this.info,n=e.cover,o=n.height,r=n.width,c=n.url,l=e.template_id,d=e.template_url;1==this.videoType?(this.$logEvent("log_actions",{operation:"click_create_same_image",behavior_info:"on_show_me_detail_page"}),t={template_id:l,url:d,height:o,width:r,cover:c},path="ai-face-swap"):(t={template_id:l},path="ai-video-generator"),t=JSON.stringify(t),this.$router.push(this.localePath("/ai-tools/".concat(path,"?info=").concat(t)))}else this.$EventBus.$emit("openLoginDialog")},report:function(){var t=this;Object(v.t)({id:this.info.id,obj_type:5}).then((function(e){t.popovervisible=!1,t.$message({message:t.$t("ReportSuccess"),type:"success",duration:5e3})}))},tagClick:function(t){window.open(this.localePath("/tagInfo/ai-video/".concat(t.id)),"_blank")}}},w=(n(4989),n(0)),component=Object(w.a)(y,(function(){var t,e,n,o,r,c,l,d,h,v,f=this,m=f._self._c;return m("div",{staticClass:"video-info"},[m("div",{staticClass:"top-title w-full flex justify-between items-start"},[m("h1",{staticClass:"title text-no-wrap-2"},[f._v("\n      "+f._s((null===(t=f.info)||void 0===t?void 0:t.name)||(null===(e=f.info)||void 0===e?void 0:e.title)||"")+"\n    ")]),f._v(" "),[1,3].includes(f.videoType)?m("button",{staticClass:"button-try",on:{click:f.handleTry}},[f._v("\n      "+f._s(f.$t("Remix"))+"\n    ")]):f._e()]),f._v(" "),m("div",{staticClass:"user-btns flex justify-between items-center"},[f.authorInfo?m("div",{staticClass:"left flex"},[f.authorInfo?m("BaseAvatar",{staticStyle:{cursor:"pointer"},attrs:{"user-data":f.authorInfo,size:40,"data-event":"click_author_area","data-id":null===(n=f.authorInfo)||void 0===n?void 0:n.id},on:{click:f.jumpToOtherUser}}):f._e(),f._v(" "),m("div",{staticClass:"name flex flex-col",attrs:{"data-event":"click_author_area","data-id":null===(o=f.authorInfo)||void 0===o?void 0:o.id},on:{click:f.jumpToOtherUser}},[m("a",{staticClass:"personal-info-a",attrs:{href:f.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[f._v("\n          "+f._s(f.authorInfo.name||f.authorInfo.id)+"\n        ")]),f._v(" "),m("span",{directives:[{name:"show",rawName:"v-show",value:f.authorInfo.follower_cnt,expression:"authorInfo.follower_cnt"}]},[f._v(f._s(f.allFollows+" "+f.$t("Followers")))])]),f._v(" "),f.determineSelfWork?f._e():m("el-button",{staticClass:"follow",attrs:{loading:f.followLoading,"data-event":"followed"===f.setFollowData(f.info)?"click_unfollow":"click_follow","data-id":null===(r=f.authorInfo)||void 0===r?void 0:r.id},on:{click:f.handleFollow}},[f._v("\n        "+f._s("followed"===f.setFollowData(f.info)?f.$t("Followed"):f.$t("Follow"))+"\n      ")])],1):f._e(),f._v(" "),m("div",{staticClass:"right"},[m("div",{staticClass:"line-2"},[m("div",{staticClass:"line-2-statistics"},[m("div",{staticClass:"item-statistics view"},[m("i",{staticClass:"iconfont icon-icon_Views"}),f._v(" "),m("span",[f._v(f._s(null===(c=f.info)||void 0===c||null===(c=c.stat)||void 0===c?void 0:c.num_of_view))])]),f._v(" "),m("div",{staticClass:"item-statistics",attrs:{"data-event":"waterfall-like","data-id":null===(l=f.info)||void 0===l?void 0:l.id,"data-info":JSON.stringify({isLiked:"icon-like"===f.setlikeData(f.info)})},on:{click:f.handleLike}},[m("i",{staticClass:"iconfont",class:f.setlikeData(f.info)}),f._v(" "),m("span",[f._v(f._s(null===(d=f.info)||void 0===d||null===(d=d.stat)||void 0===d?void 0:d.num_of_like))])])]),f._v(" "),m("div",{staticClass:"line-2-share",attrs:{"data-event":"click_share_btn"},on:{click:f.handleShare}},[m("i",{staticClass:"iconfont icon-share-icon"})]),f._v(" "),f.showReport?m("el-popover",{ref:"myPopover",attrs:{placement:"top-start","popper-class":"my-popover","visible-arrow":!1,width:"100",trigger:"manual"},model:{value:f.popovervisible,callback:function(t){f.popovervisible=t},expression:"popovervisible"}},[m("div",{staticClass:"pop-btns flex"},[m("button",{on:{click:f.report}},[f._v("\n              "+f._s(f.$t("Report"))+"\n            ")])]),f._v(" "),m("div",{staticClass:"line-2-share",staticStyle:{color:"#f1f1f1"},attrs:{slot:"reference"},on:{click:function(t){t.stopPropagation(),f.popovervisible=!f.popovervisible}},slot:"reference"},[m("i",{staticClass:"iconfont icon-more"})])]):f._e()],1)])]),f._v(" "),m("div",{staticClass:"bottom-info"},[m("div",{staticClass:"times"},[f._v("\n      "+f._s(f._f("formatNumberForeign")(null===(h=f.info)||void 0===h||null===(h=h.stat)||void 0===h?void 0:h.num_of_view))+"\n      "+f._s(f.$t("watchNum"))+" "+f._s(f.formatTime(null===(v=f.info)||void 0===v?void 0:v.create_at))+"\n    ")]),f._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:f.videoDesc,expression:"videoDesc"}],staticClass:"description text-no-wrap-2"},[f._v("\n      "+f._s(f.videoDesc)+"\n    ")]),f._v(" "),m("div",{staticClass:"video-tags"},f._l(f.tags,(function(t){return m("div",{key:t.id,staticClass:"item-tag flex-center"},[m("a",{attrs:{target:"_self",href:"/tagInfo/ai-video/"+t.id},on:{click:function(e){return e.preventDefault(),f.tagClick(t)}}},[f._v("#"+f._s((null==t?void 0:t.title)||(null==t?void 0:t.id)))])])})),0)])])}),[],!1,null,"13a74a66",null);e.a=component.exports;installComponents(component,{BaseAvatar:n(53).default})},916:function(t,e,n){"use strict";n(24);var o=n(116),r={name:"VideoComments",props:{videoType:{type:Number,default:0},videoInfo:{type:Object,default:function(){}}},components:{CmtComments:o.default},computed:{},data:function(){return{}},created:function(){},mounted:function(){},methods:{}},c=(n(4990),n(0)),component=Object(c.a)(r,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"video-comments"},[null!==(t=e.videoInfo)&&void 0!==t&&t.id?n("CmtComments",{attrs:{infos:e.videoInfo,type:9===e.videoType?15:5}}):e._e()],1)}),[],!1,null,"a9965962",null);e.a=component.exports;installComponents(component,{CmtComments:n(116).default})},917:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1),c=n(10),l=n(938);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"VideoAiPerson",mixins:[n(45).a],props:{personData:{type:Array,default:function(){return[]}}},components:{PersonInfo:l.a},computed:h(h({},Object(r.c)("user",["isLoggedIn"])),{},{personInfo:function(){return this.personData.length?this.personData[0]:{}}}),data:function(){return{formatNumberForeign:c.p}},mounted:function(){},methods:{goChatDetail:function(){var t;this.isLoggedIn?this.$router.push(this.localePath("/cyberPubPage/".concat(null===(t=this.personInfo)||void 0===t?void 0:t.id))):this.$EventBus.$emit("openLoginDialog")},goChat:function(){var t;this.isLoggedIn?(this.$logEvent("log_actions",{operation:"click_go_to_chat",behavior_info:"on_ai_video_detail_page"}),this.$router.push(this.localePath("/aiChat/".concat(null===(t=this.personInfo)||void 0===t?void 0:t.id)))):this.$EventBus.$emit("openLoginDialog")},goTag:function(t){}}},f=(n(4992),n(0)),component=Object(f.a)(v,(function(){var t,e,n,o,r,c,l=this,d=l._self._c;return d("div",{staticClass:"ai-person"},[null!==(t=l.personInfo)&&void 0!==t&&t.id?d("div",{staticClass:"video-Ai-Person",on:{click:l.goChat}},[d("div",{staticClass:"bg-cover w-full"}),l._v(" "),d("div",{staticClass:"bg-hold w-full"},[d("img",{directives:[{name:"webp",rawName:"v-webp",value:l.$imgL,expression:"$imgL"}],attrs:{src:null===(e=l.personInfo)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url,alt:"cover",loading:"lazy",width:"425",height:"58"}})]),l._v(" "),d("div",{staticClass:"content flex"},[d("div",{staticClass:"left-img",on:{click:function(t){return t.stopPropagation(),l.goChatDetail.apply(null,arguments)}}},[d("img",{directives:[{name:"webp",rawName:"v-webp",value:l.$imgL,expression:"$imgL"}],attrs:{src:null===(n=l.personInfo)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url,alt:"cover",loading:"lazy",width:"114",height:"162"}})]),l._v(" "),d("div",{staticClass:"right-content flex flex-col"},[d("div",{staticClass:"right-top flex justify-between"},[l.personInfo.author?d("PersonInfo",{attrs:{authorInfo:l.personInfo.author,fontStyle:{fontSize:"14px",color:"#FFFFFF",fontWeight:500},headStyle:{width:"28px",height:"28px",borderRadius:"50%",border:"1px solid #ffffff"}}}):l._e(),l._v(" "),d("div",{staticClass:"right-btns flex"},[d("div",{staticClass:"btns-item"},[d("i",{staticClass:"iconfont icon-users-solid imgBox-num-item-icon"}),l._v(" "),d("span",{staticClass:"imgBox-num-item-text"},[l._v("\n                "+l._s(l.formatNumberForeign((null===(o=l.personInfo)||void 0===o||null===(o=o.stat)||void 0===o?void 0:o.num_of_token)||0))+"\n              ")])]),l._v(" "),d("div",{staticClass:"btns-item",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),l.setCollect(l.personInfo,"character")}}},[d("div",{staticClass:"imgBox-num-item-icon"},[d("i",{staticClass:"iconfont",class:l.setCollectData(l.personInfo)})]),l._v(" "),d("span",{staticClass:"imgBox-num-item-text"},[l._v("\n                "+l._s(l.formatNumberForeign((null===(r=l.personInfo)||void 0===r||null===(r=r.stat)||void 0===r?void 0:r.num_of_collection)||0))+"\n              ")])])])],1),l._v(" "),d("div",{staticClass:"right-middle flex flex-col"},[d("div",{staticClass:"desc text-no-wrap-2"},[l._v(l._s(l.personInfo.evaluation))]),l._v(" "),null!==(c=l.personInfo)&&void 0!==c&&null!==(c=c.categories)&&void 0!==c&&c.length?d("div",{staticClass:"tags flex"},l._l(l.personInfo.categories,(function(t,e){return d("span",{key:"tag"+e,staticClass:"tag",on:{click:function(e){return l.goTag(t)}}},[l._v(l._s(t.name))])})),0):l._e()]),l._v(" "),d("div",{staticClass:"right-bottom flex"},[d("span",{staticClass:"go-to-person flex"},[l._v("\n            "+l._s(l.$t("goChat"))+"\n          ")])])])])]):l._e()])}),[],!1,null,"7716b7d7",null);e.a=component.exports},918:function(t,e,n){"use strict";n(18),n(19),n(24),n(4),n(28),n(44),n(26);var video=n(683),o=n(10),r=n(938),c={name:"VideoRelated",mixins:[n(45).a],props:{videoType:{type:Number,default:0},objType:{type:Number,default:5},isAudioBook:{type:Boolean,default:!1}},components:{PersonInfo:r.a},computed:{videoTime:function(){return function(t){var e;return null==t||null===(e=t.look_book)||void 0===e?void 0:e.duration}},isAiVideo:function(){return 9===this.videoType},isRotate:function(){var t=this;return function(e){return!(t.isAiVideo&&!t.isAudioBook)&&(null==e?void 0:e.cover_width)<(null==e?void 0:e.cover_height)}},dotSource:function(){return this.isAudioBook?"audio_book":this.isAiVideo?"ai_short":"lookbook"}},data:function(){return{timeFormat:o.U,formatNumberForeign:o.p,iconLoad:!1,videoList:[],loading:!1}},methods:{getVideoRelated:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.$route.params.id;if(n){var p={obj_id:n,obj_type:this.objType,page_size:20};e&&(p.scene="click_change"),this.loading=!0,Object(video.a)(p).then((function(e){var n;t.videoList=(null==e||null===(n=e.data)||void 0===n?void 0:n.items)||[],t.videoList[0]&&t.$emit("nextVideo",t.videoList[0].id)})).finally((function(){t.loading=!1}))}},changeData:function(){this.$logEvent("log_actions",{operation:"click_switch",behavior_info:"on_ai_video_detail_page",behavior_info_sub:this.$route.params.id,source:this.dotSource}),this.setIconLoad(),this.getVideoRelated(!0)},setIconLoad:function(){var t=this;this.iconLoad=!0;var e=setTimeout((function(){t.iconLoad=!1,clearTimeout(e)}),500)},toVideo:function(t){var path=5===this.objType?"/video/":"/ai-video/detail/";this.$router.replace(this.localePath("".concat(path).concat(null==t?void 0:t.id)))}}},l=c,d=(n(4993),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"video-related"},[e("div",{staticClass:"top flex justify-between items-center"},[e("div",{staticClass:"name"},[t._v(t._s(t.$t("relatedRecommend")))]),t._v(" "),e("div",{staticClass:"btn",attrs:{"data-event":"click_changeit"},on:{click:t.changeData}},[e("i",{staticClass:"iconfont icon-changeit",class:{iconLoad:t.iconLoad}}),t._v("\n      "+t._s(t.$t("changeit"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"video-cards"},t._l(t.videoList,(function(n,o){var r,c,l,d;return e("div",{key:"r_"+(null==n?void 0:n.id)+o,staticClass:"card",on:{click:function(e){return t.toVideo(n)}}},[e("div",{staticClass:"cover-img"},[t.videoTime(n)?e("div",{staticClass:"time-tag"},[t._v("\n          "+t._s(t.timeFormat(t.videoTime(n)))+"\n        ")]):t._e(),t._v(" "),null!=n&&n.cover?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],staticClass:"img-cover",class:{rotate:t.isRotate(n)},attrs:{src:null==n?void 0:n.cover,width:"190",height:"107",loading:"lazy",alt:"img-cover"}}):t._e()]),t._v(" "),e("div",{staticClass:"right-info flex flex-col justify-between"},[e("div",{staticClass:"upper flex flex-col"},[e("div",{staticClass:"title text-no-wrap-2"},[t._v("\n            "+t._s((null==n||null===(r=n.look_book)||void 0===r?void 0:r.name)||(null==n||null===(c=n.ai_video)||void 0===c?void 0:c.title))+"\n          ")]),t._v(" "),t.isAiVideo?e("div",{staticClass:"imgNum"},[e("span",[t._v(t._s(t.$t("episodeNum",{num:(null==n||null===(l=n.ai_video)||void 0===l?void 0:l.max_episode)||0})))])]):t._e(),t._v(" "),n.author&&!t.isAiVideo?e("PersonInfo",{attrs:{authorInfo:n.author,headStyle:{width:"20px",height:"20px",borderRadius:"50%"}}}):t._e()],1),t._v(" "),e("div",{staticClass:"down"},[e("div",{staticClass:"btns-item"},[e("i",{staticClass:"iconfont icon-icon_Views"}),t._v(" "),e("span",{staticClass:"imgBox-num-item-text"},[t._v("\n              "+t._s(t.formatNumberForeign((null==n||null===(d=n.stat)||void 0===d?void 0:d.num_of_view)||0))+"\n            ")])])])])])})),0)])}),[],!1,null,"4a6e09e4",null);e.a=component.exports},920:function(t,e,n){"use strict";n(16),n(18),n(11),n(12),n(13),n(8),n(7);var o=n(14),r=n(2),c=(n(19),n(6),n(32),n(22),n(4),n(1)),l=n(63),d=n(9);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"soundItem",components:{AudioPlayer:n(256).a,CollectPopover:l.default},data:function(){return{playIconCustomStyle:{position:"absolute",right:"11px",bottom:"9px",zIndex:"999"}}},props:{showHandle:{type:Boolean,default:!0},item:{type:Object,default:function(){}},imgStyle:{type:String,default:"contain"},domId:{type:String,default:""}},computed:v(v({},Object(c.c)("user",["isLoggedIn"])),{},{imgUrl:function(){var t=this.item||{},e="";return t.cover?e=t.cover:t.cover.cover?e=t.cover.cover:e},selfTag:function(){var t,e,n=[];null!==(t=this.item)&&void 0!==t&&null!==(t=t.tags)&&void 0!==t&&t.length&&(n=null===(e=this.item)||void 0===e?void 0:e.tags.map((function(t){return t.title})));return n},attrTags:function(){var t=this,e=[];if(this.item){var n,r,c,l=[],h=[],v=[];if(this.item.gender){var f=d.I.filter((function(e){return e.value===t.item.gender}))||[];f.length&&h.push(f[0].i18Key)}if(this.item.age){var m=d.I.filter((function(e){return e.value===t.item.age}))||[];m.length&&l.push(m[0].i18Key)}if(null!==(n=this.item)&&void 0!==n&&n.tones&&null!==(r=this.item)&&void 0!==r&&r.tones.length)v=null===(c=this.item)||void 0===c?void 0:c.tones.map((function(t){var e=d.I.find((function(e){return e.value===t}));return e?e.i18Key:""}));return e=[].concat(l,h,Object(o.a)(v))}return e}}),methods:{handleClickCollect:function(t){var e=this;this.$logEvent("log_actions",{operation:"click_quick_collect",behavior_info:"on_choose_audio_popup"}),this.isLoggedIn||(t.stopPropagation(),this.$EventBus.$emit("openLoginDialog",{callBack:function(){return e.$emit("newChat")}}))},handleDetail:function(){this.$logEvent("log_actions",{operation:"click_detail",behavior_info:"on_choose_audio_popup"});var t=this.localePath("/ai-audio/detail/".concat(this.item.id));window.open(t,"_blank")}}},m=(n(4998),n(0)),component=Object(m.a)(f,(function(){var t,e,n,o,r,c,l=this,d=l._self._c;return d("div",{staticClass:"sound-item",on:{click:function(t){return l.$emit("handleSelect")}}},[l._t("default"),l._v(" "),l.showHandle?d("div",{staticClass:"cltpop",on:{click:function(t){t.stopPropagation()}}},[d("div",{staticClass:"collect-popover-container",on:{click:function(t){return t.stopPropagation(),l.handleClickCollect.apply(null,arguments)}}},[d("CollectPopover",{attrs:{type:"ai_audio",folder:l.item,from:"waterfall"}})],1),l._v(" "),d("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),l.handleDetail(l.item)}}},[l._v("\n      "+l._s(l.$t("Details"))+"\n    ")])]):l._e(),l._v(" "),d("div",{staticClass:"left"},[d("AudioPlayer",{attrs:{logParams:{operation:"click_audition",behavior_info:"on_voice_select_pop",behavior_info_sub:"vioce_name=".concat(null===(t=l.item)||void 0===t?void 0:t.name)},domId:l.domId,modelPlay:"",playIconCustomStyle:l.playIconCustomStyle,item:l.item}}),l._v(" "),["",null,void 0].includes(null===(e=l.item)||void 0===e?void 0:e.cover)?[d("div",{staticClass:"image-empty-sound"},[l._v(l._s(l.$t("EmptyBannerText")))])]:[d("el-image",{staticClass:"list-item-image-card-image",attrs:{fit:l.imgStyle,src:null===(n=l.item)||void 0===n?void 0:n.cover}},[d("template",{slot:"error"},[d("img",{directives:[{name:"webp",rawName:"v-webp",value:l.$imgL,expression:"$imgL"}],staticClass:"error-img",staticStyle:{width:"110px",height:"110px","border-radius":"8px"},attrs:{src:null===(o=l.item)||void 0===o?void 0:o.cover,alt:null===(r=l.item)||void 0===r?void 0:r.name}})])],2)]],2),l._v(" "),d("div",{staticClass:"right",style:{justifyContent:l.attrTags.length||l.selfTag.length?"center":"flex-start"}},[d("div",{staticClass:"right-name",style:{marginTop:l.attrTags.length||l.selfTag.length?"0px":"10px"}},[l._v("\n      "+l._s(null===(c=l.item)||void 0===c?void 0:c.name)+"\n    ")]),l._v(" "),d("div",{staticClass:"right-tags"},[l.attrTags.length?l._l(l.attrTags,(function(t,e){return d("div",{key:t+e,staticClass:"tag-item"},[l._v("\n          "+l._s(l.$t(t))+"\n        ")])})):l._e(),l._v(" "),l.selfTag.length?l._l(l.selfTag,(function(t,e){return d("div",{key:t+e,staticClass:"tag-item"},[l._v("\n          "+l._s(t)+"\n        ")])})):l._e()],2)])],2)}),[],!1,null,"825e5212",null);e.a=component.exports;installComponents(component,{CollectPopover:n(63).default})},927:function(t,e,n){"use strict";n(16),n(18),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(6),n(50),n(22),n(31),n(4),n(28),n(21),n(140),n(44),n(26),n(10)),c=n(1),l=n(63),d=n(45),h=n(39),v=n(112),f=n(111),m=n(144),_=n(9),y=n(80),w=n(27),C=n(53),k=n(200),O=n(108),x=n(276),I=n(278);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={mixins:[d.a],components:{CollectPopover:l.default,ImgWaterFall:v.default,AdminTag:f.default,ShareDialog:m.default,BaseAvatar:C.default,DownloadVideoPop:k.default,HyColorfulBorder:O.default,HyMoreBtn:x.default,HyJewelryModal:I.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},review:{type:Boolean,default:!1},sysTag:{type:Object,default:function(){}},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}}},computed:D(D(D(D(D(D({},Object(c.c)("user",["isLoggedIn","accountSettingsData","isCompanyAccount"])),Object(c.e)("user",["userInfo","adminOff"])),Object(c.e)("payment",["productLevel"])),Object(c.c)(["videoHasVoice"])),Object(c.e)("app",["ABInfo"])),{},{isShowNewDownload:function(){var t;return 7==(null===(t=this.item)||void 0===t?void 0:t.type)&&"userPage"==this.fromPage&&this.isMine},isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},inviteCode:function(){var t;return(null===(t=this.userInfo)||void 0===t?void 0:t.invite_user_code)||""},isPC:function(){return"PC"===localStorage.getItem("visitFrom")},setNsfwPlus:function(){return function(t){return null==t?void 0:t.nsfw_plus}},isWorkFlowAppDetail:function(){return this.$route.name.includes("workFlowAppDetail")},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)}}),data:function(){return{copyTextToClipboard:r.g,saveImg:r.M,formatNumberForeign:r.p,itemShow:!1,itemShowId:"",collectDotReportInfo:{},from:"waterfall",cntShow:!0,otherShow:!1,workfolwAppLoading:!1,showVideo:!1,jewelryModalVisible:!1}},mounted:function(){var t=this;setTimeout((function(){t.otherShow=!0}),200)},methods:{handleSound:function(){this.$logEvent("log_actions",{operation:this.videoHasVoice?"click_mute":"click_unmute",behavior_info:"on_video_create_flow_page"}),this.$store.commit("app/SET_VIDEO_HAS_VOICE",!this.videoHasVoice)},onPlay:function(){var t=this;this.showVideo=!0,this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.mainVideo)||void 0===e||e.play()}))},onPause:function(){var t=this;this.showVideo=!1,this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.mainVideo)||void 0===e||e.pause()}))},goWorkfolwApp:function(t){var e,n=this;if(!this.isLoggedIn)return this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"click_same_create",behavior_info_sub:(null===(e=this.dotReportInfo)||void 0===e?void 0:e.view_domain)||""}),void this.$EventBus.$emit("openLoginDialog");this.isWorkFlowAppDetail?this.$EventBus.$emit("$_workDetailRemix",{artwork_id:t.id}):this.workfolwAppLoading||(this.workfolwAppLoading=!0,Object(y.h)({artwork_id:t.id}).then((function(e){1e4==e.status.code&&n.$router.replace(n.localePath("/workFlowAppDetail/".concat(e.data.id,"?task=mix-").concat(t.id)))})).finally((function(){n.workfolwAppLoading=!1})))},isVideoLink:r.G,handleMouseUp:function(t,e){if(2===t.which||1===t.button){var n=this.list.findIndex((function(i){return i.id===e.id})),o=(n<10?this.list.slice(0,n):this.list.slice(n-10,n)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(h.i)({items:[D(D({},this.dotReportInfo),{},{negative_ids:o,action:"view",obj_no:e.id,obj_type:1,batch_id:null==e?void 0:e.pt,stat:null==e?void 0:e.stat},this.productLevel&&{vip:this.productLevel})]})}},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=D(D({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:1})},checkGreen:function(t){return!this.isLoggedIn&&!(null==t||!t.green||![2,"2"].includes(t.green))},handleDetail:function(t,e){var n,o,r=this.checkGreen(e);this.$logEvent("log_actions",{operation:"click_image",behavior_info:e.id,behavior_info_sub:r?"is_cover":"not_cover"});var c="string"==typeof t.target.className&&(null===(n=t.target.className)||void 0===n?void 0:n.includes("boxItem"))&&(null===(o=t.target.className)||void 0===o?void 0:o.includes("defBox"));if("IMG"===t.target.tagName||"VIDEO"===t.target.tagName||"cltpop"===t.target.className||c||"ImgWaterFall"===t.target.className||"green-mode-div"===t.target.className){if(1===e.nsfw)return void this.$message.warning(this.$t("workErrTip"));if(r)return void this.$EventBus.$emit("openLoginDialog",{redirect:"/explore/detail/"+e.id,dotCover:!0});var l=this.list.findIndex((function(i){return i.id===e.id})),d=(l<10?this.list.slice(0,l):this.list.slice(l-10,l)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(h.i)({items:[D(D({},this.dotReportInfo),{},{negative_ids:d,action:"view",obj_no:e.id,obj_type:1,batch_id:null==e?void 0:e.pt,stat:null==e?void 0:e.stat},this.productLevel&&{vip:this.productLevel})]}),this.$router.push(this.localePath("/explore/detail/"+e.id))}},handPlayDoor:function(t){var e=this,n=t.id,o=t.type,r=t.cover,c=[6,7].includes(o);this.$EventBus.$emit("showDialog",{name:"HyAssembleModal",data:{doorCode:c?"aiVideoApp":"aiImageApp",artWorkNo:n,workUrl:r,source:4,objType:1,onAfterAction:function(){e.$EventBus.$emit("hideDialog","HyAssembleModal")}}})},handleClick:function(t){var e;if(!this.isLoggedIn)return this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"click_same_create",behavior_info_sub:(null===(e=this.dotReportInfo)||void 0===e?void 0:e.view_domain)||""}),void this.$EventBus.$emit("openLoginDialog");if("face_swap"!=(null==t?void 0:t.sub_channel)){var n=this.list.findIndex((function(i){return i.id===t.id})),o=(n<10?this.list.slice(0,n):this.list.slice(n-10,n)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(h.i)({items:[D(D({},this.dotReportInfo),{},{negative_ids:o,action:"task",obj_no:t.id,obj_type:1,batch_id:null==t?void 0:t.pt,stat:null==t?void 0:t.stat},this.productLevel&&{vip:this.productLevel})]});var r=Object.assign({},t);r.taskSource=4,r.logEventSource=Object(_.Y)(this.$route.name);var c=t.id,l=t.obj_type,d=t.pt;this.$logEvent("log_actions",{operation:"same_create",behavior_info:c,obj_type:l,behavior_info_sub:d}),this.$EventBus.$emit("openGenerate",{action:1,data:{source:r}})}else this.$router.push(this.localePath({path:"/ai-tools/ai-face-swap",query:{artWorkNo:t.id}}))},downloadImg:function(t){var e=this.getImageExtensionFromUrl(t.cover),n=(t.author?t.id:"image")+"".concat(e);this.saveImg(t.cover,n)},getImageExtensionFromUrl:function(t){var e=t.match(/\/([^/]+)$/);return e&&e[1].includes(".")?"."+e[1].split(".").pop().toLowerCase():".jpeg"},moreActions:function(t,e){var n,o=this,r=this.item.obj_type;switch(t){case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item);break;case"flag":this.reportArtwork(e.id),e.propS=!1;break;case"save":this.downloadImg(e),e.propS=!1;break;case"appeal":this.$message({message:this.$t("appealSuccess"),type:"success"});break;case"share":this.$logEvent("log_actions",{operation:"click_share",behavior_info:"on_personal_center",behavior_info_sub:r}),this.sharevisible=!0,this.popTime=setTimeout((function(){o.sharevisible=!1}),1e3);var path="".concat(window.location.origin,"/")+"explore/detail/".concat(e.id,"?source=share_link")+(this.inviteCode?"&u_code=".concat(this.inviteCode):""),image=(null==e||null===(n=e.banner)||void 0===n?void 0:n.url)||(null==e?void 0:e.replaceUrl)||(null==e?void 0:e.cover)||(null==e?void 0:e.url)||"";this.$refs.shareDialog.show(path,image,"share","waterfall_flow");break;case"not_interested":Object(h.i)({items:[{action:"not_interested",obj_no:e.id,obj_type:1}]}).then((function(t){var n,r;1e4==(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(o.$message({message:o.$t("reduceWork"),type:"success"}),e.propS=!1,o.setWaterFallDeleteLits(e.id),o.$emit("resizeListener")):o.$message({message:(null==t||null===(r=t.status)||void 0===r?void 0:r.msg)||o.$t("ServerError"),type:"error"})}))}},tagChange:function(){this.$emit("change")},handleType:function(t){var e=t.type,n=t.channel;return 2===e&&"sdxl"===n||4===e&&"sdxl"===n?"/cell":6===e?"/animate":"/upscale"},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(w.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},addContentDecoration:function(){this.jewelryModalVisible=!0},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}}},P=(n(4680),n(4681),n(0)),component=Object(P.a)(L,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L=this,P=L._self._c;return P("a",{staticClass:"Acnt",attrs:{href:L.localePath("/explore/detail/"+L.item.id),target:"_blank"},on:{click:function(t){return t.preventDefault(),L.handleDetail(t,L.item)},mouseup:function(t){return L.handleMouseUp(t,L.item)},mouseover:function(t){L.cntShow=!0}}},[P("HyColorfulBorder",{attrs:{showBorder:!1,photoFrame:L.item.work_frame,borderRadius:16,boxHeight:"100%"}},[P("div",{ref:"boxItem",staticClass:"defBox marking-item",class:{"bg-nsfw":1===L.item.nsfw,boxItem:!L.setNsfwPlus(L.item)},on:{mouseenter:function(t){return L.onPlay()},mouseleave:function(t){return L.onPause()}}},[L.item.sys_tag&&L.otherShow?P("div",{staticClass:"SysTag",style:{color:null===(t=L.sysTag[L.item.sys_tag[0]])||void 0===t?void 0:t.color,backgroundColor:null===(e=L.sysTag[L.item.sys_tag[0]])||void 0===e?void 0:e.bg}},[L._v("\n        "+L._s(L.$t(null===(n=L.sysTag[L.item.sys_tag[0]])||void 0===n?void 0:n.txt))+"\n      ")]):L._e(),L._v(" "),P("div",{directives:[{name:"show",rawName:"v-show",value:L.item.NSFWSHOW,expression:"item.NSFWSHOW"}],staticClass:"NSFWSHOW-box",style:{right:1===(null===(o=L.item)||void 0===o?void 0:o.nsfw)&&L.enableNsfwMode||null!==(r=L.item)&&void 0!==r&&r.nsfw_plus?"10px":"75px"}},[1!==(null===(c=L.item)||void 0===c?void 0:c.nsfw)?P("div",{staticClass:"NSFWSHOW",style:{opacity:null!==(l=L.item)&&void 0!==l&&l.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),L.item.nsfw_plus=!(null!==(e=L.item)&&void 0!==e&&e.nsfw_plus)}}},[P("i",{staticClass:"iconfont",class:null!==(d=L.item)&&void 0!==d&&d.nsfw_plus?"icon-work-show":"icon-work-hide"})]):L._e(),L._v(" "),P("HyMoreBtn",{staticClass:"more",attrs:{isShowNsfwIcon:1===(null===(h=L.item)||void 0===h?void 0:h.nsfw)&&L.enableNsfwMode||L.setNsfwPlus(L.item),isNsfw:!1,isShowReport:1!==L.item.nsfw},on:{deleteSingleImg:function(t){return L.moreActions("delete",L.item)},handleAppeal:function(t){return L.moreActions("appeal",L.item)},handleReport:function(t){return L.moreActions("flag",L.item)}}})],1),L._v(" "),P("div",{directives:[{name:"show",rawName:"v-show",value:1!==L.item.nsfw&&L.setNsfwPlus(L.item),expression:"item.nsfw !== 1 && setNsfwPlus(item)"}],staticClass:"report-icon"},[P("i",{staticClass:"iconfont icon-report"})]),L._v(" "),1===L.item.nsfw||L.isVideoLink(L.item.cover)?1!=L.item.nsfw?P("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:L.setNsfwPlus(L.item)?"blur(19px) saturate(160%)":""},attrs:{src:L.item.cover,loop:"",controls:!1},domProps:{muted:!L.videoHasVoice}}):L._e():P("ImgWaterFall",{style:{filter:L.setNsfwPlus(L.item)?"blur(19px) saturate(160%)":""},attrs:{item:L.item}}),L._v(" "),L.isVideoLink(L.item.cover)&&!L.showVideo?P("div",{staticClass:"video-mark flex_c_m"},[P("i",{staticClass:"iconfont icon-icon-tag-creation"})]):L._e(),L._v(" "),P("div",{directives:[{name:"show",rawName:"v-show",value:2!==(null===(v=L.userInfo)||void 0===v||null===(v=v.settings)||void 0===v?void 0:v.green_mode)&&L.otherShow,expression:"userInfo?.settings?.green_mode !== 2 && otherShow"}]},[[2,"2"].includes(L.item.green)&&!["/personal"].includes(L.$route.path)?P("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:L.item.waterWidth+"px",height:L.item.waterHeight+"px"}}):L._e()]),L._v(" "),L.cntShow&&L.otherShow?P("div",["comfyui"==L.item.channel?P("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),L.goWorkfolwApp(L.item)}}},[L._v("\n          "+L._s(L.$t("Remix"))+"\n        ")]):L._e(),L._v(" "),"comfyui"!=L.item.channel?P("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),L.handleClick(L.item)}}},[L._v("\n          "+L._s(L.$t("Remix"))+"\n        ")]):L._e(),L._v(" "),L.isLoggedIn?P("CollectPopover",{staticClass:"CollectPop",style:{opacity:L.itemShow&&L.itemShowId==L.item.id?1:0},attrs:{dotReportInfo:L.collectDotReportInfo,type:"artwork",folder:L.item,from:"waterfall"},on:{showChaneg:L.changeItemShow}}):L._e(),L._v(" "),L.isLoggedIn?P("div",{staticClass:"cltpop",style:{opacity:L.itemShow&&L.itemShowId==L.item.id?1:0}}):L._e(),L._v(" "),L.item.waterHeight>200?P("div",{staticClass:"waterfall-hover-photo"},[P("div",{staticClass:"hoverTop"},[P("span",[L._v(L._s(L.handleType(L.item)))]),L._v(" "),L.item?P("div",{staticClass:"moreEdit"},[L.isLoggedIn?[P("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"100",trigger:"click"},on:{show:L.handlePopoverShow},model:{value:L.item.propS,callback:function(t){L.$set(L.item,"propS",t)},expression:"item.propS"}},[P("div",{staticClass:"pop-btns flex"},[P("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==L.fromPage&&L.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),L.addContentDecoration()}}},[L._v("\n                      "+L._s(L.$t("addContentDecoration"))+"\n                    ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==L.fromPage&&L.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("pinOrNot")}}},[L._v("\n                      "+L._s(L.$t(null!==(f=L.item)&&void 0!==f&&f.isTop?"UnpinOverview":"PinOverview"))+"\n                    ")]),L._v(" "),P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("flag",L.item)}}},[L._v("\n                      "+L._s(L.$t("Report"))+"\n                    ")]),L._v(" "),L.isShowNewDownload?P("DownloadVideoPop",{attrs:{videoInfo:{videoUrl:null===(m=L.item)||void 0===m?void 0:m.cover}}},[P("button",{on:{click:function(t){t.preventDefault()}}},[L._v("\n                        "+L._s(L.$t("Download"))+"\n                      ")])]):P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("save",L.item)}}},[L._v("\n                      "+L._s(L.$t("Download"))+"\n                    ")]),L._v(" "),P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("share",L.item)}}},[L._v("\n                      "+L._s(L.$t("ShareLink"))+"\n                    ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:!(L.item.isSlot||L.item.author&&L.item.author.id==L.userInfo.id),expression:"!item.isSlot && (!item.author || item.author.id != userInfo.id)"}],on:{click:function(t){return t.preventDefault(),L.moreActions("not_interested",L.item)}}},[L._v("\n                      "+L._s(L.$t("dislike"))+"\n                    ")]),L._v(" "),L.item.NSFWSHOW?P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("appeal",L.item)}}},[L._v("\n                      "+L._s(L.$t("appeal"))+"\n                    ")]):L._e(),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:L.isMine,expression:"isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("delete")}}},[L._v("\n                      "+L._s(L.$t("Delete"))+"\n                    ")])],1),L._v(" "),P("div",{class:{"login-waterFall-btn-icon":L.isLoggedIn,"noLogin-waterFall-collect-icon prompt-show":!L.isLoggedIn},attrs:{slot:"reference"},slot:"reference"},[P("i",{staticClass:"iconfont icon-more"})])])]:L._e()],2):L._e()]),L._v(" "),P("div",{staticClass:"hoverMiddle"},[L._v("\n            "+L._s(L.item.prompt)+"\n          ")])]):P("div",[L.item?P("div",{staticClass:"short-more-edit"},[L.isLoggedIn?[P("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"100",trigger:"click"},on:{show:L.handlePopoverShow},model:{value:L.item.propS,callback:function(t){L.$set(L.item,"propS",t)},expression:"item.propS"}},[P("div",{staticClass:"pop-btns flex"},[P("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==L.fromPage&&L.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("pinOrNot")}}},[L._v("\n                    "+L._s(L.$t(null!==(_=L.item)&&void 0!==_&&_.isTop?"UnpinOverview":"PinOverview"))+"\n                  ")]),L._v(" "),P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("flag",L.item)}}},[L._v("\n                    "+L._s(L.$t("Report"))+"\n                  ")]),L._v(" "),L.isShowNewDownload?P("DownloadVideoPop",{attrs:{videoInfo:{videoUrl:null===(y=L.item)||void 0===y?void 0:y.cover}}},[P("button",{on:{click:function(t){t.preventDefault()}}},[L._v("\n                      "+L._s(L.$t("Download"))+"\n                    ")])]):P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("save",L.item)}}},[L._v("\n                    "+L._s(L.$t("Download"))+"\n                  ")]),L._v(" "),P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("share",L.item)}}},[L._v("\n                    "+L._s(L.$t("ShareLink"))+"\n                  ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:!(L.item.isSlot||L.item.author&&L.item.author.id==L.userInfo.id),expression:"!item.isSlot && (!item.author || item.author.id != userInfo.id)"}],on:{click:function(t){return t.preventDefault(),L.moreActions("not_interested",L.item)}}},[L._v("\n                    "+L._s(L.$t("dislike"))+"\n                  ")]),L._v(" "),L.item.NSFWSHOW?P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("appeal",L.item)}}},[L._v("\n                    "+L._s(L.$t("appeal"))+"\n                  ")]):L._e(),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:L.isMine,expression:"isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("delete")}}},[L._v("\n                    "+L._s(L.$t("Delete"))+"\n                  ")])],1),L._v(" "),P("div",{class:{"login-waterFall-btn-icon":L.isLoggedIn,"noLogin-waterFall-collect-icon prompt-show":!L.isLoggedIn},attrs:{slot:"reference"},slot:"reference"},[P("i",{staticClass:"iconfont icon-more"})])])]:L._e()],2):L._e()]),L._v(" "),P("admin-tag",{attrs:{id:L.item.id,type:"1",item:L.item,review:L.review},on:{change:L.tagChange}})],1):L._e()],1)]),L._v(" "),L.otherShow?P("div",{staticClass:"author",style:{width:L.item.waterWidth+"px",marginTop:"8px"}},[P("div",{staticClass:"userBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.otherUser(L.item)}}},[P("BaseAvatar",{attrs:{"user-data":L.item.author,name:(null===(w=L.item.author)||void 0===w?void 0:w.name)||(null===(C=L.item.author)||void 0===C?void 0:C.id),size:24}}),L._v(" "),P("div",{staticClass:"authorName"},[L._v(L._s((null===(k=L.item.author)||void 0===k?void 0:k.name)||(null===(O=L.item.author)||void 0===O?void 0:O.id)))])],1),L._v(" "),L.cntShow?P("div",{staticClass:"numItem"},[P("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.setLike(L.item,"artwork","waterfall")}}},[P("i",{staticClass:"iconfont",class:L.setlikeData(L.item)}),L._v(" "),null!==(x=L.item.stat)&&void 0!==x&&x.num_of_like?P("span",[L._v(L._s(L.item.stat.num_of_like))]):L._e()]),L._v(" "),P("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.setCollect(L.item,"artwork")}}},[P("i",{staticClass:"iconfont",class:L.setCollectData(L.item)}),L._v(" "),null!==(I=L.item.stat)&&void 0!==I&&I.num_of_collection?P("span",[L._v(L._s(L.item.stat.num_of_collection))]):L._e()])]):P("div",{staticClass:"numItem"},[P("div",{staticClass:"funItem"},[P("i",{staticClass:"iconfont",class:L.item.liked?"icon-like_selected":"icon-like"}),L._v(" "),null!==(S=L.item.stat)&&void 0!==S&&S.num_of_like?P("span",[L._v(L._s(L.item.stat.num_of_like))]):L._e()]),L._v(" "),P("div",{staticClass:"funItem"},[P("i",{staticClass:"iconfont",class:L.item.collect?"icon-collect_selected":"icon-collect"}),L._v(" "),null!==(D=L.item.stat)&&void 0!==D&&D.num_of_collection?P("span",[L._v(L._s(L.item.stat.num_of_collection))]):L._e()])])]):L._e(),L._v(" "),P("ShareDialog",{ref:"shareDialog",attrs:{type:"artwork"}}),L._v(" "),P("HyJewelryModal",{attrs:{artwork:L.item},on:{useSuccess:L.handleUseJewelrySuccess},model:{value:L.jewelryModalVisible,callback:function(t){L.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"6e467da2",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,CollectPopover:n(63).default,DownloadVideoPop:n(200).default,AdminTag:n(111).default,BaseAvatar:n(53).default,ShareDialog:n(144).default})},928:function(t,e,n){"use strict";n(16),n(18),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(6),n(50),n(22),n(31),n(4),n(21),n(26),n(10)),c=n(1),l=n(63),d=n(53),h=n(45),v=n(39),f=n(111),m=n(112),_=n(9),y=n(174),w=n(27),C=n(128),k=n(278),O=n(108);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={mixins:[h.a],components:{CollectPopover:l.default,AdminTag:f.default,ImgWaterFall:m.default,BaseAvatar:d.default,HyJewelryModal:k.default,HyColorfulBorder:O.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},sysTag:{type:Object,default:function(){}},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},isTrainLora:{type:Boolean,default:!1}},computed:I(I(I({},Object(c.c)("user",["isLoggedIn","accountSettingsData"])),Object(c.e)("user",["userInfo","adminOff"])),{},{authorName:function(){var t,e=null===(t=this.item)||void 0===t?void 0:t.author,n=e.id;return e.name||n},getModelType:function(){var t,e,n,o,r,c,l,d,h,v={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:this.$t("embedding1")}[null===(t=this.item)||void 0===t||null===(t=t.art_model)||void 0===t?void 0:t.type]||(null===(e=this.item)||void 0===e||null===(e=e.art_model)||void 0===e?void 0:e.type),f=(null===_.L||void 0===_.L?void 0:_.L.flux)||[],m="Pony"===(null===(n=this.item)||void 0===n||null===(n=n.art_model)||void 0===n?void 0:n.base_model),y=null===(o=this.item)||void 0===o||null===(o=o.art_model)||void 0===o?void 0:o.base_model;return"Illustrious"===(null===(r=this.item)||void 0===r||null===(r=r.art_model)||void 0===r?void 0:r.base_model)?v+" | IL ":"NoobAI"===(null===(c=this.item)||void 0===c||null===(c=c.art_model)||void 0===c?void 0:c.base_model)?v+" | NAI ":null!==(l=this.item)&&void 0!==l&&null!==(l=l.art_model)&&void 0!==l&&l.base_model.includes("SDXL")&&!m?v+" | XL ":"HiDream"===(null===(d=this.item)||void 0===d||null===(d=d.art_model)||void 0===d?void 0:d.base_model)?v+" | HID ":"SeaArt Film"===(null===(h=this.item)||void 0===h||null===(h=h.art_model)||void 0===h?void 0:h.base_model)?v+" | SAF ":f.includes(y)?v+" | F1 ":v},isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},isPC:function(){return"PC"===localStorage.getItem("visitFrom")},setNsfwPlus:function(){return function(t){return!1}}}),data:function(){var t;return{isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,copyTextToClipboard:r.g,saveImg:r.M,formatNumberForeign:r.p,itemShow:!1,itemShowId:"",collectDotReportInfo:{},cntShow:!0,from:"waterfall",otherShow:!1,loraTrainLoading:!1,jewelryModalVisible:!1}},mounted:function(){var t=this;setTimeout((function(){t.otherShow=!0}),200)},methods:I(I({},Object(c.d)("home",["setAllUpdateStatus"])),{},{moreActions:function(t){var e=this,n=this.item,o=n.id,r=void 0===o?"":o,c=n.obj_type;switch(t){case"edit":this.$logEvent("log_actions",{operation:"click_edit",behavior_info:"on_personal_center",behavior_info_sub:c}),this.$router.push({path:this.localePath("/modelEditStep"),query:{id:r}});break;case"report":Object(C.f)({id:r}).then((function(t){e.$message.success(e.$t("ReportSuccess"))}));break;case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item)}},goLoraTrain:function(t){var e=this;["Checkpoint","LORA","TextualInversion","DoRA","LoCon"].includes(t.art_model.type)?this.isLoggedIn?this.loraTrainLoading||(this.loraTrainLoading=!0,Object(y.c)({model_id:t.id}).then((function(n){if(1e4==n.status.code){var o;if(!n.data.train_model_id)return e.$message(e.$t("loraTmpErr")),e.$emit("deleteItem",t.id),void e.setAllUpdateStatus(!0);var r=n.data.ver_id,c=(null===(o=t.art_model)||void 0===o?void 0:o.ver_id)||r;e.$router.push(e.localePath("/loraTrainingEdit?dataSetNo="+n.data.train_model_id+"&modelVerNo="+c))}})).finally((function(){e.loraTrainLoading=!1})),this.$logEvent("log_actions",{operation:"click_train_same_model",behavior_info:"on_template_page",behavior_info_sub:t.id})):this.$EventBus.$emit("openLoginDialog"):this.$message(this.$t("theTypeNocreate"))},handleMouseUp:function(t,e){if(2===t.which||1===t.button){var n=this.list.findIndex((function(i){return i.id===e.id})),o=(n<10?this.list.slice(0,n):this.list.slice(n-10,n)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(v.i)({items:[I(I({},this.dotReportInfo),{},{negative_ids:o,action:"view",obj_no:e.id,obj_type:2})]})}},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=I(I({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:2})},checkGreen:function(t){return!this.isLoggedIn&&!(null==t||!t.green||![2,"2"].includes(t.green))},handleDetail:function(t,e){if(this.$logEvent("log_actions",{operation:"click_model",behavior_info:e.id}),"IMG"===t.target.tagName||"cltpop"===t.target.className||t.target.className.includes("boxItem")||t.target.className.includes("defBox")||t.target.className.includes("numItem")||"ImgWaterFall"===t.target.className||"green-mode-div"===t.target.className){if(this.checkGreen(e))return void this.$EventBus.$emit("openLoginDialog",{redirect:"/models/detail/"+e.id});var n=this.list.findIndex((function(i){return i.id===e.id})),o=(n<10?this.list.slice(0,n):this.list.slice(n-10,n)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(v.i)({items:[I(I({},this.dotReportInfo),{},{negative_ids:o,action:"view",obj_no:e.id,obj_type:2,batch_id:null==e?void 0:e.pt,stat:null==e?void 0:e.stat},this.productLevel&&{vip:this.productLevel})]}),this.$router.push(this.localePath("/models/detail/"+e.id))}},handleClick:function(t){var e,n=null==t?void 0:t.art_model,o=n.base_model,r=n.type,c=["Checkpoint","LORA","TextualInversion","DoRA","LoCon"].includes(r),l=_.G.includes(o);if(c)if(this.isLoggedIn){var d=Object.assign({},t);d.taskSource=1,d.logEventSource=Object(_.Y)(this.$route.name),d.banner={url:d.cover},d.model_ver_no=null===(e=d.art_model)||void 0===e?void 0:e.ver_id;var h=l||_.u.includes(d.base_model);this.$EventBus.$emit("openGenerate",{action:1,data:{source:d},taskVersion:h?"v2":""});var f=this.list.findIndex((function(i){return i.id===t.id})),m=(f<10?this.list.slice(0,f):this.list.slice(f-10,f)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(v.i)({items:[I(I({},this.dotReportInfo),{},{negative_ids:m,action:"task",obj_no:t.id,obj_type:2})]});var y=t.id,w=t.obj_type,C=t.pt;this.$logEvent("log_actions",{operation:"same_create",behavior_info:y,obj_type:w,behavior_info_sub:C})}else this.$EventBus.$emit("openLoginDialog");else this.$message(this.$t("theTypeNocreate"))},otherUser:function(t){if(["Checkpoint","LORA","TextualInversion","DoRA","LoCon"].includes(t.art_model.type)){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")}else this.$message(this.$t("theTypeNocreate"))},tagChange:function(){this.$emit("change")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(w.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},addContentDecoration:function(){this.jewelryModalVisible=!0},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}})},D=(n(4682),n(0)),component=Object(D.a)(S,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y,w,C,k,O,x,I=this,S=I._self._c;return S("a",{attrs:{href:I.localePath("/models/detail/"+I.item.id),target:"_blank"},on:{click:function(t){return t.preventDefault(),I.handleDetail(t,I.item)},mouseup:function(t){return I.handleMouseUp(t,I.item)},mouseover:function(t){I.cntShow=!0}}},[S("HyColorfulBorder",{attrs:{photoFrame:I.item.work_frame,borderRadius:16,boxHeight:"100%"}},[S("div",{staticClass:"defBox marking-item",class:{"bg-nsfw":1===I.item.nsfw,boxItem:!I.setNsfwPlus(I.item)},style:{width:I.item.waterWidth+"px",height:I.item.waterHeight+"px"}},[I.item.sys_tag&&I.otherShow?S("div",{staticClass:"SysTag",style:{color:null===(t=I.sysTag[I.item.sys_tag])||void 0===t?void 0:t.color,backgroundColor:null===(e=I.sysTag[I.item.sys_tag])||void 0===e?void 0:e.bg}},[I._v("\n        "+I._s(I.$t(null===(n=I.sysTag[I.item.sys_tag])||void 0===n?void 0:n.txt))+"\n      ")]):I._e(),I._v(" "),S("div",{directives:[{name:"show",rawName:"v-show",value:I.item.NSFWSHOW&&[2,"2"].includes(null===(o=I.userInfo)||void 0===o||null===(o=o.settings)||void 0===o?void 0:o.nsfw_plus)&&I.otherShow,expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus) && otherShow"}],staticClass:"NSFWSHOW",style:{right:null!==(r=I.item)&&void 0!==r&&r.nsfw_plus?"10px":"75px",opacity:null!==(c=I.item)&&void 0!==c&&c.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),I.item.nsfw_plus=!(null!==(e=I.item)&&void 0!==e&&e.nsfw_plus)}}},[S("i",{staticClass:"iconfont",class:null!==(l=I.item)&&void 0!==l&&l.nsfw_plus?"icon-work-show":"icon-work-hide"})]),I._v(" "),1!==I.item.nsfw?S("ImgWaterFall",{style:{filter:I.setNsfwPlus(I.item)?"blur(19px) saturate(160%)":""},attrs:{item:I.item,isHeight:!1}}):I._e(),I._v(" "),2!==(null===(d=I.userInfo)||void 0===d||null===(d=d.settings)||void 0===d?void 0:d.green_mode)&&I.otherShow?S("div",[[2,"2"].includes(I.item.green)&&!["/personal"].includes(I.$route.path)?S("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:I.item.waterWidth+"px",height:I.item.waterHeight+"px"}}):I._e()]):I._e(),I._v(" "),I.otherShow?S("div",{staticClass:"modelType"},[I._v("\n        "+I._s(I.getModelType)+"\n        "),"Pony"===(null===(h=I.item.art_model)||void 0===h?void 0:h.base_model)?S("span",[I._v("| "),S("i",{staticClass:"iconfont icon-icon-horse"})]):I._e()]):I._e(),I._v(" "),I.cntShow&&I.otherShow?S("div",[I.isTrainLora?S("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),I.goLoraTrain(I.item)}}},[I._v("\n          "+I._s(I.$t("navModel"))+"\n        ")]):S("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),I.handleClick(I.item)}}},[I._v("\n          "+I._s("TextualInversion"!==(null===(v=I.item.art_model)||void 0===v?void 0:v.type)?I.$t("Remix"):I.$t("workFlow46"))+"\n        ")]),I._v(" "),S("admin-tag",{attrs:{id:I.item.id,item:I.item,type:"2"},on:{change:I.tagChange}}),I._v(" "),S("CollectPopover",{directives:[{name:"show",rawName:"v-show",value:I.isLoggedIn,expression:"isLoggedIn"}],staticClass:"CollectPop",style:{opacity:I.itemShow&&I.itemShowId==I.item.id?1:0},attrs:{dotReportInfo:I.collectDotReportInfo,type:"model",folder:I.item,from:"waterfall"},on:{showChaneg:I.changeItemShow}}),I._v(" "),S("div",{directives:[{name:"show",rawName:"v-show",value:I.isLoggedIn,expression:"isLoggedIn"}],staticClass:"cltpop",style:{opacity:I.itemShow&&I.itemShowId==I.item.id?1:0}},[S("i",{staticClass:"iconfont",class:I.setCollectData(I.item)})])],1):I._e(),I._v(" "),S("div",{staticClass:"cnt"},[S("div",{staticClass:"user",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),I.otherUser(I.item)}}},[S("BaseAvatar",{attrs:{userData:I.item.author,size:24}}),I._v(" "),S("div",{staticClass:"authorName"},[I._v(I._s(I.authorName))])],1),I._v(" "),S("div",{staticClass:"title"},[I._v(I._s(null===(f=I.item.art_model)||void 0===f?void 0:f.name))]),I._v(" "),I.item.stat.rating?S("div",{staticClass:"rate"},[S("el-rate",{attrs:{disabled:""},model:{value:I.item.stat.rating,callback:function(t){I.$set(I.item.stat,"rating",t)},expression:"item.stat.rating"}}),I._v(" "),S("span",[I._v(I._s(I.item.stat.rating))])],1):I._e(),I._v(" "),S("div",{staticClass:"numItem"},[I.cntShow?S("div",{staticClass:"funItem",staticStyle:{margin:"0"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),I.setCollect(I.item,"model")}}},[S("i",{staticClass:"iconfont",class:I.setCollectData(I.item)}),I._v(" "),null!==(m=I.item.stat)&&void 0!==m&&m.num_of_collection?S("span",[I._v(I._s(I.item.stat.num_of_collection))]):I._e()]):S("div",{staticClass:"funItem",staticStyle:{margin:"0"}},[S("i",{staticClass:"iconfont",class:I.item.collect?"icon-collect_selected":"icon-collect"}),I._v(" "),null!==(_=I.item.stat)&&void 0!==_&&_.num_of_collection?S("span",[I._v(I._s(I.item.stat.num_of_collection))]):I._e()]),I._v(" "),S("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),I.handleClick(I.item)}}},[S("i",{staticClass:"iconfont icon-play"}),I._v(" "),null!==(y=I.item.stat)&&void 0!==y&&y.num_of_task?S("span",[I._v(I._s(I.formatNumberForeign(null===(w=I.item.stat)||void 0===w?void 0:w.num_of_task)))]):I._e()]),I._v(" "),S("div",{staticClass:"funItem",staticStyle:{"pointer-events":"none"}},[S("i",{staticClass:"iconfont icon-icon-Download"}),I._v(" "),null!==(C=I.item.stat)&&void 0!==C&&C.num_of_download?S("span",[I._v(I._s(I.formatNumberForeign(null===(k=I.item.stat)||void 0===k?void 0:k.num_of_download)))]):I._e()]),I._v(" "),I.isPersonal?S("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:I.handlePopoverShow}},[S("div",{staticClass:"pop-btns flex"},[S("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==I.fromPage&&I.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),I.addContentDecoration()}}},[I._v("\n                "+I._s(I.$t("addContentDecoration"))+"\n              ")]),I._v(" "),S("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==I.fromPage&&I.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),I.moreActions("pinOrNot")}}},[I._v("\n                "+I._s(I.$t(null!==(O=I.item)&&void 0!==O&&O.isTop?"UnpinOverview":"PinOverview"))+"\n              ")]),I._v(" "),S("button",{directives:[{name:"show",rawName:"v-show",value:I.isMine,expression:"isMine"}],on:{click:function(t){return t.preventDefault(),I.moreActions("edit")}}},[I._v("\n                "+I._s(I.$t("Edit"))+"\n              ")]),I._v(" "),S("button",{on:{click:function(t){return t.preventDefault(),I.moreActions("report")}}},[I._v("\n                "+I._s(I.$t("Report"))+"\n              ")]),I._v(" "),S("button",{directives:[{name:"show",rawName:"v-show",value:I.isMine&&1==(null===(x=I.item)||void 0===x?void 0:x.primary),expression:"isMine && item?.primary == 1"}],on:{click:function(t){return t.preventDefault(),I.moreActions("delete")}}},[I._v("\n                "+I._s(I.$t("Delete"))+"\n              ")])]),I._v(" "),S("div",{staticClass:"funItem more-btn-opacity",attrs:{slot:"reference"},slot:"reference"},[S("i",{staticClass:"iconfont icon-more"})])]):I._e()],1)])],1)]),I._v(" "),S("HyJewelryModal",{attrs:{artwork:I.item},on:{useSuccess:I.handleUseJewelrySuccess},model:{value:I.jewelryModalVisible,callback:function(t){I.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"1e41150e",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,AdminTag:n(111).default,CollectPopover:n(63).default,BaseAvatar:n(53).default})},929:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(10),c=n(1);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={props:{item:{type:Object,default:function(){}}},computed:d(d({},Object(c.c)("user",["isLoggedIn"])),{},{banners:function(){var t;return(null===(t=this.item)||void 0===t?void 0:t.banner)||[]}}),data:function(){return{replaceImageType:r.K}},methods:{jumpUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=t&&t.url){var e=null==t?void 0:t.url;this.$logEvent("log_actions",{operation:"click_home_banner",page_title:null==t?void 0:t.title,behavior_info:e}),window.open(e,"_blank")}}}},v=h,f=(n(4683),n(4684),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"boxItem",style:{width:t.item.waterWidth+"px",height:t.item.waterHeight+"px"}},[e("div",{staticClass:"bannerBox"},[e("el-carousel",{attrs:{height:t.item.waterHeight+"px"}},t._l(t.banners,(function(img){return e("el-carousel-item",{key:img.cover},[e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:t.replaceImageType(img.cover),loading:"lazy",alt:""},on:{click:function(e){return t.jumpUrl(img)}}})])})),1)],1)])}),[],!1,null,"1a7a29d6",null);e.a=component.exports},930:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8);var o=n(2),r=(n(4),n(7),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var l={props:{item:{type:Object,default:function(){}}},data:function(){return{}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(r.c)("user",["isLoggedIn"])),activated:function(){var video=this.$refs.mainVideo;video&&video.length&&video.forEach((function(t){t.play&&t.play()}))},methods:{setName:function(code){var t="";switch(code){case"hd_repair":t=this.$t("ai_tools_1");break;case"remove_bg":t=this.$t("ai_tools_2");break;case"draft_to_img":t=this.$t("ai_tools_3");break;case"ai_filter":t=this.$t("ai_tools_4");break;case"ai_photography":t=this.$t("ai_tools_10");break;case"ai_exchange_face":t=this.$t("ai_face_changing");break;case"simple_text_to_img":t=this.$t("Text2imgTitle");break;case"ai_makeup":t=this.$t("ai_makeup");break;case"sora":t=this.$t("toolsPage3");break;case"ai_eraser":t=this.$t("ai_erase")}return t},goPage:function(code){var t="image-upscaler";switch(code){case"ai_makeup":t="ai-makeup";break;case"remove_bg":t="remove-background";break;case"draft_to_img":t="scribble2img";break;case"ai_filter":t="ai-filter";break;case"ai_photography":t="ai-portrait";break;case"ai_exchange_face":t="ai-face-swap";break;case"simple_text_to_img":t="text2img";break;case"sora":t="sora";break;case"ai_eraser":t="ai_erase"}this.$logEvent("log_actions",{operation:"click_tools",behavior_info:"on_quick_ai",behavior_info_sub:code,user_status:this.isLoggedIn?"activated":"guest"}),window.open(this.localePath("/ai-tools/"+t),"_blank")}}},d=l,h=(n(4685),n(4686),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"videoBanner",style:{width:t.item.waterWidth+"px"}},[e("el-carousel",{attrs:{height:t.item.waterHeight+48+"px",interval:5e3}},t._l(t.item.ai_tool,(function(video){return e("el-carousel-item",{key:null==video?void 0:video.code},[e("div",{on:{click:function(e){return t.goPage(null==video?void 0:video.code)}}},[e("div",{staticClass:"videoBox",style:{width:t.item.waterWidth+"px",height:t.item.waterHeight+"px"}},[e("video",{ref:"mainVideo",refInFor:!0,attrs:{autoplay:"",muted:"",loop:"",src:null==video?void 0:video.url},domProps:{muted:!0}})]),t._v(" "),e("div",{staticClass:"objName"},[t._v(t._s(t.setName(null==video?void 0:video.code)))])])])})),1)],1)}),[],!1,null,"0179fbd6",null);e.a=component.exports},931:function(t,e,n){"use strict";n(16),n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(4),n(1)),c=n(39),l=n(10),d=n(45),h=n(111),v=n(27),f=n(207),m=n(112),_=n(53),y=n(54),w=n(278),C=n(108);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={mixins:[d.a],components:{AdminTag:h.default,listCheckbox:f.default,ImgWaterFall:m.default,BaseAvatar:_.default,HyJewelryModal:w.default,HyColorfulBorder:C.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},review:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},sysTag:{type:Object,default:function(){}}},data:function(){var t;return{isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,formatNumberForeign:l.p,deleteLoad:!1,cntShow:!0,jewelryModalVisible:!1}},computed:O(O(O({},Object(r.c)("user",["isLoggedIn","accountSettingsData"])),Object(r.e)("user",["userInfo","adminOff"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},setNsfwPlus:function(){return function(t){return!1}},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},showGreenCover:function(){return[2,"2"].includes(this.item.green)&&!["/personal"].includes(this.$route.path)&&this.greenMode}}),activated:function(){var video=this.$refs.mainVideo;video&&video.play&&video.play()},methods:{moreActions:function(t){var e=this,n=this.item,o=n.id,r=n.obj_type;n.portfolio;switch(t){case"report":Object(c.t)({id:o,obj_type:r}).then((function(t){e.$message({message:e.$t("ReportSuccess"),type:"success"})}));break;case"edit":this.handleEdit();break;case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item)}},isVideoLink:l.G,onDelete:function(t){var e=this;this.$confirm(this.$t("postDeleteTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){e.deleteLoad||(e.deleteLoad=!0,Object(v.sb)({obj_id:t.id,obj_type:t.obj_type}).then((function(n){e.setWaterFallDeleteLits(t.id),e.$emit("resizeListener"),e.$message({type:"success",message:e.$t("deleteSuccess")})})).finally((function(){e.deleteLoad=!1})))})).catch((function(){}))},handleDetail:function(t,e){var n=this.showGreenCover;this.$logEvent("log_actions",{operation:"click_post",behavior_info:this.$route.path,behavior_info_sub:(n?"gallery_cover,":"gallery,")+e.id}),Object(c.i)({items:[{action:"view",obj_no:e.id,obj_type:4}]}),n&&!this.isLoggedIn?this.$EventBus.$emit("openLoginDialog",{redirect:"/articleDetail/"+e.id,dotCover:!0}):this.$router.push(this.localePath("/articleDetail/"+e.id))},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},tagChange:function(t){if("REVIEW"!==t)this.$emit("change");else{var e=this.$route.params;localStorage.setItem("reviewList",JSON.stringify(this.list));var path="/articleDetail/"+this.item.id+"?review=1&tag="+(null==e?void 0:e.tag);this.$router.push(this.localePath(path))}},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(v.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},handleEdit:function(){var t,e;this.$logEvent("log_actions",{operation:"click_article_edit",behavior_info:"on_personal_center",behavior_info_sub:(null===(t=this.item)||void 0===t?void 0:t.id)||""}),this.$EventBus.$emit("openContribution",{remoteParams:{id:null===(e=this.item)||void 0===e?void 0:e.id},types:[y.CONTRIBUTION_TYPE_ENUM.ARTICLE]})},addContentDecoration:function(){this.jewelryModalVisible=!0},handleJewelrySuccess:function(){this.$emit("useJewelrySuccess")}}},I=(n(4687),n(0)),component=Object(I.a)(x,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_=this,y=_._self._c;return y("a",{attrs:{href:_.localePath("/articleDetail/"+_.item.id),target:"_blank"},on:{click:function(t){t.preventDefault(),!_.isCheck&&_.handleDetail(t,_.item)},mouseover:function(t){_.cntShow=!0}}},[y("HyColorfulBorder",{attrs:{photoFrame:_.item.work_frame,borderRadius:16,boxHeight:"100%"}},[y("div",{staticClass:"defBox article",class:{"bg-nsfw":1===_.item.nsfw,boxItem:!_.setNsfwPlus(_.item)},style:{width:_.item.waterWidth+"px",height:_.item.waterHeight+"px"}},[_.isCheck&&_.item?y("listCheckbox",{on:{change:function(t){return _.$emit("checkChange")}},model:{value:_.item.isCheck,callback:function(t){_.$set(_.item,"isCheck",t)},expression:"item.isCheck"}}):_._e(),_._v(" "),_.item.sys_tag?y("div",{staticClass:"SysTag",style:{color:null===(t=_.sysTag[_.item.sys_tag[0]])||void 0===t?void 0:t.color,backgroundColor:null===(e=_.sysTag[_.item.sys_tag[0]])||void 0===e?void 0:e.bg}},[_._v("\n        "+_._s(_.$t(null===(n=_.sysTag[_.item.sys_tag[0]])||void 0===n?void 0:n.txt))+"\n      ")]):_._e(),_._v(" "),y("div",{directives:[{name:"show",rawName:"v-show",value:_.item.NSFWSHOW&&[2,"2"].includes(null===(o=_.userInfo)||void 0===o||null===(o=o.settings)||void 0===o?void 0:o.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{opacity:null!==(r=_.item)&&void 0!==r&&r.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),_.item.nsfw_plus=!(null!==(e=_.item)&&void 0!==e&&e.nsfw_plus)}}},[y("i",{staticClass:"iconfont",class:null!==(c=_.item)&&void 0!==c&&c.nsfw_plus?"icon-work-show":"icon-work-hide"})]),_._v(" "),1===_.item.nsfw||_.isVideoLink(_.item.cover)?1!=_.item.nsfw?y("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:_.setNsfwPlus(_.item)?"blur(19px) saturate(160%)":""},attrs:{src:_.item.cover,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):_._e():y("ImgWaterFall",{class:_.isCheck?"":"cntImg",style:{transform:_.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:_.setNsfwPlus(_.item)?"blur(19px) saturate(160%)":""},attrs:{item:_.item}}),_._v(" "),y("div",{directives:[{name:"show",rawName:"v-show",value:_.greenMode,expression:"greenMode"}]},[y("div",{directives:[{name:"show",rawName:"v-show",value:_.showGreenCover,expression:"showGreenCover"}],staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:_.item.waterWidth+"px",height:_.item.waterHeight+"px"}})]),_._v(" "),y("div",{staticClass:"article-tag"},[y("span",[_._v(_._s(_.$t("Article")))])]),_._v(" "),3==_.item.status||4==_.item.status||2==_.item.status?y("div",{staticClass:"statusCnt"},[y("div",{staticClass:"statusZg"}),_._v(" "),y("div",{staticClass:"statusBox",style:{color:4==_.item.status||2==_.item.status?"#EF3B3B":"#ffffff"}},[y("i",{staticClass:"iconfont icon-statusBox"}),_._v(" "),y("div",[_._v("\n            "+_._s(4==_.item.status?_.$t("notApproved"):2==_.item.status?_.$t("Ban"):_.$t("underReview"))+"\n          ")])])]):_._e(),_._v(" "),y("div",{staticClass:"cnt"},[y("div",{staticClass:"article-name",attrs:{title:null===(l=_.item)||void 0===l||null===(l=l.portfolio)||void 0===l?void 0:l.name}},[_._v(_._s(null===(d=_.item)||void 0===d||null===(d=d.portfolio)||void 0===d?void 0:d.name))]),_._v(" "),y("div",{staticClass:"article-info"},[y("div",{staticClass:"user",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.otherUser(_.item)}}},[y("BaseAvatar",{attrs:{userData:_.item.author,size:24}}),_._v(" "),y("div",{staticClass:"authorName"},[_._v(_._s(null===(h=_.item.author)||void 0===h?void 0:h.name))])],1),_._v(" "),y("div",{staticClass:"numItem"},[y("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.setLike(_.item,"gallery")}}},[y("i",{staticClass:"iconfont",class:_.setlikeData(_.item)}),_._v(" "),null!==(v=_.item.stat)&&void 0!==v&&v.num_of_like?y("span",[_._v(_._s(_.item.stat.num_of_like))]):_._e()]),_._v(" "),y("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),_.setCollect(_.item,"gallery")}}},[y("i",{staticClass:"iconfont",class:_.setCollectData(_.item)}),_._v(" "),null!==(f=_.item.stat)&&void 0!==f&&f.num_of_collection?y("span",[_._v(_._s(_.item.stat.num_of_collection))]):_._e()]),_._v(" "),_.isPersonal?y("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:_.handlePopoverShow}},[y("div",{staticClass:"pop-btns flex"},[y("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==_.fromPage&&_.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),_.addContentDecoration()}}},[_._v("\n                  "+_._s(_.$t("addContentDecoration"))+"\n                ")]),_._v(" "),y("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==_.fromPage&&_.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),_.moreActions("pinOrNot")}}},[_._v("\n                  "+_._s(_.$t(null!==(m=_.item)&&void 0!==m&&m.isTop?"UnpinOverview":"PinOverview"))+"\n                ")]),_._v(" "),y("button",{directives:[{name:"show",rawName:"v-show",value:_.isMine,expression:"isMine"}],on:{click:function(t){return t.preventDefault(),_.moreActions("edit")}}},[_._v("\n                  "+_._s(_.$t("edit_contribution"))+"\n                ")]),_._v(" "),y("button",{on:{click:function(t){return t.preventDefault(),_.moreActions("report")}}},[_._v("\n                  "+_._s(_.$t("Report"))+"\n                ")]),_._v(" "),y("button",{directives:[{name:"show",rawName:"v-show",value:3!=_.item.status&&_.isMine,expression:"item.status != 3 && isMine"}],on:{click:function(t){return t.preventDefault(),_.moreActions("delete")}}},[_._v("\n                  "+_._s(_.$t("Delete"))+"\n                ")])]),_._v(" "),y("div",{staticClass:"funItem",attrs:{slot:"reference"},slot:"reference"},[y("i",{staticClass:"iconfont icon-more"})])]):_._e()],1)])])],1)]),_._v(" "),y("admin-tag",{attrs:{id:_.item.id,item:_.item,type:"4",review:_.review},on:{change:_.tagChange}}),_._v(" "),y("HyJewelryModal",{attrs:{artwork:_.item},on:{useSuccess:_.handleJewelrySuccess},model:{value:_.jewelryModalVisible,callback:function(t){_.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"6827cd3f",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,BaseAvatar:n(53).default,AdminTag:n(111).default})},932:function(t,e,n){"use strict";n(16),n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(4),n(1)),c=n(39),l=n(10),d=n(45),h=n(111),v=n(27),f=n(207),m=n(112),_=n(53),y=n(54),w=n(278),C=n(108);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={mixins:[d.a],components:{AdminTag:h.default,listCheckbox:f.default,ImgWaterFall:m.default,BaseAvatar:_.default,HyJewelryModal:w.default,HyColorfulBorder:C.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},review:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},sysTag:{type:Object,default:function(){}}},data:function(){var t;return{MAX_EDIT_NUM:2,isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,formatNumberForeign:l.p,deleteLoad:!1,cntShow:!0,jewelryModalVisible:!1}},computed:O(O(O(O(O({},Object(r.c)("user",["isLoggedIn","accountSettingsData"])),Object(r.e)("user",["userInfo","adminOff"])),Object(r.e)("payment",["productLevel"])),Object(r.e)("app",["ABInfo"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},setNsfwPlus:function(){return function(t){return!1}},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},showGreenCover:function(){return[2,"2"].includes(this.item.green)&&!["/personal"].includes(this.$route.path)&&this.greenMode},isEditDisabled:function(){var t,e;return(null===(t=this.item)||void 0===t?void 0:t.activity_id)||(null===(e=this.item)||void 0===e?void 0:e.edit_num)>=2}}),methods:{onPlay:function(){var t=this;this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.mainVideo)||void 0===e||e.play()}))},onPause:function(){var t=this;this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.mainVideo)||void 0===e||e.pause()}))},moreActions:function(t){var e=this,n=this.item,o=n.id,r=n.obj_type;switch(t){case"edit":this.handleEdit();break;case"report":Object(c.t)({id:o,obj_type:r}).then((function(t){e.$message({message:e.$t("ReportSuccess"),type:"success"})}));break;case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item);break;case"addContentDecoration":this.jewelryModalVisible=!0}},isVideoLink:l.G,onDelete:function(t){var e=this;this.$confirm(this.$t("postDeleteTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){e.deleteLoad||(e.deleteLoad=!0,Object(v.sb)({obj_id:t.id,obj_type:t.obj_type}).then((function(n){e.setWaterFallDeleteLits(t.id),e.$emit("resizeListener"),e.$message({type:"success",message:e.$t("deleteSuccess")})})).finally((function(){e.deleteLoad=!1})))})).catch((function(){}))},handleDetail:function(t,e){var n=this.showGreenCover;this.$logEvent("log_actions",{operation:"click_post",behavior_info:this.$route.path,behavior_info_sub:(n?"gallery_cover,":"gallery,")+e.id}),Object(c.i)({items:[O({action:"view",obj_no:e.id,obj_type:4,batch_id:null==e?void 0:e.pt,stat:null==e?void 0:e.stat},this.productLevel&&{vip:this.productLevel})]}),n&&!this.isLoggedIn?this.$EventBus.$emit("openLoginDialog",{redirect:"/artWorkDetail/"+e.id,dotCover:!0}):this.$router.push(this.localePath("/artWorkDetail/"+e.id))},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},tagChange:function(t){if("REVIEW"===t){var e=this.$route.params;return localStorage.setItem("reviewList",JSON.stringify(this.list)),void this.$router.push(this.localePath("/artWorkDetail/".concat(this.item.id,"?review=1&tag=").concat(null==e?void 0:e.tag)))}this.$emit("change")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(v.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},handleEdit:function(){var t,e;if(this.isEditDisabled)switch(!0){case!(null===(t=this.item)||void 0===t||!t.activity_id):this.$message(this.$t("activity_contribution_disabled_edit"));break;case(null===(e=this.item)||void 0===e?void 0:e.edit_num)>=2:this.$message(this.$t("already_not_edit"))}else{var n,o,r={picture:y.CONTRIBUTION_TYPE_ENUM.WORK,video:y.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO};this.$EventBus.$emit("openContribution",{remoteParams:{id:null===(n=this.item)||void 0===n?void 0:n.id},types:[r[null===(o=this.item)||void 0===o||null===(o=o.portfolio)||void 0===o?void 0:o.sub_channel]]})}},handPlayDoor:function(t){var e=this,n=t.cover,o=t.portfolio,r="video"===Object(l.v)(n);this.$EventBus.$emit("showDialog",{name:"HyAssembleModal",data:{doorCode:r?"aiVideoApp":"aiImageApp",artWorkNo:null==o?void 0:o.first_artwork_id,workUrl:n,source:4,objType:1,onAfterAction:function(){e.$EventBus.$emit("hideDialog","HyAssembleModal")}}})},handleJewelrySuccess:function(){this.$emit("useJewelrySuccess")}}},I=(n(4688),n(0)),component=Object(I.a)(x,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y,w,C,k,O,x,I,S,D,L=this,P=L._self._c;return P("a",{attrs:{href:L.localePath("/artWorkDetail/"+L.item.id),target:"_blank"},on:{click:function(t){t.preventDefault(),!L.isCheck&&L.handleDetail(t,L.item)},mouseover:function(t){L.cntShow=!0}}},[P("HyColorfulBorder",{attrs:{photoFrame:L.item.work_frame,borderRadius:16,boxHeight:"100%"}},[P("div",{staticClass:"defBox",class:{"bg-nsfw":1===L.item.nsfw,boxItem:!L.setNsfwPlus(L.item)},style:{width:L.item.waterWidth+"px",height:L.item.waterHeight+"px"},on:{mouseenter:function(t){!L.isCheck&&L.onPlay()},mouseleave:function(t){!L.isCheck&&L.onPause()}}},[L.isCheck&&L.item?P("listCheckbox",{on:{change:function(t){return L.$emit("checkChange")}},model:{value:L.item.isCheck,callback:function(t){L.$set(L.item,"isCheck",t)},expression:"item.isCheck"}}):L._e(),L._v(" "),L.item.sys_tag?P("div",{staticClass:"SysTag",style:{color:null===(t=L.sysTag[L.item.sys_tag[0]])||void 0===t?void 0:t.color,backgroundColor:null===(e=L.sysTag[L.item.sys_tag[0]])||void 0===e?void 0:e.bg}},[L._v("\n        "+L._s(L.$t(null===(n=L.sysTag[L.item.sys_tag[0]])||void 0===n?void 0:n.txt))+"\n      ")]):L._e(),L._v(" "),P("div",{directives:[{name:"show",rawName:"v-show",value:L.item.NSFWSHOW&&[2,"2"].includes(null===(o=L.userInfo)||void 0===o||null===(o=o.settings)||void 0===o?void 0:o.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{opacity:null!==(r=L.item)&&void 0!==r&&r.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),L.item.nsfw_plus=!(null!==(e=L.item)&&void 0!==e&&e.nsfw_plus)}}},[P("i",{staticClass:"iconfont",class:null!==(c=L.item)&&void 0!==c&&c.nsfw_plus?"icon-work-show":"icon-work-hide"})]),L._v(" "),1===L.item.nsfw||L.isVideoLink(L.item.cover)?1!=L.item.nsfw?P("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:L.setNsfwPlus(L.item)?"blur(19px) saturate(160%)":""},attrs:{src:L.item.cover,loop:"",muted:"",controls:!1},domProps:{muted:!0}}):L._e():P("ImgWaterFall",{class:L.isCheck?"":"cntImg",style:{transform:L.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:L.setNsfwPlus(L.item)?"blur(19px) saturate(160%)":""},attrs:{item:L.item}}),L._v(" "),P("div",{directives:[{name:"show",rawName:"v-show",value:L.greenMode,expression:"greenMode"}]},[P("div",{directives:[{name:"show",rawName:"v-show",value:L.showGreenCover,expression:"showGreenCover"}],staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:L.item.waterWidth+"px",height:L.item.waterHeight+"px"}})]),L._v(" "),P("div",{staticClass:"imgNum"},[P("i",{staticClass:"iconfont icon-imgNum"}),L._v(" "),P("span",[L._v(L._s(null===(l=L.item.portfolio)||void 0===l?void 0:l.num))])]),L._v(" "),3==L.item.status||4==L.item.status||2==L.item.status?P("div",{staticClass:"statusCnt"},[P("div",{staticClass:"statusZg"}),L._v(" "),P("div",{staticClass:"statusBox",style:{color:4==L.item.status||2==L.item.status?"#EF3B3B":"#ffffff"}},[P("i",{staticClass:"iconfont icon-statusBox"}),L._v(" "),P("div",[L._v("\n            "+L._s(4==L.item.status?L.$t("notApproved"):2==L.item.status?L.$t("Ban"):L.$t("underReview"))+"\n          ")])])]):L._e(),L._v(" "),L.isPersonal?P("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:L.handlePopoverShow}},[P("div",{staticClass:"pop-btns flex"},[P("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==L.fromPage&&L.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("addContentDecoration")}}},[L._v("\n            "+L._s(L.$t("addContentDecoration"))+"\n          ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==L.fromPage&&L.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("pinOrNot")}}},[L._v("\n            "+L._s(L.$t(null!==(d=L.item)&&void 0!==d&&d.isTop?"UnpinOverview":"PinOverview"))+"\n          ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:L.isMine,expression:"isMine"}],class:{disabled:L.isEditDisabled},on:{click:function(t){return t.preventDefault(),L.moreActions("edit")}}},[L._v("\n            "+L._s(L.$t("edit_contribution"))+"\n          ")]),L._v(" "),P("button",{on:{click:function(t){return t.preventDefault(),L.moreActions("report")}}},[L._v("\n            "+L._s(L.$t("Report"))+"\n          ")]),L._v(" "),P("button",{directives:[{name:"show",rawName:"v-show",value:3!=L.item.status&&L.isMine,expression:"item.status != 3 && isMine"}],on:{click:function(t){return t.preventDefault(),L.moreActions("delete")}}},[L._v("\n            "+L._s(L.$t("Delete"))+"\n          ")])]),L._v(" "),P("div",{staticClass:"more-btn",attrs:{slot:"reference"},slot:"reference"},[P("i",{staticClass:"iconfont icon-more"})])]):L._e()],1)]),L._v(" "),P("div",{staticClass:"objName",style:{width:L.item.waterWidth+"px"}},[L._v("\n    "+L._s(null===(h=L.item.portfolio)||void 0===h?void 0:h.name)+"\n  ")]),L._v(" "),P("div",{staticClass:"author",style:{width:L.item.waterWidth+"px"}},[P("div",{staticClass:"userBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.otherUser(L.item)}}},[P("BaseAvatar",{attrs:{userData:L.item.author,size:24}}),L._v(" "),P("div",{staticClass:"authorName"},[L._v(L._s(null===(v=L.item.author)||void 0===v?void 0:v.name))])],1),L._v(" "),L.cntShow?P("div",{staticClass:"numItem"},[P("div",{staticClass:"funItem",attrs:{"data-id":null===(f=L.item)||void 0===f?void 0:f.id,"data-type":null===(m=L.item)||void 0===m?void 0:m.obj_type,"data-pt":null===(_=L.item)||void 0===_?void 0:_.pt,"data-event":null!==(y=L.item)&&void 0!==y&&y.liked?"cancelLike":"like","data-desc":"瀑布流点赞"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.setLike(L.item,"gallery")}}},[P("i",{staticClass:"iconfont",class:L.setlikeData(L.item)}),L._v(" "),null!==(w=L.item.stat)&&void 0!==w&&w.num_of_like?P("span",[L._v(L._s(L.item.stat.num_of_like))]):L._e()]),L._v(" "),P("div",{staticClass:"funItem",attrs:{"data-id":null===(C=L.item)||void 0===C?void 0:C.id,"data-type":null===(k=L.item)||void 0===k?void 0:k.obj_type,"data-pt":null===(O=L.item)||void 0===O?void 0:O.pt,"data-event":null!==(x=L.item)&&void 0!==x&&x.collect?"cancelCollect":"collect","data-desc":"瀑布流收藏"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),L.setCollect(L.item,"gallery")}}},[P("i",{staticClass:"iconfont",class:L.setCollectData(L.item)}),L._v(" "),null!==(I=L.item.stat)&&void 0!==I&&I.num_of_collection?P("span",[L._v(L._s(L.item.stat.num_of_collection))]):L._e()])]):P("div",{staticClass:"numItem"},[P("div",{staticClass:"funItem"},[P("i",{staticClass:"iconfont",class:L.item.liked?"icon-like_selected":"icon-like"}),L._v(" "),null!==(S=L.item.stat)&&void 0!==S&&S.num_of_like?P("span",[L._v(L._s(L.item.stat.num_of_like))]):L._e()]),L._v(" "),P("div",{staticClass:"funItem"},[P("i",{staticClass:"iconfont",class:L.item.collect?"icon-collect_selected":"icon-collect"}),L._v(" "),null!==(D=L.item.stat)&&void 0!==D&&D.num_of_collection?P("span",[L._v(L._s(L.item.stat.num_of_collection))]):L._e()])])]),L._v(" "),P("admin-tag",{attrs:{id:L.item.id,item:L.item,type:"4",review:L.review},on:{change:L.tagChange}}),L._v(" "),P("HyJewelryModal",{attrs:{artwork:L.item},on:{useSuccess:L.handleJewelrySuccess},model:{value:L.jewelryModalVisible,callback:function(t){L.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"e252a028",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,BaseAvatar:n(53).default,AdminTag:n(111).default})},933:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);n(16),n(18);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(19),n(50),n(22),n(31),n(21),n(26);var l=n(10),d=n(1),h=n(39),v=n(45),f=n(111),m=n(27),_=n(207),y=n(112),w=n(63),C=n(53),k=n(278),O=n(108);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S=!1,D={mixins:[v.a],components:{AdminTag:f.default,listCheckbox:_.default,ImgWaterFall:y.default,CollectPopover:w.default,BaseAvatar:C.default,HyJewelryModal:k.default,HyColorfulBorder:O.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},review:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},sysTag:{type:Object,default:function(){}}},data:function(){var t;return{isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,formatNumberForeign:l.p,timeFormat:l.U,collectDotReportInfo:{},videoBgShow:!0,deleteLoad:!1,cntShow:!0,otherShow:!1,itemShow:!1,itemShowId:"",jewelryModalVisible:!1}},computed:I(I(I({},Object(d.c)("user",["isLoggedIn","accountSettingsData"])),Object(d.e)("user",["userInfo","adminOff"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},setNsfwPlus:function(){return function(t){return!1}},isRotate:function(){var t,e,n;return(null===(t=this.item)||void 0===t?void 0:t.needRotate)&&(null===(e=this.item)||void 0===e?void 0:e.cover_width)<(null===(n=this.item)||void 0===n?void 0:n.cover_height)},finalSize:function(){return this.isRotate?{width:this.item.waterHeight+"px",height:this.item.waterWidth+"px"}:{width:"100%",height:"auto"}}}),mounted:function(){var t=this;setTimeout((function(){t.otherShow=!0}),200)},methods:{moreActions:function(t){var e=this,n=this.item,o=n.id,r=n.obj_type;switch(t){case"report":Object(h.t)({id:o,obj_type:r}).then((function(t){e.$message({message:e.$t("ReportSuccess"),type:"success"})}));break;case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item)}},handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=I(I({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:1})},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},handleClick:function(t){var e;if(this.isLoggedIn){var n,o,r,c,l={},path="";if(1==(null==t||null===(e=t.look_book)||void 0===e?void 0:e.video_type))l={template_id:null===(n=t.look_book)||void 0===n?void 0:n.template_id,url:(null===(o=t.look_book)||void 0===o?void 0:o.template_url)||(null===(r=t.look_book)||void 0===r?void 0:r.url),height:t.cover_width,width:t.cover_height,cover:t.cover},path="ai-face-swap",this.$logEvent("log_actions",{operation:"click_create_same_image",behavior_info:"on_show_me_hover"});else l={template_id:null===(c=t.look_book)||void 0===c?void 0:c.template_id},path="ai-video-generator";l=JSON.stringify(l),this.$router.push(this.localePath("/ai-tools/".concat(path,"?info=").concat(l)))}else this.$EventBus.$emit("openLoginDialog")},onDelete:function(t){var e=this;this.$confirm(this.$t("postDeleteTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){e.deleteLoad||(e.deleteLoad=!0,Object(m.sb)({obj_id:t.id,obj_type:t.obj_type}).then((function(n){e.setWaterFallDeleteLits(t.id),e.$emit("resizeListener"),e.$message({type:"success",message:e.$t("deleteSuccess")})})).finally((function(){e.deleteLoad=!1})))})).catch((function(){}))},onPlayFun:function(){this.$refs.myVideo&&(this.$refs.myVideo.play(),this.$refs.myVideo.style.opacity=1,this.$refs.myVideo.paused||(this.videoBgShow=!1)),!S&&this.onPause()},onPlay:function(){S=!0,this.$emit("onPlay",{fun:this.onPlayFun})},onPause:function(){S=!1,this.$refs.myVideo&&(this.$refs.myVideo.pause(),this.$refs.myVideo.currentTime=0,this.$refs.myVideo.style.opacity=0),this.videoBgShow=!0},handleDetail:function(t,e){if(this.$logEvent("log_actions",{operation:"click_post",behavior_info:e.id,behavior_info_sub:"video,"+e.id}),"IMG"===t.target.tagName||"VIDEO"===t.target.tagName||"cltpop"===t.target.className||t.target.className.includes("imgBox")||"ImgWaterFall"===t.target.className||"green-mode-div"===t.target.className||"statusCnt"===t.target.className||3==e.status){if(this.checkGreen(e))return void this.$EventBus.$emit("openLoginDialog",{redirect:"/models/detail/"+e.id});this.$router.push(this.localePath("/video/"+e.id))}},checkGreen:function(t){return!this.isLoggedIn&&!(null==t||!t.green||![2,"2"].includes(t.green))},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},tagChange:function(t){if("REVIEW"===t){var e=this.$route.params;return localStorage.setItem("reviewList",JSON.stringify(this.list)),void this.$router.push(this.localePath("/video/".concat(this.item.id,"?review=1&tag=").concat(null==e?void 0:e.tag)))}this.$emit("change")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(m.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},addContentDecoration:function(){this.jewelryModalVisible=!0},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}}},L=(n(4690),n(0)),component=Object(L.a)(D,(function(){var t,e,n,o,r,l,d,h,v,f,m,_,y,w,C,k,O,x,I=this,S=I._self._c;return S("a",{attrs:{href:I.localePath("/video/"+I.item.id),target:"_blank"},on:{click:function(t){t.preventDefault(),!I.isCheck&&I.handleDetail(t,I.item)},mouseover:function(t){I.cntShow=!0}}},[S("HyColorfulBorder",{attrs:{showBorder:!1,photoFrame:I.item.work_frame,borderRadius:16,boxHeight:"100%"}},[S("div",{staticClass:"defBox marking-item",class:{"bg-nsfw":1===I.item.nsfw,boxItem:!I.setNsfwPlus(I.item)},style:{width:I.item.waterWidth+"px",height:I.item.waterHeight+"px"},on:{mouseenter:function(t){!I.isCheck&&I.onPlay()},mouseleave:function(t){!I.isCheck&&I.onPause()}}},[[1,3].includes(null===(t=I.item)||void 0===t||null===(t=t.look_book)||void 0===t?void 0:t.video_type)?S("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),I.handleClick(I.item)}}},[I._v("\n        "+I._s(I.$t("Remix"))+"\n      ")]):I._e(),I._v(" "),S("div",{directives:[{name:"show",rawName:"v-show",value:I.isLoggedIn,expression:"isLoggedIn"}],staticClass:"cltpop",style:{opacity:I.itemShow&&I.itemShowId==I.item.id?1:0}}),I._v(" "),I.isCheck&&I.item&&I.otherShow?S("listCheckbox",{on:{change:function(t){return I.$emit("checkChange")}},model:{value:I.item.isCheck,callback:function(t){I.$set(I.item,"isCheck",t)},expression:"item.isCheck"}}):I._e(),I._v(" "),I.item.sys_tag&&I.otherShow?S("div",{staticClass:"SysTag",style:{color:null===(e=I.sysTag[I.item.sys_tag[0]])||void 0===e?void 0:e.color,backgroundColor:null===(n=I.sysTag[I.item.sys_tag[0]])||void 0===n?void 0:n.bg}},[I._v("\n        "+I._s(I.$t(null===(o=I.sysTag[I.item.sys_tag[0]])||void 0===o?void 0:o.txt))+"\n      ")]):I._e(),I._v(" "),S("div",{directives:[{name:"show",rawName:"v-show",value:I.item.NSFWSHOW&&[2,"2"].includes(null===(r=I.userInfo)||void 0===r||null===(r=r.settings)||void 0===r?void 0:r.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{right:null!==(l=I.item)&&void 0!==l&&l.nsfw_plus?"10px":"75px",opacity:null!==(d=I.item)&&void 0!==d&&d.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),I.item.nsfw_plus=!(null!==(e=I.item)&&void 0!==e&&e.nsfw_plus)}}},[S("i",{staticClass:"iconfont",class:null!==(h=I.item)&&void 0!==h&&h.nsfw_plus?"icon-work-show":"icon-work-hide"})]),I._v(" "),1!==I.item.nsfw?S("ImgWaterFall",{style:{transform:I.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:I.setNsfwPlus(I.item)?"blur(19px) saturate(160%)":""},attrs:{item:I.item}}):I._e(),I._v(" "),[!I.isCheck&&I.otherShow?S("video",{ref:"myVideo",class:{rotate:I.isRotate},style:c({filter:I.setNsfwPlus(I.item)?"blur(19px) saturate(160%)":""},I.finalSize),attrs:{loop:"",muted:"",src:null===(v=I.item.look_book)||void 0===v?void 0:v.url,preload:"none"},domProps:{muted:!0}}):I._e()],I._v(" "),S("div",{directives:[{name:"show",rawName:"v-show",value:2!==(null===(f=I.userInfo)||void 0===f||null===(f=f.settings)||void 0===f?void 0:f.green_mode)&&I.otherShow,expression:"userInfo?.settings?.green_mode !== 2 && otherShow"}]},[[2,"2"].includes(I.item.green)&&!["/personal"].includes(I.$route.path)?S("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:I.item.waterWidth+"px",height:I.item.waterHeight+"px"}}):I._e()]),I._v(" "),S("div",{staticClass:"foot-box"},[S("div",{staticClass:"play-times"},[S("i",{staticClass:"iconfont icon-icon_Views"}),I._v(" "),S("span",{staticClass:"imgBox-num-item-text"},[I._v("\n            "+I._s(I.formatNumberForeign((null===(m=I.item)||void 0===m||null===(m=m.stat)||void 0===m?void 0:m.num_of_view)||0))+"\n          ")])]),I._v(" "),I.videoBgShow&&I.otherShow?S("div",{staticClass:"duration"},[I._v("\n          "+I._s(I.timeFormat(null===(_=I.item.look_book)||void 0===_?void 0:_.duration))+"\n        ")]):I._e()]),I._v(" "),S("admin-tag",{attrs:{id:I.item.id,item:I.item,type:"5",review:I.review},on:{change:I.tagChange}}),I._v(" "),3!=I.item.status&&4!=I.item.status&&2!=I.item.status||!I.otherShow?I._e():S("div",{staticClass:"statusCnt"},[S("div",{staticClass:"statusZg"}),I._v(" "),S("div",{staticClass:"statusBox",style:{color:4==I.item.status||2==I.item.status?"#EF3B3B":"#ffffff"}},[S("i",{staticClass:"iconfont icon-statusBox"}),I._v(" "),S("div",[I._v("\n            "+I._s(4==I.item.status?I.$t("notApproved"):2==I.item.status?I.$t("Ban"):I.$t("underReview"))+"\n          ")])])]),I._v(" "),I.isPersonal?S("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:I.handlePopoverShow}},[S("div",{staticClass:"pop-btns flex"},[S("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==I.fromPage&&I.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),I.addContentDecoration()}}},[I._v("\n            "+I._s(I.$t("addContentDecoration"))+"\n          ")]),I._v(" "),S("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==I.fromPage&&I.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),I.moreActions("pinOrNot")}}},[I._v("\n            "+I._s(I.$t(null!==(y=I.item)&&void 0!==y&&y.isTop?"UnpinOverview":"PinOverview"))+"\n          ")]),I._v(" "),S("button",{on:{click:function(t){return t.preventDefault(),I.moreActions("report")}}},[I._v("\n            "+I._s(I.$t("Report"))+"\n          ")]),I._v(" "),S("button",{directives:[{name:"show",rawName:"v-show",value:I.isMine,expression:"isMine"}],on:{click:function(t){return t.preventDefault(),I.moreActions("delete")}}},[I._v("\n            "+I._s(I.$t("Delete"))+"\n          ")])]),I._v(" "),3!=I.item.status?S("div",{staticClass:"more-btn",attrs:{slot:"reference"},slot:"reference"},[S("i",{staticClass:"iconfont icon-more"})]):I._e()]):I._e()],2)]),I._v(" "),I.otherShow?S("div",{staticClass:"objName"},[I._v("\n    "+I._s(null===(w=I.item.look_book)||void 0===w?void 0:w.name)+"\n  ")]):I._e(),I._v(" "),I.otherShow?S("div",{staticClass:"author"},[S("div",{staticClass:"userBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),I.otherUser(I.item)}}},[S("BaseAvatar",{attrs:{userData:I.item.author,size:24}}),I._v(" "),S("div",{staticClass:"authorName"},[I._v(I._s(null===(C=I.item.author)||void 0===C?void 0:C.name))])],1),I._v(" "),I.cntShow?S("div",{staticClass:"numItem"},[S("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),I.setLike(I.item,"lookbook")}}},[S("i",{staticClass:"iconfont",class:I.setlikeData(I.item)}),I._v(" "),null!==(k=I.item.stat)&&void 0!==k&&k.num_of_like?S("span",[I._v(I._s(I.item.stat.num_of_like))]):I._e()])]):S("div",{staticClass:"numItem"},[S("div",{staticClass:"funItem"},[S("i",{staticClass:"iconfont",class:I.item.liked?"icon-like_selected":"icon-like"}),I._v(" "),null!==(O=I.item.stat)&&void 0!==O&&O.num_of_like?S("span",[I._v(I._s(I.item.stat.num_of_like))]):I._e()]),I._v(" "),S("div",{staticClass:"funItem"},[S("i",{class:I.item.collect?"icon-collect_selected":"icon-icon-collect"}),I._v(" "),null!==(x=I.item.stat)&&void 0!==x&&x.num_of_collection?S("span",[I._v(I._s(I.item.stat.num_of_collection))]):I._e()])])]):I._e(),I._v(" "),S("HyJewelryModal",{attrs:{artwork:I.item},on:{useSuccess:I.handleUseJewelrySuccess},model:{value:I.jewelryModalVisible,callback:function(t){I.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"80ebe778",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,AdminTag:n(111).default,BaseAvatar:n(53).default})},934:function(t,e,n){"use strict";n(16),n(18),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(6),n(50),n(22),n(31),n(4),n(21),n(26),n(39)),c=n(45),l=n(112),d=n(1),h=n(63),v=n(207),f=n(111),m=n(27),_=n(53);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={mixins:[c.a],components:{CollectPopover:h.default,ImgWaterFall:l.default,listCheckbox:v.default,AdminTag:f.default,BaseAvatar:_.default},props:{fromPage:{type:String,default:""},item:{type:Object,default:function(){}},list:{type:Array,default:function(){return[]}},isCheck:{type:Boolean,default:!1}},computed:w(w(w({},Object(d.c)("user",["isLoggedIn"])),Object(d.e)("user",["userInfo"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},setNsfwPlus:function(){return function(t){return!1}}}),data:function(){var t;return{isPersonal:null===(t=this.$route.meta)||void 0===t?void 0:t.isPersonal,cntShow:!0,otherShow:!1,itemShow:!1,itemShowId:"",collectDotReportInfo:{},from:"waterfall"}},mounted:function(){var t=this;setTimeout((function(){t.otherShow=!0}),200)},methods:{moreActions:function(t){switch(t){case"delete":this.$emit("moreActions","delete",this.item);break;case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item)}},handleReport:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(r.i)({items:[w(w({},this.dotReportInfo),{},{negative_ids:n,action:"view",obj_no:t.id,obj_type:11})]})},handleMouseUp:function(t,e){2!==t.which&&1!==t.button||this.handleReport(e)},handleDetail:function(t,e){var n,o="string"==typeof t.target.className&&(null===(n=t.target.className)||void 0===n?void 0:n.includes("boxItem"));("IMG"===t.target.tagName||"cltpop"===t.target.className||o||"ImgWaterFall"===t.target.className||"green-mode-div"===t.target.className)&&(this.handleReport(e),this.$router.push(this.localePath("/editBoard/detail/"+e.id)))},handleClick:function(t){var e;this.isLoggedIn?(this.$router.push(this.localePath("/editBoard?remix_id=".concat(t.id,"&publish_type=").concat(null===(e=t.palette)||void 0===e?void 0:e.publish_type))),this.$logEvent("log_actions",{operation:"click_create_same_image",behavior_info:"on_canvas_page"})):this.$EventBus.$emit("openLoginDialog")},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=w(w({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:11})},tagChange:function(t){this.$emit("change",t)},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(m.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}}}},k=(n(4691),n(0)),component=Object(k.a)(C,(function(){var t,e,n,o,r,c,l,d,h,v,f,m,_,y=this,w=y._self._c;return w("a",{attrs:{href:y.localePath("/editBoard/detail/"+y.item.id)},on:{click:function(t){t.preventDefault(),!y.isCheck&&y.handleDetail(t,y.item)},mouseup:function(t){return y.handleMouseUp(t,y.item)},mouseover:function(t){y.cntShow=!0}}},[w("div",{ref:"boxItem",staticClass:"defBox",class:{"bg-nsfw":1===y.item.nsfw,boxItem:!y.setNsfwPlus(y.item)}},[y.isCheck&&y.item?w("listCheckbox",{on:{change:function(t){return y.$emit("checkChange")}},model:{value:y.item.isCheck,callback:function(t){y.$set(y.item,"isCheck",t)},expression:"item.isCheck"}}):y._e(),y._v(" "),w("div",{directives:[{name:"show",rawName:"v-show",value:y.item.NSFWSHOW&&[2,"2"].includes(null===(t=y.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus),expression:"item.NSFWSHOW && [2, '2'].includes(userInfo?.settings?.nsfw_plus)"}],staticClass:"NSFWSHOW",style:{right:null!==(e=y.item)&&void 0!==e&&e.nsfw_plus?"10px":"75px",opacity:null!==(n=y.item)&&void 0!==n&&n.nsfw_plus?1:0},on:{click:function(t){var e;t.preventDefault(),t.stopPropagation(),y.item.nsfw_plus=!(null!==(e=y.item)&&void 0!==e&&e.nsfw_plus)}}},[w("i",{staticClass:"iconfont",class:null!==(o=y.item)&&void 0!==o&&o.nsfw_plus?"icon-work-show":"icon-work-hide"})]),y._v(" "),1!==y.item.nsfw?w("ImgWaterFall",{class:y.isCheck?"":"cntImg",style:{transform:y.item.isCheck?"scale(0.85)":null,transition:"all 0.3s ease-in-out",filter:y.setNsfwPlus(y.item)?"blur(19px) saturate(160%)":""},attrs:{item:y.item}}):y._e(),y._v(" "),w("div",{directives:[{name:"show",rawName:"v-show",value:2!==(null===(r=y.userInfo)||void 0===r||null===(r=r.settings)||void 0===r?void 0:r.green_mode)&&y.otherShow,expression:"userInfo?.settings?.green_mode !== 2 && otherShow"}]},[[2,"2"].includes(y.item.green)&&!["/personal"].includes(y.$route.path)?w("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:y.item.waterWidth+"px",height:y.item.waterHeight+"px"}}):y._e()]),y._v(" "),2==(null===(c=y.item.palette)||void 0===c?void 0:c.publish_type)?w("div",{staticClass:"paletIcon"},[w("i",{staticClass:"iconfont icon-a-VectorStroke"})]):y._e(),y._v(" "),y.cntShow&&y.otherShow&&!y.isCheck?w("div",[w("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),y.handleClick(y.item)}}},[y._v("\n        "+y._s(y.$t("Remix"))+"\n      ")]),y._v(" "),w("CollectPopover",{directives:[{name:"show",rawName:"v-show",value:y.isLoggedIn,expression:"isLoggedIn"}],staticClass:"CollectPop",style:{opacity:y.itemShow&&y.itemShowId==y.item.id?1:0},attrs:{dotReportInfo:y.collectDotReportInfo,type:"palette",folder:y.item,from:"waterfall"},on:{showChaneg:y.changeItemShow}}),y._v(" "),w("div",{directives:[{name:"show",rawName:"v-show",value:y.isLoggedIn,expression:"isLoggedIn"}],staticClass:"cltpop",style:{opacity:y.itemShow&&y.itemShowId==y.item.id?1:0}}),y._v(" "),y.isPersonal?w("el-popover",{ref:"myPopover",attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:y.handlePopoverShow}},[w("div",{staticClass:"pop-btns flex"},[w("button",{directives:[{name:"show",rawName:"v-show",value:"userPage"==y.fromPage&&y.isMine,expression:"fromPage == 'userPage' && isMine"}],on:{click:function(t){return t.preventDefault(),y.moreActions("pinOrNot")}}},[y._v("\n            "+y._s(y.$t(null!==(l=y.item)&&void 0!==l&&l.isTop?"UnpinOverview":"PinOverview"))+"\n          ")]),y._v(" "),w("button",{directives:[{name:"show",rawName:"v-show",value:3!=y.item.status&&y.isMine,expression:"item.status != 3 && isMine"}],on:{click:function(t){return t.preventDefault(),y.moreActions("delete")}}},[y._v("\n            "+y._s(y.$t("Delete"))+"\n          ")])]),y._v(" "),w("div",{staticClass:"more-btn",attrs:{slot:"reference"},slot:"reference"},[w("i",{staticClass:"iconfont icon-more"})])]):y._e()],1):y._e()],1),y._v(" "),y.otherShow?w("div",{staticClass:"objName",style:{width:y.item.waterWidth+"px"}},[y._v("\n    "+y._s(null===(d=y.item.palette)||void 0===d?void 0:d.title)+"\n  ")]):y._e(),y._v(" "),y.otherShow?w("div",{staticClass:"author",style:{width:y.item.waterWidth+"px",marginTop:"8px"}},[w("div",{staticClass:"userBox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),y.otherUser(y.item)}}},[y.item.author?w("BaseAvatar",{staticStyle:{"margin-right":"6px"},attrs:{"user-data":y.item.author,size:24}}):y._e(),y._v(" "),w("div",{staticClass:"authorName"},[y._v(y._s(null===(h=y.item.author)||void 0===h?void 0:h.name))])],1),y._v(" "),y.cntShow?w("div",{staticClass:"numItem"},[w("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),y.setLike(y.item,"palette","waterfall")}}},[w("i",{staticClass:"iconfont",class:y.setlikeData(y.item)}),y._v(" "),null!==(v=y.item.stat)&&void 0!==v&&v.num_of_like?w("span",[y._v(y._s(y.item.stat.num_of_like))]):y._e()]),y._v(" "),w("div",{staticClass:"funItem",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),y.setCollect(y.item,"palette")}}},[w("i",{staticClass:"iconfont",class:y.setCollectData(y.item)}),y._v(" "),null!==(f=y.item.stat)&&void 0!==f&&f.num_of_collection?w("span",[y._v(y._s(y.item.stat.num_of_collection))]):y._e()])]):w("div",{staticClass:"numItem"},[w("div",{staticClass:"funItem"},[w("i",{staticClass:"iconfont",class:y.item.liked?"icon-like_selected":"icon-like"}),y._v(" "),null!==(m=y.item.stat)&&void 0!==m&&m.num_of_like?w("span",[y._v(y._s(y.item.stat.num_of_like))]):y._e()]),y._v(" "),w("div",{staticClass:"funItem"},[w("i",{staticClass:"iconfont",class:y.item.collect?"icon-collect_selected":"icon-collect"}),y._v(" "),null!==(_=y.item.stat)&&void 0!==_&&_.num_of_collection?w("span",[y._v(y._s(y.item.stat.num_of_collection))]):y._e()])]),y._v(" "),w("admin-tag",{attrs:{id:y.item.id,type:"11",item:y.item},on:{change:y.tagChange}})],1):y._e()])}),[],!1,null,"21517865",null);e.a=component.exports;installComponents(component,{ImgWaterFall:n(112).default,CollectPopover:n(63).default,BaseAvatar:n(53).default,AdminTag:n(111).default})},935:function(t,e,n){"use strict";n(16),n(18),n(11),n(72),n(89),n(69),n(31),n(12),n(13),n(8),n(28),n(43),n(40),n(7),n(41);var o=n(14),r=n(2),c=(n(19),n(6),n(22),n(4),n(256)),l=n(112),d=n(207),h=n(10),v=n(257),f=n(45),m=n(1),_=n(9),y=n(27),w=n(39),C=n(53),k=n(278),O=n(108);function x(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return I(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?I(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,c=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function I(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={components:{ImgWaterFall:l.default,AiChatReport:v.a,AudioPlayer:c.a,listCheckbox:d.default,BaseAvatar:C.default,HyJewelryModal:k.default,HyColorfulBorder:O.default},mixins:[f.a],props:{isCheck:{type:Boolean,default:!1},fromPage:{type:String,default:""},item:{type:Object,default:function(){}},outerClass:{type:String,default:"recList"}},data:function(){return{formatNumberForeign:h.p,jewelryModalVisible:!1}},watch:{$route:{handler:function(){var t;null===(t=this.$refs)||void 0===t||null===(t=t.myPopover)||void 0===t||t.doClose()}}},computed:D(D(D(D({},Object(m.e)("user",["token"])),Object(m.c)("user",["isLoggedIn"])),Object(m.e)("user",["userInfo"])),{},{isMine:function(){var t,e;return(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)},selfTag:function(){var t,e,n=(null===(t=this.item)||void 0===t?void 0:t.timbre)||null,o=[];return null!=n&&null!==(e=n.tags)&&void 0!==e&&e.length&&(o=null==n?void 0:n.tags.map((function(t){return t.title}))),o},attrTags:function(){var t,e=(null===(t=this.item)||void 0===t?void 0:t.timbre)||null,n=[];if(e){var o=[],r=[],c=[];if(e.gender){var l=_.I.filter((function(t){return t.value===e.gender}))||[];l.length&&r.push(l[0].i18Key)}if(e.age){var d=_.I.filter((function(t){return t.value===e.age}))||[];d.length&&o.push(d[0].i18Key)}if(null!=e&&e.tones&&null!=e&&e.tones.length){var h,v=x(null==e?void 0:e.tones);try{for(v.s();!(h=v.n()).done;){var f,m=h.value,y=x(_.I);try{for(y.s();!(f=y.n()).done;){var w=f.value;w.value===m&&c.push(w.i18Key)}}catch(t){y.e(t)}finally{y.f()}}}catch(t){v.e(t)}finally{v.f()}}return n=[].concat(o,r,c)}return n},getImageUrl:function(){return function(t){var e="";return t.cover&&!["",null,void 0].includes(t.cover)?e=Object(h.K)(t.cover,this.$imgL):e}},renderMoreActions:function(){var t=[{label:"Share",type:"share"}];if(this.isMine){var e,n=[{label:"addContentDecoration",type:"addContentDecoration"},{label:null!==(e=this.item)&&void 0!==e&&e.isTop?"UnpinOverview":"PinOverview",type:"pinOrNot"},{label:"Edit",type:"edit"},{label:"Delete",type:"delete"}];t=[].concat(n,Object(o.a)(t))}return t}}),methods:{handleToCreate:function(){var t,e=this.localePath("/ai-audio/create/".concat(null===(t=this.item)||void 0===t?void 0:t.id));this.$router.push(e)},handleClickSame:function(t){var e=this.localePath("/ai-audio/create/".concat(null==t?void 0:t.id));this.$router.push(e)},goDetail:function(){var t;this.isCheck||this.$router.push(this.localePath("/ai-audio/detail/".concat(null===(t=this.item)||void 0===t?void 0:t.id)))},handleActions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.item.obj_type;switch(t){case"pinOrNot":this.$emit("moreActions","pinOrNot",this.item);break;case"delete":this.$emit("moreActions","delete",this.item);break;case"report":try{this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_report"}),this.$refs.AiChatReport.open()}catch(t){}break;case"share":this.$logEvent("log_actions",{operation:"click_share",behavior_info:"on_personal_center",behavior_info_sub:e}),this.handleShare();break;case"edit":this.$logEvent("log_actions",{operation:"click_edit",behavior_info:"on_personal_center",behavior_info_sub:e}),this.handleEdit();break;case"download":this.handleDownload();break;case"addContentDecoration":this.addContentDecoration()}},handleShare:function(){Object(w.i)({items:[{action:"share",obj_no:this.item.id,obj_type:16}]});var t=location.host+this.localePath("/ai-audio/detail/".concat(this.item.id,"/share"));Object(h.g)(t),this.$message.success(this.$t("CopiedURLToClipboard"))},handleDownload:function(){var t,e=this;if(this.isLoggedIn){var n=(null===(t=this.item)||void 0===t?void 0:t.url)||"";Object(h.L)({url:n,scene:3,fileName:"AI_Audio_".concat(formatTime_yyyymmdd_hhmm(),".mp3")})}else this.$EventBus.$emit("openLoginDialog",{callBack:function(){e.handleDownload()}})},handleEdit:function(){var t;this.$router.push(this.localePath("/ai-audio/train/"+(null===(t=this.item)||void 0===t?void 0:t.id)))},otherUser:function(t){this.$logEvent("log_actions",{operation:"click_author_image",behavior_info:"on_ai_audio_waterfall_flow",behavior_info_sub:t.id});var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),window.open(this.localePath(path),"_blank")},handlePopoverShow:function(){var t=this;if("userPage"===this.fromPage){var e=this.item,n=e.id,o=e.obj_type;Object(y.fb)({obj_id:n,obj_type:o}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&t.$set(t.item,"isTop",null==e||null===(o=e.data)||void 0===o?void 0:o.is_top)}))}},addContentDecoration:function(){this.jewelryModalVisible=!0},handleUseJewelrySuccess:function(){this.$emit("useJewelrySuccess")}},mounted:function(){}},P=L,j=(n(4695),n(0)),component=Object(j.a)(P,(function(){var t,e,n,o,r,c,l,d,h,v,f=this,m=f._self._c;return m("a",{attrs:{href:f.localePath("/ai-audio/detail/".concat(null===(t=f.item)||void 0===t?void 0:t.id))},on:{click:function(t){return t.preventDefault(),f.goDetail.apply(null,arguments)}}},[m("div",{staticClass:"ai-audio-item",style:{width:f.item.waterWidth+"px",height:f.item.waterHeight+"px"}},[f.isCheck&&f.item?m("listCheckbox",{on:{change:function(t){return f.$emit("checkChange")}},model:{value:f.item.isCheck,callback:function(t){f.$set(f.item,"isCheck",t)},expression:"item.isCheck"}}):f._e(),f._v(" "),m("HyColorfulBorder",{attrs:{photoFrame:f.item.work_frame,borderRadius:16}},[m("div",{staticClass:"ai-audio-item-top"},[m("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"water-fall-popover-audio","append-to-body":!1,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"100",trigger:"click"},on:{show:f.handlePopoverShow}},[m("div",{staticClass:"pop-btns flex"},f._l(f.renderMoreActions,(function(t){return m("button",{key:t.type,on:{click:function(e){return e.preventDefault(),e.stopPropagation(),f.handleActions(t.type)}}},[m("span",{staticClass:"pop-btns-text"},[f._v(f._s(f.$t(t.label)))])])})),0),f._v(" "),m("div",{staticClass:"login-waterFall-btn-icon",attrs:{slot:"reference"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}},slot:"reference"},[m("i",{staticClass:"iconfont icon-more"})])]),f._v(" "),m("div",{staticClass:"imgBox"},[["",null,void 0].includes(null===(e=f.item)||void 0===e?void 0:e.cover)?m("div",{staticClass:"avatar-img"},[m("div",{staticClass:"image-empty"},[f._v(f._s(f.$t("EmptyBannerText")))])]):m("el-image",{staticClass:"avatar-img",attrs:{fit:"contain",src:f.getImageUrl(f.item),alt:null===(n=f.item.timbre)||void 0===n?void 0:n.name}},[m("template",{slot:"error"},[m("img",{directives:[{name:"webp",rawName:"v-webp",value:f.$imgL,expression:"$imgL"}],staticClass:"avatar-img",attrs:{src:f.item.cover,alt:null===(o=f.item.timbre)||void 0===o?void 0:o.name}})])],2),f._v(" "),m("AudioPlayer",{attrs:{modelPlay:"",item:f.item.timbre,needBorder:"",logParams:{operation:"click_broadcast",behavior_info:"on_ai_audio_waterfall_flow",behavior_info_sub:null===(r=f.item)||void 0===r?void 0:r.id}}})],1),f._v(" "),m("div",{staticClass:"ai-audio-name",attrs:{title:null===(c=f.item.timbre)||void 0===c?void 0:c.name}},[f._v("\n          "+f._s(null===(l=f.item.timbre)||void 0===l?void 0:l.name)+"\n        ")]),f._v(" "),m("div",{staticClass:"item-content-tags"},[f.attrTags.length?f._l(f.attrTags,(function(t,e){return m("span",{key:t+e,staticClass:"item-content-tags-item"},[f._v("\n              "+f._s(f.$t(t))+"\n            ")])})):f._e(),f._v(" "),f.selfTag.length?f._l(f.selfTag,(function(t,e){return m("span",{key:t+e,staticClass:"item-content-tags-item"},[f._v("\n              "+f._s(t)+"\n            ")])})):f._e(),f._v(" "),m("div",{staticClass:"waterfall-hover-try",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),f.handleClickSame(f.item)}}},[f._v("\n            "+f._s(f.$t("Generate"))+"\n          ")])],2)],1)]),f._v(" "),m("div",{staticClass:"ai-audio-item-bottom",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[m("div",{staticClass:"author-box",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),f.otherUser(f.item)}}},[m("BaseAvatar",{attrs:{userData:f.item.author,size:24}}),f._v(" "),m("div",{staticClass:"authorName"},[m("span",[f._v(f._s(null===(d=f.item.author)||void 0===d?void 0:d.name))])])],1),f._v(" "),m("div",{staticClass:"imgBox-num"},[m("div",{staticClass:"imgBox-num-item",on:{click:f.handleToCreate}},[m("i",{staticClass:"iconfont icon-play imgBox-num-item-icon"}),f._v(" "),m("span",{staticClass:"imgBox-num-item-text"},[f._v("\n            "+f._s(f.formatNumberForeign((null===(h=f.item)||void 0===h||null===(h=h.stat)||void 0===h?void 0:h.num_of_task)||0))+"\n          ")])]),f._v(" "),m("div",{staticClass:"imgBox-num-item imgBox-num-item-collect",on:{click:function(t){return f.setCollect(f.item,"ai_audio")}}},[m("div",{staticClass:"imgBox-num-item-icon"},[m("i",{staticClass:"iconfont",class:f.setCollectData(f.item)})]),f._v(" "),m("span",{staticClass:"imgBox-num-item-text"},[f._v("\n            "+f._s(f.formatNumberForeign((null===(v=f.item)||void 0===v||null===(v=v.stat)||void 0===v?void 0:v.num_of_collection)||0))+"\n          ")])])])])],1),f._v(" "),m("ai-chat-report",{ref:"AiChatReport",attrs:{"ai-chat-id":f.item.id}}),f._v(" "),m("HyJewelryModal",{attrs:{artwork:f.item},on:{useSuccess:f.handleUseJewelrySuccess},model:{value:f.jewelryModalVisible,callback:function(t){f.jewelryModalVisible=t},expression:"jewelryModalVisible"}})],1)}),[],!1,null,"85d37dac",null);e.a=component.exports;installComponents(component,{BaseAvatar:n(53).default})},936:function(t,e,n){"use strict";var o={props:{options:{type:Array,default:function(){return[]}},placement:{type:String,default:"top-end"}},data:function(){return{}},methods:{handlePopoverShow:function(){this.$emit("handlePopoverShow")},moreActions:function(t){this.$emit("moreActions",t)}}},r=(n(4029),n(4030),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("el-popover",{ref:"myPopover",attrs:{placement:t.placement,"popper-class":"water-fall-popover water-fall-popover-fcc","append-to-body":!0,"visible-arrow":!1,width:"100",trigger:"hover"},on:{show:t.handlePopoverShow}},[e("div",{staticClass:"pop-btns flex"},t._l(t.options,(function(option){return e("button",{key:option.label,on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.moreActions(option.type)}}},[e("i",{class:option.icon}),t._v("\n      "+t._s(t.$t("".concat(option.i18nKey)))+"\n    ")])})),0),t._v(" "),e("div",{staticClass:"item-cover-operate",attrs:{slot:"reference"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}},slot:"reference"},[e("i",{staticClass:"iconfont icon-more"})])])}),[],!1,null,"2cdee755",null);e.a=component.exports},937:function(t,e,n){"use strict";n(24),n(8);var o=n(36),r={name:"ClaimDialog",props:{type:{type:[String,Number],default:""}},data:function(){return{dialogVisible:!1,wrote:!1,btnLoading:!1,formData:{userName:"",userID:"",userAccount:"",contractMethod:"",contractInfo:""},rules:{userName:[{required:!0,message:this.$t("plsEnterUserName"),trigger:"blur"}],userID:[{required:!0,message:this.$t("plsEnterUserID"),trigger:"blur"}],userAccount:[{required:!0,message:this.$t("plsEnterUserAccount"),trigger:"blur"}],contractMethod:[{required:!0,message:this.$t("plsSelectContractMethod"),trigger:"change"}],contractInfo:[{required:!0,message:this.$t("plsEnterContractInfo"),trigger:"blur"}]}}},mounted:function(){},computed:{},methods:{showDialog:function(){this.dialogVisible=!0,this.getClaimAwardInfo()},closed:function(){this.dialogVisible=!1,this.wrote=!1,this.btnLoading=!1,this.formData={userName:"",userID:"",userAccount:"",contractMethod:"",contractInfo:""}},getClaimAwardInfo:function(){var t=this;Object(o.getClaimAwardInfo)({rank_type:this.type}).then((function(e){var n,o=null==e||null===(n=e.data)||void 0===n?void 0:n.content;o&&(t.wrote=!0,t.formData=JSON.parse(o))}))},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return console.log("error submit!!"),!1;t.btnLoading=!0,Object(o.claimAwardSubmit)({rank_type:t.type,content:JSON.stringify(t.formData)}).then((function(e){t.$message.success(t.$t("SubmitSuccess")),t.btnLoading=!1,t.dialogVisible=!1})).catch((function(e){console.log("err",e),t.btnLoading=!1,t.dialogVisible=!1}))}))}}},c=(n(4769),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"claim-award",attrs:{visible:t.dialogVisible,width:"858px","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.closed}},[e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("ClaimOfAward")))]),t._v(" "),e("el-form",{ref:"form",attrs:{model:t.formData,"status-icon":"",rules:t.rules}},[e("el-form-item",{attrs:{prop:"userName",required:""}},[e("div",{staticClass:"label"},[e("span",{staticClass:"star"},[t._v("*")]),t._v(" "),e("span",{staticClass:"number"},[t._v("1.")]),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(t.$t("ClaimDialogUserName")))])]),t._v(" "),e("el-input",{attrs:{disabled:t.wrote},model:{value:t.formData.userName,callback:function(e){t.$set(t.formData,"userName",e)},expression:"formData.userName"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"userID",required:""}},[e("div",{staticClass:"label"},[e("span",{staticClass:"star"},[t._v("*")]),t._v(" "),e("span",{staticClass:"number"},[t._v("2.")]),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(t.$t("ClaimDialogUserID")))])]),t._v(" "),e("el-input",{attrs:{disabled:t.wrote},model:{value:t.formData.userID,callback:function(e){t.$set(t.formData,"userID",e)},expression:"formData.userID"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"userAccount",required:""}},[e("div",{staticClass:"label"},[e("span",{staticClass:"star"},[t._v("*")]),t._v(" "),e("span",{staticClass:"number"},[t._v("3.")]),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(t.$t("ClaimDialogAccount")))])]),t._v(" "),e("div",{staticClass:"sub-label"},[t._v(t._s(t.$t("ClaimDialogSubLabelOne")))]),t._v(" "),e("el-input",{attrs:{disabled:t.wrote},model:{value:t.formData.userAccount,callback:function(e){t.$set(t.formData,"userAccount",e)},expression:"formData.userAccount"}})],1),t._v(" "),e("el-form-item",{staticClass:"contract-type",attrs:{prop:"contractMethod",required:""}},[e("div",{staticClass:"label"},[e("span",{staticClass:"star"},[t._v("*")]),t._v(" "),e("span",{staticClass:"number"},[t._v("4.")]),t._v(" "),e("span",{staticClass:"words"},[t._v(t._s(t.$t("ClaimDialogContractMethod")))])]),t._v(" "),e("div",{staticClass:"sub-label"},[t._v(t._s(t.$t("ClaimDialogSubLabelTwo")))]),t._v(" "),e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.wrote,placeholder:t.$t("plsSelectContractMethodPlaceholder")},model:{value:t.formData.contractMethod,callback:function(e){t.$set(t.formData,"contractMethod",e)},expression:"formData.contractMethod"}},[e("el-option",{attrs:{label:t.$t("wechat"),value:"wechat"}}),t._v(" "),e("el-option",{attrs:{label:"Discord ID",value:"discord_id"}}),t._v(" "),e("el-option",{attrs:{label:t.$t("Email"),value:"email"}})],1)],1),t._v(" "),e("el-form-item",{staticClass:"contract-info",attrs:{prop:"contractInfo",required:""}},[e("el-input",{attrs:{disabled:t.wrote},model:{value:t.formData.contractInfo,callback:function(e){t.$set(t.formData,"contractInfo",e)},expression:"formData.contractInfo"}})],1)],1),t._v(" "),e("el-button",{staticClass:"submit",attrs:{loading:t.btnLoading,disabled:t.wrote},on:{click:t.handleSubmit}},[t._v("\n    "+t._s(t.$t("Submit"))+"\n  ")])],1)}),[],!1,null,null,null);e.a=component.exports},938:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"PersonInfo",props:["authorInfo","fontStyle","headStyle"],components:{},computed:l(l(l({},Object(r.e)("user",["userInfo","token"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),{},{headBg:function(){var t;return l(l({},this.headStyle),{},{"background-color":null!==(t=this.authorInfo)&&void 0!==t&&t.head?"transparent":"#ADB8CD"})},authorName:function(){var t,e,n=(null===(t=this.authorInfo)||void 0===t?void 0:t.name)||(null===(e=this.authorInfo)||void 0===e?void 0:e.id);return n?n[0].toUpperCase():"-"}}),data:function(){return{}},mounted:function(){},methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.authorInfo)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))}}},h=(n(4991),n(0)),component=Object(h.a)(d,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"person-info flex items-center"},[o("div",{staticClass:"head",style:n.headBg,on:{click:function(t){return t.stopPropagation(),n.jumpToOtherUser.apply(null,arguments)}}},[null!==(t=n.authorInfo)&&void 0!==t&&t.head?o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"avatar",attrs:{src:null===(e=n.authorInfo)||void 0===e?void 0:e.head,width:"40",height:"40",loading:"lazy",alt:"avatar"}}):o("div",{staticClass:"letter"},[n._v("\n      "+n._s(n.authorName)+"\n    ")])]),n._v(" "),o("div",{staticClass:"name flex flex-col",on:{click:function(t){return t.stopPropagation(),n.jumpToOtherUser.apply(null,arguments)}}},[o("a",{staticClass:"personal-info-a",style:n.fontStyle,attrs:{href:n.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[n._v("\n      "+n._s(n.authorInfo.name||n.authorInfo.id)+"\n    ")])])])}),[],!1,null,"2f5b94d9",null);e.a=component.exports},941:function(t,e,n){"use strict";n(24),n(65);var o=n(25),r={name:"AiChatCustomSlider",props:{value:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:2},step:{type:Number,default:.01},showLabels:{type:Boolean,default:!1},decimal:{type:Number,default:2}},data:function(){return{isDragging:!1,debouncedEmit:null,lastValue:null}},created:function(){var t=this;this.debouncedEmit=Object(o.debounce)((function(e){t.$emit("change",e)}),1e3,{leading:!1,trailing:!0})},beforeDestroy:function(){this.debouncedEmit&&this.debouncedEmit.cancel&&(null!==this.lastValue&&this.$emit("change",this.lastValue),this.debouncedEmit.cancel())},computed:{getProgressPercent:function(){return(this.value-this.min)/(this.max-this.min)*100},getTooltipStyle:function(){var t=this.getProgressPercent;return t<10?{left:"0",transform:"translateX(0)"}:t>90?{right:"0",left:"auto",transform:"translateX(0)"}:{left:"".concat(t,"%"),transform:"translateX(-50%)"}}},methods:{formatValue:function(t){return Number(t).toFixed(this.decimal)},startDrag:function(t){this.isDragging=!0,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.stopDrag),this.onDrag(t)},stopDrag:function(){this.isDragging=!1,document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.stopDrag),this.debouncedEmit.cancel(),null!==this.lastValue&&(this.$emit("change",this.lastValue),this.lastValue=null)},onDrag:function(t){if(this.isDragging){var rect=this.$refs.sliderBar.getBoundingClientRect(),e=(t.clientX-rect.left)/rect.width;e=Math.max(0,Math.min(1,e));var n=this.min+(this.max-this.min)*e;n=Math.round(n/this.step)*this.step,n=Math.max(this.min,Math.min(this.max,n)),this.$emit("input",n),this.lastValue=n,this.debouncedEmit(n)}}}},c=(n(4040),n(0)),component=Object(c.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-slider"},[e("div",{staticClass:"slider-tooltip",style:t.getTooltipStyle},[t._v("\n    "+t._s(t.formatValue(t.value))+"\n  ")]),t._v(" "),e("div",{ref:"sliderBar",staticClass:"slider-bar",on:{mousedown:t.startDrag}},[e("div",{staticClass:"slider-progress",style:{width:"".concat(t.getProgressPercent,"%")}}),t._v(" "),e("div",{staticClass:"slider-button",style:{left:"".concat(t.getProgressPercent,"%")}})]),t._v(" "),t.showLabels?e("div",{staticClass:"slider-labels"},[e("span",[t._v(t._s(t.min))]),t._v(" "),e("span",[t._v(t._s(t.max))])]):t._e()])}),[],!1,null,"d440fe2e",null);e.a=component.exports}}]);