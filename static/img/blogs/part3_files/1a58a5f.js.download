(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1159:function(e,t,n){"use strict";n.r(t);n(18);var o=n(2),r=(n(763),n(47),n(456)),l=n.n(r),c=(n(764),n(457)),d=n.n(c),h=(n(1691),n(812)),m=n.n(h),v=(n(32),n(16),n(11),n(6),n(12),n(13),n(8),n(7),n(4),n(847)),f=n(1),_=n(10);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={props:["menuIndex"],components:{HandleChannel:v.default,ElSubmenu:m.a,ElMenu:d.a,ElMenuItem:l.a},inject:["top"],data:function(){var e=localStorage.getItem("GenetateMenuZoom");return e=e?JSON.parse(e):[],{formatNumberForeign:_.p,zoomMenu:["toolIndex","menuIndex","swiftAiIndex"],coins:[{name:"credit",icon:n(169),type:"calculateCoins",desc:"new_credit_desc",tab:"Credit"},{name:"stamina",icon:n(397),type:"tempCoins",desc:"new_stamina_desc",default:this.top.token?0:150,tab:"Subscription"}],swiftAIList:[{code:"videoGeneration",path:"",label:"视频生成",logType:"videoGeneration"},{code:"swift_filter",path:"/ai-filter",label:"AI滤镜",logType:"ai-filter"},{code:"swift_faceChange",path:"/ai-face-swap",label:"AI换脸",logType:"ai-face-swap"},{code:"swift_upscale",path:"/image-upscaler",label:"AI图像增强器",logType:"image-upscaler"},{code:"swift_modelFitting",path:"/ai-model-fitting",label:"AI模特试衣",logType:"ai-model-fitting"},{code:"swift_erase",path:"/ai_erase",label:"智能消除",logType:"ai_erase"},{code:"swift_removeBackground",path:"/remove-background",label:"去除背景",logType:"remove-background"},{code:"swift_makeUp",path:"/ai-makeup",label:"AI美妆",logType:"ai-makeup"},{code:"swift_draftDesign",path:"/scribble2img",label:"草稿成图",logType:"scribble2img"},{code:"swift_photography",path:"/ai-portrait",label:"AI写真",logType:"ai-portrait"},{code:"swiftAiMore",path:"/ai-tools",label:"查看更多",logType:"ai-tools"},{code:"ai_generate_video",path:"/ai-video-generator",label:"AI生成视频",logType:"ai-generate-video"}]}},computed:y(y(y({},Object(f.e)("payment",["paymentInfo","activeState","liteActiveState"])),Object(f.c)("user",["isCompanyAccount","isLoggedIn"])),{},{isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},showCoinBtn:function(){return!this.activeState&&!this.liteActiveState},getCoinTitle:function(){var e=this;return function(t){return e.$t(t.type)+"："+e.$t("balance")+" "+(e.paymentInfo[t.type]||0)+", "+e.$t(t.desc)}}}),methods:{changeMenu:function(e){if(["videoGeneration"].includes(e))return this.$emit("onVideoGeneration"),void this.$xyLogEvent({front_operation:"click",entity_name:"old_generate_menu_video_generation_click",entity_type:"generateMenu"});var t=this.swiftAIList.find((function(t){return(null==t?void 0:t.code)===e}));if(t){try{this.$logEvent("log_actions",{operation:"click_".concat(t.logType),behavior_info:"on_creative_flow_sidebar"})}catch(e){}var n=this.localePath("/ai-tools".concat(t.path));return["swiftAiMore"].includes(t.code)&&(n=this.localePath("".concat(t.path))),void(window&&window.open(n,"_blank"))}try{var o;null!=this&&null!==(o=this.top)&&void 0!==o&&o.token||"SIMPLE"===e||(this.$refs.generateMenu.activeIndex="SIMPLE")}catch(e){}this.$emit("changeMenu",e)},closePopup:function(){this.$emit("close")},changeZoom:function(e,t){},toMall:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.top.token)return this.$EventBus.$emit("openLoginDialog",{callBack:function(){var n=e.localePath("/mall?openTab=".concat((null==t?void 0:t.tab)||"Credit"));window.open(n,"_blank")},dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_createflow_page"});if(this.isVip){this.$logEvent("log_actions",{operation:null!=t&&t.type?"calculateCoins"===(null==t?void 0:t.type)?"click_calculate_coins":"click_temp_coins":"click_charge_btn",behavior_info:"on_creative_flow_page"});var n=this.localePath("/mall?openTab=".concat((null==t?void 0:t.tab)||"Credit"));window.open(n,"_blank")}else this.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{pageFrom:"GenerateMenu",step:"subscription",dotFrom:"not_vip_click_stamina_icon_popup"}})}}},S=C,k=(n(4052),n(0)),component=Object(k.a)(S,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-menu",attrs:{"data-group":"old_generate_menu"}},[t("div",{staticClass:"head"},[t("img",{staticClass:"logo",attrs:{src:n(275),alt:"Avatar"}}),e._v("\n    "+e._s(e.$t("SeaArt"))+"\n    "),t("i",{staticClass:"iconfont icon-goBack",on:{click:e.closePopup}})]),e._v(" "),t("div",{staticClass:"menu-panel"},[e.isCompanyAccount?e._e():t("div",{staticClass:"menu-panel-top"},[e._l(e.coins,(function(n){return[t("div",{key:n.name,staticClass:"item-coin",class:n.name,attrs:{title:e.getCoinTitle(n),"data-id":""},on:{click:function(t){return e.toMall(n)}}},[t("img",{staticClass:"icon",attrs:{src:n.icon,alt:n.name}}),e._v(" "),t("div",{staticClass:"number"},[e._v("\n            "+e._s(e.formatNumberForeign(e.paymentInfo[n.type])||e.isLoggedIn&&n.default||0)+"\n          ")]),e._v(" "),t("i",{staticClass:"el-icon-circle-plus-outline"})])]})),e._v(" "),t("div",{staticClass:"item-coin-btn",on:{click:function(t){return e.toMall()}}},[e._v(e._s(e.$t("Recharge")))])],2),e._v(" "),t("el-menu",{ref:"generateMenu",attrs:{"default-active":e.menuIndex,"default-openeds":e.zoomMenu},on:{select:e.changeMenu,open:function(t){return e.changeZoom(t,"open")},close:function(t){return e.changeZoom(t,"close")}}},[t("el-menu-item",{staticClass:"old_generate_menu_click_simple dot-group",attrs:{index:"SIMPLE"}},[t("template",{slot:"title"},[t("i",{staticClass:"iconfont icon-simple_icon"}),e._v("\n          "+e._s(e.$t("S_Simple"))+"\n        ")])],2),e._v(" "),t("el-menu-item",{staticClass:"old_generate_menu_click_text_to_image dot-group",attrs:{index:"textToImage"}},[t("template",{slot:"title"},[t("i",{staticClass:"iconfont icon-play"}),e._v("\n          "+e._s(e.$t("GenerateTextMenu"))+"\n        ")])],2),e._v(" "),t("el-menu-item",{staticClass:"old_generate_menu_click_sketchboard_mode dot-group",attrs:{index:"videoGeneration"}},[t("template",{slot:"title"},[t("span",{staticClass:"iconfont icon-a-VideoGeneration menu-item-icon"}),e._v(" "),t("div",{staticClass:"menu-item-text"},[e._v("\n            "+e._s(e.$t("videoGeneration"))+"\n          ")]),e._v(" "),t("div",{staticClass:"hot-tag"},[e._v("hot")])])],2),e._v(" "),t("el-submenu",{directives:[{name:"show",rawName:"v-show",value:"SIMPLE"!==e.menuIndex,expression:"menuIndex !== 'SIMPLE'"}],attrs:{index:"menuIndex"}},[t("template",{slot:"title"},[e._v(e._s(e.$t("GenerateAdvancedMenu")))]),e._v(" "),t("el-menu-item",{attrs:{index:"imageToImage"}},[t("template",{slot:"title"},[t("i",{staticClass:"iconfont icon-icon_imageToImage"}),e._v("\n            "+e._s(e.$t("TaskUploadImage"))+"\n          ")])],2),e._v(" "),t("el-menu-item",{attrs:{index:"conditionToImage"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("conditionToImage"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-icon_conditionToImage"}),e._v(e._s(e.$t("conditionToImage")))])])],1)],2),e._v(" "),t("el-submenu",{directives:[{name:"show",rawName:"v-show",value:"SIMPLE"!==e.menuIndex,expression:"menuIndex !== 'SIMPLE'"}],attrs:{index:"toolIndex"}},[t("template",{slot:"title"},[e._v(e._s(e.$t("Tools")))]),e._v(" "),t("el-menu-item",{attrs:{index:"expansion"}},[t("template",{slot:"title"},[t("i",{staticClass:"iconfont icon-icon_Expansion"}),e._v(e._s(e.$t("Expansion")))])],2),e._v(" "),t("el-menu-item",{attrs:{index:"extraUpscale"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("taskTabUpscale"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-icon_extraUpscale"}),e._v(e._s(e.$t("taskTabUpscale")))])])],1),e._v(" "),t("el-menu-item",{attrs:{index:"characterRepair"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("characterRepair"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-character-repair-icon1"}),e._v("\n              "+e._s(e.$t("characterRepair")))])])],1),e._v(" "),t("el-menu-item",{attrs:{index:"descriptors"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("GetDescriptors"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-icon_descriptors"}),e._v(e._s(e.$t("GetDescriptors")))])])],1),e._v(" "),t("el-menu-item",{attrs:{index:"preview"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("Preview"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-icon_Preview"}),e._v(e._s(e.$t("Preview")))])])],1),e._v(" "),t("el-menu-item",{attrs:{index:"promptStudio"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("PromptStudio"),placement:"top-start"}},[t("span",[t("i",{staticClass:"iconfont icon-icon_PromptStudio"}),e._v(e._s(e.$t("PromptStudio")))])])],1)],2),e._v(" "),t("el-submenu",{directives:[{name:"show",rawName:"v-show",value:"SIMPLE"!==e.menuIndex,expression:"menuIndex !== 'SIMPLE'"}],attrs:{index:"swiftAiIndex"}},[t("template",{slot:"title"},[e._v(e._s(e.$t("swiftAI")))]),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_faceChange","data-event":"old_generate_menu_click_ai_face_change"}},[t("template",{slot:"title"},[t("span",{staticClass:"iconfont icon-icon_AIhuanlian menu-item-icon"}),e._v(e._s(e.$t("ai_face_changing")))])],2),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_filter","data-event":"old_generate_menu_click_ai_filter"}},[t("template",{slot:"title"},[t("span",{staticClass:"iconfont icon-ai_filter menu-item-icon"}),e._v(e._s(e.$t("ai_tools_4")))])],2),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_upscale","data-event":"old_generate_menu_click_ai_image_upscaler"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("upsacler_3_H1"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-icon_gaoqingxiufu menu-item-icon"}),e._v(e._s(e.$t("upsacler_3_H1")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_modelFitting","data-event":"old_generate_menu_click_ai_model_fitting"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ModelFitting"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-icon_moteshiyi menu-item-icon"}),e._v(e._s(e.$t("ModelFitting")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_erase","data-event":"old_generate_menu_click_ai_erase"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ai_erase"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-icon_zidongcachu1 menu-item-icon"}),e._v(e._s(e.$t("ai_erase"))+" ")])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_removeBackground","data-event":"old_generate_menu_click_ai_remove_background"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ai_tools_2"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-icon_qubeijing1 menu-item-icon"}),e._v(e._s(e.$t("ai_tools_2")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_makeUp","data-event":"old_generate_menu_click_ai_makeup"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ai_makeup"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-meizhuang menu-item-icon"}),e._v(e._s(e.$t("ai_makeup")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_draftDesign","data-event":"old_generate_menu_click_ai_draft_design"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ai_tools_3"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-caogaochengtu menu-item-icon"}),e._v(e._s(e.$t("ai_tools_3")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swift_photography","data-event":"old_generate_menu_click_ai_portrait"}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.$t("ai_tools_10"),placement:"top-start"}},[t("span",[t("span",{staticClass:"iconfont icon-icon_AIxiezhen menu-item-icon"}),e._v(e._s(e.$t("ai_tools_10")))])])],1),e._v(" "),t("el-menu-item",{staticClass:"swift-menu-item",attrs:{index:"swiftAiMore","data-event":"old_generate_menu_click_ai_more"}},[t("div",{staticClass:"view-more-btn"},[e._v(e._s(e.$t("ShowALL"))),t("i",{staticClass:"el-icon-arrow-right"})])])],2)],1)],1)])}),[],!1,null,"25797565",null);t.default=component.exports},1160:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13);var o=n(3),r=n(2),l=(n(20),n(19),n(6),n(16),n(22),n(31),n(8),n(4),n(28),n(43),n(21),n(40),n(44),n(7),n(41),n(26),n(109),n(48)),c=n(581),d=n(1);n(9);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={inject:["top"],props:["value"],data:function(){return{inputSize:{minRows:1,maxRows:8},hidePromptMenu:["extraUpscale","descriptors"],isRequest:!1,EventSourceServer:null,isLoading:!1}},watch:{"top.menuIndex":function(e){this.isRequest&&this.disConnectEventSourceServer()}},computed:m(m(m(m(m({},Object(d.e)("payment",["paymentInfo"])),Object(d.c)("creation",["size_billing_rule","isIgnoreUnAvailableLora"])),Object(d.e)("user",["userInfo"])),Object(d.c)("user",["isCompanyAccount"])),{},{isStudioMode:function(){var e;return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(null===(e=this.top.config[this.top.menuIndex])||void 0===e?void 0:e.category)},isStudioFlux:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.base_model_type)||void 0===e?void 0:e.includes("Flux"))&&["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode},computedPhysicalExertion:function(){var e,t,n,o,r,l,c=this,d=["f8172af6747ec762bcf847bd60fdf7cd","cb2801e3136f4d4c9c1c12dc852691c5"],h=this.size_billing_rule.baselines||[],m=this.size_billing_rule.extra_rule||[],v=this.size_billing_rule.face_restoration||[],f=(null===(e=this.size_billing_rule)||void 0===e?void 0:e.imt_to_img_baselines)||[],_=(null===(t=this.size_billing_rule)||void 0===t?void 0:t.lab_billing_rule)||{},w=1,y=Math.max(this.value.width,this.value.height);this.isStudioMode&&(y=Math.max(this.value.studio.width,this.value.studio.height)),(h||[]).forEach((function(e){y>e.min&&y<=e.max&&(w=e.value)})),["conditionToImage","imageToImage"].includes(this.top.menuIndex)&&(f||[]).forEach((function(e){y>e.min&&y<=e.max&&(w=e.value)}));var C=1,S=this.isStudioMode?7:this.value.category;(m||[]).forEach((function(e){e.task_action===c.value.action&&e.task_category===S&&(C=e.value||1)}));var k=0,x=(null===(n=this.value)||void 0===n?void 0:n.agency_fee)||0;(this.value.lora_models||[]).forEach((function(e){e&&e.agency_fee>0&&(k+=e.agency_fee)}));var I=null;I=5===S?6*(this.value.n_iter||1):w*C*(this.value.n_iter||1),1===this.value.lcm_mode&&(I*=.5);var O,T=I;if([4,5,7].includes(S)||(T=I+k+x),this.value.enable_hr&&""!==this.value.hr_upscaler&&"textToImage"==this.top.menuIndex&&[1,"1"].includes(S)){var L,$=this.value.hr_scale||6,M=this.value.width*$,P=this.value.height*$,j=1,D=(null===(L=this.size_billing_rule)||void 0===L?void 0:L.hd)||[],N=Math.max(M,P);(D||[]).forEach((function(e){N>e.min&&N<=e.max&&(j=e.value)}));var R=1;(m||[]).forEach((function(e){2===e.task_action&&e.task_category===S&&(R=e.value||1)})),T+=j*R*(this.value.n_iter||1)}if(!["",null,void 0].includes(this.value.ad_model)&&["textToImage","imageToImage"].includes(this.top.menuIndex)&&![7,"7",5,"5","sdxl","studio"].includes(S)){var E=0;(v||[]).forEach((function(e){y>e.min&&y<=e.max&&(E=e.value||0)})),T+=E*(this.value.n_iter||1)}"expansion"===this.top.menuIndex&&(T=null!==(O=this.value)&&void 0!==O&&O.imageUrl[0]?this.setExpansionExpend:0);if(7===S){var A,U,B={conditionToImage:"contrlnet_to_img",textToImage:"text_to_img",imageToImage:"img_to_img"}[this.top.menuIndex]||"",F=B&&_[B]||6,z=0;if([1,2].includes(null===(A=this.value)||void 0===A||null===(A=A.lab_base)||void 0===A?void 0:A.quality_mode)&&"textToImage"===this.top.menuIndex){var H,V=this.calculateQuantity(this.value.n_iter||1);[2].includes(null===(H=this.value)||void 0===H||null===(H=H.lab_base)||void 0===H?void 0:H.quality_mode)&&(V=this.value.n_iter||1),z=((this.value.lab_base.intelligence_open?1:0)+2)*V}if(T=F*(this.value.n_iter||1)+z,d.includes(null==this||null===(U=this.value)||void 0===U?void 0:U.art_model_no)){var W,G,J=!(null===(W=this.value)||void 0===W||null===(W=W.ipList)||void 0===W||!W.length||null!==(G=this.value)&&void 0!==G&&null!==(G=G.lora_models)&&void 0!==G&&G.length),X=6;this.value.steps>=26&&(X=9),T=(F=J?X+12:X)*(this.value.n_iter||1)}}var K=(null===(o=this.value)||void 0===o?void 0:o.base_model_type.includes("Flux"))&&!d.includes(null==this||null===(r=this.value)||void 0===r?void 0:r.art_model_no);if(7===S&&(null!==(l=this.value)&&void 0!==l&&l.base_model_type.includes("SD 3.5")||K)){var Z;if(T=8*this.value.n_iter,null!==(Z=this.value)&&void 0!==Z&&Z.base_model_type.includes("Flux")){var Y,Q,ee=!(null===(Y=this.value)||void 0===Y||null===(Y=Y.ipList)||void 0===Y||!Y.length||null!==(Q=this.value)&&void 0!==Q&&null!==(Q=Q.lora_models)&&void 0!==Q&&Q.length),te=8;this.value.steps>=26&&(te=12),T=(w=ee?te+12:te)*(this.value.n_iter||1)}}return 3===this.value.speed_type&&(T=0),T},setExpansionExpend:function(){var e=6,t=Math.max(this.value.width,this.value.height);return[{min:0,max:512,value:6},{min:512,max:768,value:8},{min:768,max:1024,value:10},{min:1024,max:1280,value:14},{min:1280,max:1480,value:18},{min:1480,max:1536,value:24}].forEach((function(n){t>n.min&&t<=n.max&&(e=n.value||6)})),e*{1:1,2:1.5,3:2,4:2.5}[this.value.n_iter]},isShowBeautify:function(){var e=this.value.prompt;return e&&e.length<100},showPlaceholder:function(){var e,t="WhatDoUWantToCreate",n=this.value,mask=n.mask,o=n.controlnet_units,r=n.category;[5,"5","sdxl"].includes(r);"imageToImage"!==this.top.menuIndex||["",null,void 0].includes(mask)||/^(http|https):\/\//.test(mask)||0!==o.length||(t="TaskImage2ImagePlaceholder"),"expansion"===this.top.menuIndex&&this.value.isDrag&&(t="ExpansionPromptPlaceholder");var l=((null===(e=this.value)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.conds)||[]).map((function(e){return e.mode})).filter((function(e){return["ImagePrompt"].includes(e)}));return!this.isStudioFlux&&"textToImage"===this.top.menuIndex&&[7,11,"studio"].includes(r)&&l.length&&(t="studio22"),t},localText:function(){var e=this.top.randomPrompt;return e.length?e:""}}),methods:{calculateQuantity:function(e){return 1===e?0:e%2==0&&0!==e?e/2:e>1&&e%2!=0?Math.floor(e/2):0},goTutorial:function(){var link="https://docs.seaart.ai/guide-1";"ja"===this.$i18n.locale&&(link="https://docs.seaart.ai/guide-1/ri-ben-yu"),this.$logEvent("log_actions",{operation:"click_video_course",behavior_info:link}),window.open(link,"_blank")},setPrompt:function(){var e=JSON.parse(JSON.stringify(this.value)),text=this.top.randomPrompt;if(text.length){text=text.replace(/--V6|--v6/g,""),e.prompt=text,this.setConfig(e)}},changeRandom:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$logEvent("log_actions",{operation:"click_dice_to_text",behavior_info:"task"}),e.isLoading=!0,t.prev=2,t.next=5,e.top.getRandomPrompt();case 5:e.isLoading=!1,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(2),e.isLoading=!1,console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})))()},changePrompt:function(){var e=this.value,t=e.prompt,n=e.local_prompt,o=JSON.parse(JSON.stringify(this.value)),r=t;o.prompt=n,o.local_prompt=r,this.setConfig(o)},setConfig:function(e){this.$emit("input",e)},changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));n[t]=e,this.value.isTranslate&&(n.isTranslate=!1),this.$emit("input",n)},generate:function(){var e,t,n,o=null===(e=this.value)||void 0===e?void 0:e.lora_models.length,r=(null===(t=this.value)||void 0===t||null===(t=t.lora_models)||void 0===t?void 0:t.some((function(e){var t;return null===(t=e.base_model)||void 0===t?void 0:t.includes("Flux")})))||!1,l=(null===(n=this.value)||void 0===n||null===(n=n.base_model_type)||void 0===n?void 0:n.includes("Flux"))||!1;if("on"!==(this.isIgnoreUnAvailableLora||"on")&&o){if(r&&!l)return void this.$message.warning(this.$t("modelMismatchingTip"));if(l&&!r)return void this.$message.warning(this.$t("modelMismatchingTip"))}this.top.generate()},handleKeyCode:function(e){if(13==e.keyCode)if(e.metaKey||e.altKey){var t=this.value.prompt,n=document.querySelector("#generateInput"),o=n.selectionStart,r=n.selectionEnd,l=t.slice(0,o)+"\n"+t.slice(r);n.focus(),setTimeout((function(){n.setSelectionRange(o+1,o+1),n.focus()}),10),this.changeConfig(l,"prompt")}else e.preventDefault(),this.generate()},wordOptimization:function(){var e=this.value.prompt,t={prompt:e};this.isRequest||""===e||(this.isRequest=!0,this.openConnectServer(t))},openConnectServer:function(e){var t=this,n=window.location.origin+"/api/v1/task/prompt-render",o=new URLSearchParams(e).toString(),r="".concat(n,"?").concat(o),d=this.$cookies.get("lang")||navigator.language||navigator.browserLanguage,h={headers:{token:Object(l.q)(),"Accept-Language":d,"X-Device-Id":this.$cookies.get("deviceId")}};this.EventSourceServer=new c.EventSourcePolyfill(r,h),this.EventSourceServer.addEventListener("message",this.handleMessage),this.EventSourceServer.addEventListener("error",this.handleMessageError),this.EventSourceServer.addEventListener("open",(function(){t.isRequest=!0}))},handleMessage:function(e){var t,n,o=JSON.parse(e.data),code=null==o||null===(t=o.status)||void 0===t?void 0:t.code,r=null==o||null===(n=o.data)||void 0===n?void 0:n.prompt;[2e4,"20000"].includes(code)?this.$EventBus.$emit("openLoginDialog"):[1e4,"10000"].includes(code)?this.disConnectEventSourceServer():[70005,"70005"].includes(code)?this.changeConfig(r,"prompt"):(this.handlePromptErrorMessage(code),this.disConnectEventSourceServer())},handleMessageError:function(e){e.eventPhase===EventSource.CLOSED&&(this.isRequest=!1),this.disConnectEventSourceServer()},disConnectEventSourceServer:function(){this.EventSourceServer&&(this.EventSourceServer.close(),this.EventSourceServer=null),this.isRequest=!1},handlePromptErrorMessage:function(){var code=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e={70006:this.$t("taskPromptGenerateExecuting"),70017:this.$t("taskPromptGenerateLimit"),70020:this.$t("taskPromptGenerateViolate")};e[code]&&this.$message.error(e[code])}},beforeDestroy:function(){this.disConnectEventSourceServer()}},f=v,_=(n(4076),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.value.generateing||e.isRequest,expression:"value.generateing || isRequest"}],staticClass:"generate-prompt custom-form"},[t("el-input",{attrs:{type:"textarea",value:e.value.prompt,placeholder:e.$t(e.showPlaceholder),autosize:e.inputSize,resize:"none",maxlength:"2000",id:"generateInput"},on:{input:function(t){return e.changeConfig(t,"prompt")}},nativeOn:{keydown:function(t){return e.handleKeyCode(t)}}}),e._v(" "),e.isCompanyAccount?e._e():t("div",{staticClass:"physical-exertion-text",class:[e.isShowBeautify||e.value.isTranslate?"physical-exertion-text-2":""]},[e._v("\n    "+e._s(e.$t("PhysicalExertion"))+" : "+e._s(e.computedPhysicalExertion)+"\n  ")]),e._v(" "),t("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.isShowBeautify,expression:"isShowBeautify"}],staticClass:"tools-svg custom-iconfont-box",attrs:{"icon-class":"mofabang"},on:{click:e.wordOptimization}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value.isTranslate,expression:"value.isTranslate"}],staticClass:"custom-iconfont-box"},[t("i",{staticClass:"iconfont icon-i18n_prompt tools-translate",on:{click:e.changePrompt}})]),e._v(" "),t("div",{staticClass:"custom-iconfont-box"},[t("i",{staticClass:"iconfont icon-send1 generate-btn",on:{click:e.generate}})]),e._v(" "),t("div",{staticClass:"random-prompt"},[t("i",{staticClass:"iconfont icon-dice-square",class:{loading:e.isLoading},on:{click:e.changeRandom}}),e._v(" "),t("span",{on:{click:e.setPrompt}},[e._v(e._s(e.isLoading?e.$t("Loading")+"...":e.localText))])]),e._v(" "),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("newTutorial"),placement:"left"}},[t("div",{staticClass:"tutorial",on:{click:e.goTutorial}},[t("i",{staticClass:"iconfont icon-tutorial"})])])],1)}),[],!1,null,"06712624",null);t.default=component.exports;installComponents(component,{SvgIcon:n(115).default})},1161:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(3230),l=n(3231),c=n(3232),d=n(3233),h=n(3235),m=n(3236),v=n(3237),f=n(795),_=n(3240),w=n(852),y=n(3241),C=n(3242),S=n(1),k=n(853),x=n(3243),I=n(3244),O=n(3245);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={components:{HandleModel:d.default,HandleStyle:h.default,HandleAdvanced:r.default,HandleControlNet:l.default,HandExtraUpscale:m.default,HandleImage:c.default,HandleSend:v.default,selectGenerateModelType:f.default,handleJumpToOps:_.default,HandleCharacterRepair:w.default,HandleRoop:y.default,HandlePromptMagic:C.default,HandleHRepair:k.default,HandleFaceSwap:I.default,HandleAdvanceRepair:x.default,HandleAnimGen:O.default},props:["value"],inject:["top"],data:function(){return{oldTabIndex:"SET"}},computed:L(L({},Object(S.e)("user",["userInfo"])),{},{isShowSetting:function(){var e=!["promptStudio","extraUpscale","descriptors","preview","faceSwap"].includes(this.top.menuIndex),t=this.isShowModel,n=e||t;return["promptStudio","extraUpscale","descriptors","preview","faceSwap"].includes(this.top.menuIndex)&&(n=!1),n},isShowHRepair:function(){return["textToImage"].includes(this.top.menuIndex)&&[1,"1"].includes(this.value.category)&&!this.isStudioMode},checkEnableStudio:function(){return!0},activeHeadItem:function(){return function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(null==this||null===(e=this.top)||void 0===e?void 0:e.creativeMode)===t?"head-item-active":""}},isStudioMode:function(){var e;return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(null===(e=this.top.config[this.top.menuIndex])||void 0===e?void 0:e.category)},isShowModel:function(){return!["faceSwap","preview"].includes(this.top.menuIndex)&&![3,"3",4,"4",7].includes(this.value.category)&&!this.isStudioMode},isShowFaceSwap:function(){return"faceSwap"===this.top.menuIndex},isShowJump:function(){return"textToImage"===this.top.menuIndex&&[3,"3"].includes(this.value.category)&&!this.isStudioMode},isShowStyle:function(){return!["faceSwap","preview","characterRepair"].includes(this.top.menuIndex)&&![3,"3"].includes(this.value.category)},isShowAdvanced:function(){var e=this.value.category;return!["faceSwap","preview","characterRepair"].includes(this.top.menuIndex)&&![3,"3",4,"4"].includes(e)},isSdModel:function(){return["5",5].includes(this.value.category)},isShowCharacterRepair:function(){var e=this.top.menuIndex;return["imageToImage","textToImage","characterRepair"].includes(e)&&!this.isStudioMode&&!this.isSdModel},isShowControlNet:function(){var e=this.top.menuIndex,t=this.value.workIndex;return["preview","conditionToImage"].includes(e)||t<3&&"imageToImage"===e&&!this.isStudioMode},isShowRedraw:function(){var e=this.value.workIndex;return"imageToImage"===this.top.menuIndex&&3===e},handleModelType:function(){return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)}}),methods:{changeConfig:function(e){this.$emit("input",e)},sendParams:function(e){this.$emit("sendParams",e)},changeTab:function(e){this.top.changeHandle({handleType:e})},handleChangeMode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"video"===e?(this.top.handleVideoSwitchMenu(),void this.$xyLogEvent({front_operation:"click",entity_name:"old_generate_handle_video_generation_click",entity_type:"generateHandle"})):e&&"studio"===e&&!this.checkEnableStudio?(this.$message.warning(this.$t("studioTips")),void this.top.changeHandle({creativeMode:"normal"})):void this.top.changeHandle({creativeMode:e})}}},M=$,P=(n(4113),n(0)),component=Object(P.a)(M,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-handle custom-form"},[t("div",{staticClass:"head",class:[e.handleModelType?"head-flex":""]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.handleModelType,expression:"handleModelType"}],staticClass:"head-tab-box"},[t("div",{staticClass:"head-item",class:[e.activeHeadItem("normal")],on:{click:function(t){return t.stopPropagation(),e.handleChangeMode("normal")}}},[e._v("\n        "+e._s(e.$t("createModeType1"))+"\n      ")]),e._v(" "),t("div",{staticClass:"head-item",class:[e.activeHeadItem("sdxl")],on:{click:function(t){return t.stopPropagation(),e.handleChangeMode("sdxl")}}},[e._v("\n        "+e._s(e.$t("createModeType5"))+"\n      ")]),e._v(" "),t("div",{staticClass:"head-item head-item-video",class:[e.activeHeadItem("video")],on:{click:function(t){return t.stopPropagation(),e.handleChangeMode("video")}}},[e._v("\n        "+e._s(e.$t("Video"))+"\n      ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:["textToImage","imageToImage","conditionToImage"].includes(e.top.menuIndex),expression:"['textToImage', 'imageToImage', 'conditionToImage'].includes(top.menuIndex)"}],staticClass:"head-item head-item-studio",class:[e.activeHeadItem("studio")],on:{click:function(t){return t.stopPropagation(),e.handleChangeMode("studio")}}},[e._v("\n        "+e._s(e.$t("studio"))+"\n      ")])])]),e._v(" "),t("div",{staticClass:"handle-list"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"animGen"!=e.top.menuIndex,expression:"top.menuIndex != 'animGen'"}],staticClass:"handle-panel"},[t("select-generate-model-type",{directives:[{name:"show",rawName:"v-show",value:e.isShowSetting,expression:"isShowSetting"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!["extraUpscale","descriptors"].includes(e.top.menuIndex),expression:"!['extraUpscale', 'descriptors'].includes(top.menuIndex)"}],staticClass:"handle-common"},[t("handle-jump-to-ops",{directives:[{name:"show",rawName:"v-show",value:e.isShowJump,expression:"isShowJump"}]}),e._v(" "),t("handle-style",{directives:[{name:"show",rawName:"v-show",value:e.isShowStyle,expression:"isShowStyle"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),t("handle-image",{directives:[{name:"show",rawName:"v-show",value:e.isShowRedraw,expression:"isShowRedraw"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),e.isShowControlNet?t("handle-control-net",{attrs:{value:e.value},on:{input:e.changeConfig}}):e._e(),e._v(" "),t("handle-advanced",{directives:[{name:"show",rawName:"v-show",value:e.isShowAdvanced,expression:"isShowAdvanced"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),t("handle-face-swap",{directives:[{name:"show",rawName:"v-show",value:e.isShowFaceSwap,expression:"isShowFaceSwap"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),t("handle-advance-repair",{directives:[{name:"show",rawName:"v-show",value:e.isShowCharacterRepair||e.isShowHRepair,expression:"isShowCharacterRepair || isShowHRepair"}],attrs:{value:e.value},on:{input:e.changeConfig}})],1),e._v(" "),t("hand-extra-upscale",{directives:[{name:"show",rawName:"v-show",value:"extraUpscale"===e.top.menuIndex,expression:"top.menuIndex === 'extraUpscale'"}],attrs:{value:e.value},on:{input:e.changeConfig}}),e._v(" "),[3,"3","7",7].includes(e.value.category)?e._e():t("handle-send",{on:{change:e.sendParams}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"animGen"==e.top.menuIndex,expression:"top.menuIndex == 'animGen'"}],staticClass:"handle-panel"},[t("handle-anim-gen",{attrs:{value:e.value},on:{input:e.changeConfig}})],1)])])}),[],!1,null,"37afdfd3",null);t.default=component.exports},1176:function(e,t,n){"use strict";n.r(t);n(24);var o={name:"GradientProgress",props:{percentage:{type:Number,default:0},gradient:{type:String,default:"linear-gradient(99deg, #3271CC 0%, #0FFFFF 100%)"},backgroundColor:{type:String,default:"rgba(255, 255, 255, 0.1)"},borderRadius:{type:Number,default:100},width:{type:Number,default:467},height:{type:Number,default:18}},computed:{getProgressStyle:function(){return{width:this.width+"px",height:this.height+"px",background:this.backgroundColor,borderRadius:this.borderRadius+"px"}}}},r=(n(4390),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"gradient-progress-bar",style:e.getProgressStyle},[t("div",{staticClass:"gradient-progress-inner",style:{width:"".concat(e.percentage,"%"),background:e.gradient}})])}),[],!1,null,"b8c0ddf8",null);t.default=component.exports},1692:function(e,t,n){e.exports={}},1693:function(e,t,n){e.exports={}},1696:function(e,t,n){e.exports={}},1697:function(e,t,n){e.exports={}},1698:function(e,t,n){e.exports={}},1707:function(e,t,n){e.exports={}},1708:function(e,t,n){e.exports={}},1709:function(e,t,n){e.exports={}},1710:function(e,t,n){e.exports={}},1712:function(e,t,n){e.exports={}},1713:function(e,t,n){e.exports={}},1714:function(e,t,n){e.exports={}},1715:function(e,t,n){e.exports={}},1716:function(e,t,n){e.exports={}},1717:function(e,t,n){e.exports={}},1720:function(e,t,n){e.exports={}},1723:function(e,t,n){e.exports={}},1724:function(e,t,n){e.exports={}},1725:function(e,t,n){e.exports={}},1726:function(e,t,n){e.exports={}},1727:function(e,t,n){e.exports={}},1728:function(e,t,n){e.exports={}},1732:function(e,t,n){e.exports={}},1734:function(e,t,n){e.exports={}},1735:function(e,t,n){e.exports={}},1736:function(e,t,n){e.exports={}},1737:function(e,t,n){e.exports={}},1738:function(e,t,n){e.exports={}},1739:function(e,t,n){e.exports={}},1740:function(e,t,n){e.exports={}},1741:function(e,t,n){e.exports={}},1742:function(e,t,n){e.exports={}},1743:function(e,t,n){e.exports={}},1744:function(e,t,n){e.exports={}},1745:function(e,t,n){e.exports={}},1746:function(e,t,n){e.exports={}},1747:function(e,t,n){e.exports={}},1748:function(e,t,n){e.exports={}},1749:function(e,t,n){e.exports={}},1750:function(e,t,n){e.exports={}},1751:function(e,t,n){e.exports={}},1752:function(e,t,n){e.exports={}},1753:function(e,t,n){e.exports={}},1754:function(e,t,n){e.exports={}},1755:function(e,t,n){e.exports={}},1756:function(e,t,n){e.exports={}},1757:function(e,t,n){e.exports={}},1758:function(e,t,n){e.exports={}},1759:function(e,t,n){e.exports={}},1760:function(e,t,n){e.exports={}},1761:function(e,t,n){e.exports={}},1766:function(e,t,n){e.exports={}},1770:function(e,t,n){e.exports={}},1771:function(e,t,n){e.exports={}},1772:function(e,t,n){e.exports={}},1773:function(e,t,n){e.exports={}},1774:function(e,t,n){e.exports={}},1775:function(e,t,n){e.exports={}},1776:function(e,t,n){e.exports={}},1777:function(e,t,n){e.exports={}},1778:function(e,t,n){e.exports={}},1779:function(e,t,n){e.exports={}},1781:function(e,t,n){e.exports={}},1782:function(e,t,n){e.exports={}},1794:function(e,t,n){e.exports={}},1795:function(e,t,n){e.exports={}},1796:function(e,t,n){e.exports={}},1797:function(e,t,n){e.exports={}},1798:function(e,t,n){e.exports={}},1867:function(e,t,n){e.exports={}},1868:function(e,t,n){e.exports={}},1869:function(e,t,n){e.exports={}},1959:function(e,t,n){e.exports={}},2029:function(e,t,n){e.exports={}},2078:function(e,t,n){e.exports={}},2083:function(e,t,n){e.exports={}},2084:function(e,t,n){e.exports={}},2085:function(e,t,n){e.exports={}},2086:function(e,t,n){e.exports={}},253:function(e,t,n){"use strict";n.r(t);n(4);var o=n(128),r={props:["item","disabled","base_models","fontSize"],data:function(){return{show:!1,list:[],loading:!1}},computed:{version_name:function(){var e,t,n,o,r;return null!==(e=this.item)&&void 0!==e&&e.child&&null!==(t=this.item)&&void 0!==t&&t.child[0]?(null===(r=this.item)||void 0===r?void 0:r.child[0].title)||"":(null===(n=this.item)||void 0===n?void 0:n.version_name)||(null===(o=this.item)||void 0===o||null===(o=o.art_model)||void 0===o?void 0:o.version_name)||""}},watch:{show:{handler:function(e){var t=this;if(e&&!this.list.length){if(this.loading)return;this.loading=!0;var n={model_id:this.item.id};this.base_models&&(n.base_models=this.base_models),Object(o.g)(n).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.list=e.data.items)})).finally((function(){t.loading=!1}))}}}},methods:{selectItem:function(e){this.$emit("selectItem",e),this.show=!1}}},l=(n(4079),n(0)),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{placement:"bottom",trigger:"click","visible-arrow":!1,disabled:e.disabled},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"verList"},e._l(e.list,(function(n,o){return t("div",{key:o,on:{click:function(t){return e.selectItem(n)}}},[e._v(e._s(n.version_no))])})),0),e._v(" "),t("div",{staticClass:"changeVer",attrs:{slot:"reference"},on:{click:function(e){e.stopPropagation()}},slot:"reference"},[t("span",{style:{fontSize:e.fontSize?e.fontSize+"px":"14px"}},[e._v(e._s(e.version_name))]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])}),[],!1,null,"267d6a72",null);t.default=component.exports},264:function(e,t,n){"use strict";n.r(t);n(24),n(8);var o={name:"generateRectItem",props:{item:{type:Object,default:function(){}},index:{type:Number,default:0},size:{type:Number,default:100}},data:function(){return{isDragging:!1,offset:{},draggable:null,container:null,parentW:0,intW:0,intH:0,intT:0,intL:0}},watch:{size:{handler:function(e){this.resizeChildElement()}}},mounted:function(){this.container=document.getElementById("draggable"),this.draggable=this.$refs["rectItem"+this.index],this.parentW=JSON.parse(JSON.stringify(this.container.offsetWidth)),this.intW=JSON.parse(JSON.stringify(parseInt(this.draggable.style.width))),this.intH=JSON.parse(JSON.stringify(parseInt(this.draggable.style.height))),this.intT=JSON.parse(JSON.stringify(parseInt(this.draggable.style.top))),this.intL=JSON.parse(JSON.stringify(parseInt(this.draggable.style.left)))},methods:{resizeChildElement:function(){var e=this.container.offsetWidth/this.parentW;this.draggable.style.top=this.intT*e+"px",this.draggable.style.left=this.intL*e+"px",this.draggable.style.width=this.intW*e+"px",this.draggable.style.height=this.intH*e+"px",this.$emit("change",{index:this.index,top:parseInt(this.draggable.style.top),left:parseInt(this.draggable.style.left),width:parseInt(this.draggable.style.width),height:parseInt(this.draggable.style.height)})},onMousedown:function(e){this.isDragging=!0;var t=this.draggable.getBoundingClientRect();this.offset.x=e.clientX-t.left,this.offset.y=e.clientY-t.top},onMousemove:function(e){if(this.isDragging){var t=e.clientX-this.offset.x-this.container.getBoundingClientRect().left,n=e.clientY-this.offset.y-this.container.getBoundingClientRect().top;t=Math.min(this.container.clientWidth-this.draggable.clientWidth,Math.max(0,t)),n=Math.min(this.container.clientHeight-this.draggable.clientHeight,Math.max(0,n)),this.draggable.style.left=t+"px",this.draggable.style.top=n+"px",this.draggable.style.zIndex=9999}},onMouseup:function(e){this.isDragging=!1,this.draggable.style.zIndex=2,this.intW=JSON.parse(JSON.stringify(parseInt(this.draggable.style.width))),this.intH=JSON.parse(JSON.stringify(parseInt(this.draggable.style.height))),this.intT=JSON.parse(JSON.stringify(parseInt(this.draggable.style.top))),this.intL=JSON.parse(JSON.stringify(parseInt(this.draggable.style.left))),this.$emit("change",{index:this.index,top:this.intT,left:this.intL,width:this.intW,height:this.intH})}}},r=(n(4117),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{ref:"rectItem"+e.index,staticClass:"rectItem",style:{width:e.item.width+"px",height:e.item.height+"px",left:e.item.left+"px",top:e.item.top+"px"},on:{"&mousedown":function(t){return e.onMousedown.apply(null,arguments)},"&mousemove":function(t){return e.onMousemove.apply(null,arguments)},"&mouseup":function(t){return e.onMouseup.apply(null,arguments)},mouseleave:function(t){return t.preventDefault(),e.onMouseup.apply(null,arguments)}}},[t("div",{staticClass:"clear",on:{click:function(t){return e.$emit("delete",e.index)}}},[t("i",{staticClass:"el-icon-close"})])])}),[],!1,null,"67114d58",null);t.default=component.exports},297:function(e,t,n){"use strict";n.r(t);var o={name:"HelpTip",props:{content:{type:String,default:""},color:{type:String,default:""},size:{type:String,default:"16px"},textAlign:{type:String,default:"center"},width:{type:String,default:""}},computed:{getStyle:function(){return{color:this.color,fontSize:this.size}}}},r=n(0),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{trigger:"hover",placement:"top",width:e.width,"popper-class":"balance-tips"},scopedSlots:e._u([{key:"default",fn:function(){return[t("div",{staticStyle:{"word-break":"break-all"},style:{textAlign:e.textAlign}},[e._v(e._s(e.content))])]},proxy:!0}])},[e._v(" "),t("i",{staticClass:"iconfont icon-help-icon",style:e.getStyle,attrs:{slot:"reference"},slot:"reference"})])}),[],!1,null,null,null);t.default=component.exports},302:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(18),n(11),n(12),n(13);var o=n(3),r=n(2),l=(n(20),n(6),n(32),n(73),n(22),n(24),n(65),n(8),n(4),n(177),n(28),n(113),n(21),n(44),n(7),n(279)),c=n(102),d=n(38),h=n(75),m=n(156),v=n(280),f=n(35),_=n.n(f),w=n(1),y=n(29),C=n(10),S=n(209),k=(n(9),n(54)),x=n(33),I=n(848),O=n(165);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},M=Object(m.a)()?"DOMMouseScroll":"mousewheel",P={components:{ViewImage:S.a,AiChatCreateConfirm:l.a,ImageActionButtons:I.default},name:"taskImageViewer",props:{operateNumber:{type:Number,default:function(){return 1}},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},showOperateBtn:{type:Boolean,default:function(){return!1}},message:{type:Object,default:function(){return{}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},hoverBtnRenderList:{type:Array,default:function(){return[]}},nsfw:{type:Number,default:2},checkIsShowViewNsfw:{type:Boolean,default:!1}},data:function(){return{dialogVisible:!1,index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:$.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},isI18nToggled:!1,intLoraModel:[],getMetaLoading:!1,alreadySave:!1}},computed:L(L(L(L({},Object(w.c)(["isSupportWebp"])),Object(w.c)("user",["accountSettingsData","isCompanyAccount","userInfo"])),Object(w.c)("creation",["studioStyle","lab_styles"])),{},{isNsfwPlus:function(){var e,t;return(null==this||null===(e=this.currentImgInfo)||void 0===e?void 0:e.is_nsfw_plus)&&1!==(null==this||null===(t=this.currentImgInfo)||void 0===t?void 0:t.nsfw)},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},getActionButtons:function(){var e=[];return this.isShowNsfwIcon&&(e=["supportFeedback","supportReport"]),e.map((function(e){return x.IMAGE_OPERATION_BTN_LIST.find((function(t){return t.permissionKey===e}))})).filter(Boolean).map((function(e){return L(L({},e),{},{type:e.code})}))},isShowChat:function(){var e,t=null===(e=this.urlList)||void 0===e?void 0:e[this.index];return 1==(null==t?void 0:t.type)},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isShowSaveTo:function(){var e,t=this.message.img_uris,n=void 0===t?[]:t;return!!n.length&&(!(null!==(e=n[this.operateNumber-1])&&void 0!==e&&e.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},renderBtn:function(){var e=this,map={post:{type:"post",label:"Post",tip:"PostTips"},animGen:{type:"animGen",label:"AnimGen",tip:"AnimTips"},extraUpscale:{type:"extraUpscale",label:"taskTabUpscale",tip:"ExtraUpscale"},upscale:{type:"upscale",label:"OriginalityUpscale",tip:"WorkUpscale"},variations:{type:"variations",label:"Variations",tip:"WorkVariations"},removeBackground:{type:"removeBackground",label:"RemoveBackground"},chat:{type:"chat",label:"gpt_tab_chat",tip:"createChartacterToChat"},aiGenerateVideo:{type:"aiGenerateVideo",label:"ImageToVideo",tip:"ImageToVideoTip"}},t=[],n=["deleteSingleImg","save","post","animGen","chat"],o=null,r=null,l=null;return this.hoverBtnRenderList.forEach((function(c){var d=L(L({},c),map[c.code]);"upscale"===c.code&&e.isStudioMode&&d.tip&&d.tip.replace("2048*2048","3072*3072"),!n.includes(c.code)&&t.push(d),"post"===c.code&&(o=d),"animGen"===c.code&&(r=d),"chat"===c.code&&(l=d)})),r&&t.unshift(r),o&&t.unshift(o),l&&t.push(l),t.push({type:"download",label:"Download",icon:"modelDownload",tip:"SG_DownloadHover"}),t},studioRenderList:function(){var e=this;return(this.lab_styles||[]).map((function(t){var n="labStyle_".concat(t.value.replace(/\s/g,""));return{label:e.$t(n)||t.value,id:t.value}}))},getStudioStyle:function(){var e,t=(null===(e=this.message.meta)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.style_selections)||[];return(this.studioRenderList||[]).filter((function(e){return t.includes(e.id)})).map((function(e){return e.label})).join("、")||""},isSdModel:function(){var e,t;return[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isStudioMode:function(){var e,t;return["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isStudioFlux:function(){var e;return this.isStudioMode&&[1,"1"].includes(null===(e=this.message)||void 0===e?void 0:e.sub_model_category)},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.getImageUrl(this.urlList[this.index].url)},currentImgInfo:function(){return this.urlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,n=e.deg,o=e.offsetX,r=e.offsetY,l=e.enableTransition,style={transform:"scale(".concat(t,") rotate(").concat(n,"deg)"),transition:l?"transform .3s":"","margin-left":"".concat(o,"px"),"margin-top":"".concat(r,"px")};return this.mode===$.CONTAIN&&(style.maxWidth=style.maxHeight="100%"),style},viewerZIndex:function(){var e=v.a.nextZIndex();return this.zIndex>e?this.zIndex:e},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?e:t},convertTaskType:function(){return O.c[this.message.type]||""}}),watch:{accountSettingsData:{handler:function(e){this.isI18nToggled=!e.is_off_localization},deep:!0},index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(e){var t=this;this.$nextTick((function(e){var n,o=null===(n=t.$refs)||void 0===n||null===(n=n.img)||void 0===n?void 0:n[0];null!=o&&o.complete||(t.loading=!0)}))}},methods:{show:function(){this.dialogVisible=!0},init:function(){var e,t=this;if(this.msgId){this.getMetaLoading=!0;var n=this.loraModels&&0===Object.keys(this.loraModels).length,o=["",null,void 0].includes(null===(e=this.message)||void 0===e?void 0:e.art_model_name),r=![this.loraModels&&this.loraModels[this.msgId]];[n,o,r].some((function(e){return e}))?Object(y.getMetaInfo)({id:this.msgId}).then((function(e){var o,r,l;if(1e4===e.status.code){t.intLoraModel=(null===(o=e.data.meta)||void 0===o?void 0:o.lora_models)||[];var c={};c[t.msgId]=t.intLoraModel;var d=(null==e||null===(r=e.data)||void 0===r?void 0:r.art_model_name)||"";t.$emit("uploadMate",null==e?void 0:e.data),["",null,void 0].includes(null===(l=t.message)||void 0===l?void 0:l.art_model_name)&&t.$set(t.message,"art_model_name",d),n&&t.$emit("setLoraModel",c)}})).finally((function(){t.getMetaLoading=!1})):this.getMetaLoading=!1,this.intLoraModel&&!this.intLoraModel.length&&(this.intLoraModel=this.loraModels[this.msgId]||[])}},handleConfirm:function(){this.handleChat()},viewImage:function(e){this.$refs.viewImage.show(e,this.$refs.img[0],2)},isVideoUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(t){return(e||"").toLowerCase().endsWith(t)}))},openLora:function(e){var t=this.localePath("/models/detail/".concat(e.art_model.id));window.open(t,"_blank")},hide:function(){this.dialogVisible=!1,this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var e=this;this._keyDownHandler=function(t){switch(t.stopPropagation(),t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}},this._mouseWheelHandler=Object(m.b)((function(t){var n,o=t.wheelDelta?t.wheelDelta:-t.detail;["el-image-viewer__canvas task-image-viewer__canvas","el-image-viewer__img task-image-viewer__img"].includes(null==t||null===(n=t.target)||void 0===n?void 0:n.className)&&(o>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1}))})),Object(h.e)(document,"keydown",this._keyDownHandler),Object(h.e)(document,M,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(h.d)(document,"keydown",this._keyDownHandler),Object(h.d)(document,M,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(e){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var n=this.transform,o=n.offsetX,r=n.offsetY,l=e.pageX,c=e.pageY;this._dragHandler=Object(m.b)((function(e){t.transform.offsetX=o+e.pageX-l,t.transform.offsetY=r+e.pageY-c})),Object(h.e)(document,"mousemove",this._dragHandler),Object(h.e)(document,"mouseup",(function(e){Object(h.d)(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys($),t=(Object.values($).indexOf(this.mode)+1)%e.length;this.mode=$[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=L({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),o=n.zoomRate,r=n.rotateDeg,l=n.enableTransition,c=this.transform;switch(e){case"zoomOut":c.scale>.2&&(c.scale=parseFloat((c.scale-o).toFixed(3)));break;case"zoomIn":c.scale=parseFloat((c.scale+o).toFixed(3));break;case"clocelise":c.deg+=r;break;case"anticlocelise":c.deg-=r}c.enableTransition=l}},handleOperateBtnClick:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,h,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=(null===(o=t.urlList)||void 0===o||null===(o=o[t.index||0])||void 0===o?void 0:o.url)||"",n.t0=e.type,n.next="chat"===n.t0?4:"post"===n.t0?10:"animGen"===n.t0?12:"download"===n.t0?14:"aiGenerateVideo"===n.t0?16:20;break;case 4:return n.next=6,Object(d.S)({channel:"task",source_id:null===(r=t.message)||void 0===r?void 0:r.id});case 6:return c=n.sent,h=c.data.character_id,(void 0===h?"":h)?t.handleChat():t.$refs.aiChatCreateConfirm.show(),n.abrupt("break",22);case 10:return t.handlePost(),n.abrupt("break",22);case 12:return t.handleAnimate(),n.abrupt("break",22);case 14:return Object(C.M)(l),n.abrupt("break",22);case 16:return m={cover:l},m=JSON.stringify(m),window.open(t.localePath("/ai-tools/ai-video-generator?info=".concat(m))),n.abrupt("break",22);case 20:return t.$emit("imageOperate",e.type,_()(t.urlList[t.index])),n.abrupt("break",22);case 22:case"end":return n.stop()}}),n)})))()},getImageUrl:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},handleChat:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,c,h,m,v,f,_,w,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v={height:null===(n=e.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height,width:null===(o=e.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.width,id:null===(r=e.message)||void 0===r?void 0:r.id,url:e.currentImg||(null===(l=e.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url),source_account_id:(null===(c=e.message)||void 0===c||null===(c=c.messageInfo)||void 0===c||null===(c=c.author)||void 0===c?void 0:c.id)||(null===(h=e.userInfo)||void 0===h?void 0:h.id),channel:"task"},t.next=3,Object(d.S)({channel:"task",source_id:v.id});case 3:if(f=t.sent,_=(null==f?void 0:f.data)||{},w=_.can,2!==(void 0===w?2:w)){t.next=8;break}return e.$message.warning(e.$t("chatFail")),t.abrupt("return");case 8:if(!e.isShowSaveTo||1===e.nsfw){t.next=12;break}return t.next=11,e.handleSave(v);case 11:return t.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(v)),y="/cyberPubPage/".concat(null===(m=e.message)||void 0===m?void 0:m.id,"?quickChat=true&source=work"),window.open(e.localePath(y),"_blank");case 15:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,d,h,m,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:null,console.log("handleSave"),r=t.message,l=r.id,d=void 0===l?"":l,h=r.img_uris,m=(void 0===h?[]:h)[t.operateNumber-1].index,v=void 0===m?"":m,Object(c.a)({folder_no:"default",id:d,index:v}).then((function(){if(t.$emit("saveSuccess"),o){var e;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(e=t.message)||void 0===e?void 0:e.id,"?quickChat=true&source=work");window.open(t.localePath(n),"_blank")}})).catch((function(e){console.log("saveFail",e)}));case 5:case"end":return n.stop()}}),n)})))()},handlePost:function(){var e={taskId:this.message.id,url:this.currentImg,index:this.currentImgInfo.index};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_details",behavior_info_sub:e.url}),this.$EventBus.$emit("openContribution",{selectedData:[e],types:[k.CONTRIBUTION_TYPE_ENUM.WORK],source:"task"}),this.hide()},handleAnimate:function(){this.$emit("handleAnimate"),this.hide()}},mounted:function(){this.show(),this.init(),this.isI18nToggled=!this.accountSettingsData.is_off_localization,this.deviceSupportInstall()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},j=P,D=(n(4055),n(4056),n(4057),n(0)),component=Object(D.a)(j,(function(){var e,t,n,o=this,r=o._self._c;return r("el-dialog",{staticClass:"c-task-image-viewer",attrs:{visible:o.dialogVisible,"append-to-body":!0,"close-on-click-modal":!1,"show-close":!1,modal:!0,fullscreen:!0},on:{"update:visible":function(e){o.dialogVisible=e},close:o.hide}},[r("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper c-task-image-viewer",style:{"z-index":o.viewerZIndex},attrs:{tabindex:"-1"}},[r("div",{staticClass:"el-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:o.handleMaskClick.apply(null,arguments)}}}),o._v(" "),!o.showOperateBtn&&o.isShowChat?r("span",{staticClass:"el-image-viewer__btn el-image-viewer__chat",on:{click:o.handleChat}},[r("i",{staticClass:"iconfont icon-a-home-top-personl1"})]):o._e(),o._v(" "),o.showOperateBtn?o._e():r("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:o.hide}},[r("i",{staticClass:"el-icon-close"})]),o._v(" "),o.showOperateBtn?o._e():r("span",{staticClass:"el-image-viewer__btn el-image-viewer__download",on:{click:function(e){return o.handleOperateBtnClick({type:"download"})}}},[r("i",{staticClass:"iconfont icon-icon-Download"})]),o._v(" "),o.showOperateBtn?o._e():r("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[r("div",{staticClass:"el-image-viewer__actions__inner"},[r("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return o.handleActions("zoomOut")}}}),o._v(" "),r("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return o.handleActions("zoomIn")}}}),o._v(" "),r("i",{staticClass:"el-image-viewer__actions__divider"}),o._v(" "),r("i",{class:o.mode.icon,on:{click:o.toggleMode}}),o._v(" "),r("i",{staticClass:"el-image-viewer__actions__divider"}),o._v(" "),r("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return o.handleActions("anticlocelise")}}}),o._v(" "),r("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return o.handleActions("clocelise")}}})])]),o._v(" "),r("div",{staticClass:"el-image-viewer__canvas task-image-viewer__canvas"},[null!==(e=o.getActionButtons)&&void 0!==e&&e.length?r("image-action-buttons",{attrs:{visible:!0,buttons:o.getActionButtons,maxVisibleButtons:4},on:{"button-click":o.handleOperateBtnClick}}):o._e(),o._v(" "),o.isSingle?o._e():[r("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!o.infinite&&o.isFirst},on:{click:o.prev}},[r("i",{staticClass:"el-icon-arrow-left"})]),o._v(" "),r("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!o.infinite&&o.isLast},on:{click:o.next}},[r("i",{staticClass:"el-icon-arrow-right"})])],o._v(" "),o._l(o.urlList,(function(e,i){return[i!==o.index||o.isVideoUrl(o.currentImg)?i===o.index?r("video",{key:i,staticClass:"el-image-viewer__img task-image-viewer__img",style:o.imgStyle,attrs:{src:o.currentImg,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{play:o.handleImgLoad}}):o._e():r("img",{directives:[{name:"webp",rawName:"v-webp",value:o.$imgH,expression:"$imgH"}],key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img task-image-viewer__img",style:o.imgStyle,attrs:{src:o.currentImg,referrerpolicy:"no-referrer"},on:{load:o.handleImgLoad,mousedown:o.handleMouseDown,click:function(e){return o.viewImage(o.currentImg)}}})]}))],2),o._v(" "),o.showOperateBtn?r("div",{staticClass:"task-image-viewer__side-bar"},[r("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:o.hide}},[r("i",{staticClass:"el-icon-close"})]),o._v(" "),r("div",{staticClass:"btn-box",class:(null===(t=o.renderBtn)||void 0===t?void 0:t.length)%2?"odd":"even"},[o._l(o.renderBtn,(function(e){return[r("el-tooltip",{key:e.type,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"bottom",disabled:!(null!=e&&e.tip),content:o.$t(null==e?void 0:e.tip)}},[r("div",{staticClass:"button",class:e.type,on:{click:function(t){return t.stopPropagation(),o.handleOperateBtnClick(e)}}},[r("span",{staticClass:"icon"},[r("i",{staticClass:"iconfont",class:"icon-".concat(e.icon)})]),o._v(" "),r("span",{staticClass:"label"},[o._v(" "+o._s(o.$t(e.label)))])])])]}))],2),o._v(" "),[0,"0"].includes(o.currentImgInfo.operateNumber)?o._e():r("div",{staticClass:"message-divider"},[r("span",{staticClass:"message-divider-content"},[o._v(o._s(o.$t("GenerationData")))])]),o._v(" "),r("div",{staticClass:"task-image-viewer__prompt-box",class:[o.currentImgInfo&&[0,"0"].includes(o.currentImgInfo.operateNumber)?"task-image-viewer__prompt-box-margin-top":""]},[r("div",{staticClass:"task-image-viewer__prompt-title"},[r("span",{staticClass:"prompt-title-text"},[o._v(o._s(o.$t("Prompt")))]),o._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:o.convertTaskType,expression:"convertTaskType"}],staticClass:"message__title-task-tag"},[o._v(o._s(o.$t(o.convertTaskType)))])]),o._v(" "),r("div",{staticClass:"task-image-viewer__prompt-content"},[o._v("\n          "+o._s(o.setI18nPrompt)+"\n        ")]),o._v(" "),o.isSdModel||o.isStudioMode?o._e():[r("div",{staticClass:"task-image-viewer__prompt-title"},[r("span",{staticClass:"prompt-title-text"},[o._v(o._s(o.$t("NegativePrompts")))])]),o._v(" "),r("div",{staticClass:"task-image-viewer__prompt-content"},[o._v("\n            "+o._s(o.message.meta.negative_prompt||"")+"\n          ")])],o._v(" "),o.isSdModel||o.isStudioFlux?o._e():r("div",{staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("Sampler")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content"},[o._v(o._s(o.message.meta.sampler_name))])]),o._v(" "),o.isStudioMode&&!o.isStudioFlux?r("div",{staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("studio20")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content"},[o._v(o._s((null===(n=o.message.meta)||void 0===n||null===(n=n.lab_base)||void 0===n?void 0:n.scheduler)||""))])]):o._e(),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!o.isStudioFlux,expression:"!isStudioFlux"}],staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("CFGScale")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content2"},[r("span",{staticClass:"task-image-viewer__params-content-3"},[o._v(o._s(o.message.meta.cfg_scale))]),o._v(" "),r("span",[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("Steps")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content-3"},[o._v(o._s(o.message.meta.steps))])])])]),o._v(" "),o.isSdModel||o.isStudioMode&&!o.isStudioFlux?o._e():r("div",{staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("Seed")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content"},[o._v(o._s(o.message.meta.seed))])]),o._v(" "),r("div",{staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("imageDimensions")))]),o._v(" "),r("span",{staticClass:"task-image-viewer__params-content"},[o._v(o._s("".concat(o.currentImgInfo.width," X ").concat(o.currentImgInfo.height)))])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!o.getMetaLoading,expression:"!getMetaLoading"}],staticClass:"task-image-viewer__params"},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v(o._s(o.$t("Model")))]),o._v(" "),r("span",{staticClass:"scale-link-class"},[o._v(o._s(o.message.art_model_name||o.message.art_model_no))])]),o._v(" "),o.intLoraModel.length>0?r("div",{staticClass:"task-image-viewer__params",staticStyle:{"flex-wrap":"wrap","justify-content":"flex-start","align-items":"self-start"}},[r("span",{staticClass:"task-image-viewer__params-label"},[o._v("Lora")]),o._v(" "),r("div",{staticClass:"scaleBox"},o._l(o.intLoraModel,(function(e){return r("div",{key:e.id,staticClass:"scale-link-class",on:{click:function(t){return o.openLora(e)}}},[o._v("\n              "+o._s(e.art_model.name)+"\n            ")])})),0)]):o._e()],2)]):o._e(),o._v(" "),r("view-image",{ref:"viewImage"}),o._v(" "),r("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task"},on:{confirm:o.handleConfirm}})],1)])}),[],!1,null,"3d7cae21",null);t.default=component.exports},303:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(31),n(18),n(21),n(11),n(12),n(13);var o=n(14),r=n(2),l=(n(6),n(32),n(22),n(49),n(8),n(4),n(378),n(7),n(56)),c=n(27),d=n(1),h=n(10),m=n(25),v=n(29),f=n(63),_=n(45),w=n(138),y=n(253),C=n(52),S=n(9),k=n(71),x=n(239),I=void 0;function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={name:"StyleModal",mixins:[_.a],components:{CollectPopover:f.default,modelPayNum:w.default,changeVer:y.default,SwipeableList:C.default,LenovoInput:x.default},props:{selectList:{type:Array,default:function(){return[]}},modelType:{type:String,default:function(){return"LORA"}},placeholder:{type:String,default:function(){return null==I?void 0:I.$t("TaskStylePlaceHolder")}},isPaintingBoard:{type:Boolean,default:!1},isSDXL:{type:Boolean,default:!1},SDXLmodel:{type:Array,default:function(){return null}},SDmodel:{type:Array,default:function(){return null}},inTask:{type:Boolean,default:!1},isStudioMode:{type:Boolean,default:!1},fluxModelId:{type:String,default:""},studioModelInfo:{type:Object,default:function(){return{}}},menuIndex:{type:String,default:function(){return""}},isSimpleMode:{type:Boolean,default:!1},typeIndex:{type:String,default:function(){return""}},hideEmbedding:{type:Boolean,default:!1}},data:function(){return{visible:!1,activeTab:"mine",timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:this.getTimestamps().startTimestamp,endTime:this.getTimestamps().endTimestamp},{name:"week",startTime:this.getWeekTimeRange().startTimestamp,endTime:this.getWeekTimeRange().endTimestamp},{name:"months",startTime:this.getMonthTimestampRange().startTimestamp,endTime:this.getMonthTimestampRange().endTimestamp}],tagIndex:"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],tabList:[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],queryOptionsList:[{label:"综合推荐",value:"comprehensive",order:1,i18nKey:"styleModal1"},{label:"最近使用",value:"recent",order:2,i18nKey:"recentlyUsed"},{label:"我的收藏",value:"collect",order:3,i18nKey:"MyCollection"},{label:"我的模型",value:"bookmarks_choose",order:4,i18nKey:"MyModel"},{label:"更多推荐",value:"recommend",order:5,i18nKey:"FindGoodPictures"}],queryParam:{order_by:"hot",keyword:"",created:"",model_type:"LORA"},list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,limit:60,total:0},debounceHandleScroll:null,gridNum:5,modalWidth:"1340px",debounceResize:null,showType:"",modelOption:[],itemScroll:null,queryType:"comprehensive",modelTypeSelect:[],baseModelSelect:[],tabShowTagEmpty:!1,showTagEmpty:!1,keyWordCopy:""}},computed:T(T(T({},Object(d.e)("user",["collectData","cdnHost","token"])),{},{modelTypes:function(){var e=[{label:"LORA",value:"LORA"},{label:"DoRA",value:"DoRA"},{label:"LyCORIS",value:"LoCon"},{label:"embedding1",value:"TextualInversion"}];return this.hideEmbedding&&(e=e.filter((function(e){return"TextualInversion"!==e.value}))),e},inputModelTypes:function(){var e;return null!==(e=this.modelTypeSelect)&&void 0!==e&&e.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value}))},showEmptyResult:function(){var e=!this.loading,t=!this.renderList.length&&!this.hotRecentUsedList.length,n="mine"===this.activeTab&&!["comprehensive"].includes(this.queryType);return e&&t&&n},lang:function(){return this.$i18n.locale},getTitle:function(){var e={Checkpoint:"Checkpoint",LORA:"LoRA",TextualInversion:this.$t("embedding1")}[this.modelType]||this.modelType;return"".concat(this.$t("selectModels"),"(").concat(e,")")},getModels:function(){var e=S.L.sd,t=S.L.sd3,n=S.L.sdxl,r=S.L.flux,l=S.L.sd35,c=[];return c=["imageToImage","conditionToImage"].includes(this.menuIndex)?[].concat(Object(o.a)(e),Object(o.a)(t),Object(o.a)(n)):[].concat(Object(o.a)(e),Object(o.a)(l),Object(o.a)(t),Object(o.a)(n),Object(o.a)(r)),{sd:this.SDmodel||e,sd35:l,sd3:t,sdxl:this.SDXLmodel||n,allBaseModels:c,flux:r}},getBaseModel:function(){var e,t=this.getModels.sd;(t=this.isSDXL?this.getModels.sdxl:this.isPaintingBoard&&"Checkpoint"===this.modelType?this.getModels.allBaseModels:this.getModels.sd,this.isStudioMode)&&(t="Checkpoint"===this.modelType?[]:this.getModels.sd,t="Checkpoint"===this.modelType?this.getModels.allBaseModels:{SDXL:this.getModels.sdxl,SD:this.getModels.sd,SD3:this.getModels.sd3,FLUX:this.getModels.flux,"SD 3.5":this.getModels.sd35,"SD 3.5L":["SD 3.5L"],"SD 3.5M":["SD 3.5M"]}[this.getCurrentModelType]||this.getModels.sd);return"pony_default"===this.typeIndex&&(t=["Pony"]),"illustrious_default"===this.typeIndex&&(t=["Illustrious"]),"FLUX"===this.getCurrentModelType||null!==(e=this.getCurrentModelType)&&void 0!==e&&e.includes("SD 3.5")?Object(o.a)(t):"Checkpoint"===this.modelType?[].concat(Object(o.a)(t),Object(o.a)(S.L.other)):Object(o.a)(t)},getCurrentModelType:function(){var e=(this.studioModelInfo||{}).base_model_type,t=void 0===e?"":e,n=this.getModels.flux,o=this.getModels.sdxl,r=this.getModels.sd,l=this.getModels.sd35,c=o.includes(t)||(t||"").includes("SDXL"),d=r.includes(t),h=n.includes(t)||(t||"").includes("Flux"),m=l.includes(t)||(t||"").includes("SD 3.5");return h?"FLUX":c?"SDXL":d?"SD":"SD 3"===t?"SD3":m?t:void 0},showRecommendText:function(){return!this.loading&&this.hotUsedList.length&&"mine"===this.activeTab&&"comprehensive"===this.queryType},isNoRecentUsed:function(){return!this.loading&&!this.renderList.length&&"recent"===this.queryType&&this.showRecommendText},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},activeTabClass:function(){return function(e){return e&&e===this.activeTab?"tab-active":""}}},Object(d.c)(["isSupportWebp"])),{},{getImageUrl:function(){return function(e){var t="";return e.banner&&!["",null,void 0].includes(e.banner.url)?t=Object(h.K)(e.banner.url,this.$imgL):t}},activeSelectModel:function(){return function(e){return this.selectList.find((function(t){return(e.id||e.model_id)===(t.id||t.model_id)}))?"select-model-active":""}},renderList:function(){return this.list},hotUsedList:function(){return this.hotRecentUsedList},convertTabText:function(){return function(e){var t="LORA"===this.modelType?"MyStyle":"MyModel";return e.title?e.title:"bookmarks_choose"===e.type?this.$t(t):this.$t(e.i18nKey)}}}),beforeDestroy:function(){this.debounceHandleScroll=null},watch:{hotRecentUsedList:{handler:function(e){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var t=0;t<this.selectList.length;t++)if(this.selectList[t].id===this.hotRecentUsedList[i].id&&this.selectList[t].art_model_ver_no_name&&this.hotRecentUsedList[i].version_name){this.hotRecentUsedList[i].version_name=this.selectList[t].art_model_ver_no_name,this.hotRecentUsedList[i].banner.url=this.selectList[t].model_cover;break}}},list:{handler:function(e){for(var i=0;i<this.list.length;i++)for(var t=0;t<this.selectList.length;t++)if(this.selectList[t].id===this.list[i].id&&this.selectList[t].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[t].art_model_ver_no_name,this.list[i].banner.url=this.selectList[t].model_cover;break}}}},mounted:function(){var e=this;this.debounceHandleScroll=Object(m.debounce)(this.handleScroll,600),this.debounceResize=Object(m.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){e.handleResize()}))},methods:{onFilter:function(e,t){var n=this;this.loading||(1===t?this.modelTypeSelect.includes(e)?this.modelTypeSelect.forEach((function(t,o){t==e&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(e):this.baseModelSelect.includes(e)?this.baseModelSelect.forEach((function(t,o){t==e&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(e),"recommend"===this.queryType&&(this.tagIndex="hot"),this.checkGetList())},onFilterReset:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.modelTypeSelect=[],this.baseModelSelect=[],e||this.checkGetList())},changeQueryType:function(){this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:this.queryType,source:this.getCurrentSource()})},checkGetList:function(){"comprehensive"!==this.queryType?"recent"===this.queryType?this.handleGetRecentUsed():this.handleSearch():this.handleGetComList()},handleGetComList:function(){var e=this;this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to");var t,n={};(n.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,n.model_type=this.modelType||"LORA",n.ss=S.e.GenerateSearch,(this.isStudioMode||this.isSimpleMode)&&(n.mode="lab"),this.isSimpleMode&&(n.scene="st_gen"),"Checkpoint"!==this.modelType)&&(n.model_types=null!==(t=this.modelTypeSelect)&&void 0!==t&&t.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value})));return this.loading=!0,Object(v.getModelComprehensive)(n).then((function(t){var o=t||{},r=o.status.code,code=void 0===r?"":r,l=o.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var c=Array.isArray(null==data?void 0:data.items)?data.items:[],d=Array.isArray(null==data?void 0:data.hot_used_items)?data.hot_used_items:[];e.noMore=!0;var h={},m=(c||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return h[t.id]||(h[t.id]=!0,e.push(t)),e}),[]).filter((function(t){return("Checkpoint"===e.modelType?[e.modelType]:n.model_types).includes(t.type)||e.modelTypeSelect.includes(t.type)})).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));e.list=m.length<=10?m:m.slice(0,10),e.hotRecentUsedList=(d||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return h[t.id]||(h[t.id]=!0,e.push(t)),e}),[]).filter((function(t){return("Checkpoint"===e.modelType?[e.modelType]:n.model_types).includes(t.type)||e.modelTypeSelect.includes(t.type)})).map((function(t){var n,o=(t.banner||{}).nsfw;[1,"1"].includes(void 0===o?0:o)&&(t.banner=Object.assign((null===(n=t)||void 0===n?void 0:n.banner)||{},{url:e.nsfwUrl}));var r=e.findSelectItem(t);return r&&(t=Object.assign(t,r)),t}))}return e.noDataView(),e.list})).finally((function(){e.loading=!1}))},setIcon:function(){var e=this,t="homeIcon1";return this.typeOption.forEach((function(n){e.tagIndex===n.id&&(t=n.icon)})),t},handleCommand:function(e){this.tagIndex=e,this.queryParam.order_by=this.tagIndex,this.handleSearch()},handleTimeCommand:function(e){this.timeName=e.name,this.queryParam.start_at=e.startTime,this.queryParam.end_at=e.endTime,this.handleSearch()},getTimestamps:function(){var e=new Date;return{startTimestamp:e-864e5,endTimestamp:e.getTime()}},getWeekTimeRange:function(){var e=new Date;return{startTimestamp:e-6048e5,endTimestamp:e.getTime()}},getMonthTimestampRange:function(){var e=new Date;e.getFullYear(),e.getMonth();return{startTimestamp:e-2592e6,endTimestamp:e.getTime()}},changeScroll:function(){var e=this;this.$refs.listItem.forEach((function(t,n){t.classList.contains("tab-active")&&(e.itemScroll={value:t.getBoundingClientRect().left,index:n})}))},getTag:function(){var e=this;Object(k.d)({show_area:"model"}).then((function(t){if(1e4===t.status.code){var n=t.data||[];n.length&&n.forEach((function(t){t.title=t[S.r[e.$i18n.locale]]})),e.tabList=[].concat(Object(o.a)(e.tabList),Object(o.a)(n))}}))},collectionBar:function(){var e=this;Object(c.J)({type:2}).then((function(t){1e4===t.status.code&&(e.modelOption=[{label:e.$t("All"),value:""}],t.data.items.forEach((function(t){e.modelOption.push({label:t.name,value:t.id})})))}))},changeType:function(e){this.list=[],this.pageInfo={page:1,limit:60,total:0},this.handleSearch()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1340px",this.gridNum=5):(this.modalWidth="1071px",this.gridNum=4)}catch(e){}},selectItem:function(e,t,n){var o,r;(t.model_ver_no=e.model_ver_id,t.version_name=e.version_no,t.base_model=e.base_model_name,t.modelTags=Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[],null!==(o=e.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?t.banner.url=null===(r=e.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url:t.banner.url="";n&&this.$emit("selectModel",t)},openModal:function(){var e=this;if(this.resetData(),this.token&&this.collectionBar(),this.queryParam.model_type=this.modelType||"",this.tabList=[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],this.activeTab="mine",this.queryType="comprehensive",this.getTag(),!this.token)return this.checkGetList(),void(this.visible=!0);this.$nextTick((function(){e.getRecentUsedModel().finally((function(){e.loading=!1,e.list.length&&e.list.length>=10?(e.activeTab="mine",e.queryType="recent"):(e.activeTab="mine",e.queryType="comprehensive",e.hotRecentUsedList=[],e.checkGetList())})),e.visible=!0}))},handleClose:function(){this.visible=!1,this.resetData()},resetData:function(){this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.list=[],this.activeTab="mine",this.queryType="comprehensive",this.loading=!1,this.noMore=!1,this.hotRecentUsedList=[]},handleViewMore:function(){this.activeTab="",this.handleTabClick("mine","recommend")},handleTabClick:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e===this.activeTab||this.loading||(this.activeTab=e,"mine"===e?(this.queryType=n||"comprehensive",this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"}):(this.queryType="recommend",Object.assign(this.queryParam,{keyword:"",created:"",model_type:this.modelType||"LORA"})),this.$nextTick((function(){t.changeScroll()})),this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.checkGetList(),this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:e,source:this.getCurrentSource()}))},screenAll:function(){this.activeTab="mine",this.baseModelSelect=[],this.modelTypeSelect=[],this.queryParam.order_by="hot",this.queryParam.created="",this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.$logEvent("log_actions",{operation:"click_search_all",behavior_info:"on_choose_model_page",behavior_info_sub:this.activeTab}),this.handleSearch()},handleSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.list=[],this.hotRecentUsedList=[],Reflect.deleteProperty(this.queryParam,"time_to"),"recent"===this.queryType&&(this.queryType="recommend"),"comprehensive"===this.queryType&&(this.queryType="recommend"),this.getList(),"dot"===e&&this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:"search_btn",source:this.getCurrentSource()})},handleScroll:function(){var e=this.$refs.scrollWrapper;try{e&&e.scrollTop+e.clientHeight>=e.scrollHeight-30&&"recent"!==this.queryType&&this.getList(!0)}catch(e){}},getList:function(e){var t=this;if(!this.loading&&!this.noMore){this.loading=!0;var n,o={collect:"bookmarks",recommend:"community",bookmarks_choose:"bookmarks_choose"}[JSON.parse(JSON.stringify(this.queryType))]||"",r={page:this.pageInfo.page,page_size:this.pageInfo.limit,type:o};if((this.isStudioMode||this.isSimpleMode)&&(r.mode="lab"),this.isSimpleMode&&(r.scene="st_gen"),this.inTask&&(r.refer="task"),"bookmarks"===r.type){var c=0;r.folder_no=this.showType;try{var d,h=this.list.length?this.list[this.list.length-1]:null;c=(null==h||null===(d=h.collect)||void 0===d?void 0:d.collect_at)||0,r.after=1===r.page?0:c}catch(e){}}if(["recent","collect","bookmarks","bookmarks_choose","recommend","comprehensive","mine"].includes(this.activeTab)||(r.tags=[this.activeTab],r.type="community"),"Checkpoint"!==this.modelType)r.model_types=null!==(n=this.modelTypeSelect)&&void 0!==n&&n.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value}));r.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,r.ss=S.e.GenerateSearch,Object.assign(r,this.queryParam),(""!==this.queryParam.keyword&&"recommend"===this.queryType?l.q:l.s)(r).then((function(n){var o=n||{},r=o.status,l=void 0===r?{}:r,c=o.data,data=void 0===c?{}:c,d=l.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(t.noMore=!data.has_more,e){var h=t.list.map((function(e){return e.id})),m=(n.data.items||[]).filter((function(e){return!h.includes(e.id)})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}));t.list=t.list.concat(m)}else t.list=(n.data.items||[]).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}));1===t.pageInfo.page&&(t.queryParam.time_to=n.data.time_ms),t.pageInfo.page++,t.loading=!1,t.keyWordCopy=t.queryParam.keyword,t.noDataView()}})).catch((function(e){console.log(e)})).finally((function(){t.loading=!1}))}},noDataView:function(){var e=!this.loading,t=!this.list.length,n="mine"!==this.activeTab,o=""===this.queryParam.keyword,r=e&&t&&n&&o,l=e&&t&&n&&!o;this.tabShowTagEmpty=r,this.showTagEmpty=l},findSelectItem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(e)){var t=this.selectList.find((function(t){return(e.id||e.model_id)===(t.id||t.model_id)}));return e=t||e}return null},getCurrentSource:function(){return"TextualInversion"===this.modelType?"embedding":this.isSimpleMode?"simple_task":this.isPaintingBoard?"painting_board":"task"},handleSelect:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(["cltpop","use"].includes(null===(e=(arguments.length>2?arguments[2]:void 0).target)||void 0===e?void 0:e.className)){if(n&&"Checkpoint"!==this.modelType)return void this.$message.warning(this.$t("CannotSelectedRepeatedly"));if(this.isStudioMode&&!this.isStudioFlux&&"Checkpoint"!==this.modelType){var o=(this.studioModelInfo||{}).base_model_type,r=void 0===o?"":o,l=this.getModels.sdxl,c=this.getModels.sd,d=this.getModels.sd3,h=this.getModels.sd35,m=h.includes(r)||(r||"").includes("SD 3.5"),v=l.includes(r)||(r||"").includes("SDXL"),f=c.includes(r),_=d.includes(r),w=l.includes(null==t?void 0:t.base_model)||((null==t?void 0:t.base_model)||"").includes("SDXL"),y=c.includes(null==t?void 0:t.base_model),C=d.includes(null==t?void 0:t.base_model),S=h.includes(null==t?void 0:t.base_model);return v&&!w||f&&!y||_&&!C||m&&!S?void this.$message.warning(this.$t("studio25")):(this.$logEvent("log_actions",{operation:"click_choose_model",behavior_info:"on_choose_model_page",behavior_info_sub:null==t?void 0:t.id,source:this.getCurrentSource()}),void this.$emit("selectModel",t))}if(this.isStudioMode&&null!=t&&t.base_model.includes("Flux")&&["imageToImage","conditionToImage"].includes(this.menuIndex))return void this.$message.warning(this.$t("studioTips1"));this.$logEvent("log_actions",{operation:"click_choose_model",behavior_info:"on_choose_model_page",behavior_info_sub:null==t?void 0:t.id,source:this.getCurrentSource()}),this.$emit("selectModel",t)}},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getRecentUsedModel()},getRecentUsedModel:function(){var e,t=this,n={};(n.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,n.ss=S.e.GenerateSearch,"TextualInversion"===this.modelType&&(n.model_type="TextualInversion"),(this.isStudioMode||this.isSimpleMode)&&(n.mode="lab"),this.isSimpleMode&&(n.scene="st_gen"),"Checkpoint"!==this.modelType)&&(n.model_types=null!==(e=this.modelTypeSelect)&&void 0!==e&&e.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value})));return this.loading=!0,Object(v.getRecentUsed)(n).then((function(e){console.log(e);var o=e||{},r=o.status.code,code=void 0===r?"":r,l=o.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var c=Array.isArray(data.items)?data.items:[],d={};t.list=(c||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return d[t.id]||(d[t.id]=!0,e.push(t)),e}),[]).filter((function(e){var o="Checkpoint"===t.modelType?[t.modelType]:n.model_types;return t.isStudioMode||t.isSimpleMode?o.includes(e.type):o.includes(e.type)&&(null==e?void 0:e.id)!==S.m})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},handleDetail:function(e){(null==e?void 0:e.id)&&window.open(this.localePath("/models/detail/".concat(e.id)),"_blank")},convertModelFlag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getModels.sdxl,n=(this.getModels.sd,this.getModels.sd3),o=this.getModels.flux||[],r=e.type,l=void 0===r?"":r,c=e.base_model,d=void 0===c?"":c,h={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:this.$t("embedding1")}[l]||l,m=t.includes(d)||(d||"").includes("SDXL");return n.includes(d)?"SD3":o.includes(d)?"LORA"===this.modelType?h+" | F1 ":"Checkpoint | F1 ":["Illustrious"].includes(d)?"LORA"===this.modelType?h+" | IL ":"Checkpoint | IL ":m?"SDXL":h}}},$=L,M=(n(4082),n(4083),n(0)),component=Object(M.a)($,(function(){var e,t,n,o,r=this,l=r._self._c;return l("el-dialog",{ref:"styleModal",attrs:{title:r.getTitle,visible:r.visible,width:r.modalWidth,height:"auto","custom-class":"c-style-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,center:""},on:{"update:visible":function(e){r.visible=e},close:function(e){return r.onFilterReset(!0)}}},[l("div",{staticClass:"style-content-wrapper"},[l("div",{staticClass:"style-content__header"},[l("swipeable-list",{attrs:{scrollChange:r.itemScroll,top:"15px"}},[l("div",{staticClass:"style-content__header-tabs"},r._l(r.tabList,(function(e,t){return l("div",{key:"tab_".concat(null==e?void 0:e.id,"_").concat(t)},[l("div",{ref:"listItem",refInFor:!0,staticClass:"style-content__header-tabs-item",class:[r.activeTabClass(e.id)],attrs:{"data-id":e.id},on:{click:function(t){return t.stopPropagation(),r.handleTabClick(e.id)}}},[r._v("\n              "+r._s(r.convertTabText(e))+"\n            ")])])})),0)])],1),r._v(" "),l("div",{staticClass:"style-content__search-box"},[l("div",[r._e(),r._v(" "),l("LenovoInput",{attrs:{width:404,screen:{activeTab:r.activeTab,baseModelSelect:r.baseModelSelect.length?r.baseModelSelect:r.getBaseModel,modelType:r.modelType,model_types:r.inputModelTypes,isStudioMode:r.isStudioMode,isSimpleMode:r.isSimpleMode},isLoca:"creative",clearable:"",placeholder:"LORA"===r.modelType?r.$t("TaskStylePlaceHolder"):r.$t("TaskModelPlaceHolder")},on:{onScreen:function(e){return r.handleSearch("dot")},clear:function(e){return r.handleSearch("dot")}},model:{value:r.queryParam.keyword,callback:function(e){r.$set(r.queryParam,"keyword",e)},expression:"queryParam.keyword"}}),r._v(" "),l("span",{staticClass:"style-content__search-btn style-content__search-btn-gra-border",on:{click:function(){return""!=r.queryParam.keyword&&r.handleSearch("dot")}}},[l("span",[r._v(r._s(r.$t("Search")))])])],1),r._v(" "),l("div",{staticClass:"search-right"},[l("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[l("div",{staticClass:"filterCnt"},["LORA"===r.modelType?[l("div",{staticClass:"filterTit"},[r._v("\n                "+r._s(r.$t("ModelType"))+"\n              ")]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.modelTypes,(function(e,t){return l("div",{key:t,staticClass:"filterItem",class:{AfilterItem:r.modelTypeSelect.includes(e.value)},on:{click:function(t){return r.onFilter(e.value,1)}}},[r.modelTypeSelect.includes(e.value)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s(r.$t(e.label)))])])})),0)]:r._e(),r._v(" "),l("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[r._v(r._s(r.$t("BaseModel")))]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.getBaseModel,(function(e,t){return l("div",{key:t,staticClass:"filterItem",class:{AfilterItem:r.baseModelSelect.includes(e)},on:{click:function(t){return r.onFilter(e,2)}}},[r.baseModelSelect.includes(e)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s("TextualInversion"===e?r.$t("embedding1"):e))])])})),0),r._v(" "),l("div",{staticClass:"filterReset graBorder",on:{click:function(e){return r.onFilterReset(!1)}}},[r._v("\n              "+r._s(r.$t("resetSelection"))+"\n            ")])],2),r._v(" "),l("el-badge",{staticClass:"item",attrs:{slot:"reference",value:(null===(e=r.modelTypeSelect)||void 0===e?void 0:e.length)+(null===(t=r.baseModelSelect)||void 0===t?void 0:t.length),hidden:(null===(n=r.modelTypeSelect)||void 0===n?void 0:n.length)+(null===(o=r.baseModelSelect)||void 0===o?void 0:o.length)==0},slot:"reference"},[l("div",{staticClass:"filterBox"},[l("div",[l("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),l("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})])])],1),r._v(" "),"mine"===r.activeTab&&"collect"===r.queryType&&r.modelOption.length>0?l("el-select",{staticClass:"showType custom-select",class:r.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:r.changeType},model:{value:r.showType,callback:function(e){r.showType=e},expression:"showType"}},r._l(r.modelOption,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):r._e(),r._v(" "),"mine"===r.activeTab?l("el-select",{staticClass:"showType custom-select",class:r.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:r.changeQueryType},model:{value:r.queryType,callback:function(e){r.queryType=e},expression:"queryType"}},r._l(r.queryOptionsList,(function(e){return l("el-option",{key:e.value,attrs:{label:r.$t(e.i18nKey),value:e.value}})})),1):r._e(),r._v(" "),["recent","collect","bookmarks","bookmarks_choose","recommend","mine"].includes(r.activeTab)?r._e():l("div",{staticClass:"Screening"},[l("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleTimeCommand}},[l("div",{staticClass:"el-dropdown-link selectTime"},[l("div",[l("i",{staticClass:"el-icon-time"}),r._v(" "),l("span",[r._v(r._s(r.$t(r.timeName)))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.timeTypeOption,(function(e,t){return l("el-dropdown-item",{key:t,attrs:{command:e}},[l("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[l("span",[r._v(r._s(r.$t(e.name)))])])])})),1)],1),r._v(" "),l("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleCommand}},[l("div",{staticClass:"el-dropdown-link"},[l("div",[l("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(r.setIcon())}),r._v(" "),l("span",[r._v(r._s(r.$t(r.tagIndex.charAt(0).toUpperCase()+r.tagIndex.slice(1))))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.typeOption,(function(e,t){return l("el-dropdown-item",{key:t,attrs:{command:e.id}},[l("div",{staticClass:"el-dropdown-item"},[l("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(e.icon)}),r._v(" "),l("span",[r._v(r._s(r.$t(e.name)))])])])})),1)],1)],1)],1)]),r._v(" "),l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"style-content__list-wrapper",class:[r.isNoRecentUsed?"style-content__list-wrapper-no-margin":""],style:{gridTemplateColumns:"repeat(".concat(r.gridNum,", 1fr)")},on:{scroll:r.handleScroll}},[r.renderList.length?r._l(r.renderList,(function(e){var t;return l("div",{key:e.id,staticClass:"style-content__list-item",class:[r.activeSelectModel(e)],on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[l("div",{staticClass:"top-box"},[e.is_agency_fee?l("div",{staticClass:"payNum"},[l("modelPayNum",{attrs:{number:e.agency_fee}})],1):r._e()]),r._v(" "),l("div",{staticClass:"cltpop"},[l("div",{staticClass:"collect-popover-container"},[l("CollectPopover",{attrs:{type:"model",folder:e,from:"waterfall"}})],1),r._v(" "),l("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),r.handleDetail(e)}}},[r._v("\n              "+r._s(r.$t("Details"))+"\n            ")])]),r._v(" "),l("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)?l("div",{staticClass:"list-item-image-card-image"},[l("div",{staticClass:"image-empty"},[r._v(r._s(r.$t("EmptyBannerText")))])]):l("el-image",{staticClass:"list-item-image-card-image",attrs:{src:r.getImageUrl(e)}},[l("template",{slot:"error"},[l("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:e&&e.banner?e.banner.url:"",alt:""}})])],2)],1),r._v(" "),l("div",{staticClass:"list-item-image-mask"},[l("div",{staticClass:"list-item-image-mask-row"},[l("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:e.name}},[r._v(r._s(e.name))])]),r._v(" "),l("div",{staticClass:"list-item-image-mask-row"},[l("changeVer",{attrs:{from:"styleModal",item:e,base_models:r.getBaseModel},on:{selectItem:function(t){return r.selectItem(t,e,r.activeSelectModel(e))}}}),r._v(" "),l("div",{staticClass:"use",on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[r._v("\n                "+r._s(r.$t("workFlow46"))+"\n              ")])],1)]),r._v(" "),"Pony"===(null==e?void 0:e.base_model)?[l("span",{staticClass:"model-type-flag"},[r._v("\n              "+r._s("TextualInversion"===e.type?r.$t("embedding1"):"LoCon"===e.type?"LyCORIS":e.type)),l("span",{staticClass:"model-type-flag-line"},[r._v("|")]),l("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[l("span",{directives:[{name:"show",rawName:"v-show",value:""!==r.convertModelFlag(e),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[r._v(r._s(r.convertModelFlag(e)))])]],2)})):r._e(),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.showRecommendText,expression:"showRecommendText"}],staticClass:"recommend-text",style:{gridColumn:"span ".concat(r.gridNum)}},[l("div",{staticClass:"recommend-text-line"}),r._v(" "),l("div",{staticClass:"recommend-text-main"},[r._v(r._s(r.$t("styleModalLineText")))]),r._v(" "),l("div",{staticClass:"recommend-text-line"})]),r._v(" "),!r.loading&&r.hotUsedList.length&&"mine"===r.activeTab&&["comprehensive"].includes(r.queryType)?[r._l(r.hotUsedList,(function(e){var t;return l("div",{key:"hot_".concat(e.id),staticClass:"style-content__list-item",class:[r.activeSelectModel(e)],on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[l("div",{staticClass:"top-box"},[e.is_agency_fee?l("div",{staticClass:"payNum",attrs:{num:""}},[l("modelPayNum",{attrs:{number:e.agency_fee}})],1):r._e()]),r._v(" "),l("div",{staticClass:"cltpop"},[l("div",{staticClass:"collect-popover-container"},[l("CollectPopover",{attrs:{type:"model",folder:e,from:"waterfall"}})],1),r._v(" "),l("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),r.handleDetail(e)}}},[r._v("\n              "+r._s(r.$t("Details"))+"\n            ")])]),r._v(" "),l("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)?l("div",{staticClass:"list-item-image-card-image"},[l("div",{staticClass:"image-empty"},[r._v(r._s(r.$t("EmptyBannerText")))])]):l("el-image",{staticClass:"list-item-image-card-image",attrs:{src:r.getImageUrl(e)}},[l("template",{slot:"error"},[l("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:e&&e.banner?e.banner.url:"",alt:""}})])],2),r._v(" "),l("div",{staticClass:"list-item-image-mask"},[l("div",{staticClass:"list-item-image-mask-row"},[l("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:e.name}},[r._v(r._s(e.name))])]),r._v(" "),l("div",{staticClass:"list-item-image-mask-row"},[l("changeVer",{attrs:{from:"styleModal",item:e,base_models:r.getBaseModel},on:{selectItem:function(t){return r.selectItem(t,e,r.activeSelectModel(e))}}}),r._v(" "),l("div",{staticClass:"use",on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[r._v("\n                  "+r._s(r.$t("workFlow46"))+"\n                ")])],1)])],1),r._v(" "),"Pony"===(null==e?void 0:e.base_model)?[l("span",{staticClass:"model-type-flag"},[r._v("\n              "+r._s("TextualInversion"===e.type?r.$t("embedding1"):"LoCon"===e.type?"LyCORIS":e.type)),l("span",{staticClass:"model-type-flag-line"},[r._v("|")]),l("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[l("span",{directives:[{name:"show",rawName:"v-show",value:""!==r.convertModelFlag(e),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[r._v(r._s(r.convertModelFlag(e)))])]],2)})),r._v(" "),l("div",{staticClass:"show-more-item",style:{gridColumn:"span ".concat(r.gridNum)}},[l("span",{staticClass:"show-more-item-btn",on:{click:function(e){return e.stopPropagation(),r.handleViewMore()}}},[l("span",{staticClass:"show-more-item-btn-text"},[r._v(r._s(r.$t("viewMore")))]),r._v(" "),l("i",{staticClass:"iconfont icon-icon-direction-down show-more-item-btn-icon"})])])]:r._e(),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[l("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),r._v(" "),"LORA"===r.modelType&&"mine"===r.activeTab&&["recent"].includes(r.queryType)&&["",null,void 0].includes(r.queryParam.keyword)?[r._v("\n          "+r._s(r.$t("styleRecent"))+"\n        ")]:"LORA"===r.modelType&&["collect"].includes(r.queryType)&&"mine"===r.activeTab&&["",null,void 0].includes(r.queryParam.keyword)?[r._v("\n          "+r._s(r.$t("styleCollect"))+"\n        ")]:[r._v(r._s(r.$t("NoResultsFound")))]],2),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.showTagEmpty,expression:"showTagEmpty"}],staticClass:"tag-empty-box flex_c_m"},[l("div",{staticClass:"item flex_c"},[l("p",[r._v(r._s(r.$t("screenTagNodata",{keyword:r.keyWordCopy?' "'.concat(r.keyWordCopy,'" '):""})))]),r._v(" "),l("div",{staticClass:"btn",on:{click:r.screenAll}},[r._v(r._s(r.$t("screenAll")))])])]),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.tabShowTagEmpty,expression:"tabShowTagEmpty"}],staticClass:"style-content__list-empty"},[l("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),r._v(" "),l("p",[r._v(r._s(r.$t("NoResultsFound")))])],1)],2)])])}),[],!1,null,"3358f5d7",null);t.default=component.exports;installComponents(component,{SwipeableList:n(52).default,LenovoInput:n(239).default,CollectPopover:n(63).default,SvgIcon:n(115).default})},3067:function(e,t,n){e.exports={}},3068:function(e,t,n){e.exports={}},3069:function(e,t,n){e.exports={}},3094:function(e,t,n){"use strict";n.r(t);var o={},r=(n(4129),n(0)),component=Object(r.a)(o,(function(){var e=this;return(0,e._self._c)("button",{staticClass:"AddButton",on:{click:function(t){return e.$emit("click",t)}}})}),[],!1,null,"725e8c8b",null);t.default=component.exports},3095:function(e,t,n){"use strict";n.r(t);var o=n(10).g,r={mounted:function(){var e=this;this.$nextTick((function(){})),document.addEventListener("mousedown",(function(t){e.show&&(e.$el.contains(t.target)||e.close())}))},data:function(){return{show:!1,bindEl:null,clickW:0,promptList:null,item:null}},methods:{doCopy:function(){this.close(),o(this.item.data.word.rawText)},doEdit:function(){this.close(),this.item.state.isEdit="text",this.bindEl.__vue__.doFoucs()},doEditLang:function(){this.close(),this.item.state.isEdit="lang",this.bindEl.__vue__.doFoucs()},doDelete:function(){this.close(),this.promptList.removePrompt(this.item),this.bindEl.__vue__.$emit("update")},open:function(e){var t=e.item,n=e.el,o=e.event,r=e.promptList;this.bindEl=n,this.clickW=o.clientX,this.show=!0,this.item=t,this.promptList=r,this.updatePosition()},close:function(){this.show=!1},updatePosition:function(){if(this.bindEl){var e=this.$refs.menu;if(e){var t=e.getBoundingClientRect().width,rect=this.bindEl.getBoundingClientRect();e.style.left="".concat(this.clickW-t/2,"px"),e.style.top="".concat(rect.y+rect.height,"px")}}}},computed:{},beforeDestroy:function(){}},l=(n(4131),n(0)),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],ref:"menu",staticClass:"PromptMenu"},[t("button",{staticClass:"prompt-menu-btn",on:{click:e.doCopy}},[t("i",{staticClass:"iconfont icon-copy"}),e._v("\n    "+e._s(e.$t("OPS_copy"))+"\n  ")]),e._v(" "),t("button",{staticClass:"prompt-menu-btn",on:{click:e.doEdit}},[t("i",{staticClass:"iconfont icon-edit1"}),e._v(" "+e._s(e.$t("Edit")))]),e._v(" "),t("button",{staticClass:"prompt-menu-btn",on:{click:e.doDelete}},[t("i",{staticClass:"iconfont icon-work-delete"}),e._v("\n    "+e._s(e.$t("Delete"))+"\n  ")])])}),[],!1,null,null,null);t.default=component.exports},3096:function(e,t,n){"use strict";var o=n(803),r=(n(4130),n(0)),component=Object(r.a)(o.a,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"PromptList"},[e._t("default")],2)}),[],!1,null,"6deea24e",null);t.a=component.exports},3194:function(e,t,n){"use strict";n.r(t);n(19),n(22),n(90),n(1767),n(26);var o=n(1190),r=(n(18),n(805)),l=(n(4132),n(0)),component=Object(l.a)(r.a,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"PromptWork active",class:{isPNGExporting:e.isPNGExporting},on:{click:e.onWorkClick}},[t("div",{staticClass:"AddArea Area"},[t("div",{staticClass:"cover-area"},[t("div",{staticClass:"WorkInfoArea Area"},[t("div",{staticClass:"WorkName"},[t("input",{attrs:{type:"text",disabled:""},domProps:{value:e.$t("Input")}})])]),e._v(" "),t("el-input",{staticClass:"input",attrs:{type:"textarea",placeholder:e.$t("OPS_pls_input"),rows:"13",spellcheck:"false",maxlength:"1000","show-word-limit":""},on:{paste:e.onUserInputDebounce,input:e.onUserInputDebounce,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onUserInputDebounce.apply(null,arguments)},change:e.onUserInputDebounce},model:{value:e.inputText,callback:function(t){e.inputText=t},expression:"inputText"}})],1),e._v(" "),t("div",{staticClass:"cover-area"},[t("div",{staticClass:"WorkInfoArea Area"},[t("div",{staticClass:"WorkName"},[t("input",{attrs:{type:"text",disabled:""},domProps:{value:e.$t("Output")}})])]),e._v(" "),t("div",{staticClass:"output"},[[e._v(" "+e._s(e.outputText))]],2),e._v(" "),t("div",{staticClass:"options"},[t("div",{staticClass:"line"},[t("button",{attrs:{title:"copy"},on:{click:function(t){return e.copy(e.outputText)}}},[t("i",{staticClass:"iconfont icon-copy-ops"}),e._v("\n            "+e._s(e.$t("OPS_copy"))+"\n          ")]),e._v(" "),t("button",{attrs:{title:"clear"},on:{click:function(t){return e.doClear()}}},[t("i",{staticClass:"iconfont icon-clear-ops"}),e._v("\n            "+e._s(e.$t("OPS_clear_input"))+"\n          ")])]),e._v(" "),t("div",{staticClass:"line line-spacial"},[t("button",{staticClass:"line-generate-btn",attrs:{title:e.$t("Generate")},on:{click:function(t){return e.handleGenerate(e.outputText)}}},[e._v("\n            "+e._s(e.$t("Generate"))+"\n          ")])])])])]),e._v(" "),t("div",{ref:"main",staticClass:"main"},[t("div",{staticClass:"PromptListArea Area",class:[e.promptWork.groups.length<=1?"noGroup":"hasGroup"],on:{contextmenu:function(e){e.preventDefault()}}},e._l(e.promptWork.groups,(function(n,o){return t("div",{key:o,staticClass:"PromptGroup"},[e.promptWork.groups.length>1?t("div",{staticClass:"PromptGroupTitle"},[t("div",{staticClass:"name"},[t("input",{attrs:{value:"权重组"}}),e._v(" "),n.name?t("span",[e._v(e._s(n.name))]):e._e(),e._v(" "),n.groupLv&&1!=n.groupLv?t("span",{staticClass:"groupLv"},[e._v(e._s(n.groupLv))]):e._e()])]):e._e(),e._v(" "),e._l(n.lists,(function(o){return t("PromptList",{key:o.data.id,class:["promptList-type-".concat(o.data.id)],attrs:{list:o},on:{update:function(t){return e.doExportPrompt()}}},[t("div",{staticClass:"name-bar"},[t("div",{staticClass:"name",class:["type-".concat(o.data.id)],attrs:{title:o.data.name}},[t("span",{staticClass:"content"},[e._v(e._s(o.data.name||o.data.id))])])]),e._v(" "),t("div",{staticClass:"list PromptList-list"},[e._l(o.items,(function(n){return t("PromptItem",{key:n.data.word.id,attrs:{item:n,list:o},on:{click:function(t){return e.onItemClick(n)},update:function(t){return e.onItemUpdate(n)},contextmenu:function(t){return e.doOpenItemMenu(t,o)}}})})),e._v(" "),t("div",{staticClass:"add-btn flex items-center justify-center",on:{click:function(t){return e.onPromptListClick(t,o,{group:n.id,lv:n.groupLv,subType:o.data.id})}}},[t("i",{staticClass:"iconfont icon-add-icon add-btn-icon"})])],2)])}))],2)})),0)]),e._v(" "),t("PromptMenu",{ref:"menu"})],1)}),[],!1,null,null,null),c=component.exports,d=n(3116),h=n(10).g,m={props:["initPrompts"],data:function(){Object(d.dndInit)();var e=new o.PromptEditorClass({initPrompts:this.initPrompts});return{LocalTrasnslateServer:o.LOCAL_TRANSLATE_SERVER,promptEditor:e,adDelay:!1}},inject:["top"],components:{PromptWork:c},provide:function(){var e=this;return setTimeout((function(){return e.adDelay=!0}),500),{PromptEditor:this}},watch:{"promptEditor.data.server":{immediate:!0,handler:function(e){globalThis.__OPS_SERVER=e}}},methods:{doAddWorkspace:function(){var e=this;this.promptEditor.addWorkspace(),setTimeout((function(){e.$refs["operate-tool"].scrollIntoView({behavior:"smooth"})}),100)},doCopyWorkspaceUrl:function(){var e=this.promptEditor.works.map((function(e){return e.exportPrompts()})),q=encodeURIComponent(JSON.stringify(e)),t="".concat(location.origin+location.pathname,"?prompts=").concat(q);h(t)},doDeletePromptWork:function(e){this.promptEditor.removeWorkspace(e)}},computed:{needShowAd:function(){var e;if(this.adDelay&&null!==(e=this.promptEditor.data.server)&&void 0!==e&&e.startsWith("https://indexfs.moonvy.com"))return!0}}},v=(n(4133),Object(l.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptEditor"},[t("div",{staticClass:"workspace"},e._l(e.promptEditor.works,(function(n){return t("PromptWork",{key:"work-".concat((new Date).getTime(),"-").concat(Math.floor(1e3*Math.random())),attrs:{"prompt-work":n},on:{delete:e.doDeletePromptWork}})})),1),e._v(" "),e._e()])}),[function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptList"},[e._v("\n      普通：\n      "),t("div",{staticClass:"list"},[t("div",{staticClass:"PromptItem"},[t("div",{staticClass:"displayName name"},[t("div",{staticClass:"lv"},[e._v("2")]),e._v("\n            Apple\n          ")])]),e._v(" "),t("div",{staticClass:"PromptItem"},[t("div",{staticClass:"displayName name"},[t("div",{staticClass:"lv"},[e._v("1.2")]),e._v("\n            List Name\n          ")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("模型版本 4")])]),e._v(" "),t("div",{staticClass:"PromptItem"},[t("div",{staticClass:"displayName name"},[e._v("--style 4a")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("样式 4a")])])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptList"},[e._v("\n      风格：\n      "),t("div",{staticClass:"list"},[t("div",{staticClass:"PromptItem subType-style"},[t("div",{staticClass:"displayName name"},[e._v("3D")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-style"},[t("div",{staticClass:"displayName name"},[e._v("Oil")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("油画风格")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-style"},[t("div",{staticClass:"displayName name"},[t("div",{staticClass:"lv"},[e._v("2.5")]),e._v("\n            Oil\n          ")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("油画风格")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-style"},[t("div",{staticClass:"displayName name"},[e._v("Bubble Mart")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("泡泡玛特模型")])])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptList"},[e._v("\n      质量：\n      "),t("div",{staticClass:"list"},[t("div",{staticClass:"PromptItem subType-quality"},[t("div",{staticClass:"displayName name"},[e._v("4K")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-quality"},[t("div",{staticClass:"displayName name"},[t("div",{staticClass:"lv"},[e._v("2")]),e._v("\n            high quality\n          ")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("高质量")])])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptList"},[e._v("\n      命令：\n      "),t("div",{staticClass:"list"},[t("div",{staticClass:"PromptItem subType-command"},[t("div",{staticClass:"displayName name"},[e._v("--only")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-command"},[t("div",{staticClass:"displayName name"},[e._v("--v 4")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("模型版本 4")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-command"},[t("div",{staticClass:"displayName name"},[e._v("--style 4a")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("样式 4a")])])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptList"},[e._v("\n      负面：\n      "),t("div",{staticClass:"list"},[t("div",{staticClass:"PromptItem subType-eg"},[t("div",{staticClass:"displayName name"},[e._v("bad")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-eg"},[t("div",{staticClass:"displayName name"},[e._v("bad finger")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("坏手指")])]),e._v(" "),t("div",{staticClass:"PromptItem subType-eg"},[t("div",{staticClass:"displayName name"},[e._v("low")]),e._v(" "),t("div",{staticClass:"descName name"},[e._v("低质量")])])])])}],!1,null,null,null));t.default=v.exports},3226:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);n(28);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var l={data:function(){var e=this;return{isShow:!1,type:"CREATE",loading:!1,channelForm:{name:"",about:"",type:1},rules:{name:[{required:!0,message:this.$t("PleaseEnterChannelName")},{validator:function(t,n,o){/^\s*$/.test(n)&&o(new Error(e.$t("PleaseEnterChannelName"))),o()}}]}}},computed:{title:function(){return this.$t("CREATE"===this.type?"AddChannelTitle":"EditChannelTitle")}},methods:{show:function(e,t){this.type=t?"EDIT":"CREATE",t&&(this.channelForm=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)),this.loading=!1,this.isShow=e},submit:function(){var e=this;this.$refs.channelForm.validate((function(t){t&&(e.loading=!0,e.$emit("submit",e.channelForm))}))},close:function(){this.channelForm={name:"",about:"",type:1},this.loading=!1,this.$refs.channelForm.resetFields(),this.show(!1)}}},c=l,d=n(0),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"custom-dialog created-popup",attrs:{visible:e.isShow,"append-to-body":!0,"before-close":e.close,title:e.title},on:{"update:visible":function(t){e.isShow=t}}},[t("div",{staticClass:"create-body"},[t("el-form",{ref:"channelForm",staticClass:"custom-form",attrs:{model:e.channelForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("ChannelName"),required:"",prop:"name"}},[t("el-input",{attrs:{placeholder:"",maxlength:15},model:{value:e.channelForm.name,callback:function(t){e.$set(e.channelForm,"name",t)},expression:"channelForm.name"}})],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-btn",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.close}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v(e._s(e.$t("Confirm")))])],1)])}),[],!1,null,null,null);t.default=component.exports},3227:function(e,t,n){"use strict";n.r(t);var o=n(3),r=n(14),l=n(2),c=(n(20),n(6),n(32),n(50),n(11),n(16),n(22),n(31),n(122),n(49),n(18),n(8),n(12),n(13),n(4),n(28),n(21),n(44),n(7),n(26),n(29)),d=n(57),h=n(3228),m=n(48),v=n(25),f=n(294),_=n(813),w=n(35),y=n.n(w),C=n(106),S=n(1),k=n(3111),x=n(85),I=n(9),O=n(210);n(46);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={name:"TaskView",components:{MsgItem:h.default,auditDialog:O.a},mixins:[_.pollMixin],inject:["top"],data:function(){return{list:[],debounceHandleScroll:"",loading:!1,showBackTopBtn:!1,last1:0,last2:0,timer:null,showScroll:!1,showNoDataContent:!1,keyword:"",listParams:{keyword:"",time_from:"",time_to:""},btnLoading:!1}},watch:{collectData:{handler:function(){var e=this;if(this.collectData&&this.collectData.id){var t=this.list.find((function(t){return t.pub_artwork_no&&t.pub_artwork_no===e.collectData.id})),n=t?t.id:"";!["",null,void 0].includes(n)&&this.handleUpdateData(n,{collect:this.collectData.collect||null})}},deep:!0,immediate:!0},"top.channelId":{handler:function(e){this.handleChannelChange(e)},deep:!0,immediate:!0}},created:function(){this.addEmitEvent()},mounted:function(){Object(m.q)()&&this.init(),this.initScrollBar(),this.debounceHandleScroll=Object(v.debounce)(this.handleScroll,600),this.$EventBus.$on("needScrollBottom",this.checkNeedScrollToBottom),this.addPageShowEvent(),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline)},beforeDestroy:function(){this.debounceHandleScroll=null,this.timer&&window.clearTimeout(this.timer),this.timer=null,this.$EventBus.$off("needScrollBottom"),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline),document.removeEventListener("visibilitychange",this.showPageEvent),this.closeWebsocket()},computed:L(L(L(L({},Object(S.e)("user",["collectData","userInfo"])),Object(S.c)("payment",["activeState"])),Object(S.c)("user",["isLoggedIn"])),{},{checkIsShowBackTopBtn:function(){return this.showBackTopBtn&&this.list.length},showMessage:function(){return function(e){var t;return![8,"8"].includes(null==e||null===(t=e.messageInfo)||void 0===t?void 0:t.type)}},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)}}),methods:L(L({},Object(S.b)("user",["getAccountInfo"])),{},{addEmitEvent:function(){var e=this;this.$EventBus.$on("TaskListHandle",(function(t){e.handleTaskOperate(t)}))},addPageShowEvent:function(){document.addEventListener("visibilitychange",this.showPageEvent)},showPageEvent:function(){"visible"===document.visibilityState&&this.handleOnline()},settingViewNsfw:function(){var e;this.btnLoading||(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw():this.$refs.auditDialog.showDialog())},applyNsfw:function(){var e=this;this.btnLoading=!0;var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(x.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),e.btnLoading=!1,e.getAccountInfo())})).finally((function(){e.btnLoading=!1}))},handleSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.listParams=Object.assign({},this.listParams,e),this.keyword=(null==e?void 0:e.keyword)||"",this.list=[],this.getHistoryMessage()},handleOnline:function(){try{var e;null===(e=this.webSocketService)||void 0===e||e.reconnectWebSocket(!0)}catch(e){}},handleOffline:function(){},init:function(){var e=this;this.showNoDataContent=!1,this.$store.dispatch("creation/getTaskOptionsInfo"),this.last1=0,this.last2=0,this.initWebSocketService(),"PRIVATE"===this.top.channelId?this.getHistoryMessage().finally((function(){e.showNoDataContent=!0})):this.getHistoryChatMessage().finally((function(){e.showNoDataContent=!0})),this.pollingMiddleware=new f.default(3e3,(function(){e.fetchTaskData()}))},handleTaskError:function(code){var e={7e4:this.$t("taskOperateFailed"),70001:this.$t("taskExceededDailyGenerationLimit"),70002:this.$t("taskQueueFull"),70003:this.$t("taskModelVersionNotSupportVariations"),70009:this.$t("taskModelForbidden"),70008:this.$t("taskArtWorkForbidden"),70024:this.$t("error_code_70024"),80008:this.$t("InsufficientBalance"),70010:this.$t("error_code_70010"),70011:this.$t("error_code_70011"),70013:this.$t("error_code_70013"),70014:this.$t("error_code_70014"),70015:this.$t("error_code_70015"),70016:this.$t("error_code_70016"),70019:this.$t("error_code_70019"),70023:this.$t("HttpErrorCode_70023")};code&&e[code]?this.$message.error(e[code]):this.$message.error(this.$t("ServerError"))},checkNeedScrollToBottom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=this.list.findIndex((function(t){return t.id===e.id})),n=this.$refs.scrollWrapper;-1===t||t!==this.list.length-1||this.showScroll||n.scrollHeight-n.scrollTop<n.clientHeight+e.banner.height&&this.scrollToTop()}catch(e){}},checkUpdateMessageNeedScrollToBottom:function(){try{var e=this.$refs.scrollWrapper;e.scrollHeight-e.scrollTop<=2*e.clientHeight&&this.scrollToTop()}catch(e){}},initScrollBar:function(){var e=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){e.$refs.scrollWrapper.removeEventListener("scroll",e.initScrollBarStatus)}))}catch(e){}},initScrollBarStatus:function(){this.showScroll=!0},getHistoryMessage:function(){var e,t,n,o=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.loading||!this.isLoggedIn)return Promise.resolve();var h={limit:50};if(["",null,void 0].includes(l)||(h.after_id=l),h.keyword=null==this||null===(e=this.listParams)||void 0===e?void 0:e.keyword,null!=this&&null!==(t=this.listParams)&&void 0!==t&&t.time_from&&null!=this&&null!==(n=this.listParams)&&void 0!==n&&n.time_to){var m;h.time_from=null==this||null===(m=this.listParams)||void 0===m?void 0:m.time_from;try{var v;h.time_to=new Date(null==this||null===(v=this.listParams)||void 0===v?void 0:v.time_to).setHours(23,59,59,999)}catch(e){}}return this.loading=!0,Object(c.getTaskList)(h).then((function(e){if("PRIVATE"!==o.top.channelId)return e;var t=e.data,data=void 0===t?{}:t;if(h.after_id){var n,l,c=Object(d.objectArrayDeduplicationMerge)(o.list,(null==data?void 0:data.items)||[]);c=o.sortByField(c,"create_at",!0);var m=null===(n=o.$refs)||void 0===n||null===(n=n.scrollWrapper)||void 0===n?void 0:n.scrollHeight;c=c.map((function(e){return e.img_uris=((null==e?void 0:e.img_uris)||[]).filter((function(e){return null==e?void 0:e.url})),e})),(l=o.list).unshift.apply(l,Object(r.a)(c)),m&&c.length&&o.scrollToTop(m,"instant")}else o.list=((null==data?void 0:data.items)||[]).reverse().map((function(e){return e.img_uris=(e.img_uris||[]).filter((function(e){return null==e?void 0:e.url})),e})),o.scrollToTop(0,"instant")})).finally((function(){o.loading=!1}))},sortByField:function(e,t){var n=function(a,b){var e=a[t],n=b[t];return e<n?-1:e>n?1:0};return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?e.sort(n):e.sort((function(a,b){return n(b,a)}))},handleScroll:function(){try{var e=this.$refs.scrollWrapper;try{if(0===e.scrollTop&&0===e.scrollHeight)return;this.showBackTopBtn=e.scrollHeight-e.scrollTop>e.clientHeight+50,window.clearTimeout(this.timer),this.timer=setTimeout(this.isScrollEnd,1500),this.last1=null==e?void 0:e.scrollTop}catch(e){}e&&e.scrollTop<=10&&this.handleLoadMore()}catch(e){}},isScrollEnd:function(){try{var e=this.$refs.scrollWrapper;this.last2=null==e?void 0:e.scrollTop,this.last2===this.last1&&(this.showScroll=!1),0===this.last2&&(this.showBackTopBtn=!1)}catch(e){}},handleLoadMore:function(){var e=this.list.length?this.list[0]:"",t=e?e.id:"",n=e?e.timestamp:"";this.top.channelId&&"PRIVATE"===this.top.channelId?this.getHistoryMessage(t):this.getHistoryChatMessage(n)},scrollToTop:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";this.$nextTick((function(){try{var o=e.$refs.scrollWrapper;if(o){var r=t?Math.abs(o.scrollHeight-t)+100:o.scrollHeight;o.scrollTo({top:r,behavior:n})}}catch(e){}}))},handleUpdateData:function(e,data){this.list.forEach((function(t){e===t.id&&Object.assign(t,data)}))},handleUpscale:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=y()(source),n={id:(t||{}).info.id};Object(c.getMetaInfo)(n).then((function(n){var o=n||{},r=o.status.code,code=void 0===r?"":r,l=o.data,data=void 0===l?{}:l;return[1e4,"10000"].includes(code)&&(t.info.meta=data.meta,t.info.pub_artwork_no=(null==data?void 0:data.art_work_no)||"",t.info.art_model_no=(null==data?void 0:data.art_model_no)||"",t.info.art_model_ver_no=(null==data?void 0:data.art_model_ver_no)||"",t.info.meta.prompt=t.info.local_prompt||t.info.meta.prompt,e.handleOtherOperate(t)),[1e4,"10000"].includes(code)||e.handleTaskError(code),n}))},handleTaskOperate:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.info,o=void 0===n?{}:n,r=t.type,l=void 0===r?"":r,c=t.callback;switch(l){case"taskReStart":this.handleReStartTask(o);break;case"cancelTask":this.handleCancelTask(o,c);break;case"reStart":this.handleTaskRestart(o);break;case"extraUpscale":this.handleExtraUpscale(t);break;case"U":this.handleUpscale(t);break;case"V":case"A":this.handleOtherOperate(t);break;case"advanced":this.handleAdvancedOperate(t);break;case"promptSearch":null==this||null===(e=this.top)||void 0===e||e.setTextToImagePrompt(t.prompt);break;case"deleteTask":this.handleDeleteTask(o.id);break;case"removeBackground":this.handleRemoveBackground(t)}},handleExtraUpscale:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=y()(source),n=t.info,o=void 0===n?{}:n,r=t.data,data=void 0===r?{}:r;try{o.meta.prompt=o.local_prompt||o.meta.prompt}catch(e){}var l=["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res","inpaint_full_res_padding","hi_res_arg","ad_units"];Object.keys(o.meta).forEach((function(e){l.includes(e)&&delete o.meta[e]}));var d=this.groupTaskOperateParams({operate_number:data.number,action:2,info:o});d.category=o.category||1,d.channel_id="PRIVATE"===this.top.channelId?"":this.top.channelId,d.meta.hi_res_arg={image:data.imageUrl,upscaler_1:"4x-UltraSharp",upscaling_resize:2},d.operate_number=data.number||1,Object(c.createTask)(d).then((function(t){var n=t||{},o=n.data,data=void 0===o?{}:o,r=n.status,l=(void 0===r?{}:r).code;if([1e4,"10000"].includes(void 0===l?"":l)){var c=L({},data);c.sender_id=e.userInfo.id,c.messageInfo={},c.messageInfo.author={id:c.sender_id,name:e.userInfo.name},e.list.push(c),e.checkNeedClearSearch(),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}else;})).finally((function(){}))},handleCreateRestartTask:function(e){var t=this,n={id:e.id};Object(c.getMetaInfo)(n).then((function(n){var o=n||{},r=o.status.code,code=void 0===r?"":r,l=o.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var d,h={channel_id:"",art_model_no:(null==data?void 0:data.art_model_no)||"",art_model_ver_no:(null==data?void 0:data.art_model_ver_no)||"",speed_type:(null===(d=t.top)||void 0===d||null===(d=d.config)||void 0===d||null===(d=d.extraUpscale)||void 0===d?void 0:d.speed_type)||(t.activeState?2:1),meta:(null==data?void 0:data.meta)||{},action:2};if(h.channel_id="PRIVATE"===t.top.channelId?"":t.top.channelId,h.meta.prompt=h.meta.local_prompt||h.meta.prompt,[7,11].includes(e.category))return void t.handleStudioUpscaleTask(h,e,null);Object(c.createTask)(h).then((function(e){var n=e||{},o=n.data,data=void 0===o?{}:o,r=n.status,l=(void 0===r?{}:r).code;if([1e4,"10000"].includes(void 0===l?"":l)){var c=L({},data);c.sender_id=t.userInfo.id,c.messageInfo={},c.messageInfo.author={id:c.sender_id,name:t.userInfo.name},t.list.push(c),t.checkNeedClearSearch(),t.$message.success(t.$t("CreateSuccess")),t.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}else;})).finally((function(){}))}return[1e4,"10000"].includes(code)||t.handleTaskError(code),n}))},handleTaskRestart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(console.log("处理任务重新生成--",e),[2].includes(null==e?void 0:e.type))this.handleCreateRestartTask(e);else if([5,"5"].includes(e.type))this.$EventBus.$emit("taskUserUpscale",{action:9,url:e.banner.url});else{var t,n=e.type||1;if([13,"13"].includes(n))return n=6,void this.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:null==e||null===(t=e.banner)||void 0===t?void 0:t.url,art_work_no:e.pub_artwork_no,meta:y()(e.meta),local_prompt:(null==e?void 0:e.local_prompt)||""}});if([8,"8"].includes(n)&&(n=10),[7,"7"].includes(n)&&(n=9),[11].includes(n)&&(n=13),e&&([7,"7","studio",11].includes(e.category)||24===e.type)){var o,r=(null==e?void 0:e.pub_artwork_no)||"";return Array.isArray(null==e?void 0:e.pub_artwork_nos)&&null!=e&&null!==(o=e.pub_artwork_nos)&&void 0!==o&&o.length&&(r=null==e?void 0:e.pub_artwork_nos[0]),void this.$emit("reload",{action:n,data:{parent_task_id:e.id,id:r,local_prompt:(null==e?void 0:e.local_prompt)||""}})}this.$emit("reload",{action:n,data:{parent_task_id:e.id,id:e.pub_artwork_no,local_prompt:(null==e?void 0:e.local_prompt)||"",meta:y()(e.meta),category:e.category}})}},handleRemoveBackground:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=source.info,n=void 0===t?{}:t,o=source.imageUrl,r=void 0===o?"":o,l={action:7,art_work_no:n.pub_artwork_no,parent_task_id:n.id,category:n.category||1};l.meta=y()(n.meta);try{l.meta.prompt=n.local_prompt||n.meta.prompt}catch(e){}return l.meta.hi_res_arg&&delete l.meta.hi_res_arg,l.meta.remove_background={uri:r},l.channel_id="PRIVATE"===this.top.channelId?"":this.top.channelId,l.category=n.category||1,Object(c.createTask)(l).then((function(t){var n=t||{},o=n.data,data=void 0===o?{}:o,r=n.status.code;if([1e4,"10000"].includes(void 0===r?"":r)){e.list.push(data),e.$message.success(e.$t("CreateSuccess")),e.checkNeedClearSearch(),e.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}}))},handleDeleteTask:function(e){var t=this.list.findIndex((function(t){return t.id===e}));-1!==t&&this.list.splice(t,1)},handleCopyTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=11===e.type?13:24==e.type?24:1;if(e&&[7,"7","studio"].includes(null==e?void 0:e.category)){var n,o=(null==e?void 0:e.pub_artwork_no)||"";return Array.isArray(null==e?void 0:e.pub_artwork_nos)&&null!=e&&null!==(n=e.pub_artwork_nos)&&void 0!==n&&n.length&&(o=null==e?void 0:e.pub_artwork_nos[0]),void this.$emit("reload",{action:t,data:{parent_task_id:e.id,id:o}})}this.$emit("reload",{action:t,data:{parent_task_id:e.id,id:e.pub_artwork_no}})},handleAdvancedOperate:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=source.info,t=void 0===e?{}:e,n=source.btnInfo,o=void 0===n?{}:n;o&&"Make Variations"===o.btnType?this.handleOtherOperate(source):o&&"Web"===o.btnType&&(this.$router.push("/explore/detail/"+t.pub_artwork_no),this.$emit("closePopup"))},handleOtherOperate:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,source,l,d,h,m,v,f,_,w,S,k,x,I,O,T,$,M,code,P,data,j,D,N,R,E;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(source=e.length>0&&void 0!==e[0]?e[0]:{},console.log("处理超分操作,变体操作",source),l=y()(source),d=l.info,h=void 0===d?{}:d,m=l.btnInfo,v=void 0===m?{}:m,f=l.callback,h.meta.prompt=h.local_prompt||h.meta.prompt,_=-1!==v.btnType.indexOf("U")?2:-1!==v.btnType.indexOf("A")?24:3,w=["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res","inpaint_full_res_padding"],2===_&&w.push("hi_res_arg"),Object.keys(h.meta).forEach((function(e){w.includes(e)&&delete h.meta[e]})),null!=h&&null!==(o=h.meta)&&void 0!==o&&null!==(o=o.ad_units)&&void 0!==o&&o.length||delete h.meta.ad_units,2===_)try{h.meta.enable_hr=!1,delete h.meta.ad_units,delete h.meta.hr_upscaler,delete h.meta.hr_scale}catch(e){}if(S={action:_,parent_task_id:h.id,operate_number:v.id,meta:h.meta,art_work_no:h.pub_artwork_no,task_id:h.id,number:v.id},(k=t.groupTaskOperateParams({operate_number:v.id,action:_,info:h})).category=h.category||1,3!==_||![7,11].includes(h.category)){n.next=29;break}return O=y()(k),console.log("来啦flux！"),n.next=18,Object(c.getMetaInfo)({id:h.id});case 18:if(T=n.sent,M=($=T||{}).status.code,code=void 0===M?"":M,P=$.data,data=void 0===P?{}:P,![1e4,"10000"].includes(code)||!(null!=data&&null!==(x=data.base_model_name)&&void 0!==x&&x.includes("Flux")||null!=data&&null!==(I=data.base_model_name)&&void 0!==I&&I.includes("SD 3.5"))){n.next=29;break}return O.meta=null==data?void 0:data.meta,O.pub_artwork_no=(null==data?void 0:data.art_work_no)||"",O.art_model_no=(null==data?void 0:data.art_model_no)||"",O.art_model_ver_no=(null==data?void 0:data.art_model_ver_no)||"",O.meta.prompt=O.local_prompt||O.meta.prompt,O.meta.init_images=null===(j=k.meta)||void 0===j?void 0:j.init_images,t.handleStudioVariationsTask(O,h,f),n.abrupt("return");case 29:if([1,"1"].includes(null==h?void 0:h.sub_mode_category)&&[7,11,"studio"].includes(h.category)||3!==S.action&&24!==S.action||[3,"3"].includes(h.category)){n.next=36;break}return D={action:S.action,parent_task_id:h.id,operate_number:v.id,art_work_no:h.pub_artwork_no,meta:h.meta},24===(null==S?void 0:S.action)&&(N=h.img_uris,E=(R=void 0===N?[]:N).length?R[v.id-1].url:"",D.meta.init_images=[E]),console.log({data:D,action:S.action},"动画生成的快捷操作"),t.$emit("reload",{data:D,action:S.action}),n.abrupt("return");case 36:if(k.category=h.category||1,k.speed_type=(null===(r=t.top)||void 0===r||null===(r=r.config)||void 0===r||null===(r=r.extraUpscale)||void 0===r?void 0:r.speed_type)||(t.activeState?2:1),t.handleUpdateBtnStatus(S.task_id,v.btnType),k.channel_id="PRIVATE"===t.top.channelId?"":t.top.channelId,k.meta.prompt=k.meta.local_prompt||k.meta.prompt,2!==_||![7,11].includes(k.category)){n.next=44;break}return t.handleStudioUpscaleTask(k,h,f),n.abrupt("return");case 44:if(3!==_||![7,11].includes(k.category)){n.next=47;break}return t.handleStudioVariationsTask(k,h,f),n.abrupt("return");case 47:Object(c.createTask)(k).then((function(e){var n=e||{},o=n.data,data=void 0===o?{}:o,r=n.status,l=(void 0===r?{}:r).code;if([1e4,"10000"].includes(void 0===l?"":l)){f&&f(data);var c=L({},data);c.sender_id=t.userInfo.id,c.messageInfo={},c.messageInfo.author={id:c.sender_id,name:t.userInfo.name},t.list.push(c),t.checkNeedClearSearch(),t.updateBtnClickStatus(S),t.$message.success(t.$t("CreateSuccess")),t.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}else;})).finally((function(){t.handleUpdateBtnStatus(S.task_id,"")}));case 48:case"end":return n.stop()}}),n)})))()},handleStudioUpscaleTask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n={};["art_model_no","art_model_ver_no","channel_id","parent_task_id","meta","speed_type","source"].forEach((function(e){n[e]=source[e]})),Object(c.studioUpscaleTask)(n).then((function(o){var r=o||{},l=r.data,data=void 0===l?{}:l,c=r.status,d=(void 0===c?{}:c).code;if([1e4,"10000"].includes(void 0===d?"":d)){t&&t(data);var h=L({},data);h.sender_id=e.userInfo.id,h.messageInfo={},h.messageInfo.author={id:h.sender_id,name:e.userInfo.name},h.art_model_no=n.art_model_no||"",h.status=1,h.type=2,h.category=11,h.banner=null,h.img_uris=[],e.list.push(h),e.checkNeedClearSearch(),e.updateBtnClickStatus(n),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}else;})).catch((function(e){}))},handleStudioVariationsTask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n={};["art_model_no","art_model_ver_no","channel_id","parent_task_id","meta","speed_type","source"].forEach((function(e){n[e]=source[e]})),Object(c.studioVariationTask)(n).then((function(o){var r=o||{},l=r.data,data=void 0===l?{}:l,c=r.status,d=(void 0===c?{}:c).code;if([1e4,"10000"].includes(void 0===d?"":d)){t&&t(data);var h=L({},data);h.sender_id=e.userInfo.id,h.messageInfo={},h.messageInfo.author={id:h.sender_id,name:e.userInfo.name},h.art_model_no=n.art_model_no||"",h.status=1,h.type=3,h.category=11,h.banner=null,h.img_uris=[],e.list.push(h),e.checkNeedClearSearch(),e.updateBtnClickStatus(n),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(C.g)()}catch(e){}}else;})).catch((function(e){}))},groupTaskOperateParams:function(){var e,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=source.operate_number,n=void 0===t?1:t,o=source.action,r=void 0===o?1:o,l=source.info,c=void 0===l?{}:l,d={};d.action=r,d.operate_number=n,d.art_work_no=c.pub_artwork_no,d.art_model_no=(null==c?void 0:c.art_model_no)||"",d.art_model_ver_no=(null==c?void 0:c.art_model_ver_no)||"",d.parent_task_id=c.id,d.meta=c.meta;var h=c.img_uris,m=void 0===h?[]:h,v=(null==c||null===(e=c.banner)||void 0===e?void 0:e.url)||"",f=m.length?m[n-1].url:"";if(3===r){var _=d.meta.controlnet_units&&d.meta.controlnet_units.length?y()(d.meta.controlnet_units[0]):{},w={input_image:f||"",model:"canny",module:"control_sd15_canny [fef5e48e]"};_&&(_.model||_.module)?(w=Object.assign({},_,w),d.meta.controlnet_units=[w],d.meta.init_images=[],d.meta.script_args=[],d.meta.script_name="",d.meta.denoising_strength=0):(d.meta.init_images=[f],d.meta.controlnet_units=[])}return 2===r&&(d.meta.init_images=m.length?[f]:[v],d.meta.controlnet_units=[]),d},handleReStartTask:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,n={action:4,task_id:void 0===t?"":t};this.handleUpdateBtnStatus(n.task_id,"reStart"),Object(c.operateTask)(n).then((function(t){var n=(t||{}).status,o=(void 0===n?{}:n).code,code=void 0===o?"":o;if([1e4,"10000"].includes(code)){var r=(t.data||{}).new_task,l=void 0===r?null:r;return-1!==e.list.findIndex((function(e){return e.id===l.id}))?e.list.forEach((function(e){l&&e.id===l.id&&Object.assign(e,l)})):e.list.unshift(l),void e.checkNeedClearSearch()}[1e4,"10000"].includes(code)||e.handleTaskError(code)})).finally((function(){e.handleUpdateBtnStatus(n.task_id,"")}))},handleCancelTask:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;console.log("取消任务");var o=t.id,r=void 0===o?"":o,l={action:5,task_id:r};this.handleUpdateCancelBtnStatus(r,!0),Object(c.operateTask)(l).then((function(t){e.$message.warning(e.$t("cancelJobSuccess"));var o=(t||{}).status,l=(void 0===o?{}:o).code,code=void 0===l?"":l;if(n&&n(),[1e4,"10000"].includes(code)){var c=e.list.findIndex((function(e){return e.id===r}));-1!==c&&e.list.splice(c,1)}else[1e4,"10000"].includes(code)||e.handleTaskError(code)})).finally((function(){e.handleUpdateCancelBtnStatus(r,!1)}))},handleUpdateBtnStatus:function(e,t){var n=this;this.list.forEach((function(o){o.id===e&&n.$set(o,"loadingBtn",t)}))},handleUpdateCancelBtnStatus:function(e,t){var n=this;this.list.forEach((function(o){o.id===e&&n.$set(o,"isLoading",t)}))},updateBtnClickStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,n=e.task_id,o=e.number;this.list.forEach((function(e){if(e.id===n){var r={action:t,number:o};-1===(e.operation||[]).findIndex((function(e){return e.action===t&&o===e.number}))&&(!Array.isArray(e.operation)||e.operation.push(r))}}))},updateMessageList:function(e){this.checkNeedClearSearch();var t=this.list.findIndex((function(t){return e.id===t.id})),n=L({},e);n.sender_id=this.userInfo.id,n.messageInfo={},n.messageInfo.author={id:n.sender_id,name:this.userInfo.name},-1===t&&this.list.push(n),this.checkUpdateMessageNeedScrollToBottom()},checkNeedClearSearch:function(){var e;"PRIVATE"!==this.top.channelId||["",null,void 0].includes(null==this||null===(e=this.listParams)||void 0===e?void 0:e.keyword)||(this.$EventBus.$emit("clearTaskSearch"),this.$emit("clearTaskSearch"))},initWebSocketService:function(){var e=this;if(Object(m.q)()){var t=Object(I.A)();this.webSocketService=new k.default(t,(function(){e.list.length&&e.getLastChatMessage()}),this.handleWebsocketMessage)}},handleWebsocketMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$EventBus.$emit("chatMessage",e),this.checkNeedDropMessage(),e&&[5,"5"].includes(e.type)?this.handleMessageError(e):e&&[8,"8"].includes(e.type)?this.handleDeleteTaskMessage(e):this.top.channelId==e.channel_id&&this.handleChannelMessage(e)},checkNeedDropMessage:function(){try{this.list.length>=2e3&&(this.list=this.list.slice(Math.ceil(this.list.length/2)))}catch(e){}},checkHasDeleteMessage:function(){var e=this;this.list.forEach((function(t){var n,o=null==t||null===(n=t.messageInfo)||void 0===n?void 0:n.type;t&&[8,"8"].includes(o)&&e.handleDeleteTaskMessage(t.messageInfo)}))},handleMessageError:function(){var e=this;[20002,20003,20004,"20002","20003","20004"].includes((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).error_code)?this.$store.dispatch("user/logout").then((function(){e.$router.replace({path:"/home",query:{openLoginDialog:"1"}})})):this.webSocketService.reconnectWebSocket(!0)},handleDeleteTaskMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.message_id,e.channel_id),n=void 0===t?"":t,o=(e.components,e.related_message_id),r=void 0===o?"":o;if(n===this.top.channelId){var l=this.list.findIndex((function(e){return e.message_id===r}));-1!==l&&this.list.splice(l,1)}},handleChannelMessage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("PRIVATE"!==this.top.channelId){var n=t.components,o=void 0===n?[]:n,r=t.message_id,l=t.sender_id,d=t.timestamp,h=o.filter((function(e){return[1,"1"].includes(e.type)})).map((function(e){return e.custom_id}));h.length&&Object(c.batchGetTaskInfo)({ids:h}).then((function(n){(n.data.items||[]).map((function(e){var n=L({},e);return n.message_id=r,n.timestamp=d,n.sender_id=l,n.messageInfo=t,n})).forEach((function(t){var n=e.list.find((function(e){return e.id===t.id||e.message_id===t.message_id}));n?Object.assign(n,t):e.list.push(t)}))})).finally((function(){}))}},closeWebsocket:function(){this.webSocketService.close(),this.webSocketService.destroy(),this.webSocketService=null},getHistoryChatMessage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.loading)return Promise.resolve();var n={page_size:50};return t&&(n.time_from=t),n.channel_id=this.top.channelId,this.loading=!0,Object(c.getHistoryChatMessage)(n).then((function(t){if(n.channel_id!==e.top.channelId)return t;var o=t&&t.data?t.data:{},l=o.items,c=void 0===l?[]:l;o.has_more;if(n.time_from){var h,m,v=Object(d.objectArrayDeduplicationMerge)(e.list,c||[],"message_id");v=(v=(v=e.sortByField(v,"timestamp",!0)).map((function(e){var t,n={};if(e&&null!=e&&null!==(t=e.components)&&void 0!==t&&t.length){var o=e.components.find((function(e){return 1===e.type}));n=o?L({},o.task_resource):{}}return n.message_id=e.message_id,n.timestamp=e.timestamp,n.sender_id=e.sender_id,n.messageInfo=e,n})).filter((function(e){return!["userCancelDesc"].includes(e.status_desc)}))).map((function(e){return e.img_uris=(e.img_uris||[]).filter((function(e){return null==e?void 0:e.url})),e}));var f=null===(h=e.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(m=e.list).unshift.apply(m,Object(r.a)(v)),f&&v.filter((function(e){return e.id})).length&&e.scrollToTop(f,"instant")}else e.list=(c||[]).map((function(e){var t,n={};if(e&&null!=e&&null!==(t=e.components)&&void 0!==t&&t.length){var o=e.components.find((function(e){return 1===e.type}));n=o?L({},o.task_resource):{}}return n.img_uris=(n.img_uris||[]).filter((function(e){return null==e?void 0:e.url})),n.message_id=e.message_id,n.timestamp=e.timestamp,n.sender_id=e.sender_id,n.messageInfo=e,n})).filter((function(e){return!["userCancelDesc"].includes(e.status_desc)})).reverse(),e.scrollToTop(0,"instant");e.checkHasDeleteMessage()})).finally((function(){e.loading=!1}))},handleChannelChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.list=[],this.listParams={keyword:"",time_from:"",time_to:""};try{this.webSocketService.reconnectWebSocket()}catch(e){}e&&"PRIVATE"===e?this.getHistoryMessage():this.getHistoryChatMessage()},getLastChatMessage:function(){var e=this;if("PRIVATE"!==this.top.channelId){var t={page_size:100},n=this.list.length?this.list[this.list.length-1]:"",o=n?n.timestamp:"";return o&&(t.time_from=o),t.channel_id=this.top.channelId,t.order_by="asc",this.loading=!0,Object(c.getHistoryChatMessage)(t).then((function(n){if(t.channel_id!==e.top.channelId)return n;var o=n&&n.data?n.data:{},l=o.items,c=void 0===l?[]:l,h=o.has_more,m=void 0!==h&&h;if(t.time_from){var v,f=Object(d.objectArrayDeduplicationMerge)(e.list,c||[],"message_id");(f=(f=e.sortByField(f,"timestamp",!0)).map((function(e){var t,n={};if(e&&null!=e&&null!==(t=e.components)&&void 0!==t&&t.length){var o=e.components.find((function(e){return 1===e.type}));n=o?L({},o.task_resource):{}}return n.message_id=e.message_id,n.timestamp=e.timestamp,n.sender_id=e.sender_id,n.messageInfo=e,n})).filter((function(e){return!["userCancelDesc"].includes(e.status_desc)}))).length&&(v=e.list).push.apply(v,Object(r.a)(f)),e.checkHasDeleteMessage(),m&&f.length&&e.getLastChatMessage()}})).finally((function(){e.loading=!1}))}}})},M=$,P=(n(4075),n(0)),component=Object(P.a)(M,(function(){var e,t=this,n=t._self._c;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-task-view"},[n("div",{ref:"scrollContainer",staticClass:"message-list"},[n("div",{staticClass:"messages-wrapper"},[n("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper",class:[t.showScroll?"":"show-scroll-bar"],on:{scroll:t.debounceHandleScroll}},[t._l(t.list,(function(e){return[e.id&&t.showMessage(e)?n("msg-item",{key:e.id||e.message_id,attrs:{message:e,"task-from":""},on:{operate:t.handleTaskOperate,copyGenerationData:t.handleCopyTask,updateData:t.handleUpdateData}}):t._e()]})),t._v(" "),null!==(e=t.listParams)&&void 0!==e&&e.keyword||!t.showNoDataContent||t.loading||t.list.length?t._e():[n("div",{staticClass:"no-data-content"},[n("div",{staticClass:"no-data-content-normal"},[t._v(t._s(t.$t("Hello")))]),t._v(" "),n("div",{staticClass:"no-data-content-normal"},[t._v(t._s(t.$t("GoMakeFirstPicture")))]),t._v(" "),n("div",{staticClass:"no-data-content-text"},[t._m(0),t._v(" "),n("span",[t._v(t._s(t.$t("ClickIt"))+" !")])])])]],2)])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.checkIsShowBackTopBtn,expression:"checkIsShowBackTopBtn"}],staticClass:"generate-view-back-top",class:[t.checkIsShowViewNsfw?"":"generate-view-back-top-only"],on:{click:function(e){return t.scrollToTop(0)}}},[n("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),t.checkIsShowViewNsfw?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.enableNsfwMode?t.$t("hideAdultContent"):t.$t("showAdultContent"),placement:"left"}},[n("div",{staticClass:"generate-view-nsfw-plus",on:{click:t.settingViewNsfw}},[n("i",{staticClass:"iconfont",class:t.enableNsfwMode?"icon-work-hide":"icon-work-show"})])]):t._e(),t._v(" "),n("auditDialog",{ref:"auditDialog",on:{confirm:t.applyNsfw}})],1)}),[function(){var e=this._self._c;return e("span",[e("i",{staticClass:"iconfont icon-hand-down-icon"})])}],!1,null,"5599773e",null);t.default=component.exports},3228:function(e,t,n){"use strict";n.r(t);n(16),n(394),n(47);var o=n(131),r=n.n(o),l=n(3),c=n(2),d=(n(20),n(11),n(19),n(6),n(22),n(18),n(12),n(13),n(8),n(4),n(43),n(7),n(21),n(77),n(3229)),h=n(592),m=n(362),v=n(1),f=n(10),_=n(35),w=n.n(_),y=n(45),C=n(39),S=n(27),k=n(29),x=n(593),I=n(102),O=n(165);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=n(275),M={name:"MsgItem",mixins:[y.a],inject:["top"],props:{message:{type:Object,default:function(){return{}},required:!0},taskFrom:{type:String,default:function(){return""}}},components:{MessageImg:d.default,MessageOperateBtn:h.default,MetaTooltipVue:m.default,SwipeList:x.default},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),l=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0"),d=t.getSeconds().toString().padStart(2,"0");return Object(f.F)(t,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},computed:L(L(L(L({},Object(v.c)(["isSupportWebp"])),Object(v.c)("user",["accountSettingsData","userInfo","isCompanyAccount"])),Object(v.e)("payment",["paymentInfo"])),{},{isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},isShowExpireTime:function(){var e=this.message.expiration_time;return!this.alreadySave&&e&&e>0},getExpireTime:function(){var e=this.message.expiration_time,t=(new Date).getTime();if(e&&e>t){var n=e-t,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},isStudioMode:function(){return[7,"7","studio",11,"11"].includes(this.message.category)},showTaskMode:function(){return[1,2,3,4,5,7,8,13].includes(this.message.type)},convertTaskMode:function(){var e={1:"createModeType1",2:"createModeType2",6:"createModeType6",4:"createModeType4",5:"createModeType5",7:"studio",11:"studio"};return e[this.message.category]?e[this.message.category]:""},moreActionsShow:function(){return[!["",null,void 0].includes(this.message.pub_artwork_no),!["",null,void 0].includes(this.message.pub_artwork_no)&&![4,"4"].includes(this.message.type),this.checkPermission||this.checkIsChannelOwner].some((function(e){return!!e}))},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?e:t},computedPercentage:function(){return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===e?0:e}},convertStatusText:function(){var e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return this.message.status_desc?e[this.message.status_desc]:""},checkBtnStatus:function(){var e=this;return function(t){var n={disabled:!1,loading:!1};return e.currentClickBtn===t?(n.loading=!0,n.disabled=!1,n):(e.currentClickBtn&&e.currentClickBtn!==t&&(n.loading=!1,n.disabled=!0),n)}},checkBtnIsNSFW:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!1;try{var o,r,l=this.message.type||1;if([2,"2"].includes(l))n=!(null===(o=this.message)||void 0===o||null===(o=o.img_uris)||void 0===o||!o.length)&&[1,"1"].includes(null===(r=this.message)||void 0===r?void 0:r.img_uris[0].nsfw);if([1,"1",3,"3"].includes(l)){var c=!(!this.message.img_uris||!this.message.img_uris.length)&&this.message.img_uris[t-1];n=c&&[1,"1"].includes(c.nsfw)}}catch(e){}return n}},getImageUrl:function(){var e,t,n,o;return null!==(e=this.message)&&void 0!==e&&null!==(e=e.img_uris)&&void 0!==e&&e.length&&!["",null,void 0].includes(null===(t=this.message)||void 0===t||null===(t=t.img_uris[0])||void 0===t?void 0:t.url)?this.isSupportWebp&&![6,"6"].includes(this.message.type)?Object(f.K)(null===(n=this.message)||void 0===n?void 0:n.img_uris[0].url,"high"):null===(o=this.message)||void 0===o?void 0:o.img_uris[0].url:!![10,"10"].includes(this.message.type)||(!(![24,"24"].includes(this.message.type)||!this.message.img_uris.length)||(this.message.base_64_banner_url?this.message.base_64_banner_url:""))},getGridImageUrl:function(){return function(e){var t="";return e&&!["",null,void 0].includes(e.url)?t=e.url:t}},moreActionShow:function(){return[2,4,13].includes(this.message.type)},convertTaskType:function(){return O.c[this.message.type]||""},checkBtnClicked:function(){return function(e,t){var n=this.message.operation,o=void 0===n?[]:n;if(!o||!o.length)return!1;var r=(o||[]).filter((function(e){return[2,"2"].includes(e.action)})).map((function(e){return e.number})),l=(o||[]).filter((function(e){return[3,"3"].includes(e.action)})).map((function(e){return e.number})),c=(o||[]).filter((function(e){return[4,"4"].includes(e.action)})).map((function(e){return e.number})),d=!1;switch(e){case"U":d=-1!==r.indexOf(t);break;case"V":d=-1!==l.indexOf(t);break;case"reStart":d=!!c.length}return d}},imagePromptList:function(){return this.isI18nToggled?Array.isArray(this.message.reverse_local_prompts)?this.message.reverse_local_prompts:[]:Array.isArray(this.message.reverse_prompts)?this.message.reverse_prompts:[]},getImageInfo:function(){return function(e){return Object.assign(w()(this.message),{banner:e})}},checkPermission:function(){var e=!1;this.message.type;return this.message.sender_id&&this.message.sender_id===this.userInfo.id?e=!0:(this.isPrivateChannel&&(e=!0),e)},checkIsChannelOwner:function(){var e;return this.message.sender_id&&(null==this||null===(e=this.top)||void 0===e||null===(e=e.channelInfo)||void 0===e?void 0:e.owner_id)===this.userInfo.id},isPrivateChannel:function(){return["PRIVATE"].includes(this.top.channelId)},getAuthorName:function(){var e,t="",n=null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e?void 0:e.author;return t=n?n.name||n.id:"",t=["",null,void 0].includes(t)?"":"@".concat(t)},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isShowCancel:function(){var e=this.message,t=e.status,n=e.category,o=e.type,r=![4,"4"].includes(t),l=![4,5,6,10,11,13,23,"23"].includes(o);return r&&![3,"3"].includes(n)&&this.checkPermission&&l},isShowFaster:function(){var e=this.message,t=e.status,n=e.speed_type;return 1==t&&1===n&&!this.hasAccelerated}}),watch:{accountSettingsData:{handler:function(e){this.isI18nToggled=!e.is_off_localization},deep:!0},message:{handler:function(e){var t=this;this.$nextTick((function(){t.isLoading=!!e.isLoading,t.currentClickBtn=e.loadingBtn||""}))},deep:!0,immediate:!0}},data:function(){return{defaultAvatar:$,customColor:"#2E9E60",isLoading:!1,isPosting:!1,currentClickBtn:"",isI18nToggled:!1,morePopoverVisible:!1,reportLoading:!1,mapObj:{0:!0,1:!0,2:!0,3:!0,4:!0},trailBtnLoading:!1,hasAccelerated:!1,alreadySave:!1,metaTooltipShow:!1,loraModeObj:{},checkpoiontNameObj:{}}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isI18nToggled=!e.accountSettingsData.is_off_localization;case 1:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.mapObj={}},methods:{expireClick:function(){var e=(this.paymentInfo||{}).vipType,t=["svip_1","svip_2","svip_1_trial","svip_2_trial","vip_lite"].includes(e)||e.includes("vip_day");this.isVip?t&&this.$EventBus.$emit("showUpgradeDialog","NoExpireTimeTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic")},handleUpdateModelName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(this.modelName)&&this.$set(this.message,"art_model_name",e)},setLoraModel:function(e){this.loraModeObj=Object.assign(this.loraModeObj,e)},deleteSingleImg:function(e){var t=this,n=this.message,o=n.id,r=void 0===o?"":o,l=n.img_uris,c=(void 0===l?[]:l)[e-1].index,d=void 0===c?"":c;Object(I.b)({id:r,index:d}).then((function(){t.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"delete"}),t.$message({message:t.$t("deleteSuccess"),type:"success"}),t.message.img_uris=t.message.img_uris.filter((function(e){return e.index!=d})),t.message.img_uris.length||t.$emit("operate",{type:"deleteTask",info:t.message})}))},handleNsfwStatus:function(e){var t=e.index,n=e.canViewNsfw;this.$set(this.mapObj,t,n)},autoResizeScrollBtn:function(){var e=this;this.$nextTick((function(){try{var t;null==e||null===(t=e.$refs)||void 0===t||t.swipeList.setMoveBtnShow()}catch(e){}}))},toUserPage:function(e){var t,n=null===(t=this.message)||void 0===t||null===(t=t.messageInfo)||void 0===t?void 0:t.author;e=n?n.id:"",["",null,void 0].includes(e)||this.$router.push("/user/"+e)},moreActions:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"report":this.reportArtwork();break;case"collect":this.message&&this.message.collect?this.unFavorite():this.handleCollect();break;case"shareLink":this.handleShareLink();break;case"delete":this.isPrivateChannel?this.handleDeleteTask():this.handleDeleteMessage()}},handleDeleteTask:function(){var e=this;this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var t={ids:[e.message.id]};e.globalLoading=!0,Object(k.deleteTaskRecord)(t).then((function(t){var n,o;["10000",1e4].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(e.$emit("operate",{type:"deleteTask",info:e.message}),e.$message({message:e.$t("deleteSuccess"),type:"success"})):e.$message({message:(null==t||null===(o=t.status)||void 0===o?void 0:o.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))})).catch((function(e){}))},handleDeleteMessage:function(){var e=this;this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var t={channel_id:e.top.channelId,message_ids:[e.message.message_id]};e.globalLoading=!0,Object(k.deleteMessage)(t).then((function(t){var n,o;["10000",1e4].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(e.$emit("operate",{type:"deleteTask",info:e.message}),e.$message({message:e.$t("deleteSuccess"),type:"success"})):e.$message({message:(null==t||null===(o=t.status)||void 0===o?void 0:o.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))})).catch((function(e){}))},handleCollect:function(){var e=this,t={id:this.message.pub_artwork_no};this.addFavorite(t,"artwork",null,(function(data){e.$emit("updateData",e.message.id,{collect:data})}))},unFavorite:function(){var e=this;if(!this.isCollecting){var t={id:this.message.pub_artwork_no,collect:{id:this.message.collect.id}};this.isCollecting=!0,Object(S.m)({id:t.collect.id}).then((function(n){var o={id:t.id,collect:null};e.$logEvent("log_actions",{operation:"cancel_collect_image",behavior_info:t.id}),e.$emit("updateData",e.message.id,{collect:null}),e.changeCollectData(o)})).finally((function(){e.isCollecting=!1}))}},handleShareLink:function(){var e=this.message,t=e.pub_artwork_no,n=void 0===t?"":t,o=e.pub_artwork_nos,r=void 0===o?[]:o,l=n;if(r&&r.length&&(l=r[0]),!["",null,void 0].includes(l)){var c="".concat(window.location.origin,"/")+"explore/detail/".concat(l);this.$message.success(this.$t("CopiedURLToClipboard")),Object(f.g)(c)}},reportArtwork:function(){var e=this,t=this.message.pub_artwork_no,n=void 0===t?"":t;this.reportLoading||["",null,void 0].includes(n)||(this.reportLoading=!0,Object(C.r)({id:n}).then((function(t){var code=t&&t.status?t.status.code:"";[1e4,"10000"].includes(code)&&r()({message:e.$t("ReportSuccess"),type:"success",duration:5e3})})).finally((function(){e.reportLoading=!1})))},handleReStart:function(){this.closeMetaPopover(),this.$emit("operate",{info:this.message,type:"reStart"})},handleImageOperate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"extraUpscale":this.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:n,art_work_no:this.message.pub_artwork_no,meta:Object.assign({},w()(this.message.meta),{channel:this.message.category})}});break;case"upscale":this.$emit("operate",{info:this.message,type:"U",btnInfo:{btnType:"U",id:t}});break;case"variations":this.$emit("operate",{info:this.message,type:"V",btnInfo:{btnType:"V",id:t}});break;case"removeBackground":this.$emit("operate",{info:this.message,type:"removeBackground",imageUrl:n});break;case"animGen":this.$emit("operate",{info:this.message,type:"A",btnInfo:{btnType:"A",id:t}})}},handlePromptSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$emit("operate",{info:this.message,type:"promptSearch",prompt:e})},handleTaskReStart:function(){this.$emit("operate",{info:this.message,type:"taskReStart"})},handleOperate:function(e,t){this.$emit("operate",{info:this.message,type:t,btnInfo:e})},handleCancelTask:function(){this.isLoading||this.$emit("operate",{info:this.message,type:"cancelTask"})},handleTrialFastQueue:function(){var e=this;this.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"click_try"});var t=this.message.id,n=void 0===t?"":t;this.trailBtnLoading=!0,Object(I.c)({id:n}).then((function(t){var n,code=null==t||null===(n=t.status)||void 0===n?void 0:n.code;70010===code?(e.$EventBus.$emit("showBreakDialog","FastQueueTipWeb","basic"),e.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"vip_pop_show"})):1e4===code&&(e.hasAccelerated=!0,e.$message.success(e.$t("AccelerateSuccess"))),e.trailBtnLoading=!1}))},handleCopyGenerationData:function(){var e={action:"task",obj_no:this.message.id,obj_type:1,view_domain:"",category:"default",batch_id:"",negative_ids:[]};Object(C.i)({items:[e]}),this.closeMetaPopover(),this.$emit("copyGenerationData",this.message)},closeMetaPopover:function(){try{this.$refs&&this.$refs.metaPopover&&this.$refs.metaPopover.doClose()}catch(e){}}}},P=M,j=(n(4072),n(4073),n(4074),n(0)),component=Object(j.a)(P,(function(){var e,t,n,o,r,l,c,d=this,h=d._self._c;return h("div",{staticClass:"c-msg-item"},[h("div",{staticClass:"chat-message-header"},[h("img",{staticClass:"chat-message__avatar",attrs:{src:d.defaultAvatar,alt:"Avatar"}}),d._v(" "),h("h3",{staticClass:"chat-message__title"},[h("span",{staticClass:"chat-message__title-user"},[d._v(d._s(d.$t("SeaArtBot")))]),d._v(" "),h("span",{directives:[{name:"show",rawName:"v-show",value:d.convertTaskType,expression:"convertTaskType"}],staticClass:"chat-message__title-task-tag"},[d._v(d._s(d.$t(d.convertTaskType)))]),d._v(" "),h("span",{directives:[{name:"show",rawName:"v-show",value:d.showTaskMode,expression:"showTaskMode"}],staticClass:"chat-message__title-task-tag-2"},[d._v(d._s(d.$t(d.convertTaskMode)))]),d._v(" "),d.message.create_at?h("span",{staticClass:"chat-message__title-time"},[d._v(d._s(d._f("formatDateTime")(d.message.create_at)))]):d._e(),d._v(" "),d.isMyMsg?h("el-popover",{attrs:{trigger:"click","popper-class":"custom-popver"}},[h("div",{staticClass:"task-info-tips"},[h("p",[h("span",[d._v(d._s(d.$t("TaskID")))]),h("span",[d._v(d._s(d.message.id))])]),d._v(" "),3!==d.message.status||d.isCompanyAccount?d._e():[[1,2,"1","2"].includes(null===(e=d.message)||void 0===e?void 0:e.pub_community)?h("p",[h("span",{staticClass:"task-info-tips-label"},[d._v(d._s(d.$t("status")))]),d._v(" "),h("span",{staticClass:"task-pub-status"},[d._v(d._s([2,"2"].includes(null===(t=d.message)||void 0===t?void 0:t.pub_community)?d.$t("createSetting1"):d.$t("createSetting2")))])]):d._e(),d._v(" "),h("p",[h("span",{staticClass:"task-info-tips-label"},[d._v(d._s(d.$t("expend")))]),d._v(" "),h("span",{staticClass:"task-info-tips-content"},[h("span",[d._v(d._s(d.$t("tempCoins"))+" : "+d._s(null===(n=d.message)||void 0===n||null===(n=n.deduction_detail)||void 0===n?void 0:n.temp_hashrate))]),d._v(" "),h("span",[d._v(d._s(d.$t("calculateCoins"))+" : "+d._s(null===(o=d.message)||void 0===o||null===(o=o.deduction_detail)||void 0===o?void 0:o.hashrate))])])]),d._v(" "),null!==(r=d.message)&&void 0!==r&&null!==(r=r.deduction_detail)&&void 0!==r&&r.history_hashrate?h("p",[h("span",{staticClass:"task-info-tips-label"},[d._v(d._s(d.$t("currentBalance")))]),d._v(" "),h("span",{staticClass:"task-info-tips-content"},[h("span",[d._v(d._s(d.$t("tempCoins"))+" : "+d._s(null===(l=d.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.after_temp_hashrate))]),d._v(" "),h("span",[d._v(d._s(d.$t("calculateCoins"))+" : "+d._s(null===(c=d.message)||void 0===c||null===(c=c.deduction_detail)||void 0===c?void 0:c.after_hashrate))])])]):d._e()]],2),d._v(" "),h("i",{staticClass:"iconfont icon-task_tips task-info-icon",attrs:{slot:"reference"},slot:"reference"})]):d._e()],1)]),d._v(" "),[3,"3",4,"4"].includes(d.message.status)?h("div",{staticClass:"msg-item-more-panel",class:[d.morePopoverVisible?"msg-item-more-panel-show":""]},[d.moreActionsShow?h("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"msg-item-more-popover","visible-arrow":!1,width:"100",trigger:"click"},model:{value:d.morePopoverVisible,callback:function(e){d.morePopoverVisible=e},expression:"morePopoverVisible"}},[h("div",{staticClass:"pop-btns flex"},[["",null,void 0].includes(d.message.pub_artwork_no)||!d.moreActionShow||d.isStudioMode?d._e():h("button",{on:{click:function(e){return d.moreActions("report")}}},[h("span",{staticClass:"pop-btns-text"},[d._v(d._s(d.$t("Report")))]),d._v(" "),h("span",{staticClass:"pop-btns-icon"},[h("i",{staticClass:"iconfont icon-task-report-icon"})])]),d._v(" "),["",null,void 0].includes(d.message.pub_artwork_no)||!d.moreActionShow||d.isStudioMode?d._e():h("button",{on:{click:function(e){return d.moreActions("collect")}}},[h("span",{staticClass:"pop-btns-text"},[d._v(d._s(d.message.collect&&d.message.collect.id?"".concat(d.$t("cancelFavorite")):d.$t("Collect")))]),d._v(" "),h("span",{staticClass:"pop-btns-icon"},[h("i",{staticClass:"iconfont icon-collect"})])]),d._v(" "),(!["",null,void 0].includes(d.message.pub_artwork_no)&&d.moreActionShow||d.isStudioMode)&&![4,"4"].includes(d.message.type)?h("button",{directives:[{name:"show",rawName:"v-show",value:!d.isCompanyAccount,expression:"!isCompanyAccount"}],on:{click:function(e){return d.moreActions("shareLink")}}},[h("span",{staticClass:"pop-btns-text"},[d._v(d._s(d.$t("ShareLink")))]),d._v(" "),h("span",{staticClass:"pop-btns-icon"},[h("i",{staticClass:"iconfont icon-share-icon"})])]):d._e(),d._v(" "),d.checkPermission||d.checkIsChannelOwner?h("button",{on:{click:function(e){return d.moreActions("delete")}}},[h("span",{staticClass:"pop-btns-text"},[d._v(d._s(d.$t("Delete")))]),d._v(" "),h("span",{staticClass:"pop-btns-icon"},[h("i",{staticClass:"iconfont icon-shanchu"})])]):d._e()]),d._v(" "),h("div",{staticClass:"msg-item-more-icon",attrs:{slot:"reference"},slot:"reference"},[h("i",{staticClass:"iconfont icon-more msg-item-more-icon-20"})])]):d._e(),d._v(" "),[4,"4",10,"10",23,"23",25,"25"].includes(d.message.type)||[4,"4"].includes(d.message.status)?d._e():h("div",{staticClass:"msg-item-more-icon",style:{marginRight:[6,"6"].includes(d.message.type)?"":"6px"},on:{click:function(e){e.stopPropagation(),d.isI18nToggled=!d.isI18nToggled}}},[h("i",{staticClass:"iconfont icon-i18n_prompt msg-item-more-icon-24"})]),d._v(" "),[4,"4",6,"6",10,"10",23,"23",25,"25"].includes(d.message.type)||[4,"4"].includes(d.message.status)?d._e():h("el-popover",{ref:"metaPopover",staticStyle:{padding:"0"},attrs:{"popper-class":"metaPoper",placement:"right","visible-arrow":!1,trigger:"click"},model:{value:d.metaTooltipShow,callback:function(e){d.metaTooltipShow=e},expression:"metaTooltipShow"}},[d.metaTooltipShow?h("MetaTooltipVue",{attrs:{meta:d.message.meta,msgId:d.message.id,loraModels:d.loraModeObj,model:d.message.art_model_no,category:d.message.category,"model-name":d.message.art_model_name},on:{updateModelName:d.handleUpdateModelName,copyGenerationData:d.handleCopyGenerationData,close:d.closeMetaPopover,setLoraModel:d.setLoraModel}}):d._e(),d._v(" "),h("div",{staticClass:"msg-item-more-icon",attrs:{slot:"reference"},slot:"reference"},[h("span",{staticClass:"el-icon-warning-outline svg-icon msg-item-more-icon-20"})])],1),d._v(" "),[4,"4","5",5,6,"6",10,"10",23,"23",25,"25"].includes(d.message.type)||[4,"4"].includes(d.message.status)?d._e():h("div",{staticClass:"msg-item-more-icon",on:{click:function(e){return e.stopPropagation(),d.handleReStart.apply(null,arguments)}}},[h("i",{staticClass:"iconfont icon-refresh-icon2 msg-item-more-icon-18"})])],1):d._e(),d._v(" "),h("div",{staticClass:"message-text-content"},[h("div",{staticClass:"message-text-content-text"},[d._v("\n      "+d._s(d.setI18nPrompt)),d.isPrivateChannel||["",null,void 0].includes(d.getAuthorName)?d._e():h("span",{staticClass:"message-author-text",on:{click:function(e){return e.stopPropagation(),d.toUserPage.apply(null,arguments)}}},[d._v(d._s(d.getAuthorName))])])]),d._v(" "),[6,"6"].includes(d.message.type)?[h("div",{staticClass:"message-text-list"},d._l(d.imagePromptList,(function(e,t){return h("div",{key:t,staticClass:"message-text-list-item"},[h("span",{staticClass:"message-text-list-item-order"},[d._v(d._s(t+1))]),d._v(" "),h("span",{staticClass:"message-text-list-item-text"},[d._v(d._s(e))])])})),0),d._v(" "),h("div",{staticClass:"operating-options-text"},d._l(d.imagePromptList,(function(e,t){return h("message-operate-btn",{key:"".concat(t,"_prompt_text"),on:{click:function(t){return d.handlePromptSearch(e)}}},[d._v("\n        "+d._s(t+1)+"\n      ")])})),1)]:d._e(),d._v(" "),[2,"2",3,"3"].includes(d.message.status)&&(d.getImageUrl||d.isStudioMode&&d.message.img_uris.length)?h("div",{staticClass:"message-accessories",on:{mouseenter:d.autoResizeScrollBtn}},[h("swipe-list",{ref:"swipeList",attrs:{"move-leng":200}},[h("div",{staticClass:"media-attachments-container"},[d.message&&[10,"10"].includes(d.message.type)?d._l(d.message.preprocess_images,(function(e,t){return h("message-img",{key:t,attrs:{src:d.getGridImageUrl(e),msgId:d.message.id,loraModels:d.loraModeObj,nsfw:e.nsfw,message:d.getImageInfo(e),"operate-number":t+1,"view-status":d.mapObj},on:{setLoraModel:d.setLoraModel,imageOperate:d.handleImageOperate,viewNsfwStatus:d.handleNsfwStatus}})})):d.message&&Array.isArray(d.message.img_uris)&&d.message.img_uris.length?d._l(d.message.img_uris,(function(e,t){return h("message-img",{key:t,attrs:{src:d.getGridImageUrl(e),msgId:d.message.id,loraModels:d.loraModeObj,nsfw:e.nsfw,width:e.width,height:e.height,message:d.getImageInfo(e),"operate-number":t+1,"view-status":d.mapObj},on:{setLoraModel:d.setLoraModel,imageOperate:d.handleImageOperate,viewNsfwStatus:d.handleNsfwStatus,deleteSingleImg:d.deleteSingleImg,saveSuccess:function(e){d.alreadySave=!0}}})})):h("message-img",{attrs:{src:d.getImageUrl,nsfw:d.message.nsfw,message:d.message,msgId:d.message.id,loraModels:d.loraModeObj,"view-status":d.mapObj},on:{setLoraModel:d.setLoraModel,imageOperate:d.handleImageOperate,viewNsfwStatus:d.handleNsfwStatus}})],2)])],1):d._e(),d._v(" "),[1,"1",2,"2",4,"4"].includes(d.message.status)?h("div",{staticClass:"message-process-container"},[[2,"2"].includes(d.message.status)&&d.computedPercentage(d.message)?h("div",{staticClass:"message-process-panel"},[h("el-progress",{attrs:{percentage:d.computedPercentage(d.message),color:d.customColor,"show-text":!1,"stroke-width":7}})],1):d._e(),d._v(" "),h("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(d.message.status)?[h("span",{staticClass:"process-operate-box-text"},[d._v(d._s(d.$t("TaskStatusWaitingToStart"))+" "),h("span",{staticClass:"message-process-loading-span"})])]:[2,"2"].includes(d.message.status)&&!d.computedPercentage(d.message)?[h("span",{staticClass:"process-operate-box-text"},[d._v(d._s(d.$t("TaskStatusPreparing"))+" "),h("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(d.message.status)?h("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[d._v(d._s(d.convertStatusText))]):h("span",{staticClass:"process-operate-box-text"},[d._v(d._s(d.$t("youHaveCompleted"))),h("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[d._v(d._s(d.computedPercentage(d.message))+"%")]),d._v(" "),h("span",{staticClass:"message-process-loading-span"})]),d._v(" "),d.isShowFaster?h("el-button",{staticClass:"message-process-operate-box-btn fast-queue",attrs:{size:"mini",loading:d.trailBtnLoading},on:{click:d.handleTrialFastQueue}},[h("i",{staticClass:"iconfont icon-trail-fast-queue"}),d._v(" "),h("span",{staticClass:"words"},[d._v(d._s(d.$t("TrialFastQueue")))])]):d._e(),d._v(" "),d.isShowCancel?h("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:d.$t("CancelJobTips"),placement:"top-start"}},[h("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:d.isLoading},attrs:{type:"danger",size:"mini"},on:{click:d.handleCancelTask}},[d._v("\n          "+d._s(d.isLoading?"Canceling…":d.$t("CancelJob"))+"\n        ")])],1):d._e(),d._v(" "),[4,"4"].includes(d.message.status)&&d.checkPermission?h("message-operate-btn",{key:"reStart",attrs:{loading:d.checkBtnStatus("reStart").loading,disabled:d.checkBtnStatus("reStart").disabled},on:{click:d.handleTaskReStart}},[h("i",{staticClass:"iconfont icon-refresh-icon2",staticStyle:{"font-size":"18px"}})]):d._e()],2)]):d._e()],2)}),[],!1,null,"5e890855",null);t.default=component.exports},3229:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(12),n(13);var o=n(3),r=n(2),l=(n(20),n(19),n(6),n(32),n(50),n(22),n(24),n(8),n(4),n(28),n(21),n(44),n(7),n(26),n(279)),c=n(102),d=n(38),h=n(57),m=n(302),v=n(35),f=n.n(v),_=n(10),w=n(1),y=n(124),C=n(25),S=n(85),k=n(210),x=n(54),I=n(33),O=n(591),T=n(46),L=n(849),$=n(850);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j={name:"MessageImg",components:{taskImageViewer:m.default,SaveTo:y.default,AiChatCreateConfirm:l.a,auditDialog:k.a,ImageHoverButtons:O.default,FeedBackWin:L.default,reportArtworkWin:$.default},inject:["top"],props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},gridBanner:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},viewStatus:{type:Object,default:function(){return{0:!0,1:!0,2:!0,3:!0,4:!0}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}}},data:function(){return{flag:!0,loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:200,imageURLValid:!0,imageUrl:"",canViewNsfw:!1,checked:!1,alreadySave:!1,hoverBtnList:[{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"animGen",icon:"AnimGenIcon",useText:!1,order:1,tips:"AnimGen",show:!0,showTypeOptions:[]},{code:"upscale",icon:"task-upscale-icon",useText:!0,text:"U",order:2,tips:"WorkUpscale",show:!0,showTypeOptions:[]},{code:"variations",icon:"task-variations-icon",useText:!0,text:"V",order:3,tips:"WorkVariations",show:!0,showTypeOptions:[]},{code:"extraUpscale",icon:"upload-image-icon",useText:!1,order:1,tips:"ExtraUpscale",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"GraphicSubmission",show:!0,showTypeOptions:[]},{code:"removeBackground",icon:"work-remove-background",useText:!1,order:4,tips:"RemoveBackground",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],isShowHoverMask:!1,hide:!1}},computed:P(P(P(P({},Object(w.c)(["isSupportWebp"])),Object(w.c)("user",["userInfo","isCompanyAccount"])),Object(w.e)("user",["cdnHost"])),{},{getTopButtons:function(){var e=[];return this.isShowNsfwIcon&&(e=["supportFeedback","supportReport"]),e.map((function(code){return I.IMAGE_OPERATION_BTN_LIST.find((function(e){return e.permissionKey===code}))})).filter(Boolean)},getImageRenderAspectRatio:function(){var e,t={},n=(null==this||null===(e=this.message)||void 0===e?void 0:e.img_uris[0])||{},o=n.width,r=n.height,l=(this.message.banner,this.isAspectRatioExtreme(o,r));return o&&r&&o!==r&&(o<384||r<384||l)&&(t.aspectRatio="1/1"),o<=200&&(t=Object.assign(t,{minWidth:"".concat(150,"px"),maxWidth:"".concat(150,"px")})),t},showHoverMask:function(){return this.renderList.length&&this.isShowHoverMask},isStudioFlux:function(){var e;return this.isStudioMode&&[1,"1"].includes(null===(e=this.message)||void 0===e?void 0:e.sub_mode_category)},isShowChat:function(){return!this.hide&&1!==this.nsfw&&!this.isCompanyAccount&&!this.$isChinaSite&&[1,2,7,8,3,13,11,25,4,"1","2","7","8","3","13","11","25","4"].includes(this.message.type)&&[1,5,"1","5",11,"11"].includes(this.message.category)},renderList:function(){var e=JSON.parse(JSON.stringify(this.hoverBtnRenderList)),t=null,n=null,o=null,r=Object(C.chunk)(e,2),l=[],c=[];if(r.length>3){if(l=e.filter((function(e){return"animGen"===e.code?(t=e,!1):"deleteSingleImg"===e.code?(n=e,!1):"chat"!==e.code||(o=e,!1)})),c=Object(C.chunk)(l,2),o&&c[0].unshift(o),n){var d=c.length-1;d<2?(c[2]=[],c[2].push(n)):c[d]&&c[d].push(n)}if(t){var h=1;c.forEach((function(e,i){1==e.length&&(h=c.length<2?i:1)})),c[h]&&c[h].unshift(t)}}else l=e,c=Object(C.chunk)(l,2);return c},getChunkRenderList:function(){var e=this;return function(t){return e.renderList.length&&t<=e.renderList.length-1?e.renderList[t]:[]}},showAnimGen:function(){return![24,"24",25,"25"].includes(this.message.type)&&!this.isSdModel&&!this.isStudioMode},showExtraUpscale:function(){return[1,3,"1","3",7,"7",8,"8",11,23,"23",2,"2",13,"13","25",25].includes(this.message.type)&&!this.isStudioFlux},showUpscale:function(){return[1,3,5,7,8,11,23,25].includes(Number(this.message.type))},showVariations:function(){return[2,13,1,3,7,8,11,23,25,5].includes(this.message.type)},showRemoveBackground:function(){return[2,"2",13,"13"].includes(this.message.type)&&!this.isStudioFlux},isShowBtn:function(){var e,t=4===(null===(e=this.message)||void 0===e?void 0:e.type)?{chat:[!0],aiGenerateVideo:[!0]}:{extraUpscale:[this.showExtraUpscale&&1!==this.nsfw],upscale:[this.showUpscale&&1!==this.nsfw],variations:[this.showVariations&&1!==this.nsfw],removeBackground:[this.showRemoveBackground&&1!==this.nsfw],post:[this.showPostBtn&&1!==this.nsfw],save:[this.isShowSaveTo&&1!==this.nsfw],deleteSingleImg:[this.isMyMsg],animGen:[this.showAnimGen&&1!==this.nsfw],chat:[this.isShowChat],aiGenerateVideo:[this.isShowChat]};return function(e){return!!Object.keys(t).includes(e)&&t[e].every((function(e){return!!e}))}},covertI18n:function(){var e=this;return function(t){return"upscale"===(null==t?void 0:t.code)?e.isStudioMode?"".concat(e.$t("WorkUpscale")).replace("2048*2048","3072*3072"):e.$t("WorkUpscale"):e.$t(null==t?void 0:t.tips)}},hoverBtnRenderList:function(){var e=this;return this.hoverBtnList.map((function(t){return t.show=e.isShowBtn(t.code),t})).filter((function(e){return e.show}))},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus&&this.isMyMsg},isShowSaveTo:function(){var e,t=this.message.img_uris,n=void 0===t?[]:t;return!!n.length&&(!(null!==(e=n[this.operateNumber-1])&&void 0!==e&&e.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},isEnableSubmit:function(){return this.top.enableSubmit&&!this.isShowNsfwBg&&!this.error&&!this.loading},isShowNotSelectBox:function(){var e;return!(null!==(e=this.message)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.is_submit)},selectPostList:function(){var e;return(null==this||null===(e=this.top)||void 0===e?void 0:e.postSelectList)||[]},enableSubmit:function(){var e;return null==this||null===(e=this.top)||void 0===e?void 0:e.enableSubmit},showPostBtn:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_submit)&&!this.isShowNsfwBg&&this.isMyMsg&&!this.isCompanyAccount&&3!==(null===(t=this.message)||void 0===t?void 0:t.sub_model_category)},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},getRenderUrl:function(){var e,t=((null===(e=this.message)||void 0===e?void 0:e.img_uris)||[]).findIndex((function(e){return 1!==e.nsfw}));if(-1!==t){var n,o=null===(n=this.message)||void 0===n||null===(n=n.img_uris[t])||void 0===n?void 0:n.url;return(o=o?Object(_.K)(o,"high"):"")||"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")}return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var e="";return 1===this.nsfw||(e=this.checkIsShowViewNsfw&&this.isMyMsg?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===e)},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isSdModel:function(){var e,t;return[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isStudioMode:function(){var e,t;return["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw&&this.isMyMsg?(null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&!this.canViewNsfw:1===this.nsfw);var e},isShowHover:function(){var e;return!(!this.checkIsShowViewNsfw||!this.isMyMsg)&&((null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&!this.canViewNsfw)},isNsfwPlus:function(){var e;return(null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&1!==this.nsfw},isShowOperateBtn:function(){return[1,3,"1","3",7,"7",11,8,"8",2,"2",11,"13",13,24,"24","25",25,"4",4].includes(this.message.type)&&!this.isBlur&&!this.error},convertPictureWidthAndHeight:function(){var e=this.message.banner,t=(void 0===e?{}:e)||{},n=t.width,o=void 0===n?200:n,r=t.height,l=void 0===r?200:r,c=Object(h.resizeImage)(o,l,this.baseImageWidth);return isNaN(c.height)?{}:{width:"".concat(c.width,"px"),height:"".concat(c.height,"px")}},covertSmallWidth:function(){var e=this.message.banner,t=(void 0===e?{}:e).width;return(void 0===t?0:t)<=200?{minWidth:"".concat(150,"px"),maxWidth:"".concat(150,"px")}:{}},viewImageList:function(){var e=this,t=this.message,n=t.banner,o=void 0===n?{}:n,r=t.img_uris,l=void 0===r?[]:r,c=t.preprocess_images,d=void 0===c?[]:c,h=t.type,m=void 0===h?"":h;return Array.isArray(d)&&[10,"10"].includes(m)?(f()(this.message.preprocess_images||[])||[]).map((function(e,t){return e.operateNumber=t+1,e})).filter((function(t){return e.checkIsShowViewNsfw&&e.isMyMsg&&e.enableNsfwMode?![1,"1"].includes(t.nsfw)&&e.viewStatus[t.operateNumber]:![1,"1"].includes(t.nsfw)})):Array.isArray(l)&&l.length?(f()(this.message.img_uris||[])||[]).map((function(e,t){return e.operateNumber=t+1,e})).filter((function(t){return e.checkIsShowViewNsfw&&e.isMyMsg&&e.enableNsfwMode?![1,"1"].includes(t.nsfw)&&e.viewStatus[t.operateNumber]:![1,"1"].includes(t.nsfw)})):[Object.assign({},f()(o),{operateNumber:1})]},currentImageIndex:function(){var e,t=this;return-1===(e=this.viewImageList.findIndex((function(e){return e.operateNumber===t.operateNumber})))?0:e},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)}}),mounted:function(){this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode},watch:{src:{handler:function(e){e&&"string"==typeof e&&(this.imageUrl=this.isSupportWebp?Object(_.K)(e,"high"):this.src)},immediate:!0},enableNsfwMode:{handler:function(e,t){t&&t!==e&&(this.flag=!0),this.isMyMsg&&this.flag&&(this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode)},deep:!0,immediate:!0},canViewNsfw:{handler:function(e){this.$emit("viewNsfwStatus",{index:this.operateNumber,canViewNsfw:!this.isMyMsg||this.canViewNsfw,isGrid:!!Object.keys(this.gridBanner||{}).length})},deep:!0,immediate:!0},enableSubmit:{handler:function(e){e||(this.checked=!1)},immediate:!0,deep:!0}},methods:P(P(P({},Object(w.b)("user",["getAccountInfo"])),Object(w.d)("user",["SET_USER_INFO"])),{},{handleButtonClick:function(data){var code=null==data?void 0:data.code;if(console.log("handleButtonClick",data),["feedback"].includes(code)){var e,t=null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.index;this.handleViewNsfwFeedback(t)}else["report"].includes(code)&&this.handleReport()},isAspectRatioExtreme:function(e,t){try{return e/t>=2||t/e>=2}catch(e){return!1}},handleConfirm:function(){this.handleChat()},handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"}),this.alreadySave=!0,this.$emit("saveSuccess")},handleClickCheck:function(e){if(!["span","input"].includes(e.target.localName)){var t=this.checkInList();this.selectPostList.length>=20&&-1===t&&!this.checked?this.$message.warning("至多选择20个哦"):(this.checked=!this.checked,this.updateDataToPostSelectList(this.checked))}},checkInList:function(){this.message.id,null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e||e.index;var e,t=this.viewImageList[this.currentImageIndex].url;return(this.top.postSelectList||[]).findIndex((function(e){return t===e.url}))},updateDataToPostSelectList:function(e){var t,n={taskId:this.message.id,index:null==this||null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.index,url:this.viewImageList[this.currentImageIndex].url};this.top.updatePostSelectList(n)},deleteSingleImg:function(){var e=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.$emit("deleteSingleImg",e.operateNumber)})).catch((function(e){console.log("err",e)}))},handleCheckChange:function(e){var t=this.checkInList();if(this.selectPostList.length>=20&&-1===t&&e)return this.$message.warning("至多选择20个哦"),void(this.checked=!1);this.updateDataToPostSelectList(this.checked)},handleSinglePost:function(){var e,t={taskId:this.message.id,index:null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.index,url:this.viewImageList[this.currentImageIndex].url};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_hover",behavior_info_sub:t.url}),this.$EventBus.$emit("openContribution",{selectedData:[t],types:[x.CONTRIBUTION_TYPE_ENUM.WORK],source:"task"})},settingViewNsfw:function(){var e;this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.isMyMsg&&(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog())},applyNsfw:function(){var e=this;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(S.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully"))})).finally((function(){e.flag=!1;var data=f()(e.userInfo);data.is_audit=1,e.SET_USER_INFO(data),e.canViewNsfw=!e.canViewNsfw}))}else this.canViewNsfw=!this.canViewNsfw},handleShowNsfwImageUrl:function(){var e;return null!=this&&null!==(e=this.message)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.is_nsfw_plus&&!this.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(e){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",f()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var e=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){e.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(_.K)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){1!==this.nsfw&&(this.isShowHover||(this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(e){1===this.nsfw&&e.preventDefault()},handleChat:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,c,h,m,v,f,_,w,y,C,S;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _={height:(null===(n=e.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height)||(null===(o=e.message)||void 0===o||null===(o=o.meta)||void 0===o?void 0:o.height),width:(null===(r=e.message)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.width)||(null===(l=e.message)||void 0===l||null===(l=l.meta)||void 0===l?void 0:l.width),id:null===(c=e.message)||void 0===c?void 0:c.id,url:e.imageUrl||(null===(h=e.message)||void 0===h||null===(h=h.banner)||void 0===h?void 0:h.url),source_account_id:(null===(m=e.message)||void 0===m||null===(m=m.messageInfo)||void 0===m||null===(m=m.author)||void 0===m?void 0:m.id)||(null===(v=e.userInfo)||void 0===v?void 0:v.id),channel:"task"},t.next=3,Object(d.S)({channel:"task",source_id:_.id});case 3:if(w=t.sent,y=(null==w?void 0:w.data)||{},C=y.can,2!==(void 0===C?2:C)){t.next=8;break}return e.$message.warning(e.$t("chatFail")),t.abrupt("return");case 8:if(!e.isShowSaveTo||1===e.nsfw){t.next=12;break}return t.next=11,e.handleSave(_);case 11:return t.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(_)),S="/cyberPubPage/".concat(null===(f=e.message)||void 0===f?void 0:f.id,"?quickChat=true&source=work"),window.open(e.localePath(S),"_blank");case 15:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,d,h,m,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:null,r=t.message,l=r.id,d=void 0===l?"":l,h=r.img_uris,m=(void 0===h?[]:h)[t.operateNumber-1].index,v=void 0===m?"":m,Object(c.a)({folder_no:"default",id:d,index:v}).then((function(){if(t.handleSaveSuccess(),o){var e;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(e=t.message)||void 0===e?void 0:e.id,"?quickChat=true&source=work");window.open(t.localePath(n),"_blank")}})).catch((function(e){console.log("saveFail",e)}));case 4:case"end":return n.stop()}}),n)})))()},handleClick:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,h,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["deleteSingleImg"].includes(r=e.length>0&&void 0!==e[0]?e[0]:"")){n.next=4;break}return t.deleteSingleImg(),n.abrupt("return");case 4:if(!["post"].includes(r)){n.next=7;break}return t.handleSinglePost(),n.abrupt("return");case 7:if(!["save"].includes(r)){n.next=10;break}return t.$refs.saveToPopover.doShow(),n.abrupt("return");case 10:if(!["chat"].includes(r)){n.next=16;break}return n.next=13,Object(d.S)({channel:"task",source_id:null===(l=t.message)||void 0===l?void 0:l.id});case 13:c=n.sent,h=c.data.character_id,(void 0===h?"":h)?t.handleChat():t.$refs.aiChatCreateConfirm.show();case 16:["aiGenerateVideo"].includes(r)&&(m={cover:t.getImageUrl},m=JSON.stringify(m),window.open(t.localePath("/ai-tools/ai-video-generator?info=".concat(m)))),t.$emit("imageOperate",r,t.operateNumber,null===(o=t.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.url);case 18:case"end":return n.stop()}}),n)})))()},handleImageOperate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"report"!==e?"feedback"!==e?(this.$emit("imageOperate",e,t.operateNumber,t.url),this.closeViewBigImage()):this.handleViewNsfwFeedback(null==t?void 0:t.index):this.handleReport()},handleReport:function(){this.$refs.reportArtworkWin.show()},checkCanFeedback:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.is_nsfw_appeal){n.next=3;break}return t.$message.warning(t.$t("feedbackTips3")),n.abrupt("return");case 3:return n.prev=3,n.next=6,Object(T.checkAndShowFeedback)();case 6:if(1e4===(null==(l=n.sent)||null===(o=l.status)||void 0===o?void 0:o.code)){n.next=9;break}return n.abrupt("return");case 9:if(null==l||null===(r=l.data)||void 0===r||!r.feedback_expire_time){n.next=12;break}return t.$message.warning("".concat(t.$t("feedback_tips")," ").concat(formatDateTime(Number(l.data.feedback_expire_time)))),n.abrupt("return");case 12:t.$refs.feedBackWin.show(),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(3),console.log(n.t0);case 18:case"end":return n.stop()}}),n,null,[[3,15]])})))()},handleViewNsfwFeedback:function(e){var t,n=((null==this||null===(t=this.message)||void 0===t?void 0:t.img_uris)||[]).find((function(t){return(null==t?void 0:t.index)===e}));this.selCurrentImage=n,this.checkCanFeedback(n)},submitFeedback:function(){var e,t=this,desc=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={appeal:{index:this.selCurrentImage.index,task_id:null===(e=this.message)||void 0===e?void 0:e.id,remark:desc}};Object(T.feedbackNSFWImage)(n).then((function(e){var n,o;if(10100===(null==e||null===(n=e.status)||void 0===n?void 0:n.code))return t.$message.warning(t.$t("feedbackTips3")),void t.$refs.feedBackWin.handleClose(!0);var r,l=(null==e||null===(o=e.data)||void 0===o?void 0:o.result)||{};!(null==l?void 0:l.success)&&1||(t.$message.success(t.$t("feedbackTips2")),null==t||null===(r=t.message)||void 0===r||r.img_uris.forEach((function(e){e.index===t.selCurrentImage.index&&(e.is_nsfw_appeal=!0)})))})).finally((function(){t.$refs.feedBackWin.handleClose(!0)}))},handleVideoGeneration:function(){this.top.handleVideoSwitchMenu({imageToVideoUrl:this.getImageUrl})},handleConfirmReport:function(){var e=this;setTimeout((function(){e.$refs.reportArtworkWin.setLoading(!1),e.$message.success(e.$t("ReportSuccess")),e.$refs.reportArtworkWin.handleClose()}),1500)}})},D=j,N=(n(4066),n(4067),n(4068),n(0)),component=Object(N.a)(D,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-media-attachments-container"},[t("div",{staticClass:"attachments-wrap",class:[e.checked?"attachments-wrap-checked":""]},[t("div",{staticClass:"message-attachment-media"},[t("div",{staticClass:"image-content"},[t("div",{staticClass:"image-content-wrap",class:[1===e.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(e.baseImageWidth,"px"),"min-width":"".concat(150,"px")}},[t("div",{staticClass:"image-render-box"},[1===e.nsfw?[t("img",{staticClass:"media-attachments-img image-opacity-0",style:e.loading?e.convertPictureWidthAndHeight:e.getImageRenderAspectRatio,attrs:{src:e.getRenderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,contextmenu:function(t){return e.handleContextMenu(t)}}})]:[24!=e.message.type?t("img",{staticClass:"media-attachments-img",class:[e.loading?"":"media-attachments-img-show",e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],style:e.loading?e.convertPictureWidthAndHeight:e.getImageRenderAspectRatio,attrs:{src:e.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,click:e.viewBigImage,contextmenu:function(t){return e.handleContextMenu(t)}}}):e.getImageUrl?t("video",{class:[e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px",width:"".concat(e.baseImageWidth,"px"),height:"".concat(parseInt(e.height*e.baseImageWidth/e.width),"px")},attrs:{src:e.getImageUrl,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{play:function(t){e.loading=!1}}}):e._e()],e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading&&1!==e.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[t("div",{staticClass:"loading-wrapper-inner"},[t("span",{staticClass:"spinner",attrs:{role:"img","aria-label":e.$t("Loading")}},[e._m(0)])])]),e._v(" "),e.isShowNsfwIcon?[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.canViewNsfw,expression:"!canViewNsfw"}],staticClass:"generate-view-nsfw-plus-warning"},[t("i",{staticClass:"iconfont icon-jubao2"})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.canViewNsfw,expression:"canViewNsfw"}],staticClass:"generate-view-nsfw-plus",on:{click:function(t){return t.stopPropagation(),e.settingViewNsfw.apply(null,arguments)}}},[t("i",{staticClass:"iconfont",class:e.canViewNsfw?"icon-work-hide":"icon-work-show"})])]:e._e(),e._v(" "),e.isEnableSubmit?[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShowNotSelectBox,expression:"!isShowNotSelectBox"}],staticClass:"image-post-check-mask",on:{click:function(t){return t.stopPropagation(),e.handleClickCheck(t)}}},[t("el-checkbox",{staticClass:"image-post-check-box",on:{change:e.handleCheckChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowNotSelectBox,expression:"isShowNotSelectBox"}],staticClass:"image-post-check-mask-hover"},[e._v("\n                "+e._s(e.$t("notAllowSelect"))+"\n              ")])]:e._e(),e._v(" "),t("el-popover",{attrs:{placement:"right-start","popper-class":"video-generation-popover",trigger:"hover"}},[t("div",{staticClass:"cardBox",on:{click:function(t){return t.stopPropagation(),e.handleVideoGeneration.apply(null,arguments)}}},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250421/80d84a25-341c-419e-9367-e43251d662d2.webp",alt:""}}),e._v(" "),t("div",{staticClass:"title"},[e._v(e._s(e.$t("videoGeneration")))]),e._v(" "),t("div",{staticClass:"desc"},[e._v(e._s(e.$t("play_image_to_video_desc")))])]),e._v(" "),!e.getImageUrl||1===e.nsfw||e.isShowNsfwIcon&&!e.canViewNsfw||e.isEnableSubmit?e._e():t("div",{staticClass:"video-generation-btn",attrs:{slot:"reference"},on:{click:function(t){return t.stopPropagation(),e.handleVideoGeneration.apply(null,arguments)}},slot:"reference"},[t("span",[e._v(e._s(e.$t("videoGeneration")))])])]),e._v(" "),t("ImageHoverButtons",{directives:[{name:"show",rawName:"v-show",value:e.isShowOperateBtn&&e.isShowImage&&e.src&&!e.loading&&![0,"0"].includes(this.operateNumber)||1===e.nsfw||e.isShowNsfwIcon&&!e.canViewNsfw,expression:"\n                (isShowOperateBtn && isShowImage && src && !loading && ![0, '0'].includes(this.operateNumber)) ||\n                nsfw === 1 ||\n                (isShowNsfwIcon && !canViewNsfw)\n              "}],staticClass:"image-hover-mask",class:{"image-hover-mask-view":e.isShowNsfwIcon&&!e.canViewNsfw},attrs:{topButtons:e.getTopButtons,bottomButtons:[],maxVisibleBottomButtons:1,maxVisibleTopButtons:0,hideBottomButtons:e.isShowNsfwIcon&&!e.canViewNsfw,operateNumber:e.operateNumber},on:{buttonClick:e.handleButtonClick},scopedSlots:e._u([e.isShowNsfwIcon?{key:"special-config",fn:function(){return[t("i",{staticClass:"iconfont",class:e.canViewNsfw?"icon-work-hide":"icon-work-show",on:{click:function(t){return t.stopPropagation(),e.settingViewNsfw.apply(null,arguments)}}})]},proxy:!0}:null],null,!0)}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEnableSubmit&&e.isShowOperateBtn&&e.isShowImage&&e.src&&!e.loading&&![0,"0"].includes(this.operateNumber)||1===e.nsfw,expression:"\n                (!isEnableSubmit &&\n                  isShowOperateBtn &&\n                  isShowImage &&\n                  src &&\n                  !loading &&\n                  ![0, '0'].includes(this.operateNumber)) ||\n                nsfw === 1\n              "}],staticClass:"image-hover-mask",on:{click:e.viewBigImage}},[t("div",{staticClass:"image-hover-mask-btn-box"},[[e.getChunkRenderList(0).length?[e.getChunkRenderList(0).length>1?t("div",{staticClass:"image-hover-item"},[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(0)[0])}},["save"===e.getChunkRenderList(0)[0].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(0)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(0)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[0].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(0)[0].code)}}},[e.getChunkRenderList(0)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(0)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[0].icon)})],2)]],2),e._v(" "),e.getChunkRenderList(0)[1]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(0)[1]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"bottom",content:e.covertI18n(e.getChunkRenderList(0)[1])}},["save"===e.getChunkRenderList(0)[1].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(0)[1].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(0)[1].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[1].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(0)[1].code)}}},[e.getChunkRenderList(0)[1].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(0)[1].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[1].icon)})],2)]],2):e._e(),e._v(" "),e.getChunkRenderList(0)[2]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(0)[2]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"bottom",content:e.covertI18n(e.getChunkRenderList(0)[2])}},["save"===e.getChunkRenderList(0)[2].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(0)[2].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(0)[2].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[2].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(0)[2].code)}}},[e.getChunkRenderList(0)[2].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(0)[2].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[2].icon)})],2)]],2):e._e()],1):[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(0)[0])}},["save"===e.getChunkRenderList(0)[0].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(0)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(0)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[0].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(0)[0].code)}}},[e.getChunkRenderList(0)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(0)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(0)[0].icon)})],2)]],2)]]:e._e(),e._v(" "),e.getChunkRenderList(1).length?[e.getChunkRenderList(1).length>1?t("div",{staticClass:"image-hover-item"},[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(1)[0])}},["save"===e.getChunkRenderList(1)[0].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(1)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(1)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[0].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(1)[0].code)}}},[e.getChunkRenderList(1)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(1)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[0].icon)})],2)]],2),e._v(" "),e.getChunkRenderList(1)[1]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(1)[1]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"bottom",content:e.covertI18n(e.getChunkRenderList(1)[1])}},["save"===e.getChunkRenderList(1)[1].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(1)[1].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(1)[1].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[1].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(1)[1].code)}}},[e.getChunkRenderList(1)[1].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(1)[1].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[1].icon)})],2)]],2):e._e(),e._v(" "),e.getChunkRenderList(1)[2]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(1)[2]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"bottom",content:e.covertI18n(e.getChunkRenderList(1)[2])}},["save"===e.getChunkRenderList(1)[2].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(1)[2].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(1)[2].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[2].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(1)[2].code)}}},[e.getChunkRenderList(1)[2].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(1)[2].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[2].icon)})],2)]],2):e._e()],1):[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(1)[0])}},["save"===e.getChunkRenderList(1)[0].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(1)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(1)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[0].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(1)[0].code)}}},[e.getChunkRenderList(1)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(1)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(1)[0].icon)})],2)]],2)]]:e._e(),e._v(" "),e.getChunkRenderList(2).length?[e.getChunkRenderList(2).length>1?t("div",{staticClass:"image-hover-item"},[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(2)[0])}},["save"===e.getChunkRenderList(2)[0].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(2)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(2)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[0].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(2)[0].code)}}},[e.getChunkRenderList(2)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(2)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[0].icon)})],2)]],2),e._v(" "),e.getChunkRenderList(2)[1]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(2)[1]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(2)[1])}},["save"===e.getChunkRenderList(2)[1].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(2)[1].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(2)[1].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[1].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(2)[1].code)}}},[e.getChunkRenderList(2)[1].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(2)[1].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[1].icon)})],2)]],2):e._e(),e._v(" "),e.getChunkRenderList(2)[2]?t("div",{staticClass:"line-item"}):e._e(),e._v(" "),e.getChunkRenderList(2)[2]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(2)[2])}},["save"===e.getChunkRenderList(2)[2].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(2)[2].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(2)[2].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[2].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(2)[2].code)}}},[e.getChunkRenderList(2)[2].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(2)[2].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[2].icon)})],2)]],2):e._e(),e._v(" "),e.getChunkRenderList(2)[3]?t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(2)[3])}},["save"===e.getChunkRenderList(2)[3].code?[t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(2)[3].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(2)[3].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[3].icon)})],2)])]:[t("span",{staticClass:"image-hover-mask-btn",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(2)[3].code)}}},[e.getChunkRenderList(2)[3].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(2)[3].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[3].icon)})],2)]],2):e._e()],1):[t("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.covertI18n(e.getChunkRenderList(2)[0])}},["save"===e.getChunkRenderList(2)[0].code?[e.isShowSaveTo?t("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[e.getChunkRenderList(2)[0].useText?[e._v("\n                                "+e._s(e.getChunkRenderList(2)[0].text)+"\n                              ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[0].icon)})],2)]):e._e()]:[t("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){t.stopPropagation(),e.handleClick(e.getChunkRenderList(2)[0].code)}}},[e.getChunkRenderList(2)[0].useText?[e._v("\n                              "+e._s(e.getChunkRenderList(2)[0].text)+"\n                            ")]:t("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.getChunkRenderList(2)[0].icon)})],2)]],2)]]:e._e()]],2)])],2)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.error&&!e.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[t("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),e._v(" "),t("span",{staticClass:"image-load-error-text",on:{click:function(t){return t.stopPropagation(),e.clickReloadImage.apply(null,arguments)}}},[e._v(e._s(e.$t("reloadImage")))])])])]),e._v(" "),e.dialogVisible?t("task-image-viewer",{staticClass:"message-img-viewer",attrs:{operateNumber:e.operateNumber,nsfw:e.nsfw,"on-close":e.closeViewBigImage,"initial-index":e.currentImageIndex,"show-operate-btn":e.isShowOperateBtn,message:e.message,hoverBtnRenderList:e.hoverBtnRenderList,"url-list":e.viewImageList,msgId:e.message.id,loraModels:e.loraModels,checkIsShowViewNsfw:e.checkIsShowViewNsfw},on:{imageOperate:e.handleImageOperate,handleAnimate:function(t){return e.handleClick("animGen")},saveSuccess:e.handleSaveSuccess,setLoraModel:function(t){return e.$emit("setLoraModel",t)}}}):e._e()],1),e._v(" "),t("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task"},on:{confirm:e.handleConfirm}}),e._v(" "),t("auditDialog",{ref:"auditDialog",on:{confirm:e.applyNsfw}}),e._v(" "),t("feed-back-win",{ref:"feedBackWin",on:{submitFeedback:e.submitFeedback}}),e._v(" "),t("report-artwork-win",{ref:"reportArtworkWin",attrs:{title:e.$t("Tip")},on:{confirm:e.handleConfirmReport}},[t("div",{staticClass:"jubao-content-box"},[t("div",{staticClass:"icon-box"},[t("i",{staticClass:"iconfont icon-jubao2"})]),e._v(" "),t("div",{staticClass:"tips-box"},[t("p",{staticClass:"tips1"},[e._v(e._s(e.$t("newGenerate38")))]),e._v(" "),t("p",{staticClass:"tips2"},[e._v(e._s(e.$t("jubao_tips")))])])])])],1)}),[function(){var e=this._self._c;return e("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[e("span",{staticClass:"item-2VgEex"}),e("span",{staticClass:"item-2VgEex"})])}],!1,null,"4536a584",null);t.default=component.exports;installComponents(component,{SaveTo:n(124).default})},3230:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(12),n(13);var o=n(3),r=n(14),l=n(2),c=(n(20),n(6),n(50),n(16),n(73),n(49),n(8),n(4),n(218),n(21),n(40),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(7),n(41),n(1)),d=n(105),h=n(303),m=n(56),v=n(10),f=n(57),_=(n(99),n(9));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={props:["value"],components:{SliderItem:d.default,StyleModal:h.default},inject:["top"],data:function(){return{autosize:{minRows:5,maxRows:10},selectIds:[],selectModelType:"TextualInversion",modelDetailTrainedWords:[]}},computed:y(y({},Object(c.c)("creation",["taskSamplerMethods","taskVae","sd_xl_vae","sd_xl_sampler_name","lab_scheduler","lab_sampler_name","flux_sampler_name","combined_sampler_name"])),{},{isShowSteps:function(){var e;return"expansion"!==this.top.menuIndex&&!this.isStudioFlux||(null===(e=this.value)||void 0===e?void 0:e.base_model_type.includes("Flux"))},seedOptions:function(){var e={max:4294967294};return this.isStudioFlux&&(e.max=2147483643),e},enableEmbedding:function(){return[1,"1",5,"sdxl"].includes(this.value.category)},showEmbeddings:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.embeddings)||void 0===e?void 0:e.length)<8},getTriggerWords:function(){var e,t=((null===(e=this.value)||void 0===e?void 0:e.embeddings)||[]).reduce((function(pre,e){return pre.push.apply(pre,Object(r.a)((null==e?void 0:e.trained_words)||[])),pre}),[]);return Object(r.a)(new Set(t))},isSD3:function(){var e;return"SD 3"===(null===(e=this.value)||void 0===e?void 0:e.base_model_type)},schedulerDisabled:function(){var e,t=["textToImage"].includes(this.top.menuIndex)&&[1,2].includes(null===(e=this.value)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.quality_mode)&&!this.isStudioFlux,n=this.isStudioMode&&this.isSD3;return t||n},isSdModel:function(){return!["5",5].includes(this.value.category)},isStudioMode:function(){return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(this.value.category)},isStudioFlux:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.base_model_type)||void 0===e?void 0:e.includes("Flux"))&&["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode},renderTaskSamplerMethods:function(){return this.combined_sampler_name},renderTaskScheduler:function(){return this.lab_scheduler},renderStudioSampler:function(){var e;return((null===_.L||void 0===_.L?void 0:_.L.flux)||[]).includes(null===(e=this.value)||void 0===e?void 0:e.base_model_type)?this.flux_sampler_name:this.combined_sampler_name},handleVaeList:function(){return 5!==this.value.category?this.taskVae.filter((function(e){return"sdxl_vae"!==e})):this.sd_xl_vae},renderStepsOptions:function(){var e,t,n,o={min:10,max:40};return this.value.lcm_mode&&(o.min=4,o.max=8),["5",5].includes(this.value.category)&&!this.value.lcm_mode&&(o.min=20),[7,"7"].includes(this.value.category)&&(o.min=25,o.max=50),null!==(e=this.value)&&void 0!==e&&e.base_model_type.includes("Flux")&&(o.min=4,o.max=60),null!==(t=this.value)&&void 0!==t&&t.base_model_type.includes("SD 3.5")&&(o.min=6,o.max=25),null!==(n=this.value)&&void 0!==n&&n.base_model_type.includes("NoobAI")&&(o.min=32,o.max=40),o},renderCFGScale:function(){var e,t,n={min:3,max:15};return this.value.lcm_mode&&(n.min=1,n.max=3),[7,"7"].includes(this.value.category)&&(n.min=2,n.max=15),null!==(e=this.value)&&void 0!==e&&e.base_model_type.includes("SDXL")&&(n.min=1,n.max=15),null!==(t=this.value)&&void 0!==t&&t.base_model_type.includes("NoobAI")&&(n.min=3.5,n.max=5.5),n},showCustomSeed:function(){var e,t,n;return!!["imageToImage","conditionToImage"].includes(null===(e=this.top)||void 0===e?void 0:e.menuIndex)||("textToImage"===(null===(t=this.top)||void 0===t?void 0:t.menuIndex)?["normal","sdxl","studio"].includes(null===(n=this.top)||void 0===n?void 0:n.creativeMode):void 0)},seedPlsHd:function(){var e;return this.showCustomSeed&&"custom"===(null===(e=this.value)||void 0===e?void 0:e.seedMode)?this.$t("customSeed"):this.$t("RandomSeed")},showImgSeed:function(){return this.value.seedTemp&&this.value.seed!==this.value.seedTemp},showImgSeedsdxl:function(){return this.value.seedTempsdxl&&this.value.seedsdxl!==this.value.seedTempsdxl},notSdxl:function(){var e,t;return"textToImage"!==(null===(e=this.top)||void 0===e?void 0:e.menuIndex)||"sdxl"!==(null===(t=this.top)||void 0===t?void 0:t.creativeMode)}}),methods:{openModelModal:function(){var e;this.selectIds=this.value.embeddings,(null==this||null===(e=this.selectIds)||void 0===e?void 0:e.length)>=8?this.$message.warning(this.$t("embedding6",{num:8})):this.$refs.styleModal.openModal()},handleSelectModel:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=JSON.parse(JSON.stringify(t.value)),((null==o?void 0:o.embeddings)||[]).some((function(t){return t&&(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(null==t?void 0:t.model_ver_no)===(null==e?void 0:e.model_ver_no)}))){n.next=6;break}return n.next=5,t.getModelDetail(null==e?void 0:e.id,null==e?void 0:e.model_ver_no);case 5:t.value.embeddings.push(y(y({},e),{},{trained_words:Object(r.a)(t.modelDetailTrainedWords)}));case 6:t.$refs.styleModal.handleClose();case 7:case"end":return n.stop()}}),n)})))()},getModelDetail:function(){var e=this,t={id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",version_id:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""};return Object(m.G)(t).then((function(t){var n;if(!t||1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=(t&&null!=t&&t.data?null==t?void 0:t.data:{}).trained_words,r=void 0===o?[]:o;e.modelDetailTrainedWords=Array.isArray(r)?r:[]}})).finally((function(){}))},handleDeleteModel:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=((null===(e=this.value)||void 0===e?void 0:e.embeddings)||[]).findIndex((function(e){return e.id===(null==n?void 0:n.id)&&(null==n?void 0:n.model_ver_no)===(null==e?void 0:e.model_ver_no)}));-1!==o&&(null===(t=this.value)||void 0===t||null===(t=t.embeddings)||void 0===t||t.splice(o,1))},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,text=this.getTriggerWords.join(", ");2===e&&(text=content),Object(v.g)(text),this.$message.success(this.$t("CopySuccess"))},changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["auto_adjust_open","auto_adjust_strength","semantics_open","sharpness","scheduler","film_turbo"].includes(t)?n.lab_base[t]=e:n[t]=e,this.$emit("input",n)},checkNotAllowClick:function(){var e;this.isStudioMode&&[1,2].includes(null===(e=this.value)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.quality_mode)&&this.$message.warning(this.$t("studio44"))},changeConfigs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e);if(null!=t&&t.length){var n=JSON.parse(JSON.stringify(this.value));t.forEach((function(t){n[t]=e[t]})),this.$emit("input",n)}},changeLCM:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this.$logEvent("log_actions",{operation:"click_lcm",behavior_info:"on_create_work"});var t=["5",5].includes(this.value.category);if(e){console.log("isSdMode",t);var n=t?8:4,o=t?2:1.5;this.changeConfigs({steps:n,cfg_scale:o,sampler_name:"LCM",lcm_mode:1})}else{var r=t?30:20;this.changeConfigs({steps:r,cfg_scale:7,sampler_name:"DPM++2M Karras",lcm_mode:0})}},changeSamplerName:function(e){if("LCM"===e)this.changeLCM(1);else{var t=["5",5].includes(this.value.category)?30:20;this.changeConfigs({steps:t,cfg_scale:7,sampler_name:e,lcm_mode:0})}},changeSeed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"custom",t=arguments.length>1?arguments[1]:void 0,n=JSON.parse(JSON.stringify(this.value)),o=this.notSdxl?"seed":"seedsdxl",r=this.notSdxl?"seedMode":"seedModesdxl";this.value[r]&&this.value[r]!==e&&(n[o]="custom"===e?Object(f.getRandomSeed)(this.isStudioFlux):-1),t&&(n[o]=t),n[r]=e,this.$emit("input",n)},useSeed:function(e){-1!==e&&this.changeSeed("custom",e)}}},S=C,k=(n(4084),n(4085),n(0)),component=Object(k.a)(S,(function(){var e,t,n,o,r,l,c,d,h,m=this,v=m._self._c;return v("div",{staticClass:"generate-advanced handle-item"},[v("div",{staticClass:"item-head",on:{click:function(e){return m.changeConfig(!m.value.advancedZoom,"advancedZoom")}}},[v("label",[v("i",{staticClass:"iconfont icon-gaojishezhi"}),m._v("\n      "+m._s(m.$t("AdvancedConfig"))+"\n    ")]),m._v(" "),v("i",{staticClass:"el-icon-caret-bottom",class:{zoom:m.value.advancedZoom}})]),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:m.value.advancedZoom,expression:"value.advancedZoom"}],staticClass:"item-content"},[v("div",{directives:[{name:"show",rawName:"v-show",value:!(m.isStudioFlux||null!==(e=m.top)&&void 0!==e&&e.isStudioSD35Mode),expression:"!isStudioFlux && !top?.isStudioSD35Mode"}],staticClass:"h-item"},[v("label",[m._v(m._s(m.$t("NegativePrompts")))]),m._v(" "),v("el-input",{attrs:{type:"textarea",value:5===m.value.category?m.value.negative_prompt_sdxl:m.value.negative_prompt,placeholder:"",autosize:m.autosize,resize:"none",maxlength:"2000"},on:{input:function(e){return m.changeConfig(e,5===m.value.category?"negative_prompt_sdxl":"negative_prompt")}}})],1),m._v(" "),m.enableEmbedding?[v("div",{staticClass:"h-item h-item-embeding"},[v("div",{staticClass:"item-head",on:{click:function(e){return e.stopPropagation(),m.openModelModal()}}},[v("label",[m._v("\n            "+m._s(m.$t("embedding1"))+"\n            "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("embedding2"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips custom-tips-show"})])],1),m._v(" "),v("i",{directives:[{name:"show",rawName:"v-show",value:m.showEmbeddings,expression:"showEmbeddings"}],staticClass:"el-icon-circle-plus",on:{click:function(e){return e.stopPropagation(),m.openModelModal()}}})]),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:null===(t=m.value)||void 0===t||null===(t=t.embeddings)||void 0===t?void 0:t.length,expression:"value?.embeddings?.length"}],staticClass:"embeding-box"},m._l(m.value.embeddings,(function(e){return v("div",{staticClass:"embeding-box-item"},[v("div",{staticClass:"embeding-box-item-title",attrs:{title:null==e?void 0:e.name}},[m._v(m._s(null==e?void 0:e.name))]),m._v(" "),v("div",{staticClass:"embeding-box-info"},[v("span",{staticClass:"embeding-box-info-vesion",attrs:{title:null==e?void 0:e.version_name}},[m._v(m._s(null==e?void 0:e.version_name))]),m._v(" "),v("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),m.handleDeleteModel(e)}}})])])})),0)]),m._v(" "),null!==(n=m.getTriggerWords)&&void 0!==n&&n.length?v("div",{staticClass:"h-item h-item-embeding"},[v("div",{staticClass:"item-head"},[v("label",[m._v(m._s(m.$t("TriggerWords")))]),m._v(" "),v("span",{staticClass:"item-head-icon",on:{click:function(e){return m.handleCopyAll()}}},[m._v(m._s(m.$t("embedding4"))),v("i",{staticClass:"iconfont icon-copy-ops"})])]),m._v(" "),v("div",{staticClass:"trigger-words"},m._l(m.getTriggerWords,(function(e){return v("div",{staticClass:"trigger-words-item"},[v("span",{staticClass:"trigger-words-item-text",attrs:{title:e}},[m._v(m._s(e))]),m._v(" "),v("i",{staticClass:"iconfont icon-copy-ops trigger-words-item-icon",on:{click:function(t){return m.handleCopyAll(e,2)}}})])})),0)]):m._e()]:m._e(),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex&&!m.isStudioMode,expression:"top.menuIndex !== 'expansion' && !isStudioMode"}],staticClass:"h-item select-item h-item-no-padding-top"},[v("label",[m._v(m._s(m.$t("VAE"))+"\n        "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("vaeTips"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),m._v(" "),v("el-select",{attrs:{value:m.value.vae,"popper-append-to-body":!0,"popper-class":"custom-select vae-custom-select"},on:{change:function(e){return m.changeConfig(e,"vae")}}},m._l(m.handleVaeList,(function(e,i){return v("el-option",{key:"method_"+i,attrs:{label:e,value:e}},[v("el-tooltip",{attrs:{content:e,placement:"left"}},[v("span",[m._v(m._s(e))])])],1)})),1)],1),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex&&!m.isStudioMode,expression:"top.menuIndex !== 'expansion' && !isStudioMode"}],staticClass:"h-item switch-item h-item-no-padding-top"},[v("label",[m._v(m._s(m.$t("LCM")))]),m._v(" "),v("el-switch",{attrs:{"active-color":"#3F8CFF","active-value":1,"inactive-value":0},on:{change:function(e){return m.changeLCM(e,"lcm_mode")}},model:{value:m.value.lcm_mode,callback:function(e){m.$set(m.value,"lcm_mode",e)},expression:"value.lcm_mode"}})],1),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex&&!m.isStudioMode,expression:"top.menuIndex !== 'expansion' && !isStudioMode"}],staticClass:"h-item select-item h-item-no-padding-top"},[v("label",[m._v(m._s(m.$t("SamplingMethod"))+"\n        "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("WhichATUTPTI"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),m._v(" "),v("el-select",{attrs:{value:m.value.sampler_name,"popper-append-to-body":!0,"popper-class":"custom-select sampler-custom-select"},on:{change:function(e){return m.changeSamplerName(e,"sampler_name")}}},m._l(m.renderTaskSamplerMethods,(function(e,i){return v("el-option",{key:"method_"+i,attrs:{label:e,value:e}},[v("el-tooltip",{attrs:{content:e,placement:"left"}},[v("span",[m._v(m._s(e))])])],1)})),1)],1),m._v(" "),v("slider-item",{directives:[{name:"show",rawName:"v-show",value:m.isShowSteps,expression:"isShowSteps"}],attrs:{value:m.value.steps,min:m.renderStepsOptions.min,max:m.renderStepsOptions.max,label:m.$t("SamplingSteps"),tips:m.$t("HowMTTITGII")},on:{change:function(e){return m.changeConfig(e,"steps")}}}),m._v(" "),v("slider-item",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex&&!(null!==(o=m.top)&&void 0!==o&&o.isStudioSD35Mode),expression:"top.menuIndex !== 'expansion' && !top?.isStudioSD35Mode"}],attrs:{value:m.value.cfg_scale,min:m.renderCFGScale.min,max:m.renderCFGScale.max,step:.5,precision:1,label:m.$t("CFGScale"),tips:m.$t("ClassifierFGSHSTI")},on:{change:function(e){return m.changeConfig(e,"cfg_scale")}}}),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item seed-item h-item-no-padding-top"},[v("div",{staticClass:"flex justify-between items-center"},[v("label",[m._v(m._s(m.$t("Seed"))+"\n          "),v("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("ASendCTOOARNG"),placement:"top-start"}},[v("span",{staticClass:"el-icon-warning custom-tips"})])],1),m._v(" "),m.notSdxl?v("div",{directives:[{name:"show",rawName:"v-show",value:m.showCustomSeed,expression:"showCustomSeed"}],staticClass:"switch-seed flex"},[v("button",{staticClass:"switch-btn",class:{active:"random"===(null===(r=m.value)||void 0===r?void 0:r.seedMode)},on:{click:function(e){return m.changeSeed("random")}}},[m._v("\n            "+m._s(m.$t("Random"))+"\n          ")]),m._v(" "),v("button",{staticClass:"switch-btn",class:{active:"custom"===(null===(l=m.value)||void 0===l?void 0:l.seedMode)},on:{click:function(e){return m.changeSeed("custom")}}},[m._v("\n            "+m._s(m.$t("Customization"))+"\n          ")])]):v("div",{directives:[{name:"show",rawName:"v-show",value:m.showCustomSeed,expression:"showCustomSeed"}],staticClass:"switch-seed flex"},[v("button",{staticClass:"switch-btn",class:{active:"random"===(null===(c=m.value)||void 0===c?void 0:c.seedModesdxl)},on:{click:function(e){return m.changeSeed("random")}}},[m._v("\n            "+m._s(m.$t("Random"))+"\n          ")]),m._v(" "),v("button",{staticClass:"switch-btn",class:{active:"custom"===(null===(d=m.value)||void 0===d?void 0:d.seedModesdxl)},on:{click:function(e){return m.changeSeed("custom")}}},[m._v("\n            "+m._s(m.$t("Customization"))+"\n          ")])])]),m._v(" "),m.notSdxl?v("el-input-number",{attrs:{placeholder:m.seedPlsHd,value:m.value.seed,precision:0,controls:!1,min:-1,max:m.seedOptions.max},on:{input:function(e){return m.useSeed(e)}}}):v("el-input-number",{attrs:{placeholder:m.seedPlsHd,value:m.value.seedsdxl,precision:0,controls:!1,min:-1},on:{input:function(e){return m.useSeed(e)}}}),m._v(" "),m.showImgSeed?v("div",{directives:[{name:"show",rawName:"v-show",value:m.notSdxl,expression:"notSdxl"}],staticClass:"seed-temp",on:{click:function(e){return m.useSeed(m.value.seedTemp)}}},[m._v("\n        "+m._s(m.$t("useImgSeed",{seed:m.value.seedTemp}))+"\n      ")]):m._e(),m._v(" "),m.showImgSeedsdxl?v("div",{directives:[{name:"show",rawName:"v-show",value:!m.notSdxl,expression:"!notSdxl"}],staticClass:"seed-temp",on:{click:function(e){return m.useSeed(m.value.seedTempsdxl)}}},[m._v("\n        "+m._s(m.$t("useImgSeed",{seed:m.value.seedTempsdxl}))+"\n      ")]):m._e()],1),m._v(" "),v("slider-item",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==m.top.menuIndex&&!m.isStudioMode,expression:"top.menuIndex !== 'expansion' && !isStudioMode"}],attrs:{value:m.value.clip_skip,min:1,max:5,label:m.$t("clipSkip"),tips:m.$t("clipSkipTips")},on:{change:function(e){return m.changeConfig(e,"clip_skip")}}}),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:m.isStudioMode&&!(null!==(h=m.top)&&void 0!==h&&h.isStudioSD35Mode),expression:"isStudioMode && !top?.isStudioSD35Mode"}],staticClass:"h-item select-item h-item-no-padding-top",on:{click:function(e){return m.checkNotAllowClick()}}},[v("label",[m._v(m._s(m.$t("SamplingMethod"))+"\n        ")]),m._v(" "),v("el-select",{attrs:{value:m.value.sampler_name,"popper-append-to-body":!0,"popper-class":"custom-select sampler-custom-select"},on:{change:function(e){return m.changeConfig(e,"sampler_name")}}},m._l(m.renderStudioSampler,(function(e,i){return v("el-option",{key:"sampler_name_method_"+i,attrs:{label:e,value:e}},[v("el-tooltip",{attrs:{content:e,placement:"left"}},[v("span",[m._v(m._s(e))])])],1)})),1)],1)],2),m._v(" "),v("style-modal",{ref:"styleModal",attrs:{"model-type":m.selectModelType,"select-list":m.selectIds,isSDXL:!m.isSdModel,inTask:!0,"is-studio-mode":m.isStudioMode},on:{selectModel:m.handleSelectModel}})],1)}),[],!1,null,"2c3de8d9",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3231:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(7);var o=n(2),r=(n(32),n(16),n(8),n(4),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={props:["value"],components:{SliderItem:n(105).default},data:function(){return{isZoom:!0,controlNetOff:!1,controlMode:["Balance","Prompt","Controlnet"]}},inject:["top"],computed:c(c({},Object(r.c)("creation",["taskUnits","taskSdxlUnits"])),{},{taskModules:function(){return this.isSdxl?this.taskSdxlUnits:this.taskUnits},isSdxl:function(){return["5",5,"sdxl","SDXL"].includes(this.value.category)},isStudioMode:function(){return["7",7,"studio",11].includes(this.value.category)},isShowStyleFidelity:function(){var e,t="preview"===this.top.menuIndex;return(null===(e=this.finder)||void 0===e?void 0:e.has_style_fidelity)&&"0"===this.controlnet_item.control_mode&&!t&&!this.isStudioMode},controlnet_item:function(){var e=this.value,t=e.workIndex;return e.controlnet_units[t]},finder:function(){var e=this;return this.taskModules.find((function(t){return e.controlnet_item.type==t.type}))||{}},isShowResolution:function(){var e;return(null===(e=this.finder)||void 0===e?void 0:e.has_processor_res)&&this.controlnet_item.isHandle},control_modules:function(){var e;return null===(e=this.finder)||void 0===e?void 0:e.modules},control_models:function(){var e;return null===(e=this.finder)||void 0===e?void 0:e.models}}),methods:{changeConfig:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=JSON.parse(JSON.stringify(this.value)),r=o.workIndex,l=o.controlnet_units;o.lab_base;"studio"===n&&this.isStudioMode&&["stop_at","weight"].includes(t)?this.top.updateStudioControlNet(e,t,r):("controlnet_processor_res"===t?o[t]=e:l[r][t]=e,this.$emit("input",o))}}},h=d,m=(n(4086),n(0)),component=Object(m.a)(h,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"generate-controlnet handle-item"},[o("div",{staticClass:"item-head",on:{click:function(e){n.isZoom=!n.isZoom}}},[o("label",[o("i",{staticClass:"iconfont icon-kongzhiwang"}),n._v(n._s(n.$t("ControlNet"))+" ")]),n._v(" "),o("i",{staticClass:"el-icon-caret-bottom",class:{zoom:n.isZoom}})]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.isZoom,expression:"isZoom"}],staticClass:"item-content"},[o("div",{staticClass:"h-item select-item"},[o("label",[n._v(n._s(n.$t("Type")))]),n._v(" "),o("div",{staticClass:"el-selects",on:{click:function(e){return e.stopPropagation(),n.top.showControlnetPopup(!0)}}},[n._v("\n        "+n._s(n.$t(n.controlnet_item.type))+"\n        "),o("i",{staticClass:"el-icon-arrow-right"})])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"preview"!==n.top.menuIndex&&!n.isStudioMode,expression:"top.menuIndex !== 'preview' && !isStudioMode"}],staticClass:"h-item radio-item"},[o("label",[n._v(n._s(n.$t("TaskUploadImageMoreSettingPreprocessor")))]),n._v(" "),o("div",{staticClass:"radio-group"},[o("el-radio",{attrs:{value:n.controlnet_item.isHandle,label:!0},on:{input:function(e){return n.changeConfig(e,"isHandle")}}},[n._v(n._s(n.$t("Yes")))]),n._v(" "),o("el-radio",{attrs:{value:n.controlnet_item.isHandle,label:!1},on:{input:function(e){return n.changeConfig(e,"isHandle")}}},[n._v(n._s(n.$t("No")))])],1)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.controlnet_item.isHandle&&!n.isStudioMode,expression:"controlnet_item.isHandle && !isStudioMode"}],staticClass:"h-item select-item"},[o("label",[n._v(n._s(n.$t("ControlPreprocessor")))]),n._v(" "),o("el-select",{attrs:{value:n.controlnet_item.module,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:function(e){return n.changeConfig(e,"module")}}},n._l(n.control_modules,(function(e,i){return o("el-option",{key:"ControlMode_"+i,attrs:{value:e,label:e}},[n._v("\n          "+n._s(e)+"\n        ")])})),1)],1),n._v(" "),"None"==n.controlnet_item.model||"preview"===n.top.menuIndex||n.isStudioMode?n._e():o("div",{staticClass:"h-item select-item"},[o("label",[n._v(n._s(n.$t("ControlPreprocessingModel")))]),n._v(" "),o("el-select",{attrs:{value:n.controlnet_item.model,"popper-class":"custom-select sampler-custom-select","popper-append-to-body":!0},on:{change:function(e){return n.changeConfig(e,"model")}}},n._l(n.control_models,(function(e,i){return o("el-option",{key:"ControlMode_"+i,attrs:{value:e,label:e}},[o("el-tooltip",{attrs:{content:e,placement:"left"}},[o("span",[n._v(n._s(e))])])],1)})),1)],1),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:"preview"!=n.top.menuIndex&&n.isShowResolution&&!n.isStudioMode,expression:"top.menuIndex != 'preview' && isShowResolution && !isStudioMode"}],attrs:{value:n.controlnet_item.processor_res,min:0,max:2048,step:1,label:n.$t("ControlPreprocessorResolution"),tips:n.$t("StyleFidelityTips")},on:{change:function(e){return n.changeConfig(e,"processor_res")}}}),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"preview"!==n.top.menuIndex&&!n.isStudioMode,expression:"top.menuIndex !== 'preview' && !isStudioMode"}],staticClass:"h-item select-item"},[o("label",[n._v(n._s(n.$t("ControlMode")))]),n._v(" "),o("el-select",{attrs:{value:n.controlnet_item.control_mode,"popper-class":"custom-select","popper-append-to-body":!1},on:{change:function(e){return n.changeConfig(e,"control_mode")}}},n._l(n.controlMode,(function(e,i){return o("el-option",{key:"ControlMode_"+i,attrs:{value:String(i),label:n.$t("ControlMode"+e)}},[n._v("\n          "+n._s(n.$t("ControlMode"+e))+"\n        ")])})),1)],1),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isShowStyleFidelity,expression:"isShowStyleFidelity"}],attrs:{value:n.controlnet_item.threshold_a,min:.1,max:1,step:.1,label:n.$t("StyleFidelity"),tips:n.$t("StyleFidelityTips")},on:{change:function(e){return n.changeConfig(e,"threshold_a")}}}),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:"preview"!==n.top.menuIndex&&!n.isStudioMode,expression:"top.menuIndex !== 'preview' && !isStudioMode"}],attrs:{value:n.controlnet_item.weight,min:0,max:2,step:.1,label:n.$t("ControlWeight"),tips:n.$t("ControlWeightTips")},on:{change:function(e){return n.changeConfig(e,"weight")}}}),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:"preview"===n.top.menuIndex&&!n.isStudioMode,expression:"top.menuIndex === 'preview' && !isStudioMode"}],attrs:{value:n.value.controlnet_processor_res,min:512,max:1024,step:1,label:n.$t("ControlPreprocessorResolution"),tips:n.$t("StyleFidelityTips")},on:{change:function(e){return n.changeConfig(e,"controlnet_processor_res")}}}),n._v(" "),n.isStudioMode&&null!==(e=n.value.lab_base)&&void 0!==e&&null!==(e=e.conds)&&void 0!==e&&e.length?o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isStudioMode,expression:"isStudioMode"}],attrs:{value:n.value.lab_base.conds[n.value.workIndex].stop_at,min:0,max:1,step:.001,precision:3,label:"Stop At",tips:n.$t("studio3"),"show-tooltip":!1},on:{change:function(e){return n.changeConfig(e,"stop_at","studio")}}}):n._e(),n._v(" "),n.isStudioMode&&null!==(t=n.value.lab_base)&&void 0!==t&&null!==(t=t.conds)&&void 0!==t&&t.length?o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isStudioMode,expression:"isStudioMode"}],attrs:{value:n.value.lab_base.conds[n.value.workIndex].weight,min:0,max:2,step:.001,precision:3,label:n.$t("studio4"),"show-tooltip":!1,tips:n.$t("ControlWeightTips")},on:{change:function(e){return n.changeConfig(e,"weight","studio")}}}):n._e()],1)])}),[],!1,null,"45b6ca44",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3232:function(e,t,n){"use strict";n.r(t);n(16),n(8);var o={props:["value"],data:function(){return{}},computed:{renderOptions:function(){var e={min:.01,max:1,step:.05};return this.isStudioMode&&(e.min=0),e},isStudioMode:function(){return[7,"7",11].includes(this.value.category)}},methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));n[t]=e,this.$emit("input",n)}}},r=(n(4087),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-image handle-item"},[t("div",{staticClass:"item-head"},[t("label",[t("i",{staticClass:"iconfont icon-shuashua"}),e._v(e._s(e.$t("DenoisingStrength")))])]),e._v(" "),t("div",{staticClass:"item-content slider-item"},[t("el-slider",{attrs:{value:e.value.denoising_strength,min:e.renderOptions.min,max:e.renderOptions.max,step:e.renderOptions.step,"show-input":!0,"show-input-controls":!1},on:{input:function(t){return e.changeConfig(t,"denoising_strength")}}})],1)])}),[],!1,null,"51216f4a",null);t.default=component.exports},3233:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(7);var o=n(68),r=n(3),l=n(14),c=n(2),d=(n(20),n(19),n(32),n(16),n(22),n(49),n(8),n(4),n(1)),h=n(303),m=n(29),v=n(851);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={components:{StyleModal:h.default,LoraList:v.default},props:["value"],inject:["top"],data:function(){return{selectIds:[],modelType:"Checkpoint",extraModelList:[]}},watch:{"value.art_model_no":{handler:function(e){this.setInitModelList(e)},immediate:!0}},computed:_(_({},Object(d.c)("creation",["taskBaseModels","sd_xl_base_model"])),{},{isSdModel:function(){return["5",5].includes(this.value.category)},modelsList:function(){var e=this.value,t=e.art_work_no,n=e.art_model_no,o=e.art_model_ver_no;if(this.isSdModel){var r=this.sd_xl_base_model.map((function(e){var r=e.artwork,l=e.name,c=e.id;return{workId:t!==r.id&&n===c?t:r.id,name:l,id:c,art_model_ver_no:o}}));return[].concat(Object(l.a)(this.extraModelList),Object(l.a)(r))}var c=this.taskBaseModels.map((function(e){var r=e.artwork,l=e.name,c=e.id;return{workId:t!==r.id&&n===c?t:r.id,name:l,id:c,art_model_ver_no:o}}));return[].concat(Object(l.a)(this.extraModelList),Object(l.a)(c))}}),methods:{setInitModelList:function(e){var t=this.value,n=t.art_work_no,o=t.modelName,r=t.art_model_no,l=t.category,c=t.agency_fee,d=void 0===c?0:c;this.extraModelList=[];var h=this.taskBaseModels.some((function(e){return e.id===r}));if(this.isSdModel&&(h=this.sd_xl_base_model.some((function(e){return e.id===r}))),3!==l)if(e)h||(this.extraModelList=[{id:r,name:o,workId:n,agency_fee:d||0}]);else{if(this.isSdModel){var m=(null==this?void 0:this.sd_xl_base_model[0])||{},v=m.name,f=m.artwork,_=void 0===f?{}:f,w=m.id,y=m.art_model_ver_no,C=m.agency_fee,S=void 0===C?0:C;return void this.changeConfig({art_work_no:null==_?void 0:_.id,modelName:v,art_model_no:w,art_model_ver_no:y,agency_fee:S||0})}this.changeConfig({art_work_no:this.taskBaseModels[0].artwork.id,modelName:this.taskBaseModels[0].name,art_model_no:this.taskBaseModels[0].id,art_model_ver_no:this.taskBaseModels[0].art_model_ver_no,agency_fee:this.taskBaseModels[0].agency_fee||0})}},changeLora:function(e,t,n){"DEL"===e?this.deleteModel(t):this.changeWeight(n,t)},changeWeight:function(e,t){var n=this.value.lora_models;n[t].weight=e,this.changeConfig({lora_models:n})},changeConfig:function(e){var t=JSON.parse(JSON.stringify(this.value));t=_(_({},t),e),console.log(e),this.$emit("input",t)},showModelPopup:function(e){var t=this;if(this.modelType=e,"Checkpoint"===e)this.selectIds=[{id:this.value.art_model_no}];else if(this.selectIds=this.value.lora_models,this.value.lora_models.length>=3)return;this.$nextTick((function(){t.$refs.styleModal.openModal()}))},handleSelectModel:function(e){"LORA"===this.modelType?this.selectLoraHandle(e):this.selectModelHandle(e),this.$refs.styleModal.handleClose()},selectModelHandle:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("MoreModel"!==e){n.next=3;break}return t.showModelPopup("Checkpoint"),n.abrupt("return");case 3:return n.next=5,t.getModelInfo(e);case 5:o=n.sent,t.modelsList.some((function(e){return e.id===o.id}))||(t.extraModelList=[o]),t.changeConfig({art_work_no:o.sample_ids?o.sample_ids[0]:o.workId,modelName:o.name,art_model_no:o.id,art_model_ver_no:e.art_model_ver_no||e.model_ver_no||"",agency_fee:(null==e?void 0:e.agency_fee)||0});case 9:case"end":return n.stop()}}),n)})))()},selectLoraHandle:function(e){var t=this.value.lora_models,n=_({model_id:e.id,weight:1},e);t.length>2||(t.push(n),this.changeConfig({lora_models:t}))},viewImage:function(e){var t=this.value.lora_models[e];this.$refs.loraPopup.show(!0,t)},deleteModel:function(e){var t=JSON.parse(JSON.stringify(this.value));t.lora_models.splice(e,1),this.changeConfig({lora_models:t.lora_models})},getModelInfo:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,l,c,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!("object"===Object(o.a)(e))){n.next=17;break}if(!e.sample_ids&&2!==e.publish_status){n.next=6;break}return n.abrupt("return",e);case 6:if(1!==e.publish_status||e.sample_ids){n.next=8;break}return n.abrupt("return",e);case 8:return n.next=10,Object(m.getTaskConfig)({art_model_ver_no:e.model_ver_no});case 10:return r=n.sent,l=r.data,c=l.art_model,d=c.id,h=c.name,v=l.art_work_no,n.abrupt("return",{id:d,name:h,workId:v,art_model_ver_no:e.model_ver_no});case 17:return n.abrupt("return",t.modelsList.find((function(t){return t.id===e})));case 18:case"end":return n.stop()}}),n)})))()}}},y=(n(4094),n(0)),component=Object(y.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"model-handle handle-item"},[t("style-modal",{ref:"styleModal",attrs:{"model-type":e.modelType,"select-list":e.selectIds,isSDXL:e.isSdModel},on:{selectModel:e.handleSelectModel}}),e._v(" "),t("div",{staticClass:"item-head"},[t("label",[t("i",{staticClass:"iconfont icon-moxingicon model-icon title"}),e._v(e._s(e.$t("ModelSetting"))+" ")])]),e._v(" "),t("div",{staticClass:"item-content"},[t("div",{staticClass:"h-item m-item"},[t("div",{staticClass:"item-head"},[t("label",[e._v("\n          "+e._s(e.$t("Model"))+"\n        ")]),e._v(" "),t("el-select",{attrs:{value:e.value.art_model_no,placeholder:"","popper-class":"custom-select","popper-append-to-body":!1},on:{change:e.selectModelHandle}},[e._l(e.modelsList,(function(e,i){return t("el-option",{key:"model_"+i,attrs:{label:e.name,value:e.id}})})),e._v(" "),t("el-option",{attrs:{label:e.$t("selectMoreModel"),value:"MoreModel"}})],2)],1)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==e.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item l-item"},[t("div",{staticClass:"item-head",on:{click:function(t){return e.showModelPopup("LORA",t)}}},[t("label",[e._v("\n          "+e._s(e.$t("LoRA"))+"\n        ")]),e._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:e.value.lora_models.length<3,expression:"value.lora_models.length < 3"}],staticClass:"el-icon-circle-plus"})]),e._v(" "),t("lora-list",{attrs:{list:e.value.lora_models},on:{change:e.changeLora}})],1)])],1)}),[],!1,null,"c7bfd8e4",null);t.default=component.exports},3234:function(e,t,n){"use strict";n.r(t);var o=n(3),r=(n(20),n(1162)),l=n(56),c={components:{ModelBox:r.default},data:function(){return{isShow:!1,loraInfo:{}}},watch:{$route:function(e){this.show(!1)}},methods:{show:function(e,t,n){var r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,data;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r.isShow=e,!t){o.next=8;break}return o.next=4,r.getModelInfo(t,n);case 4:l=o.sent,data=l.data,r.loraInfo=data,r.$set(r,"loraInfo",r.loraInfo);case 8:case"end":return o.stop()}}),o)})))()},getModelInfo:function(e,t){return Object(l.G)({id:e,version_id:t,summary:!0})},handleBeforeClose:function(){this.loraInfo={}}}},d=(n(4091),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"lora-popup custom-dialog",attrs:{visible:e.isShow,top:"20px","append-to-body":!0},on:{"update:visible":function(t){e.isShow=t},close:e.handleBeforeClose}},[t("div",{staticClass:"lora-body"},[e.isShow?t("model-box",{ref:"modelBox",attrs:{modelInfo:e.loraInfo}}):e._e()],1)])}),[],!1,null,"e49a792c",null);t.default=component.exports;installComponents(component,{ModelBox:n(1162).default})},3235:function(e,t,n){"use strict";n.r(t);var o=n(2),r=n(14),l=(n(11),n(19),n(6),n(32),n(16),n(22),n(24),n(8),n(12),n(13),n(4),n(21),n(7),n(105)),c=n(57),d=n(9),h=n(25);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={props:["value"],inject:["top"],components:{SliderItem:l.default},watch:{"value.width":{handler:function(e,t){if(e!==t){var n=5===this.value.category;this.autoFastSelectActive(n?"sdxl":"")}},deep:!0,immediate:!0},"value.sdxl.width":{handler:function(e,t){if(e!==t){var n=5===this.value.category;this.autoFastSelectActive(n?"sdxl":"")}},deep:!0,immediate:!0},"value.studio":{handler:function(e,t){var n=this;this.isStudioMode&&this.$nextTick((function(){n.autoFastSelectStudioActive()}))},deep:!0,immediate:!0},"value.category":function(e){var t=5===this.value.category;this.autoFastSelectActive(t?"sdxl":""),7===e&&3===this.value.imageMode&&this.applyImageMode(2)},currentModelType:{handler:function(e,t){if(e&&e!==t&&this.isStudioMode){var n;if(8===this.studioSelectSize){var o,r=JSON.parse(JSON.stringify(this.value)),l=this.top.updateStudioSize(null===(o=this.value)||void 0===o?void 0:o.base_model_type,r.studio.width,r.studio.height,!0);return Object.assign(r.studio,l),void this.$emit("input",r)}"SD"===this.currentModelType&&(this.studioSelectSize=28),["SDXL","SD3"].includes(this.currentModelType)&&(this.studioSelectSize=41),!this.isStudioFlux&&!this.isStudioSD35||null!==(n=this.value)&&void 0!==n&&n.parent_task_id||(this.studioSelectSize=3),this.applyStudioStyleSize(this.studioSelectSize)}},deep:!0,immediate:!0}},data:function(){return{fastSizeSelectList:d.h,selectSize:1,studioSelectSize:13,sdSelectSize:20,imageModeSelectList:d.p,imageNumsOptions:[{code:1,label:1},{code:2,label:2},{code:3,label:3},{code:4,label:4}],sdxlSizeList:d.i,studioSdList:d.j,studioSdxlList:d.k,studioFluxList:d.l,enhanceMagicSelectList:[{code:1,label:"自动",i18nKey:"studio41"},{code:2,label:"开启",i18nKey:"studio42"},{code:3,label:"关闭",i18nKey:"studio43"}],qualityTypeSelectList:[{code:"anime",label:"动漫",i18nKey:"sdxl_Anime"},{code:"realistic",label:"写实",i18nKey:"realistic"}]}},mounted:function(){"SD"===this.currentModelType&&(this.studioSelectSize=31),["SDXL","SD3"].includes(this.currentModelType)&&(this.studioSelectSize=41)},computed:{getCurrentModelType:function(){var e=(this.value||{}).base_model_type,t=void 0===e?"":e,n=d.L.flux,o=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony"].concat(Object(r.a)(d.L.sdxl)),l=d.L.sd35,c=o.includes(t)||(t||"").includes("SDXL"),h=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"].includes(t),m=n.includes(t)||(t||"").includes("Flux"),v=l.includes(t)||(t||"").includes("SD 3.5");return m?"FLUX":c?"SDXL":h?"SD":"SD 3"===t?"SD3":"Other"===t?"Other":v?"SD 3.5":void 0},isStudioSD35:function(){return["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode&&"SD 3.5"===this.getCurrentModelType},isStudioFlux:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.base_model_type)||void 0===e?void 0:e.includes("Flux"))&&["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode},isSD3:function(){return"SD3"===this.currentModelType},studioRenderOptions:function(){var e={min:512,max:1024};return this.isStudioFlux?{min:384,max:1024}:"SD"===this.currentModelType?e:["SDXL","SD3"].includes(this.currentModelType)?{min:768,max:1536}:e},currentModelType:function(){var e=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony"].concat(Object(r.a)(d.L.sdxl)),t=d.L.sd35,n=this.value.base_model_type,o=void 0===n?"":n,l=e.includes(o)||(o||"").includes("SDXL"),c=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"].includes(o),h=["Flux.1 S","Flux.1 D"].includes(o)||(o||"").includes("Flux"),m=t.includes(o)||(o||"").includes("SD 3.5");return h?"FLUX":l?"SDXL":c?"SD":"SD 3"===o?"SD3":m?"SD 3.5":void 0},fastStudioSize:function(){return this.isStudioMode&&this.isStudioFlux||this.isStudioSD35?this.studioFluxList:this.isStudioMode&&"SD"===this.currentModelType?this.studioSdList:this.isStudioMode&&["SDXL","SD3"].includes(this.currentModelType)?this.studioSdxlList:[]},isStudioMode:function(){return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(this.value.category)},isShowQuantityOfImages:function(){return["textToImage","imageToImage","conditionToImage","expansion"].includes(this.top.menuIndex)},renderImageModeSelectList:function(){return["textToImage"].includes(this.top.menuIndex)?this.imageModeSelectList.filter((function(e){return e.code<=3})):this.imageModeSelectList},imageSizeLabel:function(){return function(e){return 8===e.code?this.$t(e.label):"".concat(e.width,"X").concat(e.height,"   [").concat(this.$t(e.label),"]")}},isSdModel:function(){return!["5",5].includes(this.value.category)},imageMaxSize:function(){if("expansion"===this.top.menuIndex)return 1536;if(this.top.handleModelType&&"sdxl"===this.top.creativeMode)return 1536;var e=this.value.imageMode;return["textToImage"].includes(this.top.menuIndex)&&Number(this.value.imageMode)>=4&&(e=3),this.getMaxSize(e)},autoSetFastSelectList:function(){var e=this,t=this.imageMaxSize;return Object(h.cloneDeep)(this.fastSizeSelectList).map((function(n){if(8===n.code)return n;var o=Object(c.resizeToBaseDimension)(n.width,n.height,t);return"expansion"!==e.top.menuIndex&&(o=JSON.parse(JSON.stringify(null==n?void 0:n.sizeMap[t]))),n.width=o.width,n.height=o.height,n}))},isShowWH:function(){return"expansion"===this.top.menuIndex||8===this.selectSize||!this.isStudioMode&&!this.isSdModel},isSdxlWH:function(){return 8===this.sdSelectSize&&5===this.value.category},isStudioWH:function(){return 8===this.studioSelectSize&&[7,11,"studio"].includes(this.value.category)}},methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));if("styleZoom"===t)return n[t]=e,void this.$emit("input",n);if(this.isSdModel&&!this.isStudioMode&&(n[t]=e),this.isStudioMode&&(["quality_open","quality_detail_offset","quality_mode","quality_type","intelligence_open"].includes(t)?(n.lab_base[t]=e,"quality_mode"===t&&[1,2].includes(e)&&(n.lab_base.scheduler="karras",n.sampler_name="DPM++ 2M Karras",[2].includes(e)&&(n.lab_base.intelligence_open=!0)),"quality_mode"===t&&[1,3].includes(e)&&([3].includes(e)&&(n.lab_base.intelligence_open=!1),n.lab_base.quality_detail_offset=.45)):n.studio[t]=e),this.isSdModel||(n.sdxl[t]=e),"n_iter"===t)for(var i in localStorage.setItem("imageNums",e),this.top.config)this.top.config[i]=v(v({},this.top.config[i]),{},{n_iter:e});else this.$emit("input",n);"quality_mode"===t&&this.$logEvent("log_actions",{operation:"click_anime_enhancement",behavior_info:"on_createflow_page"})},applyStyleSize:function(){var code=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.autoSetFastSelectList.find((function(e){return e.code===code}));if(!["",null,void 0].includes(e)&&8!==code){var t=JSON.parse(JSON.stringify(this.value));t.width=e.width,t.height=e.height,this.$emit("input",t)}},applyStudioStyleSize:function(){var code=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.fastStudioSize.find((function(e){return e.code===code}));if(!["",null,void 0].includes(e)&&8!==code){var t=JSON.parse(JSON.stringify(this.value));t.studio.width=e.width,t.studio.height=e.height,this.$emit("input",t)}},applySdStyleSize:function(){var code=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.sdxlSizeList.find((function(e){return e.code===code}));if(!["",null,void 0].includes(e)&&8!==code){var t=JSON.parse(JSON.stringify(this.value));t.sdxl.width=e.width,t.sdxl.height=e.height,this.$emit("input",t)}},applyImageMode:function(){var e=this,code=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";localStorage.setItem("imageMode",code);var t=this.imageModeSelectList.find((function(e){return e.code===code}));if(!["",null,void 0].includes(t)){var n=JSON.parse(JSON.stringify(this.value));n.realWidth=n.width,n.realHeight=n.height;var o=this.top.handleSize(v(v({},n),{},{imageMode:code})),r=o.width,l=o.height,d=this.getMaxSize(code),m=this.fastSizeSelectList.find((function(t){return t.code===e.selectSize}))||{};if(m=Object(h.cloneDeep)(m),8===this.selectSize)m={width:n.width,height:n.height},m=Object(c.resizeToBaseDimension)(m.width,m.height,d);else{var f,_=(null===(f=m)||void 0===f?void 0:f.sizeMap[d])||{},w=_.width,y=_.height;m.width=w,m.height=y}r=m.width,l=m.height,n.width=r||t.width,n.height=l||t.height,n.imageMode=code,this.$emit("input",n)}},getMaxSize:function(e){return"textToImage"===this.top.menuIndex&&e>3&&(e=3),{1:512,2:768,3:1024,4:1536}[e]||768},autoFastSelectActive:function(e){var t="sdxl"===e?this.sdxlSizeList:this.autoSetFastSelectList,n="sdxl"===e?this.value.sdxl.width:this.value.width,o="sdxl"===e?this.value.sdxl.height:this.value.height,r=t.find((function(e){return e.height===o&&e.width===n}));"sdxl"===e?this.sdSelectSize=(null==r?void 0:r.code)||8:this.selectSize=(null==r?void 0:r.code)||8},autoFastSelectStudioActive:function(){var e=this,t=this.fastStudioSize.find((function(t){return t.height===e.value.studio.height&&t.width===e.value.studio.width}));if(t&&null!=t&&t.code)this.studioSelectSize=null==t?void 0:t.code;else{var n;if("FLUX"===this.currentModelType&&(null===(n=this.value)||void 0===n||!n.parent_task_id))return void(this.studioSelectSize=3);this.studioSelectSize=8}}}},_=f,w=(n(4095),n(4096),n(0)),component=Object(w.a)(_,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"generate-style handle-item"},[n("div",{staticClass:"item-head",on:{click:function(e){return t.changeConfig(!t.value.styleZoom,"styleZoom")}}},[n("label",[n("i",{staticClass:"iconfont icon-setting1"}),t._v(t._s(t.$t("BasicSettings"))+" ")]),t._v(" "),n("i",{staticClass:"el-icon-caret-bottom",class:{zoom:t.value.styleZoom}})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.value.styleZoom,expression:"value.styleZoom"}],staticClass:"item-content"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowQuantityOfImages,expression:"isShowQuantityOfImages"}],staticClass:"fast-size-select select-item"},[n("label",[t._v(t._s(t.$t("QuantityOfImages")))]),t._v(" "),n("el-select",{attrs:{value:t.value.n_iter,placeholder:t.$t("QuantityOfImages"),"popper-class":"custom-select","popper-append-to-body":!0},on:{change:function(e){return t.changeConfig(e,"n_iter")}}},t._l(t.imageNumsOptions,(function(e){return n("el-option",{key:"quantity-of-images"+e.code,attrs:{label:e.label,value:e.code}})})),1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioMode&&t.isSdModel,expression:"!isStudioMode && isSdModel"}],staticClass:"fast-size-select select-item"},[n("label",[t._v(t._s(t.$t("imageMode"))+"\n        ")]),t._v(" "),n("el-select",{attrs:{value:t.value.imageMode,placeholder:t.$t("imageMode"),disabled:"expansion"===t.top.menuIndex,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:t.applyImageMode}},t._l(t.renderImageModeSelectList,(function(e){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:3===e.code&&7!=t.value.category||3!=e.code,expression:"(item.code === 3 && value.category != 7) || item.code != 3"}],key:"image-mode"+e.code,attrs:{label:t.$t(e.label),value:e.code}})})),1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioMode&&t.isSdModel||(null===(e=t.top)||void 0===e?void 0:e.isStudioSD35),expression:"(!isStudioMode && isSdModel) || top?.isStudioSD35"}],staticClass:"fast-size-select select-item"},[n("label",[t._v(t._s(t.$t("imageDimensions")))]),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("AspectRatio"),disabled:"expansion"===t.top.menuIndex,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:t.applyStyleSize},model:{value:t.selectSize,callback:function(e){t.selectSize=e},expression:"selectSize"}},t._l(t.autoSetFastSelectList,(function(e){return n("el-option",{key:"size-select"+e.code,attrs:{label:t.imageSizeLabel(e),value:e.code}})})),1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isStudioMode,expression:"isStudioMode"}],staticClass:"fast-size-select select-item"},[n("label",[t._v(t._s(t.$t("imageDimensions")))]),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("AspectRatio"),disabled:"expansion"===t.top.menuIndex,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:t.applyStudioStyleSize},model:{value:t.studioSelectSize,callback:function(e){t.studioSelectSize=e},expression:"studioSelectSize"}},t._l(t.fastStudioSize,(function(e){return n("el-option",{key:"size-select"+e.code,attrs:{label:t.imageSizeLabel(e),value:e.code}})})),1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isSdModel&&!t.isStudioMode,expression:"!isSdModel && !isStudioMode"}],staticClass:"fast-size-select select-item select-item-sd"},[n("label",[t._v(t._s(t.$t("imageDimensions")))]),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("AspectRatio"),disabled:"expansion"===t.top.menuIndex,"popper-class":"custom-select","popper-append-to-body":!1},on:{change:t.applySdStyleSize},model:{value:t.sdSelectSize,callback:function(e){t.sdSelectSize=e},expression:"sdSelectSize"}},t._l(t.sdxlSizeList,(function(e){return n("el-option",{key:"size-select"+e.code,attrs:{label:t.imageSizeLabel(e),value:e.code}})})),1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isSdxlWH||t.isShowWH&&!t.isStudioMode&&t.isSdModel,expression:"isSdxlWH || (isShowWH && !isStudioMode && isSdModel)"}],staticClass:"size-item"},[n("div",{staticClass:"size-item-label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("width"),placement:"top"}},[n("span",{staticClass:"size-item-label-text"},[t._v(t._s(t.$t("width")))])]),t._v(" "),n("el-input-number",{attrs:{size:"mini",value:t.isSdModel?t.value.width:t.value.sdxl.width,controls:!1,min:128,max:t.imageMaxSize,step:1,disabled:"expansion"===t.top.menuIndex},on:{change:function(e){return t.changeConfig(e,"width")}}})],1),t._v(" "),n("div",{staticClass:"size-item-label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("height"),placement:"top"}},[n("span",{staticClass:"size-item-label-text"},[t._v(t._s(t.$t("height")))])]),t._v(" "),n("el-input-number",{attrs:{size:"mini",value:t.isSdModel?t.value.height:t.value.sdxl.height,controls:!1,min:128,max:t.imageMaxSize,step:1,disabled:"expansion"===t.top.menuIndex},on:{change:function(e){return t.changeConfig(e,"height")}}})],1)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isStudioWH&&t.isStudioMode,expression:"isStudioWH && isStudioMode"}],staticClass:"size-item"},[n("div",{staticClass:"size-item-label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("width"),placement:"top"}},[n("span",{staticClass:"size-item-label-text"},[t._v(t._s(t.$t("width")))])]),t._v(" "),n("el-input-number",{attrs:{size:"mini",value:t.value.studio.width,controls:!1,min:t.studioRenderOptions.min,max:t.studioRenderOptions.max,step:1},on:{change:function(e){return t.changeConfig(e,"width")}}})],1),t._v(" "),n("div",{staticClass:"size-item-label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("height"),placement:"top"}},[n("span",{staticClass:"size-item-label-text"},[t._v(t._s(t.$t("height")))])]),t._v(" "),n("el-input-number",{attrs:{size:"mini",value:t.value.studio.height,controls:!1,min:t.studioRenderOptions.min,max:t.studioRenderOptions.max,step:1},on:{change:function(e){return t.changeConfig(e,"height")}}})],1)])])])}),[],!1,null,"e3a03c2a",null);t.default=component.exports},3236:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(4),n(7);var o=n(2),r=(n(22),n(8),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={components:{SliderItem:n(105).default},props:["value"],name:"HandExtraUpscale",data:function(){return{}},computed:c(c({},Object(r.c)("creation",["taskUpscaler"])),{},{renderUpscaleOptions:function(){return(this.taskUpscaler||[]).map((function(e){return{id:e,name:e}}))}}),methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));n[t]=e,this.$emit("input",n)}}},h=(n(4097),n(0)),component=Object(h.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"handle-extra-upscale handle-item"},[t("div",{staticClass:"item-head"},[t("label",[t("i",{staticClass:"iconfont icon-tupian"}),e._v("\n      "+e._s(e.$t("Upscale"))+"\n    ")])]),e._v(" "),t("div",{staticClass:"item-content"},[t("div",{staticClass:"h-item select-item"},[t("label",[e._v(e._s(e.$t("taskUpscaler")))]),e._v(" "),t("el-select",{attrs:{value:e.value.up_scaler,placeholder:"","popper-class":"custom-select","popper-append-to-body":!1},on:{change:function(t){return e.changeConfig(t,"up_scaler")}}},e._l(e.renderUpscaleOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),t("slider-item",{attrs:{"show-tooltip":!1,value:e.value.scaling_ratio,min:1,max:4,step:.05,label:e.$t("taskScalingRatio")},on:{change:function(t){return e.changeConfig(t,"scaling_ratio")}}})],1)])}),[],!1,null,"41fdf47e",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3237:function(e,t,n){"use strict";n.r(t);n(16);var o={inject:["top"],data:function(){return{}},computed:{isShow:function(){return["imageToImage","conditionToImage","textToImage"].includes(this.top.menuIndex)&&!this.top.isStudioFlux}},methods:{sendParams:function(e){this.$emit("change",e)}}},r=(n(4098),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"sendParams"},["textToImage"!==e.top.menuIndex?t("span",{staticClass:"send-text",on:{click:function(t){return e.sendParams("textToImage")}}},[t("i",{staticClass:"iconfont icon-sendTextBtnIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("sendTextBtn")))])]):e._e(),e._v(" "),"imageToImage"!==e.top.menuIndex?t("span",{staticClass:"send-image",on:{click:function(t){return e.sendParams("imageToImage")}}},[t("i",{staticClass:"iconfont icon-sendImageBtnIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("sendImageBtn")))])]):e._e(),e._v(" "),"conditionToImage"!==e.top.menuIndex?t("span",{staticClass:"send-controlnet",on:{click:function(t){return e.sendParams("conditionToImage")}}},[t("i",{staticClass:"iconfont icon-sendControlNetBtnIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("sendControlNetBtn")))])]):e._e()])}),[],!1,null,"60709046",null);t.default=component.exports},3238:function(e,t,n){"use strict";n.r(t);n(18);var o=n(10),r=n(138),l=n(406),c={name:"modelList",props:["list"],components:{modelPayNum:r.default,changeVerNew:l.default},data:function(){return{}},methods:{handleOpenPopup:function(){try{var e;null===(e=this.$refs.versionPanelSelect)||void 0===e||e.openPopup()}catch(e){}},handleChangeModelVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("updateModelVersionInfo",e)},changeUrl:function(e){return Object(o.K)(e,"high")},changeWeight:function(e,t){this.$emit("change","WEIGHT",t,e)},deleteModel:function(e){this.$emit("change","DEL",e)},viewLora:function(i){var e=this.list[i],t=this.localePath("/models/detail/".concat(e.art_model_no));window.open(t,"_blank")}}},d=c,h=(n(4099),n(0)),component=Object(h.a)(d,(function(){var e,t=this,n=t._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=t.list)||void 0===e?void 0:e.length,expression:"list?.length"}],staticClass:"model-list"},t._l(t.list,(function(img,i){return n("div",{key:"selectMode_"+i,staticClass:"lora-item"},[n("div",{staticClass:"image-box",on:{click:function(e){return t.viewLora(i)}}},[img.banner.url?[n("el-image",{attrs:{src:img.banner&&t.changeUrl(img.banner.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})]),t._v(" "),n("template",{slot:"error"},[n("img",{staticClass:"select-model-image",attrs:{src:img&&img.banner?img.banner.url:"",alt:""}})])],2),t._v(" "),n("div",{staticClass:"version-panel",on:{click:function(e){return e.stopPropagation(),t.handleOpenPopup.apply(null,arguments)}}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:null==img?void 0:img.version_name,placement:"top"}},[n("div",{staticClass:"version-panel-text"},[t._v(t._s(null==img?void 0:img.version_name))])]),t._v(" "),n("div",{staticClass:"version-panel-icon el-icon-caret-bottom"}),t._v(" "),n("change-ver-new",{ref:"versionPanelSelect",refInFor:!0,staticClass:"version-item",staticStyle:{opacity:"0 !important"},attrs:{from:"styleModal",item:img,base_models:[null==img?void 0:img.base_model]},on:{selectItem:t.handleChangeModelVersion}})],1)]:n("p",{staticClass:"empty-img"},[t._v(t._s(t.$t("EmptyBannerText")))])],2),t._v(" "),n("div",{staticClass:"slider slider-item"},[n("p",{staticClass:"lora-name ellipsis",on:{click:function(e){return t.viewLora(i)}}},[t._v(t._s(img.name))])]),t._v(" "),n("span",{staticClass:"select-model-box",on:{click:function(e){return t.deleteModel(i)}}},[n("i",{staticClass:"iconfont icon-select-model-icon delete-icon"}),t._v(" "),n("span",{staticClass:"select-model-box-text"},[t._v(t._s(t.$t("switch")))])])])})),0)}),[],!1,null,"064a62ae",null);t.default=component.exports},3239:function(e,t,n){"use strict";n.r(t);n(49),n(8);var o={name:"ImagePromptsList",components:{SliderItem:n(105).default},inject:["top"],props:{list:{type:Array,default:function(){return[]}},isStudioFlux:{type:Boolean,default:!1}},data:function(){return{paramTemplate:{image:"",stop_at:1,weight:1,mode:"ImagePrompt"}}},methods:{changeConfig:function(e,t,n){this.$emit("update",e,t,n)},deleteParam:function(i){var e=JSON.parse(JSON.stringify(this.list));try{e[i]&&(e.splice(i,1),this.$emit("deleteParam",i))}catch(e){}}}},r=(n(4100),n(0)),component=Object(r.a)(o,(function(){var e,t=this,n=t._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=t.list)||void 0===e?void 0:e.length,expression:"list?.length"}],staticClass:"c-image-prompts-list"},t._l(t.list,(function(e,i){return n("div",{directives:[{name:"loading",rawName:"v-loading",value:null==e?void 0:e.loading,expression:"item?.loading"}],key:"imagePrompts_"+i,staticClass:"image-prompts-list-item"},[n("div",{staticClass:"image-box"},[e.image?n("el-image",{attrs:{src:e.image}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})]),t._v(" "),n("template",{slot:"error"},[n("img",{staticClass:"select-model-image",attrs:{src:e.image?e.image:"",alt:""}})])],2):n("p",{staticClass:"empty-img"},[t._v(t._s(t.$t("EmptyBannerText")))]),t._v(" "),n("span",{staticClass:"delete-icon",on:{click:function(e){return e.stopPropagation(),t.deleteParam(i)}}},[n("i",{staticClass:"el-icon-delete"})])],1),t._v(" "),n("div",{staticClass:"right-params-box",class:[t.isStudioFlux?"right-params-box-row":""]},[n("slider-item",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioFlux,expression:"!isStudioFlux"}],attrs:{value:e.stop_at,min:0,max:1,step:.001,label:"Stop At",tips:t.$t("studio3"),"show-tooltip":!1,precision:3},on:{change:function(e){return t.changeConfig(e,i,"stop_at")}}}),t._v(" "),n("slider-item",{attrs:{value:e.weight,min:0,max:t.isStudioFlux?1:2,step:.001,label:"ImagePrompt"===(null==e?void 0:e.mode)?t.$t("newGenerate66"):t.$t("studio4"),"show-tooltip":!1,precision:3},on:{change:function(e){return t.changeConfig(e,i,"weight")}}})],1)])})),0)}),[],!1,null,"2b0b96ac",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},324:function(e,t,n){"use strict";n.r(t);n(18);var o=n(120),r=n(2),l=n(3),c=(n(20),n(22),n(11),n(6),n(12),n(13),n(8),n(4),n(7),n(83)),d=n(480),h=n(25),m=["nsfw"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={components:{HyUploadMoald:c.default},props:{params:{type:Object,default:function(){}},saveParams:{type:Object,default:function(){}},isEdit:{type:Boolean,default:!1},source:{type:String,default:""}},data:function(){var e;return{form:{title:(null===(e=this.params)||void 0===e?void 0:e.title)||"",cover:{url:"",width:0,height:0}},visible:!0,loading:!1}},watch:{params:{handler:function(e){var t,n,o;this.form.title=(null==e?void 0:e.title)||"",this.form.cover={url:(null==e||null===(t=e.cover)||void 0===t?void 0:t.url)||"",width:(null==e||null===(n=e.cover)||void 0===n?void 0:n.width)||0,height:(null==e||null===(o=e.cover)||void 0===o?void 0:o.height)||0}},immediate:!0}},mounted:function(){this.$xyLogEvent({front_operation:"exposure",entity_name:"note-vitor-edit-detail",entity_type:"note-vitor-edit-detail"})},methods:{handleData:function(){var data=Object(h.groupBy)(this.params.meta.use_image_conditions,"mode");return Object.keys(data).map((function(e){return{mode:e,list:data[e]}}))},handleUploadCover:function(){this.$refs.hyUploadMoald.openModal()},handleDeleteCover:function(){this.form.cover={url:"",width:0,height:0}},handleBeforeUpload:function(e){return!(e.file.size>5242880)||(this.$message.error(this.$t("maxUploadMaterialSize",{size:5})),!1)},handleConfirmResult:function(e){this.form.cover.url=e[0].url,this.form.cover.width=e[0].width,this.form.cover.height=e[0].height},handleSave:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:if(e.loading=!0,t.prev=3,!e.isEdit){t.next=10;break}return t.next=7,Object(d.c)({title:e.form.title,cover:e.form.cover,id:e.params.id,ss:54});case 7:t.t0=t.sent,t.next=13;break;case 10:return t.next=12,Object(d.a)(f(f({},e.params),{},{title:e.form.title,cover:e.form.cover,origin_meta:e.saveParams.meta,source:e.source,used_models:e.params.used_models.map((function(e){var t=(null==e?void 0:e.banner)||{},n=(t.nsfw,Object(o.a)(t,m));return f(f({},e),{},{banner:f({},n)})})),ss:54}));case 12:t.t0=t.sent;case 13:1e4===t.t0.status.code&&(e.$message.success(e.$t("SaveSuccess")),e.$emit("save"));case 15:return t.prev=15,e.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,,15,18]])})))()},getImageMode:function(e){return{img2img:this.$t("ImgToImg"),ctr_net:this.$t("ConditionToImg"),ip_maintain:this.$t("studio46"),style_ref:this.$t("newGenerate79")}[e]||e},handleModelClick:function(e){var path="/models/detail/".concat(e.id);window.open(this.localePath(path),"_blank")}}},w=(n(4292),n(0)),component=Object(w.a)(_,(function(){var e,t,n,o,r,l,c,d=this,h=d._self._c;return h("el-dialog",{staticClass:"editor-container-wrapper",attrs:{visible:d.visible,"close-on-click-modal":!1,"show-close":!1,"append-to-body":!0,width:"50vw",top:"100px"},on:{"update:visible":function(e){d.visible=e}}},[h("div",{staticClass:"editor-container",attrs:{"data-group":"note-vitor-edit-detail"}},[h("div",{staticClass:"editor-header"},[h("div",{staticClass:"editor-title"},[d._v(d._s(d.$t("EditNote")))]),d._v(" "),h("i",{staticClass:"iconfont icon-guanbi1 editor-header-close",on:{click:function(e){return d.$emit("close")}}})]),d._v(" "),h("div",{staticClass:"editor-body"},[h("div",{staticClass:"editor-body-left"},[h("div",{staticClass:"form-item"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("NoteTitle")))]),d._v(" "),h("div",{staticClass:"editor-body-left-input"},[h("el-input",{attrs:{placeholder:d.$t("PleaseEnterNoteTitle"),maxlength:"30","show-word-limit":""},model:{value:d.form.title,callback:function(e){d.$set(d.form,"title",e)},expression:"form.title"}})],1)]),d._v(" "),h("div",{staticClass:"form-item"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("NoteCover")))]),d._v(" "),h("div",{staticClass:"note-cover-wrapper"},[null!==(e=d.form)&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.url?h("div",{staticClass:"note-cover-item"},[h("img",{attrs:{src:null===(t=d.form)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.url,alt:"note-cover"}})]):h("div",{staticClass:"note-cover-item",attrs:{"data-id":"note-cover-upload"},on:{click:d.handleUploadCover}},[h("i",{staticClass:"iconfont icon-a-addimg"}),d._v(" "),h("span",{staticClass:"note-cover-item-text"},[d._v(d._s(d.$t("UploadImage")))])]),d._v(" "),h("div",{staticClass:"delete-cover-btn",attrs:{"data-id":"note-cover-delete"},on:{click:d.handleDeleteCover}},[h("i",{staticClass:"iconfont icon-shanchu5"})])])]),d._v(" "),d.params.meta.prompt?h("div",{staticClass:"form-item"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("Prompt")))]),d._v(" "),h("div",{staticClass:"editor-body-left-prompt"},[d._v(d._s(d.params.meta.prompt))])]):d._e(),d._v(" "),d.params.meta.negative_prompt?h("div",{staticClass:"form-item"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("NegativePrompts")))]),d._v(" "),h("div",{staticClass:"editor-body-left-prompt"},[d._v(d._s(d.params.meta.negative_prompt))])]):d._e()]),d._v(" "),h("div",{staticClass:"editor-body-right"},[h("div",{staticClass:"form-item"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("Model")))]),d._v(" "),h("ul",{staticClass:"model-list-group"},d._l(d.params.used_models,(function(e){return h("li",{key:e.id,staticClass:"model-item",attrs:{"data-id":e.id,"data-event":"note-vitor-model"},on:{click:function(t){return d.handleModelClick(e)}}},[h("div",{staticClass:"model-cover"},[h("img",{attrs:{src:e.banner.url,alt:"model-cover"}})]),d._v(" "),h("div",{staticClass:"model-desc"},[h("div",{staticClass:"model-type"},[d._v("\n                  "+d._s("TextualInversion"===e.model_type?"Embedding":"LoCon"===e.model_type?"LyCORIS":e.model_type)+"\n                ")]),d._v(" "),h("div",{staticClass:"model-name"},[d._v(d._s(e.name))])])])})),0)]),d._v(" "),h("div",{staticClass:"form-item border-bottom"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("BasicParams")))]),d._v(" "),h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v(d._s(d.$t("ImageSize")))]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.width)+"x"+d._s(d.params.meta.height))])])]),d._v(" "),h("div",{staticClass:"form-item border-bottom"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("AdvancedParams")))]),d._v(" "),null!==(n=d.params)&&void 0!==n&&null!==(n=n.meta)&&void 0!==n&&n.sampler_name?h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v("Sampler")]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.sampler_name))])]):d._e(),d._v(" "),null!==(o=d.params)&&void 0!==o&&null!==(o=o.meta)&&void 0!==o&&o.steps?h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v("Steps")]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.steps))])]):d._e(),d._v(" "),null!==(r=d.params)&&void 0!==r&&null!==(r=r.meta)&&void 0!==r&&r.cfg_scale?h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v("CFG Scale")]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.cfg_scale))])]):d._e(),d._v(" "),null!==(l=d.params)&&void 0!==l&&null!==(l=l.meta)&&void 0!==l&&l.vae?h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v("VAE")]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.vae))])]):d._e(),d._v(" "),null!==(c=d.params)&&void 0!==c&&null!==(c=c.meta)&&void 0!==c&&c.clip_skip?h("div",{staticClass:"params-item"},[h("div",{staticClass:"params-item-title"},[d._v("Clip Skip")]),d._v(" "),h("div",{staticClass:"params-item-value"},[d._v(d._s(d.params.meta.clip_skip))])]):d._e()]),d._v(" "),d.handleData().length>0?h("div",{staticClass:"form-item options-wrapper"},[h("div",{staticClass:"editor-body-item-title"},[d._v(d._s(d.$t("ImageOptions")))]),d._v(" "),h("div",{staticClass:"image-options"},d._l(d.handleData(),(function(e){return h("div",{key:e.mode,staticClass:"image-options-item"},[h("div",{staticClass:"image-options-item-title"},[d._v(d._s(d.getImageMode(e.mode)))]),d._v(" "),h("div",{staticClass:"image-options-item-list"},d._l(e.list,(function(e){var t;return h("div",{key:e.id,staticClass:"image-options-item-img"},[h("img",{attrs:{src:e.image.url,alt:"image-options"}}),d._v(" "),null!=e&&null!==(t=e.ctr_net_cond)&&void 0!==t&&t.type?h("div",{staticClass:"image-options-item-img-text"},[d._v("\n                    "+d._s(e.ctr_net_cond.type)+"\n                  ")]):d._e()])})),0)])})),0)]):d._e()])]),d._v(" "),h("div",{staticClass:"editor-footer"},[h("div",{staticClass:"editor-footer-btn",attrs:{"data-event":"note-vitor-detail-cancel"},on:{click:function(e){return d.$emit("close")}}},[d._v("\n        "+d._s(d.$t("Cancel"))+"\n      ")]),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.loading,expression:"loading"}],staticClass:"editor-footer-btn save-btn",attrs:{"data-event":"note-vitor-detail-save"},on:{click:d.handleSave}},[d._v("\n        "+d._s(d.$t("Save"))+"\n      ")])])]),d._v(" "),h("HyUploadMoald",{ref:"hyUploadMoald",attrs:{isSingleSelect:"",category:2,"file-types":["image"],uploadObj:{limit:1,multiple:!1},"before-upload":d.handleBeforeUpload},on:{onConfirm:d.handleConfirmResult}})],1)}),[],!1,null,"2f7412da",null);t.default=component.exports},3240:function(e,t,n){"use strict";n.r(t);var o={name:"handleJumpToOps",inject:["top"],data:function(){return{}},methods:{jumpToOps:function(){var e;null==this||null===(e=this.top)||void 0===e||e.changeMenu("promptStudio")}}},r=(n(4103),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-handle-jump-to-ops handle-item"},[t("div",{staticClass:"h-item l-item"},[t("div",{staticClass:"item-head",on:{click:e.jumpToOps}},[t("label",[t("i",{staticClass:"iconfont icon-book"}),e._v("\n        "+e._s(e.$t("OPS_dictionary")))]),e._v(" "),t("i",{staticClass:"el-icon-circle-plus"})])])])}),[],!1,null,"69af61d9",null);t.default=component.exports},3241:function(e,t,n){"use strict";n.r(t);var o=n(3),r=(n(20),n(16),n(8),n(4),n(28),n(21),n(105)),l=n(29),c={name:"HandleRoop",components:{SliderItem:r.default},props:["value"],inject:["top"],data:function(){return{isShowLink:!1,linkInput:"",uploading:!1,loadingImage:!1,dialogVisible:!1}},methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["face_restorer_visibility","image"].includes(t)?n.roop_arg[t]=e:n[t]=e,["image"].includes(t)&&!["",null,void 0].includes(e)&&(n.restore_faces=!1),this.$emit("input",n)},changeImage:function(e){this.changeConfig(e,"image")},viewBigImage:function(){var e;["",null,void 0].includes(null==this||null===(e=this.value)||void 0===e||null===(e=e.roop_arg)||void 0===e?void 0:e.image)||(this.dialogVisible=!0)},closeViewBigImage:function(){this.dialogVisible=!1},removeImage:function(){this.changeConfig("","image"),this.closeViewBigImage()},handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.top.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(r=e)||r.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(r.size/1024/1024<=5){n.next=12;break}return t.$message.error(t.$t("UploadImageExceed5MB")),n.abrupt("return",!1);case 12:if(!t.uploading){n.next=14;break}return n.abrupt("return");case 14:return t.uploading=!0,o.startUpload(r).then((function(e){t.uploading=!1,t.changeImage(e)})).catch((function(e){console.log(e),t.uploading=!1,t.$message.error(t.$t("uploadError"))})),n.abrupt("return",!1);case 17:case"end":return n.stop()}}),n)})))()},handleLinkUpload:function(){this.checkIsImageURL(this.linkInput)?this.uploadImageByLink(this.linkInput):this.$message.warning(this.$t("InputNotAnImageLink"))},closeLinkUploadModal:function(){this.$refs.linkUploadModal&&this.$refs.linkUploadModal.doClose(),this.linkInput=""},uploadImageByLink:function(){var e=this,t={url:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};this.uploading||(this.uploading=!0,Object(l.uploadImage)(t,"link").then((function(t){var n=(t||{data:{}}).status.code,code=void 0===n?"":n;if([1e4,"10000"].includes(code)){var o=t.data.access_url;e.$emit("imageChange",o),e.closeLinkUploadModal()}else 30003===code?e.$message.error(e.$t("UploadImageExceed5MB")):e.$message.error(e.$t("GainFail"))})).finally((function(t){e.uploading=!1})))},checkIsImageURL:function(e){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(e)},handleBeforeUploadEmpty:function(){}}},d=c,h=(n(4105),n(0)),component=Object(h.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"handle-roop handle-item"},[t("div",{staticClass:"item-head",on:{click:function(t){return e.changeConfig(!e.value.roopZoom,"roopZoom")}}},[t("label",[t("i",{staticClass:"iconfont icon-face-replace-icon"}),e._v("\n      "+e._s(e.$t("RoopLabel"))+"\n    ")]),e._v(" "),t("i",{staticClass:"el-icon-caret-bottom",class:{zoom:e.value.roopZoom}})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value.roopZoom,expression:"value.roopZoom"}],staticClass:"item-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingImage,expression:"loadingImage"}],staticClass:"item-content-image-container"},[e.value.roop_arg.image?[t("img",{staticClass:"roop-target-image",attrs:{src:e.value.roop_arg.image,alt:""}}),e._v(" "),t("div",{staticClass:"image-operate-btn-box"},[t("span",{staticClass:"el-icon-zoom-in image-operate-btn-box-icon",on:{click:function(t){return t.stopPropagation(),e.viewBigImage.apply(null,arguments)}}}),e._v(" "),t("span",{staticClass:"el-icon-delete image-operate-btn-box-icon",on:{click:function(t){return t.stopPropagation(),e.removeImage.apply(null,arguments)}}})])]:[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,"http-request":e.handleBeforeUploadEmpty,"show-file-list":!1}},[t("i",{staticClass:"el-icon-upload image-upload-icon"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n            "+e._s(e.$t("TaskUploadImageDragTips"))),t("em",[e._v(e._s(e.$t("TaskUploadImageClickUploadTips")))])])])]],2),e._v(" "),t("slider-item",{attrs:{value:e.value.roop_arg.face_restorer_visibility,tips:e.$t("RestoreVisibilityTips"),min:.1,max:1,step:.1,label:"Restore Visibility",disabled:"expansion"===e.top.menuIndex},on:{change:function(t){return e.changeConfig(t,"face_restorer_visibility")}}})],1),e._v(" "),e.dialogVisible?t("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":e.closeViewBigImage,"url-list":[e.value.roop_arg.image]}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3242:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(6),n(12),n(13),n(7);var o=n(3),r=n(2),l=(n(20),n(22),n(8),n(4),n(28),n(44),n(105)),c=n(29),d=n(1);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"HandlePromptMagic",components:{SliderItem:l.default},props:["value"],inject:["top"],data:function(){return{isShowLink:!1,linkInput:"",uploading:!1,loadingImage:!1,dialogVisible:!1}},computed:m(m({},Object(d.c)("creation",["promptStyles","studioStyle","lab_styles"])),{},{renderList:function(){var e=this;return(this.promptStyles||[]).map((function(t){var n="sdxl_".concat(t.replace(/\s/g,""));return{label:e.$t(n)||t,id:t}}))},studioRenderList:function(){var e=this;return(this.lab_styles||[]).map((function(t){var n="labStyle_".concat(t.value.replace(/\s/g,""));return{label:e.$t(n)||t.value,id:t.value}}))},isStudioMode:function(){var e;return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(null===(e=this.top.config[this.top.menuIndex])||void 0===e?void 0:e.category)}}),methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["prompt_magic","prompt_style"].includes(t)?n.sdxl[t]=e:["expand_token_length","hdr_enabled","hdr_intensity","auto_brightness_open","auto_brightness_strength"].includes(t)?n.lab_base[t]=e:n[t]=e,this.$emit("input",n)},handleStyleSelectChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=JSON.parse(JSON.stringify(this.value));t.lab_base.style_selections=e,this.$emit("input",t)},changeStudioConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["style"].includes(t)?n.studio[t]=e:n[t]=e,this.$emit("input",n)},changeImage:function(e){this.changeConfig(e,"image")},viewBigImage:function(){var e;["",null,void 0].includes(null==this||null===(e=this.value)||void 0===e||null===(e=e.roop_arg)||void 0===e?void 0:e.image)||(this.dialogVisible=!0)},closeViewBigImage:function(){this.dialogVisible=!1},removeImage:function(){this.changeConfig("","image"),this.closeViewBigImage()},handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.top.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(r=e)||r.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(r.size/1024/1024<=5){n.next=12;break}return t.$message.error(t.$t("UploadImageExceed5MB")),n.abrupt("return",!1);case 12:if(!t.uploading){n.next=14;break}return n.abrupt("return");case 14:return t.uploading=!0,o.startUpload(r).then((function(e){t.uploading=!1,t.changeImage(e)})).catch((function(e){console.log(e),t.uploading=!1,t.$message.error(t.$t("uploadError"))})),n.abrupt("return",!1);case 17:case"end":return n.stop()}}),n)})))()},handleLinkUpload:function(){this.checkIsImageURL(this.linkInput)?this.uploadImageByLink(this.linkInput):this.$message.warning(this.$t("InputNotAnImageLink"))},closeLinkUploadModal:function(){this.$refs.linkUploadModal&&this.$refs.linkUploadModal.doClose(),this.linkInput=""},uploadImageByLink:function(){var e=this,t={url:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};this.uploading||(this.uploading=!0,Object(c.uploadImage)(t,"link").then((function(t){var n=(t||{data:{}}).status.code,code=void 0===n?"":n;if([1e4,"10000"].includes(code)){var o=t.data.access_url;e.$emit("imageChange",o),e.closeLinkUploadModal()}else 30003===code?e.$message.error(e.$t("UploadImageExceed5MB")):e.$message.error(e.$t("GainFail"))})).finally((function(t){e.uploading=!1})))},checkIsImageURL:function(e){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(e)},handleBeforeUploadEmpty:function(){}}},f=v,_=(n(4106),n(4107),n(0)),component=Object(_.a)(f,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"handle-prompt-magic handle-item"},[n("div",{staticClass:"item-head",on:{click:function(e){return t.changeConfig(!t.value.promptMagicZoom,"promptMagicZoom")}}},[n("label",[n("i",{staticClass:"iconfont icon-home_icon_lora"}),t._v(t._s(t.$t("RelatedSettings"))+" ")]),t._v(" "),n("i",{staticClass:"el-icon-caret-bottom",class:{zoom:t.value.promptMagicZoom}})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.value.promptMagicZoom,expression:"value.promptMagicZoom"}],staticClass:"item-content"},[n("slider-item",{directives:[{name:"show",rawName:"v-show",value:null===(e=t.value.lab_base)||void 0===e||null===(e=e.style_selections)||void 0===e?void 0:e.includes("Studio Expand"),expression:"value.lab_base?.style_selections?.includes('Studio Expand')"}],attrs:{value:t.value.lab_base.expand_token_length,min:0,max:100,step:1,precision:0,"show-tooltip":!1,tips:t.$t("studio32"),label:t.$t("studio28")},on:{change:function(e){return t.changeConfig(e,"expand_token_length")}}}),t._v(" "),n("div",{staticClass:"other-style"},[n("label",[t._v("HDR\n        "),n("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:t.$t("studio11"),placement:"top-start"}},[n("span",{staticClass:"el-icon-warning custom-tips"})])],1),t._v(" "),n("el-switch",{attrs:{"active-value":!0,"inactive-value":!1,"active-color":"#3F8CFF"},on:{change:function(e){return t.changeConfig(e,"hdr_enabled")}},model:{value:t.value.lab_base.hdr_enabled,callback:function(e){t.$set(t.value.lab_base,"hdr_enabled",e)},expression:"value.lab_base.hdr_enabled"}})],1),t._v(" "),n("slider-item",{directives:[{name:"show",rawName:"v-show",value:t.value.lab_base.hdr_enabled,expression:"value.lab_base.hdr_enabled"}],attrs:{value:t.value.lab_base.hdr_intensity,min:0,max:2,step:.01,"show-tooltip":!1,precision:2,label:t.$t("studio7")},on:{change:function(e){return t.changeConfig(e,"hdr_intensity")}}}),t._v(" "),n("div",{staticClass:"other-style"},[n("label",[t._v(t._s(t.$t("studio8"))+"\n        "),n("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:t.$t("studio10"),placement:"top-start"}},[n("span",{staticClass:"el-icon-warning custom-tips"})])],1),t._v(" "),n("el-switch",{attrs:{"active-value":!0,"inactive-value":!1,"active-color":"#3F8CFF"},on:{change:function(e){return t.changeConfig(e,"auto_brightness_open")}},model:{value:t.value.lab_base.auto_brightness_open,callback:function(e){t.$set(t.value.lab_base,"auto_brightness_open",e)},expression:"value.lab_base.auto_brightness_open"}})],1),t._v(" "),n("slider-item",{directives:[{name:"show",rawName:"v-show",value:t.value.lab_base.auto_brightness_open,expression:"value.lab_base.auto_brightness_open"}],attrs:{value:t.value.lab_base.auto_brightness_strength,min:0,max:100,step:1,precision:0,"show-tooltip":!1,label:t.$t("studio27")},on:{change:function(e){return t.changeConfig(e,"auto_brightness_strength")}}})],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.value.promptMagicZoom,expression:"value.promptMagicZoom"}],staticClass:"item-content"},[n("slider-item",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioMode,expression:"!isStudioMode"}],attrs:{value:t.value.base_ratio,min:.5,max:1,step:.1,"show-tooltip":!1,precision:1,label:t.$t("baseSamplingRatio"),disabled:"expansion"===t.top.menuIndex},on:{change:function(e){return t.changeConfig(e,"base_ratio")}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioMode,expression:"!isStudioMode"}],staticClass:"other-style"},[n("label",[t._v(t._s(t.$t("predictMode")))]),t._v(" "),n("el-switch",{attrs:{"active-value":"gaussian","inactive-value":"none","active-color":"#3F8CFF"},on:{change:function(e){return t.changeConfig(e,"predict_mode")}},model:{value:t.value.predict_mode,callback:function(e){t.$set(t.value,"predict_mode",e)},expression:"value.predict_mode"}})],1),t._v(" "),n("slider-item",{directives:[{name:"show",rawName:"v-show",value:!t.isStudioMode&&"none"!==t.value.predict_mode,expression:"!isStudioMode && value.predict_mode !== 'none'"}],attrs:{value:t.value.predict_strength,min:.1,max:1,step:.01,"show-tooltip":!1,precision:2,label:t.$t("predictStrength"),disabled:"expansion"===t.top.menuIndex},on:{change:function(e){return t.changeConfig(e,"predict_strength")}}})],1)])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3243:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(6),n(12),n(13),n(7);var o=n(14),r=n(2),l=(n(19),n(22),n(8),n(4),n(1)),c=n(853),d=n(852),h=n(105),m=n(303),v=n(10);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={name:"HandleAdvanceRepair",props:["value"],inject:["top"],components:{HandleHRepair:c.default,HandleCharacterRepair:d.default,SliderItem:h.default,StyleModal:m.default},data:function(){return{selectList:[{code:1,label:"1x"},{code:1.5,label:"1.5x"},{code:2,label:"2x"},{code:2.5,label:"2.5x"}],characterRepairSelectList:[{code:"",i18nKey:"none"},{code:"face",i18nKey:"repairType1"},{code:"hand",i18nKey:"repairType2"},{code:"body",i18nKey:"repairType3"}]}},computed:_(_({},Object(l.c)("creation",["hr_upscaler"])),{},{isOpenUpscale:function(){return""!==this.value.hr_upscaler},isOpenCharacterRepair:function(){return""!==this.value.ad_model},isShowLora:function(){var e;return null===(e=Object.keys(this.selectLora))||void 0===e?void 0:e.length},selectLora:function(){return this.value.ad_units.lora||{}},isSdModel:function(){return[5,"5","sdxl"].includes(this.value.category)},isShowCharacterRepair:function(){var e=this.top.menuIndex;return["imageToImage","textToImage","characterRepair"].includes(e)&&!this.isStudioMode&&!this.isSdModel},isStudioMode:function(){var e;return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(null===(e=this.top.config[this.top.menuIndex])||void 0===e?void 0:e.category)},isShowHRepair:function(){return["textToImage"].includes(this.top.menuIndex)&&[1,"1"].includes(this.value.category)&&!this.isStudioMode},isFastSelectActive:function(){return function(e){return e.code===this.value.hr_scale}},computedScaleSize:function(){var e=this.value.hr_scale||2;return"".concat(this.value.width*e,"x").concat(this.value.height*e)},renderList:function(){var e=(this.hr_upscaler||[]).map((function(e){return{label:e,code:e}}));return[{code:"",label:this.$t("none")}].concat(Object(o.a)(e))}}),methods:{showLoraPopup:function(){this.$refs.styleModal.openModal()},handleSelectLora:function(e){this.changeConfig(_(_({},e),{},{weights:.5}),"lora"),this.$refs.styleModal.handleClose()},changeWeights:function(e){this.changeConfig(_(_({},this.value.ad_units.lora),{},{weights:e}),"lora")},deleteSelectedLora:function(){var e=JSON.parse(JSON.stringify(this.value));try{e.ad_units.lora={},e.ad_units.lora_models=[],this.$emit("input",e)}catch(e){console.log(e)}},changeUrl:function(e){return Object(v.K)(e,"high")},changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["lora","ad_denoising_strength","ad_confidence","prompt","negative_prompt"].includes(t)?n.ad_units[t]=e:("hr_upscaler"===t&&(n.enable_hr=""!==e),n[t]=e),this.$emit("input",n)},applyStyleSize:function(e){var t=e.code;[t*this.value.width,t*this.value.height].some((function(e){return e&&e>2048}))&&(t=2);var n=JSON.parse(JSON.stringify(this.value));n.hr_scale=t,this.$emit("input",n)}}},y=(n(4109),n(0)),component=Object(y.a)(w,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"handle-advance-repair handle-item"},[o("div",{staticClass:"item-head",on:{click:function(e){return n.changeConfig(!n.value.advanceRepairZoom,"advanceRepairZoom")}}},[o("label",[o("i",{staticClass:"iconfont icon-character-repair-icon1"}),n._v("\n      "+n._s(n.$t("AdvancedRepair"))+"\n    ")]),n._v(" "),o("i",{staticClass:"el-icon-caret-bottom",class:{zoom:n.value.advanceRepairZoom}})]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.value.advanceRepairZoom&&n.isShowHRepair,expression:"value.advanceRepairZoom && isShowHRepair"}],staticClass:"item-content",class:[n.isOpenUpscale?"item-content-spacial":""]},[o("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==n.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item select-item"},[o("label",[n._v(n._s(n.$t("taskTabUpscale")))]),n._v(" "),o("el-select",{attrs:{value:n.value.hr_upscaler,"popper-append-to-body":!0,"popper-class":"custom-select vae-custom-select"},on:{change:function(e){return n.changeConfig(e,"hr_upscaler")}}},n._l(n.renderList,(function(e,i){return o("el-option",{key:"method_"+i,attrs:{label:e.label,value:e.code}},[o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.label,placement:"top-start"}},[o("span",[n._v(n._s(e.label))])])],1)})),1)],1),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isOpenUpscale,expression:"isOpenUpscale"}],attrs:{value:n.value.hr_second_pass_steps,min:1,max:60,step:1,label:n.$t("UpscaleSamplingTimes"),"show-tooltip":!1},on:{change:function(e){return n.changeConfig(e,"hr_second_pass_steps")}}}),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isOpenUpscale,expression:"isOpenUpscale"}],attrs:{value:n.value.hr_upscaler_redraw,min:0,max:1,step:.1,label:n.$t("RedrawNoiseIntensity"),"show-tooltip":!1},on:{change:function(e){return n.changeConfig(e,"hr_upscaler_redraw")}}})],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.value.advanceRepairZoom&&n.isShowCharacterRepair,expression:"value.advanceRepairZoom && isShowCharacterRepair"}],staticClass:"item-content",class:[n.isOpenCharacterRepair?"item-content-spacial":""]},[o("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==n.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item select-item",class:[""!==n.value.ad_model?"h-item-spacial-border":""]},[o("label",[n._v("\n        "+n._s(n.$t("characterRepair"))+"\n        "),o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:n.$t("characterRepairTips"),placement:"top-start"}},[o("span",{staticClass:"el-icon-warning custom-tips"})])],1),n._v(" "),o("el-select",{attrs:{value:n.value.ad_model,"popper-append-to-body":!0,"popper-class":"custom-select vae-custom-select"},on:{change:function(e){return n.changeConfig(e,"ad_model")}}},n._l(n.characterRepairSelectList,(function(e,i){return o("el-option",{key:"method_"+i,attrs:{label:n.$t(e.i18nKey),value:e.code}},[o("el-tooltip",{attrs:{content:n.$t(e.i18nKey),placement:"top"}},[o("span",[n._v(n._s(n.$t(e.i18nKey)))])])],1)})),1)],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.isOpenCharacterRepair,expression:"isOpenCharacterRepair"}],staticClass:"h-item l-item"},[o("div",{staticClass:"item-head",on:{click:function(e){return n.showLoraPopup()}}},[o("label",[n._v("\n          "+n._s(n.$t("LoRA"))+"\n        ")]),n._v(" "),n.isShowLora?n._e():o("i",{staticClass:"el-icon-circle-plus"})]),n._v(" "),n.isShowLora?o("div",{staticClass:"item-lora"},[null!==(e=n.selectLora)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.url?o("el-image",{attrs:{src:n.changeUrl(n.selectLora.banner.url)}},[o("template",{slot:"placeholder"},[o("i",{staticClass:"el-icon-loading image-loading"})])],2):o("p",{staticClass:"empty-img"},[n._v(n._s(n.$t("EmptyBannerText")))]),n._v(" "),o("div",{staticClass:"right"},[o("div",{staticClass:"top"},[o("div",{staticClass:"name",attrs:{title:n.selectLora.name}},[n._v(n._s(n.selectLora.name))]),n._v(" "),o("i",{staticClass:"el-icon-delete",on:{click:function(e){return n.deleteSelectedLora()}}})]),n._v(" "),o("div",{staticClass:"bottom"},[o("el-slider",{staticClass:"slider-item",attrs:{value:n.selectLora.weights,min:-2,max:2,step:.1,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(e){return n.changeWeights(e)}}})],1)])],1):n._e()]),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isOpenCharacterRepair,expression:"isOpenCharacterRepair"}],attrs:{value:n.value.ad_units.ad_denoising_strength,min:0,max:.5,step:.05,label:n.$t("redrawingNoiseIntensity"),"show-tooltip":!1},on:{change:function(e){return n.changeConfig(e,"ad_denoising_strength")}}}),n._v(" "),o("slider-item",{directives:[{name:"show",rawName:"v-show",value:n.isOpenCharacterRepair,expression:"isOpenCharacterRepair"}],attrs:{value:n.value.ad_units.ad_confidence,min:0,max:1,step:.1,label:n.$t("Confidence"),"show-tooltip":!1},on:{change:function(e){return n.changeConfig(e,"ad_confidence")}}}),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.isOpenCharacterRepair,expression:"isOpenCharacterRepair"}],staticClass:"h-item input-item h-item-spacial"},[o("label",[n._v(n._s(n.$t("Prompt")))]),n._v(" "),o("el-input",{staticClass:"custom-input",attrs:{value:n.value.ad_units.prompt,type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},on:{input:function(e){return n.changeConfig(e,"prompt")}}})],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.isOpenCharacterRepair,expression:"isOpenCharacterRepair"}],staticClass:"h-item input-item h-item-spacial"},[o("label",[n._v(n._s(n.$t("NegativePrompts")))]),n._v(" "),o("el-input",{staticClass:"custom-input",attrs:{value:n.value.ad_units.negative_prompt,type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},on:{input:function(e){return n.changeConfig(e,"negative_prompt")}}})],1)],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.value.advanceRepairZoom&&!["expansion","characterRepair"].includes(n.top.menuIndex)&&!n.isSdModel&&!n.isStudioMode,expression:"\n      value.advanceRepairZoom &&\n      !['expansion', 'characterRepair'].includes(top.menuIndex) &&\n      !isSdModel &&\n      !isStudioMode\n    "}],staticClass:"item-content"},[o("div",{staticClass:"other-style"},[o("label",[n._v(n._s(n.$t("RestoreFaces")))]),n._v(" "),o("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:function(e){return n.changeConfig(e,"restore_faces")}},model:{value:n.value.restore_faces,callback:function(e){n.$set(n.value,"restore_faces",e)},expression:"value.restore_faces"}})],1)]),n._v(" "),o("style-modal",{ref:"styleModal",attrs:{"model-type":"LORA","select-list":null!==(t=n.selectLora)&&void 0!==t&&t.id?[n.selectLora.id]:[],isSDXL:n.isSdModel,inTask:!0,"hide-embedding":!0},on:{selectModel:n.handleSelectLora}})],1)}),[],!1,null,"3deb0972",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3244:function(e,t,n){"use strict";n.r(t);var o=n(3),r=(n(20),n(16),n(18),n(8),n(4),n(28),n(21),n(44),n(105)),l=n(57),c=n(29),d=n(61),h={name:"HandleFaceSwap",components:{SliderItem:r.default},props:["value"],inject:["top"],data:function(){return{isShowLink:!1,linkInput:"",uploading:!1,loadingImage:!1,dialogVisible:!1}},methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["face_distance","source_uri"].includes(t)?n.exchange_face[t]=e:n[t]=e,["source_uri"].includes(t)&&!["",null,void 0].includes(e)&&(n.restore_faces=!1),this.$emit("input",n)},changeImage:function(e){this.changeConfig(e,"source_uri")},viewBigImage:function(){var e;["",null,void 0].includes(null==this||null===(e=this.value)||void 0===e||null===(e=e.exchange_face)||void 0===e?void 0:e.source_uri)||(this.dialogVisible=!0)},closeViewBigImage:function(){this.dialogVisible=!1},removeImage:function(){this.changeConfig("","source_uri"),this.closeViewBigImage()},handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.top.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(r=e)||r.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(!(r.size/1024/1024>10)){n.next=19;break}return n.prev=9,n.next=12,Object(d.a)(r,10485760);case 12:r=n.sent,n.next=19;break;case 15:return n.prev=15,n.t0=n.catch(9),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 19:if(!t.uploading){n.next=21;break}return n.abrupt("return");case 21:return t.uploading=!0,o.startUpload(r,{category:16}).then((function(e){t.uploading=!1,t.changeImage(e)})).catch((function(e){console.log(e),t.uploading=!1,t.$message.error(t.$t("uploadError"))})),n.abrupt("return",!1);case 24:case"end":return n.stop()}}),n,null,[[9,15]])})))()},preprocessingImages:function(e){return new Promise((function(t,n){var o=new FileReader;o.addEventListener("load",(function(){var image=new Image;image.addEventListener("load",(function(){var canvas=document.createElement("canvas");canvas.width=image.width,canvas.height=image.height,canvas.getContext("2d").drawImage(image,0,0,canvas.width,canvas.height);var n=canvas.toDataURL("image/png",1),o=Object(l.dataURItoBlob)(n),r=new File([o],e.name.replace(/\.\w+$/,".png"),{type:"image/png"});t(r)})),image.src=o.result})),o.addEventListener("error",(function(){console.log("Failed to read the file."),n(new Error("Failed to read the file."))})),o.readAsDataURL(e)})).catch((function(e){return Promise.reject(new Error("Failed to convert the image to PNG format."))}))},handleLinkUpload:function(){this.checkIsImageURL(this.linkInput)?this.uploadImageByLink(this.linkInput):this.$message.warning(this.$t("InputNotAnImageLink"))},closeLinkUploadModal:function(){this.$refs.linkUploadModal&&this.$refs.linkUploadModal.doClose(),this.linkInput=""},uploadImageByLink:function(){var e=this,t={url:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};this.uploading||(this.uploading=!0,Object(c.uploadImage)(t,"link").then((function(t){var n=(t||{data:{}}).status.code,code=void 0===n?"":n;if([1e4,"10000"].includes(code)){var o=t.data.access_url;e.$emit("imageChange",o),e.closeLinkUploadModal()}else 30003===code?e.$message.error(e.$t("UploadImageExceed5MB")):e.$message.error(e.$t("GainFail"))})).finally((function(t){e.uploading=!1})))},checkIsImageURL:function(e){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(e)},handleBeforeUploadEmpty:function(){}}},m=h,v=(n(4110),n(0)),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"handle-face-swap handle-item"},[t("div",{staticClass:"item-head",on:{click:function(t){return e.changeConfig(!e.value.faceSwapZoom,"faceSwapZoom")}}},[t("label",[t("i",{staticClass:"iconfont icon-face-replace-icon"}),e._v("\n      "+e._s(e.$t("RoopLabel"))+"\n    ")]),e._v(" "),t("i",{staticClass:"el-icon-caret-bottom",class:{zoom:e.value.faceSwapZoom}})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value.faceSwapZoom,expression:"value.faceSwapZoom"}],staticClass:"item-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingImage,expression:"loadingImage"}],staticClass:"item-content-image-container"},[e.value.exchange_face.source_uri?[t("img",{staticClass:"roop-target-image",attrs:{src:e.value.exchange_face.source_uri,alt:""}}),e._v(" "),t("div",{staticClass:"image-operate-btn-box"},[t("span",{staticClass:"el-icon-zoom-in image-operate-btn-box-icon",on:{click:function(t){return t.stopPropagation(),e.viewBigImage.apply(null,arguments)}}}),e._v(" "),t("span",{staticClass:"el-icon-delete image-operate-btn-box-icon",on:{click:function(t){return t.stopPropagation(),e.removeImage.apply(null,arguments)}}})])]:[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,"http-request":e.handleBeforeUploadEmpty,"show-file-list":!1}},[t("i",{staticClass:"el-icon-upload image-upload-icon"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n            "+e._s(e.$t("TaskUploadImageDragTips"))),t("em",[e._v(e._s(e.$t("TaskUploadImageClickUploadTips")))])])])]],2)]),e._v(" "),e.dialogVisible?t("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":e.closeViewBigImage,"url-list":[e.value.exchange_face.image]}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports},3245:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(2),r=(n(8),n(105)),l=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var d={props:["value"],components:{SliderItem:r.default},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(l.c)("creation",["animationLoraRecommends"])),data:function(){return{visible:!1,cover:"",timeList:[{label:this.$t("shortVersion"),value:0},{label:this.$t("longVersion"),value:1}]}},methods:{sliderChange:function(e){var t=JSON.parse(JSON.stringify(this.value));t.animatediff.weight=e,this.$emit("input",t)},timeChange:function(e){var t=JSON.parse(JSON.stringify(this.value));t.animatediff.category=e,this.$emit("input",t)},setModel:function(e){this.cover=e.url;var t=JSON.parse(JSON.stringify(this.value));t.animatediff.weight=1,t.animatediff.lora=e.value,this.$emit("input",t),this.visible=!1},deleteModel:function(){var e=JSON.parse(JSON.stringify(this.value));e.animatediff.lora="",this.$emit("input",e)}}},h=d,m=(n(4111),n(4112),n(0)),component=Object(m.a)(h,(function(){var e,t,n,o=this,r=o._self._c;return r("div",{staticClass:"HandleAnimGen"},[r("div",{staticClass:"title"},[r("i",{staticClass:"iconfont icon-AnimGenIcon"}),o._v(" "),r("span",[o._v(o._s(o.$t("AnimGen")))])]),o._v(" "),r("div",{staticClass:"modelBox"},[r("div",{staticClass:"modelTit",on:{click:function(e){o.visible=!0}}},[r("span",{staticClass:"titTxt"},[o._v("MotionLoRA")]),o._v(" "),null!==(e=o.value.animatediff)&&void 0!==e&&e.lora?r("div",[r("i",{staticClass:"iconfont icon-select-model-icon"}),o._v(" "),r("span",[o._v(o._s(o.$t("switch")))])]):r("i",{staticClass:"el-icon-circle-plus"})]),o._v(" "),null!==(t=o.value.animatediff)&&void 0!==t&&t.lora?r("div",{staticClass:"modelInfo"},[r("video",{attrs:{src:this.cover,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}),o._v(" "),r("div",[r("div",{staticClass:"indModelName"},[r("span",[o._v(o._s(null===(n=o.value.animatediff)||void 0===n?void 0:n.lora))]),o._v(" "),r("i",{staticClass:"el-icon-delete",on:{click:o.deleteModel}})]),o._v(" "),r("div",{staticClass:"item-content slider-item"},[r("el-slider",{attrs:{min:-1,max:2,step:.05,"show-input":!0,"show-input-controls":!1},on:{change:o.sliderChange},model:{value:o.value.animatediff.weight,callback:function(e){o.$set(o.value.animatediff,"weight",e)},expression:"value.animatediff.weight"}})],1)])]):o._e()]),o._v(" "),r("div",{staticClass:"select-item"},[r("label",[o._v(o._s(o.$t("animDur")))]),o._v(" "),r("el-select",{attrs:{"popper-class":"custom-select","popper-append-to-body":!1},on:{change:o.timeChange},model:{value:o.value.animatediff.category,callback:function(e){o.$set(o.value.animatediff,"category",e)},expression:"value.animatediff.category"}},o._l(o.timeList,(function(e){return r("el-option",{key:e.item,attrs:{label:e.label,value:e.value}})})),1)],1),o._v(" "),r("el-dialog",{attrs:{visible:o.visible,"custom-class":"styleModal",width:"1376px",title:"MotionLoRA","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){o.visible=e}}},[r("div",{staticClass:"modelList"},o._l(o.animationLoraRecommends,(function(e){var t,n;return r("div",{key:e.value,staticClass:"modelItem",class:{modelItemA:(null===(t=o.value.animatediff)||void 0===t?void 0:t.lora)==e.value},on:{click:function(t){return o.setModel(e)}}},[r("video",{style:{transform:(null===(n=o.value.animatediff)||void 0===n?void 0:n.lora)==e.value?"scale(0.8)":""},attrs:{src:e.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}),o._v(" "),r("div",{staticClass:"modelName"},[o._v(o._s(e.value))])])})),0)])],1)}),[],!1,null,"2e0065fe",null);t.default=component.exports},3246:function(e,t,n){"use strict";n.r(t);n(19),n(11),n(6),n(12),n(13),n(7);var o=n(2),r=(n(16),n(8),n(4),n(26),n(3247)),l=n(3248),c=n(3251),d=n(3440),h=n(29),m=n(85),v=n(3253),f=n(1);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={components:{CUploadBox:r.default,CUploadView:l.default,PromptStudio:d.default,CWorkTab:v.default,CAnimView:c.default},props:["value","menuIndex"],inject:["top"],data:function(){return{pollingTimer:null}},computed:w(w(w({},Object(f.c)("user",["accountSettingsData","isCompanyAccount"])),Object(f.e)("payment",["paymentInfo"])),{},{showGenerateBtn:function(){return["animGen","extraUpscale","descriptors","preview","faceSwap","characterRepair"].includes(this.menuIndex)},showPromptStudio:function(){return"promptStudio"===this.menuIndex},imageUrl:function(){var e=this.value,t=e.imageUrl;return t[e.workIndex]},isShowTab:function(){return["conditionToImage","imageToImage"].includes(this.menuIndex)},controlNetList:function(){var e=this.top;return e.config[e.menuIndex].controlnet_units},isVip:function(){var e=this.paymentInfo,t=e.activeState,n=e.liteActiveState,o=e.isCompanyAccount;return t||n||o}}),watch:{"value.imageUrl":function(e,t){var n=this.value.workIndex;e[n]&&e[n]!==t[n]?this.imageReadInfo():this.$refs.cUploadView&&(this.$refs.cUploadView.backfillMaskUrl="")}},methods:{setExpend:function(){var e=1,t=Math.max(this.value.realWidth,this.value.realHeight);"extraUpscale"===this.top.menuIndex&&(t*=this.value.scaling_ratio);var n,o;([{min:1024,max:1536,value:1},{min:1536,max:2048,value:3},{min:2048,max:2560,value:4},{min:2560,max:3072,value:6},{min:3072,max:3584,value:8},{min:3584,max:4096,value:10}].forEach((function(n){t>n.min&&t<=n.max&&(e=n.value||2)})),t>4096&&(e=10),"faceSwap"===this.top.menuIndex&&(e=3),"descriptors"===this.top.menuIndex&&(e=1),"preview"===this.top.menuIndex&&(e=1),"animGen"===this.top.menuIndex)&&(e=30,1==(null===(n=this.value.animatediff)||void 0===n?void 0:n.category)&&(e=50));"characterRepair"===this.top.menuIndex&&(e=null!==(o=this.value)&&void 0!==o&&null!==(o=o.imgFiles[3])&&void 0!==o&&o.file?this.characterRepairToolCost():2,3===this.value.speed_type&&(e=0));return e},characterRepairToolCost:function(){var e,t,n=2,o=Math.max((null==this||null===(e=this.value)||void 0===e?void 0:e.realWidth)||0,(null==this||null===(t=this.value)||void 0===t?void 0:t.realHeight)||0);return[{min:0,max:512,value:1},{min:512,max:768,value:2},{min:768,max:1024,value:4}].forEach((function(e){o>e.min&&o<=e.max&&(n=e.value)})),o>1024&&(n=4),0===o&&(n=2),n},changeImage:function(img,e){var t=this.value,n=t.imageUrl,o=t.imgFiles,r=t.workIndex;console.log(n,o,r,e);var l=void 0===e?r:e,c=JSON.parse(JSON.stringify(n)),d=JSON.parse(JSON.stringify(o)),h={left_margin:-1,up_margin:-1};c[l]=null==img?void 0:img.url,h.imageUrl=c,d[l]||(d[l]={}),d[l].file=null==img?void 0:img.file,d[l].uploading=null==img?void 0:img.uploading,h.imgFiles=d,this.showGenerateBtn?h.generateing=Boolean(null==img?void 0:img.uploading):h.generateing=!0,null!=img&&img.url||null!=img&&img.file||(h.mask="",h.tempMask="",h.copyMask="",h.keepDenoisingStrength=!1,h.generateing=!1);var m=JSON.parse(JSON.stringify(this.value));5===this.value.category&&h.width?(m.sdxl.width=h.width,m.sdxl.height=h.height,m.realWidth=h.realWidth,m.realHeight=h.realHeight):m=w(w({},m),h),this.$emit("input",m)},toolEvent:function(e,t){switch(e){case"DELETE":this.deleteImage();break;case"SET_SIZE":this.saveImageInfo(this.value.isCopy?{isCopy:!1,realWidth:t.realWidth,realHeight:t.realHeight}:t)}},clearExtraInfo:function(){var e;["extraUpscale"].includes(this.top.menuIndex)&&(null==this||null===(e=this.top)||void 0===e||e.clearExtraImageMeta())},deleteImage:function(){var e,t=this.value;if(null!==(e=t.imgFiles[t.workIndex])&&void 0!==e&&e.uploading)return this.$message.warning(this.$t("pleaseUoloadImage")),!1;this.clearExtraInfo(),this.$refs.cUploadView&&(this.$refs.cUploadView.backfillMaskUrl=""),this.changeImage({url:"",file:"",uploading:!1}),3===this.value.action&&this.top.resetCurrentAction(),this.top.setUploadImageStatus(this.menuIndex,!1)},animSetWork:function(e){if(e){var t={action:24,art_work_no:e.id,meta:e.meta};this.$emit("animSetWork",t)}else{JSON.parse(JSON.stringify(this.value)).prompt=""}},saveImageInfo:function(e){var t=JSON.parse(JSON.stringify(this.value));if(t.isUploadImage||null==e||!e.width||"extraUpscale"===this.menuIndex){if(5===this.value.category&&e.width)t.sdxl.width=e.width,t.sdxl.height=e.height,t.realWidth=e.realWidth,t.realHeight=e.realHeight;else if([7,11,"studio"].includes(this.value.category)&&e.width){var n;t.realWidth=e.realWidth,t.realHeight=e.realHeight;var o=this.top.updateStudioSize(null===(n=t)||void 0===n?void 0:n.base_model_type,e.realWidth,e.realHeight,!0);Object.assign(t.studio,o)}else t=w(w({},t),e);this.$emit("input",t),e&&(e.height||e.realHeight)&&this.$emit("updateImageSize",e)}},generate:function(){this.$emit("generate")},updateMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=JSON.parse(JSON.stringify(this.value));t.mask=e,this.$emit("input",t)},imageReadInfo:function(){var e,t=this,n=this.menuIndex,o=this.value,r=o.imageUrl,l=o.workIndex,c=o.action,d=o.imgFiles,m=r[l],v=!["extraUpscale","descriptors","preview","faceSwap","characterRepair"].includes(n),f=this.isFirstImg(r,l,n),_=this.isUploadImg(r,l,d),w=this.isCost();if(console.log("是否有钱： ",w,"是否是会员："+this.isVip),!w&&!this.isCompanyAccount)return this.$EventBus.$emit(this.isVip?"showVipComputingDialog":"showNotVipComputingDialog"),this.changeLoading(!1);if(this.top.readOff&&v&&f&&3!==c&&_){"imageToImage"===this.menuIndex&&(null==this||null===(e=this.top)||void 0===e||e.checkCharacterRepair("")),clearTimeout(this.pollingTimer),this.pollingTimer=null,this.readImagePrompt(m,this.pollingTask);var y=this.top.config;[7,11,"studio"].includes(this.value.category)||Object(h.getTaskConfig)({img_url:m,action:2,base_model_name:5===y[this.menuIndex].category?"SDXL":void 0}).then((function(e){t.$emit("imgReadInfo",e.data,n)}))}else this.changeLoading(!1)},isFirstImg:function(e,t,n){return"imageToImage"===n?3===t:"conditionToImage"!==n||0===t},isCost:function(){var e=this.paymentInfo,t=e.calculateCoins,n=e.tempCoins;return console.log(t,n),t>1||n>1},isUploadImg:function(e,t,n){var o;return null===(o=n[t])||void 0===o?void 0:o.file},changeLoading:function(e){this.saveImageInfo({generateing:e})},readImagePrompt:function(e,t){Object(h.createTask)({action:11,speed_type:this.top.config[this.menuIndex].speed_type,meta:{img_2_text:{uri:e}}}).then((function(e){t&&t(e.data.id)})).catch((function(e){}))},pollingTask:function(e){var t=this;this.pollingTimer=setTimeout((function(){Object(h.batchFetchTaskProcess)({task_ids:[e]}).then((function(n){var o=n.data.items;if(3===o[0].status){var r=o[0],l=r.reverse_local_prompts,c=r.reverse_prompts;t.saveImageInfo({prompt:l[0],local_prompt:c[0],generateing:!1}),clearTimeout(t.pollingTimer),t.pollingTimer=null}else t.pollingTask(e)})).catch((function(e){t.changeLoading(!1)}))}),1e3)},changeReadOff:function(e){var t=this,n=this.value,o=n.imageUrl[n.workIndex];this.top.changeReadOff(e);var r={insight:e?1:2,auto_pub_community:this.accountSettingsData.is_auto_pub_community?1:2};Object(m.c)(r).then((function(e){var n=(e||{}).status.code;1e4==(void 0===n?"":n)?t.$message.success(t.$t("SaveSuccess")):(t.changeLoading(!1),t.$message.success(t.$t("SaveFailed")))})).catch((function(e){t.$message.success(t.$t("SaveFailed")),t.changeLoading(!1)})),e&&o&&(this.changeLoading(!0),this.imageReadInfo())}}},C=y,S=(n(4137),n(0)),component=Object(S.a)(C,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"work-body"},[t.showPromptStudio?t._e():[n("c-work-tab",{directives:[{name:"show",rawName:"v-show",value:t.isShowTab,expression:"isShowTab"}]}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"animGen"!==t.menuIndex,expression:"menuIndex !== 'animGen'"}]},[n("c-upload-box",{directives:[{name:"show",rawName:"v-show",value:!(null!==(e=t.value.imgFiles[t.value.workIndex])&&void 0!==e&&e.file||t.imageUrl),expression:"!(value.imgFiles[value.workIndex]?.file || imageUrl)"}],on:{imageChange:t.changeImage}}),t._v(" "),t._l(t.value.imageUrl,(function(img,i){var e,o;return n("c-upload-view",{directives:[{name:"show",rawName:"v-show",value:t.value.workIndex===i&&((null===(e=t.value.imgFiles[i])||void 0===e?void 0:e.file)||img),expression:"value.workIndex === i && (value.imgFiles[i]?.file || img)"}],key:"showImg_"+i,ref:"cUploadView",refInFor:!0,attrs:{imgFile:null===(o=t.value.imgFiles[i])||void 0===o?void 0:o.file,imageUrl:img,menuIndex:t.menuIndex,"mask-url":t.value.mask,workIndex:i},on:{updateMask:t.updateMask,toolEvent:t.toolEvent}})}))],2),t._v(" "),"animGen"===t.menuIndex?n("div",[n("c-anim-view",{on:{setWork:t.animSetWork,onDelete:t.deleteImage},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):t._e(),t._v(" "),n("div",{staticClass:"btn-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showGenerateBtn,expression:"!showGenerateBtn"},{name:"loading",rawName:"v-loading",value:t.value.generateing,expression:"value.generateing"}],staticClass:"read-btn"},[t._v("\n        "+t._s(t.$t("IntelligentAnalysis"))),n("el-switch",{attrs:{value:t.top.readOff,"active-color":"#3F8CFF"},on:{change:t.changeReadOff}})],1),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showGenerateBtn,expression:"showGenerateBtn"}],staticClass:"generate-btn",attrs:{loading:t.value.generateing},on:{click:t.generate}},[t._v("\n        "+t._s(t.$t("Generate"))+"\n        "),n("span",[t._v(t._s("( ".concat(t.$t("PhysicalExertion"),"：").concat(t.setExpend()," )")))])])],1)],t._v(" "),[t.showPromptStudio?n("PromptStudio"):t._e()]],2)}),[],!1,null,"72ec9ef6",null);t.default=component.exports},3247:function(e,t,n){"use strict";n.r(t);n(16);var o=n(3),r=(n(20),n(31),n(4),n(28),n(21),n(40),n(41),n(141),n(142),n(109),n(29)),l=n(61),c={imageToImage:36,conditionToImage:37,animGen:38,expansion:39,extraUpscale:40,characterRepair:41,descriptors:42,preview:43},d={inject:["top"],data:function(){return{isShowLink:!1,linkInput:"",uploading:!1}},computed:{baseSize:function(){return["characterRepair","extraUpscale","faceSwap"].includes(this.top.menuIndex)?10:5}},watch:{"top.isShowPopup":function(e){this.isShowLink=!1}},methods:{handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,d,h,m,v,f,_,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.top,r=o.menuIndex,d=o.config,h=o.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(m=e)||m.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(v=["faceSwap"].includes(t.top.menuIndex),f={category:2},v&&(f.category=16),c[r]&&(f.category=c[r]),m.size/1024/1024<=t.baseSize){n.next=24;break}return n.prev=14,n.next=17,Object(l.a)(m,1024*t.baseSize*1024);case 17:m=n.sent,n.next=24;break;case 20:return n.prev=20,n.t0=n.catch(14),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 24:if(!t.uploading){n.next=26;break}return n.abrupt("return");case 26:return t.uploading=!0,_=URL.createObjectURL(new Blob([t.fileToBlob(e)])),w=d[r].workIndex,t.top.setUploadImageStatus(r,!0),t.$emit("imageChange",{file:_,uploading:!0},w),h.startUpload(m,f).then((function(e){t.uploading=!1,t.$emit("imageChange",{url:e,file:_,uploading:!1},w),t.closeLinkUploadModal(),t.top.setUploadImageStatus(r,!0)})).catch((function(e){t.uploading=!1,t.$emit("imageChange",{uploading:!1,url:"",file:""},w),t.top.setUploadImageStatus(r,!1),t.$message.error(t.$t("uploadError"))})).finally((function(){t.uploading=!1})),n.abrupt("return",!1);case 33:case"end":return n.stop()}}),n,null,[[14,20]])})))()},handleLinkUpload:function(){this.checkIsImageURL(this.linkInput)?this.uploadImageByLink(this.linkInput):this.$message.warning(this.$t("InputNotAnImageLink"))},closeLinkUploadModal:function(){this.$refs.linkUploadModal&&this.$refs.linkUploadModal.doClose(),this.linkInput=""},uploadImageByLink:function(){var e=this,link=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.top,n=t.menuIndex,o=t.config[n].workIndex,l={url:link};this.uploading||(this.uploading=!0,this.$emit("imageChange",{file:link,uploading:!0},o),Object(r.uploadImage)(l,"link").then((function(t){e.uploading=!1;var n=(t||{data:{}}).status.code,code=void 0===n?"":n;if([1e4,"10000"].includes(code)){var r=t.data.access_url;e.$emit("imageChange",{url:r,file:link,uploading:!1},o),e.top.setUploadImageStatus(e.top.menuIndex,!0),e.closeLinkUploadModal()}else 30003===code?(e.$message.error(e.$t("UploadImageExceed5MB")),e.top.setUploadImageStatus(e.top.menuIndex,!1),e.$emit("imageChange",{uploading:!1,url:"",file:""},o)):(e.$message.error(e.$t("GainFail")),e.top.setUploadImageStatus(e.top.menuIndex,!1),e.$emit("imageChange",{uploading:!1,url:"",file:""},o))})).finally((function(t){e.uploading=!1})))},checkIsImageURL:function(e){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(e)},handleBeforeUploadEmpty:function(){},fileToBlob:function(e){return e.slice(0,e.size,e.type)}}},h=d,m=(n(4114),n(0)),component=Object(m.a)(h,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-panel"},[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,accept:".jpg,.png,.jpeg,.webp","http-request":e.handleBeforeUploadEmpty,"show-file-list":!1}},[t("i",{staticClass:"el-icon-upload image-upload-icon"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n      "+e._s(e.$t("TaskUploadImageDragTips"))),t("em",[e._v(e._s(e.$t("TaskUploadImageClickUploadTips")))]),e._v(" "),["faceSwap"].includes(e.top.menuIndex)?[t("p",{staticClass:"el-upload__text2"},[e._v(e._s(e.$t("faceSwapStep1",{number:10})))]),e._v(" "),t("p",{staticClass:"el-upload__text2"},[e._v(e._s(e.$t("faceSwapStep2")))])]:e._e()],2)]),e._v(" "),t("span",{staticClass:"upload-link"},[t("span",{staticClass:"link-btn",on:{click:function(t){e.isShowLink=!e.isShowLink}}},[t("i",{staticClass:"iconfont icon-url-line-icon"}),e._v("\n      "+e._s(e.$t("TaskUploadImageFromUrl"))+"\n    ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowLink,expression:"isShowLink"}],staticClass:"link-input"},[t("el-input",{attrs:{placeholder:""},model:{value:e.linkInput,callback:function(t){e.linkInput=t},expression:"linkInput"}},[t("el-button",{staticClass:"custom-btn",attrs:{slot:"append",type:"primary",loading:e.uploading},on:{click:e.handleLinkUpload},slot:"append"},[e._v("\n          "+e._s(e.$t("TaskUploadImageGoGotIt"))+"\n        ")])],1)],1)])],1)}),[],!1,null,"68106192",null);t.default=component.exports},3248:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(72),n(89),n(69),n(31),n(18),n(24),n(65),n(4),n(28),n(43),n(21),n(40),n(41);var o=n(3249),r=n(3250),l=n(401);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return d(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function d(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}var h={props:["imageUrl","imgFile","maskUrl","menuIndex","workIndex"],components:{CImageDraw:o.default,DragBox:r.default,generateRedrawModal:l.default},inject:["top"],data:function(){return{penSize:5,eraserSize:5,toolsType:"",imgLoading:!1,imageInfo:{width:0,height:0,rawWidth:0,rawHeight:0},backfillMaskUrl:"",rawImgLoading:!0}},mounted:function(){this.init(),this.initObserver()},computed:{isShowTools:function(){var e=this.top.config.imageToImage.controlnet_units;return"imageToImage"===this.menuIndex&&!e.length},getMaskUrl:function(){return this.maskUrl},isSdModel:function(){var e;return[5,"5","sdxl"].includes(null===(e=this.top)||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.imageToImage)||void 0===e?void 0:e.category)},isShowDraw:function(){var e=this.top.config.imageToImage.controlnet_units;return this.imageUrl&&!this.imgLoading&&!e.length}},watch:{imageUrl:function(e,t){e!=t&&(this.getImageSize(e),!e&&(this.toolsType=""))},"top.config.imageToImage":{handler:function(e,t){var n,o;e&&null!=e&&null!==(n=e.tempMask)&&void 0!==n&&n.includes("data:image/png;base64")&&!["PEN","ERASER"].includes(this.toolsType)||null!=e&&null!==(o=e.controlnet_units)&&void 0!==o&&o.length&&(this.toolsType=""),e&&!["",null,void 0].includes(e.ad_model)&&t&&["",null,void 0].includes(t.ad_model)&&(this.updateImageMask(""),this.toolsType="")},deep:!0,immediate:!0},"top.isShowPopup":function(e){this.toolsType=""},toolsType:{handler:function(e,t){var n=["AI_EDIT"].includes(e)&&["PEN","ERASER"].includes(t),o=["PEN","ERASER"].includes(e)&&["AI_EDIT"].includes(t);e!==t&&(n||o)&&this.updateImageMask("")},deep:!0,immediate:!0}},methods:{init:function(){this.getImageSize(this.imageUrl)},initObserver:function(){var e=this;new ResizeObserver((function(t){var n,o=c(t);try{for(o.s();!(n=o.n()).done;){var r,l,d=n.value.contentRect,h=d.width,m=d.height;if(console.log("宽度:",h,"高度:",m),0===h||0===m)return;if(!e.isShowDraw)return;null==e||null===(r=e.$refs)||void 0===r||null===(r=r.imageDraw)||void 0===r||r.saveCurrentDraw(),e.updateImageInfo(),null==e||null===(l=e.$refs)||void 0===l||null===(l=l.imageDraw)||void 0===l||l.displaySaveDraw()}}catch(e){o.e(e)}finally{o.f()}})).observe(this.$refs.viewBox)},updateImageInfo:function(){var e=this.$refs.uploadView,t=this.imageInfo.rawWidth,n=this.imageInfo.rawHeight,o=e.clientWidth,r=e.clientHeight,l=this.getContainedSize({width:o,height:r,naturalWidth:t,naturalHeight:n});this.imageInfo={width:l.width,height:l.height,rawWidth:t,rawHeight:n}},getContainedSize:function(img){try{var e=img.naturalWidth/img.naturalHeight,t=img.height*e,n=img.height;return t>img.width&&(t=img.width,n=img.width/e),{width:t,height:n}}catch(e){}},getImageSize:function(e){this.imgLoading=!0;var img=new Image;img.src=e;var t=this;this.imageInfo={width:0,height:0,rawWidth:0,rawHeight:0},img.onload=function(){var e=this.width,n=this.height;t.setFullSize(e,n),t.imageLoad(e,n)}},setFullSize:function(e,t){var n=Number((e/t).toFixed(2)),o=document.querySelector("#"+this.menuIndex).offsetWidth,r=e/t;this.setImageSize(e,t,n)},setImageSize:function(e,t,n){var o=e,r=t,l=this.top,c=l.creativeMode,d=5===l.config[l.menuIndex].category,h="sdxl"===c&&d?1536:1080,m=h,v=h,f=1;n>1&&o<m&&d?(f=m/o,o=Math.ceil(o*f),r=Math.ceil(r*f)):r<v&&(f=v/r,o=Math.ceil(o*f),r=Math.ceil(r*f)),n>=1&&o>m&&(o=m,r=parseInt(o/n)),n<1&&r>v&&(r=v,o=parseInt(r*n));var _=["imageToImage","characterRepair"].includes(this.menuIndex)&&3===this.workIndex||"conditionToImage"===this.menuIndex&&0===this.workIndex;"expansion"===this.menuIndex||!_&&"extraUpscale"!==this.menuIndex||this.$emit("toolEvent","SET_SIZE",{width:o,height:r,realWidth:e,realHeight:t})},imageLoad:function(e,t){var n=this.$refs.uploadView,o=n.clientWidth,r=n.clientHeight,l=this.getContainedSize({width:o,height:r,naturalWidth:e,naturalHeight:t});this.imageInfo={width:l.width,height:l.height,rawWidth:e,rawHeight:t},this.imgLoading=!1},toolEvent:function(e){var t,n=this.top;return null!==(t=n.config[n.menuIndex].imgFiles[this.workIndex])&&void 0!==t&&t.uploading?(this.$message.warning(this.$t("uploadingWaitTip")),!1):["PEN","ERASER","AI_EDIT"].includes(e)?(this.$refs.generateRedrawModal.show(this.imageUrl),this.$emit("toolEvent",e),!1):(this.$emit("toolEvent",e),void(this.toolsType="DELETE"!==e?e:""))},updateImageMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$emit("updateMask",e)}}},m=h,v=(n(4120),n(0)),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("div",{ref:"uploadView",staticClass:"upload-view"},[t("div",{ref:"viewBox",staticClass:"view-box",attrs:{id:e.menuIndex}},["expansion"===e.menuIndex?t("drag-box",{ref:"dragBox",attrs:{imageUrl:e.imageUrl}}):[t("img",{directives:[{name:"show",rawName:"v-show",value:!["AI_EDIT"].includes(e.toolsType),expression:"!['AI_EDIT'].includes(toolsType)"}],attrs:{src:e.imgFile||e.imageUrl,alt:""},on:{load:function(t){e.rawImgLoading=!1},error:function(t){e.rawImgLoading=!1}}}),e._v(" "),e.getMaskUrl&&!e.rawImgLoading?t("img",{staticClass:"redraw-mask-image",attrs:{src:e.getMaskUrl,alt:""}}):e._e()]],2),e._v(" "),t("div",{staticClass:"image-tool",class:""===e.toolsType||e.isSdModel?"":"image-tool-active"},[t("i",{staticClass:"iconfont icon-shanchu delete-icon",on:{click:function(t){return e.toolEvent("DELETE")}}}),e._v(" "),e.isShowTools?[t("div",{directives:[{name:"show",rawName:"v-show",value:"imageToImage"===e.top.menuIndex,expression:"top.menuIndex === 'imageToImage'"}],staticClass:"image-tool-panel"},[t("div",{on:{click:function(t){return e.toolEvent("PEN")}}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("PartialRepainting"),placement:"top-start",enterable:!1}},[t("i",{staticClass:"iconfont icon-huabi",class:{active:"PEN"===e.toolsType}})])],1)])]:e._e()],2),e._v(" "),t("generate-redraw-modal",{ref:"generateRedrawModal",attrs:{mask:e.getMaskUrl||""},on:{updateMask:e.updateImageMask}})],1)}),[],!1,null,"16f3dda1",null);t.default=component.exports;installComponents(component,{GenerateRedrawModal:n(401).default})},3249:function(e,t,n){"use strict";n.r(t);var o=n(3),r=(n(20),n(19),n(16),n(31),n(24),n(21),{name:"GImageDraw",inject:["top"],props:{autoStyle:{type:Object,default:function(){return{}}},brushSize:{type:Number,default:function(){return 20}},eraserSize:{type:Number,default:function(){return 20}},toolsType:{type:String,default:function(){return""}},maskUrl:{type:String,default:function(){return""}}},watch:{toolsType:{handler:function(){this.setDrawType(),this.setCanvasStyle()}},eraserSize:{handler:function(){this.setCanvasStyle()},immediate:!0,deep:!0},brushSize:{handler:function(){this.setCanvasStyle()},immediate:!0,deep:!0},"top.config.imageToImage.tempMask":{handler:function(e,t){e&&e.includes("data:image/png;base64")&&["",null,void 0].includes(t)&&this.displayMaskToCanvas(e)},immediate:!0,deep:!0}},data:function(){return{canvasWidth:400,canvasHeight:300,brushColor:"white",isDrawing:!1,lastX:0,lastY:0,canvasStyle:{},blankCanvas:"",blankBgCanvas:"",imageData:null}},mounted:function(){this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.initBgCanvas(),this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth="ERASER"===this.toolsType?4*this.eraserSize:4*this.brushSize,document.addEventListener("mouseup",this.stopDrawing),this.canvas.addEventListener("mousedown",this.startDrawing),this.canvas.addEventListener("mousemove",this.draw),this.canvas.addEventListener("mouseup",this.stopDrawing),this.blankCanvas=this.canvas.toDataURL(),this.saveBackgroundCanvas()},beforeDestroy:function(){this.canvas.removeEventListener("mousedown",this.startDrawing),this.canvas.removeEventListener("mousemove",this.draw),this.canvas.removeEventListener("mouseup",this.stopDrawing),window.removeEventListener("mouseup",this.stopDrawing)},methods:{saveCurrentDraw:function(){this.imageData=this.canvas.toDataURL()},displaySaveDraw:function(){var e=this;this.$nextTick((function(){e.displayMaskToCanvas(e.imageData,!1),e.imageData=null}))},displayMaskToCanvas:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],img=new Image;img.onload=function(){e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.drawImage(img,0,0,e.canvas.width,e.canvas.height),e.saveDrawingToBase64(n)},img.onerror=function(e){console.log(e,"888")},img.src=t},setCanvasStyle:function(){var e="ERASER"===this.toolsType?4*this.eraserSize:4*this.brushSize,t='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(e,'" height="').concat(e,'" viewBox="0 0 32 32">\n  <path fill="none" stroke="#fff" stroke-linejoin="miter" stroke-linecap="butt" stroke-miterlimit="4" stroke-width="1.9048" d="M31.048 16c0 8.311-6.737 15.048-15.048 15.048s-15.048-6.737-15.048-15.048c0-8.311 6.737-15.048 15.048-15.048s15.048 6.737 15.048 15.048z"></path>\n  </svg>'),n=btoa(t),o="data:image/svg+xml;base64,".concat(n);this.canvasStyle={cursor:"url(".concat(o,") ").concat(e/2," ").concat(e/2,", auto")}},initBgCanvas:function(){this.canvas2=this.$refs.canvas2,this.bgCtx=this.canvas2.getContext("2d"),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height)},saveBackgroundCanvas:function(){try{this.bgCtx.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.fillStyle="black",this.bgCtx.fillRect(0,0,this.canvas2.width,this.canvas2.height),this.bgCtx.drawImage(this.canvas,0,0,this.canvas2.width,this.canvas2.height),this.blankBgCanvas=this.canvas2.toDataURL("image/png",.05)}catch(e){}},setDrawType:function(){this.ctx&&(this.ctx.strokeStyle=this.brushColor,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.globalCompositeOperation="ERASER"===this.toolsType?"destination-out":"source-over")},startDrawing:function(e){this.isDrawing=!0,this.setDrawType();var t=[e.offsetX,e.offsetY];this.lastX=t[0],this.lastY=t[1],this.ctx.beginPath(),this.ctx.moveTo(e.offsetX,e.offsetY)},draw:function(e){if(this.isDrawing){this.ctx.lineWidth="ERASER"===this.toolsType?4*this.eraserSize:4*this.brushSize,this.ctx.strokeStyle=this.brushColor,this.ctx.lineTo(e.offsetX,e.offsetY),this.ctx.stroke();var t=[e.offsetX,e.offsetY];this.lastX=t[0],this.lastY=t[1]}},stopDrawing:function(){this.isDrawing=!1,this.ctx.closePath();try{this.saveDrawingToBase64()}catch(e){}},clearCanvas:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},saveDrawing:function(){var img=new Image;img.src=this.canvas2.toDataURL("image/png",.05);var link=document.createElement("a");link.download="drawing.png",link.href=img.src,link.click()},saveDrawingToBase64:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.length>0&&void 0!==e[0]&&e[0],n.prev=1,t.bgCtx.clearRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.fillStyle="black",t.bgCtx.fillRect(0,0,t.canvas2.width,t.canvas2.height),t.bgCtx.drawImage(t.canvas,0,0,t.canvas2.width,t.canvas2.height),r=t.canvas2.toDataURL("image/png",.05),t.canvas.toDataURL()!==t.blankCanvas){n.next=10;break}return t.$emit("updateMask",""),n.abrupt("return");case 10:if(r!==t.blankBgCanvas){n.next=13;break}return t.$emit("updateMask",""),n.abrupt("return");case 13:if(o)try{null==t||null===(l=t.top)||void 0===l||l.updateDisplayMask(r.slice(r.indexOf(",")+1))}catch(e){}return n.next=16,t.checkIsSameImage(r);case 16:if(!n.sent){n.next=19;break}return n.abrupt("return");case 19:t.$emit("updateMask",r.slice(r.indexOf(",")+1)),n.next=24;break;case 22:n.prev=22,n.t0=n.catch(1);case 24:case"end":return n.stop()}}),n,null,[[1,22]])})))()},checkIsSameImage:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!1,(o=e.length>0&&void 0!==e[0]?e[0]:"").slice(o.indexOf(",")+1)!==t.maskUrl){n.next=5;break}return n.abrupt("return",!0);case 5:return n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))()}}}),l=r,c=(n(4115),n(0)),component=Object(c.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-g-image-draw"},[t("canvas",{ref:"canvas",style:e.canvasStyle,attrs:{width:e.autoStyle.width,height:e.autoStyle.height}}),e._v(" "),t("canvas",{ref:"canvas2",staticStyle:{display:"none"},attrs:{width:e.autoStyle.rawWidth,height:e.autoStyle.rawHeight}})])}),[],!1,null,"ec96a390",null);t.default=component.exports},3250:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13);var o=n(2),r=(n(16),n(65),n(8),n(4),n(7),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={props:["imageUrl"],inject:["top"],data:function(){return{borderList:["left","top","right","bottom"],boxStyle:{top:0,bottom:0,left:0,right:0},imgStyle:{width:0,height:0,rawWidth:0,rawHeight:0},limit:{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0},scale:1,boxElm:null,dragElm:null,imgElm:null,borderWidth:5}},computed:c(c({},Object(r.e)("user",["cdnHost"])),{},{isDragHeight:function(){return this.imgStyle.rawHeight<1536},isDragWidth:function(){return this.imgStyle.rawWidth<1536}}),watch:{imageUrl:function(e){e&&(this.initConfig(),this.getImageSize({url:e,needImgOnload:!0}))}},mounted:function(){this.getImageSize({needImgOnload:!0}),window.addEventListener("resize",this.handleResize)},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:{handleResize:function(){this.initConfig(),this.getImageSize({needImgOnload:!1,windowChange:!0})},getImageSize:function(e){var t=e.url,n=void 0===t?this.imageUrl:t,o=e.needImgOnload,r=e.windowChange,l=void 0!==r&&r,img=new Image;img.src=n;var c=this;o?img.onload=function(){var e=this.width,t=this.height;e>=1536&&t>=1536&&c.$message.warning(c.$t("expansion_over_limit_tips")),(1436<e&&e<1536||1436<t&&t<1536)&&c.$message({message:c.$t("ImgNameIs")+" "+e+"x"+t+". "+c.$t("ExpantionTip"),type:"warning",duration:3e3}),c.imgStyle={rawHeight:t,rawWidth:e},c.initELm(l)}:this.initELm(l)},initELm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.boxElm=document.querySelector("#expansion"),this.dragElm=document.querySelector("#dragBox"),this.imgElm=document.querySelector("#dragBox img"),this.limit=c(c({},this.limit),{},{maxWidth:parseInt(this.boxElm.offsetWidth-2),maxHeight:parseInt(this.boxElm.offsetHeight-2)}),this.initDragBox(e),this.addMousemoveEvent()},initDragBox:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.limit,o=n.maxWidth,r=n.maxHeight,l=this.imgStyle,d=l.rawHeight,h=l.rawWidth,m=this.formateSize(h/d,5);this.scale=this.formateSize(o/1536,5);var v=h,f=d;h>=1536&&m>=1&&(v=o,f=this.scaleSize(o,!0,m)),d>=1536&&m<=1&&(f=r,v=this.scaleSize(r,!1,m)),h<1536&&d<1536&&(v=this.scaleSize(h),f=this.scaleSize(d)),this.limit=c(c({},this.limit),{},{minWidth:v,minHeight:f}),this.imgStyle=c(c({},this.imgStyle),{},{width:v,height:f}),this.getInitPadding(),this.$nextTick((function(){e.setResize(!1,t)}))},getInitPadding:function(){var e=this.top.config.expansion,t=e.width,n=e.height,o=e.up_margin,r=e.left_margin,l=this.imgStyle,c=l.rawWidth,d=l.rawHeight,h=2*this.borderWidth;if(-1!==o&&-1!==r){var m=this.scaleSize(o);m=m>2?m-2:m;var v=this.scaleSize(t-c-r)-h,f=this.scaleSize(n-d-o)-h;this.boxStyle={left:this.scaleSize(r),top:m,right:v<0?0:v,bottom:f<0?0:f}}},formateSize:function(e,t){var n=e.toFixed(t||0);return t?parseFloat(n):parseInt(n)},initConfig:function(){this.boxStyle={top:0,bottom:0,left:0,right:0}},getDragShow:function(e){return["left","right"].includes(e)?this.isDragWidth:!["top","bottom"].includes(e)||this.isDragHeight},resize:function(e,t){var n=0,o=0,r=this;e.onmousedown=function(l){(l=l||event).preventDefault();var c=e.getBoundingClientRect(),d=c.left,h=c.top;n=parseInt(d),o=parseInt(h);var m=JSON.parse(JSON.stringify(r.boxStyle));document.onmousemove=function(e){var l=(e=e||event).clientX-n,c=e.clientY-o;if(r.setPadding(t,l,c,m),!r.isStopMove(t))return!1},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,r.setResize()}}},isStopMove:function(e){var t=this.limit,n=t.minWidth,o=t.minHeight,r=t.maxWidth,l=t.maxHeight,c=this.boxStyle,d=c.left,h=c.right,m=c.bottom,v=c.top,f=o+m+v;l-=10;var _=n+h+d>=(r-=10)&&["left","right"].includes(e),w=f>=l&&["top","bottom"].includes(e);return _||w?(this.setPadLimit(e),!0):(h<0||v<0||d<0||m<0)&&(this.setPadLimit(e,!0),!0)},setPadLimit:function(e,t){var n=this.limit,o=n.minWidth,r=n.minHeight,l=n.maxWidth,c=n.maxHeight,d=["left","right"].includes(e),h=d?l:c,m=d?o:r,v=this.boxStyle[{left:"right",right:"left",top:"bottom",bottom:"top"}[e]],f=2*this.borderWidth;this.boxStyle[e]=t?0:h-v-m-f},setPadding:function(e,t,n,o){var r=o[e],l=["left","right"].includes(e)?t:n;l*=2,this.boxStyle[e]=r+(["left","top"].includes(e)?-l:l)},addMousemoveEvent:function(){var e=this;this.borderList.forEach((function(t,i){var n=document.querySelector(".drag-"+t);e.resize(n,t)}))},scaleSize:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.scale;return t?this.formateSize(e/n):this.formateSize(e*n)},setResize:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.boxStyle,o=n.left,r=n.right,l=n.top,c=n.bottom,d=this.dragElm,h=2*this.borderWidth,m=this.isDragWidth&&(o>0||r>0),v=this.isDragHeight&&(l>0||c>0),f=d.offsetWidth+(m?h:0),_=d.offsetHeight+(v?h:0),w=this.scaleSize(o,!0),y=this.scaleSize(l,!0);f=this.scaleSize(f,!0),_=this.scaleSize(_,!0),t||this.top.setResizeInfo({left_margin:w,up_margin:y,width:f,height:_,isDrag:e})}}},h=d,m=(n(4116),n(0)),component=Object(m.a)(h,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"drag-box",style:{padding:e.boxStyle.top+"px "+e.boxStyle.right+"px "+e.boxStyle.bottom+"px "+e.boxStyle.left+"px",minWidth:e.limit.minWidth+"px",minHeight:e.limit.minHeight+"px",backgroundImage:"url(https://".concat(e.cdnHost,"/static/upload/20230602/50b806a8-3d7a-4bad-9cfc-bbae659c9638.png)")},attrs:{id:"dragBox"}},[t("img",{style:{width:e.imgStyle.width+"px",height:e.imgStyle.height+"px"},attrs:{src:e.imageUrl,alt:""}}),e._v(" "),e._l(e.borderList,(function(n,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.imgStyle.rawWidth&&e.getDragShow(n),expression:"imgStyle.rawWidth && getDragShow(v)"}],key:"border_"+i,staticClass:"border",class:["drag-"+n]},[t("span",{staticClass:"center-btn"})])}))],2)}),[],!1,null,"08c908a4",null);t.default=component.exports},3251:function(e,t,n){"use strict";n.r(t);var o={props:["value"],components:{pickWorkModal:n(465).default},data:function(){return{}},methods:{handleSelectArtWork:function(e){this.$emit("setWork",e[0].info)},onDelete:function(){this.$emit("onDelete")}}},r=(n(4125),n(0)),component=Object(r.a)(o,(function(){var e,t,n,o,r,l,c=this,d=c._self._c;return d("div",{staticClass:"CAnimView"},[null!==(e=c.value)&&void 0!==e&&e.imageUrl[null===(t=c.value)||void 0===t?void 0:t.workIndex]?d("div",{staticClass:"deleteBox",on:{click:c.onDelete}},[d("i",{staticClass:"iconfont icon-shanchu"})]):c._e(),c._v(" "),null!==(n=c.value)&&void 0!==n&&n.imageUrl[null===(o=c.value)||void 0===o?void 0:o.workIndex]?d("div",{staticClass:"imgBox"},[d("img",{attrs:{src:null===(r=c.value)||void 0===r?void 0:r.imageUrl[null===(l=c.value)||void 0===l?void 0:l.workIndex],alt:""}})]):d("div",{staticClass:"cnt",on:{click:function(e){return c.$refs.pickWorkModal.openModal()}}},[d("i",{staticClass:"el-icon-plus"}),c._v(" "),d("span",[c._v(c._s(c.$t("animGenTip")))])]),c._v(" "),d("pick-work-modal",{ref:"pickWorkModal",attrs:{maxNum:1,type:"animGen"},on:{confirm:c.handleSelectArtWork}})],1)}),[],!1,null,"11fa3b31",null);t.default=component.exports},3252:function(e,t,n){"use strict";n.r(t);n(18);var o=n(14),r=n(3),l=(n(20),n(19),n(16),n(28),n(90),n(3117)),c=n(799),d=n(459),h=n(10),m=n(25),v=Object(h.z)("ops-notion-apiKey",""),f=Object(h.z)("ops-notion-databaseId",""),_=Object(h.z)("ops-notion-onlyMyNotion",!1),w=Object(h.z)("ops-notion-enableMyNotion",!0),y={data:function(){return{dict:null,activeDir:null,apiKey:v,databaseId:f,input_databaseId:f.value,onlyMyNotion:_,enableMyNotion:w,notionName:null,notionUrl:null,loading:!1,isHoverButton:!1}},inject:["top"],watch:{input_databaseId:{handler:function(e){if(e.startsWith("https://")){var t,n=/\/([0-9a-f]{32})/.exec(e);if(32==(null==n||null===(t=n[1])||void 0===t?void 0:t.length)){var o=null==n?void 0:n[1];this.input_databaseId=o}else this.input_databaseId=""}else e&&32!=e.length&&(this.input_databaseId="");this.databaseId=e}},"$i18n.locale":function(e){this.loadData(!0)}},mounted:function(){this.loadData(),this.notioConfigActive&&this.reloadData()},methods:{loadData:function(e){var t=this;Object(l.getDictData)(_.value,e).then((function(e){t.dict=e,t.activeDir=e[0]}))},reloadData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!w.value){t.next=3;break}return t.next=3,e.fetchNotion();case 3:e.loadData();case 4:case"end":return t.stop()}}),t)})))()},fetchNotion:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.notionName=null,e.notionUrl=null,r=Object(d.useDatabaseServer)(),t.next=7,r.fetchNotion({apiKey:v.value,databaseId:f.value});case 7:l=t.sent,e.notionName=null==l||null===(n=l.me)||void 0===n?void 0:n.name,e.notionUrl=null==l||null===(o=l.me)||void 0===o?void 0:o.url,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("[Notion]",t.t0),/Make sure the relevant pages and databases are shared with your integration/.test(t.t0.message)?alert("Notion 连接错误："+t.t0):alert("Notion 连接错误：没有 Notion 数据库的访问权限。请在此 Notion 数据库页面菜单的 'Connections' 中添加你的集成应用");case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,12,16,19]])})))()},doApplyWord:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=document.body.querySelector(".PromptWork.active"))||(n=document.body.querySelector(".PromptWork")),!n){t.next=8;break}return o=e.data.word.rawText||e.data.word.text,r=n.__vue__,t.next=7,r.promptWork.reflowPrompts(o);case 7:r.doExportPrompt();case 8:case"end":return t.stop()}}),t)})))()},doChangeActiveDir:function(e){this.activeDir=e},doGotoNotionMe:function(){this.notionUrl&&window.open(this.notionUrl)},setNotionHover:Object(m.debounce)((function(e){this.isHoverButton=e}),400)},components:{PromptItem:c.a},computed:{currentMode:function(){var e;return null==this||null===(e=this.top)||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.textToImage)||void 0===e?void 0:e.category},showCommandTab:function(){return function(e){var t=!0;return[1,2,"1","2"].includes(this.currentMode)&&"OPS_command"!==e.langKey?t:(![1,2,"1","2"].includes(this.currentMode)||"OPS_command"!==e.langKey)&&([3,"3"].includes(this.currentMode)?t:void 0)}},activeSubDirs:function(){if(this.activeDir)return[this.activeDir].concat(Object(o.a)(this.activeDir.children))},notioConfigActive:function(){return!(!this.databaseId||!this.apiKey)},isOpenDir:function(){return function(e){var t=e.name;return["质量","绘画","风格","画面效果"].includes(t)&&e.words.length>3}}}},C=(n(4134),n(0)),component=Object(C.a)(y,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"PromptDict"},[e.dict?t("div",{staticClass:"dir-buttons"},[e._l(e.dict,(function(n,i){return[t("button",{key:"dir_".concat(i),class:{active:n==e.activeDir},on:{click:function(t){return e.doChangeActiveDir(n)}}},[e._v("\n        "+e._s(e.$t(n.langKey)||n.name)+"\n      ")])]}))],2):e._e(),e._v(" "),e.activeDir?t("div",{staticClass:"active-dir"},e._l(e.activeSubDirs,(function(n){return t("details",{key:n.name,staticClass:"sub-dir",attrs:{open:e.isOpenDir(n)}},[t("summary",{directives:[{name:"show",rawName:"v-show",value:n.name!=e.activeDir.name,expression:"subDir.name != activeDir.name"}],staticClass:"name"},[t("span",{staticClass:"title"},[e._v(e._s(e.$t(n.langKey)||n.name))]),e._v(" "),t("span",{staticClass:"len"},[e._v(e._s(n.words.length))])]),e._v(" "),t("div",{staticClass:"list"},e._l(n.words,(function(n){return t("div",{staticClass:"item"},[t("PromptItem",{staticClass:"dict-word",attrs:{item:n},on:{click:function(t){return e.doApplyWord(n)}}})],1)})),0)])})),0):e._e()])}),[],!1,null,null,null);t.default=component.exports},3253:function(e,t,n){"use strict";n.r(t);n(16),n(4);var o={inject:["top"],data:function(){return{}},computed:{controlNetList:function(){var e=this.top;return e.config[e.menuIndex].controlnet_units},controlIndex:function(){var e=this.top;return e.config[e.menuIndex].workIndex},showStudioControlNet:function(){var e;return"imageToImage"===this.top.menuIndex&&["7",7,11].includes(null===(e=this.top.config)||void 0===e||null===(e=e.imageToImage)||void 0===e?void 0:e.category)}},methods:{addControlNet:function(){var e=this.top,t=e.config[e.menuIndex],n=t.imageUrl,o=t.controlnet_units;if(t.generateing)this.$message.warning(this.$t("uploadingWaitTip"));else{var r=o.every((function(e,i){return n[i]}));if(this.controlNetList.length>=3)return!1;if(n[3]||0!==this.controlNetList.length||(r=!1),!r)return this.$message.warning(this.$t("pleaseUoloadImage")),!1;this.top.addControlNet(this.controlNetList.length),this.top.clearMask()}},changeWorkTab:function(e){this.top.changeWorkTab(e)},deleteWork:function(i){this.top.changeWorkTab(i,"DEL")}}},r=(n(4136),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"change-work-tab"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"imageToImage"===e.top.menuIndex,expression:"top.menuIndex === 'imageToImage'"}],staticClass:"tab-item",class:{active:3===e.controlIndex},on:{click:function(t){return e.changeWorkTab(3)}}},[e._v("\n    "+e._s(e.$t("TaskUploadImage"))+"\n  ")]),e._v(" "),e._l(e.controlNetList,(function(n,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showStudioControlNet,expression:"!showStudioControlNet"}],key:"controlNet_"+i,staticClass:"tab-item",class:{active:e.controlIndex===i},on:{click:function(t){return e.changeWorkTab(i)}}},[e._v("\n    ControlNet "+e._s(i+1)+"\n    "),e.controlNetList.length>1||"imageToImage"===e.top.menuIndex?t("span",{staticClass:"close-icon",on:{click:function(t){return t.stopPropagation(),e.deleteWork(i)}}},[e._v("+")]):e._e()])})),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.controlNetList.length<3&&!e.showStudioControlNet,expression:"controlNetList.length < 3 && !showStudioControlNet"}],staticClass:"tab-item created-item",on:{click:e.addControlNet}},[t("i",{staticClass:"el-icon-plus"})])],2)}),[],!1,null,"0767e3b3",null);t.default=component.exports},3254:function(e,t,n){"use strict";n.r(t);n(24),n(4),n(43),n(77);var o={name:"GRechargeBanner15min",components:{BannerCountdown:n(560).default},props:{discountValue:{type:Number,default:0},duration:{type:Number,default:9e5}},data:function(){return{countdownTime:{hours:"15",minutes:"00",seconds:"00"},countdownEndTime:null,countdownRAF:null}},mounted:function(){this.startCountdown(this.duration)},beforeDestroy:function(){this.countdownRAF&&(cancelAnimationFrame(this.countdownRAF),this.countdownRAF=null)},methods:{handleClick:function(){this.$emit("upgradeBtnClick")},startCountdown:function(e){var t=this;this.countdownEndTime=Date.now()+e;var n=0;this.countdownRAF=requestAnimationFrame((function e(o){var r=Date.now(),l=Math.max(0,t.countdownEndTime-r);if(l<=0)t.$emit("countdownComplete");else{if(!n||r-n>=100){var c=Math.floor(l/6e4),d=Math.floor(l%6e4/1e3),h=Math.floor(l%1e3/10);t.countdownTime={hours:c.toString().padStart(2,"0"),minutes:d.toString().padStart(2,"0"),seconds:h.toString().padStart(2,"0")},n=r}t.countdownRAF=requestAnimationFrame(e)}}))},resetCountdown:function(){this.countdownRAF&&(cancelAnimationFrame(this.countdownRAF),this.countdownRAF=null),this.countdownTime={hours:"15",minutes:"00",seconds:"00"}}}},r=(n(4139),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"countdown-banner",attrs:{"data-group":"g-recharge-banner-15min"}},[t("div",{staticClass:"countdown-content"},[t("div",{staticClass:"countdown-text"},[e._v(e._s(e.$t("svip_quick_results_title")))]),e._v(" "),e.discountValue?t("div",{staticClass:"discount-badge"},[t("span",[e._v(e._s(e.discountValue)+"% OFF")])]):e._e(),e._v(" "),t("div",{staticClass:"countdown-timer"},[t("i",{staticClass:"el-icon-alarm-clock"}),e._v(" "),t("span",[e._v(e._s(e.$t("banner_ends_in")))]),e._v(" "),t("BannerCountdown",{attrs:{halfDiscountCountdown:e.countdownTime}})],1),e._v(" "),t("div",{staticClass:"upgrade-btn",attrs:{"data-event":"click_upgrade_btn_g-recharge-banner-15min"},on:{click:e.handleClick}},[e._v("\n      "+e._s(e.$t("UpgradeNow"))+"\n      "),t("img",{attrs:{src:"https://image.cdn2.seaart.me/20250515/503cf30f-ec94-4af2-af38-7fa1c53120a7_high.webp",alt:"upgrade"}})])]),e._v(" "),t("i",{staticClass:"iconfont icon-close",attrs:{"data-event":"click_close_g-recharge-banner-15min"},on:{click:function(t){return e.$emit("close")}}})])}),[],!1,null,"141e5e57",null);t.default=component.exports;installComponents(component,{BannerCountdown:n(560).default})},3261:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(6),n(12),n(13),n(7);var o=n(2),r=(n(32),n(8),n(4),n(1)),l=n(9);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={props:["value"],inject:["top"],data:function(){return{isShow:!1,modelCover:l.t,menuIndex:""}},computed:d(d(d({},Object(r.c)("creation",["taskUnits","taskSdxlUnits","lab_ctr_units"])),Object(r.e)("user",["cdnHost"])),{},{taskModules:function(){var e=this.taskUnits||[];return this.isSdxl&&(e=this.taskSdxlUnits||[]),this.isStudioMode&&(e=this.lab_ctr_units||[]),e},isSdxl:function(){return["5",5,"sdxl","SDXL"].includes(this.value.category)},isStudioMode:function(){return["7",7,"studio",11].includes(this.value.category)},hideModel:function(){return"preview"===this.menuIndex?["none","reference_only"]:["none"]},module:function(){var e,t=this.value,n=t.workIndex;return null===(e=t.controlnet_units[n])||void 0===e?void 0:e.type}}),methods:{show:function(e,t){this.isShow=e,this.menuIndex=t},close:function(){this.show(!1)},changeModel:function(e){var t=JSON.parse(JSON.stringify(this.value)),n=t.workIndex,o=t.controlnet_units,r=t.lab_base;if(o[n].type=e.type,this.isStudioMode){var l=(this.lab_ctr_units||[]).find((function(t){return(null==e?void 0:e.type)===t.type})),c={PyraCanny:{stop_at:.5,weight:1},CPDS:{stop_at:.5,weight:1},FaceSwap:{stop_at:.9,weight:.75}}[null==l?void 0:l.default_model];r.conds[n].mode=null==l?void 0:l.default_model,r.conds[n].stop_at=c.stop_at,r.conds[n].weight=c.weight}var d=this.taskModules.find((function(i){return e.type==i.type}))||{};o[n].model=(null==d?void 0:d.default_model)||"None",o[n].module=(null==d?void 0:d.default_module)||"none",this.$emit("input",t),this.close()}}},m=(n(4152),n(4153),n(0)),component=Object(m.a)(h,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"controlnet-popup custom-dialog big-body-dialog",attrs:{visible:e.isShow,"append-to-body":!0},on:{"update:visible":function(t){e.isShow=t}}},[t("div",{staticClass:"controlnet-body"},[t("i",{staticClass:"el-icon-close",on:{click:e.close}}),e._v(" "),t("div",{staticClass:"controlnet-grid"},e._l(e.taskModules,(function(n,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.hideModel.includes(n.type),expression:"!hideModel.includes(item.type)"}],key:"model_"+i,staticClass:"grid-item",class:{active:e.module===n.type,studioGridItem:e.isStudioMode},on:{click:function(t){return e.changeModel(n)}}},[t("div",{staticClass:"cover zoom-box",style:{"background-image":"url(".concat(n.cover,")")}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t(n.type)))])]),e._v(" "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper controlnet",effect:"dark",content:e.$t(n.type+"_Tips"),placement:"top-start"}},[t("p",{staticClass:"tips-info ellipsis-text"},[e._v(e._s(e.$t(n.type+"_Tips")))])])],1)})),0)])])}),[],!1,null,"545c44f0",null);t.default=component.exports},3262:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(14),r=n(2),l=(n(19),n(49),n(326)),c=n(1);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={inject:["top"],data:function(){return{isShow:!1,loading:!1,isEnd:!1,channel:{name:""},personList:[]}},computed:h(h({},Object(c.e)("user",["userInfo"])),{},{title:function(){return this.channel.name+"("+this.channel.num+")"},disabled:function(){return this.loading||this.isEnd}}),methods:{getNameFirst:function(e){var t=e.name,n=e.id;return t||n?(t?t[0]:n[0]).toUpperCase():""},getPersonList:function(){var e=this,t=this.channel.channel_id;this.loading=!0;var n={channel_id:t,page_size:100};Object(l.f)(this.getTimeForm(n)).then((function(t){e.loading=!1;var n=t.data,r=n.items,l=n.has_more;e.personList=[].concat(Object(o.a)(e.personList),Object(o.a)(r)),e.isEnd=!l})).catch((function(t){e.loading=!1}))},getTimeForm:function(e){var t=this.personList;return t.length?h(h({},e),{},{time_from:t[t.length-1].join_time}):e},show:function(e,t){this.initParams(),t&&(this.channel=t,this.getPersonList()),this.isShow=e},initParams:function(){this.personList=[],this.loading=!1,this.isEnd=!1},deletePerson:function(e){var t=this,n=this.personList[e];this.$confirm(this.$t("KickOutChannelTitle")+n.name,this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(l.h)({channel_id:t.channel.channel_id,member_ids:[n.id]}).then((function(n){t.$message.success(t.$t("OperateSuccess")),t.personList.splice(e,1)})).catch((function(){t.$message.warning(t.$t("QuitFail"))}))}))},close:function(){this.show(!1)},toUserPage:function(e){this.isShow=!1;var path=e===this.userInfo.id?"/personal":"/user/"+e;this.$router.push(path),this.top.closePopup()},handleScroll:function(e){var t=e.target;this.loading||this.isEnd||t.scrollHeight-(t.scrollTop+t.clientHeight)<10&&this.getPersonList()}}},v=(n(4154),n(0)),component=Object(v.a)(m,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"custom-dialog channel-person-popup",attrs:{visible:e.isShow,"destroy-on-close":"","append-to-body":!0,title:e.title,"before-close":e.close},on:{"update:visible":function(t){e.isShow=t}}},[t("div",{staticClass:"person-list",on:{scroll:e.handleScroll}},[e._l(e.personList,(function(n,i){return t("div",{key:"person_"+i,staticClass:"person-item"},[t("span",{staticClass:"head-img",style:{backgroundImage:"url("+n.head+")"}},[e._v("\n        "+e._s(n.head?"":e.getNameFirst(n))+"\n      ")]),e._v(" "),t("p",{on:{click:function(t){return e.toUserPage(n.id)}}},[e._v(e._s(n.name))]),e._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:e.channel.owner_id===n.id,expression:"channel.owner_id === person.id"}],staticClass:"el-icon-user owner-icon"}),e._v(" "),e.userInfo.id!==n.id&&e.channel.owner_id===e.userInfo.id?t("i",{staticClass:"el-icon-remove-outline delete-icon",on:{click:function(t){return e.deletePerson(i)}}}):e._e()])})),e._v(" "),e.loading?t("p",{staticClass:"loading-info"},[t("i",{staticClass:"el-icon-loading"}),e._v(e._s(e.$t("Loading"))+"...")]):e._e(),e._v(" "),e.isEnd&&e.personList.length>100?t("p",{staticClass:"end-info"},[e._v("别拉了，已经到底啦~")]):e._e()],2)])}),[],!1,null,"bc7461bc",null);t.default=component.exports},3263:function(e,t,n){"use strict";n.r(t);var o={name:"ChannelSearch",inject:["top"],"top.channelId":{handler:function(){this.keyword=""},deep:!0,immediate:!0},data:function(){return{keyword:""}},mounted:function(){var e=this;this.$EventBus.$on("clearTaskSearch",(function(){e.keyword="",e.$emit("channelSearch",e.keyword)}))},beforeDestroy:function(){this.$EventBus.$emit("clearTaskSearch")},methods:{handleSearch:function(){this.$emit("channelSearch",this.keyword)},handleChange:function(e){this.$emit("channelSearch",this.keyword)}}},r=(n(4155),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-channel-search"},[t("el-input",{staticClass:"channel-search--input",attrs:{placeholder:e.$t("Search"),clearable:""},on:{change:e.handleChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[t("template",{slot:"prefix"},[t("i",{staticClass:"iconfont icon-search search-icon"})])],2)],1)}),[],!1,null,null,null);t.default=component.exports},3264:function(e,t,n){"use strict";n.r(t);n(18);var o={name:"ChannelSelectMenu",components:{HandleChannel:n(847).default},inject:["top"],computed:{channelInfo:function(){return this.top.channelInfo}},data:function(){return{visible:!1}}},r=(n(4156),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{placement:"bottom-right",trigger:"click",width:"206","popper-class":"c-channel-select-menu"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("handle-channel",{attrs:{"add-btn-position":"bottom"}}),e._v(" "),t("div",{staticClass:"channel-select-menu-btn",attrs:{slot:"reference"},slot:"reference"},[e._v("\n    "+e._s("PRIVATE"===e.channelInfo.name?e.$t("PRIVATE"):e.channelInfo.name)+"\n    "),t("span",{class:[e.visible?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{"margin-left":"8px"}})])],1)}),[],!1,null,"61139cce",null);t.default=component.exports},3284:function(e,t,n){"use strict";n.r(t);n(31),n(18);var o={props:{item:{type:Object,required:!0},activeId:{type:String,default:""}},data:function(){return{isActive:!1}},methods:{handleClick:function(){this.$emit("item-click",this.item)},handleEdit:function(){this.$emit("item-edit",this.item)},handleDelete:function(){this.$emit("item-delete",this.item)}}},r=(n(4291),n(0)),component=Object(r.a)(o,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"note-vitor-item",class:{"is-active":n.activeId===n.item.id},attrs:{"data-id":n.item.id},on:{click:function(e){return e.stopPropagation(),n.handleClick.apply(null,arguments)}}},[o("div",{staticClass:"note-vitor-left"},[null!==(e=n.item)&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.url?o("img",{attrs:{src:null===(t=n.item)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.url,alt:""}}):n._e()]),n._v(" "),o("div",{staticClass:"note-vitor-right"},[o("div",{staticClass:"right-top"},[o("div",{staticClass:"note-title"},[n._v(n._s(n.item.title||"No Title"))]),n._v(" "),o("div",{staticClass:"action-icons"},[o("i",{staticClass:"iconfont icon-bianji2",attrs:{"data-id":n.item.id,"data-event":"note-vitor-edit"},on:{click:function(e){return e.stopPropagation(),n.handleEdit.apply(null,arguments)}}}),n._v(" "),o("i",{staticClass:"iconfont icon-icon-delete",attrs:{"data-id":n.item.id,"data-event":"note-vitor-delete"},on:{click:function(e){return e.stopPropagation(),n.handleDelete.apply(null,arguments)}}})])]),n._v(" "),o("div",{staticClass:"note-prompt"},[n._v(n._s(n.item.prompt))]),n._v(" "),o("div",{staticClass:"model-params"},n._l(n.item.used_models.slice(0,2),(function(e){return o("div",{key:e.id,staticClass:"model"},[o("div",{staticClass:"model-cover"},[o("img",{attrs:{src:e.banner.url,alt:""}})]),n._v(" "),o("div",{staticClass:"model-des"},[o("div",{staticClass:"model-name"},[n._v(n._s(e.model_type))]),n._v(" "),o("div",{staticClass:"model-version"},[n._v(n._s(e.name))])])])})),0)])])}),[],!1,null,"c7291716",null);t.default=component.exports},3373:function(e,t,n){"use strict";n.r(t);n(26);var o={name:"HalfDiscountAnimation",data:function(){return{visible:!1,animationEndTimer:null}},beforeDestroy:function(){this.animationEndTimer&&clearTimeout(this.animationEndTimer)},methods:{show:function(){var e=this;this.preloadImage(),this.$nextTick((function(){e.visible=!0,requestAnimationFrame((function(){e.$refs.animationEl&&e.$refs.animationEl.classList.add("animate")})),e.animationEndTimer=setTimeout((function(){e.$emit("anime-finish"),e.visible=!1}),3e3)}))},preloadImage:function(){(new Image).src="https://image.cdn2.seaart.me/20250409/fba46c42-18b3-4a4c-b90b-4baec9fb32ed_low.webp"}}},r=(n(4511),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return e.visible?t("div",{staticClass:"animation-container"},[t("div",{ref:"animationEl",staticClass:"discount-card",style:{backgroundImage:"url(https://image.cdn2.seaart.me/20250409/fba46c42-18b3-4a4c-b90b-4baec9fb32ed_low.webp)"}},[t("div",{staticClass:"discount-text"},[e._v(e._s(e.$t("getNumOff",{num:50})))])])]):e._e()}),[],!1,null,"29a9a3ca",null);t.default=component.exports},3374:function(e,t,n){"use strict";n.r(t);n(65),n(77),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(6),n(32),n(16),n(22),n(122),n(24),n(4),n(21),n(1)),l=n(565),c=n(126),d=n(127),h=n(1178),m=n(9),v=n(300);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={name:"SelectLevelHalfDiscount",components:{CTooltip:l.default,PaymentForm:c.a,RightPart:d.a,TextFlip:h.default},props:{popType:{type:Number,default:0},from:{type:String,default:""}},data:function(){return{step:"inGoods",levelArr:[],apiMonetaryUnit:"",selectedLevel:"standard",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"",lottieOptions:{animationData:v,loop:!0,autoplay:!0}}},computed:_(_(_(_(_({},Object(r.c)("payment",["paymentInfo"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.e)("user",["userInfo","cdnHost"])),Object(r.e)("payment",["subThirdType","halfDiscountCountdown","popupSource","paymentGrayInfo"])),{},{formattedStaminaTotal:function(){var e;return this.$t("StaminaMonthAndDay",{all:this.calculateTotalStamina(),one:null===(e=this.selectedLevelItem)||void 0===e?void 0:e.every_day_temp_coins})},isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)},isUpgrade:function(){return[3,4].includes(this.popType)},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/20250510/488c8546-a041-4fe8-bb2f-8f7961ac9a53_high.webp)")}},getLabel:function(){var e=this;return function(t){return e.$t({standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[t])}},selectedLevelItem:function(){var e=this;return this.levelArr.find((function(t){return t.label===e.selectedLevel}))||{}},isT1Country:function(){var e;return m.qb.includes(null===(e=this.userInfo)||void 0===e?void 0:e.current_country_code)},validPopupSource:function(){return this.popupSource&&"AwaitingOrderDialog"===this.popupSource.from&&"half_discount_select_level"===this.popupSource.type}}),methods:_(_({},Object(r.b)("payment",["getSubUrlAndThirdType","getSubscriptionList","setPopupSource"])),{},{toMall:function(){window.open(this.localePath("/mall"),"_blank")},calculateTotalStamina:function(){var e,t=365*(null===(e=this.selectedLevelItem)||void 0===e?void 0:e.every_day_temp_coins);return t>1e3?"".concat(Math.floor(t/100)/10,"k"):t},show:function(e,t){var n,o,r;(this.dotFrom=t,this.handleLogEvent("pop_1"),this.updateGoodsData(),this.validPopupSource)&&(this.step=this.popupSource.step||"inPay",this.goodsId=(null===(n=this.popupSource.pageFromData)||void 0===n?void 0:n.goodsId)||"",this.btnLabel=(null===(o=this.popupSource.pageFromData)||void 0===o?void 0:o.btnLabel)||"",this.defaultThirdType=(null===(r=this.popupSource.pageFromData)||void 0===r?void 0:r.defaultThirdType)||0)},close:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).showAwaitingOrder,t=void 0!==e&&e;this.$emit("close",{showAwaitingOrder:t}),this.setPopupSource(null),this.$logEvent("log_actions",{operation:"click_close",behavior_info:"on_50_percent_off_popup_lifetime_once",behavior_info_sub:"yearly"})},quitPay:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&!this.validPopupSource&&!this.$refs.paymentFormRef.useTry)return this.close({showAwaitingOrder:!0}),this.step="inGoods",void this.$EventBus.$emit("showDialog",{name:"AwaitingOrderDialog",data:{id:this.goodsId,quantity:0,paymentFormProps:this.$refs.paymentFormRef.$options.propsData,dotFrom:this.dotFrom||"",sourceDialog:"HalfDiscountDialogSelectLevel",pageFromData:{btnLabel:this.btnLabel,goodsId:this.goodsId,defaultThirdType:this.defaultThirdType}}});this.step="inGoods"},success:function(){this.step="inGoods",this.close()},updateGoodsData:function(){var e=this;this.getSubscriptionList().then((function(t){var n,o=t.data,r=(void 0===o?{}:o)||{},l=r.month,c=void 0===l?[]:l,d=r.year,h=(void 0===d?[]:d).map((function(e,t){return _(_({},e),{},{monthly_id:c[t].id,original_price:c[t].price,original_price_cn:c[t].price_cn})}));h.shift(),e.levelArr=h.map((function(t){var n=t.id,o=t.monthly_id,r=t.price_month,l=t.original_price,c=t.price_month_cn,d=t.original_price_cn,h=t.price,m=t.price_cn,v=t.local_price_web,f=t.activity,_=t.every_day_temp_coins,w=t.discount;return e.apiMonetaryUnit||(e.apiMonetaryUnit=null==v?void 0:v.currency),{activity:f,label:{sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"master"}[n],monthly_id:o,yearly_id:n,original_m_p_en:l,now_m_p_en:r,original_m_p_zh:d,now_m_p_zh:c,now_total_price_en:h,now_total_price_cn:m,now_m_p:null==v?void 0:v.price,original_m_p:null==v?void 0:v.price_old,monetaryUnit:null==v?void 0:v.currency,every_day_temp_coins:_,discount:w}}));var m=["standard","professional","master"],v=(null===(n=e.paymentInfo)||void 0===n?void 0:n.productLevel)||1;if(3===e.popType)switch(v){case 1:case 2:m=["standard","professional","master"];break;case 3:m=["professional","master"],e.selectedLevel="professional";break;case 4:m=["master"],e.selectedLevel="master"}if(4===e.popType)switch(v){case 1:m=["standard","professional","master"];break;case 2:m=["professional","master"],e.selectedLevel="professional";break;case 3:m=["master"],e.selectedLevel="master"}e.levelArr=e.levelArr.filter((function(e){return m.includes(e.label)})),e.isT1Country&&e.levelArr.sort((function(a,b){var e={standard:1,master:2,professional:3};return e[a.label]-e[b.label]}))}))},getBenefitsByLevel:function(e){var t=[{name:"Fast Generation",text:"newShopTips7"},{name:"Quality Mode",text:"qualityMode",tooltip:"daily_rights_15_tip"},{name:"Run Tasks Simultaneously",text:"simultaneousTasksCount"},{name:"Al Character Premium Model",text:"aiPremiumModel"},{name:"Credit Packs 5% Bonus",text:"creditPacksBonus"},{name:"Download Without Watermark",text:"DownloadWithoutWatermark"},{name:"Private Generation",text:"privateGeneration"},{name:"Unlimited Free Creation",text:"FreeUnlimitedCreations",tooltip:"daily_rights_2_tip_new"}];[].concat(t);return{standard:[].concat(t),professional:[].concat(t),master:[].concat(t)}[e]||t},handleLogEvent:function(sub){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.from,behavior_info_sub:sub,user_type:this.popType})},handleSelectLevel:function(label){this.selectedLevel=label,this.$logEvent("log_actions",{operation:"click_".concat(label,"_sku"),behavior_info:"on_50_percent_off_popup_lifetime_once",behavior_info_sub:"yearly"})},subscriptionNow:function(){var e=this;this.handleLogEvent("pop_2");var t=(this.levelArr.find((function(i){return i.label==e.selectedLevel}))||{}).yearly_id,n=void 0===t?"":t;this.btnLabel=this.getBtnLabel,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}})),this.$logEvent("log_actions",{operation:"click_upgrade",behavior_info:"on_50_percent_off_popup_lifetime_once",behavior_info_sub:"yearly"})}}),mounted:function(){var e=this;this._unwatchCountdown=this.$watch((function(){return e.halfDiscountCountdown}),(function(t){if(t&&void 0!==t.hours&&3600*Number(t.hours)+60*Number(t.minutes)+Number(t.seconds)<=0){var n=(new Date).toISOString().split("T")[0];localStorage.setItem("retention_dialog_last_shown",n),e.$emit("close")}}),{deep:!0,immediate:!0})},beforeDestroy:function(){this._unwatchCountdown&&(this._unwatchCountdown(),this._unwatchCountdown=null)}},y=w,C=(n(4521),n(0)),component=Object(C.a)(y,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"select-level",class:n.selectedLevel},["inGoods"===n.step?o("div",{staticClass:"select-level-container"},[o("div",{staticClass:"close-button",on:{click:function(e){return n.close({showAwaitingOrder:n.validPopupSource})}}},[o("i",{staticClass:"el-icon-close"})]),n._v(" "),o("div",{staticClass:"left-section"},[o("div",{staticClass:"new-title-section"},[o("div",{staticClass:"new-title-bg"},[o("div",{staticClass:"new-title-row"},[o("span",{staticClass:"title-divider left-divider"}),n._v(" "),o("span",{staticClass:"new-title-text"},[n._v(n._s(n.$t("limitedTime")))]),n._v(" "),o("span",{staticClass:"title-divider right-divider"})])]),n._v(" "),o("div",{staticClass:"new-timer-section"},[o("div",{staticClass:"countdown-text"},[n.halfDiscountCountdown&&void 0!==n.halfDiscountCountdown.hours?o("span",[o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.hours).padStart(2,"0")[0]))]),n._v(" "),o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.hours).padStart(2,"0")[1]))]),n._v(" "),o("span",{staticClass:"separator"},[n._v(":")]),n._v(" "),o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.minutes).padStart(2,"0")[0]))]),n._v(" "),o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.minutes).padStart(2,"0")[1]))]),n._v(" "),o("span",{staticClass:"separator"},[n._v(":")]),n._v(" "),o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.seconds).padStart(2,"0")[0]))]),n._v(" "),o("span",{staticClass:"digit-box"},[n._v(n._s(String(n.halfDiscountCountdown.seconds).padStart(2,"0")[1]))])]):n._e()]),n._v(" "),o("div",{staticClass:"timer-light-purple"},[o("span",{staticClass:"timer-label"},[n._v(n._s(n.$t("hours").toUpperCase()))]),n._v(" "),o("span",{staticClass:"timer-label"},[n._v(n._s(n.$t("minutes").toUpperCase()))]),n._v(" "),o("span",{staticClass:"timer-label"},[n._v(n._s(n.$t("seconds").toUpperCase()))])])])]),n._v(" "),0===(null===(e=n.levelArr)||void 0===e?void 0:e.length)?o("div",{staticClass:"loading-box flex_c_m"},[o("lottie",{staticClass:"loading",attrs:{options:n.lottieOptions,height:110,width:110}})],1):o("div",{staticClass:"select-levels"},n._l(n.levelArr,(function(e){return o("div",{key:e.label,staticClass:"level-item-wrapper",class:{"active-wrapper":n.selectedLevel===e.label}},[o("div",{staticClass:"level-item",class:{active:n.selectedLevel===e.label},on:{click:function(t){return n.handleSelectLevel(e.label)}}},[o("div",{staticClass:"level-item-content"},[o("div",{staticClass:"check-mark"},[o("div",{staticClass:"circle"},[n.selectedLevel===e.label?o("i",{staticClass:"el-icon-check"}):n._e()])]),n._v(" "),o("div",{staticClass:"level-name"},[n._v(n._s(n.getLabel(e.label)))]),n._v(" "),o("div",{staticClass:"price-info"},[o("div",{staticClass:"monthly-price"},[o("span",{staticClass:"sign"},[n._v(n._s(null==e?void 0:e.monetaryUnit))]),n._v(" "),o("span",{staticClass:"price"},[o("TextFlip",{attrs:{isActive:n.selectedLevel===e.label}},[n._v("\n                      "+n._s(e.now_m_p)+"\n                    ")])],1),n._v(" "),o("span",{staticClass:"unit"},[n._v("/"+n._s(n.$t("Month")))])]),n._v(" "),o("div",{staticClass:"price-details"},[o("div",{staticClass:"yearly-price"},[o("span",{staticClass:"sign"},[n._v(n._s(null==e?void 0:e.monetaryUnit))]),n._v(" "),o("span",{staticClass:"price"},[n._v(n._s((12*e.now_m_p).toFixed(2)))]),n._v(" "),o("span",{staticClass:"unit"},[n._v("/"+n._s(n.$t("year")))])]),n._v(" "),o("div",{staticClass:"original-price"},[o("span",{staticClass:"sign"},[n._v(n._s(null==e?void 0:e.monetaryUnit))]),n._v(" "),o("span",{staticClass:"price"},[n._v(n._s((12*e.original_m_p).toFixed(2)))]),n._v(" "),o("span",{staticClass:"unit"},[n._v("/"+n._s(n.$t("year")))])])])])]),n._v(" "),o("div",{staticClass:"discount-tag",style:n.getBg},[n._v("50% Off")]),n._v(" "),"standard"===e.label?o("div",{staticClass:"best-value-tag"},[o("span",{staticClass:"best-value-text"},[n._v(n._s(n.$t("bestValue")))])]):n._e()]),n._v(" "),n.halfDiscountCountdown&&n.selectedLevel===e.label?o("div",{staticClass:"countdown-bar",attrs:{translate:"no"}},[o("span",{staticClass:"countdown-info"},[n._v("\n              "+n._s(n.$t("SaveNumPercentOnPlan",{num:e.discount}))+"\n            ")])]):n._e()])})),0),n._v(" "),o("div",{staticClass:"left-more",on:{click:n.toMall}},[n._v("\n        "+n._s(n.$t("viewMore"))+"\n        "),o("i",{staticClass:"el-icon-arrow-right"})]),n._v(" "),o("el-button",{staticClass:"upgrade-button",on:{click:n.subscriptionNow}},[n._v("\n        "+n._s(n.$t("Upgrade50off"))+"\n        "),o("i",{staticClass:"el-icon-arrow-right"}),n._v(" "),o("i",{staticClass:"el-icon-arrow-right"})])],1),n._v(" "),o("div",{staticClass:"right-section"},[o("div",{staticClass:"benefits-header"},[o("h2",[n._v(n._s(n.$t("LevelPlanBenefits",{level:n.getLabel(n.selectedLevel)})))]),n._v(" "),o("TextFlip",{key:n.selectedLevel,attrs:{"is-active":!0}},[null!==(t=n.selectedLevelItem)&&void 0!==t&&t.every_day_temp_coins?o("div",{staticClass:"stamina-info",class:"text-gradient-".concat(n.selectedLevel)},[n._v("\n            "+n._s(n.formattedStaminaTotal)+"\n          ")]):n._e()])],1),n._v(" "),o("div",{staticClass:"benefits-list"},n._l(n.getBenefitsByLevel(n.selectedLevel),(function(e,t){return o("div",{key:t,staticClass:"benefit-item"},[n._m(0,!0),n._v(" "),o("span",[n._v(n._s(n.$t(e.text)))]),n._v(" "),e.tooltip?o("CTooltip",{attrs:{content:e.tooltip}}):n._e()],1)})),0),n._v(" "),o("div",{staticClass:"users-info"},[o("img",{staticClass:"user-group-image",attrs:{src:"https://image.cdn2.seaart.me/20250410/d083f35e-e9f0-48e4-97f6-0466dce32154_high.webp",alt:"User avatars"}}),n._v(" "),o("div",{staticClass:"users-count"},[n._v(n._s(n.$t("PeopleAlreadyPurchased")))])])])]):n._e(),n._v(" "),"inPay"===n.step?o("PaymentForm",{ref:"paymentFormRef",attrs:{defaultThirdType:n.defaultThirdType,disabledMethods:[],initMount:!0,upgrade:n.isUpgrade,goodsId:n.goodsId,purchParams:{},btnLabel:n.btnLabel},on:{"in-pay-back":n.quitPay,"pay-success":n.success}},[o("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):n._e()],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"octagon-check"},[e("i",{staticClass:"el-icon-check"})])}],!1,null,"34c0b5c4",null);t.default=component.exports;installComponents(component,{TextFlip:n(1178).default,CTooltip:n(565).default})},3375:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(3),r=n(2),l=(n(8),n(20),n(1)),c=n(3376),d=n(126),h=n(127);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"RetentionDialogContainer",provide:function(){return{top:this}},components:{RetentionDialog:c.default,PaymentForm:d.a,RightPart:h.a},data:function(){return{isVisible:!1,step:"inRetention",selectedLevel:null,levelData:null,goodsId:"",btnLabel:"",defaultThirdType:0,dotFrom:"on_50_percent_off_popup_lifetime_once_retain",paymentFormProps:{}}},computed:v(v({},Object(l.e)("payment",["subThirdType","defaultAwaitingOrderCountdown"])),{},{dialogWidth:function(){return"inPay"===this.step?"960px":"460px"},dialogHeight:function(){return"inPay"===this.step?"640px":"auto"}}),methods:v(v(v({},Object(l.b)("payment",["getSubUrlAndThirdType","setAwaitingOrderPoppTime","updateStoragePopupState"])),Object(l.d)("payment",["SET_AWAITING_ORDER_HAS_LOCAL_INFO"])),{},{show:function(e,data){this.selectedLevel=e,this.levelData=data,this.goodsId=(null==data?void 0:data.yearly_id)||"",this.step="inRetention",this.btnLabel=this.$t("Upgrade50off"),this.isVisible=!0,this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_50_percent_off_popup_lifetime_once_retain",behavior_info_sub:"pop_1"})},handleRetentionClose:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("upgrade"!==e){n.next=21;break}if(!t.subThirdType){n.next=8;break}t.defaultThirdType=t.subThirdType,t.step="inPay",t.$nextTick((function(){var e;t.paymentFormProps=null===(e=t.$refs.paymentFormRef)||void 0===e?void 0:e.$options.propsData})),t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_50_percent_off_popup_lifetime_once_retain",behavior_info_sub:"pop_2"}),n.next=19;break;case 8:return n.prev=8,n.next=11,t.getSubUrlAndThirdType();case 11:1e4===(null==(r=n.sent)||null===(o=r.status)||void 0===o?void 0:o.code)?(t.defaultThirdType=null===(l=r.data)||void 0===l?void 0:l.third_type,t.step="inPay",t.$nextTick((function(){var e;t.paymentFormProps=null===(e=t.$refs.paymentFormRef)||void 0===e?void 0:e.$options.propsData}))):(console.error("Failed to get payment type"),t.closeDialog()),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(8),console.error("Error fetching payment type:",n.t0),t.closeDialog();case 19:n.next=22;break;case 21:t.closeDialog(e);case 22:case"end":return n.stop()}}),n,null,[[8,15]])})))()},quitPay:function(){this.paymentFormProps&&Object.keys(this.paymentFormProps).length&&this.saveAwaitingOrderInfo(),this.closeDialog()},handlePaySuccess:function(){this.closeDialog("pay_success")},closeDialog:function(e){this.isVisible=!1,this.$emit("close",e),this.step="inRetention",this.selectedLevel=null,this.levelData=null,this.goodsId="",this.defaultThirdType=0,this.isShowPayForm=!1},saveAwaitingOrderInfo:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.SET_AWAITING_ORDER_HAS_LOCAL_INFO(!1),t.next=3,e.$nextTick();case 3:return localStorage.setItem("awaitingPaymentOrderInfo",JSON.stringify({id:e.paymentFormProps.goodsId,quantity:0,paymentFormProps:e.paymentFormProps,dotFrom:e.dotFrom,sourceDialog:"HalfDiscountDialogRetentionDialog"})),n=Date.now()+60*e.defaultAwaitingOrderCountdown*1e3,t.next=7,e.setAwaitingOrderPoppTime(n);case 7:e.updateStoragePopupState("AwaitingOrderDialog"),e.SET_AWAITING_ORDER_HAS_LOCAL_INFO(!0);case 9:case"end":return t.stop()}}),t)})))()}}),watch:{isVisible:function(e){e||(this.selectedLevel||"inPay"===this.step)&&this.closeDialog()}}},_=(n(4524),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"retention-dialog-container",attrs:{visible:e.isVisible,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"show-close":!1,width:e.dialogWidth},on:{"update:visible":function(t){e.isVisible=t}}},["inRetention"===e.step&&e.selectedLevel&&e.levelData?t("RetentionDialog",{attrs:{selectedLevel:e.selectedLevel,levelData:e.levelData},on:{close:e.handleRetentionClose}}):e._e(),e._v(" "),"inPay"===e.step?t("PaymentForm",{ref:"paymentFormRef",attrs:{defaultThirdType:e.defaultThirdType,disabledMethods:[],initMount:!0,upgrade:!0,goodsId:e.goodsId,purchParams:{},btnLabel:e.btnLabel},on:{"in-pay-back":e.quitPay,"pay-success":e.handlePaySuccess}},[t("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):e._e()],1)}),[],!1,null,"148ce1ab",null);t.default=component.exports},3376:function(e,t,n){"use strict";n.r(t);n(65),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(16),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"RetentionDialog",props:{selectedLevel:{type:String,required:!0,validator:function(e){return["standard","professional","master"].includes(e)}},levelData:{type:Object,required:!0}},computed:c(c(c({},Object(r.e)("user",["cdnHost"])),Object(r.c)("payment",["paymentInfo"])),{},{getLabel:function(){var e=this;return function(t){return e.$t({standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[t]||"")}}}),methods:{closeDialog:function(e){this.$emit("close",e)}}},h=(n(4523),n(0)),component=Object(h.a)(d,(function(){var e,t,n,o,r,l,c=this,d=c._self._c;return d("div",{staticClass:"retention-dialog",class:c.selectedLevel},[d("div",{staticClass:"dialog-content"},[d("div",{staticClass:"close-button",on:{click:function(e){return c.closeDialog("confirm")}}},[d("i",{staticClass:"el-icon-close"})]),c._v(" "),d("div",{staticClass:"header"},[d("h2",[c._v(c._s(c.$t("GiveUpDiscount")))]),c._v(" "),d("p",[c._v(c._s(c.$t("ConfirmGiveUpDeal")))])]),c._v(" "),d("div",{staticClass:"plan-details-wrapper level-item-wrapper active-wrapper",class:c.selectedLevel},[d("div",{staticClass:"plan-details level-item",class:[c.selectedLevel,{active:!0}]},[d("div",{staticClass:"level-name"},[c._v(c._s(c.getLabel(c.selectedLevel)))]),c._v(" "),d("div",{staticClass:"price-info"},[d("div",{staticClass:"monthly-price"},[d("span",{staticClass:"sign"},[c._v(c._s(null===(e=c.levelData)||void 0===e?void 0:e.monetaryUnit))]),c._v(" "),d("span",{staticClass:"price"},[c._v(c._s(null===(t=c.levelData)||void 0===t?void 0:t.now_m_p))]),c._v(" "),d("span",{staticClass:"unit"},[c._v("/"+c._s(c.$t("Month")))])]),c._v(" "),d("div",{staticClass:"price-details"},[d("div",{staticClass:"yearly-price"},[d("span",{staticClass:"sign"},[c._v(c._s(null===(n=c.levelData)||void 0===n?void 0:n.monetaryUnit))]),c._v(" "),d("span",{staticClass:"price"},[c._v(c._s((12*(null===(o=c.levelData)||void 0===o?void 0:o.now_m_p)).toFixed(2)))]),c._v(" "),d("span",{staticClass:"unit"},[c._v("/"+c._s(c.$t("year")))])]),c._v(" "),d("div",{staticClass:"original-price"},[d("span",{staticClass:"sign"},[c._v(c._s(null===(r=c.levelData)||void 0===r?void 0:r.monetaryUnit))]),c._v(" "),d("span",{staticClass:"price"},[c._v(c._s((12*(null===(l=c.levelData)||void 0===l?void 0:l.original_m_p)).toFixed(2)))]),c._v(" "),d("span",{staticClass:"unit"},[c._v("/"+c._s(c.$t("year")))])])]),c._v(" "),d("div",{staticClass:"payment-type"},[c._v(c._s(c.$t("planTypeYear")))])])])]),c._v(" "),d("div",{staticClass:"users-info"},[d("img",{staticClass:"user-group-image",attrs:{src:"https://image.cdn2.seaart.me/20250410/d083f35e-e9f0-48e4-97f6-0466dce32154_high.webp",alt:"User avatars"}}),c._v(" "),d("div",{staticClass:"users-count"},[c._v(c._s(c.$t("PeopleAlreadyPurchased")))])]),c._v(" "),d("div",{staticClass:"action-buttons"},[d("el-button",{staticClass:"upgrade-button",on:{click:function(e){return c.closeDialog("upgrade")}}},[c._v("\n        "+c._s(c.$t("Upgrade50off"))+"\n      ")]),c._v(" "),d("div",{staticClass:"confirm-give-up",on:{click:function(e){return c.closeDialog("confirm")}}},[d("div",{staticClass:"confirm-text"},[c._v(c._s(c.$t("ConfirmToGiveUp")))]),c._v(" "),d("div",{staticClass:"understand-text"},[c._v(c._s(c.$t("UnderstandMightMiss50Off",{num:50})))])])],1)])])}),[],!1,null,"def820da",null);t.default=component.exports},3440:function(e,t,n){"use strict";n.r(t);var o=n(801),r=(n(4135),n(0)),component=Object(r.a)(o.a,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"OPSIndexPage"},[t("nav",[t("div",{staticClass:"dict-button-box",on:{click:function(t){return e.toggleDictPad()}}},[t("el-tooltip",{staticClass:"dict-tooltip",attrs:{placement:"top",content:e.$t("OPS_dictionary")}},[t("button",{staticClass:"dict-button"},[t("i",{staticClass:"iconfont icon-book"})])])],1)]),e._v(" "),t("PromptEditor",{ref:"PromptEditor",attrs:{"init-prompts":e.initPrompts}}),e._v(" "),e.needDictPad?t("section",{directives:[{name:"show",rawName:"v-show",value:e.showDictPad,expression:"showDictPad"}],staticClass:"PromptDictPad"},[t("div",{staticClass:"title"},[t("button",{staticClass:"icon close-button",on:{click:function(t){return e.toggleDictPad(!1)}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("PromptDict")],1):e._e()],1)}),[],!1,null,null,null);t.default=component.exports},401:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(6),n(12),n(13);var o=n(3),r=n(2),l=(n(20),n(19),n(199),n(22),n(49),n(8),n(4),n(40),n(7),n(41),n(26),n(51)),c=n(29),d=n(104),h=n(10),m=n(1),v=n(264),f=n(121),_=n.n(f),w=n(3112),y=n(57);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"generateRedrawModal",props:{mask:{type:String,default:function(){return""}},needMixedMask:{type:Boolean,default:!1}},mixins:[w.default],data:function(){return{dialogVisible:!1,intLoading:!0,intImg:{url:"",width:0,height:0,size:50},MasterDrawing:"",intHeight:0,intWidth:0,mouseX:0,mouseY:0,isMousedown:!1,sizeList:[{name:"400%",value:400},{name:"200%",value:200},{name:"125%",value:125},{name:"100%",value:100},{name:"75%",value:75},{name:"50%",value:50},{name:"30%",value:30},{name:"20%",value:20},{name:"10%",value:10},{name:"fitToScreen",value:50},{name:"ai_erase3",value:100}],toolType:"smear",toolList:[{name:this.$t("erasePage1"),icon:"iconfont icon-tumo",value:"smear"},{name:this.$t("fastToolsEraser"),icon:"iconfont icon-icon_zidongcachu",value:"eraser"},{name:this.$t("addMaticSelection"),icon:"iconfont icon-jianyiban",value:"quick"},{name:this.$t("cancelMaticSelection"),icon:"iconfont icon-jianyiban",value:"cancelQuick"}],brushSize:40,canvas:null,context:null,startX:0,startY:0,blankCanvas:"",currentStep:-1,historyList:[],isDrawing:!1,uploading:!1,UPLOAD:new l.a({type:2}),drewPoints:[],rectList:[],imgSegmentUrlList:[],hoverMaskUrl:"",hasHover:!0,debounceHandleMouseMove:null,imagesList:[],loading:!1,inTimes:!1,retryCount:0,jsonUrl:"",imgUrl:"",imgShow:!0,lengthOfLongSide:0,consumption:1,minScaleSize:10,maxScaleSize:400,mixedMaskUrl:""}},watch:{dialogVisible:{handler:function(e){e||(this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing="")}}},components:{generateRectItem:v.default},computed:S(S({},Object(m.c)("user",["isLoggedIn","accountSettingsData","cdnHostFun"])),{},{setCanvasStyle:function(){var e="";if(["smear","eraser"].includes(this.toolType)){var t=this.brushSize;t<10&&(t=10);var n='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 ').concat(t," ").concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat(t/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),o=btoa(n),r="data:image/svg+xml;base64,".concat(o);e="url(".concat(r,") ").concat(t/2," ").concat(t/2,", auto")}return"rectangle"==this.toolType&&(e="url(https://".concat(this.cdnHostFun(),"/20240312/cb26a6cd-7ca5-4e32-a633-df7094cb570d.cur) 8 8, auto")),"noose"==this.toolType&&(e="url(https://".concat(this.cdnHostFun(),"/20240307/3b553f30-1a01-4287-85b9-b1840754b717.cur) 8 8, auto")),"drag"==this.toolType&&(e="grab"),e}}),created:function(){this.debounceHandleMouseMove=Object(d.throttle)(this.handleMouseMove,300)},mounted:function(){document.addEventListener("keydown",this.shortcutKey)},beforeDestroy:function(){document.removeEventListener("keydown",this.shortcutKey)},methods:{setImageZoomIn:function(){this.intImg.size+10>=this.maxScaleSize?this.intImg.size=this.maxScaleSize:this.intImg.size+=10},setImageZoomOut:function(){this.intImg.size-10<=this.minScaleSize?this.intImg.size=this.minScaleSize:this.intImg.size-=10},resetData:function(){this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing=""},reupload:function(){this.$emit("reupload")},shortcutKey:function(e){(e.ctrlKey||e.metaKey)&&e.shiftKey&&"z"===e.key.toLowerCase()?this.handleNext():(e.ctrlKey||e.metaKey)&&"z"===e.key.toLowerCase()&&this.handlePre()},dwn:function(){Object(h.M)(this.imgUrl)},changeTool:function(e){this.toolType=e.value,this.setDrawType(),["cancelQuick","quick"].includes(this.toolType)&&!this.imgSegmentUrlList.length&&this.getSegmentMaskData()},handleMouseMove:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.checkCoordinate(e.offsetX,e.offsetY,t.imagesList);case 2:(o=n.sent)>=0&&t.hasHover&&t.setHoverMask(o);case 4:case"end":return n.stop()}}),n)})))()},getCacheSegmentMaskData:function(){var e=arguments;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!["",null,void 0].includes(n=e.length>0&&void 0!==e[0]?e[0]:"")){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,_.a.getItem(n);case 5:return o=t.sent,t.abrupt("return",o||null);case 7:case"end":return t.stop()}}),t)})))()},setHoverMask:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0,-1].includes(e)){n.next=3;break}return t.hoverMaskUrl="",n.abrupt("return");case 3:(r=new Image).src=t.imgSegmentUrlList[e],r.onload=Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=document.createElement("canvas")).width=t.intImg.width,n.height=t.intImg.height,(o=n.getContext("2d")).clearRect(0,0,t.intImg.width,t.intImg.height),o.globalCompositeOperation="source-in",o.fillStyle="#fff",o.fillRect(0,0,t.intImg.width,t.intImg.height),o.globalCompositeOperation="source-over",o.drawImage(r,0,0,t.intImg.width,t.intImg.height),t.hoverMaskUrl=n.toDataURL();case 11:case"end":return e.stop()}}),e)})));case 6:case"end":return n.stop()}}),n)})))()},selectRegion:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["cancelQuick","quick"].includes(t.toolType)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.checkCoordinate(e.offsetX,e.offsetY,t.imagesList);case 4:(o=n.sent)>=0&&t.selectSegmentMask(o);case 6:case"end":return n.stop()}}),n)})))()},cancelSelectSegmentMask:function(e){var t=document.createElement("canvas"),n=this.intImg,o=n.width,r=n.height;t.width=o,t.height=r;var l=t.getContext("2d"),c=new Image;c.src=this.imgSegmentUrlList[e],c.onload=function(){for(var e=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<e.length;i+=2)l.drawImage(c,4*e[i],4*e[i+1],o,r);l.drawImage(c,0,0,o,r);for(var t=l.getImageData(0,0,o,r).data,n=this.context.getImageData(0,0,o,r),d=n.data,h=0;h<r;h++)for(var m=0;m<o;m++){var v=4*(h*o+m);t[v+3]>0&&(d[v]=0,d[v+1]=0,d[v+2]=0,d[v+3]=0)}this.context.putImageData(n,0,0)}},selectSegmentMask:function(e){var t=this,n=new Image,o=this.$refs.canvas.getContext("2d"),r=this.intImg,l=r.width,c=r.height;n.src=this.imgSegmentUrlList[e],n.onload=function(){o.globalCompositeOperation=["cancelQuick"].includes(t.toolType)?"destination-out":"source-over";for(var e=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<e.length;i+=2)o.drawImage(n,4*e[i],4*e[i+1],l,c);o.drawImage(n,0,0,l,c),t.saveToHistory()}},checkCoordinate:function(e,t,n){var r=this;return Object(o.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",r.detectClickedImage(e,t,n));case 1:case"end":return o.stop()}}),o)})))()},detectClickedImage:function(e,t,n){for(var o=this.canvas.width/this.canvas.offsetWidth,i=n.length-1;i>=0;i--){var r=n[i],l=parseInt(e*o),c=parseInt(t*o);if(this.checkPixelTransparency(r,l,c))return i}},checkPixelTransparency:function(e,t,n){return 0!==e.data[4*(t+n*e.width)+3]},getSegmentMaskData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,d,h,m,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.loading||e.imgSegmentUrlList.length||e.uploading)){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,t.next=5,e.getCacheSegmentMaskData(null===(n=e.intImg)||void 0===n?void 0:n.url);case 5:if(!(o=t.sent)||!o.imgSegmentUrlList.length){t.next=12;break}return l=(r=o||{}).imgSegmentUrlList,d=void 0===l?[]:l,h=r.imagesList,m=void 0===h?[]:h,e.imgSegmentUrlList=d,e.imagesList=m,e.loading=!1,t.abrupt("return");case 12:v={action:14,meta:{smart_edit:{uri:e.intImg.url}}},Object(c.createTask)(v).then((function(t){1e4==t.status.code&&e.getTaskInfo([t.data.id])})).catch((function(t){e.loading=!1}));case 14:case"end":return t.stop()}}),t)})))()},getTaskInfo:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o={};if(o.task_ids=e,o.scene=1,!["cancelQuick","quick"].includes(this.toolType))return this.inTimes&&clearTimeout(this.inTimes),this.loading=!1,this.uploading=!1,void(this.intLoading=!1);Object(c.batchFetchTaskProcess)(o).then((function(o){var r,l,c,d,h;if(1e4==o.status.code)if(null!==(r=o.data)&&void 0!==r&&r.items[0]&&3==(null===(l=o.data)||void 0===l||null===(l=l.items[0])||void 0===l?void 0:l.status))if(clearTimeout(t.inTimes),t.jsonUrl=null===(h=o.data)||void 0===h?void 0:h.items[0].segment,1==n)t.loadJsonFile(t.jsonUrl);else{var m,v;t.imgUrl=null===(m=o.data)||void 0===m||null===(m=m.items[0])||void 0===m||null===(m=m.img_uris[0])||void 0===m?void 0:m.url;var img=new Image;img.src=null===(v=o.data)||void 0===v||null===(v=v.items[0])||void 0===v||null===(v=v.img_uris[0])||void 0===v?void 0:v.url,img.onload=function(){t.intImg.url=img.src,t.uploading=!1,t.loading=!1,t.intLoading=!1,t.rectList=[],t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.saveToHistory()},img.onerror=function(){t.intImg.url=img.src,t.uploading=!1,t.loading=!1,t.intLoading=!1,t.rectList=[],t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.saveToHistory()}}else null!==(c=o.data)&&void 0!==c&&c.items[0]&&4==(null===(d=o.data)||void 0===d||null===(d=d.items[0])||void 0===d?void 0:d.status)?(clearTimeout(t.inTimes),t.loading=!1,t.intLoading=!1,t.uploading=!1):(clearTimeout(t.inTimes),t.inTimes=setTimeout((function(){t.getTaskInfo(e,n)}),1e3))})).catch((function(e){t.loading=!1,t.uploading=!1,t.intLoading=!1}))},loadJsonFile:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch(t).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initCanvas(null==data?void 0:data.result);case 2:e.loading=!1;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(n){0===e.retryCount?(e.loadJsonFile(t).finally((function(){e.loading=!1})),e.retryCount++):e.$message.error(e.$t("ServerError"))}))},initCanvas:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var data,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=e.length>0&&void 0!==e[0]?e[0]:[],t.imgSegmentUrlList=data.map((function(e){return"data:image/png;base64,".concat(e.mask_png)})),n.next=4,t.loadAllMask(t.imgSegmentUrlList);case 4:if(t.imagesList=n.sent,!t.imagesList.length){n.next=10;break}return{},r={imgSegmentUrlList:t.imgSegmentUrlList,imagesList:t.imagesList},n.next=10,_.a.setItem(null===(o=t.intImg)||void 0===o?void 0:o.url,r);case 10:case"end":return n.stop()}}),n)})))()},loadAllMask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.intImg||{},n=t.width,o=t.height,r=(source||[]).map((function(e){return new Promise((function(t,n){var img=new Image;img.onload=function(){return t(img)},img.onerror=function(e){return n(e)},img.src=e}))}));return Promise.all(r).then((function(t){for(var r=[],i=0;i<t.length;i++){var img=t[i],l=document.createElement("canvas");l.width=n,l.height=o;var c=l.getContext("2d");c.drawImage(img,0,0,e.intImg.width,e.intImg.height);var d=c.getImageData(0,0,e.intImg.width,e.intImg.height);d.data;c.putImageData(d,0,0);var h=l.toDataURL();e.$set(e.imgSegmentUrlList,i,h);var m=c.getImageData(0,0,e.intImg.width,e.intImg.height);r.push(m),l=null,c=null}return r}))},show:function(e){var t=this;this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url="",this.imgUrl="",this.mixedMaskUrl="",this.maskImageSourceUrl="",this.MasterDrawing="",this.imagesList=[],this.debounceHandleMouseMove=Object(d.throttle)(this.handleMouseMove,300),this.intLoading=!0,this.$nextTick((function(){t.intImg.url=e,t.MasterDrawing=e,t.dialogVisible=!0,t.imgLoad()}))},intSize:function(){var e=window.innerHeight-240,t=this.intImg.height;this.intImg.width>2*this.intImg.height&&(e=window.innerWidth-100,t=window.innerWidth),this.intImg.size=parseInt(e/t*100)},changeSize:function(e){var t=this;if("fitToScreen"===e.name){var n=this.$refs.draggable;return n.style.left=null,n.style.top=null,void this.$nextTick((function(){t.intSize()}))}this.intImg.size=e.value},setConsumption:function(){this.consumption=1,this.lengthOfLongSide>=1024&&this.lengthOfLongSide<=2048?this.consumption=1.5:this.lengthOfLongSide>=2048&&this.lengthOfLongSide<=4096&&(this.consumption=4)},setDrawType:function(){this.context&&(this.context.globalCompositeOperation="eraser"===this.toolType?"destination-out":"source-over")},imgLoad:function(){this.intLoading=!0;var img=new Image;img.src=this.intImg.url;var e=this;img.onload=function(){e.lengthOfLongSide=Math.max(this.width,this.height),e.setConsumption(),e.intImg.width=this.width,e.intImg.height=this.height,e.intSize(),e.intLoading=!1,e.$nextTick(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canvas=e.$refs.canvas,e.context=e.canvas.getContext("2d"),e.context.fillStyle="rgba(255, 255, 255, 1)",e.context.lineJoin="round",e.context.lineCap="round",e.rectCanvas=e.$refs.rectCanvas,e.rectText=e.rectCanvas.getContext("2d"),e.rectText.strokeStyle="rgba(0,0,0,1)",e.rectText.fillStyle="rgba(255, 255, 255, 1)",e.rectText.lineJoin="round",e.rectText.lineCap="round",e.blankCanvas=e.canvas.toDataURL(),!e.mask){t.next=15;break}return t.next=15,e.displayMaskToCanvas(e.mask);case 15:e.saveToHistory();case 16:case"end":return t.stop()}}),t)}))))},img.onerror=function(){e.$message.error(e.$t("ai_erase4")),e.intLoading=!1}},displayMaskToCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this;return new Promise((function(n,o){var img=new Image;img.onload=function(){t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.drawImage(img,0,0,t.canvas.width,t.canvas.height),n()},img.onerror=function(e){console.log(e,"局部重绘图片回填失败"),n()},img.src=e}))},downElement:function(e){if("drag"===this.toolType){this.isMousedown=!0;var t=this.$refs.draggable;this.mouseX=e.clientX-t.offsetLeft,this.mouseY=e.clientY-t.offsetTop}},moveElement:function(e){if(this.isMousedown&&"drag"===this.toolType){var t=this.$refs.draggable;t.style.left=e.clientX-this.mouseX+"px",t.style.top=e.clientY-this.mouseY+"px"}},seupElement:function(){"drag"===this.toolType&&(this.isMousedown=!1)},startDrawing:function(e){if(["smear","eraser","noose"].includes(this.toolType))if(this.isDrawing=!0,this.startX=e.offsetX,this.startY=e.offsetY,["smear","eraser"].includes(this.toolType))this.context.strokeStyle="#fff",this.context.lineWidth=this.brushSize<10?10:this.brushSize,this.context.setLineDash([]);else if("noose"==this.toolType){var t=this.$refs.draggable;this.context.strokeStyle="rgba(0,0,0,1)";var n=t.getBoundingClientRect();this.drewPoints.push([{x:e.clientX-n.left,y:e.clientY-n.top}]),this.context.setLineDash([10,5]),this.context.lineWidth=2}},draw:function(e){if(this.isDrawing){var t,n,o=this.canvas.width/this.canvas.offsetWidth;if(this.context.scale(o,o),["smear","eraser"].includes(this.toolType)){var r=e.offsetX,l=e.offsetY;this.context.beginPath(),this.context.moveTo(this.startX,this.startY),this.context.lineTo(r,l),this.context.stroke(),this.startX=r,this.startY=l}else if("noose"==this.toolType){var c,d,h=this.$refs.draggable.getBoundingClientRect();c=e.clientX,d=e.clientY;var m=this.drewPoints[this.drewPoints.length-1];m.push({x:c-h.left,y:d-h.top});var v=m[0],f=m[1],_=m.length;this.context.beginPath(),this.context.moveTo(v.x,v.y);for(var i=1;i<_;i++){var w=(n=f,{x:(t=v).x+(n.x-t.x)/2,y:t.y+(n.y-t.y)/2});this.context.quadraticCurveTo(v.x,v.y,w.x,w.y),v=m[i],f=m[i+1]}this.context.lineTo(v.x,v.y),this.context.stroke()}this.context.scale(1/o,1/o)}},stopDrawing:function(){["smear","noose","eraser"].includes(this.toolType)&&this.isDrawing&&(this.isDrawing=!1,"noose"===this.toolType&&(this.context.closePath(),this.context.stroke(),this.context.fill()),this.saveToHistory())},startRectDrawing:function(e){"rectangle"===this.toolType&&(this.isDrawing=!0,this.startX=e.offsetX,this.startY=e.offsetY)},rectDraw:function(e){var t=this;if(this.isDrawing){var n=e.offsetX,o=e.offsetY;this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height),this.$nextTick((function(){var e=t.rectCanvas.width/t.rectCanvas.offsetWidth;t.rectText.scale(e,e),t.rectText.beginPath(),t.rectText.rect(t.startX,t.startY,n-t.startX,o-t.startY),t.rectText.fill(),t.rectText.stroke(),t.rectText.scale(1/e,1/e)})),this.rectCanvas.style.zIndex=9999}},stopRectDrawing:function(e){if("rectangle"===this.toolType&&this.isDrawing){this.isDrawing=!1,this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height);var t=e.offsetX,n=e.offsetY;this.rectList.push({left:t-this.startX>0?this.startX:t,top:n-this.startY>0?this.startY:n,width:Math.abs(t-this.startX),height:Math.abs(n-this.startY)}),this.saveToHistory(),this.rectCanvas.style.zIndex=2}},rectDelete:function(e){this.rectList.splice(e,1)},rectChange:function(e){this.rectList[e.index].top=e.top,this.rectList[e.index].left=e.left,this.rectList[e.index].width=e.width,this.rectList[e.index].height=e.height},saveToHistory:function(){var e=JSON.parse(JSON.stringify(this.rectList)),t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),img=JSON.parse(JSON.stringify(this.intImg.url));this.currentStep++,1===this.currentStep&&this.historyList.splice(1,this.historyList.length-1),this.historyList.push({currentImageData:t,rects:e,img:img}),this.currentStep=this.historyList.length-1},handlePre:function(){this.historyList.length>0&&this.currentStep>0&&(this.currentStep--,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleNext:function(){this.currentStep<this.historyList.length-1&&(this.currentStep++,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleReset:function(){this.historyList.length>1&&(this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url=this.MasterDrawing,this.imgUrl="",this.imgLoad())},checkImageSize:function(e){var t=this;return new Promise((function(n,o){var r=new FileReader;r.onload=function(e){var img=new Image;img.onload=function(){var e=img.width,o=img.height;t.$set(t,"style",{width:e,height:o});var r=[e,o].every((function(e){return e<=4096}));n(r)},img.onerror=function(){o(!1)},img.src=e.target.result},r.readAsDataURL(e)}))},uploadMaskImage:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,i,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn){t.next=4;break}return e.$EventBus.$emit("openLoginDialog",{dot:!1}),e.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_createflow_page"}),t.abrupt("return");case 4:if(e.intImg.width){t.next=6;break}return t.abrupt("return");case 6:if(!e.uploading&&!e.loading){t.next=8;break}return t.abrupt("return");case 8:for(e.uploading=!0,e.loading=!0,(n=document.createElement("canvas")).width=e.intImg.width,n.height=e.intImg.height,(o=n.getContext("2d")).clearRect(0,0,n.width,n.height),r=e.context.getImageData(0,0,e.canvas.width,e.canvas.height),i=0;i<r.data.length;i+=4)255===r.data[i]&&255===r.data[i+1]&&255===r.data[i+2]||(r.data[i]=255,r.data[i+1]=255,r.data[i+2]=255);if(o.putImageData(r,0,0),l=e.canvas.width/e.canvas.offsetWidth,e.rectList.length>0&&e.rectList.forEach((function(e){o.fillStyle="rgba(255, 255, 255, 1)",o.beginPath(),o.rect(e.left*l,e.top*l,e.width*l,e.height*l),o.fill()})),(c=n.toDataURL("image/png",.1))!==e.blankCanvas){t.next=29;break}return e.uploading=!1,e.loading=!1,e.$emit("updateMask",""),e.uploading=!1,e.loading=!1,e.handleClose(),t.abrupt("return");case 29:e.uploading=!1,e.loading=!1,e.$emit("updateMask",c),e.handleClose();case 33:case"end":return t.stop()}}),t)})))()},uploadMixedMaskImage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!t)return this.mixedMaskUrl="",Promise.resolve();var n=Object(y.dataURItoBlob)(t);return this.UPLOAD.startUpload(n,{name:"img2img-mask".concat(Date.now(),".png"),type:"png",isRedirection:!0,category:46}).then((function(t){e.mixedMaskUrl=t}))},handleClose:function(){this.resetData(),this.dialogVisible=!1}}},x=k,I=(n(4118),n(4119),n(0)),component=Object(I.a)(x,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.dialogVisible,"custom-class":"c-generate-redraw-modal",fullscreen:!0,"append-to-body":"",modal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.intLoading,expression:"intLoading"}],staticClass:"main"},[t("div",{staticClass:"top"},[t("div",{staticClass:"topItem"},[t("div",{staticClass:"back",on:{click:function(t){e.dialogVisible=!1}}},[t("i",{staticClass:"el-icon-back"})])]),e._v(" "),t("div",{staticClass:"topItem",class:{disabledStyle:e.intLoading}},[t("div",{staticClass:"bntBox"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fastToolsUndo"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:!e.historyList.length||1==e.historyList.length||0==e.currentStep},on:{click:function(t){return e.handlePre()}}},[t("i",{staticClass:"iconfont icon-draw-board-icon3"})])]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fastToolsRedo"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:e.currentStep==e.historyList.length-1},on:{click:function(t){return e.handleNext()}}},[t("i",{staticClass:"iconfont icon-draw-board-icon2"})])]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("S_ResetPrompt"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:e.historyList.length<2},on:{click:function(t){return e.handleReset()}}},[t("i",{staticClass:"el-icon-refresh"})])])],1)]),e._v(" "),t("div",{staticClass:"topItem",staticStyle:{visibility:"hidden"}})]),e._v(" "),t("div",{staticClass:"right",class:{disabledStyle:e.intLoading}},[t("div",{staticClass:"dragIcon",on:{click:function(t){"drag"==e.toolType?e.toolType="smear":e.toolType="drag"}}},[t("i",{staticClass:"iconfont icon-zhuashou-copy",style:{color:"drag"==e.toolType?"#4784FF":null}})]),e._v(" "),t("div",{staticClass:"sizeBox"},[t("div",{staticClass:"sizeBnt",class:{disabledStyle:e.intImg.size<=e.minScaleSize},on:{click:e.setImageZoomOut}},[t("i",{staticClass:"el-icon-minus"})]),e._v(" "),t("el-popover",{attrs:{placement:"top",trigger:"hover","visible-arrow":!1,"popper-class":"sizeListBox"}},[t("div",{staticClass:"sizeList"},e._l(e.sizeList,(function(n,o){return t("div",{key:o,staticClass:"sizeItem",on:{click:function(t){return e.changeSize(n)}}},[e._v("\n              "+e._s(e.$t(n.name))+"\n            ")])})),0),e._v(" "),t("div",{staticClass:"sizeNum",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.intImg.size)+"%")])]),e._v(" "),t("div",{staticClass:"sizeBnt",class:{disabledStyle:e.intImg.size>=e.maxScaleSize},on:{click:e.setImageZoomIn}},[t("i",{staticClass:"el-icon-plus"})])],1)]),e._v(" "),t("div",{staticClass:"left",class:{disabledStyle:e.intLoading}},e._l(e.toolList,(function(n,o){return t("div",{key:o,staticClass:"toolItem",class:{activateToolItem:e.toolType==n.value},on:{click:function(t){return e.changeTool(n)}}},[t("i",{class:n.icon}),e._v(" "),t("span",[e._v(e._s(e.$t(n.name)))]),e._v(" "),"smear"==n.value&&"smear"==e.toolType||"eraser"==n.value&&"eraser"==e.toolType?t("div",{staticClass:"lineSize"},[t("span",[e._v(e._s(e.$t("Size")))]),e._v(" "),t("el-slider",{attrs:{"show-input":"","show-input-controls":!1,min:10},model:{value:e.brushSize,callback:function(t){e.brushSize=t},expression:"brushSize"}})],1):e._e()])})),0),e._v(" "),e.intLoading?e._e():t("div",{ref:"draggable",staticClass:"draggable",style:{width:e.intImg.width*e.intImg.size/100+"px",height:e.intImg.height*e.intImg.size/100+"px",cursor:e.setCanvasStyle},attrs:{id:"draggable"},on:{mousedown:function(t){return t.preventDefault(),e.downElement.apply(null,arguments)},mousemove:function(t){return t.preventDefault(),e.moveElement.apply(null,arguments)},mouseup:function(t){return t.preventDefault(),e.seupElement.apply(null,arguments)}}},[e.loading?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"laodMsk"}):e._e(),e._v(" "),e.intImg.url?t("img",{directives:[{name:"show",rawName:"v-show",value:e.imgShow,expression:"imgShow"}],attrs:{src:e.intImg.url,alt:""}}):e._e(),e._v(" "),e.MasterDrawing?t("img",{directives:[{name:"show",rawName:"v-show",value:!e.imgShow,expression:"!imgShow"}],attrs:{src:e.MasterDrawing,alt:""}}):e._e(),e._v(" "),t("canvas",{ref:"canvas",attrs:{width:e.intImg.width,height:e.intImg.height},on:{"&mousedown":function(t){return e.startDrawing.apply(null,arguments)},"&mousemove":function(t){["cancelQuick","quick"].includes(e.toolType)?e.debounceHandleMouseMove(t):e.draw(t)},"&mouseup":function(t){return e.stopDrawing.apply(null,arguments)},mouseenter:function(t){e.hasHover=!0},mouseleave:function(t){e.hasHover=!1,e.hoverMaskUrl="",e.stopDrawing()},mousedown:e.selectRegion}}),e._v(" "),e.hoverMaskUrl?t("img",{staticClass:"segment-image-draw-img-hover-mask",style:{width:e.intImg.width*e.intImg.size/100+"px",height:e.intImg.height*e.intImg.size/100+"px"},attrs:{src:e.hoverMaskUrl,alt:""}}):e._e(),e._v(" "),t("canvas",{directives:[{name:"show",rawName:"v-show",value:"rectangle"==e.toolType,expression:"toolType == 'rectangle'"}],ref:"rectCanvas",staticClass:"rectCanvas",attrs:{width:e.intImg.width,height:e.intImg.height},on:{"&mousedown":function(t){return e.startRectDrawing.apply(null,arguments)},"&mousemove":function(t){return e.rectDraw.apply(null,arguments)},"&mouseup":function(t){return e.stopRectDrawing.apply(null,arguments)}}}),e._v(" "),e._l(e.rectList,(function(n,o){return t("generate-rect-item",{key:"rect"+o,attrs:{item:n,index:o,size:e.intImg.size},on:{delete:e.rectDelete,change:e.rectChange}})}))],2),e._v(" "),t("el-button",{staticClass:"start",class:{disabledStyle:e.intLoading||e.loading},attrs:{disabled:e.intLoading||e.loading,loading:e.uploading},on:{click:e.uploadMaskImage}},[t("span",[e._v(e._s(e.$t("Done")))])])],1)])}),[],!1,null,"4ca3b7a8",null);t.default=component.exports;installComponents(component,{GenerateRectItem:n(264).default})},4051:function(e,t,n){"use strict";n(1692)},4052:function(e,t,n){"use strict";n(1693)},4055:function(e,t,n){"use strict";n(1696)},4056:function(e,t,n){"use strict";n(1697)},4057:function(e,t,n){"use strict";n(1698)},4066:function(e,t,n){"use strict";n(1707)},4067:function(e,t,n){"use strict";n(1708)},4068:function(e,t,n){"use strict";n(1709)},4069:function(e,t,n){"use strict";n(1710)},4071:function(e,t,n){"use strict";n(1712)},4072:function(e,t,n){"use strict";n(1713)},4073:function(e,t,n){"use strict";n(1714)},4074:function(e,t,n){"use strict";n(1715)},4075:function(e,t,n){"use strict";n(1716)},4076:function(e,t,n){"use strict";n(1717)},4079:function(e,t,n){"use strict";n(1720)},4082:function(e,t,n){"use strict";n(1723)},4083:function(e,t,n){"use strict";n(1724)},4084:function(e,t,n){"use strict";n(1725)},4085:function(e,t,n){"use strict";n(1726)},4086:function(e,t,n){"use strict";n(1727)},4087:function(e,t,n){"use strict";n(1728)},4091:function(e,t,n){"use strict";n(1732)},4093:function(e,t,n){"use strict";n(1734)},4094:function(e,t,n){"use strict";n(1735)},4095:function(e,t,n){"use strict";n(1736)},4096:function(e,t,n){"use strict";n(1737)},4097:function(e,t,n){"use strict";n(1738)},4098:function(e,t,n){"use strict";n(1739)},4099:function(e,t,n){"use strict";n(1740)},4100:function(e,t,n){"use strict";n(1741)},4101:function(e,t,n){"use strict";n(1742)},4102:function(e,t,n){"use strict";n(1743)},4103:function(e,t,n){"use strict";n(1744)},4104:function(e,t,n){"use strict";n(1745)},4105:function(e,t,n){"use strict";n(1746)},4106:function(e,t,n){"use strict";n(1747)},4107:function(e,t,n){"use strict";n(1748)},4108:function(e,t,n){"use strict";n(1749)},4109:function(e,t,n){"use strict";n(1750)},4110:function(e,t,n){"use strict";n(1751)},4111:function(e,t,n){"use strict";n(1752)},4112:function(e,t,n){"use strict";n(1753)},4113:function(e,t,n){"use strict";n(1754)},4114:function(e,t,n){"use strict";n(1755)},4115:function(e,t,n){"use strict";n(1756)},4116:function(e,t,n){"use strict";n(1757)},4117:function(e,t,n){"use strict";n(1758)},4118:function(e,t,n){"use strict";n(1759)},4119:function(e,t,n){"use strict";n(1760)},4120:function(e,t,n){"use strict";n(1761)},4125:function(e,t,n){"use strict";n(1766)},4128:function(e,t,n){"use strict";n(1770)},4129:function(e,t,n){"use strict";n(1771)},4130:function(e,t,n){"use strict";n(1772)},4131:function(e,t,n){"use strict";n(1773)},4132:function(e,t,n){"use strict";n(1774)},4133:function(e,t,n){"use strict";n(1775)},4134:function(e,t,n){"use strict";n(1776)},4135:function(e,t,n){"use strict";n(1777)},4136:function(e,t,n){"use strict";n(1778)},4137:function(e,t,n){"use strict";n(1779)},4139:function(e,t,n){"use strict";n(1781)},4140:function(e,t,n){"use strict";n(1782)},4152:function(e,t,n){"use strict";n(1794)},4153:function(e,t,n){"use strict";n(1795)},4154:function(e,t,n){"use strict";n(1796)},4155:function(e,t,n){"use strict";n(1797)},4156:function(e,t,n){"use strict";n(1798)},4291:function(e,t,n){"use strict";n(1867)},4292:function(e,t,n){"use strict";n(1868)},4294:function(e,t,n){"use strict";n(1869)},4390:function(e,t,n){"use strict";n(1959)},4461:function(e,t,n){"use strict";n(2029)},4511:function(e,t,n){"use strict";n(2078)},4521:function(e,t,n){"use strict";n(2083)},4522:function(e,t,n){"use strict";n(2084)},4523:function(e,t,n){"use strict";n(2085)},4524:function(e,t,n){"use strict";n(2086)},5651:function(e,t,n){"use strict";n(3067)},5652:function(e,t,n){"use strict";n(3068)},5653:function(e,t,n){"use strict";n(3069)},5678:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(50),n(22),n(49),n(28);var o=n(1159),r=n(3227),l=n(1160),c=n(1161),d=n(3246),h=n(1163),m=n(3261),v=n(3262),f=n(3118),_=n(3119),w=n(3263),y=n(3264),C=n(594),S=n(1164),k=n(3343),x=n(54),I=n(600),O=n(601),T={components:{GenerateMenu:o.default,GeneratePrompt:l.default,GenerateHandle:c.default,TaskView:r.default,CWorkPanel:d.default,ControlNetPopup:m.default,ChannelPersonPopup:v.default,ChannelSearch:w.default,ChannelSelectMenu:y.default,SimpleGenerate:h.default,GRechargeBanner:C.default,EasyGenerate:S.default,NewVersionNoticeModal:k.default,FilterButton:I.default,FilterOptionPopup:O.default},mixins:[f.GMixIn,_.default],provide:function(){var e=this;return{driverContainer:function(){return e.$refs.driverContainer}}},head:function(){if("page"!==this.mode)return{};var e=this.currentPageType;return console.log("head方法执行，当前类型:",e),{title:this.$t({image:"create_img_title",video:"create_vid_title",element:"create_vid_title","ai-app":"create_aiApp_title",effect:"create_effect_title",audio:"create_audio_title"}[e]),meta:[{hid:"description",name:"description",content:this.$t({image:"create_img_desc",video:"create_vid_desc",element:"create_vid_desc","ai-app":"create_aiApp_desc",effect:"create_effect_desc",audio:"create_audio_desc"}[e])}]}},data:function(){return{postSelectList:[],enableSubmit:!1,enableClassicMode:!0,currentPageType:""}},watch:{$route:function(e,form){if(this.isShowPopup){if("1"===e.query.openLoginDialog||"1"===form.query.openLoginDialog&&!e.query.openLoginDialog)return;this.closePopup("route-change")}},"config.imageToImage":{handler:function(e,t){if(e.mask&&""===t.mask){this.config.imageToImage.keepDenoisingStrength?console.log("不重置局部重绘强度"):this.config.imageToImage.denoising_strength=.7;try{/^(http|https):\/\//.test(e.mask)||(this.config.imageToImage.prompt="")}catch(e){}}e.mask&&e.mask!==t.mask&&(this.config.imageToImage.ad_model=""),e.ad_model&&""===t.ad_model&&(this.config.imageToImage.denoising_strength=.7,this.config.imageToImage.mask="")},immediate:!0,deep:!0},menuIndex:{handler:function(e,t){var n=this;"textToImage"===e&&"textToImage"!==t&&this.$nextTick((function(){n.taskViewScrollToBottom()}))},immediate:!0,deep:!0}},methods:{handleEnableClassicMode:function(){this.$logEvent("log_actions",{operation:"click_switch_model",behavior_info:"on_new_create_flow_page",behavior_info_sub:"close"}),this.handleSwitchMenu(2),this.enableClassicMode=!0},handleChannelSearch:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.listParams=Object.assign({},this.listParams,{keyword:t}),null==this||null===(e=this.$refs)||void 0===e||null===(e=e.taskView)||void 0===e||e.handleSearch(this.listParams),this.$logEvent("log_actions",{operation:"type_search",behavior_info:"on_create_flow_page"})},changePostStatus:function(){this.enableSubmit=!this.enableSubmit},cancelPost:function(){this.enableSubmit=!1,this.postSelectList=[]},sendToPost:function(){if(this.postSelectList.length){try{this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow",behavior_info_sub:(this.postSelectList||[]).map((function(e){return e.url}))})}catch(e){}this.$EventBus.$emit("openContribution",{selectedData:this.postSelectList,types:[x.CONTRIBUTION_TYPE_ENUM.WORK],source:"task"})}else this.$message.warning(this.$t("selectOneWork"))},updatePostSelectList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(this.postSelectList||[]).findIndex((function(t){return e.url===t.url}));-1===t?-1===t&&this.postSelectList.length<20&&this.postSelectList.push(e):this.postSelectList.splice(t,1)},updateGenerateType:function(){try{var e=window.location.pathname.split("/").pop();this.currentPageType=e}catch(e){console.log("updateGenerateType error",e)}}}},L=T,$=(n(4461),n(0)),component=Object($.a)(L,(function(){var e=this,t=e._self._c;return t("div",{class:{"p-generate-page generate-popup":"page"===e.mode}},["modal"===e.mode?[t("el-dialog",{attrs:{visible:e.isShowPopup,fullscreen:"","custom-class":"generate-popup","before-close":e.closePopup,"destroy-on-close":!1,"close-on-press-escape":!1,modal:!1},on:{"update:visible":function(t){e.isShowPopup=t}}},[t("div",{ref:"driverContainer",staticClass:"generate-body"},[[2,"2"].includes(e.currentGenerateMode)?t("easy-generate",{ref:"easyGenerate",attrs:{isShowSubBanner:e.isShowSubBanner,isShowPopup:e.isShowPopup,currentGenerateMode:e.currentGenerateMode},on:{close:e.closePopup,backOld:e.handleSwitchMenu,closeSubBanner:e.closeSubBanner}}):e._e(),e._v(" "),[2,"2"].includes(e.currentGenerateMode)?e._e():[t("generate-menu",{attrs:{menuIndex:e.menuIndex},on:{changeMenu:e.changeMenu,close:e.closePopup,onVideoGeneration:e.handleVideoSwitchMenu}}),e._v(" "),t("div",{staticClass:"generate-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"SIMPLE"!==e.menuIndex,expression:"menuIndex !== 'SIMPLE'"}],staticClass:"generate-work"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!["promptStudio"].includes(e.menuIndex),expression:"!['promptStudio'].includes(menuIndex)"}],staticClass:"channel-title",style:{height:e.isShowSubBanner&&"textToImage"===e.menuIndex?"100px":"46px"}},[t("div",{staticClass:"title-handle"},[e.token?t("div",{staticClass:"channel-title-left"},[t("channel-select-menu"),e._v(" "),"PRIVATE"===e.channelInfo.name&&["textToImage"].includes(e.menuIndex)?t("filter-option-popup",{attrs:{scene:"oldGenerate",listParams:e.listParams},on:{"filter-change":e.debounceHandleFilter}},[t("filter-button",{attrs:{count:e.getFilterCount}})],1):e._e(),e._v(" "),t("channel-search",{directives:[{name:"show",rawName:"v-show",value:"PRIVATE"===e.channelInfo.name&&["textToImage"].includes(e.menuIndex),expression:"channelInfo.name === 'PRIVATE' && ['textToImage'].includes(menuIndex)"}],on:{channelSearch:e.handleChannelSearch}})],1):e._e(),e._v(" "),t("div",{staticClass:"channel-title-right"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"PRIVATE"===e.channelInfo.name&&["textToImage"].includes(e.menuIndex)&&!e.isCompanyAccount,expression:"\n                        channelInfo.name === 'PRIVATE' && ['textToImage'].includes(menuIndex) && !isCompanyAccount\n                      "}],staticClass:"post-btn-area"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.enableSubmit,expression:"!enableSubmit"}],staticClass:"base-btn post-btn",on:{click:function(t){return t.stopPropagation(),e.changePostStatus.apply(null,arguments)}}},[t("i",{staticClass:"iconfont icon-post-icon1 post-btn-icon"}),e._v(" "),t("span",{staticClass:"post-btn-text"},[e._v(e._s(e.$t("Post")))])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.enableSubmit,expression:"enableSubmit"}],staticClass:"base-btn cancel-btn",on:{click:function(t){return t.stopPropagation(),e.cancelPost.apply(null,arguments)}}},[e._v("\n                        "+e._s(e.$t("Cancel"))+"\n                      ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.enableSubmit,expression:"enableSubmit"}],staticClass:"base-btn next-step-btn",on:{click:function(t){return t.stopPropagation(),e.sendToPost.apply(null,arguments)}}},[e._v("\n                        "+e._s(e.$t("NextStep"))+"\n                      ")])]),e._v(" "),t("div",{staticClass:"switch-btn-box"},[t("span",{staticClass:"switch-btn-label"},[e._v(e._s(e.$t("newGenerate36")))]),e._v(" "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t("newGenerate35"),placement:"top-start"}},[t("span",{staticClass:"switch-btn-icon el-icon-question"})]),e._v(" "),t("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:e.handleEnableClassicMode},model:{value:e.enableClassicMode,callback:function(t){e.enableClassicMode=t},expression:"enableClassicMode"}})],1),e._v(" "),e.channelInfo.num?t("span",{staticClass:"channel-num",on:{click:e.viewChannelPerson}},[t("i",{staticClass:"el-icon-s-custom"}),e._v(e._s(e.channelInfo.num)+"\n                    ")]):e._e()])]),e._v(" "),e.isShowSubBanner?t("g-recharge-banner",{directives:[{name:"show",rawName:"v-show",value:"textToImage"===e.menuIndex&&!e.isCompanyAccount,expression:"menuIndex === 'textToImage' && !isCompanyAccount"}],on:{close:e.closeSubBanner}}):e._e()],1),e._v(" "),t("div",{staticClass:"work-panel"},[e.token?t("task-view",{directives:[{name:"show",rawName:"v-show",value:["textToImage","task"].includes(e.menuIndex),expression:"['textToImage', 'task'].includes(menuIndex)"}],ref:"taskView",on:{reload:e.show,closePopup:e.closePopup,clearTaskSearch:e.resetListParams}}):e._e(),e._v(" "),e._l(e.menuKey,(function(n,o){return t("c-work-panel",{directives:[{name:"show",rawName:"v-show",value:e.menuIndex===n,expression:"menuIndex === val"}],key:"work_"+o,attrs:{menuIndex:n},on:{generate:e.generate,imgReadInfo:e.imgReadInfo,updateImageSize:e.handleUpdateImageSize,animSetWork:function(t){return e.getConfig(t)},onDelete:function(t){return e.resetConfig(!0)}},model:{value:e.config[n],callback:function(t){e.$set(e.config,n,t)},expression:"config[val]"}})}))],2),e._v(" "),t("generate-prompt",{directives:[{name:"show",rawName:"v-show",value:e.showPrompt,expression:"showPrompt"}],model:{value:e.config[e.menuIndex],callback:function(t){e.$set(e.config,e.menuIndex,t)},expression:"config[menuIndex]"}})],1),e._v(" "),t("generate-handle",{directives:[{name:"loading",rawName:"v-loading",value:!["descriptors"].includes(e.menuIndex)&&e.config[e.menuIndex].generateing,expression:"!['descriptors'].includes(menuIndex) && config[menuIndex].generateing"},{name:"show",rawName:"v-show",value:e.showHandle,expression:"showHandle"}],on:{sendParams:e.sendParams},model:{value:e.config[e.menuIndex],callback:function(t){e.$set(e.config,e.menuIndex,t)},expression:"config[menuIndex]"}}),e._v(" "),t("simple-generate",{directives:[{name:"show",rawName:"v-show",value:"SIMPLE"===e.menuIndex,expression:"menuIndex === 'SIMPLE'"}],ref:"simpleGenerate"})],1),e._v(" "),t("control-net-popup",{ref:"controlnetPopup",model:{value:e.config[e.menuIndex],callback:function(t){e.$set(e.config,e.menuIndex,t)},expression:"config[menuIndex]"}}),e._v(" "),t("channel-person-popup",{ref:"channelPersonPopup"})]],2),e._v(" "),e.isShowPopup&&[1,"1"].includes(e.currentGenerateMode)?t("new-version-notice-modal",{on:{confirm:function(t){return e.handleSwitchMenu(2,t)}}}):e._e()],1)]:[t("div",{ref:"driverContainer",staticClass:"generate-body"},[t("easy-generate",{ref:"easyGenerate",attrs:{isShowSubBanner:e.isShowSubBanner,isShowPopup:e.isShowPopup,mode:"page",currentGenerateMode:e.currentGenerateMode},on:{close:e.closePopup,backOld:e.handleSwitchMenu,closeSubBanner:e.closeSubBanner,updateGenerateType:e.updateGenerateType}})],1)]],2)}),[],!1,null,"9a27bdb4",null);t.default=component.exports;installComponents(component,{EasyGenerate:n(1164).default,GenerateMenu:n(1159).default,GeneratePrompt:n(1160).default,GenerateHandle:n(1161).default,SimpleGenerate:n(1163).default})},5684:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(1)),c=n(3373),d=n(889),h=n(3375),m=n(78);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={name:"HalfDiscountDialogContainer",components:{HalfDiscountAnimation:c.default,SelectLevelDialog:d.default,RetentionDialogContainer:h.default},data:function(){return{popType:null,from:""}},mounted:function(){var e;null===(e=this.$refs)||void 0===e||null===(e=e.HalfDiscountAnimation)||void 0===e||e.preloadImage()},computed:f(f({},Object(l.c)("user",["isLoggedIn","userInfo"])),{},{hasShownRetentionRecently:function(){var e=localStorage.getItem("retention_dialog_last_shown");if(!e)return!1;var t=new Date(e),n=new Date-t;return Math.floor(n/864e5)<3}}),methods:f(f(f({},Object(l.b)("payment",["setHalfDiscountCountdown"])),Object(l.b)("user",["getAccountInfo"])),{},{getPopType:function(){if(null!==this.popType&&void 0!==this.popType)return this.popType;var e=localStorage.getItem("user_type");return e&&"0"!==e?e:null},show:function(data){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,source,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=null==data?void 0:data.popType,source=(null==data?void 0:data.source)||"",r=(null==data?void 0:data.endAt)||"",null!=o){t.next=8;break}return console.warn("[HalfDiscountDialogContainer] Invalid popType received in show():",o),e.hide(),t.abrupt("return");case 8:o&&o>0&&r&&e.setHalfDiscountCountdown(r),e.popType=o,e.from=source,null===(n=e.$refs.HalfDiscountAnimation)||void 0===n||n.show(),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),console.error("[HalfDiscountDialogContainer] Error in show method:",t.t0),e.hide();case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()},showSelectLevel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==t?t:this.getPopType(),o=null!==e?e:this.from;null==n&&console.error("[HalfDiscountDialogContainer] 无法获取有效的 popType，弹窗可能无法正常显示"),this.$refs.SelectLevelDialogRef.show(n,o)},handleCloseNewSelectLevel:function(e){if(!e||!e.showAwaitingOrder)if(e&&e.level&&e.data&&!this.hasShownRetentionRecently){var t=(new Date).toISOString().split("T")[0];localStorage.setItem("retention_dialog_last_shown",t),this.$refs.RetentionDialogContainerRef.show(e.level,e.data)}else this.closeDialog()},closeDialog:function(){this.hide(),this.$emit("close",m.a.HALF_PRICE)},hide:function(){try{this.popType=null,this.from=""}catch(e){console.error("[HalfDiscountDialogContainer] Error in hide method:",e)}}})},w=_,y=n(0),component=Object(y.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"half-discount-dialog-container"},[t("HalfDiscountAnimation",{ref:"HalfDiscountAnimation",on:{"anime-finish":e.showSelectLevel}}),e._v(" "),t("SelectLevelDialog",{ref:"SelectLevelDialogRef",on:{close:e.handleCloseNewSelectLevel}}),e._v(" "),t("RetentionDialogContainer",{ref:"RetentionDialogContainerRef",on:{close:e.closeDialog}})],1)}),[],!1,null,null,null);t.default=component.exports},5840:function(e,t,n){"use strict";n.r(t);var o={name:"GMenuItem",props:{item:{type:Object,default:function(){return{}}},activeIndex:{type:String,default:""}},components:{GMenuItem:l},data:function(){return{zoom:!1}},methods:{changeMenu:function(){var e=this.item,t=e.key,n=e.children,o=e.icon;null!=n&&n.length?o&&(this.zoom=!this.zoom):this.$emit("change",t)},handle:function(e){this.$emit("change",e)}}},r=(n(5651),n(0)),component=Object(r.a)(o,(function(){var e,t,n,o=this,r=o._self._c;return r("div",{staticClass:"menu-item",class:{"sub-menu":null===(e=o.item.children)||void 0===e?void 0:e.length,"zoom-item":o.zoom,"open-item":!o.item.icon}},[r("div",{staticClass:"menu-info",class:{active:o.activeIndex===o.item.key},on:{click:function(e){return o.changeMenu("")}}},[o.item.icon?r("i",{staticClass:"iconfont",class:o.item.icon}):o._e(),o._v(" "),r("span",{staticClass:"menu-title"},[o._v(o._s(o.$t(o.item.title)))]),o._v(" "),null!==(t=o.item)&&void 0!==t&&null!==(t=t.children)&&void 0!==t&&t.length&&o.item.icon?r("i",{staticClass:"el-icon-arrow-down"}):o._e()]),o._v(" "),null!==(n=o.item)&&void 0!==n&&null!==(n=n.children)&&void 0!==n&&n.length?r("div",{staticClass:"menu-child"},o._l(o.item.children,(function(e){return r("g-menu-item",{key:e.key,attrs:{item:e,activeIndex:o.activeIndex},on:{change:o.handle}})})),1):o._e()])}),[],!1,null,"6682c557",null),l=t.default=component.exports},5841:function(e,t,n){"use strict";n.r(t);n(65),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(6),n(32),n(16),n(22),n(4),n(21),n(1)),l=n(126),c=n(127),d=n(475),h=n(889);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"GoodsDialog",provide:function(){return{top:this}},components:{PaymentForm:l.a,RightPart:c.a,RightsComponent:d.a,SelectLevelDialog:h.default},data:function(){return{isShowDialog:!1,step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",selectedLevel:"standard",levelArr:[],apiMonetaryUnit:"",popType:0,from:"",dotFrom:""}},computed:v(v(v(v(v({},Object(r.c)("payment",["paymentInfo"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.e)("user",["userInfo","cdnHost"])),Object(r.e)("payment",["subThirdType","halfDiscountCountdown"])),{},{isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)},isUpgrade:function(){return[3,4].includes(this.popType)},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},getLabel:function(){var e=this;return function(t){return e.$t({standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[t])}},getBtnLabel:function(){return this.$t("Upgrade50off")}}),methods:v(v({},Object(r.b)("payment",["getSubUrlAndThirdType","getSubscriptionList"])),{},{isOpen:function(e,t){return this.isShowDialog=!0,this.popType=e,this.from=t,this.dotFrom=t,this.handleLogEvent("pop_1"),this.updateGoodsData(),!0},close:function(){console.log("[GoodsDialog] 关闭弹窗"),this.isShowDialog=!1,this.step="inGoods",this.$emit("close")},quitPay:function(){this.step="inGoods"},updateGoodsData:function(){var e=this;this.getSubscriptionList().then((function(t){var n,o=t.data,r=(void 0===o?{}:o)||{},l=r.month,c=void 0===l?[]:l,d=r.year,h=(void 0===d?[]:d).map((function(e,t){return v(v({},e),{},{monthly_id:c[t].id,original_price:c[t].price,original_price_cn:c[t].price_cn})}));h.shift(),e.levelArr=h.map((function(t){var n=t.id,o=t.monthly_id,r=t.price_month,l=t.original_price,c=t.price_month_cn,d=t.original_price_cn,h=t.price,m=t.price_cn,v=t.local_price_web,f=t.activity;return e.apiMonetaryUnit||(e.apiMonetaryUnit=null==v?void 0:v.currency),{activity:f,label:{sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"master"}[n],monthly_id:o,yearly_id:n,original_m_p_en:l,now_m_p_en:r,original_m_p_zh:d,now_m_p_zh:c,now_total_price_en:h,now_total_price_cn:m,now_m_p:null==v?void 0:v.price,original_m_p:null==v?void 0:v.price_old,monetaryUnit:null==v?void 0:v.currency}}));var m=["standard","professional","master"],f=(null===(n=e.paymentInfo)||void 0===n?void 0:n.productLevel)||1;if(3===e.popType)switch(f){case 1:case 2:m=["standard","professional","master"];break;case 3:m=["professional","master"],e.selectedLevel="professional";break;case 4:m=["master"],e.selectedLevel="master"}if(4===e.popType)switch(f){case 1:m=["standard","professional","master"];break;case 2:m=["professional","master"],e.selectedLevel="professional";break;case 3:m=["master"],e.selectedLevel="master"}e.levelArr=e.levelArr.filter((function(e){return m.includes(e.label)}))}))},toMall:function(){window.open(this.localePath("/mall"),"_blank")},handleLogEvent:function(sub){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.from,behavior_info_sub:sub,user_type:this.popType})},subscriptionNow:function(){var e=this;this.handleLogEvent("pop_2");var t=(this.levelArr.find((function(i){return i.label==e.selectedLevel}))||{}).yearly_id,n=void 0===t?"":t;this.btnLabel=this.getBtnLabel,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}}))}})},_=(n(5652),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"goods-dialog flex-center",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowDialog=t}}},["inGoods"===e.step?t("div",{staticClass:"half-discount-container"},[t("div",{staticClass:"half-discount-close flex-center",on:{click:e.close}},[t("i",{staticClass:"el-icon-close"})]),e._v(" "),t("div",{staticClass:"left",class:e.selectedLevel},[t("div",{staticClass:"left-title words-wrap"},[e._v("\n          "+e._s(e.$t("LimitHalfTitle"))+"\n        ")]),e._v(" "),t("div",{staticClass:"left-level"},e._l(e.levelArr,(function(n){var o,r,l;return t("div",{key:n.label,staticClass:"item-level",class:{active:e.selectedLevel==n.label},on:{click:function(t){e.selectedLevel=n.label}}},[t("div",{staticClass:"half-discount flex-center",style:e.getBg},[e._v("50% OFF")]),e._v(" "),t("div",{staticClass:"countdown-box flex-center"},[t("span",[e._v(e._s(null===(o=e.halfDiscountCountdown)||void 0===o?void 0:o.hours))]),e._v(" "),t("span",[e._v(":")]),e._v(" "),t("span",[e._v(e._s(null===(r=e.halfDiscountCountdown)||void 0===r?void 0:r.minutes))]),e._v(" "),t("span",[e._v(":")]),e._v(" "),t("span",[e._v(e._s(null===(l=e.halfDiscountCountdown)||void 0===l?void 0:l.seconds))])]),e._v(" "),t("div",{staticClass:"item-level-label"},[e._v("\n              "+e._s(e.getLabel(n.label))+"\n            ")]),e._v(" "),t("div",{staticClass:"item-level-price item-level-yearly"},[t("div",{staticClass:"top"},[t("span",{staticClass:"sign"},[e._v("\n                  "+e._s(null==n?void 0:n.monetaryUnit)+"\n                ")]),e._v(" "),t("span",{staticClass:"price"},[e._v("\n                  "+e._s(n.now_m_p)+"\n                ")]),e._v(" "),t("span",[e._v("/")]),e._v(" "),t("span",{staticClass:"type"},[e._v("\n                  "+e._s(e.$t("Month"))+"\n                ")])]),e._v(" "),t("div",{staticClass:"bottom"},[t("div",{staticClass:"now-price"},[t("span",{staticClass:"sign"},[e._v("\n                    "+e._s(null==n?void 0:n.monetaryUnit)+"\n                  ")]),e._v(" "),t("span",{staticClass:"price"},[e._v("\n                    "+e._s((12*n.now_m_p).toFixed(2))+"\n                  ")]),e._v(" "),t("span",[e._v("/")]),e._v(" "),t("span",{staticClass:"type"},[e._v("\n                    "+e._s(e.$t("year"))+"\n                  ")])]),e._v(" "),t("div",{staticClass:"original-price"},[t("span",{staticClass:"sign"},[e._v("\n                    "+e._s(null==n?void 0:n.monetaryUnit)+"\n                  ")]),e._v(" "),t("span",{staticClass:"price"},[e._v("\n                    "+e._s((12*n.original_m_p).toFixed(2))+"\n                  ")]),e._v(" "),t("span",[e._v("/")]),e._v(" "),t("span",{staticClass:"type"},[e._v("\n                    "+e._s(e.$t("year"))+"\n                  ")])])])])])})),0),e._v(" "),t("div",{staticClass:"left-more",on:{click:e.toMall}},[e._v("\n          "+e._s(e.$t("viewMore"))+"\n          "),t("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),t("el-button",{staticClass:"left-btn",on:{click:e.subscriptionNow}},[e._v("\n          "+e._s(e.getBtnLabel)+"\n        ")])],1),e._v(" "),t("div",{staticClass:"right"},[t("RightsComponent",{attrs:{selectedLevel:e.selectedLevel,hiddenItems:["free","basic"]}})],1)]):e._e(),e._v(" "),"inPay"===e.step?t("PaymentForm",{attrs:{defaultThirdType:e.defaultThirdType,disabledMethods:[],isFreeTry:!1,initMount:!0,upgrade:e.isUpgrade,goodsId:e.goodsId,purchParams:{},btnLabel:e.btnLabel},on:{"in-pay-back":e.quitPay,"pay-success":function(t){e.isShowDialog=!1,e.step="inGoods"}}},[t("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):e._e()],1),e._v(" "),t("SelectLevelDialog",{ref:"SelectLevelDialogRef"})],1)}),[],!1,null,"9cd0488c",null);t.default=component.exports},5842:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(26),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"HalfDiscountDialog",data:function(){return{visible:!1,countdown:null,isShowClose:!1,popType:0,from:""}},computed:c(c(c({},Object(r.e)("user",["cdnHost"])),Object(r.e)("payment",["halfDiscountCountdown"])),{},{getStyle:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20250317/0242eff9-b990-479c-bc73-fdea2a21a09b.webp)")}}}),watch:{visible:{handler:function(e){var t=this;e?setTimeout((function(){t.isShowClose=!0}),3e3):this.isShowClose=!1},immediate:!0}},methods:{handleLogEvent:function(e){var t={operation:e,behavior_info:this.from,behavior_info_sub:"pop_on_50_percent_off",user_type:this.popType};this.$logEvent("log_actions",t)},show:function(e,t){this.popType=e,this.from=t,this.visible=!0,this.handleLogEvent("to_pay_pop_show")},handleClose:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"click_close";this.handleLogEvent(e),this.popType=0,this.from="",this.visible=!1,"click_close"===e&&this.$emit("close")},handleShopNow:function(){this.handleClose("click_shop_now"),this.$emit("shop",this.from)}}},h=d,m=(n(5653),n(0)),component=Object(m.a)(h,(function(){var e,t,n,o=this,r=o._self._c;return r("el-dialog",{staticClass:"limit-half-modal flex-center",attrs:{visible:o.visible,width:"438px",center:"",modal:!1,"modal-append-to-body":"","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){o.visible=e}}},[r("div",{staticClass:"modal-content",style:o.getStyle},[r("div",{directives:[{name:"show",rawName:"v-show",value:o.isShowClose,expression:"isShowClose"}],staticClass:"dialog-close flex-center",on:{click:function(e){return o.handleClose("click_close")}}},[r("i",{staticClass:"el-icon-close"})]),o._v(" "),r("div",{staticClass:"title"},[o._v(o._s(o.$t("SVIPCard")))]),o._v(" "),r("div",{staticClass:"txt words-wrap flex-center"},[o._v(o._s(o.$t("SVIPCardTxt")))]),o._v(" "),r("div",{staticClass:"slogan flex-center"},[o._v(o._s(o.$t("SVIPCardSlogan")))]),o._v(" "),r("div",{staticClass:"countdown flex-center"},[r("div",{staticClass:"time-block"},[o._v(o._s(null===(e=o.halfDiscountCountdown)||void 0===e?void 0:e.hours))]),o._v(" "),r("div",{staticClass:"separator"},[o._v(":")]),o._v(" "),r("div",{staticClass:"time-block"},[o._v(o._s(null===(t=o.halfDiscountCountdown)||void 0===t?void 0:t.minutes))]),o._v(" "),r("div",{staticClass:"separator"},[o._v(":")]),o._v(" "),r("div",{staticClass:"time-block"},[o._v(o._s(null===(n=o.halfDiscountCountdown)||void 0===n?void 0:n.seconds))])]),o._v(" "),r("div",{staticClass:"shop-button-wrapper flex-center"},[r("el-button",{staticClass:"shop-button",attrs:{type:"primary"},on:{click:o.handleShopNow}},[o._v("\n        "+o._s(o.$t("businesSwiperBtn1"))+"\n      ")])],1)])])}),[],!1,null,"2d5cef2e",null);t.default=component.exports},592:function(e,t,n){"use strict";n.r(t);var o={name:"MessageOperateBtn",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clicked:{type:Boolean,default:!1},disableClickStatus:{type:Boolean,default:!1}},watch:{loading:{handler:function(e){this.isLoading=e},immediate:!0,deep:!0},disabled:{handler:function(e){this.isDisabled=e},immediate:!0},clicked:{handler:function(e){this.isClicked=e},immediate:!0}},data:function(){return{isClicked:!1,isLoading:!1,isDisabled:!1}},methods:{handleClick:function(){this.isLoading||this.isDisabled||(this.disableClickStatus,this.$emit("click"))},handleKeydown:function(e){32===e.keyCode&&e.preventDefault()}}},r=(n(4069),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-message-operate-btn"},[t("button",e._b({staticClass:"message-operate-btn look-filled color-primary size-small grow",class:{"color-brand":e.isClicked&&!e.isLoading,"operate-btn-disable":e.isDisabled},attrs:{role:"button",type:"button",disabled:e.isDisabled},on:{click:function(t){return t.stopPropagation(),e.handleClick.apply(null,arguments)},keydown:e.handleKeydown}},"button",e.$attrs,!1),[t("div",{staticClass:"contents-wrapper"},[t("div",{staticClass:"content",style:{opacity:e.isLoading?0:1}},[e._t("default")],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"content-loading"},[t("svg",{staticClass:"content-loading-dots",attrs:{width:"24.5",height:"7"}},[t("g",{staticStyle:{opacity:"1"}},[t("circle",{attrs:{cx:"3.5",cy:"3.5",r:"3.5",fill:"currentColor"}}),e._v(" "),t("circle",{attrs:{cx:"12.25",cy:"3.5",r:"3.5",fill:"currentColor"}}),e._v(" "),t("circle",{attrs:{cx:"21",cy:"3.5",r:"3.5",fill:"currentColor"}})])])])])])])}),[],!1,null,"92974c76",null);t.default=component.exports},593:function(e,t,n){"use strict";n.r(t);n(24);var o={name:"SwipeList",props:{iconBntWidth:{type:Number,default:40},scrollLeftnum:{type:Number,default:null},scrollChange:{type:Object,default:null},moveLeng:{type:Number,default:600}},data:function(){return{isShowLeft:!1,isShowRight:!1,savedScrollLeft:0}},mounted:function(){var e=this;this.$refs.scrollArea.addEventListener("scroll",this.setMoveBtnShow),this.$once("hook:beforeDestroy",(function(){e.$refs.scrollArea.removeEventListener("scroll",e.setMoveBtnShow)}))},updated:function(){var e=this;this.$nextTick((function(){e.setMoveBtnShow()}))},watch:{scrollLeftnum:{handler:function(e){e&&e>0&&(this.$refs.scrollArea.scrollLeft=e-this.$refs.scrollArea.getBoundingClientRect().left-this.$refs.scrollArea.offsetWidth/2+50)}},scrollChange:{handler:function(e){if(e.value){var t=e.value-this.$refs.scrollArea.getBoundingClientRect().left-this.$refs.scrollArea.offsetWidth/2+50;this.tagsMove(t)}}}},activated:function(){var e=this;this.$nextTick((function(){e.setMoveBtnShow()})),this.$refs.scrollArea.scrollLeft=this.savedScrollLeft},methods:{setMoveBtnShow:function(){var e=this.$refs.scrollArea;e<=this.$refs.tags.offsetWidth&&(this.isShowRight=!1),this.isShowLeft=0!==e.scrollLeft,this.isShowRight=e.scrollLeft+e.clientWidth!==e.scrollWidth,this.savedScrollLeft=this.$refs.scrollArea.scrollLeft},tagsMove:function(e){this.$refs.scrollArea.scrollBy({left:e,behavior:"smooth"})}}},r=(n(4071),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{ref:"tags",staticClass:"c-swipe-list"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowLeft,expression:"isShowLeft"}],staticClass:"swipeab-icon-box swipeab-icon-box-left",style:{width:e.iconBntWidth+"px"}},[t("div",{staticClass:"icon-bnt",style:{width:e.iconBntWidth+"px",height:e.iconBntWidth+"px"},on:{click:function(t){return e.tagsMove("-"+e.moveLeng)}}},[t("i",{staticClass:"el-icon-arrow-left"})])]),e._v(" "),t("div",{ref:"scrollArea",staticClass:"scroll-area"},[t("div",{staticClass:"content"},[t("div",{staticClass:"list"},[e._t("default")],2)])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowRight,expression:"isShowRight"}],staticClass:"swipeab-icon-box swipeab-icon-box-right",style:{width:e.iconBntWidth+"px"}},[t("div",{staticClass:"icon-bnt",style:{width:e.iconBntWidth+"px",height:e.iconBntWidth+"px"},on:{click:function(t){return e.tagsMove(e.moveLeng)}}},[t("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"dc9b0ed2",null);t.default=component.exports},594:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(26),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={inject:["top"],components:{GRechargeBanner15min:n(3254).default},data:function(){return{isCountdownMode:!1,isFlipping:!1,discountValue:0,countdownDuration:9e5}},computed:c(c(c(c(c(c(c({},Object(r.c)("user",["isLoggedIn"])),Object(r.c)("payment",["paymentInfo"])),Object(r.e)("payment",["halfDiscountCountdown"])),Object(r.e)("user",["userInfo"])),Object(r.c)("activity",["isShowActivityBanner","currentActivity"])),Object(r.e)("creation",["generateViewShow"])),{},{isOldUser:function(){var e;return!!this.userInfo&&((new Date).getTime()-(null===(e=this.userInfo)||void 0===e?void 0:e.create_at))/1e3/3600>48},svipTxt:function(){var e,t;return this.halfDiscountCountdown?"Svip50Off":this.isShowActivityBanner?(null===(t=this.currentActivity)||void 0===t?void 0:t.createBannerKey)||"NewYearGBanner":this.isOldUser||null!==(e=this.paymentInfo)&&void 0!==e&&e.svipExpiryTime?"Svip80Off":"SvipFreeTry"}}),mounted:function(){var e=this;this.$EventBus.$on("commercialBannerSwitch",this.handleBannerSwitch),this.watchRoute=this.$watch((function(){return e.generateViewShow}),(function(t,n){n&&!t&&e.restoreOriginalBanner()}))},beforeDestroy:function(){this.$EventBus.$off("commercialBannerSwitch",this.handleBannerSwitch),this.watchRoute()},methods:{toMall:function(){var e="".concat(location.origin,"/mall");window.open(e,"_blank")},handleClick:function(){this.isLoggedIn?this.halfDiscountCountdown?this.$EventBus.$emit("showHalfGoodsDialog","on_50_percent_off_createflow_popup_banner"):this.$EventBus.$emit("openDailyDialog","createBanner"):(this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_createflow_page"}),this.$EventBus.$emit("openLoginDialog",{dot:!1}))},closeBanner:function(){var time=Date.now();localStorage.setItem("SubBannerTime",time),this.$emit("close")},handleBannerSwitch:function(data){if("countdown"===data.mode){var e=data.duration||9e5;this.discountValue=data.discount||0,this.countdownDuration=e,this.doFlipAnimation(!0)}},restoreOriginalBanner:function(){this.doFlipAnimation(!1)},doFlipAnimation:function(e){var t=this;this.isFlipping=!0,setTimeout((function(){t.isCountdownMode=e}),200),setTimeout((function(){t.isFlipping=!1}),400)}}},h=(n(4140),n(0)),component=Object(h.a)(d,(function(){var e,t,n,o=this,r=o._self._c;return r("div",{staticClass:"recharge-banner",class:{"countdown-mode":o.isCountdownMode,flip:o.isFlipping},attrs:{"data-group":"g-recharge-banner"}},[r("div",{staticClass:"banner-content original"},[r("div",{staticClass:"content"},[r("p",[o._v(o._s(o.$t(o.svipTxt)))]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.halfDiscountCountdown,expression:"halfDiscountCountdown"}],staticClass:"countdown-box flex-center"},[r("span",[o._v(o._s(null===(e=o.halfDiscountCountdown)||void 0===e?void 0:e.hours))]),o._v(" "),r("span",[o._v(":")]),o._v(" "),r("span",[o._v(o._s(null===(t=o.halfDiscountCountdown)||void 0===t?void 0:t.minutes))]),o._v(" "),r("span",[o._v(":")]),o._v(" "),r("span",[o._v(o._s(null===(n=o.halfDiscountCountdown)||void 0===n?void 0:n.seconds))])]),o._v(" "),r("div",{staticClass:"sub-btn",attrs:{"data-event":"click_banner_upgrade_btn_g-recharge-banner"},on:{click:o.handleClick}},[o._v("\n        "+o._s(o.$t("seoEraser_btn_1"))+"\n        "),r("i",{staticClass:"iconfont icon-icon-right-circle",staticStyle:{color:"#2b1d07"}})])]),o._v(" "),o.isCountdownMode?o._e():r("i",{staticClass:"iconfont icon-close",attrs:{"data-event":"click_close_banner_g-recharge-banner"},on:{click:o.closeBanner}})]),o._v(" "),r("div",{staticClass:"banner-content countdown"},[r("GRechargeBanner15min",{attrs:{discountValue:o.discountValue,duration:o.countdownDuration},on:{upgradeBtnClick:o.handleClick,countdownComplete:o.restoreOriginalBanner,close:o.closeBanner}})],1)])}),[],!1,null,"620c7dbf",null);t.default=component.exports},795:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(21);var o=n(68),r=n(3),l=n(14),c=n(2),d=(n(20),n(19),n(11),n(6),n(32),n(50),n(22),n(31),n(49),n(12),n(13),n(8),n(4),n(40),n(7),n(41),n(141),n(142),n(109),n(1)),h=n(85),m=n(303),v=n(29),f=n(851),_=n(3238),w=n(3239),y=n(25),C=n(61),S=n(137),k=n(9),x=n(33),I=n(99);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={name:"selectGenerateModelType",components:{StyleModal:m.default,LoraList:f.default,modelList:_.default,ImagePromptsList:w.default,SliderItem:S.default},props:["value"],inject:["top"],data:function(){return{modelType:1,selectList:[{code:1,label:"默认",i18nKey:"createModeType1",tips:""},{code:2,label:"海艺V6",i18nKey:"createModeType2",tips:"createModeTips2"},{code:6,label:"海艺2.1",i18nKey:"createModeType6",tips:"createModeTips6"},{code:3,label:"预览版",i18nKey:"createModeType3",tips:"createModeTips3"}],createSettings:[{code:1,i18nKey:"createSetting1",tips:""},{code:2,i18nKey:"createSetting2",tips:"createSettingTips1"}],createSetting:1,loading:!1,visible:!1,selectIds:[],selectModelType:"Checkpoint",extraModelList:[],uploadingIp:!1}},watch:{accountSettingsData:{handler:function(){this.createSetting=this.accountSettingsData.is_auto_pub_community?1:2},immediate:!0,deep:!0},"value.art_model_no":{handler:function(e,t){this.setInitModelList(e),this.isStudioMode&&this.resetStudioQualityType()},immediate:!0},"value.base_model_type":{handler:function(e,t){if(this.isStudioMode&&"textToImage"===this.top.menuIndex){if(((null===k.L||void 0===k.L?void 0:k.L.flux)||[]).includes(e)&&t!==e){var n;this.resetStudioFluxSize();var code=null===(n=this.queueRenderList[0])||void 0===n?void 0:n.code;this.handleQueueSelectChange(code)}if(e!==t&&((null===k.L||void 0===k.L?void 0:k.L.flux)||[]).includes(t)){var o,r=this.top.getStudioDefaultStyle(null===(o=this.value)||void 0===o?void 0:o.base_model_type),l=JSON.parse(JSON.stringify(this.value));l.studio.width=null==r?void 0:r.width,l.studio.height=null==r?void 0:r.height,l.ipList=[],l.lab_base.conds=(l.lab_base.conds||[]).filter((function(e){return"IpMaintain"!==e.mode})),this.$emit("input",l)}}},immediate:!0},isStudioMode:{handler:function(e){e&&(this.extraModelList=[])},immediate:!0},isSdMode:{handler:function(e){e&&(this.extraModelList=[])},immediate:!0},getCurrentModelType:{handler:function(e,t){if(this.isStudioMode){var n=JSON.parse(JSON.stringify(this.value));"SD3"===e&&t!==e&&(n.sampler_name="dpmpp_2m",n.lab_base.quality_open=!1,n.lab_base.scheduler="sgm_uniform"),"SD3"===t&&t!==e&&(n.sampler_name="DPM++ 2M Karras",n.lab_base.quality_open=!1,n.lab_base.scheduler="karras"),this.$emit("input",n)}},immediate:!0}},computed:T(T(T(T({},Object(d.c)("payment",["productLevel","activeState","paymentInfo"])),Object(d.c)("user",["userInfo","accountSettingsData","isCompanyAccount"])),Object(d.c)("creation",["taskBaseModels","sd_xl_base_model","lab_base_model","isIgnoreUnAvailableLora"])),{},{hasConflictModel:function(){var e,t,n,o=Object(I.getAdditionalModels)((null==this||null===(e=this.value)||void 0===e?void 0:e.base_model_type)||"");return((null===(t=this.value)||void 0===t?void 0:t.lora_models)||[]).some((function(e){return!o.includes(null==e?void 0:e.base_model)}))||((null===(n=this.value)||void 0===n?void 0:n.embeddings)||[]).some((function(e){return!o.includes(null==e?void 0:e.base_model)}))},showIpUpload:function(){var e;return!(null!==(e=this.value)&&void 0!==e&&e.ipList.some((function(e){return"IpMaintain"===e.mode})))},isStudioInfinity:function(){var e,t;return(null===(e=this.value)||void 0===e||null===(e=e.base_model_type)||void 0===e?void 0:e.includes("Flux"))&&!(null!==(t=this.value)&&void 0!==t&&null!==(t=t.lora_models)&&void 0!==t&&t.length)&&["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode},isStudioFlux:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.base_model_type)||void 0===e?void 0:e.includes("Flux"))&&["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode},isStudioSD35:function(){return["textToImage"].includes(this.top.menuIndex)&&this.isStudioMode&&"SD 3.5"===this.getCurrentModelType},showImagePromptsUpload:function(){var e,t,n=this.top.config.textToImage,o=4;return this.isStudioFlux&&(o=1),(null==n||null===(e=n.lab_base)||void 0===e||null===(e=e.conds)||void 0===e?void 0:e.length)>=0&&(null==n||null===(t=n.lab_base)||void 0===t||null===(t=t.conds)||void 0===t?void 0:t.length)<o},modelList:function(){var e,t;return[{art_model_no:this.value.art_model_no,art_model_ver_no:this.value.art_model_ver_no,name:this.value.modelName,is_agency_fee:this.value.is_agency_fee||this.value.agency_fee>0,agency_fee:this.value.agency_fee,banner:{url:this.value.model_cover||""},version_name:this.value.art_model_ver_no_name||"",base_model_type:this.value.base_model_type||"",base_model:this.value.base_model_type||"",modelTags:Array.isArray(null===(e=this.value)||void 0===e?void 0:e.modelTags)?null===(t=this.value)||void 0===t?void 0:t.modelTags:[],id:this.value.art_model_no,version_no:this.value.art_model_ver_no}]},isShowModel:function(){return!["faceSwap","preview","promptStudio"].includes(this.top.menuIndex)&&![3,"3",4,"4"].includes(this.value.category)},isSdMode:function(){return[5,"5","sdxl"].includes(this.value.category)},isVipFun:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},isOnlyVipLite:function(){var e,t;return!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState)&&!this.isCompanyAccount&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},canUseUnlimitedQueue:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.infiniteQueue},isStudioMode:function(){return["textToImage","imageToImage","conditionToImage"].includes(this.top.menuIndex)&&[7,"studio",11].includes(this.value.category)},renderList:function(){return this.selectList.filter((function(e){return![3,"3"].includes(e.code)}))},queueRenderList:function(){return[{code:1,i18nKey:"NormalQueue",tips:"",show:!this.isVipFun},{code:2,i18nKey:"SubsBottomTerms2",tips:"",isVip:!0,show:this.isVipFun},{code:3,i18nKey:"UnlimitedQueue",tips:this.UnlimitedQueueTip,isVip:!0,show:!(this.isStudioMode||this.isCompanyAccount)}].filter((function(e){return e.show}))},UnlimitedQueueTip:function(){return this.isCompanyAccount?"ToBUnlimitedQueueTip":"UnlimitedQueueTip"},modelsList:function(){var e=this.value,t=e.art_work_no,n=e.art_model_no,o=e.art_model_ver_no,r=void 0===o?"":o;if(this.isSdMode){var c=this.sd_xl_base_model.map((function(e){var o=e.artwork,l=e.name,c=e.id,d=e.model_ver_no,h=void 0===d?"":d,m=o?null==o?void 0:o.id:"";return{workId:t!==m&&n===c?t:m,name:l,id:c,art_model_ver_no:h||r,banner:{url:e.cover||""},version_name:(null==e?void 0:e.model_ver_name)||"",base_model_type:(null==e?void 0:e.base_model)||"",base_model:(null==e?void 0:e.base_model)||"",modelTags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]}}));return[].concat(Object(l.a)(this.extraModelList),Object(l.a)(c))}if(this.isStudioMode){var d,h=this.lab_base_model.map((function(e){e.artwork;var t=e.name,n=e.id,o=e.model_ver_no;return{name:t,id:n,art_model_ver_no:(void 0===o?"":o)||r,banner:{url:e.cover||""},version_name:(null==e?void 0:e.model_ver_name)||"",base_model_type:(null==e?void 0:e.base_model)||"",base_model:(null==e?void 0:e.base_model)||"",modelTags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]}})),m=[].concat(Object(l.a)(this.extraModelList),Object(l.a)(h));return this.isStudioMode&&["imageToImage","conditionToImage"].includes(null==this||null===(d=this.top)||void 0===d?void 0:d.menuIndex)&&(m=m.filter((function(e){var t=null==e?void 0:e.base_model.includes("SD 3.5"),n=((null===k.L||void 0===k.L?void 0:k.L.flux)||[]).includes(null==e?void 0:e.base_model);return!(t&&n)}))),m}var v=this.taskBaseModels.map((function(e){var o=e.artwork,l=e.name,c=e.id,d=e.model_ver_no,h=void 0===d?"":d,m=o?null==o?void 0:o.id:"";return{workId:t!==m&&n===c?t:m,name:l,id:c,art_model_ver_no:h||r,banner:{url:e.cover||""},version_name:(null==e?void 0:e.model_ver_name)||"",base_model_type:(null==e?void 0:e.base_model)||"",base_model:(null==e?void 0:e.base_model)||"",modelTags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]}}));return[].concat(Object(l.a)(this.extraModelList),Object(l.a)(v))},getCurrentModelType:function(){var e=(this.value||{}).base_model_type,t=void 0===e?"":e,n=null===k.L||void 0===k.L?void 0:k.L.flux,o=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony"].concat(Object(l.a)(k.L.sdxl)),r=null===k.L||void 0===k.L?void 0:k.L.sd35,c=o.includes(t)||(t||"").includes("SDXL"),d=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"].includes(t),h=n.includes(t)||(t||"").includes("Flux"),m=r.includes(t)||(t||"").includes("SD 3.5");return h?"FLUX":c?"SDXL":d?"SD":"SD 3"===t?"SD3":"Other"===t?"Other":m?"SD 3.5":void 0}}),methods:T(T(T({},Object(d.b)("user",["getAccountInfo"])),Object(d.b)("creation",["setIsIgnoreUnAvailableLoraStatus"])),{},{handleUpdateModelVersion:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=JSON.parse(JSON.stringify(this.value));n.art_model_ver_no=null==t?void 0:t.model_ver_id,n.model_cover=(null==t||null===(e=t.sample)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url)||"",n.art_model_ver_no_name=(null==t?void 0:t.version_no)||(null==t?void 0:t.model_ver_id),this.$emit("input",n)},handleUpdateLoraVersion:function(e,t){var n=this.value.lora_models;try{var o,r;if(n[t].version_name=(null==e?void 0:e.version_no)||(null==e?void 0:e.model_ver_id),n[t].model_ver_no=null==e?void 0:e.model_ver_id,null!=e&&null!==(o=e.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)n[t].banner.url=null==e||null===(r=e.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url;this.changeConfig({lora_models:n})}catch(e){}},resetStudioQualityType:function(){var e,t,n;if(![3,"3"].includes(null===(e=this.value)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.quality_mode)){var o=JSON.parse(JSON.stringify(this.value)),r=null==this||null===(t=this.top)||void 0===t?void 0:t.getStudioModelTagsType(o);r!==(null==o||null===(n=o.lab_base)||void 0===n?void 0:n.quality_type)&&(o.lab_base.quality_type=r||"anime",this.$emit("input",o))}},resetStudioFluxSize:function(){var e,t=JSON.parse(JSON.stringify(this.value));null!==(e=t.studio)&&void 0!==e&&e.keepImageSize?t.studio.keepImageSize=!1:(t.studio.width=688,t.studio.height=1024);try{var n,o,r,l,c;if(t.sampler_name="Euler",t.cfg_scale=3.5,null!=t&&null!==(n=t.lab_base)&&void 0!==n&&null!==(n=n.conds)&&void 0!==n&&n.length)t.lab_base.conds=null!=t&&null!==(r=t.lab_base)&&void 0!==r&&null!==(r=r.conds)&&void 0!==r&&r.length?null===(l=t.lab_base)||void 0===l?void 0:l.conds.slice(0,1):[],((null==t||null===(c=t.lab_base)||void 0===c?void 0:c.conds)||[]).forEach((function(e){e.weight=.8}));null!=t&&null!==(o=t.lora_models)&&void 0!==o&&o.length&&(t.lora_models=((null==t?void 0:t.lora_models)||[]).filter((function(e){return((null===k.L||void 0===k.L?void 0:k.L.flux)||[]).includes(null==e?void 0:e.base_model)}))),t.lab_base.quality_mode=3}catch(e){}this.$emit("input",t)},addImagePrompts:function(){var e,t=4;this.isStudioFlux&&(t=1),(null===(e=this.value)||void 0===e||null===(e=e.lab_base)||void 0===e||null===(e=e.conds)||void 0===e?void 0:e.length)>=t||this.$refs.imagePromptsUpload.$el.querySelector(".image-prompts-upload-btn").click()},handleDeleteImagePrompts:function(i){var e,t,n=JSON.parse(JSON.stringify(this.value));null!=n&&null!==(e=n.lab_base)&&void 0!==e&&e.conds[i]&&(null==n||null===(t=n.lab_base)||void 0===t||t.conds.splice(i,1));this.$emit("input",n)},addIpList:function(){var e;(null===(e=this.value)||void 0===e||null===(e=e.ipList)||void 0===e?void 0:e.length)>=1||(this.$refs.ipCondsUpload.$el.querySelector(".ip-prompts-upload-btn").click(),this.$logEvent("log_actions",{operation:"click_character_reference",behavior_info:"on_createflow_page"}))},handleDeleteIp:function(i){var e,t=this,n=JSON.parse(JSON.stringify(this.value));null!=n&&n.ipList[i]&&(null==n||n.ipList.splice(i,1),((null==n||null===(e=n.lab_base)||void 0===e?void 0:e.conds)||[]).forEach((function(e){"ImagePrompt"===(null==e?void 0:e.mode)&&.35===(null==e?void 0:e.weight)&&t.$set(e,"weight",.8)})));this.$emit("input",n)},changeIpConfig:function(e,t,n){try{var o=JSON.parse(JSON.stringify(this.value));o.ipList[t][n]=e,this.$emit("input",o)}catch(e){}},handleBeforeUploadIp:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("上传ip"),r=t.top.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=6;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 6:if(!(l=e)||l.size){n.next=9;break}return n.abrupt("return",!1);case 9:if(!((null===(o=t.value)||void 0===o||null===(o=o.ipList)||void 0===o?void 0:o.length)>=1)){n.next=11;break}return n.abrupt("return");case 11:return c=Object(y.uniqueId)("ipPromptList_"),d=URL.createObjectURL(new Blob([t.fileToBlob(e)])),t.updateIpImage(c,d),h=!0,n.prev=15,n.next=18,Object(C.a)(e,5242880);case 18:l=n.sent,n.next=25;break;case 21:n.prev=21,n.t0=n.catch(15),console.error("Compression failed:",n.t0),h=!1;case 25:if(h){n.next=28;break}return t.updateIpImage(c,""),n.abrupt("return",!1);case 28:return t.uploadingIp=!0,r.startUpload(l,{category:49}).then((function(e){t.uploadingIp=!1,t.updateIpImage(c,e)})).catch((function(e){t.uploadingIp=!1,t.updateIpImage(c,"")})),n.abrupt("return",!1);case 31:case"end":return n.stop()}}),n,null,[[15,21]])})))()},updateIpImage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=(this.value.ipList||[]).findIndex((function(e){return(null==e?void 0:e.id)===t}));if(-1===o){var r,l={image:n,stop_at:1,weight:.75,mode:"IpMaintain",loading:!0,id:t};this.value.ipList.push(l);var c=JSON.parse(JSON.stringify(this.value));((null==c||null===(r=c.lab_base)||void 0===r?void 0:r.conds)||[]).forEach((function(t){"ImagePrompt"===(null==t?void 0:t.mode)&&e.$set(t,"weight",.35)})),this.$emit("input",c)}else if(n){var d=JSON.parse(JSON.stringify(this.value));d.ipList[o].image=n,d.ipList[o].loading=!1,this.$emit("input",d)}else{var h=JSON.parse(JSON.stringify(this.value));null!=h&&h.ipList[o]&&(null==h||h.ipList.splice(o,1)),this.$emit("input",h)}},changeImagePromptsConfig:function(e,t,n){try{var o=JSON.parse(JSON.stringify(this.value));o.lab_base.conds[t][n]=e,this.$emit("input",o)}catch(e){}},checkImageSize:function(e){return new Promise((function(t,n){var o=new FileReader;o.onload=function(e){var img=new Image;img.onload=function(){var e=img.naturalWidth,n=img.naturalHeight;t({width:e,height:n})},img.onerror=function(){n(!1)},img.src=e.target.result},o.readAsDataURL(e)}))},handleBeforeUpload:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.top.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(l=e)||l.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(!((null===(o=t.value.lab_base)||void 0===o||null===(o=o.conds)||void 0===o?void 0:o.length)>=4)){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,t.checkImageSize(e);case 12:return c=n.sent,d=Object(y.uniqueId)("imagePromptList_"),h=URL.createObjectURL(new Blob([t.fileToBlob(e)])),t.updateImage(d,h),m=!0,n.prev=17,n.next=20,Object(C.a)(e,5242880);case 20:l=n.sent,n.next=27;break;case 23:n.prev=23,n.t0=n.catch(17),console.error("Compression failed:",n.t0),m=!1;case 27:if(m){n.next=30;break}return t.updateImage(d,""),n.abrupt("return",!1);case 30:return t.uploading=!0,r.startUpload(l,{category:2}).then((function(e){var n,o,r;t.uploading=!1;var l=t.top.getStudioDefaultStyle(null===(n=t.value)||void 0===n?void 0:n.base_model_type,t.isStudioFlux),h=t.top.convertStudioBaseSize(null==c?void 0:c.width,null==c?void 0:c.height,l),m=JSON.parse(JSON.stringify(t.value));m.studio.width=(null==h?void 0:h.width)||l.width,m.studio.height=(null==h?void 0:h.height)||l.height,console.log("图片宽：".concat(null==c?void 0:c.width," 图片高：").concat(null==c?void 0:c.height),"转换后图片宽:".concat(null===(o=m.studio)||void 0===o?void 0:o.width," 转换后图片高:").concat(null===(r=m.studio)||void 0===r?void 0:r.height),h),t.$set(t.value,"studio",m.studio),t.updateImage(d,e)})).catch((function(e){t.uploading=!1,t.$message.error(t.$t("uploadError")),t.updateImage(d,"")})),n.abrupt("return",!1);case 33:case"end":return n.stop()}}),n,null,[[17,23]])})))()},fileToBlob:function(e){return e.slice(0,e.size,e.type)},updateImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(this.value.lab_base.conds||[]).findIndex((function(t){return(null==t?void 0:t.id)===e}));if(-1===n){var o={image:t,stop_at:1,weight:1,mode:"ImagePrompt",loading:!0,id:e};if(this.isStudioFlux){var r,l=!(null===(r=this.value)||void 0===r||null===(r=r.ipList)||void 0===r||!r.length);o.weight=l?.35:.8}this.value.lab_base.conds.push(o)}else{var c=JSON.parse(JSON.stringify(this.value));c.lab_base.conds[n].image=t,c.lab_base.conds[n].loading=!1,this.$emit("input",c),t||this.handleDeleteImagePrompts(n)}},handleIconClick:function(){this.top.resetConfig(!1,"refresh")},hidePopover:function(){},handleCreateSettingSelectChange:function(e){![2,"2"].includes(e)||this.paymentInfo.show_auto_pub_switch?this.saveSettings(e):this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic")},saveSettings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.loading=!0;var n={};n.auto_pub_community=t,Object(h.c)(n).then((function(n){var o=(n||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(e.$message.success(e.$t("SaveSuccess")),e.createSetting=t,e.loading=!1,e.getAccountInfo())})).finally((function(){e.loading=!1}))},getSettingsInfo:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:e.loading=!0,e.getAccountInfo().then((function(t){var n=t||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if(["10000",1e4].includes(code)){var l=data.is_auto_pub_community,c=void 0===l||l;e.createSetting=c?1:2}})).finally((function(){e.loading=!1}));case 4:case"end":return t.stop()}}),t)})))()},changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));t&&(n[t]=e),n=T(T({},n),e),this.$emit("input",n)},studioChangeConfig:function(e,t){if(this.isStudioMode&&["prompt_magic"].includes(t)){var n=JSON.parse(JSON.stringify(this.value));n.lab_base.prompt_magic=e,this.$emit("input",n)}},changeCategory:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value)),r=o.MJ,l={MJ:{}};if(3!==e&&3!==o.category||(["local_prompt","prompt","art_work_no"].forEach((function(e){l.MJ[e]=o[e]})),l=T(T({},l),r)),l.category=e,"textToImage"===(null==this||null===(n=this.top)||void 0===n?void 0:n.menuIndex)){if([5,"5"].includes(l.category)){l.cfg_scale=5,l.steps=30,l.enablePromptMagic=!0,l.sdxl={prompt_magic:.4,prompt_style:"Fantasy Art"};var c=this.sd_xl_base_model[0];l.art_work_no="",l.art_model_ver_no=(null==c?void 0:c.model_ver_no)||"",l.agency_fee=0,l.art_model_no=c.id,l.modelName=c.name,l.model_cover=c.cover||"",l.art_model_ver_no_name=(null==c?void 0:c.model_ver_name)||"",l.lora_models=[],l.sampler_name="DPM++ 2M Karras"}else l.cfg_scale=7,l.steps=20,l.sampler_name="DPM++ 2M Karras";[5,"5"].includes(t)&&t!==l.category&&this.top.resetTextToImageMode()}localStorage.setItem("defaultCategory",l.category),this.changeConfig(l)},handleSelectChange:function(e){if(!e||![3,"3"].includes(e)||this.activeState||this.isCompanyAccount){var t=this.value.category;this.changeCategory(e,t)}else this.$message.warning(this.$t("error_code_70010"))},handleQueueSelectChange:function(e){if(![3].includes(e)||3!=e||this.isVipFun){if(!([3].includes(e)&&this.isStudioMode&&this.isCompanyAccount))if([3].includes(e)&&this.isOnlyVipLite)this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard");else if(![3].includes(e)||this.canUseUnlimitedQueue){for(var i in localStorage.setItem("speed_type",e),this.top.config)this.top.config[i]=T(T({},this.top.config[i]),{},{speed_type:e});this.$logEvent("log_actions",{operation:"click_free_create",behavior_info:"on_create_flow_page",behavior_info_sub:3===e?"open":"close"})}else this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard")}else this.$EventBus.$emit("showBreakDialog","UnlimitedQueueTipWeb","standard")},setInitModelList:function(e){var t=this.value,n=t.art_work_no,o=t.modelName,r=t.art_model_no,l=t.category,c=t.agency_fee,d=void 0===c?0:c,h=t.model_cover,m=void 0===h?"":h,v=t.art_model_ver_no_name,f=void 0===v?"":v,_=t.base_model_type,w=void 0===_?"":_,y=t.modelTags,C=void 0===y?[]:y;this.extraModelList=[];var S=this.taskBaseModels.some((function(e){return e.id===r}));if(this.isSdMode&&(S=this.sd_xl_base_model.some((function(e){return e.id===r}))),this.isStudioMode&&(S=this.lab_base_model.some((function(e){return e.id===r}))),3!==l){if(!e){var k,x,I,O,T,L,$,M,P,j,D,N,R,E,A,U,B,F,z,H;if(this.isSdMode){var V=(null==this?void 0:this.sd_xl_base_model[0])||{},W=V.name,G=V.artwork,J=void 0===G?{}:G,X=V.id,K=V.art_model_ver_no,Z=V.agency_fee,Y=void 0===Z?0:Z,Q=V.cover,ee=void 0===Q?"":Q,te=V.art_model_ver_no_name,ie=void 0===te?"":te,ne=V.model_ver_no,se=void 0===ne?"":ne,ae=V.model_ver_name,oe=void 0===ae?"":ae,re=V.base_model,le=void 0===re?"":re,ce=V.tags,de=void 0===ce?[]:ce;return void this.changeConfig({art_work_no:(null==J?void 0:J.id)||"",modelName:W,art_model_no:X,art_model_ver_no:se||K,agency_fee:Y||0,model_cover:ee||"",art_model_ver_no_name:oe||ie,base_model_type:le||"",modelTags:Array.isArray(de)?de:[]})}return this.isStudioMode?void this.changeConfig({art_work_no:(null===(D=this.lab_base_model[0])||void 0===D||null===(D=D.artwork)||void 0===D?void 0:D.id)||"",modelName:null===(N=this.lab_base_model[0])||void 0===N?void 0:N.name,art_model_no:null===(R=this.lab_base_model[0])||void 0===R?void 0:R.id,art_model_ver_no:null===(E=this.lab_base_model[0])||void 0===E?void 0:E.model_ver_no,agency_fee:(null===(A=this.lab_base_model[0])||void 0===A?void 0:A.agency_fee)||0,model_cover:(null===(U=this.lab_base_model[0])||void 0===U?void 0:U.cover)||"",art_model_ver_no_name:(null===(B=this.lab_base_model[0])||void 0===B?void 0:B.model_ver_name)||"",base_model_type:(null===(F=this.lab_base_model[0])||void 0===F?void 0:F.base_model)||"",modelTags:Array.isArray(null===(z=this.lab_base_model[0])||void 0===z?void 0:z.tags)?null===(H=this.lab_base_model[0])||void 0===H?void 0:H.tags:[]}):void this.changeConfig({art_work_no:(null===(k=this.taskBaseModels[0])||void 0===k||null===(k=k.artwork)||void 0===k?void 0:k.id)||"",modelName:null===(x=this.taskBaseModels[0])||void 0===x?void 0:x.name,art_model_no:null===(I=this.taskBaseModels[0])||void 0===I?void 0:I.id,art_model_ver_no:null===(O=this.taskBaseModels[0])||void 0===O?void 0:O.model_ver_no,agency_fee:(null===(T=this.taskBaseModels[0])||void 0===T?void 0:T.agency_fee)||0,model_cover:(null===(L=this.taskBaseModels[0])||void 0===L?void 0:L.cover)||"",art_model_ver_no_name:(null===($=this.taskBaseModels[0])||void 0===$?void 0:$.model_ver_name)||"",base_model_type:(null===(M=this.taskBaseModels[0])||void 0===M?void 0:M.base_model)||"",modelTags:Array.isArray(null===(P=this.taskBaseModels[0])||void 0===P?void 0:P.tags)?null===(j=this.taskBaseModels[0])||void 0===j?void 0:j.tags:[]})}S||(this.extraModelList=[{id:r,name:o,workId:n,agency_fee:d||0,banner:{url:m||""},version_name:f,base_model_type:w,base_model:w,modelTags:Array.isArray(C)?C:[]}])}},changeLora:function(e,t,n){"DEL"===e?this.deleteModel(t):this.changeWeight(n,t)},changeModel:function(e,t,n){"DEL"===e&&this.showModelPopup("Checkpoint")},changeWeight:function(e,t){var n=this.value.lora_models;n[t].weight=e,this.changeConfig({lora_models:n})},showModelPopup:function(e){var t,n=this;if(this.selectModelType=e,"Checkpoint"===e)this.selectIds=[{id:this.value.art_model_no,art_model_ver_no_name:this.value.art_model_ver_no_name,model_cover:this.value.model_cover}];else if(this.selectIds=this.value.lora_models,(null==this||null===(t=this.value)||void 0===t||null===(t=t.lora_models)||void 0===t?void 0:t.length)>=5)return;this.$nextTick((function(){n.$refs.styleModal.openModal()}))},handleSelectModel:function(e){if(null!=e&&e.base_model&&this.$refs.styleModal){var t,n,o,r=(null==e||null===(t=e.base_model)||void 0===t?void 0:t.toLowerCase().includes("sdxl"))||(null==e||null===(n=e.base_model)||void 0===n?void 0:n.toLowerCase().includes("pony"))||((null===k.L||void 0===k.L?void 0:k.L.sdxl)||[]).includes(null==e?void 0:e.base_model);if(null!==(o=this.$refs.styleModal)&&void 0!==o&&o.isSDXL){if(!r)return void this.$message.error(this.$t("setModelVererr"))}else if(r&&!this.isStudioMode)return void this.$message.error(this.$t("setModelVererr"))}"LORA"===this.selectModelType?this.selectLoraHandle(e):this.selectModelHandle(e),this.$refs.styleModal.handleClose()},selectModelHandle:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m,v,f,_,w,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("选择模型处理--",e),"MoreModel"!==e){n.next=4;break}return t.showModelPopup("Checkpoint"),n.abrupt("return");case 4:return n.next=6,t.getModelInfo(e);case 6:if(m=n.sent,t.modelsList.some((function(e){return e.id===m.id}))||(t.extraModelList=[m]),v=[],Array.isArray(null==m?void 0:m.modelTags)&&null!=m&&null!==(o=m.modelTags)&&void 0!==o&&o.length&&(v=null==m?void 0:m.modelTags),Array.isArray(null==m?void 0:m.tags)&&null!=m&&null!==(r=m.tags)&&void 0!==r&&r.length&&(v=null==m?void 0:m.tags),!(t.isStudioMode&&m.base_model.includes("Flux")&&["imageToImage","conditionToImage"].includes(null==t||null===(l=t.top)||void 0===l?void 0:l.menuIndex))){n.next=15;break}return t.$message.warning(t.$t("studioTips1")),n.abrupt("return");case 15:if(f={},(null==m?void 0:m.base_model)===(null==t||null===(c=t.value)||void 0===c?void 0:c.base_model_type)){n.next=22;break}if(Object(x.checkIsSameModelType)(null==t||null===(_=t.value)||void 0===_?void 0:_.base_model_type,null==m?void 0:m.base_model)){n.next=22;break}return n.next=20,null==t||null===(w=t.top)||void 0===w?void 0:w.getModelDefaultConfig(null==m?void 0:m.base_model);case 20:f=n.sent,console.log("切换前的模型类型:".concat(null==t||null===(y=t.value)||void 0===y?void 0:y.base_model_type,",切换后的模型类型:").concat(m.base_model),"切换后对应的默认参数值",f);case 22:t.changeConfig(T({art_work_no:m.sample_ids?m.sample_ids[0]:m.workId,modelName:m.name,art_model_no:m.id,art_model_ver_no:e.art_model_ver_no||e.model_ver_no||"",agency_fee:(null==e?void 0:e.agency_fee)||0,model_cover:(null==m||null===(d=m.banner)||void 0===d?void 0:d.url)||(null==e||null===(h=e.banner)||void 0===h?void 0:h.url)||"",art_model_ver_no_name:m.version_name||e.version_name,base_model_type:m.base_model,modelTags:v},f));case 23:case"end":return n.stop()}}),n)})))()},selectLoraHandle:function(e){var t=this.value.lora_models,n=T({model_id:e.id,weight:1},e);if(!((null==t?void 0:t.length)>=5))if(!this.isVipFun&&(null==t?void 0:t.length)>=3)this.$EventBus.$emit("showBreakDialog","LoRALimit5TipWeb","basic");else{var o=t.findIndex((function(e){return e.id===n.id}));-1!==o?t[o]=n:t.push(n),this.changeConfig({lora_models:t})}},viewImage:function(e){var t=this.value.lora_models[e];this.$refs.loraPopup.show(!0,t)},deleteModel:function(e){var t=JSON.parse(JSON.stringify(this.value));t.lora_models.splice(e,1),this.changeConfig({lora_models:t.lora_models})},getModelInfo:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,l,c,d,h,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!("object"===Object(o.a)(e))){n.next=17;break}if(!e.sample_ids&&2!==e.publish_status){n.next=6;break}return n.abrupt("return",e);case 6:if(1!==e.publish_status||e.sample_ids){n.next=8;break}return n.abrupt("return",e);case 8:return n.next=10,Object(v.getTaskConfig)({art_model_ver_no:e.model_ver_no});case 10:return r=n.sent,l=r.data,c=l.art_model,d=c.id,h=c.name,m=l.art_work_no,n.abrupt("return",{id:d,name:h,workId:m,art_model_ver_no:e.model_ver_no,base_model:e.base_model||"",tags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]});case 17:return n.abrupt("return",t.modelsList.find((function(t){return t.id===e})));case 18:case"end":return n.stop()}}),n)})))()}})},$=L,M=(n(4101),n(4102),n(0)),component=Object(M.a)($,(function(){var e,t,o,r,l,c,d,h=this,m=h._self._c;return m("div",{staticClass:"c-select-generate-model-type model-handle handle-item"},[m("div",{staticClass:"item-head"},[m("label",[m("i",{staticClass:"iconfont icon-moxingicon model-icon title"}),h._v("\n      "+h._s(h.$t("taskCommonConfig"))+"\n    ")]),h._v(" "),m("div",{staticClass:"btn-box"},[m("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"left",enterable:!1,content:h.$t("resetAllConfig")}},[m("div",{staticClass:"item-head-btn item-head-btn-margin",on:{click:function(e){return e.stopPropagation(),h.handleIconClick.apply(null,arguments)}}},[m("span",{staticClass:"el-icon-refresh"})])]),h._v(" "),m("el-popover",{ref:"Popover",attrs:{title:"",trigger:"hover","popper-class":"c-select-generate-model-type-popover","append-to-body":!0,"visible-arrow":!1,offset:20},on:{hide:h.hidePopover},model:{value:h.visible,callback:function(e){h.visible=e},expression:"visible"}},[m("div",{staticClass:"item-content"},[null!==(e=h.top)&&void 0!==e&&e.isShowPopup&&!h.isCompanyAccount?m("div",{directives:[{name:"show",rawName:"v-show",value:"promptStudio"!==h.top.menuIndex,expression:"top.menuIndex !== 'promptStudio'"}],staticClass:"h-item m-item"},[m("div",{staticClass:"item-head"},[m("label",[h._v("\n                "+h._s(h.$t("workPermissions"))+"\n              ")]),h._v(" "),m("el-select",{attrs:{value:h.createSetting,placeholder:"","popper-class":"custom-select custom-select-top-40",loading:h.loading,disabled:h.loading,"popper-append-to-body":!1},on:{change:h.handleCreateSettingSelectChange}},h._l(h.createSettings,(function(e,i){return m("el-option",{key:"createSetting"+i,attrs:{label:h.$t(e.i18nKey),value:e.code}},[h._v("\n                  "+h._s(h.$t(e.i18nKey))+"\n                  "),e.tips?m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t(e.tips),placement:"top-start"}},[m("span",{staticClass:"el-icon-warning custom-tips"})]):h._e()],1)})),1)],1)]):h._e()]),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:!["promptStudio"].includes(h.top.menuIndex),expression:"!['promptStudio'].includes(top.menuIndex)"}],staticClass:"item-head-btn",attrs:{slot:"reference"},slot:"reference"},[m("span",{staticClass:"el-icon-setting"})])])],1)]),h._v(" "),m("div",{staticClass:"item-content"},[this.isCompanyAccount?h._e():m("div",{staticClass:"queue-switch refiner-switch"},[m("label",[h._v(h._s(h.$t("daily_rights_2"))+"\n        "),m("el-tooltip",{attrs:{content:h.$t(this.UnlimitedQueueTip),placement:"top-start",effect:"light"}},[m("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}})])],1),h._v(" "),m("el-switch",{attrs:{"data-event":"old_generate_menu_switch_free","active-color":"#3F8CFF",value:h.value.speed_type,"active-value":3,"inactive-value":h.queueRenderList[0].code},on:{change:function(e){return h.handleQueueSelectChange(e)}}})],1),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:h.isShowModel,expression:"isShowModel"}],staticClass:"h-item m-item"},[m("div",{staticClass:"item-head"},[m("label",[h._v("\n          "+h._s(h.$t("Model"))+"\n        ")]),h._v(" "),m("el-select",{staticClass:"opacity-inner",attrs:{value:h.value.art_model_no,placeholder:"","popper-class":"custom-select generate-model-custom-select","popper-append-to-body":!1},on:{change:h.selectModelHandle}},[h._l(h.modelsList,(function(e,i){return m("el-option",{key:"model_"+i,attrs:{label:e.name,value:e.id}},[m("el-tooltip",{attrs:{content:e.name,placement:"left"}},[m("span",[h._v(h._s(e.name))])])],1)})),h._v(" "),m("el-option",{attrs:{label:h.$t("selectMoreModel"),value:"MoreModel"}})],2)],1),h._v(" "),m("model-list",{attrs:{list:h.modelList},on:{change:h.changeModel,updateModelVersionInfo:h.handleUpdateModelVersion}})],1),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:h.isShowModel&&!["expansion","characterRepair"].includes(h.top.menuIndex)||(null===(t=h.value)||void 0===t?void 0:t.base_model_type.includes("Flux")),expression:"\n        (isShowModel && !['expansion', 'characterRepair'].includes(top.menuIndex)) ||\n        value?.base_model_type.includes('Flux')\n      "}],staticClass:"h-item l-item"},[m("div",{staticClass:"item-head",on:{click:function(e){return h.showModelPopup("LORA",e)}}},[m("label",[h._v("\n          "+h._s(h.$t("LoRA"))+"\n        ")]),h._v(" "),m("i",{directives:[{name:"show",rawName:"v-show",value:(null===(o=h.value)||void 0===o||null===(o=o.lora_models)||void 0===o?void 0:o.length)<5,expression:"value?.lora_models?.length < 5"}],staticClass:"el-icon-circle-plus"})]),h._v(" "),h.isStudioMode&&h.hasConflictModel?m("div",{staticClass:"other-style ignore-available-lora-switch"},[m("label",[h._v(h._s(h.$t("ignoreUnAvailableLoraTips"))+" ")]),h._v(" "),m("el-switch",{attrs:{"active-color":"#3F8CFF",value:h.isIgnoreUnAvailableLora,"active-value":"on","inactive-value":"off"},on:{change:h.setIsIgnoreUnAvailableLoraStatus}})],1):h._e(),h._v(" "),m("lora-list",{attrs:{list:h.value.lora_models,"is-studio-mode":h.isStudioMode,"studio-model-info":h.modelList[0]},on:{updateLoraInfo:h.handleUpdateLoraVersion,change:h.changeLora}})],1),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:["textToImage","promptStudio"].includes(h.top.menuIndex)&&!h.isStudioMode&&!h.isSdMode,expression:"['textToImage', 'promptStudio'].includes(top.menuIndex) && !isStudioMode && !isSdMode"}],staticClass:"h-item m-item"},[m("div",{staticClass:"item-head"},[m("label",[h._v("\n          "+h._s(h.$t("createModeTitle"))+"\n        ")]),h._v(" "),m("el-select",{attrs:{value:h.value.category,placeholder:"","popper-class":"custom-select","popper-append-to-body":!1},on:{change:h.handleSelectChange}},h._l(h.renderList,(function(e,i){return m("el-option",{key:"category"+i,attrs:{label:h.$t(e.i18nKey),value:e.code}},[h._v("\n            "+h._s(h.$t(e.i18nKey))+"\n            "),e.isVip?m("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}):h._e(),h._v(" "),e.tips?m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t(e.tips),placement:"top-start"}},[m("span",{staticClass:"el-icon-warning custom-tips"})]):h._e()],1)})),1)],1)]),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:"sdxl"===h.top.creativeMode&&h.top.handleModelType,expression:"top.creativeMode === 'sdxl' && top.handleModelType"}],staticClass:"other-style refiner-switch"},[m("label",[h._v(h._s(h.$t("Refiner"))+" ")]),h._v(" "),m("el-switch",{attrs:{"active-color":"#3F8CFF","active-value":1,"inactive-value":0},on:{change:function(e){return h.changeConfig(e,"refiner_mode")}},model:{value:h.value.refiner_mode,callback:function(e){h.$set(h.value,"refiner_mode",e)},expression:"value.refiner_mode"}})],1),h._v(" "),m("slider-item",{directives:[{name:"show",rawName:"v-show",value:h.value.refiner_mode&&"sdxl"===h.top.creativeMode&&h.top.handleModelType,expression:"value.refiner_mode && top.creativeMode === 'sdxl' && top.handleModelType"}],staticClass:"refiner-slider",attrs:{value:h.value.refiner_switch_at,min:.1,max:1,step:.1,"show-tooltip":!1,precision:2,label:"Switch at",tips:h.$t("refiner_tips")},on:{change:function(e){return h.changeConfig(e,"refiner_switch_at")}}}),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:h.isStudioMode&&["textToImage"].includes(h.top.menuIndex),expression:"isStudioMode && ['textToImage'].includes(top.menuIndex)"}],staticClass:"h-item l-item"},[m("div",{staticClass:"item-head",on:{click:function(e){return e.stopPropagation(),h.addImagePrompts()}}},[m("label",[h._v("\n          "+h._s(h.isStudioFlux||h.isStudioSD35?h.$t("ImgToImg"):h.$t("studio1"))+"\n          "),m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("studio2"),placement:"top-start"}},[m("span",{staticClass:"el-icon-warning custom-tips custom-tips-show"})])],1),h._v(" "),m("i",{directives:[{name:"show",rawName:"v-show",value:h.showImagePromptsUpload,expression:"showImagePromptsUpload"}],staticClass:"el-icon-circle-plus",on:{click:function(e){return e.stopPropagation(),h.addImagePrompts()}}})]),h._v(" "),null!==(r=h.value.lab_base)&&void 0!==r&&null!==(r=r.conds)&&void 0!==r&&r.length?m("image-prompts-list",{ref:"imagePromptsList",attrs:{list:h.value.lab_base.conds,isStudioFlux:h.isStudioFlux},on:{deleteParam:h.handleDeleteImagePrompts,update:h.changeImagePromptsConfig}}):h._e(),h._v(" "),m("el-upload",{key:"imagePromptsUpload",ref:"imagePromptsUpload",staticClass:"image-upload",staticStyle:{display:"none !important"},attrs:{action:"#",accept:".jpg,.png,.jpeg,.webp","before-upload":h.handleBeforeUpload,"http-request":function(){},"show-file-list":!1}},[m("i",{staticClass:"el-icon-upload image-upload-icon"}),h._v(" "),m("el-button",{staticClass:"image-prompts-upload-btn",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[h._v(h._s(h.$t("UploadImg")))])],1)],1),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:h.isStudioInfinity,expression:"isStudioInfinity"}],staticClass:"h-item l-item"},[m("div",{staticClass:"item-head",on:{click:function(e){return e.stopPropagation(),h.addIpList()}}},[m("label",[h._v("\n          "+h._s(h.$t("studio46"))+"\n          "),m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("studio47"),placement:"top-start"}},[m("span",{staticClass:"el-icon-warning custom-tips custom-tips-show"})])],1),h._v(" "),m("i",{directives:[{name:"show",rawName:"v-show",value:h.showIpUpload,expression:"showIpUpload"}],staticClass:"el-icon-circle-plus",on:{click:function(e){return e.stopPropagation(),h.addIpList()}}})]),h._v(" "),null!==(l=h.value)&&void 0!==l&&null!==(l=l.ipList)&&void 0!==l&&l.length?m("image-prompts-list",{key:"ipPromptsList",ref:"imagePromptsList",attrs:{list:h.value.ipList,isStudioFlux:h.isStudioFlux},on:{deleteParam:h.handleDeleteIp,update:h.changeIpConfig}}):h._e(),h._v(" "),m("el-upload",{key:"ipCondsUpload",ref:"ipCondsUpload",staticClass:"image-upload",staticStyle:{display:"none !important"},attrs:{action:"#",accept:".jpg,.png,.jpeg,.webp","before-upload":h.handleBeforeUploadIp,"http-request":function(){},"show-file-list":!1}},[m("i",{staticClass:"el-icon-upload image-upload-icon"}),h._v(" "),m("el-button",{staticClass:"ip-prompts-upload-btn",attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[h._v(h._s(h.$t("UploadImg")))])],1)],1),h._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:h.isStudioFlux||h.isStudioSD35,expression:"isStudioFlux || isStudioSD35"}],staticClass:"other-style refiner-switch"},[m("label",[h._v(h._s(h.$t("studio28"))+"\n        "),m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("studio45"),placement:"top-start"}},[m("span",{staticClass:"el-icon-warning custom-tips"})])],1),h._v(" "),m("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:function(e){return h.studioChangeConfig(e,"prompt_magic")}},model:{value:h.value.lab_base.prompt_magic,callback:function(e){h.$set(h.value.lab_base,"prompt_magic",e)},expression:"value.lab_base.prompt_magic"}})],1)],1),h._v(" "),m("style-modal",{ref:"styleModal",attrs:{"model-type":h.selectModelType,"select-list":h.selectIds,isSDXL:h.isSdMode,inTask:!0,fluxModelId:null===(c=h.top)||void 0===c?void 0:c.fluxModelId,"menu-index":null===(d=h.top)||void 0===d?void 0:d.menuIndex,"is-studio-mode":h.isStudioMode,"studio-model-info":h.modelList[0]},on:{selectModel:h.handleSelectModel}})],1)}),[],!1,null,"7595d342",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},799:function(e,t,n){"use strict";var o=n(802),r=(n(4128),n(0)),component=Object(r.a)(o.a,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"PromptItem dnd-item",class:["type-".concat(e.item.data.word.type),"subType-".concat(e.item.data.word.subType),{disabled:e.item.data.disabled,isEdit:e.item.state.isEdit}],on:{click:e.onClick,contextmenu:function(t){return t.preventDefault(),e.$emit("contextmenu",{el:e.$el,item:e.item,event:t})},dblclick:function(t){return e.$emit("contextmenu",{el:e.$el,item:e.item,event:t})},mousedown:e.onMousedown}},[t("div",{staticClass:"content"},[t("div",{staticClass:"displayName name"},["text"==e.item.state.isEdit?t("span",{ref:"input",staticClass:"input",attrs:{contenteditable:"true"},on:{keydown:e.onKeydown,blur:e.onBlur}},[e._v(e._s(e.displayName)+"\n      ")]):t("span",[e._v(e._s(e.displayName))]),e._v(" "),e.displayLv?t("div",{staticClass:"lv"},[e._v(e._s(e.displayLv))]):e._e()]),e._v(" "),e.langName||"lang"==e.item.state.isEdit?t("div",{staticClass:"langName name"},["lang"==e.item.state.isEdit?t("span",{ref:"inputLang",staticClass:"input inputLang",attrs:{contenteditable:"true"},on:{keydown:e.onKeydownLang,blur:e.onBlurLang}},[e._v(e._s(e.langName))]):t("span",[e._v(" "+e._s(e.langName))])]):e._e()]),e._v(" "),e._m(0)])}),[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"dnd-slots"},[t("div",{staticClass:"dnd-slot-pre"}),e._v(" "),t("div",{staticClass:"dnd-slot-next"})])}],!1,null,"5c5368ce",null);t.a=component.exports},847:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(32),n(50),n(22),n(49),n(4),n(21),n(26),n(3226)),l=n(326),c=n(10),d=n(1);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={components:{ChannelEditPopup:r.default},inject:["top"],props:{tooltipDisabled:{type:Boolean,default:!1},addBtnPosition:{type:String,default:"top"}},data:function(){return{loading:!1,timer:null,channelList:[{name:"PRIVATE",channel_id:"PRIVATE",owner_id:"",about:"OnlySee",num:0,isNew:!1}]}},computed:m({},Object(d.e)("user",["userInfo"])),mounted:function(){this.init()},methods:{init:function(){var e=localStorage.getItem("channelInviteCode");if(this.$EventBus.$on("chatMessage",this.handleMessage),e)return this.joinChannel(e),void localStorage.removeItem("channelInviteCode");this.channelList.length<2&&this.getChannelList()},handleMessage:function(e){var t=e.type,n=e.channel_id;switch(t){case 1:this.channelListSort(n);break;case 2:this.joinMessage(e);break;case 3:this.quitMessage(e);break;case 6:this.kickOutChannel(e)}},channelListSort:function(e){var t=this.getChannelIndex(e);-1!==t&&(this.channelList[t].isNew=!0,this.channelList[t]=this.channelList.splice(1,1,this.channelList[t])[0])},kickOutChannel:function(e){var t=e.member_kick_outs,n=e.channel_id,o=this.getChannelIndex(n),r=this.channelList[o].name;if(t.includes(this.userInfo.id)){if(this.channelList.splice(o,1),this.top.channelId===n){var l=this.channelList[0];this.top.changeHandle({channelId:l.channel_id,channelInfo:l})}this.$message.warning(this.$t("KickChannelMsg")+": "+r)}else this.updateChannelInfo(this.channelList[o])},joinMessage:function(e){var t=e.channel_id,n=this.getChannelIndex(t);this.updateChannelInfo(this.channelList[n])},quitMessage:function(e){var t=e.member_leaves,n=e.channel_id,o=this.getChannelIndex(n);t.includes(this.userInfo.id)||this.updateChannelInfo(this.channelList[o])},getChannelIndex:function(e){return this.channelList.findIndex((function(t){return t.channel_id===e}))},updateChannelInfo:function(e){e.channel_id===this.top.channelId&&this.getChannelInfo({channel_id:e.channel_id})},getChannelList:function(e){var t=this;this.loading=!0,this.channelList.splice(1,this.channelList.length-1),Object(l.e)().then((function(n){var o=n.data.items,r=t.channelList.concat(o.map((function(e){return m(m({},e),{},{num:1,isNew:!1})})));t.$set(t,"channelList",r),t.loading=!1,e&&t.changeChannel(e)})).catch((function(e){t.loading=!1}))},joinChannel:function(e){var t=this;Object(l.g)({channel_id:e}).then((function(e){var n=e.data.channel_id;t.$message.success(t.$t("JoinChannelSuccess")),t.getChannelList(n)})).catch((function(e){t.getChannelInfo({invite_code:invite_code})}))},addChannel:function(){this.$refs.createChannelPopup.show(!0)},changeChannel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PRIVATE",n=this.channelList.find((function(e){return e.channel_id===t}));n.isNew=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){e.top.changeHandle({channelId:t,channelInfo:n}),"PRIVATE"!==t&&e.getChannelInfo({channel_id:n.channel_id}),clearTimeout(e.timer),e.timer=null}),300)},getChannelInfo:function(e){var t=this;Object(l.d)(e).then((function(e){var n=e.data,o=n.member_count,r=n.channel_id,l=t.getChannelIndex(r);l>-1?(t.channelList[l].num=o,t.top.channelId===t.channelList[l].channel_id&&t.top.changeHandle({channelInfo:t.channelList[l]})):t.getChannelList(r)}))},submitChannel:function(e){var t=this;(e.channel_id?l.c:l.a)(e).then((function(n){t.getChannelList(),t.$message.success(t.$t(e.channel_id?"editSuccess":"CreateSuccess")),t.$refs.createChannelPopup.close()})).catch((function(e){t.$refs.createChannelPopup.show(!0)}))},editChannel:function(e){this.$refs.createChannelPopup.show(!0,e)},handleMore:function(e,t){switch(e){case"INVITE":this.invitePerson(t);break;case"EDIT":this.editChannel(t);break;case"Disband":this.disbandChannel(t);break;default:this.quitChannel(t)}},invitePerson:function(e){var t=e.channel_id,n=(e.name,this.userInfo),o=n.name,r=n.id,l=this.channelList.find((function(e){return e.channel_id===t})),d=(null==l?void 0:l.invite_url)||"";Object(c.g)((o||r)+" "+this.$t("ChannelInviteLink")+"\n"+d),this.$message.success(this.$t("CopiedURLToClipboard"))},quitChannel:function(e){var t=this,n=e.channel_id,o=this.channelList.findIndex((function(e){return e.channel_id===n}));this.$confirm(this.$t("QuitChannelWarn"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(l.i)({channel_id:n}).then((function(e){t.$message.success(t.$t("QuitSuccess")),t.channelList.splice(o,1),t.changeChannel()})).catch((function(){t.$message.warning(t.$t("QuitFail"))}))}))},disbandChannel:function(e){var t=this,n=e.channel_id,o=void 0===n?"":n,r=this.channelList.findIndex((function(e){return e.channel_id===o}));this.$confirm(this.$t("disbandChannelWarn"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(l.b)({channel_id:o}).then((function(e){t.$message.success(t.$t("OperateSuccess")),t.channelList.splice(r,1),t.changeChannel()})).catch((function(){t.$message.warning(t.$t("taskOperateFailed"))}))}))}}},f=v,_=(n(4051),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"handle-panel channel-panel"},[["top"].includes(e.addBtnPosition)?t("div",{staticClass:"panel-head"},[t("span",{staticClass:"panel-title"},[e._v(e._s(e.$t("Channel")))]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:e.tooltipDisabled,content:e.$t("AddChannelTitle"),placement:"top-end"}},[t("i",{staticClass:"iconfont icon-add",on:{click:e.addChannel}})])],1):e._e(),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"channel-list"},[["bottom"].includes(e.addBtnPosition)?t("div",{staticClass:"channel-item channel-item-add",on:{click:function(t){return t.stopPropagation(),e.addChannel.apply(null,arguments)}}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:e.tooltipDisabled,content:e.$t("AddChannelTitle"),placement:"top-end"}},[t("span",{staticClass:"el-icon-circle-plus-outline channel-item-add-icon"})]),e._v(" "),t("span",{staticClass:"panel-title"},[e._v(e._s(e.$t("Channel")))])],1):e._e(),e._v(" "),e._l(e.channelList,(function(n,i){return t("div",{key:"channel_"+i,staticClass:"channel-item",class:{active:e.top.channelId===n.channel_id,new:n.isNew}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:e.tooltipDisabled,content:e.$t("Owenr"),placement:"top-end"}},[t("i",{directives:[{name:"show",rawName:"v-show",value:n.owner_id===e.userInfo.id||!n.owner_id,expression:"channel.owner_id === userInfo.id || !channel.owner_id"}],staticClass:"iconfont icon-user2 owner-icon"})]),e._v(" "),t("div",{staticClass:"channel-info",on:{click:function(t){return e.changeChannel(n.channel_id)}}},[t("p",{staticClass:"name"},[e._v(e._s("PRIVATE"===n.name?e.$t("PRIVATE"):n.name))])]),e._v(" "),t("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"PRIVATE"!==n.channel_id,expression:"channel.channel_id !== 'PRIVATE'"}],staticClass:"more-btn",attrs:{trigger:"click"},on:{command:function(t){return e.handleMore(t,n)}}},[t("i",{staticClass:"el-icon-more more-icon"}),e._v(" "),t("el-dropdown-menu",{staticClass:"custom-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:n.owner_id===e.userInfo.id,expression:"channel.owner_id === userInfo.id"}],attrs:{icon:"el-icon-user",command:"INVITE"}},[e._v(e._s(e.$t("Invite")))]),e._v(" "),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:n.owner_id===e.userInfo.id,expression:"channel.owner_id === userInfo.id"}],attrs:{icon:"el-icon-edit",command:"EDIT"}},[e._v(e._s(e.$t("Edit")))]),e._v(" "),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:n.owner_id===e.userInfo.id,expression:"channel.owner_id === userInfo.id"}],attrs:{icon:"el-icon-circle-close",command:"Disband"}},[e._v(e._s(e.$t("disband")))]),e._v(" "),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:n.owner_id!==e.userInfo.id,expression:"channel.owner_id !== userInfo.id"}],attrs:{icon:"el-icon-switch-button",command:"QUIT"}},[e._v(e._s(e.$t("Quit")))])],1)],1)],1)}))],2),e._v(" "),t("channel-edit-popup",{ref:"createChannelPopup",on:{submit:e.submitChannel}})],1)}),[],!1,null,"9b429d22",null);t.default=component.exports},851:function(e,t,n){"use strict";n.r(t);n(18);var o=n(14),r=(n(19),n(16),n(21),n(10)),l=n(3234),c=n(138),d=n(9),h=n(406),m={props:{list:{type:Array,default:function(){return[]}},isStudioMode:{type:Boolean,default:!1},studioModelInfo:{type:Object,default:function(){return{}}}},components:{LoraPopup:l.default,modelPayNum:c.default,changeVerNew:h.default},data:function(){return{}},computed:{checkStudioLoraType:function(){var e=this;return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).base_model,n=(e.studioModelInfo||{}).base_model_type,r=null===d.L||void 0===d.L?void 0:d.L.flux,l=["SD 3"],c=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony"].concat(Object(o.a)(d.L.sdxl)),h=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"],m=null===d.L||void 0===d.L?void 0:d.L.sd35,v=r.includes(n)||(n||"").includes("Flux"),f=c.includes(n)||(n||"").includes("SDXL"),_=h.includes(n),w=l.includes(n),y=m.includes(n)||(n||"").includes("SD 3.5"),C=c.includes(t)||(t||"").includes("SDXL"),S=h.includes(t),k=l.includes(t),x=r.includes(t),I=m.includes(t)&&n===t;return f&&!C||_&&!S||w&&!k||v&&!x||y&&!I}}},methods:{handleOpenPopup:function(e){try{var t;null===(t=this.$refs)||void 0===t||null===(t=t[e])||void 0===t||t.openPopup()}catch(e){}},handleChangeLoraVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;this.$emit("updateLoraInfo",e,t)},changeUrl:function(e){return Object(r.K)(e,"high")},changeWeight:function(e,t){this.$emit("change","WEIGHT",t,e)},deleteModel:function(e){this.$emit("change","DEL",e)},viewLora:function(i){var e=this.list[i],t=this.localePath("/models/detail/".concat(e.id));window.open(t,"_blank")}}},v=m,f=(n(4093),n(0)),component=Object(f.a)(v,(function(){var e,t=this,n=t._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=t.list)||void 0===e?void 0:e.length,expression:"list?.length"}],staticClass:"lora-list"},[n("lora-popup",{ref:"loraPopup"}),t._v(" "),t._l(t.list,(function(img,i){return n("div",{key:"selectMode_"+i,staticClass:"lora-item"},[n("div",{staticClass:"image-box",on:{click:function(e){return t.viewLora(i)}}},[img.is_agency_fee?n("div",{staticClass:"payNum"},[n("modelPayNum",{attrs:{number:img.agency_fee}})],1):t._e(),t._v(" "),img.banner.url?n("el-image",{attrs:{src:img.banner&&t.changeUrl(img.banner.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})]),t._v(" "),n("template",{slot:"error"},[n("img",{staticClass:"select-model-image",attrs:{src:img&&img.banner?img.banner.url:"",alt:""}})])],2):n("p",{staticClass:"empty-img"},[t._v(t._s(t.$t("EmptyBannerText")))]),t._v(" "),t.checkStudioLoraType(img)?t._e():n("div",{staticClass:"version-panel",on:{click:function(e){return e.stopPropagation(),t.handleOpenPopup("loraVersion_".concat(i))}}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:null==img?void 0:img.version_name,placement:"top"}},[n("div",{staticClass:"version-panel-text"},[t._v(t._s(null==img?void 0:img.version_name))])]),t._v(" "),n("div",{staticClass:"version-panel-icon el-icon-caret-bottom"}),t._v(" "),n("change-ver-new",{ref:"loraVersion_".concat(i),refInFor:!0,staticClass:"version-item",staticStyle:{opacity:"0 !important"},attrs:{from:"styleModal",item:img,base_models:[null==img?void 0:img.base_model]},on:{selectItem:function(e){return t.handleChangeLoraVersion(e,i)}}})],1),t._v(" "),t.isStudioMode?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("newGenerate131",{text:(null==img?void 0:img.base_model)||""}),placement:"top-start"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.checkStudioLoraType(img),expression:"checkStudioLoraType(img)"}],staticClass:"lora-type-not-match"},[n("span",{staticClass:"iconfont icon-warn"}),t._v(" "),n("span",{staticClass:"model-type-info"},[t._v(t._s((null==img?void 0:img.base_model)||""))])])]):t._e()],1),t._v(" "),n("div",{staticClass:"slider slider-item"},[n("p",{staticClass:"lora-name ellipsis",on:{click:function(e){return t.viewLora(i)}}},[t._v(t._s(img.name))]),t._v(" "),n("el-slider",{attrs:{value:img.weight,min:-1,max:2,step:.05,"show-input":"","show-input-controls":!1,"show-tooltip":!1},on:{input:function(e){return t.changeWeight(e,i)}}})],1),t._v(" "),n("i",{staticClass:"el-icon-delete delete-icon",on:{click:function(e){return t.deleteModel(i)}}})])}))],2)}),[],!1,null,"358cc60b",null);t.default=component.exports},852:function(e,t,n){"use strict";n.r(t);n(16),n(8);var o={name:"HandleCharacterRepair",components:{SliderItem:n(105).default},props:["value"],inject:["top"],data:function(){return{selectList:[{code:"",i18nKey:"none"},{code:"face",i18nKey:"repairType1"},{code:"hand",i18nKey:"repairType2"},{code:"body",i18nKey:"repairType3"}]}},methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));["ad_denoising_strength","prompt","negative_prompt"].includes(t)?n.ad_units[t]=e:n[t]=e,this.$emit("input",n)}}},r=(n(4104),n(0)),component=Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-character-repair handle-item"},[t("div",{staticClass:"item-head",on:{click:function(t){return e.changeConfig(!e.value.characterRepairZoom,"characterRepairZoom")}}},[t("label",[t("i",{staticClass:"iconfont icon-character-repair-icon1"}),e._v("\n      "+e._s(e.$t("characterRepair"))+"\n    ")]),e._v(" "),t("i",{staticClass:"el-icon-caret-bottom",class:{zoom:e.value.characterRepairZoom}})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value.characterRepairZoom,expression:"value.characterRepairZoom"}],staticClass:"item-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==e.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item select-item"},[t("label",[e._v(e._s(e.$t("repairType"))+"\n        "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t("characterRepairTips"),placement:"top-start"}},[t("span",{staticClass:"el-icon-warning custom-tips"})])],1),e._v(" "),t("el-select",{attrs:{value:e.value.ad_model,"popper-append-to-body":!1,"popper-class":"custom-select vae-custom-select"},on:{change:function(t){return e.changeConfig(t,"ad_model")}}},e._l(e.selectList,(function(n,i){return t("el-option",{key:"method_"+i,attrs:{label:e.$t(n.i18nKey),value:n.code}},[t("el-tooltip",{attrs:{content:e.$t(n.i18nKey),placement:"top"}},[t("span",[e._v(e._s(e.$t(n.i18nKey)))])])],1)})),1)],1),e._v(" "),t("slider-item",{directives:[{name:"show",rawName:"v-show",value:""!==e.value.ad_model,expression:"value.ad_model !== ''"}],attrs:{value:e.value.ad_units.ad_denoising_strength,min:0,max:.5,step:.05,label:e.$t("redrawingNoiseIntensity"),"show-tooltip":!1},on:{change:function(t){return e.changeConfig(t,"ad_denoising_strength")}}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.value.ad_model,expression:"value.ad_model !== ''"}],staticClass:"h-item input-item"},[t("label",[e._v(e._s(e.$t("Prompt")))]),e._v(" "),t("el-input",{staticClass:"custom-input",attrs:{value:e.value.ad_units.prompt,type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},on:{input:function(t){return e.changeConfig(t,"prompt")}}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.value.ad_model,expression:"value.ad_model !== ''"}],staticClass:"h-item input-item"},[t("label",[e._v(e._s(e.$t("NegativePrompts")))]),e._v(" "),t("el-input",{staticClass:"custom-input",attrs:{value:e.value.ad_units.negative_prompt,type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},on:{input:function(t){return e.changeConfig(t,"negative_prompt")}}})],1)],1)])}),[],!1,null,"ef6c7ce8",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},853:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(7);var o=n(14),r=n(2),l=(n(19),n(22),n(8),n(4),n(1));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"HandleHRepair",props:["value"],inject:["top"],data:function(){return{selectList:[{code:1,label:"1x"},{code:1.5,label:"1.5x"},{code:2,label:"2x"},{code:2.5,label:"2.5x"}]}},computed:d(d({},Object(l.c)("creation",["hr_upscaler"])),{},{isFastSelectActive:function(){return function(e){return e.code===this.value.hr_scale}},computedScaleSize:function(){var e=this.value.hr_scale||2;return"".concat(this.value.width*e,"x").concat(this.value.height*e)},renderList:function(){var e=(this.hr_upscaler||[]).map((function(e){return{label:e,code:e}}));return[{code:"",label:this.$t("none")}].concat(Object(o.a)(e))}}),methods:{changeConfig:function(e,t){var n=JSON.parse(JSON.stringify(this.value));n[t]=e,this.$emit("input",n)},applyStyleSize:function(e){var t=e.code;[t*this.value.width,t*this.value.height].some((function(e){return e&&e>2048}))&&(t=2);var n=JSON.parse(JSON.stringify(this.value));n.hr_scale=t,this.$emit("input",n)}}},m=(n(4108),n(0)),component=Object(m.a)(h,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"handle-h-repair handle-item"},[t("div",{staticClass:"item-head",on:{click:function(t){return e.changeConfig(!e.value.enable_hr,"enable_hr")}}},[t("label",[t("i",{staticClass:"iconfont icon-icon_h_d_repair"}),e._v(e._s(e.$t("ai_tools_1"))+" ")]),e._v(" "),t("i",{staticClass:"el-icon-caret-bottom",class:{zoom:e.value.enable_hr}})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value.enable_hr,expression:"value.enable_hr"}],staticClass:"item-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"expansion"!==e.top.menuIndex,expression:"top.menuIndex !== 'expansion'"}],staticClass:"h-item select-item"},[t("label",[e._v(e._s(e.$t("taskRepairMethod")))]),e._v(" "),t("el-select",{attrs:{value:e.value.hr_upscaler,"popper-append-to-body":!1,"popper-class":"custom-select vae-custom-select"},on:{change:function(t){return e.changeConfig(t,"hr_upscaler")}}},e._l(e.renderList,(function(n,i){return t("el-option",{key:"method_"+i,attrs:{label:n.label,value:n.code}},[t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:n.label,placement:"top-start"}},[t("span",[e._v(e._s(n.label))])])],1)})),1)],1)])])}),[],!1,null,"42370bf8",null);t.default=component.exports},869:function(e,t,n){"use strict";n.r(t);var o=n(14),r=n(2),l=n(3),c=(n(19),n(11),n(6),n(50),n(22),n(49),n(18),n(12),n(13),n(8),n(4),n(7),n(20),n(3284)),d=n(480),h=n(324),m=n(161),v=n(277);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={components:{draggable:n.n(v).a,NoteVitorItem:c.default},props:{currentParams:{type:Object,default:function(){}},saveParams:{type:Object,default:function(){}},selectActiveId:{type:String,default:""},source:{type:String,default:""}},data:function(){return{visible:!0,noteVitorList:[],hasMore:!0,loading:!1,activeId:this.selectActiveId}},mounted:function(){this.getNoteHistoryList(),this.$xyLogEvent({front_operation:"exposure",entity_name:"note-vitor-popover",entity_type:"note-vitor-popover"})},methods:{getNoteHistoryList:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(d.d)({limit:30});case 3:1e4===(n=t.sent).status.code&&(e.noteVitorList=n.data.items||[]),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},handleDrag:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(d.f)({id:t.noteVitorList[e.newIndex].id,index:e.newIndex});case 2:case"end":return n.stop()}}),n)})))()},handleClick:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.activeId=e.id;case 1:case"end":return n.stop()}}),n)})))()},handleEdit:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(d.e)({id:e.id});case 2:1e4===(o=n.sent).status.code&&(r=Object(m.a)({render:function(e){return e(h.default,{props:{isEdit:!0,params:o.data.item,source:t.source},on:{close:function(){r.close()},save:function(){t.getNoteHistoryList(),r.close()}}})}}));case 4:case"end":return n.stop()}}),n)})))()},handleDelete:function(e){var t=this;this.$confirm(this.$t("ConfirmDelete"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then(Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(d.b)({ids:[e.id]});case 2:1e4===n.sent.status.code&&(t.$message.success(t.$t("deleteSuccess")),o=t.noteVitorList.findIndex((function(t){return t.id===e.id})),t.noteVitorList.splice(o,1));case 4:case"end":return n.stop()}}),n)}))))},assembleParams:function(e){var t,n={banner:{url:e.model_cover},name:e.modelName,id:e.art_model_no,model_no:e.art_model_no,model_ver_no:e.art_model_ver_no,base_model_name:e.base_model_name,model_type:"Checkpoint"},r=e.embeddings.map((function(e){return{banner:e.banner,name:e.name,id:e.id,model_no:e.id,base_model_name:e.base_model,model_ver_no:e.model_ver_no,model_type:"TextualInversion"===e.type?"Embedding":"LoCon"===e.type?"LyCORIS":e.type}})),l=e.lora_models.map((function(e){return{banner:e.banner,name:e.name,id:e.id,model_no:e.id,base_model_name:e.base_model,model_ver_no:e.model_ver_no,model_type:"TextualInversion"===e.type?"Embedding":"LoCon"===e.type?"LyCORIS":e.type}})),c=e.imageToImageList.map((function(e){return{mode:"img2img",image:_({},e)}})),d=e.controlnet_units.map((function(e){return{mode:"ctr_net",image:{url:e.input_image},ctr_net_cond:e}})),h=e.ipList.map((function(e){return{mode:"ip_maintain",image:{url:e.image}}})),m=e.styleReferenceList.map((function(e){return{mode:"style_ref",image:{url:e.image}}}));return{title:(null==e?void 0:e.title)||"",cover:{url:(null==e||null===(t=e.cover)||void 0===t?void 0:t.url)||""},used_models:[n].concat(Object(o.a)(r),Object(o.a)(l)),meta:{cfg_scale:e.cfg_scale,clip_skip:e.clip_skip,width:e.width,height:e.height,negative_prompt:e.negative_prompt,prompt:e.prompt,sampler_name:e.sampler_name,steps:e.steps,vae:e.vae,use_image_conditions:[].concat(Object(o.a)(c),Object(o.a)(d),Object(o.a)(h),Object(o.a)(m))}}},saveCurrentParams:function(){var e=this,t=Object(m.a)({render:function(n){return n(h.default,{props:{params:e.assembleParams(e.currentParams),saveParams:e.saveParams,source:e.source},on:{close:function(){t.close()},save:function(){e.getNoteHistoryList(),t.close()}}})}})},handleApply:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.activeId){t.next=3;break}return e.$message.warning(e.$t("SelectNote")),t.abrupt("return");case 3:e.$emit("fill",{requestParams:{obj_id:e.activeId,source:8},NoteFill:!0},e.activeId);case 4:case"end":return t.stop()}}),t)})))()}}},y=(n(4294),n(0)),component=Object(y.a)(w,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"mask",attrs:{visible:e.visible,width:"56vw","close-on-click-modal":!1,"show-close":!1,"append-to-body":!0},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"history-container",attrs:{"data-group":"note-vitor-history"}},[t("div",{staticClass:"history-header"},[t("div",{staticClass:"history-header-title-box"},[t("div",{staticClass:"history-header-title"},[e._v(e._s(e.$t("NoteVitor")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1 history-header-close",on:{click:function(t){return e.$emit("close")}}})])]),e._v(" "),t("div",{staticClass:"history-body"},[e.noteVitorList.length>0?t("draggable",{staticClass:"history-list",attrs:{scroll:!1,"force-fallback":"false",animation:"300",delay:100,tag:"div"},on:{end:e.handleDrag},model:{value:e.noteVitorList,callback:function(t){e.noteVitorList=t},expression:"noteVitorList"}},e._l(e.noteVitorList,(function(n){return t("NoteVitorItem",{key:n.id,attrs:{item:n,"active-id":e.activeId},on:{"item-click":e.handleClick,"item-edit":e.handleEdit,"item-delete":e.handleDelete}})})),1):e._e(),e._v(" "),0!==e.noteVitorList.length||e.loading?e._e():t("div",{staticClass:"history-list-empty"},[t("img",{attrs:{src:n(1501),alt:""}}),e._v(" "),t("span",[e._v(e._s(e.$t("NoteEmpty")))])]),e._v(" "),e.loading?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"loading-box"}):e._e()],1),e._v(" "),t("div",{staticClass:"history-footer"},[t("div",{staticClass:"history-footer-btn",attrs:{"data-event":"note-vitor-save-btn","data-id":"note-vitor-save-current","data-info":JSON.stringify({modelId:e.currentParams.art_model_no,verId:e.currentParams.art_model_ver_no})},on:{click:e.saveCurrentParams}},[t("span",{staticClass:"btn-text"},[e._v(e._s(e.$t("saveCurrentParams")))])]),e._v(" "),t("div",{staticClass:"history-footer-btn history-footer-btn-save",class:{disabled:!e.activeId||0===e.noteVitorList.length},attrs:{"data-event":"note-vitor-apply-btn","data-id":"note-vitor-apply"},on:{click:e.handleApply}},[t("span",{staticClass:"btn-text"},[e._v(e._s(e.$t("Apply")))])])])])])}),[],!1,null,"39ac38d4",null);t.default=component.exports},889:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(24),n(1));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"SelectLevelDialog",components:{SelectLevel:n(3374).default},data:function(){return{isShowDialog:!1,popType:0,from:""}},computed:c(c({},Object(r.c)("payment",["paymentInfo"])),Object(r.e)("payment",["subThirdType"])),methods:c(c(c({},Object(r.b)("payment",["getSubUrlAndThirdType"])),Object(r.b)("user",["getAccountInfo"])),{},{show:function(e,t){var n=this;this.isShowDialog=!0,this.popType=Number(e),this.from=t,this.$nextTick((function(){n.$refs.selectLevelRef&&n.$refs.selectLevelRef.show(e,t)}))},handleInternalClose:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).showAwaitingOrder,t=void 0!==e&&e,n=this.$refs.selectLevelRef;if(n){var o=n.selectedLevel,data=n.selectedLevelItem;this.isShowDialog=!1,this.$emit("close",{level:o,data:data,showAwaitingOrder:t})}else this.isShowDialog=!1,this.$emit("close",{showAwaitingOrder:t})}})},h=d,m=(n(4522),n(0)),component=Object(m.a)(h,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"select-level-dialog",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.isShowDialog=t}}},[t("div",{staticClass:"dialog-container"},[t("SelectLevel",{ref:"selectLevelRef",attrs:{popType:e.popType,from:e.from},on:{close:e.handleInternalClose}})],1)])}),[],!1,null,"0b25fac8",null);t.default=component.exports}}]);