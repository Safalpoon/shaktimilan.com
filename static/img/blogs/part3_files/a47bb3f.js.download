(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{116:function(t,e,n){"use strict";n.r(e);var o=n(30),r=(n(19),n(185),n(243),n(4),n(40),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(41),n(11),n(12),n(13),n(3)),l=n(2),c=(n(20),n(6),n(32),n(50),n(16),n(22),n(31),n(49),n(18),n(24),n(8),n(43),n(21),n(77),n(7),n(141),n(142),n(109),n(39)),d=n(1),h=n(45),v=n(63),f=n(53),m=n(83),y=n(209),C=n(10),w=n(162),main=n(811),k=n.n(main),L=n(945),O=n(3225);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={name:"CmtComments",mixins:[h.a],props:{infos:{type:Object,default:function(){}},type:{type:Number,default:1},dotReportInfo:{type:Object,default:function(){return{view_domain:"",batch_id:"",action:"",obj_no:"",obj_type:1,negative_ids:[],category:"default"}}},naturalScroll:{type:Boolean,default:!1},inputPosition:{type:String,default:"bottom"},isReverseLoad:{type:Boolean,default:!1},isShowCommentCount:{type:Boolean,default:!0}},components:{CollectPopover:v.default,BaseAvatar:f.default,EmojiPicker:k.a,HyUploadMoald:m.default,ImagePreview:O.default,ViewImage:y.a},data:function(){return{formatNumberForeign:C.p,commListData:{obj_id:"",obj_type:1,page:1,sort:"like"},commList:[],commTotal:0,pubTxt:"",replyTxt:"",isReplyId:"",loading:!1,noMoreData:!1,pubLoading:!1,replyPubLoading:!1,repMorLoading:!1,likeLoading:!1,typeKey:"",selectedImageUrls:[],inEditMode:!1,inReplyEditMode:!1,replyMeta:{item:null,index:null,toUser:!1},showEmojiPanel:!1,emojiTable:L.emojis,currentTrigger:null,scrollHandler:null,throttledUpdatePosition:null}},computed:T(T(T({},Object(d.c)("user",["isLoggedIn"])),Object(d.e)("user",["userInfo","adminOff"])),{},{isAuthor:function(){var t=this;return function(e){var n;return e===(null===(n=t.infos.author)||void 0===n?void 0:n.id)}},canDelete:function(){var t=this;return function(e){var n;return 1===t.adminOff||e.user_info.user_id===(null===(n=t.userInfo)||void 0===n?void 0:n.id)}}}),watch:{commTotal:{handler:function(t){this.$emit("updateCountNum",t||0)},immediate:!0},"infos.id":{handler:function(t,e){console.log("wathc-infos.id",t,e),e&&t&&t!==e&&(this.commListData.obj_id=t,this.commListData.obj_type=this.type,this.getCommentList(!0))},immediate:!0},inEditMode:{handler:function(t){var e=this;t?this.$nextTick((function(){e.lockEmojiPicker()})):this.showEmojiPanel=!1}},showEmojiPanel:{handler:function(t){t?(this.initEmojiTable(),this.$refs.popoverEditorRef.$el.style.display="block"):this.$refs.popoverEditorRef.$el.style.display="none"}}},mounted:function(){var t=this;if(this.initData(),this.naturalScroll){var e=this.isReverseLoad?this.reverseLoadFn:this.checkLoadMoreAll;window.addEventListener("scroll",e)}else this.$refs.list&&this.$refs.list.addEventListener("scroll",this.checkLoadMore);this.getCommentList(!0),this.$EventBus.$on("update-comment-for-st-detail",(function(){console.log("st详情页触发更新评论组件的数据"),t.getCommentList(!0)}))},beforeDestroy:function(){if(this.$EventBus.$off("update-comment-for-st-detail"),this.naturalScroll){var t=this.isReverseLoad?this.reverseLoadFn:this.checkLoadMoreAll;window.removeEventListener("scroll",t)}else this.$refs.list&&this.$refs.list.removeEventListener("scroll",this.checkLoadMore);this.scrollHandler&&(window.removeEventListener("scroll",this.scrollHandler,!0),this.scrollHandler=null),this.throttledUpdatePosition&&(this.throttledUpdatePosition.cancel(),this.throttledUpdatePosition=null)},methods:{initData:function(){switch(this.type){case 1:this.typeKey="artwork";break;case 2:this.typeKey="model";break;case 4:this.typeKey="gallery";break;case 5:this.typeKey="lookbook";break;case 9:this.typeKey="character";break;case 11:this.typeKey="palette";break;case 13:this.typeKey="workflow";break;case 15:this.typeKey="ai_video";break;case 21:this.typeKey="ai_novel"}this.commListData.obj_id=this.infos.id,this.commListData.obj_type=this.type},clickTransBtn:function(t){null!=t&&t.showTranslation?this.$set(t,"showTranslation",!1):(this.$logEvent("log_actions",{operation:"view_translation",behavior_info:this.type,behavior_info_sub:this.infos.id}),null!=t&&t.translationTxt?this.$set(t,"showTranslation",!0):this.translateContent(t))},translateContent:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=t.content,r=localStorage.getItem("translate_language")||e.$i18n.locale,r=(null==(l={zhCN:"zh-cn",zhTW:"zh-tw"})?void 0:l[r])||r,e.$set(t,"isLoading",!0),n.next=8,Object(w.a)(o,{to:r});case 8:c=n.sent,text=c.text,e.$set(t,"isLoading",!1),text&&(e.$set(t,"translationTxt",text),e.$set(t,"showTranslation",!0)),n.next=20;break;case 14:throw n.prev=14,n.t0=n.catch(0),e.$set(t,"isLoading",!1),localStorage.removeItem("translate_".concat(e.sessionId)),console.error("谷歌翻译报错",n.t0),new n.t0("谷歌翻译报错",n.t0);case 20:case"end":return n.stop()}}),n,null,[[0,14]])})))()},handleMark:function(){this.isLoggedIn?this.setCollectData(this.infos).includes("collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.infos,this.typeKey)):(console.log("收藏"),this.$refs.collectPopover.visible=!0):this.$EventBus.$emit("openLoginDialog")},setTiem:function(t){var e=t?new Date(t):new Date,n=new Date;if(e.toDateString()===n.toDateString())return"".concat(this.$t("today")," ").concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0"));var o=new Date;return o.setDate(n.getDate()-1),e.toDateString()===o.toDateString()?"".concat(this.$t("yesterday")," ").concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0")):e.getFullYear()===n.getFullYear()?"".concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0")):"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0"))},onLike:function(t,e,n){var o,r=this;if(this.isLoggedIn){if(!this.likeLoading){this.likeLoading=!0;var l=1;t.is_like&&(l=0),Object(c.e)({comment_id:t.id,obj_id:this.infos.id,obj_type:this.type,type:l}).then((function(o){1e4==o.status.code&&(n||0==n?(r.commList[e].children[n].is_like=!t.is_like,0==l?r.commList[e].children[n].like_count>0&&r.commList[e].children[n].like_count--:r.commList[e].children[n].like_count++):(r.commList[e].is_like=!t.is_like,0==l?r.commList[e].like_count>0&&r.commList[e].like_count--:r.commList[e].like_count++))})).finally((function(e){r.likeLoading=!1,r.$route.path.includes("/event-center")&&r.$logEvent("log_actions",{operation:1===l?"like":"cancel_like",behavior_info:t.id,obj_type:r.type})}))}}else null!==(o=this.$route)&&void 0!==o&&null!==(o=o.name)&&void 0!==o&&o.includes("aiChat")?this.$EventBus.$emit("openLoginDialog",{callBack:function(){return r.$emit("newChat")}}):this.$EventBus.$emit("openLoginDialog")},openPub:function(){this.$refs.commTitle&&(this.$refs.commTitle.scrollIntoView({behavior:"smooth",block:"center"}),this.$refs.pubInput.focus())},openReply:function(t){var e=this;this.pubTxt="",this.replyTxt="",this.selectedImageUrls=[],this.isReplyId===t?this.isReplyId="":this.isReplyId=t,this.$nextTick((function(){e.$refs.replyInput[0]&&(e.$refs.replyInput[0].scrollIntoView({behavior:"smooth",block:"center"}),e.$refs.replyInput[0].focus())})),this.showEmojiPanel=!1},onkeyRep:function(t,e,n,o){13==o.keyCode&&this.replyComm(t,e,n)},replyComm:function(t,e,n){var o,r=this;if(this.isLoggedIn){if((this.replyTxt||this.selectedImageUrls.length)&&!this.replyPubLoading){this.replyPubLoading=!0;var l,d={content:this.replyTxt,obj_id:this.infos.id,obj_type:this.type,root_id:n?t.root_id:t.id,parent_id:t.id,pictures:this.selectedImageUrls.map((function(t){return{url:new URL(t).pathname}}))};if(9===this.type)d.author_id=(null==this||null===(l=this.infos)||void 0===l||null===(l=l.author)||void 0===l?void 0:l.id)||"";Object(c.d)(d).then((function(o){if(1e4===o.status.code){var l,c,d={user_info:{avatar:r.userInfo.head,avatar_frame:null===(l=r.userInfo)||void 0===l?void 0:l.avatar_frame,user_id:r.userInfo.id,username:r.userInfo.name,is_author:r.userInfo.id==(null===(c=r.infos)||void 0===c||null===(c=c.author)||void 0===c?void 0:c.id)?1:0},like_count:0,replies_count:0,content:r.replyTxt,id:o.data.comment_id,root_id:n?t.root_id:t.id,pictures:r.selectedImageUrls.map((function(t){return{url:t}}))};n&&(d.target=t.user_info),[null,"",void 0].includes(r.commList[e].children)&&(r.commList[e].children=[]),r.commList[e].children.unshift(d),r.replyTxt="",r.selectedImageUrls=[],r.isReplyId="",r.commTotal++;r.$logEvent("log_actions",{operation:"comment_image",behavior_info:["作品","模型","作品集","视频"][r.type-1]}),r.$emit("onCommentEnd",T(T({},o.data),{},{commTotal:r.commTotal}))}else 40007===o.status.code?r.$message.error(r.$t("sensitive_works_comment_prompt")):10628===o.status.code?r.$message({message:r.$t("comments_exterlinks_notion"),duration:7e3,type:"error"}):r.$message.error(r.$t("text_00256"))})).catch((function(){r.$message.error(r.$t("text_00256"))})).finally((function(t){r.replyPubLoading=!1,r.inEditMode=!1}))}}else null!==(o=this.$route)&&void 0!==o&&null!==(o=o.name)&&void 0!==o&&o.includes("aiChat")?this.$EventBus.$emit("openLoginDialog",{callBack:function(){return r.$emit("newChat")}}):this.$EventBus.$emit("openLoginDialog")},onkeyPub:function(t){13===t.keyCode&&this.onPub()},onPub:function(){var t,e=this;if(this.isLoggedIn){if((this.pubTxt||this.selectedImageUrls.length)&&!this.pubLoading){this.pubLoading=!0;var n,o={content:this.pubTxt,obj_id:this.infos.id,obj_type:this.type,pictures:this.selectedImageUrls.map((function(t){return{url:new URL(t).pathname}}))};if(9===this.type)o.author_id=(null==this||null===(n=this.infos)||void 0===n||null===(n=n.author)||void 0===n?void 0:n.id)||"";Object(c.d)(o).then((function(t){if(1e4===t.status.code){var n,o,r={user_info:{avatar:e.userInfo.head,avatar_frame:null===(n=e.userInfo)||void 0===n?void 0:n.avatar_frame,user_id:e.userInfo.id,username:e.userInfo.name,is_author:e.userInfo.id==(null===(o=e.infos)||void 0===o||null===(o=o.author)||void 0===o?void 0:o.id)?1:0},like_count:0,replies_count:0,children:[],content:e.pubTxt,id:t.data.comment_id,pictures:e.selectedImageUrls.map((function(t){return{url:t}}))};e.commList.unshift(r),e.commTotal++,e.pubTxt="",e.selectedImageUrls=[];e.$logEvent("log_actions",{operation:"comment_image",behavior_info:["作品","模型","作品集","视频"][e.type-1]}),e.$emit("onCommentEnd",T(T({},t.data),{},{commTotal:e.commTotal}))}else 40007===t.status.code?e.$message.error(e.$t("sensitive_works_comment_prompt")):10628===t.status.code?e.$message({message:e.$t("comments_exterlinks_notion"),duration:7e3,type:"error"}):e.$message.error(e.$t("text_00256"))})).catch((function(){e.$message.error(e.$t("text_00256"))})).finally((function(t){e.pubLoading=!1,e.inEditMode=!1}))}}else null!==(t=this.$route)&&void 0!==t&&null!==(t=t.name)&&void 0!==t&&t.includes("aiChat")?this.$EventBus.$emit("openLoginDialog",{callBack:function(){return e.$emit("newChat")}}):this.$EventBus.$emit("openLoginDialog")},updateEmojiPanelPosition:function(){if(this.showEmojiPanel&&this.currentTrigger){var t=this.currentTrigger.getBoundingClientRect(),e=this.$refs.popoverEditorRef.$el;e.style.top="".concat(t.top-436-16,"px"),e.style.left="".concat(t.left-306,"px")}},onOpenEmojiPanel:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{item:null,index:null,toUser:!1};this.$logEvent("log_actions",{operation:"click_emoji",behavior_info:"on_detail_page",obj_type:this.type});var o=event.currentTarget;this.inEditMode=!0,this.inReplyEditMode=e,this.replyMeta=n,this.$nextTick((function(){if(t.showEmojiPanel=!t.showEmojiPanel,t.showEmojiPanel){t.currentTrigger=o;var e=t.$refs.popoverEditorRef.$el;e.style.position="fixed",e.style.zIndex="10",t.updateEmojiPanelPosition(),t.throttledUpdatePosition||(t.throttledUpdatePosition=_.throttle(t.updateEmojiPanelPosition,10)),t.scrollHandler=t.throttledUpdatePosition,window.addEventListener("scroll",t.scrollHandler,!0),t.$refs.emojiPicker.display.visible=!0}else{var n,r;if(t.inReplyEditMode)null===(n=t.$refs.replyInput)||void 0===n||null===(n=n[0])||void 0===n||n.focus();else null===(r=t.$refs.pubInput)||void 0===r||r.focus();t.scrollHandler&&(window.removeEventListener("scroll",t.scrollHandler,!0),t.scrollHandler=null),t.currentTrigger=null}}))},onOpenImagePanel:function(){var t,e,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{item:null,index:null,toUser:!1};(this.$logEvent("log_actions",{operation:"click_upload_image",behavior_info:"on_detail_page",obj_type:this.type}),this.inEditMode=!0,this.inReplyEditMode=o,this.replyMeta=r,this.inReplyEditMode)?null===(t=this.$refs.replyInput)||void 0===t||null===(t=t[0])||void 0===t||t.focus():null===(e=this.$refs.pubInput)||void 0===e||e.focus();this.$nextTick((function(){n.$refs.hyUploadModal.openModal()}))},handleConfirmImageSelect:function(t){var e=this,n=Object(o.a)(t,1)[0];this.selectedImageUrls=[n.url],this.$nextTick((function(){e.updateEmojiPanelPosition()}))},updateRecentEmojis:function(t){var e=Object.entries(L.emojis.CmtCommentsEmojiLook).find((function(e){var n=Object(o.a)(e,2);n[0];return n[1]===t}))[0],n=JSON.parse(localStorage.getItem("recent_emojis")||"[]");Array.isArray(n)||(n=Object.entries(n).map((function(t){var e=Object(o.a)(t,2);return{key:e[0],value:e[1]}}))),(n=n.filter((function(e){return e.value!==t}))).unshift({key:e,value:t}),n.length>10&&(n=n.slice(0,10)),localStorage.setItem("recent_emojis",JSON.stringify(n))},insert:function(t){if(this.updateRecentEmojis(t),this.inReplyEditMode){var e=this.$refs.replyInput[0],n=e.selectionStart,o=e.selectionEnd;this.replyTxt=this.replyTxt.substring(0,n)+t+this.replyTxt.substring(o),this.$nextTick((function(){var o=n+t.length;e.setSelectionRange(o,o)}))}else{var r=this.$refs.pubInput,l=r.selectionStart,c=r.selectionEnd;this.pubTxt=this.pubTxt.substring(0,l)+t+this.pubTxt.substring(c),this.$nextTick((function(){var e=l+t.length;r.setSelectionRange(e,e)}))}},lockEmojiPicker:function(){this.$refs.emojiPicker.hide=function(){},document.removeEventListener("keyup",this.$refs.emojiPicker.escape),this.$refs.emojiPicker.display.visible=!0},initEmojiTable:function(){var t=JSON.parse(localStorage.getItem("recent_emojis")||"[]"),e=new Map;t.forEach((function(t){e.set(t.key,t.value)})),this.emojiTable=T({CmtCommentsRecentUse:e},Object.entries(L.emojis).reduce((function(t,e){var n=Object(o.a)(e,2),r=n[0],l=n[1];return t[r]=new Map(Object.entries(l)),t}),{})),this.$nextTick((function(){var t=document.querySelector(".editor-emoji-panel-section");t&&(t.scrollTop=0)}))},goToPersonal:function(t){var e,n=t.user_info.user_id,o=null===(e=this.userInfo)||void 0===e?void 0:e.id,path="/user/"+encodeURIComponent(n);o==n&&(path="/personal"),window.open(this.localePath(path),"_blank")},checkLoadMore:function(){var t=this.$refs.list,e=t.scrollTop,n=t.scrollHeight;e+t.clientHeight>=n-600&&this.getCommentList()},checkLoadMoreAll:function(){(window.pageYOffset||document.documentElement.scrollTop)+window.innerHeight>=document.documentElement.scrollHeight&&this.getCommentList()},reverseLoadFn:function(){var t=document.querySelector("#reverseLoadDiv"),e=t&&t.getBoundingClientRect(),n=window.innerHeight;t&&e.top<n&&this.getCommentList()},onRepMor:function(t,e){var n=this;console.log(t),this.repMorLoading||(this.repMorLoading=!0,Object(c.f)({obj_id:this.infos.id,obj_type:this.type,root_id:t.id,page:t.replyPage,sort:"like"}).then((function(o){1e4==o.status.code&&(1==t.replyPage?n.commList[e].children=o.data.items||[]:n.commList[e].children=n.commList[e].children.concat(o.data.items||[]),n.commList[e].replyPage++)})).finally((function(t){n.repMorLoading=!1})))},getCommentList:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n&&(this.noMoreData=!1,this.commListData.page=1),this.loading||this.noMoreData||null===(t=this.commListData)||void 0===t||!t.obj_id||(this.loading=!0,Object(c.f)(this.commListData).then((function(t){1e4==t.status.code&&(t.data.items.forEach((function(t){t.replies_count>1&&e.$set(t,"replyPage",1)})),n||1===e.commListData.page?e.commList=t.data.items||[]:e.commList=e.commList.concat(t.data.items||[]),e.commTotal=t.data.total,e.commListData.page++,t.data.items&&0!=t.data.items.length&&0!=t.data.has_more||(e.noMoreData=!0))})).finally((function(t){e.loading=!1})))},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("deleteComment"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){n.deleteCommentFun(t,e)})).catch((function(){}))},deleteCommentFun:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,l,d,h,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(c.h)({id:t.id});case 3:1e4===o.sent.status.code&&(e?(r=n.commList.findIndex((function(i){return i.id===e.id})))>-1&&(l=n.commList[r].children.findIndex((function(i){return i.id===t.id})))>-1&&(n.commList[r].children.splice(l,1),n.commList[r].replies_count=Math.max(0,n.commList[r].replies_count-1),n.commTotal=Math.max(0,n.commTotal-1)):(d=n.commList.findIndex((function(i){return i.id===t.id})))>-1&&(v=(null===(h=n.commList[d].children)||void 0===h?void 0:h.length)||0,n.commList.splice(d,1),n.commTotal=Math.max(0,n.commTotal-1-v)),n.$message.success(n.$t("deleteSuccess"))),o.next=10;break;case 7:o.prev=7,o.t0=o.catch(0),console.error("删除评论失败:",o.t0);case 10:case"end":return o.stop()}}),o,null,[[0,7]])})))()},viewImage:function(t,e){this.$refs.viewImage.show(t,e)}}},P=x,I=(n(4037),n(4038),n(0)),component=Object(I.a)(P,(function(){var t,e,n,r,l,c=this,d=c._self._c;return d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.loading,expression:"loading"}],staticClass:"cmt-comments",class:c.naturalScroll&&"natural-view"},["top"===c.inputPosition?d("div",{staticClass:"input-box-container"},[d("div",{staticClass:"inputBox"},[d("input",{directives:[{name:"model",rawName:"v-model",value:c.pubTxt,expression:"pubTxt"}],ref:"pubInput",attrs:{type:"text",maxlength:"300",placeholder:c.$t("saySom")},domProps:{value:c.pubTxt},on:{focus:function(t){c.isReplyId=""},keyup:c.onkeyPub,click:function(t){c.showEmojiPanel=!1},input:function(t){t.target.composing||(c.pubTxt=t.target.value)}}}),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenEmojiPanel(!1)}}},[d("Icon",{directives:[{name:"show",rawName:"v-show",value:!c.showEmojiPanel,expression:"!showEmojiPanel"}],attrs:{name:"emoji",size:"22",color:"#646466"}}),c._v(" "),d("Icon",{directives:[{name:"show",rawName:"v-show",value:c.showEmojiPanel,expression:"showEmojiPanel"}],attrs:{name:"jianpan",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenImagePanel(!1)}}},[d("Icon",{attrs:{name:"picture",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.pubLoading,expression:"pubLoading"}],staticClass:"icon-btn",on:{click:c.onPub}},[d("Icon",{attrs:{name:"Comment_send",size:"22",color:"#646466"}})],1)]),c._v(" "),d("ImagePreview",{directives:[{name:"show",rawName:"v-show",value:!c.inReplyEditMode&&c.selectedImageUrls.length>0,expression:"!inReplyEditMode && selectedImageUrls.length > 0"}],on:{"image-urls-change":function(t){c.$nextTick((function(){return c.updateEmojiPanelPosition()}))}},model:{value:c.selectedImageUrls,callback:function(t){c.selectedImageUrls=t},expression:"selectedImageUrls"}})],1):c._e(),c._v(" "),d("div",{ref:"list",staticClass:"commMain"},[c._t("cmtInner"),c._v(" "),21===c.type?[d("div",{staticClass:"action-box"},[d("div",{staticClass:"commFunBar"},[d("div",{staticClass:"funBarBnt"},[d("div",{staticClass:"commFunNum"},[d("i",{staticClass:"iconfont icon-work-show"}),c._v(" "),d("span",[c._v(c._s(c.formatNumberForeign(null===(t=c.infos.stat)||void 0===t?void 0:t.num_of_view)))])]),c._v(" "),d("div",{staticClass:"commFunNum",on:{click:c.openPub}},[d("i",{staticClass:"el-icon-chat-dot-round"}),c._v(" "),d("span",[c._v(c._s(c.commTotal))])]),c._v(" "),d("div",{on:{click:function(t){return t.preventDefault(),c.handleMark.apply(null,arguments)}}},[d("client-only",[d("CollectPopover",{ref:"collectPopover",attrs:{triggerMode:"click",hideBtn:!0,type:c.typeKey,folder:c.infos,dotReportInfo:c.dotReportInfo}},[d("div",{staticClass:"commFunNum"},[d("i",{staticClass:"iconfont",class:c.setCollectData(c.infos)}),c._v(" "),d("span",[c._v(c._s(c.formatNumberForeign(null===(e=c.infos.stat)||void 0===e?void 0:e.num_of_collection)))])])])],1)],1)]),c._v(" "),d("div",{staticClass:"commFunBarRight flex"},[c._t("cmtMore")],2)])]),c._v(" "),c._t("custom-inner")]:c._e(),c._v(" "),d("div",{staticClass:"commCnt"},[c.isShowCommentCount?d("div",{ref:"commTitle",staticClass:"commNum"},[c._v("\n        "+c._s(c.$t("commNumTotal",{number:c.commTotal}))+"\n      ")]):c._e(),c._v(" "),c.commList.length?d("div",{staticClass:"list"},c._l(c.commList,(function(t,e){var n;return d("div",{key:e,staticClass:"commItem"},[d("div",{staticClass:"avatar-wrapper flex items-center"},[d("div",{staticClass:"avatar",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),c.goToPersonal(t)}}},[d("BaseAvatar",{attrs:{"user-data":null==t?void 0:t.user_info,name:t.user_info.username||t.user_info.user_id,size:28,theme:"dark"}}),c._v(" "),d("div",{staticClass:"avatarName"},[d("span",[c._v(c._s(t.user_info.username||t.user_info.user_id))]),c._v(" "),c.isAuthor(t.user_info.user_id)?d("div",{staticClass:"isAuthor"},[c._v("\n                  "+c._s(c.$t("author"))+"\n                ")]):c._e()])],1),c._v(" "),c.canDelete(t)?d("el-popover",{attrs:{trigger:"hover","popper-class":"cmt-comments-more-popover",placement:"bottom-end"}},[d("div",{staticClass:"btn-item",on:{click:function(e){return c.handleDelete(t)}}},[d("Icon",{attrs:{name:"shanchu5",size:"16",color:"#cfd0d2"}}),c._v("\n                "+c._s(c.$t("Delete"))+"\n              ")],1),c._v(" "),d("div",{staticClass:"more-dots",attrs:{slot:"reference"},slot:"reference"},[d("i",{staticClass:"el-icon-more"})])]):c._e()],1),c._v(" "),d("div",{staticClass:"commListCnt",attrs:{"data-id":null==t?void 0:t.id}},[d("div",{staticClass:"commTxt"},[c._v(c._s(null!=t&&t.showTranslation?(null==t?void 0:t.translationTxt)||"":t.content))]),c._v(" "),null!==(n=t.pictures)&&void 0!==n&&n.length?d("div",{staticClass:"comm-images"},c._l(t.pictures,(function(image,t){return d("div",{key:t,staticClass:"comm-image"},[image.nsfw?d("span",[d("Icon",{attrs:{name:"warning",size:"14",color:"#6f6f6f"}}),c._v("\n                  "+c._s(c.$t("CmtCommentsImageViolationNotice"))+"\n                ")],1):d("img",{attrs:{src:image.url,alt:""},on:{click:function(t){return c.viewImage(image.url,t.target)}}})])})),0):c._e(),c._v(" "),d("div",{staticClass:"comm-operation"},[d("div",{staticClass:"date"},[c._v(c._s(c.setTiem(t.create_at)))]),c._v(" "),d("div",{staticClass:"translate",on:{click:function(e){return c.clickTransBtn(t)}}},[d("span",{directives:[{name:"loading",rawName:"v-loading",value:null==t?void 0:t.isLoading,expression:"item?.isLoading"}]},[c._v("\n                  "+c._s(c.$t(null!=t&&t.showTranslation?"ViewOriginal":"ViewTranslation"))+"\n                ")])])]),c._v(" "),d("div",{staticClass:"txt-fun-bar"},[d("div",{staticClass:"fun-num",attrs:{"data-event":"character-comment-like","data-id":t.id,"data-info":JSON.stringify({isLiked:!(null!=t&&t.is_like)})},on:{click:function(n){return c.onLike(t,e)}}},[d("i",{staticClass:"iconfont",class:[t.is_like?"icon-like_selected":"icon-like"]}),c._v(" "),t.like_count>0?d("span",[c._v(c._s(c.formatNumberForeign(t.like_count)))]):d("span",[c._v(c._s(c.$t("CmtCommentsLike")))])]),c._v(" "),d("div",{staticClass:"fun-num",attrs:{"data-event":"character-comment-reply","data-id":t.id},on:{click:function(e){return c.openReply(t.id)}}},[d("i",{staticClass:"el-icon-chat-dot-round"}),c._v(" "),t.replies_count>0?d("span",[c._v(c._s(c.formatNumberForeign(t.replies_count)))]):d("span",[c._v(c._s(c.$t("CmtCommentsReply")))])])]),c._v(" "),d("div",{staticClass:"input-box-container"},[c.isReplyId==t.id?d("div",{staticClass:"inputBox"},[d("input",{directives:[{name:"model",rawName:"v-model",value:c.replyTxt,expression:"replyTxt"}],ref:"replyInput",refInFor:!0,attrs:{type:"text",maxlength:"300",placeholder:"".concat(c.$t("replyTo")," @").concat(t.user_info.username||t.user_info.user_id)},domProps:{value:c.replyTxt},on:{keyup:function(n){return c.onkeyRep(t,e,!1,n)},click:function(t){c.showEmojiPanel=!1},input:function(t){t.target.composing||(c.replyTxt=t.target.value)}}}),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(n){return c.onOpenEmojiPanel(!0,{item:t,index:e,toUser:!1})}}},[d("Icon",{directives:[{name:"show",rawName:"v-show",value:!c.showEmojiPanel,expression:"!showEmojiPanel"}],attrs:{name:"emoji",size:"22",color:"#646466"}}),c._v(" "),d("Icon",{directives:[{name:"show",rawName:"v-show",value:c.showEmojiPanel,expression:"showEmojiPanel"}],attrs:{name:"jianpan",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(n){return c.onOpenImagePanel(!0,{item:t,index:e,toUser:!1})}}},[d("Icon",{attrs:{name:"picture",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.replyPubLoading,expression:"replyPubLoading"}],staticClass:"icon-btn",on:{click:function(n){return c.replyComm(t,e,!1)}}},[d("Icon",{attrs:{name:"Comment_send",size:"22",color:"#646466"}})],1)]):c._e(),c._v(" "),d("ImagePreview",{directives:[{name:"show",rawName:"v-show",value:c.inReplyEditMode&&c.isReplyId===t.id&&c.selectedImageUrls.length>0,expression:"inReplyEditMode && isReplyId === item.id && selectedImageUrls.length > 0"}],on:{"image-urls-change":function(t){c.$nextTick((function(){return c.updateEmojiPanelPosition()}))}},model:{value:c.selectedImageUrls,callback:function(t){c.selectedImageUrls=t},expression:"selectedImageUrls"}})],1),c._v(" "),c._l(t.children,(function(n,o){var r,l,h;return d("div",{key:o,staticClass:"replies"},[d("div",{staticClass:"avatar-wrapper flex items-center"},[d("div",{staticClass:"avatar",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),c.goToPersonal(n)}}},[d("BaseAvatar",{attrs:{"user-data":null==n?void 0:n.user_info,name:n.user_info.username||n.user_info.user_id,size:24,theme:"dark"}}),c._v(" "),d("div",{staticClass:"avatarName"},[d("span",[c._v(c._s(n.user_info.username||n.user_info.user_id))]),c._v(" "),c.isAuthor(n.user_info.user_id)?d("div",{staticClass:"isAuthor"},[c._v("\n                      "+c._s(c.$t("author"))+"\n                    ")]):c._e()])],1),c._v(" "),c.canDelete(n)?d("el-popover",{attrs:{trigger:"hover","popper-class":"cmt-comments-more-popover",placement:"bottom-end"}},[d("div",{staticClass:"btn-item",on:{click:function(e){return c.handleDelete(n,t)}}},[d("Icon",{attrs:{name:"shanchu5",size:"16",color:"#cfd0d2"}}),c._v("\n                    "+c._s(c.$t("Delete"))+"\n                  ")],1),c._v(" "),d("div",{staticClass:"more-dots",attrs:{slot:"reference"},slot:"reference"},[d("i",{staticClass:"el-icon-more"})])]):c._e()],1),c._v(" "),d("div",{staticClass:"commListCnt"},[null!==(r=n.target)&&void 0!==r&&r.username?d("div",{staticClass:"commTxt"},[c._v("\n                  "+c._s(c.$t("reply"))+" "),d("span",[c._v(c._s(null===(l=n.target)||void 0===l?void 0:l.username)+":")]),c._v("\n                  "+c._s(null!=n&&n.showTranslation?(null==n?void 0:n.translationTxt)||"":n.content)+"\n                ")]):d("div",{staticClass:"commTxt"},[c._v(c._s(null!=n&&n.showTranslation?(null==n?void 0:n.translationTxt)||"":n.content))]),c._v(" "),null!==(h=n.pictures)&&void 0!==h&&h.length?d("div",{staticClass:"comm-images"},c._l(n.pictures,(function(image,t){return d("div",{key:t,staticClass:"comm-image"},[image.nsfw?d("span",[d("Icon",{attrs:{name:"warning",size:"14",color:"#6f6f6f"}}),c._v("\n                      "+c._s(c.$t("CmtCommentsImageViolationNotice"))+"\n                    ")],1):d("img",{attrs:{src:image.url,alt:""},on:{click:function(t){return c.viewImage(image.url,t.target)}}})])})),0):c._e(),c._v(" "),d("div",{staticClass:"comm-operation"},[d("div",{staticClass:"date"},[c._v(c._s(c.setTiem(n.create_at)))]),c._v(" "),d("div",{staticClass:"translate",on:{click:function(t){return c.clickTransBtn(n)}}},[d("span",{directives:[{name:"loading",rawName:"v-loading",value:null==n?void 0:n.isLoading,expression:"ele?.isLoading"}]},[c._v("\n                      "+c._s(c.$t(null!=n&&n.showTranslation?"ViewOriginal":"ViewTranslation"))+"\n                    ")])])]),c._v(" "),d("div",{staticClass:"txt-fun-bar"},[d("div",{staticClass:"fun-num",on:{click:function(t){return c.onLike(n,e,o)}}},[d("i",{staticClass:"iconfont",class:[n.is_like?"icon-like_selected":"icon-like"]}),c._v(" "),n.like_count>0?d("span",[c._v(c._s(c.formatNumberForeign(n.like_count)))]):d("span",[c._v(c._s(c.$t("CmtCommentsLike")))])]),c._v(" "),d("div",{staticClass:"fun-num",on:{click:function(t){return c.openReply(n.id)}}},[d("i",{staticClass:"el-icon-chat-dot-round"}),c._v(" "),d("span",[c._v(c._s(c.$t("CmtCommentsReply")))])])]),c._v(" "),d("div",{staticClass:"input-box-container"},[c.isReplyId==n.id?d("div",{staticClass:"inputBox"},[d("input",{directives:[{name:"model",rawName:"v-model",value:c.replyTxt,expression:"replyTxt"}],ref:"replyInput",refInFor:!0,attrs:{type:"text",maxlength:"300",placeholder:"".concat(c.$t("reply")," @").concat(n.user_info.username||n.user_info.user_id)},domProps:{value:c.replyTxt},on:{keyup:function(t){return c.onkeyRep(n,e,!0,t)},click:function(t){c.showEmojiPanel=!1},input:function(t){t.target.composing||(c.replyTxt=t.target.value)}}}),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenEmojiPanel(!0,{item:n,index:e,toUser:!0})}}},[d("Icon",{directives:[{name:"show",rawName:"v-show",value:!c.showEmojiPanel,expression:"!showEmojiPanel"}],attrs:{name:"emoji",size:"22",color:"#646466"}}),c._v(" "),d("Icon",{directives:[{name:"show",rawName:"v-show",value:c.showEmojiPanel,expression:"showEmojiPanel"}],attrs:{name:"jianpan",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenImagePanel(!0,{item:n,index:e,toUser:!0})}}},[d("Icon",{attrs:{name:"picture",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.replyPubLoading,expression:"replyPubLoading"}],staticClass:"icon-btn",on:{click:function(t){return c.replyComm(n,e,!0)}}},[d("Icon",{attrs:{name:"Comment_send",size:"22",color:"#646466"}})],1)]):c._e(),c._v(" "),d("ImagePreview",{directives:[{name:"show",rawName:"v-show",value:c.inReplyEditMode&&c.isReplyId===n.id&&c.selectedImageUrls.length>0,expression:"inReplyEditMode && isReplyId === ele.id && selectedImageUrls.length > 0"}],on:{"image-urls-change":function(t){c.$nextTick((function(){return c.updateEmojiPanelPosition()}))}},model:{value:c.selectedImageUrls,callback:function(t){c.selectedImageUrls=t},expression:"selectedImageUrls"}})],1)])])})),c._v(" "),t.replies_count>1&&t.children.length<t.replies_count?d("div",{staticClass:"morRep",on:{click:function(n){return c.onRepMor(t,e)}}},[c._v("\n              "+c._s(c.$t("CmtCommentsUnfoldNumReply",{number:t.replies_count-t.children.length}))+"\n            ")]):c._e()],2)])})),0):c._t("empty")],2)],2),c._v(" "),"bottom"===c.inputPosition?d("div",{staticClass:"commInput",style:c.infos.style||{}},[21!==c.type?d("div",{staticClass:"commFunBar"},[d("div",{staticClass:"funBarBnt"},[d("div",{directives:[{name:"show",rawName:"v-show",value:"model"!==c.typeKey,expression:"typeKey !== 'model'"}],staticClass:"commFunNum",attrs:{"data-event":"waterfall-like","data-id":c.infos.id,"data-info":JSON.stringify({isLiked:"icon-like"===c.setlikeData(c.infos)})},on:{click:function(t){return c.setLike(c.infos,c.typeKey)}}},[d("i",{staticClass:"iconfont",class:c.setlikeData(c.infos)}),c._v(" "),d("span",[c._v(c._s(c.formatNumberForeign(4!=c.type?null===(n=c.infos.stat)||void 0===n?void 0:n.num_of_like:c.infos.num_of_praise)))])]),c._v(" "),d("div",{on:{click:function(t){return t.preventDefault(),c.handleMark.apply(null,arguments)}}},[d("client-only",[d("CollectPopover",{ref:"collectPopover",attrs:{triggerMode:"click",hideBtn:!0,type:c.typeKey,folder:c.infos,dotReportInfo:c.dotReportInfo}},[d("div",{staticClass:"commFunNum",attrs:{"data-event":"icon-collect-gpt"===c.setCollectData(c.infos)?"collect":"cancelCollect","data-id":c.infos.id}},[d("i",{staticClass:"iconfont",class:c.setCollectData(c.infos)}),c._v(" "),d("span",[c._v(c._s(c.formatNumberForeign(null===(r=c.infos.stat)||void 0===r?void 0:r.num_of_collection)))])])])],1)],1),c._v(" "),d("div",{staticClass:"commFunNum"},[d("i",{staticClass:"iconfont icon-work-show"}),c._v(" "),d("span",[c._v(c._s(c.formatNumberForeign(null===(l=c.infos.stat)||void 0===l?void 0:l.num_of_view)))])]),c._v(" "),d("div",{staticClass:"commFunNum",on:{click:c.openPub}},[d("i",{staticClass:"el-icon-chat-dot-round"}),c._v(" "),d("span",[c._v(c._s(c.commTotal))])])]),c._v(" "),d("div",{staticClass:"commFunBarRight flex"},[c._t("cmtMore")],2)]):c._e(),c._v(" "),d("div",{staticClass:"input-box-container"},[d("div",{staticClass:"inputBox"},[d("input",{directives:[{name:"model",rawName:"v-model",value:c.pubTxt,expression:"pubTxt"}],ref:"pubInput",attrs:{type:"text",maxlength:"300",placeholder:c.$t("saySom")},domProps:{value:c.pubTxt},on:{focus:function(t){c.isReplyId=""},keyup:c.onkeyPub,click:function(t){c.showEmojiPanel=!1},input:function(t){t.target.composing||(c.pubTxt=t.target.value)}}}),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenEmojiPanel(!1)}}},[d("Icon",{directives:[{name:"show",rawName:"v-show",value:!c.showEmojiPanel,expression:"!showEmojiPanel"}],attrs:{name:"emoji",size:"22",color:"#646466"}}),c._v(" "),d("Icon",{directives:[{name:"show",rawName:"v-show",value:c.showEmojiPanel,expression:"showEmojiPanel"}],attrs:{name:"jianpan",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{staticClass:"icon-btn",on:{click:function(t){return c.onOpenImagePanel(!1)}}},[d("Icon",{attrs:{name:"picture",size:"22",color:"#646466"}})],1),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.pubLoading,expression:"pubLoading"}],staticClass:"icon-btn",on:{click:c.onPub}},[d("Icon",{attrs:{name:"Comment_send",size:"22",color:"#646466"}})],1)]),c._v(" "),d("ImagePreview",{directives:[{name:"show",rawName:"v-show",value:!c.inReplyEditMode&&c.selectedImageUrls.length>0,expression:"!inReplyEditMode && selectedImageUrls.length > 0"}],on:{"image-urls-change":function(t){c.$nextTick((function(){return c.updateEmojiPanelPosition()}))}},model:{value:c.selectedImageUrls,callback:function(t){c.selectedImageUrls=t},expression:"selectedImageUrls"}})],1)]):c._e(),c._v(" "),d("div",{attrs:{id:"reverseLoadDiv"}}),c._v(" "),d("el-popover",{directives:[{name:"show",rawName:"v-show",value:c.inEditMode&&c.showEmojiPanel,expression:"inEditMode && showEmojiPanel"}],ref:"popoverEditorRef",staticClass:"popover-editor",attrs:{trigger:"manual","popper-options":{modifiers:[{name:"computeStyles",options:{adaptive:!1,gpuAcceleration:!1}}]},placement:"bottom-start"},model:{value:c.inEditMode,callback:function(t){c.inEditMode=t},expression:"inEditMode"}},[d("div",{directives:[{name:"show",rawName:"v-show",value:c.showEmojiPanel,expression:"showEmojiPanel"}],staticClass:"editor-emoji-panel-section"},[d("EmojiPicker",{ref:"emojiPicker",attrs:{emojiTable:c.emojiTable},on:{emoji:c.insert},scopedSlots:c._u([{key:"emoji-picker",fn:function(t){var e=t.emojis,n=t.insert;return d("div",{},[d("div",{staticClass:"emoji-picker"},[d("div",c._l(e,(function(t,e){return d("div",{key:e},[d("h5",[c._v(c._s(c.$t(e)))]),c._v(" "),d("div",c._l(t instanceof Map?t:new Map(Object.entries(t)),(function(t){var e=Object(o.a)(t,2),r=e[0],l=e[1];return d("span",{key:r,attrs:{title:r},on:{click:function(t){return n(l)}}},[c._v("\n                    "+c._s(l)+"\n                  ")])})),0)])})),0)])])}}])})],1)]),c._v(" "),d("HyUploadMoald",{ref:"hyUploadModal",attrs:{recentlyUsedQueryObj:{artwork_types:[1,3,4]},personalWorksQueryObj:{artwork_types:[1,3,4]},isSingleSelect:!0},on:{onConfirm:c.handleConfirmImageSelect}}),c._v(" "),d("ViewImage",{ref:"viewImage"})],1)}),[],!1,null,"9f095db0",null);e.default=component.exports;installComponents(component,{CollectPopover:n(63).default,BaseAvatar:n(53).default})},1177:function(t,e,n){"use strict";n.r(e);n(763),n(47);var o=n(456),r=n.n(o),l=(n(764),n(457)),c=n.n(l),d=(n(24),{name:"CreativeCenterMenu",components:{ElMenu:c.a,ElMenuItem:r.a},props:{menuIndex:{type:[String,Number],default:""}},data:function(){return{zoomMenu:[]}},methods:{changeMenu:function(){},changeZoom:function(){}}}),h=(n(4476),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"creative-center-menu"},[e("el-menu",{ref:"generateMenu",attrs:{"default-active":t.menuIndex,"default-openeds":t.zoomMenu},on:{select:t.changeMenu,open:function(e){return t.changeZoom(e,"open")},close:function(e){return t.changeZoom(e,"close")}}},[e("el-menu-item",{attrs:{index:"submittedWorks"}},[e("template",{slot:"title"},[e("i",{staticClass:"iconfont icon-wenshengtu creative-center-menu-item-icon"}),t._v("\n        "+t._s(t.$t("CreativeCenterPopup34")))])],2)],1)],1)}),[],!1,null,"73363d2e",null);e.default=component.exports},1179:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(73),n(22),n(4),n(28),n(58)),l=n(147),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var h={props:{type:{type:String,default:"artwork"},id:{type:String,default:""},width:{type:String,default:"1016px"}},data:function(){return{getTimeDiff2:r.e,dialogVisible:!1,commentData:{},commentFromData:{obj_id:"",obj_type:"artwork",page:1,page_size:8},repliesFromData:{comment_id:"",page:1,page_size:10},commentList:[],commentListLoading:!1,commentText:"",isLoading:!1,buttonShow:!1,loadMoreShow:!1,focusBnt:!1,repliesListLoading:!1,repliesList:[],noMoreData:!1,total:0,errTxt:"",errTxtShow:!1}},watch:{dialogVisible:{handler:function(t){var e=this;t?(this.commentData.id&&this.getRepliesList(),this.$nextTick((function(){e.$refs.list.addEventListener("scroll",e.checkLoadMore)}))):(this.commentData={},this.buttonShow=!1,this.commentText="",this.repliesList=[],this.noMoreData=!1,this.errTxtShow=!1,this.errTxt="",this.getCommentList(),this.$refs.list.removeEventListener("scroll",this.checkLoadMore))}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.c)("user",["isLoggedIn"])),created:function(){this.commentFromData.obj_type=this.type,this.commentFromData.obj_id=this.id},mounted:function(){this.getCommentList()},methods:{initials:function(t){return t.split(" ").map((function(t){return t[0]})).join("")},setButtonShow:function(){this.buttonShow=!!this.focusBnt||this.commentText.length>0},onComment:function(){var t=this;if(!this.commentText||/^\s*$/.test(this.commentText))return this.errTxtShow=!0,void(this.errTxt=this.$t("CommentEmpty"));this.errTxtShow=!1,this.errTxt="",this.isLoading=!0;var e={content:this.commentText,obj_id:this.id,obj_type:this.type},n=l.a;this.commentData.id&&(n=l.b,e.comment_id=this.commentData.id,delete e.obj_id,delete e.obj_type),n(e).then((function(e){var n,o;1e4==(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?(t.commentText="",t.commentData.id?(t.$refs.list.scrollTop=0,t.noMoreData=!1,t.getRepliesList()):t.dialogVisible=!1):("40007"==(null==e||null===(o=e.status)||void 0===o?void 0:o.code)?t.errTxt=t.$t("CommentViolates"):t.errTxt=t.$t("ServerError"),t.errTxtShow=!0)})).finally((function(){t.isLoading=!1}))},getCommentList:function(t){var e=this;this.commentListLoading||(t?this.commentFromData.page++:this.commentFromData.page=1,this.commentListLoading=!0,Object(l.g)(this.commentFromData).then((function(n){var o,r;1e4==(null==n||null===(o=n.status)||void 0===o?void 0:o.code)?(e.commentList=t?e.commentList.concat(n.data.list||[]):n.data.list||[],e.total=n.data.total,e.commentFromData.page==Math.ceil(n.data.total/e.commentFromData.page_size)?e.loadMoreShow=!1:e.loadMoreShow=!0):e.$message({message:(null==n||null===(r=n.status)||void 0===r?void 0:r.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.commentListLoading=!1})))},checkLoadMore:function(){var t=this.$refs.list,e=t.scrollTop,n=t.scrollHeight;e+t.clientHeight>=n-300&&this.getRepliesList(!0)},getRepliesList:function(t){var e=this;this.repliesListLoading||this.noMoreData||(this.repliesListLoading=!0,this.repliesFromData.comment_id=this.commentData.id,t?this.repliesFromData.page++:this.repliesFromData.page=1,Object(l.j)(this.repliesFromData).then((function(n){var o;if(1e4==(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){if(0==n.data.list.length)return void(e.noMoreData=!0);e.repliesList=t?e.repliesList.concat(n.data.list||[]):n.data.list||[]}else{var r;e.$message({message:(null==n||null===(r=n.status)||void 0===r?void 0:r.msg)||e.$t("ServerError"),type:"error"})}})).finally((function(){e.repliesListLoading=!1})))}}},v=h,f=(n(4836),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"img-comment",style:{marginBottom:"model"==t.type?"0":null}},[e("div",{staticClass:"comment-cnt",style:{width:t.width}},[e("div",{staticClass:"comment-title"},[e("span",{staticClass:"tit"},[t._v(t._s(t.$t("comment")+"("+t.total+")"))]),t._v(" "),e("div",{on:{click:function(e){t.isLoggedIn?t.dialogVisible=!0:t.$EventBus.$emit("openLoginDialog")}}},[e("i",{staticClass:"iconfont icon-comment"}),t._v(" "),e("span",[t._v(t._s(t.$t("AddComment")))])])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.commentListLoading,expression:"commentListLoading"}],staticClass:"comment-list"},t._l(t.commentList,(function(n,o){return e("div",{key:o,staticClass:"comment-item"},[e("div",{staticClass:"item-cnt"},[e("div",{staticClass:"item-title"},[n.account_info?e("div",{staticClass:"item-user"},[n.account_info.avatar?e("img",{staticClass:"item-avator",attrs:{decoding:"async",loading:"lazy",src:n.account_info.avatar,alt:""}}):e("div",{staticClass:"item-avator"},[t._v("\n                "+t._s(t.initials(n.account_info.name))+"\n              ")]),t._v(" "),e("div",{staticClass:"item-name"},[t._v(t._s(n.account_info.name))])]):t._e()]),t._v(" "),e("div",{staticClass:"item-text"},[t._v(t._s(n.content))]),t._v(" "),e("div",{staticClass:"item-info"},[e("div",{staticClass:"item-time"},[t._v(t._s(t.getTimeDiff2(n.create_at,Date.now())))]),t._v(" "),e("div",{staticClass:"item-num",on:{click:function(e){t.isLoggedIn?(t.commentData=n,t.dialogVisible=!0):t.$EventBus.$emit("openLoginDialog")}}},[e("i",{staticClass:"iconfont icon-comment"}),t._v(" "),e("span",[t._v(t._s(n.replies_num))])])])])])})),0)]),t._v(" "),t.loadMoreShow&&0!=t.commentList.length?e("div",{staticClass:"more",on:{click:function(e){return t.getCommentList(!0)}}},[e("span",[t._v(t._s(t.$t("loadMore")))])]):t._e(),t._v(" "),e("el-dialog",{attrs:{title:t.$t("comment"),visible:t.dialogVisible,top:"30vh",width:"508px","modal-append-to-body":!1,"close-on-click-modal":!1,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"addcomment"},[t.commentData.id?e("div",[e("div",{staticClass:"addcmt-title"},[t.commentData.account_info?e("div",{staticClass:"addcmt-user"},[t.commentData.account_info.avatar?e("img",{staticClass:"addcmt-avator",attrs:{decoding:"async",loading:"lazy",src:t.commentData.account_info.avatar,alt:""}}):e("div",{staticClass:"addcmt-avator"},[t._v("\n              "+t._s(t.initials(t.commentData.account_info.name))+"\n            ")]),t._v(" "),e("div",{staticClass:"addcmt-userinfo"},[e("div",[t._v(t._s(t.commentData.account_info.name))]),t._v(" "),e("div",[t._v(t._s(t.getTimeDiff2(t.commentData.create_at,Date.now())))])])]):t._e()]),t._v(" "),e("div",{staticClass:"addcmt-text"},[t._v(t._s(t.commentData.content))]),t._v(" "),e("div",{staticClass:"addcmt-num"},[t._v("\n          "+t._s(t.repliesList.length)+" "),e("span",[t._v(t._s(t.$t("reply")))])])]):t._e(),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.commentText,expression:"commentText"}],staticClass:"addcmt-input",attrs:{type:"text",placeholder:t.$t("typeComment"),maxlength:"200"},domProps:{value:t.commentText},on:{focus:function(e){t.buttonShow=!0},blur:t.setButtonShow,input:function(e){e.target.composing||(t.commentText=e.target.value)}}}),t._v(" "),t.errTxtShow?e("div",{staticClass:"errTxtBox"},[t._v(t._s(t.errTxt))]):t._e(),t._v(" "),!t.commentData.id||t.buttonShow?e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("div",{on:{mouseover:function(e){t.focusBnt=!0},mouseout:function(e){t.focusBnt=!1}}},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{loading:t.isLoading},on:{click:t.onComment}},[t._v(t._s(t.$t("comment")))])],1)]):t._e(),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.repliesListLoading,expression:"repliesListLoading"}],ref:"list",staticClass:"addcmt-list"},t._l(t.repliesList,(function(n,o){return e("div",{key:o,staticClass:"adcmt-item"},[n.account_info?e("div",[n.account_info.avatar?e("img",{staticClass:"list-avator",attrs:{decoding:"async",loading:"lazy",src:n.account_info.avatar,alt:""}}):e("div",{staticClass:"list-avator"},[t._v("\n              "+t._s(t.initials(n.account_info.name))+"\n            ")])]):t._e(),t._v(" "),e("div",{staticClass:"list-text"},[e("div",{staticClass:"list-name"},[t._v(t._s(n.account_info.name))]),t._v(" "),e("div",{staticClass:"list-cnt"},[t._v(t._s(n.content))])])])})),0)])])],1)}),[],!1,null,"8aa2b95e",null);e.default=component.exports},1185:function(t,e,n){"use strict";n.r(e);var o={name:"CTabs",props:{tabs:{type:Array,default:function(){return[]}},currentTab:{type:String,default:""},tabStyle:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{changeTab:function(t){this.$emit("changeTab",t)}}},r=(n(5116),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-tab",style:t.tabStyle},t._l(t.tabs,(function(n){return e("div",{key:n.value,staticClass:"item-tab",class:{active:t.currentTab==n.value},on:{click:function(e){return t.changeTab(n)}}},[t._v("\n    "+t._s(t.$t(n.label))+"\n  ")])})),0)}),[],!1,null,"8b81e2ac",null);e.default=component.exports},1581:function(t,e,n){t.exports={}},1582:function(t,e,n){t.exports={}},1583:function(t,e,n){t.exports={}},1584:function(t,e,n){t.exports={}},1677:function(t,e,n){t.exports={}},1678:function(t,e,n){t.exports={}},1679:function(t,e,n){t.exports={}},1763:function(t,e,n){t.exports={}},1764:function(t,e,n){t.exports={}},1765:function(t,e,n){t.exports={}},1919:function(t,e,n){t.exports={}},1957:function(t,e,n){t.exports={}},1958:function(t,e,n){t.exports={}},2042:function(t,e,n){t.exports={}},2043:function(t,e,n){t.exports={}},2044:function(t,e,n){t.exports={}},2045:function(t,e,n){t.exports={}},2046:function(t,e,n){t.exports={}},2047:function(t,e,n){t.exports={}},2048:function(t,e,n){t.exports={}},2049:function(t,e,n){t.exports={}},2050:function(t,e,n){t.exports={}},2051:function(t,e,n){t.exports={}},2052:function(t,e,n){t.exports={}},2053:function(t,e,n){t.exports={}},2054:function(t,e,n){t.exports={}},2055:function(t,e,n){t.exports={}},2056:function(t,e,n){t.exports={}},2057:function(t,e,n){t.exports={}},2058:function(t,e,n){t.exports={}},2059:function(t,e,n){t.exports={}},2060:function(t,e,n){t.exports={}},2061:function(t,e,n){t.exports={}},2062:function(t,e,n){t.exports={}},2063:function(t,e,n){t.exports={}},2064:function(t,e,n){t.exports={}},2065:function(t,e,n){t.exports={}},2066:function(t,e,n){t.exports={}},2067:function(t,e,n){t.exports={}},2068:function(t,e,n){t.exports={}},2069:function(t,e,n){t.exports={}},2070:function(t,e,n){t.exports={}},2071:function(t,e,n){t.exports={}},2072:function(t,e,n){t.exports={}},2073:function(t,e,n){t.exports={}},2074:function(t,e,n){t.exports={}},2075:function(t,e,n){t.exports={}},2273:function(t,e,n){t.exports={}},2368:function(t,e,n){t.exports={}},2410:function(t,e,n){t.exports={}},249:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(16),n(4),n(43),n(1)),l=n(27),c=n(10);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={mixins:[n(45).a],props:{value:{type:Boolean,default:!1},width:{type:String,default:"510px"},type:{type:String,default:"artwork"},dataToCollect:{type:Object,default:function(){return{}}},checkList:{type:Object,default:function(){return{ids:[],collectIds:[]}}},editData:{type:Object,default:function(){return{}}},category:{type:Boolean,default:!1},banner:{type:String,default:function(){return""}},fromPage:{type:String,default:function(){return""}},isColorBtn:{type:Boolean,default:!1}},computed:h(h(h({},Object(r.e)("payment",["paymentInfo"])),Object(r.c)("user",["isCompanyAccount","userInfo"])),{},{getBannerUrl:function(){var t,e,n,o,r="";if(this.dataToCollect&&this.dataToCollect.cover)r="[object Object]"===Object.prototype.toString.call(null==this||null===(e=this.dataToCollect)||void 0===e?void 0:e.cover)?(null==this||null===(n=this.dataToCollect)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url)||"":(null==this||null===(o=this.dataToCollect)||void 0===o?void 0:o.cover)||"";else if(this.dataToCollect&&null!==(t=this.dataToCollect)&&void 0!==t&&t.banner){var l,c,d;if("[object Object]"===Object.prototype.toString.call(null==this||null===(l=this.dataToCollect)||void 0===l?void 0:l.banner))r=(null==this||null===(c=this.dataToCollect)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.url)||"";else r=(null==this||null===(d=this.dataToCollect)||void 0===d?void 0:d.banner)||""}else r=this.banner||"";return r},isGreen:function(){return this.checkGreen(null==this?void 0:this.dataToCollect)},dialogVisible:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount}}),watch:{dialogVisible:{handler:function(t){t?(console.log(this.dataToCollect,"8889"),this.editData.id&&(this.formData.id=this.editData.id,this.formData.name=this.editData.name,this.formData.is_visible=1==this.editData.status||!1,this.secret=!this.formData.is_visible)):(this.formData.id="",this.formData.name="",this.formData.is_visible=!0,this.secret=!1,this.$emit("closeMask"))}}},data:function(){return{isLoading:!1,isDeleteLoading:!1,formData:{id:"",name:"",type:"",is_visible:!0},secret:!1,isInputActive:!1,innerVisible:!1,replaceImageType:c.K}},methods:{checkGreen:function(t){return!(null==t||!t.green||![2,"2"].includes(t.green))&&this.greenMode},greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},secretChange:function(){!this.isVip&&this.category&&(this.secret=!1,this.$EventBus.$emit("showBreakDialog","PrivacyPortfolioTipWeb","basic"))},onCreate:function(){var t=this;if(["",null,void 0].includes(this.formData.name)){var e=this.category?this.$t("portfolioName"):this.$t("collectBox3");this.$message.warning(this.$t("collectCreate11",{name:e}))}else{this.formData.type={artwork:1,model:2,post:3,gallery:3,palette:4,workflow:5,swtft_app:6,character:7,ai_audio:9,ai_novel:21}[this.type],this.isLoading=!0,this.formData.is_visible=!this.secret,this.category?this.formData.category=2:delete this.formData.category,Object(l.o)(this.formData).then((function(e){var n=(e||{}).status.code,code=void 0===n?"":n;["20201",20201].includes(code)?t.$message.error(t.category?t.$t("portfoliosOverLimit"):t.$t("boardOverLimit")):["20202",20202].includes(code)?t.$message.error(t.category?t.$t("portfolioOverRepeated"):t.$t("boardOverRepeated")):["20203",20203].includes(code)?t.$message.error(t.category?t.$t("violationPortfolioname"):t.$t("violationBoardname")):(t.dataToCollect&&t.dataToCollect.id&&t.addFavorite(t.dataToCollect,t.type,e.data,(function(e){var n;if(t.dialogVisible=!1,!["",null,void 0].includes(null==t||null===(n=t.formData)||void 0===n?void 0:n.name)){var o="saveModal"===t.fromPage?"collectCreate5":"collectCreate4";t.$message.success(t.$t(o,{name:t.formData.name}))}t.$emit("create")}),null,!0),t.checkList.ids&&t.checkList.ids.length>0?t.moveFavorite(t.checkList,e.data,t.category,(function(e){var n;t.dialogVisible=!1,!["",null,void 0].includes(null==t||null===(n=t.formData)||void 0===n?void 0:n.name)&&t.$message.success(t.$t("collectCreate6",{name:t.formData.name})),t.$emit("create")})):(t.dialogVisible=!1,t.$emit("create",e.data)))})).finally((function(){t.isLoading=!1}))}},onEdit:function(){var t=this;this.isLoading=!0,this.formData.is_visible=!this.secret,this.category?this.formData.category=2:delete this.formData.category,Object(l.q)(this.formData).then((function(e){var n=(e||{}).status.code,code=void 0===n?"":n;["20201",20201].includes(code)?t.$message.error(t.category?t.$t("portfoliosOverLimit"):t.$t("boardOverLimit")):["20202",20202].includes(code)?t.$message.error(t.category?t.$t("portfolioOverRepeated"):t.$t("boardOverRepeated")):["20203",20203].includes(code)?t.$message.error(t.category?t.$t("violationPortfolioname"):t.$t("violationBoardname")):1e4===e.status.code&&(t.dialogVisible=!1,t.$emit("create"))})).finally((function(){t.isLoading=!1}))},onDelete:function(){var t=this;this.isDeleteLoading=!0,this.category?this.formData.category=2:delete this.formData.category,Object(l.p)({id:this.editData.id,category:this.category?2:null}).then((function(e){1e4===e.status.code&&(t.dialogVisible=!1,t.innerVisible=!1,t.$emit("delete"))})).finally((function(){t.isDeleteLoading=!1}))}}},f=(n(3898),n(3899),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.editData.id?t.category?t.$t("editPortfolio"):t.$t("collectBox2"):t.category?t.$t("createPortfolio"):t.$t("collectBox1"),visible:t.dialogVisible,top:"30vh","append-to-body":"","modal-append-to-body":"",modal:"","close-on-click-modal":!0,center:"","custom-class":"SaDialog collection-create-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"main"},[t.getBannerUrl?e("img",{style:{filter:t.isGreen?"blur(19px) saturate(160%)":""},attrs:{decoding:"async",loading:"lazy",src:t.replaceImageType(t.getBannerUrl,"low")}}):t._e(),t._v(" "),e("div",{style:{width:"100%"}},[e("div",{staticClass:"title"},[t._v("\n        "+t._s(t.category?t.$t("portfolioName"):t.$t("collectBox3"))+"\n      ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],class:{inputActive:t.isInputActive},attrs:{type:"text",maxlength:"40",placeholder:t.category?t.$t("portfolioName"):t.$t("collectBox3")},domProps:{value:t.formData.name},on:{focus:function(e){t.isInputActive=!0},blur:function(e){t.isInputActive=!1},input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}}),t._v(" "),e("div",{staticClass:"secret-box",class:[t.isColorBtn&&"secret-box-color"]},[e("div",{staticClass:"secret-text"},[e("span",[t._v(t._s(t.$t(t.category?"MakePortfolioPrivate":"collectBox4")))]),t._v(" "),e("span",[t._v("("+t._s(t.$t("OnlySee"))+")")])]),t._v(" "),e("el-switch",{staticClass:"secret-box-switch",on:{change:t.secretChange},model:{value:t.secret,callback:function(e){t.secret=e},expression:"secret"}})],1),t._v(" "),t.editData.id?e("div",{staticClass:"deleteCollect"},[e("div",{on:{click:function(e){t.innerVisible=!0}}},[t._v("\n          "+t._s(t.category?t.$t("deletePortfolio"):t.$t("collectBox5"))+"\n        ")]),t._v(" "),e("div",[t._v(t._s(t.category?t.$t("deletePortfolioDesc"):t.$t("collectBox6")))])]):t._e()])]),t._v(" "),e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),t.editData.id?e("el-button",{attrs:{loading:t.isLoading},on:{click:t.onEdit}},[t._v(t._s(t.$t("Done")))]):e("el-button",{class:[t.isColorBtn&&"liner-color"],attrs:{loading:t.isLoading},on:{click:t.onCreate}},[t._v(t._s(t.$t("Create")))])],1),t._v(" "),e("el-dialog",{attrs:{visible:t.innerVisible,top:"40vh",width:t.width,"custom-class":"SaDialog","append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e}}},[e("div",{staticClass:"sure"},[t._v("\n      "+t._s(t.category?t.$t("deletePortfolioAndWorks"):t.$t("collectBox7"))+"\n    ")]),t._v(" "),e("div",{staticClass:"sureDesc"},[t._v("\n      "+t._s(t.category?t.$t("newWorksPermanentlyDeleted",{name:t.editData.name}):t.$t("collectBox8",{name:t.editData.name}))+"\n    ")]),t._v(" "),e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.innerVisible=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{loading:t.isDeleteLoading},on:{click:t.onDelete}},[t._v(t._s(t.$t("Delete")))])],1)])],1)}),[],!1,null,"2d8d602c",null);e.default=component.exports},2513:function(t,e,n){t.exports={}},2548:function(t,e,n){t.exports={}},289:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(19),n(4),n(28),n(43),n(40),n(140),n(77),n(41),n(141),n(142),n(109),{name:"CAudio",props:{audio:{type:Object,required:!0,default:function(){return{}}},isShowDownload:{type:Boolean,default:!0}},data:function(){return{isPlaying:!1,currentTime:0,duration:0,progress:0}},methods:{togglePlay:function(){var t;if(null!==(t=this.audio)&&void 0!==t&&t.url){var audio=this.$refs.audio;this.isPlaying?audio.pause():audio.play(),this.isPlaying=!this.isPlaying}},onTimeUpdate:function(t){var audio=t.target;this.currentTime=audio.currentTime,this.progress=audio.currentTime/audio.duration*100},onLoadedMetadata:function(t){this.duration=t.target.duration},onEnded:function(){this.isPlaying=!1,this.currentTime=0,this.progress=0},onError:function(){this.isPlaying=!1,this.$message.error(this.$t("Audio playback failed"))},handleProgressClick:function(t){var e=this.$refs.progressBar,audio=this.$refs.audio,rect=e.getBoundingClientRect(),time=(t.clientX-rect.left)/rect.width*audio.duration;audio.currentTime=time},formatTime:function(t){var e=Math.floor(t/60),n=Math.floor(t%60);return"".concat(e,":").concat(n.toString().padStart(2,"0"))},handleDownload:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,link;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.audio)&&void 0!==n&&n.url){e.next=2;break}return e.abrupt("return",t.$message.warning(t.$t("Invalid audio URL")));case 2:return e.prev=2,e.next=5,fetch(t.audio.url);case 5:return o=e.sent,e.next=8,o.blob();case 8:r=e.sent,l=window.URL.createObjectURL(r),(link=document.createElement("a")).href=l,link.download=t.getFileName(),document.body.appendChild(link),link.click(),document.body.removeChild(link),window.URL.revokeObjectURL(l),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(2),console.error("Download failed:",e.t0),t.$message.error(t.$t("Download failed"));case 23:case"end":return e.stop()}}),e,null,[[2,19]])})))()},getFileName:function(){var t,e=(null===(t=this.audio)||void 0===t?void 0:t.url)||"";if(!e)return"";var n=e.match(/\/([^\/?#]+)[^\/]*$/);return n?decodeURIComponent(n[1]):""}}}),l=(n(4349),n(0)),component=Object(l.a)(r,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-audio flex-center"},[n("div",{staticClass:"c-audio-player"},[n("div",{staticClass:"c-audio-control",on:{click:e.togglePlay}},[n("i",{staticClass:"iconfont",class:e.isPlaying?"icon-bofangz":"icon-zanting1"})]),e._v(" "),n("div",{ref:"progressBar",staticClass:"c-audio-progress",on:{click:e.handleProgressClick}},[n("div",{staticClass:"c-audio-progress-bar",style:{width:e.progress+"%"}})]),e._v(" "),n("div",{staticClass:"c-audio-time"},[n("span",[e._v(e._s(e.formatTime(e.currentTime)))]),e._v(" "),n("span",[e._v("/")]),e._v(" "),n("span",[e._v(e._s(e.formatTime(e.duration)))])]),e._v(" "),e.isShowDownload?n("div",{staticClass:"c-audio-download",on:{click:function(t){return t.stopPropagation(),e.handleDownload.apply(null,arguments)}}},[n("i",{staticClass:"iconfont icon-modelDownload"})]):e._e()]),e._v(" "),n("audio",{ref:"audio",attrs:{src:null===(t=e.audio)||void 0===t?void 0:t.url},on:{timeupdate:e.onTimeUpdate,loadedmetadata:e.onLoadedMetadata,ended:e.onEnded,error:e.onError}})])}),[],!1,null,"bdeba260",null);e.default=component.exports},3057:function(t,e,n){t.exports={}},3058:function(t,e,n){t.exports={}},3059:function(t,e,n){t.exports={}},3060:function(t,e,n){t.exports={}},3225:function(t,e,n){"use strict";n.r(e);var o=n(14),r=(n(49),{props:{value:{type:Array,default:function(){return[]}}},methods:{removeImage:function(t){var e=Object(o.a)(this.value);e.splice(t,1),this.$emit("input",e),this.$emit("image-urls-change")}}}),l=(n(4036),n(0)),component=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-preview"},t._l(t.value,(function(n,o){return e("div",{key:o,staticClass:"image-preview-item"},[e("img",{attrs:{src:n,alt:""}}),t._v(" "),e("div",{staticClass:"remove-btn",on:{click:function(e){return t.removeImage(o)}}},[e("i",{staticClass:"el-icon-close"})])])})),0)}),[],!1,null,"f010f36c",null);e.default=component.exports},3351:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(73),n(22),n(1));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var c={name:"headBar",data:function(){return{}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(r.e)("user",["userInfo"])),methods:{handleClose:function(){this.$emit("closePopup")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")}}},d=c,h=(n(4475),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"head-bar"},[e("div",{staticClass:"head-bar-content"},[e("img",{staticClass:"head-bar-logo",attrs:{src:n(275),alt:"Avatar"}}),t._v(" "),e("span",{staticClass:"head-bar-title"},[t._v(t._s(t.$t("creativeCenter")))]),t._v(" "),e("i",{staticClass:"iconfont icon-goBack head-bar-icon",on:{click:t.handleClose}})]),t._v(" "),e("div",{staticClass:"head-bar-content"},[e("div",{staticClass:"avatar",class:[t.userInfo.head?"":"avatar-color"]},[t.userInfo.head?e("img",{attrs:{src:t.userInfo.head,alt:"avatar"}}):e("div",[t._v("\n        "+t._s(t.initials(t.userInfo.name?t.userInfo.name:t.userInfo.id))+"\n      ")])]),t._v(" "),e("div",{staticClass:"name-text"},[t._v("\n      "+t._s(t.userInfo.name?t.userInfo.name:t.userInfo.id)+"\n    ")])])])}),[],!1,null,"766515c4",null);e.default=component.exports},3352:function(t,e,n){"use strict";n.r(e);var o={name:"handleText",inject:["top"],data:function(){return{uploading:!1,accept:".jpg,.jpeg,.png,.svg,.webp,.bmp,.tif"}},methods:{fileExceed:function(){this.$message({type:"warning",message:this.$t("CreativeCenterPopup20",{number:20})})},handleBeforeUpload:function(t){return this.handleUploadImage(t),!1},handleBeforeUploadEmpty:function(){},handleUploadImage:function(t){t&&(this.$emit("changeStep",2),this.top.changeType("upload"),t&&this.top.jumpToTextEdit(t))},handleSelectImage:function(){this.$emit("openPickWorkModal"),this.top.changeType("pick")}}},r=(n(4477),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"handle-text-upload"},[e("div",{staticClass:"text-upload-tip"},[e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("span",[t._v(t._s(t.$t("TextPostTip")))])]),t._v(" "),e("div",{staticClass:"upload-area",on:{click:function(e){return e.stopPropagation(),t.handleSelectImage.apply(null,arguments)}}},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],ref:"imageUpload2",staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":t.handleBeforeUpload,disabled:"",accept:t.accept,multiple:"",limit:20,"on-exceed":t.fileExceed,"http-request":t.handleBeforeUploadEmpty,"show-file-list":!1}},[e("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[e("div",{staticClass:"el-upload__text_1"},[t._v(t._s(t.$t("CreativeCenterPopup19")))]),t._v(" "),e("div",{staticClass:"el-upload__text_2"},[t._v("（ "+t._s(t.$t("CreativeCenterPopup20",{number:20}))+" ）")])])])],1),t._v(" "),e("div",{staticClass:"upload-describe-wrapper"},[e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup1")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup2")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup3",{number:10})))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item upload-describe-area-item-margin"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup4")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup5")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup6")))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup7")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup8")))])])])])}),[],!1,null,null,null);e.default=component.exports},3353:function(t,e,n){"use strict";n.r(e);var o={name:"handleVideo",inject:["top"],data:function(){return{uploading:!1}},methods:{handleBeforeUpload:function(t){if(-1===["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/quicktime"].indexOf(t.type))return this.$message.warning(this.$t("OnlySupportVideo"));if(!(t.size>1073741824))return this.handleUploadVideo(t),!1;this.$message.warning(this.$t("CreativeCenterPopup12",{number:1}))},handleBeforeUploadEmpty:function(){},handleUploadVideo:function(t){t&&(this.$emit("changeStep",2),this.top.changeType("upload"),t&&this.top.jumpToVideoEdit(t))}}},r=(n(4478),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"handle-video-upload"},[e("div",{staticClass:"video-upload-tip"},[e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("span",[t._v(t._s(t.$t("VideoPostTip")))])]),t._v(" "),e("div",{staticClass:"upload-area"},[[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],ref:"videoUpload",staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":t.handleBeforeUpload,disabled:t.uploading,accept:"video/*","http-request":t.handleBeforeUploadEmpty,"show-file-list":!1}},[e("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[e("div",{staticClass:"el-upload__text_1"},[t._v(t._s(t.$t("CreativeCenterPopup22")))]),t._v(" "),e("div",{staticClass:"el-upload__btn-box"},[e("div",{staticClass:"upload-box-btn",on:{click:function(e){return t.handleUploadVideo()}}},[t._v(t._s(t.$t("selectingMaterialsType3")))])])])])]],2),t._v(" "),e("div",{staticClass:"upload-describe-wrapper"},[e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup10")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup11",{number:15})))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup12",{number:1})))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item upload-describe-area-item-margin"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup13")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup14")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup15")))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup16")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup17")))])])])])}),[],!1,null,null,null);e.default=component.exports},3354:function(t,e,n){"use strict";n.r(e);var o={name:"handleArticle",inject:["top"],data:function(){return{uploading:!1,accept:".jpg,.jpeg,.png,.svg,.webp,.bmp,.tif"}},methods:{handleBeforeUpload:function(t){return this.handleUploadImage(t),!1},handleBeforeUploadEmpty:function(){},handleUploadImage:function(t){t&&(this.$logEvent("log_actions",{operation:"click_upload_cover_tab",behavior_info:"on_artical_upload_popup"}),this.$emit("changeStep",2),this.top.changeType("upload"),this.top.jumpToArticleEdit(t))},handleSelectImage:function(){this.$logEvent("log_actions",{operation:"click_personal_work_tab",behavior_info:"on_artical_upload_popup"}),this.$emit("openPickWorkModal"),this.top.changeType("pick")}}},r=(n(4479),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"handle-article-upload"},[e("div",{staticClass:"text-upload-tip"},[e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("span",[t._v(t._s(t.$t("ArticlePostTip")))])]),t._v(" "),e("div",{staticClass:"upload-area",on:{click:function(e){return e.stopPropagation(),t.handleSelectImage.apply(null,arguments)}}},[[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],ref:"imageUpload2",staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":t.handleBeforeUpload,disabled:"",accept:t.accept,"http-request":t.handleBeforeUploadEmpty,"show-file-list":!1}},[e("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[e("div",{staticClass:"el-upload__text_1"},[t._v("\n              "+t._s(t.$t("CreativeCenterPopup19"))+"\n            ")]),t._v(" "),e("div",{staticClass:"el-upload__text_2"},[t._v("（ "+t._s(t.$t("ArticleUploadLimit"))+" ）")])])])]],2),t._v(" "),e("div",{staticClass:"upload-describe-wrapper"},[e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup1")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup2")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup3",{number:10})))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item upload-describe-area-item-margin"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup4")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup5")))]),t._v(" "),e("div",[t._v(t._s(t.$t("CreativeCenterPopup6")))])]),t._v(" "),e("div",{staticClass:"upload-describe-area-item"},[e("p",[t._v(t._s(t.$t("CreativeCenterPopup7")))]),t._v(" "),e("div",[t._v(t._s(t.$t("ArticleImageScale")))])])])])}),[],!1,null,null,null);e.default=component.exports},3355:function(t,e,n){"use strict";n.r(e);var o=n(14),r=(n(11),n(72),n(19),n(32),n(16),n(4),n(152),n(7),n(888)),l=n(605),c=n(465),d=n(203),h={name:"handleTextEdit",inject:["top"],components:{PostForm:r.default,UploadImageItem:l.default,pickWorkModal:c.default},data:function(){return{selectList:[],maxNum:20,isPosting:!1,params:{}}},computed:{showUpload:function(){return this.top.type}},methods:{updateParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.params=t,this.$refs.postForm.initTags((null==t?void 0:t.tags)||[])},updateImageFile:function(t){var e=this;this.$nextTick((function(){e.$refs.uploadImageItem.curstomUpload({file:t})}))},handleSelectArtWork:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateList(t)},handleStep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$emit("changeStep",t)},handleCancel:function(){var t=this;this.isPosting||this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("changeStep",1)})).catch((function(t){console.log("err",t)}))},imagDelete:function(){},onClearAll:function(){this.selectList=[]},imgUpChange:function(){},handleOpenPickWorkModal:function(){this.top.openPickWorkModal()},updateList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[].concat(Object(o.a)(this.selectList),Object(o.a)(t));for(e=e.reduce((function(t,e){return t.find((function(u){return u.url===e.url}))||t.push(e),t}),[]);e.length>20;)e.shift();this.selectList=e},handleLogEvent:function(t){try{this.$logEvent("log_actions",{operation:"post_picture",behavior_info:"choose_picture"}),this.$logEvent("log_actions",{operation:"post_picture",behavior_info:"choose_tag",behavior_info_sub:null==t?void 0:t.tags[0]}),this.$logEvent("log_actions",{operation:"post_picture",behavior_info:"release_picture"})}catch(t){}},handleConfirm:function(){var t=this,e=this.groupParams();e&&!this.isPosting&&(this.handleLogEvent(e),this.isPosting=!0,Object(d.worksPost)(e).then((function(e){if(1e4===e.status.code)t.$message.success(t.$t("CreativeCenterPopup30")),t.resetData(),t.$emit("changeStep",1);else{if([40017,40018].includes(e.status.code))return void t.$message.error(t.$t("CreativeCenterPopup37"));t.$message.error(e.status.msg)}})).finally((function(){t.isPosting=!1})))},resetData:function(){var t;this.selectList=[],this.isPosting=!1,null==this||null===(t=this.$refs)||void 0===t||null===(t=t.postForm)||void 0===t||t.resetFormData()},groupParams:function(){var t,e={};if(!this.selectList.length)return this.$message.warning(this.$t("CreativeCenterPopup23")),!1;var n=this.$refs.postForm.submitData();if(!n)return!1;var o=[],r=[],l=[];return this.selectList.forEach((function(t){var e=(null==t?void 0:t.info)||{},n=e.channel,c=e.obj_parent_no;!t.id||n||t.taskId||o.push(t.id),"artwork"===n&&c&&!t.taskId&&o.push(c),"upload"===n&&r.push({width:t.width,height:t.height,uri:t.url}),t.taskId&&l.push({task_id:t.taskId,index:t.index})})),e.artwork_ids=o,e.upload_images=r,e.save_personal=l,e.tags=n.tags||[],e.intro=n.description||"",e.title=n.title||"",e.source=null==this||null===(t=this.top)||void 0===t?void 0:t.source,e.link=n.link||[],e}}},v=h,f=(n(4484),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"handle-text-edit"},[e("div",{staticClass:"handle-text-edit-header"},[e("div",{staticClass:"header-item"},[e("span",{staticClass:"header-item-border"}),t._v(" "),e("span",{staticClass:"header-item-text"},[t._v(t._s(t.$t("GraphicSubmission")))])]),t._v(" "),e("div",{staticClass:"header-item"},[e("div",{staticClass:"header-item-btn",on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("Publish"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"handle-text-edit-content"},[e("div",{staticClass:"top-tips"},[e("span",{staticClass:"tips-select-count"},[t._v(t._s(t.$t("imageAlbum"))+" ("+t._s(t.selectList.length)+"/"+t._s(t.maxNum)+")")]),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("handleWorkTips1",{number:t.maxNum}),placement:"top"}},[e("span",{staticClass:"el-icon-info tips-select-info-tips"})]),t._v(" "),e("div",{staticClass:"tips-select-desc-text"},[t._v(t._s(t.$t("handleWorkTips2")))])],1),t._v(" "),e("div",{staticClass:"pick-result-box"},[e("UploadImageItem",{ref:"uploadImageItem",attrs:{max:t.maxNum,"show-upload":t.showUpload},on:{delete:t.imagDelete,clearAll:t.onClearAll,handleChange:t.imgUpChange,openPickWorkModal:t.handleOpenPickWorkModal},model:{value:t.selectList,callback:function(e){t.selectList=e},expression:"selectList"}})],1),t._v(" "),e("post-form",{key:"textPostForm",ref:"postForm",attrs:{fileList:t.selectList}})],1),t._v(" "),e("pick-work-modal",{ref:"pickWorkModal",attrs:{type:"contribute"},on:{confirm:t.handleSelectArtWork}})],1)}),[],!1,null,"19da6884",null);e.default=component.exports},3356:function(t,e,n){"use strict";n.r(e);n(16);var o=n(3),r=(n(20),n(11),n(72),n(4),n(28),n(40),n(152),n(41),n(141),n(142),n(109),n(888)),l=n(605),c=n(465),d=n(3357),h=n(3130),v=n(203),f=n(57),m=n(403),_={name:"handleVideoEdit",inject:["top"],components:{PostForm:r.default,UploadImageItem:l.default,pickWorkModal:c.default,videoCoverEditModal:d.default},mixins:[h.uploadVideoMixIn,m.videoCoverMixIn],data:function(){return{selectList:[],maxNum:20,formData:{cover:"",video:"",cover_height:0,cover_width:0,duration:0,url:""},url:"",rawCoverUrl:"",base64Cover:null,rawCoverUploading:!1}},watch:{},computed:{showUpload:function(){return this.top.type}},mounted:function(){},methods:{handleVideoLoadedMetadata:function(){var video=this.$refs.videoPlayer;video&&video.duration&&(this.formData.duration=Math.floor(video.duration))},updateVideoFile:function(t){this.beforeUpload(t),this.generateThumbnail(t)},generateThumbnail:function(t){var e=this,n=URL.createObjectURL(t);this.getBestPoster(n,30).then((function(t){e.base64Cover=null==t?void 0:t.posterUrl,e.formData.duration=Math.floor((null==t?void 0:t.duration)||0),e.rawCoverUrl=null==t?void 0:t.posterUrl,e.formData.cover=null==t?void 0:t.posterUrl})).catch((function(t){console.log(t)})).finally((function(){URL.revokeObjectURL(n)}))},uploadMaskImage:function(){var t=this,e=this.top.UPLOAD,n=Object(f.dataURItoBlob)(this.base64Cover);return this.rawCoverUploading=!0,e.startUpload(n,{name:"videoPost".concat(Date.now(),".png"),type:"png"}).then((function(e){t.rawCoverUrl=e,t.formData.cover=e})).finally((function(){t.rawCoverUploading=!1}))},handleImageLoad:function(t){this.formData.cover_width=t.target.naturalWidth,this.formData.cover_height=t.target.naturalHeight},handleUpdateCover:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("handleUpdateCover",this.formData),this.formData.cover!==t&&(this.formData.cover=t,this.$forceUpdate())},openEditVideoCoverModal:function(){this.$refs.videoCoverEditModal.openModal(this.rawCoverUrl)},handleBeforeUpload:function(t){if(-1===["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/quicktime"].indexOf(t.type))return this.$message.warning(this.$t("OnlySupportVideo"));if(!(t.size>1073741824))return this.generateThumbnail(t),this.beforeUpload(t),!1;this.$message.warning(this.$t("CreativeCenterPopup12",{number:1}))},handleUploadClick:function(){this.$refs.UploadVideo.$refs["upload-inner"].handleClick()},handleSelectArtWork:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateList(t)},handleStep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$emit("changeStep",t)},cancelUploadVideo:function(){this.clear()},handleCancel:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("changeStep",1)})).catch((function(t){console.log("err",t)}))},imagDelete:function(){},onClearAll:function(){this.selectList=[]},imgUpChange:function(){},handleOpenPickWorkModal:function(){this.$refs.pickWorkModal.openModal(this.selectList)},updateList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.selectList=t||[]},remotePost:function(t){var e;this.formData=t,this.base64Cover=t.cover,"video_editor"===t.source&&(this.rawCoverUrl=t.cover),["img_to_video","text_to_video"].includes(null==this||null===(e=this.top)||void 0===e?void 0:e.source)&&this.$refs.postForm.defSelectedTags(["ai video"])},handleLogEvent:function(t){try{this.$logEvent("log_actions",{operation:"post_video",behavior_info:"click_post_video"}),this.$logEvent("log_actions",{operation:"post_video",behavior_info:"choose_tag",behavior_info_sub:null==t?void 0:t.tags[0]}),this.$logEvent("log_actions",{operation:"post_video",behavior_info:"release_video"})}catch(t){}},checkCoverUrl:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var pattern;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pattern=/^(http|https):\/\//,""===t.formData.cover||pattern.test(t.formData.cover)){e.next=5;break}return e.abrupt("return",t.uploadMaskImage());case 5:return e.abrupt("return",t.formData.cover);case 6:case"end":return e.stop()}}),e)})))()},handleConfirm:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPosting){e.next=2;break}return e.abrupt("return");case 2:return t.isPosting=!0,e.next=5,t.groupParams();case 5:if(n=e.sent){e.next=9;break}return t.isPosting=!1,e.abrupt("return");case 9:t.handleLogEvent(n),Object(v.videoPost)(n).then((function(e){if(1e4===e.status.code)t.$message.success(t.$t("CreativeCenterPopup30")),t.resetData(),t.$emit("changeStep",1);else{if([40017,40018].includes(e.status.code))return void t.$message.error(t.$t("CreativeCenterPopup37"));t.$message.error(e.status.msg)}})).finally((function(){t.isPosting=!1}));case 11:case"end":return e.stop()}}),e)})))()},resetData:function(){var t;this.selectList=[],this.formData.cover="",this.formData.url="",this.formData.cover_width=0,this.formData.cover_height=0,this.isPosting=!1,null==this||null===(t=this.$refs)||void 0===t||null===(t=t.postForm)||void 0===t||t.resetFormData(),this.base64Cover=null,this.rawCoverUploading=!1},groupParams:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={},t.formData.cover){e.next=4;break}return t.$message.warning(t.$t("audioTrain1")),e.abrupt("return",!1);case 4:if(t.formData.url){e.next=7;break}return t.$message.warning(t.$t("CreativeCenterPopup39")),e.abrupt("return",!1);case 7:if(r=t.$refs.postForm.submitData()){e.next=10;break}return e.abrupt("return",!1);case 10:return e.next=12,t.checkCoverUrl();case 12:return e.sent,o.look_book_tpl_info={id:t.formData.templateId||"",url:t.formData.originalUrl||""},o.tags=r.tags||[],o.intro=r.description||"",o.video_url=t.formData.url||"",o.cover_url=t.formData.cover||"",o.duration=t.formData.duration||0,o.title=r.title||"",o.cover_width=t.formData.cover_width,o.cover_height=t.formData.cover_height,o.source=null==t||null===(n=t.top)||void 0===n?void 0:n.source,o.link=r.link||[],e.abrupt("return",o);case 25:case"end":return e.stop()}}),e)})))()}}},y=_,C=(n(4486),n(0)),component=Object(C.a)(y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"handle-video-edit"},[e("div",{staticClass:"handle-video-edit-header"},[e("div",{staticClass:"header-item"},[e("span",{staticClass:"header-item-border"}),t._v(" "),e("span",{staticClass:"header-item-text"},[t._v(t._s(t.$t("VideoSubmission")))])]),t._v(" "),e("div",{staticClass:"header-item"},[e("div",{staticClass:"header-item-btn",on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("Publish"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"handle-text-edit-content"},[e("div",{staticClass:"handle-text-edit-content-left"},[e("div",{staticClass:"content-left-title"},[t._v(t._s(t.$t("CreativeCenterPopup24")))]),t._v(" "),e("div",{staticClass:"content-main"},[e("div",{staticClass:"content-main-cover-box"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.rawCoverUploading,expression:"rawCoverUploading"}],staticClass:"cover-image-box"},[t.formData.cover?e("img",{staticClass:"cover-image",attrs:{src:t.formData.cover,alt:"封面"},on:{load:function(e){return t.handleImageLoad(e)}}}):t._e()]),t._v(" "),e("div",{staticClass:"cover-image-title"},[t._v(t._s(t.$t("CreativeCenterPopup25")))])]),t._v(" "),e("div",{staticClass:"content-main-text-box"},[e("div",{staticClass:"main-title"},[t._v(t._s(t.$t("CreativeCenterPopup26")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("CreativeCenterPopup27")))])]),t._v(" "),e("div",{staticClass:"content-main-btn-box"},[e("div",{staticClass:"content-main-btn",on:{click:function(e){return e.stopPropagation(),t.openEditVideoCoverModal()}}},[e("span",{staticClass:"content-main-btn-text"},[t._v(t._s(t.$t("CreativeCenterPopup28")))])])])]),t._v(" "),e("post-form",{key:"videoPostForm",ref:"postForm",attrs:{from:"videoPost",fileList:[{url:t.formData.url}]}})],1),t._v(" "),e("div",{staticClass:"handle-text-edit-content-right"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:["pending"].includes(t.uploadingStatus),expression:"['pending'].includes(uploadingStatus)"}],staticClass:"video-preview-wrap"},[e("div",{staticClass:"progress-bar"}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.formData.url&&!["pending"].includes(t.uploadingStatus),expression:"!formData.url && !['pending'].includes(uploadingStatus)"}],staticClass:"empty-tips"},[t._m(0),t._v(" "),e("div",[t._v(t._s(t.$t("uploadError")))])]),t._v(" "),t.formData.url?e("video",{ref:"videoPlayer",staticClass:"video-preview-wrap-video",attrs:{src:t.formData.url,controlslist:"nofullscreen nodownload noremoteplayback noplaybackrate",controls:"",disablepictureinpicture:""},on:{loadedmetadata:t.handleVideoLoadedMetadata}}):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:["pending"].includes(t.uploadingStatus),expression:"['pending'].includes(uploadingStatus)"}],staticClass:"cancel-btn",on:{click:function(e){return e.stopPropagation(),t.cancelUploadVideo.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("CreativeCenterPopup29"))+"\n      ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!["pending"].includes(t.uploadingStatus),expression:"!['pending'].includes(uploadingStatus)"}],staticClass:"refresh-btn",on:{click:function(e){return e.stopPropagation(),t.handleUploadClick.apply(null,arguments)}}},[e("span",{staticClass:"el-icon-refresh re-upload-icon"}),t._v(" "),e("span",{staticClass:"re-upload-text"},[t._v(t._s(t.$t("CreativeCenterPopup33")))])])])]),t._v(" "),e("el-upload",{ref:"UploadVideo",staticClass:"image-upload",staticStyle:{display:"none"},attrs:{action:"#",drag:"","before-upload":t.handleBeforeUpload,"show-file-list":!1}},[e("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[e("div",{staticClass:"el-upload__text_1"},[t._v(t._s(t.$t("CreativeCenterPopup22")))]),t._v(" "),e("div",{staticClass:"el-upload__btn-box"},[e("div",{staticClass:"upload-box-btn"},[e("span",{staticClass:"el-icon-refresh re-upload-icon"}),t._v(" "),e("span",{staticClass:"re-upload-text"},[t._v(t._s(t.$t("CreativeCenterPopup33")))])])])])]),t._v(" "),e("video-cover-edit-modal",{ref:"videoCoverEditModal",on:{updateCover:t.handleUpdateCover}})],1)}),[function(){var t=this._self._c;return t("div",[t("span",{staticClass:"el-icon-warning"})])}],!1,null,"ba51a758",null);e.default=component.exports},3357:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(16),n(21),n(61)),l={name:"videoCoverEditModal",inject:["top"],data:function(){return{visible:!1,loading:!1,tabList:[{i18nKey:"CreativeCenterPopup31",icon:"GraphicSubmission",label:"截取封面",code:"captureCover"},{i18nKey:"CreativeCenterPopup32",icon:"VideoSubmission",label:"上传封面",code:"uploadCover"}],activeTab:"captureCover",uploading:!1,imageUrl:"",rawCoverUrl:"",accept:".jpeg,.png,.webp,.jpg"}},methods:{resetData:function(){this.imageUrl=""},openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&(this.rawCoverUrl=t),this.visible=!0},handleRawCoverImageLoad:function(t){},reUpload:function(){this.$refs.imgUpload.$refs["upload-inner"].handleClick()},handleClose:function(){this.visible=!1},handleConfirm:function(){var t="";if("captureCover"===this.activeTab&&(t=this.rawCoverUrl),"uploadCover"===this.activeTab){if(!this.imageUrl)return void this.$message.warning("请先上传图片");t=this.imageUrl}this.$emit("updateCover",t),this.handleClose()},handleTabClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"uploadCover"===(null==t?void 0:t.code)&&this.$logEvent("log_actions",{operation:"post_video",behavior_info:"choose_video_cover"}),this.activeTab=t.code||""},handleUploadImage:function(){},handleImageLoad:function(t){},handleBeforeUploadEmpty:function(){},handleBeforeUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.top.UPLOAD,l=["image/jpeg","image/png","image/jpg","image/webp"],!e.isLoading){n.next=4;break}return n.abrupt("return");case 4:if(l.includes(t.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 7:if(!(c=t)||c.size){n.next=10;break}return n.abrupt("return",!1);case 10:if(!(c.size/1024/1024>5)){n.next=21;break}return n.prev=11,n.next=14,Object(r.a)(c,5242880);case 14:c=n.sent,n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(11),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 21:return e.imageUrl="",e.uploading=!0,o.startUpload(c).then((function(t){e.uploading=!1,e.imageUrl=t})).catch((function(t){e.uploading=!1,e.$message.error(e.$t("uploadError"))})),n.abrupt("return",!1);case 25:case"end":return n.stop()}}),n,null,[[11,17]])})))()}}},c=l,d=(n(4485),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.visible,"custom-class":"c-video-cover-edit-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":"",width:"800px",title:t.$t("PleaseSetCover")},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"video-cover-edit-modal-header"},t._l(t.tabList,(function(n){return e("div",{key:n.code,staticClass:"tab-item",class:[t.activeTab===n.code?"tab-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleTabClick(n)}}},[t._v("\n      "+t._s(t.$t(n.i18nKey))+"\n    ")])})),0),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"captureCover"===t.activeTab,expression:"activeTab === 'captureCover'"}],staticClass:"video-cover-edit-content"},[e("div",{staticClass:"result-show"},[t.rawCoverUrl?e("img",{staticClass:"cover-img",attrs:{src:t.rawCoverUrl,alt:""},on:{load:function(e){return t.handleRawCoverImageLoad(e)}}}):t._e()])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"uploadCover"===t.activeTab,expression:"activeTab === 'uploadCover'"}],staticClass:"video-cover-edit-content"},[e("el-upload",{directives:[{name:"show",rawName:"v-show",value:!t.imageUrl,expression:"!imageUrl"},{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],ref:"imgUpload",staticClass:"image-upload",attrs:{action:"#",drag:"","before-upload":t.handleBeforeUpload,disabled:t.uploading,accept:t.accept,"http-request":t.handleBeforeUploadEmpty,"show-file-list":!1}},[e("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[e("div",{staticClass:"el-upload__text_1"},[t._v(t._s(t.$t("CreativeCenterPopup36")))]),t._v(" "),e("div",{staticClass:"el-upload__btn-box"},[e("div",{staticClass:"upload-box-btn upload-box-btn-gradient",on:{click:t.handleUploadImage}},[e("div",{staticClass:"upload-box-btn-inner"},[t._v(t._s(t.$t("UploadImg")))])])])])]),t._v(" "),t.imageUrl?e("div",{staticClass:"result-show"},[e("img",{staticClass:"cover-img",attrs:{src:t.imageUrl,alt:""},on:{load:function(e){return t.handleImageLoad(e)}}})]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.imageUrl,expression:"imageUrl"}],staticClass:"re-upload",on:{click:function(e){return e.stopPropagation(),t.reUpload()}}},[e("span",{staticClass:"el-icon-refresh re-upload-icon"}),t._v(" "),e("span",{staticClass:"re-upload-text"},[t._v(t._s(t.$t("CreativeCenterPopup33")))])])],1),t._v(" "),e("div",{staticClass:"bottom-btn-box"},[e("div",{staticClass:"bottom-btn-box-btn",on:{click:function(e){return e.stopPropagation(),t.handleClose()}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"bottom-btn-box-btn bottom-btn-box-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm()}}},[t._v(t._s(t.$t("Confirm")))])])])}),[],!1,null,null,null);e.default=component.exports},3358:function(t,e,n){"use strict";n.r(e);n(16);var o=n(14),r=n(2),l=n(3),c=(n(20),n(19),n(11),n(6),n(32),n(22),n(31),n(18),n(8),n(12),n(13),n(4),n(7),n(61)),d=n(51),h=n(82),v=n(9),f=n(71),m=n(212),_=n(203),y=n(35),C=n.n(y),w=n(822);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"handleArticleEdit",inject:["top"],components:{MyEditor:m.default},data:function(){return{isLoading:!1,isUploading:!1,getTagLoading:!1,selectedImage:{},accept:".jpg,.jpeg,.png,.svg,.webp,.bmp,.tif",formData:{title:"",tags:[],content:""},tagList:[],intRmdTag:[],postTagList:[],checkTagList:[],rules:{title:[{required:!0,message:this.$t("postFormTitleTips")}],tags:[{required:!0,message:this.$t("CreativeCenterPopup35"),trigger:["change","blur"]}]},toolbarConfig:{toolbarKeys:["header1","header2","header3","bold","underline","italic","through","color","insertLink","uploadImage","bulletedList","numberedList","undo","redo"]},editId:""}},mounted:function(){this.getTagList()},computed:{},methods:{checkItem:function(t){return this.checkTagList.find((function(e){return e.id===t.id}))},handleCheckTag:function(t){this.checkTagList.find((function(e){return e.id===t.id}))?(this.checkTagList=this.checkTagList.filter((function(e){return e.id!==t.id})),this.formData.tags=this.formData.tags.filter((function(e){return e.id!==t.id})),this.tagList=this.tagList.filter((function(e){return e.id!==t.id}))):(this.checkTagList.push(t),this.formData.tags.push(t),this.tagList.push(t),this.$refs.postForm.validateField("tags"))},removeTag:function(t){this.postTagList.find((function(e){return e===t}))&&(this.tagList=this.tagList.filter((function(e){return e!==t})),this.intRmdTag=this.intRmdTag.filter((function(e){return e!==t})),this.checkTagList=this.checkTagList.filter((function(e){return e!==t})))},getTagList:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getTagLoading=!0,Object(f.d)({show_area:"post"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){return e.title=e[v.r[t.$i18n.locale]],e.label=e.title||e.id,e.searchLabel=(t.langOptions||[]).map((function(t){return e[t]?e[t]:""})).filter((function(t){return!!t})),e})),t.$set(t,"tagList",n),t.$set(t,"intRmdTag",n),t.getTagLoading=!1})).finally((function(){t.getTagLoading=!1})),e.next=4,Object(f.d)({show_area:"post_tag"});case 4:1e4===(n=e.sent).status.code&&(t.postTagList=n.data?n.data.map((function(e){return L({title:e[v.r[t.$i18n.locale]]||e.en,label:e.title},e)})):[]);case 6:case"end":return e.stop()}}),e)})))()},changeTag:function(t){var e=t.length-1;"string"==typeof t[e]&&(t[e]=t[e].slice(0,30)),this.formData.tags=t},setIntRmdTag:function(t){var e,n=this;t&&(this.tagList=[].concat(Object(o.a)(this.intRmdTag),Object(o.a)(null===(e=this.formData)||void 0===e?void 0:e.tags.filter((function(t){return!n.intRmdTag.find((function(e){return e.title===t.title}))})))))},remoteMethod:function(t){var e=this;t&&Object(h.d)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.tagList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.tagList.push({title:t.title,id:t.title,type:(null==t?void 0:t.type)||""})})))}))},filterMethod:function(){var t=this;this.$nextTick((function(){try{t.$refs.tagSelect.$el.querySelector(".el-select__input").setAttribute("maxlength",30)}catch(t){}}))},updateList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.selectedImage=(null==t?void 0:t[0])||""},updateImageFile:function(t){var e=this;this.$nextTick((function(){e.customUpload({file:t})}))},handleOpenPickWorkModal:function(){this.top.openPickWorkModal()},customUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isUploading=!0,!((o=t.file).size/1024/1024>2)){n.next=14;break}return n.prev=3,n.next=6,Object(c.a)(o,2097152);case 6:o=n.sent,n.next=14;break;case 9:return n.prev=9,n.t0=n.catch(3),console.error("Compression failed:",n.t0),e.isUploading=!1,n.abrupt("return");case 14:return n.next=16,e.checkImageSize(o);case 16:r=n.sent,(l=new d.a({type:2})).startUpload(o,{category:50,size:o.size}).then((function(t){var n={url:t,uploadStatus:100,ready:!0,file_id:l.fileId,width:r.width,height:r.height};e.selectedImage=n})).finally((function(){e.isUploading=!1}));case 19:case"end":return n.stop()}}),n,null,[[3,9]])})))()},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t=img.naturalWidth,n=img.naturalHeight;e({width:t,height:n})},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},handleCancel:function(){var t=this;this.isLoading||this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.resetData(),t.$emit("changeStep",1)})).catch((function(t){console.log("err",t)}))},handleConfirm:function(){var t=this;this.$refs.postForm.validate((function(e){e&&t.postArticle()}))},postArticle:function(){var t,e=this,n=C()(this.formData);n.tags.forEach((function(t,i){t.title||(n.tags[i]={title:t});var e=Object.keys(t);2===e.length&&e.every((function(t){return["title","id"].includes(t)}))&&delete n.tags[i].id}));var o=this.selectedImage,r=o.url,l=o.width,c=o.height;o.id;if(n.cover={width:l,height:c,uri:r},null!=n&&null!==(t=n.cover)&&void 0!==t&&t.uri){this.isLoading=!0;var d=_.articlePost;this.editId&&(d=_.articleEdit,n.id=this.editId),d(n).then((function(){e.$message.success(e.$t("CreativeCenterPopup30")),e.resetData(),e.$emit("changeStep",1),e.isLoading=!1})).catch((function(t){e.$message.error(t.message||e.$t("PostFailed")),e.isLoading=!1}))}else this.$message.warning(this.$t("PleaseSetCover"))},resetData:function(){this.selectedImage={},this.formData={title:"",tags:[],content:""},this.editId=""},handleEdit:function(t){var e=this,n=t.id;this.editId=n,this.isLoading=!0,Object(w.a)({id:n}).then((function(t){var n=t.data,o=n.portfolio,r=(n.author,o.cover),l=o.name,c=o.tag,content=o.content;e.formData.title=l,e.formData.tags=c,e.selectedImage={url:null==r?void 0:r.url,width:null==r?void 0:r.width,height:null==r?void 0:r.height},e.formData.content=content})).finally((function(){e.isLoading=!1}))}}},$=O,T=(n(4487),n(0)),component=Object(T.a)($,(function(){var t,e=this,n=e._self._c;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"handle-article-edit"},[n("div",{staticClass:"handle-article-edit-header"},[n("div",{staticClass:"header-item"},[n("span",{staticClass:"header-item-border"}),e._v(" "),n("span",{staticClass:"header-item-text"},[e._v(e._s(e.$t("PublishArticle")))])]),e._v(" "),n("div",{staticClass:"header-item"},[n("div",{staticClass:"header-item-btn",on:{click:function(t){return t.stopPropagation(),e.handleCancel.apply(null,arguments)}}},[e._v("\n        "+e._s(e.$t("Cancel"))+"\n      ")]),e._v(" "),n("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(t){return t.stopPropagation(),e.handleConfirm.apply(null,arguments)}}},[e._v("\n        "+e._s(e.$t("Publish"))+"\n      ")])])]),e._v(" "),n("div",{staticClass:"handle-article-edit-content"},[n("div",{staticClass:"cover-title"},[e._v(e._s(e.$t("CoverImg")))]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isUploading,expression:"isUploading"}],staticClass:"image-box",on:{click:e.handleOpenPickWorkModal}},[null!==(t=e.selectedImage)&&void 0!==t&&t.url?[n("img",{staticClass:"selected-image",attrs:{src:e.selectedImage.url,alt:"selected image"}}),e._v(" "),n("el-upload",{ref:"imageUpload",staticClass:"upload-image",attrs:{action:"/",disabled:"","http-request":e.customUpload,accept:e.accept,"show-file-list":!1}},[n("div",{staticClass:"hover-box flex-center"},[e._v("\n            "+e._s(e.$t("Replace"))+"\n          ")])])]:n("el-upload",{ref:"imageUpload",staticClass:"upload-image-box",attrs:{action:"/",disabled:"","http-request":e.customUpload,accept:e.accept,"show-file-list":!1}},[n("i",{staticClass:"el-icon-plus"}),e._v(" "),n("div",{staticClass:"desc"},[e._v(e._s(e.$t("ArticleImageScale")))])])],2),e._v(" "),n("el-form",{ref:"postForm",staticClass:"article-post-form",attrs:{model:e.formData,rules:e.rules,"label-position":"top"}},[n("el-form-item",{attrs:{label:e.$t("Title"),prop:"title"}},[n("el-input",{staticClass:"title-input",attrs:{"show-word-limit":"",maxlength:"80",placeholder:e.$t("postFormTitleTips")},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("TagsAssociation"),prop:"tags"}},[n("el-select",{ref:"tagSelect",staticClass:"show-tag",staticStyle:{width:"100%"},attrs:{"value-key":"title",placeholder:e.$t("TagsAssociationTips"),multiple:"","multiple-limit":5,"popper-class":"show-tag-select post-show-tag-select",clearable:"",filterable:"","allow-create":"","default-first-option":"",remote:"","remote-method":e.remoteMethod},on:{"visible-change":e.setIntRmdTag,"remove-tag":e.removeTag,change:e.changeTag},nativeOn:{input:function(t){return e.filterMethod.apply(null,arguments)}},model:{value:e.formData.tags,callback:function(t){e.$set(e.formData,"tags",t)},expression:"formData.tags"}},e._l(e.tagList,(function(t,i){return n("el-option",{key:"tag_".concat(t.id+i),attrs:{label:t.title,value:t}},[e._v("\n            "+e._s(t.title?t.title:t)+"\n            "),n("span",{directives:[{name:"show",rawName:"v-show",value:[1,"1"].includes(null==t?void 0:t.type),expression:"[1, '1'].includes(v?.type)"}],staticClass:"label-flag"},[e._v(e._s(e.$t("official")))])])})),1),e._v(" "),n("div",{staticClass:"custom-tag-box"},e._l(e.postTagList,(function(t){return n("div",{key:t.id,staticClass:"custom-tag-item",class:{"custom-tag-item--active":e.checkItem(t)},on:{click:function(n){return e.handleCheckTag(t)}}},[n("span",[e._v("#")]),e._v(e._s(t.title)+"\n          ")])})),0)],1)],1),e._v(" "),n("div",{staticClass:"content-title"},[e._v(e._s(e.$t("Content")))]),e._v(" "),n("MyEditor",{ref:"MyEditorRef",attrs:{height:"auto",uploadCategory:50,toolbarConfig:e.toolbarConfig,defaultProps:{mode:"simple"}},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)])}),[],!1,null,"ef526924",null);e.default=component.exports;installComponents(component,{MyEditor:n(212).default})},3359:function(t,e,n){"use strict";n.r(e);var o=n(54),r=n(3360),l=n(3361),c=n(3362),d=n(3363),h=n(3364),v=n(3365),f={name:"ResourceSelector",components:{SelectorForWork:r.default,SelectorForLocalVideo:l.default,SelectorForArticle:c.default,SelectorForCharacter:d.default,SelectorForModelCheckpoint:h.default,SelectorForModelLora:v.default},props:{visible:{type:Boolean,default:!1},enabledTypeList:{type:Array,default:o.CONTRIBUTION_TYPE_LIST},selectedData:{default:void 0},linkActivity:{type:Object,default:function(){}}},emits:["update:visible","confirmSelect"],data:function(){return{CONTRIBUTION_TYPE_ENUM:o.CONTRIBUTION_TYPE_ENUM,activeTab:""}},watch:{visible:{handler:function(t){var e=this;t?this.$nextTick((function(){e.activeTab=e.enabledTypeList[0].value})):this.activeTab=""}}},methods:{closeSelector:function(){this.$emit("update:visible",!1)},confirmSelect:function(t,e){this.$emit("confirmSelect",{type:t,selectedData:e}),this.closeSelector()}}},m=(n(4496),n(4497),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"resource-selector",attrs:{visible:t.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"tabs"},t._l(t.enabledTypeList,(function(n){return e("div",{key:n.value,staticClass:"tab-item",class:{active:t.activeTab===n.value},on:{click:function(e){t.activeTab=n.value}}},[t._v("\n      "+t._s(t.$t(n.label))+"\n    ")])})),0),t._v(" "),e("div",{staticClass:"selector-container"},[t.activeTab===t.CONTRIBUTION_TYPE_ENUM.WORK?e("SelectorForWork",{attrs:{selectedList:t.selectedData,linkActivity:t.linkActivity},on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.WORK,e)}}}):t._e(),t._v(" "),t.activeTab===t.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO?e("SelectorForLocalVideo",{on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO,e)}}}):t._e(),t._v(" "),t.activeTab===t.CONTRIBUTION_TYPE_ENUM.ARTICLE?e("SelectorForArticle",{attrs:{selectedList:t.selectedData,linkActivity:t.linkActivity},on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.ARTICLE,e)}}}):t._e(),t._v(" "),t.activeTab===t.CONTRIBUTION_TYPE_ENUM.CHARACTER?e("SelectorForCharacter",{attrs:{selectedList:t.selectedData,linkActivity:t.linkActivity},on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.CHARACTER,e)}}}):t._e(),t._v(" "),t.activeTab===t.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT?e("SelectorForModelCheckpoint",{attrs:{selectedList:t.selectedData,linkActivity:t.linkActivity},on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT,e)}}}):t._e(),t._v(" "),t.activeTab===t.CONTRIBUTION_TYPE_ENUM.MODEL_LORA?e("SelectorForModelLora",{attrs:{selectedList:t.selectedData,linkActivity:t.linkActivity},on:{closeSelector:t.closeSelector,confirmSelect:function(e){return t.confirmSelect(t.CONTRIBUTION_TYPE_ENUM.MODEL_LORA,e)}}}):t._e()],1)])}),[],!1,null,"c887de7e",null);e.default=component.exports},3360:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(3),l=n(14),c=(n(20),n(11),n(72),n(89),n(19),n(6),n(69),n(16),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(28),n(43),n(21),n(40),n(7),n(41),n(26),n(27)),d=n(81),h=n(51),v=n(164);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return y(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function y(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}var C={name:"SelectorForWork",components:{Waterfall:n(408).default},props:{selectedList:{type:Array,default:function(){return[]}},linkActivity:{type:Object,default:function(){}}},emits:["closeSelector","confirmSelect"],created:function(){this.thisTimeSelectedList=Object(l.a)(this.selectedList||[]),this.initCollection(),this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_select_page",behavior_info_sub:"gallery"})},data:function(){return{maxSelectCount:20,localImageUploading:!1,thisTimeSelectedList:[],waterfallParamsForTaskHistories:{after_id:""},waterfallParamsForAccountList:{page:1,page_size:35},waterfallResForAccountList:{has_more:!0},folderNo:"task-histories",folderOptions:[{value:"task-histories",label:this.$t("AllWorks")}],hasNewData:!1,createEntryList:[{id:"generateImage",targetTab:"generateImage",icon:"a-uploadimage",title:this.$t("imageGeneration"),logEventOperation:"click_image_generate"},{id:"generateVideo",targetTab:"generateVideo",icon:"video",title:this.$t("videoGeneration"),logEventOperation:"click_video_generate"}]}},watch:{folderNo:function(){this.$refs.waterfallRef.initWaterfallList()}},computed:{allowLocalPost:function(){return!this.linkActivity.id||this.linkActivity.allow_local_post},resultContentTypes:function(){var t,e=[0,1];if(1===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)){var n,o,r=[];return null!==(n=this.linkActivity)&&void 0!==n&&null!==(n=n.post_sub_type)&&void 0!==n&&n.includes(1)&&r.push(0),null!==(o=this.linkActivity)&&void 0!==o&&null!==(o=o.post_sub_type)&&void 0!==o&&o.includes(2)&&r.push(1),r}return e},artworkTypes:function(){var t,e,n=[1,3,4],o=[6,7],r=[].concat(n,o),l=[];return null!==(t=this.linkActivity)&&void 0!==t&&null!==(t=t.post_sub_type)&&void 0!==t&&t.includes(1)&&l.push.apply(l,n),null!==(e=this.linkActivity)&&void 0!==e&&null!==(e=e.post_sub_type)&&void 0!==e&&e.includes(2)&&l.push.apply(l,o),l.length?l:r}},methods:{initCollection:function(){var t=this;Object(c.I)({type:1,category:2}).then((function(e){var n=[];e.data.items.forEach((function(e){"all"===e.id?n.push({value:"",label:t.$t("already_save_work")}):n.push({value:e.id,label:e.name})})),t.folderOptions=[{value:"task-histories",label:t.$t("AllWorks")}].concat(n)}))},handleFileChange:function(t){var e=this,n=Array.from(t.target.files);if(n.some((function(t){return!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type)})))this.$message.warning(this.$t("AllowImageFiles"));else{if(n.some((function(t){return t.size>10485760})))this.$message.warning(this.$t("CreativeCenterPopup3",{number:10}));else{var o=n.map((function(t){return new h.a({type:44}).startUpload(t)}));this.localImageUploading=!0,Promise.all(o).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n){var o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.map(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(v.getImageDimensions)(e);case 2:return n=t.sent,t.abrupt("return",{url:e,width:n.width,height:n.height});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=3,Promise.all(o);case 3:c=t.sent,e.$emit("confirmSelect",[].concat(Object(l.a)(e.thisTimeSelectedList),Object(l.a)(c)));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){e.localImageUploading=!1})),t.target.value=""}}},getWaterfallList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,f,y,C,w,k,component,L,O,$,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("task-histories"!==t.folderNo){e.next=18;break}return r={display_mode:2,scene:"post_add_refer",result_content_types:t.resultContentTypes,time_from:0===(null===(n=t.linkActivity)||void 0===n?void 0:n.activity_type)?Object(v.getUtc0)():void 0},e.next=4,Object(d.j)(r);case 4:if(l=e.sent,t.waterfallParamsForTaskHistories.after_id=l.data.after_id,h=[],null!=l&&null!==(o=l.data)&&void 0!==o&&null!==(o=o.items)&&void 0!==o&&o.length){f=_(l.data.items);try{for(f.s();!(y=f.n()).done;)if((C=y.value).components){w=_(C.components);try{for(w.s();!(k=w.n()).done;)component=k.value,h.push({meta:component,id:component.artwork_no||C.id+"_"+component.index,taskId:C.id,index:component.index,url:component.url,width:component.width,height:component.height})}catch(t){w.e(t)}finally{w.f()}}}catch(t){f.e(t)}finally{f.f()}}if(!h.length){e.next=12;break}e.t0=h,e.next=15;break;case 12:return e.next=14,t.getMoreWaterfallList();case 14:e.t0=e.sent;case 15:return e.abrupt("return",e.t0);case 18:return t.waterfallParamsForAccountList.page=1,O=m(m({},t.waterfallParamsForAccountList),{},{folder_no:t.folderNo,artwork_types:t.artworkTypes,theme_activity_date:0===(null===(L=t.linkActivity)||void 0===L?void 0:L.activity_type)?t.linkActivity.date:void 0}),e.next=22,Object(c.ab)(O);case 22:if($=e.sent,t.waterfallResForAccountList.has_more=$.data.has_more,T=$.data.items.map((function(t){var e,n,o;return{meta:t,id:t.id,url:(null==t||null===(e=t.stream)||void 0===e?void 0:e.url)||(null==t||null===(n=t.stream)||void 0===n?void 0:n.url2)||(null==t||null===(o=t.stream)||void 0===o?void 0:o.url3)||t.cover.url,width:t.cover.width,height:t.cover.height}})),!T.length){e.next=29;break}e.t1=T,e.next=32;break;case 29:return e.next=31,t.getMoreWaterfallList();case 31:e.t1=e.sent;case 32:return e.abrupt("return",e.t1);case 33:case"end":return e.stop()}}),e)})))()},getMoreWaterfallList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,f,y,C,w,k,component,L,O,$,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("task-histories"!==t.folderNo){e.next=20;break}if(t.waterfallParamsForTaskHistories.after_id){e.next=3;break}return e.abrupt("return",[]);case 3:return r=m(m({},t.waterfallParamsForTaskHistories),{},{display_mode:2,scene:"post_add_refer",result_content_types:t.resultContentTypes,time_from:0===(null===(n=t.linkActivity)||void 0===n?void 0:n.activity_type)?Object(v.getUtc0)():void 0}),e.next=6,Object(d.j)(r);case 6:if(l=e.sent,t.waterfallParamsForTaskHistories.after_id=l.data.after_id,h=[],null!=l&&null!==(o=l.data)&&void 0!==o&&null!==(o=o.items)&&void 0!==o&&o.length){f=_(l.data.items);try{for(f.s();!(y=f.n()).done;)if((C=y.value).components){w=_(C.components);try{for(w.s();!(k=w.n()).done;)component=k.value,h.push({meta:component,id:component.artwork_no||C.id+"_"+component.index,taskId:C.id,index:component.index,url:component.url,width:component.width,height:component.height})}catch(t){w.e(t)}finally{w.f()}}}catch(t){f.e(t)}finally{f.f()}}if(!h.length){e.next=14;break}e.t0=h,e.next=17;break;case 14:return e.next=16,t.getMoreWaterfallList();case 16:e.t0=e.sent;case 17:return e.abrupt("return",e.t0);case 20:if(t.waterfallResForAccountList.has_more){e.next=22;break}return e.abrupt("return",[]);case 22:return t.waterfallParamsForAccountList.page++,O=m(m({},t.waterfallParamsForAccountList),{},{folder_no:t.folderNo,artwork_types:t.artworkTypes,theme_activity_date:0===(null===(L=t.linkActivity)||void 0===L?void 0:L.activity_type)?t.linkActivity.date:void 0}),e.next=26,Object(c.ab)(O);case 26:if($=e.sent,t.waterfallResForAccountList.has_more=$.data.has_more,T=$.data.items.map((function(t){var e,n,o;return{meta:t,id:t.id,url:(null==t||null===(e=t.stream)||void 0===e?void 0:e.url)||(null==t||null===(n=t.stream)||void 0===n?void 0:n.url2)||(null==t||null===(o=t.stream)||void 0===o?void 0:o.url3)||t.cover.url,width:t.cover.width,height:t.cover.height}})),!T.length){e.next=33;break}e.t1=T,e.next=36;break;case 33:return e.next=35,t.getMoreWaterfallList();case 35:e.t1=e.sent;case 36:return e.abrupt("return",e.t1);case 37:case"end":return e.stop()}}),e)})))()},handleLoadNewData:function(){this.$refs.waterfallRef.initWaterfallList(),this.hasNewData=!1},handleGoToCreate:function(t){var e=this;this.$logEvent("log_actions",{operation:t.logEventOperation,behavior_info:"on_createflow_page"}),this.$EventBus.$emit("openGenerate",{action:1,data:{portalParams:{targetTab:t.targetTab}}}),setTimeout((function(){return e.hasNewData=!0}),300)},onConfirmSelectClick:function(){0!==this.thisTimeSelectedList.length&&(this.$logEvent("log_actions",{operation:"click_confirm",behavior_info:"on_homepage_inspiration_tab_bottom",behavior_info_sub:"choose_works"}),this.$emit("confirmSelect",this.thisTimeSelectedList))}}},w=C,k=(n(4490),n(0)),L=Object(k.a)(w,(function(){var t,e,n=this,o=n._self._c;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.localImageUploading,expression:"localImageUploading"}],staticClass:"selector-for-work"},[o("div",{staticClass:"folder-select"},[o("el-select",{staticClass:"folder-select",attrs:{"popper-class":"contribution-resource-selector-folder-list-popper"},model:{value:n.folderNo,callback:function(t){n.folderNo=t},expression:"folderNo"}},n._l(n.folderOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:0===(null===(t=n.linkActivity)||void 0===t?void 0:t.activity_type),expression:"linkActivity?.activity_type === 0"}],staticClass:"description"},[o("Icon",{attrs:{name:"explanation",color:"#777E91"}}),n._v(" "),o("div",{staticClass:"desc-text"},[n._v("\n      "+n._s(n.$t("Daily_Theme_Updload_D2",{num1:null===(e=n.linkActivity)||void 0===e?void 0:e.date,num2:n.$t("Work")}))+"\n    ")])],1),n._v(" "),o("div",{staticClass:"description"},[o("Icon",{attrs:{name:"explanation",color:"#777E91"}}),n._v(" "),o("div",{staticClass:"desc-text"},[n._v("\n      "+n._s(n.$t("nsfw_prompt_contribution_selector"))+"\n    ")])],1),n._v(" "),o("div",{staticClass:"waterfall-wrapper"},[o("Waterfall",{ref:"waterfallRef",attrs:{getWaterfallListFn:n.getWaterfallList,getMoreWaterfallListFn:n.getMoreWaterfallList,selectedList:n.thisTimeSelectedList,isSingleSelect:!1,maxSelectCount:n.maxSelectCount},on:{"update:selectedList":function(t){n.thisTimeSelectedList=t},"update:selected-list":function(t){n.thisTimeSelectedList=t}},scopedSlots:n._u([n.allowLocalPost?{key:"waterfall-prefix-item",fn:function(){return[o("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",multiple:""},on:{change:n.handleFileChange}}),n._v(" "),o("div",{staticClass:"local-upload-btn",on:{click:function(t){return n.$refs.fileInput.click()}}},[o("Icon",{attrs:{name:"upload-icon",size:"32",color:"#777E91"}})],1)]},proxy:!0}:null],null,!0)}),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.hasNewData,expression:"hasNewData"}],staticClass:"load-new-data"},[o("div",{staticClass:"load-new-data-btn",on:{click:n.handleLoadNewData}},[o("Icon",{attrs:{name:"refresh-icon2",size:"40",color:"#fff"}})],1)])],1),n._v(" "),o("div",{staticClass:"create-entry"},[o("div",{staticClass:"entry-list"},n._l(n.createEntryList,(function(t){return o("div",{key:t.id,staticClass:"entry-item",on:{click:function(e){return n.handleGoToCreate(t)}}},[o("Icon",{staticClass:"item-icon",attrs:{name:t.icon,size:"20",color:"#f4f4f4"}}),n._v(" "),o("div",{staticClass:"item-title"},[n._v(n._s(t.title))])],1)})),0)]),n._v(" "),o("div",{staticClass:"footer"},[o("div",{staticClass:"selected-info"},[n._v("\n      "+n._s(n.$t("selected")+" "+n.thisTimeSelectedList.length+"/"+n.maxSelectCount)+"\n    ")]),n._v(" "),o("div",{staticClass:"operation"},[o("div",{staticClass:"cancel-btn",on:{click:function(t){return n.$emit("closeSelector")}}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("div",{staticClass:"confirm-btn",class:{disabled:0===n.thisTimeSelectedList.length},on:{click:n.onConfirmSelectClick}},[n._v("\n        "+n._s(n.$t("NextStep"))+"\n      ")])])])])}),[],!1,null,"4eae5d69",null);e.default=L.exports},3361:function(t,e,n){"use strict";n.r(e);var o={name:"SelectorForLocalVideo",emits:["closeSelector","confirmSelect"],created:function(){this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_select_page",behavior_info_sub:"video"})},data:function(){return{}},methods:{handleFileChange:function(t){var e=t.target.files[0];if(-1!==["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/quicktime"].indexOf(e.type)){e.size>1073741824?this.$message.warning(this.$t("CreativeCenterPopup12",{number:1})):(this.$emit("confirmSelect",e),t.target.value="")}else this.$message.warning(this.$t("OnlySupportVideo"))}}},r=(n(4491),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"selector-for-local-video"},[e("div",{staticClass:"description"},[e("Icon",{attrs:{name:"explanation",color:"#777E91"}}),t._v(" "),e("div",{staticClass:"desc-text"},[t._v("\n      "+t._s(t.$t("nsfw_prompt_contribution_selector"))+"\n    ")])],1),t._v(" "),e("div",{staticClass:"main"},[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"video/*"},on:{change:t.handleFileChange}}),t._v(" "),e("div",{staticClass:"upload-btn",on:{click:function(e){return t.$refs.fileInput.click()}}},[e("Icon",{attrs:{name:"upload-icon",size:"32",color:"#777E91"}})],1)]),t._v(" "),e("div",{staticClass:"footer"},[e("div",{staticClass:"selected-info"}),t._v(" "),e("div",{staticClass:"operation"},[e("div",{staticClass:"cancel-btn",on:{click:function(e){return t.$emit("closeSelector")}}},[t._v(t._s(t.$t("Cancel")))])])])])}),[],!1,null,"15c09385",null);e.default=component.exports},3362:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(3),l=n(14),c=(n(20),n(11),n(72),n(89),n(19),n(6),n(69),n(16),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(28),n(43),n(40),n(7),n(41),n(27)),d=n(81),h=n(51),v=n(164);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return y(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?y(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function y(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}var C={name:"SelectorForWork",components:{Waterfall:n(408).default},props:{selectedList:{type:Array,default:function(){return[]}},linkActivity:{type:Object,default:function(){}}},emits:["closeSelector","confirmSelect"],created:function(){this.thisTimeSelectedList=Object(l.a)(this.selectedList||[]),this.initCollection(),this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_select_page",behavior_info_sub:"article"})},data:function(){return{localImageUploading:!1,thisTimeSelectedList:[],waterfallParamsForTaskHistories:{after_id:""},waterfallParamsForAccountList:{page:1,page_size:35},waterfallResForAccountList:{has_more:!0},folderNo:"task-histories",folderOptions:[{value:"task-histories",label:this.$t("AllWorks")}]}},computed:{allowLocalPost:function(){return!this.linkActivity.id||this.linkActivity.allow_local_post}},watch:{folderNo:function(){this.$refs.waterfallRef.initWaterfallList()}},methods:{initCollection:function(){var t=this;Object(c.I)({type:1,category:2}).then((function(e){var n=[];e.data.items.forEach((function(e){"all"===e.id?n.push({value:"",label:t.$t("already_save_work")}):n.push({value:e.id,label:e.name})})),t.folderOptions=[{value:"task-histories",label:t.$t("AllWorks")}].concat(n)}))},handleFileChange:function(t){var e=this,n=Array.from(t.target.files);if(n.some((function(t){return!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type)})))this.$message.warning(this.$t("AllowImageFiles"));else{if(n.some((function(t){return t.size>10485760})))this.$message.warning(this.$t("CreativeCenterPopup3",{number:10}));else{var o=n.map((function(t){return new h.a({type:44}).startUpload(t)}));this.localImageUploading=!0,Promise.all(o).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n){var o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.map(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(v.getImageDimensions)(e);case 2:return n=t.sent,t.abrupt("return",{url:e,width:n.width,height:n.height});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=3,Promise.all(o);case 3:l=t.sent,e.$emit("confirmSelect",l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){e.localImageUploading=!1})),t.target.value=""}}},getWaterfallList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,v,f,y,C,component,w,k,L;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("task-histories"!==t.folderNo){e.next=18;break}return o={display_mode:2,scene:"post_add_refer",result_content_types:[0]},e.next=4,Object(d.j)(o);case 4:if(r=e.sent,t.waterfallParamsForTaskHistories.after_id=r.data.after_id,l=[],null!=r&&null!==(n=r.data)&&void 0!==n&&null!==(n=n.items)&&void 0!==n&&n.length){h=_(r.data.items);try{for(h.s();!(v=h.n()).done;)if((f=v.value).components){y=_(f.components);try{for(y.s();!(C=y.n()).done;)component=C.value,l.push({meta:component,id:component.artwork_no||f.id+"_"+component.index,taskId:f.id,index:component.index,url:component.url,width:component.width,height:component.height})}catch(t){y.e(t)}finally{y.f()}}}catch(t){h.e(t)}finally{h.f()}}if(!l.length){e.next=12;break}e.t0=l,e.next=15;break;case 12:return e.next=14,t.getMoreWaterfallList();case 14:e.t0=e.sent;case 15:return e.abrupt("return",e.t0);case 18:return t.waterfallParamsForAccountList.page=1,w=m(m({},t.waterfallParamsForAccountList),{},{folder_no:t.folderNo,artwork_types:[1,3,4]}),e.next=22,Object(c.ab)(w);case 22:if(k=e.sent,t.waterfallResForAccountList.has_more=k.data.has_more,L=k.data.items.map((function(t){return{meta:t,id:t.id,url:t.cover.url,width:t.cover.width,height:t.cover.height}})),!L.length){e.next=29;break}e.t1=L,e.next=32;break;case 29:return e.next=31,t.getMoreWaterfallList();case 31:e.t1=e.sent;case 32:return e.abrupt("return",e.t1);case 33:case"end":return e.stop()}}),e)})))()},getMoreWaterfallList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,v,f,y,C,component,w,k,L;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("task-histories"!==t.folderNo){e.next=20;break}if(t.waterfallParamsForTaskHistories.after_id){e.next=3;break}return e.abrupt("return",[]);case 3:return o=m(m({},t.waterfallParamsForTaskHistories),{},{display_mode:2,scene:"post_add_refer",result_content_types:[0]}),e.next=6,Object(d.j)(o);case 6:if(r=e.sent,t.waterfallParamsForTaskHistories.after_id=r.data.after_id,l=[],null!=r&&null!==(n=r.data)&&void 0!==n&&null!==(n=n.items)&&void 0!==n&&n.length){h=_(r.data.items);try{for(h.s();!(v=h.n()).done;)if((f=v.value).components){y=_(f.components);try{for(y.s();!(C=y.n()).done;)component=C.value,l.push({meta:component,id:component.artwork_no||f.id+"_"+component.index,taskId:f.id,index:component.index,url:component.url,width:component.width,height:component.height})}catch(t){y.e(t)}finally{y.f()}}}catch(t){h.e(t)}finally{h.f()}}if(!l.length){e.next=14;break}e.t0=l,e.next=17;break;case 14:return e.next=16,t.getMoreWaterfallList();case 16:e.t0=e.sent;case 17:return e.abrupt("return",e.t0);case 20:if(t.waterfallResForAccountList.has_more){e.next=22;break}return e.abrupt("return",[]);case 22:return t.waterfallParamsForAccountList.page++,w=m(m({},t.waterfallParamsForAccountList),{},{folder_no:t.folderNo,artwork_types:[1,3,4]}),e.next=26,Object(c.ab)(w);case 26:if(k=e.sent,t.waterfallResForAccountList.has_more=k.data.has_more,L=k.data.items.map((function(t){return{meta:t,id:t.id,url:t.cover.url,width:t.cover.width,height:t.cover.height}})),!L.length){e.next=33;break}e.t1=L,e.next=36;break;case 33:return e.next=35,t.getMoreWaterfallList();case 35:e.t1=e.sent;case 36:return e.abrupt("return",e.t1);case 37:case"end":return e.stop()}}),e)})))()},onConfirmSelectClick:function(){0!==this.thisTimeSelectedList.length&&this.$emit("confirmSelect",this.thisTimeSelectedList)}}},w=C,k=(n(4492),n(0)),L=Object(k.a)(w,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.localImageUploading,expression:"localImageUploading"}],staticClass:"selector-for-article"},[e("div",{staticClass:"folder-select"},[e("el-select",{staticClass:"folder-select",attrs:{"popper-class":"contribution-resource-selector-folder-list-popper"},model:{value:t.folderNo,callback:function(e){t.folderNo=e},expression:"folderNo"}},t._l(t.folderOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("div",{staticClass:"description"},[e("Icon",{attrs:{name:"explanation",color:"#777E91"}}),t._v(" "),e("div",{staticClass:"desc-text"},[t._v("\n      "+t._s(t.$t("nsfw_prompt_contribution_selector"))+"\n    ")])],1),t._v(" "),e("Waterfall",{ref:"waterfallRef",attrs:{getWaterfallListFn:t.getWaterfallList,getMoreWaterfallListFn:t.getMoreWaterfallList,selectedList:t.thisTimeSelectedList,isSingleSelect:!0},on:{"update:selectedList":function(e){t.thisTimeSelectedList=e},"update:selected-list":function(e){t.thisTimeSelectedList=e}},scopedSlots:t._u([t.allowLocalPost?{key:"waterfall-prefix-item",fn:function(){return[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.handleFileChange}}),t._v(" "),e("div",{staticClass:"local-upload-btn",on:{click:function(e){return t.$refs.fileInput.click()}}},[e("Icon",{attrs:{name:"upload-icon",size:"32",color:"#777E91"}})],1)]},proxy:!0}:null],null,!0)}),t._v(" "),e("div",{staticClass:"footer"},[e("div",{staticClass:"operation"},[e("div",{staticClass:"cancel-btn",on:{click:function(e){return t.$emit("closeSelector")}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"confirm-btn",class:{disabled:0===t.thisTimeSelectedList.length},on:{click:t.onConfirmSelectClick}},[t._v("\n        "+t._s(t.$t("Confirm"))+"\n      ")])])])],1)}),[],!1,null,"a2a34a0a",null);e.default=L.exports},3363:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=n(14),c=(n(20),n(19),n(22),n(1)),d=n(36);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"SelectorForCharacter",components:{Waterfall:n(408).default},props:{selectedList:{type:Array,default:function(){return[]}},linkActivity:{type:Object,default:function(){}}},emits:["closeSelector","confirmSelect"],created:function(){this.thisTimeSelectedList=Object(l.a)(this.selectedList||[]),this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_select_page",behavior_info_sub:"character"})},data:function(){return{thisTimeSelectedList:[],waterfallParams:{page:1,page_size:35},folderNo:0,folderOptions:[{value:0,label:this.$t("all_character")},{value:1,label:this.$t("createSetting1")},{value:2,label:this.$t("createSetting2")}],isWaterfallLoading:!1,waterfallList:[]}},computed:v({},Object(c.c)("user",["userInfo"])),watch:{folderNo:function(){this.$refs.waterfallRef.initWaterfallList()}},methods:{getWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page=1,o=v(v({},t.waterfallParams),{},{publish_status:t.folderNo,account_no:t.userInfo.id,theme_activity_type:t.linkActivity.activity_type,theme_activity_id:t.linkActivity.id}),t.isWaterfallLoading=!0,e.next=5,Object(d.squareCharacterList)(o);case 5:return r=e.sent,l=null===(n=r.data.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})),t.waterfallList=l,t.isWaterfallLoading=!1,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})))()},getMoreWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page++,o=v(v({},t.waterfallParams),{},{publish_status:t.folderNo,account_no:t.userInfo.id,theme_activity_type:t.linkActivity.activity_type,theme_activity_id:t.linkActivity.id}),t.isWaterfallLoading=!0,e.next=5,Object(d.squareCharacterList)(o);case 5:return r=e.sent,c=(null===(n=r.data.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})))||[],t.waterfallList=[].concat(Object(l.a)(t.waterfallList),Object(l.a)(c)),t.isWaterfallLoading=!1,e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))()},onConfirmSelectClick:function(){0!==this.thisTimeSelectedList.length&&this.$emit("confirmSelect",this.thisTimeSelectedList)},onGoToCreate:function(){this.$emit("closeSelector"),this.$router.push("/cyberPubPage/new-character")}}},m=(n(4493),n(0)),component=Object(m.a)(f,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{staticClass:"selector-for-character"},[l("div",{staticClass:"folder-select"},[l("el-select",{staticClass:"folder-select",attrs:{"popper-class":"contribution-resource-selector-folder-list-popper"},model:{value:r.folderNo,callback:function(t){r.folderNo=t},expression:"folderNo"}},r._l(r.folderOptions,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:0===(null===(t=r.linkActivity)||void 0===t?void 0:t.activity_type),expression:"linkActivity?.activity_type === 0"}],staticClass:"description"},[l("Icon",{attrs:{name:"explanation",color:"#777E91"}}),r._v(" "),l("div",{staticClass:"desc-text"},[r._v("\n      "+r._s(r.$t("Daily_Theme_Updload_D2",{num1:null===(e=r.linkActivity)||void 0===e?void 0:e.date,num2:r.$t("Tavern")}))+"\n    ")])],1),r._v(" "),l("div",{staticClass:"waterfall-wrapper"},[l("Waterfall",{directives:[{name:"show",rawName:"v-show",value:(null===(n=r.waterfallList)||void 0===n?void 0:n.length)||r.isWaterfallLoading,expression:"waterfallList?.length || isWaterfallLoading"}],ref:"waterfallRef",attrs:{getWaterfallListFn:r.getWaterfallList,getMoreWaterfallListFn:r.getMoreWaterfallList,selectedList:r.thisTimeSelectedList,isSingleSelect:!0},on:{"update:selectedList":function(t){r.thisTimeSelectedList=t},"update:selected-list":function(t){r.thisTimeSelectedList=t}}}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:!(null!==(o=r.waterfallList)&&void 0!==o&&o.length||r.isWaterfallLoading),expression:"!waterfallList?.length && !isWaterfallLoading"}],staticClass:"no-content"},[l("svg-icon",{staticClass:"no-content-icon",attrs:{"icon-class":"no-submission-data"}}),r._v(" "),l("div",{staticClass:"go-create-btn",on:{click:r.onGoToCreate}},[l("div",{staticClass:"go-create-btn-wrapper"},[l("div",{staticClass:"text-wrapper"},[r._v(r._s(r.$t("toCreate")))])])])],1)],1),r._v(" "),l("div",{staticClass:"footer"},[l("div",{staticClass:"operation"},[l("div",{staticClass:"cancel-btn",on:{click:function(t){return r.$emit("closeSelector")}}},[r._v(r._s(r.$t("Cancel")))]),r._v(" "),l("div",{staticClass:"confirm-btn",class:{disabled:0===r.thisTimeSelectedList.length},on:{click:r.onConfirmSelectClick}},[r._v("\n        "+r._s(r.$t("Confirm"))+"\n      ")])])])])}),[],!1,null,"561b18ec",null);e.default=component.exports;installComponents(component,{SvgIcon:n(115).default})},3364:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=n(14),c=(n(20),n(19),n(22),n(1)),d=n(56);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"SelectorForModelCheckpoint",components:{Waterfall:n(408).default},props:{selectedList:{type:Array,default:function(){return[]}},linkActivity:{type:Object,default:function(){}}},emits:["closeSelector","confirmSelect"],created:function(){this.thisTimeSelectedList=Object(l.a)(this.selectedList||[])},data:function(){return{thisTimeSelectedList:[],waterfallParams:{page:1,page_size:35},isWaterfallLoading:!1,waterfallList:[],createEntryList:[{icon:"shangchuan2",title:this.$t("UploadModels"),clickFn:function(){return window.open("/modelEditStep","_blank")},id:"upload_model_btn",logEventOperation:"upload_model_btn_click"},{icon:"kuaisudaoru",title:this.$t("quick_import_model"),clickFn:function(){return window.open("/modelImport","_blank")},id:"quick_import_model_btn",logEventOperation:"quick_import_model_btn_click"}]}},computed:v({},Object(c.c)("user",["userInfo"])),methods:{getWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page=1,o=v(v({},t.waterfallParams),{},{model_types:["Checkpoint"],refer:"Post",publish_status:1}),t.isWaterfallLoading=!0,e.next=5,Object(d.l)(o);case 5:return r=e.sent,l=null===(n=r.data)||void 0===n||null===(n=n.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})),t.waterfallList=l,t.isWaterfallLoading=!1,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})))()},getMoreWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page++,o=v(v({},t.waterfallParams),{},{model_types:["Checkpoint"],refer:"Post",publish_status:1}),t.isWaterfallLoading=!0,e.next=5,Object(d.l)(o);case 5:return r=e.sent,c=(null===(n=r.data)||void 0===n||null===(n=n.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})))||[],t.waterfallList=[].concat(Object(l.a)(t.waterfallList),Object(l.a)(c)),t.isWaterfallLoading=!1,e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))()},onConfirmSelectClick:function(){0!==this.thisTimeSelectedList.length&&this.$emit("confirmSelect",this.thisTimeSelectedList)}}},m=(n(4494),n(0)),component=Object(m.a)(f,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"selector-for-model-checkpoint"},[n("div",{staticClass:"waterfall-wrapper"},[n("Waterfall",{directives:[{name:"show",rawName:"v-show",value:(null===(t=e.waterfallList)||void 0===t?void 0:t.length)||e.isWaterfallLoading,expression:"waterfallList?.length || isWaterfallLoading"}],ref:"waterfallRef",attrs:{getWaterfallListFn:e.getWaterfallList,getMoreWaterfallListFn:e.getMoreWaterfallList,selectedList:e.thisTimeSelectedList,isSingleSelect:!0},on:{"update:selectedList":function(t){e.thisTimeSelectedList=t},"update:selected-list":function(t){e.thisTimeSelectedList=t}}})],1),e._v(" "),n("div",{staticClass:"create-entry"},[n("div",{staticClass:"entry-list"},e._l(e.createEntryList,(function(t){return n("div",{key:t.id,staticClass:"entry-item",attrs:{"data-id":t.id,"data-event":t.logEventOperation},on:{click:t.clickFn}},[n("Icon",{staticClass:"item-icon",attrs:{name:t.icon,size:"20",color:"#f4f4f4"}}),e._v(" "),n("div",{staticClass:"item-title"},[e._v(e._s(t.title))])],1)})),0)]),e._v(" "),n("div",{staticClass:"footer"},[n("div",{staticClass:"operation"},[n("div",{staticClass:"cancel-btn",on:{click:function(t){return e.$emit("closeSelector")}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),n("div",{staticClass:"confirm-btn",class:{disabled:0===e.thisTimeSelectedList.length},on:{click:e.onConfirmSelectClick}},[e._v("\n        "+e._s(e.$t("Confirm"))+"\n      ")])])])])}),[],!1,null,"f5dfc8d8",null);e.default=component.exports},3365:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=n(14),c=(n(20),n(19),n(22),n(1)),d=n(56);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"SelectorForModelLora",components:{Waterfall:n(408).default},props:{selectedList:{type:Array,default:function(){return[]}},linkActivity:{type:Object,default:function(){}}},emits:["closeSelector","confirmSelect"],created:function(){this.thisTimeSelectedList=Object(l.a)(this.selectedList||[])},data:function(){return{thisTimeSelectedList:[],waterfallParams:{page:1,page_size:35},isWaterfallLoading:!1,waterfallList:[],createEntryList:[{icon:"xunlianmoxing",title:this.$t("trainMode"),clickFn:function(){return window.open("/loraTrainingEdit?DSType=0","_blank")},id:"train_model_btn",logEventOperation:"train_model_btn_click"},{icon:"shangchuan2",title:this.$t("UploadModels"),clickFn:function(){return window.open("/modelEditStep","_blank")},id:"upload_model_btn",logEventOperation:"upload_model_btn_click"},{icon:"kuaisudaoru",title:this.$t("quick_import_model"),clickFn:function(){return window.open("/modelImport","_blank")},id:"quick_import_model_btn",logEventOperation:"quick_import_model_btn_click"}]}},computed:v({},Object(c.c)("user",["userInfo"])),methods:{getWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page=1,o=v(v({},t.waterfallParams),{},{model_types:["LORA"],refer:"Post",publish_status:1}),t.isWaterfallLoading=!0,e.next=5,Object(d.l)(o);case 5:return r=e.sent,l=null===(n=r.data)||void 0===n||null===(n=n.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})),t.waterfallList=l,t.isWaterfallLoading=!1,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})))()},getMoreWaterfallList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.waterfallParams.page++,o=v(v({},t.waterfallParams),{},{model_types:["LORA"],refer:"Post",publish_status:1}),t.isWaterfallLoading=!0,e.next=5,Object(d.l)(o);case 5:return r=e.sent,c=(null===(n=r.data)||void 0===n||null===(n=n.items)||void 0===n?void 0:n.map((function(t){return{meta:t,id:t.id,url:t.cover,width:t.cover_width||1,height:t.cover_height||1}})))||[],t.waterfallList=[].concat(Object(l.a)(t.waterfallList),Object(l.a)(c)),t.isWaterfallLoading=!1,e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})))()},onConfirmSelectClick:function(){0!==this.thisTimeSelectedList.length&&this.$emit("confirmSelect",this.thisTimeSelectedList)}}},m=(n(4495),n(0)),component=Object(m.a)(f,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"selector-for-model-lora"},[n("div",{staticClass:"waterfall-wrapper"},[n("Waterfall",{directives:[{name:"show",rawName:"v-show",value:(null===(t=e.waterfallList)||void 0===t?void 0:t.length)||e.isWaterfallLoading,expression:"waterfallList?.length || isWaterfallLoading"}],ref:"waterfallRef",attrs:{getWaterfallListFn:e.getWaterfallList,getMoreWaterfallListFn:e.getMoreWaterfallList,selectedList:e.thisTimeSelectedList,isSingleSelect:!0},on:{"update:selectedList":function(t){e.thisTimeSelectedList=t},"update:selected-list":function(t){e.thisTimeSelectedList=t}}})],1),e._v(" "),n("div",{staticClass:"create-entry"},[n("div",{staticClass:"entry-list"},e._l(e.createEntryList,(function(t){return n("div",{key:t.id,staticClass:"entry-item",attrs:{"data-id":t.id,"data-event":t.logEventOperation},on:{click:t.clickFn}},[n("Icon",{staticClass:"item-icon",attrs:{name:t.icon,size:"20",color:"#f4f4f4"}}),e._v(" "),n("div",{staticClass:"item-title"},[e._v(e._s(t.title))])],1)})),0)]),e._v(" "),n("div",{staticClass:"footer"},[n("div",{staticClass:"operation"},[n("div",{staticClass:"cancel-btn",on:{click:function(t){return e.$emit("closeSelector")}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),n("div",{staticClass:"confirm-btn",class:{disabled:0===e.thisTimeSelectedList.length},on:{click:e.onConfirmSelectClick}},[e._v("\n        "+e._s(e.$t("Confirm"))+"\n      ")])])])])}),[],!1,null,"d6fd597a",null);e.default=component.exports},3366:function(t,e,n){"use strict";n.r(e);n(16);var o=n(2),r=n(14),l=(n(19),n(6),n(11),n(32),n(69),n(22),n(31),n(18),n(8),n(4),n(12),n(13),n(218),n(21),n(40),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(7),n(41),n(1)),c=n(71),d=n(81),h=n(27),v=n(299),f=n(10),m=n(364),_=n(3367),y=n(54),C=n(164);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={name:"PublishWork",components:{ActivitySelector:m.default,ImageList:_.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedList:{type:Array,default:function(){return[]}},remoteParams:{type:Object,default:function(){}}},emits:["update:visible","reselectData","selectedDataChange"],created:function(){this.initWorkForm(),this.initLinkTags(),this.initActivities(),this.initMaxSelectCount(),this.initLogEvent(),this.checkNSFW()},mounted:function(){Object(f.J)(300)},destroyed:function(){Object(f.V)()},data:function(){return{maxSelectCount:20,isPublishLoading:!1,isCheckNSFWLoading:!1,isInitFormLoading:!1,workForm:{title:"",intro:"",tags:[],activity_type:void 0,activity_id:""},isLinkTagsLoading:!1,linkTagsOptions:[],isActivitiesLoading:!1,activitiesOptions:[],aiTextLoading:!1,aiCacheTitle:"",aiCacheIntro:"",formItemHighlightErrorBorder:{title:!1,intro:!1,tags:!1}}},computed:{canPublish:function(){return this.selectedList.length>0&&!this.isCheckNSFWLoading},workFormRules:function(){var t;return{tags:null!==(t=this.workForm)&&void 0!==t&&t.activity_id?[{required:!1}]:[{required:!0,message:this.$t("TagsAssociationTips"),trigger:"change"}]}},selectedListIncludeTypes:function(){var t=new Set;return this.selectedList.forEach((function(e){return t.add(Object(C.isImageOrVideo)(e.url))})),Array.from(t)},defaultTagList:function(){var t,e,n,o=this,l=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&l.push.apply(l,Object(r.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var c=this.activitiesOptions.find((function(t){return t.value===o.workForm.activity_id}));return null!=c&&null!==(e=c.tag_list)&&void 0!==e&&e.length?l.push.apply(l,Object(r.a)(c.tag_list)):null!=c&&c.tag&&l.push(c.tag),l}},watch:{selectedList:{handler:function(t,e){this.initMaxSelectCount(),Object(C.checkExistNewItem)(t,e,"url")&&this.checkNSFW()}}},methods:k(k({},Object(l.b)("user",["getAccountInfo"])),{},{initWorkForm:function(){var t=this;this.remoteParams.id?(this.isInitFormLoading=!0,Object(h.pb)({id:this.remoteParams.id}).then((function(e){var n=e.data.list,o=e.data.portfolio,r=o.name,l=o.tag,c=o.intro;t.workForm.title=r,t.workForm.intro=c,t.workForm.tags=(null==l?void 0:l.map((function(t){return t.id||t.title})))||[],t.$emit("selectedDataChange",(null==n?void 0:n.map((function(t){var e,n,o;return{url:null==t||null===(e=t.banner)||void 0===e?void 0:e.url,width:null==t||null===(n=t.banner)||void 0===n?void 0:n.width,height:null==t||null===(o=t.banner)||void 0===o?void 0:o.height}})))||[])})).finally((function(){t.isInitFormLoading=!1}))):Object.keys(this.remoteParams).length&&(this.workForm=k(k({},this.workForm),{},{tags:this.remoteParams.tags||[]}))},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(c.d)({show_area:"post"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(v.a)(e,t.$i18n.locale),type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.workForm.activity_type=this.linkActivity.activity_type,this.workForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list,activity_type:this.linkActivity.activity_type}]):(this.isActivitiesLoading=!0,Object(d.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n,o=(null===(n=e.data.items)||void 0===n?void 0:n.filter((function(t){return t.participation_type_limits.includes(y.CONTRIBUTION_TYPE_ENUM.WORK)})))||[],l=o.filter((function(t){var e,n;return!(null!=t&&t.post_sub_type)||0===(null==t||null===(e=t.post_sub_type)||void 0===e?void 0:e.length)||2===(null==t||null===(n=t.post_sub_type)||void 0===n?void 0:n.length)})),c=o.filter((function(t){var e,n;return 1===(null==t||null===(e=t.post_sub_type)||void 0===e?void 0:e.length)&&1===(null==t||null===(n=t.post_sub_type)||void 0===n?void 0:n[0])})),d=o.filter((function(t){var e,n;return 1===(null==t||null===(e=t.post_sub_type)||void 0===e?void 0:e.length)&&2===(null==t||null===(n=t.post_sub_type)||void 0===n?void 0:n[0])})),h=[].concat(Object(r.a)(l),Object(r.a)(c),Object(r.a)(d)).map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list,activity_type:t.activity_type,post_sub_type:t.post_sub_type}}))||[];t.activitiesOptions=h})).finally((function(){t.isActivitiesLoading=!1})))},initMaxSelectCount:function(){this.selectedList.length>this.maxSelectCount&&this.handleImageListChange(this.selectedList.slice(0,this.maxSelectCount))},initLogEvent:function(){var t=this;this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_publish_page",behavior_info_sub:"gallery"});var e=this.$watch("workForm.activity_id",(function(){t.$logEvent("log_actions",{operation:"click_add_activity",behavior_info:"on_post_page_publish_page",behavior_info_sub:"gallery"}),e()}))},checkNSFW:function(){var t,e=this;null!==(t=this.selectedList)&&void 0!==t&&t.length&&(this.isCheckNSFWLoading=!0,Object(d.g)({content_list:this.selectedList.map((function(t){var e;return null!=t&&t.taskId?{type:3,task_info:{index:t.index,task_id:t.taskId}}:null!=t&&null!==(e=t.meta)&&void 0!==e&&e.id?{type:1,artwork_id:t.meta.id}:null!=t&&t.url?{type:2,url:t.url}:void 0}))}).then((function(t){var n,o=((null===(n=t.data)||void 0===n||null===(n=n.check_res)||void 0===n?void 0:n.map((function(t){return t.is_nsfw_limit})))||[]).map((function(t,e){return t?e:-1})).filter((function(t){return-1!==t}));if(o.length){var r=e.selectedList.filter((function(t,e){return!o.includes(e)}));e.handleImageListChange(r),r.length?e.$message.error(e.$t("nsfw_prompt_upload_media_partial_failure"),{duration:5e3}):e.$message.error(e.$t("nsfw_prompt_upload_media_failure"),{duration:5e3})}})).finally((function(){e.isCheckNSFWLoading=!1})))},onAutoGenerateClick:function(){var t=this;if(this.aiCacheTitle&&this.aiCacheIntro)return this.workForm.title=this.aiCacheTitle,void(this.workForm.intro=this.aiCacheIntro);var e=this.selectedList[0].url;this.aiTextLoading=!0,Object(d.f)({uri:e}).then((function(e){var n=null==e?void 0:e.data,title=n.title,o=n.intro;t.workForm.title=title,t.workForm.intro=o,t.aiCacheTitle=title,t.aiCacheIntro=o})).finally((function(){t.aiTextLoading=!1}))},onActivitySelectChange:function(t){var e;if(!t)return this.workForm.activity_id="",void(this.workForm.activity_type=void 0);var n,o=null===(e=this.activitiesOptions.find((function(e){return e.value===t})))||void 0===e||null===(e=e.post_sub_type)||void 0===e?void 0:e.map((function(t){return{1:"image",2:"video"}[t]}));this.selectedListIncludeTypes.every((function(t){return o.includes(t)}))?(this.workForm.activity_id=t,this.workForm.activity_type=null===(n=this.activitiesOptions.find((function(e){return e.value===t})))||void 0===n?void 0:n.activity_type):("image"===(null==o?void 0:o[0])&&this.$message.warning(this.$t("activity_only_support_image")),"video"===(null==o?void 0:o[0])&&this.$message.warning(this.$t("activity_only_support_video")))},clearFormItemHighlightErrorBorder:function(t){var e=this;t?this.formItemHighlightErrorBorder[t]=!1:Object.keys(this.formItemHighlightErrorBorder).forEach((function(t){return e.formItemHighlightErrorBorder[t]=!1}))},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPublishClick:function(){var t=this;this.canPublish&&this.$refs.workFormRef.validate((function(e){if(e){var o=n(160),l=k(k({},t.remoteParams.id?{id:t.remoteParams.id}:{}),{},{source:t.source?t.source:void 0,activity_type:t.workForm.activity_type,activity_id:t.workForm.activity_id||void 0,theme_activity_date:0===t.linkActivity.activity_type?t.linkActivity.date:void 0,title:t.workForm.title,intro:t.workForm.intro,tags:t.workForm.tags.map((function(e){return t.linkTagsOptions.map((function(option){return option.value})).includes(e)?{id:e}:{title:e}})),content_list:t.remoteParams.id?void 0:Object(r.a)(t.selectedList.map((function(t){var e;return null!=t&&t.taskId?{type:3,task_info:{index:t.index,task_id:t.taskId}}:null!=t&&null!==(e=t.meta)&&void 0!==e&&e.id?{type:1,artwork_id:t.meta.id}:null!=t&&t.url?{type:2,upload_image:{uri:t.url,width:t.width,height:t.height}}:void 0})))}),c=t.remoteParams.id?d.q:d.e;t.isPublishLoading=!0,c(l).then((function(e){var n,r,l;1e4===e.status.code?(t.$logEvent("log_actions",{operation:"publish_success",behavior_info:"on_post_page_publish_page",behavior_info_sub:"gallery"}),t.getAccountInfo(),t.closePublish(),Object(C.alertPostSuccess)(t,{isDailyFirst:null===(n=e.data)||void 0===n?void 0:n.is_daily_first,jumpUrl:"/artWorkDetail/".concat((null===(r=e.data)||void 0===r?void 0:r.id)||t.remoteParams.id),imgSrc:null===(l=t.selectedList)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.url,staminaImgSrc:o})):40335===e.status.code?t.$message.error(t.$t("already_not_edit")):40017===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.title=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Title")}))):40018===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.intro=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Desc")}))):40311===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.tags=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("TagsAssociation")}))):t.$message.error(e.status.msg)})).catch((function(){t.$message.error(t.$t("PostFailed"))})).finally((function(){t.isPublishLoading=!1}))}}))},onReselectClick:function(){!this.linkActivity.id&&this.workForm.activity_id&&(this.workForm.activity_id="",this.workForm.activity_type=void 0),this.$emit("reselectData",this.selectedList)},handleImageListChange:function(t){this.$emit("selectedDataChange",t)}})},O=(n(4500),n(0)),component=Object(O.a)(L,(function(){var t=this,e=t._self._c;return e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.isPublishLoading||t.isInitFormLoading,expression:"isPublishLoading || isInitFormLoading"}],staticClass:"publish-work",attrs:{visible:t.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"section-header"},[e("div",{staticClass:"title"},[t._v(t._s(t.remoteParams.id?t.$t("edit_work"):t.$t("post_my_work")))])]),t._v(" "),e("div",{staticClass:"section-content"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isCheckNSFWLoading,expression:"isCheckNSFWLoading"}],staticClass:"image-list-container"},[e("ImageList",{attrs:{imageList:t.selectedList,isDisabledMove:!!t.remoteParams.id,isDisabledDelete:!!t.remoteParams.id},on:{imageListChange:t.handleImageListChange}},[t.selectedList.length<t.maxSelectCount&&!t.remoteParams.id?e("div",{staticClass:"reselect-btn",attrs:{"data-event":"contribution_work_publish_reselect_btn"},on:{click:t.onReselectClick}},[e("Icon",{attrs:{name:"add-icon",size:"24",color:"#51575f"}})],1):t._e()])],1),t._v(" "),e("div",{staticClass:"form-container"},[e("el-form",{ref:"workFormRef",attrs:{model:t.workForm,rules:t.workFormRules}},[e("el-form-item",{attrs:{label:t.$t("Title"),prop:"title"}},[e("el-input",{class:{"highlight-error-border":t.formItemHighlightErrorBorder.title},attrs:{maxlength:"80","show-word-limit":"",placeholder:t.$t("postFormTitleTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("title")}},model:{value:t.workForm.title,callback:function(e){t.$set(t.workForm,"title",e)},expression:"workForm.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Desc"),prop:"intro"}},[e("el-input",{staticClass:"desc-textarea",class:{"highlight-error-border":t.formItemHighlightErrorBorder.intro},attrs:{type:"textarea",maxlength:"2500","show-word-limit":"",placeholder:t.$t("postFormDescTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("intro")}},model:{value:t.workForm.intro,callback:function(e){t.$set(t.workForm,"intro",e)},expression:"workForm.intro"}}),t._v(" "),e("ActivitySelector",{attrs:{activityId:t.workForm.activity_id,activitiesOptions:t.activitiesOptions,isLoading:t.isActivitiesLoading,disabled:!!t.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_work_publish_activity_select",dataEventForOption:"contribution_work_publish_activity_option"}},on:{change:t.onActivitySelectChange}})],1),t._v(" "),e("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:t.isLinkTagsLoading,expression:"isLinkTagsLoading"}],attrs:{label:t.$t("TagsAssociation"),prop:"tags"}},[e("el-select",{class:{"highlight-error-border":t.formItemHighlightErrorBorder.tags},attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,"allow-create":"",filterable:"","default-first-option":"",placeholder:t.$t("TagsAssociationTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("tags")},"remove-tag":function(e){return t.clearFormItemHighlightErrorBorder("tags")}},model:{value:t.workForm.tags,callback:function(e){t.$set(t.workForm,"tags",e)},expression:"workForm.tags"}},t._l(t.linkTagsOptions,(function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value,disabled:n.disabled}},[e("span",[t._v(t._s(n.label))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:[1,"1"].includes(null==n?void 0:n.type),expression:"[1, '1'].includes(item?.type)"}],staticClass:"label-flag"},[t._v(t._s(t.$t("official")))])])})),1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.workForm.activity_id,expression:"workForm.activity_id"}],staticClass:"link-tags-description"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("Required_Tags")))]),t._v(" "),t._l(t.defaultTagList,(function(n){return e("div",{key:n,staticClass:"default-tag"},[t._v("# "+t._s(n))])}))],2)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.selectedList.length&&!t.remoteParams.id,expression:"selectedList.length && !remoteParams.id"},{name:"loading",rawName:"v-loading",value:t.aiTextLoading,expression:"aiTextLoading"}],staticClass:"auto-generate-btn",on:{click:t.onAutoGenerateClick}},[t._v("\n          "+t._s(t.$t("autoGenerate"))+"\n        ")])],1)],1)]),t._v(" "),e("div",{staticClass:"section-footer"},[t.remoteParams.id?e("div",{staticClass:"description"},[t._v("\n      "+t._s(t.$t("every_contribution_edit_num",{num:2}))+"\n    ")]):t.workForm.activity_id?e("div",{staticClass:"description"},[t._v("\n      "+t._s(t.$t("good_post"))+"\n    ")]):t._e(),t._v(" "),e("div",{staticClass:"operation-wrapper"},[e("div",{staticClass:"selected-info"},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.remoteParams.id,expression:"!remoteParams.id"}]},[t._v("\n          "+t._s(t.$t("newGenerate11",{number:t.selectedList.length+"/"+t.maxSelectCount}))+"\n        ")])]),t._v(" "),e("div",{staticClass:"operation"},[e("div",{staticClass:"cancel-btn",on:{click:t.onCancelClick}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"confirm-btn",class:{disabled:!t.canPublish},attrs:{title:0===t.selectedList.length?t.$t("selectingMaterialsType1"):"","data-event":"contribution_work_publish_confirm_btn"},on:{click:t.onPublishClick}},[t._v("\n          "+t._s(t.remoteParams.id?t.$t("Save"):t.$t("post_v"))+"\n        ")])])])])])}),[],!1,null,"367331f8",null);e.default=component.exports},3367:function(t,e,n){"use strict";n.r(e);var o=n(14),r=(n(49),n(277)),l=n.n(r),c=n(164),d={name:"ImageList",components:{draggable:l.a},props:{imageList:{type:Array,default:function(){return[]}},isDisabledMove:{type:Boolean,default:!1},isDisabledDelete:{type:Boolean,default:!1}},created:function(){this.currentImageList=Object(o.a)(this.imageList||[])},data:function(){return{currentImageList:[]}},computed:{isImageOrVideo:function(){return function(t){return Object(c.isImageOrVideo)(t)}}},watch:{imageList:{handler:function(t){this.currentImageList=Object(o.a)(t)}}},methods:{handleDelete:function(t){this.currentImageList.splice(t,1),this.$emit("imageListChange",this.currentImageList)},handleDragChange:function(){this.$emit("imageListChange",this.currentImageList)}}},h=(n(4499),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-list"},[e("draggable",{staticClass:"image-grid",attrs:{move:function(){return!t.isDisabledMove}},on:{change:t.handleDragChange},model:{value:t.currentImageList,callback:function(e){t.currentImageList=e},expression:"currentImageList"}},[t._l(t.currentImageList,(function(n,o){return e("div",{key:n.id,staticClass:"image-item"},[e("img",{directives:[{name:"show",rawName:"v-show",value:"image"===t.isImageOrVideo(n.url),expression:"isImageOrVideo(item.url) === 'image'"}],staticClass:"image-item-img",attrs:{src:n.url,alt:"image"}}),t._v(" "),e("video",{directives:[{name:"show",rawName:"v-show",value:"video"===t.isImageOrVideo(n.url),expression:"isImageOrVideo(item.url) === 'video'"}],staticClass:"image-item-img",attrs:{src:n.url,autoplay:"autoplay",loop:"loop",muted:"muted"},domProps:{muted:!0}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabledDelete,expression:"!isDisabledDelete"}],staticClass:"close-btn",on:{click:function(e){return t.handleDelete(o)}}},[e("Icon",{attrs:{name:"close",size:"8",color:"#fff"}})],1)])})),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.$slots.default,expression:"$slots['default']"}],staticClass:"image-item"},[e("div",{staticClass:"image-item-img"},[t._t("default")],2)])],2)],1)}),[],!1,null,"deb993c8",null);e.default=component.exports},3368:function(t,e,n){"use strict";n.r(e);n(16);var o=n(3131),r=n(3),l=n(2),c=n(14),d=(n(20),n(6),n(11),n(32),n(22),n(18),n(8),n(12),n(13),n(4),n(21),n(40),n(7),n(41),n(141),n(142),n(109),n(1)),h=n(71),v=n(81),f=n(27),m=n(299),_=n(51),y=n(61),C=n(10),w=n(364),k=n(54),L=n(164),O=n(3132),$=n(3133);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P={name:"PublishLocalVideo",components:{ActivitySelector:w.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedFile:{},remoteParams:{type:Object,default:function(){}}},emits:["update:visible"],mixins:[O.uploadVideoMixIn,$.videoCoverMixIn],created:function(){this.clearVideoInfo(),this.updateVideoFile(this.selectedFile),this.initLocalVideoForm(),this.initLinkTags(),this.initActivities(),this.initLogEvent()},mounted:function(){Object(C.J)(300)},destroyed:function(){Object(C.V)()},data:function(){return{formData:{cover:"",video:"",cover_height:0,cover_width:0,duration:0,url:""},currentVideoFile:null,isPublishLoading:!1,isCheckNSFWLoading:!1,isInitFormLoading:!1,localVideoForm:{title:"",intro:"",tags:[],video_url:"",duration:0,cover_url:"",cover_width:0,cover_height:0,activity_id:""},isLinkTagsLoading:!1,linkTagsOptions:[],coverUploading:!1,isActivitiesLoading:!1,activitiesOptions:[],aiTextLoading:!1,aiCacheTitle:"",aiCacheIntro:"",formItemHighlightErrorBorder:{title:!1,intro:!1,tags:!1}}},computed:{canPublish:function(){return this.localVideoForm.video_url&&this.localVideoForm.cover_url&&!this.coverUploading&&!this.isCheckNSFWLoading},localVideoFormRules:function(){var t;return{tags:null!==(t=this.localVideoForm)&&void 0!==t&&t.activity_id?[{required:!1}]:[{required:!0,message:this.$t("TagsAssociationTips"),trigger:"change"}]}},disabledUploadCover:function(){return["pending"].includes(this.uploadingStatus)||this.coverUploading},defaultTagList:function(){var t,e,n,o=this,r=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&r.push.apply(r,Object(c.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var l=this.activitiesOptions.find((function(t){return t.value===o.localVideoForm.activity_id}));return null!=l&&null!==(e=l.tag_list)&&void 0!==e&&e.length?r.push.apply(r,Object(c.a)(l.tag_list)):null!=l&&l.tag&&r.push(l.tag),r}},watch:{uploadingStatus:{handler:function(t){"complete"===t&&(this.localVideoForm.video_url=this.formData.url,this.currentVideoFile&&this.generateThumbnail(this.currentVideoFile))}},"localVideoForm.cover_url":{handler:function(t){t&&this.checkNSFW()}}},methods:x(x({},Object(d.b)("user",["getAccountInfo"])),{},{clearVideoInfo:function(){this.localVideoForm=x(x({},this.localVideoForm),{},{video_url:"",duration:0,cover_url:"",cover_width:0,cover_height:0})},initLocalVideoForm:function(){var t=this;this.remoteParams.id?(this.isInitFormLoading=!0,Object(f.pb)({id:this.remoteParams.id}).then((function(e){var n=e.data.portfolio,o=n.name,r=n.intro,l=n.tag,c=n.cover,d=n.stream,h=c||{},v=h.width,f=h.height,m=h.url,_=d||{},y=_.duration,C=_.url,w=_.url2,k=_.url3;t.localVideoForm.title=o,t.localVideoForm.intro=r,t.localVideoForm.tags=(null==l?void 0:l.map((function(t){return t.id||t.title})))||[],t.localVideoForm.video_url=C||w||k,t.localVideoForm.duration=y,t.localVideoForm.cover_url=m,t.localVideoForm.cover_width=v,t.localVideoForm.cover_height=f})).finally((function(){t.isInitFormLoading=!1}))):Object.keys(this.remoteParams).length?this.localVideoForm=x(x({},this.localVideoForm),{},{tags:this.remoteParams.tags||[],video_url:this.remoteParams.url,duration:this.remoteParams.duration,cover_url:this.remoteParams.cover,cover_width:this.remoteParams.cover_width,cover_height:this.remoteParams.cover_height}):this.clearVideoInfo()},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(h.d)({show_area:"post"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(m.a)(e,t.$i18n.locale),type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.localVideoForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list}]):(this.isActivitiesLoading=!0,Object(v.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n;t.activitiesOptions=(null===(n=e.data.items)||void 0===n||null===(n=n.filter((function(t){return t.participation_type_limits.includes(k.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO)})))||void 0===n?void 0:n.map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list}})))||[]})).finally((function(){t.isActivitiesLoading=!1})))},initLogEvent:function(){var t=this;this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_publish_page",behavior_info_sub:"video"});var e=this.$watch("localVideoForm.activity_id",(function(){t.$logEvent("log_actions",{operation:"click_add_activity",behavior_info:"on_post_page_publish_page",behavior_info_sub:"video"}),e()}))},checkNSFW:function(){var t=this;this.localVideoForm.cover_url&&(this.isCheckNSFWLoading=!0,Object(v.g)({content_list:[{type:4,url:this.localVideoForm.cover_url}]}).then((function(e){var n;(null===(n=e.data)||void 0===n||null===(n=n.check_res)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.is_nsfw_limit)&&(t.clearVideoInfo(),t.$message.error(t.$t("nsfw_prompt_upload_media_failure"),{duration:5e3}))})).finally((function(){t.isCheckNSFWLoading=!1})))},onAutoGenerateClick:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aiCacheTitle||!t.aiCacheIntro){e.next=4;break}return t.localVideoForm.title=t.aiCacheTitle,t.localVideoForm.intro=t.aiCacheIntro,e.abrupt("return");case 4:n=t.localVideoForm.cover_url,t.aiTextLoading=!0,Object(v.f)({uri:n}).then((function(e){var n=null==e?void 0:e.data,title=n.title,o=n.intro;t.localVideoForm.title=title,t.localVideoForm.intro=o,t.aiCacheTitle=title,t.aiCacheIntro=o})).finally((function(){t.aiTextLoading=!1}));case 7:case"end":return e.stop()}}),e)})))()},onActivitySelectChange:function(t){this.localVideoForm.activity_id=t},updateVideoFile:function(t){t&&t instanceof File&&(this.clearVideoInfo(),this.beforeUpload(t),this.currentVideoFile=t)},generateThumbnail:function(t){var e=this,n=URL.createObjectURL(t);this.getBestPoster(n,30).then((function(t){e.uploadMaskImage(null==t?void 0:t.posterUrl),e.localVideoForm.duration=Math.floor((null==t?void 0:t.duration)||0)})).catch((function(t){console.log(t)})).finally((function(){URL.revokeObjectURL(n)}))},handleVideoFileChange:function(t){var e=t.target.files[0];if(-1!==["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/quicktime"].indexOf(e.type)){e.size>1073741824?this.$message.warning(this.$t("CreativeCenterPopup12",{number:1})):(this.updateVideoFile(e),t.target.value="")}else this.$message.warning(this.$t("OnlySupportVideo"))},handleCoverFileChange:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.target.files[0],l=["image/jpeg","image/png","image/jpg","image/webp"],!e.coverUploading){n.next=4;break}return n.abrupt("return");case 4:if(l.includes(r.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return");case 7:if(!r||r.size){n.next=9;break}return n.abrupt("return");case 9:if(!(r.size/1024/1024>5)){n.next=20;break}return n.prev=10,n.next=13,Object(y.a)(r,5242880);case 13:Object(o.a)("file"),n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(10),console.error("Compression failed:",n.t0),n.abrupt("return");case 20:e.coverUploading=!0,new _.a({type:2}).startUpload(r).then((function(t){e.localVideoForm.cover_url=t})).catch((function(t){30005===t.code&&e.clearVideoInfo()})).finally((function(){e.coverUploading=!1})),t.target.value="";case 23:case"end":return n.stop()}}),n,null,[[10,16]])})))()},uploadMaskImage:function(t){var e=this,n=Object(C.h)(t);this.coverUploading=!0,new _.a({type:2}).startUpload(n,{name:"videoPost".concat(Date.now(),".png"),type:"png"}).then((function(t){e.localVideoForm.cover_url=t})).catch((function(t){30005===t.code&&e.clearVideoInfo()})).finally((function(){e.coverUploading=!1}))},handleImageLoad:function(t){this.localVideoForm.cover_width=t.target.naturalWidth,this.localVideoForm.cover_height=t.target.naturalHeight},clearFormItemHighlightErrorBorder:function(t){var e=this;t?this.formItemHighlightErrorBorder[t]=!1:Object.keys(this.formItemHighlightErrorBorder).forEach((function(t){return e.formItemHighlightErrorBorder[t]=!1}))},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPublishClick:function(){var t=this;this.canPublish&&this.$refs.localVideoFormRef.validate(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(o){var r,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o&&(r=n(160),l=x(x({},t.remoteParams.id?{id:t.remoteParams.id}:{}),{},{source:t.source?t.source:void 0,activity_type:t.localVideoForm.activity_id?1:void 0,activity_id:t.localVideoForm.activity_id||void 0,title:t.localVideoForm.title,intro:t.localVideoForm.intro,tags:t.localVideoForm.tags.map((function(e){return t.linkTagsOptions.map((function(option){return option.value})).includes(e)?{id:e}:{title:e}}))},t.remoteParams.id?{}:{video_url:t.localVideoForm.video_url,duration:t.localVideoForm.duration,cover_url:t.localVideoForm.cover_url,cover_width:t.localVideoForm.cover_width,cover_height:t.localVideoForm.cover_height}),c=t.remoteParams.id?v.p:v.d,t.isPublishLoading=!0,c(l).then((function(e){var n,o;1e4===e.status.code?(t.$logEvent("log_actions",{operation:"publish_success",behavior_info:"on_post_page_publish_page",behavior_info_sub:"video"}),t.getAccountInfo(),t.closePublish(),Object(L.alertPostSuccess)(t,{isDailyFirst:null===(n=e.data)||void 0===n?void 0:n.is_daily_first,jumpUrl:"/artWorkDetail/".concat((null===(o=e.data)||void 0===o?void 0:o.id)||t.remoteParams.id),imgSrc:t.localVideoForm.cover_url,staminaImgSrc:r})):40335===e.status.code?t.$message.error(t.$t("already_not_edit")):40017===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.title=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Title")}))):40018===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.intro=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Desc")}))):40311===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.tags=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("TagsAssociation")}))):t.$message.error(e.status.msg)})).catch((function(){t.$message.error(t.$t("PostFailed"))})).finally((function(){t.isPublishLoading=!1})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})},I=P,j=(n(4501),n(0)),component=Object(j.a)(I,(function(){var t=this,e=t._self._c;return e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.isPublishLoading||t.isInitFormLoading,expression:"isPublishLoading || isInitFormLoading"}],staticClass:"publish-local-video",attrs:{visible:t.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"section-header"},[e("div",{staticClass:"title"},[t._v(t._s(t.remoteParams.id?t.$t("edit_local_video"):t.$t("post_local_video")))])]),t._v(" "),e("div",{staticClass:"section-content"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:["pending"].includes(t.uploadingStatus),expression:"['pending'].includes(uploadingStatus)"}],staticClass:"video-container"},[e("input",{ref:"videoFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"video/*"},on:{change:t.handleVideoFileChange}}),t._v(" "),t.localVideoForm.video_url?e("video",{ref:"videoPlayer",staticClass:"video-preview",attrs:{src:t.localVideoForm.video_url,controlslist:"nofullscreen nodownload noremoteplayback noplaybackrate",controls:"",disablepictureinpicture:""}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.localVideoForm.video_url&&!["pending"].includes(t.uploadingStatus)&&!t.remoteParams.id,expression:"!localVideoForm.video_url && !['pending'].includes(uploadingStatus) && !remoteParams.id"}],staticClass:"empty-tips"},[e("div",[e("span",{staticClass:"el-icon-warning"})]),t._v(" "),e("div",[t._v(t._s(t.$t("uploadError")))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!["pending"].includes(t.uploadingStatus)&&!t.remoteParams.id,expression:"!['pending'].includes(uploadingStatus) && !remoteParams.id"}],staticClass:"hover-btn reselect-btn",style:{opacity:t.localVideoForm.video_url?void 0:1},on:{click:function(e){return t.$refs.videoFileInput.click()}}},[t._v("\n        "+t._s(t.$t("reselect"))+"\n      ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:["pending"].includes(t.uploadingStatus)&&!t.remoteParams.id,expression:"['pending'].includes(uploadingStatus) && !remoteParams.id"}],staticClass:"hover-btn cancel-upload-btn",on:{click:function(e){return e.stopPropagation(),t.clear.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("CreativeCenterPopup29"))+"\n      ")])]),t._v(" "),e("div",{staticClass:"form-container"},[e("el-form",{ref:"localVideoFormRef",attrs:{model:t.localVideoForm,rules:t.localVideoFormRules}},[e("el-form-item",{attrs:{label:t.$t("CoverImg"),prop:"cover_url"}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.coverUploading||t.isCheckNSFWLoading,expression:"coverUploading || isCheckNSFWLoading"}],staticClass:"cover-img-container"},[e("div",{staticClass:"cover-preview-wrapper"},[t.localVideoForm.cover_url?e("img",{staticClass:"cover-preview",attrs:{src:t.localVideoForm.cover_url,alt:""},on:{load:function(e){return t.handleImageLoad(e)}}}):t._e()]),t._v(" "),e("div",{staticClass:"desc"},[t._v("\n              "+t._s(t.$t("CreativeCenterPopup27"))+"\n            ")]),t._v(" "),e("input",{ref:"coverFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.handleCoverFileChange}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.remoteParams.id,expression:"!remoteParams.id"}],staticClass:"upload-cover-btn",class:t.disabledUploadCover?"disabled":"",on:{click:function(e){!t.disabledUploadCover&&t.$refs.coverFileInput.click()}}},[e("Icon",{attrs:{name:"upload-icon",size:"20",color:"#777E91"}})],1)])]),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Title"),prop:"title"}},[e("el-input",{class:{"highlight-error-border":t.formItemHighlightErrorBorder.title},attrs:{maxlength:"80","show-word-limit":"",placeholder:t.$t("postFormTitleTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("title")}},model:{value:t.localVideoForm.title,callback:function(e){t.$set(t.localVideoForm,"title",e)},expression:"localVideoForm.title"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Desc"),prop:"intro"}},[e("el-input",{staticClass:"desc-textarea",class:{"highlight-error-border":t.formItemHighlightErrorBorder.intro},attrs:{type:"textarea",maxlength:"2500","show-word-limit":"",placeholder:t.$t("postFormDescTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("intro")}},model:{value:t.localVideoForm.intro,callback:function(e){t.$set(t.localVideoForm,"intro",e)},expression:"localVideoForm.intro"}}),t._v(" "),e("ActivitySelector",{attrs:{activityId:t.localVideoForm.activity_id,activitiesOptions:t.activitiesOptions,isLoading:t.isActivitiesLoading,disabled:!!t.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_local_video_publish_activity_select",dataEventForOption:"contribution_local_video_publish_activity_option"}},on:{change:t.onActivitySelectChange}})],1),t._v(" "),e("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:t.isLinkTagsLoading,expression:"isLinkTagsLoading"}],attrs:{label:t.$t("TagsAssociation"),prop:"tags"}},[e("el-select",{class:{"highlight-error-border":t.formItemHighlightErrorBorder.tags},attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,"allow-create":"",filterable:"","default-first-option":"",placeholder:t.$t("TagsAssociationTips")},on:{focus:function(e){return t.clearFormItemHighlightErrorBorder("tags")},"remove-tag":function(e){return t.clearFormItemHighlightErrorBorder("tags")}},model:{value:t.localVideoForm.tags,callback:function(e){t.$set(t.localVideoForm,"tags",e)},expression:"localVideoForm.tags"}},t._l(t.linkTagsOptions,(function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value,disabled:n.disabled}},[e("span",[t._v(t._s(n.label))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:[1,"1"].includes(null==n?void 0:n.type),expression:"[1, '1'].includes(item?.type)"}],staticClass:"label-flag"},[t._v(t._s(t.$t("official")))])])})),1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.localVideoForm.activity_id,expression:"localVideoForm.activity_id"}],staticClass:"link-tags-description"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("Required_Tags")))]),t._v(" "),t._l(t.defaultTagList,(function(n){return e("div",{key:n,staticClass:"default-tag"},[t._v("# "+t._s(n))])}))],2)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.localVideoForm.cover_url&&!t.remoteParams.id,expression:"localVideoForm.cover_url && !remoteParams.id"},{name:"loading",rawName:"v-loading",value:t.aiTextLoading,expression:"aiTextLoading"}],staticClass:"auto-generate-btn",on:{click:t.onAutoGenerateClick}},[t._v("\n          "+t._s(t.$t("autoGenerate"))+"\n        ")])],1)],1)]),t._v(" "),e("div",{staticClass:"section-footer"},[t.remoteParams.id?e("div",{staticClass:"description"},[t._v("\n      "+t._s(t.$t("every_contribution_edit_num",{num:2}))+"\n    ")]):t.localVideoForm.activity_id?e("div",{staticClass:"description"},[t._v("\n      "+t._s(t.$t("good_post"))+"\n    ")]):t._e(),t._v(" "),e("div",{staticClass:"operation"},[e("div",{staticClass:"cancel-btn",on:{click:t.onCancelClick}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"confirm-btn",class:{disabled:!t.canPublish},attrs:{title:t.localVideoForm.video_url?"":t.$t("CreativeCenterPopup39"),"data-event":"contribution_local_video_publish_confirm_btn"},on:{click:t.onPublishClick}},[t._v("\n        "+t._s(t.remoteParams.id?t.$t("Save"):t.$t("releaseName"))+"\n      ")])])])])}),[],!1,null,"08860f11",null);e.default=component.exports},3369:function(t,e,n){"use strict";n.r(e);n(16);var o=n(2),r=n(14),l=(n(6),n(11),n(32),n(22),n(18),n(8),n(12),n(13),n(4),n(21),n(7),n(1)),c=n(71),d=n(81),h=n(299),v=n(10),f=n(212),m=n(364),_=n(54),y=n(164);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={name:"PublishArticle",components:{MyEditor:f.default,ActivitySelector:m.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedList:{type:Array,default:function(){return[]}},remoteParams:{type:Object,default:function(){}}},emits:["update:visible","reselectData","selectedDataChange"],created:function(){this.initArticleForm(),this.initLinkTags(),this.initActivities(),this.initLogEvent(),this.checkNSFW()},mounted:function(){Object(v.J)(300)},destroyed:function(){Object(v.V)()},data:function(){return{isPublishLoading:!1,isCheckNSFWLoading:!1,isInitFormLoading:!1,articleForm:{title:"",tags:[],content:"",activity_id:""},articleFormRules:{title:[{required:!0,message:this.$t("gptRulesTite"),trigger:"blur"}],content:[{required:!0,message:this.$t("addMintext"),trigger:"blur"}]},isLinkTagsLoading:!1,linkTagsOptions:[],isActivitiesLoading:!1,activitiesOptions:[],toolbarConfig:{toolbarKeys:["header1","header2","header3","bold","underline","italic","through","color","insertLink","uploadImage","bulletedList","numberedList","undo","redo"]},formItemHighlightErrorBorder:{title:!1,intro:!1,tags:!1}}},computed:{canPublish:function(){return this.selectedList.length>0&&!this.isCheckNSFWLoading},defaultTagList:function(){var t,e,n,o=this,l=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&l.push.apply(l,Object(r.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var c=this.activitiesOptions.find((function(t){return t.value===o.articleForm.activity_id}));return null!=c&&null!==(e=c.tag_list)&&void 0!==e&&e.length?l.push.apply(l,Object(r.a)(c.tag_list)):null!=c&&c.tag&&l.push(c.tag),l}},watch:{selectedList:{handler:function(t,e){Object(y.checkExistNewItem)(t,e,"url")&&this.checkNSFW()}}},methods:w(w({},Object(l.b)("user",["getAccountInfo"])),{},{initArticleForm:function(){var t=this;this.remoteParams.id&&(this.isInitFormLoading=!0,Object(d.h)({id:this.remoteParams.id}).then((function(e){var n=e.data.portfolio,o=n.name,r=n.tag,content=n.content,l=n.cover;t.articleForm.title=o,t.articleForm.tags=(null==r?void 0:r.map((function(t){return t.id||t.title})))||[],t.articleForm.content=content,t.$emit("selectedDataChange",[{url:null==l?void 0:l.url,width:null==l?void 0:l.width,height:null==l?void 0:l.height}])})).finally((function(){t.isInitFormLoading=!1})))},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(c.d)({show_area:"article"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(h.a)(e,t.$i18n.locale)||e.en,type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.articleForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list}]):(this.isActivitiesLoading=!0,Object(d.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n;t.activitiesOptions=(null===(n=e.data.items)||void 0===n||null===(n=n.filter((function(t){return t.participation_type_limits.includes(_.CONTRIBUTION_TYPE_ENUM.ARTICLE)})))||void 0===n?void 0:n.map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list}})))||[]})).finally((function(){t.isActivitiesLoading=!1})))},initLogEvent:function(){var t=this;this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_publish_page",behavior_info_sub:"article"});var e=this.$watch("articleForm.activity_id",(function(){t.$logEvent("log_actions",{operation:"click_add_activity",behavior_info:"on_post_page_publish_page",behavior_info_sub:"article"}),e()}))},checkNSFW:function(){var t,e=this;null!==(t=this.selectedList)&&void 0!==t&&t.length&&(this.isCheckNSFWLoading=!0,Object(d.g)({content_list:[this.selectedList[0]].map((function(t){var e;return null!=t&&t.taskId?{type:3,task_info:{index:t.index,task_id:t.taskId}}:null!=t&&null!==(e=t.meta)&&void 0!==e&&e.id?{type:1,artwork_id:t.meta.id}:null!=t&&t.url?{type:2,url:t.url}:void 0}))}).then((function(t){var n;(null===(n=t.data)||void 0===n||null===(n=n.check_res)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.is_nsfw_limit)&&(e.$emit("selectedDataChange",[]),e.$message.error(e.$t("nsfw_prompt_upload_media_failure"),{duration:5e3}))})).finally((function(){e.isCheckNSFWLoading=!1})))},onActivitySelectChange:function(t){this.articleForm.activity_id=t},clearFormItemHighlightErrorBorder:function(t){var e=this;t?this.formItemHighlightErrorBorder[t]=!1:Object.keys(this.formItemHighlightErrorBorder).forEach((function(t){return e.formItemHighlightErrorBorder[t]=!1}))},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPreviewClick:function(){var t,e,n;if(this.articleForm.title){var o={title:this.articleForm.title,content:this.articleForm.content,cover:{uri:null===(t=this.selectedList[0])||void 0===t?void 0:t.url,width:null===(e=this.selectedList[0])||void 0===e?void 0:e.width,height:null===(n=this.selectedList[0])||void 0===n?void 0:n.height}};localStorage.setItem("previewArticleData",JSON.stringify(o)),window.open("/articleDetailPreview","_blank")}else this.$message.warning(this.$t("gptRulesTite"))},onPublishClick:function(){var t=this;this.canPublish&&this.$refs.articleFormRef.validate((function(e){if(e){var o,r,l,c=n(160),h=w(w({},t.remoteParams.id?{id:t.remoteParams.id}:{}),{},{source:t.source?t.source:void 0,activity_type:t.articleForm.activity_id?1:void 0,activity_id:t.articleForm.activity_id||void 0,title:t.articleForm.title,tags:t.articleForm.tags.map((function(e){return t.linkTagsOptions.map((function(option){return option.value})).includes(e)?{id:e}:{title:e}})),content:t.articleForm.content,cover:{uri:null===(o=t.selectedList[0])||void 0===o?void 0:o.url,width:null===(r=t.selectedList[0])||void 0===r?void 0:r.width,height:null===(l=t.selectedList[0])||void 0===l?void 0:l.height}}),v=t.remoteParams.id?d.o:d.a;t.isPublishLoading=!0,v(h).then((function(e){var n,o,r;1e4===e.status.code?(t.$logEvent("log_actions",{operation:"publish_success",behavior_info:"on_post_page_publish_page",behavior_info_sub:"article"}),t.getAccountInfo(),t.closePublish(),Object(y.alertPostSuccess)(t,{isDailyFirst:null===(n=e.data)||void 0===n?void 0:n.is_daily_first,jumpUrl:"/articleDetail/".concat((null===(o=e.data)||void 0===o?void 0:o.id)||t.remoteParams.id),imgSrc:null===(r=t.selectedList)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.url,staminaImgSrc:c})):40335===e.status.code?t.$message.error(t.$t("already_not_edit")):40017===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.title=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Title")}))):40018===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.intro=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("Content")}))):40311===e.status.code?(t.clearFormItemHighlightErrorBorder(),t.formItemHighlightErrorBorder.tags=!0,t.$message.error(t.$t("sensitive_works_contribution_scene_prompt",{scene:t.$t("TagsAssociation")}))):t.$message.error(e.status.msg)})).catch((function(){t.$message.error(t.$t("PostFailed"))})).finally((function(){t.isPublishLoading=!1}))}}))},onReselectClick:function(){this.$emit("reselectData",this.selectedList)}})},L=(n(4502),n(4503),n(0)),component=Object(L.a)(k,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isPublishLoading||e.isInitFormLoading,expression:"isPublishLoading || isInitFormLoading"}],staticClass:"publish-article",attrs:{visible:e.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:"","data-group":"class_p-contribution"},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"section-header"},[n("div",{staticClass:"title"},[e._v(e._s(e.remoteParams.id?e.$t("edit_article"):e.$t("PublishArticle")))])]),e._v(" "),n("div",{staticClass:"section-content"},[n("div",{staticClass:"image-container"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("CoverImg")))]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isCheckNSFWLoading,expression:"isCheckNSFWLoading"}],staticClass:"image-cover",style:{backgroundImage:"url(".concat(null===(t=e.selectedList[0])||void 0===t?void 0:t.url,")")}},[n("div",{staticClass:"reselect-btn",style:{opacity:0===e.selectedList.length?1:void 0},on:{click:e.onReselectClick}},[e._v("\n          "+e._s(0===e.selectedList.length?e.$t("PleaseSetCover"):e.$t("reselect"))+"\n        ")])])]),e._v(" "),n("div",{staticClass:"form-container"},[n("el-form",{ref:"articleFormRef",attrs:{model:e.articleForm,rules:e.articleFormRules}},[n("el-form-item",{attrs:{label:e.$t("Title"),prop:"title"}},[n("el-input",{class:{"highlight-error-border":e.formItemHighlightErrorBorder.title},attrs:{maxlength:"80","show-word-limit":"",placeholder:e.$t("postFormTitleTips")},on:{focus:function(t){return e.clearFormItemHighlightErrorBorder("title")}},model:{value:e.articleForm.title,callback:function(t){e.$set(e.articleForm,"title",t)},expression:"articleForm.title"}})],1),e._v(" "),n("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.isLinkTagsLoading,expression:"isLinkTagsLoading"}],attrs:{label:e.$t("TagsAssociation"),prop:"tags"}},[n("el-select",{class:{"highlight-error-border":e.formItemHighlightErrorBorder.tags},attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,"allow-create":"",filterable:"","default-first-option":"",placeholder:e.$t("TagsAssociationTips")},on:{focus:function(t){return e.clearFormItemHighlightErrorBorder("tags")},"remove-tag":function(t){return e.clearFormItemHighlightErrorBorder("tags")}},model:{value:e.articleForm.tags,callback:function(t){e.$set(e.articleForm,"tags",t)},expression:"articleForm.tags"}},e._l(e.linkTagsOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}},[n("span",[e._v(e._s(t.label))]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:[1,"1"].includes(null==t?void 0:t.type),expression:"[1, '1'].includes(item?.type)"}],staticClass:"label-flag"},[e._v(e._s(e.$t("official")))])])})),1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.articleForm.activity_id,expression:"articleForm.activity_id"}],staticClass:"link-tags-description"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("Required_Tags")))]),e._v(" "),e._l(e.defaultTagList,(function(t){return n("div",{key:t,staticClass:"default-tag"},[e._v("# "+e._s(t))])}))],2)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("Content"),prop:"content"}},[n("MyEditor",{staticClass:"my-editor",class:{"highlight-error-border":e.formItemHighlightErrorBorder.intro},attrs:{height:"auto",uploadCategory:50,toolbarConfig:e.toolbarConfig,defaultProps:{mode:"simple"}},nativeOn:{click:function(t){return e.clearFormItemHighlightErrorBorder("intro")}},model:{value:e.articleForm.content,callback:function(t){e.$set(e.articleForm,"content",t)},expression:"articleForm.content"}}),e._v(" "),n("ActivitySelector",{attrs:{activityId:e.articleForm.activity_id,activitiesOptions:e.activitiesOptions,isLoading:e.isActivitiesLoading,disabled:!!e.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_article_publish_activity_select",dataEventForOption:"contribution_article_publish_activity_option"}},on:{change:e.onActivitySelectChange}})],1)],1)],1)]),e._v(" "),n("div",{staticClass:"section-footer"},[e.articleForm.activity_id?n("div",{staticClass:"description"},[e._v("\n      "+e._s(e.$t("good_post"))+"\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"operation"},[n("div",{staticClass:"cancel-btn",on:{click:e.onCancelClick}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),n("div",{staticClass:"cancel-btn",on:{click:e.onPreviewClick}},[e._v(e._s(e.$t("preview")))]),e._v(" "),n("div",{staticClass:"confirm-btn",class:{disabled:!e.canPublish},attrs:{title:0===e.selectedList.length?e.$t("PleaseSetCover"):"","data-event":"contribution_article_publish_confirm_btn"},on:{click:e.onPublishClick}},[e._v("\n        "+e._s(e.remoteParams.id?e.$t("Save"):e.$t("releaseName"))+"\n      ")])])])])}),[],!1,null,"624ed1c8",null);e.default=component.exports;installComponents(component,{MyEditor:n(212).default})},3370:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(14),l=(n(6),n(11),n(32),n(16),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(7),n(21),n(1)),c=n(71),d=n(38),h=n(81),v=n(299),f=n(10),m=n(364),_=n(54),y=n(164);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={name:"PublishCharacter",components:{ActivitySelector:m.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedList:{type:Array,default:function(){return[]}}},emits:["update:visible","reselectData","selectedDataChange"],created:function(){this.initSelectedCharacter(),this.initLinkTags(),this.initActivities(),this.initLogEvent()},mounted:function(){Object(f.J)(300)},destroyed:function(){Object(f.V)()},data:function(){return{isPublishLoading:!1,isCharacterDetailLoading:!1,characterForm:{title:"",desc:"",tags:[],activity_id:""},isLinkTagsLoading:!1,linkTagsOptions:[],isActivitiesLoading:!1,activitiesOptions:[]}},computed:{defaultTagList:function(){var t,e,n,o=this,l=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&l.push.apply(l,Object(r.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var c=this.activitiesOptions.find((function(t){return t.value===o.characterForm.activity_id}));return null!=c&&null!==(e=c.tag_list)&&void 0!==e&&e.length?l.push.apply(l,Object(r.a)(c.tag_list)):null!=c&&c.tag&&l.push(c.tag),l}},watch:{selectedList:{handler:function(){this.initSelectedCharacter()}}},methods:w(w({},Object(l.b)("user",["getAccountInfo"])),{},{initSelectedCharacter:function(){var t,e=this;this.selectedList.length>0?(this.isCharacterDetailLoading=!0,Object(d.w)({id:this.selectedList[0].meta.id}).then((function(t){var n;e.characterForm={title:t.data.name,desc:t.data.evaluation,tags:Object(r.a)(t.data.categories.map((function(t){return t.name}))).slice(0,5),activity_id:null===(n=e.linkActivity)||void 0===n?void 0:n.id}})).finally((function(){e.isCharacterDetailLoading=!1}))):this.characterForm={title:"",desc:"",tags:[],activity_id:null===(t=this.linkActivity)||void 0===t?void 0:t.id}},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(c.d)({show_area:"cyber_bar"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(v.a)(e,t.$i18n.locale)||e.en,type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.characterForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list}]):(this.isActivitiesLoading=!0,Object(h.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n;t.activitiesOptions=(null===(n=e.data.items)||void 0===n||null===(n=n.filter((function(t){return t.participation_type_limits.includes(_.CONTRIBUTION_TYPE_ENUM.CHARACTER)})))||void 0===n?void 0:n.map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list}})))||[]})).finally((function(){t.isActivitiesLoading=!1})))},initLogEvent:function(){var t=this;this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_page_publish_page",behavior_info_sub:"character"});var e=this.$watch("characterForm.activity_id",(function(){t.$logEvent("log_actions",{operation:"click_add_activity",behavior_info:"on_post_page_publish_page",behavior_info_sub:"character"}),e()}))},onActivitySelectChange:function(t){this.characterForm.activity_id=t},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPublishClick:function(){var t,e,o=this;if(0!==this.selectedList.length){var r=n(160),l={character_id:this.selectedList[0].meta.id,theme_activity_date:0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)?this.linkActivity.id:void 0,theme_activity_id:1===(null===(e=this.linkActivity)||void 0===e?void 0:e.activity_type)?this.linkActivity.id:void 0};this.isPublishLoading=!0,Object(h.b)(l).then((function(t){var e;1e4===t.status.code?(o.$logEvent("log_actions",{operation:"publish_success",behavior_info:"on_post_page_publish_page",behavior_info_sub:"character"}),o.getAccountInfo(),o.closePublish(),Object(y.alertPostSuccess)(o,{isDailyFirst:t.data.is_daily_first,jumpUrl:"/aiChat/".concat(t.data.id),imgSrc:null===(e=o.selectedList)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.url,staminaImgSrc:r})):o.$message.error(o.$t("PostFailed"))})).catch((function(){o.$message.error(o.$t("PostFailed"))})).finally((function(){o.isPublishLoading=!1}))}},onReselectClick:function(){this.$emit("reselectData",this.selectedList)}})},L=(n(4504),n(0)),component=Object(L.a)(k,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:n.isPublishLoading,expression:"isPublishLoading"}],staticClass:"publish-character",attrs:{visible:n.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(t){n.visible=t}}},[o("div",{staticClass:"section-header"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t("publish_character")))])]),n._v(" "),o("div",{staticClass:"section-content"},[o("section",{staticClass:"content-left"},[o("div",{staticClass:"image-container"},[o("div",{staticClass:"image-cover",style:{backgroundImage:"url(".concat(null===(t=n.selectedList[0])||void 0===t?void 0:t.url,")")}},[o("div",{staticClass:"reselect-btn",style:{opacity:0===n.selectedList.length?1:void 0},on:{click:n.onReselectClick}},[n._v("\n            "+n._s(n.$t("reselect"))+"\n          ")])])])]),n._v(" "),o("section",{directives:[{name:"loading",rawName:"v-loading",value:n.isCharacterDetailLoading,expression:"isCharacterDetailLoading"}],staticClass:"content-right"},[o("el-form",{attrs:{model:n.characterForm}},[o("el-form-item",{attrs:{label:n.$t("Title"),prop:"title"}},[o("el-input",{attrs:{disabled:""},model:{value:n.characterForm.title,callback:function(t){n.$set(n.characterForm,"title",t)},expression:"characterForm.title"}})],1),n._v(" "),o("el-form-item",{attrs:{label:n.$t("Desc"),prop:"desc"}},[o("div",{staticClass:"desc-content"},[o("div",{staticClass:"desc-content-wrapper"},[n._v(n._s(n.characterForm.desc))])]),n._v(" "),o("ActivitySelector",{attrs:{activityId:n.characterForm.activity_id,activitiesOptions:n.activitiesOptions,isLoading:n.isActivitiesLoading,disabled:!!n.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_character_publish_activity_select",dataEventForOption:"contribution_character_publish_activity_option"}},on:{change:n.onActivitySelectChange}})],1),n._v(" "),o("el-form-item",{attrs:{label:n.$t("TagsAssociation"),prop:"tags"}},[o("el-select",{attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,disabled:"",placeholder:""},model:{value:n.characterForm.tags,callback:function(t){n.$set(n.characterForm,"tags",t)},expression:"characterForm.tags"}}),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.characterForm.activity_id,expression:"characterForm.activity_id"}],staticClass:"link-tags-description"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t("Required_Tags")))]),n._v(" "),n._l(n.defaultTagList,(function(t){return o("div",{key:t,staticClass:"default-tag"},[n._v("# "+n._s(t))])}))],2)],1)],1)],1)]),n._v(" "),o("div",{staticClass:"section-footer"},[2===(null===(e=n.selectedList)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.meta)||void 0===e||null===(e=e.character)||void 0===e?void 0:e.publish_status)?o("div",{staticClass:"description"},[n._v("\n      "+n._s(n.$t("after_post_character_public"))+"\n    ")]):n.characterForm.activity_id?o("div",{staticClass:"description"},[n._v("\n      "+n._s(n.$t("good_post"))+"\n    ")]):n._e(),n._v(" "),o("div",{staticClass:"operation"},[o("div",{staticClass:"cancel-btn",on:{click:n.onCancelClick}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("div",{staticClass:"confirm-btn",class:{disabled:0===n.selectedList.length},attrs:{title:0===n.selectedList.length?n.$t("please_select_character"):"","data-event":"contribution_character_publish_confirm_btn"},on:{click:n.onPublishClick}},[n._v("\n        "+n._s(n.$t("releaseName"))+"\n      ")])])])])}),[],!1,null,"8a1e4344",null);e.default=component.exports},3371:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(14),l=(n(6),n(11),n(32),n(16),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(7),n(21),n(1)),c=n(71),d=n(81),h=n(299),v=n(10),f=n(364),m=n(54),_=n(164);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"PublishModelCheckpoint",components:{ActivitySelector:f.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedList:{type:Array,default:function(){return[]}}},emits:["update:visible","reselectData","selectedDataChange"],created:function(){this.initSelectedModelCheckpoint(),this.initLinkTags(),this.initActivities()},mounted:function(){Object(v.J)(300)},destroyed:function(){Object(v.V)()},data:function(){return{isPublishLoading:!1,isModelDetailLoading:!1,modelCheckpointForm:{title:"",desc:"",tags:[],activity_id:""},isLinkTagsLoading:!1,linkTagsOptions:[],isActivitiesLoading:!1,activitiesOptions:[]}},computed:{defaultTagList:function(){var t,e,n,o=this,l=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&l.push.apply(l,Object(r.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var c=this.activitiesOptions.find((function(t){return t.value===o.modelCheckpointForm.activity_id}));return null!=c&&null!==(e=c.tag_list)&&void 0!==e&&e.length?l.push.apply(l,Object(r.a)(c.tag_list)):null!=c&&c.tag&&l.push(c.tag),l},isImageOrVideo:function(){return function(t){return Object(_.isImageOrVideo)(t)}}},watch:{selectedList:{handler:function(){this.initSelectedModelCheckpoint()}}},methods:C(C({},Object(l.b)("user",["getAccountInfo"])),{},{initSelectedModelCheckpoint:function(){var t,e=this;this.selectedList.length>0?(this.isModelDetailLoading=!0,Object(d.i)({id:this.selectedList[0].meta.id,scene:"model_detail_v2"}).then((function(t){var n,o,l;e.modelCheckpointForm={title:t.data.name,desc:null===(n=t.data.model_info_v2)||void 0===n?void 0:n.desc,tags:Object(r.a)((null===(o=t.data)||void 0===o||null===(o=o.tags)||void 0===o?void 0:o.map((function(t){return t.title})))||[]).slice(0,5),activity_id:null===(l=e.linkActivity)||void 0===l?void 0:l.id}})).finally((function(){e.isModelDetailLoading=!1}))):this.modelCheckpointForm={title:"",desc:"",tags:[],activity_id:null===(t=this.linkActivity)||void 0===t?void 0:t.id}},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(c.d)({show_area:"model"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(h.a)(e,t.$i18n.locale)||e.en,type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.modelCheckpointForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list}]):(this.isActivitiesLoading=!0,Object(d.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n;t.activitiesOptions=(null===(n=e.data.items)||void 0===n||null===(n=n.filter((function(t){return t.participation_type_limits.includes(m.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT)})))||void 0===n?void 0:n.map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list}})))||[]})).finally((function(){t.isActivitiesLoading=!1})))},onActivitySelectChange:function(t){this.modelCheckpointForm.activity_id=t},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPublishClick:function(){var t=this;if(0!==this.selectedList.length){var e=n(160),o={model_id:this.selectedList[0].meta.id,activity_id:this.linkActivity.id};this.isPublishLoading=!0,Object(d.c)(o).then((function(n){var o;1e4===n.status.code?(t.getAccountInfo(),t.closePublish(),Object(_.alertPostSuccess)(t,{isDailyFirst:n.data.is_daily_first,jumpUrl:"/models/detail/".concat(n.data.id),imgSrc:null===(o=t.selectedList)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.url,staminaImgSrc:e})):t.$message.error(t.$t("PostFailed"))})).catch((function(){t.$message.error(t.$t("PostFailed"))})).finally((function(){t.isPublishLoading=!1}))}},onReselectClick:function(){this.$emit("reselectData",this.selectedList)}})},k=(n(4505),n(0)),component=Object(k.a)(w,(function(){var t,e,n,o,r=this,l=r._self._c;return l("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:r.isPublishLoading,expression:"isPublishLoading"}],staticClass:"publish-model-checkpoint",attrs:{visible:r.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(t){r.visible=t}}},[l("div",{staticClass:"section-header"},[l("div",{staticClass:"title"},[r._v(r._s(r.$t("publish_xx_model",{name:"Checkpoint"})))])]),r._v(" "),l("div",{staticClass:"section-content"},[l("section",{staticClass:"content-left"},[l("div",{staticClass:"image-container"},[l("div",{directives:[{name:"show",rawName:"v-show",value:"image"===r.isImageOrVideo(null===(t=r.selectedList[0])||void 0===t?void 0:t.url),expression:"isImageOrVideo(selectedList[0]?.url) === 'image'"}],staticClass:"image-preview",style:{backgroundImage:"url(".concat(null===(e=r.selectedList[0])||void 0===e?void 0:e.url,")")}}),r._v(" "),l("video",{directives:[{name:"show",rawName:"v-show",value:"video"===r.isImageOrVideo(null===(n=r.selectedList[0])||void 0===n?void 0:n.url),expression:"isImageOrVideo(selectedList[0]?.url) === 'video'"}],staticClass:"video-preview",attrs:{src:null===(o=r.selectedList[0])||void 0===o?void 0:o.url,autoplay:"autoplay",loop:"loop",muted:"muted"},domProps:{muted:!0}}),r._v(" "),l("div",{staticClass:"reselect-btn",style:{opacity:0===r.selectedList.length?1:void 0},on:{click:r.onReselectClick}},[r._v("\n          "+r._s(r.$t("reselect"))+"\n        ")])])]),r._v(" "),l("section",{directives:[{name:"loading",rawName:"v-loading",value:r.isModelDetailLoading,expression:"isModelDetailLoading"}],staticClass:"content-right"},[l("el-form",{attrs:{model:r.modelCheckpointForm}},[l("el-form-item",{attrs:{label:r.$t("Title"),prop:"title"}},[l("el-input",{attrs:{disabled:""},model:{value:r.modelCheckpointForm.title,callback:function(t){r.$set(r.modelCheckpointForm,"title",t)},expression:"modelCheckpointForm.title"}})],1),r._v(" "),l("el-form-item",{attrs:{label:r.$t("Desc"),prop:"desc"}},[l("div",{staticClass:"desc-content"},[l("div",{staticClass:"desc-content-wrapper",domProps:{innerHTML:r._s(r.modelCheckpointForm.desc)}})]),r._v(" "),l("ActivitySelector",{attrs:{activityId:r.modelCheckpointForm.activity_id,activitiesOptions:r.activitiesOptions,isLoading:r.isActivitiesLoading,disabled:!!r.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_model_checkpoint_publish_activity_select",dataEventForOption:"contribution_model_checkpoint_publish_activity_option"}},on:{change:r.onActivitySelectChange}})],1),r._v(" "),l("el-form-item",{attrs:{label:r.$t("TagsAssociation"),prop:"tags"}},[l("el-select",{attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,disabled:"",placeholder:""},model:{value:r.modelCheckpointForm.tags,callback:function(t){r.$set(r.modelCheckpointForm,"tags",t)},expression:"modelCheckpointForm.tags"}}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.modelCheckpointForm.activity_id,expression:"modelCheckpointForm.activity_id"}],staticClass:"link-tags-description"},[l("div",{staticClass:"title"},[r._v(r._s(r.$t("Required_Tags")))]),r._v(" "),r._l(r.defaultTagList,(function(t){return l("div",{key:t,staticClass:"default-tag"},[r._v("# "+r._s(t))])}))],2)],1)],1)],1)]),r._v(" "),l("div",{staticClass:"section-footer"},[r.modelCheckpointForm.activity_id?l("div",{staticClass:"description"},[r._v("\n      "+r._s(r.$t("good_post"))+"\n    ")]):r._e(),r._v(" "),l("div",{staticClass:"operation"},[l("div",{staticClass:"cancel-btn",on:{click:r.onCancelClick}},[r._v(r._s(r.$t("Cancel")))]),r._v(" "),l("div",{staticClass:"confirm-btn",class:{disabled:0===r.selectedList.length},attrs:{"data-event":"contribution_model_checkpoint_publish_confirm_btn"},on:{click:r.onPublishClick}},[r._v("\n        "+r._s(r.$t("releaseName"))+"\n      ")])])])])}),[],!1,null,"4d00b659",null);e.default=component.exports},3372:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(14),l=(n(6),n(11),n(32),n(16),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(7),n(21),n(1)),c=n(71),d=n(81),h=n(299),v=n(10),f=n(364),m=n(54),_=n(164);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"PublishModelLora",components:{ActivitySelector:f.default},props:{visible:{type:Boolean,default:!1},source:{type:String,default:""},linkActivity:{type:Object,default:function(){}},selectedList:{type:Array,default:function(){return[]}}},emits:["update:visible","reselectData","selectedDataChange"],created:function(){this.initSelectedModelLora(),this.initLinkTags(),this.initActivities()},mounted:function(){Object(v.J)(300)},destroyed:function(){Object(v.V)()},data:function(){return{isPublishLoading:!1,isModelDetailLoading:!1,modelLoraForm:{title:"",desc:"",tags:[],activity_id:""},isLinkTagsLoading:!1,linkTagsOptions:[],isActivitiesLoading:!1,activitiesOptions:[]}},computed:{defaultTagList:function(){var t,e,n,o=this,l=[];0===(null===(t=this.linkActivity)||void 0===t?void 0:t.activity_type)&&l.push.apply(l,Object(r.a)((null===(n=this.linkActivity)||void 0===n?void 0:n.subjoin_tags)||[]));var c=this.activitiesOptions.find((function(t){return t.value===o.modelLoraForm.activity_id}));return null!=c&&null!==(e=c.tag_list)&&void 0!==e&&e.length?l.push.apply(l,Object(r.a)(c.tag_list)):null!=c&&c.tag&&l.push(c.tag),l},isImageOrVideo:function(){return function(t){return Object(_.isImageOrVideo)(t)}}},watch:{selectedList:{handler:function(){this.initSelectedModelLora()}}},methods:C(C({},Object(l.b)("user",["getAccountInfo"])),{},{initSelectedModelLora:function(){var t,e=this;this.selectedList.length>0?(this.isModelDetailLoading=!0,Object(d.i)({id:this.selectedList[0].meta.id,scene:"model_detail_v2"}).then((function(t){var n,o,l;e.modelLoraForm={title:t.data.name,desc:null===(n=t.data.model_info_v2)||void 0===n?void 0:n.desc,tags:Object(r.a)((null===(o=t.data)||void 0===o||null===(o=o.tags)||void 0===o?void 0:o.map((function(t){return t.title})))||[]).slice(0,5),activity_id:null===(l=e.linkActivity)||void 0===l?void 0:l.id}})).finally((function(){e.isModelDetailLoading=!1}))):this.modelLoraForm={title:"",desc:"",tags:[],activity_id:null===(t=this.linkActivity)||void 0===t?void 0:t.id}},initLinkTags:function(){var t=this;this.isLinkTagsLoading=!0,Object(c.d)({show_area:"model"}).then((function(e){t.linkTagsOptions=e.data.map((function(e){return{value:e.id,label:Object(h.a)(e,t.$i18n.locale)||e.en,type:e.type}}))})).finally((function(){t.isLinkTagsLoading=!1}))},initActivities:function(){var t=this;this.linkActivity.id?(this.modelLoraForm.activity_id=this.linkActivity.id,this.activitiesOptions=[{value:this.linkActivity.id,label:this.linkActivity.title,tag:this.linkActivity.tag,tag_list:this.linkActivity.tag_list}]):(this.isActivitiesLoading=!0,Object(d.m)({activity_type:1,activity_status:2,size:1e3}).then((function(e){var n;t.activitiesOptions=(null===(n=e.data.items)||void 0===n||null===(n=n.filter((function(t){return t.participation_type_limits.includes(m.CONTRIBUTION_TYPE_ENUM.MODEL_LORA)})))||void 0===n?void 0:n.map((function(t){return{value:t.id,label:t.title,tag:t.tag,tag_list:t.tag_list}})))||[]})).finally((function(){t.isActivitiesLoading=!1})))},onActivitySelectChange:function(t){this.modelLoraForm.activity_id=t},closePublish:function(){this.$emit("update:visible",!1)},onCancelClick:function(){var t=this;this.$confirm(this.$t("handleTextEditTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"colorful-confirm"}).then((function(){t.closePublish()})).catch((function(){}))},onPublishClick:function(){var t=this;if(0!==this.selectedList.length){var e=n(160),o={model_id:this.selectedList[0].meta.id,activity_id:this.linkActivity.id};this.isPublishLoading=!0,Object(d.c)(o).then((function(n){var o;1e4===n.status.code?(t.getAccountInfo(),t.closePublish(),Object(_.alertPostSuccess)(t,{isDailyFirst:n.data.is_daily_first,jumpUrl:"/models/detail/".concat(n.data.id),imgSrc:null===(o=t.selectedList)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.url,staminaImgSrc:e})):t.$message.error(t.$t("PostFailed"))})).catch((function(){t.$message.error(t.$t("PostFailed"))})).finally((function(){t.isPublishLoading=!1}))}},onReselectClick:function(){this.$emit("reselectData",this.selectedList)}})},k=(n(4506),n(0)),component=Object(k.a)(w,(function(){var t,e,n,o,r=this,l=r._self._c;return l("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:r.isPublishLoading,expression:"isPublishLoading"}],staticClass:"publish-model-lora",attrs:{visible:r.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"5vh","data-group":"class_p-contribution"},on:{"update:visible":function(t){r.visible=t}}},[l("div",{staticClass:"section-header"},[l("div",{staticClass:"title"},[r._v(r._s(r.$t("publish_xx_model",{name:"LoRA"})))])]),r._v(" "),l("div",{staticClass:"section-content"},[l("section",{staticClass:"content-left"},[l("div",{staticClass:"image-container"},[l("div",{directives:[{name:"show",rawName:"v-show",value:"image"===r.isImageOrVideo(null===(t=r.selectedList[0])||void 0===t?void 0:t.url),expression:"isImageOrVideo(selectedList[0]?.url) === 'image'"}],staticClass:"image-preview",style:{backgroundImage:"url(".concat(null===(e=r.selectedList[0])||void 0===e?void 0:e.url,")")}}),r._v(" "),l("video",{directives:[{name:"show",rawName:"v-show",value:"video"===r.isImageOrVideo(null===(n=r.selectedList[0])||void 0===n?void 0:n.url),expression:"isImageOrVideo(selectedList[0]?.url) === 'video'"}],staticClass:"video-preview",attrs:{src:null===(o=r.selectedList[0])||void 0===o?void 0:o.url,autoplay:"autoplay",loop:"loop",muted:"muted"},domProps:{muted:!0}}),r._v(" "),l("div",{staticClass:"reselect-btn",style:{opacity:0===r.selectedList.length?1:void 0},on:{click:r.onReselectClick}},[r._v("\n          "+r._s(r.$t("reselect"))+"\n        ")])])]),r._v(" "),l("section",{directives:[{name:"loading",rawName:"v-loading",value:r.isModelDetailLoading,expression:"isModelDetailLoading"}],staticClass:"content-right"},[l("el-form",{attrs:{model:r.modelLoraForm}},[l("el-form-item",{attrs:{label:r.$t("Title"),prop:"title"}},[l("el-input",{attrs:{disabled:""},model:{value:r.modelLoraForm.title,callback:function(t){r.$set(r.modelLoraForm,"title",t)},expression:"modelLoraForm.title"}})],1),r._v(" "),l("el-form-item",{attrs:{label:r.$t("Desc"),prop:"desc"}},[l("div",{staticClass:"desc-content"},[l("div",{staticClass:"desc-content-wrapper",domProps:{innerHTML:r._s(r.modelLoraForm.desc)}})]),r._v(" "),l("ActivitySelector",{attrs:{activityId:r.modelLoraForm.activity_id,activitiesOptions:r.activitiesOptions,isLoading:r.isActivitiesLoading,disabled:!!r.linkActivity.id,logEventInfo:{dataEventForSelector:"contribution_model_lora_publish_activity_select",dataEventForOption:"contribution_model_lora_publish_activity_option"}},on:{change:r.onActivitySelectChange}})],1),r._v(" "),l("el-form-item",{attrs:{label:r.$t("TagsAssociation"),prop:"tags"}},[l("el-select",{attrs:{"popper-class":"contribution-publish-el-select-popper",multiple:"","multiple-limit":5,disabled:"",placeholder:""},model:{value:r.modelLoraForm.tags,callback:function(t){r.$set(r.modelLoraForm,"tags",t)},expression:"modelLoraForm.tags"}}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.modelLoraForm.activity_id,expression:"modelLoraForm.activity_id"}],staticClass:"link-tags-description"},[l("div",{staticClass:"title"},[r._v(r._s(r.$t("Required_Tags")))]),r._v(" "),r._l(r.defaultTagList,(function(t){return l("div",{key:t,staticClass:"default-tag"},[r._v("# "+r._s(t))])}))],2)],1)],1)],1)]),r._v(" "),l("div",{staticClass:"section-footer"},[r.modelLoraForm.activity_id?l("div",{staticClass:"description"},[r._v("\n      "+r._s(r.$t("good_post"))+"\n    ")]):r._e(),r._v(" "),l("div",{staticClass:"operation"},[l("div",{staticClass:"cancel-btn",on:{click:r.onCancelClick}},[r._v(r._s(r.$t("Cancel")))]),r._v(" "),l("div",{staticClass:"confirm-btn",class:{disabled:0===r.selectedList.length},attrs:{"data-event":"contribution_model_lora_publish_confirm_btn"},on:{click:r.onPublishClick}},[r._v("\n        "+r._s(r.$t("releaseName"))+"\n      ")])])])])}),[],!1,null,"45d07a32",null);e.default=component.exports},364:function(t,e,n){"use strict";n.r(e);var o={name:"ActivitySelector",props:{activityId:{type:String,default:""},activitiesOptions:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},logEventInfo:{type:Object,default:function(){return{dataEventForSelector:"",dataEventForOption:""}}}},computed:{localActivityId:{get:function(){return this.activityId},set:function(t){this.onSelectChange(t)}}},emits:["change"],methods:{onSelectChange:function(t){this.$emit("change",t)},onClearClick:function(){this.onSelectChange("")},onSelectVisibleChange:function(t){t&&this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_post_component_popup",behavior_info_sub:"switch_to_activity_challenge"})},onActivityItemClick:function(t){this.$logEvent("log_actions",{operation:"click",behavior_info:"on_post_component_popup",behavior_info_sub:"switch_to_activity_challenge"}),window.open("/event-center/activity/".concat(t.value),"_blank")}}},r=(n(4498),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"activity-selector",attrs:{"data-event":t.logEventInfo.dataEventForSelector}},[e("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"activity-select",class:{"already-selected":t.activityId},attrs:{"popper-class":"contribution-publish-el-select-popper",value:t.localActivityId,clearable:"",placeholder:t.$t("add_activity"),"no-data-text":t.$t("temp_no_activities"),disabled:t.disabled},on:{change:t.onSelectChange,clear:t.onClearClick,"visible-change":t.onSelectVisibleChange},scopedSlots:t._u([{key:"prefix",fn:function(){return[t.activityId?e("Icon",{attrs:{name:"icon-event-flag",size:"16",color:"#ffffff"}}):e("Icon",{attrs:{name:"tianjia",size:"16",color:"#3271CC"}})]},proxy:!0}])},[t._v(" "),t._l(t.activitiesOptions,(function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value,"data-event":t.logEventInfo.dataEventForOption}},[e("span",[t._v(t._s(n.label))]),t._v(" "),e("span",{staticClass:"activity-link",on:{click:function(e){return e.stopPropagation(),t.onActivityItemClick(n)}}},[e("Icon",{attrs:{name:"Frame",size:"24",color:"#fcfcfc"}})],1)])}))],2)],1)}),[],!1,null,"7fe469f6",null);e.default=component.exports},3898:function(t,e,n){"use strict";n(1581)},3899:function(t,e,n){"use strict";n(1582)},3900:function(t,e,n){"use strict";n(1583)},3901:function(t,e,n){"use strict";n(1584)},4036:function(t,e,n){"use strict";n(1677)},4037:function(t,e,n){"use strict";n(1678)},4038:function(t,e,n){"use strict";n(1679)},408:function(t,e,n){"use strict";n.r(e);n(4);var o=n(14),r=(n(19),n(6),n(24),n(164)),l={name:"Waterfall",props:{getWaterfallListFn:{type:Function,required:!0},getMoreWaterfallListFn:{type:Function,required:!0},selectedList:{type:Array,default:function(){return[]}},isSingleSelect:{type:Boolean,default:!1},maxSelectCount:{type:Number,default:1/0}},emits:["update:selectedList","onSelectedListChange"],mounted:function(){this.initWaterfallList()},data:function(){return{isWaterfallLoading:!1,waterfallList:[],waterfallItemWidth:0,waterfallGridAutoRows:10,thisTimeSelectedList:[],hasWaterfallPrefixItem:!0}},computed:{isImageOrVideo:function(){return function(t){return Object(r.isImageOrVideo)(t)}}},watch:{selectedList:{handler:function(t){this.thisTimeSelectedList=t}},thisTimeSelectedList:{handler:function(t){this.$emit("update:selectedList",t),this.$emit("onSelectedListChange",t)}}},methods:{initWaterfallList:function(){var t=this;this.waterfallList=[],this.isWaterfallLoading=!0,this.getWaterfallListFn().then((function(e){t.waterfallList=e,t.thisTimeSelectedList=t.selectedList})).finally((function(){t.isWaterfallLoading=!1,t.hasWaterfallPrefixItem=!0,t.$nextTick((function(){var e;t.waterfallItemWidth=(null===(e=document.querySelector(".waterfall-item"))||void 0===e?void 0:e.offsetWidth)||0,t.hasWaterfallPrefixItem=!!t.$slots["waterfall-prefix-item"]}))}))},getMoreWaterfallList:function(){var t=this;this.isWaterfallLoading||(this.isWaterfallLoading=!0,this.getMoreWaterfallListFn().then((function(e){t.waterfallList=[].concat(Object(o.a)(t.waterfallList),Object(o.a)(e))})).finally((function(){t.isWaterfallLoading=!1})))},handleScroll:function(t){var e=t.target;e.scrollHeight-e.scrollTop-e.clientHeight<30&&this.getMoreWaterfallList()},onWaterfallItemClick:function(t){if(this.thisTimeSelectedList.some((function(e){return e.id===t.id})))this.thisTimeSelectedList=this.thisTimeSelectedList.filter((function(e){return e.id!==t.id}));else if(this.isSingleSelect)this.thisTimeSelectedList=[t];else{if(this.thisTimeSelectedList.length>=this.maxSelectCount)return;this.thisTimeSelectedList=[].concat(Object(o.a)(this.thisTimeSelectedList),[t])}}}},c=(n(4489),n(0)),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isWaterfallLoading,expression:"isWaterfallLoading"}],staticClass:"waterfall",on:{scroll:t.handleScroll}},[e("div",{staticClass:"waterfall-container",style:{gridAutoRows:"".concat(t.waterfallGridAutoRows,"px")}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.hasWaterfallPrefixItem,expression:"hasWaterfallPrefixItem"}],staticClass:"waterfall-item prefix-item",style:{gridRowEnd:"span ".concat(Math.ceil(1*t.waterfallItemWidth/(2*t.waterfallGridAutoRows))),height:t.waterfallItemWidth?"100%":"0"}},[t._t("waterfall-prefix-item")],2),t._v(" "),t._l(t.waterfallList,(function(n){return e("div",{key:n.id,staticClass:"waterfall-item",class:{selected:t.thisTimeSelectedList.some((function(t){return t.id===n.id})),disabled:t.thisTimeSelectedList.length>=t.maxSelectCount&&!t.thisTimeSelectedList.some((function(t){return t.id===n.id}))},style:{gridRowEnd:"span ".concat(Math.ceil(n.height/n.width*t.waterfallItemWidth/(2*t.waterfallGridAutoRows)))},on:{click:function(e){return t.onWaterfallItemClick(n)}}},[e("div",{staticClass:"waterfall-item-wrapper"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"image"===t.isImageOrVideo(n.url),expression:"isImageOrVideo(item.url) === 'image'"}],staticClass:"item-media",style:{backgroundImage:"url(".concat(n.url,")")}},[t._t("image-item-mask",null,{itemMeta:n.meta})],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"video"===t.isImageOrVideo(n.url),expression:"isImageOrVideo(item.url) === 'video'"}],staticClass:"item-media"},[e("video",{staticClass:"video-item",attrs:{src:n.url}}),t._v(" "),e("Icon",{staticClass:"video-item-play",attrs:{name:"icon-play",size:"24",color:"#fff"}})],1)])])}))],2)])}),[],!1,null,"00816cdc",null);e.default=component.exports},4122:function(t,e,n){"use strict";n(1763)},4123:function(t,e,n){"use strict";n(1764)},4124:function(t,e,n){"use strict";n(1765)},424:function(t,e,n){"use strict";n.r(e);n(28),n(140);var o={name:"CFile",props:{file:{type:Object,required:!0,default:function(){return{}}}},computed:{fileName:function(){var t,e=(null===(t=this.file)||void 0===t?void 0:t.url)||"";if(!e)return"";var n=e.match(/\/([^\/?#]+)[^\/]*$/);return n?decodeURIComponent(n[1]):""}},methods:{handleDownload:function(){var t;if(null===(t=this.file)||void 0===t||!t.url)return this.$message.warning(this.$t("Invalid file URL"));try{var link=document.createElement("a");link.href=this.file.url,link.download=this.fileName,document.body.appendChild(link),link.click(),document.body.removeChild(link)}catch(t){console.error("Download failed:",t),this.$message.error(this.$t("Download failed"))}}}},r=(n(4387),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-file",on:{click:t.handleDownload}},[e("div",{staticClass:"c-file-content"},[e("i",{staticClass:"iconfont icon-text c-file-icon"}),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.fileName,placement:"top"}},[e("span",{staticClass:"c-file-name"},[t._v(t._s(t.fileName))])])],1)])}),[],!1,null,"a679548a",null);e.default=component.exports},425:function(t,e,n){"use strict";n.r(e);n(24);var o={name:"CText",props:{text:{type:String,default:""},height:{type:[String,Number],default:"192px"},backgroundColor:{type:String,default:"#181924"}},data:function(){return{isExpanded:!1,showToggle:!1}},computed:{contentHeight:function(){return this.isExpanded?"none":this.height}},mounted:function(){this.isShowToggle()},methods:{isShowToggle:function(){var t=this;this.$nextTick((function(){var content=t.$refs.content;t.showToggle=content.scrollHeight>content.clientHeight}))},handleToggle:function(){this.isExpanded=!this.isExpanded}}},r=(n(4388),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-text",style:{backgroundColor:t.backgroundColor}},[e("div",{ref:"content",staticClass:"c-text-content",class:{"is-expanded":t.isExpanded},style:{maxHeight:t.contentHeight}},[t._v("\n    "+t._s(t.text)+"\n  ")]),t._v(" "),t.showToggle?e("div",{staticClass:"c-text-toggle",on:{click:t.handleToggle}},[t._v("\n    "+t._s(t.isExpanded?t.$t("PackUp"):t.$t("Unfold"))+"\n    "),e("i",{class:t.isExpanded?"el-icon-arrow-up":"el-icon-arrow-down"})]):t._e()])}),[],!1,null,"2a254c9a",null);e.default=component.exports},4349:function(t,e,n){"use strict";n(1919)},4387:function(t,e,n){"use strict";n(1957)},4388:function(t,e,n){"use strict";n(1958)},4475:function(t,e,n){"use strict";n(2042)},4476:function(t,e,n){"use strict";n(2043)},4477:function(t,e,n){"use strict";n(2044)},4478:function(t,e,n){"use strict";n(2045)},4479:function(t,e,n){"use strict";n(2046)},4480:function(t,e,n){"use strict";n(2047)},4481:function(t,e,n){"use strict";n(2048)},4482:function(t,e,n){"use strict";n(2049)},4483:function(t,e,n){"use strict";n(2050)},4484:function(t,e,n){"use strict";n(2051)},4485:function(t,e,n){"use strict";n(2052)},4486:function(t,e,n){"use strict";n(2053)},4487:function(t,e,n){"use strict";n(2054)},4488:function(t,e,n){"use strict";n(2055)},4489:function(t,e,n){"use strict";n(2056)},4490:function(t,e,n){"use strict";n(2057)},4491:function(t,e,n){"use strict";n(2058)},4492:function(t,e,n){"use strict";n(2059)},4493:function(t,e,n){"use strict";n(2060)},4494:function(t,e,n){"use strict";n(2061)},4495:function(t,e,n){"use strict";n(2062)},4496:function(t,e,n){"use strict";n(2063)},4497:function(t,e,n){"use strict";n(2064)},4498:function(t,e,n){"use strict";n(2065)},4499:function(t,e,n){"use strict";n(2066)},4500:function(t,e,n){"use strict";n(2067)},4501:function(t,e,n){"use strict";n(2068)},4502:function(t,e,n){"use strict";n(2069)},4503:function(t,e,n){"use strict";n(2070)},4504:function(t,e,n){"use strict";n(2071)},4505:function(t,e,n){"use strict";n(2072)},4506:function(t,e,n){"use strict";n(2073)},4507:function(t,e,n){"use strict";n(2074)},4508:function(t,e,n){"use strict";n(2075)},465:function(t,e,n){"use strict";n.r(e);n(19),n(6),n(24),n(4),n(7);var o=n(25),r=n(36),l={name:"pickWorkModal",components:{WaterFallVue:n(854).default},props:{maxNum:{type:Number,default:20},type:{type:String,default:"default"}},data:function(){return{visible:!1,loading:!1,list:[],noMore:!1,queryParam:{keyword:"",page:1,page_size:60,time_to:0,after:0},debounceHandleScroll:null,scrollTop:0,selectList:[],debounceHandleSearch:null}},computed:{renderList:function(){return"animGen"==this.type?this.list.filter((function(t){return"sdxl"!=t.channel&&"studio"!=t.channel&&6!=t.type})):this.list}},mounted:function(){this.debounceHandleScroll=Object(o.debounce)(this.handleScroll,200),this.debounceHandleSearch=Object(o.debounce)(this.handleSearch,600)},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceHandleSearch=null},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.resetData(),this.getList(),this.selectList=t||[],this.visible=!0},handleClose:function(){this.visible=!1},resetData:function(){this.list=[],this.loading=!1,this.queryParam={keyword:"",page:1,page_size:60,time_to:0,after:0},this.scrollTop=0,this.noMore=!1,this.selectList=[]},handleCancel:function(){this.visible=!1},handleSearch:function(){this.loading=!1,this.noMore=!1,this.queryParam.page=1,this.queryParam.time_to=0,this.queryParam.after=0,this.scrollTop=0,this.list=[],this.getList()},handleScroll:function(){var t=this.$refs.handleWorkScroll;this.scrollTop=t.scrollTop||0;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-50&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n=r.artworkList;this.queryParam.order_by="new",this.queryParam.artwork_types=[1,4,6],"animGen"==this.type&&(this.queryParam.artwork_types=[1,4],this.queryParam.scene="motion"),"character"==this.type&&(this.queryParam.artwork_types=[1,3,4]),"contribute"===this.type&&(this.queryParam.artwork_types=[1,3,4,6],this.queryParam.scene="post"),this.queryParam.type="bookmarks",this.queryParam.category=2;var o=this.queryParam;return new Promise((function(r,l){n(o).then((function(n){if(1e4===n.status.code){var l;if(e.noMore=!n.data.has_more,e.list=t?e.list.concat(n.data.items||[]):n.data.items||[],1===o.page&&n.data.time_ms&&(o.time_to=n.data.time_ms),n.data.items.length>0)e.queryParam.after=null===(l=n.data.items[n.data.items.length-1])||void 0===l||null===(l=l.folder_no)||void 0===l?void 0:l.collect_at;o.page++,r()}})).catch((function(t){l(t)})).finally((function(){e.loading=!1}))}))}},getCheckList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectList=[],(e.url||[]).forEach((function(n,o){t.selectList.push({url:n,id:(null==e?void 0:e.ids[o])||"",type:"check",info:null==e?void 0:e.info[o]})}))},handleConfirm:function(){this.selectList.length?(this.$emit("confirm",this.selectList),this.handleClose()):this.$message.warning(this.$t("selectOneWork"))}}},c=l,d=(n(4124),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return t.visible?e("el-dialog",{attrs:{visible:t.visible,"custom-class":"c-pick-work-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":"",center:""},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"pick-work-modal-header"},[e("div",{staticClass:"pick-work-modal-header-item"},[e("span",{staticClass:"header-item-text"},[t._v(t._s(t.$t("personalFeed")))]),t._v(" "),e("el-tooltip",{staticClass:"header-item-text-tip",attrs:{effect:"dark",content:t.$t("handleWorkTips1",{number:20}),placement:"top"}},[e("span",{staticClass:"el-icon-info header-item-text-tip"})]),t._v(" "),e("span",{staticClass:"header-item-desc-text"},[t._v(t._s(t.$t("modelWorkDesc")))]),t._v(" "),e("span",{staticClass:"header-item-desc-text",staticStyle:{"margin-left":"8px"}},[t._v(t._s(t.$t("imageAlbum"))+" ("+t._s(t.selectList.length)+"/"+t._s(t.maxNum)+")")])],1),t._v(" "),e("div",{staticClass:"pick-work-modal-header-item"},[e("div",{staticClass:"header-item-btn",on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("Done"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"pick-work-modal-body"},[e("div",{staticClass:"search-box"},[e("el-input",{staticClass:"search-box__search-input",attrs:{placeholder:t.$t("Search"),clearable:""},on:{change:t.handleSearch},model:{value:t.queryParam.keyword,callback:function(e){t.$set(t.queryParam,"keyword",e)},expression:"queryParam.keyword"}},[e("template",{slot:"suffix"},[e("i",{staticClass:"iconfont icon-search search-icon",on:{click:t.handleSearch}})])],2)],1),t._v(" "),e("div",{ref:"handleWorkScroll",staticClass:"handle-work-scroll-list",on:{scroll:t.debounceHandleScroll}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"wraper",staticClass:"wraper"},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{showNs:"",type:"artwork",cols:5,container:"wraper",list:t.renderList,lazy:!0,dislikeShow:!0,isCheck:!0,checkMax:t.maxNum,alreadyNoMoreData:t.noMore,scrollContainerClassName:"handle-work-scroll-list",scrollContentTop:t.scrollTop,selectList:t.selectList},on:{load:function(e){return t.getList(!0)},getChecList:t.getCheckList}})],1)])])]):t._e()}),[],!1,null,null,null);e.default=component.exports},4836:function(t,e,n){"use strict";n(2273)},4932:function(t,e,n){"use strict";n(2368)},4973:function(t,e,n){"use strict";n(2410)},5080:function(t,e,n){"use strict";n(2513)},5116:function(t,e,n){"use strict";n(2548)},5641:function(t,e,n){"use strict";n(3057)},5642:function(t,e,n){"use strict";n(3058)},5643:function(t,e,n){"use strict";n(3059)},5644:function(t,e,n){"use strict";n(3060)},565:function(t,e,n){"use strict";n.r(e);n(24);var o={name:"CTooltip",props:{content:{type:String,default:""},color:{type:String,default:"rgba(0, 0, 0, 0.7)"},font:{type:Number,default:16}},computed:{getStyle:function(){return{color:this.color,fontSize:"".concat(this.font,"px")}}}},r=n(0),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("el-tooltip",{attrs:{effect:"dark",placement:"top","open-delay":0,"popper-class":"rights-components-tooltip"}},[e("span",[e("i",{staticClass:"iconfont icon-help-icon",style:t.getStyle})]),t._v(" "),e("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n    "+t._s(t.$t(t.content))+"\n  ")])])}),[],!1,null,null,null);e.default=component.exports},5679:function(t,e,n){"use strict";n.r(e);n(16),n(22);var o=n(3351),r=n(1177),l=n(3352),c=n(3353),d=n(3354),h=n(605),v=n(3355),f=n(3356),m=n(3358),_=n(465),y=n(83),C=n(51),w={name:"CreativeCenterPopup",components:{headBar:o.default,CreativeCenterMenu:r.default,handleText:l.default,handleVideo:c.default,handleArticle:d.default,UploadImageItem:h.default,handleTextEdit:v.default,pickWorkModal:_.default,HyUploadMoald:y.default,handleVideoEdit:f.default,handleArticleEdit:m.default},provide:function(){return{top:this}},data:function(){return{visible:!1,menuIndex:"textToImage",activeTab:"text",tabList:[{i18nKey:"GraphicSubmission",icon:"GraphicSubmission",label:"图文投稿",code:"text"},{i18nKey:"VideoSubmission",icon:"VideoSubmission",label:"视频投稿",code:"video"},{i18nKey:"ArticleSubmission",icon:"ArticleSubmission",label:"文章投稿",code:"article"}],step:1,type:"pick",saveParams:null,UPLOAD:new C.a({type:2}),source:""}},computed:{uploadObj:function(){var t="text"===this.activeTab;return{multiple:t,limit:t?20:1}}},watch:{$route:{handler:function(t){this.handleClose()}}},mounted:function(){var t=this;this.$EventBus.$on("openCreativeCenterModal",(function(e){t.openModal(e)}))},beforeDestroy:function(){this.$EventBus.$off("openCreativeCenterModal"),this.saveParams=null},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.resetData(),this.initData(t),this.visible=!0},initData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.saveParams=e;var n=e.list,o=void 0===n?[]:n,r=e.type,l=void 0===r?"text":r,c=e.source,source=void 0===c?"":c;this.activeTab=l,this.source=source,"text"===l&&null!=o&&o.length&&(this.handleStep(2),"swift_ai"!=source&&"face_swap_gif"!=source||(this.type="upload"),this.$nextTick((function(){var n=(o||[]).map((function(t){return t.type="check",t}));t.$refs.handleTextEdit.updateList(n),t.$refs.handleTextEdit.updateParams(e)}))),"video"===l&&null!=o&&o.length&&(this.handleStep(2),this.$nextTick((function(){var e=null==o?void 0:o[0];t.$refs.handleVideoEdit.remotePost(e)}))),"article"===l&&null!=e&&e.id&&(this.handleStep(2),this.$nextTick((function(){t.$refs.handleArticleEdit.handleEdit(e)})))},changeType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.type=t},openPickWorkModal:function(){this.$refs.HyUploadMoaldRef.openModal()},resetData:function(){this.menuIndex="textToImage",this.activeTab="text",this.step=1,this.type="pick",this.saveParams=null},handleClose:function(){this.visible=!1},handleTabClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activeTab=t.code||""},handleStep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.step=t},handleSelectArtWork:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t.type="check",t}));this.handleStep(2),this.$nextTick((function(){"text"===t.activeTab?t.$refs.handleTextEdit.updateList(e):t.$refs.handleArticleEdit.updateList(e)}))},jumpToVideoEdit:function(t){var e=this;this.$nextTick((function(){e.$refs.handleVideoEdit.updateVideoFile(t)}))},jumpToTextEdit:function(t){var e=this;this.$nextTick((function(){e.$refs.handleTextEdit.updateImageFile(t)}))},jumpToArticleEdit:function(t){var e=this;this.$nextTick((function(){e.$refs.handleArticleEdit.updateImageFile(t)}))}}},k=w,L=(n(4488),n(0)),component=Object(L.a)(k,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"c-creative-center-popup",attrs:{visible:t.visible,fullscreen:"","destroy-on-close":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"creative-center-body"},[e("head-bar",{on:{closePopup:t.handleClose}}),t._v(" "),e("div",{staticClass:"main-content"},[e("creative-center-menu",{ref:"creativeCenterMenu",attrs:{"menu-index":t.menuIndex}}),t._v(" "),e("div",{staticClass:"creative-center-content-container"},[e("div",{staticClass:"creative-center-content"},[1===t.step?[e("div",{staticClass:"container-header"},t._l(t.tabList,(function(n){return e("div",{key:n.code,staticClass:"tab-item",class:[t.activeTab===n.code?"tab-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleTabClick(n)}}},[t._v("\n                "+t._s(t.$t(n.i18nKey))+"\n              ")])})),0),t._v(" "),e("div",{staticClass:"uploader-container"},["text"===t.activeTab?e("handle-text",{on:{changeStep:t.handleStep,openPickWorkModal:t.openPickWorkModal}}):t._e(),t._v(" "),"video"===t.activeTab?e("handle-video",{on:{changeStep:t.handleStep}}):t._e(),t._v(" "),"article"===t.activeTab?e("handle-article",{on:{changeStep:t.handleStep,openPickWorkModal:t.openPickWorkModal}}):t._e()],1)]:t._e(),t._v(" "),2===t.step?["text"===t.activeTab?e("handle-text-edit",{ref:"handleTextEdit",on:{changeStep:t.handleStep}}):t._e(),t._v(" "),"video"===t.activeTab?e("handle-video-edit",{ref:"handleVideoEdit",on:{changeStep:t.handleStep}}):t._e(),t._v(" "),"article"===t.activeTab?e("handle-article-edit",{ref:"handleArticleEdit",on:{changeStep:t.handleStep}}):t._e()]:t._e()],2)])],1)],1),t._v(" "),["text","article"].includes(t.activeTab)?e("pick-work-modal",{ref:"pickWorkModal",attrs:{type:"contribute",maxNum:"text"==t.activeTab?20:1},on:{confirm:t.handleSelectArtWork}}):t._e(),t._v(" "),e("HyUploadMoald",{ref:"HyUploadMoaldRef",attrs:{category:"text"===t.activeTab?44:50,isSingleSelect:"article"===t.activeTab,isMultiSelect:"text"===t.activeTab,uploadObj:t.uploadObj},on:{onConfirm:t.handleSelectArtWork}})],1)}),[],!1,null,"03f163b2",null);e.default=component.exports;installComponents(component,{CreativeCenterMenu:n(1177).default})},5680:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13);var o=n(2),r=(n(6),n(16),n(449),n(306),n(307),n(8),n(4),n(21),n(7),n(25)),l=n(1),c=n(54),d=n(3359),h=n(3366),v=n(3368),f=n(3369),m=n(3370),_=n(3371),y=n(3372);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var w={name:"Contribution",components:{ResourceSelector:d.default,PublishWork:h.default,PublishLocalVideo:v.default,PublishArticle:f.default,PublishCharacter:m.default,PublishModelCheckpoint:_.default,PublishModelLora:y.default},mounted:function(){var t=this;this.$EventBus.$on("openContribution",(function(e){return t.openContribution(e)}))},beforeDestroy:function(){this.$EventBus.$off("openContribution")},data:function(){return{CONTRIBUTION_TYPE_ENUM:c.CONTRIBUTION_TYPE_ENUM,resourceSelectorVisible:!1,enabledTypeList:c.CONTRIBUTION_TYPE_LIST,publishVisible:Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},c.CONTRIBUTION_TYPE_ENUM.WORK,!1),c.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO,!1),c.CONTRIBUTION_TYPE_ENUM.ARTICLE,!1),c.CONTRIBUTION_TYPE_ENUM.CHARACTER,!1),c.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT,!1),c.CONTRIBUTION_TYPE_ENUM.MODEL_LORA,!1),source:"",linkActivity:{},selectedData:[],remoteParams:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["isLoggedIn"])),methods:{openContribution:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isLoggedIn){console.log("contributionParams",t);var e=t.types,n=void 0===e?[]:e,o=t.source,source=void 0===o?"":o,r=t.linkActivity,l=void 0===r?{}:r,d=t.selectedData,h=void 0===d?[]:d,v=t.remoteParams,f=void 0===v?{}:v;return this.source=source,this.linkActivity=l,0===n.length?(this.selectedData=[],this.remoteParams={},this.enabledTypeList=c.CONTRIBUTION_TYPE_LIST.filter((function(t){return c.SUPPORT_NO_ACTIVITY_TYPE_LIST.includes(t.value)})),void(this.resourceSelectorVisible=!0)):n.length>1?(this.selectedData=[],this.remoteParams={},this.updateEnabledTypeList(n),void(this.resourceSelectorVisible=!0)):n[0]===c.CONTRIBUTION_TYPE_ENUM.WORK?(this.updateEnabledTypeList(n),void(Object.keys(f).length||h.length?(this.remoteParams=f,this.selectedData=h,this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.WORK]=!0):(this.remoteParams={},this.selectedData=[],this.resourceSelectorVisible=!0))):n[0]===c.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO?(this.updateEnabledTypeList(n),void(Object.keys(f).length?(this.remoteParams=f,this.selectedData=[],this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO]=!0):(this.remoteParams={},this.selectedData=[],this.resourceSelectorVisible=!0))):n[0]===c.CONTRIBUTION_TYPE_ENUM.ARTICLE?(this.updateEnabledTypeList(n),void(Object.keys(f).length?(this.remoteParams=f,this.selectedData=[],this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.ARTICLE]=!0):(this.remoteParams={},this.selectedData=[],this.resourceSelectorVisible=!0))):n[0]===c.CONTRIBUTION_TYPE_ENUM.CHARACTER?(this.updateEnabledTypeList(n),void(h.length?(this.selectedData=h,this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.CHARACTER]=!0):(this.selectedData=[],this.resourceSelectorVisible=!0))):n[0]===c.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT?(this.updateEnabledTypeList(n),void(h.length?(this.selectedData=h,this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT]=!0):(this.selectedData=[],this.resourceSelectorVisible=!0))):n[0]===c.CONTRIBUTION_TYPE_ENUM.MODEL_LORA?(this.updateEnabledTypeList(n),void(h.length?(this.selectedData=h,this.publishVisible[c.CONTRIBUTION_TYPE_ENUM.MODEL_LORA]=!0):(this.selectedData=[],this.resourceSelectorVisible=!0))):void 0}this.$EventBus.$emit("openLoginDialog")},updateEnabledTypeList:function(t){this.enabledTypeList=c.CONTRIBUTION_TYPE_LIST.filter((function(e){return t.includes(e.value)}))},cloneSelectedData:function(data){return null==data||data instanceof File||data instanceof Blob||data instanceof FileList||data instanceof FormData||data instanceof ArrayBuffer||data instanceof DataView||data instanceof ImageData?data:Object(r.cloneDeep)(data)},openPublish:function(t,e){var n=this;Object.keys(this.publishVisible).forEach((function(e){n.publishVisible[e]=e===t})),this.selectedData=this.cloneSelectedData(e)},clearRemoteParams:function(){this.remoteParams={id:this.remoteParams.id||void 0}},confirmSelect:function(t){var e=t.type,n=t.selectedData;this.updateEnabledTypeList([e]),this.clearRemoteParams(),this.openPublish(e,n)},reselectData:function(t){this.selectedData=t,this.resourceSelectorVisible=!0},selectedDataChange:function(t){this.selectedData=t}}},k=w,L=(n(4507),n(0)),component=Object(L.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"contribution-container"},[e("ResourceSelector",{attrs:{visible:t.resourceSelectorVisible,enabledTypeList:t.enabledTypeList,selectedData:t.selectedData,linkActivity:t.linkActivity},on:{"update:visible":function(e){t.resourceSelectorVisible=e},confirmSelect:t.confirmSelect}}),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.WORK]?e("PublishWork",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.WORK],source:t.source,linkActivity:t.linkActivity,selectedList:t.selectedData,remoteParams:t.remoteParams},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.WORK,e)},reselectData:t.reselectData,selectedDataChange:t.selectedDataChange}}):t._e(),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO]?e("PublishLocalVideo",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO],source:t.source,linkActivity:t.linkActivity,selectedFile:t.selectedData,remoteParams:t.remoteParams},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.LOCAL_VIDEO,e)}}}):t._e(),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.ARTICLE]?e("PublishArticle",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.ARTICLE],source:t.source,linkActivity:t.linkActivity,selectedList:t.selectedData,remoteParams:t.remoteParams},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.ARTICLE,e)},reselectData:t.reselectData,selectedDataChange:t.selectedDataChange}}):t._e(),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.CHARACTER]?e("PublishCharacter",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.CHARACTER],source:t.source,linkActivity:t.linkActivity,selectedList:t.selectedData},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.CHARACTER,e)},reselectData:t.reselectData,selectedDataChange:t.selectedDataChange}}):t._e(),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT]?e("PublishModelCheckpoint",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT],source:t.source,linkActivity:t.linkActivity,selectedList:t.selectedData},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.MODEL_CHECKPOINT,e)},reselectData:t.reselectData,selectedDataChange:t.selectedDataChange}}):t._e(),t._v(" "),t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.MODEL_LORA]?e("PublishModelLora",{attrs:{visible:t.publishVisible[t.CONTRIBUTION_TYPE_ENUM.MODEL_LORA],source:t.source,linkActivity:t.linkActivity,selectedList:t.selectedData},on:{"update:visible":function(e){return t.$set(t.publishVisible,t.CONTRIBUTION_TYPE_ENUM.MODEL_LORA,e)},reselectData:t.reselectData,selectedDataChange:t.selectedDataChange}}):t._e()],1)}),[],!1,null,"3a199245",null);e.default=component.exports},5681:function(t,e,n){"use strict";n.r(e);var o=n(2);n(11),n(6),n(32),n(12),n(13),n(8),n(4),n(7),n(26);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c={data:function(){return{list:[],Timeing:null,typeKey:"",collectDotReportInfo:{}}},components:{CollectPopover:n(63).default},methods:{openTime:function(){var t=this,e=-1;this.list.length>0&&!this.Timeing&&(this.Timeing=setInterval((function(){var n;(e++,null!==(n=t.list[e])&&void 0!==n&&n.isChangeShow||e++,t.list[e])?(t.$refs.msgItem[e].style.opacity=0,setTimeout((function(){(t.list[e].show=!1,t.list.length-1<=e)&&(clearInterval(t.Timeing),t.Timeing=null,t.list.every((function(t){return!1===t.show}))&&(t.list=[]))}),300)):t.list.length-1<=e&&(clearInterval(t.Timeing),t.Timeing=null,t.list.every((function(t){return!1===t.show}))&&(t.list=[]))}),3e3))},permItem:function(t){this.list[t].isChangeShow=!1,clearTimeout(this.list[t].closeTime),this.list[t].closeTime=null,delete this.list[t].closeTime},closeItem:function(t){var e,n,o=this;null!==(e=this.$refs.collectPopover[t])&&void 0!==e&&e.visible||null!==(n=this.$refs.collectPopover[t])&&void 0!==n&&n.createShow||(this.list[t].isChangeShow=!0,this.list[t].closeTime=setTimeout((function(){var e;null!==(e=o.list[t])&&void 0!==e&&e.isChangeShow&&(o.list[t].show=!1),o.list.every((function(t){return!1===t.show}))&&(o.list=[])}),3e3))},setBottom:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.$refs.msgItem.forEach((function(e,n){e.style.bottom="".concat(60*(t.$refs.msgItem.length-1-n)+20,"px"),e.style.opacity=1}))}),100)}))}},mounted:function(){var t=this;this.$EventBus.$on("setCollectMsgBox",(function(e,n,o){t.typeKey=n,t.list.find((function(t){return t.id===e.id}))||(t.collectDotReportInfo=l(l({},o),{},{action:"collection",obj_no:e.id,obj_type:1}),t.$set(e,"show",!0),t.$set(e,"isChangeShow",!0),t.list.push(e),t.setBottom(),t.Timeing||t.openTime())}))},beforeDestroy:function(){this.$EventBus.$off("setCollectMsgBox")}},d=(n(4508),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",t._l(t.list,(function(n,o){return e("div",{directives:[{name:"show",rawName:"v-show",value:n.show,expression:"item.show"}],key:o,ref:"msgItem",refInFor:!0,staticClass:"CollectMsgBox",on:{mouseover:function(e){return t.permItem(o)},mouseout:function(e){return t.closeItem(o)}}},[e("div",{staticClass:"left"},[e("i",{staticClass:"el-icon-success"}),t._v(" "),e("span",[t._v(t._s(t.$t("CollectedSuccess")))])]),t._v(" "),e("CollectPopover",{ref:"collectPopover",refInFor:!0,attrs:{triggerMode:"click",hideBtn:!0,type:t.typeKey,folder:n,dotReportInfo:t.collectDotReportInfo,from:"waterfall"},on:{closeMask:function(e){return t.closeItem(o)}}},[e("div",{staticClass:"right"},[e("span",[t._v(t._s(t.$t("atb")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)})),0)}),[],!1,null,"2879e366",null);e.default=component.exports;installComponents(component,{CollectPopover:n(63).default})},573:function(t,e,n){"use strict";n.r(e);n(6),n(16),n(18),n(4),n(11),n(12),n(13),n(8);var o=n(14),r=n(2),l=(n(19),n(21),n(7),n(27)),c=n(10),d=n(249),h=n(201),v=n(36),f=n(56),m=n(1),_=n(45),y=n(574),C=n(171),w=n(254),k=n(58);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={mixins:[_.a],name:"CollectionBookmarks",inject:["app"],components:{CollectionCreate:d.default,WaterFallVue:h.default,EditTitle:y.default,homeList:C.a,NoData:w.default},props:{isOpen:{type:Boolean,default:!0},type:{type:String,default:"artwork"},account_no:{type:String,default:""},category:{type:Boolean,default:!0},wraperShow:{type:Boolean,default:!0}},computed:O(O(O(O({},Object(m.e)("user",["userInfo"])),Object(m.c)("user",["isLoggedIn"])),Object(m.e)("app",["topBanner"])),{},{getThreshold:function(){return this.app.bannerTotallyShow?108:62},shutterOffset:function(){return function(t){return"-"+12*(5-t)}},isNoData:function(){return this.getReady&&0==this.list.length}}),data:function(){return{formatTime:k.c,noSearchData:!1,collectionList:[],createShow:!1,isTiemRow:!1,replaceImageType:c.K,filterImgType:[],checkMaxNum:-1,isFilterNSFW:!1,queryParam:{page:1,page_size:35,type:"bookmarks",order_by:"new",folder_no:"default",keyword:"",start_at:0,end_at:0,after:0,artwork_types:[]},formData:{type:""},list:[],isLoading:!0,isLock:!1,isReq:!1,isCheck:!1,editData:{},checkList:{},dotReportInfo:{category:"default",view_domain:"personal_center",batch_id:""},listDef:!1,getReady:!1}},watch:{type:{handler:function(t){this.intData()}},category:{handler:function(t){this.intData()}}},mounted:function(){this.intData()},activated:function(){this.list=Object(o.a)(this.list)},methods:{onChangeTitleBar:function(t){this.editSuccess(),this.$refs.WaterFallVue.isCheckAll=!1;var e=t.workType,n=t.searchKeyword,o=t.start_at,r=t.end_at,l=t.order_by,c=t.publish_status;e&&(this.queryParam.artwork_types=e),![void 0,void 0,null].includes(n)&&(this.queryParam.keyword=n),!["",void 0,void 0,null].includes(o)&&(this.queryParam.start_at=o),!["",void 0,void 0,null].includes(r)&&(this.queryParam.end_at=r),l&&(this.queryParam.order_by=l),!["",void 0,void 0,null].includes(c)&&(this.queryParam.publish_status=c),delete this.queryParam.time_to,this.list=[],this.isLock=!1,this.isReq=!1,this.queryParam.after=0,this.queryParam.page=1,this.getList()},checkAll:function(){this.$refs.WaterFallVue.checkAll()},getChecList:function(t){this.checkList=t},onEdit:function(t){"{}"===JSON.stringify(t)&&t.constructor===Object&&this.$logEvent("log_actions",{operation:"click_new_collection",behavior_info:"on_personal_center"}),this.editData=t,this.createShow=!0},editSuccess:function(){if(this.checkList.ids){var t=Object(o.a)(this.checkList.ids);this.$refs.WaterFallVue.clearCheck(t),this.queryParam.page=1}},intData:function(){this.queryParam.page=1,delete this.queryParam.time_to,this.list=[],this.isLock=!1,this.isReq=!1,this.queryParam.after=0,this.collectionList=[],this.$refs.editTitle&&(this.$refs.editTitle.isCheck=!1),this.getList(),this.getCollectionList()},getCollectionList:function(){var t=this;this.formData={type:{artwork:1,model:2,post:3,palette:4,workflow:5,swtft_app:6,character:7,ai_audio:9,ai_novel:21}[this.type]},this.account_no?this.formData.other_id=this.account_no:delete this.formData.other_id,this.category?this.formData.category=2:delete this.formData.category,Object(l.I)(this.formData).then((function(e){var n=e.data.items||[];n.forEach((function(element){if(1e4===e.status.code){element.imgList=[];var n={artwork:"artwork_items",model:"model_items",post:"post_items",palette:"tpl_items",workflow:"comfy_ui_items",swtft_app:"comfy_ui_items",character:"character_items",ai_audio:"timbre_items",ai_novel:"ebook_items"},o=element[n[t.type]]?element[n[t.type]]:null;o&&o.forEach((function(e){var n={url:1==e.status&&(2==e.primary||e.account_no==t.userInfo.id)&&e.banner&&e.banner.url?e.banner.url:null,nsfw:e.nsfw,id:e.id};element.imgList.push(n)}))}})),t.collectionList=n,t.account_no&&0==t.collectionList.length?t.listDef=!0:t.listDef=!1}))},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isLoading=!0,this.isReq=!0,this.queryParam.type="bookmarks",delete this.queryParam.source_type,this.account_no?this.queryParam.account_no=this.account_no:delete this.queryParam.account_no,this.category?this.queryParam.category=2:delete this.queryParam.category;var n="";"artwork"==this.type?n=v.artworkList:"model"==this.type?n=this.account_no?f.t:f.s:"post"==this.type?(delete this.queryParam.type,this.account_no&&(this.queryParam.act_id=this.account_no),n=l.rb):"palette"==this.type?(n=l.jb,this.account_no&&(this.queryParam.act_id=this.account_no)):"swtft_app"==this.type||"workflow"==this.type?(n=l.v,this.queryParam.source_type=7,"swtft_app"==this.type&&(this.queryParam.source_type=8),this.account_no&&(this.queryParam.act_id=this.account_no)):"character"==this.type?(this.queryParam.type=0,n=l.i):"ai_audio"==this.type?(this.queryParam.type=0,n=l.c):"ai_novel"==this.type&&(this.queryParam.source_types=[21],this.queryParam.type=21,n=v.getAiNovelCollect),n(this.queryParam).then((function(n){if(n.status&&150002===n.status.code)e.noSearchData=!0;else{if(e.noSearchData=!1,n.data.has_more?e.isLock=!1:e.isLock=!0,e.list=t?e.list.concat(n.data.items||[]):n.data.items||[],e.isReq=!1,1===e.queryParam.page&&(e.queryParam.time_to=n.data.time_ms),n.data.items.length>0){var o,r,l=n.data.items[n.data.items.length-1];e.queryParam.after=(null==l||null===(o=l.folder_no)||void 0===o?void 0:o.collect_at)||(null==l||null===(r=l.collect)||void 0===r?void 0:r.collect_at)}e.$emit("getlistbanner",e.list),e.queryParam.page++,e.isLoading=!1}})).catch((function(t){var code=t.code;e.noSearchData=150002===code,e.isReq=!1,e.isLoading=!1})).finally((function(){e.getReady=!0}))}},cancleCollect:function(t){this.list=this.list.filter((function(i){return i.id!==t.id})),this.getCollectionList()},goToCollectionDetail:function(t){this.$router.push({path:"/collectiondetail",query:{type:this.type,id:t.id,name:t.name,account_no:this.account_no?this.account_no:null,category:this.category?2:null}})}}},T=(n(4932),n(0)),component=Object(T.a)($,(function(){var t,e=this,o=e._self._c;return o("div",{staticClass:"CollectionBookmarks"},[o("div",{staticClass:"main"},[o("div",{staticClass:"collection"},[null!==(t=e.collectionList)&&void 0!==t&&t.length?o("div",{staticClass:"folder-title"},[o("div",{staticClass:"name"},[e._v("\n          "+e._s(e.$t(e.category?"portfolio":"Favorites"))+"\n          "),o("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),e.account_no?e._e():o("div",{staticClass:"create-btn flex-center",attrs:{"data-event":e.category?"click_create_portfolio":"click_create_favorite"},on:{click:function(t){return e.onEdit({})}}},[o("i",{staticClass:"el-icon-folder-add"}),e._v("\n          "+e._s(e.$t(e.category?"AddPortfolio":"AddFavorite"))+"\n        ")])]):e._e(),e._v(" "),e._l(this.collectionList.filter((function(i){return"default"!=i.id})),(function(t,r){return o("div",{key:r,staticClass:"collectionlist",on:{click:function(n){return e.goToCollectionDetail(t)}}},[o("div",{staticClass:"listItem"},["all"==t.id?o("div",{staticClass:"imgs"},e._l(5,(function(r,l){return o("div",{key:l,staticClass:"imgsitem",style:{transform:"translateX("+e.shutterOffset(r)+"%)",zIndex:5-r}},[t.imgList&&t.imgList[l]&&t.imgList[l].url?o("img",{staticClass:"imgslist",attrs:{decoding:"async",loading:"lazy",src:1==t.imgList[l].nsfw?n(217):e.replaceImageType(t.imgList[l].url,"low")}}):e._e()])})),0):o("div",{staticClass:"imgs"},[e._l(3,(function(r,l){return o("div",{key:l,staticClass:"myimgsitem"},[t.imgList&&t.imgList[l]&&t.imgList[l].url?o("img",{attrs:{decoding:"async",loading:"lazy",src:1==t.imgList[l].nsfw?n(217):e.replaceImageType(t.imgList[l].url,"low")}}):e._e()])})),e._v(" "),e.account_no?e._e():o("div",{staticClass:"edit",on:{click:function(n){return n.stopPropagation(),e.onEdit(t)}}},[o("i",{staticClass:"iconfont icon-icon-edit1"})])],2),e._v(" "),o("div",{staticClass:"infos"},[o("div",{staticClass:"name"},[o("span",[e._v(e._s(0!=r||e.account_no?t.name:e.category?e.$t("AllWorks"):e.$t("Allcollect")))]),e._v(" "),2==t.status?o("i",{staticClass:"iconfont icon-collectLock"}):e._e()]),e._v(" "),o("div",{staticClass:"count-time"},[o("div",{staticClass:"count"},[e._v(e._s(e.$t("NumContent",{num:(null==t?void 0:t.count)||0})))]),e._v(" "),o("div",{staticClass:"time"},[e._v(e._s(e.formatTime(null==t?void 0:t.update_at)))])])])])])}))],2),e._v(" "),e.wraperShow?o("EditTitle",{ref:"editTitle",attrs:{editShow:!e.account_no,title:e.category?e.$t("UnorganizedWorks"):e.$t("UnorganizedIdeas"),checkList:e.checkList,listLenth:e.account_no?e.list.length:e.category?e.setPortfolioList(e.list,"default").length:e.setCollectList(e.list,"default").length,threshold:e.getThreshold,titleSize:20,account_no:e.account_no,isOpen:e.isOpen,category:e.category,type:e.type,isScreen:e.category},on:{changeCheck:function(t){e.isCheck=t},checkAll:e.checkAll,editSuccess:function(t){return e.editSuccess()},changeTitleBar:e.onChangeTitleBar,newCreate:function(t){return e.getCollectionList()},changeTiemRow:function(t){return e.isTiemRow=t},ImgTypeChange:function(t){e.filterImgType=t,t.length>0?e.isFilterNSFW=!0:e.isFilterNSFW=!1,t.length>0?e.checkMaxNum=20:e.checkMaxNum=-1}}}):e._e(),e._v(" "),e.wraperShow?o("div",{ref:"wraper",staticClass:"wraper"},[["post","palette","swtft_app","workflow","character","ai_audio","ai_novel"].includes(e.type)?o("homeList",{ref:"WaterFallVue",attrs:{fromPage:"userPage",isOpen:e.isOpen,list:e.account_no?e.list:e.setCollectList(e.list,"default"),container:"wraper",dotReportInfo:e.dotReportInfo,isTiemRow:e.isTiemRow,isCheck:e.isCheck,type:e.type,cols:"swtft_app"==e.type||"workflow"==e.type?5:7},on:{load:function(t){return e.getList(!0)},getChecList:e.getChecList,onCancleCollect:e.cancleCollect}}):o("WaterFallVue",{ref:"WaterFallVue",attrs:{noSearchData:e.noSearchData,fromPage:"userPage",type:"artwork"==e.type?"artwork":"model",container:"wraper",list:e.account_no?e.list:e.category?e.setPortfolioList(e.list,"default"):e.setCollectList(e.list,"default"),lazy:!0,isTiemRow:e.isTiemRow,isCheck:e.isCheck,category:e.category,alreadyNoMoreData:e.isLock&&e.list.length>0,dotReportInfo:e.dotReportInfo,filterImgType:e.filterImgType,isFilterNSFW:e.isFilterNSFW,checkMax:e.checkMaxNum,needGridSource:!0},on:{load:function(t){return e.getList(!0)},getChecList:e.getChecList,newCreate:function(t){return e.getCollectionList()},reload:e.intData}})],1):e._e(),e._v(" "),e.isNoData&&e.listDef?o("NoData"):e._e()],1),e._v(" "),o("collection-create",{attrs:{editData:e.editData,category:e.category,type:e.type},on:{create:function(t){return e.getCollectionList()},delete:function(t){return e.getCollectionList()}},model:{value:e.createShow,callback:function(t){e.createShow=t},expression:"createShow"}})],1)}),[],!1,null,"20bc0db8",null);e.default=component.exports;installComponents(component,{EditTitle:n(574).default,NoData:n(129).default,CollectionCreate:n(249).default})},575:function(t,e,n){"use strict";n.r(e);var o={name:"DetailInfoTag",props:{detailInfoTagStyle:{type:Object,default:function(){return{}}},icon:{type:String,default:"icon-icon-huodongtag"},title:{type:String,default:""},pathData:{type:String,default:""}},methods:{handleClick:function(){this.pathData&&window.open(this.pathData,"_blank")}}},r=(n(4973),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail-info-tag",style:t.detailInfoTagStyle,on:{click:t.handleClick}},[e("i",{staticClass:"iconfont",class:t.icon}),t._v(" "),e("span",{staticClass:"detail-info-title"},[t._v(t._s(t.title))])])}),[],!1,null,"a333418c",null);e.default=component.exports},5832:function(t,e,n){"use strict";n.r(e);n(24);var o={name:"CCategorys",props:{categorys:{type:Array,default:function(){return[]}},currentCategory:{type:String,default:""},moveLength:{type:Number,default:100}},data:function(){return{}},methods:{changeCategory:function(t){this.$emit("changeCategory",t)},scrollMove:function(t){this.$refs.scrollArea.scrollBy({left:t,behavior:"smooth"})}}},r=(n(5641),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-category"},[e("div",{staticClass:"left-icon arrow",on:{click:function(e){return t.scrollMove("-".concat(t.moveLength))}}},[e("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),e("div",{ref:"scrollArea",staticClass:"categorys"},t._l(t.categorys,(function(n){return e("div",{key:n.value,staticClass:"item-category",class:{active:t.currentCategory==n.value},on:{click:function(e){return t.changeCategory(n)}}},[t._v("\n      "+t._s(t.$t(n.label))+"\n    ")])})),0),t._v(" "),e("div",{staticClass:"right-icon arrow",on:{click:function(e){return t.scrollMove(t.moveLength)}}},[e("i",{staticClass:"el-icon-arrow-right"})])])}),[],!1,null,"509f0d2e",null);e.default=component.exports},5833:function(t,e,n){"use strict";n.r(e);n(6),n(18),n(4),n(11),n(12),n(13),n(8);var o=n(2),r=(n(7),n(1)),l=n(27),c=n(10),d=n(249);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={mixins:[n(45).a],name:"CollectionComponent",components:{CollectionCreate:d.default},props:{account_no:{type:String,default:""},category:{type:Boolean,default:!0}},computed:v(v(v({},Object(r.c)("user",["isLoggedIn"])),Object(r.e)("user",["userInfo"])),{},{shutterOffset:function(){return function(t){return"-"+12*(5-t)}}}),data:function(){return{collectionList:[],createShow:!1,replaceImageType:c.K}},watch:{},mounted:function(){this.isLoggedIn&&this.getCollectionList()},methods:{onEdit:function(t){this.editData=t,this.createShow=!0},getCollectionList:function(){var t=this;this.formData={type:{artwork:1,model:2,post:3,palette:4,workflow:5,swtft_app:6,character:7,ai_audio:9,ai_novel:21}[this.type]},this.account_no?this.formData.other_id=this.account_no:delete this.formData.other_id,this.category?this.formData.category=2:delete this.formData.category,Object(l.I)(this.formData).then((function(e){var n=e.data.items||[];n.forEach((function(element){if(1e4===e.status.code){element.imgList=[];var n={artwork:"artwork_items",model:"model_items",post:"post_items",palette:"tpl_items",workflow:"comfy_ui_items",swtft_app:"comfy_ui_items",ai_novel:"ebook_items"},o=element[n[t.type]]?element[n[t.type]]:null;o&&o.forEach((function(e){var n={url:1==e.status&&(2==e.primary||e.account_no==t.userInfo.id)&&e.banner&&e.banner.url?e.banner.url:null,nsfw:e.nsfw,id:e.id};element.imgList.push(n)}))}})),t.collectionList=n}))}}},m=(n(5642),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"collection"},[e("div",{staticClass:"collection"},[t.account_no?t._e():e("div",{staticClass:"collectionlist",on:{click:function(e){return t.onEdit({})}}},[e("div",{staticClass:"listItem add"},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("div",{staticClass:"text"},[t._v("\n          "+t._s(t.$t(t.category?"AddPortfolio":"AddFavorite"))+"\n        ")])])]),t._v(" "),t._l(this.collectionList.filter((function(i){return"default"!=i.id})),(function(o,r){return e("div",{key:r,staticClass:"collectionlist",on:{click:function(e){return t.$router.push({path:"/collectiondetail",query:{type:t.type,id:o.id,name:o.name,account_no:t.account_no?t.account_no:null,category:t.category?2:null}})}}},[e("div",{staticClass:"listItem"},["all"==o.id?e("div",{staticClass:"imgs"},t._l(5,(function(r,l){return e("div",{key:l,staticClass:"imgsitem",style:{transform:"translateX("+t.shutterOffset(r)+"%)",zIndex:5-r}},[o.imgList&&o.imgList[l]&&o.imgList[l].url?e("img",{staticClass:"imgslist",attrs:{decoding:"async",loading:"lazy",src:1==o.imgList[l].nsfw?n(217):t.replaceImageType(o.imgList[l].url,"low")}}):t._e()])})),0):e("div",{staticClass:"imgs"},[t._l(3,(function(r,l){return e("div",{key:l,staticClass:"myimgsitem"},[o.imgList&&o.imgList[l]&&o.imgList[l].url?e("img",{attrs:{decoding:"async",loading:"lazy",src:1==o.imgList[l].nsfw?n(217):t.replaceImageType(o.imgList[l].url,"low")}}):t._e()])})),t._v(" "),t.account_no?t._e():e("div",{staticClass:"edit",on:{click:function(e){return e.stopPropagation(),t.onEdit(o)}}},[e("i",{staticClass:"iconfont icon-icon-edit1"})])],2),t._v(" "),e("div",{staticClass:"infos"},[e("div",{staticClass:"name"},[e("span",[t._v(t._s(0!=r||t.account_no?o.name:t.category?t.$t("AllWorks"):t.$t("Allcollect")))]),t._v(" "),2==o.status?e("i",{staticClass:"iconfont icon-collectLock"}):t._e()])])])])}))],2),t._v(" "),e("collection-create",{attrs:{editData:t.editData,category:t.category,type:t.type},on:{create:function(e){return t.getCollectionList()},delete:function(e){return t.getCollectionList()}},model:{value:t.createShow,callback:function(e){t.createShow=e},expression:"createShow"}})],1)}),[],!1,null,"7f2d20c6",null);e.default=component.exports;installComponents(component,{CollectionCreate:n(249).default})},5834:function(t,e,n){"use strict";n.r(e);n(16),n(49),n(21);var o={name:"CommonQA",props:{questions:{type:Array,default:function(){return[]}}},computed:{isOpen:function(){var t=this;return function(e){return t.openAnswers.includes(e)}}},data:function(){return{openAnswers:[]}},mounted:function(){},methods:{toggleAnswer:function(t){this.openAnswers.includes(t)?this.openAnswers.splice(this.openAnswers.indexOf(t),1):(this.$logEvent("log_actions",{operation:"click_enterprise_services_Q&A",behavior_info:"Q".concat(t+1)}),this.openAnswers.push(t))}}},r=(n(5643),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"qa-content"},t._l(t.questions,(function(n,i){return e("div",{key:"questions_".concat(i),staticClass:"qa-item",class:{open:t.isOpen(i)},on:{click:function(e){return t.toggleAnswer(i)}}},[e("div",{staticClass:"qa-title"},[e("span",{staticClass:"title-text"},[t._v(t._s(n.title))]),t._v(" "),e("span",{staticClass:"title-icon"},[e("i",{staticClass:"el-icon-arrow-right",class:{open:t.isOpen(i)}})])]),t._v(" "),e("div",{staticClass:"qa-answer flex flex-col"},[e("div",{staticClass:"qa-answer-main"},[t._v(t._s(n.answerMain))]),t._v(" "),t._l(n.answerSub,(function(line,n){return e("div",{key:"ques_ans".concat(n),staticClass:"qa-answer-line"},[t._v("\n        "+t._s(line)+"\n      ")])}))],2)])})),0)}),[],!1,null,"2e1f4c86",null);e.default=component.exports},5835:function(t,e,n){"use strict";n.r(e);n(24),n(65);var o={name:"CustomSlider",props:{value:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showLabels:{type:Boolean,default:!1},decimal:{type:Number,default:2}},data:function(){return{isDragging:!1}},methods:{formatValue:function(t){return Number(t).toFixed(this.decimal)},startDrag:function(t){this.isDragging=!0,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.stopDrag),this.onDrag(t)},stopDrag:function(){this.isDragging=!1,document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.stopDrag)},onDrag:function(t){if(this.isDragging){var rect=this.$refs.sliderBar.getBoundingClientRect(),e=(t.clientX-rect.left)/rect.width;e=Math.max(0,Math.min(1,e));var n=this.min+(this.max-this.min)*e;n=Math.round(n/this.step)*this.step,n=Math.max(this.min,Math.min(this.max,n)),this.$emit("input",n),this.$emit("change",n)}}}},r=(n(5644),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-slider"},[e("div",{staticClass:"slider-tooltip",style:{left:"".concat(t.value/t.max*100,"%")}},[t._v("\n    "+t._s(t.formatValue(t.value))+"\n  ")]),t._v(" "),e("div",{ref:"sliderBar",staticClass:"slider-bar",on:{mousedown:t.startDrag}},[e("div",{staticClass:"slider-progress",style:{width:"".concat(t.value/t.max*100,"%")}}),t._v(" "),e("div",{staticClass:"slider-button",style:{left:"".concat(t.value/t.max*100,"%")}})]),t._v(" "),t.showLabels?e("div",{staticClass:"slider-labels"},[e("span",[t._v(t._s(t.min))]),t._v(" "),e("span",[t._v(t._s(t.max))])]):t._e()])}),[],!1,null,"038d55e8",null);e.default=component.exports},605:function(t,e,n){"use strict";n.r(e);n(4);var o=n(3),r=(n(20),n(32),n(50),n(49),n(18),n(26),n(51)),l=n(61),c=n(10),d={name:"UploadImageItem",props:["value","createId","max","showUpload"],inject:["top"],components:{ViewImage:n(209).a},data:function(){return{replaceImageType:c.K,isUploading:!1,accept:".jpg,.jpeg,.png,.svg,.webp,.bmp,.tif",fileList:[],tempList:[],batchSize:2,selectedFilesCount:0,bigMediaShow:!1,bigMediaUrl:"",dragIndex:-1}},computed:{showImgLoading:function(){return function(img){return!img.tags&&!img.disabled_tag&&"check"!=img.type&&(100!=img.uploadStatus||!img.error&&!img.ready)}}},watch:{value:function(t){t&&this.$set(this,"fileList",t)}},mounted:function(){this.value&&this.$set(this,"fileList",this.value)},methods:{isVideoLink:c.G,curstomUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isUploading=!0,!((o=t.file).size/1024/1024>2)){n.next=14;break}return n.prev=3,n.next=6,Object(l.a)(o,2097152);case 6:o=n.sent,n.next=14;break;case 9:return n.prev=9,n.t0=n.catch(3),console.error("Compression failed:",n.t0),e.isUploading=!1,n.abrupt("return");case 14:return n.next=16,e.checkImageSize(o);case 16:c=n.sent,e.addFileByUpload(o).then((function(t){var n=new r.a({type:2});n.startUpload(o,{category:44,size:o.size}).then((function(o){var r=e.fileList.find((function(e){return e.imageId===t}));r.url=o,r.uploadStatus=100,r.ready=!0,r.file_id=n.fileId,r.width=c.width,r.height=c.height})).catch((function(n){var o=e.fileList.findIndex((function(e){return e.imageId===t}));e.deleteFile(o)})).finally((function(){e.isUploading=!1}))}));case 18:case"end":return n.stop()}}),n,null,[[3,9]])})))()},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t=img.naturalWidth,n=img.naturalHeight;e({width:t,height:n})},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},handleOpenPickArtWorkModal:function(){this.fileList.length>=this.max||this.$emit("openPickWorkModal",this.fileList)},handleChange:function(t,e){var n=this;this.tempList=e,this.$emit("input",this.fileList),setTimeout((function(){n.$emit("handleChange",n.fileList)}),500)},addFileByUpload:function(t){var e=this;return new Promise((function(n,o){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){var o={imageId:e.fileList.length+t.name,uploadStatus:0,ready:!1};e.fileList.push(o),n(o.imageId)},r.onerror=function(t){return o(t)}}))},addFile:function(t){var e=t.imageId,n=t.url;this.fileList.push({file_id:e,url:n,uploadStatus:100,ready:!0})},updateProgress:function(t,e){var n=t.loaded,o=t.total,r=Math.round(n/o*100),l=this.fileList.findIndex((function(t){return t.file_id==e.file_id}));l>-1&&(this.fileList[l].uploadStatus=r)},clear:function(){var t=this;this.$confirm(this.$t("DeleteAllFiles"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.fileList=[],t.$emit("clearAll",t.fileList),t.$emit("handleChange",t.fileList)})).catch((function(){}))},deleteFile:function(t){var e=this.fileList[t];this.fileList.splice(t,1),this.$emit("delete",e),this.$emit("handleChange",this.fileList)},fileExceed:function(){this.$message({type:"warning",message:this.$t("CreativeCenterPopup20",{number:this.max})})},refreshUpload:function(t){var e=this.fileList[t].file_id;this.fileList[t].error=!1,this.fileList[t].uploadStatus=0,e?this.startUpload(e):this.getUploadSign(e)},imgError:function(t){this.$refs[t.url][0].src=t.url},viewBigMedia:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image",n=arguments.length>2?arguments[2]:void 0;this.bigMediaUrl=t.url,"video"===e?this.bigMediaShow=!0:this.$refs.viewImage.show(this.bigMediaUrl,n.target)},dragstart:function(t,e){t.dataTransfer.setData("text/plain",""),this.dragIndex=e},dragenter:function(t,e){if(t.preventDefault(),this.dragIndex!==e){var n=this.fileList[this.dragIndex];this.fileList.splice(this.dragIndex,1),this.fileList.splice(e,0,n),this.dragIndex=e,this.$emit("handleChange",this.fileList)}},dragover:function(t){t.preventDefault()},drop:function(t){t.preventDefault()}}},h=d,v=(n(4480),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-image-item flex flex-col"},[e("div",{staticClass:"upload-content flex flex-wrap"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.isUploading,expression:"isUploading"},{name:"show",rawName:"v-show",value:"upload"===t.showUpload&&t.fileList.length<t.max,expression:"showUpload === 'upload' && fileList.length < max"}],ref:"imageUpload",staticClass:"upload-image",attrs:{action:"/",disabled:t.fileList.length==t.max,drag:"",multiple:"","http-request":t.curstomUpload,limit:20,"on-exceed":t.fileExceed,accept:t.accept,"show-file-list":!1,"on-change":t.handleChange}},[e("i",{staticClass:"el-icon-plus"})]),t._v(" "),"pick"===t.showUpload&&t.fileList.length<t.max?e("div",{staticClass:"upload-image upload-image-btn",on:{click:function(e){return e.stopPropagation(),t.handleOpenPickArtWorkModal.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",{staticClass:"upload-image-btn-text"},[t._v(t._s(t.$t("CreativeCenterPopup21")))])]):t._e(),t._v(" "),t._l(t.fileList,(function(img,i){return[e("div",{key:"upload_".concat(i),staticClass:"image-item flex",attrs:{draggable:!0},on:{dragenter:function(e){return t.dragenter(e,i)},dragover:function(e){return t.dragover(e)},dragstart:function(e){return t.dragstart(e,i)},drop:t.drop}},[e("div",{staticClass:"img-handle"},[e("i",{staticClass:"el-icon-rank"}),t._v(" "),e("span",[e("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.deleteFile(i)}}}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:img.error,expression:"img.error"}],staticClass:"el-icon-refresh-left refresg-icon",on:{click:function(e){return t.refreshUpload(i)}}})])]),t._v(" "),img.url&&!t.isVideoLink(img.url)?e("img",{ref:img.url,refInFor:!0,attrs:{src:t.replaceImageType(img.url,"low")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),e.target!==e.currentTarget?null:t.viewBigMedia(img,"image",e)},mousedown:function(t){t.preventDefault()},error:function(e){return t.imgError(img)}}}):img.url?e("video",{attrs:{src:img.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{click:function(e){return e.stopPropagation(),e.target!==e.currentTarget?null:t.viewBigMedia(img,"video",e)}}}):t._e(),t._v(" "),t.showImgLoading(img)?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.showImgLoading(img),expression:"showImgLoading(img)"}],staticClass:"loading"}):t._e()])]}))],2),t._v(" "),t.fileList.length>0?e("el-button",{staticClass:"clear text-right",attrs:{type:"text"},on:{click:t.clear}},[e("i",{staticClass:"iconfont icon-moveDelete"}),t._v("\n    "+t._s(t.$t("DeleteAll"))+"\n  ")]):t._e(),t._v(" "),t.bigMediaShow&&t.bigMediaUrl?e("div",{staticClass:"bigMedia",on:{click:function(e){t.bigMediaShow=!1}}},[e("video",{attrs:{src:t.bigMediaUrl,autoplay:"",loop:"",controls:!1,muted:""},domProps:{muted:!0},on:{click:function(t){t.stopPropagation()}}}),t._v(" "),t._m(0)]):t._e(),t._v(" "),e("view-image",{ref:"viewImage"})],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"videoClear"},[t("i",{staticClass:"el-icon-close"})])}],!1,null,"40586532",null);e.default=component.exports},63:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(12),n(13),n(8);var o=n(2),r=(n(6),n(16),n(4),n(21),n(7),n(27)),l=n(10),c=n(45),d=n(249),h=n(1),v=n(35),f=n.n(v),m=(n(39),n(36));function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={mixins:[c.a],components:{CollectionCreate:d.default},props:{folder:{type:Object,default:function(){return{}}},type:{type:String,default:"artwork"},hideBtn:{type:Boolean,default:!1},triggerMode:{type:String,default:"click"},from:{type:String,default:""},dotReportInfo:{type:Object,default:function(){return{view_domain:"",batch_id:"",action:"",obj_no:"",obj_type:1,negative_ids:[],category:"default"}}}},data:function(){return{visible:!1,folderlist:[],keyword:"",folderCollectList:{artwork:[],model:[],post:[]},createShow:!1,onloading:!1,isLoding:!1,replaceImageType:l.K,collectTagList:[],typeKeys:{artwork:1,model:2,gallery:3,post:3,lookbook:3,palette:4,workflow:5,swtft_app:6,character:7,ai_video:15,ai_audio:9,ai_novel:21}}},computed:y(y(y({},Object(h.c)("user",["folderCollect","isLoggedIn"])),Object(h.e)("user",["userInfo","collectData"])),{},{setFolderName:function(){var t,e=this,n=this.collectData,o=function(t){var n=t&&t.collect?t.collect.collection_name:e.$t("collectCreate2");return"default"==n?e.$t("UnorganizedIdeas"):n||e.$t("UnorganizedIdeas")};return n&&n.ids&&n.ids.includes(null===(t=this.folder)||void 0===t?void 0:t.id)?o(n):o(this.folder)},filteredList:function(){var t,e=this;return null===(t=this.folderlist)||void 0===t?void 0:t.filter((function(t){return t.name.includes(e.keyword)&&"all"!=t.id&&"default"!=t.id&&t.id!==(e.folder.collect&&e.folder.collect.collection_id)}))}}),watch:{visible:{handler:function(t){t&&this.isLoggedIn&&("artwork"==this.type&&this.$logEvent("log_actions",{operation:"quick_collect",behavior_info:"favorites_pop",behavior_info_sub:this.folder.id}),this.folderCollectList=f()(this.folderCollect),this.onloading=!0,this.getCollectionList(),this.getCollectTagList()),t||this.$emit("closeMask")}}},methods:y(y({},Object(h.d)("user",["SET_FOLDER_COLLECT"])),{},{getCollectTagList:function(){var t,e=this,n={};console.log("this.type",this.type),n.obj_type={artwork:1,model:2,gallery:4,post:4,lookbook:5,character:9,palette:11,workflow:13,swtft_app:13,ai_video:15,ai_audio:16,ai_novel:21}[this.type]||"",n.obj_id=null===(t=this.folder)||void 0===t?void 0:t.id,Object(m.getCollectTagList)(n).then((function(t){var n,o,r;t&&1e4!==(null==t||null===(n=t.status)||void 0===n?void 0:n.code)||(e.collectTagList=Array.isArray(null==t||null===(o=t.data)||void 0===o?void 0:o.items)?null==t||null===(r=t.data)||void 0===r?void 0:r.items:[])})).finally((function(){}))},handleFastCreate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createShow=!0;try{this.$refs.collectionCreate.formData.name=t.title||""}catch(t){}},handleShow:function(){this.$emit("showChaneg",{show:!0,id:this.folder.id})},newCreate:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.visible=!1,["",null,void 0].includes(null==data?void 0:data.name)||this.$message.success(this.$t("collectCreate4",{name:null==data?void 0:data.name})),this.$emit("newCreate")},getCollectionList:function(){var t=this,e={type:this.typeKeys[this.type]};Object(r.J)(e).then((function(e){var n;t.onloading=!1;var o=f()(e.data.items);o.forEach((function(element){element.imgList=[];var e={artwork:"artwork_items",model:"model_items",post:"post_items",palette:"tpl_items",comfy:"comfy_ui_items",ai_novel:"ebook_items"},n=element[e[t.type]]?element[e[t.type]]:null;if(n){var o={url:1==n.status&&(2==n.primary||n.account_no==t.userInfo.id)&&n.banner&&n.banner.url?n.banner.url:null,nsfw:n.nsfw,id:n.id};element.imgList.push(o)}})),t.folderlist=o,t.folderCollectList[t.type]=(null===(n=t.folderCollectList[t.type])||void 0===n?void 0:n.filter((function(e){return t.folderlist.some((function(t){return e.id===t.id}))})))||[],t.folderCollectList[t.type].forEach((function(element){t.folderlist.forEach((function(t){element.id==t.id&&(element.imgList=t.imgList)}))}))}))},collect:function(t){var e=this;"artwork"==this.type&&this.$logEvent("log_actions",{operation:"quick_collect",behavior_info:"click_join_favorites",behavior_info_sub:this.folder.id});var n=t||null;this.isLoding=!0,this.addFavorite(this.folder,this.type,n,(function(o){if(n){var r=e.folderCollectList;r[e.type][0]&&n.id==r[e.type][0].id||r[e.type].unshift(n),r[e.type].length>2&&r[e.type].pop(),["",null,void 0].includes(null==t?void 0:t.name)||e.$message.success(e.$t("collectCreate4",{name:null==t?void 0:t.name})),e.SET_FOLDER_COLLECT(r)}e.$emit("onCollectionOk",o),e.isLoding=!1,e.visible=!1}),(function(t){e.isLoding=!1}),!0)}})},w=C,k=(n(3900),n(3901),n(0)),component=Object(k.a)(w,(function(){var t,e=this,n=e._self._c;return n("el-popover",{attrs:{placement:"bottom-start",width:"360","popper-class":"CollectPopover ".concat(e.createShow?"display_none":""),"visible-arrow":!1,title:e.$t("Collect"),trigger:e.triggerMode},on:{"after-enter":e.handleShow,hide:function(t){return e.$emit("showChaneg",{show:!1,id:e.folder.id})}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("div",{staticClass:"cltpop-cent"},[n("div",{staticStyle:{padding:"0 10px"}},[n("div",{staticClass:"search"},[n("i",{staticClass:"iconfont icon-folder-search"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],attrs:{type:"text",placeholder:e.$t("Search")},domProps:{value:e.keyword},on:{input:function(t){t.target.composing||(e.keyword=t.target.value)}}})]),e._v(" "),e.onloading?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.onloading,expression:"onloading"}],staticClass:"loadbox"}):e._e(),e._v(" "),n("div",{staticClass:"list"},[n("div",{directives:[{name:"show",rawName:"v-show",value:0==e.keyword.length,expression:"keyword.length == 0"}]},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("collectCreate2")))]),e._v(" "),n("div",{staticClass:"itembox",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.collect()}}},[n("div",{staticClass:"itemboxinfo"},[n("div",{staticClass:"itemboxinfoleft"},[n("i",{staticClass:"iconfont icon-deff-mycollect"})]),e._v(" "),n("span",[e._v(e._s(e.$t("UnorganizedIdeas")))])]),e._v(" "),n("el-button",{attrs:{loading:e.isLoding}},[e._v(e._s(e.$t("Collect")))])],1)]),e._v(" "),n("div",{staticClass:"title"},[e._v(e._s(e.$t("myfolder")))]),e._v(" "),e._l(e.filteredList,(function(t,o){return n("div",{key:o,staticClass:"itembox",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),e.collect(t)}}},[n("div",{staticClass:"itemboxinfo"},[n("div",{staticClass:"itemboxinfoleft"},[t.imgList&&t.imgList[0]&&t.imgList[0].url?n("img",{attrs:{decoding:"async",loading:"lazy",src:e.replaceImageType(t.imgList[0].url,"high")}}):n("i",{staticClass:"iconfont icon-deff-collect"})]),e._v(" "),n("span",[e._v(e._s(t.name))])]),e._v(" "),n("el-button",{attrs:{loading:e.isLoding}},[e._v(e._s(e.$t("Collect")))])],1)})),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:null===(t=e.collectTagList)||void 0===t?void 0:t.length,expression:"collectTagList?.length"}],staticClass:"title"},[e._v(e._s(e.$t("Recommend")))]),e._v(" "),e._l(e.collectTagList,(function(t,o){var r;return n("div",{directives:[{name:"show",rawName:"v-show",value:null===(r=e.collectTagList)||void 0===r?void 0:r.length,expression:"collectTagList?.length"}],key:"recommend_".concat(o),staticClass:"itembox",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),e.handleFastCreate(t)}}},[n("div",{staticClass:"itemboxinfo"},[n("div",{staticClass:"itemboxinfoleft"},[t.cover?n("img",{attrs:{decoding:"async",loading:"lazy",src:e.replaceImageType(t.cover,"high")}}):n("i",{staticClass:"iconfont icon-deff-collect"})]),e._v(" "),n("span",[e._v(e._s(t.title))])]),e._v(" "),n("el-button",{attrs:{loading:e.isLoding}},[e._v(e._s(e.$t("Create")))])],1)}))],2)]),e._v(" "),n("div",{staticClass:"create"},[n("div",{staticClass:"itembox",on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.createShow=!0}}},[n("div",{staticClass:"itemboxinfo"},[n("div",{staticClass:"itemboxinfoleft"},[n("i",{staticClass:"el-icon-plus"})]),e._v(" "),n("span",[e._v(e._s(e.$t("collectBox1")))])])])])]),e._v(" "),e.hideBtn?e._t("default",null,{slot:"reference"}):n("div",{staticClass:"bnt",attrs:{slot:"reference"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),function(){}.apply(null,arguments)}},slot:"reference"},[n("div",{attrs:{title:e.setFolderName}},[e._v(e._s(e.setFolderName))]),e._v(" "),n("i",{staticClass:"el-icon-arrow-down",style:{transform:e.visible?"rotate(180deg)":null}})]),e._v(" "),n("collection-create",{ref:"collectionCreate",attrs:{dataToCollect:e.folder,type:e.type},on:{create:e.newCreate,closeMask:function(t){return e.$emit("closeMask")}},model:{value:e.createShow,callback:function(t){e.createShow=t},expression:"createShow"}})],2)}),[],!1,null,"33654ab0",null);e.default=component.exports;installComponents(component,{CollectionCreate:n(249).default})},854:function(t,e,n){"use strict";n.r(e);n(16),n(18),n(21),n(394),n(47);var o=n(131),r=n.n(o),l=n(14),c=n(2),d=(n(19),n(6),n(50),n(73),n(22),n(31),n(49),n(24),n(11),n(12),n(13),n(8),n(4),n(28),n(43),n(140),n(77),n(7),n(26),n(10)),h=n(98),v=n(35),f=n.n(v),m=n(58),_=n(1),y=n(39),C=n(45),w=n(63),k=n(372),L=n(27),O=n(207),$=n(138),T=n(53);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I={name:"waterFall",mixins:[C.a],components:{CollectPopover:w.default,listCheckbox:O.default,modelPayNum:$.default,BaseAvatar:T.default},props:{showNs:Boolean,list:{type:Array,default:function(){return[]}},containerForImg:{type:Object,default:null},container:{type:String,require:!0},gap:{type:Number,default:16},lazy:{type:Boolean,default:!1},type:{type:String,default:""},actived:{type:Boolean,default:!0},cols:{type:Number,default:7},fromPage:{type:String,default:""},isFromRelated:{type:Boolean,default:!1},isShowNullRelatedImg:{type:Boolean,default:!1},alreadyNoMoreData:{type:Boolean,default:!1},noSearchData:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},dislikeShow:{type:Boolean,default:!1},hidethumbup:{type:Boolean,default:!1},hidecollect:{type:Boolean,default:!1},hoverShow:{type:Boolean,default:!1},imgQuality:{type:String,default:"low"},isTiemRow:{type:Boolean,default:!1},openWin:{type:Boolean,default:!1},checkMax:{type:Number,default:-1},category:{type:Boolean,default:!1},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},scrollContainerClassName:{type:String,default:""},scrollContentTop:{type:Number,default:0},selectList:{type:Array,default:function(){return[]}}},data:function(){var t=this;return{formatNumberForeign:d.p,copyTextToClipboard:d.g,saveImg:d.M,width:0,heights:[],dataList:[],resizeListener:Object(h.a)((function(){return t.resize(t.dataList)}),500),selfCols:4,isCollecting:!1,imagePopoverVisible:!1,reportLoading:!1,openWatch:!0,isDelete:!1,sharevisible:!1,popTime:0,itemShow:!1,itemShowId:"",checkList:{ids:[],collectIds:[],folderNos:[],url:[],info:[]},isCheckAll:!1,scrollTop:0,lastTime:null,appeaData:{obj_no:"",obj_type:1,remark:""},appealShow:!1,collectDotReportInfo:{}}},watch:{appealShow:{handler:function(t){t||(this.appeaData={obj_no:"",obj_type:1,remark:""})}},isCheck:{handler:function(t){this.isCheckAll=!1,this.dataList.forEach((function(t){t.isCheck=!1})),this.checkList={ids:[],collectIds:[],folderNos:[],url:[],info:[]},this.$emit("getChecList",this.checkList)}},list:{handler:function(t,e){this.updateList(t,e)}},WaterFallDeleteLits:{handler:function(t){this.isDelete=!0}},scrollContentTop:{handler:function(t){this.scrollTop=this.scrollContentTop||0},immediate:!0,deep:!0}},computed:P(P(P({},Object(_.c)("user",["isLoggedIn","accountSettingsData"])),Object(_.e)("user",["userInfo","adminOff"])),{},{greenMode:function(){var t;return 2!==(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.green_mode)},enableGreenMode:function(){return this.greenMode&&!["/personal"].includes(this.$route.path)},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)},isShowNsfw:function(){return function(t){return this.category&&this.checkIsShowViewNsfw&&!this.enableNsfwMode&&1!==t.nsfw&&(null==t?void 0:t.is_nsfw_plus)}},isPC:function(){return"PC"===localStorage.getItem("visitFrom")},setDeffBoxShow:function(){return function(t){return 2==t.status||5==t.status||((t.author&&t.author.id)!=this.userInfo.id&&"personal"!=this.fromPage?"artwork"==this.type&&1==t.primary:void 0)}},renderList:function(){return this.dynamicList(this.dataList)},setNsfwPlus:function(){return function(t){return!1}}}),activated:function(){var t=this;this.openWatch=!0,this.resizeListener(),window.addEventListener("resize",this.resizeListener),this.lazy&&document.addEventListener("scroll",this.lazyLoad),this.$nextTick((function(){window.scrollTo(0,t.scrollTop)}))},deactivated:function(){this.openWatch=!1,window.removeEventListener("resize",this.resizeListener),window.removeEventListener("scroll",this.lazyLoad)},mounted:function(){var t=this;window.addEventListener("resize",this.resizeListener),this.lazy,this.$nextTick((function(){t.checkList.ids=t.selectList.map((function(t){return t.id})),t.checkList.url=t.selectList.map((function(t){return t.url})),(t.list||[]).forEach((function(e){var n;e.isCheck=t.checkList.url.includes(null==e||null===(n=e.banner)||void 0===n?void 0:n.url)})),(t.dataList||[]).forEach((function(e){var n;e.isCheck=t.checkList.url.includes(null==e||null===(n=e.banner)||void 0===n?void 0:n.url)})),t.updateList(t.list)}))},beforeDestroy:function(){window.removeEventListener("resize",this.resizeListener)},methods:P(P({},Object(_.b)("user",["getAccountInfo"])),{},{updateList:function(t,e){var n=this.openWatch,o=this.width;if(n){o&&0!=o||(this.width=this.getWidth());var r=f()(t);if(this.dataList.length<100)this.updateDataList(r,!1);else if(r.length>this.dataList.length){var c=Object(l.a)(r.slice(this.dataList.length));this.updateDataList(c,!0)}else r.length<=this.dataList.length&&(this.dataList=[],this.updateDataList(r,!1))}},goToDetail:function(t){t.name?window.open("/models/detail/".concat(t.id),"_blank"):window.open("/explore/detail/".concat(t.id),"_blank")},goToPersonal:function(t){var e;if(this.isLoggedIn){var n=t.author.id,o=null===(e=this.userInfo)||void 0===e?void 0:e.id,path="/user/"+encodeURIComponent(n);o==n&&(path="/personal"),window.open(path,"_blank")}else this.$EventBus.$emit("openLoginDialog")},dynamicList:function(t){var e=this.containerForImg||this.$parent.$refs[this.container]||document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0];if(!e)return t;var n=this.scrollTop-e.offsetTop;return t.filter((function(t){return n-t.top<1500&&t.top-n<2e3}))},getItemTime:function(t){var e=new Date(t),n=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0");return"".concat(n,"-").concat(o)},processTimeGroups:function(t){for(var i=0;i<t.length;i++){var e,n,o,r,l=t[i];if(null!=l&&null!==(e=l.folder_no)&&void 0!==e&&e.collect_at)if(this.getItemTime(null==l||null===(n=l.folder_no)||void 0===n?void 0:n.collect_at)!==this.lastTime)t.splice(i,0,{timeItem:this.getItemTime(null==l||null===(o=l.folder_no)||void 0===o?void 0:o.collect_at)}),this.lastTime=this.getItemTime(null==l||null===(r=l.folder_no)||void 0===r?void 0:r.collect_at)}return t},updateDataList:function(t,e){var n=this,o=this.dataList,r=this.isCheckAll,l=this.checkList,c=this.WaterFallDeleteLits,h=this.width;t.forEach((function(t){o.forEach((function(e){t.id==e.id&&(t.collect=e.collect,t.isCheck=e.isCheck,t.liked=e.liked)}))}));var v,f,_=t.filter((function(t){return!c.includes(t.id)}));this.isTiemRow&&(e||(this.lastTime=null),this.processTimeGroups(_));for(var i=0;i<_.length;i++){var y=_[i];if(y.timeItem)y.waterWidth=h,y.waterHeight=30;else{var C,w,k,L,O;if(this.$set(y,"hoverd",!1),this.$set(y,"propS",!1),this.$set(y,"rowIndex",-1),!r&&l.ids.includes(y.id)?this.$set(y,"isCheck",l.ids.includes(y.id)):this.$set(y,"isCheck",!!r),r&&!l.ids.includes(y.id))l.ids.push(y.id),null!=y&&null!==(k=y.collect)&&void 0!==k&&k.id&&l.collectIds.push(y.collect.id),null!=y&&null!==(L=y.folder_no)&&void 0!==L&&L.id&&l.folderNos.push(y.folder_no.id),null!=y&&null!==(O=y.banner)&&void 0!==O&&O.url&&l.url.push(y.banner.url),y&&l.info.push(y);y.timeDiff=Object(m.d)(y.created_at,Date.now()),y.waterWidth=h,this.isTiemRow||"gallery"===this.type?y.waterHeight=h:(v=y.banner&&y.banner.width?y.banner.width:308,f=y.banner&&y.banner.height?y.banner.height:308,y.waterHeight=parseInt(f*h/v),isNaN(y.waterHeight)&&(y.waterHeight=320)),null==y||null===(C=y.banner)||void 0===C||!C.url||null!==(w=y.banner)&&void 0!==w&&w.replaceUrl||(y.banner.replaceUrl=Object(d.K)(y.banner.url,this.imgQuality||"low")),y.errorTime=0}}e?_.forEach((function(t){n.dataList.push(t)})):this.dataList=_,this.waterfall()},checkAll:function(){var t=this;if(this.isCheck){var e=this.dataList.filter((function(t){return!t.timeItem}));this.checkList.ids.length<e.length?(e.forEach((function(e){e.isCheck=!0,t.checkChange(e)})),this.isCheckAll=!0):(e.forEach((function(e){e.isCheck=!1,t.checkChange(e)})),this.isCheckAll=!1)}},clearCheck:function(t){var e=this;t.forEach((function(t){e.dataList.forEach((function(e){t==e.id&&(e.isCheck=!1)})),e.checkList.ids.forEach((function(n,o){t!==n&&t.id!==n||(e.checkList.ids.splice(o,1),e.checkList.collectIds.splice(o,1),e.checkList.folderNos.splice(o,1),e.checkList.url.splice(o,1),e.checkList.info.splice(o,1))}))})),this.$emit("getChecList",this.checkList)},checkChange:function(t){if(t.isCheck){var e,n,o;if(!this.checkList.ids.includes(t.id))this.checkList.ids.push(t.id),null!=t&&null!==(e=t.collect)&&void 0!==e&&e.id&&this.checkList.collectIds.push(t.collect.id),null!=t&&null!==(n=t.folder_no)&&void 0!==n&&n.id&&this.checkList.folderNos.push(t.folder_no.id),null!=t&&null!==(o=t.banner)&&void 0!==o&&o.url&&this.checkList.url.push(t.banner.url),t&&this.checkList.info.push(t)}else{var r,l,c;if(-1==this.checkList.ids.indexOf(t.id))return;if(this.checkList.ids.splice(this.checkList.ids.indexOf(t.id),1),null!=t&&null!==(r=t.collect)&&void 0!==r&&r.id&&this.checkList.collectIds.splice(this.checkList.collectIds.indexOf(t.collect.id),1),null!=t&&null!==(l=t.folder_no)&&void 0!==l&&l.id&&this.checkList.folderNos.splice(this.checkList.folderNos.indexOf(t.folder_no.id),1),null!=t&&null!==(c=t.banner)&&void 0!==c&&c.url&&this.checkList.url.splice(this.checkList.url.indexOf(t.banner.url),1),t){var d=this.checkList.info.findIndex((function(e){return e.id===t.id}));this.checkList.info.splice(d,1)}}this.$emit("getChecList",this.checkList)},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id,this.handleCollectPopoverClick(t)},moreActions:function(t,e){var n=this;switch(t){case"flag":this.reportArtwork(e.id);break;case"save":this.downloadImg(e);break;case"share":this.sharevisible=!0,this.popTime=setTimeout((function(){n.sharevisible=!1}),1e3);var o="".concat(window.location.origin,"/")+"explore/detail/".concat(e.id);this.$message.success(this.$t("CopiedURLToClipboard")),this.copyTextToClipboard(o);break;case"delete":this.handleWorkDelete(e);break;case"not_interested":Object(y.i)({items:[{action:"not_interested",obj_no:e.id,obj_type:1}]}).then((function(t){var o,r;1e4==(null==t||null===(o=t.status)||void 0===o?void 0:o.code)?(n.$message({message:n.$t("reduceWork"),type:"success"}),e.propS=!1,n.setWaterFallDeleteLits(e.id),n.resizeListener()):n.$message({message:(null==t||null===(r=t.status)||void 0===r?void 0:r.msg)||n.$t("ServerError"),type:"error"})}));break;case"setBg":Object(L.y)({id:e.id}).then((function(t){var o;if(1e4==(null==t||null===(o=t.status)||void 0===o?void 0:o.code))n.$message({message:n.$t("SetSuccess"),type:"success"}),e.propS=!1,n.getAccountInfo();else{var r,l,c=n.$t("ServerError");if(20309==(null==t||null===(r=t.status)||void 0===r?void 0:r.code))c=n.$t("SetBgLimit");else c=null==t||null===(l=t.status)||void 0===l?void 0:l.msg;n.$message({message:c,type:"error"})}}));break;case"appeal":this.appeaData.obj_no=e.id,this.appealShow=!0}},downloadImg:function(t){var e=this.getImageExtensionFromUrl(t.banner.url),n=(t.author?t.id:"image")+"".concat(e);this.saveImg(t.banner.url,n)},getImageExtensionFromUrl:function(t){var e=t.match(/\/([^/]+)$/);return e&&e[1].includes(".")?"."+e[1].split(".").pop().toLowerCase():".jpeg"},handleWorkDelete:function(t){var e=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var n={id:t.id};e.globalLoading=!0,Object(k.a)(n).then((function(n){var o,r;1e4==(null==n||null===(o=n.status)||void 0===o?void 0:o.code)?(e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.setWaterFallDeleteLits(t.id),e.resizeListener()):e.$message({message:(null==n||null===(r=n.status)||void 0===r?void 0:r.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))})).catch((function(t){console.log("err",t)}))},handleContextMenu:function(t,e){1===e.nsfw&&t.preventDefault()},reportArtwork:function(t){var e=this;this.reportLoading||(this.reportLoading=!0,Object(y.r)({id:t}).then((function(t){var code=t&&t.status?t.status.code:"";[1e4].includes(code)&&r()({message:e.$t("ReportSuccess"),type:"success",duration:5e3})})).finally((function(){e.reportLoading=!1})))},handleClick:function(t,e,n){if(this.isLoggedIn||6===t.type){var o=this.list.findIndex((function(i){return i.id===t.id})),r=(o<10?this.list.slice(0,o):this.list.slice(o-10,o)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));switch(e){case"创作":Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:r,action:"task",obj_no:t.id,obj_type:1})]});var l=Object.assign({},t);"model"===this.type&&["explore","personal"].includes(this.fromPage)&&(l.taskSource=1),this.$EventBus.$emit("openGenerate",{action:1,data:{source:l}});break;case"收藏":Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:r,action:"collection",obj_no:t.id,obj_type:1})]}),this.setCollect(t,n)}}else this.$EventBus.$emit("openLoginDialog")},handleCollectPopoverClick:function(t){var e=this.list.findIndex((function(i){return i.id===t.id})),n=(e<10?this.list.slice(0,e):this.list.slice(e-10,e)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));this.collectDotReportInfo=P(P({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:t.id,obj_type:1})},handleDetail:function(t,e){var n=this;if(this.isCheck){if(-1==this.checkMax||this.checkList.ids.length<this.checkMax)this.checkList.ids.length==this.dataList.length&&(this.isCheckAll=!0),e.isCheck&&(this.isCheckAll=!1),e.isCheck=!e.isCheck;else if(e.isCheck)this.checkList.ids.length==this.dataList.length&&(this.isCheckAll=!0),e.isCheck&&(this.isCheckAll=!1),e.isCheck=!e.isCheck;else{var o;if(1===this.checkMax)return((null===(o=this.checkList)||void 0===o?void 0:o.ids[0])||"")&&this.dataList.forEach((function(t){n.$set(t,"isCheck",!1)})),void(e.isCheck=!e.isCheck);this.$message({message:this.$t("已超过最大选择上限"),type:"warning"})}return!1}if(this.$logEvent("log_actions",{operation:{artwork:"click_image",model:"click_model",gallery:"click_gallery"}[this.type],behavior_info:e.id}),"activity"!==this.type)if("IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className||"model"!==this.type)if("IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className&&"green-mode-div"!==t.target.className||"artwork"!==this.type)"IMG"!==t.target.tagName&&"img-content"!==t.target.className&&"statusZg"!==t.target.className&&"workInfo"!==t.target.className||"gallery"!==this.type||(Object(y.i)({items:[{action:"view",obj_no:e.id,obj_type:4}]}),this.$router.push("/artWorkDetail/"+e.id));else{if(this.checkGreen(e))return void this.$EventBus.$emit("openLoginDialog",{redirect:"/explore/detail/"+e.id});var r=this.list.findIndex((function(i){return i.id===e.id})),l=(r<10?this.list.slice(0,r):this.list.slice(r-10,r)).map((function(t){return t.id})).filter((function(t){return"banner"!=t&&"ai_tool"!=t}));Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:l,action:"view",obj_no:e.id,obj_type:1})]}),this.openWin?window.open("/explore/detail/"+e.id,"_blank"):this.$router.push("/explore/detail/"+e.id)}else 3==e.status||4==e.status?this.$router.push({path:"/models/detail/".concat(e.id),query:{type:"other"}}):this.$router.push("/models/detail/".concat(e.id))},imgError:function(t){t.errorTime++,t.errorTime>=2||(this.$refs[t.id][0].src=t.banner.url)},waterfall:function(){var t=this;try{this.heights=[];for(var e=function(){var e=t.dataList[i],n=e.waterHeight,o="artwork"==t.type?40:70;if(e.timeItem){e.left=0;var r=t.getMaxIndex(t.heights);e.top=r>-1?t.heights[r]+t.gap:0,t.heights.forEach((function(r,l){t.heights[l]=e.top+n+o}))}else if(t.heights.length<t.selfCols)if(t.dataList[i-1]&&t.dataList[i-1].timeItem)if(e.left=0,e.top=t.dataList[i-1].top+t.dataList[i-1].waterHeight+t.gap,t.heights[0]){var l=t.heights[0]+n;t.heights=[l+t.gap]}else t.heights.push(e.top+n+o);else e.top=t.dataList[i-1]?t.dataList[i-1].top:0,e.left=t.heights.length*(t.width+t.gap),t.heights.push(e.top+n+o);else{var c=t.getMinIndex(t.heights),d=t.heights[c]+t.gap;e.top=d,e.left=c*(t.width+t.gap),t.heights[c]=d+n+o}},i=0;i<this.dataList.length;i++)e();this.setWaterFallRect()}catch(t){}},getWidth:function(){var t,e;this.selfCols=this.cols;var n=this.containerForImg?this.containerForImg.offsetWidth:(null===(t=this.$parent.$refs[this.container])||void 0===t?void 0:t.offsetWidth)||(null===(e=document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0])||void 0===e?void 0:e.offsetWidth);n||(n=1236),n<1700&&(this.selfCols=6),n<1500&&(this.selfCols=5),n<1240&&(this.selfCols=5),n<980&&(this.selfCols=4),n<730&&(this.selfCols=4),n<500&&this.isPC&&(this.selfCols=1);var o=~~((n-this.selfCols*this.gap-this.gap+32)/this.selfCols);return this.isPC,o>176?o:176},setWaterFallRect:function(){var t=this.containerForImg||this.$parent.$refs[this.container]||document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0],e=Math.max.apply(null,this.heights);this.list.length&&(t.style.height=e+"px",t.style.marginBottom="130px")},getMinIndex:function(t){var e=Math.min.apply(null,t);return t.indexOf(e)},getMaxIndex:function(t){var e=Math.max.apply(null,t);return t.indexOf(e)},resize:function(t){var e=this;if(this.openWatch){var n,o;if(this.containerForImg){if(this.containerForImg.offsetWidth<600)return}else if((null===(n=this.$parent.$refs[this.container])||void 0===n?void 0:n.offsetWidth)<600||(null===(o=document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0])||void 0===o?void 0:o.offsetWidth)<600)return;this.dataList=f()(t).filter((function(t){return!e.WaterFallDeleteLits.includes(t.id)})),this.width=this.getWidth(),this.dataList.forEach((function(t){if(t.timeItem)t.waterWidth=e.width,t.waterHeight=30;else{var n,o;if(e.$set(t,"hoverd",!1),t.timeDiff=Object(m.d)(t.created_at,Date.now()),t.waterWidth=e.width,e.isTiemRow||"gallery"===e.type)t.waterHeight=e.width;else null!=t&&null!==(o=t.banner)&&void 0!==o&&o.width&&(t.waterHeight=parseInt(e.width/(t.banner.width/t.banner.height))),isNaN(t.waterHeight)&&(t.waterHeight=320);null!=t&&null!==(n=t.banner)&&void 0!==n&&n.replaceUrl&&(t.banner.replaceUrl=Object(d.K)(t.banner.url,e.imgQuality||"low")),t.errorTime=0}})),this.waterfall()}},lazyLoad:function(){this.actived&&this.openWatch},initials:function(t){return t.split(" ").map((function(t){return t[0]})).join("")},otherUser:function(t,e){var path=e?"/user/"+encodeURIComponent(t.author.id)+"?type=gather":"/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal?tab=gather"),this.openWin?window.open(path,"_blank"):this.$router.push(path)},getPersonalInfoUrl:function(t){var path="/user/"+encodeURIComponent(t.author.id);return this.userInfo.id==t.author.id&&(path="/personal"),path},checkGreen:function(t){return!this.isLoggedIn&&!(null==t||!t.green||![2,"2"].includes(t.green))}})},j=(n(4122),n(4123),n(0)),component=Object(j.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"waterfall-container"},[t._l(t.renderList,(function(n,o){var r,l;return e("a",{key:n.top+","+n.left,staticClass:"waterfall-item",class:{"waterfall-dialog":t.containerForImg},style:{top:n.top+"px",left:n.left+"px"},attrs:{href:"model"===t.type?"/models/detail/"+n.id:"gallery"==t.type?"/artWorkDetail/"+n.id:"/explore/detail/"+n.id,target:"_blank"},on:{click:function(e){return e.preventDefault(),t.handleDetail(e,n)},contextmenu:function(e){return t.handleContextMenu(e,n)}}},[t.setDeffBoxShow(n)?e("div",{staticClass:"deffBox",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[e("div",[t._v(t._s(t.$t("PictureInvalid")))]),t._v(" "),e("div",[e("i",{staticClass:"el-icon-warning-outline"}),t._v(" "),e("span",[t._v(t._s(t.$t("PictureHidden")))])]),t._v(" "),"collect"==t.fromPage?e("i",{staticClass:"iconfont",class:t.setCollectData(n),on:{click:function(e){e.preventDefault(),t.handleClick(n,"收藏","artwork"),t.setWaterFallDeleteLits(n.id),t.resizeListener()}}}):t._e(),t._v(" "),t.isCheck&&n?e("listCheckbox",{on:{change:function(e){return t.checkChange(n)}},model:{value:n.isCheck,callback:function(e){t.$set(n,"isCheck",e)},expression:"item.isCheck"}}):t._e()],1):n.timeItem?e("div",{staticClass:"timeRow",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[t._v("\n      "+t._s(n.timeItem)+"\n    ")]):e("div",{staticClass:"listCnt marking-item",class:[1===n.banner.nsfw||t.isShowNsfw(n.banner)?"bg-nsfw":""]},[[2,"2"].includes(n.green)&&t.enableGreenMode?e("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}}):t._e(),t._v(" "),e("div",{staticClass:"img-content",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[6==n.type&&1!=n.banner.nsfw?e("video",{ref:"mainVideo",refInFor:!0,staticClass:"cntVideo",attrs:{src:null===(r=n.banner)||void 0===r?void 0:r.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):1!=n.banner.nsfw?e("el-image",{staticClass:"cntImg",style:{transform:n.isCheck?"scale(0.85)":null,filter:t.setNsfwPlus(n)?"blur(19px) saturate(160%)":""},attrs:{src:null===(l=n.banner)||void 0===l?void 0:l.replaceUrl,fit:"cover",lazy:""}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e()],1),t._v(" "),3==n.status||4==n.status?e("div",{staticClass:"statusCnt"},[e("div",{staticClass:"statusZg"}),t._v(" "),e("div",{staticClass:"statusBox",style:{color:4==n.status?"#EF3B3B":"#ffffff"}},[e("i",{staticClass:"iconfont icon-statusBox"}),t._v(" "),e("div",[t._v(t._s(4==n.status?t.$t("notApproved"):t.$t("underReview")))])])]):t._e(),t._v(" "),t.isCheck&&n?e("listCheckbox",{on:{change:function(e){return t.checkChange(n)}},model:{value:n.isCheck,callback:function(e){t.$set(n,"isCheck",e)},expression:"item.isCheck"}}):e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"shade"},[e("p",[t._v(t._s(t.$t("NotPass"))+" "+t._s(t.$t("Auditing")))])]),t._v(" "),("artwork"==t.type?3!=n.type:1==n.status&&"gallery"!==t.type&&"activity"!==t.type)?e("div",{staticClass:"waterfall-hover-try",class:{"prompt-show":!t.isLoggedIn},on:{click:function(e){return e.preventDefault(),t.handleClick(n,"创作")}}},[t._v("\n          "+t._s("artwork"==t.type?t.$t("Remix"):t.$t("Try"))+"\n        ")]):t._e(),t._v(" "),t.isLoggedIn&&1==n.status&&"gallery"!==t.type&&"activity"!==t.type?e("CollectPopover",{staticClass:"CollectPop",attrs:{type:t.type,folder:n,dotReportInfo:t.collectDotReportInfo,from:"waterfall"},on:{showChaneg:t.changeItemShow}}):t._e(),t._v(" "),t.isLoggedIn&&1==n.status&&"gallery"!==t.type&&"activity"!==t.type?e("div",{staticClass:"cltpop",style:{opacity:t.itemShow&&t.itemShowId==n.id?1:0}}):t._e(),t._v(" "),"artwork"===t.type&&n.waterHeight>200?e("div",[e("div",{staticClass:"waterfall-hover-photo"},[e("div",{staticClass:"hoverTop"},[e("span",[t._v(t._s(n.type&&1!=n.type&&3!=n.type?"/grid":"/upscale"))]),t._v(" "),n?e("div",{staticClass:"moreEdit"},[t.isLoggedIn?[e("el-popover",{key:o,ref:"myPopover",refInFor:!0,attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!1,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"100",trigger:"click"},model:{value:n.propS,callback:function(e){t.$set(n,"propS",e)},expression:"item.propS"}},[e("div",{staticClass:"pop-btns flex"},[e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("flag",n)}}},[t._v("\n                        "+t._s(t.$t("Report"))+"\n                      ")]),t._v(" "),e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("save",n)}}},[t._v("\n                        "+t._s(t.$t("SaveImage"))+"\n                      ")]),t._v(" "),e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("share",n)}}},[t._v("\n                        "+t._s(t.$t("ShareLink"))+"\n                      ")]),t._v(" "),!t.dislikeShow||n.author&&n.author.id==t.userInfo.id?t._e():e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("not_interested",n)}}},[t._v("\n                        "+t._s(t.$t("dislike"))+"\n                      ")]),t._v(" "),n.author&&n.author.id==t.userInfo.id&&n.banner.a_a?e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("appeal",n)}}},[t._v("\n                        "+t._s(t.$t("appeal"))+"\n                      ")]):t._e(),t._v(" "),n.author&&n.author.id==t.userInfo.id?e("button",{on:{click:function(e){return e.preventDefault(),t.moreActions("delete",n)}}},[t._v("\n                        "+t._s(t.$t("Delete"))+"\n                      ")]):t._e()]),t._v(" "),e("div",{class:{"login-waterFall-btn-icon":t.isLoggedIn,"noLogin-waterFall-collect-icon prompt-show":!t.isLoggedIn},attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-more"})])])]:t._e()],2):t._e()]),t._v(" "),3!=n.type?e("div",{staticClass:"hoverMiddle"},[t._v("\n              "+t._s(n.prompt)+"\n            ")]):t._e()])]):t._e(),t._v(" "),"model"===t.type&&n.base_model.includes("SDXL")?e("div",{staticClass:"modelPoint"},[t._v("\n          "+t._s((null==n?void 0:n.type)+" | XL ")+"\n        ")]):"model"===t.type?e("div",{staticClass:"modelPoint"},[t._v(t._s(null==n?void 0:n.type))]):t._e()],1),t._v(" "),"activity"===t.type?e("div",{staticClass:"activity",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToDetail(n)}}},[n.name?e("div",{staticClass:"top-container"},[e("div",{staticClass:"name"},[t._v(t._s(n.name))])]):t._e(),t._v(" "),e("div",{staticClass:"personal-info"},[e("div",{staticClass:"left-info",style:{width:n.name?"100%":"calc(100% - 68px)"}},[n.author.head?e("img",{staticClass:"avatorClass",attrs:{decoding:"async",loading:"lazy",src:n.author.head,alt:""},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToPersonal(n)}}}):e("div",{staticClass:"avatorClass",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToPersonal(n)}}},[t._v("\n              "+t._s(t.initials(n.author.name||n.author.id))+"\n            ")]),t._v(" "),e("span",{staticClass:"ellipsis-text",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goToPersonal(n)}}},[t._v("\n              "+t._s(n.author.name||n.author.id)+"\n            ")])])])]):t._e()],1),t._v(" "),"model"===t.type?e("div",{staticClass:"waterfall-hover-model"},[e("span",{staticClass:"ellipsis-text modelName"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"hoverBottom"},[n.author?e("div",{staticClass:"flex-center",staticStyle:{"max-width":"50%"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.otherUser(n)}}},[n.author.head?e("img",{staticClass:"avatorClass",attrs:{decoding:"async",loading:"lazy",src:n.author.head,alt:""}}):n.author?e("div",{staticClass:"avatorClass"},[t._v("\n            "+t._s(t.initials(n.author.name||n.author.id))+"\n          ")]):t._e(),t._v(" "),e("span",{staticClass:"ellipsis-text"},[t._v(t._s(n.author.name))])]):e("div"),t._v(" "),1==n.status?e("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}}):t._e()])]):t._e(),t._v(" "),"artwork"===t.type?e("div",{staticClass:"workInfo"},[n.author?e("div",{staticClass:"flex-center flex-center-image",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.otherUser(n)}}},[n.author?e("BaseAvatar",{staticStyle:{"margin-right":"6px"},attrs:{size:30,"user-data":n.author}}):t._e(),t._v(" "),e("span",{staticClass:"ellipsis-text",style:{"max-width":t.containerForImg?"3rem":""}},[t._v(t._s(n.author.name||n.author.id))])],1):e("div"),t._v(" "),e("div",{staticClass:"numInfo",class:{"hover-show":t.hoverShow}})]):t._e()])})),t._v(" "),t.isShowNullRelatedImg?e("div",{staticClass:"null-data-container"},[e("img",{staticClass:"null-image",attrs:{src:n(500),alt:"null_related_image"},on:{load:function(e){return t.$emit("solveScrollbarStyle")}}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("NoRelatedWorks")))])]):t._e(),t._v(" "),t.alreadyNoMoreData?e("div",{staticClass:"at-bottom"},[e("div",{staticClass:"dashed-line"}),t._v(" "),e("div",{staticClass:"tips"},[t._v(t._s(t.$t("NoMoreData")))]),t._v(" "),e("div",{staticClass:"dashed-line"})]):t._e(),t._v(" "),t.noSearchData?e("div",{staticClass:"no-search-data-container"},[e("img",{staticClass:"no-search-image",attrs:{src:n(504),alt:"no search data"}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("NoSearchData")))])]):t._e(),t._v(" "),e("el-dialog",{attrs:{title:t.$t("appeal"),visible:t.appealShow,width:"500px","modal-append-to-body":!1,"close-on-click-modal":!1,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.appealShow=e}}},[e("div",{staticClass:"appealCnt"},[e("el-input",{attrs:{type:"textarea",placeholder:t.$t("enterAppealCnt"),maxlength:"50","show-word-limit":""},model:{value:t.appeaData.remark,callback:function(e){t.$set(t.appeaData,"remark",e)},expression:"appeaData.remark"}})],1),t._v(" "),e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.appealShow=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{attrs:{loading:t.isAppealLoading},on:{click:function(e){return t.setResourceAppeal(t.appeaData)}}},[t._v(t._s(t.$t("Submit")))])],1)])],2)}),[],!1,null,"6d7e71a1",null);e.default=component.exports;installComponents(component,{CollectPopover:n(63).default,BaseAvatar:n(53).default})},888:function(t,e,n){"use strict";n.r(e);n(11),n(72),n(16),n(152);var o=n(30),r=n(3),l=n(14),c=n(2),d=(n(20),n(19),n(6),n(32),n(22),n(31),n(49),n(8),n(4),n(28),n(12),n(13),n(40),n(44),n(92),n(7),n(41),n(141),n(142),n(109),n(203)),h=n(82),v=n(1),f=n(9),m=n(71);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C="",w="",k={name:"PostForm",inject:["top"],props:{from:{type:String,default:""},fileList:{type:Array,default:function(){return[]}}},data:function(){var t=this;return{formData:{title:"",description:"",tags:[],link:[""]},rules:{tags:[{required:!0,message:this.$t("CreativeCenterPopup35"),trigger:["change","blur"]}],link:[{validator:function(e,n,o){if(n.length>0){for(var i=0;i<n.length;i++){var r=n[i];if(r)try{null===new URL(r)&&o(new Error(t.$t("linkWarn",{name:t.$t("Link")})))}catch(e){o(new Error(t.$t("linkWarn",{name:t.$t("Link")})))}else;}o()}o()},trigger:["blur"]}]},selectList:[],intRmdTag:[],postTagList:[],loading:!1,aiTextLoading:!1,langOptions:["zh_cn","zh_tw","ja","ar","ko","de","fr","ru","es","th","en","pt"]}},mounted:function(){this.resetFormData(),this.getTagList()},computed:y(y({},Object(v.c)("user",["userInfo"])),{},{renderList:function(){var t=this.$i18n.locale?this.$i18n.locale:"en";return"zhCN"===t&&(t="zh_cn"),"zhTW"===t&&(t="zh_tw"),(this.selectList||[]).map((function(e){return e.label=e[t],e.label=e.label?e.label:e.title?e.title:e.id,e}))},whiteList:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.post_white}}),methods:{initTags:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$set(this.formData,"tags",t)},checkItem:function(t){return this.formData.tags.find((function(e){return e===t.id}))},handleCheckTag:function(t){this.formData.tags.find((function(e){return e===t.id}))?(this.formData.tags=this.formData.tags.filter((function(e){return e!==t.id})),this.intRmdTag=this.intRmdTag.filter((function(e){return e.id!==t.id}))):(this.formData.tags.push(t.id),this.intRmdTag.push(t),this.$refs.postForm.validateField("tags"))},removeTag:function(t){this.postTagList.find((function(e){return e.id===t}))&&(this.selectList=this.selectList.filter((function(e){return e.id!==t})),this.intRmdTag=this.intRmdTag.filter((function(e){return e.id!==t}))),this.changeCustomTag()},defSelectedTags:function(t){this.formData.tags=t},changeCustomTag:function(){var t,e=this,n=null===(t=this.formData)||void 0===t?void 0:t.tags.filter((function(t){return!e.intRmdTag.find((function(e){return e.title===t||e.id===t}))}));n=n.map((function(t){return{title:t,id:t}})),this.selectList=[].concat(Object(l.a)(this.intRmdTag),Object(l.a)(n))},setIntRmdTag:function(t){t&&this.changeCustomTag()},remoteMethod:function(t){var e=this;t&&Object(h.d)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.selectList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.selectList.push({title:t.title,id:t.title,type:(null==t?void 0:t.type)||""})})))}))},filterMethod:function(){var t=this;this.$nextTick((function(){try{t.$refs.tagSelect.$el.querySelector(".el-select__input").setAttribute("maxlength",30)}catch(t){}}))},resetFormData:function(){C="",w="";try{this.selectList=[],this.formData.title="",this.formData.description="",this.formData.tags=[],this.$refs.postForm.resetFields()}catch(t){}},changeTag:function(t){var e=t.length-1;"string"==typeof t[e]&&(t[e]=t[e].slice(0,30)),this.formData.tags=t},getTagList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,Object(m.d)({show_area:"videoPost"===t.from?"ai_video":"post"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){return e.title=e[f.r[t.$i18n.locale]],e.label=e.title||e.id,e.searchLabel=(t.langOptions||[]).map((function(t){return e[t]?e[t]:""})).filter((function(t){return!!t})),e})),t.$set(t,"selectList",n),t.$set(t,"intRmdTag",n),t.loading=!1})).finally((function(){t.loading=!1})),e.next=4,Object(m.d)({show_area:"post_tag"});case 4:1e4===(n=e.sent).status.code&&(t.postTagList=n.data?n.data.map((function(e){var n,o,r,l;return y({title:null!==(n=null!==(o=e[f.r[t.$i18n.locale]])&&void 0!==o?o:e.en)&&void 0!==n?n:e.id,label:null!==(r=null!==(l=e[f.r[t.$i18n.locale]])&&void 0!==l?l:e.en)&&void 0!==r?r:e.id,searchLabel:(t.langOptions||[]).map((function(t){return e[t]?e[t]:""})).filter((function(t){return!!t}))},e)})):[]);case 6:case"end":return e.stop()}}),e)})))()},submitData:function(){var t=this,e=null;return this.$refs.postForm.validate((function(n){n?((e=JSON.parse(JSON.stringify(t.formData))).description=(e.description||"").replace(/\n/g,"<br>"),e.tags=t.handleTags(e.tags),e.link=e.link.filter((function(t){return!!t.trim()}))):t.$message.error(t.$t("CreativeCenterPopup38"))})),e},handleTags:function(t){var e=this;return t.map((function(t){var n=e.intRmdTag.find((function(e){return e.id===t}));return n||{title:t}}))},removeLink:function(t){1===this.formData.link.length?this.formData.link=[""]:this.formData.link.splice(t,1)},addLink:function(){this.formData.link.length>=5||this.formData.link.push("")},handAutoGenerateTitle:function(){var t=this,e={uri:Object(o.a)(this.fileList,1)[0].url};if(C&&w)return this.formData.title=C,void(this.formData.description=w);this.aiTextLoading=!0,Object(d.autoGenerateTitle)(e).then((function(e){var n=null==e?void 0:e.data,title=n.title,o=n.intro;t.formData.title=title,t.formData.description=o,C=title,w=o})).finally((function(){t.aiTextLoading=!1}))}}},L=k,O=(n(4481),n(4482),n(4483),n(0)),component=Object(O.a)(L,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-post-form"},[e("el-form",{ref:"postForm",staticClass:"custom-form",attrs:{model:t.formData,rules:t.rules,"label-position":"top"}},[e("el-form-item",{staticClass:"title-form-item",attrs:{label:t.$t("Title"),prop:"title"}},[e("el-input",{staticClass:"title-input",attrs:{"show-word-limit":"",maxlength:"80",placeholder:t.$t("postFormTitleTips")},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}}),t._v(" "),e("el-button",{staticClass:"title-btn",attrs:{type:"primary",size:"mini",loading:t.aiTextLoading},on:{click:t.handAutoGenerateTitle}},[t._v(t._s(t.$t("autoGenerate")))])],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Desc"),prop:"description"}},[e("el-input",{staticClass:"post-form-textarea",attrs:{type:"textarea",autosize:{minRows:4,maxRows:20},maxlength:"2500","show-word-limit":"",placeholder:t.$t("postFormDescTips")},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),t._v(" "),t.whiteList?e("el-form-item",{attrs:{label:t.$t("Link"),prop:"link"}},t._l(t.formData.link,(function(n,o){return e("div",{key:"link".concat(o),staticClass:"links"},[[e("el-input",{staticClass:"title-input",attrs:{"show-word-limit":"",maxlength:"200",placeholder:t.$t("inputPls",{name:t.$t("Link")})},model:{value:t.formData.link[o],callback:function(e){t.$set(t.formData.link,o,e)},expression:"formData.link[index]"}}),t._v(" "),t.formData.link.length>1?e("i",{staticClass:"el-icon-remove-outline",on:{click:function(e){return t.removeLink(o)}}}):t._e(),t._v(" "),t.formData.link.length<5?e("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(e){return t.addLink()}}}):t._e()]],2)})),0):t._e(),t._v(" "),e("el-form-item",{attrs:{label:t.$t("TagsAssociation"),prop:"tags"}},[e("el-select",{ref:"tagSelect",staticClass:"show-tag",staticStyle:{width:"100%"},attrs:{"value-key":"title",placeholder:t.$t("TagsAssociationTips"),multiple:"","multiple-limit":5,"popper-class":"show-tag-select post-show-tag-select",clearable:"",filterable:"","allow-create":"","default-first-option":"",remote:"","remote-method":t.remoteMethod},on:{"visible-change":t.setIntRmdTag,"remove-tag":t.removeTag,change:t.changeTag},nativeOn:{input:function(e){return t.filterMethod.apply(null,arguments)}},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},t._l(t.selectList,(function(n,i){return e("el-option",{key:"tag_".concat(n.id+i),attrs:{label:n.title,value:n.id}},[t._v("\n          "+t._s(n.title?n.title:n)+"\n          "),e("span",{directives:[{name:"show",rawName:"v-show",value:[1,"1"].includes(null==n?void 0:n.type),expression:"[1, '1'].includes(v?.type)"}],staticClass:"label-flag"},[t._v(t._s(t.$t("official")))])])})),1),t._v(" "),e("div",{staticClass:"custom-tag-box"},t._l(t.postTagList,(function(n){return e("div",{key:n.id,staticClass:"custom-tag-item",class:{"custom-tag-item--active":t.checkItem(n)},on:{click:function(e){return t.handleCheckTag(n)}}},[e("span",[t._v("#")]),t._v(t._s(n.title)+"\n        ")])})),0)],1)],1)],1)}),[],!1,null,"990bd094",null);e.default=component.exports},895:function(t,e,n){"use strict";n.r(e);var o={props:{list:{type:Array,default:function(){return[]}}},data:function(){return{currentIndex:""}},methods:{handleCollapse:function(t){this.currentIndex!==t?this.currentIndex=t:this.currentIndex=""}}},r=(n(5080),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",t._l(t.list,(function(n,o){return e("div",{key:o,staticClass:"collapse",on:{click:function(e){return t.handleCollapse(o)}}},[e("span",{staticClass:"tag"},[t._v(t._s(o===t.currentIndex?"-":"+"))]),t._v(" "),e("div",{staticClass:"label",class:{active:o===t.currentIndex}},[t._v("\n      "+t._s(t.$t(n.label))+"\n      "),t._l(n.value,(function(n){return e("div",{key:n,staticClass:"coll-value"},[e("span",[t._v(t._s(t.$t(n)))])])}))],2)])})),0)}),[],!1,null,"96d6cd96",null);e.default=component.exports}}]);