(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1164:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(12),n(13);var o=n(68),l=n(3),r=n(14),c=n(2),d=(n(20),n(19),n(199),n(6),n(32),n(50),n(22),n(31),n(24),n(8),n(4),n(378),n(28),n(21),n(40),n(44),n(92),n(7),n(41),n(26),n(3265)),v=n(1169),m=n(1171),h=n(1),f=n(51),_=n(9),y=n(870),C=n(3298),w=n(36),k=n(25),I=n(29),x=n(57),T=n(46),S=n(594),O=n(48),P=n(818),M=n(871),L=n(3302),$=n(3122),D=n(407),j=n(33),E=n(3307),A=n(3123),N=n(625),V=n(301),R=n(3313),F=n(3314),B=n(902),U=n(439),G=n(80),z=n(3318),W=n(3319),H=n(99),K=n(3331),J=n(3332),X=n(10),Q=n(3333),Y=n(3335),Z=n(3338),ee=n(3341),te=n(165),ie=n(268);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae={effect:"effect",multiImage:"element"},se={"1:1":"icon-icon-a-1_11","16:9":"icon-a-16_91","4:3":"icon-a-4_31","2:3":"icon-a-2_3","9:16":"icon-a-9_161"},le={name:"EasyGenerate",props:{mode:{type:String,default:"modal"},isShowSubBanner:{type:Boolean,default:!1},isShowPopup:{type:Boolean,default:!0},currentGenerateMode:{type:[String,Number],default:1}},mixins:[P.googleCaptchaMixIn,$.workFlowAppDetailMixIn,A.videoModelMixIn],components:{CombinedSelectDialog:D.default,EasyGenerateTopBar:v.default,ParamsPanel:d.default,EasyTopInputArea:m.default,UpscaleToolsModal:y.default,AnimeToolsModal:C.default,GRechargeBanner:S.default,CommonParamsPanel:M.default,GenerateResults:L.default,MessageList:E.default,SelectVideoModelModal:V.default,VideoExtensionModal:R.default,VideoInputArea:F.default,VideoEffectRecommendModal:z.default,VideoFrameInterpolationModal:B.a,audioParamsPanel:W.default,DeductionPromptModal:K.default,CreationGuidanceTemplate:J.default,ModelRecipe:Q.default,CreativeAssistant:Y.default,VideoInspirationLibrary:Z.default,MusicInspirationLibrary:ee.default},provide:function(){return{easyTop:this}},data:function(){return{isSetUpConfigData:!1,currentTab:"generateImage",tabs:[{id:"generateImage",name:"imgTab",component:"params-panel",taskDomainTypes:[3,4,5,6,7,8,9,10]},{id:"generateVideo",name:"videoTab",component:"params-panel",taskDomainTypes:[11,12,13,14,15,25]},{id:"app",name:"aiapp",component:"common-params-panel",taskDomainTypes:[1,2,16]},{id:"generateAudio",name:"Audio",component:"audio-params-panel",taskDomainTypes:[17]}],categoryInfo:{banner:{url:""},name:"",id:"277fb03e36660a72d72692c6153d8a0c"},isImageToImageToTextToImage:!1,channelId:"PRIVATE",config:{generateImage:Object(U.getDefaultConfig)("generateImage"),generateVideo:Object(U.getDefaultConfig)("generateVideo"),app:Object(U.getDefaultConfig)("app"),generateAudio:Object(U.getDefaultConfig)("generateAudio")},modelParams:{},videoModelParams:{},currentVideoModel:null,debouncedGetPanelParams:null,isRetryOrRemixOrPortal:!1,defaultInter:1,menuIndex:"textToImage",defaultModule:"canny",UPLOAD:new f.a({type:2}),fluxModelId:_.m,randomPrompt:"",paymentInfoDone:!1,userInfoDone:!1,calcCost:0,throttledClick:null,throttledGetMultiImg2videoCost:null,isPosting:!1,defaultModel:null,defaultVideoModel:null,needGoogleCaptcha:"",activeCategory:"model",listParams:{viewMode:1,task_domain_types:[],use_model_series:[],save_modes:[],time_from:"",time_to:""},discountOff:0,costInfo:{},pendingShowParams:null,isMounting:!1,isShowSale:!1,debounceGenerate:function(){},debounceUpdateRouteParams:function(){},createOpenParams:{},appImageInputUrl:"",use_gen_guide_template_id:"",use_gen_guide_template_hash:"",isShowCreationGuidance:!1,isUpdatePanelParams:!0,isShowCreativeAssistant:!1,isRemixScene:!1,isShowMessageManage:!1}},computed:oe(oe(oe(oe(oe(oe({},Object(h.c)("creation",["taskBaseModels","animationLoraRecommends","taskModules","taskUnits","taskSdxlUnits","taskModels","sd_xl_base_model","image_mode","lab_base_model","lab_ctr_units","lab_style_enhancement_tag","default_flux","size_billing_rule","v2_sd_xl_ctr_units","v2_ctr_units","modelDefaultConfigParams","default_ai_app","IllustriousVersionIdList","isIgnoreUnAvailableLora"])),Object(h.c)("user",["accountSettingsData","userInfo","isCompanyAccount","isLoggedIn","getEnableUsePresetConfig"])),Object(h.e)("payment",["paymentInfo"])),Object(h.e)("user",["cdnHost"])),Object(h.e)("app",["ABInfo"])),{},{costCalculationTrigger:function(){return{currentSpecialEffectsTemplateInfo:this.currentSpecialEffectsTemplateInfo,currentSpecialEffectsImageList:this.currentSpecialEffectsImageList,getCurrentVideoTab:this.getCurrentVideoTab,computedCost:this.computedCost,currentPrompt:this.currentPrompt,currentPromptMagicStatus:this.currentPromptMagicStatus,currentImageSizeStatus:this.currentImageSizeStatus,modelParams:this.modelParams,currentWidth:this.currentWidth,currentHeight:this.currentHeight,currentUpscaler:this.currentUpscaler,currentFaceRepair:this.currentFaceRepair,currentPersonRepair:this.currentPersonRepair,currentPersonRepairObj:this.currentPersonRepairObj,currentImageOrControlNet:this.currentImageOrControlNet,hasActiveIpMain:this.hasActiveIpMain,hasEnableControlNetToImageLength:this.hasEnableControlNetToImageLength,currentModelId:this.currentModelId,currentSteps:this.currentSteps,activeVideoInputTab:this.activeVideoInputTab,videoGenerationMode:this.videoGenerationMode,videoStyle:this.videoStyle,videoMotionMode:this.videoMotionMode,speed_type:this.currentConfigInfo.speed_type}},currentConfigInfo:function(){return this.config[this.currentTab]||{}},imageDefaultSize:function(){var e,t,n=null===(e=this.modelParams)||void 0===e||null===(e=e.resolution_param)||void 0===e||null===(e=e.dft_resolution_options)||void 0===e?void 0:e.map((function(e,i){return{code:i+1,icon:se[e.aspect_ratio],label:e.aspect_ratio,aspect_ratio:e.aspect_ratio,width:e.width,height:e.height}}));return null!==(t=this.modelParams)&&void 0!==t&&null!==(t=t.resolution_param)&&void 0!==t&&null!==(t=t.options)&&void 0!==t&&t.length&&n.push({code:5,icon:"icon-icon-Custom",label:"more"}),n},isNotLoginAndIsVideoGenerate:function(){return!this.isLoggedIn&&"generateVideo"===this.currentTab},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},vipLevel:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.productLevel},isOnlyVipLite:function(){var e,t;return!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState)&&!this.isCompanyAccount&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},isSd35Model:function(){var e=this.currentConfigInfo.base_model_type;return["SD 3.5"].includes(e)||(e||"").includes("SD 3.5")},isSDXLModel:function(){var e,t=null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type;return["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony","SDXL Hyper"].concat(Object(r.a)(_.L.sdxl)).includes(t)||(t||"").includes("SDXL")},isSdModel:function(){var e,t=null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type;return[].concat(Object(r.a)(_.L.sd),Object(r.a)(_.L.sd3),["SD 1.5 LCM","SD 1.5 Hyper"],Object(r.a)(_.L.other)).includes(t)},isCommunityFlux:function(){var e,t=null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type;return _.L.flux.includes(t)},isHiDreamModel:function(){var e,t=null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type;return((null===_.L||void 0===_.L?void 0:_.L.HiDream)||[]).includes(t)},isSeaArtFilmModel:function(){var e,t=null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type;return((null===_.L||void 0===_.L?void 0:_.L.SeaDream)||[]).includes(t)},currentVideoModelConfig:function(){var e;return(null===(e=this.videoModelParams)||void 0===e?void 0:e[{img2video:"i2v_model_param",txt2video:"t2v_model_param"}[this.activeVideoInputTab]])||{}},isEnableModelQuickConfig:function(){var e,t,n,o;return!((null===(e=this.modelParams)||void 0===e?void 0:e.model_no)!==(null===(t=this.currentConfigInfo)||void 0===t?void 0:t.art_model_no)||null===(n=Object.keys(this.modelParams||{}))||void 0===n||!n.length)&&!(null===(o=this.modelParams)||void 0===o||null===(o=o.image_model_generation_param)||void 0===o||!o.enable_config_option)},currentImageModelConfig:function(){var e;return(null===(e=this.modelParams)||void 0===e?void 0:e.image_model_generation_param)||{}},isShowAnimeEnhance:function(){var e=this.currentConfigInfo,t=this.getStudioModelTagsType(e);return this.isSDXLModel&&"anime"===t},isAnimeEnhanceEnable:function(){var e,t=this.currentConfigInfo,n=1===(null==t||null===(e=t.generate)||void 0===e?void 0:e.anime_enhance),o=this.isShowAnimeEnhance;return n&&o},getCurrentGenerateType:function(){var e=this.currentConfigInfo,t=(e.imageToImageList||[]).filter((function(e){return null==e?void 0:e.enable})),n=(e.controlnet_units||[]).filter((function(e){return null==e?void 0:e.enable}));return this.isCommunityFlux||!(null!=t&&t.length||null!=n&&n.length)||this.isAnimeEnhanceEnable||this.isSd35Model?"textToImage":null!=t&&t.length?"imageToImage":null!=n&&n.length?"conditionToImage":"textToImage"},getCurrentEquivalentCategory:function(){var e=1,t=this.currentConfigInfo,n=this.getCurrentModelType(t.base_model_type);return this.isCommunityFlux||this.isAnimeEnhanceEnable?e=7:"SD"===n?(0===t.generate.mode&&(e=1),1===t.generate.mode&&(e=2),2===t.generate.mode&&(e=6),e):"SDXL"===n?e=5:void 0},currentPrompt:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.prompt},currentPromptMagicStatus:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate)||void 0===e?void 0:e.prompt_magic_mode},currentImageSizeStatus:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate)||void 0===e?void 0:e.gen_mode},computedCost:function(){var e,t,n=this.currentConfigInfo,o=this.size_billing_rule.baselines||[],l=this.size_billing_rule.extra_rule||[],r=this.size_billing_rule.face_restoration||[],c=(null===(e=this.size_billing_rule)||void 0===e?void 0:e.imt_to_img_baselines)||[],d=(null===(t=this.size_billing_rule)||void 0===t?void 0:t.lab_billing_rule)||{},v=1,m=Math.max(n.width,n.height);(o||[]).forEach((function(e){m>e.min&&m<=e.max&&(v=e.value)})),["conditionToImage","imageToImage"].includes(this.getCurrentGenerateType)&&(c||[]).forEach((function(e){m>e.min&&m<=e.max&&(v=e.value)}));var h=1,f=this.getCurrentEquivalentCategory;(l||[]).forEach((function(e){e.task_category===f&&(h=e.value||1)}));var _=0,y=(null==n?void 0:n.agency_fee)||0;(n.lora_models||[]).forEach((function(e){e&&e.agency_fee>0&&(_+=e.agency_fee)}));var C=null;C=5===f?6*(n.n_iter||1):v*h*(n.n_iter||1),"LCM"===n.sampler_name&&(C*=.5);var w=C;if([4,5,7].includes(f)||(w=C+_+y),n.enable_hr&&""!==n.hr_upscaler&&[1,"1"].includes(f)){var k,I=n.hr_scale||6,x=n.width*I,T=n.height*I,S=1,O=(null===(k=this.size_billing_rule)||void 0===k?void 0:k.hd)||[],P=Math.max(x,T);(O||[]).forEach((function(e){P>e.min&&P<=e.max&&(S=e.value)}));var M=1;(l||[]).forEach((function(e){2===e.task_action&&e.task_category===f&&(M=e.value||1)})),w+=S*M*(n.n_iter||1)}if(!["",null,void 0].includes(n.ad_model)&&["textToImage","imageToImage"].includes(this.getCurrentGenerateType)&&![7,"7",5,"5","sdxl","studio"].includes(f)){var L=0;(r||[]).forEach((function(e){m>e.min&&m<=e.max&&(L=e.value||0)})),w+=L*(n.n_iter||1)}if(7===f){var $,D={conditionToImage:"contrlnet_to_img",textToImage:"text_to_img",imageToImage:"img_to_img"}[this.getCurrentGenerateType]||"",j=D&&d[D]||6,E=0;if([1].includes(null==n||null===($=n.generate)||void 0===$?void 0:$.anime_enhance)&&"textToImage"===this.getCurrentGenerateType){E=2*(n.n_iter||1)}w=j*(n.n_iter||1)+E}return 3===n.speed_type&&(w=0),w},currentModelType:function(){var e;return this.getCurrentModelType(null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type)},currentWidth:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.width},currentHeight:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.height},currentUpscaler:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.hr_upscaler},currentFaceRepair:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.restore_faces},currentPersonRepair:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.ad_model},currentPersonRepairObj:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.ad_units},currentImageOrControlNet:function(){try{var e=this.currentConfigInfo,t=(e.imageToImageList||[]).filter((function(e){return null==e?void 0:e.enable})),n=(e.controlnet_units||[]).filter((function(e){return null==e?void 0:e.enable}));return this.isCommunityFlux||!(null!=t&&t.length||null!=n&&n.length)||this.isAnimeEnhanceEnable?"textToImage":null!=t&&t.length?"imageToImage":null!=n&&n.length?"conditionToImage":"textToImage"}catch(e){return"textToImage"}},currentRawModelType:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.base_model_type},hasEnableImageToImage:function(){var e;return((null===(e=this.currentConfigInfo)||void 0===e?void 0:e.imageToImageList)||[]).some((function(e){return null==e?void 0:e.enable}))},hasEnableControlNetToImage:function(){var e;return((null===(e=this.currentConfigInfo)||void 0===e?void 0:e.controlnet_units)||[]).some((function(e){return null==e?void 0:e.enable}))},hasEnableControlNetToImageLength:function(){var e;return((null===(e=this.currentConfigInfo)||void 0===e?void 0:e.controlnet_units)||[]).length},isEnableQuality:function(){try{var e;return 1===(null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate)||void 0===e?void 0:e.gen_mode)}catch(e){}},taskControlNetModules:function(){return null!=this&&this.isSDXLModel?this.v2_sd_xl_ctr_units:this.v2_ctr_units},hasActiveIpMain:function(){var e,t=null==this?void 0:this.currentConfigInfo;return["FLUX"===this.getCurrentModelType(null==t?void 0:t.base_model_type),((null==t?void 0:t.ipList)||[]).some((function(e){return null==e?void 0:e.enable})),!(null!=t&&null!==(e=t.lora_models)&&void 0!==e&&e.length)].every((function(e){return e}))},hasIpMaintain:function(){var e,t,n=null==this?void 0:this.currentConfigInfo;return["FLUX"===this.getCurrentModelType(null==n?void 0:n.base_model_type),null==n||null===(e=n.ipList)||void 0===e?void 0:e.length,!(null!=n&&null!==(t=n.lora_models)&&void 0!==t&&t.length)].every((function(e){return e}))},currentModelId:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.art_model_no},hasListSelectOptions:function(){var e,t,n,o,l;return(null===(e=this.listParams)||void 0===e||null===(e=e.save_modes)||void 0===e?void 0:e.length)||(null===(t=this.listParams)||void 0===t||null===(t=t.use_model_series)||void 0===t?void 0:t.length)||(null===(n=this.listParams)||void 0===n||null===(n=n.task_domain_types)||void 0===n?void 0:n.length)||(null===(o=this.listParams)||void 0===o?void 0:o.time_from)||(null===(l=this.listParams)||void 0===l?void 0:l.time_to)},notNeedCheckPrompt:function(){var e,t,n=null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.imageToVideoList)||void 0===e?void 0:e.length,o=(this.isMiniMax||this.isKLModel||this.isTongYiFast||this.isTongYiProfessional||this.isPixVerse||this.isSeaArtStream)&&n,l="effect"===(null===(t=this.currentConfigInfo)||void 0===t?void 0:t.currentVideoTab)&&this.isVideoModel;return o||l},currentSteps:function(){var e;return null===(e=this.currentConfigInfo)||void 0===e?void 0:e.steps},activeVideoInputTab:function(){var e;return null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.currentVideoInputToolTab},currentSpecialEffectsTemplateInfo:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.SpecialEffectsAppInfo)||null},currentSpecialEffectsImageList:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.specialEffectsImageList)||[]},videoGenerationMode:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.quality_mode)||""},videoMotionMode:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.motion_mode)||""},videoStyle:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.style)||""},checkIsShowDisable:function(){var e;if("generateVideo"===this.currentTab&&"effect"===(null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab)){var t,n,o,l=(null===(t=this.currentConfigInfo)||void 0===t||null===(t=t.SpecialEffectsAppInfo)||void 0===t||null===(t=t.templateInfo)||void 0===t||null===(t=t.inputs)||void 0===t?void 0:t.length)||1;!(null!==(n=this.currentConfigInfo)&&void 0!==n&&null!==(n=n.effectImageList)&&void 0!==n&&null!==(n=n.slice(0,l))&&void 0!==n&&n.every((function(e){return null==e?void 0:e.url}))&&null!==(o=this.currentConfigInfo)&&void 0!==o&&null!==(o=o.SpecialEffectsAppInfo)&&void 0!==o&&o.id)}},getDiscountOffText:function(){return"".concat(null==this?void 0:this.discountOff,"% Off")},getCurrentVideoTab:function(){var e;return null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab},isNoobai:function(){var e=this.currentConfigInfo.base_model_type;return["NoobAI"].includes(e)||(e||"").includes("NoobAI")},currentRouteParams:function(){var e,t,n,o,l,r,c,d={},v=this.currentTab;"generateVideo"===this.currentTab&&["effect","multiImage"].includes(null===(e=this.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab)&&(v=ae[null===(c=this.currentConfigInfo)||void 0===c?void 0:c.currentVideoTab]);switch(v){case"generateImage":case"generateVideo":d={type:v,id:null===(t=this.currentConfigInfo)||void 0===t?void 0:t.art_model_no,model_ver_no:null===(n=this.currentConfigInfo)||void 0===n?void 0:n.art_model_ver_no};break;case"app":d={type:"app",id:null===(o=this.currentConfigInfo)||void 0===o||null===(o=o.categoryInfo)||void 0===o?void 0:o.id};break;case"effect":d={type:"effect",id:null===(l=this.currentConfigInfo)||void 0===l||null===(l=l.SpecialEffectsAppInfo)||void 0===l?void 0:l.id};break;case"generateAudio":d={type:(null===(r=this.currentConfigInfo)||void 0===r?void 0:r.currentAudioTab)||"audio"};break;case"element":d={type:"element"}}return d},notUserNeedCheckPrompt:function(){var e;return!this.isLoggedIn&&["A","B","C","D"].includes(null===(e=this.ABInfo)||void 0===e?void 0:e.task_generation_guide_gray)}}),watch:{costCalculationTrigger:{handler:function(){this.throttledClick&&this.throttledClick()},deep:!0},isShowPopup:{handler:function(e){var t;e&&(this.debounceUpdateRouteParams(null===(t=this.currentRouteParams)||void 0===t?void 0:t.type),this.isMounting||this.setGenerateImageDefaultConfig())}},currentRouteParams:{handler:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&(null==e?void 0:e.type)&&this.debounceUpdateRouteParams(null==e?void 0:e.type)},deep:!0},isVip:{handler:function(){[2,"2"].includes(this.currentGenerateMode)&&this.setGenerateImageDefaultConfig()}},paymentInfo:{handler:function(e){var t;null!==(t=Object.keys(e))&&void 0!==t&&t.length&&(this.paymentInfoDone=!0,this.changeSpeedType())},deep:!0,immediate:!0},userInfo:{handler:function(e){var t;if(null!==(t=Object.keys(e))&&void 0!==t&&t.length){this.userInfoDone=!0,this.changeSpeedType();var n=e.settings,o=(void 0===n?{}:n).insight;this.readOff=1===o}},deep:!0,immediate:!0},currentRawModelType:{handler:function(e,t){if(this.config[this.currentTab].prompt&&e!==t&&this.throttledClick&&this.throttledClick(),e&&e!==t&&["generateVideo","generateImage"].includes(this.currentTab)){var n,o,l=!0;["generateImage"].includes(this.currentTab)&&this.isRemixScene&&(l=!1),this.debouncedGetPanelParams({base_model_name:e,model_no:null===(n=this.config[this.currentTab])||void 0===n?void 0:n.art_model_no,model_ver_no:null===(o=this.config[this.currentTab])||void 0===o?void 0:o.art_model_ver_no},l),this.isRemixScene=!1}},immediate:!0,deep:!0},isLoggedIn:{handler:function(e,t){this.getHistory(),"generateImage"!==this.activeCategory&&(this.activeCategory="generateImage"),!e&&t&&this.checkNeedGoogleCaptcha(),this.setGenerateImageDefaultConfig()},immediate:!0}},created:function(){this.throttledClick=Object(k.throttle)(this.getCalcCost,2e3),this.throttledGetMultiImg2videoCost=Object(k.throttle)(this.getMultiImg2videoCost,2e3),this.debouncedGetPanelParams=Object(k.debounce)(this._getPanelParams,500)},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.currentVideoModel=null,e.debounceUpdateRouteParams=Object(k.debounce)(e.updateRouteParams,500),e.debounceGenerate=Object(k.debounce)(e.handleGenerate,500),e.isMounting=!0,e.getDefaultInter(),e.$EventBus.$on("updateCategoryInfo",e.updateCategoryInfo),e.$EventBus.$on("openEasyVideoExtension",e.openEasyVideoExtensionModal),e.$EventBus.$on("openEasyVideoFrameInterpolation",e.openEasyVideoFrameInterpolationModal),e.isLoggedIn&&(null==e||null===(n=e.lab_base_model)||void 0===n||!n.length)){t.next=12;break}return o=[e.$store.dispatch("creation/getTaskOptionsInfo"),e.$store.dispatch("creation/getV2TaskOptionsInfo")],t.next=12,Promise.all(o);case 12:return e.isLoggedIn&&e.loadInitialData(),t.next=15,e.init();case 15:e.isMounting=!1,e.pendingShowParams&&(l=e.pendingShowParams,r=l.params,c=l.isKeep,d=l.keepMode,e.pendingShowParams=null,e.show(r,c,d));case 17:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.currentVideoModel=null,this.throttledClick=null,this.throttledGetMultiImg2videoCost=null,this.debouncedGetPanelParams=null,this.$EventBus.$off("updateCategoryInfo",this.updateCategoryInfo),this.$EventBus.$off("openEasyVideoRecModal",this.openVideoModal),this.$EventBus.$off("openEasyVideoExtension",this.openEasyVideoExtensionModal),this.$EventBus.$off("openEasyVideoFrameInterpolation",this.openEasyVideoFrameInterpolationModal),this.removeDeductionResult()},methods:oe(oe(oe({},Object(h.b)("payment",["getPaymentInfo"])),Object(h.b)("user",["getAccountInfo"])),{},{getImageGenerateConfig:function(){return{n_iter:this.isLoggedIn?4:this.defaultInter||2,gen_mode:this.isLoggedIn&&this.isVip&&this.vipLevel>1?1:0}},setGenerateImageDefaultConfig:function(){try{var e=this.getImageGenerateConfig();e&&(this.$set(this.config.generateImage,"n_iter",e.n_iter),this.$set(this.config.generateImage.generate,"gen_mode",e.gen_mode))}catch(e){}},setAidescribe:function(e){this.$refs.deductionPromptModal.showModal({image:e,result:[],isDeduction:!0})},setImgGenerate:function(e){var t={url:e||"",denoising_strength:.35,mask:"",copyMask:"",enable:!0,width:0,height:0};this.updateConfig({imageToImageList:[t]},this.currentTab)},handleShowCreativeAssistant:function(){this.isShowCreativeAssistant=!this.isShowCreativeAssistant,this.throttledClick&&this.throttledClick()},handleGeneratePrompt:function(e){this.config[this.currentTab].prompt=e,this.handleGenerate()},handleOpenModelRecipe:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image"){case"image":this.$refs.modelRecipe.showModal();break;case"video":this.$refs.videoInspirationLibrary.showModal();break;case"music":this.$refs.musicInspirationLibrary.showModal()}},handleRecipeRemix:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generateImage";this.switchTab(t),this.getConfig({data:{art_work_no:e,scene:j.GENERATE_SCENE.recipe_remix},action:1,isRecipeRemix:!0,tab:t})},handleUseParams:function(e){var t=this,n=e.params,o=e.paramsType;this.switchTab("generateImage"),{Prompt:function(){t.config.generateImage.prompt=n},Lora:function(){var e=[],o=[];n.forEach((function(t){var n;"TextualInversion"===t.model_type?o.push({base_model:t.base_model_name,id:t.id,model_id:t.id,model_type:t.model_type,type:t.model_type,model_ver_no:t.model_ver_no,model_ver_id:t.model_ver_no,status:1,publish_status:1,banner:t.banner,version_name:t.version_name,name:t.name,trained_words:t.trained_words}):e.push({base_model:t.base_model_name,id:t.id,model_id:t.id,model_type:t.model_type,type:t.model_type,model_ver_no:t.model_ver_no,name:t.name,status:1,weight:null!==(n=t.weight)&&void 0!==n?n:1,publish_status:1,banner:t.banner,version_name:t.version_name})})),t.updateConfig({lora_models:e,embeddings:o},"generateImage")},AdvancedConfig:function(){t.updateConfig(n,"generateImage")},NegativePrompt:function(){t.config.generateImage.negative_prompt=n}}[o]()},handleUseVideoInspirationParams:function(e){Object(N.handleUseInspirationParams)(e,this)},handleUseAudioInspirationParams:function(e){var t=this,n=e.params;({Prompt:function(){t.config.generateAudio.aiVoice.prompt=n},Lyric:function(){t.config.generateAudio.aiVoice.lyrics=n}})[e.paramsType]()},handleMusicRecipeRemix:function(e){var t="";try{t=JSON.parse(null==e?void 0:e.attr).prompt}catch(e){t=""}this.handleAudioNavigation({data:{currentAudioTab:"aiVoice",prompt:t,lyrics:(null==e?void 0:e.prompt)||""}})},handleOpenNoteListModal:function(e){var t,n=e.source,source=void 0===n?"":n;null===(t=this.$refs)||void 0===t||null===(t=t.generateImageParamsPanel[0])||void 0===t||t.handleNoteVitor({source:source})},handleUseText:function(text){this.config[this.currentTab].prompt=text},getHistory:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={limit:30,display_mode:1,scene:"guest_task_item_count"},e.isLoggedIn||(n.g_mode=1),t.next=4,Object(T.easyGetDefaultHistory)(n);case 4:1e4===(o=t.sent).status.code&&(["A","B","C","D"].includes(null===(l=e.ABInfo)||void 0===l?void 0:l.task_generation_guide_gray)?e.isShowCreationGuidance=!(null!==(r=o.data)&&void 0!==r&&null!==(r=r.items)&&void 0!==r&&r.length):e.isShowCreationGuidance=!1);case 6:case"end":return t.stop()}}),t)})))()},handleClickItem:function(data){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=data.itemId,o=data.actionType,e.use_gen_guide_template_id=n,e.switchTab("generateImage"),t.next=5,new Promise((function(t){var o=e.config.generateImage.loading;e.getConfig({data:{source:9,obj_id:n},action:1,isGuide:!0}),function e(){o?setTimeout(e,500):t()}()}));case 5:return t.next=7,new Promise((function(e){setTimeout((function(){e()}),1500)}));case 7:({A:function(){e.handleGenerate()},B:function(){},C:function(){e.handleGenerate()},D:function(){}})[o]();case 9:case"end":return t.stop()}}),t)})))()},updateRouteParams:function(){var e,t,n,o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",map={generateImage:"image",generateVideo:"video",app:"ai-app",effect:"effect",aiVoice:"song",videoAddLipSync:"lipsync",videoAddMusic:"sound-effect",element:"element"};if(l&&map[l]){var r,c={};switch(l){case"generateImage":case"generateVideo":c={id:null===(e=this.config[l])||void 0===e?void 0:e.art_model_no,model_ver_no:null===(t=this.config[l])||void 0===t?void 0:t.art_model_ver_no};break;case"app":c={id:null===(n=this.config[l])||void 0===n||null===(n=n.categoryInfo)||void 0===n?void 0:n.id};break;case"effect":c={id:null===(o=this.config.generateVideo)||void 0===o||null===(o=o.SpecialEffectsAppInfo)||void 0===o?void 0:o.id};break;default:c={}}r={generateType:map[l]};var d=oe({},this.$route.query),v=oe(oe({},d),c),path=this.localePath("/create/".concat(map[l])),m=this.$router.resolve({path:path,params:r,query:Object.keys(v).length?v:void 0});window.history.replaceState(oe({},history.state),document.title,m.href),this.$emit("updateGenerateType")}},checkIsIllustriousVersionId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(this.IllustriousVersionIdList||[]).some((function(t){return t===e}))},switchTab:function(e){var t;this.currentTab=e,"generateImage"!==e&&(this.isShowCreativeAssistant=!1),this.handleSwitchTabLogEvent(e);var n=e;"generateVideo"===e&&["effect","multiImage"].includes(this.config.generateVideo.currentVideoTab)&&(n=ae[this.config.generateVideo.currentVideoTab]),this.updateRouteParams(n);var o=this.config.generateVideo;this.isLoggedIn||o.prompt||null!==(t=o.imageToVideoList[0])&&void 0!==t&&t.firstFrame,["SeaArt Film Video","SeaArt Ultra Pro"].includes(this.config.generateVideo.base_model_type)},getTemplateImages:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ie.d)({count:1,scene:3,model_no:e.config.generateVideo.art_model_no});case 2:return n=t.sent,t.abrupt("return",n.data.image_urls);case 4:case"end":return t.stop()}}),t)})))()},setVideoTemplate:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTemplateImages();case 2:n=t.sent,o=n[0],e.updateConfig({prompt:e.$t(o.prompt),imageToVideoList:[{mode:"first_frame",url:o.imgs[0],firstFrame:o.imgs[0],lastFrame:""}],isImageToVideoInitData:!0},"generateVideo"),localStorage.setItem("videoTemplate",JSON.stringify({prompt:e.$t(o.prompt),imageToVideoList:[{mode:"first_frame",url:o.imgs[0],firstFrame:o.imgs[0],lastFrame:""}],creator_temp_id:o.creator_temp_id,art_model_ver_no:e.config.generateVideo.art_model_ver_no,art_model_no:e.config.generateVideo.art_model_no}));case 6:case"end":return t.stop()}}),t)})))()},handleSwitchTabLogEvent:function(){var e={generateImage:"click_image_generate",generateVideo:"click_video_generate",app:"click_ai_app",generateAudio:"click_audio"}[arguments.length>0&&void 0!==arguments[0]?arguments[0]:""]||"";e&&this.$logEvent("log_actions",{operation:e,behavior_info:"on_createflow_page"})},changeConfigAndSwitchTab:function(e){var t=e.tabIndex,n=void 0===t?"":t,o=e.subMenuIndex;if("generateVideo"===n&&"effect"===(void 0===o?"":o))try{this.switchTab("generateVideo"),this.config.generateVideo.currentVideoTab="effect"}catch(e){}},initDefaultModelInfo:function(){var e,t,n,o,l,r,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v={},m={};if(!c||!["generateImage","generateVideo"].includes(c))return v;"generateImage"===c?(m=this.defaultModel||{},this.notUserNeedCheckPrompt?v.prompt="":v.prompt=(null===(r=m)||void 0===r?void 0:r.positive_prompt)||""):"generateVideo"===c&&(m=this.defaultVideoModel||{});if(m=JSON.parse(JSON.stringify(m)),v.art_model_no=(null===(e=m)||void 0===e?void 0:e.id)||"",v.modelName=m.name||"",v.model_cover=(null===(t=m)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url)||"",v.art_model_ver_no_name=(null===(n=m)||void 0===n?void 0:n.version_name)||"",v.art_model_ver_no=(null===(o=m)||void 0===o?void 0:o.model_ver_no)||"",v.base_model_type=(null===(l=m)||void 0===l?void 0:l.base_model)||"",v.modelTags=[],"generateVideo"===c){var h,f=this.initVideoModelDefaultParams(null===(h=v)||void 0===h?void 0:h.base_model_type);v=Object.assign(v,f)}var _=this.getStaticConfig(v.base_model_type);return v=Object.assign(v,_||{}),d&&this.$set(this.config,c,Object.assign(this.config[c],v)),v},initDefaultAppInfo:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(e.length>1&&void 0!==e[1]?e[1]:"")||t.default_ai_app||"",r={template_id:o},c={},n.next=7,Object(G.e)(r).then(function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(t){var n,l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=t.data,c={banner:{url:(null==(data=void 0===l?{}:l)||null===(n=data.samples)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.url)||""},id:o,name:(null==data?void 0:data.name)||""};case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){}));case 7:return n.abrupt("return",{categoryInfo:c});case 8:case"end":return n.stop()}}),n)})))()},getStaticConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(null==this?void 0:this.modelDefaultConfigParams[e])||{};return Object.assign({},t)||{}},getModelDefaultConfig:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=e.length>0&&void 0!==e[0]?e[0]:"",r=(null==t?void 0:t.modelDefaultConfigParams)||{},null!==(o=Object.keys(r))&&void 0!==o&&o.length){n.next=5;break}return n.next=5,t.$store.dispatch("creation/getV2TaskOptionsInfo");case 5:return c=(null==t?void 0:t.modelDefaultConfigParams[l])||{},d=Object.assign({},c),n.abrupt("return",d||{});case 8:case"end":return n.stop()}}),n)})))()},updateListParams:function(e){this.$set(this,"listParams",Object.assign(this.listParams,e||{}))},resetListParams:function(){var e={viewMode:1,keyword:"",task_domain_types:[],use_model_series:[],save_modes:[],time_from:"",time_to:""};arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(e.viewMode=this.listParams.viewMode),this.$set(this,"listParams",e)},loadInitialData:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.getAccountInfo(),e.getPaymentInfo()]);case 2:case"end":return t.stop()}}),t)})))()},updateCategoryInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.obj,o=e.type;if((null!==n||null!==o)&&(this.categoryInfo=null!=n&&n.id?n:this.categoryInfo,"aiApp"===o)){var l=Object(k.cloneDeep)(this.categoryInfo),r=oe(oe({},this.config.app),{},{categoryInfo:l});this.$set(this.config,"app",r),"app"===t&&this.switchTab("app")}},handleChannelSearch:function(e){var t;null==this||null===(t=this.$refs)||void 0===t||null===(t=t.taskView)||void 0===t||t.handleSearch(e),this.$logEvent("log_actions",{operation:"type_search",behavior_info:"on_new_create_flow_page"})},handleOpenDeductionPrompt:function(e){var image=e.image,t=e.result,n=e.isDeduction,o=void 0!==n&&n;this.$refs.deductionPromptModal.showModal({image:image,result:t,isDeduction:o})},updateSpeedType:function(e){for(var i in this.config)this.config[i]=oe(oe({},this.config[i]),{},{speed_type:e})},closeSubBanner:function(){this.$emit("closeSubBanner")},backOld:function(){this.saveConfig(),this.$emit("backOld",1)},closePopup:function(){var e;this.$EventBus.$emit("closeAllGeneratePopup"),this.$EventBus.$emit("closeDownloadVideoPopup"),this.$EventBus.$emit("closeRandomPromptPopup"),this.$emit("close"),this.isShowCreationGuidance=!1,this.removeDeductionResult(),null===(e=this.$refs)||void 0===e||null===(e=e.modelRecipe)||void 0===e||e.closeModal(!0),this.isShowCreativeAssistant=!1},removeDeductionResult:function(){localStorage.getItem("deductionResult")&&localStorage.removeItem("deductionResult")},init:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$EventBus.$off("openEasyAnimeToolsModal"),e.$EventBus.$off("openEasyUpscaleToolsModal"),e.$EventBus.$off("openEasyVideoRecModal"),e.$EventBus.$on("openEasyUpscaleToolsModal",e.openEasyUpscaleToolsModal),e.$EventBus.$on("openEasyAnimeToolsModal",e.openAnimeToolsModal),e.$EventBus.$on("openEasyVideoRecModal",e.openVideoModal),e.$store.dispatch("creation/getTaskOptionsInfo"),v=(null==e?void 0:e.modelDefaultConfigParams)||{},null!==(n=Object.keys(v))&&void 0!==n&&n.length||e.$store.dispatch("creation/getV2TaskOptionsInfo"),null!==(o=e.currentConfigInfo)&&void 0!==o&&o.art_model_no&&null!==(l=e.defaultModel)&&void 0!==l&&l.id){t.next=12;break}return t.next=12,e.getPresetModel(!1,!1);case 12:return t.next=14,e.resetConfig(!0);case 14:e.getPanelParams({base_model_name:null===(r=e.config)||void 0===r||null===(r=r[e.currentTab])||void 0===r?void 0:r.base_model_type,model_no:null===(c=e.config)||void 0===c||null===(c=c[e.currentTab])||void 0===c?void 0:c.art_model_no,model_ver_no:null===(d=e.config)||void 0===d||null===(d=d[e.currentTab])||void 0===d?void 0:d.art_model_ver_no}),e.saveConfig();case 16:case"end":return t.stop()}}),t)})))()},openEasyVideoExtensionModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{this.$refs.videoExtensionModal.show(e)}catch(e){}},openEasyVideoFrameInterpolationModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{this.$refs.videoFrameInterpolationModal.show(e)}catch(e){}},openVideoModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{this.handleSelectVideoModel({},e,this.defaultVideoModel)}catch(e){}},initParams:function(){var e,t=this;if(null===(e=this.currentConfigInfo)||void 0===e||!e.art_model_no)try{var n,o,l,r,c,d={},v=["imageToImage","conditionToImage"],m=(this.lab_base_model||[]).filter((function(e){var n=null==e?void 0:e.base_model.includes("SD 3.5");return v.includes(t.menuIndex)?!n:e}))[0];m=null===(n=this.getDefaultModel({}))||void 0===n?void 0:n.art_model,d.art_model_no=m.id,d.modelName=m.name,d.art_work_no="",d.lora_models=[],d.model_cover=(null===(o=m)||void 0===o?void 0:o.cover)||"",d.is_agency_fee=!1,d.agency_fee=0,d.art_model_ver_no_name=(null===(l=m)||void 0===l?void 0:l.model_ver_name)||"",d.art_model_ver_no=(null===(r=m)||void 0===r?void 0:r.model_ver_no)||"",d.base_model_type=(null===(c=m)||void 0===c?void 0:c.base_model)||"",d.modelTags=this.getStudioModelTags(m);var h=["textToImage"].includes(this.menuIndex)&&this.isCommunityFlux;if(h){Object.assign(d,{negative_prompt:"",cfg_scale:3.5,steps:25,category:1,sampler_name:"Euler",denoising_strength:.5,base_model_type:"",modelTags:[],embeddings:[],lab_base:{conds:[],style_selections:["Studio Enhance","Studio Expand"],expand_token_length:10,hdr_enabled:!0,hdr_intensity:.5,auto_brightness_open:!0,auto_brightness_strength:75,auto_adjust_open:!1,auto_adjust_strength:20,semantics_open:!1,film_turbo:0,sharpness:2,scheduler:"karras",custom_height_width:!1,quality_open:!1,quality_detail_offset:.45,quality_mode:1,quality_type:"anime",intelligence_open:!1,prompt_magic:!0},studio:{style:"classic",width:1152,height:896}});var f=this.getStudioDefaultStyle(d.base_model_type,h);d.studio.width=f.width,d.studio.height=f.height}this.$set(this.config,"textToImage",Object.assign(this.config.textToImage,d))}catch(e){}},resetStudioParams:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,m,h,f,y,C,w,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=["textToImage","imageToImage","conditionToImage"],o={negative_prompt:"",cfg_scale:6,steps:30,category:1,sampler_name:"Euler",denoising_strength:.5,base_model_type:"",modelTags:[],embeddings:[],lab_base:{conds:[],style_selections:["Studio Enhance","Studio Expand"],expand_token_length:10,hdr_enabled:!0,hdr_intensity:.5,auto_brightness_open:!0,auto_brightness_strength:75,auto_adjust_open:!1,auto_adjust_strength:20,semantics_open:!1,film_turbo:0,sharpness:2,scheduler:"karras",custom_height_width:!1,quality_open:!1,quality_detail_offset:.45,quality_mode:1,quality_type:"anime",intelligence_open:!1,prompt_magic:!0},studio:{style:"classic",width:1152,height:896}},t.prev=2,m=["imageToImage","conditionToImage"],h=(e.lab_base_model||[]).filter((function(t){var n=null==t?void 0:t.base_model.includes("SD 3.5");return m.includes(e.menuIndex)?!n:t})),h[0],f=null===(l=e.getDefaultModel({}))||void 0===l?void 0:l.art_model,o.art_model_no=f.id,o.modelName=f.name,o.art_work_no="",o.lora_models=[],o.model_cover=(null===(r=f)||void 0===r?void 0:r.cover)||"",o.is_agency_fee=!1,o.agency_fee=0,o.art_model_ver_no_name=(null===(c=f)||void 0===c?void 0:c.model_ver_name)||"",o.art_model_ver_no=(null===(d=f)||void 0===d?void 0:d.model_ver_no)||"",o.base_model_type=(null===(v=f)||void 0===v?void 0:v.base_model)||"",o.modelTags=e.getStudioModelTags(f),y=e.isCommunityFlux,C=e.getStudioDefaultStyle(o.base_model_type,y),o.studio.width=C.width,o.studio.height=C.height,((null===_.L||void 0===_.L?void 0:_.L.flux)||[]).includes(null==o?void 0:o.base_model_type)&&(o.sampler_name="Euler",o.cfg_scale=3.5,o.steps=25),t.next=25,e.getModelDefaultConfig(o.base_model_type);case 25:w=t.sent,Object.assign(o,w||{}),t.next=31;break;case 29:t.prev=29,t.t0=t.catch(2);case 31:n.includes(e.menuIndex)&&(k=Object.assign(e.config[e.currentTab],o),"conditionToImage"===e.menuIndex&&(k.lab_base.conds=(k.controlnet_units||[]).map((function(t){return e.$set(t,"type","canny"),{image:"",mode:"PyraCanny",stop_at:.5,weight:1}}))),e.$set(e.config,e.menuIndex,k));case 32:case"end":return t.stop()}}),t,null,[[2,29]])})))()},getRandomPrompt:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,pattern,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:"",n.prev=1,c={},null!==(l=t.currentConfigInfo)&&void 0!==l&&l.art_model_no&&(c.art_model_no=(null===(d=t.currentConfigInfo)||void 0===d?void 0:d.art_model_no)||""),c.scene="tf_v2",c.base_model_name=(null===(r=t.currentConfigInfo)||void 0===r?void 0:r.base_model_type)||"",null!=t&&t.isVideoModel&&t.handleVideoModelLogEvent("randomPrompt","click_random_prompts"),n.next=9,Object(w.getRandomPrompts)(c);case 9:if(v=n.sent,m=v.data.local,t.randomPrompt=m,"click"!==o){n.next=18;break}if(pattern=/--V6|--v6/g,text=(m||"").replace(pattern,""),!["",null,void 0].includes(text)){n.next=17;break}return n.abrupt("return");case 17:t.config[t.currentTab].prompt=text;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),t.isLoggedIn||10624!==n.t0.code||"generateVideo"!==t.currentTab||t.$EventBus.$emit("openLoginDialog"),t.randomPrompt="";case 24:case"end":return n.stop()}}),n,null,[[1,20]])})))()},setDeepProperty:function(e,path,t){for(var n=path.split("."),l=e,i=0;i<n.length-1;i++){var r=n[i];l[r]&&"object"===Object(o.a)(l[r])||this.$set(l,r,{}),l=l[r]}var c=n[n.length-1];this.$set(l,c,t)},updatePrompt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.config[this.currentTab].isTranslate=!1,"generateAudio"===this.currentTab)try{var t={aiVoice:"aiVoice.prompt",videoAddLipSync:"lipSyncParams.audioParams.prompt",videoAddMusic:"videoAddMusic.paramsForm.prompt"}[this.config[this.currentTab].currentAudioTab];return void(t&&this.setDeepProperty(this.config[this.currentTab],t,e))}catch(e){}this.config[this.currentTab].prompt=e},handleSimpleTextToImage:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(r=e.length>0&&void 0!==e[0]?e[0]:{})&&r.data){n.next=3;break}return n.abrupt("return");case 3:if(c=(null==r?void 0:r.data)||{},d=c.art_model_no,v=c.art_model_ver_no,m=(null==r||null===(o=r.data)||void 0===o?void 0:o.meta)||{},h=m.negative_prompt,f=m.prompt,(y={model_no:d,model_ver_no:v,channel_id:"",speed_type:t.currentConfigInfo.speed_type,meta:{cfg_scale:7,steps:20,lcm_mode:0,sampler_name:"DPM++ 2M Karras",width:683,height:1024,prompt:f||_.n.prompt,negative_prompt:h||_.n.negative_prompt,imageSize:2,n_iter:1,clip_skip:2,restore_faces:!1,prompt_magic:!0,vae:"vae-ft-mse-840000-ema-pruned",lora_models:[]}}).meta=Object.assign(y.meta,(null==r||null===(l=r.data)||void 0===l?void 0:l.meta)||{}),y.meta.generate=t.currentConfigInfo.generate,t.isLoggedIn){n.next=16;break}return y.g_mode=1,n.next=12,t.checkNeedGoogleCaptcha();case 12:if(1!==t.needGoogleCaptcha){n.next=16;break}return n.next=15,t.updateCaptcha("ttc_v2");case 15:y.g_recaptcha_token=t.captchaToken||"";case 16:Object(T.easyTextToImage)(y).then((function(e){var n,o;if([2e4,20001,20002,20003,20004,20301].includes(null==e||null===(n=e.status)||void 0===n?void 0:n.code))return t.$EventBus.$emit("openLoginDialog",{dot:!1}),void t.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});if(!e||1e4===(null==e||null===(o=e.status)||void 0===o?void 0:o.code)){t.$message.success(t.$t("CreateSuccess"));var l=Object.assign({},y,(null==e?void 0:e.data)||{});l.banner=null,l.img_uris=[],l.status=1,t.updateTask(l)}})).catch((function(e){})).finally((function(){}));case 17:case"end":return n.stop()}}),n)})))()},getPresetModel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=oe({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return Object(T.easyGetDefaultPresetModel)(n).then((function(n){var o=n||{},l=o.status.code,code=void 0===l?"":l;o.data;if([1e4,"10000"].includes(code)){var r,c,d=(null==n||null===(r=n.data)||void 0===r||null===(r=r.default_model)||void 0===r?void 0:r.art_model)||{};e.defaultModel=null!=d&&d.id?d:null;var v=(null==n||null===(c=n.data)||void 0===c||null===(c=c.default_video_model)||void 0===c?void 0:c.art_model)||{};e.defaultVideoModel=null!=v&&v.id?v:null,t&&(e.notUserNeedCheckPrompt?e.config[e.currentTab].prompt="":e.config[e.currentTab].prompt=(null==d?void 0:d.positive_prompt)||""),"modal"!==e.mode&&e.getPanelParams({base_model_name:null==d?void 0:d.base_model,model_no:null==d?void 0:d.id,model_ver_no:null==d?void 0:d.model_ver_no})}})).finally((function(){}))},show:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S,O,P,M,L,$,D,j,E,A,V;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(S=e.length>0&&void 0!==e[0]?e[0]:{},O=e.length>1&&void 0!==e[1]&&e[1],P=e.length>2&&void 0!==e[2]&&e[2],t.removeDeductionResult(),!t.isMounting){n.next=7;break}return t.pendingShowParams={params:S,isKeep:O,keepMode:P},n.abrupt("return");case 7:if(null!==(o=t.defaultModel)&&void 0!==o&&o.id){n.next=10;break}return n.next=10,t.init();case 10:if("HOME_CREATE_INPUT"!==(null==S||null===(l=S.data)||void 0===l?void 0:l.openType)?t.getHistory():t.isShowCreationGuidance=!1,t.createOpenParams=S.data,t.checkNeedGoogleCaptcha(),t.$store.dispatch("creation/setGenerateTaskNum",0),t.handleRetryOrRemixOrPortalOrNote(S),null==S||null===(r=S.data)||void 0===r||!r.portalParams||!Object.keys((null==S||null===(c=S.data)||void 0===c?void 0:c.portalParams)||{}).length){n.next=18;break}return t.handlePortalParams(null==S||null===(M=S.data)||void 0===M?void 0:M.portalParams,S),n.abrupt("return");case 18:if((!["generateImage","generateVideo"].includes(t.currentTab)||null!==(d=t.currentConfigInfo)&&void 0!==d&&d.art_model_no)&&null!==(v=t.defaultModel)&&void 0!==v&&v.id){n.next=21;break}return n.next=21,t.getPresetModel(!1,!0);case 21:if(!t.shouldSwitchToVideoModel(S)){n.next=25;break}return n.next=24,t.handleVideoModelSelection(S);case 24:return n.abrupt("return");case 25:if(!t.isAppCategory(S)){n.next=28;break}return t.handleAppNavigation(S),n.abrupt("return");case 28:if("AUDIO"!==(null==S||null===(m=S.data)||void 0===m?void 0:m.openType)){n.next=32;break}return null!=S&&null!==(L=S.data)&&void 0!==L&&L.currentAudioTab&&!["videoAddMusic","lipsync"].includes(null==S||null===($=S.data)||void 0===$?void 0:$.currentAudioTab)||(S.data.videoInfo=Object.assign({},(null==S||null===(D=S.data)||void 0===D?void 0:D.videoInfo)||{},{needCheckVideo:!0})),t.handleAudioNavigation(S),n.abrupt("return");case 32:if("SIMPLE"!==(null==S||null===(h=S.data)||void 0===h?void 0:h.openType)){n.next=36;break}return t.switchTab("generateImage"),t.handleSimpleTextToImage(S),n.abrupt("return");case 36:if("HOME_CREATE_INPUT"!==(null==S||null===(f=S.data)||void 0===f?void 0:f.openType)){n.next=39;break}return t.handleHomeCreateInput(S),n.abrupt("return");case 39:if(null==S||null===(_=S.data)||void 0===_||!_.imageToVideoUrl){n.next=43;break}return t.switchTab("generateVideo"),t.handleSelectVideoModel(S.data,null==S||null===(j=S.data)||void 0===j?void 0:j.imageToVideoUrl,t.defaultVideoModel),n.abrupt("return");case 43:if(0!==(null==S?void 0:S.action)){n.next=46;break}return t.handleTaskRefresh(S,O,P),n.abrupt("return");case 46:if(6!==(null==S?void 0:S.action)||null==S||null===(y=S.data)||void 0===y||!y.imageUrl){n.next=49;break}return t.getUpscaleParamsAndOpenModal(S),n.abrupt("return");case 49:if(24!==(null==S||null===(C=S.data)||void 0===C?void 0:C.action)||null==S||null===(w=S.data)||void 0===w||!w.parent_task_id){n.next=52;break}return t.handleAnimationGeneration(S),n.abrupt("return");case 52:if(48!==(null==S?void 0:S.action)||null==S||null===(k=S.data)||void 0===k||!k.parent_task_id){n.next=55;break}return t.handleMultiImageGeneration(S),n.abrupt("return");case 55:if("ai-tools-play"!==(null==S||null===(I=S.data)||void 0===I?void 0:I.scene)||null==S||null===(x=S.data)||void 0===x||!x.parent_task_id){n.next=58;break}return Object(N.handlePlayVideoScene)(S,t),n.abrupt("return");case 58:if(1!==(null==S?void 0:S.action)||"ai-tools-play-img"!==(null==S||null===(T=S.data)||void 0===T?void 0:T.scene)){n.next=62;break}return t.currentTab="generateImage","aiImg"===(null==S||null===(E=S.data)||void 0===E?void 0:E.type)?t.setAidescribe(null==S||null===(A=S.data)||void 0===A?void 0:A.url):t.setImgGenerate(null==S||null===(V=S.data)||void 0===V?void 0:V.url),n.abrupt("return");case 62:t.getConfig(oe(oe({},null==S?void 0:S.data),{},{action:null==S?void 0:S.action}));case 63:case"end":return n.stop()}}),n)})))()},handleSelectEffect:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(G.h)({template_id:null==e?void 0:e.id});case 3:o=n.sent,l=oe(oe({id:null==e?void 0:e.id},(null==o?void 0:o.data)||{}),{},{templateInfo:(null==o?void 0:o.data)||{}}),t.updateConfig({SpecialEffectsAppInfo:l},"generateVideo"),n.next=10;break;case 8:n.prev=8,n.t0=n.catch(0);case 10:case"end":return n.stop()}}),n,null,[[0,8]])})))()},handlePortalParams:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=(o=e||{}).targetTab,r=o.targetSubTab,c=o.id,d=o.model_ver_no,v=o.reMixId,m=void 0===v?"":v,h=o.appImageInputUrl,f=void 0===h?"":h,t.appImageInputUrl=f,"effect"!==l){n.next=10;break}if(!c){n.next=7;break}return n.next=7,t.handleSelectEffect({id:c});case 7:return t.switchTab("generateVideo"),t.$set(t.config.generateVideo,"currentVideoTab","effect"),n.abrupt("return",Promise.resolve());case 10:if(["generateImage","generateVideo","app","generateAudio"].includes(l)&&("generateVideo"===l&&t.$set(t.config.generateVideo,"currentVideoTab","videoModel"),t.switchTab(l)),!l||!["generateImage","generateVideo"].includes(l)||!c&&!d){n.next=17;break}return n.next=14,t.getModelInfo(c,d);case 14:return _=n.sent,t.updateConfig(_,l),n.abrupt("return",Promise.resolve());case 17:if("app"!==l||!c){n.next=24;break}return n.next=20,t.initDefaultAppInfo(r,c);case 20:return y=n.sent,m&&(y.reMixId=m),t.updateConfig(y,"app"),n.abrupt("return",Promise.resolve());case 24:if("multiImage"!==l){n.next=28;break}return t.switchTab("generateVideo"),t.updateConfig({currentVideoTab:"multiImage",currentVideoInputToolTab:j.VIDEO_CREATION_MODE.MULTI_IMG_TO_VIDEO},"generateVideo"),n.abrupt("return",Promise.resolve());case 28:return n.abrupt("return",Promise.resolve());case 29:case"end":return n.stop()}}),n)})))()},getModelInfo:function(e,t){return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={model_no:e,art_model_ver_no:t,task_flow_version:"v2"},n.next=3,Object(I.getTaskConfig)(o);case 3:return l=n.sent,r=l.data,c=(void 0===r?{}:r).art_model,d=c.id,v=c.name,m=c.version_name,h=c.base_model,f=c.model_ver_no,_=c.banner,y=void 0===_?{}:_,n.abrupt("return",{art_model_no:d||e,art_model_ver_no:f,art_model_ver_no_name:m,modelName:v,base_model_type:h,model_cover:(null==y?void 0:y.url)||"",modelTags:[]});case 15:case"end":return n.stop()}}),n)})))()},shouldSwitchToVideoModel:function(e){var t;return(null==e||null===(t=e.data)||void 0===t?void 0:t.selectUltraModel)&&!this.isVideoModel},handleVideoModelSelection:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.switchTab("generateVideo"),t.$EventBus.$emit("selectModel",{model:{id:null==e||null===(o=e.data)||void 0===o?void 0:o.id,model_ver_no:null==e||null===(l=e.data)||void 0===l?void 0:l.model_ver_no,banner:oe(oe({},null==e||null===(r=e.data)||void 0===r?void 0:r.banner),{},{url:"https://".concat(t.cdnHost,"/").concat(null==e||null===(c=e.data)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.url)})}});case 2:case"end":return n.stop()}}),n)})))()},isAppCategory:function(e){var t,n=(null==e||null===(t=e.data)||void 0===t?void 0:t.activeCategory)||"";return["fast_app","aiApp"].includes(n)},handleAppNavigation:function(e){var t,n,o,l,r,data=(null==e?void 0:e.data)||{},c={obj:{banner:(null==data||null===(t=data.creativity)||void 0===t?void 0:t.banner)||(null==data||null===(n=data.creativity)||void 0===n?void 0:n.cover),name:(null==data||null===(o=data.creativity)||void 0===o?void 0:o.title)||(null==data||null===(l=data.creativity)||void 0===l?void 0:l.name),id:null==data||null===(r=data.creativity)||void 0===r?void 0:r.id,reMixId:null==data?void 0:data.reMixId,imgUrlList:(null==data?void 0:data.imgUrlList)||[]},type:"aiApp"};this.switchTab("app"),this.updateCategoryInfo(c,"app")},handleAudioNavigation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.switchTab("generateAudio");var t=e.data,data=void 0===t?{}:t,n=data.currentAudioTab,o=void 0===n?"videoAddMusic":n,l=data.prompt,r=void 0===l?"":l,c=data.negative_prompt,d=void 0===c?"":c,v=data.videoInfo,m=void 0===v?{}:v,h=data.audioUrl,f=void 0===h?"":h,_=data.audioName,y=void 0===_?"":_,C=data.lyrics,w=void 0===C?"":C,k=data.duration,I=void 0===k?5:k,x={currentAudioTab:o};switch(o){case"videoAddMusic":var T=Object(U.getDefaultConfig)("generateAudio").videoAddMusic,S=oe(oe({},T.paramsForm),{},{prompt:r,enableNegativePrompts:!!d,negative_prompt:d,duration:I}),O=oe(oe({},T),{},{paramsForm:S,videoInfo:{id:(null==m?void 0:m.id)||"",isTask:(null==m?void 0:m.isTask)||!1,url:(null==m?void 0:m.url)||"",coverUrl:(null==m?void 0:m.coverUrl)||"",needCheckVideo:(null==m?void 0:m.needCheckVideo)||!1}});x.videoAddMusic=O;break;case"videoAddLipSync":var P=oe(oe({},Object(U.getDefaultConfig)("generateAudio").lipSyncParams),{},{videoInfo:{duration:(null==m?void 0:m.duration)||0,url:(null==m?void 0:m.url)||"",id:(null==m?void 0:m.id)||"",isTask:(null==m?void 0:m.isTask)||!1,needCheckVideo:(null==m?void 0:m.needCheckVideo)||!1},lipSyncTab:r?"lipSyncText":"lipSyncUpload"});P.audioParams.prompt=r,"lipSyncUpload"===P.lipSyncTab&&f&&(P.audioParams.localAudio.url=f,P.audioParams.localAudio.name=y),x.lipSyncParams=P;break;case"aiVoice":var M=Object(U.getDefaultConfig)("generateAudio").aiVoice;x.aiVoice=oe(oe({},M),{},{lyrics:w,prompt:r,generateMode:w||!r?"vocalSongs":"instrumentalSongs"})}this.updateConfig(x,"generateAudio")},handleHomeCreateInput:function(e){var t,n,o=((null==e||null===(t=e.data)||void 0===t?void 0:t.homeCreateInputParams)||{}).targetTab,l={generateImage:this.handleCreateImageTask,generateVideo:this.handleCreateVideoTask,app:this.handleCreateSmartEditTask};l[o]&&(["generateImage","generateVideo"].includes(o)&&this.switchTab(o),["app"].includes(o)&&this.handleAppNavigation({data:{creativity:(null==e||null===(n=e.data)||void 0===n||null===(n=n.homeCreateInputParams)||void 0===n?void 0:n.creativity)||{}}}),l[o](e))},handleCreateImageTask:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=(null==e||null===(o=e.data)||void 0===o?void 0:o.homeCreateInputParams)||{},r=l.requestParams,c=l.isImageToImage,d=void 0!==c&&c,null!=(v=oe(oe({},r),{},{source:80001}))&&v.model_no){n.next=4;break}return n.abrupt("return");case 4:if(t.isLoggedIn){n.next=12;break}return v.g_mode=1,n.next=8,t.checkNeedGoogleCaptcha();case 8:if(1!==t.needGoogleCaptcha){n.next=12;break}return n.next=11,t.updateCaptcha("ttc_v2");case 11:v.g_recaptcha_token=t.captchaToken||"";case 12:(d?T.easyImageToImage:T.easyTextToImage)(v,{customWhiteList:[2e4,20001,20002,20003,20004,20301]}).then((function(n){var o,l;if([2e4,20001,20002,20003,20004,20301].includes(null==n||null===(o=n.status)||void 0===o?void 0:o.code))return t.$xyLogEvent({front_operation:"click",entity_name:"homepage_creation",entity_type:"homepage_creation_guide_ai_image",event_name:"homepage_creation_guide_ai_image_onGenerate",obj_category:"aiImage",event_desc:"点击创作",user_status:t.isLoggedIn?"activated":"guest",obj_info:JSON.stringify({model_id:null==v?void 0:v.model_no})}),t.$EventBus.$emit("openLoginDialog",{loginFrom:"aiImage_task",callBack:function(){t.handleCreateImageTask(e)}}),void t.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});if(!n||1e4===(null==n||null===(l=n.status)||void 0===l?void 0:l.code)){t.$message.success(t.$t("CreateSuccess"));var r=Object.assign({},v,(null==n?void 0:n.data)||{});r.banner=null,r.img_uris=[],r.status=1,t.updateTask(r)}})).catch((function(e){})).finally((function(){}));case 14:case"end":return n.stop()}}),n)})))()},handleCreateVideoTask:function(e){var t,n,o,l,r,c,d,v=this,m=null!=e&&null!==(t=e.data)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&null!==(t=t.generate_video)&&void 0!==t&&null!==(t=t.image_opts)&&void 0!==t&&t.length?"imageToVideo":"textToVideo",h=T.easyTextToVideo;"imageToVideo"===m&&(h=T.easyImageToVideo);var f,_,y={model_no:null==e||null===(n=e.data)||void 0===n?void 0:n.model_no,model_ver_no:null==e||null===(o=e.data)||void 0===o?void 0:o.model_ver_no,meta:oe({},null==e||null===(l=e.data)||void 0===l?void 0:l.meta),ss:null==e||null===(r=e.data)||void 0===r?void 0:r.ss,source:80002};null!=e&&null!==(c=e.data)&&void 0!==c&&c.use_gen_guide_template_id&&null!=e&&null!==(d=e.data)&&void 0!==d&&d.use_origin_gen_guide_template_meta&&(y.use_gen_guide_template_id=null==e||null===(f=e.data)||void 0===f?void 0:f.use_gen_guide_template_id,y.use_origin_gen_guide_template_meta=null==e||null===(_=e.data)||void 0===_?void 0:_.use_origin_gen_guide_template_meta);h(y,{customWhiteList:[2e4,20001,20002,20003,20004,20301]}).then((function(t){var n,o;if([2e4,20001,20002,20003,20004,20301].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code))return v.$xyLogEvent({front_operation:"click",entity_name:"homepage_creation",entity_type:"homepage_creation_guide_ai_video",event_name:"homepage_creation_guide_ai_video_onGenerate",obj_category:"aiVideo",event_desc:"首页点击视频创作唤起登录",user_status:v.isLoggedIn?"activated":"guest",obj_info:JSON.stringify({model_id:null==e?void 0:e.model_no})}),void v.$EventBus.$emit("openLoginDialog",{loginFrom:"aiVideo_task",callBack:function(){v.handleCreateVideoTask(e)}});if(!t||1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){v.$message.success(v.$t("CreateSuccess"));var l=Object.assign({},e,(null==t?void 0:t.data)||{});l.banner=null,l.img_uris=[],l.status=1,["imageToVideo","textToVideo"].includes(m)&&(l.task_domain_type="textToVideo"===m?11:12),["imageToVideo"].includes(m)&&null!=e&&e.template_id&&(l.task_domain_type=15),v.updateTask(l),v.updateConfig({prompt:"",imageToVideoList:[],isImageToVideoInitData:!0},"generateVideo")}}))},handleCreateSmartEditTask:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,c,d,v,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=(null==e||null===(o=e.data)||void 0===o?void 0:o.homeCreateInputParams)||{},c=l.requestParams,d=l.creativity,v=void 0===d?{}:d,m=oe(oe({},c),{},{source:80003}),n.next=4,t.updateCaptcha("cmfy_app");case 4:t.captchaToken&&(m.g_recaptcha_token=t.captchaToken),t.isLoggedIn||(m.g_mode=1),Object(G.f)(m,{customWhiteList:[2e4,20001,20002,20003,20004,20301]}).then((function(n){var o,l,c,d;if([2e4,20001,20002,20003,20004,20301].includes(null==n||null===(o=n.status)||void 0===o?void 0:o.code))return t.$xyLogEvent({front_operation:"click",entity_name:"homepage_creation",entity_type:"homepage_creation_guide_ai_smart_edit",event_name:"homepage_creation_guide_ai_smart_edit_onGenerate",obj_category:"imageEditing",event_desc:"点击创作",user_status:t.isLoggedIn?"activated":"guest"}),void t.$EventBus.$emit("openLoginDialog",{loginFrom:"imageEditing_task",callBack:function(){t.handleCreateSmartEditTask(e)}});var m,h=(null==n||null===(l=n.data)||void 0===l?void 0:l.id)||"",f=(null==n||null===(c=n.data)||void 0===c?void 0:c.scene)||"",code=null==n||null===(d=n.status)||void 0===d?void 0:d.code,_={70010:["showBreakDialog","VipTip","basic"],70039:["showVipComputingDialog","vipDialogComputedTit2",{fromVideo:"video_task_generate"===f}],80008:t.isVip?["showVipComputingDialog","",{fromVideo:"video_task_generate"===f}]:["showNotVipComputingDialog"]};if(code&&_[code])(m=t.$EventBus).$emit.apply(m,Object(r.a)(_[code]));else if(1e4===code&&t.$message.success(t.$t("CreateSuccess")),h){var y={id:h,process:0,components:[],expiration_time:0,deduction_detail:{},status_desc:"waiting",status:1,creativity:v,task_domain_type:2,create_at:Date.now(),speed_type:t.isVip?2:1};t.updateTask(y)}}));case 7:case"end":return n.stop()}}),n)})))()},handleTaskRefresh:function(e,t,n){var o=this,data=(null==e?void 0:e.data)||{};this.$nextTick((function(){if(data){o.updateTask(Object.assign(data,{status:1,status_desc:""}))}}))},handleAnimationGeneration:function(e){var t=JSON.parse(JSON.stringify((null==e?void 0:e.data)||{}));try{var n,o;t.art_model_no=(null==e||null===(n=e.data)||void 0===n?void 0:n.art_model_no)||"",t.art_model_ver_no=(null==e||null===(o=e.data)||void 0===o?void 0:o.art_model_ver_no)||"",t.art_work_no=""}catch(e){}this.getAnimeParamsAndOpenModal(t)},checkNeedGoogleCaptcha:function(){var e=this;if(""!==this.needGoogleCaptcha||this.isLoggedIn)return Promise.resolve();return Object(T.easyGetVisitorStatus)({scene:4}).then((function(t){var n,o;1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)&&(e.needGoogleCaptcha=null==t||null===(o=t.data)||void 0===o?void 0:o.state)}))},getMapMenuIndex:function(e){var t=[{code:1,value:"textToImage"},{code:7,value:"imageToImage"},{code:8,value:"conditionToImage"},{code:24,value:"animGen"}].find((function(t){return t.code===e}));return t?t.value:"textToImage"},checkCurrentTab:function(){var e,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(null==data?void 0:data.task_domain_type)||(null==data||null===(e=data.task)||void 0===e?void 0:e.task_domain_type),n=(null==data?void 0:data.base_model_name)||"",o="",l=Object(j.checkIsVideoModel)(n);return(this.tabs||[]).forEach((function(e){((null==e?void 0:e.taskDomainTypes)||[]).includes(t)&&(o=null==e?void 0:e.id)})),l&&(o="generateVideo"),o||"generateImage"},resetRemixParams:function(){var e=oe({},j.AI_VIDEO_GENERATE_PARAMS);return e.isUploadImage=!1,e.enable_hr=!1,e.hr_upscaler="",e.hr_scale=1.5,e.ad_model="",e.restore_faces=!1,e.ad_units={lora:{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""},e.embeddings=[],e.imageToImageList=[],e.lora_models=[],e.controlnet_units=[],e.negative_prompt="",e.ipList=[],e.styleReferenceList=[],e},handleImageModelParams:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=data.model,n=void 0===t?{}:t,o=data.config,l=void 0===o?{}:o;if(this.modelParams=oe(oe({},n),l),e){var r,c,d,v,m={width:null==l||null===(r=l.resolution_param)||void 0===r?void 0:r.dft_width,height:null==l||null===(c=l.resolution_param)||void 0===c?void 0:c.dft_height,n_iter:null==l||null===(d=l.gen_num_param)||void 0===d?void 0:d.dft_num};Object.keys(m).forEach((function(e){[null,void 0,""].includes(m[e])&&delete m[e]})),(null===(v=Object.keys(m))||void 0===v?void 0:v.length)&&this.updateConfig(m,this.currentTab)}},getPanelParams:function(e){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=t.length>1&&void 0!==t[1]&&t[1],o.abrupt("return",n.debouncedGetPanelParams(e,l));case 2:case"end":return o.stop()}}),o)})))()},_getPanelParams:function(e){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l,r,c,d,v,m,h,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(d=t.length>1&&void 0!==t[1]&&t[1],e.model_no&&(!n.isVideoModel||(null==n||null===(l=n.currentVideoModel)||void 0===l?void 0:l.base_model_name)!==(null==e?void 0:e.base_model_name))){o.next=3;break}return o.abrupt("return",Promise.resolve());case 3:if(!["generateImage"].includes(n.currentTab)||(null==n||null===(r=n.modelParams)||void 0===r?void 0:r.model_no)!==(null==e?void 0:e.model_no)||(null==n||null===(c=n.modelParams)||void 0===c?void 0:c.model_ver_no)!==(null==e?void 0:e.model_ver_no)){o.next=6;break}return n.isSetUpConfigData=d,o.abrupt("return",Promise.resolve());case 6:return n.videoModelParams=void 0,o.prev=7,n.isSetUpConfigData=d,o.next=11,Object(T.fetchModelParams)(e);case 11:return 1e4===(v=o.sent).status.code&&(f=(null===(m=v.data)||void 0===m?void 0:m.model_param)||{},n.currentVideoModel=e,"video"===f.model_type?Object(N.handleVideoModelParams)({model:e,config:(null==f?void 0:f.video_model_generation_param)||{}},d,n):n.handleImageModelParams({model:e,config:(null==v||null===(h=v.data)||void 0===h?void 0:h.model_param)||{}},d)),o.abrupt("return",Promise.resolve());case 16:return o.prev=16,o.t0=o.catch(7),n.videoModelParams=void 0,o.abrupt("return",Promise.resolve());case 20:case"end":return o.stop()}}),o,null,[[7,16]])})))()},handleRetryOrRemixOrPortalOrNote:function(e){var t=(null==e?void 0:e.data)||{},n=t.parent_task_id,o=t.task_id;(n||o)&&(this.isRetryOrRemixOrPortal=!0)},getConfig:function(e){var t=this,n=null,o={};if(null!=e&&e.isGuide||null!=e&&e.isRecipeRemix||null!=e&&e.NoteFill){var c,d=(null==e?void 0:e.tab)||"generateImage";n=I.getTaskConfig,o=e.data,this.clearConfig(null===(c=this.config)||void 0===c?void 0:c[d],!1,d),this.config[d].loading=!0}else{var v;n=null!=e&&e.parent_task_id?I.getMetaInfo:I.getTaskConfig;var m=this.getReferParams(e);if(0===Object.keys(m).length||6===e.action){var h,f=this.getCacheConfig(),y=!1;return null!=e&&e.id||!f||null===(h=f.generateImage)||void 0===h||!h.art_model_no||(y=!0),void this.setDefaultMeta(e,y)}this.config.generateImage.loading=!0,null!=e&&e.parent_task_id&&(m={id:null==e?void 0:e.parent_task_id}),null!=e&&e.scene&&(m.scene=null==e?void 0:e.scene);var C={art_model_ver_no:e.model_ver_no,img_url:e.cover,action:3,source:3};(o=e.hsaModelEdit?C:m).task_flow_version="v2",1!==(null==e?void 0:e.is_preset)&&1!==(null==e||null===(v=e.art_model)||void 0===v?void 0:v.is_preset)||!this.getEnableUsePresetConfig||(o.source=6)}this.isRemixScene=!0,n(o).then(function(){var n=Object(l.a)(regeneratorRuntime.mark((function n(o){var l,c,d,v,m,h,f,y,C,w,k,I,T,S,O,P,M,L,$,D,E,A,N,V,R,F,data,B,U,G,z,W,H,K,J,Q,Y,Z,ee,te,ie,ne,ae,se,le,re,ce,de,ue,pe,ve,me,he,fe,ge,_e,be,ye,Ce,we,ke,Ie,xe,Te,Se,Oe,Pe,Me,Le,$e,De,je,Ee,Ae,Ne,Ve,Re,Fe,Be,Ue,pattern,Ge,ze,We,He,qe,Ke,Je,Xe,Qe,Ye,Ze,et,tt,it,nt,ot,at,st,lt,ct,ut,pt,vt,mt,ht,ft,gt,_t,bt,yt,Ct,wt,kt,It;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if([1e4,"10000"].includes(null==o||null===(l=o.status)||void 0===l?void 0:l.code)){n.next=4;break}return t.$message.error(o.status.msg||t.$t("ServerError")),t.isRemixScene=!1,n.abrupt("return");case 4:if(data=oe(oe({},e),o.data),3===(null==e?void 0:e.action))try{data.meta.lab_base=[]}catch(e){}if(null==e||!e.parent_task_id||null!=data&&data.task||(data.task={},data.task.type=null==data?void 0:data.type),B=JSON.parse(JSON.stringify(data)),24!==(null==data||null===(c=data.task)||void 0===c?void 0:c.type)&&24!==(null==data?void 0:data.action)){n.next=13;break}U=JSON.parse(JSON.stringify(data));try{z=U.img_uris,W=void 0===z?[]:z,H=(null==U?void 0:U.meta)||{},K=H.init_images,J=null==U||null===(G=U.banner)||void 0===G?void 0:G.url,U.meta.init_images=null!=W&&W.length?K||[]:J?[J]:[]}catch(e){}return t.getAnimeParamsAndOpenModal(U),n.abrupt("return");case 13:if(3===(null==e?void 0:e.action)||![4,13].includes(null==data||null===(d=data.task)||void 0===d?void 0:d.type)){n.next=18;break}return Y=(null==data||null===(Q=data.meta)||void 0===Q?void 0:Q.hi_res_arg)||{},Z=Y.upscaling_resize,ee=void 0===Z?2:Z,te=Y.upscaler_1,ie=void 0===te?"4x-UltraSharp":te,ne=Y.image,ae={url:void 0===ne?"":ne,upscaler_1:ie,upscaling_resize:ee},t.getUpscaleParamsAndOpenModal(ae,"display"),n.abrupt("return");case 18:se=!1;try{se=(null==data||null===(le=data.meta)||void 0===le||null===(le=le.generate_video)||void 0===le?void 0:le.init_extend_video_url)||""}catch(e){}if((re=t.checkCurrentTab(data))&&t.switchTab(re),48!==(null==data||null===(v=data.task)||void 0===v?void 0:v.type)||12!==(null==data||null===(m=data.task)||void 0===m?void 0:m.task_domain_type)){n.next=25;break}return t.handleMultiImageGeneration({data:data}),n.abrupt("return");case 25:if(37!==(null==e?void 0:e.action)&&37!==(null==data||null===(h=data.task)||void 0===h?void 0:h.type)&&37!==(null==data?void 0:data.type)||!se){n.next=28;break}return t.getVideoExtensionAndOpenModal(data),n.abrupt("return");case 28:if(![17,23].includes(null==data?void 0:data.task_domain_type)){n.next=33;break}return ve=(null==data||null===(ce=data.meta)||void 0===ce||null===(ce=ce.generate_audio)||void 0===ce||null===(ce=ce.video_opts)||void 0===ce||null===(ce=ce[0])||void 0===ce?void 0:ce.uri)||"",me=ve?{id:null==data?void 0:data.id,isTask:!0,url:ve,coverUrl:null==data||null===(de=data.img_uris)||void 0===de||null===(de=de[0])||void 0===de?void 0:de.cover_url}:{},t.handleAudioNavigation({data:{videoInfo:me,prompt:(null==data?void 0:data.local_prompt)||"",negative_prompt:(null==data||null===(ue=data.meta)||void 0===ue?void 0:ue.negative_prompt)||"",duration:(null==data||null===(pe=data.meta)||void 0===pe||null===(pe=pe.generate_audio)||void 0===pe?void 0:pe.audio_duration)||5}}),n.abrupt("return");case 33:if(20!==(null==data?void 0:data.task_domain_type)){n.next=36;break}return t.handleAudioNavigation({data:{currentAudioTab:"videoAddLipSync",videoInfo:{url:null==data||null===(he=data.meta)||void 0===he||null===(he=he.generate_video)||void 0===he?void 0:he.video_url,id:null==data?void 0:data.id,isTask:!0,duration:0},prompt:(null==data?void 0:data.local_prompt)||""}}),n.abrupt("return");case 36:if(21!==(null==data?void 0:data.task_domain_type)){n.next=39;break}return t.handleAudioNavigation({data:{currentAudioTab:"aiVoice",prompt:(null==data?void 0:data.local_prompt)||"",lyrics:(null==data||null===(fe=data.meta)||void 0===fe||null===(fe=fe.generate_audio)||void 0===fe?void 0:fe.origin_lyrics)||""}}),n.abrupt("return");case 39:if(ge=t.getMapMenuIndex(null==data||null===(f=data.task)||void 0===f?void 0:f.type),null!=e&&e.parent_task_id&&(data.meta=Object.assign({},(null==e?void 0:e.meta)||{},(null==o||null===(_e=o.data)||void 0===_e?void 0:_e.meta)||{}),data.art_work_no=(null==data?void 0:data.artwork_no)||""),null!=e&&e.parent_task_id&&(data.channel=null==data?void 0:data.category),3===(null==e?void 0:e.action)){data.meta.init_images=(null==e?void 0:e.init_images)||[],data.meta.controlnet_units=[];try{Ce={image:null==e||null===(be=e.init_images)||void 0===be?void 0:be[0],mode:"ImagePrompt",stop_at:1,weight:.35},null!=data&&null!==(ye=data.meta)&&void 0!==ye&&null!==(ye=ye.lab_base)&&void 0!==ye&&null!==(ye=ye.conds)&&void 0!==ye&&ye.length?data.meta.lab_base.conds.push(Ce):data.meta.lab_base.conds=[Ce]}catch(e){}}return we=[t.checkIsStudioMode(null==data?void 0:data.category),t.checkIsStudioMode(null==data||null===(y=data.task)||void 0===y?void 0:y.category)].some((function(e){return e})),data&&we&&(data.channel="studio",data.category=7,t.creativeMode="studio",null==data||null===(ke=data.task)||void 0===ke||ke.type,t.checkIsStudioMode(null===(Ie=t.config[t.currentTab])||void 0===Ie?void 0:Ie.category)||t.resetStudioParams()),t.$EventBus.$emit("resetInputPackUpStatus"),n.next=48,t.handleMeta(data,"",re);case 48:if(xe=n.sent,Te=t.resetRemixParams(),(xe=Object.assign({},Te,xe)).raw_local_prompt=(null==B?void 0:B.local_prompt)||"",xe.raw_prompt=(null==B||null===(C=B.meta)||void 0===C?void 0:C.prompt)||"",xe&&null!==(w=xe)&&void 0!==w&&null!==(w=w.controlnet_units)&&void 0!==w&&w.length&&(xe.controlnet_units=((null===(Se=xe)||void 0===Se?void 0:Se.controlnet_units)||[]).map((function(e){return e.enable=!0,e}))),xe.logEventSource=(null==e?void 0:e.logEventSource)||0,xe=t.setImageSize(xe),(xe=t.handleInitConfig(xe)).base_model_type=(null==data?void 0:data.base_model_name)||"",Oe=[t.checkIsStudioMode(null==data?void 0:data.category),t.checkIsStudioMode(null==data?void 0:data.channel)].some((function(e){return e})),["textToImage","imageToImage","conditionToImage"].includes(ge)&&Oe)try{Ve=(t.lab_base_model||[]).filter((function(e){return(null==e?void 0:e.id)===t.fluxModelId})),Ve[0],Re=null===(Pe=t.getDefaultModel({}))||void 0===Pe?void 0:Pe.art_model,xe.art_model_no=xe.art_model_no||Re.id,xe.modelName=xe.modelName||Re.name,xe.art_work_no="",xe.model_cover=xe.model_cover||(null===(Me=Re)||void 0===Me?void 0:Me.cover),xe.is_agency_fee=xe.is_agency_fee||!1,xe.agency_fee=xe.agency_fee||0,xe.art_model_ver_no_name=(null===(Le=xe)||void 0===Le?void 0:Le.art_model_ver_no_name)||(null===($e=Re)||void 0===$e?void 0:$e.model_ver_name)||"",xe.art_model_ver_no=(null===(De=xe)||void 0===De?void 0:De.art_model_ver_no)||(null===(je=Re)||void 0===je?void 0:je.model_ver_no)||"",xe.base_model_type=(null===(Ee=xe)||void 0===Ee?void 0:Ee.base_model_type)||(null===(Ae=Re)||void 0===Ae?void 0:Ae.base_model)||"",xe.modelTags=null!==(Ne=xe)&&void 0!==Ne&&Ne.modelTags?xe.modelTags:t.getStudioModelTags(Re),xe=t.checkStudioParams(xe)}catch(e){}if("imageToImage"!==ge&&"animGen"!==ge){n.next=71;break}if(null!=B&&null!==(Fe=B.meta)&&void 0!==Fe&&Fe.mask&&(xe.mask=(null==B||null===(Ue=B.meta)||void 0===Ue?void 0:Ue.mask)||""),pattern=/^(http|https):\/\//,xe.keepDenoisingStrength=!1,3===xe.action&&(xe.copyMask="",xe.mask="",xe.tempMask="",xe.keepDenoisingStrength=!1),!pattern.test(xe.mask)){n.next=70;break}return xe.ad_model="",xe.keepDenoisingStrength=!0,n.next=70,Object(x.getImageBlob)(xe.mask,(function(e){xe.copyMask=xe.mask,xe.mask=e,xe.tempMask=e}));case 70:!pattern.test(xe.mask)&&null!=data&&null!==(Be=data.meta)&&void 0!==Be&&null!==(Be=Be.ad_units)&&void 0!==Be&&Be.length&&(ze=(null==data||null===(Ge=data.meta)||void 0===Ge?void 0:Ge.ad_units[0])||{},xe.ad_model=ze.ad_model||"",xe.ad_units=Object.assign({},{lora:{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""},ze||{}),delete xe.ad_units.ad_model);case 71:if(("imageToImage"===ge||["textToImage","conditionToImage"].includes(ge)&&3===(null===(k=xe)||void 0===k?void 0:k.action))&&((qe={}).url=(null===(We=xe)||void 0===We?void 0:We.init_images[0])||"",qe.denoising_strength=(null===(He=xe)||void 0===He?void 0:He.denoising_strength)||.35,qe.enable=!0,qe.mask=xe.mask||"",qe.tempMask=xe.tempMask||"",qe.copyMask=xe.copyMask||"",qe.compose_mask="",xe.imageToImageList=[qe]),Ke=(null===_.L||void 0===_.L?void 0:_.L.flux)||[],Je=(null===_.L||void 0===_.L?void 0:_.L.sd35)||[],!Ke.includes(null==data?void 0:data.base_model_name)&&!Je.includes(null==data?void 0:data.base_model_name)||null==data||null===(I=data.meta)||void 0===I||null===(I=I.lab_base)||void 0===I||null===(I=I.conds)||void 0===I||!I.length){n.next=96;break}if(it={},nt=((null==data||null===(Xe=data.meta)||void 0===Xe||null===(Xe=Xe.lab_base)||void 0===Xe?void 0:Xe.conds)||[]).find((function(e){return"ImagePrompt"===e.mode}))||null,xe.ipList=((null==data||null===(Qe=data.meta)||void 0===Qe||null===(Qe=Qe.lab_base)||void 0===Qe?void 0:Qe.conds)||[]).filter((function(e){return"IpMaintain"===e.mode})).map((function(e){return e.enable=!0,e})),xe.styleReferenceList=((null==data||null===(Ye=data.meta)||void 0===Ye||null===(Ye=Ye.lab_base)||void 0===Ye?void 0:Ye.conds)||[]).filter((function(e){return"StyleReference"===e.mode})).map((function(e){return e.enable=!0,e})),xe.lab_base.conds=((null===(Ze=xe)||void 0===Ze||null===(Ze=Ze.lab_base)||void 0===Ze?void 0:Ze.conds)||[]).filter((function(e){return"IpMaintain"!==e.mode&&"StyleReference"!==e.mode})),ot=/^(http|https):\/\//,xe.keepDenoisingStrength=!1,null!=B&&null!==(et=B.meta)&&void 0!==et&&et.mask&&(xe.mask=(null==B||null===(at=B.meta)||void 0===at?void 0:at.mask)||""),!ot.test(xe.mask)){n.next=88;break}return xe.ad_model="",xe.keepDenoisingStrength=!0,n.next=88,Object(x.getImageBlob)(xe.mask,(function(e){xe.copyMask=xe.mask,xe.mask=e,xe.tempMask=e}));case 88:it.denoising_strength=null==nt?void 0:nt.weight,it.enable=!0,it.mask=xe.mask||"",it.tempMask=xe.tempMask||"",it.copyMask=xe.copyMask||"",it.url=(null==nt?void 0:nt.image)||"",it.compose_mask=(null===(tt=xe)||void 0===tt?void 0:tt.compose_mask)||"",nt&&(xe.imageToImageList=[it]);case 96:["textToImage","imageToImage","animGen"].includes(ge)&&null!=data&&null!==(T=data.meta)&&void 0!==T&&null!==(T=T.ad_units)&&void 0!==T&&T.length&&(ut=(null===(st=data.meta)||void 0===st?void 0:st.ad_units[0])||{},pt=null==data||null===(lt=data.meta)||void 0===lt||null===(lt=lt.ad_units)||void 0===lt||null===(lt=lt[0])||void 0===lt||null===(lt=lt.lora_models)||void 0===lt?void 0:lt[0],vt=pt?oe(oe({},pt),{},{banner:{url:(null==pt||null===(ct=pt.art_model)||void 0===ct||null===(ct=ct.banner)||void 0===ct?void 0:ct.url)||""}}):{},xe.ad_model=ut.ad_model||"",xe.characterRepairZoom=!!xe.ad_model,xe.ad_units=Object.assign({},{lora:vt||{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""},ut||{}),delete xe.ad_units.ad_model),null!==(S=xe)&&void 0!==S&&S.hr_scale&&(xe.hr_scale=1.5),null!=data&&null!==(O=data.meta)&&void 0!==O&&null!==(O=O.ad_units)&&void 0!==O&&O.length||(xe.ad_model="",xe.characterRepairZoom=!!xe.ad_model,xe.ad_units={lora:{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""}),xe.steps<=0&&(xe.steps=[5,"5"].includes(xe.category)?30:20),xe.imgFiles=[],xe.tabIndex=t.creativeMode,xe.generate=(null==B||null===(P=B.meta)||void 0===P?void 0:P.generate)||(null===(M=t.config[re])||void 0===M?void 0:M.generate),"generateVideo"===re&&(xe=Object.assign(xe,t.initVideoParams(xe,B)||{}));try{xe.generate.gen_mode=t.config[re].generate.gen_mode||0,t.isLoggedIn||(xe.generate.gen_mode=0),xe.generate.prompt_magic_mode=[null,void 0,null].includes(null===(mt=t.config[re])||void 0===mt||null===(mt=mt.generate)||void 0===mt?void 0:mt.prompt_magic_mode)?2:null===(ht=t.config[re])||void 0===ht?void 0:ht.generate.prompt_magic_mode}catch(e){}if(ft=[].concat(Object(r.a)(null===_.L||void 0===_.L?void 0:_.L.flux),Object(r.a)(null===_.L||void 0===_.L?void 0:_.L.SeaDream)),ft.includes(null===(L=xe)||void 0===L?void 0:L.base_model_type)&&(xe.enableNegativePrompts=!1,xe.negative_prompt=""),null!==($=xe)&&void 0!==$&&$.base_model_type.includes("SD 3.5")&&(xe.steps=null===(gt=B.meta)||void 0===gt?void 0:gt.steps,xe.width=null===(_t=B.meta)||void 0===_t?void 0:_t.width,xe.height=null===(bt=B.meta)||void 0===bt?void 0:bt.height),xe.n_iter=t.config[re].n_iter,null!=t&&t.isVideoModel&&""===Object(j.checkVideoModelType)(null===(D=xe)||void 0===D?void 0:D.base_model_type)&&1===xe.n_iter&&(xe.n_iter=2),(null===(E=xe)||void 0===E?void 0:E.base_model_type)===t.config[re].base_model_type){n.next=116;break}return n.next=114,null==t?void 0:t.getModelDefaultConfig(null===(yt=xe)||void 0===yt?void 0:yt.base_model_type);case 114:Ct=n.sent,xe=Object.assign(Ct||{},xe);case 116:if((null!=e&&e.parent_task_id||null!=e&&e.task_id||4===(null==e?void 0:e.taskSource)||null!=e&&null!==(A=e.meta)&&void 0!==A&&null!==(A=A.generate_video)&&void 0!==A&&null!==(A=A.image_opts)&&void 0!==A&&A.length)&&(xe.isImageToVideoInitData=!0),null!==_.L&&void 0!==_.L&&null!==(N=_.L.HiDream)&&void 0!==N&&N.includes(null===(V=xe)||void 0===V?void 0:V.base_model_type)&&!t.checkHiDreamModelSize(xe.width,xe.height)&&(xe.width=832,xe.height=1248),null!==_.L&&void 0!==_.L&&null!==(R=_.L.SeaDream)&&void 0!==R&&R.includes(null===(F=xe)||void 0===F?void 0:F.base_model_type)&&!t.checkSeaDreamModelSize(xe.width,xe.height)&&(xe.width=982,xe.height=1472),"generateImage"!==re){n.next=122;break}return n.next=122,t._getPanelParams({base_model_name:null===(wt=xe)||void 0===wt?void 0:wt.base_model_type,model_no:null===(kt=xe)||void 0===kt?void 0:kt.art_model_no,model_ver_no:null===(It=xe)||void 0===It?void 0:It.art_model_ver_no});case 122:t.config[re]=Object.assign(t.config[re]||{},xe),null!=e&&e.isGuide&&(t.use_gen_guide_template_hash=Object(X.q)({art_model_no:xe.art_model_no,art_model_ver_no:xe.art_model_ver_no,width:xe.width,height:xe.height,prompt:xe.prompt})),t.config[re].loading=!1,t.$set(t.config,re,t.config[re]);case 126:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).finally((function(){var e;t.config[t.currentTab].loading=!1,null!==(e=t.config.generateImage)&&void 0!==e&&e.isCustomSizeChange&&(t.config.generateImage.isCustomSizeChange=!1),Object.keys(t.config).forEach((function(e){t.$set(t.config,e,Object.assign({},t.config[e],{loading:!1}))}))}))},checkModelSize:function(e,t,n){return H.IMAGE_SIZE_OPTIONS_MORE.filter((function(t){return Object.keys(t).includes(e)&&5!==t.code})).some((function(o){var l,r;return(null===(l=o[e])||void 0===l||null===(l=l.standard)||void 0===l?void 0:l.width)===t&&(null===(r=o[e])||void 0===r||null===(r=r.standard)||void 0===r?void 0:r.height)===n}))},checkHiDreamModelSize:function(e,t){return this.checkModelSize("HiDream",e,t)},checkSeaDreamModelSize:function(e,t){return this.checkModelSize("SeaDream",e,t)},getVideoExtensionAndOpenModal:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var e,t,n=(null==data||null===(e=data.meta)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.init_extend_video_cover_url)||"";this.$EventBus.$emit("openEasyVideoExtension",{url:n,prompt:(null==data||null===(t=data.meta)||void 0===t?void 0:t.prompt)||"",info:data,isTask:!1})}catch(e){}},setImageSize:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(k.cloneDeep)(source);return null!=e&&e.width&&null!=e&&e.height||(e.width=688,e.height=1024),e},getAnimeParamsAndOpenModal:function(data){var e,t,n,o,l=(null==data||null===(e=data.meta)||void 0===e?void 0:e.animatediff)||{},r=Array.isArray(null==data||null===(t=data.meta)||void 0===t?void 0:t.init_images)&&null!=data&&null!==(n=data.meta)&&void 0!==n&&null!==(n=n.init_images)&&void 0!==n&&n.length?null==data||null===(o=data.meta)||void 0===o?void 0:o.init_images[0]:"",c={art_model_no:null==data?void 0:data.art_model_no,art_model_ver_no:null==data?void 0:data.art_model_ver_no,art_work_no:null==data?void 0:data.art_work_no,action:24,category:1,meta:(null==data?void 0:data.meta)||{}};this.$EventBus.$emit("openEasyAnimeToolsModal",{animatediff:l,url:r,requestParams:c})},getUpscaleParamsAndOpenModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.data,o=((void 0===n?{}:n)||{}).imageUrl,l={url:void 0===o?"":o};t&&(l=e),this.$EventBus.$emit("openEasyUpscaleToolsModal",l)},getStudioDefaultStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getCurrentModelType(e),o={width:832,height:1216,min:768,max:1536};return"SD"===n&&(o={width:624,height:936,min:512,max:1024}),(t||["FLUX"].includes(n))&&(o={width:688,height:1024,min:384,max:1024}),"HiDream"===n&&(o={width:832,height:1248,min:768,max:1360}),"SeaDream"===n&&(o={width:982,height:1472,min:512,max:1472}),o},getCurrentModelType:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony","SDXL Hyper"].concat(Object(r.a)(_.L.sdxl)),l=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"].concat(Object(r.a)(_.L.other)),c=null===_.L||void 0===_.L?void 0:_.L.sd35,d=null===_.L||void 0===_.L?void 0:_.L.flux,v=o.includes(n)||(n||"").includes("SDXL"),m=l.includes(n),h=["SD 3"].includes(n),f=d.includes(n),y=c.includes(n)||(n||"").includes("SD 3.5");return v?"SDXL":m||h?"SD":f?"FLUX":y?"SD 3.5":null!==_.L&&void 0!==_.L&&null!==(e=_.L.HiDream)&&void 0!==e&&e.includes(n)?"HiDream":null!==_.L&&void 0!==_.L&&null!==(t=_.L.SeaDream)&&void 0!==t&&t.includes(n)?"SeaDream":Object(j.checkVideoModelType)(n)},preProcessParams:function(e){this.use_gen_guide_template_id&&(e.use_gen_guide_template_id=this.use_gen_guide_template_id,e.use_origin_gen_guide_template_meta=!0,Object(X.q)({art_model_no:e.model_no,art_model_ver_no:e.model_ver_no,width:e.meta.width,height:e.meta.height,prompt:e.meta.prompt})!==this.use_gen_guide_template_hash&&(e.use_origin_gen_guide_template_meta=!1));return e},handleGenerate:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,m,h,f,y,C,w,k,I,x,S,O,P,M,L,$,D,j,E,A,N,V,R;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.$refs)&&void 0!==n&&null!==(n=n.modelRecipe)&&void 0!==n&&n.visible&&(null===(h=e.$refs)||void 0===h||null===(h=h.modelRecipe)||void 0===h||h.closeModal(!1)),null!==(o=e.$refs)&&void 0!==o&&null!==(o=o.videoInspirationLibrary)&&void 0!==o&&o.visible&&(null===(f=e.$refs)||void 0===f||null===(f=f.videoInspirationLibrary)||void 0===f||f.closeModal(!1)),y=e.currentTab,e.visitorLogEvent(),!(C=e.config[y]).generateing){t.next=7;break}return t.abrupt("return");case 7:if(!((null===_.L||void 0===_.L?void 0:_.L.sd3)||[]).includes(null==C?void 0:C.base_model_type)){t.next=10;break}return e.$message.warning(e.$t("newGenerate52")),t.abrupt("return");case 10:if(!e.vipLimit(C)){t.next=12;break}return t.abrupt("return");case 12:if(!e.validParams(C)){t.next=15;break}return C.generateing=!1,t.abrupt("return");case 15:if("generateVideo"!==e.currentTab||"effect"!==(null===(l=e.currentConfigInfo)||void 0===l?void 0:l.currentVideoTab)||!e.checkIsNotValidEffectParams()){t.next=18;break}return C.generateing=!1,t.abrupt("return");case 18:return C.generateing=!0,t.next=21,e.getParams();case 21:if(w=t.sent,k=e.isVideoModel,I=e.getGenerateType(),x=e.getParamsByType(w,I,C),k&&(x=e.extractVideoParams(w),O=(null===(S=x)||void 0===S||null===(S=S.meta)||void 0===S||null===(S=S.generate_video)||void 0===S?void 0:S.image_opts)||[],I=null!=O&&O.length?"imageToVideo":"textToVideo"),!k||"imageToVideo"!==I||null!==(r=x)&&void 0!==r&&null!==(r=r.meta)&&void 0!==r&&null!==(r=r.generate_video)&&void 0!==r&&null!==(r=r.image_opts)&&void 0!==r&&r.length){t.next=29;break}return e.$message.warning(e.$t("pleaseSelectImage")),t.abrupt("return");case 29:if(!e.checkVideoEffectImageParams(k,I,x)){t.next=33;break}return e.$message.warning(e.$t("pleaseSelectImage")),C.generateing=!1,t.abrupt("return");case 33:if("on"===(P=e.isIgnoreUnAvailableLora||"on")||e.checkModelTypeCompatibility(C,(null===(c=w)||void 0===c||null===(c=c.meta)||void 0===c?void 0:c.lora_models)||[])||k){t.next=38;break}return C.generateing=!1,e.$message.warning(e.$t("studio25")),t.abrupt("return");case 38:if("on"===P||e.checkModelTypeCompatibility(C,(null===(d=w)||void 0===d||null===(d=d.meta)||void 0===d?void 0:d.embeddings)||[])||k){t.next=42;break}return C.generateing=!1,e.$message.warning(e.$t("newGenerate63")),t.abrupt("return");case 42:if(k||(x.meta.generate=e.config[e.currentTab].generate),"generateVideo"!==e.currentTab||"multiImage"!==(null===(v=e.currentConfigInfo)||void 0===v?void 0:v.currentVideoTab)){t.next=50;break}if(x=e.getMultiImg2videoParams(),w=x,I="multiImg2video",x){t.next=50;break}return C.generateing=!1,t.abrupt("return");case 50:M=T.easyTextToImage,t.t0=I,t.next="textToImage"===t.t0?54:"imageToImage"===t.t0?57:"conditionToImage"===t.t0?59:"imageToVideo"===t.t0?61:"textToVideo"===t.t0?64:"multiImg2video"===t.t0?66:68;break;case 54:return M=T.easyTextToImage,x=e.preProcessParams(x),t.abrupt("break",70);case 57:return M=T.easyImageToImage,t.abrupt("break",70);case 59:return M=T.easyControlNetToImage,t.abrupt("break",70);case 61:return M=T.easyImageToVideo,e.isLoggedIn||($=JSON.parse(localStorage.getItem("videoTemplate")),D=e.config.generateVideo,$&&5===(null===(L=D.generate_video)||void 0===L?void 0:L.generate_video_duration)&&(j=$.prompt===D.prompt,E=JSON.stringify($.imageToVideoList)===JSON.stringify(D.imageToVideoList),A=$.art_model_ver_no===D.art_model_ver_no,N=$.art_model_no===D.art_model_no,j&&E&&A&&N&&(x.use_gen_guide_template_id=$.creator_temp_id,x.use_origin_gen_guide_template_meta=!0))),t.abrupt("break",70);case 64:return M=T.easyTextToVideo,t.abrupt("break",70);case 66:return M=T.easyMultiImg2video,t.abrupt("break",70);case 68:return M=T.easyTextToImage,t.abrupt("break",70);case 70:if(e.isLoggedIn||!["textToImage"].includes(I)){t.next=78;break}return x.g_mode=1,t.next=74,e.checkNeedGoogleCaptcha();case 74:if(1!==e.needGoogleCaptcha){t.next=78;break}return t.next=77,e.updateCaptcha("ttc_v2");case 77:x.g_recaptcha_token=e.captchaToken||"";case 78:if(["textToImage","conditionToImage","imageToImage"].includes(I)&&null!==(m=e.config)&&void 0!==m&&null!==(m=m.generateImage)&&void 0!==m&&m.isTranslate)try{x.meta.artwork_remix_local_prompt=(null===(V=e.config)||void 0===V||null===(V=V.generateImage)||void 0===V?void 0:V.raw_local_prompt)||"",x.meta.original_translated_meta_prompt=(null===(R=e.config)||void 0===R||null===(R=R.generateImage)||void 0===R?void 0:R.raw_prompt)||""}catch(e){}M(x).then((function(t){var n,o,l;e.use_gen_guide_template_id="",e.use_gen_guide_template_hash="";t.data;if(t&&1e4!==(null==t||null===(n=t.status)||void 0===n?void 0:n.code))e.config[y].generateing=!1;else{e.clearConfig(JSON.parse(JSON.stringify(C)),null===(o=e.config)||void 0===o||null===(o=o[y])||void 0===o?void 0:o.isLockParams,y),e.$message.success(e.$t("CreateSuccess"));var r=Object.assign({},w,(null==t?void 0:t.data)||{});r.banner=null,r.img_uris=[],r.status=1,["imageToVideo","textToVideo"].includes(I)&&(r.task_domain_type="textToVideo"===I?11:12),["imageToVideo"].includes(I)&&null!==(l=x)&&void 0!==l&&l.template_id&&(r.task_domain_type=15),e.updateTask(r),e.config[e.currentTab].generateing=!1,e.shouldRefreshList(!0),e.isShowCreationGuidance=!1,e.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),localStorage.getItem("videoTemplate")&&localStorage.removeItem("videoTemplate")}})).catch((function(t){e.config[e.currentTab].generateing=!1})).finally((function(){e.isImageToImageToTextToImage=!1,e.config[e.currentTab].generateing=!1}));case 80:case"end":return t.stop()}}),t)})))()},shouldRefreshList:function(){this.hasListSelectOptions&&this.resetListParams(!0)},visitorLogEvent:function(){this.isLoggedIn||this.$logEvent("log_actions",{operation:"click_generate",behavior_info:"on_new_create_flow_page",behavior_info_sub:"guest_visit"})},checkModelTypeCompatibility:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(!t||0===t.length))return!0;var n=(e||{}).base_model_type,o=void 0===n?"":n,l=Object(H.getAdditionalModels)(o);return(t||[]).every((function(e){return l.includes(null==e?void 0:e.base_model)}))},checkVideoEffectImageParams:function(e,t,n){var o;return e&&"imageToVideo"===t&&(null==n?void 0:n.template_id)&&!((null==n||null===(o=n.meta)||void 0===o||null===(o=o.generate_video)||void 0===o?void 0:o.image_opts)||[]).every((function(e){return null==e?void 0:e.url}))},validParams:function(e){var t=e.prompt;e.art_work_no,e.art_model_no;return this.isOnlySupportImageToVideo?(this.$message.warning(this.$t("newGenerate111")),!0):!t&&!this.notNeedCheckPrompt&&this.$message.warning(this.$t("PromptNotEmpty"))},handleImageExtraUpscale:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign(t,{task_flow_version:"v2"});return Object(I.createTask)(n).then((function(t){var n,o={banner:null,img_uris:[],status:1};return(null===(n=o=Object.assign(o,(null==t?void 0:t.data)||{}))||void 0===n?void 0:n.id)&&e.updateTask(o),t})).catch((function(e){}))},handleAnimeGenerate:function(e){var t=this,n=Object.assign(e,{task_flow_version:"v2"});return Object(I.createTask)(n).then((function(e){var n,o={banner:null,img_uris:[],status:1};return(null===(n=o=Object.assign(o,(null==e?void 0:e.data)||{}))||void 0===n?void 0:n.id)&&t.updateTask(o),e})).catch((function(e){}))},handleGenerateByPrompt:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!["",null,void 0].includes(t)){var n=this.lab_base_model.find((function(t){return(null==t?void 0:t.id)===e.fluxModelId}))||{},o={model_no:null==n?void 0:n.id,model_ver_no:null==n?void 0:n.model_ver_no};null!=o&&o.model_no&&(o.meta={cfg_scale:6,width:688,height:1024,n_iter:2,prompt:t,seed:Object(x.getRandomSeed)(!0),steps:30,sampler_name:"Euler",negative_prompt:"",lab_base:{conds:[]}},Object(T.easyTextToImage)(o).then((function(t){var n;t.data;if(!t||1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){e.$message.success(e.$t("CreateSuccess"));var l=Object.assign({},o,(null==t?void 0:t.data)||{});l.banner=null,l.img_uris=[],l.status=1,e.updateTask(l)}})).catch((function(e){})))}},getParamsByType:function(){var e,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=/^blob:/,l={model_no:null==source?void 0:source.art_model_no,model_ver_no:null==source?void 0:source.art_model_ver_no,channel_id:"",speed_type:this.config[this.currentTab].speed_type},c=null==this||null===(e=this.config[this.currentTab])||void 0===e||null===(e=e.controlnet_units)||void 0===e?void 0:e.length;if((this.isCommunityFlux&&!c||this.isSd35Model)&&"textToImage"===t){var d,v,m,h;if(l.meta={cfg_scale:source.meta.cfg_scale,width:source.meta.width,height:source.meta.height,n_iter:source.meta.n_iter,prompt:source.meta.prompt,seed:source.meta.seed,steps:source.meta.steps,sampler_name:"DPM++ 2M Karras",negative_prompt:"",lab_base:{conds:[]}},this.isCommunityFlux)l.meta.sampler_name=(null==source||null===(h=source.meta)||void 0===h?void 0:h.sampler_name)||"Euler";if(null!==(d=this.config[this.currentTab].imageToImageList)&&void 0!==d&&d.length){var f,_=this.config[this.currentTab].imageToImageList[0],y={image:null==_?void 0:_.url,stop_at:1,weight:null==_?void 0:_.denoising_strength,mode:"ImagePrompt",loading:!1};l.meta.lab_base={conds:[y]};var C=this.isCommunityFlux&&(null===(f=this.config[this.currentTab])||void 0===f||null===(f=f.ipList)||void 0===f?void 0:f.length);if(null!=_&&_.mask&&!C){["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res_padding"].forEach((function(e){l.meta[e]=source.meta[e]}))}}if((this.isCommunityFlux||this.isSd35Model)&&(l.meta.lora_models=source.meta.lora_models||[]),this.isCommunityFlux&&null!==(v=this.config[this.currentTab])&&void 0!==v&&null!==(v=v.ipList)&&void 0!==v&&v.length){var w,k,I,x,T=((null===(w=this.config[this.currentTab])||void 0===w?void 0:w.ipList)||[]).filter((function(e){return"IpMaintain"===e.mode&&e.image&&!o.test(e.image)&&(null==e?void 0:e.enable)})).map((function(e){return{image:null==e?void 0:e.image,mode:null==e?void 0:e.mode,stop_at:null==e?void 0:e.stop_at,weight:null==e?void 0:e.weight}}));if(null!==(k=l)&&void 0!==k&&null!==(k=k.meta)&&void 0!==k&&null!==(k=k.lora_models)&&void 0!==k&&k.length&&(T=(T||[]).filter((function(e){return"IpMaintain"!==e.mode})).map((function(e){return{image:null==e?void 0:e.image,mode:null==e?void 0:e.mode,stop_at:null==e?void 0:e.stop_at,weight:null==e?void 0:e.weight}}))),null!==(I=T)&&void 0!==I&&I.length)(x=l.meta.lab_base.conds).push.apply(x,Object(r.a)(T))}if(null!==(m=this.config[this.currentTab].styleReferenceList)&&void 0!==m&&m.length&&this.isCommunityFlux){var S,O,P,M,L=((null===(S=this.config[this.currentTab])||void 0===S?void 0:S.styleReferenceList)||[]).filter((function(e){return"StyleReference"===e.mode&&e.image&&!o.test(e.image)})).map((function(e){return{image:null==e?void 0:e.image,mode:null==e?void 0:e.mode,weight:null==e?void 0:e.weight}}));if(!(this.hasIpMaintain||null!==(O=this.config[this.currentTab].controlnet_units)&&void 0!==O&&O.length||null!==(P=this.config[this.currentTab].imageToImageList)&&void 0!==P&&P.length))(M=l.meta.lab_base.conds).push.apply(M,Object(r.a)(L))}}if(!this.isCommunityFlux&&"textToImage"===t&&!this.isImageToImageToTextToImage){var $,D,j={meta:{}},E=["prompt","negative_prompt","width","height","steps","cfg_scale","sampler_name","n_iter","lora_models","vae","clip_skip","seed","restore_faces","ad_units","embeddings"];if(""!==(null===($=this.config[this.currentTab])||void 0===$?void 0:$.hr_upscaler))j.meta.hr_upscaler=null===(D=this.config[this.currentTab])||void 0===D?void 0:D.hr_upscaler,j.meta.hr_second_pass_steps=20,j.meta.denoising_strength=.5;if(this.isAnimeEnhanceEnable){var A=["vae","clip_skip","ad_units","embeddings"];E=E.filter((function(e){return!A.includes(e)}))}E.forEach((function(e){j.meta[e]=source.meta[e]})),this.isAnimeEnhanceEnable&&(j.meta.sampler_name="DPM++ 2M Karras",j.meta.lab_base={scheduler:"karras"}),j.speed_type=l.speed_type,l=Object.assign(l,j)}if("imageToImage"===t&&(l=Object.assign(l,this.getImageToImagePostParams(source))),"conditionToImage"===t&&(l=Object.assign(l,this.getControlNetPostParams(source))),"on"===(this.isIgnoreUnAvailableLora||"on")){var N,V,R=Object(H.getAdditionalModels)((null==n?void 0:n.base_model_type)||"");l.meta.lora_models=((null===(N=l)||void 0===N||null===(N=N.meta)||void 0===N?void 0:N.lora_models)||[]).filter((function(e){return R.some((function(t){return t===(null==e?void 0:e.base_model)}))})),l.meta.embeddings=((null===(V=l)||void 0===V||null===(V=V.meta)||void 0===V?void 0:V.embeddings)||[]).filter((function(e){return R.some((function(t){return t===(null==e?void 0:e.base_model)}))}))}return l},getImageToImagePostParams:function(source){var e,t,n,o={},l=["prompt","negative_prompt","width","height","steps","cfg_scale","sampler_name","n_iter","lora_models","vae","clip_skip","seed","controlnet_units","init_images","denoising_strength","embeddings","ad_units"];("SD"!==this.currentModelType&&(l=l.filter((function(e){return!["ad_units"].includes(e)}))),null!=source&&null!==(e=source.meta)&&void 0!==e&&null!==(e=e.controlnet_units)&&void 0!==e&&e.length||null==source||null===(t=source.meta)||void 0===t||!t.mask)||(n=l).push.apply(n,["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res_padding"]);return o.meta={},l.forEach((function(e){o.meta[e]=source.meta[e]})),o.speed_type=source.speed_type,o},getControlNetPostParams:function(source){var e={};return e.meta={},["prompt","negative_prompt","width","height","steps","cfg_scale","sampler_name","n_iter","lora_models","vae","clip_skip","seed","controlnet_units","embeddings"].forEach((function(t){e.meta[t]=source.meta[t]})),e.speed_type=source.speed_type,e},getGenerateType:function(){var e=JSON.parse(JSON.stringify(this.config[this.currentTab])),t=(e.imageToImageList||[]).filter((function(e){return null==e?void 0:e.enable})),n=(e.controlnet_units||[]).filter((function(e){return null==e?void 0:e.enable}));return this.isHiDreamModel||this.isSeaArtFilmModel?"textToImage":this.isCommunityFlux&&(null==n||!n.length)||!(null!=t&&t.length||null!=n&&n.length)||this.isAnimeEnhanceEnable||this.isSd35Model?(this.isImageToImageToTextToImage=this.isSd35Model,"textToImage"):null!=t&&t.length?"imageToImage":null!=n&&n.length?"conditionToImage":"textToImage"},clearConfig:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentTab;try{var o,l;if(null!==(o=e)&&void 0!==o&&o.parent_task_id&&delete e.parent_task_id,t)(e=oe(oe({},e),{},{imageUrl:[""],roop_arg:{face_restorer_visibility:.6,image:""},logEventSource:0})).lab_base.conds=[],e.specialEffectsImageList=[{url:"",order:1},{url:"",order:2}];else e=oe(oe({},e),{},{imageUrl:[""],mask:"",copyMask:"",tempMask:"",keepDenoisingStrength:!1,prompt:"",local_prompt:"",raw_local_prompt:"",raw_prompt:"",roop_arg:{face_restorer_visibility:.6,image:""},controlnet_units:[],logEventSource:0,imageToImageList:[],ipList:[],styleReferenceList:[]}),Object.assign((null===(l=e)||void 0===l?void 0:l.lab_base)||{},{conds:[]}),e.imageToVideoList=[],e.multiImg2videoInfo=Object(k.cloneDeep)(j.MULTI_IMG_TO_VIDEO_DEFAULT_PARAMS),e.specialEffectsImageList=[{url:"",order:1},{url:"",order:2}];this.config[n]=e}catch(e){}},getParams:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y,C,w,k,meta;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]&&e[0],l=t.config[t.currentTab],r={},c=l.art_work_no,d=l.art_model_no,v=l.parent_task_id,m=l.art_model_ver_no,h=l.action,f=l.operate_number,_=l.category,y=l.speed_type,C=l.animatediff,w=l.logEventSource,k=void 0===w?0:w,meta=t.getCommonMeta(l),n.next=7,t.getPrivateMeta(l,meta,o);case 7:return meta=n.sent,r={action:"conditionToImage"===t.menuIndex?10:h,art_work_no:c,art_model_no:d,art_model_ver_no:m,parent_task_id:v,operate_number:f,channel_id:"PRIVATE"!==t.channelId&&t.channelId,category:_,speed_type:y,meta:meta},k&&(r.source=k),"animGen"===t.menuIndex&&(r.meta.animatediff=C),"textToImage"!==t.menuIndex&&([3,"3","midjourney","sdxl",5,"5"].includes(l.channel)||[3,"3","midjourney","sdxl",5,"5"].includes(meta.channel))&&(([3,"3","midjourney"].includes(l.channel)||[3,"3","midjourney"].includes(meta.channel))&&(r.category=3),(["sdxl",5,"5"].includes(l.channel)||["sdxl",5,"5"].includes(meta.channel))&&(r.category=5),[3,"3","midjourney","sdxl",5,"5"].includes(meta.channel)&&delete r.meta.channel),8===l.action&&"descriptors"===t.menuIndex&&(Reflect.deleteProperty(r,"art_work_no"),Reflect.deleteProperty(r,"art_model_no"),Reflect.deleteProperty(r,"art_model_ver_no")),Object.keys(r).forEach((function(e){r[e]||Reflect.deleteProperty(r,e)})),n.abrupt("return",r);case 15:case"end":return n.stop()}}),n)})))()},getCommonMeta:function(e){var t,meta={},n=["prompt","negative_prompt","restore_faces","seed","sampler_name","width","height","steps","cfg_scale","lora_models","vae","clip_skip","hr_second_pass_steps","lcm_mode"];return["development"].includes("production")&&n.push("roop_arg"),n.push("n_iter"),["extraUpscale","descriptors"].includes(this.menuIndex)||(n.forEach((function(t){meta[t]=e[t]})),["",null,void 0,0,"0"].includes(meta.seed)&&(meta.seed=-1),["-1",-1].includes(meta.seed)&&(meta.seed=Object(x.getRandomSeed)(this.isCommunityFlux||this.isTongYiFast||this.isTongYiProfessional||this.isPixVerse)),["",null,void 0].includes(null==meta||null===(t=meta.roop_arg)||void 0===t?void 0:t.image)&&delete meta.roop_arg,["textToImage","imageToImage","animGen","conditionToImage"].includes(this.menuIndex)&&![5,"5"].includes(e.category)||delete meta.roop_arg,!["",null,void 0].includes(e.hr_upscaler)&&"textToImage"===this.menuIndex&&[1,"1"].includes(e.category)&&(e.enable_hr?(meta.enable_hr=!0,meta.hr_upscaler=e.hr_upscaler||"R-ESRGAN 4x+",meta.hr_scale=1.5):meta.enable_hr=!1),meta.width=(null==meta?void 0:meta.width)<=0?1024:meta.width,meta.height=(null==meta?void 0:meta.height)<=0?1024:meta.height,this.isSeaArtFilmModel?(meta.lora_models=[],meta.negative_prompt=""):meta.lora_models=((null==e?void 0:e.lora_models)||[]).map((function(e){var t=e.model_id,n=e.weight,o=e.model_ver_no,l=e.base_model;return{model_id:t,weight:n,model_ver_no:o||"",base_model:void 0===l?"":l}}))),meta},uploadMaskImage:function(mask){var e=mask.includes("data:image/png;base64")?mask:"data:image/png;base64,".concat(mask),t=Object(x.dataURItoBlob)(e);return this.UPLOAD.startUpload(t,{name:"img2img-mask".concat(Date.now(),".png"),type:"png",isRedirection:!0,category:46})},getPrivateMeta:function(e,meta){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l,r,c,d,v,m,h,f,_,y,C,w,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=t.length>2&&void 0!==t[2]&&t[2],r=n.menuIndex,c=e.denoising_strength,d=e.imageUrl,v=e.controlnet_units,m=e.scaling_ratio,h=e.up_scaler,f=e.controlnet_processor_res,_=e.left_margin,y=e.up_margin,C=e.embeddings,w=e.meta,I=e.imageToImageList,meta.embeddings=(C||[]).map((function(e){return{model_id:null==e?void 0:e.id,model_ver_id:null==e?void 0:e.model_ver_no,weight:(null==e?void 0:e.weight)||1}})),null==I||!I.length){o.next=18;break}if(x=I[0],meta.denoising_strength=null==x?void 0:x.denoising_strength,meta.init_images=[x.url],!v.length&&!l){o.next=12;break}o.t0={},o.next=15;break;case 12:return o.next=14,n.getCanvasParams(e);case 14:o.t0=o.sent;case 15:T=o.t0,v.length&&(meta.controlnet_units=n.getControlnet_units(v)),meta=Object.assign({},meta,T);case 18:if(null!=I&&I.length||null==v||!v.length||(meta.controlnet_units=n.getControlnet_units(v)),!["imageToImage","animGen","characterRepair"].includes(r)){o.next=35;break}if(meta.denoising_strength=c,meta.init_images=d.slice(3),v.length&&(meta.controlnet_units=n.getControlnet_units(v,d)),S=e.imageToImageList[0]||{},O={},null==S||!S.enable){o.next=34;break}if(!v.length&&!l){o.next=30;break}o.t1={},o.next=33;break;case 30:return o.next=32,n.getCanvasParams(e);case 32:o.t1=o.sent;case 33:O=o.t1;case 34:meta=Object.assign({},meta,O);case 35:return["imageToImage","textToImage","animGen","characterRepair"].includes(r)&&(""!==e.ad_model&&($=(null==e||null===(P=e.ad_units)||void 0===P?void 0:P.lora)||{},D=$.id,j=$.model_ver_no,E=$.weights,A={model_id:D,model_ver_no:j,weight:E},(null==(N=Object(k.cloneDeep)(e.ad_units))?void 0:N.lora)&&delete N.lora,meta.ad_units=[Object.assign({ad_model:e.ad_model,lora_models:null!==(M=Object.keys((null==e||null===(L=e.ad_units)||void 0===L?void 0:L.lora)||{}))&&void 0!==M&&M.length?[A]:[]},N)]),3===e.action&&(e.enable_hr?(meta.enable_hr=!0,meta.hr_upscaler=e.hr_upscaler||"R-ESRGAN 4x+",meta.hr_scale=1.5):meta.enable_hr=!1)),"extraUpscale"===r&&(meta.hi_res_arg={upscaling_resize:m,upscaler_1:h,image:d[0]},meta.width=e.realWidth||e.width,meta.height=e.realHeight||e.height,meta=oe(oe({},w),meta)),"conditionToImage"===r&&(meta.controlnet_units=n.getControlnet_units(v)),"descriptors"===r&&(meta={img_2_text:{uri:e.imageUrl[0]}}),"preview"===r&&(meta={controlnet_input_images:d,controlnet_module:null===(V=v[0])||void 0===V?void 0:V.module,controlnet_processor_res:f}),"expansion"===r&&(meta=oe(oe({},meta),{},{left_margin:_,up_margin:y,image:d[0]})),o.abrupt("return",meta);case 42:case"end":return o.stop()}}),o)})))()},getControlnet_units:function(e){var t=this;return(e||[]).filter((function(e){return null==e?void 0:e.enable})).map((function(e,n){var o=e.type,l=e.processor_res,r=e.threshold_a,c=e.control_mode,d=e.model,v=e.module,m=e.weight,h=e.isHandle,f=e.input_image,_=r,y=(t.taskControlNetModules||[]).find((function(e){return(null==e?void 0:e.type)===o}));return[0,"0"].includes(c)&&y&&null!=y&&y.has_style_fidelity||(_=null),{processor_res:h?l:0,input_image:f,threshold_a:_,model:d,module:h?v:"none",control_mode:Number(c),weight:m,guidance:1,guidance_end:1,type:o}}))},updateTask:function(data){this.$refs.taskView.updateMessageList(data),this.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}})},updateVideoExtensionTask:function(){var e=oe(oe({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{status:1,task_domain_type:te.a.TaskDomainTypeExtendVideo});this.$refs.taskView.updateMessageList(e)},updateVideoFrameInterpolationTask:function(){var e=oe(oe({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{status:1,task_domain_type:te.a.TaskDomainTypeVideoFrameInterpolation});this.$refs.taskView.updateMessageList(e),this.$refs.taskView.scrollToTop(0)},updateVideoUpscaleTask:function(){var e=oe(oe({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{status:1,task_domain_type:te.a.TaskDomainTypeUpscaleVideo});this.$refs.taskView.updateMessageList(e)},getCanvasParams:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,mask,v,m,h,pattern,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(d=(c=e.length>0&&void 0!==e[0]?e[0]:{}).imageToImageList[0]||{},mask=(null==d?void 0:d.mask)||"",v=(null==d?void 0:d.tempMask)||"",m=(null==d?void 0:d.compose_mask)||"",h={mask:mask,mask_blur:4,inpainting_fill:1,inpainting_mask_invert:0,inpaint_full_res_padding:32,compose_mask:m},pattern=/^(http|https):\/\//,["",null,void 0].includes(v)||["",null,void 0].includes(mask)||v!==mask){n.next=11;break}return h.mask=d.copyMask,(t.config[t.currentTab].imageToImageList||[]).forEach((function(e){t.$set(e,"mask",d.copyMask)})),n.abrupt("return",h);case 11:if(["",null,void 0].includes(null===(o=c.imageToImageList[0])||void 0===o?void 0:o.mask)||"data:,"===(null===(l=c.imageToImageList[0])||void 0===l?void 0:l.mask)||pattern.test(null===(r=c.imageToImageList[0])||void 0===r?void 0:r.mask)){n.next=14;break}return n.next=14,t.uploadMaskImage(null===(f=c.imageToImageList[0])||void 0===f?void 0:f.mask).then((function(e){(t.config[t.currentTab].imageToImageList||[]).forEach((function(n){t.$set(n,"mask",e)})),h.mask=e}));case 14:return c.generateing=!1,n.abrupt("return",["",null,void 0].includes(h.mask)?{}:h);case 16:case"end":return n.stop()}}),n)})))()},vipLimit:function(e){return!this.isVip&&((null!=e&&null!==(t=e.lora_models)&&void 0!==t&&t.length?e.lora_models:[]).length>3&&(this.$EventBus.$emit("showBreakDialog","LoRALimit5TipWeb","basic"),!0));var t},checkStudioParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{e.steps<25&&(e.steps=30),e.lab_base.quality_mode||(e.lab_base.quality_mode=1)}catch(e){}return e},setSeed:function(){var meta=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(k.cloneDeep)(meta),t=this.config[this.currentTab].seed;return e.seedTemp=e.seed||"",e.seed=t,e},changeLora:function(e){return e?e.map((function(e){var t=e.art_model,n=e.model_ver_no;return oe(oe(oe({},e),t),{},{model_ver_no:n})})):[]},handleInitConfig:function(){var e,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(k.cloneDeep)(source),pattern=/--auto|--s2/g;try{t.local_prompt=t.local_prompt.replace(pattern,""),t.local_prompt.trim(),t.prompt=t.prompt.replace(pattern,""),t.prompt.trim()}catch(e){}if("textToImage"===this.menuIndex&&["sdxl",5,"5"].includes(t.category))try{var n,o,l,r;t.cfg_scale=t.cfg_scale||7,t.steps=t.steps||30;var c,d=this.sd_xl_base_model[0];if(d=null===(n=this.getDefaultModel({}))||void 0===n?void 0:n.art_model,t.art_model_no=t.art_model_no||d.id,t.modelName=t.modelName||d.name,t.art_model_no===d.id)t.art_work_no=(null===(c=d)||void 0===c||null===(c=c.artwork)||void 0===c?void 0:c.id)||"";else t.art_work_no=t.art_work_no||"";t.art_work_no=t.art_work_no||"",t.model_cover=t.model_cover||d.cover,t.is_agency_fee=t.is_agency_fee||!1,t.agency_fee=t.agency_fee||0,t.art_model_ver_no_name=(null==t?void 0:t.art_model_ver_no_name)||(null===(o=d)||void 0===o?void 0:o.model_ver_name)||"",t.art_model_ver_no=(null==t?void 0:t.art_model_ver_no)||(null===(l=d)||void 0===l?void 0:l.model_ver_no)||"",t.base_model_type=(null==t?void 0:t.base_model_type)||(null===(r=d)||void 0===r?void 0:r.base_model)||"",t.modelTags=this.getStudioModelTags(d)}catch(e){}if(null!=t&&null!==(e=t.roop_arg)&&void 0!==e&&e.image&&(t.roopZoom=!0),t&&t.sdxl)try{var v;t.enablePromptMagic=![0,"0",null,void 0].includes(t.sdxl.prompt_magic),t.sdxl={prompt_magic:[0,"0",null,void 0].includes(null==t||null===(v=t.sdxl)||void 0===v?void 0:v.prompt_magic)?.4:t.sdxl.prompt_magic,prompt_style:t.sdxl.prompt_style||"Fantasy Art"}}catch(e){}return t},handleMeta:function(data,e){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l,r,c,d,v,m,h,f,meta,_,y,C,w,k,I,T,S,O,P,M,L,$,D;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return v=t.length>2&&void 0!==t[2]?t[2]:"",o.next=3,n.getImageNums();case 3:return m=o.sent,h=v||e,f=n.handleParams(data,h),meta=f.meta,_=f.art_work_no,y=f.art_model,C=f.base_model_name,w=void 0===C?"":C,[3,"3"].includes(null==data?void 0:data.action)&&(meta=n.handleVariationsMeta(data,meta)),meta.lcm_mode=null!==(l=meta)&&void 0!==l&&l.lcm_mode?1:0,(meta=n.setSeed(meta,data)).lora_models=n.changeLora(meta.lora_models),k=Array.isArray(null==data||null===(r=data.meta)||void 0===r?void 0:r.embeddings)?null==data||null===(c=data.meta)||void 0===c?void 0:c.embeddings:[],meta.embeddings=(k||[]).map((function(e){return oe(oe({},e),(null==e?void 0:e.art_model)||{})})),I={},e?(T=n.config[e],S=T.width,O=T.height,P=T.seed,M=T.prompt,L=T.left_margin,$=T.up_margin,meta=oe({width:S,height:O,seed:P,prompt:M,left_margin:L,up_margin:$},meta)):I=n.getOtherParams(data),(null==(D=oe(oe(oe(oe({},n.config[e||n.menuIndex]),{},{art_work_no:_,art_model_ver_no:y?y.model_ver_no:"",denoising_strength:.35},meta),I),{},{isTranslate:!0,n_iter:m,isRead:I.imageUrl&&I.imageUrl[0],category:Object(x.handleCategory)((null==data?void 0:data.category)||(null==data||null===(d=data.meta)||void 0===d?void 0:d.category)||1),base_model_type:w}))?void 0:D.prompt)!==(null==D?void 0:D.local_prompt)&&null!=D&&D.prompt&&null!=D&&D.local_prompt||(D.isTranslate=!1),o.abrupt("return",D);case 17:case"end":return o.stop()}}),o)})))()},handleVariationsMeta:function(data,meta){try{var e,t=data.img_uris,n=(meta||{}).init_images,o=null==data||null===(e=data.banner)||void 0===e?void 0:e.url;meta.init_images=t.length?n||[]:o?[o]:[]}catch(e){}return meta},getOtherParams:function(data){var e=data||{},t=e.meta,n=t.controlnet_units,o=void 0===n?[]:n,image=t.image,l=e.operate_number,r={workIndex:0};if(["imageToImage","conditionToImage","animGen"].includes(this.menuIndex)){var c,d=(null==data?void 0:data.category)||(null==data||null===(c=data.meta)||void 0===c?void 0:c.category)||1;r={imageUrl:this.getImageUrl(data),controlnet_units:l?[]:this.getControlNetParams(o,d)}}else"expansion"===this.menuIndex&&(r={imageUrl:[image],isDrag:!1});return r},getControlNetParams:function(e,t){var n=this,o=e.map((function(e){var o=e.type,l=e.processor_res,r=void 0===l?512:l,c=e.module,d=e.model,v=e.control_mode,m=e.weight,h=e.threshold_a,f=o||n.defaultModule,_=d,y=c,C=t||n.getConfigCategory(),w=["5",5,"sdxl","SDXL"].includes(C)?n.taskSdxlUnits:n.taskUnits,k=w.find((function(i){return i.type==n.defaultModule}))||{},I=w.find((function(e){return e.models.includes(d)}));I&&(f=I.type);return("None"==d||["t2i-adapter_diffusers_xl_canny","t2i-adapter_xl_canny","t2i-adapter_diffusers_xl_openpose","t2i-adapter_xl_openpose","t2i-adapter_diffusers_xl_lineart","t2i-adapter_diffusers_xl_depth_midas","t2i-adapter_diffusers_xl_depth_zoe"].includes(d))&&(f=n.defaultModule,_=(null==k?void 0:k.default_model)||"None",y=(null==k?void 0:k.default_module)||"none"),o&&(f=o),{type:f,processor_res:r,module:y,isHandle:"none"!==c,model:_,threshold_a:h,control_mode:Number(v),weight:m,enable:!0}}));return o},getImageUrl:function(data){var e=[],t=data||{},n=t.meta,o=n.init_images,l=n.controlnet_units,r=t.operate_number,c=t.img_uris,d=t.banner;return r&&c&&c.length&&(e[3]=c[r-1].url),null!=l&&l.length&&!r&&(e=l.map((function(e){return e.input_image}))),this.handleWorkIndex()&&!e[3]&&(e[3]=o?o[0]:(null==d?void 0:d.url)||""),e},handleWorkIndex:function(){return["imageToImage","animGen","characterRepair"].includes(this.menuIndex)},handleParams:function(e,t){var n=this.accountSettingsData.is_off_localization,o=["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res","inpaint_full_res_padding"];"imageToImage"===this.menuIndex&&(o=e.meta.mask?o.slice(1):o);var l,r=e.local_prompt,c=e.parent_task_id,d=e.operate_number,v=e.meta,m=v.prompt,h=(v.sampler_name,e.action),f=e.channel,_=e.art_model,y=(e.banner,e.task,_||{}),C=y.name,w=y.id,k=y.agency_fee,I=void 0===k?0:k,T=y.is_agency_fee,S=void 0!==T&&T;if("textToImage"===this.menuIndex){var O=Object(x.handleCategory)(f);localStorage.setItem("defaultCategory",O),e.meta.category=O}w&&(e.meta.art_model_no=w,e.meta.modelName=C,e.meta.agency_fee=I||0,e.meta.is_agency_fee=S||!1,e.meta.model_cover=(null==_||null===(l=_.banner)||void 0===l?void 0:l.url)||"",e.meta.art_model_ver_no_name=(null==_?void 0:_.version_name)||"",e.meta.base_model_type=(null==_?void 0:_.base_model)||"",e.meta.modelTags=this.getStudioModelTags(_));return _&&_.id==e.id&&(_.model_ver_no=e.model_ver_no),e.meta.local_prompt=r,e.meta=oe(oe({},e.meta),{},{action:h}),n||(e.meta.prompt=r,e.meta.local_prompt=m),c&&(e.meta.parent_task_id=c),d&&(e.meta.operate_number=d),Object.keys(e.meta).forEach((function(t){o.includes(t)&&delete e.meta[t]})),e},getDefaultModel:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==data||!data.art_model)try{var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k={},I={banner:{url:""}};if(this.defaultModel)(k=JSON.parse(JSON.stringify(this.defaultModel))).cover=(null===(y=k)||void 0===y||null===(y=y.banner)||void 0===y?void 0:y.url)||"",I.cover=(null===(C=k)||void 0===C||null===(C=C.banner)||void 0===C?void 0:C.url)||"",I.model_cover=(null===(w=k)||void 0===w||null===(w=w.banner)||void 0===w?void 0:w.url)||"";I.id=null===(e=k)||void 0===e?void 0:e.id,I.name=null===(t=k)||void 0===t?void 0:t.name,I.art_work_no="",I.banner.url=null===(n=k)||void 0===n?void 0:n.cover,I.is_agency_fee=(null===(o=k)||void 0===o?void 0:o.is_agency_fee)||!1,I.agency_fee=(null===(l=k)||void 0===l?void 0:l.agency_fee)||0,I.version_name=(null===(r=k)||void 0===r?void 0:r.model_ver_name)||(null===(c=k)||void 0===c?void 0:c.version_name),I.model_ver_name=(null===(d=k)||void 0===d?void 0:d.model_ver_name)||(null===(v=k)||void 0===v?void 0:v.version_name),I.model_ver_no=(null===(m=k)||void 0===m?void 0:m.model_ver_no)||"",I.base_model=(null===(h=k)||void 0===h?void 0:h.base_model)||"",I.modelTags=Array.isArray(null===(f=k)||void 0===f?void 0:f.tags)?null===(_=k)||void 0===_?void 0:_.tags:[],data.art_model=I}catch(e){}return data},getReferParams:function(e){var t={},n=e.model_ver_no,o=e.art_work_no,l=e.id,r=e.prompt,c=(e.banner,e.samples,e.taskSource),d=void 0===c?0:c,v=e.art_model,m=this.getParentId(e);return null!=v&&v.ver_id?t.art_model_ver_no=v.ver_id:n?[3,"3"].includes(d)||(t.art_model_ver_no=n):o||l?t.art_work_no=o||m:r&&!e.noRefer&&(t.prompt=r),0===Object.keys(t).length||[0,"0"].includes(d)||(t.source=d),l||o||null==e||!e.parent_task_id||(t.id=(null==e?void 0:e.parent_task_id)||""),t},getParentId:function(e){var t=e.parent_art_work,n=e.type,o=e.parent_art_work_no,l=e.id;return 1===n&&(o||t)?o||t.id:l},setDefaultMeta:function(e,t){var n,o=this,l=e.action;e.art_work_no,e.imageUrl;l=l<1?1:l;var r=this.defaultModel;if(null!=r&&r.id){var c=this.getModelParams(e);if(c=this.setModelVersion(c,e),!t){delete this.config[this.currentTab].channel;var d=this.getFluxDefaultConfig(null===(n=c)||void 0===n?void 0:n.base_model_type);this.config.generateImage=oe(oe(oe(oe({},this.config.generateImage),e),{},{action:l},c),d),this.$set(this.config,"generateImage",this.config.generateImage)}}else setTimeout((function(){o.setDefaultMeta(e,t)}),2e3)},getFluxDefaultConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={},n=this.getCacheConfig();return((null===_.L||void 0===_.L?void 0:_.L.flux)||[]).includes(e)&&!n&&(t=Object.assign(t,j.FLUX_DEFAULT_CONFIG)),t},getModelParams:function(e){var t,n,o,l,r=this.config[this.currentTab].category,c=[5,"5","sdxl"].includes(r),d=(this.checkIsStudioMode(r),e.art_work_no),v=(e.model_ver_no,e.type),m=e.banner,h=e.action,f=e.name,_=e.id,y=e.samples,C=["LORA","Checkpoint"].includes(v)&&(!(null!=y&&y.length)||""===(null==m?void 0:m.url)),w=c?this.sd_xl_base_model[0]:this.taskBaseModels[0],k=(Object(O.o)(),{art_work_no:d,art_model_no:(w=null===(t=this.getDefaultModel({}))||void 0===t?void 0:t.art_model).id,modelName:w.name,agency_fee:0,is_agency_fee:!1,model_cover:w.cover||"",art_model_ver_no_name:(null===(n=w)||void 0===n?void 0:n.model_ver_name)||"",art_model_ver_no:(null===(o=w)||void 0===o?void 0:o.model_ver_no)||"",base_model_type:(null===(l=w)||void 0===l?void 0:l.base_model)||"",modelTags:this.getStudioModelTags(w)});return C&&("LORA"===v&&(k=this.getLoraParams(k,e)),"Checkpoint"===v&&(k.art_model_no=_,k.modelName=f)),6!==h&&(k.art_work_no=""),C&&(k.category=1),k},getLoraParams:function(e,t){var n,o=t.id,l=t.name,r=t.origin_model,c=t.agency_fee,d=t.is_agency_fee,v=t.base_model,m=t.cover;r&&(e.art_model_no=null==r?void 0:r.model_no,e.modelName=null==r?void 0:r.name,e.model_cover=(null==r||null===(n=r.banner)||void 0===n?void 0:n.url)||"",e.art_model_ver_no_name=(null==r?void 0:r.version_name)||"",e.base_model_type=(null==r?void 0:r.base_model)||"");return e.lora_models=[{id:o,name:l,banner:{url:m||""},weight:1,model_id:o,agency_fee:c,is_agency_fee:d,base_model:v||""}],e},checkIsStudioMode:function(){return["7","11",7,11,"studio"].includes(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")},getStudioModelTags:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Array.isArray(null==source?void 0:source.tags)?null==source?void 0:source.tags:[]},setModelVersion:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=Object(k.cloneDeep)(source);try{"LORA"===e.type&&(t.lora_models[0].model_ver_no=e.model_ver_no),"Checkpoint"===e.type&&(t.art_model_ver_no=e.model_ver_no)}catch(e){}return t},openEasyUpscaleToolsModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$refs.upscaleToolsModal.show(e)},openAnimeToolsModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$refs.animeToolsModal.show(e)},getCacheConfig:function(){var e=null;try{var t;e=localStorage.getItem("easyCacheConfig")||null,null===(t=e=JSON.parse(e)||null)||void 0===t||delete t.generateAudio}catch(e){}return e},getDefaultInter:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.easyGetDefaultParams)();case 2:if(1e4!==(null==(o=t.sent)||null===(n=o.status)||void 0===n?void 0:n.code)){t.next=8;break}return e.config[e.currentTab].n_iter=(null==o||null===(l=o.data)||void 0===l?void 0:l.dft_img_gen_num)||2,e.defaultInter=(null==o||null===(r=o.data)||void 0===r?void 0:r.dft_img_gen_num)||2,e.$store.commit("creation/SET_GENERATE_TASK_OPTIONS",null==o?void 0:o.data),t.abrupt("return",(null==o||null===(c=o.data)||void 0===c?void 0:c.dft_img_gen_num)||2);case 8:case"end":return t.stop()}}),t)})))()},getImageNums:function(){var e=localStorage.getItem("imageNums")||this.defaultInter;return["1","2","3","4",1,2,3,4].includes(e)?Number(e):2},saveConfig:function(){localStorage.setItem("easyCacheConfig",JSON.stringify(this.config))},resetConfig:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,i,h,f,_,y,C,w,k,I,x,T;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]&&e[0],l=e.length>1&&void 0!==e[1]&&e[1],r=e.length>2&&void 0!==e[2]?e[2]:"",t.isRemixScene=!1,c=t.getCacheConfig(),d=JSON.parse(JSON.stringify(t.config)),v=t.getImageGenerateConfig(),n.next=9,t.getImageNums();case 9:m=n.sent,n.t0=regeneratorRuntime.keys(t.config);case 11:if((n.t1=n.t0()).done){n.next=40;break}if(i=n.t1.value,h=oe(oe({},Object(U.getDefaultConfig)(i)),{},{n_iter:m}),!o){n.next=34;break}if(n.prev=15,(h=Object.assign({},h,c&&c[i]||{})).category=1,h.generateing=!1,h.loading=!1,h.speed_type=null===(f=t.config[i])||void 0===f?void 0:f.speed_type,h.keepDenoisingStrength=!1,h.logEventSource=0,C=!(null!==(_=h)&&void 0!==_&&_.art_model_no)&&["generateImage","generateVideo"].includes(i),w=!(null!==(y=h)&&void 0!==y&&null!==(y=y.categoryInfo)&&void 0!==y&&y.id)&&["app"].includes(i),!C&&!w){n.next=30;break}return n.next=28,t.initDefaultModelOrAppConfig(i);case 28:k=n.sent,h=Object.assign(h,k||{});case 30:n.next=34;break;case 32:n.prev=32,n.t2=n.catch(15);case 34:"generateImage"===i&&v&&(h.n_iter=v.n_iter,h.generate.gen_mode=v.gen_mode);try{l&&(h.prompt=(null===(I=d[i])||void 0===I?void 0:I.prompt)||"")}catch(e){}l||t.$set(t.config,i,h),l&&r&&t.$set(t.config,r,h),n.next=11;break;case 40:if(!l){n.next=47;break}return n.next=43,t.initDefaultModelOrAppConfig(r);case 43:x=n.sent,T=oe(oe({},t.config[r]),x),"generateImage"===r&&(t.modelParams={},T.n_iter=(null==v?void 0:v.n_iter)||T.n_iter,T.generate.gen_mode=(null==v?void 0:v.gen_mode)||T.generate.gen_mode),t.$set(t.config,r,T);case 47:case"end":return n.stop()}}),n,null,[[15,32]])})))()},initDefaultModelOrAppConfig:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=e.length>0&&void 0!==e[0]?e[0]:"",r={},n.t0=l,n.next="generateImage"===n.t0?5:"generateVideo"===n.t0?7:"app"===n.t0?9:15;break;case 5:return r=t.initDefaultModelInfo("generateImage"),n.abrupt("break",16);case 7:return r=t.initDefaultModelInfo("generateVideo"),n.abrupt("break",16);case 9:if(null===(o=t.config.app)||void 0===o||null===(o=o.categoryInfo)||void 0===o||!o.id){n.next=11;break}return n.abrupt("return");case 11:return n.next=13,t.initDefaultAppInfo("app");case 13:return r=n.sent,n.abrupt("break",16);case 15:return n.abrupt("break",16);case 16:return n.abrupt("return",r);case 17:case"end":return n.stop()}}),n)})))()},getControlNet:function(){return{type:this.defaultModule,processor_res:512,module:this.defaultModule,model:this.getModel()||"",control_mode:0,threshold_a:.5,weight:1,isHandle:!0,input_image:""}},adjustControlNetWeight:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var n;((null===(n=this.config[this.currentTab])||void 0===n?void 0:n.controlnet_units)||[]).forEach((function(n){e.$set(n,"weight",t?.75:1)}))}catch(e){}},addControlNet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getControlNet();n.type=e.type,(n=Object.assign(n,e||{})).input_image=t,n.enable=!0,this.isCommunityFlux&&(n.weight=.75),this.config[this.currentTab].controlnet_units.push(n)},getModel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultModule,t=this.taskControlNetModules.findIndex((function(t){return t===e}));return this.taskModels[t]},updateConfig:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t&&this.$set(this.config,t,oe(oe({},this.config[t]),e))},getStudioModelTagsType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(null==e?void 0:e.modelTags)||[],n=this.lab_style_enhancement_tag||{},o=n.anime,l=void 0===o?[]:o,r=n.realism,c=void 0===r?[]:r,d=(l||[]).some((function(e){return null==t?void 0:t.includes(e)})),v=(c||[]).some((function(e){return null==t?void 0:t.includes(e)}));return d?"anime":v&&!d?"realistic":"anime"},changeSpeedType:function(){var e=Number(localStorage.getItem("speed_type")),t=this.isOnlyVipLite||!e?2:e;if(this.paymentInfoDone&&this.userInfoDone)for(var i in this.config)this.config[i]=oe(oe({},this.config[i]),{},{speed_type:this.isVip?t:1})},handleMultiImageGeneration:function(){var e,t,n,o,l=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=(null==r?void 0:r.data)||{},meta=c.meta,d=c.local_prompt;this.currentTab="generateVideo",this.config.generateVideo=oe(oe({},this.config.generateVideo),{},{currentVideoTab:"multiImage",currentVideoInputToolTab:j.VIDEO_CREATION_MODE.MULTI_IMG_TO_VIDEO,prompt:d||"",multiImg2videoInfo:{imageList:((null==meta||null===(e=meta.generate_video)||void 0===e?void 0:e.image_opts)||[]).concat(Array(4-((null==meta||null===(t=meta.generate_video)||void 0===t?void 0:t.image_opts)||[]).length).fill({url:""})),height:(null==meta?void 0:meta.height)||0,width:(null==meta?void 0:meta.width)||0,aspect_ratio:(null==meta?void 0:meta.aspect_ratio)||"",gen_mode:(null==meta||null===(n=meta.generate)||void 0===n?void 0:n.gen_mode)||0,negative_prompt:(null==meta?void 0:meta.negative_prompt)||"",enableNegativePrompts:!(null==meta||!meta.negative_prompt),generate_video_duration:(null==meta||null===(o=meta.generate_video)||void 0===o?void 0:o.generate_video_duration)||5}}),this.$nextTick((function(){l.getMultiImg2videoCost()}))},getMultiImg2videoParams:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.config[this.currentTab],o=n.multiImg2videoInfo,l={meta:{prompt:(null==n?void 0:n.prompt)||"",height:(null==o?void 0:o.height)||0,width:(null==o?void 0:o.width)||0,negative_prompt:null!=o&&o.enableNegativePrompts&&(null==o?void 0:o.negative_prompt)||"",aspect_ratio:(null==o?void 0:o.aspect_ratio)||"",generate:{gen_mode:(null==o?void 0:o.gen_mode)||0},generate_video:{generate_video_duration:(null==o?void 0:o.generate_video_duration)||5,image_opts:[]}},model_no:"",model_ver_no:"",task_domain_type:25,ss:52},r=null==o||null===(e=o.imageList)||void 0===e?void 0:e.filter((function(e){return e.url})).map((function(e){return{url:e.url}}));return t&&0===r.length?(this.$message.warning(this.$t("pleaseSelectImage")),!1):(l.meta.generate_video.image_opts=r,l)},getMultiImg2videoCost:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.getMultiImg2videoParams(!1),e.isPosting=!0,t.next=4,Object(T.easyEstimatedConsumption)(o);case 4:l=t.sent,e.isPosting=!1,1e4===(null==l||null===(n=l.status)||void 0===n?void 0:n.code)&&(e.calcCost=(null==l||null===(r=l.data)||void 0===r?void 0:r.calculate_coins)||0,e.discountOff=(null==l||null===(c=l.data)||void 0===c?void 0:c.discount_off_rate)||0,e.costInfo=(null==l?void 0:l.data)||{});case 7:case"end":return t.stop()}}),t)})))()},getCalcCost:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,m,h,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=e.config[e.currentTab],"multiImage"!==(null===(n=e.currentConfigInfo)||void 0===n?void 0:n.currentVideoTab)){t.next=4;break}return e.throttledGetMultiImg2videoCost(),t.abrupt("return");case 4:if(null!=d&&d.art_model_no){t.next=6;break}return t.abrupt("return");case 6:if(null==e||!e.isVideoModel||null!=e&&null!==(o=e.currentSpecialEffectsTemplateInfo)&&void 0!==o&&o.id||"effect"!==(null==e||null===(l=e.currentConfigInfo)||void 0===l?void 0:l.currentVideoTab)){t.next=11;break}return e.calcCost=0,e.discountOff=0,e.costInfo={},t.abrupt("return");case 11:return t.next=13,e.getParams(!0);case 13:v=t.sent,m=e.getGenerateType(),h=e.getParamsByType(v,m,d),e.isVideoModel&&(h=e.extractVideoParams(v),m=null!=d&&null!==(f=d.imageToVideoList)&&void 0!==f&&f.length?"imageToVideo":"textToVideo"),e.isVideoModel&&"effect"===(null==e||null===(r=e.currentConfigInfo)||void 0===r?void 0:r.currentVideoTab)&&null!==(c=h)&&void 0!==c&&c.template_id&&(h.task_domain_type=15),h.meta.generate=e.config[e.currentTab].generate,e.isPosting=!0,Object(T.easyEstimatedConsumption)(h).then((function(t){var n,o;if(!t||1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var l=(null==t?void 0:t.data)||{};"effect"===(null==e||null===(o=e.currentConfigInfo)||void 0===o?void 0:o.currentVideoTab)&&(l.discount_off_rate=80,l.discount_rate=20,l.has_discount=!0,l.calculate_coins_before_discount=parseInt(l.calculate_coins/.2,10)),e.calcCost=(null==l?void 0:l.calculate_coins)||0,e.discountOff=(null==l?void 0:l.discount_off_rate)||0,e.costInfo=l}})).finally((function(){e.isPosting=!1}));case 21:case"end":return t.stop()}}),t)})))()},handleCreate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={targetTab:"generateVideo"};null!=e&&e.model_id&&(t.id=null==e?void 0:e.model_id,t.model_ver_no=null==e?void 0:e.model_ver_no),1e4===e.obj_type?this.changeConfigAndSwitchTab({tabIndex:"generateVideo",subMenuIndex:"effect"}):this.show({action:1,data:{portalParams:t},creativeMode:"normal"})},handleNoteVitor:function(e){this.currentTab="generateImage",this.config.generateImage=oe(oe({},this.config.generateImage),e)},closeInspirationWin:function(){var e,t,n,o,l,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(null!==(e=this.$refs)&&void 0!==e&&null!==(e=e.modelRecipe)&&void 0!==e&&e.visible&&this.$refs.modelRecipe.closeModal(r),null!==(t=this.$refs)&&void 0!==t&&null!==(t=t.videoInspirationLibrary)&&void 0!==t&&t.visible)&&(null===(o=this.$refs)||void 0===o||null===(o=o.videoInspirationLibrary)||void 0===o||o.closeModal(r));null!==(n=this.$refs)&&void 0!==n&&null!==(n=n.musicInspirationLibrary)&&void 0!==n&&n.visible&&(null===(l=this.$refs)||void 0===l||null===(l=l.musicInspirationLibrary)||void 0===l||l.closeModal(r))},setMessageManage:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isShowMessageManage=e,t&&this.$refs.taskView.handleManageOperate("CANCEL")}})},re=le,ce=(n(4459),n(0)),component=Object(ce.a)(re,(function(){var e,t,n,o,l,r,c=this,d=c._self._c;return[2,"2"].includes(c.currentGenerateMode)?d("div",{staticClass:"c-easy-generate",on:{click:function(){return c.closeInspirationWin(!1)}}},[d("easy-generate-top-bar",{attrs:{isShowPopup:c.isShowPopup,listParams:c.listParams},on:{close:function(e){return c.closePopup()},backOld:c.backOld,channelSearch:c.handleChannelSearch}}),c._v(" "),d("div",{staticClass:"easy-generate-content",class:{"easy-generate-content-character":"character"===c.activeCategory}},[d("div",{staticClass:"easy-generate-content-left"},[d("div",{staticClass:"generate-tabs"},c._l(c.tabs,(function(e){return d("div",{key:e.id,staticClass:"tab-item",class:{active:c.currentTab===e.id},attrs:{"data-event":"generate_page_click_tab","data-id":e.id},on:{click:function(t){return c.switchTab(e.id)}}},[c._v("\n          "+c._s(c.$t(e.name))+"\n          "),d("div",{directives:[{name:"show",rawName:"v-show",value:c.currentTab===e.id,expression:"currentTab === tab.id"}],staticClass:"tab-indicator"}),c._v(" "),"generateVideo"===e.id?d("div",{staticClass:"hot-tag"},[d("div",[c._v("hot")])]):c._e()])})),0),c._v(" "),c._l(c.tabs,(function(e){return[c.currentTab===e.id?d(e.component,{key:e.id,ref:"".concat(e.id,"ParamsPanel"),refInFor:!0,tag:"component",attrs:{value:c.config[e.id],menuIndex:e.id},on:{openModelRecipe:c.handleOpenModelRecipe}}):c._e()]})),c._v(" "),"generateVideo"===c.currentTab&&"effect"===(null===(e=c.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab)?d("div",{staticClass:"generate-footer"},[c.isNotLoginAndIsVideoGenerate?[d("div",{staticClass:"bottom-generate-btn",class:{"generate-btn-disable":c.checkIsShowDisable},on:{click:c.debounceGenerate}},[c._v("\n            "+c._s(c.$t("Generate"))+"\n          ")])]:d("div",{staticClass:"bottom-generate-btn",class:[c.checkIsShowDisable&&"generate-btn-disable",!!c.notNeedCheckPrompt&&c.isShowDiscountOff&&"generate-btn-discount"],attrs:{"data-discount-off":c.getDiscountOffText},on:{click:function(e){return c.debounceGenerate()}}},[null!==(t=c.currentConfigInfo)&&void 0!==t&&t.generateing?[d("span",{staticClass:"el-icon-loading"})]:c._e(),c._v("\n          "+c._s(c.$t("Generate"))+"\n          "),c.isVideoModel&&c.isShowDiscountOff?[!c.notNeedCheckPrompt||null!==(n=c.currentConfigInfo)&&void 0!==n&&n.generateing||c.isCompanyAccount?c._e():d("span",{staticClass:"generate-btn-sub-spacial"},[d("i",{staticClass:"iconfont icon-trail-fast-queue"}),c._v(" "),c.getDiscountOffBeforeNum?d("span",{staticClass:"generate-btn-sub-delete-text"},[c._v(c._s(c.getDiscountOffBeforeNum||0))]):c._e(),c._v(" "),d("span",{staticClass:"generate-btn-sub-normal-text"},[c._v(c._s(c.calcCost>=0?c.calcCost:c.computedCost))])])]:["effect"===(null===(o=c.currentConfigInfo)||void 0===o?void 0:o.currentVideoTab)&&0===c.calcCost?[d("el-tooltip",{attrs:{effect:"dark",content:c.$t("workFlow31"),placement:"top"},model:{value:c.isShowSale,callback:function(e){c.isShowSale=e},expression:"isShowSale"}},[d("i",{staticClass:"iconfont icon-a-icon-ContactUs",on:{click:function(e){e.stopPropagation(),c.isShowSale=!c.isShowSale}}})])]:[c.checkIsShowDisable||!c.notNeedCheckPrompt||null!==(l=c.currentConfigInfo)&&void 0!==l&&l.generateing||c.isCompanyAccount?c._e():d("span",{staticClass:"generate-btn-sub"},[c._v("\n                ("+c._s(c.$t("PhysicalExertion"))+": "+c._s(c.calcCost>0?c.calcCost:c.computedCost)+" )\n              ")])]]],2)],2):c._e()],2),c._v(" "),d("video-effect-recommend-modal",{on:{create:c.handleCreate}}),c._v(" "),"generateImage"===c.currentTab?d("ModelRecipe",{ref:"modelRecipe",attrs:{modelData:c.config.generateImage},on:{RecipeRemix:c.handleRecipeRemix,useParams:c.handleUseParams,openNoteListModal:c.handleOpenNoteListModal}}):c._e(),c._v(" "),"generateVideo"===c.currentTab?d("VideoInspirationLibrary",{ref:"videoInspirationLibrary",attrs:{modelData:c.config.generateVideo},on:{RecipeRemix:function(e){return c.handleRecipeRemix(e,"generateVideo")},useParams:c.handleUseVideoInspirationParams}}):c._e(),c._v(" "),"generateAudio"===c.currentTab&&"aiVoice"===c.config.generateAudio.currentAudioTab?d("MusicInspirationLibrary",{ref:"musicInspirationLibrary",attrs:{modelData:c.config.generateAudio},on:{RecipeRemix:c.handleMusicRecipeRemix,useParams:c.handleUseAudioInspirationParams}}):c._e(),c._v(" "),d("div",{staticClass:"easy-generate-content-right",style:{overflowY:c.isShowCreationGuidance?"auto !important":"none"},attrs:{"data-group":"generate_page_content_right"}},[d("div",{staticClass:"easy-generate-content-right-main"},[[d("div",{staticClass:"easy-generate-content-right-top"},[c.isVideoModel||"generateImage"!==c.currentTab?c._e():d("easy-top-input-area",{ref:"easyTopInputAreaRefs",attrs:{value:c.config[c.currentTab],menuIndex:c.currentTab},on:{openDeductionPrompt:c.handleOpenDeductionPrompt,showCreativeAssistant:c.handleShowCreativeAssistant}}),c._v(" "),"generateVideo"===c.currentTab&&"effect"!==(null===(r=c.currentConfigInfo)||void 0===r?void 0:r.currentVideoTab)?d("video-input-area",{attrs:{value:c.config[c.currentTab],menuIndex:c.currentTab}}):c._e(),c._v(" "),c.isShowSubBanner?d("g-recharge-banner",{directives:[{name:"show",rawName:"v-show",value:!c.isCompanyAccount,expression:"!isCompanyAccount"}],on:{close:c.closeSubBanner}}):c._e()],1),c._v(" "),"generateImage"===c.currentTab?[d("message-list",{directives:[{name:"show",rawName:"v-show",value:!c.isShowCreationGuidance,expression:"!isShowCreationGuidance"}],ref:"taskView",attrs:{channelId:c.channelId},on:{reload:c.show,closePopup:c.closePopup}}),c._v(" "),d("creation-guidance-template",{directives:[{name:"show",rawName:"v-show",value:c.isShowCreationGuidance,expression:"isShowCreationGuidance"}],attrs:{"is-init-guide":c.isShowCreationGuidance,"is-generate":c.config.generateImage.generateing},on:{clickItem:c.handleClickItem}})]:[d("message-list",{ref:"taskView",attrs:{channelId:c.channelId},on:{reload:c.show,closePopup:c.closePopup}})]]],2),c._v(" "),c.$isChinaSite?c._e():[d("creative-assistant",{attrs:{isShowCreativeAssistant:c.isShowCreativeAssistant,currentTab:c.config[c.currentTab],calcCost:c.calcCost},on:{close:function(e){c.isShowCreativeAssistant=!1},"generate-prompt":c.handleGeneratePrompt,"modify-prompt":c.handleUseText}})]],2)],1),c._v(" "),d("upscale-tools-modal",{ref:"upscaleToolsModal"}),c._v(" "),d("anime-tools-modal",{ref:"animeToolsModal"}),c._v(" "),d("video-extension-modal",{ref:"videoExtensionModal",on:{updateList:c.updateVideoExtensionTask}}),c._v(" "),d("video-frame-interpolation-modal",{ref:"videoFrameInterpolationModal",on:{updateList:c.updateVideoFrameInterpolationTask}}),c._v(" "),d("CombinedSelectDialog",{ref:"combinedSelectDialog",attrs:{source:"CreativeFlow",subSource:c.currentTab,instanceId:"easyGenerate"}}),c._v(" "),d("SelectVideoModelModal",{ref:"selectVideoModelModal",on:{confirm:c.handleSelectVideoModel}}),c._v(" "),d("deduction-prompt-modal",{ref:"deductionPromptModal",on:{useText:c.handleUseText}})],1):c._e()}),[],!1,null,"4bf5d11e",null);t.default=component.exports;installComponents(component,{EasyGenerateTopBar:n(1169).default,EasyTopInputArea:n(1171).default})},1165:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(12),n(13),n(7);var o=n(3),l=n(68),r=n(14),c=n(2),d=(n(20),n(19),n(6),n(32),n(16),n(22),n(31),n(8),n(4),n(113),n(21),n(288)),v=n(29),m=n(1),h=n(814),f=n(856),_=n(97),y=n(9),C=n(406),w=n(33);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x={name:"EasyModelPanel",props:["value","menuIndex"],inject:["easyTop"],components:{EasyStyleModal:d.default,SelectModelConfirmModal:f.default,commonConfirmModal:_.default,changeVerNew:C.default},data:function(){return{extraModelList:[],selectModelType:"Checkpoint",selectIds:[],visible:!1,isFirstClickInspiration:!0,isFirstClickVideoInspiration:!0}},mounted:function(){var e=this;this.$EventBus.$on("selectModel",(function(t){return e.handleSelectModel2(t)})),this.$EventBus.$on("closeAllGeneratePopup",(function(){e.visible=!1}))},beforeDestroy:function(){this.$EventBus.$off("selectModel"),this.$EventBus.$off("closeAllGeneratePopup")},computed:I(I(I({},Object(m.c)("creation",["taskBaseModels","v2_sd_xl_ctr_units","v2_ctr_units"])),Object(m.c)("user",["userInfo","isLoggedIn","getEnableUsePresetConfig"])),{},{taskModules:function(){var e;return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isSDXLModel?this.v2_sd_xl_ctr_units:this.v2_ctr_units},showChangeVerSelect:function(){var e;return!(null!==(e=this.easyTop)&&void 0!==e&&e.isWan2114BModel)},getTaskUnitsDiffList:function(){var e=this.v2_sd_xl_ctr_units.map((function(e){return null==e?void 0:e.type})),t=this.v2_ctr_units.map((function(e){return null==e?void 0:e.type}));return Object(h.difference)(e,t)},hideModel:function(){return"preview"===(null==this?void 0:this.menuIndex)?["none","reference_only"]:["none"]},modelsList:function(){var e=this.value,t=e.art_work_no,n=e.art_model_no,o=e.art_model_ver_no,l=void 0===o?"":o,c=this.taskBaseModels.map((function(e){var o=e.artwork,r=e.name,c=e.id,d=e.model_ver_no,v=void 0===d?"":d,m=o?null==o?void 0:o.id:"";return{workId:t!==m&&n===c?t:m,name:r,id:c,art_model_ver_no:v||l,banner:{url:e.cover||""},version_name:(null==e?void 0:e.model_ver_name)||"",base_model_type:(null==e?void 0:e.base_model)||"",base_model:(null==e?void 0:e.base_model)||"",modelTags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]}}));return[].concat(Object(r.a)(this.extraModelList),Object(r.a)(c))},modelInfo:function(){var e,t,n=this.value.model_cover||"",o=this.value.model_cover||"";return["",null,void 0].includes(n)||"object"!==Object(l.a)(n)||(o=(null==n?void 0:n.url)||""),{art_model_no:this.value.art_model_no,art_model_ver_no:this.value.art_model_ver_no,name:this.value.modelName,is_agency_fee:this.value.is_agency_fee||this.value.agency_fee>0,agency_fee:this.value.agency_fee,banner:{url:o},version_name:this.value.art_model_ver_no_name||"",base_model_type:this.value.base_model_type||"",base_model:this.value.base_model_type||"",modelTags:Array.isArray(null===(e=this.value)||void 0===e?void 0:e.modelTags)?null===(t=this.value)||void 0===t?void 0:t.modelTags:[],id:this.value.art_model_no,version_no:this.value.art_model_ver_no}},isVideoBanner:function(){var e,t=(null==this||null===(e=this.modelInfo)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url)||"";if(!t)return!1;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return t.toLowerCase().endsWith(e)}))}}),methods:I(I({},Object(m.b)("creation",["setCombinedDialogStatus"])),{},{handleOpenVideoInspirationLibrary:function(){this.isFirstClickVideoInspiration&&(this.isFirstClickVideoInspiration=!1),this.$emit("openModelRecipe","video")},handleOpenModelRecipe:function(){this.isFirstClickInspiration&&(this.isFirstClickInspiration=!1),this.$emit("openModelRecipe","image")},handleJumpDetail:function(){var e,t=window.location.origin,n=null==this||null===(e=this.modelInfo)||void 0===e?void 0:e.art_model_no;n&&window.open(t+this.localePath("/models/detail/".concat(n)),"_blank")},getModelInfobyVersion:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(1===(null==t?void 0:t.is_preset)&&this.getEnableUsePresetConfig){var l,r,c=!0;if(this.isLoggedIn)c=null===(l=this.userInfo)||void 0===l?void 0:l.shot_task_v2_preset_meta_popup,null!==(r=this.userInfo)&&void 0!==r&&r.shot_task_v2_preset_meta_popup||localStorage.setItem("presetModelNotTips",1);else c=!localStorage.getItem("presetModelNotTips");if(c)this.$refs.customConfirmModal.show({subTitle:"newGenerate60",fromPage:"modelPreset"}).then(Object(o.a)(regeneratorRuntime.mark((function o(){var l,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(v.getTaskConfig)({art_model_ver_no:null==t?void 0:t.model_ver_id,source:6,task_flow_version:"v2"});case 2:r=o.sent,e.updateModelPresetParams(n,null==r||null===(l=r.data)||void 0===l?void 0:l.meta),e.changeConfig(n);case 5:case"end":return o.stop()}}),o)}))))}},handleChangeModelVersion:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},(c=JSON.parse(JSON.stringify(t.value))).art_model_ver_no=null==r?void 0:r.model_ver_id,c.model_cover=(null==r||null===(o=r.sample)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.url)||"",c.art_model_ver_no_name=(null==r?void 0:r.version_no)||(null==r?void 0:r.model_ver_id),c.isCustomSizeChange=!1,n.next=8,t.getModelInfobyVersion(r,c);case 8:null==t||null===(l=t.easyTop)||void 0===l||l.updateConfig(c,t.menuIndex);case 9:case"end":return n.stop()}}),n)})))()},openStyleModal:function(){this.selectIds=[{id:this.value.art_model_no,art_model_ver_no_name:this.value.art_model_ver_no_name,model_cover:this.value.model_cover}],this.$EventBus.$emit("needCheckInputPackUp","paramsPanel"),"Checkpoint"===this.selectModelType?this.setCombinedDialogStatus({visible:!0,instanceId:"easyGenerate"}):this.$refs.easyStyleModal.openModal(this.selectModelType),this.$logEvent("log_actions",{operation:"click_basemodel",behavior_info:"on_new_create_flow_page"}),this.$logEvent("log_actions",{operation:"click_model_select_popup",behavior_info:"on_createflow_page"})},updateModelPresetParams:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},source=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=source&&source.width&&null!=source&&source.height&&(t.width=source.width,t.height=source.height),t.cfg_scale=source.cfg_scale||7,t.clip_skip=source.clip_skip||2,t.negative_prompt=source.negative_prompt||"",!this.isLoggedIn&&["",null,void 0].includes(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.prompt)&&(t.prompt=(null==source?void 0:source.positive_prompt)||(null==source?void 0:source.prompt)||""),t.sampler_name=source.sampler_name||"DPM++ 2M Karras",t.vae=source.vae||"vae-ft-mse-840000-ema-pruned",t.steps=source.steps||20,t.lcm_mode="LCM"===t.sampler_name?1:0,t},resetModelBaseParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("FLUX"===t?(e.cfg_scale=3.5,e.steps=30,e.clip_skip=2,e.sampler_name="Euler",e.denoising_strength=.5):(e.cfg_scale=7,e.clip_skip=2,e.sampler_name="DPM++ 2M Karras",e.vae="SDXL"===t?"None":"vae-ft-mse-840000-ema-pruned",e.steps=t.includes("SD 3.5")?25:20),Object(w.checkIsVideoModel)(n)){var o,l=null==this||null===(o=this.easyTop)||void 0===o?void 0:o.initVideoModelDefaultParams(n);Object.assign(e,l)}return e.lcm_mode="LCM"===(null==e?void 0:e.sampler_name)?1:0,e},handleSelectModel:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,C,k,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R,F,B;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return h=e.length>0&&void 0!==e[0]?e[0]:{},f=e.length>2&&void 0!==e[2]?e[2]:"",_=e.length>3&&void 0!==e[3]&&e[3],n.next=6,t.getModelInfo(h);case 6:if(C=n.sent,t.modelsList.some((function(e){return e.id===C.id}))||(t.extraModelList=[C]),k=[],Array.isArray(null==C?void 0:C.modelTags)&&null!=C&&null!==(o=C.modelTags)&&void 0!==o&&o.length&&(k=null==C?void 0:C.modelTags),Array.isArray(null==C?void 0:C.tags)&&null!=C&&null!==(l=C.tags)&&void 0!==l&&l.length&&(k=null==C?void 0:C.tags),I={art_work_no:C.sample_ids?C.sample_ids[0]:C.workId,modelName:C.name,art_model_no:C.id,art_model_ver_no:h.art_model_ver_no||h.model_ver_no||"",agency_fee:(null==h?void 0:h.agency_fee)||0,model_cover:(null==C||null===(r=C.banner)||void 0===r?void 0:r.url)||(null==h||null===(c=h.banner)||void 0===c?void 0:c.url)||"",art_model_ver_no_name:C.version_name||h.version_name,base_model_type:C.base_model,modelTags:k},x=!1,!t.checkShowIpMainTips(I)){n.next=18;break}return n.next=18,null===(T=t.$refs)||void 0===T||null===(T=T.customConfirmModal)||void 0===T?void 0:T.show({subTitle:"newGenerate65"}).then((function(e){I.ipList=[],I.styleReferenceList=[],x=!1})).catch((function(e){x=!0}));case 18:if(!x){n.next=20;break}return n.abrupt("return");case 20:if("preset"===f&&_&&(I=t.updateModelPresetParams(I,h),t.$EventBus.$emit("resetInputPackUpStatus")),S=null===(d=t.easyTop)||void 0===d?void 0:d.getCurrentModelType(C.base_model),O=(null==t||null===(v=t.easyTop)||void 0===v?void 0:v.isSd35Model)||y.L.sd35.includes(h.base_model)||(h.base_model||"").includes("SD 3.5")||!1,P="FLUX"===S,M="SDXL"===S,L="SD"===S,$="SeaDream"===S,D=null===(m=t.easyTop)||void 0===m?void 0:m.getCurrentModelType(t.value.base_model_type),Object(w.checkIsVideoModel)(C.base_model)||(I.imageToVideoList=[]),"preset"!==f&&D!==S&&(t.resetModelBaseParams(I,S,C.base_model),D!==S&&!Object(w.checkIsVideoModel)(C.base_model)&&Object(w.checkIsVideoModel)(t.value.base_model_type)&&(I.width=688,I.height=1024,I.imageToVideoList=[],1===(null==t||null===(j=t.value)||void 0===j?void 0:j.n_iter)&&(I.n_iter=2))),!P&&!O){n.next=52;break}if(N=(N=JSON.parse(JSON.stringify(t.value.controlnet_units))).map((function(e){return e.type})),null!==(E=N)&&void 0!==E&&E.length){n.next=40;break}return t.$refs.easyStyleModal.handleClose(),I.controlnet_units=[],I.enableNegativePrompts=!1,I.negative_prompt="",t.changeConfig(I),n.abrupt("return");case 40:if(!(w.ENABLE_FLUX_STYLE_REFERENCE&&P&&null!==(A=N)&&void 0!==A&&A.length)){n.next=49;break}return V=JSON.parse(JSON.stringify(t.value.controlnet_units)),R=["canny","depth","ip_adapter"],t.$refs.easyStyleModal.handleClose(),I.controlnet_units=V.filter((function(e){return R.includes(null==e?void 0:e.type)})).slice(0,1),I.enableNegativePrompts=!1,I.negative_prompt="",t.changeConfig(I),n.abrupt("return");case 49:return t.$logEvent("log_actions",{operation:"model_incompatibility_popup_show",behavior_info:"on_new_create_flow_page",behavior_info_sub:N||[]}),t.$refs.confirmModal.show().then((function(){t.$refs.easyStyleModal.handleClose(),I.controlnet_units=[],I.enableNegativePrompts=!1,I.negative_prompt="",t.changeConfig(I)})),n.abrupt("return");case 52:if($&&(I.enableNegativePrompts=!1,I.negative_prompt=""),D===S||!M&&!L){n.next=62;break}if((F=t.checkNeedTips(C)).length){n.next=59;break}return t.$refs.easyStyleModal.handleClose(),t.changeConfig(I),n.abrupt("return");case 59:return t.$logEvent("log_actions",{operation:"model_incompatibility_popup_show",behavior_info:"on_new_create_flow_page",behavior_info_sub:F||[]}),t.$refs.confirmModal.show(F).then((function(){t.$refs.easyStyleModal.handleClose();var e=JSON.parse(JSON.stringify(t.value));e.controlnet_units=(e.controlnet_units||[]).filter((function(e){return!F.includes(null==e?void 0:e.type)})),I.controlnet_units=e.controlnet_units,t.changeConfig(I)})),n.abrupt("return");case 62:D!==S&&(null==t||null===(B=t.easyTop)||void 0===B||B.adjustControlNetWeight(P)),t.$refs.easyStyleModal.handleClose(),t.changeConfig(I);case 65:case"end":return n.stop()}}),n)})))()},handleSelectModel2:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,C,k,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R,F,B,U,G,z,W,H,K,J,X,Q,Y,Z,ee,te,ie,ne,oe,ae,se,le,re,ce,de,ue,pe,ve,me;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return C=e.model,k=void 0===C?{}:C,I=e.model_type,x=e.isPreset,T=void 0===x?"":x,S=e.usePreset,O=void 0!==S&&S,n.next=3,t.getModelInfo(k,"preset"===T);case 3:if(P=n.sent,t.modelsList.some((function(e){return e.id===P.id}))||(t.extraModelList=[P]),M=[],Array.isArray(null==P?void 0:P.modelTags)&&null!=P&&null!==(o=P.modelTags)&&void 0!==o&&o.length&&(M=null==P?void 0:P.modelTags),Array.isArray(null==P?void 0:P.tags)&&null!=P&&null!==(l=P.tags)&&void 0!==l&&l.length&&(M=null==P?void 0:P.tags),L={art_work_no:P.sample_ids?P.sample_ids[0]:P.workId,modelName:P.name,art_model_no:P.id,art_model_ver_no:k.art_model_ver_no||k.model_ver_no||"",agency_fee:(null==k?void 0:k.agency_fee)||0,model_cover:(null==P||null===(r=P.banner)||void 0===r?void 0:r.url)||(null==k||null===(c=k.banner)||void 0===c?void 0:c.url)||"",art_model_ver_no_name:P.version_name||k.version_name,base_model_type:P.base_model||k.base_model||"",modelTags:M},$=!1,!t.checkShowIpMainTips(L)){n.next=15;break}return n.next=15,null===(D=t.$refs)||void 0===D||null===(D=D.customConfirmModal)||void 0===D?void 0:D.show({subTitle:"newGenerate65"}).then((function(e){L.ipList=[],L.styleReferenceList=[],$=!1})).catch((function(e){$=!0}));case 15:if(!$){n.next=17;break}return n.abrupt("return");case 17:if("preset"===T&&O&&(L=t.updateModelPresetParams(L,P),t.$EventBus.$emit("resetInputPackUpStatus")),j=null===(d=t.easyTop)||void 0===d?void 0:d.getCurrentModelType(P.base_model),E=(null==t||null===(v=t.easyTop)||void 0===v?void 0:v.isSd35Model)||y.L.sd35.includes(k.base_model)||(k.base_model||"").includes("SD 3.5")||!1,A="FLUX"===j,N="SDXL"===j,V="SD"===j,R="SeaDream"===j,F=null===(m=t.easyTop)||void 0===m?void 0:m.getCurrentModelType(t.value.base_model_type),Object(w.checkIsVideoModel)(P.base_model)||(L.imageToVideoList=[],L.SpecialEffectsAppInfo=null,L.specialEffectsImageList=JSON.parse(JSON.stringify((null===w.AI_VIDEO_GENERATE_PARAMS||void 0===w.AI_VIDEO_GENERATE_PARAMS?void 0:w.AI_VIDEO_GENERATE_PARAMS.specialEffectsImageList)||[])),L.currentVideoInputToolTab=w.VIDEO_CREATION_MODE.IMG_TO_VIDEO,!Object(w.checkIsVideoModel)(P.base_model)&&Object(w.checkIsVideoModel)(t.value.base_model_type)&&(null!==(B=L)&&void 0!==B&&B.prompt||(L.prompt=""))),"preset"===T&&("preset"!==T||O)||F===j||t.resetModelBaseParams(L,j,P.base_model),"preset"===T&&("preset"!==T||O)||(null==t||null===(h=t.value)||void 0===h?void 0:h.base_model_type)===(null==P?void 0:P.base_model)){n.next=33;break}if(Object(w.checkIsSameModelType)(null==t||null===(U=t.value)||void 0===U?void 0:U.base_model_type,null==P?void 0:P.base_model)){n.next=33;break}return n.next=31,null==t||null===(G=t.easyTop)||void 0===G?void 0:G.getModelDefaultConfig(null==P?void 0:P.base_model);case 31:z=n.sent,L=Object.assign(L,z||{});case 33:if(!A&&!E){n.next=55;break}if(K=(K=JSON.parse(JSON.stringify(t.value.controlnet_units))).map((function(e){return e.type})),null!==(W=K)&&void 0!==W&&W.length){n.next=43;break}return t.$refs.easyStyleModal.handleClose(),L.controlnet_units=[],L.enableNegativePrompts=!1,L.negative_prompt="",t.changeConfig(L),n.abrupt("return");case 43:if(!(w.ENABLE_FLUX_STYLE_REFERENCE&&A&&null!==(H=K)&&void 0!==H&&H.length)){n.next=52;break}return J=JSON.parse(JSON.stringify(t.value.controlnet_units)),X=["canny","depth","ip_adapter"],t.$refs.easyStyleModal.handleClose(),L.controlnet_units=J.filter((function(e){return X.includes(null==e?void 0:e.type)})).slice(0,1),L.enableNegativePrompts=!1,L.negative_prompt="",t.changeConfig(L),n.abrupt("return");case 52:return t.$logEvent("log_actions",{operation:"model_incompatibility_popup_show",behavior_info:"on_new_create_flow_page",behavior_info_sub:K||[]}),t.$refs.confirmModal.show(K).then((function(){t.$refs.easyStyleModal.handleClose(),L.controlnet_units=[],L.enableNegativePrompts=!1,L.negative_prompt="",t.changeConfig(L)})),n.abrupt("return");case 55:if(R&&(L.enableNegativePrompts=!1,L.negative_prompt=""),F===j||!N&&!V){n.next=65;break}if((Q=t.checkNeedTips(P)).length){n.next=62;break}return t.$refs.easyStyleModal.handleClose(),t.changeConfig(L),n.abrupt("return");case 62:return t.$logEvent("log_actions",{operation:"model_incompatibility_popup_show",behavior_info:"on_new_create_flow_page",behavior_info_sub:Q||[]}),t.$refs.confirmModal.show(Q).then((function(){t.$refs.easyStyleModal.handleClose();var e=JSON.parse(JSON.stringify(t.value));e.controlnet_units=(e.controlnet_units||[]).filter((function(e){return!Q.includes(null==e?void 0:e.type)})),L.controlnet_units=e.controlnet_units,t.changeConfig(L)})),n.abrupt("return");case 65:F!==j&&(null==t||null===(Y=t.easyTop)||void 0===Y||Y.adjustControlNetWeight(A)),t.$refs.easyStyleModal.handleClose(),Object(w.checkIsVideoModel)(P.base_model)&&(ie=Object(w.checkIsVideoModel)(P.base_model),ne=Object(w.checkIsVideoModel)(t.value.base_model_type),oe=ie&&ne,ae=null==t||null===(Z=t.easyTop)||void 0===Z?void 0:Z.initVideoModelDefaultParams(P.base_model,oe),L=Object.assign(L,ae),(se=null==t||null===(ee=t.easyTop)||void 0===ee?void 0:ee.updateVideoInputSelectTab(null===(te=L)||void 0===te?void 0:te.base_model_type))&&(L.currentVideoInputToolTab=se),se||(L.currentVideoInputToolTab=(null==t||null===(le=t.easyTop)||void 0===le||null===(le=le.currentConfigInfo)||void 0===le?void 0:le.currentVideoInputToolTab)||(null===(re=L)||void 0===re?void 0:re.currentVideoInputToolTab))),ce=!Object(w.checkIsVideoModel)(P.base_model),de=Object(w.checkIsVideoModel)(t.value.base_model_type),ce&&de&&(L.width=688,L.height=1024,L.imageToVideoList=[],L.n_iter=null===(ue=t.easyTop)||void 0===ue?void 0:ue.defaultInter,null!==(pe=L)&&void 0!==pe&&pe.prompt||(L.prompt="")),Object(w.checkIsVideoModel)(P.base_model)&&!Object(w.checkIsVideoModel)(t.value.base_model_type)&&(L.n_iter=null===(ve=t.easyTop)||void 0===ve?void 0:ve.defaultInter,null!==(me=L)&&void 0!==me&&me.prompt||(L.prompt="")),"HiDream"===F||"HiDream"!==P.base_model||null!=t&&null!==(f=t.easyTop)&&void 0!==f&&f.checkHiDreamModelSize(L.width,L.height)||(L.width=832,L.height=1248),"SeaDream"===F||"SeaArt Film"!==P.base_model||null!=t&&null!==(_=t.easyTop)&&void 0!==_&&_.checkSeaDreamModelSize(L.width,L.height)||(L.width=982,L.height=1472,L.lora_models=[]),t.changeConfig(L);case 75:case"end":return n.stop()}}),n)})))()},checkNeedTips:function(e){var t,n=this,o="SDXL"===(null===(t=this.easyTop)||void 0===t?void 0:t.getCurrentModelType(e.base_model)),l=JSON.parse(JSON.stringify(this.value.controlnet_units));l=l.map((function(e){return e.type}));var r=[],c=this.v2_sd_xl_ctr_units.map((function(e){return null==e?void 0:e.type})),d=this.v2_ctr_units.map((function(e){return null==e?void 0:e.type}));return r=(o?c:d).filter((function(e){return!n.hideModel.includes(e)&&l.includes(e)})),l.filter((function(e){return!r.includes(e)}))},checkShowIpMainTips:function(e){var t,n,o,l=(null===y.L||void 0===y.L?void 0:y.L.flux)||[],r="FLUX"===(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.currentModelType),c=!l.includes(null==e?void 0:e.base_model_type),d=(null==this||null===(n=this.easyTop)||void 0===n||null===(n=n.currentConfigInfo)||void 0===n||null===(n=n.styleReferenceList)||void 0===n?void 0:n.length)||(null==this||null===(o=this.easyTop)||void 0===o?void 0:o.hasIpMaintain);return r&&c&&d},getModelInfo:function(e){var t=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c,d,m,h,f,_,y,C,w,k,x,T,meta,S,O;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=t.length>1&&void 0!==t[1]&&t[1],!("object"===Object(l.a)(e))){o.next=32;break}if(!(null!=e&&e.sample_ids||2===(null==e?void 0:e.publish_status))){o.next=7;break}return o.abrupt("return",e);case 7:if(1!==(null==e?void 0:e.publish_status)||null!=e&&e.sample_ids||r){o.next=9;break}return o.abrupt("return",e);case 9:return c={art_model_ver_no:e.model_ver_no,task_flow_version:"v2"},r&&(c.source=6),o.next=13,Object(v.getTaskConfig)(c);case 13:if(d=o.sent,m=d.data,f=(h=void 0===m?{}:m).art_model,_=f.id,y=f.name,C=f.version_name,w=f.base_model,k=f.model_ver_no,x=h.art_work_no,T=h.meta,meta=void 0===T?{}:T,S=h.local_prompt,O=void 0===S?"":S,!r||!meta){o.next=31;break}return o.abrupt("return",I(I({id:_,name:y,version_name:C,workId:x,art_model_ver_no:e.model_ver_no||k,base_model:e.base_model||w,tags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]},meta),{},{prompt:O||meta.prompt||""}));case 31:return o.abrupt("return",{id:_,name:y,version_name:C,workId:x,art_model_ver_no:e.model_ver_no||k,base_model:e.base_model||w,tags:Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[]});case 32:return o.abrupt("return",n.modelsList.find((function(t){return t.id===e})));case 33:case"end":return o.stop()}}),o)})))()},changeConfig:function(e,t){var n,o,l=JSON.parse(JSON.stringify(this.value));t&&(l[t]=e),l=I(I({},l),e),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(l,this.menuIndex),null==this||null===(o=this.easyTop)||void 0===o||o.getPanelParams({model_ver_no:l.art_model_ver_no,model_no:l.art_model_no,base_model_name:l.base_model_type},!0)},handleCreate:function(e){var t,n,o,l;this.handleSelectModel2({model:{id:e.id,model_ver_no:e.model_ver_no,banner:{url:null===(t=e.banner)||void 0===t?void 0:t.url,width:null===(n=e.banner)||void 0===n?void 0:n.width,height:null===(o=e.banner)||void 0===o?void 0:o.height}}}),this.visible=!1,null==this||null===(l=this.easyTop)||void 0===l||l.updateConfig({currentVideoInputToolTab:w.VIDEO_CREATION_MODE.IMG_TO_VIDEO},this.menuIndex)}})},T=x,S=(n(4232),n(4233),n(0)),component=Object(S.a)(T,(function(){var e,t,n,o,l,r,c,d,v=this,m=v._self._c;return m("el-popover",{ref:"modelPopover",attrs:{"popper-class":"recommend-model-popover",placement:"right","visible-arrow":!1,width:"318",trigger:"manual"},model:{value:v.visible,callback:function(e){v.visible=e},expression:"visible"}},[m("div",{staticClass:"c-easy-model-panel",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),v.openStyleModal.apply(null,arguments)}},slot:"reference"},[m("div",{staticClass:"background-media"},[!v.isVideoBanner&&null!==(e=v.modelInfo)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.url?m("img",{attrs:{src:null===(t=v.modelInfo)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url}}):v.isVideoBanner&&null!==(n=v.modelInfo)&&void 0!==n&&null!==(n=n.banner)&&void 0!==n&&n.url?m("video",{attrs:{src:null===(o=v.modelInfo)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.url,loop:"",muted:"",autoplay:"",playsinline:""},domProps:{muted:!0}}):v._e()]),v._v(" "),m("div",{staticClass:"model-panel-card"},[m("div",{staticClass:"model-panel-card-left"},[m("div",{staticClass:"model-panel-card-left-box"},[m("span",{staticClass:"model-panel-card-left-tag"},[v._v(v._s(v.$t("Model")))])]),v._v(" "),m("div",{staticClass:"model-panel-card-left-text-box"},[m("span",{staticClass:"model-panel-card-left-text"},[v._v(v._s(null===(l=v.modelInfo)||void 0===l?void 0:l.name))]),v._v(" "),m("i",{directives:[{name:"show",rawName:"v-show",value:null===(r=v.modelInfo)||void 0===r?void 0:r.art_model_no,expression:"modelInfo?.art_model_no"}],staticClass:"iconfont icon-icon-xinxi",on:{click:function(e){return e.stopPropagation(),v.handleJumpDetail.apply(null,arguments)}}})]),v._v(" "),m("change-ver-new",{directives:[{name:"show",rawName:"v-show",value:(null===(c=v.modelInfo)||void 0===c?void 0:c.art_model_ver_no)&&v.showChangeVerSelect,expression:"modelInfo?.art_model_ver_no && showChangeVerSelect"}],attrs:{from:"styleModal",item:v.modelInfo,base_models:[null===(d=v.modelInfo)||void 0===d?void 0:d.base_model]},on:{selectItem:v.handleChangeModelVersion}})],1),v._v(" "),m("div",{staticClass:"model-panel-card-right"},[m("span",{staticClass:"iconfont icon-select-model-icon"})])]),v._v(" "),"generateImage"===v.menuIndex&&v.value.art_model_no&&v.value.art_model_ver_no?m("div",{staticClass:"model-panel-card-bottom",attrs:{"data-event":"model-recipe-btn"},on:{click:function(e){return e.stopPropagation(),v.handleOpenModelRecipe.apply(null,arguments)}}},[m("div",{staticClass:"model-panel-card-bottom-text"},[v._v("\n        "+v._s(v.$t("model_recipe"))+"\n        "),v.isFirstClickInspiration?m("span",{staticClass:"tips-icon-new"},[v._v("NEW")]):v._e()])]):v._e(),v._v(" "),"generateVideo"===v.menuIndex&&v.value.art_model_no&&v.value.art_model_ver_no?m("div",{staticClass:"model-panel-card-bottom",attrs:{"data-desc":"aiVideo","data-event":"video-model-inspiration-btn"},on:{click:function(e){return e.stopPropagation(),v.handleOpenVideoInspirationLibrary.apply(null,arguments)}}},[m("div",{staticClass:"model-panel-card-bottom-text"},[v._v("\n        "+v._s(v.$t("model_recipe"))+"\n        "),v.isFirstClickVideoInspiration?m("span",{staticClass:"tips-icon-new"},[v._v("NEW")]):v._e()])]):v._e(),v._v(" "),m("easy-style-modal",{ref:"easyStyleModal",attrs:{"model-type":v.selectModelType,inTask:!0,"is-studio-mode":!0,"select-list":v.selectIds},on:{selectModel:v.handleSelectModel}}),v._v(" "),m("select-model-confirm-modal",{ref:"confirmModal"}),v._v(" "),m("common-confirm-modal",{ref:"customConfirmModal"})],1)])}),[],!1,null,"3c95cbc0",null);t.default=component.exports;installComponents(component,{EasyStyleModal:n(288).default})},1166:function(e,t,n){"use strict";n.r(t);n(19),n(11),n(12),n(13);var o=n(3),l=n(68),r=n(14),c=n(2),d=(n(20),n(6),n(50),n(16),n(73),n(22),n(49),n(18),n(8),n(4),n(21),n(7),n(25)),v=n(407),m=n(596),h=n(1),f=n(56),_=n(288),y=n(99);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"EasyAdditionalPanel",props:["value","menuIndex"],inject:["easyTop"],components:{AdditionalPanelCardItem:m.default,EasyStyleModal:_.default,CombinedSelectDialog:v.default},data:function(){return{isCollapse:!1,selectIds:[],modelDetailTrainedWords:[],loraModelTypeKeyList:["LORA","DoRA","LoCon"],loraModelTypeList:{LORA:"selectedLoraModelType",DoRA:"selectedDoRAModelType",LoCon:"selectedLyCORISModelType"},showAllTriggerWords:!1,triggerWordsNeedMore:!1}},mounted:function(){},updated:function(){},watch:{},computed:w(w(w(w({},Object(h.c)("payment",["paymentInfo"])),Object(h.c)("user",["isCompanyAccount","isLoggedIn"])),Object(h.c)("creation",["isIgnoreUnAvailableLora"])),{},{hasConflictModel:function(){var e,t,n,o=Object(y.getAdditionalModels)((null==this||null===(e=this.value)||void 0===e?void 0:e.base_model_type)||"");return((null===(t=this.value)||void 0===t?void 0:t.lora_models)||[]).some((function(e){return!o.includes(null==e?void 0:e.base_model)}))||((null===(n=this.value)||void 0===n?void 0:n.embeddings)||[]).some((function(e){return!o.includes(null==e?void 0:e.base_model)}))},subSource:function(){return"generateVideo"===this.menuIndex?"loraVideoModel":"loraImgModel"},showViewMore:function(){var e,t,n,o,l=!this.isCollapse&&((null===(e=this.value)||void 0===e||null===(e=e.embeddings)||void 0===e?void 0:e.length)||(null===(t=this.value)||void 0===t||null===(t=t.lora_models)||void 0===t?void 0:t.length)),r=!(null!==(n=this.value)&&void 0!==n&&null!==(n=n.lora_models)&&void 0!==n&&n.length&&null!==(o=this.easyTop)&&void 0!==o&&o.isHunyuan);return l&&r},modelInfo:function(){var e,t;return{art_model_no:this.value.art_model_no,art_model_ver_no:this.value.art_model_ver_no,name:this.value.modelName,is_agency_fee:this.value.is_agency_fee||this.value.agency_fee>0,agency_fee:this.value.agency_fee,banner:{url:this.value.model_cover||""},version_name:this.value.art_model_ver_no_name||"",base_model_type:this.value.base_model_type||"",base_model:this.value.base_model_type||"",modelTags:Array.isArray(null===(e=this.value)||void 0===e?void 0:e.modelTags)?null===(t=this.value)||void 0===t?void 0:t.modelTags:[]}},showAdd:function(){var e,t;return!(null!==(e=this.value)&&void 0!==e&&null!==(e=e.lora_models)&&void 0!==e&&e.length||null!==(t=this.value)&&void 0!==t&&null!==(t=t.embeddings)&&void 0!==t&&t.length)},isVipFun:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},selectedLoraModelList:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.lora_models)||void 0===e?void 0:e.filter((function(e){return"LORA"===(null==e?void 0:e.type)})))||[]},selectedDoRAModelList:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.lora_models)||void 0===e?void 0:e.filter((function(e){return"DoRA"===(null==e?void 0:e.type)})))||[]},selectedLyCORISModelList:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.lora_models)||void 0===e?void 0:e.filter((function(e){return"LoCon"===(null==e?void 0:e.type)})))||[]},triggeredWords:function(){var e,t,n=[];return([].concat(Object(r.a)(((null===(e=this.value)||void 0===e?void 0:e.lora_models)||[]).map((function(e){return w(w({},e),{},{modelType:(null==e?void 0:e.type)||""})}))),Object(r.a)(((null===(t=this.value)||void 0===t?void 0:t.embeddings)||[]).map((function(e){return w(w({},e),{},{modelType:"Embedding"})}))))||[]).forEach((function(e){var t;if(null!=e&&e.trained_words&&null!=e&&null!==(t=e.trained_words)&&void 0!==t&&t.length){var o=((null==e?void 0:e.trained_words)||[]).map((function(t){return{word:t,modelName:(null==e?void 0:e.name)||"",modelVersionName:(null==e?void 0:e.version_name)||"",modelId:(null==e?void 0:e.id)||"",modelVersionId:(null==e?void 0:e.model_ver_no)||"",modelType:(null==e?void 0:e.modelType)||""}}));n=[].concat(Object(r.a)(n),Object(r.a)(o))}})),n}}),methods:w(w({},Object(h.b)("creation",["setCombinedDialogStatus","setIsIgnoreUnAvailableLoraStatus"])),{},{checkTriggerWordsOverflow:Object(d.debounce)((function(){var e=this;this.$nextTick((function(){try{var t,n=null==e||null===(t=e.$refs)||void 0===t?void 0:t.triggerWordContent;if(n){var o=n.scrollHeight;e.triggerWordsNeedMore=o>80}}catch(e){}}))}),200),toggleTriggerWordsDisplay:function(){var e=this;this.showAllTriggerWords=!this.showAllTriggerWords,this.$nextTick((function(){e.checkTriggerWordsOverflow()}))},handleSelectAdditionalModel:function(e){var t,n,o=(null==e?void 0:e.obj)||null;if(o){try{var r,c,d;if(!["",null,void 0].includes(null===(r=o)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)&&"object"===Object(l.a)(null===(c=o)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.url))o.banner.url=(null===(d=o.banner)||void 0===d||null===(d=d.url)||void 0===d?void 0:d.url)||""}catch(e){}var v,m;if(null===(t=o)||void 0===t||!t.type||null===(n=o)||void 0===n||!n.base_model)o=w(w({},o),{},{type:null===(v=o)||void 0===v||null===(v=v.art_model)||void 0===v?void 0:v.type,base_model:null===(m=o)||void 0===m||null===(m=m.art_model)||void 0===m?void 0:m.base_model});this.handleSelectModel(o)}},handleUpdateLoraVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=JSON.parse(JSON.stringify(this.value)).lora_models,o=void 0===n?[]:n;(o||[]).forEach((function(n){if((null==n?void 0:n.id)===(null==t?void 0:t.id)){var o,l;if(n.version_name=(null==e?void 0:e.version_no)||(null==e?void 0:e.model_ver_id),n.model_ver_no=null==e?void 0:e.model_ver_id,null!=e&&null!==(o=e.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)n.banner.url=(null==e||null===(l=e.sample)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||"";n.trained_words=Array.isArray(null==e?void 0:e.trained_words)?null==e?void 0:e.trained_words:[]}})),this.changeConfig({lora_models:o})}catch(e){}},handleUpdateEmbeddingVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=JSON.parse(JSON.stringify(this.value)).embeddings,o=void 0===n?[]:n;(o||[]).forEach((function(n){if((null==n?void 0:n.id)===(null==t?void 0:t.id)){var o,l;if(n.version_name=(null==e?void 0:e.version_no)||(null==e?void 0:e.model_ver_id),n.model_ver_no=null==e?void 0:e.model_ver_id,null!=e&&null!==(o=e.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)n.banner.url=(null==e||null===(l=e.sample)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||"";n.trained_words=Array.isArray(null==e?void 0:e.trained_words)?null==e?void 0:e.trained_words:[]}})),this.changeConfig({embeddings:o})}catch(e){}},toggleFoldStatus:function(){this.isCollapse=!this.isCollapse,this.$logEvent("log_actions",{operation:"click_additional",behavior_info:"on_new_create_flow_page"})},openSelectModal:function(){this.selectIds=[].concat(Object(r.a)(this.value.lora_models),Object(r.a)(this.value.embeddings)),this.setCombinedDialogStatus({visible:!0,instanceId:"additionalPanel"}),this.$EventBus.$emit("needCheckInputPackUp","paramsPanel"),this.$logEvent("log_actions",{operation:"click_additional",behavior_info:"on_new_create_flow_page"})},handleSelectModel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e||{}).type,n=void 0===t?"":t;"TextualInversion"===n&&this.selectEmbeddingHandle(e),this.loraModelTypeKeyList.includes(n)&&this.selectLoraHandle(e),this.$refs.easyStyleModal.handleClose()},selectEmbeddingHandle:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.value.embeddings,l=void 0===o?[]:o,r=w({model_id:e.id,weight:1},e),!((null==l?void 0:l.length)>=8)){n.next=5;break}return t.$message.warning(t.$t("embedding6",{num:8})),n.abrupt("return");case 5:return c=l.findIndex((function(e){return e.id===r.id&&(null==e?void 0:e.model_ver_no)===(null==r?void 0:r.model_ver_no)})),n.next=8,t.getModelDetail(null==r?void 0:r.model_id,null==r?void 0:r.model_ver_no);case 8:d=n.sent,d=Array.isArray(d)?d:[],-1!==c?l[c]=w(w({},r),{},{trained_words:d}):l.push(w(w({},r),{},{trained_words:d})),t.changeConfig({embeddings:l});case 12:case"end":return n.stop()}}),n)})))()},getModelDetail:function(){var e=this,t={id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",version_id:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""};return Object(f.G)(t).then((function(t){var n;if(t&&1e4!==(null==t||null===(n=t.status)||void 0===n?void 0:n.code))return[];var o=(t&&null!=t&&t.data?null==t?void 0:t.data:{}).trained_words,l=void 0===o?[]:o;return e.modelDetailTrainedWords=Array.isArray(l)?l:[],Array.isArray(l)?l:[]})).finally((function(){}))},selectLoraHandle:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=t.value.lora_models,r=w({model_id:e.id,weight:1},e),!(null!=t&&null!==(o=t.easyTop)&&void 0!==o&&o.isHunyuan&&(null==l?void 0:l.length)>=1)){n.next=5;break}return t.$message.warning(t.$t("newGenerate50")),n.abrupt("return");case 5:if(!((null==l?void 0:l.length)>=5)){n.next=8;break}return t.$message.warning(t.$t("newGenerate50")),n.abrupt("return");case 8:if(t.isLoggedIn||!((null==l?void 0:l.length)>=3)){n.next=12;break}return t.$EventBus.$emit("openLoginDialog",{dot:!1}),t.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),n.abrupt("return");case 12:if(t.isVipFun||!((null==l?void 0:l.length)>=3)){n.next=15;break}return t.$EventBus.$emit("showBreakDialog","LoRALimit5TipWeb","basic"),n.abrupt("return");case 15:return c=l.findIndex((function(e){return e.id===r.id})),n.next=18,t.getModelDetail(null==r?void 0:r.model_id,null==r?void 0:r.model_ver_no);case 18:d=n.sent,d=Array.isArray(d)?d:[],-1!==c?l[c]=w(w({},r),{},{trained_words:d}):l.push(w(w({},r),{},{trained_words:d})),t.changeConfig({lora_models:l});case 22:case"end":return n.stop()}}),n)})))()},changeWeight:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=JSON.parse(JSON.stringify(this.value)),l=o.lora_models,r=o.embeddings,c=void 0===r?[]:r;if(this.loraModelTypeKeyList.includes(n)){var d=l.findIndex((function(e){return(null==t?void 0:t.id)===e.id}));-1!==d&&(l[d].weight=e,this.changeConfig({lora_models:l}))}else if("Embedding"===n){var v=c.findIndex((function(e){return(null==t?void 0:t.id)===e.id&&(null==t?void 0:t.model_ver_no)===(null==e?void 0:e.model_ver_no)}));-1!==v&&(c[v].weight=e,this.changeConfig({embeddings:c}))}},deleteModel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=JSON.parse(JSON.stringify(this.value)),o=n.lora_models,l=n.embeddings,r=void 0===l?[]:l;if(this.loraModelTypeKeyList.includes(t)){var c=o.findIndex((function(t){return(null==e?void 0:e.id)===t.id}));-1!==c&&(o.splice(c,1),this.changeConfig({lora_models:o}))}else if("Embedding"===t){var d=r.findIndex((function(t){return(null==e?void 0:e.id)===t.id&&(null==e?void 0:e.model_ver_no)===(null==t?void 0:t.model_ver_no)}));-1!==d&&(r.splice(d,1),this.changeConfig({embeddings:r}))}},handleUseTriggerWord:function(e){var t,n=(null===(t=this.value)||void 0===t?void 0:t.prompt)||"";n="".concat(e.word,",").concat(n),this.changeConfig({prompt:n}),this.$message.success(this.$t("Added"))},handleUseAllTriggerWords:function(){var e,t=this.triggeredWords.map((function(e){return e.word})).join(","),n=(null===(e=this.value)||void 0===e?void 0:e.prompt)||"";n="".concat(t,",").concat(n),this.changeConfig({prompt:n}),this.$message.success(this.$t("Added"))},changeConfig:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value));t&&(o[t]=e),o=w(w({},o),e),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)}})},I=k,x=(n(4272),n(0)),component=Object(x.a)(I,(function(){var e,t,n,o,l,r,c,d,v,m=this,h=m._self._c;return h("div",{staticClass:"c-easy-additional-panel"},[h("div",{staticClass:"additional-panel-title",on:{click:function(e){e.stopPropagation(),m.showAdd?m.openSelectModal():m.toggleFoldStatus()}}},[h("span",{staticClass:"additional-panel-title-text"},[m._v(m._s(m.$t("newGenerate48")))]),m._v(" "),h("span",{staticClass:"additional-panel-title-icon",class:m.showAdd?"el-icon-circle-plus-outline":(m.isCollapse,"el-icon-caret-bottom"),on:{click:function(e){e.stopPropagation(),m.showAdd?m.openSelectModal():m.toggleFoldStatus()}}})]),m._v(" "),!m.isCollapse&&m.hasConflictModel?h("div",{staticClass:"additional-panel-item"},[h("div",{staticClass:"panel-item-label-box"},[h("span",{staticClass:"generate-mode-panel-label-text"},[m._v(m._s(m.$t("ignoreUnAvailableLoraTips")))])]),m._v(" "),h("div",{staticClass:"panel-item-label panel-item-label-flex"},[h("el-switch",{attrs:{"active-color":"#3F8CFF",value:m.isIgnoreUnAvailableLora,"active-value":"on","inactive-value":"off"},on:{change:m.setIsIgnoreUnAvailableLoraStatus}})],1)]):m._e(),m._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:!m.isCollapse&&(null===(e=m.selectedLoraModelList)||void 0===e?void 0:e.length),expression:"!isCollapse && selectedLoraModelList?.length"}],staticClass:"lora-list"},[h("div",{staticClass:"lora-list-label"},[m._v(m._s(m.$t("LoRA")))]),m._v(" "),h("div",{staticClass:"lora-list-content"},[m._l(m.selectedLoraModelList||[],(function(e,t){return[h("additional-panel-card-item",{key:"lora_".concat(t),attrs:{modelInfo:e},on:{deleteItem:function(t){return m.deleteModel(e,"LORA")},updateVersion:function(t){return m.handleUpdateLoraVersion(t,e)},changeWeight:function(t){return m.changeWeight(t,e,"LORA")}}})]}))],2)]),m._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:!m.isCollapse&&(null===(t=m.selectedDoRAModelList)||void 0===t?void 0:t.length),expression:"!isCollapse && selectedDoRAModelList?.length"}],staticClass:"lora-list"},[h("div",{staticClass:"lora-list-label"},[m._v(m._s(m.$t("DoRA")))]),m._v(" "),h("div",{staticClass:"lora-list-content"},[m._l(m.selectedDoRAModelList||[],(function(e,t){return[h("additional-panel-card-item",{key:"dora_".concat(t),attrs:{modelInfo:e},on:{deleteItem:function(t){return m.deleteModel(e,"DoRA")},updateVersion:function(t){return m.handleUpdateLoraVersion(t,e)},changeWeight:function(t){return m.changeWeight(t,e,"DoRA")}}})]}))],2)]),m._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:!m.isCollapse&&(null===(n=m.selectedLyCORISModelList)||void 0===n?void 0:n.length),expression:"!isCollapse && selectedLyCORISModelList?.length"}],staticClass:"lora-list"},[h("div",{staticClass:"lora-list-label"},[m._v(m._s(m.$t("LyCORIS")))]),m._v(" "),h("div",{staticClass:"lora-list-content"},[m._l(m.selectedLyCORISModelList||[],(function(e,t){return[h("additional-panel-card-item",{key:"lycoris_".concat(t),attrs:{modelInfo:e},on:{deleteItem:function(t){return m.deleteModel(e,"LoCon")},updateVersion:function(t){return m.handleUpdateLoraVersion(t,e)},changeWeight:function(t){return m.changeWeight(t,e,"LoCon")}}})]}))],2)]),m._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:!m.isCollapse&&(null===(o=m.value)||void 0===o||null===(o=o.embeddings)||void 0===o?void 0:o.length),expression:"!isCollapse && value?.embeddings?.length"}],staticClass:"lora-list"},[h("div",{staticClass:"lora-list-label"},[m._v(m._s(m.$t("embedding1")))]),m._v(" "),h("div",{staticClass:"lora-list-content"},[m._l((null===(l=m.value)||void 0===l?void 0:l.embeddings)||[],(function(e,t){return[h("additional-panel-card-item",{key:"embedding_".concat(t),attrs:{modelInfo:e,type:"embedding"},on:{deleteItem:function(t){return m.deleteModel(e,"Embedding")},updateVersion:function(t){return m.handleUpdateEmbeddingVersion(t,e)},changeWeight:function(t){return m.changeWeight(t,e,"Embedding")}}})]}))],2)]),m._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:!m.isCollapse&&(null===(r=m.triggeredWords)||void 0===r?void 0:r.length)&&"generateImage"===m.menuIndex,expression:"!isCollapse && triggeredWords?.length && menuIndex === 'generateImage'"}],staticClass:"trigger-word-area"},[h("div",{staticClass:"trigger-word-area-header"},[h("span",{staticClass:"trigger-word-area-title"},[m._v(m._s(m.$t("embedding3"))+"\n          "),h("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:m.$t("triggerWordsTips"),placement:"top-start"}},[h("i",{staticClass:"custom-tips el-icon-warning"})])],1),m._v(" "),h("span",{staticClass:"trigger-word-area-use-all",on:{click:m.handleUseAllTriggerWords}},[m._v(m._s(m.$t("useAll")))])]),m._v(" "),h("div",{ref:"triggerWordContent",staticClass:"trigger-word-area-content"},m._l(m.triggeredWords,(function(e,t){return h("div",{key:"trigger_word_".concat(t),staticClass:"trigger-word-area-content-item",on:{click:function(t){return m.handleUseTriggerWord(e)}}},[h("el-tooltip",{attrs:{placement:"top",content:"".concat(m.$t("by")," ").concat(e.modelName,"-").concat(e.modelVersionName),effect:"light"}},[h("span",{staticClass:"trigger-word-text"},[m._v(m._s((null==e?void 0:e.word)||""))])]),m._v(" "),h("span",{staticClass:"trigger-word-icon iconfont icon-a-icon-TopPrompt"})],1)})),0)]),m._v(" "),m.showViewMore?h("div",{staticClass:"tools-popup-view-more-btn",attrs:{"data-event":"click_additional_model_more"},on:{click:function(e){return e.stopPropagation(),m.openSelectModal()}}},[h("span",{staticClass:"tools-popup-view-more-btn-text"},[m._v(m._s(m.$t("addMoreParams")))]),m._v(" "),h("span",{staticClass:"tools-popup-view-more-btn-icon el-icon-right"})]):m._e(),m._v(" "),h("easy-style-modal",{ref:"easyStyleModal",attrs:{"model-type":"LORA",inTask:!0,isSD35:null===(c=m.easyTop)||void 0===c?void 0:c.isSd35Model,isSDXL:null===(d=m.easyTop)||void 0===d?void 0:d.isSDXLModel,"is-studio-mode":!0,studioModelInfo:m.modelInfo,"select-list":m.selectIds},on:{selectModel:m.handleSelectModel}}),m._v(" "),h("CombinedSelectDialog",{ref:"additionalModelModal",attrs:{source:"selectAdditionalModel",subSource:m.subSource,baseModelType:null===(v=m.value)||void 0===v?void 0:v.base_model_type,instanceId:"additionalPanel"},on:{handleSelectAdditionalModel:m.handleSelectAdditionalModel}})],1)}),[],!1,null,"5b50430d",null);t.default=component.exports;installComponents(component,{EasyStyleModal:n(288).default})},1167:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(12),n(13);var o=n(14),l=n(2),r=(n(19),n(6),n(32),n(22),n(18),n(65),n(8),n(4),n(21),n(7),n(85)),c=n(1),d=n(99),v=n(57),m=n(25),h=n(33),f=n(97),_=n(597),y=n(137),C=n(9),w=n(598),k=n(866),I=n(867),x=n(385),T=n(271),S=n(868);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={"1:1":"icon-icon-a-1_11","16:9":"icon-a-16_91","4:3":"icon-a-4_31","3:4":"icon-a-3_4","9:16":"icon-a-9_161","3:2":"icon-a-3_2","2:3":"icon-a-2_3","21:9":"icon-a-21_9"},L={name:"EasyGenerateModePanel",props:["value","menuIndex"],inject:["easyTop"],components:{commonConfirmModal:f.default,ImageSizeOptionsPopup:_.default,SliderItem:y.default,VideoUpload:w.default,MarkImgSelect:k.default,SpecialEffectsAppPanel:I.default,VideoExplainPopover:x.a,VideoTemplateCard:S.default},data:function(){return{createSetting:1,lastFrameState:!1,imageSizeOptions:[{code:1,label:"2:3",icon:"icon-a-2_3",sd:{standard:{width:512,height:768}},sdxl:{standard:{width:768,height:1152}},flux:{standard:{width:688,height:1024},quality:{width:1024,height:1536}},HiDream:{standard:{width:832,height:1248}},SeaDream:{standard:{width:982,height:1472},quality:{width:1280,height:1920}},IL:{standard:{width:1024,height:1536}},IL3:{standard:{width:1248,height:1824}}},{code:2,label:"1:1",icon:"icon-icon-a-1_11",sd:{standard:{width:768,height:768}},sdxl:{standard:{width:1024,height:1024}},flux:{standard:{width:1024,height:1024},quality:{width:1536,height:1536}},HiDream:{standard:{width:1024,height:1024}},SeaDream:{standard:{width:1472,height:1472},quality:{width:2048,height:2048}},IL:{standard:{width:1536,height:1536}},IL3:{standard:{width:1536,height:1536}}},{code:3,label:"9:16",icon:"icon-a-9_161",sd:{standard:{width:432,height:768}},sdxl:{standard:{width:810,height:1440}},flux:{standard:{width:592,height:1024},quality:{width:864,height:1536}},HiDream:{standard:{width:768,height:1360}},SeaDream:{standard:{width:828,height:1472},quality:{width:1152,height:2048}},IL:{standard:{width:864,height:1536}},IL3:{standard:{width:1152,height:2048}}},{code:4,label:"4:3",icon:"icon-a-4_31",sd:{standard:{width:768,height:576}},sdxl:{standard:{width:1024,height:768}},flux:{standard:{width:1024,height:768},quality:{width:1536,height:1152}},HiDream:{standard:{width:1168,height:880}},SeaDream:{standard:{width:1472,height:1104},quality:{width:2048,height:1536}},IL:{standard:{width:1536,height:1152}},IL3:{standard:{width:2048,height:1536}}},{code:5,label:"more",icon:"icon-icon-Custom",sd:{},sdxl:{},flux:{},HiDream:{},SeaDream:{},IL:{},IL3:{}}],imageSizeOptionsMore:d.IMAGE_SIZE_OPTIONS_MORE,pixVerseGenerationList:h.PIX_VERSE_GENERATION_MODE,currentImageSize:1,isLockSize:!1,lockSize:{width:1,height:1,aspectRatio:1},showAspectRatio:"1:1",debounceComputedAspectRatio:function(){},debounceCheckActiveSizeMode:function(){},isExpand:!0}},created:function(){this.debounceComputedAspectRatio=Object(m.debounce)(this.getSizeAspectRatio,500),this.debounceCheckActiveSizeMode=Object(m.debounce)(this.checkAutoActiveSizeMode,500),this.$EventBus.$on("closeAllGeneratePopup",this.closeImageSizeOptionPopup)},beforeDestroy:function(){this.debounceComputedAspectRatio=null,this.debounceCheckActiveSizeMode=null,this.$EventBus.$off("closeAllGeneratePopup",this.closeImageSizeOptionPopup)},computed:P(P(P(P({},Object(c.c)("payment",["paymentInfo"])),Object(c.c)("creation",["pixVerseStyleList","IllustriousVersion3IdList"])),Object(c.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),{},{shouldShowPrivateCreation:function(){var e,t;return null!==(e=this.easyTop)&&void 0!==e&&e.isEnableModelQuickConfig?Object(T.getSceneConfig)("basic_private_creation",(null===(t=this.easyTop)||void 0===t?void 0:t.currentImageModelConfig)||{}):!this.isCompanyAccount},isCustomSize:function(){var e;return!(null===(e=this.easyTop)||void 0===e||null===(e=e.imageDefaultSize)||void 0===e||!e.length)},imageDefaultSize:function(){var e,t=null===(e=this.easyTop)||void 0===e?void 0:e.imageDefaultSize;return null!=t&&t.length?t:this.imageSizeOptions},generateVideoDuration:function(){var e;return null===(e=this.value)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.generate_video_duration},disableBasicMode:function(){var e,t,n,o="txt2video"===(null===(e=this.easyTop)||void 0===e?void 0:e.activeVideoInputTab),l=null===(t=this.easyTop)||void 0===t?void 0:t.isKL10Model;return!o&&!l&&(null===(n=this.value)||void 0===n||null===(n=n.imageToVideoList)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.lastFrame)},renderPixVerseStyleList:function(){var e=((null==this?void 0:this.pixVerseStyleList)||[]).map((function(e){return e.label=e.name,e}));return[{label:this.$t("createModeType1"),value:"",img:""}].concat(Object(o.a)(e))},isShowVideoGenerateMode:function(){var e;return null===(e=this.easyTop)||void 0===e?void 0:e.isPixVerse},isShowFluency:function(){var e;return null===(e=this.easyTop)||void 0===e?void 0:e.isPixVerse},renderFluency:function(){return[{code:"normal",label:"fast_ai_standard"},{code:"fast",label:"fast_ai_fluent"}]},videoFirstFrameConfig:function(){var e,t,n=null===(e=this.easyTop)||void 0===e?void 0:e.videoModelParams;return(null==n||null===(t=n.i2v_model_param)||void 0===t?void 0:t.frame_ctl)||[]},showVideoUpload:function(){return this.videoFirstFrameConfig.some((function(i){return i>0}))},showVideoUploadEndImg:function(){return this.videoFirstFrameConfig.some((function(i){return i>1}))&&this.isLoggedIn},videoModelDurationConfig:function(){var e,t,n,o;if("generateVideo"!==(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab))return[];var l=null===(t=this.easyTop)||void 0===t?void 0:t.videoModelParams,r=(null===(n=this.easyTop)||void 0===n||null===(n=n.currentConfigInfo)||void 0===n?void 0:n.currentVideoInputToolTab)===h.VIDEO_CREATION_MODE.IMG_TO_VIDEO?"i2v_model_param":"t2v_model_param";return(null==l||null===(o=l[r])||void 0===o||null===(o=o.duration_ctl)||void 0===o?void 0:o.map((function(i){return{code:i,label:"".concat(i,"s")}})))||[]},isShowSizeText:function(){var e;return!(null!==(e=this.easyTop)&&void 0!==e&&e.isPixVerse)},getEffectsImageList:function(){var e;return(null===(e=this.value)||void 0===e?void 0:e.specialEffectsImageList)||[]},specialEffectsOutputNodes:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.SpecialEffectsAppInfo)||void 0===e||null===(e=e.templateInfo)||void 0===e||null===(e=e.inputs)||void 0===e?void 0:e.length)||1},isShowSpecialEffects:function(){var e,t,n=null===(e=this.easyTop)||void 0===e?void 0:e.isVideoModel,o="effect"===(null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t?void 0:t.currentVideoTab);return n&&o},isDisableGenModePanel:function(){var e,t;return(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isDisableSupportQuality)||(null===(t=this.easyTop)||void 0===t?void 0:t.isAnimeEnhanceEnable)},isShowRelevance:function(){var e,t;return(null===(e=this.easyTop)||void 0===e?void 0:e.isVideoModel)&&(null===(t=this.easyTop)||void 0===t||null===(t=t.currentVideoModelConfig)||void 0===t?void 0:t.enable_relevance)},renderVideoSizeOptions:function(){var e,t,n=null===(e=this.easyTop)||void 0===e?void 0:e.videoModelParams;return n&&(null==n||null===(t=n.t2v_model_param)||void 0===t||null===(t=t.resolution_param)||void 0===t?void 0:t.options.map((function(i,e){return{width:i.width,height:i.height,showAspectRatio:i.aspect_ratio,label:i.aspect_ratio,icon:M[i.aspect_ratio],code:e+1}})))||[]},isRenderVideoSizeOptions:function(){var e;return"generateVideo"===(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)&&this.renderVideoSizeOptions.length},isShowFree:function(){var e,t,n,o,l,r,c=!this.isCompanyAccount;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(l=this.easyTop)||void 0===l||null===(l=l.currentVideoModelConfig)||void 0===l?void 0:l.enable_free_setting)&&!c;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return Object(T.getSceneConfig)("basic_free_creation",(null===(r=this.easyTop)||void 0===r?void 0:r.currentImageModelConfig)||{});var d=!(null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isHiDreamModel),v=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isSeaArtFilmModel);return c&&d&&v},UnlimitedQueueTip:function(){return this.isCompanyAccount?"ToBUnlimitedQueueTip":"UnlimitedQueueTip"},queueRenderList:function(){return[{code:1,i18nKey:"NormalQueue",tips:"",show:!this.isVipFun},{code:2,i18nKey:"SubsBottomTerms2",tips:"",isVip:!0,show:this.isVipFun},{code:3,i18nKey:"UnlimitedQueue",tips:this.UnlimitedQueueTip,isVip:!0,show:!0}].filter((function(e){return e.show}))},isOnlyVipLite:function(){var e,t;return!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState)&&!this.isCompanyAccount&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},canUseUnlimitedQueue:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.infiniteQueue},isVipFun:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},vipLevel:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.productLevel},isShowGenerateMode:function(){var e,t,n,o,l,r;return null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel?(null===(o=this.easyTop)||void 0===o||null===(o=o.currentVideoModelConfig)||void 0===o?void 0:o.enable_gen_mode_ctl)&&!(null!==(l=this.easyTop)&&void 0!==l&&l.isPixVerse):null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig?Object(T.getSceneConfig)("basic_generate_mode",(null===(r=this.easyTop)||void 0===r?void 0:r.currentImageModelConfig)||{}):!(null!==(n=this.easyTop)&&void 0!==n&&n.isHiDreamModel)},isShowPromptMagic:function(){var e,t,n,o,l,r,c,d;return null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel?null===(c=this.easyTop)||void 0===c||null===(c=c.currentVideoModelConfig)||void 0===c?void 0:c.enable_prompt_magic_mode_ctl:null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig?Object(T.getSceneConfig)("basic_prompt_magic",(null===(d=this.easyTop)||void 0===d?void 0:d.currentImageModelConfig)||{}):[null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isCommunityFlux,null==this||null===(o=this.getCurrentModelType)||void 0===o?void 0:o.includes("SD 3.5"),null==this||null===(l=this.easyTop)||void 0===l?void 0:l.isHiDreamModel,null==this||null===(r=this.easyTop)||void 0===r?void 0:r.isSeaArtFilmModel].some((function(e){return e}))},isShowImageNum:function(){var e;return null===(e=this.easyTop)||void 0===e||!e.isVideoModel||this.isMiniMax},isShowGenerateNum:function(){var e,t,n,o="effect"===(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab);return!(null===(t=this.easyTop)||void 0===t||!t.isVideoModel)&&((null===(n=this.easyTop)||void 0===n||null===(n=n.currentVideoModelConfig)||void 0===n?void 0:n.enable_n_video_iter)&&!o&&!this.isMiniMax)},isShowImageSize:function(){var e,t,n,o=[h.VIDEO_CREATION_MODE.IMG_TO_VIDEO,h.VIDEO_CREATION_MODE.IMG_TO_LIVE2D].includes(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.currentVideoInputToolTab);return null===(t=this.easyTop)||void 0===t||!t.isVideoModel||(null===(n=this.renderVideoSizeOptions)||void 0===n?void 0:n.length)&&!o},imageNumLimit:function(){var e;if(this.isCustomSize)return null===(e=this.easyTop)||void 0===e||null===(e=e.modelParams)||void 0===e||null===(e=e.gen_num_param)||void 0===e?void 0:e.max_num;var t=4;return this.isMiniMax&&(t=3),t},isVideoModel:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isVideoModel},isMiniMax:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isMiniMax},isHunyuan:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isHunyuan},isKLModel:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isKLModel},isSpecialILModel:function(){var e,t;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.checkIsIllustriousVersionId(null===(t=this.value)||void 0===t?void 0:t.art_model_ver_no)},getModelType:function(){return this.isSpecialILModel3?"IL3":this.isSpecialILModel?"IL":null==this?void 0:this.getCurrentModelType},isSpecialILModel3:function(){var e=this;return(this.IllustriousVersion3IdList||[]).some((function(t){var n;return t===(null==e||null===(n=e.value)||void 0===n?void 0:n.art_model_ver_no)}))},isSDXLModel:function(){var e=this.value.base_model_type;return["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony","SDXL Hyper"].concat(Object(o.a)(C.L.sdxl)).includes(e)||(e||"").includes("SDXL")},widthMaxMin:function(){return this.isCustomSize?this.getCustomSizeOptions.width:this.getCustomSizeOptions},heightMaxMin:function(){return this.isCustomSize?this.getCustomSizeOptions.height:this.getCustomSizeOptions},getCustomSizeOptions:function(){var e,t,n,o,l;if(this.isCustomSize)return{width:{min:null===(t=this.easyTop)||void 0===t||null===(t=t.modelParams)||void 0===t||null===(t=t.resolution_param)||void 0===t?void 0:t.min_height,max:null===(n=this.easyTop)||void 0===n||null===(n=n.modelParams)||void 0===n||null===(n=n.resolution_param)||void 0===n?void 0:n.max_height},height:{min:null===(o=this.easyTop)||void 0===o||null===(o=o.modelParams)||void 0===o||null===(o=o.resolution_param)||void 0===o?void 0:o.min_width,max:null===(l=this.easyTop)||void 0===l||null===(l=l.modelParams)||void 0===l||null===(l=l.resolution_param)||void 0===l?void 0:l.max_width}};var r={min:128,max:1024},c={min:384,max:1024};return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?c:"sd"===this.getCurrentModelType?r:null!=this&&this.isSpecialILModel?{min:512,max:1536}:null!=this&&this.isSpecialILModel3?{min:512,max:2048}:["sdxl"].includes(this.getCurrentModelType)?{min:128,max:1536}:"SD 3.5"===this.getCurrentModelType?c:"HiDream"===this.getCurrentModelType?{min:768,max:1360}:"SeaDream"===this.getCurrentModelType?{min:512,max:1472}:r},isCurrentImageNum:function(){return function(i){return this.value.n_iter===i}},getCurrentModelType:function(){var e=this.value.base_model_type||"",t=Object(d.getCurrentModelType)(e);return t||"sd"},showVideoUploadContent:function(){var e,t,n,o,l=null===(e=this.easyTop)||void 0===e?void 0:e.isVideoModel,r=null==this||null===(t=this.value)||void 0===t?void 0:t.currentVideoInputToolTab,c=(null==this||null===(n=this.value)||void 0===n?void 0:n.currentVideoTab)===h.VIDEO_CREATION_MODE.EFFECT,d=l&&[h.VIDEO_CREATION_MODE.IMG_TO_VIDEO].includes(r)&&!c,v=[h.VIDEO_CREATION_MODE.IMG_TO_LIVE2D].includes(r)&&(null===(o=this.easyTop)||void 0===o?void 0:o.isMiniMax)&&!c;return d||v},checkVideoGenerationModeStatus:function(){return function(code){var e,t=!1;if(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isPixVerse&&"1080p"===code){var n,o,l=8===(null===(n=this.value)||void 0===n||null===(n=n.generate_video)||void 0===n?void 0:n.generate_video_duration),r="fast"===(null===(o=this.value)||void 0===o||null===(o=o.generate_video)||void 0===o?void 0:o.motion_mode);t=l||r}return t}},checkVideoDurationStatus:function(){return function(code){var e,t,n=!1;null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isPixVerse&&8===code&&(n="fast"===(null===(t=this.value)||void 0===t||null===(t=t.generate_video)||void 0===t?void 0:t.motion_mode));return n}}}),watch:{menuIndex:{handler:function(e){this.isExpand=!0},immediate:!0},"easyTop.modelParams":{handler:function(e){if(e){var t,n,o,data=null;if("generateVideo"===(null===(t=this.easyTop)||void 0===t?void 0:t.currentTab))return;if(null==this||null===(n=this.easyTop)||void 0===n||null===(n=n.modelParams)||void 0===n||!n.resolution_param)return;if(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isSetUpConfigData){var l,r,c;data=null===(l=this.easyTop)||void 0===l||null===(l=l.modelParams)||void 0===l?void 0:l.resolution_param;var d=null===(r=this.easyTop)||void 0===r||null===(r=r.imageDefaultSize)||void 0===r?void 0:r.find((function(e){var t;return e.aspect_ratio===(null===(t=data)||void 0===t?void 0:t.dft_aspect_ratio)})),v=null===(c=this.$refs)||void 0===c||null===(c=c.ImageSizeOptionsPopup)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.customOptions,m=null==v?void 0:v.find((function(e){var t;return e.aspect_ratio===(null===(t=data)||void 0===t?void 0:t.dft_aspect_ratio)}));this.currentImageSize=d?d.code:m?m.code:5}else{var h,f,_,y,C=null==this||null===(h=this.easyTop)||void 0===h||null===(h=h.config)||void 0===h||null===(h=h[this.menuIndex])||void 0===h?void 0:h.width,w=null==this||null===(f=this.easyTop)||void 0===f||null===(f=f.config)||void 0===f||null===(f=f[this.menuIndex])||void 0===f?void 0:f.height,k=null===(_=this.easyTop)||void 0===_||null===(_=_.imageDefaultSize)||void 0===_?void 0:_.find((function(e){return e.width===C&&e.height===w})),I=null===(y=this.$refs)||void 0===y||null===(y=y.ImageSizeOptionsPopup)||void 0===y||null===(y=y[0])||void 0===y?void 0:y.customOptions,x=null==I?void 0:I.find((function(e){return e.width===C&&e.height===w}));this.currentImageSize=k?k.code:x?x.code:5}}},deep:!0,immediate:!0},"userInfo.settings.is_auto_pub_community":{handler:function(e){this.isLoggedIn?this.createSetting=e?1:2:this.createSetting=1},immediate:!0},isLoggedIn:{handler:function(e){!e&&(this.createSetting=1)},immediate:!0,deep:!0},"value.width":{handler:function(e){this.lockSize||(this.lockSize.width=e,this.lockSize.height=this.value.height),this.debounceComputedAspectRatio&&this.debounceComputedAspectRatio(),this.debounceCheckActiveSizeMode&&this.debounceCheckActiveSizeMode()},immediate:!0,deep:!0},"value.height":{handler:function(e){this.lockSize||(this.lockSize.height=e,this.lockSize.width=this.value.width),this.debounceComputedAspectRatio&&this.debounceComputedAspectRatio(),this.debounceCheckActiveSizeMode&&this.debounceCheckActiveSizeMode()},immediate:!0,deep:!0},"easyTop.currentModelType":{handler:function(e,t){try{var n;if(e&&e!==t&&this.checkNeedUpdateSize(),"HiDream"===e&&e!==t&&3===this.value.speed_type)this.handleQueueSelectChange(null===(n=this.queueRenderList[0])||void 0===n?void 0:n.code)}catch(e){}},immediate:!0,deep:!0},"value.imageToImageList":{handler:function(e,t){null!=e&&e.length&&this.checkAutoActiveSizeMode()},immediate:!0,deep:!0},"value.art_model_no":{handler:function(e,t){e&&["",null,void 0].includes(t)&&this.checkNeedUpdateSize()},immediate:!0},"value.imageToVideoList":{handler:function(e){var t,n=null==e?void 0:e.some((function(e){return null==e?void 0:e.lastFrame}));if(n&&!this.lastFrameState&&(null===(t=this.easyTop)||void 0===t||!t.isKL10Model)&&(this.easyTop.isKL15Model||this.easyTop.isKL16Model)){var o,l=JSON.parse(JSON.stringify(this.value));l.generate.gen_mode=1,null==this||null===(o=this.easyTop)||void 0===o||o.updateConfig(l,this.menuIndex),this.$message.success(this.$t("LastFrameOnlyQualityMode"))}this.lastFrameState=n},deep:!0},isSpecialILModel:{handler:function(e,t){"sdxl"===this.getCurrentModelType&&e!==t&&this.checkNeedUpdateSize()}}},methods:P(P({},Object(c.b)("user",["getAccountInfo"])),{},{selectEffect:function(e){var t;null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig({SpecialEffectsAppInfo:e},this.menuIndex)},selectTemplate:function(e){var t;null===(t=this.easyTop)||void 0===t||t.updateConfig({prompt:this.$t(e.prompt),imageToVideoList:[{mode:"first_frame",url:e.imgs[0],firstFrame:e.imgs[0],lastFrame:""}],isImageToVideoInitData:!0},this.menuIndex),this.$refs.videoUpload.activeImgTab="first_frame"},selectSample:function(e){var t;null==this||null===(t=this.easyTop)||void 0===t||t.updateEffectImage({url:null==e?void 0:e.url},0)},changeVideoConfig:function(e,t){var n,o,l,r,c=JSON.parse(JSON.stringify(this.value));("relevance"===t&&(c.generate_video.relevance=e),"generate_video_duration"!==t||null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isPixVerse)||(null!=this&&null!==(r=this.easyTop)&&void 0!==r&&r.isFixedDuration?c.generate_video.generate_video_duration=5:c.generate_video.generate_video_duration=e);null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isPixVerse&&(c=this.handlePixVerseConflict(c,e,t)),null==this||null===(l=this.easyTop)||void 0===l||l.updateConfig(c,this.menuIndex)},handlePixVerseConflict:function(source,e,t){return"generate_video_duration"===t&&(source.generate_video.generate_video_duration=e,8===e&&"1080p"===source.generate_video.quality_mode&&(source.generate_video.generate_video_duration=8,source.generate_video.quality_mode="720p"),8===e&&"fast"===source.generate_video.motion_mode&&(source.generate_video.generate_video_duration=5)),"motion_mode"===t&&(source.generate_video.motion_mode=e,"fast"===e&&"1080p"===source.generate_video.quality_mode&&(source.generate_video.quality_mode="720p"),"fast"===e&&(source.generate_video.generate_video_duration=5)),source},handleUpdateVideoSize:function(e){this.updateImageSize({width:e.width,height:e.height,aspect_ratio:e.aspectRatio})},handleQueueSelectChange:function(e){var t;if(this.$logEvent("log_actions",{operation:"click_free_create",behavior_info:"on_new_create_flow_page",behavior_info_sub:3===e?"open":"close"}),3===e&&!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});![3].includes(e)||3!==e||this.isVipFun?[3].includes(e)&&this.isStudioMode&&this.isCompanyAccount||([3].includes(e)&&this.isOnlyVipLite?this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard"):![3].includes(e)||this.canUseUnlimitedQueue?(localStorage.setItem("speed_type",e),null==this||null===(t=this.easyTop)||void 0===t||t.updateSpeedType(e)):this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard")):this.$EventBus.$emit("showBreakDialog","UnlimitedQueueTipWeb","standard")},closeImageSizeOptionPopup:function(){try{var e;null===(e=this.$refs)||void 0===e||null===(e=e.ImageSizeOptionsPopup)||void 0===e||e.handleClose()}catch(e){}},resetData:function(){this.isLockSize=!1,this.lockSize={width:1,height:1,aspectRatio:1},this.showAspectRatio="1:1",this.currentImageSize=1},getSizeAspectRatio:function(){var e=this.isLockSize?this.lockSize.width:this.value.width,t=this.isLockSize?this.lockSize.height:this.value.height,n=(h.checkImageSizeList||[]).find((function(n){return n.width===e&&n.height===t}));this.showAspectRatio=n?null==n?void 0:n.showAspectRatio:Object(d.calculateAspectRatio)(e,t)},changeLockStatus:function(){this.lockSize.width=this.value.width,this.lockSize.height=this.value.height,this.isLockSize=!this.isLockSize},checkAutoActiveSizeMode:function(){var e,t;if(!(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel||5===this.currentImageSize&&null!==(t=this.value)&&void 0!==t&&t.isCustomSizeChange)){var n,o=this.value,l=o.width,r=o.height,c=(h.checkImageSizeList||[]).find((function(e){return e.width===l&&e.height===r}));if(this.isCustomSize)c=null===(n=this.easyTop)||void 0===n?void 0:n.imageDefaultSize.find((function(e){return e.width===l&&e.height===r}));this.currentImageSize=c?c.code:5}},checkNeedUpdateSize:function(){var e,t=this;if(null==this||null===(e=this.easyTop)||void 0===e||!e.isVideoModel){var n,o=this.value,l=o.width,r=o.height,c={width:l,height:r},d=(h.checkImageSizeList||[]).find((function(e){return e.width===l&&e.height===r}));if(this.isCustomSize)d=null===(n=this.easyTop)||void 0===n?void 0:n.imageDefaultSize.find((function(e){return e.width===l&&e.height===r}));if(this.currentImageSize=d?d.code:5,5!==this.currentImageSize){var v;if(null!==(v=this.easyTop)&&void 0!==v&&null!==(v=v.imageDefaultSize)&&void 0!==v&&v.length){var m,f=null===(m=this.easyTop)||void 0===m?void 0:m.imageDefaultSize.find((function(e){return e.code===t.currentImageSize}));f&&(c={width:f.width,height:f.height,isCustomSizeChange:!1})}else this.imageSizeOptions.forEach((function(e){if((null==e?void 0:e.code)===t.currentImageSize){var n="SD 3.5"===t.getCurrentModelType?"flux":t.getCurrentModelType;["IL","IL3"].includes(t.getModelType)&&(n=t.getModelType),["sd","sdxl","flux","HiDream","SeaDream","IL","IL3"].includes(n)&&(c=e[n].standard)}}));this.updateImageSize(c)}else{var _=this.convertStudioBaseSize(l,r,this.heightMaxMin,!0);null!=_&&_.isCustom&&(this.currentImageSize=5),this.updateImageSize({width:null==_?void 0:_.width,height:null==_?void 0:_.height})}}},convertStudioBaseSize:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(this.imageSizeOptions||[]).filter((function(e){return 5!==e.code})).map((function(e){return e.width=e.sd.standard.width,e.height=e.sd.standard.height,e})),r={},c=parseFloat((e/t).toFixed(2)),d=l.find((function(e){var t=parseFloat((e.width/e.height).toFixed(2));return c===t}));o&&(d=null);var m=n;if(d){var h=this.getCurrentModelType;["IL","IL3"].includes(this.getModelType)&&(h=this.getModelType),["sd","sdxl","flux","SeaDream","IL","IL3"].includes(h)&&(r=d[h].standard)}else{var f=Object(v.resizeToBaseDimension)(e,t,m.max);r.width=f.width,r.height=f.height,r.isCustom=!0}return r},handleSwitchAnimeEnhance:function(e,t){var n,o,l,r=this;if(this.$logEvent("log_actions",{operation:"click_anime_enhance",behavior_info:"on_new_createflow_page"}),(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isShowAnimeEnhance)&&((null==this||null===(o=this.value)||void 0===o||null===(o=o.imageToImageList)||void 0===o?void 0:o.length)||(null===(l=this.value)||void 0===l||null===(l=l.controlnet_units)||void 0===l?void 0:l.length))&&1===e)try{var c;null===(c=this.$refs)||void 0===c||null===(c=c.commonConfirmModal)||void 0===c||c.show({subTitle:"newGenerate1"}).then((function(){r.clearAnimeEnhanceParams(e,t)}))}catch(e){}else this.changeConfig(e,t)},clearAnimeEnhanceParams:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value));o.sampler_name="DPM++ 2M Karras",o.imageToImageList=[],o.controlnet_units=[],o.generate[t]=e,1===e&&(o.generate.gen_mode=0),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)},changeConfig:function(e,t){var n,o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!this.disableBasicMode||"gen_mode"!==t||0!==e){this.handleLogEvent(t,e),this.$EventBus.$emit("needCheckInputPackUp","paramsPanel");var r,c=JSON.parse(JSON.stringify(this.value));if("gen_mode"===t&&1===e&&!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});if(this.isVipFun||"gen_mode"!==t||1!==e)if(null===(n=this.easyTop)||void 0===n||!n.isVideoModel||this.canUseUnlimitedQueue||this.isCompanyAccount||"gen_mode"!==t||1!==e){if("gen_mode"!==t||1!==e||!this.isDisableGenModePanel){if("n_iter"===t&&this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),"n_video_iter"===t&&2===e&&"vip2"===l){if(!this.isLoggedIn)return void this.$EventBus.$emit("openLoginDialog");if(this.vipLevel<2)return this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"video_nums_popup",behavior_info_sub:"pop_2"}),void this.$EventBus.$emit("showBreakDialog","video_vip_tips_web","standard","SpecificPop_QualityWork",["standard","professional","master"])}t&&!["anime_enhance","prompt_magic_mode","gen_mode"].includes(t)?(c[t]=e,"n_iter"===t&&localStorage.setItem("imageNums",e)):(c.generate[t]=e,"anime_enhance"===t&&(c.sampler_name="DPM++ 2M Karras",1===e&&(c.generate.gen_mode=0))),null==this||null===(o=this.easyTop)||void 0===o||o.updateConfig(c,this.menuIndex)}}else this.$EventBus.$emit("showUpgradeDialog","video_vip_tips_web","standard","SpecificPop_QualityWork",["standard","professional","master"]);else null!=this&&null!==(r=this.easyTop)&&void 0!==r&&r.isKLModel?this.$EventBus.$emit("showBreakDialog","UpgradeQualityModel","standard","",["standard","professional","master"]):this.$EventBus.$emit("showBreakDialog","updateQualityTips","basic")}},changePixVerseConfig:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value)),l=(this.pixVerseGenerationList||[]).filter((function(e){return null==e?void 0:e.isVip})).map((function(e){return null==e?void 0:e.code}));if("quality_mode"!==t||!l.includes(e)||this.isLoggedIn){if((!this.isVipFun||this.isVipFun&&!this.canUseUnlimitedQueue)&&"quality_mode"===t&&l.includes(e))this.$EventBus.$emit("showBreakDialog","UpgradeQualityModel","standard","",["standard","professional","master"]);else if("quality_mode"!==t||!this.checkVideoGenerationModeStatus(e)){if(t&&!["motion_mode","quality_mode","style"].includes(t))o[t]=e;else try{"motion_mode"===t&&"fast"===e&&"1080p"===o.generate_video.quality_mode&&(o.generate_video.quality_mode="720p"),"motion_mode"===t&&"fast"===e&&(o.generate_video.generate_video_duration=5),o.generate_video[t]=e}catch(e){}null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)}}else this.$EventBus.$emit("openLoginDialog",{dot:!1})},handleQualityLogEvent:function(source,e){try{var t,n=(null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t?void 0:t.base_model_type)||"";if(!e||!n)return;this.$logEvent("log_actions",{operation:e,behavior_info:"on_new_create_flow_page",behavior_info_sub:n})}catch(e){}},handleLogEvent:function(e,t){var n,o,l,r="",c="";switch(e){case"gen_mode":var d;if(r="click_generate_model",c=1===t?"quality":"standard",null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isVideoModel)null==this||null===(d=this.easyTop)||void 0===d||d.handleVideoModelLogEvent("qualityMode",1===t?"click_quality_model_off":"click_quality_model_on");this.handleQualityLogEvent("qualityMode",1===t?"click_quality_model_off":"click_quality_model_on");break;case"prompt_magic_mode":r="click_prompt_magic";c={0:"auto",1:"open",2:"close"}[t]||"";break;case"click_image_setting":r="click_image_setting",c=t;break;case"n_iter":r="click_image_numbers",c=t;break;case"createSetting":var v;if(r="click_private_model",c=t,null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isVideoModel)null==this||null===(v=this.easyTop)||void 0===v||v.handleVideoModelLogEvent("privateMode","close"===t?"click_private_model_off":"click_private_model_on");this.handleQualityLogEvent("privateMode","close"===t?"click_private_model_off":"click_private_model_on")}if(r&&(!["gen_mode","createSetting"].includes(e)||null==this||null===(l=this.easyTop)||void 0===l||!l.isVideoModel)){var m={operation:r,behavior_info:"on_new_create_flow_page"};m.behavior_info_sub=c,this.$logEvent("log_actions",m)}},customSizeChange:function(e,t,n){if(this.isLockSize){var o=this.calculateDimensions(t,e),l=this.widthMaxMin.max,r=this.widthMaxMin.min;[null==o?void 0:o.width,null==o?void 0:o.height].every((function(e){return e>=r&&e<=l}))&&this.updateImageSize({width:null==o?void 0:o.width,height:null==o?void 0:o.height,isCustomSizeChange:!0})}else{var c,d=JSON.parse(JSON.stringify(this.value));d[t]=e,d.isCustomSizeChange=!0,null===(c=this.easyTop)||void 0===c||c.updateConfig(d,this.menuIndex)}},calculateDimensions:function(e,t){var n,o,l=this.lockSize.width,r=this.lockSize.height,c=this.widthMaxMin.max,d=this.widthMaxMin.min;return"width"===e?o=(n=t)/l*r:n=(o=t)/r*l,n>c?o=(n=c)/l*r:n<d&&(o=(n=d)/l*r),o>c?n=(o=c)/r*l:o<d&&(n=(o=d)/r*l),{width:Math.round(n),height:Math.round(o)}},handleCreateSettingSelectChange:function(e){return this.handleLogEvent("createSetting",[2,"2"].includes(e)?"open":"close"),this.isLoggedIn?[2,"2"].includes(e)&&!this.paymentInfo.show_auto_pub_switch?(this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic"),void(this.createSetting=1)):void(this.isLoggedIn&&this.saveSettings(e)):(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),void(this.createSetting=1))},saveSettings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.loading=!0;var n={};n.auto_pub_community=t,n.mode=1,Object(r.c)(n).then((function(n){var o=(n||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(e.$message.success(e.$t("SaveSuccess")),e.createSetting=t,e.loading=!1,e.getAccountInfo())})).finally((function(){e.loading=!1}))},handleUpdateSize:function(){var e,t,n,l,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$EventBus.$emit("needCheckInputPackUp","paramsPanel"),this.currentImageSize=r.code;var c=Object(o.a)(this.imageSizeOptionsMore).find((function(e){return(null==e?void 0:e.code)===(null==r?void 0:r.code)}));if(5===(null==r?void 0:r.code)&&(c={code:5,label:"newGenerate43",icon:"icon-icon-Custom",sd:{},sdxl:{},flux:{}}),this.isLockSize=!1,this.handleLogEvent("click_image_setting",5===(null===(e=c)||void 0===e?void 0:e.code)?"custom":null===(t=c)||void 0===t?void 0:t.label),5!==(null===(n=c)||void 0===n?void 0:n.code)){var d="SD 3.5"===this.getCurrentModelType?"flux":this.getCurrentModelType;if(["IL","IL3"].includes(this.getModelType)&&(d=this.getModelType),null!==(l=this.easyTop)&&void 0!==l&&null!==(l=l.imageDefaultSize)&&void 0!==l&&l.length){var v,m,h,f=[].concat(Object(o.a)(null===(v=this.easyTop)||void 0===v?void 0:v.imageDefaultSize),Object(o.a)(null===(m=this.easyTop)||void 0===m||null===(m=m.modelParams)||void 0===m||null===(m=m.resolution_param)||void 0===m?void 0:m.options)).find((function(e){return e.aspect_ratio===(null==r?void 0:r.label)}));!f||null!=r&&r.custom||this.updateImageSize({width:f.width,height:f.height,isCustomSizeChange:!0});var _=null===(h=this.easyTop)||void 0===h?void 0:h.imageDefaultSize.find((function(e){return e.aspect_ratio===(null==r?void 0:r.label)}));_&&(this.currentImageSize=_.code)}else["sd","sdxl","flux","HiDream","SeaDream","IL","IL3"].includes(d)&&this.updateImageSize(c[d].standard)}},updateImageSize:function(e){var t,n=e.width,o=e.height,l=e.isCustomSizeChange,r=void 0!==l&&l,c=JSON.parse(JSON.stringify(this.value));n&&(c.width=n||(null==c?void 0:c.width),c.height=o||(null==c?void 0:c.height)),o&&(c.height=o||(null==c?void 0:c.height)),c.isCustomSizeChange=r,null===(t=this.easyTop)||void 0===t||t.updateConfig(c,this.menuIndex)},handleExpand:function(){this.isExpand=!this.isExpand}})},$=L,D=(n(4286),n(0)),component=Object(D.a)($,(function(){var e,t,o,l,r,c,d,v,m,h,f,_,y,C,w=this,k=w._self._c;return k("div",{staticClass:"c-easy-generate-mode-panel"},["generateImage"===w.menuIndex?k("div",{staticClass:"c-easy-generate-mode-panel-title"},[k("span",{staticClass:"text"},[w._v(w._s(w.$t("BasicSettings")))]),w._v(" "),k("span",{class:[w.isExpand?"el-icon-caret-top":"el-icon-caret-bottom"],attrs:{"data-id":w.isExpand?"generate-mode-panel-title-expand-top":"generate-mode-panel-title-expand-bottom"},on:{click:w.handleExpand}})]):w._e(),w._v(" "),k("special-effects-app-panel",{directives:[{name:"show",rawName:"v-show",value:w.isShowSpecialEffects,expression:"isShowSpecialEffects"}],attrs:{value:w.value,menuIndex:w.menuIndex},on:{selectEffect:w.selectEffect,selectSample:w.selectSample}}),w._v(" "),w.showVideoUpload?k("video-upload",{directives:[{name:"show",rawName:"v-show",value:w.showVideoUploadContent,expression:"showVideoUploadContent"}],ref:"videoUpload",attrs:{isEndImg:w.showVideoUploadEndImg,value:w.value,menuIndex:w.menuIndex}}):w._e(),w._v(" "),w.showVideoUpload?k("div",{directives:[{name:"show",rawName:"v-show",value:w.showVideoUploadContent,expression:"showVideoUploadContent"}],staticClass:"generate-mode-panel-item"},[k("video-template-card",{on:{selectTemplate:w.selectTemplate}})],1):w._e(),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowVideoGenerateMode&&!w.isShowSpecialEffects,expression:"isShowVideoGenerateMode && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("mark-img-select",{staticClass:"generate-panel-item-mark-img",attrs:{list:w.renderPixVerseStyleList},on:{onChange:function(e){return w.changePixVerseConfig(e,"style")}},model:{value:w.value.generate_video.style,callback:function(e){w.$set(w.value.generate_video,"style",e)},expression:"value.generate_video.style"}})],1),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowVideoGenerateMode&&!w.isShowSpecialEffects,expression:"isShowVideoGenerateMode && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("newGenerate5")))]),w._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:null!==(e=w.easyTop)&&void 0!==e&&e.isVideoModel?w.$t("newGenerate108"):w.$t("newGenerate47"),placement:"top-start"}},[k("i",{staticClass:"custom-tips el-icon-warning"})])],1),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-rows"},w._l(w.pixVerseGenerationList,(function(e){var t;return k("div",{key:e.code,staticClass:"panel-item panel-item-video-content",class:[(null===(t=w.value)||void 0===t||null===(t=t.generate_video)||void 0===t?void 0:t.quality_mode)===e.code?"active-btn":"",w.checkVideoGenerationModeStatus(e.code)&&"panel-item-disable"],on:{click:function(t){return t.stopPropagation(),w.changePixVerseConfig(e.code,"quality_mode")}}},[k("span",{staticClass:"panel-item-title"},[w._v(w._s(w.$t(e.i18nKey)))]),w._v(" "),k("span",{staticClass:"panel-item-sub-title"},[w._v(w._s(e.subTitle))]),w._v(" "),!w.isCompanyAccount&&null!=e&&e.isVip?k("div",{staticClass:"panel-item-vip-icon"},[k("img",{attrs:{src:n(136),alt:"vip-icon"}})]):w._e()])})),0)]),w._v(" "),w.isExpand?[k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowGenerateMode&&!w.isShowSpecialEffects,expression:"isShowGenerateMode && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("newGenerate5")))]),w._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:null!==(t=w.easyTop)&&void 0!==t&&t.isVideoModel?w.$t("newGenerate108"):w.$t("newGenerate47"),placement:"top-start"}},[k("i",{staticClass:"custom-tips el-icon-warning"})])],1),w._v(" "),k("div",{staticClass:"panel-item-content"},[k("div",{staticClass:"panel-item",class:{"active-btn":0===(null===(o=w.value)||void 0===o||null===(o=o.generate)||void 0===o?void 0:o.gen_mode),"disabled-box":w.disableBasicMode},attrs:{"data-event":"generate-mode-basic"},on:{click:function(e){return e.stopPropagation(),w.changeConfig(0,"gen_mode")}}},[w._v("\n          "+w._s(w.$t("newGenerate44"))+"\n        ")]),w._v(" "),k("VideoExplainPopover",{key:"quality",staticClass:"mall-explain-popup margin-left-0",attrs:{type:"quality",isVideoModel:"generateVideo"===(null===(l=w.easyTop)||void 0===l?void 0:l.currentTab)}},[k("div",{staticClass:"panel-item",class:[1===(null===(r=w.value)||void 0===r||null===(r=r.generate)||void 0===r?void 0:r.gen_mode)?"active-btn":"",w.isDisableGenModePanel&&"panel-item-disable"],attrs:{slot:"reference","data-event":"generate-mode-advanced"},on:{click:function(e){return e.stopPropagation(),w.changeConfig(1,"gen_mode")}},slot:"reference"},[w.isCompanyAccount?w._e():k("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),w._v("\n            "+w._s(w.$t("newGenerate45"))+"\n          ")])])],1)]),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowPromptMagic&&!w.isShowSpecialEffects,expression:"isShowPromptMagic && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item",class:[(null===(c=w.easyTop)||void 0===c?void 0:c.isHunyuan)&&"generate-mode-panel-item-no-margin"]},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("studio28")))]),w._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:w.$t("studio45"),placement:"top-start"}},[k("i",{staticClass:"custom-tips el-icon-warning"})])],1),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-2"},[k("div",{staticClass:"panel-item",class:[2===(null===(d=w.value)||void 0===d||null===(d=d.generate)||void 0===d?void 0:d.prompt_magic_mode)?"active-btn":""],attrs:{"data-event":"generate-magic-mode-auto"},on:{click:function(e){return e.stopPropagation(),w.changeConfig(2,"prompt_magic_mode")}}},[w._v("\n          "+w._s(w.$t("studio41"))+"\n        ")]),w._v(" "),k("div",{staticClass:"panel-item",class:[1===(null===(v=w.value)||void 0===v||null===(v=v.generate)||void 0===v?void 0:v.prompt_magic_mode)?"active-btn":""],attrs:{"data-event":"generate-magic-mode-open"},on:{click:function(e){return e.stopPropagation(),w.changeConfig(1,"prompt_magic_mode")}}},[w._v("\n          "+w._s(w.$t("newGenerate18"))+"\n        ")]),w._v(" "),k("div",{staticClass:"panel-item",class:[0===(null===(m=w.value)||void 0===m||null===(m=m.generate)||void 0===m?void 0:m.prompt_magic_mode)?"active-btn":""],attrs:{"data-event":"generate-magic-mode-close"},on:{click:function(e){return e.stopPropagation(),w.changeConfig(0,"prompt_magic_mode")}}},[w._v("\n          "+w._s(w.$t("newGenerate17"))+"\n        ")])])]),w._v(" "),w.isShowImageSize?k("div",{directives:[{name:"show",rawName:"v-show",value:!w.isShowSpecialEffects,expression:"!isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"generate-mode-panel-item-title"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("newGenerate6")))])]),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowSizeText,expression:"isShowSizeText"}],staticClass:"current-size"},[w._v(w._s(w.value.width)+" x "+w._s(w.value.height))])]),w._v(" "),w.isRenderVideoSizeOptions?[k("div",{staticClass:"panel-item-content panel-item-content-flex-single"},w._l(w.renderVideoSizeOptions,(function(e){var t,n;return k("div",{key:e.code,staticClass:"panel-item",class:[(null===(t=w.value)||void 0===t?void 0:t.width)===e.width&&(null===(n=w.value)||void 0===n?void 0:n.height)===e.height?"active-btn":""],on:{click:function(t){return t.stopPropagation(),w.handleUpdateVideoSize(e)}}},[k("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),w._v(" "),k("span",{staticClass:"panel-item-label"},[w._v(w._s(e.label))])])})),0)]:[k("div",{staticClass:"panel-item-content panel-item-content-5 column-gap-4 panel-grid-5"},[w._l(w.imageDefaultSize,(function(e){return[5===e.code?[k("image-size-options-popup",{key:"ImageSizeOptionsPopup_".concat(e.code),ref:"ImageSizeOptionsPopup",refInFor:!0,attrs:{currentImageSize:w.currentImageSize,modelType:w.getModelType},on:{applySize:w.handleUpdateSize}},[k("div",{key:e.code,staticClass:"panel-item",class:["panel-item-custom",![1,2,3,4].includes(w.currentImageSize)&&"panel-item-active"]},[k("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),w._v(" "),k("span",{staticClass:"panel-item-label panel-item-label-overflow",attrs:{title:w.$t(null==e?void 0:e.label)}},[w._v(w._s(w.$t(null==e?void 0:e.label)))])])])]:[k("div",{key:e.code,staticClass:"panel-item",class:[5===e.code&&"panel-item-custom",e.code===w.currentImageSize&&"panel-item-active"],on:{click:function(t){return t.stopPropagation(),w.handleUpdateSize(e)}}},[k("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),w._v(" "),5===e.code?[k("span",{staticClass:"panel-item-label panel-item-label-overflow",attrs:{title:w.$t(null==e?void 0:e.label)}},[w._v(w._s(w.$t(null==e?void 0:e.label)))])]:k("span",{staticClass:"panel-item-label"},[w._v(w._s(e.label))])],2)]]}))],2),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:5===w.currentImageSize,expression:"currentImageSize === 5"}],staticClass:"custom-size-box"},[k("div",{staticClass:"custom-size-box-item"},[k("span",{staticClass:"custom-size-box-item-text-before"},[w._v("Width")]),w._v(" "),k("el-input-number",{key:"custom_width_input",staticClass:"easy-input-number custom-size-box-item-input-number",attrs:{value:w.value.width,controls:!1,min:w.widthMaxMin.min,max:w.widthMaxMin.max,step:1,disabled:5!==w.currentImageSize||w.isLockSize},on:{change:function(e){return w.customSizeChange(e,"width")}}}),w._v(" "),k("span",{staticClass:"custom-size-box-item-text-after"},[w._v("px")])],1),w._v(" "),k("div",{staticClass:"custom-size-box-item-lock",class:[w.isLockSize&&"active-btn"],on:{click:function(e){return e.stopPropagation(),w.changeLockStatus.apply(null,arguments)}}},[k("i",{staticClass:"iconfont",class:[w.isLockSize?"icon-collectLock":"icon-lock-open-variant-outline"]})]),w._v(" "),k("div",{staticClass:"custom-size-box-item"},[k("span",{staticClass:"custom-size-box-item-text-before"},[w._v("Height")]),w._v(" "),k("el-input-number",{key:"custom_height_input",staticClass:"easy-input-number custom-size-box-item-input-number",attrs:{value:w.value.height,controls:!1,min:w.heightMaxMin.min,max:w.heightMaxMin.max,step:1,disabled:5!==w.currentImageSize||w.isLockSize},on:{change:function(e){return w.customSizeChange(e,"height")}}}),w._v(" "),k("span",{staticClass:"custom-size-box-item-text-after"},[w._v("px")])],1)]),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:5===w.currentImageSize,expression:"currentImageSize === 5"}],staticClass:"custom-size-box"},[k("div",{staticClass:"custom-size-box-slider-item"},[k("el-slider",{staticClass:"easy-slider-item",attrs:{value:w.value.width,min:w.widthMaxMin.min,max:w.widthMaxMin.max,step:1,disabled:5!==w.currentImageSize,"show-tooltip":!1},on:{input:function(e){return w.customSizeChange(e,"width")}}})],1),w._v(" "),k("div",{staticClass:"custom-size-box-slider-item-ratio"},[w._v("\n            "+w._s(w.showAspectRatio)+"\n          ")]),w._v(" "),k("div",{staticClass:"custom-size-box-slider-item"},[k("el-slider",{staticClass:"easy-slider-item",attrs:{value:w.value.height,min:w.heightMaxMin.min,max:w.heightMaxMin.max,step:1,disabled:5!==w.currentImageSize,"show-tooltip":!1},on:{input:function(e){return w.customSizeChange(e,"height")}}})],1)])]],2):w._e(),w._v(" "),((null===(h=w.videoModelDurationConfig)||void 0===h?void 0:h.length)||0)>1?k("div",{directives:[{name:"show",rawName:"v-show",value:!w.isShowSpecialEffects,expression:"!isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("Duration")))])]),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-duration"},w._l(w.videoModelDurationConfig,(function(i){var e;return k("div",{key:"videoDuration_".concat(i.code),staticClass:"panel-item",class:{"active-btn":w.value.generate_video.generate_video_duration===i.code,"panel-item-disable":(null===(e=w.easyTop)||void 0===e?void 0:e.isFixedDuration)||w.checkVideoDurationStatus(i.code)},on:{click:function(e){return e.stopPropagation(),w.changeVideoConfig(i.code,"generate_video_duration")}}},[w._v("\n          "+w._s(i.label)+"\n        ")])})),0)]):w._e(),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowRelevance&&!w.isShowSpecialEffects,expression:"isShowRelevance && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("newGenerate123")))]),w._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:w.$t("newGenerate109"),placement:"top-start"}},[k("i",{staticClass:"custom-tips el-icon-warning"})])],1),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-2"},[k("slider-item",{attrs:{"hide-label":!0,value:w.value.generate_video.relevance,min:0,max:1,step:.1},on:{change:function(e){return w.changeVideoConfig(e,"relevance")}}})],1)]),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowImageNum&&!w.isShowSpecialEffects,expression:"isShowImageNum && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(null!==(f=w.easyTop)&&void 0!==f&&f.isVideoModel?w.$t("newGenerate124"):w.$t("QuantityOfImages")))])]),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-4"},w._l(w.imageNumLimit,(function(i){var e;return k("div",{key:"numberImages_".concat(i),staticClass:"panel-item",class:[(null===(e=w.value)||void 0===e?void 0:e.n_iter)===i?"active-btn":""],attrs:{"data-event":"generate_click_image_numbers","data-id":i},on:{click:function(e){return e.stopPropagation(),w.changeConfig(i,"n_iter")}}},[w._v("\n          "+w._s(i)+"\n        ")])})),0)]),w._v(" "),w.isShowFluency?k("div",{directives:[{name:"show",rawName:"v-show",value:!w.isShowSpecialEffects,expression:"!isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("pix_verse_6")))]),w._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:w.$t("pix_verse_5"),placement:"top-start"}},[k("i",{staticClass:"custom-tips el-icon-warning"})])],1),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-2"},w._l(w.renderFluency,(function(i){var e;return k("div",{key:"motion_mode_".concat(i.code),staticClass:"panel-item",class:[w.value.generate_video.motion_mode===i.code?"active-btn":"",(null===(e=w.easyTop)||void 0===e?void 0:e.isDisableSupportQuality)&&"panel-item-disable"],on:{click:function(e){return e.stopPropagation(),w.changePixVerseConfig(i.code,"motion_mode")}}},[w._v("\n          "+w._s(w.$t(i.label))+"\n        ")])})),0)]):w._e(),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowGenerateNum,expression:"isShowGenerateNum"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(null!==(_=w.easyTop)&&void 0!==_&&_.isVideoModel?w.$t("newGenerate124"):w.$t("QuantityOfImages")))])]),w._v(" "),k("div",{staticClass:"panel-item-content panel-item-content-4"},w._l(2,(function(i){var e;return k("div",{key:"numberImages_".concat(i),staticClass:"panel-item",class:[(null===(e=w.value)||void 0===e?void 0:e.n_video_iter)===i?"active-btn":""],on:{click:function(e){return e.stopPropagation(),w.changeConfig(i,"n_video_iter","vip2")}}},[2===i?k("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:""}}):w._e(),w._v("\n          "+w._s(i)+"\n        ")])})),0)]),w._v(" "),w.shouldShowPrivateCreation?k("div",{staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label panel-item-label-flex"},[k("VideoExplainPopover",{key:"private",staticClass:"explain-hover-reference",attrs:{type:"private",placement:"top-start",isVideoModel:"generateVideo"===(null===(y=w.easyTop)||void 0===y?void 0:y.currentTab)}},[k("div",{staticClass:"panel-item-label-box",attrs:{slot:"reference"},slot:"reference"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("newGenerate12")))]),w._v(" "),w.isCompanyAccount?w._e():k("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),w._v(" "),k("span",{staticClass:"icon-tips-videx"},[k("i",{staticClass:"el-icon-warning"})])])]),w._v(" "),k("el-switch",{attrs:{"active-color":"#3F8CFF","active-value":2,"inactive-value":1},on:{change:w.handleCreateSettingSelectChange},model:{value:w.createSetting,callback:function(e){w.createSetting=e},expression:"createSetting"}})],1)]):w._e(),w._v(" "),k("div",{directives:[{name:"show",rawName:"v-show",value:w.isShowFree&&!w.isShowSpecialEffects,expression:"isShowFree && !isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[k("div",{staticClass:"panel-item-label panel-item-label-flex"},[k("VideoExplainPopover",{key:"free",staticClass:"explain-hover-reference",attrs:{type:"free",placement:"top-start",isVideoModel:"generateVideo"===(null===(C=w.easyTop)||void 0===C?void 0:C.currentTab)}},[k("div",{staticClass:"panel-item-label-box",attrs:{slot:"reference"},slot:"reference"},[k("span",{staticClass:"generate-mode-panel-label-text"},[w._v(w._s(w.$t("daily_rights_2")))]),w._v(" "),w.isCompanyAccount?w._e():k("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),w._v(" "),k("span",{staticClass:"icon-tips-videx"},[k("i",{staticClass:"el-icon-warning"})])])]),w._v(" "),k("el-switch",{attrs:{"active-color":"#3F8CFF",value:w.value.speed_type,"active-value":3,"inactive-value":w.queueRenderList[0].code},on:{change:function(e){return w.handleQueueSelectChange(e)}}})],1)])]:w._e(),w._v(" "),k("common-confirm-modal",{ref:"commonConfirmModal"})],2)}),[],!1,null,"ca3ed80a",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},1168:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(12),n(13),n(7);var o=n(14),l=n(2),r=(n(19),n(6),n(32),n(16),n(22),n(8),n(4),n(21),n(85)),c=n(1),d=n(137),v=n(561),m=n(562),h=n(57),f=n(33),_=n(271);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={name:"EasyAdvanceSettingPanel",props:["value","menuIndex"],inject:["easyTop"],data:function(){return{createSetting:1,loading:!1,cardConfigList:[{code:"vae",i18nKey:"VAE",tips:"vaeTips"},{code:"clip_skip",i18nKey:"clipSkip",tips:"clipSkipTips"},{code:"mode",i18nKey:"newGenerate7",tips:"",mapOptions:[{code:0,label:"默认",i18nKey:"createModeType1",tips:""},{code:1,label:"海艺V6",i18nKey:"createModeType2",tips:"createModeTips2",isVip:!0},{code:2,label:"海艺2.1",i18nKey:"createModeType6",tips:"createModeTips6",isVip:!0}]}],repairConfigList:[{code:"hr_upscaler",i18nKey:"taskTabUpscale",mapOptions:this.renderList,tips:""},{code:"hr_second_pass_steps",i18nKey:"UpscaleSamplingTimes",tips:""},{code:"hr_upscaler_redraw",i18nKey:"RedrawNoiseIntensity",tips:""},{code:"ad_model",i18nKey:"characterRepair",tips:"",mapOptions:[{code:"",i18nKey:"none"},{code:"face",i18nKey:"repairType1"},{code:"hand",i18nKey:"repairType2"},{code:"body",i18nKey:"repairType3"}]},{code:"ad_units.lora",i18nKey:"LoRA",tips:""},{code:"ad_units.ad_denoising_strength",i18nKey:"redrawingNoiseIntensity",tips:""},{code:"ad_units.ad_confidence",i18nKey:"Confidence",tips:""},{code:"ad_units.prompt",i18nKey:"Prompt",tips:""},{code:"ad_units.negative_prompt",i18nKey:"NegativePrompts",tips:""},{code:"restore_faces",i18nKey:"RestoreFaces",tips:""}],isCollapse:!0,CAMERA_CONTROL_OPTIONS:f.CAMERA_CONTROL_OPTIONS}},components:{SliderItem:d.default,EasyAdvanceRepairModal:v.default,EasyModeModal:m.default},computed:C(C(C(C({},Object(c.c)("payment",["paymentInfo"])),Object(c.c)("user",["accountSettingsData","isCompanyAccount","isLoggedIn"])),Object(c.c)("creation",["taskSamplerMethods","taskVae","sd_xl_sampler_name","lab_scheduler","lab_sampler_name","hr_upscaler","flux_sampler_name","combined_sampler_name","video_config"])),{},{isShowNegativePrompts:function(){var e,t,n,o,l,r,c,d,v=!this.isCollapse;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(c=this.easyTop)||void 0===c||null===(c=c.currentVideoModelConfig)||void 0===c||null===(c=c.high_quality_setting)||void 0===c?void 0:c.enable_negative_prompts)&&v;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return Object(_.getSceneConfig)("advanced_negative_prompts",(null===(d=this.easyTop)||void 0===d?void 0:d.currentImageModelConfig)||{});var m=!(null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isHiDreamModel),h=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isSeaArtFilmModel);return v&&!(null!==(l=this.easyTop)&&void 0!==l&&l.isCommunityFlux)&&!(null!==(r=this.easyTop)&&void 0!==r&&r.isSd35Model)&&m&&h},getRenderVideoConfig:function(){var e,t,n=(null==this||null===(e=this.video_config)||void 0===e?void 0:e.camera_control_mode_items)||[];if(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&t.isKL15Model){var o=["Camera Movement","Horizontal","Vertical","Zoom","Pan","Titt","Roll"];n=n.filter((function(e){return o.includes(e.mode)}))}return n.map((function(e){return{code:e.mode,name:e.mode,preview:e.example_url||"",showOffSet:null==e?void 0:e.has_offset_opt}}))},renderHunyuanSampler:function(){var e;return(null==this||null===(e=this.video_config)||void 0===e?void 0:e.sampler_name)||[]},renderHunyuanScheduler:function(){var e;return(null==this||null===(e=this.video_config)||void 0===e?void 0:e.scheduler)||[]},cameraControlPreview:function(){var e,t=this;return(null===(e=(this.getRenderVideoConfig||[]).find((function(e){return e.code===t.value.generate_video.camera_control_option.mode})))||void 0===e?void 0:e.preview)||""},isShowCollector:function(){var e;return[null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isHunyuan].some(Boolean)},isHunyuan:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isHunyuan},isShowCameraControl:function(){var e,t,n=!this.isCollapse,o=0===this.value.generate.gen_mode&&this.value.currentVideoInputToolTab===f.VIDEO_CREATION_MODE.TXT_TO_VIDEO,l=5===this.value.generate_video.generate_video_duration,r=0!==this.value.generate.gen_mode&&this.value.currentVideoInputToolTab===f.VIDEO_CREATION_MODE.IMG_TO_VIDEO;return null!==(e=this.easyTop)&&void 0!==e&&e.isKL10Model?n&&o&&l:null!==(t=this.easyTop)&&void 0!==t&&t.isKL15Model?n&&r&&l:void 0},isShowCameraControlOffset:function(){var e=this,t=(this.getRenderVideoConfig||[]).find((function(t){var n;return(null==t?void 0:t.code)===(null===(n=e.value)||void 0===n||null===(n=n.generate_video)||void 0===n||null===(n=n.camera_control_option)||void 0===n?void 0:n.mode)}));return!!t&&(null==t?void 0:t.showOffSet)},isShowSampler:function(){var e,t,n,o,l,r,c,d=!this.isCollapse;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(r=this.easyTop)||void 0===r||null===(r=r.currentVideoModelConfig)||void 0===r||null===(r=r.high_quality_setting)||void 0===r?void 0:r.enable_sampler)&&d;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return Object(_.getSceneConfig)("advanced_sampler_name",(null===(c=this.easyTop)||void 0===c?void 0:c.currentImageModelConfig)||{});var v=!(null!==(n=this.easyTop)&&void 0!==n&&n.isSd35Model),m=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isHiDreamModel),h=!(null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isSeaArtFilmModel);return d&&v&&m&&h},isShowCFGScale:function(){var e,t,n,o,l,r,c=!this.isCollapse;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(l=this.easyTop)||void 0===l||null===(l=l.currentVideoModelConfig)||void 0===l||null===(l=l.high_quality_setting)||void 0===l?void 0:l.enable_cfg_scale)&&c;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return Object(_.getSceneConfig)("advanced_cfg_scale",(null===(r=this.easyTop)||void 0===r?void 0:r.currentImageModelConfig)||{});var d=!(null!==(n=this.easyTop)&&void 0!==n&&n.isSd35Model),v=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isHiDreamModel);return c&&d&&v},isShowCard:function(){var e,t,n,o,l,r,c=!this.isCollapse;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(r=this.easyTop)||void 0===r||null===(r=r.currentVideoModelConfig)||void 0===r||null===(r=r.high_quality_setting)||void 0===r?void 0:r.enable_vae)&&c;var d=!(null!==(t=this.easyTop)&&void 0!==t&&t.isSd35Model||null!==(n=this.easyTop)&&void 0!==n&&n.isCommunityFlux),v=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isHiDreamModel),m=!(null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isSeaArtFilmModel);return c&&d&&v&&m},isShowSeed:function(){var e,t,n,o;return null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel?(null===(n=this.easyTop)||void 0===n||null===(n=n.currentVideoModelConfig)||void 0===n||null===(n=n.high_quality_setting)||void 0===n?void 0:n.enable_lock_seed)&&!this.isCollapse:null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig?Object(_.getSceneConfig)("advanced_seed_option",(null===(o=this.easyTop)||void 0===o?void 0:o.currentImageModelConfig)||{})&&!this.isCollapse:!this.isCollapse},showImgSeed:function(){return this.value.seedTemp&&this.value.seed!==this.value.seedTemp},isVipFun:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},isOnlyVipLite:function(){var e,t;return!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState)&&!this.isCompanyAccount&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},canUseUnlimitedQueue:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.infiniteQueue},queueRenderList:function(){return[{code:1,i18nKey:"NormalQueue",tips:"",show:!this.isVipFun},{code:2,i18nKey:"SubsBottomTerms2",tips:"",isVip:!0,show:this.isVipFun},{code:3,i18nKey:"UnlimitedQueue",tips:this.UnlimitedQueueTip,isVip:!0,show:!0}].filter((function(e){return e.show}))},UnlimitedQueueTip:function(){return this.isCompanyAccount?"ToBUnlimitedQueueTip":"UnlimitedQueueTip"},isShowUpscale:function(){var e,t,n,o=!(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux),l=null==this||null===(t=this.easyTop)||void 0===t?void 0:t.hasEnableImageToImage,r=null==this||null===(n=this.easyTop)||void 0===n?void 0:n.hasEnableControlNetToImage;return o&&(!l&&!r)},isShowAdvancedRepair:function(){var e,t,n,o,l,r,c,d,v,m,h,f,y,C,w;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(f=this.easyTop)||void 0===f||null===(f=f.currentVideoModelConfig)||void 0===f||null===(f=f.high_quality_setting)||void 0===f?void 0:f.enable_hr_upscaler)&&!this.isCollapse;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return[Object(_.getSceneConfig)("advanced_enable_hd_repair",(null===(y=this.easyTop)||void 0===y?void 0:y.currentImageModelConfig)||{}),Object(_.getSceneConfig)("advanced_enable_face_repair",(null===(C=this.easyTop)||void 0===C?void 0:C.currentImageModelConfig)||{}),Object(_.getSceneConfig)("advanced_enable_character_repair",(null===(w=this.easyTop)||void 0===w?void 0:w.currentImageModelConfig)||{})].some(Boolean);var k=!(this.isCollapse||null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isCommunityFlux||null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isAnimeEnhanceEnable||null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isSd35Model),I=!(null!==(r=this.value)&&void 0!==r&&null!==(r=r.controlnet_units)&&void 0!==r&&r.length&&(null===(c=this.value)||void 0===c||null===(c=c.imageToImageList)||void 0===c||!c.length)&&(null==this||null===(d=this.easyTop)||void 0===d||!d.isCommunityFlux)&&(null==this||null===(v=this.easyTop)||void 0===v||!v.isAnimeEnhanceEnable)),x=!(null!=this&&null!==(m=this.easyTop)&&void 0!==m&&m.isHiDreamModel),T=!(null!=this&&null!==(h=this.easyTop)&&void 0!==h&&h.isSeaArtFilmModel);return k&&I&&x&&T},schedulerDisabled:function(){return!1},isShowEngineMode:function(){var e,t,n,o,l,r=(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentConfigInfo)||{},c=null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isSdModel,d=null==r||null===(n=r.imageToImageList)||void 0===n?void 0:n.length,v=null==r||null===(o=r.controlnet_units)||void 0===o?void 0:o.length,m=this.isOpenUpscale,h=null==this||null===(l=this.easyTop)||void 0===l?void 0:l.isEnableQuality;return c&&[!d,!v,!m,!h].every((function(e){return e}))},renderCardConfigList:function(){var e,t,n=this,o=["vae","clip_skip","mode"];if(null!==(e=this.easyTop)&&void 0!==e&&e.isAnimeEnhanceEnable)return this.cardConfigList.filter((function(e){return!o.includes(null==e?void 0:e.code)}));if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig){var map={vae:"advanced_vae",clip_skip:"advanced_clip_skip",mode:"advanced_enable_engine_option"};return o=o.filter((function(e){var t;return Object(_.getSceneConfig)(map[e],(null===(t=n.easyTop)||void 0===t?void 0:t.currentImageModelConfig)||{})})),this.cardConfigList.filter((function(e){return o.includes(null==e?void 0:e.code)}))}return this.isShowEngineMode?this.cardConfigList:(o=["mode"],this.cardConfigList.filter((function(e){return!o.includes(null==e?void 0:e.code)})))},renderStepsOptions:function(){var e,t,n,o,l,r,c,d={min:10,max:40};return null!=this&&null!==(e=this.value)&&void 0!==e&&e.lcm_mode&&(d.min=4,d.max=8),null===(t=this.easyTop)||void 0===t||!t.isSDXLModel||null!=this&&null!==(n=this.value)&&void 0!==n&&n.lcm_mode||(d.min=20),null!==(o=this.easyTop)&&void 0!==o&&o.isAnimeEnhanceEnable&&(d.min=25,d.max=50),null!==(l=this.easyTop)&&void 0!==l&&l.isCommunityFlux&&(d.min=4,d.max=60),null!==(r=this.easyTop)&&void 0!==r&&r.isSd35Model&&(d.min=6,d.max=25),null!==(c=this.easyTop)&&void 0!==c&&c.isNoobai&&(d.min=20,d.max=40),d},renderCFGScale:function(){var e,t,n,o,l,r={min:3,max:15};return null!=this&&null!==(e=this.value)&&void 0!==e&&e.lcm_mode&&(r.min=1,r.max=3),null!==(t=this.easyTop)&&void 0!==t&&t.isAnimeEnhanceEnable&&(r.min=2,r.max=15),null!==(n=this.easyTop)&&void 0!==n&&n.isSeaArtFilmModel&&(r.min=1,r.max=10),null!==(o=this.easyTop)&&void 0!==o&&o.isSDXLModel&&(r.min=1,r.max=15),null!==(l=this.easyTop)&&void 0!==l&&l.isNoobai&&(r.min=3.5,r.max=15),r},getCharacterRepairName:function(){var e=this,t=[{code:"",i18nKey:"none"},{code:"face",i18nKey:"repairType1"},{code:"hand",i18nKey:"repairType2"},{code:"body",i18nKey:"repairType3"}].find((function(t){return t.code===e.value.ad_model}));return t?this.$t(null==t?void 0:t.i18nKey):""},seedOptions:function(){var e,t,n,o,l={max:4294967294};return(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux||null!=this&&null!==(t=this.easyTop)&&void 0!==t&&t.isTongYiFast||null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isTongYiProfessional||null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isPixVerse)&&(l.max=2147483643),l},isOpenUpscale:function(){return""!==this.value.hr_upscaler},isOpenCharacterRepair:function(){return""!==this.value.ad_model},selectLora:function(){var e;return(null===(e=this.value.ad_units)||void 0===e?void 0:e.lora)||{}},isShowLora:function(){var e;return null===(e=Object.keys(this.selectLora))||void 0===e?void 0:e.length},renderList:function(){var e=(this.hr_upscaler||[]).map((function(e){return{label:e,code:e}}));return[{code:"",label:this.$t("none")}].concat(Object(o.a)(e))},getCardRenderInfo:function(){var e=this;return function(){var t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mapOptions,o=(void 0===n?[]:n).find((function(e){return e.code===t}));return o?e.$t(null==o?void 0:o.i18nKey):t}},isCurrentImageNum:function(){return function(i){return this.value.n_iter===i}},renderTaskSamplerMethods:function(){var e;return"FLUX"===(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentModelType)?this.flux_sampler_name:this.combined_sampler_name},isShowSteps:function(){var e,t,n,o,l,r,c=!this.isCollapse;if(null!==(e=this.easyTop)&&void 0!==e&&e.isVideoModel)return(null===(l=this.easyTop)||void 0===l||null===(l=l.currentVideoModelConfig)||void 0===l||null===(l=l.high_quality_setting)||void 0===l?void 0:l.enable_steps)&&c;if(null!==(t=this.easyTop)&&void 0!==t&&t.isEnableModelQuickConfig)return Object(_.getSceneConfig)("advanced_steps",(null===(r=this.easyTop)||void 0===r?void 0:r.currentImageModelConfig)||{});var d=!(null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isHiDreamModel),v=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isSeaArtFilmModel);return c&&d&&v}}),watch:{accountSettingsData:{handler:function(){this.createSetting=this.accountSettingsData.is_auto_pub_community?1:2},immediate:!0,deep:!0},isShowEngineMode:{handler:function(e){if(!e)try{var t,n=JSON.parse(JSON.stringify(this.value));n.generate.mode=0,null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig(n,this.menuIndex)}catch(e){}},immediate:!0}},methods:C(C({},Object(c.b)("user",["getAccountInfo"])),{},{changeVideoConfig:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value));"mode"===t&&(o.generate_video.camera_control_option.mode=e),"offset"===t&&(o.generate_video.camera_control_option.offset=e),"generate_video_duration"===t&&(o.generate_video.generate_video_duration=e),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)},useSeed:function(e){var t,n=["",null,void 0,-1].includes(e)?-1:e,o=JSON.parse(JSON.stringify(this.value));o.seed=n,o.lockSeed||(o.lockSeed=!0),null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig(o,this.menuIndex)},handleQueueSelectChange:function(e){var t;if(this.$logEvent("log_actions",{operation:"click_free_create",behavior_info:"on_new_create_flow_page",behavior_info_sub:3===e?"open":"close"}),3===e&&!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});![3].includes(e)||3!==e||this.isVipFun?[3].includes(e)&&this.isStudioMode&&this.isCompanyAccount||([3].includes(e)&&this.isOnlyVipLite?this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard"):![3].includes(e)||this.canUseUnlimitedQueue?(localStorage.setItem("speed_type",e),null==this||null===(t=this.easyTop)||void 0===t||t.updateSpeedType(e)):this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard")):this.$EventBus.$emit("showBreakDialog","UnlimitedQueueTipWeb","standard")},toggleFoldStatus:function(){this.isCollapse=!this.isCollapse,this.$logEvent("log_actions",{operation:"click_advanced_config",behavior_info:"on_new_create_flow_page",behavior_info_sub:this.isCollapse?"open":"close"})},changeConfig:function(e,t){var n,o,l,r,c;this.$EventBus.$emit("needCheckInputPackUp","paramsPanel"),"enableNegativePrompts"===t&&(this.$logEvent("log_actions",{operation:"click_negative_prompt",behavior_info:"on_new_create_flow_page",behavior_info_sub:e?"open":"close"}),this.$EventBus.$emit("resetInputPackUpStatus"));var d=JSON.parse(JSON.stringify(this.value)),v=(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isCommunityFlux)||(null==this||null===(o=this.easyTop)||void 0===o?void 0:o.isTongYiFast)||(null==this||null===(l=this.easyTop)||void 0===l?void 0:l.isTongYiProfessional)||(null==this||null===(r=this.easyTop)||void 0===r?void 0:r.isPixVerse);t&&("sampler_name"!==t&&(d[t]=e),"lockSeed"===t&&(this.$logEvent("log_actions",{operation:"click_fixed_seed",behavior_info:"on_new_create_flow_page",behavior_info_sub:e?"open":"close"}),d.seed=e?Object(h.getRandomSeed)(v):-1),"sampler_name"===t&&(d=this.handleLCMConfig(d,e))),null==this||null===(c=this.easyTop)||void 0===c||c.updateConfig(d,this.menuIndex)},handleLCMConfig:function(e,t){var n,o=null===(n=this.easyTop)||void 0===n?void 0:n.isSDXLModel,l=20,r=7;return"LCM"===t?(l=o?8:4,r=o?2:1.5,e.steps=l,e.cfg_scale=r,e.sampler_name="LCM",e.lcm_mode=1,e):("LCM"===(null==e?void 0:e.sampler_name)&&"LCM"!==t?(e.steps=l,e.cfg_scale=r,e.sampler_name=t,e.lcm_mode=0):(e.sampler_name=t,e.lcm_mode=0),e)},handleUpdateConfig:function(e){var t,n=JSON.parse(JSON.stringify(this.value));e&&e.hasOwnProperty("mode")&&(n.generate.mode=(null==e?void 0:e.mode)||0,delete e.mode),n=C(C({},n),e),null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig(n,this.menuIndex)},handleCreateSettingSelectChange:function(e){if([2,"2"].includes(e)&&!this.paymentInfo.show_auto_pub_switch)return this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic"),void(this.createSetting=1);this.saveSettings(e)},saveSettings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.loading=!0;var n={};n.auto_pub_community=t,n.mode=1,Object(r.c)(n).then((function(n){var o=(n||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(e.$message.success(e.$t("SaveSuccess")),e.createSetting=t,e.loading=!1,e.getAccountInfo())})).finally((function(){e.loading=!1}))},openRepairModal:function(){this.$refs.repairModal.show()},openModeModal:function(){this.$refs.modeModal.show()}})},k=w,I=(n(4289),n(4290),n(0)),component=Object(I.a)(k,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k=this,I=k._self._c;return I("div",{staticClass:"c-easy-advance-setting-panel",style:{"padding-bottom":k.isShowSeed||k.isCollapse?"0px":"var(--base-font-size)"}},[I("div",{staticClass:"additional-panel-title additional-panel-title-height",on:{click:function(e){return e.stopPropagation(),k.toggleFoldStatus()}}},[I("span",{staticClass:"additional-panel-title-text"},[k._v(k._s(k.$t("AdvancedConfig")))]),k._v(" "),I("span",{staticClass:"additional-panel-title-icon",class:[k.isCollapse?"el-icon-caret-bottom":"el-icon-caret-top"]})]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowSampler,expression:"isShowSampler"}],staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("SamplingMethod")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.schedulerDisabled?k.$t("studio44"):k.$t("WhichATUTPTI"),placement:"top-start"}},[I("i",{staticClass:"custom-tips",class:[k.schedulerDisabled?"iconfont icon-warn ":"el-icon-warning"]})])],1),k._v(" "),I("div",{staticClass:"panel-item-content"},[I("el-select",{staticClass:"easy-custom-select",attrs:{value:k.value.sampler_name,"popper-append-to-body":!0,disabled:k.schedulerDisabled,"popper-class":"custom-select"},on:{change:function(e){return k.changeConfig(e,"sampler_name")}}},k._l(k.renderTaskSamplerMethods,(function(e,i){return I("el-option",{key:"method_"+i,attrs:{label:e,value:e}},[I("el-tooltip",{attrs:{content:e,placement:"left"}},[I("span",[k._v(k._s(e))])])],1)})),1)],1)]),k._v(" "),k.isShowCollector&&!k.isCollapse?I("div",{staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("studio21")))])]),k._v(" "),I("div",{staticClass:"panel-item-content panel-item-content-2"},[I("el-select",{staticClass:"easy-custom-select",attrs:{value:k.value.sampler_name,"popper-append-to-body":!0,"popper-class":"custom-select"},on:{change:function(e){return k.changeConfig(e,"sampler_name")}}},k._l(k.renderHunyuanSampler,(function(e,i){return I("el-option",{key:"method_"+i,attrs:{label:e,value:e}})})),1)],1)]):k._e(),k._v(" "),k.isHunyuan&&!k.isCollapse?I("div",{staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("studio20")))])]),k._v(" "),I("div",{staticClass:"panel-item-content panel-item-content-2"},[I("el-select",{staticClass:"easy-custom-select",attrs:{value:k.value.scheduler,"popper-append-to-body":!0,"popper-class":"custom-select"},on:{change:function(e){return k.changeConfig(e,"scheduler")}}},k._l(k.renderHunyuanScheduler,(function(e,i){return I("el-option",{key:"method_"+i,attrs:{label:e,value:e}})})),1)],1)]):k._e(),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowSteps,expression:"isShowSteps"}],staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("SamplingSteps")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.$t("HowMTTITGII"),placement:"top-start"}},[I("i",{staticClass:"custom-tips el-icon-warning"})])],1),k._v(" "),I("div",{staticClass:"panel-item-content panel-item-content-2"},[I("slider-item",{attrs:{"hide-label":!0,value:k.value.steps,min:k.renderStepsOptions.min,max:k.renderStepsOptions.max,label:"Strength"},on:{change:function(e){return k.changeConfig(e,"steps")}}})],1)]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowCFGScale,expression:"isShowCFGScale"}],staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("CFGScale")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.$t("newGenerate49"),placement:"top-start"}},[I("i",{staticClass:"custom-tips el-icon-warning"})])],1),k._v(" "),I("div",{staticClass:"panel-item-content panel-item-content-2"},[I("slider-item",{attrs:{"hide-label":!0,value:k.value.cfg_scale,min:k.renderCFGScale.min,max:k.renderCFGScale.max,step:.5,precision:1},on:{change:function(e){return k.changeConfig(e,"cfg_scale")}}})],1)]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:(null===(e=k.renderCardConfigList)||void 0===e?void 0:e.length)&&k.isShowCard,expression:"renderCardConfigList?.length && isShowCard"}],staticClass:"panel-item-card",on:{click:k.openModeModal}},[I("div",{staticClass:"panel-item-content-card"},k._l(k.renderCardConfigList,(function(e){var t;return I("div",{key:e.code,staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t(e.i18nKey)))]),k._v(" "),I("div",{staticClass:"card-item-value"},[e.mapOptions&&e.mapOptions.length?[k._v("\n            "+k._s(k.getCardRenderInfo(e,"mode"===e.code?null===(t=k.value)||void 0===t||null===(t=t.generate)||void 0===t?void 0:t.mode:k.value[e.code]))+"\n          ")]:[k._v(k._s(k.value[e.code]||""))]],2)])})),0)]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowAdvancedRepair,expression:"isShowAdvancedRepair"}],staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("AdvancedRepair")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.$t("ClassifierFGSHSTI"),placement:"top-start"}},[I("i",{staticClass:"custom-tips el-icon-warning"})])],1),k._v(" "),I("div",{staticClass:"panel-item-card",on:{click:k.openRepairModal}},[I("div",{staticClass:"panel-item-content-card"},[I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowUpscale,expression:"isShowUpscale"}],staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("taskTabUpscale")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k.isOpenUpscale?[k._v("\n              "+k._s(k.value.hr_upscaler)+"\n            ")]:[k._v(k._s(k.$t("none")))]],2)]),k._v(" "),I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("RestoreFaces")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v("\n            "+k._s(k.value.restore_faces?k.$t("newGenerate18"):k.$t("newGenerate17"))+"\n          ")])]),k._v(" "),I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("characterRepair")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k.isOpenCharacterRepair?[k._v("\n              "+k._s(k.getCharacterRepairName)+"\n            ")]:[k._v(k._s(k.$t("newGenerate17")))]],2)]),k._v(" "),k.isOpenCharacterRepair?[k.isShowLora?I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("LoRA")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v(k._s(null===(t=k.selectLora)||void 0===t?void 0:t.name)+":"+k._s(null===(n=k.selectLora)||void 0===n?void 0:n.version_name))])]):k._e(),k._v(" "),I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("redrawingNoiseIntensity")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v("\n              "+k._s(null===(o=k.value)||void 0===o||null===(o=o.ad_units)||void 0===o?void 0:o.ad_denoising_strength)+"\n            ")])]),k._v(" "),I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("Confidence")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v("\n              "+k._s(null===(l=k.value)||void 0===l||null===(l=l.ad_units)||void 0===l?void 0:l.ad_confidence)+"\n            ")])]),k._v(" "),null!==(r=k.value)&&void 0!==r&&null!==(r=r.ad_units)&&void 0!==r&&r.prompt?I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("Prompt")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v("\n              "+k._s(null===(c=k.value)||void 0===c||null===(c=c.ad_units)||void 0===c?void 0:c.prompt)+"\n            ")])]):k._e(),k._v(" "),null!==(d=k.value)&&void 0!==d&&null!==(d=d.ad_units)&&void 0!==d&&d.negative_prompt?I("div",{staticClass:"panel-item-content-card-item"},[I("div",{staticClass:"card-item-label"},[k._v(k._s(k.$t("NegativePrompts")))]),k._v(" "),I("div",{staticClass:"card-item-value"},[k._v("\n              "+k._s(null===(v=k.value)||void 0===v||null===(v=v.ad_units)||void 0===v?void 0:v.negative_prompt)+"\n            ")])]):k._e()]:k._e()],2)])]),k._v(" "),k.isShowCameraControl?I("div",{staticClass:"advance-setting-panel-item"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("newGenerate118")))])]),k._v(" "),I("div",{staticClass:"panel-item-content"},[I("el-select",{staticClass:"easy-custom-select",attrs:{value:k.value.generate_video.camera_control_option.mode,"popper-append-to-body":!0,"popper-class":"custom-select"},on:{change:function(e){return k.changeVideoConfig(e,"mode")}}},k._l(k.getRenderVideoConfig,(function(e,i){return I("el-option",{key:"method_"+i,attrs:{label:e.name,value:e.code}})})),1)],1),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.cameraControlPreview,expression:"cameraControlPreview"}],staticClass:"camera-control-preview"},[I("img",{attrs:{src:k.cameraControlPreview,alt:"camera-control-preview"}})]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowCameraControlOffset,expression:"isShowCameraControlOffset"}],staticClass:"panel-item-content"},[I("slider-item",{attrs:{"hide-label":!0,value:k.value.generate_video.camera_control_option.offset,min:-10,max:10,step:.1},on:{change:function(e){return k.changeVideoConfig(e,"offset")}}})],1)]):k._e(),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowNegativePrompts,expression:"isShowNegativePrompts"}],staticClass:"advance-setting-panel-item advance-setting-panel-item-flex"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("NegativePrompts")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.$t("newGenerate53"),placement:"top-start"}},[I("i",{staticClass:"custom-tips el-icon-warning"})])],1),k._v(" "),I("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:function(e){return k.changeConfig(e,"enableNegativePrompts")}},model:{value:k.value.enableNegativePrompts,callback:function(e){k.$set(k.value,"enableNegativePrompts",e)},expression:"value.enableNegativePrompts"}})],1),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:!k.isCollapse&&k.isShowNegativePrompts&&(null===(m=k.easyTop)||void 0===m?void 0:m.isVideoModel)&&"effect"!==(null===(h=k.value)||void 0===h?void 0:h.currentVideoTab)&&!(null!==(f=k.easyTop)&&void 0!==f&&f.isStudioFlux)&&!(null!==(_=k.easyTop)&&void 0!==_&&_.isCommunityFlux)&&!(null!==(y=k.easyTop)&&void 0!==y&&y.isSd35Model)&&k.value.enableNegativePrompts,expression:"\n      !isCollapse &&\n      isShowNegativePrompts &&\n      easyTop?.isVideoModel &&\n      value?.currentVideoTab !== 'effect' &&\n      !easyTop?.isStudioFlux &&\n      !easyTop?.isCommunityFlux &&\n      !easyTop?.isSd35Model &&\n      value.enableNegativePrompts\n    "}],staticClass:"advance-setting-panel-item margin-bottom-20"},[I("div",{staticClass:"negative-prompt-input"},[I("el-input",{ref:"negativePromptInput",staticClass:"top-input-area-input",attrs:{type:"textarea",value:k.value.negative_prompt,autosize:{minRows:4,maxRows:4},resize:"none",maxlength:null!==(C=k.easyTop)&&void 0!==C&&C.isPixVerse?2048:2e3,placeholder:k.$t("pleaseEnte")},on:{input:function(e){return k.changeConfig(e,"negative_prompt")}}})],1)]),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowSeed,expression:"isShowSeed"}],staticClass:"advance-setting-panel-item advance-setting-panel-item-flex"},[I("div",{staticClass:"panel-item-label"},[I("span",{staticClass:"generate-mode-panel-label-text"},[k._v(k._s(k.$t("newGenerate21")))]),k._v(" "),I("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:k.$t("newGenerate42"),placement:"top-start"}},[I("i",{staticClass:"custom-tips el-icon-warning"})])],1),k._v(" "),I("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:function(e){return k.changeConfig(e,"lockSeed")}},model:{value:k.value.lockSeed,callback:function(e){k.$set(k.value,"lockSeed",e)},expression:"value.lockSeed"}})],1),k._v(" "),I("div",{directives:[{name:"show",rawName:"v-show",value:!k.isCollapse&&k.isShowSeed,expression:"!isCollapse && isShowSeed"}],staticClass:"advance-setting-panel-item margin-bottom-20"},[I("el-input-number",{directives:[{name:"show",rawName:"v-show",value:k.value.lockSeed,expression:"value.lockSeed"}],attrs:{placeholder:k.$t("customSeed"),value:k.value.seed,precision:0,controls:!1,min:-1,max:k.seedOptions.max},on:{change:function(e){return k.changeConfig(e,"seed")}}}),k._v(" "),k.showImgSeed?I("div",{staticClass:"seed-temp",on:{click:function(e){return k.useSeed(k.value.seedTemp)}}},[k._v("\n      "+k._s(k.$t("useImgSeed",{seed:k.value.seedTemp}))+"\n    ")]):k._e()],1),k._v(" "),I("easy-advance-repair-modal",{ref:"repairModal",attrs:{isShowUpscale:k.isShowUpscale,value:k.value},on:{updateData:k.handleUpdateConfig}}),k._v(" "),I("easy-mode-modal",{ref:"modeModal",attrs:{isShowEngineMode:k.isShowEngineMode,value:k.value,isAnimeEnhanceEnable:null===(w=k.easyTop)||void 0===w?void 0:w.isAnimeEnhanceEnable},on:{updateData:k.handleUpdateConfig}})],1)}),[],!1,null,"627661dc",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default,EasyAdvanceRepairModal:n(561).default,EasyModeModal:n(562).default})},1169:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(7);var o=n(2),l=(n(19),n(16),n(8),n(4),n(43),n(77),n(1)),r=n(163),c=n(10),d=n(3287),v=n(1170),m=n(600),h=n(601),f=n(3288);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C="daily_already",w={name:"EasyGenerateTopBar",inject:["easyTop"],props:{isShowPopup:{type:Boolean,default:!1},listParams:{type:Object,default:function(){return{}}}},components:{ToolsPopup:d.default,EasyChannelSearch:v.default,FilterButton:m.default,FilterOptionPopup:h.default,ListActionBar:f.default},mounted:function(){this.handleDailyFirst(),this.initActivityCheckInInfo()},watch:{isShowPopup:function(e){e&&(this.handleDailyFirst(),this.initActivityCheckInInfo())}},data:function(){return{selectedTemplate:"",formatNumberForeign:c.p,coins:[{name:"credit",icon:n(169),type:"calculateCoins",desc:"new_credit_desc",tab:"Credit"},{name:"stamina",icon:n(397),type:"tempCoins",desc:"new_stamina_desc",default:this.isLoggedIn?0:150,tab:"Subscription"}],enableClassicMode:!1,options:[{code:"generate",label:"创作流"},{code:"workflowApp",label:"快应用"},{code:"character",label:"数字人"}],isTodayFirstCreate:!1,isTodayFirstClaim:!1,canClaim:!1}},computed:y(y(y(y(y({},Object(l.e)("app",["ABInfo"])),Object(l.e)("payment",["paymentInfo","activeState","liteActiveState"])),Object(l.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),Object(l.e)("user",["token","userInfo"])),{},{isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},isShowClassicMode:function(){var e;return!("modal"!==(null===(e=this.easyTop)||void 0===e?void 0:e.mode)||this.userInfo.disable_task_v1_switch||!this.isLoggedIn)},getCoinTitle:function(){var e=this;return function(t){return e.$t(t.type)+"："+e.$t("balance")+" "+(e.paymentInfo[t.type]||0)+", "+e.$t(t.desc)}},isCharacter:function(){var e;return"character"===(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.activeCategory)},isFastApp:function(){var e;return"aiApp"===(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.activeCategory)},isShowSearch:function(){var e;return["model"].includes(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.activeCategory)},getFilterCount:function(){var e,t,n,o,l;return[(null===(e=this.listParams)||void 0===e||null===(e=e.task_domain_types)||void 0===e?void 0:e.length)||0,(null===(t=this.listParams)||void 0===t||null===(t=t.use_model_series)||void 0===t?void 0:t.length)||0,(null===(n=this.listParams)||void 0===n||null===(n=n.save_modes)||void 0===n?void 0:n.length)||0,null!==(o=this.listParams)&&void 0!==o&&o.time_from||null!==(l=this.listParams)&&void 0!==l&&l.time_to?1:0].reduce((function(e,t){return e+t}),0)}}),methods:{getTodayStr:function(){var e=new Date;return"".concat(e.getUTCFullYear(),"-").concat((e.getUTCMonth()+1).toString().padStart(2,"0"),"-").concat(e.getUTCDate().toString().padStart(2,"0"))},handleDailyFirst:function(){if(this.isTodayFirstCreate=!1,this.isTodayFirstClaim=!1,this.isLoggedIn){var e=this.getTodayStr(),t=localStorage.getItem(C);if(t){var n,l,r=JSON.parse(t);null!==(n=r[this.userInfo.id])&&void 0!==n&&null!==(n=n[e])&&void 0!==n&&n.created?this.isTodayFirstCreate=!1:(this.isTodayFirstCreate=!0,localStorage.setItem(C,JSON.stringify(y(y({},r),{},Object(o.a)({},this.userInfo.id,y(y({},r[this.userInfo.id]),{},Object(o.a)({},e,{created:!0}))))))),null!==(l=r[this.userInfo.id])&&void 0!==l&&null!==(l=l[e])&&void 0!==l&&l.claimed?this.isTodayFirstClaim=!1:this.isTodayFirstClaim=!0}else this.isTodayFirstCreate=!0,this.isTodayFirstClaim=!0,localStorage.setItem(C,JSON.stringify(Object(o.a)({},this.userInfo.id,Object(o.a)({},e,{created:!0}))))}},initActivityCheckInInfo:function(){var e=this;this.canClaim=!1,this.isLoggedIn&&Object(r.d)().then((function(t){var n=t.data.week_item_list,o=new Date,l="".concat(o.getUTCFullYear()).concat((o.getUTCMonth()+1).toString().padStart(2,"0")).concat(o.getUTCDate().toString().padStart(2,"0"));e.canClaim=n.some((function(e){return e.date===l&&!e.is_finish}))}))},goGift:function(){if(this.$logEvent("log_actions",{operation:"click_gift",behavior_info:"on_createflow_page",behavior_info_sub:"top_navigation_bar"}),this.$EventBus.$emit("showDialog",{name:"ActivityClaimDialog"}),this.isTodayFirstClaim){this.isTodayFirstClaim=!1;var e=this.getTodayStr(),t=localStorage.getItem(C),n=JSON.parse(t);localStorage.setItem(C,JSON.stringify(y(y({},n),{},Object(o.a)({},this.userInfo.id,y(y({},n[this.userInfo.id]),{},Object(o.a)({},e,y(y({},n[this.userInfo.id][e]),{},{claimed:!0})))))))}},handleClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.easyTop.switchCategory(null==e?void 0:e.code)},handleChannelSearch:function(e){this.$emit("channelSearch",e)},goTutorial:function(){var link="https://docs.seaart.ai/guide-1";"ja"===this.$i18n.locale&&(link="https://docs.seaart.ai/guide-1/ri-ben-yu"),window.open(link,"_blank")},closePopup:function(){this.$emit("close")},toMall:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isVip||!this.isLoggedIn){this.$logEvent("log_actions",{operation:"calculateCoins"===(null==e?void 0:e.type)?"click_calculate_coins":"click_temp_coins",behavior_info:"on_creative_flow_page"});var t="".concat(location.origin,"/mall?openTab=").concat((null==e?void 0:e.tab)||"Credit");window.open(t,"_blank")}else this.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{pageFrom:"EasyGenerateTopBar",step:"subscription",dotFrom:"not_vip_click_stamina_icon_popup"}})},handleEnableClassicMode:function(e){if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),void(this.enableClassicMode=!1);this.$logEvent("log_actions",{operation:"click_switch_model",behavior_info:"on_new_create_flow_page",behavior_info_sub:"open"}),this.$emit("backOld"),this.enableClassicMode=!1},handleComponentClick:function(){this.$EventBus.$emit("needCheckInputPackUp")},handleFilterClick:function(){this.$emit("filter"),this.$logEvent("log_actions",{operation:"click_filter_button",behavior_info:"on_createflow_page"})}}},k=w,I=(n(4310),n(0)),component=Object(I.a)(k,(function(){var e,t=this,o=t._self._c;return o("div",{staticClass:"c-easy-generate-top-bar",on:{click:t.handleComponentClick}},[o("div",{staticClass:"top-bar-left",on:{click:function(e){return e.stopPropagation(),t.closePopup()}}},[o("span",{staticClass:"iconfont icon-goBack top-bar-left-icon"}),t._v(" "),o("img",{staticClass:"logo",attrs:{src:n(315),alt:"Avatar"}})]),t._v(" "),o("div",{staticClass:"top-bar-main"},[o("list-action-bar",{attrs:{listParams:t.listParams}}),t._v(" "),o("div",{staticClass:"top-bar-search"},[o("easy-channel-search",{on:{channelSearch:t.handleChannelSearch}})],1),t._v(" "),t.isCharacter||t.isFastApp?t._e():o("tools-popup",[o("div",{staticClass:"tool-btn"},[o("span",{staticClass:"tool-btn-text"},[t._v(t._s(t.$t("AI_Tools")))]),t._v(" "),o("span",{staticClass:"tool-btn-icon el-icon-caret-bottom"})])]),t._v(" "),t.isCompanyAccount?t._e():o("div",{staticClass:"coin-btn"},[t._l(t.coins,(function(e){return[o("el-tooltip",{key:"".concat(e.name,"_coin"),attrs:{"popper-class":"custom-tips-popper",effect:"light",content:t.getCoinTitle(e),placement:"bottom"}},[o("div",{key:e.name,staticClass:"item-coin",class:e.name,attrs:{"data-id":""},on:{click:function(n){return t.toMall(e)}}},[o("div",{staticClass:"flex_c_m"},[o("img",{staticClass:"icon",attrs:{src:e.icon,alt:e.name}}),t._v(" "),o("div",{staticClass:"number"},[t._v("\n                "+t._s(t.formatNumberForeign(t.paymentInfo[e.type])||0)+"\n              ")])]),t._v(" "),o("i",{staticClass:"el-icon-circle-plus-outline"})])])]}))],2),t._v(" "),o("div",{staticClass:"guide-btn",on:{click:function(e){return e.stopPropagation(),t.goTutorial()}}},[t._m(0)]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoggedIn&&"B"===(null===(e=t.ABInfo)||void 0===e?void 0:e.checkin_traffic_control),expression:"isLoggedIn && ABInfo?.checkin_traffic_control === 'B'"}],staticClass:"gift-btn",class:{shake:t.isTodayFirstCreate},on:{click:function(e){return e.stopPropagation(),t.goGift()}}},[o("img",{staticClass:"gift-btn-icon",attrs:{src:n(1035)}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isTodayFirstClaim&&t.canClaim,expression:"isTodayFirstClaim && canClaim"}],staticClass:"unread"})])],1),t._v(" "),t.isShowClassicMode?o("div",{staticClass:"top-bar-right"},[o("span",{staticClass:"switch-btn-label"},[t._v(t._s(t.$t("newGenerate36")))]),t._v(" "),o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:t.$t("newGenerate35"),placement:"top-start"}},[o("span",{staticClass:"switch-btn-icon el-icon-question"})]),t._v(" "),o("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:t.handleEnableClassicMode},model:{value:t.enableClassicMode,callback:function(e){t.enableClassicMode=e},expression:"enableClassicMode"}})],1):t._e()])}),[function(){var e=this._self._c;return e("span",{staticClass:"guide-btn-content"},[e("i",{staticClass:"iconfont icon-education"})])}],!1,null,"885ed3f6",null);t.default=component.exports;installComponents(component,{EasyChannelSearch:n(1170).default})},1170:function(e,t,n){"use strict";n.r(t);var o={name:"EasyChannelSearch",inject:["easyTop"],"easyTop.channelId":{handler:function(){this.keyword=""},deep:!0,immediate:!0},data:function(){return{keyword:""}},mounted:function(){var e=this;this.$EventBus.$on("clearEasyTaskSearch",(function(){e.keyword="",e.$emit("channelSearch",e.keyword)}))},beforeDestroy:function(){this.$EventBus.$emit("clearEasyTaskSearch")},methods:{handleSearch:function(){this.$emit("channelSearch",this.keyword)},handleChange:function(e){this.$emit("channelSearch",this.keyword)}}},l=(n(4300),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-easy-channel-search"},[t("el-input",{staticClass:"easy-channel-search--input",attrs:{placeholder:e.$t("Search"),clearable:""},on:{change:e.handleChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[t("template",{slot:"prefix"},[t("i",{staticClass:"iconfont icon-search search-icon"})])],2)],1)}),[],!1,null,null,null);t.default=component.exports},1171:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(7);var o=n(14),l=n(3),r=n(2),c=(n(20),n(19),n(6),n(16),n(22),n(31),n(49),n(8),n(4),n(28),n(26),n(3289)),d=n(603),v=n(470),m=n(179),h=n(25),f=n(57),_=n(97),y=n(1);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"EasyTopInputArea",props:["value","menuIndex"],inject:["easyTop"],components:{ImageAndControlNetPopup:c.default,RandomPromptPopup:d.default,ImageToImageCard:v.default,PickOrUploadImageModal:m.default,commonConfirmModal:_.default},data:function(){return{inputSize:{minRows:1,maxRows:8},promptActive:!1,inputIsScroll:!1,debounceCheckScroll:function(){},debounceGenerate:function(){},hasBottomPadding:!1,isPackUp:!1,isScroll:!1,scrollWrapDom:null,scrollHandler:null,throttleScrollHandler:null}},computed:w(w(w({},Object(y.c)("user",["isCompanyAccount"])),Object(y.c)("creation",["smart_edit_template_id"])),{},{isVerticalLayout:function(){return this.promptActive||!this.isScroll},notShowUpload:function(){var e;return(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.modelParams)||void 0===e||!e.hide_img_cond_panel)&&(!this.isHunyuan&&!this.isHiDreamModel&&!this.isSeaArtFilmModel)},isShowImageAndControlNetPopup:function(){var e;return(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.modelParams)||void 0===e||!e.hide_img_cond_panel)&&(!this.hasExtraImages&&this.notShowUpload)},isVerticalLayoutAndShowImageAndControlNetPopup:function(){var e;return(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.modelParams)||void 0===e||!e.hide_img_cond_panel)&&(this.isVerticalLayout&&this.notShowUpload)},isHiDreamModel:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isHiDreamModel},isSeaArtFilmModel:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSeaArtFilmModel},isShowTranslate:function(){var e,t,n;return(null===(e=this.value)||void 0===e?void 0:e.isTranslate)&&""!==(null===(t=this.value)||void 0===t?void 0:t.prompt)&&""!==(null===(n=this.value)||void 0===n?void 0:n.local_prompt)},getDiscountOffText:function(){var e;return"".concat(null===(e=this.easyTop)||void 0===e?void 0:e.discountOff,"% Off")},showLockParamsBtn:function(){var e,t,n,o;return[!["",null,void 0].includes(null==this||null===(e=this.value)||void 0===e?void 0:e.prompt),!["",null,void 0].includes(null==this||null===(t=this.value)||void 0===t?void 0:t.negative_prompt),null===(n=this.value)||void 0===n||null===(n=n.imageToImageList)||void 0===n?void 0:n.length,null===(o=this.value)||void 0===o||null===(o=o.controlnet_units)||void 0===o?void 0:o.length].some((function(e){return!!e}))},showPlaceholder:function(){var e,t,n,o,l="WhatDoUWantToCreate",mask=null!==(e=this.value)&&void 0!==e&&null!==(e=e.imageToImageList)&&void 0!==e&&e.length?null===(t=this.value)||void 0===t||null===(t=t.imageToImageList[0])||void 0===t?void 0:t.mask:"";return null===(n=this.value)||void 0===n||null===(n=n.imageToImageList)||void 0===n||!n.length||["",null,void 0].includes(mask)||/^(http|https):\/\//.test(mask)||null!==(o=this.value)&&void 0!==o&&null!==(o=o.controlnet_units)&&void 0!==o&&o.length||(l="TaskImage2ImagePlaceholder"),l},showBottomPadding:function(){var e,t,n=!1,o=!this.value.enableNegativePrompts&&this.value.prompt,l=!(null!==(e=this.value)&&void 0!==e&&null!==(e=e.imageToImageList)&&void 0!==e&&e.length||null!==(t=this.value)&&void 0!==t&&null!==(t=t.controlnet_units)&&void 0!==t&&t.length),r=this.inputIsScroll&&this.hasBottomPadding&&o&&l,c=this.value.enableNegativePrompts,d=this.isPositionBottom;return l&&(r||c||d)&&(n=!0),n},showLineHeight:function(){var e=!1;return this.inputIsScroll&&this.hasBottomPadding&&(e=!0),e},isPositionBottom:function(){var e=!1;return(this.value.enableNegativePrompts||this.showExtraOptionBar)&&(e=!0),this.value.prompt&&this.inputIsScroll&&(e=!0),e},showExtraOptionBar:function(){var e,t,n,o,l,r,c="FLUX"===(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentModelType)&&(null===(t=this.value)||void 0===t||null===(t=t.ipList)||void 0===t?void 0:t.length),d=null===(n=this.value)||void 0===n||null===(n=n.styleReferenceList)||void 0===n?void 0:n.length,v=null===(o=this.value)||void 0===o||null===(o=o.imageToVideoList)||void 0===o?void 0:o.length;return(null===(l=this.value)||void 0===l||null===(l=l.controlnet_units)||void 0===l?void 0:l.length)||(null===(r=this.value)||void 0===r||null===(r=r.imageToImageList)||void 0===r?void 0:r.length)||c||d||v},isRedrawMask:function(){var e,t,n=(null==this||null===(e=this.value)||void 0===e?void 0:e.imageToImageList)||[];return(null==n?void 0:n.length)&&!["",null,void 0].includes(null===(t=n[0])||void 0===t?void 0:t.mask)},hasExtraImages:function(){var e,t,n,o,l;return(null===(e=this.value)||void 0===e||null===(e=e.imageToImageList)||void 0===e?void 0:e.length)>0||(null===(t=this.value)||void 0===t||null===(t=t.controlnet_units)||void 0===t?void 0:t.length)>0||(null===(n=this.value)||void 0===n||null===(n=n.styleReferenceList)||void 0===n?void 0:n.length)>0||(null===(o=this.value)||void 0===o||null===(o=o.ipList)||void 0===o?void 0:o.length)>0||(null===(l=this.value)||void 0===l||null===(l=l.imageToVideoList)||void 0===l?void 0:l.length)>0},firstPreviewImage:function(){var e,t,n,o,l;if(null!==(e=this.value)&&void 0!==e&&null!==(e=e.imageToImageList)&&void 0!==e&&null!==(e=e[0])&&void 0!==e&&e.url)return this.value.imageToImageList[0].url;if(null!==(t=this.value)&&void 0!==t&&null!==(t=t.controlnet_units)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t.input_image)return this.value.controlnet_units[0].input_image;if(null!==(n=this.value)&&void 0!==n&&null!==(n=n.styleReferenceList)&&void 0!==n&&null!==(n=n[0])&&void 0!==n&&n.image)return this.value.styleReferenceList[0].image;if(null!==(o=this.value)&&void 0!==o&&null!==(o=o.ipList)&&void 0!==o&&null!==(o=o[0])&&void 0!==o&&o.url)return this.value.ipList[0].url;if(null!==(l=this.value)&&void 0!==l&&null!==(l=l.imageToVideoList)&&void 0!==l&&l.length){var r,c=(null===(r=this.value.imageToVideoList)||void 0===r?void 0:r[0])||{};return(null==c?void 0:c.firstFrame)||(null==c?void 0:c.lastFrame)||(null==c?void 0:c.url)||""}return""}}),watch:{"value.enableNegativePrompts":{handler:function(e,t){var n=this;e&&!t&&this.$nextTick((function(){n.$refs.negativePromptInput.focus()}))},deep:!0,immediate:!0},"value.prompt":{handler:function(e){e&&!this.promptActive&&(this.debounceResizeTextArea(),this.debounceCheckScroll()),e||(this.isPackUp=!1)},deep:!0,immediate:!0},showLockParamsBtn:{handler:function(e,t){if(!e){var n,o=JSON.parse(JSON.stringify(this.value));o.isLockParams=!1,null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)}},immediate:!0}},mounted:function(){this.debounceGenerate=Object(h.debounce)(this.handleGenerate,500),this.debounceCheckScroll=Object(h.debounce)(this.checkInputScroll,100),this.debounceCheckScroll(),this.$EventBus.$on("messageItemPromptWidthUpdate",this.checkInputScroll),this.$EventBus.$on("closeAllGeneratePopup",this.handleClosePopup),this.$EventBus.$on("resetInputPackUpStatus",this.changePackUpStatus),this.$EventBus.$on("needCheckInputPackUp",this.handleClickOutside),this.$EventBus.$on("addMoreStyleReference",this.handleAddMoreStyleReference),this.$EventBus.$on("closeRandomPromptPopup",this.handleCloseRandomPopup),this.handleScroll()},beforeDestroy:function(){this.debounceCheckScroll=null,this.debounceGenerate=null,this.$EventBus.$off("messageItemPromptWidthUpdate",this.checkInputScroll),this.$EventBus.$off("closeAllGeneratePopup",this.handleClosePopup),this.$EventBus.$off("resetInputPackUpStatus",this.changePackUpStatus),this.$EventBus.$off("needCheckInputPackUp",this.handleClickOutside),this.$EventBus.$off("addMoreStyleReference",this.handleAddMoreStyleReference),this.$EventBus.$off("closeRandomPromptPopup",this.handleCloseRandomPopup),this.scrollWrapDom&&this.throttleScrollHandler&&(this.scrollWrapDom.removeEventListener("scroll",this.throttleScrollHandler),this.scrollWrapDom=null,this.throttleScrollHandler=null)},methods:{handleBtnsIconContainerMouseDown:function(e){this.promptActive=!0,e.preventDefault()},handleGenerateBtnMouseDown:function(e){this.promptActive&&e.preventDefault()},handleScroll:function(){var e=this;this.scrollWrapDom=document.querySelector(".c-easy-task-view-scroll-wrap"),this.scrollWrapDom&&(this.throttleScrollHandler=Object(h.throttle)((function(){var t=e.scrollWrapDom.scrollTop,n=t>0;e.isScroll!==n&&(e.isScroll=n),e.promptActive&&t>0&&(e.promptActive=!1)}),100),this.scrollWrapDom.addEventListener("scroll",this.throttleScrollHandler,{passive:!0}))},handleCreativeAssistantShow:function(){this.$emit("showCreativeAssistant")},changePrompt:function(){var e,t=this.value,n=t.prompt,o=t.local_prompt,l=JSON.parse(JSON.stringify(this.value)),r=n;l.prompt=o,l.local_prompt=r,null==this||null===(e=this.easyTop)||void 0===e||e.updateConfig(l,this.menuIndex),this.$logEvent("log_actions",{operation:"click_prompt_compare",behavior_info:"on_new_create_flow_page"})},handleDeleteImageToVideo:function(e){this.easyTop.deleteImageToVideo(e)},handleAddMoreStyleReference:function(){var e;if((null==this||null===(e=this.value)||void 0===e||null===(e=e.styleReferenceList)||void 0===e?void 0:e.length)>=4)this.$message(this.$t("newGenerate80",{num:4}));else{this.handleOpenPickWorkModal({type:"styleReference",checkFace:!1})}},handleClickOutside:function(){var e,t=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(["paramsPanel"].includes(source)&&this.isPackUp)try{this.isPackUp=!1,this.$nextTick((function(){t.$refs.realPromptInput.focus()}))}catch(e){}else if(!["paramsPanel"].includes(source)&&null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isShowPopup&&!this.isPackUp)try{this.isPackUp=!0,this.$nextTick((function(){t.$refs.realPromptInput.blur()}))}catch(e){}},changePackUpStatus:function(){this.isPackUp=!1,this.autoResizeInputHeight()},handleInputFocus:function(){this.promptActive=!0,this.isPackUp&&(this.isPackUp=!1)},handleInputBlur:function(){var e=this;setTimeout((function(){var t,n,o=document.activeElement===(null===(t=e.$refs)||void 0===t||null===(t=t.realPromptInput)||void 0===t||null===(t=t.$refs)||void 0===t?void 0:t.textarea),l=document.activeElement===(null===(n=e.$refs)||void 0===n||null===(n=n.negativePromptInput)||void 0===n||null===(n=n.$refs)||void 0===n?void 0:n.textarea);o||l||(e.promptActive=!1)}),50)},handleChangePackUpStatus:function(){this.$logEvent("log_actions",{operation:"click_fold",behavior_info:"on_new_create_flow_page"}),this.isPackUp=!0},handleClearPrompt:function(){var e;this.$logEvent("log_actions",{operation:"click_prompt_delete",behavior_info:"on_new_create_flow_page"});var t=JSON.parse(JSON.stringify(this.value));t.prompt="",null==this||null===(e=this.easyTop)||void 0===e||e.updateConfig(t,this.menuIndex)},toggleLockParamsStatus:function(){var e,t=JSON.parse(JSON.stringify(this.value));t.isLockParams=!t.isLockParams,null==this||null===(e=this.easyTop)||void 0===e||e.updateConfig(t,this.menuIndex),this.$logEvent("log_actions",{operation:"click_fixed_params",behavior_info:"on_new_create_flow_page"})},handleClosePopup:function(){try{this.$refs.imageControlNetPopup.onClose()}catch(e){}},handleCloseRandomPopup:function(){try{var e;null===(e=this.$refs)||void 0===e||e.randomPromptPopup.onClose()}catch(e){}},autoResizeInputHeight:function(){var e=this;try{setTimeout((function(){var t;null===(t=e.$refs)||void 0===t||null===(t=t.realPromptInput)||void 0===t||t.resizeTextarea()}),0)}catch(e){}},checkInputScroll:function(){var e=this;if(!this.value.prompt)return this.inputIsScroll=!1,void(this.hasBottomPadding=!1);this.$nextTick((function(){try{var t,n,o,l=(null===(t=e.$refs.realPromptInput)||void 0===t||null===(t=t.$refs)||void 0===t?void 0:t.textarea)||(null===(n=e.$refs.realPromptInput)||void 0===n?void 0:n.$el);if(!l)return e.inputIsScroll=!1,void(e.hasBottomPadding=!1);var r=(null===(o=window)||void 0===o?void 0:o.devicePixelRatio)||1,c=27;r>=1.5&&(c=22);var d=l.clientHeight||l.offsetHeight;e.inputIsScroll=d>c;var v=l.scrollHeight,m=v>c;e.hasBottomPadding=m&&v<=90,setTimeout((function(){var t;null===(t=e.$refs)||void 0===t||null===(t=t.realPromptInput)||void 0===t||t.resizeTextarea()}),0)}catch(t){var h;e.inputIsScroll=!1,e.hasBottomPadding=!1,null===(h=e.$refs)||void 0===h||null===(h=h.realPromptInput)||void 0===h||h.resizeTextarea()}}))},debounceResizeTextArea:function(){try{var e;null===(e=this.$refs)||void 0===e||null===(e=e.realPromptInput)||void 0===e||e.resizeTextarea()}catch(e){}},handleKeyCode:function(e){this.debounceCheckScroll&&this.debounceCheckScroll(),"Enter"!==e.key&&13!==e.keyCode||(e.shiftKey?(e.preventDefault(),this.insertNewlineAtCursor()):(e.preventDefault(),this.debounceGenerate&&this.debounceGenerate()))},insertNewlineAtCursor:function(){var e=this.value.prompt,t=document.querySelector("#easyGenerateInput");if(t){var n=t.selectionStart,o=t.selectionEnd,l=e.slice(0,n)+"\n"+e.slice(o);this.changeConfig(l,"prompt"),this.$nextTick((function(){t.focus(),t.setSelectionRange(n+1,n+1)}))}},checkNotAllowQualityMode:function(){var e,t,n;return(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.hasEnableImageToImage)&&(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isSDXLModel)&&(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isEnableQuality)},handleGenerate:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.promptActive=!1,null!==(n=e.value)&&void 0!==n&&n.prompt||null!=e&&null!==(o=e.easyTop)&&void 0!==o&&o.notNeedCheckPrompt){t.next=3;break}return t.abrupt("return");case 3:if(!e.checkNotAllowQualityMode()){t.next=14;break}return t.prev=4,t.next=7,null===(l=e.$refs)||void 0===l||null===(l=l.commonConfirmModal)||void 0===l?void 0:l.show({subTitle:"newGenerate46"}).then((function(){var t,n=JSON.parse(JSON.stringify(e.value));Object.assign(n,{generate:{gen_mode:0}}),null==e||null===(t=e.easyTop)||void 0===t||t.updateConfig(n,e.menuIndex)}));case 7:null===(r=e.easyTop)||void 0===r||r.handleGenerate(),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(4);case 12:t.next=15;break;case 14:null===(c=e.easyTop)||void 0===c||c.handleGenerate();case 15:case"end":return t.stop()}}),t,null,[[4,10]])})))()},handleDeleteControlNet:function(e){var t=JSON.parse(JSON.stringify(this.value));try{var n;t.controlnet_units.splice(e,1),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(t,this.menuIndex)}catch(e){}},changeConfig:function(e,t){var n;"enableNegativePrompts"===t&&this.$logEvent("log_actions",{operation:"click_cancel_negative_prompt",behavior_info:"on_new_create_flow_page"}),this.debounceCheckScroll&&this.debounceCheckScroll();var o=JSON.parse(JSON.stringify(this.value));"prompt"===t&&o.isTranslate&&(o.isTranslate=!1),t&&(o[t]=e),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)},handleOpenPickWorkModal:function(){var e,t,n,o,l,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r&&"imageToImage"===r.type&&null!==(e=this.value.imageToImageList)&&void 0!==e&&e.length||r&&"controlNet"===r.type&&(null===(t=this.value)||void 0===t||null===(t=t.controlnet_units)||void 0===t?void 0:t.length)>=3?this.$message.warning(this.$t("newGenerate41")):r&&"IpMaintain"===r.type&&(null===(n=this.value)||void 0===n||null===(n=n.ipList)||void 0===n?void 0:n.length)>=1?this.$message.warning(this.$t("newGenerate64")):r&&"styleReference"===r.type&&(null===(o=this.value)||void 0===o||null===(o=o.styleReferenceList)||void 0===o?void 0:o.length)>=4||r&&["imageToVideo","imageToLive2D"].includes(r.type)&&null!==(l=this.value)&&void 0!==l&&null!==(l=l.imageToVideoList)&&void 0!==l&&l.length?this.$message.warning(this.$t("newGenerate81")):this.$refs.pickOrUploadImageModal.openModal([],r||null)},handleDeleteIpMain:function(){try{var e,t=JSON.parse(JSON.stringify(this.value));t.ipList=[],t.lab_base.conds=(t.lab_base.conds||[]).filter((function(e){return"IpMaintain"!==(null==e?void 0:e.mode)})),null===(e=this.easyTop)||void 0===e||e.updateConfig(t,this.menuIndex)}catch(e){}},handleDeleteStyleReference:function(e){var t,n=JSON.parse(JSON.stringify(this.value));n.styleReferenceList.splice(e,1),null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig(n,this.menuIndex)},updateImageSize:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==t||null===(e=t.info)||void 0===e?void 0:e.banner)||(null==t?void 0:t.banner)||{},o=n.width,l=n.height;if(!o||!l)return null;var r=Object(f.resizeToBaseDimension)(o,l,1024);return{width:r.width,height:r.height}},handlePickImage:function(){var e,t,n=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r&&"imageEditing"===r.type){var c;if(!this.smart_edit_template_id)return;return this.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:this.smart_edit_template_id},imgUrlList:[null===(c=l[0])||void 0===c?void 0:c.url]}}),void this.handleClosePopup()}if(r&&"imageToImage"===r.type){var d,v,m=w({url:(null===(d=l[0])||void 0===d?void 0:d.url)||"",denoising_strength:.35,mask:"",copyMask:"",enable:!0,width:0,height:0},l[0]),h=this.updateImageSize(l[0])||{};return null==this||null===(v=this.easyTop)||void 0===v||v.updateConfig(w({imageToImageList:[m]},h),this.menuIndex),this.changePackUpStatus(),void this.handleClosePopup()}if(r&&"controlNet"===r.type){var f,_,y,C;if((null===(f=JSON.parse(JSON.stringify(this.value)).controlnet_units)||void 0===f?void 0:f.length)>=3)return;if(this.isRedrawMask)(null===(_=this.$refs)||void 0===_||null===(_=_.commonConfirmModal)||void 0===_?void 0:_.show({subTitle:"newGenerate58"})).then((function(){var e,t,o,c=JSON.parse(JSON.stringify(n.value));(c.imageToImageList||[]).map((function(e){return e.mask="",e.denoising_strength=.35,e})),c.mask="",c.tempMask="",c.copyMask="",null==n||null===(e=n.easyTop)||void 0===e||e.updateConfig(c,n.menuIndex),null===(t=n.easyTop)||void 0===t||t.addControlNet(null==r?void 0:r.controlNetInfo,(null===(o=l[0])||void 0===o?void 0:o.url)||""),n.changePackUpStatus(),n.handleClosePopup()}));else null===(y=this.easyTop)||void 0===y||y.addControlNet(null==r?void 0:r.controlNetInfo,(null===(C=l[0])||void 0===C?void 0:C.url)||""),this.changePackUpStatus(),this.handleClosePopup()}r&&"imageDescribe"===r.type&&this.$emit("openDeductionPrompt",{image:null===(e=l[0])||void 0===e?void 0:e.url,result:[],isDeduction:!0});if(r&&"IpMaintain"===r.type){var k=JSON.parse(JSON.stringify({image:"",stop_at:1,weight:.75,enable:!0,mode:"IpMaintain"}));(k=w(w({},k),l[0]||{})).image=k.url||"",this.changeConfig([k],"ipList"),this.changePackUpStatus(),this.handleClosePopup()}if(r&&"styleReference"===r.type){var I,x,T;if((null==this||null===(I=this.value)||void 0===I||null===(I=I.styleReferenceList)||void 0===I?void 0:I.length)>=4)return void this.$message(this.$t("newGenerate80",{num:4}));var S=w({image:(null===(x=l[0])||void 0===x?void 0:x.url)||"",weight:3,mode:"StyleReference",enable:!0},l[0]),O=[].concat(Object(o.a)((null===(T=this.value)||void 0===T?void 0:T.styleReferenceList)||[]),[S]);this.changeConfig(O,"styleReferenceList"),this.handleClosePopup()}r&&["imageToVideo","imageToLive2D"].includes(r.type)&&(null===(t=this.easyTop)||void 0===t||t.addImageToVideo(l[0],r.type),this.changePackUpStatus(),this.handleClosePopup())}}},I=k,x=(n(4325),n(0)),component=Object(x.a)(I,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S=this,O=S._self._c;return O("div",{directives:[{name:"loading",rawName:"v-loading",value:S.value.loading,expression:"value.loading"}],ref:"inputBox",staticClass:"c-easy-top-input-area",class:[!S.isVerticalLayout&&"easy-top-input-area-pack-up"]},[O("div",{staticClass:"top-input-box-container",class:{"flex-column":S.isVerticalLayout}},[O("div",{staticClass:"top-input-box-container-left"},[O("div",{staticClass:"top-input-box",class:[(!S.isPositionBottom||!S.isVerticalLayout)&&"top-input-box-align-center"]},[O("div",{directives:[{name:"show",rawName:"v-show",value:!S.isVerticalLayout&&S.hasExtraImages&&!(null!==(e=S.easyTop)&&void 0!==e&&e.isHiDreamModel)&&!(null!==(t=S.easyTop)&&void 0!==t&&t.isSeaArtFilmModel),expression:"!isVerticalLayout && hasExtraImages && !easyTop?.isHiDreamModel && !easyTop?.isSeaArtFilmModel"}],staticClass:"top-input-box-preview"},[O("img",{staticClass:"top-input-box-preview-image",attrs:{src:S.firstPreviewImage,alt:"preview"}})]),S._v(" "),O("image-and-control-net-popup",{directives:[{name:"show",rawName:"v-show",value:S.isShowImageAndControlNetPopup&&!S.isVerticalLayout,expression:"isShowImageAndControlNetPopup && !isVerticalLayout"}],ref:"imageControlNetPopup",attrs:{"menu-index":S.menuIndex},on:{openUploadImage:S.handleOpenPickWorkModal}},[O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("newGenerate68"),placement:"top-start"}},[O("span",{staticClass:"top-input-box-icon"},[O("i",{staticClass:"iconfont icon-a-icon-addimg2img"})])])],1),S._v(" "),O("div",{staticClass:"top-input-area",class:[S.showLineHeight&&"top-input-area-line-height"]},[O("el-input",{ref:"realPromptInput",staticClass:"top-input-area-input top-input-area-input-real",class:[!S.isVerticalLayout&&"top-input-area-input-real-pack-up"],attrs:{type:"textarea",value:S.value.prompt,placeholder:S.$t(S.showPlaceholder),autosize:S.inputSize,resize:"none",maxlength:"2000",id:"easyGenerateInput"},on:{focus:S.handleInputFocus,blur:S.handleInputBlur,input:function(e){return S.changeConfig(e,"prompt")}},nativeOn:{keydown:function(e){return S.handleKeyCode(e)}}})],1)],1),S._v(" "),O("div",{directives:[{name:"show",rawName:"v-show",value:S.value.enableNegativePrompts&&S.isVerticalLayout,expression:"value.enableNegativePrompts && isVerticalLayout"}],staticClass:"negative-prompt-input-box"},[O("hr",{staticClass:"negative-prompt-input-box-divider",class:[null!==(n=S.value)&&void 0!==n&&n.prompt?"margin-top-10":""],attrs:{"aria-orientation":"horizontal"}}),S._v(" "),O("div",{staticClass:"negative-prompt-input-box-tag"},[O("div",{staticClass:"input-box-tag"},[O("div",{staticClass:"input-box-tag-text"},[S._v(S._s(S.$t("NegativePrompts")))]),S._v(" "),O("div",{staticClass:"input-box-tag-icon",on:{click:function(e){return e.stopPropagation(),S.changeConfig(!1,"enableNegativePrompts")}}},[O("i",{staticClass:"el-icon-close"})])])]),S._v(" "),O("div",{staticClass:"negative-prompt-input"},[O("el-input",{ref:"negativePromptInput",staticClass:"top-input-area-input",attrs:{type:"textarea",value:S.value.negative_prompt,autosize:S.inputSize,resize:"none",maxlength:"2000"},on:{focus:function(e){S.promptActive=!0},blur:S.handleInputBlur,input:function(e){return S.changeConfig(e,"negative_prompt")}}})],1)]),S._v(" "),O("div",{directives:[{name:"show",rawName:"v-show",value:S.showExtraOptionBar,expression:"showExtraOptionBar"}],staticClass:"extra-options-bar"},[S._l(S.value.imageToVideoList,(function(image,i){return O("image-to-image-card",{key:"imageToVideo_".concat(i),attrs:{value:S.value,type:"imageToVideo",cardInfo:image,"menu-index":S.menuIndex},on:{delete:function(e){return S.handleDeleteImageToVideo(i)}}})})),S._v(" "),S._l(S.value.imageToImageList,(function(image,i){return O("image-to-image-card",{key:"image_".concat(i),attrs:{value:S.value,type:"image",cardInfo:image,"menu-index":S.menuIndex}})})),S._v(" "),S._l(S.value.ipList,(function(e,i){return O("image-to-image-card",{key:"ipItem_".concat(i),attrs:{value:S.value,type:"IpMaintain",cardInfo:e,"menu-index":S.menuIndex},on:{delete:S.handleDeleteIpMain}})})),S._v(" "),S._l(S.value.controlnet_units,(function(e,t){return[O("image-to-image-card",{key:"controlNet_".concat(t),attrs:{value:S.value,type:"controlNet",cardInfo:e,"menu-index":S.menuIndex},on:{delete:function(e){return S.handleDeleteControlNet(t)}}})]})),S._v(" "),S._l(S.value.styleReferenceList,(function(e,t){return O("image-to-image-card",{key:"styleReference_".concat(t),attrs:{value:S.value,type:"styleReference",cardInfo:e,"menu-index":S.menuIndex},on:{delete:function(e){return S.handleDeleteStyleReference(t)}}})}))],2)]),S._v(" "),O("div",{staticClass:"top-input-box-right"},[O("div",{staticClass:"btns-icon-container",on:{mousedown:S.handleBtnsIconContainerMouseDown}},[O("div",{directives:[{name:"show",rawName:"v-show",value:S.isVerticalLayoutAndShowImageAndControlNetPopup,expression:"isVerticalLayoutAndShowImageAndControlNetPopup"}],staticClass:"btn-icon-item"},[O("image-and-control-net-popup",{ref:"imageControlNetPopup",attrs:{"menu-index":S.menuIndex},on:{openUploadImage:S.handleOpenPickWorkModal}},[O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("newGenerate68"),placement:"top-start"}},[O("span",{staticClass:"top-input-box-icon"},[O("i",{staticClass:"iconfont icon-a-uploadimage"})])])],1)],1),S._v(" "),O("div",{directives:[{name:"show",rawName:"v-show",value:S.isShowTranslate,expression:"isShowTranslate"}],staticClass:"top-input-box-right-icon",on:{click:S.changePrompt}},[O("i",{staticClass:"iconfont icon-i18n_prompt"})]),S._v(" "),O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("newGenerate69"),placement:"top-start"}},[O("div",{directives:[{name:"show",rawName:"v-show",value:S.showLockParamsBtn,expression:"showLockParamsBtn"}],staticClass:"top-input-box-right-icon icon-hover-show",on:{click:function(e){return e.stopPropagation(),S.toggleLockParamsStatus()}}},[O("i",{staticClass:"iconfont",class:[null!==(o=S.value)&&void 0!==o&&o.isLockParams?"icon-lock-keyhole":"icon-lock-keyhole-open"]})])]),S._v(" "),O("random-prompt-popup",{ref:"randomPromptPopup",on:{openPickImageModal:S.handleOpenPickWorkModal}},[O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("newGenerate70"),placement:"top-start"}},[O("div",{staticClass:"top-input-box-right-icon"},[O("i",{staticClass:"iconfont icon-search-magic"})])])],1)],1),S._v(" "),O("div",{staticClass:"generate-btn-container",attrs:{"data-group":"image_generation_creation_flow_prompt_assistant_btn"}},[S.$isChinaSite?S._e():O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("CreativeAssistant"),placement:"top"}},[O("div",{staticClass:"creative-assistant-icon",attrs:{"data-event":"creative-assistant-icon"},on:{mousedown:function(e){return e.stopPropagation(),S.handleCreativeAssistantShow.apply(null,arguments)}}},[O("i",{staticClass:"iconfont icon-robot"}),S._v(" "),O("span",{staticClass:"creative-assistant-icon-title"},[S._v(S._s(S.$t("czlToolCharacter")))])])]),S._v(" "),O("div",{staticClass:"generate-btn",class:[!(null!==(l=S.value)&&void 0!==l&&l.prompt)&&!(null!==(r=S.easyTop)&&void 0!==r&&r.notNeedCheckPrompt)&&"generate-btn-disable",!!(null!==(c=S.value)&&void 0!==c&&c.prompt||null!==(d=S.easyTop)&&void 0!==d&&d.notNeedCheckPrompt)&&(null===(v=S.easyTop)||void 0===v?void 0:v.isShowDiscountOff)&&"generate-btn-discount"],attrs:{id:"generate-btn","data-discount-off":S.getDiscountOffText},on:{mousedown:S.handleGenerateBtnMouseDown,click:function(e){return S.debounceGenerate()}}},[null!==(m=S.value)&&void 0!==m&&m.generateing?[O("span",{staticClass:"el-icon-loading"})]:S._e(),S._v("\n          "+S._s(S.$t("Generate"))+"\n          "),null!==(h=S.easyTop)&&void 0!==h&&h.isVideoModel&&null!==(f=S.easyTop)&&void 0!==f&&f.isShowDiscountOff?[!(S.value.prompt||null!==(_=S.easyTop)&&void 0!==_&&_.notNeedCheckPrompt)||null!==(y=S.value)&&void 0!==y&&y.generateing||S.isCompanyAccount?S._e():O("span",{staticClass:"generate-btn-sub-spacial"},[O("i",{staticClass:"iconfont icon-trail-fast-queue"}),S._v(" "),null!==(C=S.easyTop)&&void 0!==C&&C.getDiscountOffBeforeNum?O("span",{staticClass:"generate-btn-sub-delete-text"},[S._v(S._s((null===(w=S.easyTop)||void 0===w?void 0:w.getDiscountOffBeforeNum)||0))]):S._e(),S._v(" "),O("span",{staticClass:"generate-btn-sub-normal-text"},[S._v(S._s(S.easyTop.calcCost>=0?S.easyTop.calcCost:null===(k=S.easyTop)||void 0===k?void 0:k.computedCost))])])]:[!(S.value.prompt||null!==(I=S.easyTop)&&void 0!==I&&I.notNeedCheckPrompt)||null!==(x=S.value)&&void 0!==x&&x.generateing||S.isCompanyAccount?S._e():O("span",{staticClass:"generate-btn-sub"},[O("i",{staticClass:"iconfont icon-Lightning"}),S._v("\n              "+S._s(S.easyTop.calcCost>=0?S.easyTop.calcCost:null===(T=S.easyTop)||void 0===T?void 0:T.computedCost)+"\n            ")])]],2)],1)])]),S._v(" "),O("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:S.handlePickImage}}),S._v(" "),O("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"40172bdd",null);t.default=component.exports},1172:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(394),n(47);var o=n(131),l=n.n(o),r=n(3),c=n(2),d=(n(20),n(6),n(32),n(50),n(11),n(22),n(122),n(18),n(24),n(4),n(12),n(13),n(8),n(28),n(21),n(44),n(7),n(686)),v=n(619),m=n(592),h=n(362),f=n(1),_=n(10),y=n(35),C=n.n(y),w=n(45),k=n(39),I=n(27),x=n(29),T=n(593),S=n(102),O=n(1173),P=n(1174),M=n(46),L=n(97),$=n(424),D=n(425),j=n(289),E=n(586),A=n(563),N=n(33);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=n(275),B={name:"EasyMsgItem",mixins:[w.a],inject:["easyTop"],props:{message:{type:Object,default:function(){return{}},required:!0},showTime:{type:Boolean,default:!1},taskFrom:{type:String,default:function(){return""}},channelId:{type:String,default:function(){return""}},visibleButtonCount:{type:Number,default:3}},components:{MessageImg:d.default,historyModel:v.a,MessageOperateBtn:m.default,MetaTooltipVue:h.default,SwipeList:T.default,EasyMsgItemHeader:O.default,EasyTaskInfoPopup:P.default,commonConfirmModal:L.default,CFile:$.default,CText:D.default,CAudio:j.default,ModelViewer:E.a,EasyMessageAudio:A.default},filters:{formatDateTime:function(e,t){var n=new Date(e),o=["zhCN","zhTw"].includes(t.$i18n.locale)?"zh-CN":"en-US",l="zh-CN"===o?{weekday:"short",year:"numeric",month:"long",day:"numeric"}:{weekday:"long",day:"numeric",month:"long",year:"numeric"},r=new Intl.DateTimeFormat(o,l).format(n);return"zh-CN"===o&&(r=(r||"").replace(/(日)([^0-9]+)/,"$1 $2")),r}},computed:R(R(R(R(R({},Object(f.c)(["isSupportWebp"])),Object(f.c)("user",["accountSettingsData","userInfo","isCompanyAccount","isLoggedIn"])),Object(f.e)("payment",["paymentInfo"])),Object(f.e)("app",["ABInfo"])),{},{isAIFaceChangingVideo:function(){var e;return 26===(null===(e=this.message)||void 0===e?void 0:e.type)},isNewProcessBar:function(){return"B"==this.ABInfo.ai_app_process_bar},getComponentsArr:function(){var e,t=(null===(e=this.message)||void 0===e?void 0:e.components)||[],n={4:1,2:2,3:3,0:4,1:5,6:6};return t.sort((function(a,b){var e=String(a.type),t=String(b.type);return n[e]-n[t]}))},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},isShowExpireTime:function(){var e=this.message.expiration_time;return!this.alreadySave&&e&&e>0},getExpireTime:function(){var e=this.message.expiration_time,t=(new Date).getTime();if(e&&e>t){var n=e-t,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},isStudioMode:function(){return[7,"7","studio",11,"11"].includes(this.message.category)},showTaskMode:function(){return[1,2,3,4,5,7,8,13].includes(this.message.type)},convertTaskMode:function(){var e={1:"createModeType1",2:"createModeType2",6:"createModeType6",4:"createModeType4",5:"createModeType5",7:"studio",11:"studio"};return e[this.message.category]?e[this.message.category]:""},moreActionsShow:function(){return[!["",null,void 0].includes(this.message.pub_artwork_no),!["",null,void 0].includes(this.message.pub_artwork_no)&&![4,"4"].includes(this.message.type),this.checkPermission||this.checkIsChannelOwner].some((function(e){return!!e}))},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?e:t},computedPercentage:function(){return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===e?0:e}},convertStatusText:function(){var e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return this.message.status_desc?e[this.message.status_desc]:""},checkBtnStatus:function(){var e=this;return function(t){var n={disabled:!1,loading:!1};return e.currentClickBtn===t?(n.loading=!0,n.disabled=!1,n):(e.currentClickBtn&&e.currentClickBtn!==t&&(n.loading=!1,n.disabled=!0),n)}},checkBtnIsNSFW:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!1;try{var o,l,r=this.message.type||1;if([2,"2"].includes(r))n=!(null===(o=this.message)||void 0===o||null===(o=o.components)||void 0===o||!o.length)&&[1,"1"].includes(null===(l=this.message)||void 0===l?void 0:l.components[0].nsfw);if([1,"1",3,"3"].includes(r)){var c,d,v=!(null===(c=this.message)||void 0===c||!c.components||null===(d=this.message)||void 0===d||null===(d=d.components)||void 0===d||!d.length)&&this.message.components[t-1];n=v&&[1,"1"].includes(v.nsfw)}}catch(e){}return n}},getImageUrl:function(){var e,t,n="",o=(null===(e=this.message)||void 0===e?void 0:e.components)||[];return null!=o&&o.length&&!["",null,void 0].includes(null===(t=o[0])||void 0===t?void 0:t.url)?n=this.isSupportWebp&&![6,"6"].includes(this.message.type)?Object(_.K)(o[0].url,"high"):o[0].url:!![10,"10"].includes(this.message.type)||(!(![24,"24"].includes(this.message.type)||null==o||!o.length)||(!!o.find((function(e){return 2===e.type}))||n))},getGridImageUrl:function(){return function(e){var t="";return e&&!["",null,void 0].includes(e.url)?t=e.url:t}},moreActionShow:function(){return[2,4,13].includes(this.message.type)},checkBtnClicked:function(){return function(e,t){var n=this.message.operation,o=void 0===n?[]:n;if(!o||!o.length)return!1;var l=(o||[]).filter((function(e){return[2,"2"].includes(e.action)})).map((function(e){return e.number})),r=(o||[]).filter((function(e){return[3,"3"].includes(e.action)})).map((function(e){return e.number})),c=(o||[]).filter((function(e){return[4,"4"].includes(e.action)})).map((function(e){return e.number})),d=!1;switch(e){case"U":d=-1!==l.indexOf(t);break;case"V":d=-1!==r.indexOf(t);break;case"reStart":d=!!c.length}return d}},imagePromptList:function(){return this.isI18nToggled?Array.isArray(this.message.reverse_local_prompts)?this.message.reverse_local_prompts:[]:Array.isArray(this.message.reverse_prompts)?this.message.reverse_prompts:[]},getImageInfo:function(){return function(e){return Object.assign(C()(this.message),{banner:e})}},checkPermission:function(){var e=!1;this.message.type;return this.message.sender_id&&this.message.sender_id===this.userInfo.id?e=!0:(this.isPrivateChannel&&(e=!0),e)},checkIsChannelOwner:function(){var e;return this.message.sender_id&&(null==this||null===(e=this.top)||void 0===e||null===(e=e.channelInfo)||void 0===e?void 0:e.owner_id)===this.userInfo.id},isPrivateChannel:function(){return["PRIVATE"].includes(this.channelId)},getAuthorName:function(){var e,t="",n=null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e?void 0:e.author;return t=n?n.name||n.id:"",t=["",null,void 0].includes(t)?"":"@".concat(t)},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isShowCancel:function(){var e;if(!this.isLoggedIn)return!1;var t=this.message,n=t.status,o=t.category,l=t.type,r=![4,"4"].includes(n),c=![4,5,6,10,11,13,23,"23",26,"26"].includes(l),d=Object(N.checkVideoModelType)(null==this||null===(e=this.message)||void 0===e||null===(e=e.ckpts)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.base_model);return["kl_v1.0","kl_v1.5","kl_v1.6","miniMax"].includes(d)?[1,"1"].includes(n)&&this.checkPermission:r&&![3,"3"].includes(o)&&this.checkPermission&&c},isShowFaster:function(){if(!this.isLoggedIn)return!1;var e=this.message,t=e.status,n=e.speed_type;return 1==t&&1===n&&!this.hasAccelerated},showReStartTaskBtn:function(){var e,t=null===(e=this.message)||void 0===e||null===(e=e.ckpts)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.base_model_name;return![N.VIDEO_MODEL_LIST.minMax,N.VIDEO_MODEL_LIST["kl_v1.0"],N.VIDEO_MODEL_LIST["kl_v1.5"],N.VIDEO_MODEL_LIST["kl_v1.6"]].includes(t)}}),watch:{accountSettingsData:{handler:function(e){this.isI18nToggled=!e.is_off_localization},deep:!0},message:{handler:function(e){var t=this;this.$nextTick((function(){t.isLoading=!!e.isLoading,t.currentClickBtn=e.loadingBtn||""}))},deep:!0,immediate:!0},isShowCancel:{handler:function(e){this.postTaskCancelExposureLog()}}},data:function(){return{defaultAvatar:F,customColor:"#2E9E60",isLoading:!1,isPosting:!1,currentClickBtn:"",isI18nToggled:!1,morePopoverVisible:!1,reportLoading:!1,mapObj:{0:!0,1:!0,2:!0,3:!0,4:!0},trailBtnLoading:!1,hasAccelerated:!1,alreadySave:!1,metaTooltipShow:!1,loraModeObj:{},checkpoiontNameObj:{},isInSave:!1}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isI18nToggled=!e.accountSettingsData.is_off_localization,e.postTaskCancelExposureLog();case 2:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.mapObj={}},methods:{convertSecondToMinute:function(e){return e||0===e?Math.ceil(e/60):0},postTaskCancelExposureLog:function(){this.isShowCancel&&[1,"1",2,"2",4,"4"].includes(this.message.status)&&2==this.message.task_domain_type&&this.$xyLogEvent({front_operation:"exposure",entity_type:"message-process-operate-box-btn",entity_name:"cancelTask",obj_id:"cancelTask",obj_category:2==this.message.task_domain_type?"ai_app":"other",obj_pt:this.isNewProcessBar?"new_create_workflow_add_task_duration":"old_create_workflow_task_progress_percentage"})},handleSaveSuccess:function(e){var t,n=this;((null==this||null===(t=this.message)||void 0===t?void 0:t.components)||[]).forEach((function(component,t){t===e&&n.$set(component,"is_saved_personal",!0)}))},handleModelOperation:function(e,t){var n=t.modelUrl,o=this.message.components;if("delete"===e){var l=(void 0===o?[]:o).findIndex((function(e){return e.url===n}));-1!==l&&this.deleteSingleImg(l+1)}},show3DModel:function(e){var t=e.url;this.$refs.modelViewer.show({url:t,createTime:this.message.create_at,id:this.message.id})},handleMoreAction:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"TASK_INFO":this.$refs.easyTaskInfoPopup.show();break;case"REFRESH_TASK":this.handleReStart();break;case"DELETE_ALL":this.isPrivateChannel?this.handleDeleteTask():this.handleDeleteMessage();break;case"SAVE_ALL":this.saveToSever()}},saveToSever:function(){var e=this;if(!this.isInSave){var t={};t.items=(this.message.components||[]).filter((function(e){return 1!==(null==e?void 0:e.nsfw)})).map((function(t){var n;return{folder_no:"default",id:null===(n=e.message)||void 0===n?void 0:n.id,index:t.index}})),this.isInSave=!0,Object(M.easyBatchSaveParams)(t).then((function(){e.$message.success(e.$t("SaveSuccess")),e.alreadySave=!0;try{var t;null!==(t=e.message)&&void 0!==t&&null!==(t=t.components)&&void 0!==t&&t.length&&(e.message.components||[]).forEach((function(t){e.$set(t,"is_saved_personal",!0)}))}catch(e){}e.$emit("saveSuccess"),e.handleClosePopover()})).finally((function(){e.isInSave=!1}))}},handleClosePopover:function(){try{this.$refs.easyMsgHeader.handleClosePopover()}catch(e){}},handleAutoGenerate:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null==this||null===(e=this.easyTop)||void 0===e||e.handleGenerateByPrompt(t)},expireClick:function(){var e=(this.paymentInfo||{}).vipType,t=["svip_1","svip_2","svip_1_trial","svip_2_trial","vip_lite"].includes(e)||e.includes("vip_day");this.isVip?t&&this.$EventBus.$emit("showUpgradeDialog","NoExpireTimeTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic")},handleUpdateModelName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(["",null,void 0].includes(this.modelName)&&this.$set(this.message,"art_model_name",e),t){var n,o,l={};l.meta=(null==t?void 0:t.meta)||{},l.art_model=(null==t?void 0:t.art_model)||{},this.$set(this.message,"art_model",Object.assign({},(null===(n=this.message)||void 0===n?void 0:n.art_model)||{},l.art_model)),this.$set(this.message,"meta",Object.assign({},(null==this||null===(o=this.message)||void 0===o?void 0:o.meta)||{},l.meta))}},setLoraModel:function(e){this.loraModeObj=Object.assign(this.loraModeObj,e)},deleteSingleImg:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=this.message,l=o.id,r=void 0===l?"":l,c=o.components,d=(void 0===c?[]:c)[e-1].index,v=void 0===d?"":d;["",void 0,null].includes(n)||(v=n),Object(S.b)({id:r,index:v}).then((function(){var e;t.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"delete"}),t.$message({message:t.$t("deleteSuccess"),type:"success"}),t.message.components=t.message.components.filter((function(e){return e.index!=v})),null!==(e=t.message)&&void 0!==e&&null!==(e=e.components)&&void 0!==e&&e.length||t.$emit("operate",{type:"deleteTask",info:t.message})}))},handleNsfwStatus:function(e){var t=e.index,n=e.canViewNsfw;this.$set(this.mapObj,t,n)},autoResizeScrollBtn:function(){var e=this;this.$nextTick((function(){try{var t;null==e||null===(t=e.$refs)||void 0===t||t.swipeList.setMoveBtnShow()}catch(e){}}))},toUserPage:function(e){var t,n=null===(t=this.message)||void 0===t||null===(t=t.messageInfo)||void 0===t?void 0:t.author;e=n?n.id:"",["",null,void 0].includes(e)||this.$router.push("/user/"+e)},moreActions:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"report":this.reportArtwork();break;case"collect":this.message&&this.message.collect?this.unFavorite():this.handleCollect();break;case"shareLink":this.handleShareLink();break;case"delete":this.isPrivateChannel?this.handleDeleteTask():this.handleDeleteMessage()}},handleDeleteTask:function(){var e=this;try{this.$refs.commonConfirmModal.show({subTitle:"deleteTaskConfirm"}).then((function(){var t={ids:[e.message.id]};e.globalLoading=!0,Object(x.deleteTaskRecord)(t).then((function(t){var n,o;["10000",1e4].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(e.$emit("operate",{type:"deleteTask",info:e.message}),e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.handleClosePopover()):e.$message({message:(null==t||null===(o=t.status)||void 0===o?void 0:o.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))})).catch((function(e){}))}catch(e){}},handleDeleteMessage:function(){var e=this;try{this.$refs.commonConfirmModal.show({subTitle:"deleteTaskConfirm"}).then((function(){var t={channel_id:e.channelId,message_ids:[e.message.message_id]};e.globalLoading=!0,Object(x.deleteMessage)(t).then((function(t){var n,o;["10000",1e4].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(e.$emit("operate",{type:"deleteTask",info:e.message}),e.$message({message:e.$t("deleteSuccess"),type:"success"})):e.$message({message:(null==t||null===(o=t.status)||void 0===o?void 0:o.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))})).catch((function(e){}))}catch(e){}},handleCollect:function(){var e=this,t={id:this.message.pub_artwork_no};this.addFavorite(t,"artwork",null,(function(data){e.$emit("updateData",e.message.id,{collect:data})}))},unFavorite:function(){var e=this;if(!this.isCollecting){var t={id:this.message.pub_artwork_no,collect:{id:this.message.collect.id}};this.isCollecting=!0,Object(I.m)({id:t.collect.id}).then((function(n){var o={id:t.id,collect:null};e.$logEvent("log_actions",{operation:"cancel_collect_image",behavior_info:t.id}),e.$emit("updateData",e.message.id,{collect:null}),e.changeCollectData(o)})).finally((function(){e.isCollecting=!1}))}},handleShareLink:function(){var e=this.message,t=e.pub_artwork_no,n=void 0===t?"":t,o=e.pub_artwork_nos,l=void 0===o?[]:o,r=n;if(l&&l.length&&(r=l[0]),!["",null,void 0].includes(r)){var c="".concat(window.location.origin,"/")+"explore/detail/".concat(r);this.$message.success(this.$t("CopiedURLToClipboard")),Object(_.g)(c)}},reportArtwork:function(){var e=this,t=this.message.pub_artwork_no,n=void 0===t?"":t;this.reportLoading||["",null,void 0].includes(n)||(this.reportLoading=!0,Object(k.r)({id:n}).then((function(t){var code=t&&t.status?t.status.code:"";[1e4,"10000"].includes(code)&&l()({message:e.$t("ReportSuccess"),type:"success",duration:5e3})})).finally((function(){e.reportLoading=!1})))},handleReStart:function(){this.closeMetaPopover(),this.$emit("operate",{info:this.message,type:"reStart"})},handleImageOperate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"extraUpscale":this.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:n,art_work_no:this.message.pub_artwork_no,meta:Object.assign({},C()(this.message.meta),{channel:this.message.category})}});break;case"upscale":this.$emit("operate",{info:this.message,type:"U",btnInfo:{btnType:"U",id:t}});break;case"variations":this.$emit("operate",{info:this.message,type:"V",btnInfo:{btnType:"V",id:t}});break;case"removeBackground":this.$emit("operate",{info:this.message,type:"removeBackground",imageUrl:n});break;case"animGen":this.$emit("operate",{info:this.message,type:"A",btnInfo:{btnType:"A",id:t}});break;case"videoUpscale":this.$emit("operate",{info:this.message,type:"videoUpscale",btnInfo:{btnType:"A",id:t},url:n})}},handlePromptSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$emit("operate",{info:this.message,type:"promptSearch",prompt:e})},handleTaskReStart:function(){this.$emit("operate",{info:this.message,type:"taskReStart"})},handleOperate:function(e,t){this.$emit("operate",{info:this.message,type:t,btnInfo:e})},handleCancelTask:function(){this.isLoading||this.$emit("operate",{info:this.message,type:"cancelTask"})},handleTrialFastQueue:function(){var e,t=this;[11,12,13,14].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.task_domain_type)?this.$logEvent("log_actions",{operation:"click_quick_queue",behavior_info:"on_video_create_flow_page"}):this.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"click_try"});var n=this.message.id,o=void 0===n?"":n;this.trailBtnLoading=!0,Object(S.c)({id:o}).then((function(e){var n,code=null==e||null===(n=e.status)||void 0===n?void 0:n.code;70010===code?(t.$EventBus.$emit("showBreakDialog","FastQueueTipWeb","basic"),t.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"vip_pop_show"})):1e4===code&&(t.hasAccelerated=!0,t.$message.success(t.$t("AccelerateSuccess"))),t.trailBtnLoading=!1}))},handleCopyGenerationData:function(){this.closeMetaPopover(),this.$emit("copyGenerationData",this.message)},closeMetaPopover:function(){try{this.$refs.easyTaskInfoPopup.handleClose()}catch(e){}}}},U=B,G=(n(4396),n(4397),n(4398),n(0)),component=Object(G.a)(U,(function(){var e,t,n,o,l,r,c,d,v,m,h=this,f=h._self._c;return f("div",{staticClass:"c-easy-msg-item"},[h.showTime?f("div",{staticClass:"easy-msg-item-time-box"},[h._v(h._s(h._f("formatDateTime")(null===(e=h.message)||void 0===e?void 0:e.create_at,this)))]):h._e(),h._v(" "),f("easy-msg-item-header",{ref:"easyMsgHeader",attrs:{message:h.message,isMyMsg:h.isMyMsg,moreActionsShow:h.moreActionsShow,checkPermission:h.checkPermission,isShowExpireTime:h.isShowExpireTime,expireTime:h.getExpireTime,alreadySave:h.alreadySave,checkIsChannelOwner:h.checkIsChannelOwner},on:{moreAction:h.handleMoreAction}}),h._v(" "),null!==(t=h.easyTop)&&void 0!==t&&t.isShowPopup?f("easy-task-info-popup",{ref:"easyTaskInfoPopup",attrs:{loraModeObj:h.loraModeObj,message:h.message,"is-my-msg":h.isMyMsg,isShowExpireTime:h.isShowExpireTime,expireTime:h.getExpireTime},on:{updateModelName:h.handleUpdateModelName,setLoraModel:h.setLoraModel,close:function(e){return h.handleClosePopover()},copyGenerationData:h.handleCopyGenerationData}}):h._e(),h._v(" "),[6,"6"].includes(h.message.type)?[f("div",{staticClass:"message-text-list"},h._l(h.imagePromptList,(function(e,t){return f("div",{key:t,staticClass:"message-text-list-item"},[f("span",{staticClass:"message-text-list-item-order"},[h._v(h._s(t+1))]),h._v(" "),f("span",{staticClass:"message-text-list-item-text"},[h._v(h._s(e))])])})),0),h._v(" "),f("div",{staticClass:"operating-options-text"},h._l(h.imagePromptList,(function(e,t){return f("message-operate-btn",{key:"".concat(t,"_prompt_text"),on:{click:function(t){return h.handleAutoGenerate(e)}}},[h._v("\n        "+h._s(t+1)+"\n      ")])})),1)]:h._e(),h._v(" "),[2,"2",3,"3"].includes(h.message.status)&&(h.getImageUrl||h.isStudioMode&&null!==(n=h.message)&&void 0!==n&&null!==(n=n.components)&&void 0!==n&&n.length)?f("div",{staticClass:"message-accessories",on:{mouseenter:h.autoResizeScrollBtn}},[f("div",{staticClass:"media-attachments-container"},[h.message&&[10,"10"].includes(h.message.type)?h._l(h.message.components,(function(e,t){return f("message-img",{key:t,attrs:{src:h.getGridImageUrl(e),msgId:h.message.id,loraModels:h.loraModeObj,nsfw:e.nsfw,message:h.getImageInfo(e),"operate-number":t+1,"view-status":h.mapObj,imageInfo:e},on:{setLoraModel:h.setLoraModel,imageOperate:h.handleImageOperate,viewNsfwStatus:h.handleNsfwStatus,copyGenerationData:h.handleCopyGenerationData,updateModelName:h.handleUpdateModelName}})})):h.message&&Array.isArray(null===(o=h.message)||void 0===o?void 0:o.components)&&null!==(l=h.message)&&void 0!==l&&null!==(l=l.components)&&void 0!==l&&l.length?[h._l(h.getComponentsArr,(function(e,t){return[4==e.type?f("div",{key:"list-item-file_".concat(null==e?void 0:e.index),staticClass:"c-history-box c-history-box-file"},[f("CFile",{attrs:{file:{url:e.url}}})],1):2==e.type?f("div",{key:"list-item-text_".concat(null==e?void 0:e.index),staticClass:"c-history-box c-history-box-text"},[f("CText",{ref:"textRef",refInFor:!0,attrs:{text:null==e?void 0:e.content,backgroundColor:"#20212B"}})],1):3==e.type&&[21,23].includes(h.message.task_domain_type)?f("div",{key:"list-item-audio_".concat(null==e?void 0:e.index),staticClass:"c-history-box c-history-box-audio-new"},[f("EasyMessageAudio",{attrs:{url:e.url,title:e.title,coverUrl:e.cover_url,"operate-number":t+1,message:h.message,loraModels:h.loraModeObj},on:{setLoraModel:h.setLoraModel,delete:h.deleteSingleImg,updateModelName:h.handleUpdateModelName,copyGenerationData:h.handleCopyGenerationData}})],1):3==e.type?f("div",{key:"list-item-audio_".concat(null==e?void 0:e.index),staticClass:"c-history-box c-history-box-audio"},[f("CAudio",{attrs:{audio:{url:e.url}}})],1):6==e.type?f("div",{key:"list-item-model_".concat(t),staticClass:"c-history-box c-history-box-model"},[f("history-model",{attrs:{isCreatieFlow:!0,"operate-number":t+1,message:e},on:{"view-model":function(t){return h.show3DModel(e)},deleteSingleImg:h.deleteSingleImg}})],1):f("div",{key:"list-item-img_".concat(null==e?void 0:e.index),staticClass:"c-history-box c-history-box-img"},[f("message-img",{attrs:{imageInfo:e,src:h.getGridImageUrl(e),msgId:h.message.id,loraModels:h.loraModeObj,nsfw:e.nsfw,width:e.width,height:e.height,message:h.getImageInfo(e),"is-mask-blur":(null==e?void 0:e.is_blur)||!1,"operate-number":t+1,showSaveFlag:null==e?void 0:e.is_saved_personal,"view-status":h.mapObj,visibleButtonCount:h.visibleButtonCount,showHoverMaskButton:!h.isAIFaceChangingVideo},on:{setLoraModel:h.setLoraModel,copyGenerationData:h.handleCopyGenerationData,imageOperate:h.handleImageOperate,updateModelName:h.handleUpdateModelName,viewNsfwStatus:h.handleNsfwStatus,deleteSingleImg:h.deleteSingleImg,saveSuccess:h.handleSaveSuccess}})],1)]}))]:f("message-img",{attrs:{src:h.getImageUrl,nsfw:h.message.nsfw,message:h.message,"is-mask-blur":(null===(r=h.message)||void 0===r?void 0:r.is_blur)||!1,msgId:h.message.id,loraModels:h.loraModeObj,"view-status":h.mapObj,showHoverMaskButton:!h.isAIFaceChangingVideo,visibleButtonCount:h.visibleButtonCount},on:{updateModelName:h.handleUpdateModelName,copyGenerationData:h.handleCopyGenerationData,setLoraModel:h.setLoraModel,imageOperate:h.handleImageOperate,viewNsfwStatus:h.handleNsfwStatus,saveSuccess:h.handleSaveSuccess}})],2)]):h._e(),h._v(" "),[1,"1",2,"2",4,"4"].includes(h.message.status)?f("div",{staticClass:"message-process-container"},[f("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(h.message.status)?[f("span",{staticClass:"process-operate-box-text"},[h._v(h._s(h.$t("TaskStatusWaitingToStart"))+" "),f("span",{staticClass:"message-process-loading-span"})])]:[2,"2"].includes(h.message.status)&&!h.computedPercentage(h.message)?[f("span",{staticClass:"process-operate-box-text"},[h._v(h._s(h.$t("TaskStatusPreparing"))+" "),f("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(h.message.status)?f("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[h._v(h._s(h.convertStatusText))]):f("span",{staticClass:"process-operate-box-text"},[h.isNewProcessBar&&2==h.message.task_domain_type&&null!==(c=h.message)&&void 0!==c&&null!==(c=c.estimate_time)&&void 0!==c&&c.min_time&&null!==(d=h.message)&&void 0!==d&&null!==(d=d.estimate_time)&&void 0!==d&&d.max_time?[h._v("\n          "+h._s(h.$t("ai_app_genarate_time_estimate",{estimate:"".concat(null===(v=h.message)||void 0===v||null===(v=v.estimate_time)||void 0===v?void 0:v.min_time,"-").concat(null===(m=h.message)||void 0===m||null===(m=m.estimate_time)||void 0===m?void 0:m.max_time)}))+"\n          "),f("span",{staticClass:"message-process-loading-span"})]:[h._v("\n          "+h._s(h.$t("youHaveCompleted"))+"\n          "),f("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[h._v("\n            "+h._s(h.computedPercentage(h.message))+"%\n          ")]),h._v(" "),f("span",{staticClass:"message-process-loading-span"})]],2),h._v(" "),[2,"2"].includes(h.message.status)&&h.computedPercentage(h.message)?f("div",{staticClass:"message-process-panel"},[f("el-progress",{staticClass:"message-process-panel-progress",attrs:{percentage:h.computedPercentage(h.message),color:h.customColor,"show-text":!1,"stroke-width":12}})],1):h._e(),h._v(" "),h.isShowFaster?f("el-button",{staticClass:"message-process-operate-box-btn fast-queue",attrs:{size:"mini",loading:h.trailBtnLoading},on:{click:h.handleTrialFastQueue}},[f("i",{staticClass:"iconfont icon-trail-fast-queue"}),h._v(" "),f("span",{staticClass:"words"},[h._v(h._s(h.$t("TrialFastQueue")))])]):h._e(),h._v(" "),h.isShowCancel?f("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:h.$t("CancelJobTips"),placement:"top-start"}},[f("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:h.isLoading},attrs:{type:"danger",size:"mini","data-type":2==h.message.task_domain_type?"ai_app":"other","data-group":"message-process-operate-box-btn","data-event":"cancelTask","data-id":"cancelTask","data-pt":h.isNewProcessBar?"new_create_workflow_add_task_duration":"old_create_workflow_task_progress_percentage"},on:{click:h.handleCancelTask}},[h._v("\n          "+h._s(h.isLoading?"Canceling…":h.$t("CancelJob"))+"\n        ")])],1):h._e(),h._v(" "),[4,"4"].includes(h.message.status)&&h.checkPermission&&h.showReStartTaskBtn?f("message-operate-btn",{key:"reStart",attrs:{loading:h.checkBtnStatus("reStart").loading,disabled:h.checkBtnStatus("reStart").disabled},on:{click:h.handleTaskReStart}},[f("i",{staticClass:"iconfont icon-refresh-icon2",staticStyle:{"font-size":"18px"}})]):h._e()],2),h._v(" "),h.message.rest_estimate_time?f("div",{staticClass:"message-estimate_time"},[h._v("\n      "+h._s(h.$t("videoTaskReady",{num:h.convertSecondToMinute(h.message.rest_estimate_time)}))+"\n    ")]):h._e()]):h._e(),h._v(" "),f("common-confirm-modal",{ref:"commonConfirmModal"}),h._v(" "),f("ModelViewer",{ref:"modelViewer",on:{handleOperation:h.handleModelOperation}})],2)}),[],!1,null,"85aaa60a",null);t.default=component.exports;installComponents(component,{EasyMsgItemHeader:n(1173).default,EasyTaskInfoPopup:n(1174).default,CFile:n(424).default,CText:n(425).default,EasyMessageAudio:n(563).default,CAudio:n(289).default})},1173:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(18);var o=n(2),l=n(3),r=(n(20),n(11),n(22),n(6),n(24),n(12),n(13),n(8),n(4),n(43),n(7),n(21),n(77),n(26),n(1)),c=n(10),d=n(878),v=n(46),m=n(165),h=n(99);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={name:"EasyMsgItemHeader",inject:["easyTop"],components:{MessageLoraPopup:d.default},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),d=t.getMinutes().toString().padStart(2,"0"),v=t.getSeconds().toString().padStart(2,"0");return Object(c.F)(t,new Date)?"".concat(r,":").concat(d,":").concat(v):"".concat(n,"/").concat(o,"/").concat(l," ").concat(r,":").concat(d,":").concat(v)}},props:{message:{type:Object,default:function(){return{}},required:!0},isShowExpireTime:{type:[Boolean,Number],default:!1},expireTime:{type:String,default:""},isMyMsg:{type:Boolean,default:!1},moreActionsShow:{type:Boolean,default:!1},checkPermission:{type:Boolean,default:!1},checkIsChannelOwner:{type:Boolean,default:!1},alreadySave:{type:Boolean,default:!1}},data:function(){return{removeCameraMarkers:h.removeCameraMarkers,isI18nToggled:!1,isFoldPrompt:!0,morePopoverVisible:!1,showFoldBtn:!0,isInDownloadTask:!1,pollingTimer:null}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$EventBus.$on("messageItemPromptWidthUpdate",e.handleResize),e.isI18nToggled=!e.accountSettingsData.is_off_localization,e.checkPromptOverflow();case 3:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.$EventBus.$off("messageItemPromptWidthUpdate",this.handleResize),this.pollingTimer&&window.clearTimeout(this.pollingTimer),this.pollingTimer=null,this.isInDownloadTask=!1},computed:_(_(_({},Object(r.c)("user",["accountSettingsData","isCompanyAccount","isLoggedIn"])),Object(r.e)("payment",["paymentInfo"])),{},{getRetryLogEventInfo:function(){var e,t,n,o,l={};null!==(e=this.message)&&void 0!==e&&e.creativity&&(l={id:null===(t=this.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.id,name:null===(n=this.message)||void 0===n||null===(n=n.creativity)||void 0===n?void 0:n.name,task_domain_type:null===(o=this.message)||void 0===o?void 0:o.task_domain_type});return JSON.stringify(l)},hasAllSaved:function(){var e;return((null===(e=this.message)||void 0===e?void 0:e.components)||[]).every((function(e){return null==e?void 0:e.is_saved_personal}))||this.alreadySave},hasOtherType:function(){var e;return null===(e=this.message)||void 0===e||null===(e=e.components)||void 0===e?void 0:e.some((function(e){return![0,"0",1,"1"].includes(null==e?void 0:e.type)}))},getRenderImageUrl:function(){var e,t=(null===(e=this.message)||void 0===e||null===(e=e.creativity)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url)||"";return t?Object(c.K)(t,"low"):t},allowRefreshOrMoreOperate:function(){return[3,4].includes(this.message.status)},allowRestartOperate:function(){var e,t;return![4,"4","5",5,6,"6",10,"10",23,"23",25,"25",26,"26"].includes(null===(e=this.message)||void 0===e?void 0:e.type)&&[1,"1","2",2,3,"3"].includes(null===(t=this.message)||void 0===t?void 0:t.status)},getFirstLora:function(){var e;return(null===(e=this.message)||void 0===e?void 0:e.loras[0])||{}},getFirstLoraType:function(){var e,t=null===(e=this.message)||void 0===e||null===(e=e.loras[0])||void 0===e?void 0:e.model_type;return"LoCon"===t?"LyCORIS":"TextualInversion"===t?"embedding1":t||""},moreActionShow:function(){return[2,4,13].includes(this.message.type)},isStudioMode:function(){return[7,"7","studio",11,"11"].includes(this.message.category)},convertTaskType:function(){var e;return m.b[null===(e=this.message)||void 0===e?void 0:e.task_domain_type]||m.c[this.message.type]||""},isVideoModel:function(){var e;return[11,12,13,14,15].includes(null===(e=this.message)||void 0===e?void 0:e.task_domain_type)},getAppType:function(){var e,t,n,o={1:"ai_tools_4",2:"Swtft_App",15:"VideoEffect",16:"Swtft_App"};if([1,2,15,16].includes(null===(e=this.message)||void 0===e?void 0:e.task_domain_type))return o[null===(t=this.message)||void 0===t?void 0:t.task_domain_type]?o[null===(n=this.message)||void 0===n?void 0:n.task_domain_type]:""},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.prompt?this.message.prompt:"";return this.isI18nToggled?e:t},isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)}}),methods:{toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var e=(this.paymentInfo||{}).vipType,t=["svip_1","svip_2","svip_1_trial","svip_2_trial","vip_lite"].includes(e)||e.includes("vip_day");this.isVip?t&&this.$EventBus.$emit("showUpgradeDialog","NoExpireTimeTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic")},handleJumpModelDetail:function(e){var t,n;if(null!=e&&e.id){var o="";if([1,2,15].includes(null===(t=this.message)||void 0===t?void 0:t.task_domain_type)){var l,r=[1].includes(null===(l=this.message)||void 0===l?void 0:l.task_domain_type)?"/aiFilterDetail/":"/workFlowAppDetail/";o=this.localePath("".concat(r).concat(e.id))}else o=16===(null===(n=this.message)||void 0===n?void 0:n.task_domain_type)?this.localePath("/ai-tools/".concat(e.id)):this.localePath("/models/detail/".concat(e.id));window.open(o,"_blank")}},handleLogEvent:function(e){this.$logEvent("log_actions",{operation:e,behavior_info:"on_new_create_flow_page",behavior_info_sub:"on_create_flow_topbar"})},handleClickMore:function(){this.handleLogEvent("click_more")},handleResize:function(){this.checkPromptOverflow()},checkPromptOverflow:function(){var e=this;this.$nextTick((function(){try{var element=e.$refs.promptBox,rect=null==element?void 0:element.getBoundingClientRect(),t=window.getComputedStyle(element),n=parseFloat(null==t?void 0:t.lineHeight),o=(null==rect?void 0:rect.height)>n,l=(null==element?void 0:element.scrollWidth)>(null==element?void 0:element.clientWidth);e.showFoldBtn=o||l}catch(t){e.showFoldBtn=!0}}))},toggleFoldPromptStatus:function(){this.handleLogEvent("click_view_prompt"),this.isFoldPrompt=!this.isFoldPrompt,this.checkPromptOverflow()},toggleI18nPrompt:function(){this.handleLogEvent("click_translate"),this.isI18nToggled=!this.isI18nToggled,this.checkPromptOverflow()},handleSendAll:function(){var e,content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";content&&(null==this||null===(e=this.easyTop)||void 0===e||e.updatePrompt(content)),this.$emit("messageItemPromptWidthUpdate"),this.$emit("resetInputPackUpStatus"),this.$logEvent("log_actions",{operation:"click_copy_prompt",behavior_info:"on_new_create_flow_page"})},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";content&&(Object(c.g)(content),this.$message.success(this.$t("CopySuccess")))},handleRefreshTask:function(){var e;if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});this.handleLogEvent("click_retry"),[1,2].includes(null===(e=this.message)||void 0===e?void 0:e.task_domain_type)?this.handleFastAppReStart():this.$emit("moreAction","REFRESH_TASK")},handleFastAppReStart:function(){var e,t,n,o,l={obj:_(_({},(null===(e=this.message)||void 0===e?void 0:e.creativity)||{}),{},{onlyUpdateInfo:!1,retryId:null===(t=this.message)||void 0===t?void 0:t.id,banner:Object.assign({},(null===(n=this.message)||void 0===n||null===(n=n.creativity)||void 0===n?void 0:n.cover)||{})}),type:[1].includes(null===(o=this.message)||void 0===o?void 0:o.task_domain_type)?"ai_filter":"aiApp"};this.$EventBus.$emit("updateCategoryInfo",l,"app")},handleMoreActionClick:function(){return this.isLoggedIn||(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"})),!1},handleMoreAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});this.allowRefreshOrMoreOperate&&(this.handleMoreActionLogEvent(e),"DOWNLOAD_ALL"!==e?this.$emit("moreAction",e):this.handleDownloadImages())},handleMoreActionLogEvent:function(e){var t="";switch(e){case"SAVE_ALL":t="click_save_all";break;case"DOWNLOAD_ALL":t="click_download_all";break;case"TASK_INFO":t="click_task_info";break;case"DELETE_ALL":t="click_delete_all"}t&&this.$logEvent("log_actions",{operation:t,behavior_info:"on_new_create_flow_page"})},handleDownloadImages:function(){var e,t,n=this;if(!this.isInDownloadTask){var o={download_task_id:"",items:[]};o.items=((null===(e=this.message)||void 0===e?void 0:e.components)||[]).map((function(e){var t;return{index:e.index,id:null===(t=n.message)||void 0===t?void 0:t.id}})),null!==(t=o.items)&&void 0!==t&&t.length&&(this.isInDownloadTask=!0,Object(v.easyDownloadAllImages)(o).then((function(e){var t;if(1e4===(null==e||null===(t=e.status)||void 0===t?void 0:t.code)){var o=(null==e?void 0:e.data)||{},l=o.download_task_id,r=void 0===l?"":l;o.url;return n.pollingTask(r)}n.isInDownloadTask=!1})).catch((function(e){n.isInDownloadTask=!1})))}},stopTask:function(){this.pollingTimer&&window.clearTimeout(this.pollingTimer),this.pollingTimer=null,this.isInDownloadTask=!1},pollingTask:function(e){var t=this;return new Promise((function(n,o){t.isInDownloadTask=!0;var l={download_task_id:e,items:[]};t.pollingTimer=setTimeout((function(){Object(v.easyDownloadAllImages)(l).then((function(l){var r,c;if(1e4!==(null==l||null===(r=l.status)||void 0===r?void 0:r.code))return t.pollingTimer&&window.clearTimeout(t.pollingTimer),t.pollingTimer=null,t.$message.error(t.$t("ServerError")),t.isInDownloadTask=!1,void o();var d=(null==l||null===(c=l.data)||void 0===c?void 0:c.url)||"";["",null,void 0].includes(d)?t.pollingTask(e):(t.pollingTimer&&window.clearTimeout(t.pollingTimer),t.pollingTimer=null,t.isInDownloadTask=!1,t.openDownloadLink(d),t.handleClosePopover(),n())})).catch((function(e){t.$message.error(t.$t("ServerError")),t.isInDownloadTask=!1,o()}))}),1e3)}))},openDownloadLink:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=e,a.download="image_download",a.click(),document.body.removeChild(a)}},handleClosePopover:function(){try{this.$refs.myPopover.doClose()}catch(e){}}}},C=y,w=(n(4383),n(4384),n(0)),component=Object(w.a)(C,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S,O,P,M,L,$,D,j,E=this,A=E._self._c;return A("div",{staticClass:"c-easy-msg-item-header"},[A("div",{staticClass:"msg-item-header-info-panel",class:[E.isFoldPrompt&&"align-items-center"]},[A("div",{staticClass:"msg-item-header-info-panel-tag"},[E._v(E._s(E.$t(E.convertTaskType)))]),E._v(" "),A("div",{staticClass:"msg-item-header-info-panel-prompt-box",class:[E.isFoldPrompt&&"align-items-center"]},[A("div",{ref:"promptBox",staticClass:"info-panel-prompt-box-content",class:[E.isFoldPrompt&&"text-ellipsis"]},[[1,2,16].includes(null===(e=E.message)||void 0===e?void 0:e.task_domain_type)?[E._v("\n          "+E._s(null===(t=E.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name)+"\n        ")]:[E._v("\n          "+E._s(E.removeCameraMarkers(E.setI18nPrompt))+"\n        ")]],2),E._v(" "),[1,2,16].includes(null===(n=E.message)||void 0===n?void 0:n.task_domain_type)?E._e():[[21].includes(null===(o=E.message)||void 0===o?void 0:o.task_domain_type)?E._e():A("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:E.$t("newGenerate67"),placement:"bottom"}},[A("span",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0].includes(E.setI18nPrompt),expression:"!['', null, void 0].includes(setI18nPrompt)"}],staticClass:"info-panel-prompt-box-icon iconfont icon-a-icon-TopPrompt",on:{click:function(e){return e.stopPropagation(),E.handleSendAll(E.setI18nPrompt)}}})]),E._v(" "),A("span",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0].includes(E.setI18nPrompt),expression:"!['', null, void 0].includes(setI18nPrompt)"}],staticClass:"info-panel-prompt-box-icon iconfont icon-i18n_prompt",on:{click:function(e){return e.stopPropagation(),E.toggleI18nPrompt.apply(null,arguments)}}})],E._v(" "),A("span",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0].includes(E.setI18nPrompt)&&E.showFoldBtn,expression:"!['', null, void 0].includes(setI18nPrompt) && showFoldBtn"}],staticClass:"info-panel-prompt-box-icon",class:[E.isFoldPrompt?"iconfont icon-add-tag":"el-icon-minus"],on:{click:function(e){return e.stopPropagation(),E.toggleFoldPromptStatus.apply(null,arguments)}}})],2)]),E._v(" "),A("div",{staticClass:"msg-item-header-operate-bar",class:[!E.isFoldPrompt&&"align-items-flex-start"]},[[1,2,15,16].includes(null===(l=E.message)||void 0===l?void 0:l.task_domain_type)?[A("div",{staticClass:"operate-bar-model-card",on:{click:function(e){var t;return e.stopPropagation(),E.handleJumpModelDetail(null===(t=E.message)||void 0===t?void 0:t.creativity)}}},[A("el-image",{staticClass:"operate-bar-model-card-img",attrs:{src:E.getRenderImageUrl}},[A("template",{slot:"error"},[A("div",{staticClass:"operate-bar-model-card-img"})])],2),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info"},[A("div",{staticClass:"operate-bar-model-card-info-title"},[E._v(E._s(E.$t(E.getAppType)))]),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info-sub-title"},[E._v(E._s(null===(r=E.message)||void 0===r||null===(r=r.creativity)||void 0===r?void 0:r.name))])])],1)]:[E._l((null===(c=E.message)||void 0===c?void 0:c.ckpts)||[],(function(e){var t;return[A("div",{key:null==e?void 0:e.id,staticClass:"operate-bar-model-card",on:{click:function(t){return t.stopPropagation(),E.handleJumpModelDetail(e)}}},[A("el-image",{staticClass:"operate-bar-model-card-img",attrs:{src:null==e||null===(t=e.banner)||void 0===t?void 0:t.url}},[A("template",{slot:"error"},[A("div",{staticClass:"operate-bar-model-card-img"})])],2),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info"},[A("div",{staticClass:"operate-bar-model-card-info-title"},[E._v(E._s(E.$t("Model")))]),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info-sub-title"},[E._v(E._s(null==e?void 0:e.name))])])],1)]})),E._v(" "),A("message-lora-popup",{attrs:{message:E.message}},[null!==(d=E.message)&&void 0!==d&&null!==(d=d.loras)&&void 0!==d&&d.length?A("div",{staticClass:"operate-bar-model-card"},[A("img",{staticClass:"operate-bar-model-card-img",attrs:{src:null===(v=E.getFirstLora)||void 0===v||null===(v=v.banner)||void 0===v?void 0:v.url,alt:""}}),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info"},[A("div",{staticClass:"operate-bar-model-card-info-title"},[E._v(E._s(E.$t(E.getFirstLoraType)))]),E._v(" "),A("div",{staticClass:"operate-bar-model-card-info-sub-title"},[E._v(E._s(null===(m=E.getFirstLora)||void 0===m?void 0:m.name))])])]):E._e()])],E._v(" "),[3,"3"].includes(null===(h=E.message)||void 0===h?void 0:h.status)?A("div",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0,0].includes(null===(f=E.message)||void 0===f||null===(f=f.components[0])||void 0===f?void 0:f.width),expression:"!['', null, void 0, 0].includes(message?.components[0]?.width)"}],staticClass:"operate-bar-num-card"},[A("span",{staticClass:"operate-bar-num-card-icon iconfont icon-home_icon_lora"}),E._v(" "),A("span",{staticClass:"operate-bar-num-card-text operate-bar-num-card-text-100"},[E._v(E._s("".concat(null===(_=E.message)||void 0===_||null===(_=_.components[0])||void 0===_?void 0:_.width," x ").concat(null===(y=E.message)||void 0===y||null===(y=y.components[0])||void 0===y?void 0:y.height))+"px")])]):E._e(),E._v(" "),3===(null===(C=E.message)||void 0===C?void 0:C.status)&&1===(null===(w=E.message)||void 0===w?void 0:w.sub_status)?A("el-tooltip",{attrs:{effect:"dark",content:E.$t("cost_fail_tips1"),placement:"top"}},[A("i",{staticClass:"iconfont icon-warning-error",staticStyle:{color:"#e15f5f","font-size":"13px"}})]):E._e(),E._v(" "),E.isMyMsg&&E.isLoggedIn?A("el-popover",{attrs:{trigger:"hover","popper-class":"custom-popver"}},[A("div",{staticClass:"easy-task-info-tips"},[A("p",[A("span",{staticClass:"task-info-tips-label"},[E._v(E._s(E.$t("TaskID")))]),A("span",{staticClass:"task-info-tips-copy",on:{click:function(e){return E.handleCopyAll(E.message.id)}}},[E._v(E._s(E.message.id)+" "),A("i",{staticClass:"iconfont icon-copy-ops"})])]),E._v(" "),3!==E.message.status||E.isCompanyAccount?E._e():[[1,2,"1","2"].includes(null===(k=E.message)||void 0===k?void 0:k.pub_community)?A("p",[A("span",{staticClass:"task-info-tips-label"},[E._v(E._s(E.$t("status")))]),E._v(" "),A("span",{staticClass:"task-pub-status"},[E._v(E._s([2,"2"].includes(null===(I=E.message)||void 0===I?void 0:I.pub_community)?E.$t("createSetting1"):E.$t("createSetting2")))])]):E._e(),E._v(" "),A("p",[A("span",{staticClass:"task-info-tips-label"},[E._v(E._s(E.$t("expend")))]),E._v(" "),A("span",{staticClass:"task-info-tips-content"},[A("span",[E._v(E._s(E.$t("tempCoins"))+" : "+E._s(null===(x=E.message)||void 0===x||null===(x=x.deduction_detail)||void 0===x?void 0:x.temp_hashrate))]),E._v(" "),A("span",[E._v(E._s(E.$t("calculateCoins"))+" : "+E._s(null===(T=E.message)||void 0===T||null===(T=T.deduction_detail)||void 0===T?void 0:T.hashrate))])])]),E._v(" "),null!==(S=E.message)&&void 0!==S&&null!==(S=S.deduction_detail)&&void 0!==S&&S.history_hashrate?A("p",[A("span",{staticClass:"task-info-tips-label"},[E._v(E._s(E.$t("currentBalance")))]),E._v(" "),A("span",{staticClass:"task-info-tips-content"},[A("span",[E._v(E._s(E.$t("tempCoins"))+" : "+E._s(null===(O=E.message)||void 0===O||null===(O=O.deduction_detail)||void 0===O?void 0:O.after_temp_hashrate))]),E._v(" "),A("span",[E._v(E._s(E.$t("calculateCoins"))+" : "+E._s(null===(P=E.message)||void 0===P||null===(P=P.deduction_detail)||void 0===P?void 0:P.after_hashrate))])])]):E._e(),E._v(" "),E.message.create_at?A("p",[A("span",{staticClass:"task-info-tips-label"},[E._v(E._s(E.$t("newGenerate26")))]),E._v(" "),A("span",{staticClass:"task-info-tips-text"},[E._v(E._s(E._f("formatDateTime")(E.message.create_at)))])]):E._e()]],2),E._v(" "),A("div",{staticClass:"msg-item-header-operate-bar-refresh-btn",attrs:{slot:"reference"},slot:"reference"},[A("i",{staticClass:"iconfont icon-icon-information"})])]):E._e(),E._v(" "),E.isLoggedIn?E._e():[A("div",{staticClass:"msg-item-header-operate-bar-refresh-btn",on:{click:function(e){return e.stopPropagation(),E.handleMoreActionClick.apply(null,arguments)}}},[A("i",{staticClass:"iconfont icon-icon-information"})])],E._v(" "),A("div",{directives:[{name:"show",rawName:"v-show",value:E.allowRestartOperate,expression:"allowRestartOperate"}],staticClass:"msg-item-header-operate-bar-refresh-btn",attrs:{"data-id":null===(M=E.message)||void 0===M?void 0:M.id,"data-info":E.getRetryLogEventInfo},on:{click:function(e){return e.stopPropagation(),E.handleRefreshTask.apply(null,arguments)}}},[A("i",{staticClass:"iconfont icon-refresh-icon2"})]),E._v(" "),E.isLoggedIn&&E.moreActionsShow&&E.allowRefreshOrMoreOperate&&null!==(L=E.easyTop)&&void 0!==L&&L.isShowPopup?A("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"easy-msg-item-more-popover","visible-arrow":!1,trigger:"click"},model:{value:E.morePopoverVisible,callback:function(e){E.morePopoverVisible=e},expression:"morePopoverVisible"}},[A("div",{staticClass:"pop-btns flex"},[![3,"3"].includes(null===($=E.message)||void 0===$?void 0:$.status)||E.hasOtherType||E.hasAllSaved?E._e():A("button",{on:{click:function(e){return E.handleMoreAction("SAVE_ALL")}}},[A("span",{staticClass:"pop-btns-icon"},[A("i",{staticClass:"iconfont icon-workflow_icon_save"})]),E._v(" "),A("span",{staticClass:"pop-btns-text"},[E._v(E._s(E.$t("newGenerate13")))])]),E._v(" "),E.isVideoModel||![3,"3"].includes(null===(D=E.message)||void 0===D?void 0:D.status)||E.hasOtherType?E._e():A("button",{attrs:{"data-event":"generate_pop_click_download_all"},on:{click:function(e){return E.handleMoreAction("DOWNLOAD_ALL")}}},[A("span",{staticClass:"pop-btns-icon"},[A("i",{class:[E.isInDownloadTask?"el-icon-loading":"iconfont icon-icon-Download"]})]),E._v(" "),A("span",{staticClass:"pop-btns-text"},[E._v(E._s(E.$t("newGenerate14")))])]),E._v(" "),[1,2,11,12,13,16].includes(null===(j=E.message)||void 0===j?void 0:j.task_domain_type)?E._e():A("button",{attrs:{"data-event":"generate_pop_click_task_info"},on:{click:function(e){return E.handleMoreAction("TASK_INFO")}}},[A("span",{staticClass:"pop-btns-icon"},[A("i",{staticClass:"iconfont icon-icon-information"})]),E._v(" "),A("span",{staticClass:"pop-btns-text"},[E._v(E._s(E.$t("newGenerate15")))])]),E._v(" "),E.checkPermission||E.checkIsChannelOwner?A("button",{attrs:{"data-event":"generate_pop_click_delete_all"},on:{click:function(e){return E.handleMoreAction("DELETE_ALL")}}},[A("span",{staticClass:"pop-btns-icon"},[A("i",{staticClass:"iconfont icon-Trash2"})]),E._v(" "),A("span",{staticClass:"pop-btns-text"},[E._v(E._s(E.$t("DeleteAll")))])]):E._e()]),E._v(" "),A("div",{staticClass:"msg-item-header-operate-bar-more-btn",attrs:{slot:"reference"},on:{click:E.handleClickMore},slot:"reference"},[A("i",{staticClass:"iconfont icon-more"})])]):E._e(),E._v(" "),E.isLoggedIn?E._e():[A("div",{staticClass:"msg-item-header-operate-bar-more-btn",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),E.handleMoreActionClick.apply(null,arguments)}},slot:"reference"},[A("i",{staticClass:"iconfont icon-more"})])]],2)])}),[],!1,null,"1a361f22",null);t.default=component.exports},1174:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(16),n(24),n(1175)),r=n(1),c=n(10);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var v={name:"EasyTaskInfoPopup",components:{EasyMetaTooltip:l.default},props:{message:{type:Object,default:function(){return{}}},loraModeObj:{type:Object},isMyMsg:{type:Boolean,default:!1},isShowExpireTime:{type:[Boolean,Number],default:!1},expireTime:{type:String,default:""}},data:function(){return{visible:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(r.c)("user",["isCompanyAccount"])),methods:{show:function(){this.visible=!0},handleClose:function(){this.visible=!1,this.$emit("close")},handleUpdateModelName:function(e,t){this.$emit("updateModelName",e,t)},handleCopyGenerationData:function(){this.$emit("copyGenerationData")},setLoraModel:function(e){this.$emit("setLoraModel",e)},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(content)||(Object(c.g)(content),this.$message.success(this.$t("CopySuccess")))}}},m=v,h=(n(4386),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"easy-task-info-popup","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"","append-to-body":"",width:"322px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"easy-task-info-popup-header"},[t("div",{staticClass:"modal-header-title"},[t("span",{staticClass:"modal-header-title-text"},[e._v(e._s(e.$t("newGenerate15")))])]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),e.visible?t("div",{staticClass:"easy-task-info-popup-content"},[t("easy-meta-tooltip",{attrs:{meta:e.message.meta,msgId:e.message.id,loraModels:e.loraModeObj,model:e.message.art_model_no,category:e.message.category,message:e.message,"model-name":e.message.art_model_name},on:{updateModelName:e.handleUpdateModelName,copyGenerationData:e.handleCopyGenerationData,setLoraModel:e.setLoraModel}})],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{EasyMetaTooltip:n(1175).default})},1175:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(18);var o=n(14),l=n(2),r=(n(11),n(6),n(73),n(22),n(24),n(8),n(12),n(13),n(4),n(28),n(43),n(21),n(77),n(7),n(44),n(1)),c=n(29),d=n(10),v=n(165);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"EasyMetaTooltip",props:{meta:{type:Object,require:!0,default:function(){return{}}},message:{type:Object,default:function(){return{}}},sourceFrom:{type:String,default:""},model:{type:String,default:""},modelName:{type:String,default:""},category:{type:[String,Number],default:1},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},showCreate:{type:Boolean,default:!0}},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0"),v=t.getSeconds().toString().padStart(2,"0");return Object(d.F)(t,new Date)?"".concat(r,":").concat(c,":").concat(v):"".concat(n,"/").concat(o,"/").concat(l," ").concat(r,":").concat(c,":").concat(v)}},data:function(){return{intLoraModel:[],loading:!1}},computed:h(h(h(h({},Object(r.c)("user",["isLoggedIn"])),Object(r.e)("creation",["generateViewShow"])),Object(r.c)("creation",["studioStyle","lab_styles"])),{},{getModelList:function(){var e,t,n,l=(null===(e=this.message)||void 0===e?void 0:e.art_model)||{};l=h(h({},l),{},{type:"Checkpoint"});var r=((null===(t=this.message.meta)||void 0===t?void 0:t.lora_models)||[]).map((function(e){var t,n;return h(h(h({},e),(null==e?void 0:e.art_model)||{}),{},{type:"LoCon"===(null==e||null===(t=e.art_model)||void 0===t?void 0:t.type)?"LyCORIS":(null==e||null===(n=e.art_model)||void 0===n?void 0:n.type)||"LORA"})}));return l&&null!==(n=l)&&void 0!==n&&n.id?[l].concat(Object(o.a)(r)):r},convertTaskType:function(){var e;return v.b[null===(e=this.message)||void 0===e?void 0:e.task_domain_type]||v.c[this.message.type]||""},isSdModel:function(){return[5,"5","sdxl"].includes(null==this?void 0:this.category)},isStudioModel:function(){return[7,"7","studio",11].includes(null==this?void 0:this.category)},studioRenderList:function(){var e=this;return(this.lab_styles||[]).map((function(t){var n="labStyle_".concat(t.value.replace(/\s/g,""));return{label:e.$t(n)||t.value,id:t.value}}))},getStudioStyle:function(){var e,t=(null===(e=this.meta)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.style_selections)||[];return(this.studioRenderList||[]).filter((function(e){return t.includes(e.id)})).map((function(e){return e.label})).join("、")||""}}),mounted:function(){this.msgId&&this.getMsgInfo()},methods:{handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(content)||(this.$logEvent("log_actions",{operation:"click_copy",behavior_info:"on_new_create_flow_page",behavior_info_sub:"on_task_info"}),Object(d.g)(content),this.$message.success(this.$t("CopySuccess")))},getMsgInfo:function(){var e=this;this.loading=!0;var t=0===Object.keys(this.loraModels).length,n=["",null,void 0].includes(this.modelName),o=![this.loraModels&&this.loraModels[this.msgId]];[t,n,o].some((function(e){return e}))?Object(c.getMetaInfo)({id:this.msgId,task_flow_version:"v2"}).then((function(n){var o,l;if(1e4===n.status.code){e.intLoraModel=(null===(o=n.data.meta)||void 0===o?void 0:o.lora_models)||[];var r=(null==n||null===(l=n.data)||void 0===l?void 0:l.art_model_name)||"",c={};c[e.msgId]=e.intLoraModel,["",null,void 0].includes(e.modelName)&&e.$emit("updateModelName",r,null==n?void 0:n.data),t&&e.$emit("setLoraModel",c)}})).finally((function(){e.loading=!1})):this.loading=!1,this.intLoraModel&&!this.intLoraModel.length&&(this.intLoraModel=this.loraModels[this.msgId]||[])},handleClick:function(){this.$logEvent("log_actions",{operation:"click_retry",behavior_info:"on_new_create_flow_page",behavior_info_sub:"on_task_info"}),this.$emit("copyGenerationData",{model:this.model,meta:this.meta})},openLora:function(e){window.open("/models/detail/"+e.art_model.id)},handleJumpDetail:function(e){["",null,void 0].includes(null==e?void 0:e.id)||window.open("/models/detail/".concat(null==e?void 0:e.id),"_blank")}}},_=f,y=(n(4385),n(0)),component=Object(y.a)(_,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C=this,w=C._self._c;return w("div",{directives:[{name:"loading",rawName:"v-loading",value:C.loading,expression:"loading"}],staticClass:"easy-tooltip-wraper"},[null!==(e=C.meta)&&void 0!==e&&e.prompt?w("div",[w("div",{staticClass:"easy-tooltip-wraper-title"},[w("span",{staticClass:"easy-tooltip-wraper-title-text"},[C._v(C._s(C.$t("Prompt")))]),C._v(" "),w("span",{directives:[{name:"show",rawName:"v-show",value:null===(t=C.meta)||void 0===t?void 0:t.prompt,expression:"meta?.prompt"}],staticClass:"easy-tooltip-wraper-title-icon iconfont icon-codeCopy1",on:{click:function(e){var t;return e.stopPropagation(),C.handleCopyAll(null===(t=C.meta)||void 0===t?void 0:t.prompt)}}})]),C._v(" "),w("div",{staticClass:"promptDesc"},[C._v("\n      "+C._s(null===(n=C.meta)||void 0===n?void 0:n.prompt)+"\n    ")])]):C._e(),C._v(" "),null!==(o=C.meta)&&void 0!==o&&o.negative_prompt?w("div",[w("div",{staticClass:"easy-tooltip-wraper-title"},[w("span",{staticClass:"easy-tooltip-wraper-title-text"},[C._v(C._s(C.$t("NegativePrompts")))]),C._v(" "),w("span",{directives:[{name:"show",rawName:"v-show",value:null===(l=C.meta)||void 0===l?void 0:l.negative_prompt,expression:"meta?.negative_prompt"}],staticClass:"easy-tooltip-wraper-title-icon iconfont icon-codeCopy1",on:{click:function(e){var t;return e.stopPropagation(),C.handleCopyAll(null===(t=C.meta)||void 0===t?void 0:t.negative_prompt)}}})]),C._v(" "),w("div",{staticClass:"promptDesc"},[C._v("\n      "+C._s(null===(r=C.meta)||void 0===r?void 0:r.negative_prompt)+"\n    ")])]):C._e(),C._v(" "),w("div",{staticClass:"easy-tooltip-wraper-params-box"},[w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("newGenerate27")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(C.$t(C.convertTaskType)))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("newGenerate26")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(C._f("formatDateTime")(C.message.create_at)))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("imageDimensions")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v("\n        "+C._s("".concat(null===(c=C.message)||void 0===c||null===(c=c.components[0])||void 0===c?void 0:c.width," x ").concat(null===(d=C.message)||void 0===d||null===(d=d.components[0])||void 0===d?void 0:d.height))+" px\n      ")])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("Seed")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(null===(v=C.meta)||void 0===v?void 0:v.seed))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("Sampler")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(null===(m=C.meta)||void 0===m?void 0:m.sampler_name))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("Steps")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(null===(h=C.meta)||void 0===h?void 0:h.steps))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("CFGScale")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s(null===(f=C.meta)||void 0===f?void 0:f.cfg_scale))])]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item"},[w("div",{staticClass:"easy-tooltip-params-item-title"},[C._v(C._s(C.$t("clipSkip")))]),C._v(" "),w("div",{staticClass:"easy-tooltip-params-item-content"},[C._v(C._s((null===(_=C.meta)||void 0===_?void 0:_.clip_skip)||""))])])]),C._v(" "),null!==(y=C.getModelList)&&void 0!==y&&y.length?w("div",{directives:[{name:"show",rawName:"v-show",value:!C.loading,expression:"!loading"}],staticClass:"easy-tooltip-wraper-model-box"},C._l(C.getModelList,(function(e,t){var n;return w("div",{key:"model_i_".concat(t),staticClass:"easy-tooltip-wraper-model-box-item"},[w("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[w("img",{attrs:{src:null==e||null===(n=e.banner)||void 0===n?void 0:n.url,alt:""}})]),C._v(" "),w("div",{staticClass:"easy-tooltip-wraper-model-box-item-content",on:{click:function(t){return t.stopPropagation(),C.handleJumpDetail(e)}}},[w("div",{staticClass:"easy-tooltip-model-box-model-header"},[w("span",{staticClass:"easy-tooltip-model-box-model-type"},[C._v(C._s(C.$t(null==e?void 0:e.type)))]),C._v(" "),w("div",{staticClass:"easy-tooltip-model-box-model-name",attrs:{title:null==e?void 0:e.name}},[C._v(C._s((null==e?void 0:e.name)||""))])]),C._v(" "),"Checkpoint"===(null==e?void 0:e.type)||["",null,void 0].includes(null==e?void 0:e.weight)?C._e():w("div",{staticClass:"easy-tooltip-model-box-model-strength"},[w("span",{staticClass:"easy-tooltip-model-box-model-strength-label"},[C._v(C._s(C.$t("Strength"))+" : ")]),C._v(" "),w("span",{staticClass:"easy-tooltip-model-box-model-strength-value"},[C._v(C._s(null==e?void 0:e.weight))])])])])})),0):C._e(),C._v(" "),C.showCreate?w("div",{staticClass:"easy-meta-tooltip-divider-line"}):C._e(),C._v(" "),C.showCreate?w("div",{staticClass:"copyClass",on:{click:C.handleClick}},[C._v("\n    "+C._s(C.$t("Generate"))+"\n  ")]):C._e()])}),[],!1,null,"690377b0",null);t.default=component.exports},1234:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(3),l=n(30),r=n(2),c=(n(20),n(16),n(22),n(31),n(18),n(24),n(8),n(21),n(90),n(1)),d=n(363),v=n(83),m=n(872),h=n(873),f=n(874),_=n(875),y=n(182);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={inject:["top"],props:{itemData:{type:Object,default:function(){}},storagekey:{type:String,default:""},index:{type:Number,default:0},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:d.default,HyUploadMoald:v.default,GuestUpload:m.default,ExampleImage:h.default,ImageReversePrompt:f.default,MaskModal:_.default,NodeTips:y.default},data:function(){return{category:20,pendingFile:[],isPendingUpload:!1,isTextEllipsis:!1,isDragOver:!1}},computed:w(w({},Object(c.c)("user",["isLoggedIn"])),{},{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}},enableMaskEdit:function(){var e=(this.itemData||{}).option,option=void 0===e?{}:e;return null==option?void 0:option.is_mask_draw},upModalObj:function(){var e;return{template_id:(null===(e=this.top)||void 0===e||null===(e=e.workFlowAppData)||void 0===e?void 0:e.id)||""}},showReverseSwitch:function(){var e;return!(null===(e=this.itemData)||void 0===e||null===(e=e.reverse_node_ids)||void 0===e||!e.length)}}),watch:{isLoggedIn:function(){this.uploadPendingFile()}},mounted:function(){this.checkTextEllipsis(),this.uploadPendingFile()},methods:{changeValue:function(e){this.top.changeVal(w(w({},this.idsObj),{},{val:e}),this.index)},confirmMask:function(mask){this.changeValue(mask)},checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.titleRef;t&&(e.isTextEllipsis=t.scrollWidth>t.clientWidth)}))},reverrsePrompt:function(){var e;null===(e=this.$refs)||void 0===e||null===(e=e.imageReversePromptRef)||void 0===e||e.switchReverrsePrompt()},selectExampleImage:function(e){var t;this.isPendingUpload||(this.$logEvent("log_actions",{operation:"click_sample_image",behavior_info:"on_new_createflow_page",behavior_info_sub:(null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t?void 0:t.name)||""}),this.uploadHandleConfirm([{url:e}]))},reUpload:function(){this.isPendingUpload||(this.isLoggedIn?this.$refs.hyUploadMoald.openModal():this.$refs.guestUploadRef.reUpload())},handleUpload:function(){this.isPendingUpload||this.$refs.hyUploadMoald.openModal()},openGenerateModal:function(){var e;this.enableMaskEdit&&(this.$logEvent("log_actions",{operation:"click_edit_mask",behavior_info:"on_app_detail_page"}),null===(e=this.$refs)||void 0===e||null===(e=e.maskModal)||void 0===e||e.show(this.itemData.val))},uploadHandleConfirm:function(e){var t=Object(l.a)(e,1)[0];this.changeValue(t.url)},handleDelete:function(){this.changeValue("")},uploadPendingFile:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn&&null!==(n=e.pendingFile)&&void 0!==n&&n.length){t.next=2;break}return t.abrupt("return");case 2:e.isPendingUpload=!0,e.$refs.guestUploadRef.handleChange(e.pendingFile[0],e.pendingFile.slice(0,1)),e.pendingFile=[];case 5:case"end":return t.stop()}}),t)})))()},uploadSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isPendingUpload=!1;var t=e.map((function(e){var t=e.url,n=e.width,o=e.height;return{id:"",url:t,width:n,height:o,info:{id:"",channel:"upload",cover:{url:t,width:n,height:o,img_category:20}}}}));this.isLoggedIn?this.$emit("uploadSuccess",t.map((function(e){return e.info.cover}))):this.storageTempData(t),this.uploadHandleConfirm(t)},onUploadFail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isPendingUpload=!1,this.pendingFile=e},storageTempData:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:[],l=t.itemData,r=l.node_id,c=l.node_type,d=t.$route.params.id,v=localStorage.getItem("".concat(t.storagekey)),(m=v?JSON.parse(v):{})[d]||(m[d]=[]),null!=o&&o.length&&m[d].push({id:d,category:t.category,nodeId:r,nodeType:c,url:o[0].url,width:o[0].width,height:o[0].height}),localStorage.setItem("".concat(t.storagekey),JSON.stringify(m));case 8:case"end":return n.stop()}}),n)})))()},handleDragEnter:function(e){e.preventDefault(),e.stopPropagation(),this.isPendingUpload||this.itemData.isPreview||(this.isDragOver=!0)},handleDragLeave:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,n=e.relatedTarget;n&&t.contains(n)||(this.isDragOver=!1)},handleDrop:function(e){if(e.preventDefault(),e.stopPropagation(),this.isDragOver=!1,!this.isPendingUpload&&!this.itemData.isPreview){var t=e.dataTransfer.files,n=e.dataTransfer.getData("text/uri-list");if(n&&n.includes("seaart.me"))this.changeValue(n);else if(t.length>0){var o=t[0];o.type.startsWith("image/")&&this.processDragFile(o)}}},processDragFile:function(e){if(e){var t={name:e.name,raw:e,percentage:0,status:"ready",uid:Date.now(),size:e.size};this.isPendingUpload=!0,this.$refs.guestUploadRef.handleChange(t,[t])}},handleFileChange:function(e){var t=e.target?e.target.files[0]:e;this.processDragFile(t)}}},I=k,x=(n(4339),n(4340),n(0)),component=Object(x.a)(I,(function(){var e,t,n,o=this,l=o._self._c;return l("div",{staticClass:"image-field"},[l("div",{staticClass:"image-field-top"},[l("div",{staticClass:"image-field-top-left"},[l("el-tooltip",{attrs:{content:o.itemData.title,placement:"top",disabled:!o.isTextEllipsis}},[l("div",{ref:"titleRef",staticClass:"image-field-top-left-title"},[o._v("\n          "+o._s(o.itemData.title)+"\n        ")])]),o._v(" "),l("NodeTips",{attrs:{itemData:o.itemData,currentWorkFlow:o.currentWorkFlow}})],1),o._v(" "),l("el-tooltip",{attrs:{content:o.$t("ai_app_smart_prompt_tip"),placement:"top","open-delay":200}},[o.showReverseSwitch?l("div",{staticClass:"btn-area",attrs:{"data-group":"ai-app-smart-prompt","data-desc":"ai应用智能提示"},on:{click:o.reverrsePrompt}},[l("i",{staticClass:"iconfont icon-zhinengtishi"}),o._v(" "),l("span",[o._v(o._s(o.$t("smart_prompt")))])]):o._e()])],1),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:o.itemData.val,expression:"itemData.val"},{name:"loading",rawName:"v-loading",value:o.isPendingUpload,expression:"isPendingUpload"}],staticClass:"image-field-display"},[l("img",{staticClass:"img",class:[o.enableMaskEdit&&"cursor-pointer"],attrs:{src:o.itemData.val,alt:"image"},on:{click:function(e){return e.stopPropagation(),o.openGenerateModal.apply(null,arguments)}}}),o._v(" "),l("div",{staticClass:"handle-btn reupload-btn",on:{click:o.reUpload}},[l("Icon",{attrs:{name:"a-icon-reselectimg",size:"16",color:"#fff"}})],1),o._v(" "),l("div",{staticClass:"handle-btn delete-btn",on:{click:o.handleDelete}},[l("Icon",{attrs:{name:"a-pyDelete1",size:"18",color:"#fff"}})],1),o._v(" "),o.enableMaskEdit?l("span",{staticClass:"edit-mask-btn",on:{click:function(e){return e.stopPropagation(),o.openGenerateModal.apply(null,arguments)}}},[o._v(o._s(o.$t("EditMask")))]):o._e()]),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:!o.itemData.val,expression:"!itemData.val"}],staticClass:"image-field-upload-box"},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isPendingUpload,expression:"isPendingUpload"},{name:"show",rawName:"v-show",value:o.isLoggedIn,expression:"isLoggedIn"}],staticClass:"pick-item",class:{"drag-over":o.isDragOver},on:{click:function(e){return e.stopPropagation(),o.handleUpload()},dragover:function(e){return e.preventDefault(),o.handleDragEnter.apply(null,arguments)},dragleave:function(e){return e.preventDefault(),o.handleDragLeave.apply(null,arguments)},drop:function(e){return e.preventDefault(),o.handleDrop.apply(null,arguments)}}},[l("input",{ref:"dragUploadInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".jpg,.png,.jpeg,.webp"},on:{change:o.handleFileChange}}),o._v(" "),l("i",{staticClass:"iconfont icon-Frame5"}),o._v(" "),l("div",{staticClass:"upload-item-text"},[o._v(o._s(o.$t("click_upload_or_drag")))])]),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:!o.isLoggedIn,expression:"!isLoggedIn"}],staticClass:"pick-item"},[l("guest-upload",{ref:"guestUploadRef",attrs:{fileTypes:["image"],videoCategory:61,category:o.category,uploadObj:{other:o.upModalObj},storagekey:o.storagekey},on:{onUploadStart:function(e){o.isPendingUpload=!0},onUploadEnd:function(e){o.isPendingUpload=!1},onUploadSuccess:o.uploadSuccess,onUploadFail:o.onUploadFail}})],1)]),o._v(" "),o.showReverseSwitch?l("ImageReversePrompt",{ref:"imageReversePromptRef",attrs:{data:o.itemData}}):o._e(),o._v(" "),null!==(e=o.itemData)&&void 0!==e&&null!==(e=e.example_image)&&void 0!==e&&e.length?l("ExampleImage",{attrs:{data:null===(t=o.itemData)||void 0===t?void 0:t.example_image,value:null===(n=o.itemData)||void 0===n?void 0:n.val},on:{selected:o.selectExampleImage}}):o._e(),o._v(" "),l("HyUploadMoald",{ref:"hyUploadMoald",attrs:{"is-need-login":!1,category:20,isSingleSelect:"",uploadObj:{other:o.upModalObj},recentlyUsedQueryObj:o.upModalObj,personalWorksQueryObj:o.upModalObj},on:{onConfirm:o.uploadHandleConfirm}}),o._v(" "),l("MaskModal",{ref:"maskModal",on:{confirm:o.confirmMask}})],1)}),[],!1,null,"60a39ff2",null);t.default=component.exports},1235:function(e,t,n){"use strict";n.r(t);n(18);var o=n(2),l=(n(11),n(19),n(6),n(12),n(13),n(8),n(4),n(7),n(363)),r=n(366),c=n(10);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={inject:["top"],props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:l.default,WorkflowStyleModal:r.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{"itemData.art_model":{handler:function(e){var t,n=(e||{}).art_model;n&&(this.displayData.name=null==n?void 0:n.name,this.displayData.url=null==n||null===(t=n.banner)||void 0===t?void 0:t.url,this.displayData.version_name=null==n?void 0:n.version_name)},deep:!0}},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}},mounted:function(){this.setArtModel()},methods:{setArtModel:function(){var e,t=(this.itemData||{}).art_model;t&&(this.displayData.name=null==t?void 0:t.name,this.displayData.url=null==t||null===(e=t.banner)||void 0===e?void 0:e.url,this.displayData.version_name=null==t?void 0:t.version_name)},changeUrl:function(e){return Object(c.K)(e,"high")},openModelSelect:function(){this.$refs.workflowStyleModal.openModal({modelType:"Checkpoint"})},handleSelectModel:function(e){var t=e.info,n=t||{},o=n.id,l=void 0===o?"":o,r=n.name,c=void 0===r?"":r,d=n.model_ver_no,m=void 0===d?"":d,h=n.version_name,f=void 0===h?"":h,_=n.banner,y=void 0===_?{}:_,C="".concat(l,"@").concat(m);this.displayData={name:c,url:(null==y?void 0:y.url)||"",version_name:f},this.top.changeNodeProperty(this.idsObj,"art_model",t||{}),this.top.changeVal(v(v({},this.idsObj),{},{val:C})),this.$refs.collapse.updateScrollHeight()}}},h=(n(4343),n(0)),component=Object(h.a)(m,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"checkpoint-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:t.itemData.title,itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}},[t.itemData.val?n("div",{staticClass:"checkpoint-field-content"},[n("div",{staticClass:"checkpoint-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[t._v("\n          "+t._s(t.displayData.version_name)+"\n        ")]),t._v(" "),null!==(e=t.displayData)&&void 0!==e&&e.url?n("el-image",{attrs:{fit:"cover",src:t.changeUrl(t.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[t._v("\n          "+t._s(t.$t("EmptyBannerText"))+"\n        ")]),t._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:t.displayData.name}},[t._v("\n          "+t._s(t.displayData.name)+"\n        ")])],1),t._v(" "),n("div",{staticClass:"checkpoint-field-content-right flex-center",on:{click:t.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:t.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),t._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:t.handleSelectModel}})],1)}),[],!1,null,"6783db6c",null);t.default=component.exports},1236:function(e,t,n){"use strict";n.r(t);n(18);var o=n(2),l=(n(11),n(19),n(6),n(12),n(13),n(8),n(4),n(7),n(363)),r=n(366),c=n(10);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={inject:["top"],props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:l.default,WorkflowStyleModal:r.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{itemData:{handler:function(e){var t,n=(e||{}).art_model;n&&(this.displayData.name=null==n?void 0:n.name,this.displayData.url=null==n||null===(t=n.banner)||void 0===t?void 0:t.url,this.displayData.version_name=null==n?void 0:n.version_name)},deep:!0}},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}},methods:{changeUrl:function(e){return Object(c.K)(e,"high")},openModelSelect:function(){this.$refs.workflowStyleModal.openModal({modelType:"LORA"})},handleSelectModel:function(e){var t=e.info||{},n=t.id,o=void 0===n?"":n,l=t.name,r=void 0===l?"":l,c=t.model_ver_no,d=void 0===c?"":c,m=t.version_name,h=void 0===m?"":m,f=t.banner,_=void 0===f?{}:f,y="".concat(o,"@").concat(d);this.displayData={name:r,url:(null==_?void 0:_.url)||"",version_name:h},this.top.changeVal(v(v({},this.idsObj),{},{val:y})),this.$refs.collapse.updateScrollHeight()}}},h=(n(4344),n(0)),component=Object(h.a)(m,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"lora-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:t.itemData.title,itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}},[t.itemData.val?n("div",{staticClass:"lora-field-content"},[n("div",{staticClass:"lora-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[t._v("\n          "+t._s(t.displayData.version_name)+"\n        ")]),t._v(" "),null!==(e=t.displayData)&&void 0!==e&&e.url?n("el-image",{attrs:{fit:"cover",src:t.changeUrl(t.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[t._v("\n          "+t._s(t.$t("EmptyBannerText"))+"\n        ")]),t._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:t.displayData.name}},[t._v("\n          "+t._s(t.displayData.name)+"\n        ")])],1),t._v(" "),n("div",{staticClass:"lora-field-content-right flex-center",on:{click:t.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:t.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),t._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:t.handleSelectModel}})],1)}),[],!1,null,"346118ec",null);t.default=component.exports},1237:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=n(363);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={inject:["top"],props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:l.default},data:function(){return{}},mounted:function(){},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}},methods:{changeValue:function(e){this.top.changeVal(c(c({},this.idsObj),{},{val:e}))}}},v=(n(4345),n(0)),component=Object(v.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slider-field"},[t("CollapseComponent",{attrs:{title:e.itemData.title,itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}},[t("el-slider",{attrs:{"show-input":"","show-input-controls":!1,value:e.itemData.val,min:e.itemData.option.min,max:e.itemData.option.max,step:e.itemData.option.step},on:{input:e.changeValue}})],1)],1)}),[],!1,null,"17fc1626",null);t.default=component.exports},1238:function(e,t,n){"use strict";n.r(t);n(4),n(41),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={inject:["top"],components:{NodeTips:n(182).default},props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{isTextEllipsis:!1}},mounted:function(){this.checkTextEllipsis()},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}},methods:{changeValue:function(e){this.top.changeVal(r(r({},this.idsObj),{},{val:e}))},checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.titleRef;t&&(e.isTextEllipsis=t.scrollWidth>t.clientWidth)}))}}},d=(n(4346),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-field"},[t("div",{staticClass:"select-field-top"},[t("el-tooltip",{attrs:{content:e.itemData.title,placement:"top",disabled:!e.isTextEllipsis,"open-delay":300}},[t("div",{ref:"titleRef",staticClass:"select-field-top-title"},[e._v(e._s(e.itemData.title))])]),e._v(" "),t("NodeTips",{attrs:{itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}})],1),e._v(" "),t("el-select",{staticClass:"custom-select-transparent",attrs:{"popper-class":"painting-board-select",value:e.itemData.val,"popper-append-to-body":!0},on:{change:e.changeValue}},e._l(e.itemData.option.values,(function(e){return t("el-option",{key:"key"+e,attrs:{label:e,value:e}})})),1)],1)}),[],!1,null,"d4b26b9e",null);t.default=component.exports},1239:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={inject:["top"],components:{NodeTips:n(182).default},props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{seedMode:"random",numVal:{random:0,custom:0},isTextEllipsis:!1}},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}},isRandom:function(){return"random"===this.seedMode},seedPlsHd:function(){return this.isRandom?this.$t("RandomSeed"):this.$t("customSeed")},getVal:function(){var e=this.numVal,t=e.random,n=e.custom;return this.isRandom?t:n}},watch:{numVal:{handler:function(){this.top.changeVal(r(r({},this.idsObj),{},{val:this.getVal}))},deep:!0,immediate:!0}},mounted:function(){this.checkTextEllipsis()},methods:{initData:function(){this.numVal.random=this.getRandomSeed(),this.numVal.custom=this.getRandomSeed()},changeSeedMode:function(e){this.seedMode=e,this.isRandom?this.numVal.random=this.getRandomSeed():this.top.changeVal(r(r({},this.idsObj),{},{val:this.getVal}))},changeValue:function(e){this.isRandom?this.numVal.random=e:this.numVal.custom=e},getRandomSeed:function(){return Math.floor(4294967294*Math.random())+1},checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.titleRef;t&&(e.isTextEllipsis=t.scrollWidth>t.clientWidth)}))}}},d=(n(4347),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"seed-field"},[t("div",{staticClass:"seed-field-top"},[t("div",{staticClass:"seed-field-top-left"},[t("el-tooltip",{attrs:{content:e.itemData.title,placement:"top",disabled:!e.isTextEllipsis,"open-delay":300}},[t("div",{ref:"titleRef",staticClass:"seed-field-top-left-title"},[e._v(e._s(e.itemData.title))])]),e._v(" "),t("NodeTips",{attrs:{itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}})],1),e._v(" "),t("div",{staticClass:"seed-field-top-switch"},[t("button",{staticClass:"switch-btn",class:{active:e.isRandom},on:{click:function(t){return e.changeSeedMode("random")}}},[e._v("\n        "+e._s(e.$t("Random"))+"\n      ")]),e._v(" "),t("button",{staticClass:"switch-btn",class:{active:!e.isRandom},on:{click:function(t){return e.changeSeedMode("custom")}}},[e._v("\n        "+e._s(e.$t("Customization"))+"\n      ")])])]),e._v(" "),t("div",{staticClass:"seed-field-content flex-center"},[t("el-input-number",{attrs:{placeholder:e.seedPlsHd,precision:0,controls:!1,min:-1,disabled:e.isRandom,value:e.getVal},on:{input:e.changeValue}})],1)])}),[],!1,null,"599c2f27",null);t.default=component.exports},1240:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),l=n(2),r=(n(20),n(16),n(4),n(21),n(1)),c=n(363),d=n(181);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"VideoField",inject:["top","easyTop"],props:{itemData:{type:Object,default:function(){return{}}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:c.default},data:function(){return{uploading:!1,accept:"video/mp4"}},computed:m(m({},Object(r.c)("user",["isLoggedIn"])),{},{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}}),mounted:function(){},beforeDestroy:function(){},methods:{handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["video/mp4"].includes(e.type)){n.next=4;break}return t.$message.error(t.$t("OnlySupportVideo")),n.abrupt("return");case 4:if(!(e.size/1024/1024>100)){n.next=8;break}return t.$message.error(t.$t("UploadImageExceedCustomMB",{number:100})),n.abrupt("return");case 8:return n.next=10,t.handleUploadVideo(e);case 10:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(e){var t=this;return this.uploading=!0,new d.a({file:e,category:20,maxSize:104857600}).beforeUpload().then((function(e){var n=e.url,o=void 0===n?"":n;t.top.changeVal(m(m({},t.idsObj),{},{val:o})),t.uploading=!1})).catch((function(e){t.uploading=!1})).finally((function(){t.uploading=!1}))},handleDelete:function(){this.top.changeVal(m(m({},this.idsObj),{},{val:""}))}}},f=(n(4348),n(0)),component=Object(f.a)(h,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"video-field"},[n("CollapseComponent",{attrs:{title:t.itemData.title,itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}},[t.itemData.val?n("div",{staticClass:"video-field-display"},[n("video",{ref:"mainVideo",staticClass:"video width-height-hundred",attrs:{autoplay:"",muted:"",loop:"",src:null===(e=t.itemData)||void 0===e?void 0:e.val},domProps:{muted:!0}}),t._v(" "),n("i",{staticClass:"iconfont delete-icon icon-shanchu",on:{click:t.handleDelete}})]):n("div",{staticClass:"video-field-upload-box"},[n("el-upload",{attrs:{action:"#","before-upload":t.handleBeforeUpload,"show-file-list":!1,accept:t.accept,"http-request":function(){}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],staticClass:"uploader"},[n("i",{staticClass:"el-icon-plus"})])])],1)])],1)}),[],!1,null,"f15654b4",null);t.default=component.exports},1241:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),l=n(2),r=(n(20),n(16),n(4),n(21),n(1)),c=n(363),d=n(584),v=n(289);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"AudioField",inject:["top"],props:{itemData:{type:Object,default:function(){return{}}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:c.default,CAudio:v.default},data:function(){return{uploading:!1,accept:"audio/mp3,audio/wav,audio/ogg,audio/aac,audio/mpeg,audio/flac"}},computed:h(h({},Object(r.c)("user",["isLoggedIn"])),{},{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}}),mounted:function(){},beforeDestroy:function(){},methods:{handleBeforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["audio/mp3","audio/wav","audio/ogg","audio/aac","audio/mpeg","audio/flac"].includes(e.type)){n.next=4;break}return t.$message.error(t.$t("OnlySupportAudio")),n.abrupt("return");case 4:if(!(e.size/1024/1024>150)){n.next=8;break}return t.$message.error(t.$t("audioUploadMaxError")),n.abrupt("return");case 8:return n.next=10,t.handleUploadVideo(e);case 10:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(e){var t=this;return this.uploading=!0,new d.a({file:e,category:59,maxSize:157286400}).beforeUpload().then((function(e){var n=e.url,o=void 0===n?"":n;t.top.changeVal(h(h({},t.idsObj),{},{val:o})),t.uploading=!1})).catch((function(e){t.uploading=!1})).finally((function(){t.uploading=!1}))},handleDelete:function(){this.top.changeVal(h(h({},this.idsObj),{},{val:""}))}}},_=(n(4350),n(0)),component=Object(_.a)(f,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"audio-field"},[n("CollapseComponent",{attrs:{title:t.itemData.title,itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}},[t.itemData.val?n("div",{staticClass:"audio-field-display"},[n("CAudio",{attrs:{audio:{url:null===(e=t.itemData)||void 0===e?void 0:e.val},isShowDownload:!1}}),t._v(" "),n("div",{staticClass:"delete-icon-box flex-center",on:{click:t.handleDelete}},[n("i",{staticClass:"iconfont delete-icon icon-shanchu"})])],1):n("div",{staticClass:"audio-field-upload-box"},[n("el-upload",{attrs:{action:"#","before-upload":t.handleBeforeUpload,"show-file-list":!1,accept:t.accept,"http-request":function(){}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],staticClass:"uploader"},[n("i",{staticClass:"el-icon-plus"})])])],1)])],1)}),[],!1,null,"681b2876",null);t.default=component.exports;installComponents(component,{CAudio:n(289).default})},1242:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(19),n(31),n(36)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"PopularFastApp",props:{info:{type:Object,default:function(){}}},data:function(){return{list:[],hasExposure:!1}},inject:["easyTop"],mounted:function(){this.getPopularAiAppList()},methods:d(d({},Object(r.b)("creation",["setCombinedDialogStatus"])),{},{handleViewMore:function(){this.$logEvent("log_actions",{operation:"click_hot_app",behavior_info:"on_createflow_page_ai_app_tab",behavior_info_sub:"more"}),this.setCombinedDialogStatus({visible:!0,instanceId:"easyGenerate"})},switchApp:function(e){var t;this.$logEvent("log_actions",{operation:"click_hot_app",behavior_info:"on_createflow_page_ai_app_tab",behavior_info_sub:(null==e?void 0:e.title)||""}),this.$EventBus.$emit("updateCategoryInfo",{type:"aiApp",obj:{id:null==e?void 0:e.id,name:null==e?void 0:e.title,banner:{url:null==e||null===(t=e.cover)||void 0===t?void 0:t.url}}})},getPopularAiAppList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(l.getWaterAiApp)({offset:"",page:t?2:1,page_size:20,sub_channel:[],tones:[],languages:[],genders:[],ages:[],model_types:[],base_models:[],run_available:0,nodes_type:[],source_types:[],tag_ids:[],character_type:0,output_types:[],order_by:t?"month_hot":"week_hot",order_by_time:t?"month_hot":"week_hot",timeType:t?"month":"week"}).then((function(n){var o=n.data.items,l=void 0===o?[]:o,r=n.status;1e4==(null==r?void 0:r.code)&&(e.list=t?e.list.concat(l.slice(0,4-e.list.length)):l.slice(0,4),e.list.length<4&&!t&&e.getPopularAiAppList(!0),e.exposureLogEvent(),e.$nextTick((function(){var t=e.$refs.appsContainer;if(t)for(var n=t.querySelectorAll(".app-card"),i=0;i<n.length;i++){var o=n[i].querySelector(".app-title");e.$set(e.list[i],"isEllipsis",o.scrollWidth>o.clientWidth)}})))}))},goDetail:function(e){var t=this.localePath("/workFlowAppDetail/".concat(null==e?void 0:e.id));window.open(t,"_blank")},exposureLogEvent:function(){var e;null!==(e=this.list)&&void 0!==e&&e.length&&this.hasExposure&&(this.hasExposure=!0,this.$logEvent("log_actions",{operation:"exposure_hot_app",behavior_info:"on_createflow_page_ai_app_tab"}),this.$logEvent("log_actions",{operation:"exposure_hot_app",behavior_info:"on_createflow_page_ai_app_tab",behavior_info_sub:"more"}))}})},m=v,h=(n(4351),n(0)),component=Object(h.a)(m,(function(){var e,t=this,n=t._self._c;return null!==(e=t.list)&&void 0!==e&&e.length?n("div",{staticClass:"popular-apps-container"},[n("div",{staticClass:"popular-apps-header"},[n("h2",{staticClass:"popular-apps-title"},[t._v(t._s(t.$t("popular_fast_apps")))]),t._v(" "),n("div",{staticClass:"view-more",on:{click:t.handleViewMore}},[t._v(t._s(t.$t("viewMore"))+" "),n("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),n("div",{ref:"appsContainer",staticClass:"apps-grid"},t._l(t.list,(function(e){var o,l;return n("div",{key:e.id,staticClass:"app-card",class:{active:(null===(o=t.info)||void 0===o?void 0:o.id)==e.id},attrs:{"data-event":"popular_fast_app_item","data-id":e.id},on:{click:function(n){return n.stopPropagation(),t.switchApp(e)}}},[n("div",{staticClass:"inner-card"},[n("div",{staticClass:"detail-badge",on:{click:function(n){return t.goDetail(e)}}},[n("span",[t._v(t._s(t.$t("Details")))])]),t._v(" "),n("div",{staticClass:"app-image-wrapper"},[n("img",{staticClass:"app-image",attrs:{src:null==e||null===(l=e.cover)||void 0===l?void 0:l.url,alt:"Warmth of Jesus"}})]),t._v(" "),n("el-tooltip",{attrs:{content:null==e?void 0:e.title,placement:"top",disabled:!(null!=e&&e.isEllipsis)}},[n("div",{staticClass:"app-title"},[n("span",[t._v("\n              "+t._s(null==e?void 0:e.title)+"\n            ")])])])],1)])})),0)]):t._e()}),[],!1,null,"8252f162",null);t.default=component.exports},1243:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(89),n(6),n(69),n(12),n(13),n(8),n(28),n(40),n(7),n(41);var o=n(3),l=n(2),r=(n(20),n(19),n(32),n(16),n(31),n(18),n(24),n(65),n(4),n(43),n(21),n(90),n(92),n(26),n(819)),c=n(182);function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return v(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function v(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={inject:["top"],mixins:[r.promptPolishMixIn],components:{NodeTips:c.default},props:{itemData:{type:Object,default:function(){}},index:{type:Number,default:0},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{exampleText:[],isTextEllipsis:!1,randomLoading:!1,randomTimer:null,randomIndex:0,isRefined:!1,loading:!0}},mounted:function(){this.initExampleText(),this.checkTextEllipsis()},computed:{idsObj:function(){var e=this.itemData;return{field:e.field,node_id:e.node_id,node_type:e.node_type}},showBottomBtn:function(){var e;return this.itemData.val||(null===(e=this.exampleText)||void 0===e?void 0:e.length)||this.showRefineSwitch},showRefineSwitch:function(){return this.itemData.show_refine_switch&&this.itemData.val&&this.itemData.val.length<=100&&!this.isRefined}},methods:{changeValue:function(e,source){"refine"!=source&&(this.isRefined=!1),this.top.changeVal(h(h({},this.idsObj),{},{val:e}),this.index)},getDecimalCount:function(e){var t=e.toString();return t.includes(".")?t.split(".")[1].length:0},formatStepPrecision:function(e,t){var n=Math.pow(10,e-1);return Number((Math.ceil(t*n)/n).toFixed(e))},initExampleText:function(){var e,t;null!==(e=this.itemData)&&void 0!==e&&null!==(e=e.example_text)&&void 0!==e&&e.length?this.exampleText=null===(t=this.itemData)||void 0===t?void 0:t.example_text.concat(this.itemData.val):this.exampleText=[]},generatePrompt:function(){var e,t=this;if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.randomIndex=Math.floor(Math.random()*this.exampleText.length),void this.changeValue(this.exampleText[this.randomIndex]);this.$logEvent("log_actions",{operation:"click_random_prompt",behavior_info:"on_new_createflow_page",behavior_info_sub:(null===(e=this.top)||void 0===e||null===(e=e.workFlowAppData)||void 0===e?void 0:e.name)||""}),this.randomLoading=!0,clearTimeout(this.randomTimer),this.randomTimer=setTimeout((function(){t.randomIndex+=1,t.randomIndex>=t.exampleText.length&&(t.randomIndex=0),t.changeValue(t.exampleText[t.randomIndex]),t.randomLoading=!1}),300)},refinePrompt:function(){var e,t=this.top,n=t.workFlowAppData,o=void 0===n?{}:n,l=t.codeViewData,r=void 0===l?[]:l,c=t.workFlowIndex,d=void 0===c?0:c,v=t.workFlowTabList,m=void 0===v?[]:v,h=(null===(e=this.itemData)||void 0===e?void 0:e.refine_node_ids)||[],f=(null==h?void 0:h[0])||{},_=f.node_id,y=f.node_type,C=f.field,w=r.find((function(e){return e.node_id==_&&e.node_type==y&&e.field==C}))||{},k=m[d]||{},I=k.model_type;if(null!=w&&w.val||"image"!=I){var x=this.itemData.val;"string"!=typeof x&&x&&(x=JSON.stringify(x)),this.getPromptPolish({prompt:x||"",template_id:o.id,ver_no:null==k?void 0:k.verNo,img_url:(null==w?void 0:w.val)||""})}else this.$message.warning(this.$t("pleaseUoloadImage"))},getPromptPolish:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,v,m,h,f,_,y,C,w,line,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.isPromptPolishing){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,t.isPromptPolishing=!0,n.next=6,fetch("/api/stream/tool/prompt/text",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",token:t.$cookies.get("T"),"Accept-Language":t.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-Device-Id":t.$cookies.get("deviceId"),"X-App-Id":"web_global_seaart"},body:JSON.stringify(e)});case 6:o=n.sent,l=o.body.getReader(),r=new TextDecoder("utf-8"),c="",v="";case 11:return n.next=14,l.read();case 14:if(m=n.sent,h=m.done,f=m.value,!h){n.next=19;break}return n.abrupt("break",49);case 19:if(!(_=r.decode(f,{stream:!0})).includes('"code":70017')){n.next=23;break}return t.$message.error("".concat(t.$t("ai_app_use_count_limit"),"}")),n.abrupt("break",49);case 23:if(!_.includes('"code":20000')){n.next=26;break}return t.$EventBus.$emit("openLoginDialog"),n.abrupt("break",49);case 26:y=(c+=_).split("\n"),c=y.pop()||"",C=d(y),n.prev=30,C.s();case 32:if((w=C.n()).done){n.next=39;break}if(""!==(line=w.value).trim()){n.next=36;break}return n.abrupt("continue",37);case 36:if(line.startsWith("data: "))try{"---end---"!==(text=line.slice(6))&&(v+=text,t.changeValue(v,"refine"))}catch(e){console.error("解析数据失败:",e)}case 37:n.next=32;break;case 39:n.next=44;break;case 41:n.prev=41,n.t0=n.catch(30),C.e(n.t0);case 44:return n.prev=44,C.f(),n.finish(44);case 47:n.next=11;break;case 49:t.isPromptPolishing=!1,n.next=57;break;case 52:n.prev=52,n.t1=n.catch(2),console.error("获取智能提示失败",n.t1),t.$message.error("".concat(t.$t("comicPage17"))),t.isPromptPolishing=!1;case 57:case"end":return n.stop()}}),n,null,[[2,52],[30,41,44,47]])})))()},updatePrompt:function(e){this.isRefined=!0,this.changeValue(e,"refine")},checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.titleRef;t&&(e.isTextEllipsis=t.scrollWidth>t.clientWidth)}))},deleteValue:function(){this.changeValue(""),this.$refs.textareaRef.focus()}},render:function(){var e,t=this,n=arguments[0],o=this.itemData,l=o.value_type,r=o.option||{},d=r.step,v=void 0===d?.1:d,m=r.min,h=void 0===m?0:m,f=r.max,_=void 0===f?100:f,y=r.accuracy,C=void 0===y?.1:y;C<this.getDecimalCount(v)&&(v=this.formatStepPrecision(C,v)),0!=C&&0!=v||(v=1);var w=n("div",{class:"input-field"},[n("div",{class:"input-field-top"},[n("div",{class:"input-field-top-left"},[n("el-tooltip",{attrs:{content:this.itemData.title,placement:"top",disabled:!this.isTextEllipsis,"open-delay":300}},[n("div",{class:"input-field-top-left-title",ref:"titleRef"},[this.itemData.title])]),n(c.default,{attrs:{itemData:this.itemData,currentWorkFlow:this.currentWorkFlow}})])]),n("div",{class:"input-field-content"},[n("el-input",{attrs:{placeholder:"",type:"textarea",resize:"none",value:this.itemData.val},on:{input:this.changeValue},ref:"textareaRef"}),this.showBottomBtn&&n("div",{class:"option-box"},[n("div",{class:"left-btn"},[!(null===(e=this.exampleText)||void 0===e||!e.length)&&n("el-tooltip",{attrs:{content:this.$t("workflow_clues_hover_tip"),placement:"top"}},[n("div",{class:"option-btn",on:{click:function(){return t.generatePrompt(!1)}}},[n("i",{class:["iconfont icon-suijishushengcheng random-icon",this.randomLoading?"random-prompt-loading":""]}),n("div",{class:"option-btn-title"},[this.$t("Random")])])]),this.showRefineSwitch&&n("div",{class:"option-btn",attrs:{"data-group":"ai-app-code-viewer-input-field-refine","data-desc":"ai应用-文本输入组件-内容润色"},on:{click:function(){return t.refinePrompt()}}},[n("i",{class:["iconfont icon-gpt-advance random-icon",this.isPromptPolishing?"random-polish-loading":""]}),n("div",{class:"option-btn-title"},[this.$t("Ideate")])])]),n("i",{class:"el-icon-delete icon-option",attrs:{"data-group":"ai-app-code-viewer-input-field-delete","data-desc":"ai应用-文本输入组件-内容删除"},on:{click:this.deleteValue}})])])]),k=n("div",{class:"input-field number-input"},[n("div",{class:"number-input-box width-height-hundred"},[n("div",{class:"number-input-top"},[n("el-tooltip",{attrs:{content:this.itemData.title,placement:"top",disabled:!this.isTextEllipsis,"open-delay":300}},[n("div",{class:"number-input-title",ref:"titleRef"},[this.itemData.title])]),n(c.default,{attrs:{itemData:this.itemData,currentWorkFlow:this.currentWorkFlow}})]),n("el-input-number",{attrs:{size:"small",step:v,precision:C,min:h,max:_,value:this.itemData.val},on:{change:this.changeValue}})])]);return 1==l?w:k}},_=f,y=(n(4331),n(0)),component=Object(y.a)(_,undefined,undefined,!1,null,"56d9073d",null);t.default=component.exports},137:function(e,t,n){"use strict";n.r(t);var o={props:["value","min","max","label","step","tips","disabled","showTooltip","precision","hideLabel","hideSlider"],data:function(){return{}},methods:{changeConfig:function(e){this.$emit("change",e)}}},l=(n(4006),n(4007),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slider-item",class:[e.hideLabel?"easy-slider-item-between":""]},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.hideLabel,expression:"!hideLabel"}],staticClass:"slider-label"},[t("p",[e._v("\n      "+e._s(e.label)+"\n      "),e.tips?t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.tips,placement:"top-start"}},[t("span",{staticClass:"el-icon-warning custom-tips"})]):e._e()],1),e._v(" "),t("el-input-number",{staticClass:"easy-input-number",attrs:{value:e.value,controls:!1,min:e.min,max:e.max,precision:e.precision,step:e.step,disabled:e.disabled},on:{change:e.changeConfig}})],1),e._v(" "),e.hideSlider?e._e():t("el-slider",{staticClass:"easy-slider-item",attrs:{value:e.value,min:e.min,max:e.max,step:e.step,disabled:e.disabled,"show-tooltip":!1},on:{input:e.changeConfig}}),e._v(" "),t("el-input-number",{directives:[{name:"show",rawName:"v-show",value:e.hideLabel,expression:"hideLabel"}],staticClass:"easy-input-number",attrs:{value:e.value,controls:!1,min:e.min,max:e.max,precision:e.precision,step:e.step,disabled:e.disabled},on:{change:e.changeConfig}})],1)}),[],!1,null,"4a1e13a4",null);t.default=component.exports},1591:function(e,t,n){e.exports={}},1651:function(e,t,n){e.exports={}},1652:function(e,t,n){e.exports={}},1695:function(e,t,n){e.exports={}},1702:function(e,t,n){e.exports={}},1703:function(e,t,n){e.exports={}},1704:function(e,t,n){e.exports={}},1705:function(e,t,n){e.exports={}},1706:function(e,t,n){e.exports={}},1733:function(e,t,n){e.exports={}},179:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8);var o=n(14),l=n(3),r=n(2),c=(n(20),n(19),n(6),n(32),n(50),n(16),n(22),n(31),n(49),n(24),n(4),n(28),n(21),n(40),n(7),n(41),n(141),n(142),n(109),n(25)),d=n(36),v=n(3291),m=n(121),h=n.n(m),f=n(51),_=n(61),y=n(3292),C=n(97),w=(n(99),n(46)),k=n(1);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T={name:"PickOrUploadImageModal",inject:["easyTop"],components:{WaterFallVue:v.default,LinkUploadModal:y.default,commonConfirmModal:C.default},props:{maxNum:{type:Number,default:1},type:{type:String,default:"default"}},data:function(){return{visible:!1,loading:!1,list:[],noMore:!1,queryParam:{keyword:"",page:1,page_size:60,time_to:0,after:0},debounceHandleScroll:null,scrollTop:0,selectList:[],debounceHandleSearch:null,activeTab:"upload",UPLOAD:new f.a({type:36}),uploading:!1,accept:".jpg,.png,.jpeg,.webp",baseSize:5,extraOption:null,faceCheckResult:null,btnLoading:!1}},computed:x(x({},Object(k.c)("user",["isLoggedIn"])),{},{checkAspectRatioAndSize:function(){var e,t;return(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isMiniMax)||(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isKlModel)},renderList:function(){return"animGen"==this.type?this.list.filter((function(e){return"sdxl"!=e.channel&&"studio"!=e.channel&&6!=e.type})):this.list}}),mounted:function(){this.debounceHandleScroll=Object(c.debounce)(this.handleScroll,200),this.debounceHandleSearch=Object(c.debounce)(this.handleSearch,600)},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceHandleSearch=null},methods:{handleChangeTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.activeTab!==e&&!this.loading&&!this.uploading){var t="upload"===e?"click_upload_images_tab":"click_personal_work_tab";this.$logEvent("log_actions",{operation:t,behavior_info:"on_image_upload_popup"}),this.activeTab=e,this.isLoggedIn&&(this.selectList=[],this.resetData(),this.$refs.WaterFallVue.refreshCheck(),"upload"===this.activeTab?this.getLocalList():this.getList())}},handleDeleteImage:function(e){var t=this;this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then(Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.list.findIndex((function(t){return t.id===e.id})),t.deleteRecentUsedImage(t.list[o]).then((function(e){-1!==o&&t.list.splice(o,1)}));case 3:case"end":return n.stop()}}),n)}))))},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.resetData(),this.extraOption=null,"animGen"===this.type&&(this.activeTab="pick"),this.extraOption=t||null,!this.isLoggedIn){return this.list=[{id:"upload",banner:{width:268,height:268,url:"https://image.cdn.centcloud.seaart.me/2024-09-02/dev-crap5pdgflik2alqoeig-2/e1e5ee5245caef9f9adf649d960d218d_low.webp"},customType:"upload"}],void(this.visible=!0)}"upload"===this.activeTab?this.getLocalList():this.getList(),this.selectList=e||[],this.visible=!0},handleClose:function(){this.visible=!1},resetData:function(){this.list=[],this.loading=!1,this.queryParam={keyword:"",page:1,page_size:60,time_to:0,after:0},"animGen"===this.type&&(this.queryParam.scene="motion"),this.scrollTop=0,this.noMore=!1,this.selectList=[],this.btnLoading=!1},handleCancel:function(){this.visible=!1},handleSearch:function(){this.loading=!1,this.noMore=!1,this.queryParam.page=1,this.queryParam.time_to=0,this.queryParam.after=0,this.scrollTop=0,this.list=[],this.getList()},handleScroll:function(){var e=this.$refs.handleWorkScroll;this.scrollTop=e.scrollTop||0;try{e&&e.scrollTop+e.clientHeight>=e.scrollHeight-50&&this.getList(!0)}catch(e){}},getList:function(e){var t=this;if(!this.loading&&!this.noMore){this.loading=!0;var n=d.artworkList;this.queryParam.order_by="new",this.queryParam.artwork_types=[1,4,6],"animGen"==this.type&&(this.queryParam.artwork_types=[1,4]),"character"==this.type&&(this.queryParam.artwork_types=[1,3,4]),"contribute"===this.type&&(this.queryParam.artwork_types=[1,3,4,6],this.queryParam.scene="post"),this.queryParam.type="bookmarks",this.queryParam.category=2;var o=this.queryParam;return new Promise((function(l,r){n(o).then((function(n){if(1e4===n.status.code){var r;if(t.noMore=!n.data.has_more,t.list=e?t.list.concat(n.data.items||[]):n.data.items||[],1===o.page&&n.data.time_ms&&(o.time_to=n.data.time_ms),n.data.items.length>0)t.queryParam.after=null===(r=n.data.items[n.data.items.length-1])||void 0===r||null===(r=r.folder_no)||void 0===r?void 0:r.collect_at;o.page++,l()}})).catch((function(e){r(e)})).finally((function(){t.loading=!1}))}))}},getLocalList:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={scene:"tf_v2"},e.loading=!0,Object(w.getRecentUsedImageList)(n).then((function(t){var n,l=[{id:"upload",banner:{width:268,height:268,url:"https://image.cdn.centcloud.seaart.me/2024-09-02/dev-crap5pdgflik2alqoeig-2/e1e5ee5245caef9f9adf649d960d218d_low.webp"},customType:"upload"}];if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var r,c=((null==t||null===(r=t.data)||void 0===r?void 0:r.items)||[]).map((function(e){return e.banner={url:null==e?void 0:e.url,width:null==e?void 0:e.width,height:null==e?void 0:e.height},e}));l=[].concat(Object(o.a)(l),Object(o.a)(c))}e.list=l,e.noMore=!0})).finally((function(){e.loading=!1}));case 3:case"end":return t.stop()}}),t)})))()},addRecentUsedImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};n.width=null==e?void 0:e.width,n.height=null==e?void 0:e.height,n.url=(null==e?void 0:e.url)||"",t&&(n.img_category=2),null!=e&&e.artwork_id&&!((null==e?void 0:e.artwork_id)||"").includes("personal_upload_")&&(n.artwork_id=null==e?void 0:e.artwork_id),this.isLoggedIn&&Object(w.addRecentUsedImage)(n).then((function(e){})).finally((function(){}))},deleteRecentUsedImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return t.url=null==e?void 0:e.url,Object(w.deleteRecentUsedImage)(t)},getCheckList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectList=[],(t.url||[]).forEach((function(n,o){e.selectList.push({url:n,id:(null==t?void 0:t.ids[o])||"",type:"check",info:null==t?void 0:t.info[o]})}))},handleLinkImageUpload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.uniqueId)("personal_upload_".concat(Date.now(),"_"));this.updateImageInfo(t,{banner:e,uploading:!1})},handleConfirm:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectList.length){t.next=3;break}return e.$message.warning(e.$t("selectOneWork")),t.abrupt("return");case 3:if(null==e||null===(n=e.extraOption)||void 0===n||!n.checkFace){t.next=13;break}return t.next=6,e.checkFaceByLink((null==e||null===(o=e.selectList)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.url)||"");case 6:if(null!==(l=e.faceCheckResult)&&void 0!==l&&l.is_face){t.next=9;break}return e.$message.warning(e.$t("HttpErrorCode_30044")),t.abrupt("return");case 9:return"upload"!==e.activeTab&&e.handleUpdateAddImage(e.selectList[0]),e.$emit("confirm",e.selectList,e.extraOption),e.handleClose(),t.abrupt("return");case 13:if("upload"!==e.activeTab&&e.handleUpdateAddImage(e.selectList[0]),!e.checkAspectRatioAndSize){t.next=25;break}return e.btnLoading=!0,t.next=18,e.checkAspectRatioAndSizeCanUse(e.selectList[0]);case 18:if(r=t.sent,e.btnLoading=!1,r){t.next=22;break}return t.abrupt("return");case 22:return e.$emit("confirm",e.selectList,e.extraOption),e.handleClose(),t.abrupt("return");case 25:e.$emit("confirm",e.selectList,e.extraOption),e.handleClose();case 27:case"end":return t.stop()}}),t)})))()},checkAspectRatioAndSizeCanUse:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,source,c,d,v,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=(null==(source=e.length>0&&void 0!==e[0]?e[0]:{})?void 0:source.url)||(null==source||null===(o=source.info)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.url)||""){n.next=4;break}return n.abrupt("return",!1);case 4:return n.next=6,t.getImageDimensions(c);case 6:if(d=n.sent,!(null!=t&&null!==(l=t.easyTop)&&void 0!==l&&l.isTongYiFast||null!=t&&null!==(r=t.easyTop)&&void 0!==r&&r.isTongYiProfessional)){n.next=16;break}if(v=d.width>=300&&d.width<=2e3,m=d.height>=300&&d.height<=2e3,v&&m){n.next=13;break}return t.$message.error(t.$t("uploadWanAiTips")),n.abrupt("return",!1);case 13:case 24:return n.abrupt("return",!0);case 16:if(!t.checkAspectRatioAndSize){n.next=24;break}if(!(d.width<300||d.height<300)){n.next=20;break}return t.$message.error(t.$t("imageRuleMinWh",{w:300,h:300})),n.abrupt("return",!1);case 20:if(!((h=d.width/d.height)<.4||h>2.5)){n.next=24;break}return t.$message.error(t.$t("newGenerate129")),n.abrupt("return",!1);case 25:case"end":return n.stop()}}),n)})))()},handleUpdateAddImage:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,source,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((c={}).url=(null==(source=e.length>0&&void 0!==e[0]?e[0]:{})?void 0:source.url)||(null==source||null===(o=source.info)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.url)||"",c.width=null==source||null===(l=source.info)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.width,c.height=null==source||null===(r=source.info)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.height,c.artwork_id=null==source?void 0:source.id,null!=c&&c.width&&null!=c&&c.height){n.next=12;break}return n.next=9,t.getImageDimensions(c.url);case 9:d=n.sent,c.width=d.width,c.height=d.height;case 12:t.addRecentUsedImage(c);case 13:case"end":return n.stop()}}),n)})))()},checkFaceByLink:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={scene:"tf_v2_inf_ip_adapter",url:e.length>0&&void 0!==e[0]?e[0]:""},t.btnLoading=!0,n.abrupt("return",Object(w.easyCheckImageFace)(o).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.faceCheckResult=Object.assign({},o,(null==e?void 0:e.data)||{}))})).finally((function(){t.btnLoading=!1})));case 4:case"end":return n.stop()}}),n)})))()},handleBeforeUpload:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,d,v,m,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.UPLOAD,["image/jpeg","image/png","image/webp","image/jpg"].includes(e.type)){n.next=5;break}return t.$message.error(t.$t("AllowImageFiles")),n.abrupt("return",!1);case 5:if(!(l=e)||l.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(r=t.baseSize,t.checkAspectRatioAndSize&&(r=10),l.size/1024/1024<=r){n.next=21;break}return n.prev=12,n.next=15,Object(_.a)(l,1024*r*1024);case 15:l=n.sent,n.next=21;break;case 18:return n.prev=18,n.t0=n.catch(12),n.abrupt("return",!1);case 21:if(!t.uploading){n.next=23;break}return n.abrupt("return");case 23:return n.next=25,t.checkImageSize(l);case 25:if(d=n.sent,!t.checkAspectRatioAndSize){n.next=34;break}if(!(d.width<300||d.height<300)){n.next=30;break}return t.$message.error(t.$t("imageRuleMinWh",{w:300,h:300})),n.abrupt("return",!1);case 30:if(!((v=d.width/d.height)<.4||v>2.5)){n.next=34;break}return t.$message.error(t.$t("newGenerate129")),n.abrupt("return",!1);case 34:return t.uploading=!0,m=Object(c.uniqueId)("personal_upload_".concat(Date.now(),"_")),h=URL.createObjectURL(new Blob([t.fileToBlob(e)])),f={url:h,width:null==d?void 0:d.width,height:null==d?void 0:d.height},n.next=40,t.updateImageInfo(m,{banner:f,uploading:!0});case 40:return o.startUpload(l).then((function(e){t.uploading=!1,f.url=e,t.updateImageInfo(m,{banner:f,uploading:!1})})).catch((function(e){t.uploading=!1,f.url="",t.updateImageInfo(m,{banner:f,uploading:!1}),t.$message.error(t.$t("uploadError"))})).finally((function(){t.uploading=!1})),n.abrupt("return",!1);case 42:case"end":return n.stop()}}),n,null,[[12,18]])})))()},updateImageInfo:function(e){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l,r,c,d,v,m,f,_,y;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=t.length>1&&void 0!==t[1]?t[1]:{},d=/^blob:/,v=n.list.find((function(t){return t.id===e})),m=n.list.findIndex((function(t){return t.id===e})),f=Object.assign({id:e},c),v?(Object.assign(v,c),null!=c&&null!==(_=c.banner)&&void 0!==_&&_.url||n.list.splice(m,1),n.$refs.WaterFallVue.refreshCheck()):(n.list.splice(1,0,f),n.$refs.WaterFallVue.refreshCheck()),null==c||null===(l=c.banner)||void 0===l||!l.url||d.test(null==c||null===(r=c.banner)||void 0===r?void 0:r.url)){o.next=11;break}return n.addRecentUsedImage(null==c?void 0:c.banner,2),y=(n.list||[]).filter((function(e){var t,n;return"upload"!==(null==e?void 0:e.customType)&&(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)&&!d.test(null==e||null===(n=e.banner)||void 0===n?void 0:n.url)})),o.next=11,h.a.setItem("uploadImages",y);case 11:case"end":return o.stop()}}),o)})))()},handleBeforeUploadEmpty:function(){},fileToBlob:function(e){return e.slice(0,e.size,e.type)},checkImageSize:function(e){return new Promise((function(t,n){var o=new FileReader;o.onload=function(e){var img=new Image;img.onload=function(){var e=img.naturalWidth,n=img.naturalHeight;t({width:e,height:n})},img.onerror=function(){n(!1)},img.src=e.target.result},o.readAsDataURL(e)}))},getImageDimensions:function(e){return new Promise((function(t,n){var img=new Image;img.onload=function(){t({width:img.naturalWidth,height:img.naturalHeight})},img.onerror=function(){n(new Error("Failed to load image."))},img.src=e}))},handleTriggerUpload:function(){var e=arguments.length>1?arguments[1]:void 0;this.$logEvent("log_actions",{operation:"click_upload_image",behavior_info:"on_create_flow_popup",behavior_info_sub:"local_upload"}),e&&this.handleBeforeUpload(e)},handleTriggerLinkUpload:function(){this.$logEvent("log_actions",{operation:"click_upload_image",behavior_info:"on_create_flow_popup",behavior_info_sub:"click_url_upload"}),this.$refs.linkUpload.show()}}},S=T,O=(n(4317),n(0)),component=Object(O.a)(S,(function(){var e=this,t=e._self._c;return e.visible?t("el-dialog",{attrs:{visible:e.visible,"custom-class":"c-pick-or-upload-image-modal","modal-append-to-body":!0,"append-to-body":!0,"destroy-on-close":"",center:"",width:"1106px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"pick-or-upload-image-modal-header"},[t("div",{staticClass:"pick-or-upload-image-modal-header-title"},[e._v(e._s(e.$t("newGenerate32")))]),e._v(" "),t("div",{staticClass:"pick-or-upload-image-modal-header-tabs"},["animGen"!==e.type?t("div",{staticClass:"header-tabs-item",class:["upload"===e.activeTab&&"header-tabs-item-active"],attrs:{"data-event":"generate_click_upload_images_tab"},on:{click:function(t){return t.stopPropagation(),e.handleChangeTab("upload")}}},[e._v("\n        "+e._s(e.$t("newGenerate33"))+"\n      ")]):e._e(),e._v(" "),t("div",{staticClass:"header-tabs-item",class:["pick"===e.activeTab&&"header-tabs-item-active"],attrs:{"data-event":"generate_click_personal_work_tab"},on:{click:function(t){return t.stopPropagation(),e.handleChangeTab("pick")}}},[e._v("\n        "+e._s(e.$t("newGenerate34"))+"\n      ")])])]),e._v(" "),t("div",{staticClass:"pick-or-upload-image-modal-body"},[t("div",{ref:"handleWorkScroll",staticClass:"handle-work-scroll-list",on:{scroll:e.debounceHandleScroll}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"wraper",staticClass:"wraper"},[t("WaterFallVue",{ref:"WaterFallVue",attrs:{showNs:"",type:"artwork",cols:5,gap:10,container:"wraper",list:e.renderList,lazy:!0,dislikeShow:!0,isCheck:!0,checkMax:e.maxNum,alreadyNoMoreData:e.noMore,scrollContainerClassName:"handle-work-scroll-list",scrollContentTop:e.scrollTop,selectList:e.selectList,currentTab:e.activeTab},on:{load:function(t){return e.getList(!0)},getChecList:e.getCheckList,openCustomUpload:e.handleTriggerUpload,openLinkUpload:e.handleTriggerLinkUpload,deleteUploadImage:e.handleDeleteImage}})],1)])]),e._v(" "),t("div",{staticClass:"pick-or-upload-image-modal-bottom",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"pick-or-upload-image-modal-bottom-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("div",{staticClass:"pick-or-upload-image-modal-bottom-btn pick-or-upload-image-modal-bottom-btn-color",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e.btnLoading?[t("span",{staticClass:"el-icon-loading"})]:e._e(),e._v("\n      "+e._s(e.$t("Confirm"))+"\n    ")],2)]),e._v(" "),t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],ref:"imageUpload2",staticClass:"image-upload",staticStyle:{display:"none !important"},attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,disabled:e.uploading,accept:e.accept,multiple:"",limit:20,"http-request":e.handleBeforeUploadEmpty,"show-file-list":!1}},[t("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon",attrs:{slot:"trigger"},slot:"trigger"})]),e._v(" "),t("link-upload-modal",{ref:"linkUpload",on:{linkImage:e.handleLinkImageUpload}}),e._v(" "),t("common-confirm-modal",{ref:"commonConfirmModal"})],1):e._e()}),[],!1,null,null,null);t.default=component.exports},1799:function(e,t,n){e.exports={}},1800:function(e,t,n){e.exports={}},1801:function(e,t,n){e.exports={}},1808:function(e,t,n){e.exports={}},1809:function(e,t,n){e.exports={}},1810:function(e,t,n){e.exports={}},182:function(e,t,n){"use strict";n.r(t);n(19);var o={name:"NodeTips",props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},computed:{showAnnotation:function(){return this.itemData.show_icon_switch&&(!!this.itemData.icon_text||!!this.itemData.icon_image)}},methods:{postLog:function(e){var t,n;this.showAnnotation&&this.$xyLogEvent({front_operation:e,entity_type:"ai-app-node-tips",entity_name:"ai-app-node-tips_show",obj_id:"".concat(null===(t=this.currentWorkFlow)||void 0===t?void 0:t.id,"@").concat(null===(n=this.currentWorkFlow)||void 0===n?void 0:n.ver_no),obj_pt:this.itemData.field})}}},l=(n(4329),n(4330),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return e.showAnnotation?t("el-tooltip",{attrs:{trigger:"hover","append-to-body":"","popper-class":"ai-app-node-tips-popover"},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticClass:"ai-app-node-tips-content"},[e.itemData.icon_text?t("div",{staticClass:"ai-app-node-tips-text"},[e._v(e._s(e.itemData.icon_text))]):e._e(),e._v(" "),e.itemData.icon_image?t("div",{staticClass:"ai-app-node-tips-image"},[t("img",{attrs:{src:e.itemData.icon_image,alt:"tips-image"}})]):e._e()])]},proxy:!0}],null,!1,2141938356)},[e._v(" "),e.showAnnotation?t("i",{staticClass:"el-icon-warning ai-app-node-tips-icon",attrs:{"data-pt":e.itemData.field},on:{click:function(e){e.stopPropagation()},mouseenter:function(t){return e.postLog("exposure")}}}):e._e()]):e._e()}),[],!1,null,"1c4ca5f2",null);t.default=component.exports},1825:function(e,t,n){e.exports={}},1826:function(e,t,n){e.exports={}},1827:function(e,t,n){e.exports={}},1828:function(e,t,n){e.exports={}},1829:function(e,t,n){e.exports={}},1830:function(e,t,n){e.exports={}},1838:function(e,t,n){e.exports={}},1839:function(e,t,n){e.exports={}},1840:function(e,t,n){e.exports={}},1841:function(e,t,n){e.exports={}},1845:function(e,t,n){e.exports={}},1847:function(e,t,n){e.exports={}},1848:function(e,t,n){e.exports={}},1849:function(e,t,n){e.exports={}},1851:function(e,t,n){e.exports={}},1852:function(e,t,n){e.exports={}},1853:function(e,t,n){e.exports={}},1856:function(e,t,n){e.exports={}},1857:function(e,t,n){e.exports={}},1862:function(e,t,n){e.exports={}},1863:function(e,t,n){e.exports={}},1864:function(e,t,n){e.exports={}},1865:function(e,t,n){e.exports={}},1866:function(e,t,n){e.exports={}},1870:function(e,t,n){e.exports={}},1871:function(e,t,n){e.exports={}},1872:function(e,t,n){e.exports={}},1873:function(e,t,n){e.exports={}},1874:function(e,t,n){e.exports={}},1875:function(e,t,n){e.exports={}},1876:function(e,t,n){e.exports={}},1878:function(e,t,n){e.exports={}},1879:function(e,t,n){e.exports={}},1880:function(e,t,n){e.exports={}},1881:function(e,t,n){e.exports={}},1882:function(e,t,n){e.exports={}},1883:function(e,t,n){e.exports={}},1884:function(e,t,n){e.exports={}},1885:function(e,t,n){e.exports={}},1886:function(e,t,n){e.exports={}},1887:function(e,t,n){e.exports={}},1888:function(e,t,n){e.exports={}},1889:function(e,t,n){e.exports={}},1890:function(e,t,n){e.exports={}},1891:function(e,t,n){e.exports={}},1892:function(e,t,n){e.exports={}},1893:function(e,t,n){e.exports={}},1894:function(e,t,n){e.exports={}},1895:function(e,t,n){e.exports={}},1896:function(e,t,n){e.exports={}},1897:function(e,t,n){e.exports={}},1898:function(e,t,n){e.exports={}},1899:function(e,t,n){e.exports={}},1900:function(e,t,n){e.exports={}},1901:function(e,t,n){e.exports={}},1902:function(e,t,n){e.exports={}},1903:function(e,t,n){e.exports={}},1904:function(e,t,n){e.exports={}},1906:function(e,t,n){e.exports={}},1907:function(e,t,n){e.exports={}},1908:function(e,t,n){e.exports={}},1909:function(e,t,n){e.exports={}},1910:function(e,t,n){e.exports={}},1913:function(e,t,n){e.exports={}},1914:function(e,t,n){e.exports={}},1915:function(e,t,n){e.exports={}},1916:function(e,t,n){e.exports={}},1917:function(e,t,n){e.exports={}},1918:function(e,t,n){e.exports={}},1920:function(e,t,n){e.exports={}},1921:function(e,t,n){e.exports={}},1923:function(e,t,n){e.exports={}},1924:function(e,t,n){e.exports={}},1925:function(e,t,n){e.exports={}},1926:function(e,t,n){e.exports={}},1928:function(e,t,n){e.exports={}},1929:function(e,t,n){e.exports={}},1930:function(e,t,n){e.exports={}},1931:function(e,t,n){e.exports={}},1932:function(e,t,n){e.exports={}},1933:function(e,t,n){e.exports={}},1934:function(e,t,n){e.exports={}},1935:function(e,t,n){e.exports={}},1936:function(e,t,n){e.exports={}},1937:function(e,t,n){e.exports={}},1938:function(e,t,n){e.exports={}},1939:function(e,t,n){e.exports={}},1940:function(e,t,n){e.exports={}},1941:function(e,t,n){e.exports={}},1942:function(e,t,n){e.exports={}},1943:function(e,t,n){e.exports={}},1944:function(e,t,n){e.exports={}},1950:function(e,t,n){e.exports={}},1951:function(e,t,n){e.exports={}},1953:function(e,t,n){e.exports={}},1954:function(e,t,n){e.exports={}},1955:function(e,t,n){e.exports={}},1956:function(e,t,n){e.exports={}},1963:function(e,t,n){e.exports={}},1964:function(e,t,n){e.exports={}},1965:function(e,t,n){e.exports={}},1966:function(e,t,n){e.exports={}},1967:function(e,t,n){e.exports={}},1968:function(e,t,n){e.exports={}},1969:function(e,t,n){e.exports={}},1970:function(e,t,n){e.exports={}},1971:function(e,t,n){e.exports={}},1972:function(e,t,n){e.exports={}},1974:function(e,t,n){e.exports={}},1975:function(e,t,n){e.exports={}},1976:function(e,t,n){e.exports={}},1977:function(e,t,n){e.exports={}},1978:function(e,t,n){e.exports={}},1979:function(e,t,n){e.exports={}},1980:function(e,t,n){e.exports={}},1982:function(e,t,n){e.exports={}},1983:function(e,t,n){e.exports={}},1984:function(e,t,n){e.exports={}},1985:function(e,t,n){e.exports={}},1986:function(e,t,n){e.exports={}},1987:function(e,t,n){e.exports={}},1988:function(e,t,n){e.exports={}},1989:function(e,t,n){e.exports={}},1990:function(e,t,n){e.exports={}},1991:function(e,t,n){e.exports={}},1992:function(e,t,n){e.exports={}},1993:function(e,t,n){e.exports={}},1994:function(e,t,n){e.exports={}},1995:function(e,t,n){e.exports={}},1996:function(e,t,n){e.exports={}},1997:function(e,t,n){e.exports={}},1998:function(e,t,n){e.exports={}},1999:function(e,t,n){e.exports={}},200:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(16),n(21),n(1)),r=n(10);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"DownloadVideo",props:{videoInfo:{type:Object,default:function(){return{videoUrl:""}}},keepModalFirst:{type:Boolean,default:!1}},data:function(){return{isShowPopoverVisible:!1}},computed:d(d(d({},Object(l.c)("user",["isLoggedIn"])),Object(l.e)("payment",["paymentInfo","isCompanyAccount"])),{},{getPopperClass:function(){return this.keepModalFirst?"download-video-popper download-video-popper-keep-first":"download-video-popper"},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},showPopover:function(){return this.videoInfo.videoUrl.includes("temp-watermark-convert")}}),mounted:function(){this.$EventBus.$on("closeDownloadVideoPopup",this.closeDownloadVideoPopup)},beforeDestroy:function(){this.$EventBus.$off("closeDownloadVideoPopup",this.closeDownloadVideoPopup)},methods:{downloadWithWatermark:function(e){this.isShowPopoverVisible=!1,"click_standard"===e&&this.$logEvent("log_actions",{operation:"click_standard",behavior_info:"on_commercial_watermarking_popup"}),this.downloadVideo(this.videoInfo.videoUrl)},handleVipDownload:function(){this.isShowPopoverVisible=!1,this.isVip?(this.$logEvent("log_actions",{operation:"click_professional",behavior_info:"on_commercial_watermarking_popup"}),this.downloadVideo(this.videoInfo.videoUrl,4)):this.$EventBus.$emit("showBreakDialog","UpgradeWatermark","basic")},downloadVideo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.isLoggedIn)try{Object(r.N)({url:e,scene:t}),this.$emit("download-success")}catch(e){this.$emit("download-error",e)}else this.$EventBus.$emit("openLoginDialog",{dot:!1})},closeDownloadVideoPopup:function(){try{var e;null===(e=this.$refs)||void 0===e||null===(e=e.downloadVideoPopover)||void 0===e||e.doClose()}catch(e){}}}},m=v,h=(n(4360),n(4361),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("div",[e.showPopover?t("el-popover",{ref:"downloadVideoPopover",staticClass:"download-video-popover",attrs:{placement:"bottom",trigger:"click","popper-class":e.getPopperClass},model:{value:e.isShowPopoverVisible,callback:function(t){e.isShowPopoverVisible=t},expression:"isShowPopoverVisible"}},[t("div",{staticClass:"download-video"},[t("div",{staticClass:"download-btn watermark",on:{click:function(t){return e.downloadWithWatermark("click_standard")}}},[e._v("\n        "+e._s(e.$t("DownloadWithWatermark"))+"\n      ")]),e._v(" "),t("div",{staticClass:"download-btn no-watermark",on:{click:e.handleVipDownload}},[t("img",{staticClass:"vip-icon",attrs:{src:n(375),alt:"vip-icon"}}),e._v("\n        "+e._s(e.$t("DownloadWithoutWatermark"))+"\n      ")])]),e._v(" "),e._t("default",null,{slot:"reference"})],2):t("div",{staticClass:"direct-download-wrapper",on:{click:e.downloadWithWatermark}},[e._t("default")],2)],1)}),[],!1,null,"206f58be",null);t.default=component.exports},2e3:function(e,t,n){e.exports={}},2001:function(e,t,n){e.exports={}},2002:function(e,t,n){e.exports={}},2003:function(e,t,n){e.exports={}},2004:function(e,t,n){e.exports={}},2005:function(e,t,n){e.exports={}},2006:function(e,t,n){e.exports={}},2007:function(e,t,n){e.exports={}},2008:function(e,t,n){e.exports={}},2010:function(e,t,n){e.exports={}},2011:function(e,t,n){e.exports={}},2012:function(e,t,n){e.exports={}},2013:function(e,t,n){e.exports={}},2014:function(e,t,n){e.exports={}},2015:function(e,t,n){e.exports={}},2016:function(e,t,n){e.exports={}},2017:function(e,t,n){e.exports={}},2018:function(e,t,n){e.exports={}},2019:function(e,t,n){e.exports={}},2020:function(e,t,n){e.exports={}},2021:function(e,t,n){e.exports={}},2022:function(e,t,n){e.exports={}},2023:function(e,t,n){e.exports={}},2025:function(e,t,n){e.exports={}},2026:function(e,t,n){e.exports={}},2027:function(e,t,n){e.exports={}},2028:function(e,t,n){e.exports={}},2746:function(e,t,n){e.exports={}},288:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(31),n(18),n(21),n(11),n(12),n(13);var o=n(14),l=n(2),r=(n(6),n(32),n(22),n(49),n(8),n(4),n(378),n(7),n(56)),c=n(27),d=n(1),v=n(10),m=n(25),h=n(29),f=n(63),_=n(45),y=n(138),C=n(253),w=n(52),k=n(9),I=n(71),x=n(239),T=n(46),S=n(97),O=n(33),P=void 0;function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={name:"EasyStyleModal",mixins:[_.a],inject:["easyTop"],components:{CollectPopover:f.default,modelPayNum:y.default,changeVer:C.default,SwipeableList:w.default,LenovoInput:x.default,commonConfirmModal:S.default},props:{selectList:{type:Array,default:function(){return[]}},hideEmbedding:{type:Boolean,default:!1},placeholder:{type:String,default:function(){return null==P?void 0:P.$t("TaskStylePlaceHolder")}},isPaintingBoard:{type:Boolean,default:!1},isSDXL:{type:Boolean,default:!1},SDXLmodel:{type:Array,default:function(){return null}},SDmodel:{type:Array,default:function(){return null}},inTask:{type:Boolean,default:!1},isStudioMode:{type:Boolean,default:!1},fluxModelId:{type:String,default:""},studioModelInfo:{type:Object,default:function(){return{}}},menuIndex:{type:String,default:function(){return""}},isSimpleMode:{type:Boolean,default:!1}},data:function(){return{visible:!1,topTabConfig:{checkpoint:[{code:"presetsModel",i18nKey:"presetsModel"},{code:"communityMode",i18nKey:"communityModel"},{code:"workflowApp",i18nKey:"Swtft_App"},{code:"character",i18nKey:"digitalHuman"}],other:[{code:"presetsLora",i18nKey:"newGenerate62"},{code:"LORA",i18nKey:"communityModel"}]},activeTopTab:"presetsModel",presetsModelList:[],activeTab:"mine",timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:this.getTimestamps().startTimestamp,endTime:this.getTimestamps().endTimestamp},{name:"week",startTime:this.getWeekTimeRange().startTimestamp,endTime:this.getWeekTimeRange().endTimestamp},{name:"months",startTime:this.getMonthTimestampRange().startTimestamp,endTime:this.getMonthTimestampRange().endTimestamp}],tagIndex:"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],tabList:[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],queryOptionsList:[{label:"综合推荐",value:"comprehensive",order:1,i18nKey:"styleModal1"},{label:"最近使用",value:"recent",order:2,i18nKey:"recentlyUsed"},{label:"我的收藏",value:"collect",order:3,i18nKey:"MyCollection"},{label:"我的模型",value:"bookmarks_choose",order:4,i18nKey:"MyModel"},{label:"更多推荐",value:"recommend",order:5,i18nKey:"FindGoodPictures"}],queryParam:{order_by:"hot",keyword:"",created:"",model_type:"LORA"},list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,limit:60,total:0},debounceHandleScroll:null,gridNum:5,modalWidth:"1340px",debounceResize:null,showType:"",modelOption:[],itemScroll:null,queryType:"comprehensive",modelTypeSelect:[],baseModelSelect:[],tabShowTagEmpty:!1,showTagEmpty:!1,keyWordCopy:"",selectModel:null,modelType:"LORA",enableUsePresetConfig:!0,debounceChangeHandle:function(){}}},computed:L(L(L(L({},Object(d.e)("user",["collectData","cdnHost","token"])),Object(d.c)("user",["userInfo","isLoggedIn"])),{},{modelTypes:function(){var e=[{label:"LORA",value:"LORA"},{label:"DoRA",value:"DoRA"},{label:"LyCORIS",value:"LoCon"},{label:"embedding1",value:"TextualInversion"}];return this.hideEmbedding&&(e=e.filter((function(e){return"TextualInversion"!==e.value}))),e},inputModelTypes:function(){var e;return null!==(e=this.modelTypeSelect)&&void 0!==e&&e.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value}))},isSD35Model:function(){var e;return(null===(e=this.getCurrentModelType)||void 0===e?void 0:e.includes("SD 3.5"))||!1},getCurrentTabConfig:function(){var e=this.topTabConfig.other;return this.hideEmbedding&&(e=e.filter((function(e){return"TextualInversion"!==e.code}))),"Checkpoint"===this.modelType?this.topTabConfig.checkpoint:e},showEmptyResult:function(){var e,t=!this.loading,n=!this.renderList.length&&!this.hotRecentUsedList.length,o="mine"===this.activeTab&&!["comprehensive"].includes(this.queryType),l="TextualInversion"===this.modelType&&"TextualInversion"===this.activeTopTab&&!(null!==(e=this.list)&&void 0!==e&&e.length);return t&&n&&(o||l)},lang:function(){return this.$i18n.locale},getTitle:function(){var e={Checkpoint:"Checkpoint",LORA:"LoRA",TextualInversion:this.$t("embedding1")}[this.modelType]||this.modelType;return"".concat(this.$t("selectModels"),"(").concat(e,")")},getModels:function(){var e=k.L.sd,t=k.L.sdxl,n=k.L.flux,l=k.L.sd35,r=k.L.pony,c=void 0===r?[]:r,d=k.L.other,v=void 0===d?[]:d,m=k.L.hy,h=void 0===m?[]:m,f=k.L.tongyi_pro,_=void 0===f?[]:f,y=k.L.tongyi_fast,C=void 0===y?[]:y,w=[].concat(Object(o.a)(e),Object(o.a)(l),Object(o.a)(t),Object(o.a)(n),Object(o.a)(v));return{sd:this.SDmodel||[].concat(Object(o.a)(e),Object(o.a)(v)),sdxl:this.SDXLmodel||t,sd35:l,flux:n,allBaseModels:w,pony:c,hy:h,tongyi_pro:_,tongyi_fast:C}},getBaseModel:function(){null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e||e.base_model_type;var e,t,n,l,r,c=this.getModels.sd;(c=this.isSDXL?this.getModels.sdxl:this.isPaintingBoard&&"Checkpoint"===this.modelType?this.getModels.allBaseModels:this.getModels.sd,this.isStudioMode||null!==(t=this.getCurrentModelType)&&void 0!==t&&t.includes("SD 3.5"))&&(c="Checkpoint"===this.modelType?[]:this.getModels.sd,c="Checkpoint"===this.modelType?this.getModels.allBaseModels:{sdxl:this.getModels.sdxl,sd:this.getModels.sd,flux:this.getModels.flux,"SD 3.5":this.getModels.sd35,"SD 3.5L":["SD 3.5L"],"SD 3.5M":["SD 3.5M"]}[this.getCurrentModelType]||this.getModels.sd);return"flux"===this.getCurrentModelType?(null===(r=this.easyTop)||void 0===r?void 0:r.isCommunityFlux)?Object(o.a)(k.L.flux):Object(o.a)(c):(null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isHunyuan&&(c=Object(o.a)((null===k.L||void 0===k.L?void 0:k.L.hy)||[])),null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isWan2114BModel&&(c=Object(o.a)((null===k.L||void 0===k.L?void 0:k.L.wan_video)||[])),Object(o.a)(c))},getCurrentModelType:function(){var e=(this.studioModelInfo||{}).base_model_type,t=void 0===e?"":e,n=this.getModels.sdxl,o=this.getModels.sd,l=this.getModels.flux,r=this.getModels.sd35,c=n.includes(t)||(t||"").includes("SDXL"),d=o.includes(t),v=l.includes(t)||(t||"").includes("Flux"),m=r.includes(t)||(t||"").includes("SD 3.5");return v?"flux":c?"sdxl":d||"SD 3"===t?"sd":m?t:Object(O.checkVideoModelType)(t)},showRecommendText:function(){var e;return!this.loading&&this.hotUsedList.length&&(null===(e=this.renderList)||void 0===e?void 0:e.length)&&"mine"===this.activeTab&&"comprehensive"===this.queryType},isNoRecentUsed:function(){return!this.loading&&!this.renderList.length&&"recent"===this.queryType&&this.showRecommendText},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},activeTabClass:function(){return function(e){return e&&e===this.activeTab?"tab-active":""}}},Object(d.c)(["isSupportWebp"])),{},{getImageUrl:function(){return function(e){var t="";return e.banner&&!["",null,void 0].includes(e.banner.url)?t=Object(v.K)(e.banner.url,this.$imgL):t}},activeSelectModel:function(){return function(e){var t=this.selectList.find((function(t){return(e.id||e.model_id)===(t.id||t.model_id)})),n=this.selectModel&&this.selectModel.id===(null==e?void 0:e.id);return t||n?"select-model-active":""}},renderList:function(){return this.list},hotUsedList:function(){return this.hotRecentUsedList},convertTabText:function(){return function(e){var t="LORA"===this.modelType?"MyStyle":"MyModel";return e.title?e.title:"bookmarks_choose"===e.type?this.$t(t):this.$t(e.i18nKey)}},isVideoType:function(){return function(e){return Object(O.checkVideoModelType)(e)}}}),beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceResize=null,this.debounceChangeHandle=null},watch:{hotRecentUsedList:{handler:function(e){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var t=0;t<this.selectList.length;t++)if(this.selectList[t].id===this.hotRecentUsedList[i].id&&this.selectList[t].art_model_ver_no_name&&this.hotRecentUsedList[i].version_name){this.hotRecentUsedList[i].version_name=this.selectList[t].art_model_ver_no_name,this.hotRecentUsedList[i].banner.url=this.selectList[t].model_cover;break}}},list:{handler:function(e){for(var i=0;i<this.list.length;i++)for(var t=0;t<this.selectList.length;t++)if(this.selectList[t].id===this.list[i].id&&this.selectList[t].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[t].art_model_ver_no_name,this.list[i].banner.url=this.selectList[t].model_cover;break}}},userInfo:{handler:function(e){var t;if(null!==(t=Object.keys(e))&&void 0!==t&&t.length){var n=e.settings,o=(void 0===n?{}:n).use_model_preset_meta_mode,l=void 0===o?1:o;this.enableUsePresetConfig=1===l}},deep:!0,immediate:!0}},mounted:function(){var e=this;this.initUsePresetConfigStatus(),this.debounceHandleScroll=Object(m.debounce)(this.handleScroll,600),this.debounceResize=Object(m.debounce)(this.handleResize,500),this.debounceChangeHandle=Object(m.debounce)(this.handleChangeUsePresetConfig,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){e.handleResize()}))},methods:L(L({},Object(d.b)("user",["recordEnableUsePresetConfig"])),{},{initUsePresetConfigStatus:function(){var e,t=localStorage.getItem("enableUsePresetConfig");this.isLoggedIn?(this.enableUsePresetConfig=[1,"1"].includes(null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.use_model_preset_meta_mode),localStorage.setItem("enableUsePresetConfig",this.enableUsePresetConfig?1:2)):this.enableUsePresetConfig=!!["",null,void 0].includes(t)||[1,"1"].includes(t)},handleConfirm:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.selectModel)if(t&&this.enableUsePresetConfig){var n,o,l=!0;if(this.isLoggedIn)l=null===(n=this.userInfo)||void 0===n?void 0:n.shot_task_v2_preset_meta_popup,null!==(o=this.userInfo)&&void 0!==o&&o.shot_task_v2_preset_meta_popup||localStorage.setItem("presetModelNotTips",1);else l=!localStorage.getItem("presetModelNotTips");if(l)this.$refs.commonConfirmModal.show({subTitle:"newGenerate60",fromPage:"modelPreset"}).then((function(){e.$emit("selectModel",e.selectModel,e.queryParam.model_type,t,!0),e.selectModel=null,e.$logEvent("log_actions",{operation:"click_try_it_now",behavior_info:"on_model_config_popup"})})).catch((function(){e.$emit("selectModel",e.selectModel,e.queryParam.model_type,t),e.selectModel=null}));else this.$emit("selectModel",this.selectModel,this.queryParam.model_type,t,!0),this.selectModel=null}else this.$emit("selectModel",this.selectModel,this.queryParam.model_type,t),this.selectModel=null;else this.handleClose()},handleChangeTopTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.activeTopTab!==e&&!this.loading){var t;if(["character","workflowApp"].includes(e))null==this||null===(t=this.easyTop)||void 0===t||t.switchCategory(e),this.handleClose();switch(this.activeTopTab=e,e){case"presetsModel":case"presetsLora":this.getPresetModels();break;case"communityMode":this.pageInfo.page=1,this.loading=!0,this.noMore=!1,this.modelTypeSelect=[],this.baseModelSelect=[],Reflect.deleteProperty(this.queryParam,"time_to"),this.checkGetList();break;case"LORA":case"TextualInversion":this.modelType=e,this.queryParam.model_type=this.modelType||"",this.pageInfo.page=1,this.loading=!0,this.noMore=!1,this.modelTypeSelect=[],this.baseModelSelect=[],this.list=[],this.hotRecentUsedList=[],Reflect.deleteProperty(this.queryParam,"time_to"),"LORA"===e?this.checkGetList():this.getPresetModels();break;default:this.checkGetList()}}},handleChangeUsePresetConfig:function(e){this.recordEnableUsePresetConfig(e?1:2),this.$logEvent("log_actions",{operation:"use_recommend_params",behavior_info:"on_choose_model_page",behavior_info_sub:e?"open":"close"})},onFilter:function(e,t){var n=this;this.loading||(1===t?this.modelTypeSelect.includes(e)?this.modelTypeSelect.forEach((function(t,o){t==e&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(e):this.baseModelSelect.includes(e)?this.baseModelSelect.forEach((function(t,o){t==e&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(e),"recommend"===this.queryType&&(this.tagIndex="hot"),this.checkGetList())},onFilterReset:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.modelTypeSelect=[],this.baseModelSelect=[],e||this.checkGetList())},changeQueryType:function(){this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:this.queryType,source:this.getCurrentSource()})},checkGetList:function(){"comprehensive"!==this.queryType?"recent"===this.queryType?this.handleGetRecentUsed():this.handleSearch():this.handleGetComList()},handleGetComList:function(){var e=this;this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to");var t,n={};(n.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,n.model_type=this.modelType||"LORA",n.scene="tf_v2","Checkpoint"!==this.modelType)&&(n.model_types=null!==(t=this.modelTypeSelect)&&void 0!==t&&t.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value})));return(this.isStudioMode||this.isSimpleMode)&&(n.mode="lab"),n.ss=k.e.GenerateSearch,this.loading=!0,Object(h.getModelComprehensive)(n).then((function(t){var n=t||{},o=n.status.code,code=void 0===o?"":o,l=n.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var r=Array.isArray(null==data?void 0:data.items)?data.items:[],c=Array.isArray(null==data?void 0:data.hot_used_items)?data.hot_used_items:[];e.noMore=!0;var d={},v=(r||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return d[t.id]||(d[t.id]=!0,e.push(t)),e}),[]).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));e.list=v.length<=10?v:v.slice(0,10),e.hotRecentUsedList=(c||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return d[t.id]||(d[t.id]=!0,e.push(t)),e}),[]).map((function(t){var n,o=(t.banner||{}).nsfw;[1,"1"].includes(void 0===o?0:o)&&(t.banner=Object.assign((null===(n=t)||void 0===n?void 0:n.banner)||{},{url:e.nsfwUrl}));var l=e.findSelectItem(t);return l&&(t=Object.assign(t,l)),t}))}return e.noDataView(),e.list})).finally((function(){e.loading=!1}))},setIcon:function(){var e=this,t="homeIcon1";return this.typeOption.forEach((function(n){e.tagIndex===n.id&&(t=n.icon)})),t},handleCommand:function(e){this.tagIndex=e,this.queryParam.order_by=this.tagIndex,this.handleSearch()},handleTimeCommand:function(e){this.timeName=e.name,this.queryParam.start_at=e.startTime,this.queryParam.end_at=e.endTime,this.handleSearch()},getTimestamps:function(){var e=new Date;return{startTimestamp:e-864e5,endTimestamp:e.getTime()}},getWeekTimeRange:function(){var e=new Date;return{startTimestamp:e-6048e5,endTimestamp:e.getTime()}},getMonthTimestampRange:function(){var e=new Date;e.getFullYear(),e.getMonth();return{startTimestamp:e-2592e6,endTimestamp:e.getTime()}},changeScroll:function(){var e=this;this.$refs.listItem.forEach((function(t,n){t.classList.contains("tab-active")&&(e.itemScroll={value:t.getBoundingClientRect().left,index:n})}))},getTag:function(){var e=this;Object(I.d)({show_area:"model"}).then((function(t){if(1e4===t.status.code){var n=t.data||[];n.length&&n.forEach((function(t){t.title=t[k.r[e.$i18n.locale]]})),e.tabList=[].concat(Object(o.a)(e.tabList),Object(o.a)(n))}}))},collectionBar:function(){var e=this;Object(c.J)({type:2}).then((function(t){1e4===t.status.code&&(e.modelOption=[{label:e.$t("All"),value:""}],t.data.items.forEach((function(t){e.modelOption.push({label:t.name,value:t.id})})))}))},changeType:function(e){this.list=[],this.pageInfo={page:1,limit:60,total:0},this.handleSearch()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1340px",this.gridNum=5):(this.modalWidth="1071px",this.gridNum=4)}catch(e){}},selectItem:function(e,t,n){var o,l;(t.model_ver_no=e.model_ver_id,t.version_name=e.version_no,t.base_model=e.base_model_name,t.modelTags=Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[],t.trained_words=Array.isArray(null==e?void 0:e.trained_words)?null==e?void 0:e.trained_words:[],null!==(o=e.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?t.banner.url=null===(l=e.sample)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url:t.banner.url="";n&&(this.selectModel=t,this.handleConfirm())},openModal:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.resetData(),this.modelType=t,this.token&&this.collectionBar(),this.queryParam.model_type=this.modelType||"",this.activeTopTab="";var n="LORA"===this.modelType?"presetsLora":"presetsModel";if(this.tabList=[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],this.activeTab="mine",this.queryType="comprehensive",this.getTag(),!this.token)return this.handleChangeTopTab(n),void(this.visible=!0);this.$nextTick((function(){"Checkpoint"===e.modelType?e.getRecentUsedModel().finally((function(){e.loading=!1,e.list.length&&e.list.length>=5?(n="communityMode",e.handleChangeTopTab(n)):(e.list=[],e.hotRecentUsedList=[],e.handleChangeTopTab(n))})):e.getRecentUsedModel().finally((function(){e.loading=!1,e.list.length&&e.list.length>=5?(n="LORA",e.handleChangeTopTab(n)):(e.list=[],e.hotRecentUsedList=[],e.handleChangeTopTab(n))})),e.visible=!0}))},getPresetModels:function(){var e=this;this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to");var t,n={};(n.scene="LORA"===this.modelType?"lora_select_popup":"model","lora_select_popup"===n.scene)&&(n.main_use_base_model=null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t?void 0:t.base_model_type,this.hotRecentUsedList=[],this.hideEmbedding&&(n.model_types=["LORA"]));return this.loading=!0,Object(T.easyGetPresetModel)(n).then((function(t){var o=t||{},l=o.status.code,code=void 0===l?"":l,r=o.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var c=Array.isArray(null==data?void 0:data.items)?data.items:[];e.noMore=!0;var d={},v=(c||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return d[t.id]||(d[t.id]=!0,e.push(t)),e}),[]).filter((function(t){return"Checkpoint"===e.modelType?t.type===e.modelType:t})).map((function(t){var n,o=(t.banner||{}).nsfw;[1,"1"].includes(void 0===o?0:o)&&(t.banner=Object.assign((null===(n=t)||void 0===n?void 0:n.banner)||{},{url:e.nsfwUrl}));var l=e.findSelectItem(t);return l&&(t=Object.assign(t,l)),t}));"lora_select_popup"===n.scene?(e.presetsModelList=[],e.list=v):(e.presetsModelList=v,e.list=v)}e.noDataView()})).finally((function(){e.loading=!1}))},handleClose:function(){this.visible=!1,this.resetData()},resetData:function(){this.modelType="LORA",this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.list=[],this.activeTab="mine",this.queryType="comprehensive",this.loading=!1,this.noMore=!1,this.hotRecentUsedList=[],this.selectModel=null},handleViewMore:function(){this.activeTab="",this.handleTabClick("mine","recommend")},handleTabClick:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e===this.activeTab||this.loading||(this.activeTab=e,this.queryType="mine"===e?n||"comprehensive":"recommend",this.$nextTick((function(){t.changeScroll()})),this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:e,source:this.getCurrentSource()}))},screenAll:function(){this.activeTab="mine",this.baseModelSelect=[],this.modelTypeSelect=[],this.queryParam.order_by="hot",this.queryParam.created="",this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.$logEvent("log_actions",{operation:"click_search_all",behavior_info:"on_choose_model_page",behavior_info_sub:this.activeTab}),this.handleSearch()},handleSearch:function(){this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.list=[],this.hotRecentUsedList=[],Reflect.deleteProperty(this.queryParam,"time_to"),"recent"===this.queryType&&(this.queryType="recommend"),"comprehensive"===this.queryType&&(this.queryType="recommend"),this.getList(),this.$logEvent("log_actions",{operation:"TextualInversion"===this.modelType?"click_tab":"click_choose_model_tab",behavior_info:"TextualInversion"===this.modelType?"on_create_flow_page_embedding_settings":"on_choose_model_page",behavior_info_sub:"search_btn",source:this.getCurrentSource()})},handleScroll:function(){var e=this.$refs.scrollWrapper;try{e&&e.scrollTop+e.clientHeight>=e.scrollHeight-30&&"recent"!==this.queryType&&this.getList(!0)}catch(e){}},getList:function(e){var t=this;if(!this.loading&&!this.noMore){this.loading=!0;var n,o={collect:"bookmarks",recommend:"community",bookmarks_choose:"bookmarks_choose"}[JSON.parse(JSON.stringify(this.queryType))]||"",l={page:this.pageInfo.page,page_size:this.pageInfo.limit,type:o,scene:"tf_v2"};if((this.isStudioMode||this.isSimpleMode)&&(l.mode="lab"),this.inTask&&(l.refer="task"),"bookmarks"===l.type){var c=0;l.folder_no=this.showType;try{var d,v=this.list.length?this.list[this.list.length-1]:null;c=(null==v||null===(d=v.collect)||void 0===d?void 0:d.collect_at)||0,l.after=1===l.page?0:c}catch(e){}}if(["recent","collect","bookmarks","bookmarks_choose","recommend","comprehensive","mine"].includes(this.activeTab)||(l.tags=[this.activeTab],l.type="community"),l.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,"Checkpoint"!==this.modelType)l.model_types=null!==(n=this.modelTypeSelect)&&void 0!==n&&n.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value}));Object.assign(l,this.queryParam);var m=""!==this.queryParam.keyword&&"recommend"===this.queryType?r.q:r.s;l.ss=k.e.GenerateSearch,m(l).then((function(n){var o=n||{},l=o.status,r=void 0===l?{}:l,c=o.data,data=void 0===c?{}:c,d=r.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(t.noMore=!data.has_more,e){var v=t.list.map((function(e){return e.id})),m=(n.data.items||[]).filter((function(e){return!v.includes(e.id)})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}));t.list=t.list.concat(m)}else{var h,f=((null==n||null===(h=n.data)||void 0===h?void 0:h.items)||[]).reduce((function(e,t){return e.some((function(e){return e.id===t.id}))||e.push(t),e}),[]);t.list=(f||[]).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}1===t.pageInfo.page&&(t.queryParam.time_to=n.data.time_ms),t.pageInfo.page++,t.loading=!1,t.keyWordCopy=t.queryParam.keyword,t.noDataView()}})).catch((function(e){console.log(e)})).finally((function(){t.loading=!1}))}},noDataView:function(){var e=!this.loading,t=!this.list.length,n="mine"!==this.activeTab,o=""===this.queryParam.keyword,l=e&&t&&n&&o,r=e&&t&&n&&!o;this.tabShowTagEmpty=l,this.showTagEmpty=r},findSelectItem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(e)){var t=this.selectList.find((function(t){return(e.id||e.model_id)===(t.id||t.model_id)}));return e=t||e}return null},getCurrentSource:function(){return"TextualInversion"===this.modelType?"embedding":this.isSimpleMode?"simple_task":this.isPaintingBoard?"painting_board":"task"},handleSelectPresetModel:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];["","el-icon-arrow-down"].includes(null===(t=e.target)||void 0===t?void 0:t.className)||(o?this.$message.warning(this.$t("CannotSelectedRepeatedly")):(this.selectModel=n,this.handleConfirm("Checkpoint"!==this.modelType?"":"preset")))},handleSelect:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(["cltpop","use"].includes(null===(e=(arguments.length>2?arguments[2]:void 0).target)||void 0===e?void 0:e.className)){if(n)return void this.$message.warning(this.$t("CannotSelectedRepeatedly"));if(this.isStudioMode&&!this.isStudioFlux&&"Checkpoint"!==this.modelType){var o=(this.studioModelInfo||{}).base_model_type,l=void 0===o?"":o,r=this.getModels.sdxl,c=this.getModels.sd,d=(this.getModels.sd3,this.getModels.sd35),v=r.includes(l)||(l||"").includes("SDXL"),m=c.includes(l),h=d.includes(l)||(l||"").includes("SD 3.5"),f=r.includes(null==t?void 0:t.base_model)||((null==t?void 0:t.base_model)||"").includes("SDXL"),_=c.includes(null==t?void 0:t.base_model),y=d.includes(null==t?void 0:t.base_model)||((null==t?void 0:t.base_model)||"").includes("SD 3.5");return v&&!f||m&&!_||h&&!y?void this.$message.warning(this.$t("studio25")):(this.$logEvent("log_actions",{operation:"click_choose_model",behavior_info:"on_choose_model_page",behavior_info_sub:null==t?void 0:t.id,source:this.getCurrentSource()}),this.selectModel=t,void this.handleConfirm())}this.$logEvent("log_actions",{operation:"click_choose_model",behavior_info:"on_choose_model_page",behavior_info_sub:null==t?void 0:t.id,source:this.getCurrentSource()}),this.selectModel=t,this.handleConfirm()}},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getRecentUsedModel()},getRecentUsedModel:function(){var e,t=this,n={};(n.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,"TextualInversion"===this.modelType&&(n.model_type="TextualInversion"),(this.isStudioMode||this.isSimpleMode)&&(n.mode="lab"),n.scene="tf_v2","Checkpoint"!==this.modelType)&&(n.model_types=null!==(e=this.modelTypeSelect)&&void 0!==e&&e.length?this.modelTypeSelect:this.modelTypes.map((function(e){return e.value})));return n.ss=k.e.GenerateSearch,this.loading=!0,Object(h.getRecentUsed)(n).then((function(e){var n=e||{},o=n.status.code,code=void 0===o?"":o,l=n.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var r=Array.isArray(data.items)?data.items:[],c={};t.list=(r||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return c[t.id]||(c[t.id]=!0,e.push(t)),e}),[]).filter((function(e){var n="Checkpoint"===t.modelType?[t.modelType]:["LORA","LoCon","DoRA","TextualInversion"];return t.isStudioMode||t.isSimpleMode?n.includes(e.type):n.includes(e.type)&&(null==e?void 0:e.id)!==k.m})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},handleDetail:function(e){(null==e?void 0:e.id)&&window.open("/models/detail/".concat(e.id))},convertModelFlag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getModels.sdxl,n=this.getModels.flux||[],o=e.type,l=void 0===o?"":o,r=e.base_model,c=void 0===r?"":r,d={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:this.$t("embedding1")}[l]||l,v=t.includes(c)||(c||"").includes("SDXL");if(["LORA","DoRA","LoCon","TextualInversion"].includes(l)){var m=d;return n.includes(c)?m=d+" | F1 ":v&&(m=d+("Illustrious"===c?" | IL ":" | SDXL")),Object(O.checkVideoModelType)(c)&&["LORA","DoRA","LoCon"].includes(l)?d:m}return n.includes(c)?"LORA"===this.modelType?d+" | F1 ":"Checkpoint | F1 ":v?"SDXL":""}})},D=$,j=(n(4158),n(4159),n(0)),component=Object(j.a)(D,(function(){var e,t,n,o,l,r=this,c=r._self._c;return c("el-dialog",{ref:"styleModal",attrs:{title:r.getTitle,visible:r.visible,width:r.modalWidth,height:"auto","custom-class":"easy-style-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!0,center:""},on:{"update:visible":function(e){r.visible=e},close:function(e){return r.onFilterReset(!0)}}},[c("template",{slot:"title"},[c("div",{staticClass:"easy-style-modal-header"},[c("div",{staticClass:"easy-style-modal-header-tabs"},r._l(r.getCurrentTabConfig,(function(e){return c("div",{key:"top_tab_".concat(e.code),staticClass:"header-tabs-item",class:[r.activeTopTab===(null==e?void 0:e.code)&&"header-tabs-item-active"],on:{click:function(t){return t.stopPropagation(),r.handleChangeTopTab(e.code)}}},[r._v("\n          "+r._s(r.$t(e.i18nKey))+"\n        ")])})),0),r._v(" "),c("div",{staticClass:"header-close-btn",on:{click:function(e){return e.stopPropagation(),r.handleClose()}}},[c("i",{staticClass:"el-icon-close"})])])]),r._v(" "),c("div",{staticClass:"style-content-wrapper"},[["presetsModel","TextualInversion","presetsLora"].includes(r.activeTopTab)?r._e():c("div",{staticClass:"style-content__header"},[c("swipeable-list",{attrs:{scrollChange:r.itemScroll,top:"15px"}},[c("div",{staticClass:"style-content__header-tabs"},r._l(r.tabList,(function(e,t){return c("div",{key:"tab_".concat(null==e?void 0:e.id,"_").concat(t)},[c("div",{ref:"listItem",refInFor:!0,staticClass:"style-content__header-tabs-item",class:[r.activeTabClass(e.id)],on:{click:function(t){return t.stopPropagation(),r.handleTabClick(e.id)}}},[r._v("\n              "+r._s(r.convertTabText(e))+"\n            ")])])})),0)])],1),r._v(" "),["presetsModel","TextualInversion","presetsLora"].includes(r.activeTopTab)?r._e():c("div",{staticClass:"style-content__search-box"},[c("div",[r._e(),r._v(" "),c("LenovoInput",{attrs:{width:404,screen:{activeTab:r.activeTab,baseModelSelect:r.baseModelSelect.length?r.baseModelSelect:r.getBaseModel,modelType:r.modelType,model_types:r.inputModelTypes,isStudioMode:r.isStudioMode,isSimpleMode:r.isSimpleMode},isLoca:"creative",clearable:"",placeholder:"LORA"===r.modelType?r.$t("TaskStylePlaceHolder"):r.$t("TaskModelPlaceHolder")},on:{onScreen:r.handleSearch,clear:r.handleSearch},model:{value:r.queryParam.keyword,callback:function(e){r.$set(r.queryParam,"keyword",e)},expression:"queryParam.keyword"}}),r._v(" "),c("span",{staticClass:"style-content__search-btn style-content__search-btn-gra-border",on:{click:function(){return""!=r.queryParam.keyword&&r.handleSearch()}}},[c("span",[r._v(r._s(r.$t("Search")))])])],1),r._v(" "),c("div",{staticClass:"search-right"},[c("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[c("div",{staticClass:"filterCnt"},["Checkpoint"===r.modelType||r.isSD35Model?r._e():c("div",[c("div",{staticClass:"filterTit"},[r._v("\n                "+r._s(r.$t("ModelType"))+"\n              ")]),r._v(" "),c("div",{staticClass:"filterList"},r._l(r.modelTypes,(function(e,t){return c("div",{key:t,staticClass:"filterItem",class:{AfilterItem:r.modelTypeSelect.includes(e.value)},on:{click:function(t){return r.onFilter(e.value,1)}}},[r.modelTypeSelect.includes(e.value)?c("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),c("span",[r._v(r._s(r.$t(e.label)))])])})),0)]),r._v(" "),c("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[r._v(r._s(r.$t("BaseModel")))]),r._v(" "),c("div",{staticClass:"filterList"},r._l(r.getBaseModel,(function(e,t){return c("div",{key:t,staticClass:"filterItem",class:{AfilterItem:r.baseModelSelect.includes(e)},on:{click:function(t){return r.onFilter(e,2)}}},[r.baseModelSelect.includes(e)?c("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),c("span",[r._v(r._s("TextualInversion"===e?r.$t("embedding1"):e))])])})),0),r._v(" "),c("div",{staticClass:"filterReset graBorder",on:{click:function(e){return r.onFilterReset(!1)}}},[r._v("\n              "+r._s(r.$t("resetSelection"))+"\n            ")])]),r._v(" "),c("el-badge",{staticClass:"item",attrs:{slot:"reference",value:(null===(e=r.modelTypeSelect)||void 0===e?void 0:e.length)+(null===(t=r.baseModelSelect)||void 0===t?void 0:t.length),hidden:(null===(n=r.modelTypeSelect)||void 0===n?void 0:n.length)+(null===(o=r.baseModelSelect)||void 0===o?void 0:o.length)==0},slot:"reference"},[c("div",{staticClass:"filterBox"},[c("div",[c("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),c("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})])])],1),r._v(" "),"mine"===r.activeTab&&"collect"===r.queryType&&r.modelOption.length>0?c("el-select",{staticClass:"showType custom-select",class:r.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:r.changeType},model:{value:r.showType,callback:function(e){r.showType=e},expression:"showType"}},r._l(r.modelOption,(function(e){return c("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):r._e(),r._v(" "),"mine"===r.activeTab?c("el-select",{staticClass:"showType custom-select",class:r.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:r.changeQueryType},model:{value:r.queryType,callback:function(e){r.queryType=e},expression:"queryType"}},r._l(r.queryOptionsList,(function(e){return c("el-option",{key:e.value,attrs:{label:r.$t(e.i18nKey),value:e.value}})})),1):r._e(),r._v(" "),["recent","collect","bookmarks","bookmarks_choose","recommend","mine"].includes(r.activeTab)?r._e():c("div",{staticClass:"Screening"},[c("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleTimeCommand}},[c("div",{staticClass:"el-dropdown-link selectTime"},[c("div",[c("i",{staticClass:"el-icon-time"}),r._v(" "),c("span",[r._v(r._s(r.$t(r.timeName)))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.timeTypeOption,(function(e,t){return c("el-dropdown-item",{key:t,attrs:{command:e}},[c("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[c("span",[r._v(r._s(r.$t(e.name)))])])])})),1)],1),r._v(" "),c("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleCommand}},[c("div",{staticClass:"el-dropdown-link"},[c("div",[c("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(r.setIcon())}),r._v(" "),c("span",[r._v(r._s(r.$t(r.tagIndex.charAt(0).toUpperCase()+r.tagIndex.slice(1))))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.typeOption,(function(e,t){return c("el-dropdown-item",{key:t,attrs:{command:e.id}},[c("div",{staticClass:"el-dropdown-item"},[c("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(e.icon)}),r._v(" "),c("span",[r._v(r._s(r.$t(e.name)))])])])})),1)],1)],1)],1)]),r._v(" "),["presetsModel"].includes(r.activeTopTab)&&"Checkpoint"===r.modelType?c("div",{directives:[{name:"show",rawName:"v-show",value:!r.loading&&(null===(l=r.presetsModelList)||void 0===l?void 0:l.length),expression:"!loading && presetsModelList?.length"}],staticClass:"presets-model-option-btn"},[c("el-checkbox",{staticClass:"presets-model-option-checkbox",on:{change:r.debounceChangeHandle},model:{value:r.enableUsePresetConfig,callback:function(e){r.enableUsePresetConfig=e},expression:"enableUsePresetConfig"}},[r._v("\n        "+r._s(r.$t("newGenerate59"))+"\n      ")])],1):r._e(),r._v(" "),c("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"style-content__list-wrapper",class:[r.isNoRecentUsed?"style-content__list-wrapper-no-margin":"",!["presetsModel","presetsLora"].includes(r.activeTopTab)&&"style-content__list-wrapper-box",["presetsModel"].includes(r.activeTopTab)&&"style-content__list-wrapper-presetModel"],style:{gridTemplateColumns:"repeat(".concat(r.gridNum,", 1fr)")},on:{scroll:r.handleScroll}},[["presetsModel"].includes(r.activeTopTab)?r._l(r.presetsModelList,(function(e){var t;return c("div",{key:"preset_mode_".concat(e.id),staticClass:"style-content__list-item style-content__list-item-preset-model",class:[r.activeSelectModel(e)],on:{click:function(t){t.stopPropagation(),r.handleSelectPresetModel(t,e,r.activeSelectModel(e))}}},[c("div",{staticClass:"preset-model-cltpop"},[c("div",{staticClass:"collect-popover-container"},[c("CollectPopover",{attrs:{type:"model",folder:e,from:"waterfall"}})],1),r._v(" "),c("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),r.handleDetail(e)}}},[r._v("\n              "+r._s(r.$t("Details"))+"\n            ")])]),r._v(" "),c("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)?c("div",{staticClass:"list-item-image-card-image"},[c("div",{staticClass:"image-empty"},[r._v(r._s(r.$t("EmptyBannerText")))])]):c("el-image",{staticClass:"list-item-image-card-image",attrs:{src:r.getImageUrl(e)}},[c("template",{slot:"error"},[c("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:e&&e.banner?e.banner.url:"",alt:""}})])],2)],1),r._v(" "),c("div",{staticClass:"image-describe-box"},[c("div",{staticClass:"image-describe-box-main-title"},[r._v(r._s(e.name))]),r._v(" "),c("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:(null==e?void 0:e.desc)||"",placement:"bottom"}},[c("div",{staticClass:"image-describe-box-describe-text"},[r._v(r._s((null==e?void 0:e.desc)||""))])])],1)])})):[r.renderList.length?r._l(r.renderList,(function(e){var t;return c("div",{key:e.id,staticClass:"style-content__list-item",class:[r.activeSelectModel(e)],on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[c("div",{staticClass:"top-box"},[e.is_agency_fee?c("div",{staticClass:"payNum"},[c("modelPayNum",{attrs:{number:e.agency_fee}})],1):r._e()]),r._v(" "),c("div",{staticClass:"cltpop"},[c("div",{staticClass:"collect-popover-container"},[c("CollectPopover",{attrs:{type:"model",folder:e,from:"waterfall"}})],1),r._v(" "),c("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),r.handleDetail(e)}}},[r._v("\n                "+r._s(r.$t("Details"))+"\n              ")])]),r._v(" "),c("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)?c("div",{staticClass:"list-item-image-card-image"},[c("div",{staticClass:"image-empty"},[r._v(r._s(r.$t("EmptyBannerText")))])]):c("el-image",{staticClass:"list-item-image-card-image",attrs:{src:r.getImageUrl(e)}},[c("template",{slot:"error"},[c("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:e&&e.banner?e.banner.url:"",alt:""}})])],2)],1),r._v(" "),c("div",{staticClass:"list-item-image-mask"},[c("div",{staticClass:"list-item-image-mask-row"},[c("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:e.name}},[r._v(r._s(e.name))])]),r._v(" "),c("div",{staticClass:"list-item-image-mask-row"},[c("changeVer",{attrs:{from:"styleModal",item:e,base_models:r.getBaseModel},on:{selectItem:function(t){return r.selectItem(t,e,r.activeSelectModel(e))}}}),r._v(" "),c("div",{staticClass:"use",on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[r._v("\n                  "+r._s(r.$t("workFlow46"))+"\n                ")])],1)]),r._v(" "),"Pony"===(null==e?void 0:e.base_model)?[c("span",{staticClass:"model-type-flag"},[r._v("\n                "+r._s("TextualInversion"===e.type?r.$t("embedding1"):"LoCon"===e.type?"LyCORIS":e.type)+"\n                "),c("span",{staticClass:"model-type-flag-line"},[r._v("|")]),c("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[c("span",{directives:[{name:"show",rawName:"v-show",value:""!==r.convertModelFlag(e),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[r._v(r._s(r.convertModelFlag(e)))])],r._v(" "),r.isVideoType(null==e?void 0:e.base_model)?c("div",{staticClass:"video-flag"},[c("i",{staticClass:"iconfont icon-icon-tag-video"})]):r._e()],2)})):r._e(),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:r.showRecommendText,expression:"showRecommendText"}],staticClass:"recommend-text",style:{gridColumn:"span ".concat(r.gridNum)}},[c("div",{staticClass:"recommend-text-line"}),r._v(" "),c("div",{staticClass:"recommend-text-main"},[r._v(r._s(r.$t("styleModalLineText")))]),r._v(" "),c("div",{staticClass:"recommend-text-line"})]),r._v(" "),!r.loading&&r.hotUsedList.length&&"mine"===r.activeTab&&["comprehensive"].includes(r.queryType)?[r._l(r.hotUsedList,(function(e){var t;return c("div",{key:"hot_".concat(e.id),staticClass:"style-content__list-item",class:[r.activeSelectModel(e)],on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[c("div",{staticClass:"top-box"},[e.is_agency_fee?c("div",{staticClass:"payNum"},[c("modelPayNum",{attrs:{number:e.agency_fee}})],1):r._e()]),r._v(" "),c("div",{staticClass:"cltpop"},[c("div",{staticClass:"collect-popover-container"},[c("CollectPopover",{attrs:{type:"model",folder:e,from:"waterfall"}})],1),r._v(" "),c("div",{staticClass:"detail-button",on:{click:function(t){return t.stopPropagation(),r.handleDetail(e)}}},[r._v("\n                "+r._s(r.$t("Details"))+"\n              ")])]),r._v(" "),c("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)?c("div",{staticClass:"list-item-image-card-image"},[c("div",{staticClass:"image-empty"},[r._v(r._s(r.$t("EmptyBannerText")))])]):c("el-image",{staticClass:"list-item-image-card-image",attrs:{src:r.getImageUrl(e)}},[c("template",{slot:"error"},[c("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:e&&e.banner?e.banner.url:"",alt:""}})])],2),r._v(" "),c("div",{staticClass:"list-item-image-mask"},[c("div",{staticClass:"list-item-image-mask-row"},[c("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:e.name}},[r._v(r._s(e.name))])]),r._v(" "),c("div",{staticClass:"list-item-image-mask-row"},[c("changeVer",{attrs:{from:"styleModal",item:e,base_models:r.getBaseModel},on:{selectItem:function(t){return r.selectItem(t,e,r.activeSelectModel(e))}}}),r._v(" "),c("div",{staticClass:"use",on:{click:function(t){return t.stopPropagation(),function(t){return r.handleSelect(e,r.activeSelectModel(e),t)}.apply(null,arguments)}}},[r._v("\n                    "+r._s(r.$t("workFlow46"))+"\n                  ")])],1)])],1),r._v(" "),"Pony"===(null==e?void 0:e.base_model)?[c("span",{staticClass:"model-type-flag"},[r._v("\n                "+r._s("TextualInversion"===(null==e?void 0:e.type)?r.$t("embedding1"):"LoCon"===(null==e?void 0:e.type)?"LyCORIS":null==e?void 0:e.type)+"\n                "),c("span",{staticClass:"model-type-flag-line"},[r._v("|")]),c("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[c("span",{directives:[{name:"show",rawName:"v-show",value:""!==r.convertModelFlag(e),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[r._v(r._s(r.convertModelFlag(e)))])],r._v(" "),r.isVideoType(null==e?void 0:e.base_model)?c("div",{staticClass:"video-flag"},[c("i",{staticClass:"iconfont icon-icon-tag-video"})]):r._e()],2)})),r._v(" "),c("div",{staticClass:"show-more-item",style:{gridColumn:"span ".concat(r.gridNum)}},[c("span",{staticClass:"show-more-item-btn",on:{click:function(e){return e.stopPropagation(),r.handleViewMore()}}},[c("span",{staticClass:"show-more-item-btn-text"},[r._v(r._s(r.$t("viewMore")))]),r._v(" "),c("i",{staticClass:"iconfont icon-icon-direction-down show-more-item-btn-icon"})])])]:r._e(),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:r.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[c("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),r._v(" "),"LORA"===r.modelType&&"mine"===r.activeTab&&["recent"].includes(r.queryType)&&["",null,void 0].includes(r.queryParam.keyword)?[r._v("\n            "+r._s(r.$t("styleRecent"))+"\n          ")]:"LORA"===r.modelType&&["collect"].includes(r.queryType)&&"mine"===r.activeTab&&["",null,void 0].includes(r.queryParam.keyword)?[r._v("\n            "+r._s(r.$t("styleCollect"))+"\n          ")]:[r._v(r._s(r.$t("NoResultsFound")))]],2),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:r.showTagEmpty,expression:"showTagEmpty"}],staticClass:"tag-empty-box flex_c_m"},[c("div",{staticClass:"item flex_c"},[c("p",[r._v(r._s(r.$t("screenTagNodata",{keyword:r.keyWordCopy?' "'.concat(r.keyWordCopy,'" '):""})))]),r._v(" "),c("div",{staticClass:"btn",on:{click:r.screenAll}},[r._v(r._s(r.$t("screenAll")))])])]),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:r.tabShowTagEmpty,expression:"tabShowTagEmpty"}],staticClass:"style-content__list-empty"},[c("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),r._v(" "),c("p",[r._v(r._s(r.$t("NoResultsFound")))])],1)]],2)]),r._v(" "),c("common-confirm-modal",{ref:"commonConfirmModal"})],2)}),[],!1,null,"ee4a5ee0",null);t.default=component.exports;installComponents(component,{SwipeableList:n(52).default,LenovoInput:n(239).default,CollectPopover:n(63).default,SvgIcon:n(115).default})},2886:function(e,t,n){e.exports={}},298:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(18),n(21);var o=n(3),l=n(14),r=n(2),c=(n(20),n(11),n(6),n(32),n(73),n(22),n(24),n(65),n(8),n(12),n(13),n(4),n(177),n(28),n(43),n(113),n(77),n(44),n(7),n(279)),d=n(102),v=n(38),m=n(75),h=n(156),f=n(280),_=n(35),y=n.n(_),C=n(1),w=n(29),k=n(10),I=n(209),x=n(471),T=n(3304),S=n(200),O=n(46),P=n(144),M=n(54),L=n(324),$=n(161),D=n(33),j=n(848),E=n(97),A=n(165),N=n(99),V=n(3305);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},U=Object(h.a)()?"DOMMouseScroll":"mousewheel",G={components:{ViewImage:I.a,AiChatCreateConfirm:c.a,textOverflowArea:x.default,DownloadVideoPop:S.default,ShareDialog:P.default,ImageActionButtons:j.default,commonConfirmModal:E.default,LyricAudio:T.default,OneLineEllipsisWithExpand:V.default},name:"EasyTaskImageViewer",inject:{easyTop:{default:function(){return null}}},props:{operateNumber:{type:Number,default:function(){return 1}},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},showOperateBtn:{type:Boolean,default:function(){return!1}},message:{type:Object,default:function(){return{}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},nsfw:{type:Number,default:2},customForm:{type:Boolean,default:!1},isFromHistory:{type:Boolean,default:!1},showChatBtn:{type:Boolean,default:!0},checkIsShowViewNsfw:{type:Boolean,default:!1}},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0"),d=t.getSeconds().toString().padStart(2,"0");return Object(k.F)(t,new Date)?"".concat(r,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(l," ").concat(r,":").concat(c,":").concat(d)}},data:function(){return{removeCameraMarkers:N.removeCameraMarkers,dialogVisible:!1,index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:B.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},isI18nToggled:!1,intLoraModel:[],getMetaLoading:!1,alreadySave:!1,workId:"",isClickedShareBtn:!1,isInViewImage:!1,specialPrompt:""}},computed:F(F(F(F({},Object(C.c)(["isSupportWebp","videoHasVoice"])),Object(C.c)("user",["accountSettingsData","isCompanyAccount","userInfo"])),Object(C.c)("creation",["studioStyle","lab_styles","smart_edit_template_id"])),{},{isNsfwPlus:function(){var e,t;return(null==this||null===(e=this.currentImgInfo)||void 0===e?void 0:e.is_nsfw_plus)&&1!==(null==this||null===(t=this.currentImgInfo)||void 0===t?void 0:t.nsfw)},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},getActionButtons:function(){var e,t,n=((null==this||null===(e=this.currentImgInfo)||void 0===e||null===(e=e.action_capability)||void 0===e?void 0:e.basic)||[]).map((function(e){return e.val})).filter((function(e){return"supportFeedback"!==e}));return this.isShowNsfwIcon&&(n=[].concat(Object(l.a)(n),["supportFeedback","supportReport"])),null!=this&&null!==(t=this.currentImgInfo)&&void 0!==t&&t.is_saved_personal&&(n=n.filter((function(e){return"supportSave"!==e}))),n.map((function(e){return D.IMAGE_OPERATION_BTN_LIST.find((function(t){return t.permissionKey===e}))})).filter(Boolean).map((function(e){return F(F({},e),{},{type:e.code})}))},editButtons:function(){var e;return((null==this||null===(e=this.currentImgInfo)||void 0===e||null===(e=e.action_capability)||void 0===e?void 0:e.edit)||[]).map((function(e){return F(F({},D.IMAGE_OPERATION_BTN_LIST.find((function(t){return(null==t?void 0:t.permissionKey)===e.val}))),{},{creativityTemplateId:e.creativity_template_id})})).filter(Boolean).map((function(e){return"aiErase"===e.code&&(e.icon="iconfont icon-a-AIEraser"),F(F({},e),{},{type:e.code})}))},moreButtons:function(){var e;return((null==this||null===(e=this.currentImgInfo)||void 0===e||null===(e=e.action_capability)||void 0===e?void 0:e.extend)||[]).map((function(e){return F(F({},D.IMAGE_OPERATION_BTN_LIST.find((function(t){return(null==t?void 0:t.permissionKey)===e.val}))),{},{creativityTemplateId:e.creativity_template_id})})).filter(Boolean).map((function(e){return F(F({},e),{},{type:e.code})}))},inviteCode:function(){var e;return(null===(e=this.userInfo)||void 0===e?void 0:e.invite_user_code)||""},getEffectInfo:function(){var e;return(null==this||null===(e=this.message)||void 0===e?void 0:e.creativity)||{}},getModelList:function(){var e,t,n,o=(null===(e=this.message)||void 0===e?void 0:e.art_model)||{};o=F(F({},o),{},{type:"Checkpoint"});var r=((null===(t=this.message.meta)||void 0===t?void 0:t.lora_models)||[]).map((function(e){var t,n;return F(F(F({},e),(null==e?void 0:e.art_model)||{}),{},{type:"LoCon"===(null==e||null===(t=e.art_model)||void 0===t?void 0:t.type)?"LyCORIS":(null==e||null===(n=e.art_model)||void 0===n?void 0:n.type)||"LORA"})}));return o&&null!==(n=o)&&void 0!==n&&n.id?[o].concat(Object(l.a)(r)):r},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isShowSaveTo:function(){var e,t=this.message.img_uris,n=void 0===t?[]:t;return!!n.length&&(!(null!==(e=n[this.operateNumber-1])&&void 0!==e&&e.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},studioRenderList:function(){var e=this;return(this.lab_styles||[]).map((function(t){var n="labStyle_".concat(t.value.replace(/\s/g,""));return{label:e.$t(n)||t.value,id:t.value}}))},getStudioStyle:function(){var e,t=(null===(e=this.message.meta)||void 0===e||null===(e=e.lab_base)||void 0===e?void 0:e.style_selections)||[];return(this.studioRenderList||[]).filter((function(e){return t.includes(e.id)})).map((function(e){return e.label})).join("、")||""},isSdModel:function(){var e,t;return[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isStudioMode:function(){var e,t;return["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.getImageUrl(this.urlList[this.index].url)},currentImgInfo:function(){return this.urlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,n=e.deg,o=e.offsetX,l=e.offsetY,r=e.enableTransition,style={transform:"scale(".concat(t,") rotate(").concat(n,"deg)"),transition:r?"transform .3s":"","margin-left":"".concat(o,"px"),"margin-top":"".concat(l,"px")};return this.mode===B.CONTAIN&&(style.maxWidth=style.maxHeight="100%"),style},viewerZIndex:function(){var e=f.a.nextZIndex();return this.zIndex>e?this.zIndex:e},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?e:t},convertTaskType:function(){var e;return A.b[null===(e=this.message)||void 0===e?void 0:e.task_domain_type]||A.c[this.message.type]||""}}),watch:{accountSettingsData:{handler:function(e){this.isI18nToggled=!e.is_off_localization},deep:!0},index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(e){var t=this;this.$nextTick((function(){var e,n=null===(e=t.$refs)||void 0===e||null===(e=e.img)||void 0===e?void 0:e[0];null!=n&&n.complete||(t.loading=!0)}))}},methods:{handleDeleteSingleImg:function(){var e=this;this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){var t;e.$emit("handleDeleteSingleImg",null==e?void 0:e.currentImgInfo,null===(t=e.currentImgInfo)||void 0===t?void 0:t.index),e.prev()})).catch((function(e){console.log("err",e)}))},assembleParams:function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y=[];null!==(e=this.message)&&void 0!==e&&null!==(e=e.meta)&&void 0!==e&&null!==(e=e.controlnet_units)&&void 0!==e&&e.length&&(null===(h=this.message)||void 0===h||h.meta.controlnet_units.forEach((function(e){y.push({mode:"ctr_net",image:{url:e.input_image},ctr_net_cond:e})})));null!==(t=this.message)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&null!==(t=t.init_images)&&void 0!==t&&t.length&&(null===(f=this.message)||void 0===f||f.meta.init_images.forEach((function(e){y.push({mode:"img2img",image:{url:e}})})));null!==(n=this.message)&&void 0!==n&&null!==(n=n.meta)&&void 0!==n&&null!==(n=n.lab_base)&&void 0!==n&&null!==(n=n.conds)&&void 0!==n&&n.length&&(null===(_=this.message)||void 0===_||null===(_=_.meta)||void 0===_||null===(_=_.lab_base)||void 0===_||_.conds.forEach((function(e){y.push({mode:"StyleReference"===e.mode?"style_ref":"ImagePrompt"===e.mode?"img2img":"ip_maintain",image:{url:e.image}})})));return{task_id:this.message.id,used_models:this.getModelList.map((function(e){return F(F({},e),{},{model_no:e.id,model_type:e.type,base_model_name:e.base_model})})),title:"",cover:{url:this.urlList[this.index].url,width:this.urlList[this.index].width,height:this.urlList[this.index].height},meta:{prompt:null!==(o=this.message.local_prompt)&&void 0!==o?o:"",negative_prompt:null!==(l=this.message.meta.negative_prompt)&&void 0!==l?l:"",cfg_scale:this.message.meta.cfg_scale,clip_skip:this.message.meta.clip_skip,width:null!==(r=this.message.meta.width)&&void 0!==r?r:"",height:null!==(c=this.message.meta.height)&&void 0!==c?c:"",steps:null!==(d=this.message.meta.steps)&&void 0!==d?d:"",sampler_name:null!==(v=this.message.meta.sampler_name)&&void 0!==v?v:"",vae:null!==(m=this.message.meta.vae)&&void 0!==m?m:"",use_image_conditions:y}}},handleNoteVitorRecord:function(){var e=this,t=Object($.a)({render:function(n){return n(L.default,{props:{params:e.assembleParams(),saveParams:F(F({},e.message),{},{meta:F(F({},e.message.meta),{},{prompt:e.message.local_prompt})}),source:"create_image_records"},on:{close:function(){t.close()},save:function(){t.close()}}})}})},show:function(){this.dialogVisible=!0},handleVolumeChange:function(e){this.videoHasVoice===e.target.muted&&this.$store.commit("app/SET_VIDEO_HAS_VOICE",!this.videoHasVoice)},handleGenerate:function(){this.hide(),this.$emit("copyGenerationData")},handleJumpDetail:function(e){["",null,void 0].includes(null==e?void 0:e.id)||window.open("/models/detail/".concat(null==e?void 0:e.id),"_blank")},handleJumpAppDetail:function(e){if(null!=e&&e.id){var t=this.localePath("".concat("/workFlowAppDetail/").concat(e.id));window.open(t,"_blank")}},init:function(){var e,t=this;if(this.msgId){this.getMetaLoading=!0;var n=this.loraModels&&0===Object.keys(this.loraModels).length,o=["",null,void 0].includes(null===(e=this.message)||void 0===e?void 0:e.art_model_name),l=![this.loraModels&&this.loraModels[this.msgId]];[n,o,l].some((function(e){return e}))?Object(w.getMetaInfo)({id:this.msgId,task_flow_version:"v2"}).then((function(e){var o,l,r;if(1e4===e.status.code){t.intLoraModel=(null===(o=e.data.meta)||void 0===o?void 0:o.lora_models)||[];var c={};c[t.msgId]=t.intLoraModel;var d=(null==e||null===(l=e.data)||void 0===l?void 0:l.art_model_name)||"";if(t.$emit("uploadMate",null==e?void 0:e.data),["",null,void 0].includes(null===(r=t.message)||void 0===r?void 0:r.art_model_name)&&(t.$set(t.message,"art_model_name",d),null!=e&&e.data)){var v={},m=null==e?void 0:e.data;t.specialPrompt=(null==m?void 0:m.local_prompt)||"",v.meta=(null==m?void 0:m.meta)||{},v.art_model=(null==m?void 0:m.art_model)||{},t.$emit("updateModelName",d,null==e?void 0:e.data)}n&&t.$emit("setLoraModel",c)}})).finally((function(){t.getMetaLoading=!1})):this.getMetaLoading=!1,this.intLoraModel&&!this.intLoraModel.length&&(this.intLoraModel=this.loraModels[this.msgId]||[])}},handleConfirm:function(){this.handleChat()},viewImage:function(e){this.$refs.viewImage.show(e,this.$refs.img[0],2)},isVideoUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(t){return(e||"").toLowerCase().endsWith(t)}))},isAudioUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp3",".wav",".m4a",".ogg",".flac",".aac"].some((function(t){return(e||"").toLowerCase().endsWith(t)}))},openLora:function(e){window.open("/models/detail/"+e.art_model.id)},hide:function(){this.dialogVisible=!1,this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var e=this;this._keyDownHandler=function(t){switch(t.stopPropagation(),t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}},this._mouseWheelHandler=Object(h.b)((function(t){var n,o=t.wheelDelta?t.wheelDelta:-t.detail;["el-image-viewer__canvas task-image-viewer__canvas","el-image-viewer__img task-image-viewer__img"].includes(null==t||null===(n=t.target)||void 0===n?void 0:n.className)&&(o>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1}))})),Object(m.e)(document,"keydown",this._keyDownHandler),Object(m.e)(document,U,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(m.d)(document,"keydown",this._keyDownHandler),Object(m.d)(document,U,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(e){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var n=this.transform,o=n.offsetX,l=n.offsetY,r=e.pageX,c=e.pageY;this._dragHandler=Object(h.b)((function(e){t.transform.offsetX=o+e.pageX-r,t.transform.offsetY=l+e.pageY-c})),Object(m.e)(document,"mousemove",this._dragHandler),Object(m.e)(document,"mouseup",(function(e){Object(m.d)(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(B),t=(Object.values(B).indexOf(this.mode)+1)%e.length;this.mode=B[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=F({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),o=n.zoomRate,l=n.rotateDeg,r=n.enableTransition,c=this.transform;switch(e){case"zoomOut":c.scale>.2&&(c.scale=parseFloat((c.scale-o).toFixed(3)));break;case"zoomIn":c.scale=parseFloat((c.scale+o).toFixed(3));break;case"clocelise":c.deg+=l;break;case"anticlocelise":c.deg-=l}c.enableTransition=r}},handleOperateBtnClick:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,m,h,f,_,C,w,I;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:f=(null===(o=t.urlList)||void 0===o||null===(o=o[t.index||0])||void 0===o?void 0:o.url)||"",t.handleLogEvent(null==e?void 0:e.type),n.t0=e.type,n.next="chat"===n.t0?5:"post"===n.t0?11:"imageEditing"===n.t0?13:"download"===n.t0?18:"aiGenerateVideo"===n.t0?20:"videoExtension"===n.t0?29:"save"===n.t0?35:"deleteSingleImg"===n.t0?37:"Share"===n.t0?39:"videoExtendFrame"===n.t0?41:"aiErase"===n.t0?46:"partialRedrawing"===n.t0?48:"expandImage"===n.t0?50:52;break;case 5:return n.next=7,Object(v.S)({channel:"task",source_id:null===(l=t.message)||void 0===l?void 0:l.id});case 7:return _=n.sent,C=_.data.character_id,(void 0===C?"":C)?t.handleChat():t.$refs.aiChatCreateConfirm.show(),n.abrupt("break",54);case 11:return t.handlePost(),n.abrupt("break",54);case 13:if(t.smart_edit_template_id){n.next=15;break}return n.abrupt("return");case 15:return t.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:t.smart_edit_template_id},imgUrlList:[f]}}),t.hide(),n.abrupt("break",54);case 18:return t.isAudioUrl(f)?(I=(null===(w=t.urlList)||void 0===w||null===(w=w[t.index||0])||void 0===w?void 0:w.title)||"",Object(k.L)({url:f,fileName:I})):Object(k.M)(f),n.abrupt("break",54);case 20:if(f){n.next=23;break}return n.abrupt("return");case 23:if(!t.isFromHistory){n.next=26;break}return t.$emit("openEasyVideoRecModal",f),n.abrupt("return");case 26:return t.$EventBus.$emit("openEasyVideoRecModal",f),t.$emit("onlyCloseViewer"),n.abrupt("break",54);case 29:if(f){n.next=31;break}return n.abrupt("return");case 31:return t.$logEvent("log_actions",{operation:"click_video_extension",behavior_info:"on_new_create_flow_page",behavior_info_sub:(null==t||null===(r=t.message)||void 0===r||null===(r=r.art_model)||void 0===r?void 0:r.base_model)||""}),t.$EventBus.$emit("openEasyVideoExtension",{url:(null===(c=t.currentImgInfo)||void 0===c?void 0:c.cover_url)||(null===(d=t.currentImgInfo)||void 0===d?void 0:d.url),info:F(F({},t.message),{},{banner:t.currentImgInfo||{}}),isTask:!0,isImageOperation:!0}),t.$emit("onlyCloseViewer"),n.abrupt("break",54);case 35:return t.$emit("imageOperate",e.type,y()(t.urlList[t.index])),n.abrupt("break",54);case 37:return t.handleDeleteSingleImg(),n.abrupt("break",54);case 39:return t.handleShare(e.type,y()(t.urlList[t.index])),n.abrupt("break",54);case 41:if(f){n.next=43;break}return n.abrupt("return");case 43:return t.$EventBus.$emit("openEasyVideoFrameInterpolation",{url:(null===(m=t.currentImgInfo)||void 0===m?void 0:m.cover_url)||(null===(h=t.currentImgInfo)||void 0===h?void 0:h.url),info:F(F({},t.message),{},{banner:t.currentImgInfo||{}}),isTask:!0,isImageOperation:!0}),t.$emit("onlyCloseViewer"),n.abrupt("break",54);case 46:return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:f,type:"aiErase",appId:e.creativityTemplateId,callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),t.$emit("onlyCloseViewer")}}}),n.abrupt("break",54);case 48:return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:f,type:"partialRedrawing",appId:e.creativityTemplateId,callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),t.$emit("onlyCloseViewer")}}}),n.abrupt("break",54);case 50:return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:f,type:"expandImage",appId:e.creativityTemplateId,callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),t.$emit("onlyCloseViewer")}}}),n.abrupt("break",54);case 52:return t.$emit("imageOperate",e.type,y()(t.urlList[t.index]),e),n.abrupt("break",54);case 54:t.$emit("onClickBtns",e);case 55:case"end":return n.stop()}}),n)})))()},handleShare:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var o,l,path,image;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.$logEvent("log_actions",{operation:"click",behavior_info:"on_create_flow_work_detail_page",behavior_info_sub:null===(o=n.message)||void 0===o?void 0:o.id,entity_type:"button",entity_name:"share",page_name:"createflow_task_detail_page_modal"}),n.workId=n.message.id,e.next=4,Object(O.easyBatchSaveParams)({items:[{folder_no:"default",id:n.message.id,index:t.index}],scene:"task_item_share"});case 4:1e4===(l=e.sent).status.code&&(n.$emit("saveSuccess"),l.data.items[0].artwork_no?(path="".concat(window.location.origin,"/explore/detail/").concat(l.data.items[0].artwork_no)+(n.inviteCode?"?u_code=".concat(n.inviteCode):""),image=(null==t?void 0:t.url)||t.cover_url||"",n.$refs.shareDialog.show(path,image,"share","create-flow")):n.$message.error(n.$t(l.data.items[0].result_desc)));case 6:case"end":return e.stop()}}),e)})))()},handleLogEvent:function(e){var t,n="";switch(e){case"imageEditing":n="click_smart_image_modification";break;case"download":n="click_download";break;case"chat":n="click_chat";break;case"upscale":n="click_creative_superscore";break;case"variations":n="click_variant";break;case"save":n="click_save";break;case"post":n="click_post";break;case"deleteSingleImg":n="click_delete"}n&&this.$logEvent("log_actions",{operation:n,behavior_info:"on_create_flow_work_detail_page",behavior_info_sub:null===(t=this.message)||void 0===t?void 0:t.id})},getImageUrl:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},handleChat:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,m,h,f,_,y,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h={height:null===(n=e.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height,width:null===(o=e.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.width,id:null===(l=e.message)||void 0===l?void 0:l.id,url:e.currentImg||(null===(r=e.message)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url),source_account_id:(null===(c=e.message)||void 0===c||null===(c=c.messageInfo)||void 0===c||null===(c=c.author)||void 0===c?void 0:c.id)||(null===(d=e.userInfo)||void 0===d?void 0:d.id),channel:"task"},t.next=3,Object(v.S)({channel:"task",source_id:h.id});case 3:if(f=t.sent,_=(null==f?void 0:f.data)||{},y=_.can,2!==(void 0===y?2:y)){t.next=8;break}return e.$message.warning(e.$t("chatFail")),t.abrupt("return");case 8:if(!e.isShowSaveTo||1===e.nsfw){t.next=12;break}return t.next=11,e.handleSave(h);case 11:return t.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(h)),C="/cyberPubPage/".concat(null===(m=e.message)||void 0===m?void 0:m.id,"?quickChat=true&source=work"),window.open(e.localePath(C),"_blank");case 15:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,v,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:null,l=t.message,r=l.id,c=void 0===r?"":r,v=l.img_uris,m=(void 0===v?[]:v)[t.operateNumber-1].index,h=void 0===m?"":m,Object(d.a)({folder_no:"default",id:c,index:h}).then((function(){if(t.$emit("saveSuccess"),o){var e;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(e=t.message)||void 0===e?void 0:e.id,"?quickChat=true&source=work");window.open(t.localePath(n),"_blank")}})).catch((function(e){console.log("saveFail",e)}));case 4:case"end":return n.stop()}}),n)})))()},handlePost:function(){var e,t={taskId:this.message.id,url:this.currentImg,index:this.currentImgInfo.index};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_details",behavior_info_sub:t.url});var n={16:["faceswap"],17:["ai voice"],20:["ai voice","ai video"]},o=(null==n?void 0:n[null===(e=this.message)||void 0===e?void 0:e.task_domain_type])||[],l={types:[M.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[t],remoteParams:{tags:o}};this.$EventBus.$emit("openContribution",l),this.hide()},handleAnimate:function(){this.$emit("handleAnimate"),this.hide()},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(content)||(Object(k.g)(content),this.$message.success(this.$t("CopySuccess")))},handleDownloadClick:function(){var e=this;this.$nextTick((function(){var t,n=e.$refs.downloadVideoPop;n&&(null==n||null===(t=n.$el)||void 0===t||t.click())}))},formatDuration:function(e){return Object(k.U)(e)}},mounted:function(){this.show(),this.init(),this.isI18nToggled=!this.accountSettingsData.is_off_localization,this.deviceSupportInstall()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},z=G,W=(n(4363),n(4364),n(4365),n(4366),n(0)),component=Object(W.a)(z,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R=this,F=R._self._c;return F("el-dialog",{staticClass:"c-easy-task-image-viewer-dialog",attrs:{visible:R.dialogVisible,"append-to-body":!0,"close-on-click-modal":!1,"show-close":!1,modal:!0,fullscreen:!0},on:{"update:visible":function(e){R.dialogVisible=e},close:R.hide}},[F("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper c-easy-task-image-viewer",style:{"z-index":R.viewerZIndex},attrs:{tabindex:"-1"}},[F("div",{staticClass:"el-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:R.handleMaskClick.apply(null,arguments)}}}),R._v(" "),R.showOperateBtn?R._e():F("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:R.hide}},[F("i",{staticClass:"el-icon-close"})]),R._v(" "),R.showOperateBtn?R._e():F("span",{staticClass:"el-image-viewer__btn el-image-viewer__download",on:{click:function(e){return R.handleOperateBtnClick({type:"download"})}}},[F("i",{staticClass:"iconfont icon-icon-Download"})]),R._v(" "),R.showOperateBtn?R._e():F("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[F("div",{staticClass:"el-image-viewer__actions__inner"},[F("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return R.handleActions("zoomOut")}}}),R._v(" "),F("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return R.handleActions("zoomIn")}}}),R._v(" "),F("i",{staticClass:"el-image-viewer__actions__divider"}),R._v(" "),F("i",{class:R.mode.icon,on:{click:R.toggleMode}}),R._v(" "),F("i",{staticClass:"el-image-viewer__actions__divider"}),R._v(" "),F("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return R.handleActions("anticlocelise")}}}),R._v(" "),F("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return R.handleActions("clocelise")}}})])]),R._v(" "),F("div",{staticClass:"el-image-viewer__canvas task-image-viewer__canvas"},[R.isSingle||R.isAudioUrl(R.currentImg)?R._e():[F("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!R.infinite&&R.isFirst},on:{click:R.prev}},[F("i",{staticClass:"el-icon-arrow-left"})]),R._v(" "),F("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!R.infinite&&R.isLast},on:{click:R.next}},[F("i",{staticClass:"el-icon-arrow-right"})])],R._v(" "),R._l(R.urlList,(function(e,i){return[i===R.index&&R.isAudioUrl(R.currentImg)?F("LyricAudio",{attrs:{audio:R.currentImgInfo,message:R.message},on:{prev:R.prev,next:R.next}}):i!==R.index||R.isVideoUrl(R.currentImg)?i===R.index?F("video",{key:i,staticClass:"el-image-viewer__img task-image-viewer__img",style:R.imgStyle,attrs:{src:R.currentImg,autoplay:"",loop:"",controls:"",controlsList:"nodownload"},domProps:{muted:!R.videoHasVoice},on:{volumechange:R.handleVolumeChange,play:R.handleImgLoad}}):R._e():F("img",{directives:[{name:"webp",rawName:"v-webp",value:R.$imgH,expression:"$imgH"}],key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img task-image-viewer__img",style:R.imgStyle,attrs:{src:R.currentImg,referrerpolicy:"no-referrer"},on:{load:R.handleImgLoad,mousedown:R.handleMouseDown,click:function(e){return R.viewImage(R.currentImg)}}})]})),R._v(" "),R.isSingle||R.isAudioUrl(R.currentImg)?R._e():[F("div",{staticClass:"indicator-box"},R._l(R.urlList,(function(e,i){return F("span",{key:"indicator_".concat(i),staticClass:"indicator-box-item",class:[R.index===i&&"indicator-box-item-active"]})})),0)]],2),R._v(" "),R.showOperateBtn?F("div",{staticClass:"task-image-viewer__side-bar"},[F("div",{staticClass:"task-image-viewer__side-bar—header"},[F("div",{staticClass:"flex"},[null!==(e=R.getActionButtons)&&void 0!==e&&e.length?F("image-action-buttons",{attrs:{visible:!0,buttons:R.getActionButtons,iconStyle:"task-image-viewer__side-bar_iconStyle_czl",iconFontsize:"task-image-viewer__side-bar_iconFontsize_czl",gap:4,maxVisibleButtons:3},on:{"button-click":R.handleOperateBtnClick}}):R._e(),R._v(" "),R.urlList[R.index].operation_labels.includes("supportMetaNote")?F("div",{staticClass:"task-image-viewer__side-bar_note-vitor-record",on:{click:R.handleNoteVitorRecord}},[F("i",{staticClass:"iconfont icon-BIJI"}),R._v(" "),F("span",[R._v(R._s(R.$t("NoteVitorRecord")))])]):R._e()],1),R._v(" "),F("span",{on:{click:R.hide}},[F("i",{staticClass:"el-icon-close el-image-viewer-close"})])]),R._v(" "),F("div",{staticClass:"task-image-viewer__side-booderbtm"}),R._v(" "),F("div",{staticClass:"task-image-viewer__side-bar-box"},[null!==(t=R.editButtons)&&void 0!==t&&t.length?F("div",{staticClass:"edit-group mrgin-bt8"},[F("div",{staticClass:"group-title"},[R._v(R._s(R.$t("Edit")))]),R._v(" "),F("div",{staticClass:"button-row"},R._l(R.editButtons,(function(e){return F("el-tooltip",{key:e.code,attrs:{content:R.$t(e.tips),disabled:!e.tips,placement:"bottom",effect:"light","popper-class":"task-image-viewer-popover"}},[F("div",{staticClass:"button",attrs:{"data-group":"create-task-image-viewer","data-type":"detail-edit-button","data-id":e.code,"data-desc":"创作流图片详情编辑组按钮"},on:{click:function(t){return t.stopPropagation(),R.handleOperateBtnClick(e)}}},[F("span",{staticClass:"icon"},[F("i",{class:e.icon})]),R._v(" "),F("span",{staticClass:"label"},[R._v(R._s(R.$t(e.label)))])])])})),1)]):R._e(),R._v(" "),null!==(n=R.moreButtons)&&void 0!==n&&n.length?F("div",{staticClass:"more-group"},[F("div",{staticClass:"group-title"},[R._v(R._s(R.$t("more")))]),R._v(" "),F("div",{staticClass:"button-row"},R._l(R.moreButtons,(function(e){return F("el-tooltip",{key:e.code,attrs:{content:R.$t(e.tips),disabled:!e.tips,placement:"bottom","popper-class":"task-image-viewer-popover",effect:"light"}},[F("div",{staticClass:"button",attrs:{"data-group":"create-task-image-viewer","data-type":"detail-more-button","data-id":e.code,"data-desc":"创作流图片详情更多组按钮"},on:{click:function(t){return t.stopPropagation(),R.handleOperateBtnClick(e)}}},[F("span",{staticClass:"icon"},[F("i",{class:e.icon})]),R._v(" "),F("span",{staticClass:"label"},[R._v(R._s(R.$t(e.label)))])])])})),1)]):R._e(),R._v(" "),R.customForm?R._e():F("div",{staticClass:"task-image-viewer__prompt-box",class:[R.currentImgInfo&&[0,"0"].includes(R.currentImgInfo.operateNumber)?"task-image-viewer__prompt-box-margin-top":""]},[[21].includes(null===(o=R.message)||void 0===o?void 0:o.task_domain_type)?R._e():[F("div",{staticClass:"task-image-viewer__prompt-title"},[F("span",{staticClass:"prompt-title-text"},[R._v(R._s(R.$t("Prompt")))]),R._v(" "),F("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(e){return e.stopPropagation(),R.handleCopyAll(R.setI18nPrompt)}}})]),R._v(" "),F("OneLineEllipsisWithExpand",{attrs:{text:R.removeCameraMarkers(R.setI18nPrompt)}})],R._v(" "),null!==(l=R.message)&&void 0!==l&&null!==(l=l.meta)&&void 0!==l&&l.negative_prompt?[F("div",{staticClass:"task-image-viewer__prompt-title"},[F("span",{staticClass:"prompt-title-text"},[R._v(R._s(R.$t("NegativePrompts")))]),R._v(" "),F("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(e){var t;return e.stopPropagation(),R.handleCopyAll(null===(t=R.message)||void 0===t||null===(t=t.meta)||void 0===t?void 0:t.negative_prompt)}}})]),R._v(" "),F("text-overflow-area",{staticClass:"prompt-text-overflow"},[R._v(R._s((null===(r=R.message)||void 0===r||null===(r=r.meta)||void 0===r?void 0:r.negative_prompt)||""))])]:R._e(),R._v(" "),null!==(c=R.message)&&void 0!==c&&null!==(c=c.meta)&&void 0!==c&&null!==(c=c.generate_audio)&&void 0!==c&&c.origin_lyrics?[F("div",{staticClass:"task-image-viewer__prompt-title"},[F("span",{staticClass:"prompt-title-text"},[R._v(R._s(R.$t("song_lyric")))]),R._v(" "),F("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(e){var t;return e.stopPropagation(),R.handleCopyAll(null===(t=R.message)||void 0===t||null===(t=t.meta)||void 0===t||null===(t=t.generate_audio)||void 0===t?void 0:t.origin_lyrics)}}})]),R._v(" "),F("text-overflow-area",{staticClass:"prompt-text-overflow"},[F("div",{staticClass:"pre-wrap"},[R._v(R._s((null===(d=R.message)||void 0===d||null===(d=d.meta)||void 0===d||null===(d=d.generate_audio)||void 0===d?void 0:d.origin_lyrics)||""))])])]:R._e(),R._v(" "),[21].includes(null===(v=R.message)||void 0===v?void 0:v.task_domain_type)?[F("div",{staticClass:"task-image-viewer__prompt-title"},[F("span",{staticClass:"prompt-title-text"},[R._v(R._s(R.$t("songstyle")))]),R._v(" "),F("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(e){return e.stopPropagation(),R.handleCopyAll(R.specialPrompt)}}})]),R._v(" "),F("text-overflow-area",{staticClass:"prompt-text-overflow"},[R._v(R._s(R.specialPrompt||""))])]:R._e(),R._v(" "),F("div",{staticClass:"easy-tooltip-wraper-params-box"},[F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("newGenerate27")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(R.$t(R.convertTaskType)))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("newGenerate26")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(R._f("formatDateTime")(R.message.create_at)))])]),R._v(" "),[17,20,21,23].includes(null===(m=R.message)||void 0===m?void 0:m.task_domain_type)?R._e():F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("imageDimensions")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v("\n                "+R._s("".concat(null===(h=R.message)||void 0===h||null===(h=h.components[0])||void 0===h?void 0:h.width," x ").concat(null===(f=R.message)||void 0===f||null===(f=f.components[0])||void 0===f?void 0:f.height))+" px\n              ")])]),R._v(" "),[11,12,13,14,15].includes(null===(_=R.message)||void 0===_?void 0:_.task_domain_type)?F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("Duration")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s((null===(y=R.message)||void 0===y||null===(y=y.components[R.index])||void 0===y?void 0:y.duration)||0)+"s")])]):R._e(),R._v(" "),[21,23].includes(null===(C=R.message)||void 0===C?void 0:C.task_domain_type)?F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("Duration")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v("\n                "+R._s(R.formatDuration((null===(w=R.message)||void 0===w||null===(w=w.components[R.index])||void 0===w?void 0:w.duration)||0))+"\n              ")])]):R._e(),R._v(" "),[11,12,13,14,15,17,20,21,23].includes(null===(k=R.message)||void 0===k?void 0:k.task_domain_type)?R._e():[F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("Seed")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(null===(I=R.message)||void 0===I||null===(I=I.meta)||void 0===I?void 0:I.seed))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("Sampler")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(null===(x=R.message)||void 0===x||null===(x=x.meta)||void 0===x?void 0:x.sampler_name))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("Steps")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(null===(T=R.message)||void 0===T||null===(T=T.meta)||void 0===T?void 0:T.steps))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("CFGScale")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s(null===(S=R.message.meta)||void 0===S?void 0:S.cfg_scale))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item"},[F("div",{staticClass:"easy-tooltip-params-item-title"},[R._v(R._s(R.$t("clipSkip")))]),R._v(" "),F("div",{staticClass:"easy-tooltip-params-item-content"},[R._v(R._s((null===(O=R.message)||void 0===O||null===(O=O.meta)||void 0===O?void 0:O.clip_skip)||""))])])]],2)],2),R._v(" "),R.customForm||[15].includes(null===(P=R.message)||void 0===P?void 0:P.task_domain_type)?R._e():[null!==(M=R.getModelList)&&void 0!==M&&M.length?F("div",{directives:[{name:"show",rawName:"v-show",value:!R.loading,expression:"!loading"}],staticClass:"easy-tooltip-wraper-model-box"},R._l(R.getModelList,(function(e,t){var n,o,l;return F("div",{key:"model_i_".concat(t),staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(t){return t.stopPropagation(),R.handleJumpDetail(e)}}},[F("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[R.isVideoUrl(null==e||null===(n=e.banner)||void 0===n?void 0:n.url)?F("video",{attrs:{src:null==e||null===(o=e.banner)||void 0===o?void 0:o.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):F("img",{attrs:{src:null==e||null===(l=e.banner)||void 0===l?void 0:l.url,alt:""}})]),R._v(" "),F("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[F("div",{staticClass:"easy-tooltip-model-box-model-name-row"},[F("span",{staticClass:"easy-tooltip-model-box-model-type"},[R._v(R._s(R.$t(null==e?void 0:e.type)))]),R._v(" "),F("span",{staticClass:"easy-tooltip-model-box-model-name"},[R._v(R._s((null==e?void 0:e.name)||""))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-model-box-model-version-row"},["Checkpoint"!==(null==e?void 0:e.type)?F("span",{staticClass:"easy-tooltip-model-box-model-strength"},[R._v("\n                    "+R._s(R.$t("Strength"))+" : "+R._s((null==e?void 0:e.weight)||"")+"\n                  ")]):R._e(),R._v(" "),F("span",{staticClass:"easy-tooltip-model-box-model-version"},[R._v(R._s((null==e?void 0:e.version_name)||""))])])])])})),0):R._e()],R._v(" "),!R.customForm&&[15].includes(null===(L=R.message)||void 0===L?void 0:L.task_domain_type)&&null!==($=R.getEffectInfo)&&void 0!==$&&$.id?[null!==(D=R.getModelList)&&void 0!==D&&D.length?F("div",{directives:[{name:"show",rawName:"v-show",value:!R.loading,expression:"!loading"}],staticClass:"easy-tooltip-wraper-model-box"},[F("div",{staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(e){return e.stopPropagation(),R.handleJumpAppDetail(R.getEffectInfo)}}},[F("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[R.isVideoUrl(null===(j=R.getEffectInfo)||void 0===j||null===(j=j.cover)||void 0===j?void 0:j.url)?F("video",{attrs:{src:null===(E=R.getEffectInfo)||void 0===E||null===(E=E.cover)||void 0===E?void 0:E.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):F("img",{attrs:{src:null===(A=R.getEffectInfo)||void 0===A||null===(A=A.cover)||void 0===A?void 0:A.url,alt:""}})]),R._v(" "),F("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[F("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[F("span",{staticClass:"easy-tooltip-model-box-model-type"},[R._v(R._s(R.$t("VideoEffect")))])]),R._v(" "),F("div",{staticClass:"easy-tooltip-model-box-model-name"},[R._v(R._s((null===(N=R.getEffectInfo)||void 0===N?void 0:N.name)||""))]),R._v(" "),F("div",{staticClass:"easy-tooltip-model-box-model-version"},[R._v(R._s((null===(V=R.getEffectInfo)||void 0===V?void 0:V.desc)||""))])])])]):R._e()]:R._e(),R._v(" "),R.customForm?[R._t("customContent")]:R._e()],2),R._v(" "),R.customForm?R._e():F("div",{staticClass:"bottom-generate-btn-box"},[F("div",{staticClass:"copyClass",on:{click:R.handleGenerate}},[R._v("\n          "+R._s(R.$t("Generate"))+"\n        ")])])]):R._e(),R._v(" "),F("view-image",{ref:"viewImage"}),R._v(" "),F("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task",fromPage:"newTask"},on:{confirm:R.handleConfirm}}),R._v(" "),F("ShareDialog",{ref:"shareDialog",attrs:{type:"artwork",workId:R.workId}}),R._v(" "),F("common-confirm-modal",{ref:"commonConfirmModal"})],1)])}),[],!1,null,"103b2c5a",null);t.default=component.exports;installComponents(component,{ShareDialog:n(144).default})},301:function(e,t,n){"use strict";n.r(t);n(18),n(16),n(22),n(4);var o=n(46),l={name:"SelectVideoModelModal",props:{fromPage:{type:String,default:""},changeBtnColor:{type:Boolean,default:!1}},data:function(){return{visible:!1,list:[],loading:!1,selectItem:null,url:""}},computed:{nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},getSelectClass:function(){return function(e){var t;return(null===(t=this.selectItem)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)?this.changeBtnColor?"select-control-net-item-active-blue":"select-control-net-item-active":""}}},methods:{show:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.resetData(),this.url=t||"",this.visible=!0,null!==(e=this.list)&&void 0!==e&&e.length?this.selectItem=this.list[0]:this.getList()},resetData:function(){this.selectItem=null,this.url=""},getList:function(){var e=this,t={};this.loading=!0,t.scene="task_item_video_model_rec",Object(o.easyGetPresetModel)(t).then((function(t){var n=t||{},o=n.status.code,code=void 0===o?"":o,l=n.data,data=void 0===l?{}:l;if([1e4,"10000"].includes(code)){var r=Array.isArray(null==data?void 0:data.items)?data.items:[],c={};e.list=(r||[]).map((function(e){return e.art_model||{}})).reduce((function(e,t){return c[t.id]||(c[t.id]=!0,e.push(t)),e}),[]).map((function(t){var n=(t.banner||{}).nsfw;return[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign((null==t?void 0:t.banner)||{},{url:e.nsfwUrl})),t})),e.list.length>0&&(e.selectItem=e.list[0])}})).finally((function(){e.loading=!1}))},handleClose:function(){this.visible=!1},handleConfirm:function(){var e=this.selectItem;this.$emit("confirm",e,this.url),this.handleClose()},handleClick:function(e){this.selectItem=e}}},r=l,c=(n(3908),n(0)),component=Object(c.a)(r,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"select-video-model-modal custom-dialog",title:e.$t("ControlNet"),"destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"append-to-body":"","modal-append-to-body":"",width:"1058px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"modal-header"},[t("div",{staticClass:"modal-header-title"},[e._v(e._s(e.$t("RecommendedModels")))]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"select-control-net--modal-content"},e._l(e.list,(function(n,i){var o;return t("div",{key:"model_"+i,staticClass:"image-card-item-content",class:[e.getSelectClass(n)],on:{click:function(t){return e.handleClick(n)}}},[t("div",{staticClass:"image-card-item-content-img"},[t("img",{attrs:{src:null==n||null===(o=n.banner)||void 0===o?void 0:o.url,alt:""}})]),e._v(" "),t("div",{staticClass:"image-card-item-content-text"},[t("div",{staticClass:"image-card-item-content-title"},[e._v(e._s((null==n?void 0:n.name)||""))]),e._v(" "),t("div",{staticClass:"image-card-item-content-subtitle"},[e._v("\n          "+e._s((null==n?void 0:n.desc)||"")+"\n        ")])])])})),0),e._v(" "),t("div",{staticClass:"select-control-net--modal-footer"},[t("span",{staticClass:"modal-footer-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),e.changeBtnColor?t("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm color-change-btn",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e._v(e._s(e.$t("Confirm")))]):t("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports},3066:function(e,t,n){e.exports={}},3073:function(e,t,n){e.exports={}},3078:function(e,t,n){e.exports={}},3079:function(e,t,n){e.exports={}},3080:function(e,t,n){e.exports={}},3081:function(e,t,n){e.exports={}},3265:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(8),n(4),n(177),n(1165)),r=n(1166),c=n(1167),d=n(1168),v=n(161),m=n(869),h=n(271),f=n(3285),_=n(33),y=n(25),C={name:"ParamsPanel",components:{EasyModelPanel:l.default,EasyAdditionalPanel:r.default,EasyGenerateModePanel:c.default,EasyAdvanceSettingPanel:d.default,MultiImageGenerate:f.default},props:["value","menuIndex"],inject:["easyTop"],data:function(){return{videoTabs:[{id:"videoModel",label:"newGenerate137"},{id:"effect",label:"Effect"},{id:"multiImage",label:"multi_image"}],selectActiveId:""}},mounted:function(){},computed:{showAdvancePanel:function(){var e,t,n,o,l="effect"!==(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab);if(null!==(t=this.easyTop)&&void 0!==t&&t.isVideoModel)return(null===(o=this.easyTop)||void 0===o||null===(o=o.currentVideoModelConfig)||void 0===o?void 0:o.high_quality_setting)&&l;if(null!==(n=this.easyTop)&&void 0!==n&&n.isEnableModelQuickConfig){var r,c=(null===(r=this.easyTop)||void 0===r||null===(r=r.currentImageModelConfig)||void 0===r?void 0:r.advanced_settings)||{};return Object.keys(c).length>0&&Object.values(c).some((function(e){return!0===e}))&&l}return l},showAdditionalPanel:function(){var e,t,n,o,l,r,c,d="effect"!==(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.currentVideoTab);if(null!==(t=this.easyTop)&&void 0!==t&&t.isVideoModel)return(null===(r=this.easyTop)||void 0===r||null===(r=r.currentVideoModelConfig)||void 0===r?void 0:r.enable_lora_ctl)&&d;if(null!==(n=this.easyTop)&&void 0!==n&&n.isEnableModelQuickConfig)return Object(h.getSceneConfig)("additional_panel",(null===(c=this.easyTop)||void 0===c?void 0:c.currentImageModelConfig)||{});var v=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&o.isHiDreamModel),m=!(null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isSeaArtFilmModel);return d&&v&&m},showModelPanel:function(){var e,t=!0;return"generateVideo"===this.menuIndex&&"effect"===(null===(e=this.value)||void 0===e?void 0:e.currentVideoTab)&&(t=!1),t},currentTab:function(){var e;return null===(e=this.easyTop)||void 0===e?void 0:e.currentTab},currentParams:function(){var e;return(null===(e=this.easyTop)||void 0===e?void 0:e.config.generateImage)||null}},methods:{changeVideoTab:function(e){var t,n,o,l,r,c;if(null===(t=this.easyTop)||void 0===t||t.closeInspirationWin(!0),this.$logEvent("log_actions",{operation:"effect"===e?"click_video_effect":"click_video_model",behavior_info:"on_video_generate_params_page",behavior_info_sub:"click_video_generate"}),"effect"===e&&(null===(n=this.value)||void 0===n||null===(n=n.specialEffectsImageList)||void 0===n||null===(n=n[0])||void 0===n||!n.url)&&null!==(o=this.value)&&void 0!==o&&null!==(o=o.imageToVideoList)&&void 0!==o&&o.length){var d,v,m=(null===(d=this.value)||void 0===d||null===(d=d.imageToVideoList)||void 0===d?void 0:d[0])||{},h=(null==m?void 0:m.url)||(null==m?void 0:m.firstFrame)||(null==m?void 0:m.lastFrame)||"";null==this||null===(v=this.easyTop)||void 0===v||v.updateEffectImage({url:h},0)}if("videoModel"===e&&null!==(l=this.value)&&void 0!==l&&null!==(l=l.specialEffectsImageList)&&void 0!==l&&null!==(l=l[0])&&void 0!==l&&l.url&&(null===(r=this.value)||void 0===r||null===(r=r.imageToVideoList)||void 0===r||!r.length)){var f,C,w,k=null===(f=this.value)||void 0===f||null===(f=f.specialEffectsImageList)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.url,I=(null===(C=this.value)||void 0===C?void 0:C.currentVideoInputToolTab)===_.VIDEO_CREATION_MODE.IMG_TO_LIVE2D?"imageToLive2D":"imageToVideo";null==this||null===(w=this.easyTop)||void 0===w||w.addImageToVideo({url:k},I)}if("multiImage"===e){var x,T,S={currentVideoInputToolTab:_.VIDEO_CREATION_MODE.MULTI_IMG_TO_VIDEO,currentVideoTab:e};return null!==(x=this.value)&&void 0!==x&&x.multiImg2videoInfo||(S.multiImg2videoInfo=Object(y.cloneDeep)(_.MULTI_IMG_TO_VIDEO_DEFAULT_PARAMS)),void(null==this||null===(T=this.easyTop)||void 0===T||T.updateConfig(S,this.menuIndex))}null==this||null===(c=this.easyTop)||void 0===c||c.updateConfig({currentVideoTab:e,currentVideoInputToolTab:_.VIDEO_CREATION_MODE.IMG_TO_VIDEO},this.menuIndex)},handleComponentClick:function(){this.$EventBus.$emit("needCheckInputPackUp","paramsPanel")},handleResetParams:function(){var e;this.$logEvent("log_actions",{operation:"click_reset_params",behavior_info:"on_new_create_flow_page"}),null==this||null===(e=this.easyTop)||void 0===e||e.resetConfig(!1,!0,this.menuIndex);try{this.$refs.generateModePanel.resetData(),this.$EventBus.$emit("resetInputPackUpStatus")}catch(e){}},handleNoteVitor:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,source,d,h,f,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=e.source,source=void 0===c?"create_notes":c,t.easyTop.isLoggedIn){n.next=4;break}return t.$EventBus.$emit("openLoginDialog",{dot:!1}),n.abrupt("return");case 4:return n.next=6,null===(o=t.easyTop)||void 0===o?void 0:o.getParams();case 6:d=n.sent,h=null===(l=t.easyTop)||void 0===l?void 0:l.getGenerateType(),f=null===(r=t.easyTop)||void 0===r?void 0:r.getParamsByType(d,h);try{f.meta.generate=t.easyTop.config[t.currentTab].generate}catch(e){}_=Object(v.a)({render:function(e){return e(m.default,{props:{currentParams:t.currentParams,saveParams:f,selectActiveId:t.selectActiveId,source:source},on:{close:function(){_.close()},fill:function(e,n){var o;t.selectActiveId=n,null===(o=t.easyTop)||void 0===o||o.getConfig({data:e.requestParams,action:1,NoteFill:e.NoteFill}),_.close()}}})}});case 11:case"end":return n.stop()}}),n)})))()}}},w=(n(4298),n(0)),component=Object(w.a)(C,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"c-params-panel",on:{click:n.handleComponentClick}},[o("div",{staticClass:"params-panel-main"},["generateVideo"===n.menuIndex?[o("div",{staticClass:"video-top-tab"},n._l(n.videoTabs,(function(e){var t;return o("div",{key:e.id,staticClass:"video-top-tab-item",class:[(null===(t=n.value)||void 0===t?void 0:t.currentVideoTab)===e.id&&"active-btn"],attrs:{"data-id":e.id},on:{click:function(t){return t.stopPropagation(),n.changeVideoTab(e.id)}}},[o("div",{staticClass:"text-ellipsis"},[n._v(n._s(n.$t(e.label)))])])})),0)]:n._e(),n._v(" "),"multiImage"===(null===(e=n.value)||void 0===e?void 0:e.currentVideoTab)?o("MultiImageGenerate",{attrs:{value:n.value,"menu-index":n.menuIndex}}):[o("easy-model-panel",n._g(n._b({directives:[{name:"show",rawName:"v-show",value:n.showModelPanel,expression:"showModelPanel"}],attrs:{value:n.value,"menu-index":n.menuIndex}},"easy-model-panel",n.$attrs,!1),n.$listeners)),n._v(" "),o("easy-additional-panel",{directives:[{name:"show",rawName:"v-show",value:n.showAdditionalPanel,expression:"showAdditionalPanel"}],attrs:{value:n.value,"menu-index":n.menuIndex}}),n._v(" "),o("easy-generate-mode-panel",{ref:"generateModePanel",attrs:{value:n.value,"menu-index":n.menuIndex}}),n._v(" "),o("easy-advance-setting-panel",{directives:[{name:"show",rawName:"v-show",value:n.showAdvancePanel,expression:"showAdvancePanel"}],attrs:{value:n.value,"menu-index":n.menuIndex}})]],2),n._v(" "),"multiImage"!==(null===(t=n.value)||void 0===t?void 0:t.currentVideoTab)?o("div",{staticClass:"reset-params-box"},[o("div",{staticClass:"reset-params-btn",attrs:{"data-event":"generate_click_reset_params"},on:{click:function(e){return e.stopPropagation(),n.handleResetParams.apply(null,arguments)}}},[o("span",{staticClass:"reset-params-btn-icon el-icon-refresh-left"}),n._v(" "),o("span",{staticClass:"reset-params-btn-text"},[n._v(n._s(n.$t("S_ResetPrompt")))])]),n._v(" "),"generateImage"===n.currentTab?o("div",{staticClass:"reset-params-btn",attrs:{"data-event":"generate_click_note_vitor"},on:{click:function(e){return e.stopPropagation(),n.handleNoteVitor.apply(null,arguments)}}},[o("span",{staticClass:"reset-params-btn-icon icon-NotebookPen iconfont"}),n._v(" "),o("span",{staticClass:"reset-params-btn-text"},[n._v(n._s(n.$t("NoteVitor")))])]):n._e()]):n._e()])}),[],!1,null,"68890acc",null);t.default=component.exports;installComponents(component,{EasyModelPanel:n(1165).default,EasyAdditionalPanel:n(1166).default,EasyGenerateModePanel:n(1167).default,EasyAdvanceSettingPanel:n(1168).default})},3266:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(21);var o=n(14),l=n(2),r=n(3),c=n(68),d=(n(20),n(11),n(19),n(6),n(32),n(73),n(22),n(31),n(49),n(12),n(13),n(24),n(8),n(4),n(28),n(44),n(4234),n(7),n(595)),v=n(467),m=n(857),h=n(468),f=n(859),_=n(860),y=n(861),C=n(862),w=n(1),k=n(9),I=n(56),x=n(36),T=n(82),S=n(10),O=n(25),P=n(99),M=n(145);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=[{name:"styleModal1",id:"recommend",value:1,icon:"homeIcon1"},{name:"Follow",id:"follows",value:2,icon:"homeIcon2"},{name:"Hot",id:"hot",value:3,icon:"hot"},{name:"New",id:"new",value:4,icon:"new1"}],j={name:"SquareList",mixins:[M.a],components:{ModelItem:C.default,FastAppItem:y.default,NoData:_.default,CombinedSelectionLenovoSearch:f.default,GenderSelect:h.default,CharacterFilter:m.default,PreferenceSelect:v.default,HyHomeForms:d.default},inject:["CombinedSelectionDialog"],provide:function(){return{homePageApp:this}},props:{value:{type:String,default:""},sourceChannel:{type:Number,default:1},baseModels:{type:Array,default:function(){return k.b}},marginTop:{type:[String,Number],default:0},gridNum:{type:Number,default:6},activeTab:{type:String,default:""},activeTabInfo:{type:Object,default:function(){}},baseModelType:{type:String,default:""},isAdditionalModel:{type:Boolean,default:!1},isImageTrainModel:{type:Boolean,default:!1},subSource:{type:String,default:""},source:{type:String,default:""}},watch:{baseModelType:{handler:function(e,t){this.isAdditionalModel&&e!==t&&(this.baseModelSelect=[],this.onFilterReset())}},"CombinedSelectionDialog.curCategoryId":{handler:function(e,t){e!==t&&(this.activeTagIndex=0)}},"CombinedSelectionDialog.realTab":{handler:function(e){"object"===Object(c.a)(e)?(this.relatedSearchWords=null==e?void 0:e.map((function(e){return{word:e.name,id:e.id}})),this.relatedSearchWords.unshift({word:this.$t("All"),id:e.map((function(e){return e.id}))})):this.relatedSearchWords=[]}},value:{handler:function(e){e?this.CombinedSelectionDialog.isClearCurTagFromSearch&&(this.CombinedSelectionDialog.isClearCurTagFromSearch=!1,this.activeTagIndex=null):(this.CombinedSelectionDialog.isClearCurTagFromSearch&&(this.CombinedSelectionDialog.isClearCurTagFromSearch=!1),this.relatedSearchWords=[],this.activeTagIndex=null,this.typeOption=[].concat(D),this.baseModelSelect=[],this.onFilterReset())}},activeTab:{handler:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(e===t){o.next=8;break}return n.squareList=[],o.next=4,n.initFilter(n.activeTab);case 4:return n.queryParam.keyword="",n.queryParam.tag_ids="",o.next=8,n.intList();case 8:case"end":return o.stop()}}),o)})))()},immediate:!0},userInfo:{handler:function(e){var t,n;this.queryParam.genders=null!=e&&null!==(t=e.character_setting)&&void 0!==t&&t.gender?[null==e||null===(n=e.character_setting)||void 0===n?void 0:n.gender]:[];var o=e.settings,l=(void 0===o?{}:o).use_model_preset_meta_mode,r=void 0===l?1:l;this.enableUsePresetConfig=1===r},deep:!0,immediate:!0}},computed:$($($($({homeData:function(){return this.activeTabInfo},squareTitleLayout:function(){var e;return this.isSearch?null!==(e=this.relatedSearchWords)&&void 0!==e&&e.length?"space-between":"flex-end":"space-between"},isSearch:function(){var e;return(null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.curCategoryId)||this.value},isShowRecommendText:function(){var e,t;return!!this.isSearch&&(!(null===(e=this.recommendList)||void 0===e||!e.length)||!(this.loading||null!==(t=this.squareList)&&void 0!==t&&t.length))},isModelType:function(){return["model","imgModel","videoModel","loraImgModel","loraVideoModel","image_train_model"].includes(this.activeTab)},tabType:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.outInitTab},searchType:function(){return k.x[this.tabType]},isShowSearch:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.isUseTagFilter},parentTab:function(){var e,t=null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.realTab;return"string"==typeof t?"features"===t?null:[t]:null==t?void 0:t.map((function(e){return e.id}))},emptyNumber:function(){var e,t;return 6===this.gridNum?18-(null===(e=this.squareList)||void 0===e?void 0:e.length):15-(null===(t=this.squareList)||void 0===t?void 0:t.length)},paramsCount:function(){var e,t,n;return this.isAdditionalModel?((null===(t=this.baseModelSelect)||void 0===t?void 0:t.length)||0)+((null===(n=this.modelTypeSelect)||void 0===n?void 0:n.length)||0):null===(e=this.baseModelSelect)||void 0===e?void 0:e.length},isHiddleTitle:function(){var e;return(null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.searchIng)||this.isShowSearch},isLoggedIn:{handler:function(e){this.tagIndex=e?"recommend":"hot"}},timeTypeOption:function(){return this.timeInit},lang:function(){return this.$i18n.locale},hideTimeTypeOption:function(){var e=["recommend","follows","new"].includes(this.tagIndex);return this.isSearch||e},renderTypeOption:function(){var e=Object(O.cloneDeep)(this.typeOption);return this.isLoggedIn||(e=e.filter((function(e){return"follows"!==e.id}))),(this.value||"features"!==this.CombinedSelectionDialog.realTab)&&((e=e.filter((function(e){return!["recommend","follows"].includes(e.id)}))).unshift({name:"styleModal1",id:"default",value:1,icon:"homeIcon1"}),this.tagIndex="default"),["aiApp"].includes(this.activeTab)&&(e=e.filter((function(e){return"follows"!==e.id&&"recommend"!==e.id}))),["videoModel"].includes(this.activeTab)&&(e=e.filter((function(e){return"recommend"!==e.id}))),e},setIcon:function(){var e=this,t="homeIcon1";return this.renderTypeOption.forEach((function(n){e.tagIndex===n.id&&(t=n.icon)})),t}},Object(w.e)("app",["topBanner","ABInfo"])),Object(w.e)("user",["adminOff","token"])),Object(w.c)("user",["isLoggedIn","userInfo","isCompanyAccount","cdnHostFun"])),{},{isModelItem:function(){var e=this;return function(t){return 2===t.obj_type||e.isModelType}},isFastAppItem:function(){var e=this;return function(t){return 14===t.obj_type||"aiApp"===e.activeTab}},dataInfo:function(){var e=this;return function(t,n){var o=e.queryParam.search_type,r=t.id,c=t.obj_type,d=t.pt,v=e.activeTabInfo,m=v.id,h=v.name,f=v.title||e.$t(h);return Object(l.a)(Object(l.a)({id:r,type:c,pt:d,info:{resp_type:"landing_page"},cindex:n,mIndex:"",session_id:e.CombinedSelectionDialog.sessionID,request_id:e.requestId,search_keyword:e.CombinedSelectionDialog.keyword,en_search_keyword:e.enSearchKeyword,search_scene:"create_flow_model",resp_type:"landing_page",entity_name:"model"===o?"associate_word":"text_search",entity_type:"model"===o?"associate_word_box":""},"entity_type",""),"position","popup,".concat(m,",").concat(f,",,,瀑布流,,").concat(n))}},renderBaseModels:function(){return this.isAdditionalModel?Object(P.getAdditionalModels)(this.baseModelType):this.baseModels},additionModelTypes:function(){var e=[{label:"LORA",value:"LORA"},{label:"DoRA",value:"DoRA"},{label:"LyCORIS",value:"LoCon"},{label:"embedding1",value:"TextualInversion"}];return"loraVideoModel"===this.subSource?e.filter((function(e){return"LORA"===e.value})):e},currentBaseModelTypes:function(){var e;return this.isAdditionalModel?null===(e=this.additionModelTypes)||void 0===e?void 0:e.map((function(e){return e.value})):["Checkpoint"]}}),methods:$($({},Object(w.b)("user",["recordEnableUsePresetConfig"])),{},{initData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.squareList=[],t.next=3,e.initFilter(e.activeTab);case 3:return e.queryParam.keyword="",e.queryParam.tag_ids="",e.queryParam.model_types=e.currentBaseModelTypes,t.next=8,e.intList();case 8:case"end":return t.stop()}}),t)})))()},resetSessionId:function(){var e,t;null!==(e=this.CombinedSelectionDialog)&&void 0!==e&&e.keyword&&(null===(t=this.CombinedSelectionDialog)||void 0===t||t.resetSessionId())},HyHomeFormsRefInitFilter:function(){try{var e;null===(e=this.$refs)||void 0===e||null===(e=e.HyHomeFormsRef)||void 0===e||e.initFilter()}catch(e){}},handleSubTagClick:function(e,t){this.activeTagIndex=t,"string"==typeof e.id?this.currentTagId=[e.id]:e.id?this.currentTagId=e.id:this.currentTagId=e.word,this.resetSessionId(),this.value?(this.$emit("input","".concat(this.value," ").concat(e.word)),this.queryParam.sub_obj_name=e.word,this.updateList("search")):this.intList(!0)},handleSearch:function(e,t){var n;null===(n=this.CombinedSelectionDialog)||void 0===n||n.handleSearch(e,t)},updateList:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";switch("add"!==e&&(this.queryParam.keyword="",this.queryParam.tag_ids=""),o&&(this.queryParam.keyword=o),e){case"tab":null===this.activeTagIndex?this.queryParam.tag_ids=this.parentTab:this.queryParam.tag_ids=this.currentTagId,this.intList(n);break;case"search":this.queryParam.keyword=(null===(t=this.CombinedSelectionDialog)||void 0===t?void 0:t.keyword)||"",this.queryParam.search_type=l,this.intList(!!this.queryParam.keyword);break;case"add":this.getList(!!this.queryParam.keyword);break;default:this.intList()}},resetViewData:function(){this.baseModelSelect=[],this.modelTypeSelect=this.isAdditionalModel?[]:["Checkpoint"],this.queryParam.sub_obj_name=""},handleChangeUsePresetConfig:function(e){this.recordEnableUsePresetConfig(e?1:2),this.$logEvent("log_actions",{operation:"click_use_official_recommended_params",behavior_info:"on_model_select_page",behavior_info_sub:e?"open":"close"})},lazyLoad:function(){var e=document.documentElement.scrollHeight,t=window.innerHeight;this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset,e-this.scrollTop-t<1.5*t&&this.getList()},noWebpImgReport:function(e){var t=["png","jpg","jpeg"],n=e.map((function(e){return{id:e.id,webpimg:Object(S.K)(e.cover||"","low")}})).filter((function(e){var n=e.webpimg.split("."),o=n[n.length-1];return o&&t.includes(o)}));n.length>0&&Object(S.P)("nowebp",n)},onFilterReset:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isReq){t.next=2;break}return t.abrupt("return");case 2:return e.modelTypeSelect=e.isAdditionalModel?[]:["Checkpoint"],e.baseModelSelect=[],t.next=6,e.intList(!!e.isSearch);case 6:case"end":return t.stop()}}),t)})))()},intList:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]&&e[0],t.squareList=[],t.isReq=!1,t.isLock=!1,t.queryParam.page=1,t.queryParam.page_size=35,t.queryParam.offset="",t.isAdditionalModel&&(t.queryParam.model_types=t.currentBaseModelTypes,t.queryParam.base_models=t.renderBaseModels),n.next=10,t.getList(o);case 10:case"end":return n.stop()}}),n)})))()},initFilter:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=t.ABInfo.filter_recommend,r={feature:["All","recommend"],model:["months","hot"],post:["week","hot"],lora_train:["months","hot"],design_template:["All","hot"],ishow:["All","hot"],workflow:["All","hot"],aiApp:["months","hot"],ai_video:["All","hot"],imgModel:["months","hot"],videoModel:["months","hot"],loraImgModel:["All","hot"],loraVideoModel:["All","hot"]},c={feature:"B"===l?["All","recommend"]:["months","hot"],model:["All","hot"],post:["All","hot"],lora_train:["All","hot"],design_template:["All","hot"],ishow:["All","hot"],workflow:["All","hot"],aiApp:["months","hot"],ai_video:["All","hot"],imgModel:["All","hot"],videoModel:["All","hot"],loraImgModel:["All","hot"],loraVideoModel:["All","hot"]},d=null,v=t.isLoggedIn?r:c,m={tagIndex:"hot",timeName:"All"},v[e]?(t.tagIndex=v[e][1],d=t.timeTypeOption.find((function(t){return t.name===v[e][0]}))):(t.tagIndex=m.tagIndex,d=t.timeTypeOption.find((function(e){return e.name===m.timeName}))),t.timeName=null===(o=d)||void 0===o?void 0:o.name;case 9:case"end":return n.stop()}}),n)})))()},getAdditionalModelParams:function(){var e={};return this.isAdditionalModel&&(e={model_types:this.modelTypeSelect.length?this.modelTypeSelect:this.currentBaseModelTypes,base_models:this.baseModelSelect.length?this.baseModelSelect:this.renderBaseModels}),e},handleItemSelect:function(e){this.$emit("handleItemSelect",e)},screenWaterList:function(){var e=this.$refs.HyHomeFormsRef.formData;this.tagIndex=e.order_by,this.queryParam=$($({},this.queryParam),e),this.intList()},getList:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var l,r,c,d,v,m,h,f,_,y,C,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=e.length>0&&void 0!==e[0]&&e[0],r={months:"month",days:"day",week:"week",All:""},c=t.queryParam.page,!t.isReq&&!t.isLock){n.next=5;break}return n.abrupt("return");case 5:if(t.isReq=!0,delete t.queryParam.model_type,delete t.queryParam.domain,delete t.queryParam.order_by,delete t.queryParam.model_types,delete t.queryParam.base_models,delete t.queryParam.refer,delete t.queryParam.scene,delete t.queryParam.type,delete t.queryParam.model_type,delete t.queryParam.mode,delete t.queryParam.created,delete t.queryParam.base_models,delete t.searchParams.model_types,d=x.getRecentSquare,v=1===c,m="recommend"===t.tagIndex,l?(d=T.a,f=t.queryParam.sub_obj_name?t.queryParam.keyword.replace(t.queryParam.sub_obj_name,""):t.queryParam.keyword,t.searchParams={obj_name:f.trimEnd(),sub_obj_name:t.queryParam.sub_obj_name,obj_type:t.searchType,offset:t.queryParam.offset,order_by:"default",page_size:t.queryParam.page_size,page:t.queryParam.page,base_models:t.baseModels},t.isAdditionalModel&&(t.searchParams=$($({},t.searchParams),t.getAdditionalModelParams())),t.isSearch&&(t.tagIndex&&(_="All"!==t.timeName&&"hot"===t.tagIndex,t.isSearch?t.searchParams.order_by=t.tagIndex:t.searchParams.order_by=_?r[t.timeName]:t.tagIndex),t.baseModelSelect.length?t.searchParams.base_models=t.baseModelSelect:t.searchParams.base_models=t.baseModels,t.isAdditionalModel&&(t.searchParams=$($({},t.searchParams),t.getAdditionalModelParams()))),null===t.activeTagIndex?t.searchParams.tag_ids=t.parentTab:t.searchParams.tag_ids=t.currentTagId,2===t.searchType&&(t.searchParams.model_types=t.isAdditionalModel?t.searchParams.model_types:t.currentBaseModelTypes,t.searchParams.with_ver_info=1),null!==(h=t.CombinedSelectionDialog)&&void 0!==h&&h.keyword&&(t.searchParams.tag_ids=[])):(t.tagIndex&&(y="All"!==t.timeName&&"hot"===t.tagIndex,t.queryParam.order_by=y?"".concat(r[t.timeName],"_").concat(t.tagIndex):t.tagIndex),t.isModelType&&(l?(t.queryParam.page_size=35,t.queryParam.refer="task",t.queryParam.scene="tf_v2",t.queryParam.type="community",t.queryParam.model_type="Checkpoint",t.queryParam.mode="lab",t.queryParam.created="",t.queryParam.base_models=t.isAdditionalModel?t.renderBaseModels:t.baseModels,t.isAdditionalModel&&(t.queryParam=$($({},t.queryParam),t.getAdditionalModelParams())),d=I.q):"recommend"===t.tagIndex?(delete t.queryParam.keyword,t.queryParam.model_types=t.currentBaseModelTypes,t.queryParam.base_models=t.isAdditionalModel?t.renderBaseModels:t.baseModels,d=x.getModelSquareRecommend):("follows"===t.tagIndex?(t.queryParam.source_types=[2],d=x.getModelSquareAttention):d=x.getModelSquare,t.queryParam.model_types=t.currentBaseModelTypes||["Checkpoint"],t.isAdditionalModel?t.queryParam=$($({},t.queryParam),t.getAdditionalModelParams()):(t.queryParam.base_models=t.baseModelSelect.length?t.baseModelSelect:t.baseModels,null!=t&&null!==(C=t.queryParam)&&void 0!==C&&null!==(C=C.base_models)&&void 0!==C&&C.length||(t.queryParam.base_models=t.baseModels)),t.queryParam.model_types.forEach((function(e,n){"LoRA"===e&&(t.queryParam.model_types[n]="LORA")})))),"aiApp"===t.activeTab?(t.queryParam.run_available=1,t.queryParam.order_by=t.queryParam.order_by_time||t.queryParam.order_by,d=x.getFastAppSquare):t.queryParam.run_available="",v&&m||delete t.queryParam.window_code),t.loading=!0,w=Object(k.ib)(l?t.searchParams:t.queryParam),t.isLoggedIn||d!==x.getRecentSquare){n.next=27;break}return n.abrupt("return");case 27:w.session_id=t.CombinedSelectionDialog.sessionID,w.scene="task_popup","generateVideo"===t.source&&(w.scene="task_video_checkpoint_popup"),t.isAdditionalModel&&"loraVideoModel"===t.subSource&&(w.scene="task_video_lora_popup"),w.ss=k.e.GenerateSearch,d(w).then((function(e){var n=e.status,data=e.data;if(1e4===(null==n?void 0:n.code)){var r,c;if("recommend"===t.tagIndex?data.has_more||(t.queryParam.page=0):t.isLock=!data||!data.has_more,t.requestId=n.request_id,t.enSearchKeyword=data.search_word_en,t.squareList=1===t.queryParam.page?data.items||[]:t.squareList.concat(data.items||[]),!t.CombinedSelectionDialog.curCategoryId&&data.related_search_words&&(t.relatedSearchWords=data.related_search_words||[],t.activeTagIndex=null),null!=data&&data.related_search_words||null===(r=t.CombinedSelectionDialog)||void 0===r||!r.keyword||(t.relatedSearchWords=[],t.activeTagIndex=null),t.isReq=!1,data.offset&&("new"===t.queryParam.order_by||l)&&(t.queryParam.offset=data.offset),t.queryParam.page++,t.noWebpImgReport(data.items||[]),t.squareList.length<=12&&t.isSearch){var d=JSON.parse(JSON.stringify(t.queryParam));d.keyword="",d.tag_ids=[],d.model_types=["Checkpoint"],t.isAdditionalModel&&(d=$($({},d),t.getAdditionalModelParams())),t.isImageTrainModel&&(d.base_models=t.baseModels),Object(x.getModelSquareRecommend)(d).then((function(e){t.recommendList=[].concat(Object(o.a)(t.recommendList),Object(o.a)(e.data.items))||[]}))}(!t.isSearch||(null===(c=t.squareList)||void 0===c?void 0:c.length)>12)&&(t.recommendList=[]);var v,m="";if(150002===(null==n?void 0:n.code))m=(null==n||null===(v=n.msg)||void 0===v||null===(v=v.split(":"))||void 0===v?void 0:v.pop())||"";2===t.queryParam.page&&t.logSearchEvent({sensitive_keyword:m})}t.loading=!1})).catch((function(e){t.loading=!1,t.isReq=!1}));case 33:case"end":return n.stop()}}),n)})))()},logSearchEvent:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).sensitive_keyword,t=void 0===e?"":e,n=this.queryParam,o=n.search_type;if(n.keyword){var l=this.isAdditionalModel?"log_action_image_lora_search":"log_action_image_model_search",r=$({event_id:l="model"===o?l.replace("_search","_text_search"):l,search_keyword:this.queryParam.keyword,en_search_keyword:this.enSearchKeyword,session_id:this.CombinedSelectionDialog.sessionID,request_id:this.requestId,entity_name:"model"===o?"associate_word":"type_search",entity_type:"model"===o?"associate_word_box":"",sensitive_keyword:t},this.CombinedSelectionDialog.getLogEventParams());if(this.CombinedSelectionDialog.sessionID){if(null!==this.activeTagIndex){var c=this.CombinedSelectionDialog.keyword;r=Object.assign(r,{front_operation:c?"search_input_query":"search_tag_query",event_name:c?"log_action_search_input_query":"log_action_search_tag_query",tag_content:this.searchParams.tag_ids,base_models:this.baseModelSelect,tagIndex:this.tagIndex})}else r=Object.assign(r,{front_operation:"search_query",event_name:this.isAdditionalModel?"log_action_image_lora_search":"log_action_image_model_search"});this.$xyLogEvent(r)}}},modelChange:function(e,t){var n=this;this.resetSessionId(),this.$xyLogEvent({front_operation:"model_filter_click",event_name:"log_action_model_filter_click",value:this.baseModelSelect,source_channel:this.sourceChannel}),this.isReq||(1===t?this.modelTypeSelect.includes(e)?this.modelTypeSelect.forEach((function(t,o){t===e&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(e):this.baseModelSelect.includes(e)?this.baseModelSelect.forEach((function(t,o){t===e&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(e),"recommend"===this.tagIndex&&(this.tagIndex="hot"),this.isSearch?this.intList(!0):this.intList())},handleTimeCommand:function(e){this.timeUpdate(),this.timeName=e.name,"recommend"!==this.tagIndex&&"follows"!==this.tagIndex||(this.tagIndex="hot"),this.isSearch?this.intList(!0):this.intList(),"All"!==e.name&&this.$logEvent("log_actions",{operation:" click_time_filter_button",behavior_info:e.name})},timeUpdate:function(){this.timeInit=[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(S.B)().startTimestamp,endTime:Object(S.B)().endTimestamp},{name:"week",startTime:Object(S.C)().startTimestamp,endTime:Object(S.C)().endTimestamp},{name:"months",startTime:Object(S.A)().startTimestamp,endTime:Object(S.A)().endTimestamp}]},handleCommand:function(e){this.resetSessionId();var t={hot:"click_hot",follows:"click_follows",recommend:"click_recommend",new:"click_new"}[e.id||e];if(t){var n,o,l={click_hot:null!==(n=this.queryParam.base_models)&&void 0!==n&&n.length?"".concat(this.timeName,",").concat(this.queryParam.base_models.join(",")):this.timeName||"",click_follows:null!==(o=this.queryParam.base_models)&&void 0!==o&&o.length?this.queryParam.base_models.join(","):this.timeName||""}[t];this.$logEvent("log_actions",{operation:t,behavior_info_sub:l,behavior_info:"on_select_bar",position:"create_flow"})}var r=!1;if("recommend"!==this.tagIndex&&"follows"!==this.tagIndex||(r=!0),this.timeUpdate(),this.tagIndex=e,"recommend"===this.tagIndex)delete this.queryParam.tag,this.modelTypeSelect=[],this.baseModelSelect=[],this.timeName="All",this.$refs.tagList&&(this.$refs.tagList.selectItem="");else if("follows"==this.tagIndex)this.timeName="All",this.$refs.tagList&&(this.$refs.tagList.selectItem="");else if(r){var c=this.timeTypeOption.find((function(e){return"week"===e.name}));return void this.handleTimeCommand(c)}this.isSearch?this.intList(!0):this.intList()},handleAppTypeChange:function(e){this.queryParam.output_types=""===e?["image","video"]:[e],this.intList()},initUsePresetConfigStatus:function(){var e,t=localStorage.getItem("enableUsePresetConfig");this.isLoggedIn?(this.enableUsePresetConfig=[1,"1"].includes(null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.use_model_preset_meta_mode),localStorage.setItem("enableUsePresetConfig",this.enableUsePresetConfig?1:2)):this.enableUsePresetConfig=!!["",null,void 0].includes(t)||[1,"1"].includes(t)},formatTag:function(e){return"default"===e?"styleModal1":e.charAt(0).toUpperCase()+this.tagIndex.slice(1)}}),created:function(){this.throttledLazyLoad=Object(O.throttle)(this.lazyLoad,200,{leading:!0,trailing:!0})},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.debounceChangeHandle=Object(O.debounce)(e.handleChangeUsePresetConfig,500),e.initUsePresetConfigStatus();case 2:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.debounceChangeHandle=null,this.throttledLazyLoad.cancel()},data:function(){return{requestId:"",enSearchKeyword:"",test:!0,enableUsePresetConfig:!0,debounceChangeHandle:function(){},throttledLazyLoad:null,scrollTop:0,getListNum:0,isLock:!1,isReq:!1,queryParam:{offset:"",page:1,page_size:35,with_ver_info:1,output_types:[],model_types:["Checkpoint"],tag_ids:[],scene:"task_popup",sub_obj_name:""},searchParams:{},timeInit:[{name:"All",name2:"click_All_filter",startTime:null,endTime:null},{name:"days",name2:"click_days_filter",startTime:Object(S.B)().startTimestamp,endTime:Object(S.B)().endTimestamp},{name:"week",name2:"click_week_filter",startTime:Object(S.C)().startTimestamp,endTime:Object(S.C)().endTimestamp},{name:"months",name2:"click_months_filter",startTime:Object(S.A)().startTimestamp,endTime:Object(S.A)().endTimestamp}],squareList:[],recommendList:[],activeTagIndex:null,currentTagId:"",relatedSearchWords:[],modelTypes:k.eb,baseModelSelect:[],modelTypeSelect:[],timeName:"All",typeOption:[].concat(D),loading:!0,tagIndex:"recommend",appType:"",appTypeList:[{name:"All",id:"",show:!0},{name:"videoGeneration",id:"video",show:!0},{name:"imageGeneration",id:"image",show:!0}]}}},E=j,A=(n(4253),n(0)),component=Object(A.a)(E,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"square"},["aiApp"===e.activeTab?t("HyHomeForms",{ref:"HyHomeFormsRef",attrs:{ptype:"swift_app"},on:{onScreen:e.screenWaterList}}):t("div",{staticClass:"square-header",style:{marginTop:e.marginTop,justifyContent:e.squareTitleLayout}},[e.isHiddleTitle?e._e():t("div",{staticClass:"square-header-title"},[e._v("\n      "+e._s(e.$t("square"))+"\n    ")]),e._v(" "),e.relatedSearchWords.length?t("swipeable-list",{staticClass:"tag-list",attrs:{iconBntWidth:28,listGap:"20px",top:"0px"}},e._l(e.relatedSearchWords,(function(n,o){return t("div",{key:o,staticClass:"tag-item",class:{active:e.activeTagIndex==o},on:{click:function(t){return e.handleSubTagClick(n,o)}}},[e._v("\n        "+e._s(null==n?void 0:n.word)+"\n      ")])})),0):e._e(),e._v(" "),t("div",{staticClass:"square-header-filters"},[e.isModelType?t("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[t("div",{staticClass:"filterCnt custom-dropdown-fcc"},[!e.isModelType||e.isAdditionalModel||e.isImageTrainModel?e._e():t("div",[t("div",{staticClass:"filterList pre-checkbox-box",staticStyle:{margin:"0 0 20px 0"}},[t("el-checkbox",{staticClass:"presets-model-option-checkbox",on:{change:e.debounceChangeHandle},model:{value:e.enableUsePresetConfig,callback:function(t){e.enableUsePresetConfig=t},expression:"enableUsePresetConfig"}}),e._v(" "),t("span",{staticClass:"pre-title"},[e._v(" "+e._s(e.$t("newGenerate59")))])],1)]),e._v(" "),e.isAdditionalModel?t("div",[t("div",{staticClass:"filterTit"},[e._v("\n              "+e._s(e.$t("ModelType"))+"\n            ")]),e._v(" "),t("div",{staticClass:"filterList"},e._l(e.additionModelTypes,(function(n,o){return t("div",{key:o,staticClass:"filterItem",class:{AfilterItem:e.modelTypeSelect.includes(n.value)},on:{click:function(t){return e.modelChange(n.value,1)}}},[e.modelTypeSelect.includes(n.value)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v(" "),t("span",[e._v(e._s(e.$t(n.label)))])])})),0)]):e._e(),e._v(" "),t("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[e._v(e._s(e.$t("BaseModel")))]),e._v(" "),t("div",{staticClass:"filterList"},e._l(e.renderBaseModels,(function(n,o){return t("div",{key:o,staticClass:"filterItem",class:{AfilterItem:e.baseModelSelect.includes(n)},on:{click:function(t){return e.modelChange(n,2)}}},[e.baseModelSelect.includes(n)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v(" "),t("span",[e._v(e._s(n))])])})),0),e._v(" "),t("div",{staticClass:"filterReset graBorder",on:{click:e.onFilterReset}},[e._v("\n            "+e._s(e.$t("resetSelection"))+"\n          ")])]),e._v(" "),t("el-badge",{staticClass:"item",attrs:{slot:"reference",hidden:!e.paramsCount,value:e.paramsCount},slot:"reference"},[t("div",{staticClass:"filterBox"},[t("div",[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])],1):e._e(),e._v(" "),t("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:!e.hideTimeTypeOption,expression:"!hideTimeTypeOption"}],attrs:{trigger:"hover"},on:{command:e.handleTimeCommand}},[t("div",{staticClass:"el-dropdown-link selectTime"},[t("div",[t("i",{staticClass:"el-icon-time"}),e._v(" "),t("span",[e._v(e._s(e.$t(e.timeName)))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"custom-dropdown custom-dropdown-fcc",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.timeTypeOption,(function(n,o){return t("el-dropdown-item",{key:o,attrs:{command:n}},[t("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[t("span",[e._v(e._s(e.$t(n.name)))])])])})),1)],1),e._v(" "),t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[t("div",{staticClass:"el-dropdown-link"},[t("div",[t("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(e.setIcon)}),e._v(" "),"recently"===e.tagIndex?t("span",[e._v(e._s(e.$t("recentlyUsed")))]):t("span",[e._v(e._s(e.$t(e.formatTag(e.tagIndex))))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"custom-dropdown custom-dropdown-fcc",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.renderTypeOption,(function(n,o){return t("el-dropdown-item",{key:o,attrs:{command:n.id,"data-event":"model_sort_click","data-id":n.value}},[t("div",{staticClass:"el-dropdown-item"},[t("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(n.icon)}),e._v(" "),t("span",[e._v(e._s(e.$t(n.name)))])])])})),1)],1),e._v(" "),"aiApp"===e.activeTab?t("PreferenceSelect",{staticClass:"app-type-select",attrs:{menuClass:"custom-dropdown custom-dropdown-fcc",list:e.appTypeList},on:{onChange:e.handleAppTypeChange},model:{value:e.appType,callback:function(t){e.appType=t},expression:"appType"}}):e._e()],1)],1),e._v(" "),t("div",{staticClass:"square-square-list",style:{gridTemplateColumns:"repeat(".concat(e.gridNum,", 1fr)"),minHeight:e.squareList.length?"40vh":"15vh"}},[e.squareList.length?e._l(e.squareList,(function(n,o){return t("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibility,expression:"handleVisibility"}],key:n.id,staticClass:"card-item",style:{height:e.isModelItem(n)&&5===e.gridNum?"340px":"280px"},attrs:{"data-info":JSON.stringify(e.dataInfo(n,o,null==n?void 0:n.id))}},[e.isModelItem(n)?t("ModelItem",{attrs:{item:n,logData:e.dataInfo(n,o),isAdditionalModel:e.isAdditionalModel,additionalBaseModels:e.renderBaseModels},on:{handleItemSelect:e.handleItemSelect}}):e._e(),e._v(" "),e.isFastAppItem(n)?t("FastAppItem",{attrs:{item:n,logData:e.dataInfo(n,o),isAdditionalModel:e.isAdditionalModel},on:{handleItemSelect:e.handleItemSelect}}):e._e(),e._v(" "),e.emptyNumber>0?e._l(e.emptyNumber,(function(o){return t("div",{key:"empty"+o,staticClass:"card-item-empty",style:{height:e.isModelItem(n)&&5===e.gridNum?"340px":"280px"}})})):e._e()],2)})):e._e(),e._v(" "),e.loading||e.squareList.length?e._e():[t("div",{staticClass:"square-empty-box"},[t("div",{staticClass:"square-empty"},[t("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),e._v(" "),t("p",[e._v(e._s(e.$t("NoResultsFound")))])],1)])],e._v(" "),e.isShowRecommendText?t("div",{staticClass:"recommend-text",style:{gridColumn:"span ".concat(e.gridNum)}},[t("div",{staticClass:"recommend-text-line"}),e._v(" "),t("div",{staticClass:"recommend-text-main"},[e._v(e._s(e.$t("styleModalLineText")))]),e._v(" "),t("div",{staticClass:"recommend-text-line"})]):e._e(),e._v(" "),e.recommendList.length?e._l(e.recommendList,(function(n,o){return t("div",{key:n.id,staticClass:"card-item",style:{height:e.isModelItem(n)&&5===e.gridNum?"340px":"280px"}},[e.isModelItem(n)?t("ModelItem",{attrs:{item:n,logData:e.dataInfo(n,o),isAdditionalModel:e.isAdditionalModel,addtionalBaseModels:e.renderBaseModels},on:{handleItemSelect:e.handleItemSelect}}):e._e()],1)})):e._e(),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"loading-box"})],2)],1)}),[],!1,null,"b91c6c50",null);t.default=component.exports;installComponents(component,{SwipeableList:n(52).default,SvgIcon:n(115).default})},3275:function(e,t,n){"use strict";n.r(t);var o={name:"CombinedSelectionSearch",inject:["CombinedSelectionDialog"],data:function(){return{keyword:"",searchPlaceholder:{model:"searchModelPlaceHolder",imgModel:"searchModelPlaceHolder",videoModel:"searchModelPlaceHolder",aiApp:"searchWorkflowAppPlaceHolder",collect:"Search",mine:"Search"}}},methods:{handleClear:function(){this.keyword="",this.$emit("search",this.keyword)},handleSearch:function(){this.$emit("search",this.keyword)},resetSearch:function(){this.keyword=""}},computed:{currentActiveTab:function(){return this.CombinedSelectionDialog.currentActiveTab||""},placeHolder:function(){return this.searchPlaceholder[this.currentActiveTab]||"Search"}}},l=(n(4254),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"style-content__search-box"},[t("el-input",{staticClass:"style-content__search-input",attrs:{placeholder:e.$t(e.placeHolder),autofocus:""},on:{change:e.handleSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[t("i",{staticClass:"iconfont icon-search search-icon",attrs:{slot:"prefix"},on:{click:e.handleSearch},slot:"prefix"}),e._v(" "),e.keyword?t("i",{staticClass:"el-input__icon el-icon-circle-close",attrs:{slot:"suffix"},on:{click:e.handleClear},slot:"suffix"}):e._e()])],1)}),[],!1,null,"153bdb50",null);t.default=component.exports},3279:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(26),n(97)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"RecentlyItem",components:{commonConfirmModal:l.default},inject:["CombinedSelectionDialog"],data:function(){return{selectModelData:null,callBackObj:null,showImage:!0,typeMap:{2:"model",14:"aiApp"},iconMap:{2:"icon-icon-Menu-model-selected",14:"icon-a-icon-tag-AIquickapp"}}},computed:d(d(d({},Object(r.e)("user",["collectData","cdnHost","token"])),Object(r.c)("user",["userInfo","isLoggedIn","getEnableUsePresetConfig"])),{},{itemCover:function(){var e,t,n;return(null===(e=this.item)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url)||(null===(t=this.item)||void 0===t?void 0:t.cover)||(null===(n=this.item)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.url)||""},itemCoverObj:function(){var e,t;return(null===(e=this.item)||void 0===e?void 0:e.cover)||(null===(t=this.item)||void 0===t?void 0:t.banner)||{}},selectedId:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.selectedId}}),props:{logEventPosition:{type:String,default:""},item:{type:Object,default:function(){}}},methods:{handleImageError:function(){this.showImage=!1},handleLogEventFn:function(){var e,t,n,o={operation:"click",behavior_info:null===(e=this.item)||void 0===e?void 0:e.id,obj_type:null===(t=this.item)||void 0===t?void 0:t.obj_type};null!==(n=this.CombinedSelectionDialog)&&void 0!==n&&n.dynamicModel&&this.logEventPosition&&(o.position=this.logEventPosition),this.$logEvent("log_actions",o)},handleConfirm:function(){var e,t,n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.selectModelData={model:this.callBackObj,model_type:(null===(e=this.item)||void 0===e?void 0:e.content_type)||(null===(t=this.item)||void 0===t?void 0:t.type),isPreset:o},o&&this.getEnableUsePresetConfig){var l,r,c,d,v=!0;if(this.isLoggedIn)v=null===(l=this.userInfo)||void 0===l?void 0:l.shot_task_v2_preset_meta_popup,null!==(r=this.userInfo)&&void 0!==r&&r.shot_task_v2_preset_meta_popup||localStorage.setItem("presetModelNotTips",1);else v=!localStorage.getItem("presetModelNotTips");if(v)this.$refs.commonConfirmModal.show({subTitle:"newGenerate60",fromPage:"modelPreset"}).then((function(){var e,t;n.selectModelData={model:n.callBackObj,model_type:(null===(e=n.item)||void 0===e?void 0:e.content_type)||(null===(t=n.item)||void 0===t?void 0:t.type),isPreset:o,usePreset:!0},n.$logEvent("log_actions",{operation:"click_try_it_now",behavior_info:"on_model_config_popup"}),n.sendData()})).catch((function(){var e,t;n.selectModelData={model:n.callBackObj,model_type:(null===(e=n.item)||void 0===e?void 0:e.content_type)||(null===(t=n.item)||void 0===t?void 0:t.type),isPreset:o},n.sendData()}));else this.selectModelData={model:this.callBackObj,model_type:(null===(c=this.item)||void 0===c?void 0:c.content_type)||(null===(d=this.item)||void 0===d?void 0:d.type),isPreset:o,usePreset:!0},this.sendData()}else this.sendData()},sendData:function(){var e=this;this.$emit("handleItemSelect",{obj:this.callBackObj,type:"model"}),setTimeout((function(){e.$EventBus.$emit("selectModel",e.selectModelData),e.selectModelData=null}),10)},handleSelect:function(){var e,t,n,o,l,r,c,v,m,h,f;if(this.handleLogEventFn(),this.typeMap[this.item.obj_type])if(this.callBackObj={name:null===(e=this.item)||void 0===e?void 0:e.title,id:null===(t=this.item)||void 0===t?void 0:t.id,banner:{url:this.itemCover||"",width:(null===(n=this.itemCoverObj)||void 0===n?void 0:n.width)||0,height:(null===(o=this.itemCoverObj)||void 0===o?void 0:o.height)||0,nsfw:null===(l=this.itemCoverObj)||void 0===l?void 0:l.url,is_nsfw_plus:(null===(r=this.itemCoverObj)||void 0===r?void 0:r.nsfw_plus)||(null===(c=this.item)||void 0===c?void 0:c.nsfw_plus)||!1,green:(null===(v=this.itemCoverObj)||void 0===v?void 0:v.green)||(null===(m=this.item)||void 0===m?void 0:m.green)||0,has_meta:(null===(h=this.itemCoverObj)||void 0===h?void 0:h.has_meta)||0}},2!==(null===(f=this.item)||void 0===f?void 0:f.obj_type))this.$emit("handleItemSelect",{obj:this.callBackObj,type:this.typeMap[this.item.obj_type]});else{var _,y,C,w,k,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R={base_model:(null===(_=this.item)||void 0===_?void 0:_.content_sub_type)||(null===(y=this.item)||void 0===y?void 0:y.base_model),type:(null===(C=this.item)||void 0===C?void 0:C.content_type)||(null===(w=this.item)||void 0===w?void 0:w.type),version_name:(null===(k=this.item)||void 0===k?void 0:k.version_name)||(null!==(I=this.item)&&void 0!==I&&I.child&&this.item.child.length>0?null===(x=this.item)||void 0===x?void 0:x.child[0].title:(null===(T=this.item)||void 0===T||null===(T=T.art_model)||void 0===T?void 0:T.version_name)||""),is_agency_fee:(null===(S=this.item)||void 0===S?void 0:S.is_agency_fee)||!1,agency_fee:(null===(O=this.item)||void 0===O?void 0:O.agency_fee)||0,payment_way:(null===(P=this.item)||void 0===P?void 0:P.payment_way)||0,sample_ids:(null===(M=this.item)||void 0===M?void 0:M.sample_ids)||null,model_ver_no:(null===(L=this.item)||void 0===L?void 0:L.model_ver_no)||(null!==($=this.item)&&void 0!==$&&$.child&&this.item.child.length>0?null===(D=this.item)||void 0===D?void 0:D.child[0].id:(null===(j=this.item)||void 0===j||null===(j=j.art_model)||void 0===j?void 0:j.ver_id)||"")};this.callBackObj=d(d({},this.callBackObj),R),this.selectModelData={model:this.callBackObj,model_type:(null===(E=this.item)||void 0===E?void 0:E.content_type)||(null===(A=this.item)||void 0===A?void 0:A.type),isPreset:""};var F=1===(null===(N=this.item)||void 0===N?void 0:N.is_preset)||1===(null===(V=this.item)||void 0===V||null===(V=V.art_model)||void 0===V?void 0:V.is_preset)?"preset":"";this.handleConfirm(F)}}}},m=v,h=(n(4263),n(0)),component=Object(h.a)(m,(function(){var e,t,n,o=this,l=o._self._c;return l("div",{ref:"recently_listItem",staticClass:"recently-item",on:{click:function(e){return e.stopPropagation(),o.handleSelect(o.item)}}},[l("div",{staticClass:"recently-item-banner",class:{"recently-item-banner-empty":!o.itemCover||!o.showImage}},[l("div",{staticClass:"rec-icon"},[l("i",{staticClass:"iconfont",class:[o.iconMap[o.item.obj_type]]})]),o._v(" "),o.itemCover&&o.showImage?l("img",{attrs:{src:o.itemCover,alt:(null===(e=o.item)||void 0===e?void 0:e.title)||"seaArt"},on:{error:o.handleImageError}}):o._e()]),o._v(" "),l("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[l("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[o._v("\n      "+o._s(null===(t=o.item)||void 0===t?void 0:t.title)+"\n    ")]),o._v(" "),l("div",{staticClass:"recently-item-name overflow-ellipsis-2"},[o._v("\n      "+o._s(null===(n=o.item)||void 0===n?void 0:n.title)+"\n    ")])]),o._v(" "),l("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"475fc304",null);t.default=component.exports},3280:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(12),n(13),n(7);var o=n(3),l=n(2),r=(n(20),n(6),n(22),n(8),n(4),n(9)),c=n(25),d=n(1);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"mineModelFilter",props:{curCode:{type:String,default:""},baseModels:{type:Array,default:function(){return r.b}},additionModelTypes:{type:Array,default:function(){return[]}},isAdditionalModel:{type:Boolean,default:!1}},computed:m(m({},Object(d.c)("user",["userInfo","isLoggedIn"])),{},{paramsCount:function(){var e,t,n;return this.isAdditionalModel?((null===(e=this.queryParam)||void 0===e||null===(e=e.base_models)||void 0===e?void 0:e.length)||0)+((null===(t=this.selectedStatus)||void 0===t?void 0:t.length)||0)+((null===(n=this.queryParam)||void 0===n||null===(n=n.model_types)||void 0===n?void 0:n.length)||0):this.queryParam.base_models.length+this.selectedStatus.length}}),data:function(){return{debounceChangeHandle:function(){},enableUsePresetConfig:!0,types:r.eb,selectedStatus:[],orders:[{key:"New",value:"new"},{key:"Hot",value:"hot"}],status:[{key:"createSetting1",value:1},{key:"createSetting2",value:2}],queryParam:{keyword:"",order_by:"new",publish_status:0,model_types:[],base_models:[],with_ver_info:1}}},watch:{userInfo:{handler:function(e){var t;if(null!==(t=Object.keys(e))&&void 0!==t&&t.length){var n=e.settings,o=(void 0===n?{}:n).use_model_preset_meta_mode,l=void 0===o?1:o;this.enableUsePresetConfig=1===l}},deep:!0,immediate:!0}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.debounceChangeHandle=Object(c.debounce)(e.handleChangeUsePresetConfig,500),e.initUsePresetConfigStatus();case 2:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.debounceChangeHandle=null},methods:m(m({},Object(d.b)("user",["recordEnableUsePresetConfig"])),{},{initUsePresetConfigStatus:function(){var e,t=localStorage.getItem("enableUsePresetConfig");this.isLoggedIn?(this.enableUsePresetConfig=[1,"1"].includes(null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.use_model_preset_meta_mode),localStorage.setItem("enableUsePresetConfig",this.enableUsePresetConfig?1:2)):this.enableUsePresetConfig=!!["",null,void 0].includes(t)||[1,"1"].includes(t)},handleChangeUsePresetConfig:function(e){this.recordEnableUsePresetConfig(e?1:2),this.$logEvent("log_actions",{operation:"click_use_official_recommended_params",behavior_info:"on_model_select_page",behavior_info_sub:e?"open":"close"})},handleFilter:function(e,t){switch(t){case"order_by":this.queryParam.order_by=e;break;case"publish_status":this.selectedStatus.includes(e)?this.selectedStatus=this.selectedStatus.filter((function(t){return t!==e})):this.selectedStatus.push(e),[0,2].includes(this.selectedStatus.length)?this.queryParam.publish_status=0:this.queryParam.publish_status=this.selectedStatus[0];break;case"model_types":this.queryParam.model_types.includes(e)?this.queryParam.model_types=this.queryParam.model_types.filter((function(t){return t!==e})):this.queryParam.model_types.push(e);break;case"base_models":this.queryParam.base_models.includes(e)?this.queryParam.base_models=this.queryParam.base_models.filter((function(t){return t!==e})):this.queryParam.base_models.push(e)}var n=m({},this.queryParam);this.isAdditionalModel?(n.model_types=this.queryParam.model_types.length?this.queryParam.model_types.filter((function(e){return"Checkpoint"!==e})):this.additionModelTypes.map((function(e){return e.value})),n.base_models=this.queryParam.base_models.length?this.queryParam.base_models:this.baseModels):n.model_types=["Checkpoint"],this.$emit("handleFilter",n)},filterReset:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.list=[],this.selectedStatus=[],this.queryParam={order_by:"new",publish_status:0,model_types:this.isAdditionalModel?[]:["Checkpoint"],base_models:[]};var t=m({},this.queryParam);this.isAdditionalModel&&(t.model_types=this.additionModelTypes.map((function(e){return e.value})),t.base_models=this.baseModels),e||this.$emit("handleFilter",t,!0)}})},f=h,_=(n(4264),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("div",[t("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[t("div",{staticClass:"filter-content"},[e.isAdditionalModel?e._e():t("div",{staticClass:"filter pre-checkbox-box"},[t("el-checkbox",{staticClass:"presets-model-option-checkbox",on:{change:e.debounceChangeHandle},model:{value:e.enableUsePresetConfig,callback:function(t){e.enableUsePresetConfig=t},expression:"enableUsePresetConfig"}}),e._v(" "),t("span",{staticClass:"pre-title"},[e._v(" "+e._s(e.$t("newGenerate59")))])],1),e._v(" "),["collect","recent"].includes(e.curCode)?e._e():[t("div",{staticClass:"title"},[e._v(e._s(e.$t("Sorting")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.orders,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.queryParam.order_by===n.value},on:{click:function(t){return e.handleFilter(n.value,"order_by")}}},[e.queryParam.order_by===n.value?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n            "+e._s(e.$t(n.key))+"\n          ")])})),0),e._v(" "),t("div",{staticClass:"title"},[e._v(e._s(e.$t("status")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.status,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.selectedStatus.includes(n.value)},on:{click:function(t){return e.handleFilter(n.value,"publish_status")}}},[e.selectedStatus.includes(n.value)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n            "+e._s(e.$t(n.key))+"\n          ")])})),0)],e._v(" "),e.isAdditionalModel?t("div",[t("div",{staticClass:"title"},[e._v(e._s(e.$t("ModelType")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.additionModelTypes,(function(n,o){return t("div",{key:o,staticClass:"item-filter",class:{active:e.queryParam.model_types.includes(n.value)},on:{click:function(t){return e.handleFilter(n.value,"model_types")}}},[e.queryParam.model_types.includes(n.value)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v(" "),t("span",[e._v(e._s(e.$t(n.label)))])])})),0)]):e._e(),e._v(" "),t("div",{staticClass:"title"},[e._v(e._s(e.$t("BaseModel")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.baseModels,(function(n){return t("div",{key:n,staticClass:"item-filter",class:{active:e.queryParam.base_models.includes(n)},on:{click:function(t){return e.handleFilter(n,"base_models")}}},[e.queryParam.base_models.includes(n)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n          "+e._s(n)+"\n        ")])})),0),e._v(" "),t("div",{staticClass:"filter-reset",on:{click:function(t){return t.stopPropagation(),e.filterReset(!1)}}},[e._v("\n        "+e._s(e.$t("resetSelection"))+"\n      ")])],2),e._v(" "),t("el-badge",{staticClass:"item",attrs:{slot:"reference",value:e.paramsCount,hidden:0===e.paramsCount},slot:"reference"},[t("div",{staticClass:"filter-box"},[t("div",[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])],1)],1)}),[],!1,null,"3913f6b9",null);t.default=component.exports},3281:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(6),n(4);var o={name:"mineFastAppFilter",computed:{paramsCount:function(){var e;return(null===(e=this.selectedStatus)||void 0===e?void 0:e.length)||0}},data:function(){return{queryParam:{order_by:"new",publish_status:0},orders:[{key:"New",value:"new"},{key:"Hot",value:"hot"}],statusArr:[{key:"Publish",value:1},{key:"offShelf",value:2}],selectedStatus:[]}},methods:{handleFilter:function(e,t){"sort"===t?this.queryParam.order_by=e:(this.selectedStatus.includes(e)?this.selectedStatus=this.selectedStatus.filter((function(t){return t!==e})):this.selectedStatus.push(e),[0,2].includes(this.selectedStatus.length)?this.queryParam.publish_status=0:this.queryParam.publish_status=this.selectedStatus[0]);this.$emit("handleFilter",this.queryParam)},filterReset:function(){this.selectedStatus=[],this.queryParam={publish_status:0,order_by:"new"},this.$emit("handleFilter",this.queryParam,!0)}}},l=(n(4265),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[t("div",{staticClass:"filter-content"},[t("div",{staticClass:"title"},[e._v(e._s(e.$t("Sorting")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.orders,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.queryParam.order_by===n.value},on:{click:function(t){return e.handleFilter(n.value,"sort")}}},[e.queryParam.order_by===n.value?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n        "+e._s(e.$t(n.key))+"\n      ")])})),0),e._v(" "),t("div",{staticClass:"title"},[e._v(e._s(e.$t("status")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.statusArr,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.selectedStatus.includes(n.value)},on:{click:function(t){return e.handleFilter(n.value,"status")}}},[e.selectedStatus.includes(n.value)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n        "+e._s(e.$t(n.key))+"\n      ")])})),0),e._v(" "),t("div",{staticClass:"filter-reset",on:{click:e.filterReset}},[e._v("\n      "+e._s(e.$t("resetSelection"))+"\n    ")])]),e._v(" "),t("el-badge",{staticClass:"item",attrs:{slot:"reference",hidden:0===e.paramsCount,value:e.paramsCount},slot:"reference"},[t("div",{staticClass:"filter-box"},[t("div",[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])],1)}),[],!1,null,"051206e6",null);t.default=component.exports},3285:function(e,t,n){"use strict";n.r(t);n(19),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(14),l=n(3),r=n(2),c=(n(199),n(22),n(31),n(122),n(20),n(3286)),d=n(1),v=n(25),m=n(385),h=n(268);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={name:"MultiImageGenerate",inject:["easyTop"],props:{value:{type:Object,default:function(){return{}}},menuIndex:{type:String,default:""}},components:{UploadBox:c.default,VideoExplainPopover:m.a},data:function(){return{isCollapse:!1,sizeList:[{width:720,height:1280,aspect_ratio:"9:16",icon:"icon-a-9_161"},{width:1024,height:1024,aspect_ratio:"1:1",icon:"icon-icon-a-1_11"},{width:1280,height:720,aspect_ratio:"16:9",icon:"icon-a-16_91"}],durationList:[5,10],displayedSamples:[],samplePage:1,samplePageSize:5}},computed:_(_(_(_({},Object(d.c)("user",["isCompanyAccount","isLoggedIn"])),Object(d.c)("payment",["paymentInfo"])),Object(d.c)("creation",["video_config"])),{},{isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},generateValue:function(){var e;return null===(e=this.value)||void 0===e?void 0:e.multiImg2videoInfo}}),mounted:function(){this.getSampleImages()},methods:{getSampleImages:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.d)({scene:2});case 2:1e4===(n=t.sent).status.code&&(e.sampleImages=n.data.batch_images,e.refreshDisplayedSamples());case 4:case"end":return t.stop()}}),t)})))()},refreshDisplayedSamples:function(){this.displayedSamples=this.sampleImages.sort((function(){return Math.random()-.5})).slice(0,5)},handleChangeSamples:function(){this.refreshDisplayedSamples()},handleChangeGenMode:function(e){var t;this.isLoggedIn?this.isVip||1!==e?this.isVip&&1===(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)&&1===e?this.$EventBus.$emit("showUpgradeDialog","UpgradeQualityModel","standard"):this.changeConfig(e,"gen_mode"):this.$EventBus.$emit("showBreakDialog","updateQualityTips","basic"):this.$EventBus.$emit("openLoginDialog")},changeConfig:function(e,t){var n=Object(v.cloneDeep)(this.generateValue);t?n[t]=e:n=_(_({},n),e),this.easyTopUpdateConfig(n)},handleChangeImageList:function(e){this.changeConfig(e,"imageList")},easyTopUpdateConfig:function(e){var t,n=this;null===(t=this.easyTop)||void 0===t||t.updateConfig({multiImg2videoInfo:e},this.menuIndex),this.$nextTick((function(){var e;null===(e=n.easyTop)||void 0===e||e.throttledGetMultiImg2videoCost()}))},toggleFoldStatus:function(){this.isCollapse=!this.isCollapse},handleSelectSample:function(e){var t;null===(t=this.easyTop)||void 0===t||t.updateConfig({prompt:this.$t(e.prompt)},this.menuIndex);var n=e.imgs.map((function(img){return{url:img}}));n.length<4&&n.push.apply(n,Object(o.a)(Array(4-n.length).fill({url:""}))),this.changeConfig(n,"imageList")}}},C=(n(4296),n(4297),n(0)),component=Object(C.a)(y,(function(){var e,t,o=this,l=o._self._c;return l("div",{staticClass:"multi-image-generate"},[l("div",{staticClass:"multi-image-generate-params"},[l("div",{staticClass:"multi-image-generate-select-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("selectImage")))])]),o._v(" "),l("p",{staticClass:"multi-image-generate-title-tip"},[o._v(o._s(o.$t("multi_image_select_image_tip")))]),o._v(" "),l("div",{staticClass:"multi-image-generate-content"},[l("UploadBox",{attrs:{imageList:o.generateValue.imageList},on:{change:o.handleChangeImageList}})],1)]),o._v(" "),l("div",{staticClass:"multi-image-generate-list-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("ExampleImages")))]),o._v(" "),l("div",{staticClass:"change-btn",on:{click:o.handleChangeSamples}},[l("i",{staticClass:"el-icon-refresh"}),o._v("\n          "+o._s(o.$t("changeit"))+"\n        ")])]),o._v(" "),l("div",{staticClass:"multi-image-generate-content example-images-box"},o._l(o.displayedSamples,(function(e,t){var n,r;return l("el-popover",{key:"multi-image-generate-displayed-sample-".concat(t),attrs:{placement:"top",trigger:"hover","popper-class":"multi-image-generate-popover"}},[l("div",{staticClass:"panel-item-image-box-hover"},o._l(e.imgs,(function(img,e){return l("img",{key:"multi-image-generate-displayed-sample-".concat(t,"-").concat(e),staticClass:"panel-item-image",attrs:{src:img,alt:"example-image"}})})),0),o._v(" "),l("div",{staticClass:"panel-item-image-box",class:{"panel-item-image-box-active":(null===(n=o.generateValue)||void 0===n?void 0:n.imageList[0].url)===e.imgs[0]},attrs:{slot:"reference","data-number":o.$t("number_of_pictures",{num:(null===(r=e.imgs)||void 0===r?void 0:r.length)||0})},on:{click:function(t){return t.stopPropagation(),o.handleSelectSample(e)}},slot:"reference"},[l("img",{staticClass:"panel-item-image",attrs:{src:e.imgs[0],alt:"example-image"}})])])})),1)]),o._v(" "),l("div",{staticClass:"multi-image-generate-quality-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("newGenerate5"))+"\n          "),l("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:o.$t("newGenerate108"),placement:"top-start"}},[l("i",{staticClass:"custom-tips el-icon-warning-outline"})])],1)]),o._v(" "),l("div",{staticClass:"multi-image-generate-content flex-wrap-nowrap"},[l("div",{staticClass:"panel-item",class:{"active-btn":0===(null===(e=o.generateValue)||void 0===e?void 0:e.gen_mode)},on:{click:function(e){return e.stopPropagation(),o.handleChangeGenMode(0)}}},[o._v("\n          "+o._s(o.$t("newGenerate44"))+"\n        ")]),o._v(" "),l("VideoExplainPopover",{key:"quality",staticClass:"mall-explain-popup margin-left-0",attrs:{type:"quality",isVideoModel:!0}},[l("div",{staticClass:"panel-item",class:{"active-btn":1===(null===(t=o.generateValue)||void 0===t?void 0:t.gen_mode)},attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),o.handleChangeGenMode(1)}},slot:"reference"},[o.isCompanyAccount?o._e():l("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),o._v("\n            "+o._s(o.$t("newGenerate45"))+"\n          ")])])],1)]),o._v(" "),l("div",{staticClass:"multi-image-generate-size-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("ToVideoSize")))]),o._v(" "),l("div",{staticClass:"current-size"},[o._v(o._s(o.generateValue.width)+" x "+o._s(o.generateValue.height))])]),o._v(" "),l("div",{staticClass:"multi-image-generate-content multi-image-generate-content-single"},o._l(o.sizeList,(function(e){var t;return l("div",{key:"multi-image-generate-size-".concat(e.aspect_ratio),staticClass:"panel-item",class:{"active-btn":(null===(t=o.generateValue)||void 0===t?void 0:t.aspect_ratio)===e.aspect_ratio},on:{click:function(t){return t.stopPropagation(),o.changeConfig(e)}}},[l("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),o._v(" "),l("span",{staticClass:"panel-item-label"},[o._v(o._s(e.aspect_ratio))])])})),0)]),o._v(" "),l("div",{staticClass:"multi-image-generate-duration-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("Duration")))])]),o._v(" "),l("div",{staticClass:"multi-image-generate-content"},o._l(o.durationList,(function(e){var t;return l("div",{key:"multi-image-generate-duration-".concat(e),staticClass:"panel-item",class:{"active-btn":(null===(t=o.generateValue)||void 0===t?void 0:t.generate_video_duration)===e},on:{click:function(t){return t.stopPropagation(),o.changeConfig(e,"generate_video_duration")}}},[o._v("\n          "+o._s(e)+"s\n        ")])})),0)])]),o._v(" "),l("div",{staticClass:"multi-image-generate-params"},[l("div",{staticClass:"multi-image-generate-advanced-box"},[l("div",{staticClass:"multi-image-generate-title",on:{click:function(e){return e.stopPropagation(),o.toggleFoldStatus.apply(null,arguments)}}},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v(o._s(o.$t("AdvancedConfig")))]),o._v(" "),l("span",{staticClass:"additional-panel-title-icon",class:[o.isCollapse?"el-icon-caret-top":"el-icon-caret-bottom"]})])]),o._v(" "),o.isCollapse?[l("div",{staticClass:"multi-image-generate-negative-box"},[l("div",{staticClass:"multi-image-generate-title"},[l("span",{staticClass:"multi-image-generate-title-text"},[o._v("\n            "+o._s(o.$t("NegativePrompts"))+"\n            "),l("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:o.$t("newGenerate53"),placement:"top-start"}},[l("i",{staticClass:"custom-tips el-icon-warning-outline"})])],1),o._v(" "),l("el-switch",{attrs:{value:o.generateValue.enableNegativePrompts,"active-color":"#3F8CFF"},on:{change:function(e){return o.changeConfig(e,"enableNegativePrompts")}}})],1),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:o.generateValue.enableNegativePrompts,expression:"generateValue.enableNegativePrompts"}],staticClass:"multi-image-generate-content"},[l("div",{staticClass:"negative-prompt-input"},[l("el-input",{staticClass:"top-input-area-input",attrs:{type:"textarea",value:o.generateValue.negative_prompt,autosize:{minRows:4,maxRows:4},resize:"none",maxlength:2e3,placeholder:o.$t("pleaseEnte")},on:{input:function(e){return o.changeConfig(e,"negative_prompt")}}})],1)])])]:o._e()],2)])}),[],!1,null,"5073db1e",null);t.default=component.exports},3286:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(16),n(18),n(21),n(90),n(1)),r=n(83),c=n(25);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var v={name:"MultiImageUploadBox",emits:["change"],props:{imageList:{type:Array,default:function(){return[]}}},components:{HyUploadModal:r.default},data:function(){return{currentUploadIndex:0,dragOverIndex:-1,isDragUpload:!1,isFromSeaArtDrag:!1,uploadObj:{fileMaxSize:10,minWh:[300,300],minProportion:[1,2.5],maxProportion:[2.5,1],accept:".jpg,.png,.jpeg,.webp,.bmp"}}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(l.c)("user",["isLoggedIn"])),methods:{handlePickImage:function(e){var t=e[0]||{},n=Object(c.cloneDeep)(this.imageList);n[this.currentUploadIndex]=Object(c.cloneDeep)(t),this.emitUpdate(n),this.isDragUpload&&(this.reportDragUploadEvent(!0),this.resetDragState())},handleUpload:function(e){this.isLoggedIn?(this.currentUploadIndex=e,this.$refs.pickOrUploadImageModal.openModal()):this.$EventBus.$emit("openLoginDialog")},handleDelete:function(e){var t=Object(c.cloneDeep)(this.imageList);t[e]={url:""},this.emitUpdate(t)},emitUpdate:function(e){this.$emit("change",e)},handleDragEnter:function(e,t){var n;e.preventDefault(),e.stopPropagation(),null!==(n=this.imageList[t])&&void 0!==n&&n.url||(this.dragOverIndex=t)},handleDragLeave:function(e,t){e.preventDefault(),e.stopPropagation();var n=e.currentTarget,o=e.relatedTarget;o&&n.contains(o)||(this.dragOverIndex=-1)},handleDrop:function(e,t){var n,o;if(e.preventDefault(),e.stopPropagation(),this.dragOverIndex=-1,null===(n=this.imageList[t])||void 0===n||!n.url)if(this.isLoggedIn){var l=e.dataTransfer.files,r=e.dataTransfer.getData("text/uri-list");if(r&&null!==(o=String(r))&&void 0!==o&&o.includes("seaart"))this.handleDragUrl(r,t);else if(l.length>0){var c=l[0];c.type.startsWith("image/")&&this.processDragFile(c,t)}}else this.$EventBus.$emit("openLoginDialog")},handleDragUrl:function(e,t){var n={url:e};this.isDragUpload=!0,this.isFromSeaArtDrag=!0,this.currentUploadIndex=t;var o=Object(c.cloneDeep)(this.imageList);o[t]=Object(c.cloneDeep)(n),this.emitUpdate(o),this.reportDragUploadEvent(!0),this.resetDragState()},processDragFile:function(e,t){if(e){var n={name:e.name,raw:e,percentage:0,status:"ready",uid:Date.now(),size:e.size};this.isDragUpload=!0,this.isFromSeaArtDrag=!1,this.currentUploadIndex=t,this.$refs.pickOrUploadImageModal.openModal();try{this.$refs.pickOrUploadImageModal.handleChange(n,[n])}catch(e){console.error("拖拽文件上传失败:",e),this.reportDragUploadEvent(!1),this.resetDragState()}}},reportDragUploadEvent:function(e){try{this.$xyLogEvent({front_operation:"click",entity_name:"generate_multi_image_drag_upload_success",entity_type:"generate_multi_image_drag_upload",event_name:"log_action_front",obj_desc:"aiVideo",obj_info:{status:e}})}catch(e){console.error("埋点上报失败:",e)}},resetDragState:function(){this.isDragUpload=!1,this.isFromSeaArtDrag=!1}}},m=v,h=(n(4295),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-box"},[e._l(e.imageList,(function(n,o){return t("div",{key:"multi-image-generate-upload-box-item-".concat(o),staticClass:"upload-box-item",class:{"drag-over":e.dragOverIndex===o},on:{dragover:function(t){return t.preventDefault(),e.handleDragEnter(t,o)},dragleave:function(t){return t.preventDefault(),e.handleDragLeave(t,o)},drop:function(t){return t.preventDefault(),e.handleDrop(t,o)}}},[n.url?[t("div",{staticClass:"upload-box-item-image"},[t("img",{attrs:{src:n.url,alt:"upload-box-item-image"}}),e._v(" "),t("div",{staticClass:"delete-btn",on:{click:function(t){return t.stopPropagation(),e.handleDelete(o)}}},[t("i",{staticClass:"el-icon-close"})])])]:t("div",{staticClass:"upload-box-item-icon",on:{click:function(t){return e.handleUpload(o)}}},[t("i",{staticClass:"iconfont icon-a-icon-addimg2img"}),e._v(" "),t("span",{staticClass:"upload-box-item-icon-text"},[e._v(e._s(e.$t("click_upload_or_drag")))])])],2)})),e._v(" "),t("HyUploadModal",{ref:"pickOrUploadImageModal",attrs:{isSingleSelect:"",uploadObj:e.uploadObj,category:57},on:{onConfirm:e.handlePickImage}})],2)}),[],!1,null,"3caaa1f8",null);t.default=component.exports},3287:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8),n(7);var o=n(2),l=(n(19),n(6),n(16),n(4),n(1)),r=n(9);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"ToolsPopup",data:function(){return{visible:!1}},computed:d(d(d({},Object(l.c)("user",["cdnHostFun"])),Object(l.c)("user",["isCompanyAccount","isLoggedIn"])),{},{cardList:function(){var e=[{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai-face-swap")),title:"ai_face_changing",subTitle:"ai_face_changing_desc",type:"ai_face_changing",dataLoggingName:"ai_face_changing",path:"ai-face-swap",logType:"ai-face-swap"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai-filter")),title:"ai_tools_4",subTitle:"ai_tools_8",type:"ai_filter",dataLoggingName:"ai_filters",path:"ai-filter",logType:"ai-filter"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai-model-fitting")),title:"ai_model_fitting_title",subTitle:"ai_model_fitting_desc",type:"aiModelFitting",path:"ai-model-fitting",logType:"ai-model-fitting"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("remove-background")),title:"ai_tools_2",subTitle:"ai_tools_6",type:"remove_background",dataLoggingName:"remove_background",path:"remove-background",logType:"remove-background"},{source1:"",cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai_erase")),title:"ai_erase",subTitle:"ai_erase_tip",type:"ai_erase",dataLoggingName:"",path:"ai_erase",logType:"ai_erase"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("image-upscaler")),title:"upsacler_3_H1",subTitle:"upsacler_4_H1_value",type:"hd_restoration",dataLoggingName:"hd_restoration",path:"image-upscaler",logType:"image-upscaler"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai-makeup")),title:"ai_makeup",subTitle:"ai_makeup_desc",type:"ai-makeup",dataLoggingName:"ai-makeup",path:"ai-makeup",logType:"ai-makeup"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("ai-portrait")),title:"ai_tools_10",subTitle:"ai_tools_11",type:"ai_photography",dataLoggingName:"ai_photography",path:"ai-portrait",logType:"ai-portrait"},{cover:"https://".concat(this.cdnHostFun()).concat(Object(r.W)("scribble2img")),title:"ai_tools_3",subTitle:"ai_tools_7",type:"character_fixes",dataLoggingName:"from_sketch_to_artwork",path:"scribble2img",logType:"scribble2img"}];return this.isCompanyAccount?e.filter((function(e){return!["ai_photography"].includes(e.type)})):e}}),methods:{jumpUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&null!=e&&e.logType&&this.$logEvent("log_actions",{operation:"click_ai_tools",behavior_info:"on_new_create_flow_page",behavior_info_sub:null==e?void 0:e.logType});var t=this.localePath("/ai-tools/".concat(e.path));["swiftAiMore"].includes(e.code)&&(t=this.localePath("".concat(e.path))),window&&window.open(t,"_blank")},openToolsModal:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"AnimGen":this.$EventBus.$emit("openEasyAnimeToolsModal");break;case"Upscale":this.$EventBus.$emit("openEasyUpscaleToolsModal")}}}},m=v,h=(n(4299),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("el-popover",{ref:"topBarPopover",attrs:{title:"",trigger:"hover","popper-class":"easy-generate-tools-popup","append-to-body":!0,"visible-arrow":!1},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"tools-popup-title"},[e._v(e._s(e.$t("AI_Tools")))]),e._v(" "),t("div",{staticClass:"tools-popup-menus"},[t("div",{staticClass:"tools-popup-menu-item",on:{click:function(t){return t.stopPropagation(),e.openToolsModal("Upscale")}}},[t("i",{staticClass:"iconfont icon-icon_extraUpscale tools-popup-menu-item-icon"}),e._v("\n      "+e._s(e.$t("taskTabUpscale"))+"\n    ")])]),e._v(" "),t("div",{staticClass:"tools-popup-title"},[e._v(e._s(e.$t("swiftAI")))]),e._v(" "),t("div",{staticClass:"tools-popup-card-list"},e._l(e.cardList,(function(n){return t("div",{key:n.type,staticClass:"tools-popup-card-item",style:"background-image: url(".concat(n.cover,")"),on:{click:function(t){return t.stopPropagation(),e.jumpUrl(n)}}},[t("div",{staticClass:"tools-popup-card-item-info"},[t("div",{staticClass:"card-item-info-title"},[t("span",{staticClass:"card-title-text"},[e._v(e._s(e.$t(n.title)))]),e._v(" "),t("span",{staticClass:"card-title-icon"},[t("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),t("div",{staticClass:"card-item-info-sub-title"},[e._v(e._s(e.$t(n.subTitle)))])])])})),0),e._v(" "),t("div",{staticClass:"tools-popup-view-more-btn",on:{click:function(t){return t.stopPropagation(),e.jumpUrl({code:"swiftAiMore",path:"/ai-tools"})}}},[t("span",{staticClass:"tools-popup-view-more-btn-text"},[e._v(e._s(e.$t("viewMore")))]),e._v(" "),t("span",{staticClass:"tools-popup-view-more-btn-icon el-icon-right"})])])}),[],!1,null,null,null);t.default=component.exports},3288:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(601)),r=n(869),c=n(161),d=n(54),v={name:"ListActionBar",props:{listParams:{type:Object,default:function(){return{}}}},components:{FilterOptionPopup:l.default},inject:["easyTop"],data:function(){return{selectActiveId:"",isActiveManage:!1,messages:this.$t("messagesListtext_3"),idx:0,timerId:null,isText:!1}},computed:{isCharacter:function(){var e;return"character"===(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.activeCategory)},currentParams:function(){var e;return(null===(e=this.easyTop)||void 0===e?void 0:e.config.generateImage)||null}},mounted:function(){},beforeDestroy:function(){},watch:{"easyTop.isShowMessageManage":{handler:function(e){this.isActiveManage=!!e}}},methods:{openNote:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,d,v,source,m,h,f,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v=e.source,source=void 0===v?"create_notes":v,t.easyTop.isLoggedIn){n.next=4;break}return t.$EventBus.$emit("openLoginDialog",{dot:!1}),n.abrupt("return");case 4:return n.next=6,null===(o=t.easyTop)||void 0===o?void 0:o.getParams();case 6:m=n.sent,h=null===(l=t.easyTop)||void 0===l?void 0:l.getGenerateType(),f=null===(d=t.easyTop)||void 0===d?void 0:d.getParamsByType(m,h);try{f.meta.generate=t.easyTop.config[t.currentTab].generate}catch(e){}_=Object(c.a)({render:function(e){return e(r.default,{props:{currentParams:t.currentParams,saveParams:f,selectActiveId:t.selectActiveId,source:source},on:{close:function(){_.close()},fill:function(e,n){var o;t.selectActiveId=n,null===(o=t.easyTop)||void 0===o||o.getConfig({data:e.requestParams,action:1,NoteFill:e.NoteFill}),_.close()}}})}});case 11:case"end":return n.stop()}}),n)})))()},openPublish:function(){this.$EventBus.$emit("openContribution",{selectedData:[],types:[d.CONTRIBUTION_TYPE_ENUM.WORK],source:"task"})},openManage:function(){this.isActiveManage=!this.isActiveManage,this.easyTop.setMessageManage(this.isActiveManage,!this.isActiveManage)},openFilter:function(){this.isActiveManage=!1,this.easyTop.setMessageManage(!1),this.$emit("filter"),this.$logEvent("log_actions",{operation:"click_filter_button",behavior_info:"on_createflow_page"})}}},m=(n(4309),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"list-action-bar-box"},[t("div",{staticClass:"list-action-bar-item list-action-bar-item-left"},[t("el-tooltip",{attrs:{effect:"dark",content:"".concat(e.$t("postTips2")),placement:"bottom"}},[t("div",{staticClass:"publish-btn btn",attrs:{"data-id":"publish-btn"},on:{click:e.openPublish}},[t("span",{staticClass:"iconfont icon-square-plus font16"})])])],1),e._v(" "),t("el-tooltip",{attrs:{effect:"dark",content:"".concat(e.$t("Manage")),placement:"bottom"}},[t("div",{staticClass:"btn",class:{"is-active-manage":e.isActiveManage},attrs:{"data-id":"list-action-bar-item-manage"},on:{click:function(t){return e.openManage()}}},[t("span",{staticClass:"iconfont icon-layout-grid font16"})])]),e._v(" "),e.isCharacter?e._e():t("filter-option-popup",{attrs:{listParams:e.listParams}},[t("el-tooltip",{attrs:{effect:"dark",content:"".concat(e.$t("Filter")),placement:"bottom"}},[t("div",{staticClass:"btn",attrs:{"data-id":"list-action-bar-item-filter"},on:{click:function(t){return e.openFilter("filter")}}},[t("span",{staticClass:"iconfont icon-filter font16"})])])],1)],1)}),[],!1,null,"6294cea2",null);t.default=component.exports},3289:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8),n(7);var o=n(2),l=(n(6),n(16),n(4),n(21),n(33)),r=n(602),c=n(1);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"ImageAndControlNetPopup",data:function(){return{visible:!1,ENABLE_FLUX_STYLE_REFERENCE:l.ENABLE_FLUX_STYLE_REFERENCE}},inject:["easyTop"],components:{SelectControlNetModal:r.default},computed:v(v(v({},Object(c.c)("creation",["v2_sd_xl_ctr_units","v2_ctr_units","conf_img"])),Object(c.c)("user",["cdnHostFun","isLoggedIn"])),{},{imageToVideoCover:function(){return["https://".concat(null==this?void 0:this.cdnHostFun(),"/static/upload/20250117/f8e2c9ab-5de4-4202-8b26-41a4df4bef26.png"),"https://".concat(null==this?void 0:this.cdnHostFun(),"/static/upload/20250117/f498b780-8343-4183-8c80-ffe684a46757.gif")]},imageToLive2DCover:function(){return["https://".concat(null==this?void 0:this.cdnHostFun(),"/static/upload/20250117/be9531c0-51dc-466a-bb44-e992b36e8f6d.png"),"https://".concat(null==this?void 0:this.cdnHostFun(),"/static/upload/20250117/0c1b39dc-8ff5-41f0-9191-5dc03b0472da.gif")]},styleReferenceCover:function(){var e;return(null==this||null===(e=this.conf_img)||void 0===e?void 0:e.flux_style_reference)||[]},isHideImageToImage:function(){var e,t,n,o,l,r,c,d,v,m=(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isCommunityFlux)&&(null==this||null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t||null===(t=t.controlnet_units)||void 0===t?void 0:t.length),h=(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isCommunityFlux)&&(null==this||null===(o=this.easyTop)||void 0===o||null===(o=o.currentConfigInfo)||void 0===o||null===(o=o.styleReferenceList)||void 0===o?void 0:o.length),f=null==this||null===(l=this.easyTop)||void 0===l?void 0:l.isMiniMax,_=null==this||null===(r=this.easyTop)||void 0===r?void 0:r.isKLModel,y=null==this||null===(c=this.easyTop)||void 0===c?void 0:c.isHunYuan,C=(null==this||null===(d=this.easyTop)||void 0===d?void 0:d.isTongYiFast)||(null==this||null===(v=this.easyTop)||void 0===v?void 0:v.isTongYiProfessional);return m||h||f||_||y||C},showIpMaintain:function(){var e,t,n,o,l,r,c,d,v,m=null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isCommunityFlux,h=!(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&null!==(t=t.currentConfigInfo)&&void 0!==t&&null!==(t=t.lora_models)&&void 0!==t&&t.length),f=!(null!=this&&null!==(n=this.easyTop)&&void 0!==n&&null!==(n=n.currentConfigInfo)&&void 0!==n&&null!==(n=n.styleReferenceList)&&void 0!==n&&n.length),_=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&null!==(o=o.currentConfigInfo)&&void 0!==o&&null!==(o=o.controlnet_units)&&void 0!==o&&o.length),y=!(null!=this&&null!==(l=this.easyTop)&&void 0!==l&&l.isMiniMax),C=!(null!=this&&null!==(r=this.easyTop)&&void 0!==r&&r.isHunYuan),w=!(null!=this&&null!==(c=this.easyTop)&&void 0!==c&&c.isKLModel),k=!(null!=this&&null!==(d=this.easyTop)&&void 0!==d&&d.isTongYiFast||null!=this&&null!==(v=this.easyTop)&&void 0!==v&&v.isTongYiProfessional);return m&&h&&f&&_&&y&&C&&w&&k},taskModules:function(){var e;return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isSDXLModel?this.v2_sd_xl_ctr_units:this.v2_ctr_units},renderControlNetList:function(){var e,t=["canny","reference_only"];return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux&&(t=["canny"]),(this.taskModules||[]).filter((function(e){return t.includes(null==e?void 0:e.type)}))},isHideControlNet:function(){var e,t,n,o,r,c,d,v,m,h,f,_=(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isCommunityFlux)&&((null==this||null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t||null===(t=t.styleReferenceList)||void 0===t?void 0:t.length)||!l.ENABLE_FLUX_STYLE_REFERENCE),y=null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isSd35Model,C=(null==this||null===(o=this.easyTop)||void 0===o?void 0:o.isCommunityFlux)&&(null==this||null===(r=this.easyTop)||void 0===r||null===(r=r.currentConfigInfo)||void 0===r||null===(r=r.imageToImageList)||void 0===r?void 0:r.length)||(null==this||null===(c=this.easyTop)||void 0===c?void 0:c.hasIpMaintain),w=null==this||null===(d=this.easyTop)||void 0===d?void 0:d.isMiniMax,k=null==this||null===(v=this.easyTop)||void 0===v?void 0:v.isHunYuan,I=null==this||null===(m=this.easyTop)||void 0===m?void 0:m.isKLModel,x=(null==this||null===(h=this.easyTop)||void 0===h?void 0:h.isTongYiFast)||(null==this||null===(f=this.easyTop)||void 0===f?void 0:f.isTongYiProfessional);return _||y||C||w||k||I||x},isAnimeEnhanceEnable:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isAnimeEnhanceEnable},showStyleReference:function(){var e,t,n,o,r,c,d,v,m,h=!(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&null!==(e=e.currentConfigInfo)&&void 0!==e&&null!==(e=e.imageToImageList)&&void 0!==e&&e.length),f=!(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&t.hasIpMaintain),_=null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isCommunityFlux,y=!(null!=this&&null!==(o=this.easyTop)&&void 0!==o&&null!==(o=o.currentConfigInfo)&&void 0!==o&&null!==(o=o.controlnet_units)&&void 0!==o&&o.length),C=l.ENABLE_FLUX_STYLE_REFERENCE,w=!(null!=this&&null!==(r=this.easyTop)&&void 0!==r&&r.isMiniMax),k=!(null!=this&&null!==(c=this.easyTop)&&void 0!==c&&c.isKLModel),I=!(null!=this&&null!==(d=this.easyTop)&&void 0!==d&&d.isHunYuan),x=!(null!=this&&null!==(v=this.easyTop)&&void 0!==v&&v.isTongYiFast||null!=this&&null!==(m=this.easyTop)&&void 0!==m&&m.isTongYiProfessional);return h&&f&&_&&y&&C&&w&&k&&I&&x},showImageToVideo:function(){var e,t,n,o,l,r=null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isMiniMax,c=null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isHunYuan,d=null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isKLModel,v=(null==this||null===(o=this.easyTop)||void 0===o?void 0:o.isTongYiFast)||(null==this||null===(l=this.easyTop)||void 0===l?void 0:l.isTongYiProfessional);return r||c||d||v},showImageToLive2D:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isMiniMax}}),methods:{onClose:function(){this.visible=!1},handlePopupShow:function(){this.$emit("show")},handlePopupHide:function(){this.$emit("hide")},logOperation:function(e){var t={imageToImage:"click_image_to_image_tab",controlNet:"click_controlnet_tab",IpMaintain:"click_character_reference",imageEditing:"click_smart_image_modification"};t[e]&&this.$logEvent("log_actions",{operation:t[e],behavior_info:"on_new_create_flow_page"})},openModal:function(e,t){var n,o;if(this.logOperation(e),this.isLoggedIn||this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),this.isAnimeEnhanceEnable&&["controlNet","imageToImage"].includes(e))this.$message.warning(this.$t("newGenerate20"));else{var l=null;"controlNet"===e&&((l={}).model=(null==t?void 0:t.default_model)||"None",l.module=(null==t?void 0:t.default_module)||"none",l.type=t.type),"controlNet"===e&&this.isHideControlNet||("controlNet"===e&&null!=this&&null!==(n=this.easyTop)&&void 0!==n&&n.isCommunityFlux&&null!=this&&null!==(o=this.easyTop)&&void 0!==o&&null!==(o=o.currentConfigInfo)&&void 0!==o&&null!==(o=o.controlnet_units)&&void 0!==o&&o.length?this.$message(this.$t("newGenerate81")):("IpMaintain"!==e||this.showIpMaintain)&&("styleReference"!==e||this.showStyleReference)&&("imageToVideo"===e&&!this.showImageToVideo||"imageToLive2D"===e&&!this.showImageToLive2D||this.$emit("openUploadImage",{type:e,controlNetInfo:l,checkFace:"IpMaintain"===e})))}},handleSelect:function(e){this.$emit("openUploadImage",{type:"controlNet",controlNetInfo:e})},handleOpenPickControlNet:function(){if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});this.isAnimeEnhanceEnable?this.$message.warning(this.$t("newGenerate20")):this.isHideControlNet||this.$refs.selectControlNetModal.show()}}},h=(n(4312),n(0)),component=Object(h.a)(m,(function(){var e,t,n=this,o=n._self._c;return o("el-popover",{ref:"topBarPopover",staticClass:"image-and-control-net-popup-wrapper",attrs:{title:"",trigger:"click","popper-class":"image-and-control-net-popup","append-to-body":!0,"visible-arrow":!1,placement:"bottom-start"},on:{show:n.handlePopupShow,hide:n.handlePopupHide},scopedSlots:n._u([{key:"reference",fn:function(){return[n._t("default")]},proxy:!0}],null,!0),model:{value:n.visible,callback:function(e){n.visible=e},expression:"visible"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isHideImageToImage,expression:"!isHideImageToImage"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("imageEditing")}}},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("SmartImageEditing")))]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/static/upload/20250425/30ddef90-0344-433e-8d93-8cc08f625143.png"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/static/upload/20250425/0870f3cc-8fca-47cc-a97c-7acda8694c29.png"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("SmartImageEditingTempDesc")}},[n._v("\n        "+n._s(n.$t("SmartImageEditingTempDesc"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isHideImageToImage,expression:"!isHideImageToImage"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("imageToImage")}}},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("TaskUploadImage")))]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/static/upload/20240919/f4c390e3-8622-4a9b-a9c6-dd6a72866ac6.jpeg"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/static/upload/20240919/53cc0e90-573b-4e5e-a952-d56f5a87ff66.jpeg"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("newGenerate19")}},[n._v("\n        "+n._s(n.$t("newGenerate19"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showIpMaintain,expression:"showIpMaintain"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("IpMaintain")}}},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("studio46")))]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/20241111/357f66fe-6dcb-46fd-b9d8-7b65b4c81cf4_high.webp"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:"https://".concat(n.cdnHostFun(),"/20241111/ce6bee26-a8ff-4241-9775-f45c476e6674_high.webp"),alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("studio47")}},[n._v("\n        "+n._s(n.$t("studio47"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showStyleReference,expression:"showStyleReference"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("styleReference")}}},[o("div",{staticClass:"image-card-item-title"},[o("span",{staticClass:"image-card-item-title-text"},[n._v(n._s(n.$t("newGenerate79")))]),n._v(" "),null!==(e=n.easyTop)&&void 0!==e&&null!==(e=e.currentConfigInfo)&&void 0!==e&&null!==(e=e.styleReferenceList)&&void 0!==e&&e.length?o("span",{staticClass:"image-counter"},[n._v("\n        （"+n._s(null===(t=n.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t||null===(t=t.styleReferenceList)||void 0===t?void 0:t.length)+"/"+n._s(4)+"）\n      ")]):n._e()]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[n.styleReferenceCover[0]?o("img",{attrs:{src:n.styleReferenceCover[0],alt:""}}):n._e()]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[n.styleReferenceCover[1]?o("img",{attrs:{src:n.styleReferenceCover[1],alt:""}}):n._e()]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("newGenerate82")}},[n._v("\n        "+n._s(n.$t("newGenerate82"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showImageToVideo,expression:"showImageToVideo"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("imageToVideo")}}},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("ImageToVideo")))]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:n.imageToVideoCover[0],alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:n.imageToVideoCover[1],alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("newGenerate119")}},[n._v("\n        "+n._s(n.$t("newGenerate119"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showImageToLive2D,expression:"showImageToLive2D"}],staticClass:"image-card-item",on:{click:function(e){return e.stopPropagation(),n.openModal("imageToLive2D")}}},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("newGenerate122")))]),n._v(" "),o("div",{staticClass:"image-card-item-content"},[o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:n.imageToLive2DCover[0],alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-img"},[o("img",{attrs:{src:n.imageToLive2DCover[1],alt:""}})]),n._v(" "),o("div",{staticClass:"image-card-item-content-text",attrs:{title:n.$t("newGenerate120")}},[n._v("\n        "+n._s(n.$t("newGenerate120"))+"\n      ")])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isHideControlNet,expression:"!isHideControlNet"}],staticClass:"image-card-item"},[o("div",{staticClass:"image-card-item-title"},[n._v(n._s(n.$t("ConditionToImg")))]),n._v(" "),n._l(n.renderControlNetList,(function(e,t){return[o("div",{key:"image_card_".concat(null==e?void 0:e.type),staticClass:"elements-card-item-content",on:{click:function(t){return t.stopPropagation(),n.openModal("controlNet",e)}}},[o("div",{staticClass:"elements-card-item-content-img"},[o("img",{attrs:{src:null==e?void 0:e.covers[0],alt:""}})]),n._v(" "),o("div",{staticClass:"elements-card-item-content-img"},[null!=e&&e.covers[1]?o("img",{attrs:{src:null==e?void 0:e.covers[1],alt:""}}):n._e()]),n._v(" "),o("div",{staticClass:"elements-card-item-content-text"},[o("div",{staticClass:"content-text--title"},[n._v(n._s(n.$t(e.type)))]),n._v(" "),o("div",{staticClass:"content-text--subtitle",attrs:{title:n.$t(e.type+"_Tips")}},[n._v("\n            "+n._s(n.$t(e.type+"_Tips"))+"\n          ")])])])]}))],2),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!n.isHideControlNet,expression:"!isHideControlNet"}],staticClass:"tools-popup-view-more-btn",on:{click:n.handleOpenPickControlNet}},[o("span",{staticClass:"tools-popup-view-more-btn-text"},[n._v(n._s(n.$t("viewMore")))]),n._v(" "),o("span",{staticClass:"tools-popup-view-more-btn-icon el-icon-right"})]),n._v(" "),n._v(" "),o("select-control-net-modal",{ref:"selectControlNetModal",on:{confirm:n.handleSelect}})],1)}),[],!1,null,null,null);t.default=component.exports},3290:function(e,t,n){"use strict";n.r(t);n(6),n(32),n(16),n(22),n(65),n(8),n(4),n(28);var o=n(137),l=n(401),r=n(179),c=n(57),d=n(99),v={name:"ImageToImageOptionModal",props:["value","source","menuIndex"],inject:["easyTop"],components:{SliderItem:o.default,generateRedrawModal:l.default,PickOrUploadImageModal:r.default},data:function(){return{visible:!1,rawImgLoading:!0}},computed:{isShowRedraw:function(){var e,t,n,o=!(null!==(e=this.easyTop)&&void 0!==e&&null!==(e=e.currentConfigInfo)&&void 0!==e&&null!==(e=e.controlnet_units)&&void 0!==e&&e.length),l=!(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&null!==(t=t.currentConfigInfo)&&void 0!==t&&null!==(t=t.ipList)&&void 0!==t&&t.length),r="SD 3.5"!==(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.getCurrentModelType);return o&&l&&r},renderOptions:function(){return{min:.01,max:1,step:.05}},getCurrentModelType:function(){var e,t=(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.base_model_type)||"",n=Object(d.getCurrentModelType)(t);return n||"sd"},getCustomSizeOptions:function(){var e,t={min:128,max:1024};return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?{min:384,max:1024}:"sd"===this.getCurrentModelType?t:["sdxl","sd3"].includes(this.getCurrentModelType)?{min:128,max:1536}:t}},watch:{"source.mask":{handler:function(e,t){if(e&&["",null,void 0].includes(t)){this.value.keepDenoisingStrength||this.changeConfig(.7,"denoising_strength");try{var n;if(!/^(http|https):\/\//.test(e))null===(n=this.easyTop)||void 0===n||n.updateConfig({prompt:""},this.menuIndex)}catch(e){}}var o;e&&e!==t&&(null===(o=this.easyTop)||void 0===o||o.updateConfig({ad_model:""},this.menuIndex))},immediate:!0,deep:!0}},methods:{show:function(){this.visible=!0},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},openPickImageModal:function(){this.$refs.pickOrUploadImageModal.openModal([],null)},changeConfig:function(e,t){this.$set(this.source,t,e)},handleOpenRedrawModal:function(){this.$refs.generateRedrawModal.show(this.source.url)},handlePickImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.changeConfig(null===(e=t[0])||void 0===e?void 0:e.url,"url"),this.changeConfig("","mask"),this.changeConfig("","tempMask"),this.changeConfig("","copyMask"),this.handleUpdateImageSize(null!=t&&t.length?t[0]:{})},handleUpdateImageSize:function(){var e,t,n,o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(null==l||null===(e=l.info)||void 0===e?void 0:e.banner)||(null==l?void 0:l.banner)||{},c=r.width,d=r.height;if(c&&d){var v=JSON.parse(JSON.stringify(this.value)),m={};m=this.convertStudioBaseSize(c,d,this.getCustomSizeOptions),v.width=(null===(t=m)||void 0===t?void 0:t.width)||(null==v?void 0:v.width),v.height=(null===(n=m)||void 0===n?void 0:n.height)||(null==v?void 0:v.height),null==this||null===(o=this.easyTop)||void 0===o||o.updateConfig(v,this.menuIndex)}},convertStudioBaseSize:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=([{code:1,label:"2:3",icon:"icon-a-2_3",sd:{standard:{width:512,height:768}},sdxl:{standard:{width:768,height:1152}},flux:{standard:{width:688,height:1024},quality:{width:1024,height:1536}}},{code:2,label:"1:1",icon:"icon-icon-a-1_11",sd:{standard:{width:768,height:768}},sdxl:{standard:{width:1024,height:1024}},flux:{standard:{width:1024,height:1024},quality:{width:1536,height:1536}}},{code:3,label:"9:16",icon:"icon-a-9_161",sd:{standard:{width:432,height:768}},sdxl:{standard:{width:810,height:1440}},flux:{standard:{width:592,height:1024},quality:{width:864,height:1536}}},{code:4,label:"4:3",icon:"icon-a-4_31",sd:{standard:{width:768,height:576}},sdxl:{standard:{width:1024,height:768}},flux:{standard:{width:1024,height:768},quality:{width:1536,height:1152}}},{code:5,label:"custom",icon:"icon-icon-Custom",sd:{},sdxl:{},flux:{}}]||[]).filter((function(e){return 5!==e.code})).map((function(e){return e.width=e.sd.standard.width,e.height=e.sd.standard.height,e})),l={},r=parseFloat((e/t).toFixed(2)),d=o.find((function(e){var t=parseFloat((e.width/e.height).toFixed(2));return r===t})),v=n;if(d){var m=this.getCurrentModelType;["sd","sdxl"].includes(m)&&(l=d[m].standard),["flux"].includes(m)&&(l=d[m].standard)}else{var h=Object(c.resizeToBaseDimension)(e,t,v.max);l.width=h.width,l.height=h.height,l.isCustom=!0}return l},updateImageMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$set(this.source,"mask",e),e||this.$set(this.source,"compose_mask",e)},updateMixedImageMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$set(this.source,"compose_mask",e)},handleDelete:function(){var e;null===(e=this.easyTop)||void 0===e||e.updateConfig({imageToImageList:[]},this.menuIndex),this.handleClose()}}},m=v,h=(n(4318),n(0)),component=Object(h.a)(m,(function(){var e,t,n,o=this,l=o._self._c;return l("el-dialog",{attrs:{visible:o.visible,"custom-class":"image-to-image-option-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(e){o.visible=e}}},[l("div",{staticClass:"modal-content"},[l("div",{staticClass:"modal-content-top"},[l("div",{staticClass:"modal-content-top-left"},[l("span",{staticClass:"modal-content-top-icon",on:{click:o.openPickImageModal}},[l("i",{staticClass:"iconfont icon-a-icon-reselectimg"})])]),o._v(" "),l("div",{staticClass:"modal-content-top-right",on:{click:function(e){return e.stopPropagation(),o.handleDelete()}}},[l("span",{staticClass:"modal-content-top-icon"},[l("i",{staticClass:"el-icon-delete"})])])]),o._v(" "),l("div",{staticClass:"modal-content-strength"},[l("div",{staticClass:"modal-content-strength-text"},[o._v("Strength")]),o._v(" "),l("div",{staticClass:"modal-content-strength-content"},[l("slider-item",{attrs:{"hide-label":!0,value:o.source.denoising_strength,precision:2,min:o.renderOptions.min,max:o.renderOptions.max,step:o.renderOptions.step},on:{change:function(e){return o.changeConfig(e,"denoising_strength")}}})],1)]),o._v(" "),l("div",{staticClass:"modal-content-image-box"},[l("img",{staticClass:"modal-content-image-box-img",attrs:{src:null===(e=o.source)||void 0===e?void 0:e.url,alt:""},on:{load:function(e){o.rawImgLoading=!1},error:function(e){o.rawImgLoading=!1}}}),o._v(" "),null!==(t=o.source)&&void 0!==t&&t.mask?l("img",{staticClass:"redraw-mask-image",attrs:{src:null===(n=o.source)||void 0===n?void 0:n.mask,alt:""}}):o._e(),o._v(" "),o.isShowRedraw?l("span",{staticClass:"modal-content-image-box-icon",on:{click:function(e){return e.stopPropagation(),o.handleOpenRedrawModal.apply(null,arguments)}}},[l("i",{staticClass:"iconfont icon-huabi"})]):o._e()])]),o._v(" "),l("generate-redraw-modal",{ref:"generateRedrawModal",attrs:{needMixedMask:!1,mask:o.source.mask||""},on:{updateMask:o.updateImageMask,updateMixedMask:o.updateMixedImageMask}}),o._v(" "),l("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:o.handlePickImage}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default,GenerateRedrawModal:n(401).default})},3291:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(21),n(394),n(47);var o=n(131),l=n.n(o),r=n(14),c=n(2),d=(n(19),n(6),n(50),n(22),n(31),n(49),n(24),n(11),n(12),n(13),n(8),n(4),n(28),n(43),n(140),n(77),n(7),n(26),n(10)),v=n(98),m=n(35),h=n.n(m),f=n(58),_=n(1),y=n(39),C=n(45),w=n(63),k=n(372),I=n(27),x=n(207),T=n(138),S=n(53);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={name:"waterFall",mixins:[C.a],components:{CollectPopover:w.default,listCheckbox:x.default,modelPayNum:T.default,BaseAvatar:S.default},props:{showNs:Boolean,currentTab:{type:String,default:""},list:{type:Array,default:function(){return[]}},containerForImg:{type:Object,default:null},container:{type:String,require:!0},gap:{type:Number,default:16},lazy:{type:Boolean,default:!1},type:{type:String,default:""},actived:{type:Boolean,default:!0},cols:{type:Number,default:7},fromPage:{type:String,default:""},isFromRelated:{type:Boolean,default:!1},isShowNullRelatedImg:{type:Boolean,default:!1},alreadyNoMoreData:{type:Boolean,default:!1},noSearchData:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},dislikeShow:{type:Boolean,default:!1},hidethumbup:{type:Boolean,default:!1},hidecollect:{type:Boolean,default:!1},hoverShow:{type:Boolean,default:!1},imgQuality:{type:String,default:"low"},isTiemRow:{type:Boolean,default:!1},openWin:{type:Boolean,default:!1},checkMax:{type:Number,default:-1},category:{type:Boolean,default:!1},dotReportInfo:{type:Object,default:function(){return{category:"default",view_domain:"",batch_id:""}}},scrollContainerClassName:{type:String,default:""},scrollContentTop:{type:Number,default:0},selectList:{type:Array,default:function(){return[]}}},data:function(){var e=this;return{formatNumberForeign:d.p,copyTextToClipboard:d.g,saveImg:d.M,width:0,heights:[],dataList:[],resizeListener:Object(v.a)((function(){return e.resize(e.dataList)}),500),selfCols:4,isCollecting:!1,imagePopoverVisible:!1,reportLoading:!1,openWatch:!0,isDelete:!1,sharevisible:!1,popTime:0,itemShow:!1,itemShowId:"",checkList:{ids:[],collectIds:[],folderNos:[],url:[],info:[]},isCheckAll:!1,scrollTop:0,lastTime:null,appeaData:{obj_no:"",obj_type:1,remark:""},appealShow:!1,collectDotReportInfo:{}}},watch:{appealShow:{handler:function(e){e||(this.appeaData={obj_no:"",obj_type:1,remark:""})}},isCheck:{handler:function(e){this.isCheckAll=!1,this.dataList.forEach((function(e){e.isCheck=!1})),this.checkList={ids:[],collectIds:[],folderNos:[],url:[],info:[]},this.$emit("getChecList",this.checkList)}},list:{handler:function(e,t){this.updateList(e,t)}},WaterFallDeleteLits:{handler:function(e){this.isDelete=!0}},scrollContentTop:{handler:function(e){this.scrollTop=this.scrollContentTop||0},immediate:!0,deep:!0}},computed:P(P(P({},Object(_.c)("user",["isLoggedIn","accountSettingsData"])),Object(_.e)("user",["userInfo","adminOff"])),{},{greenMode:function(){var e;return 2!==(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.green_mode)},enableGreenMode:function(){return this.greenMode&&!["/personal"].includes(this.$route.path)},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)},isShowNsfw:function(){return function(e){return this.category&&this.checkIsShowViewNsfw&&!this.enableNsfwMode&&1!==e.nsfw&&(null==e?void 0:e.is_nsfw_plus)}},isPC:function(){return"PC"===localStorage.getItem("visitFrom")},setDeffBoxShow:function(){return function(e){return 2==e.status||5==e.status||((e.author&&e.author.id)!=this.userInfo.id&&"personal"!=this.fromPage?"artwork"==this.type&&1==e.primary:void 0)}},renderList:function(){return this.dynamicList(this.dataList)}}),activated:function(){var e=this;this.openWatch=!0,this.resizeListener(),window.addEventListener("resize",this.resizeListener),this.lazy&&document.addEventListener("scroll",this.lazyLoad),this.$nextTick((function(){window.scrollTo(0,e.scrollTop)}))},deactivated:function(){this.openWatch=!1,window.removeEventListener("resize",this.resizeListener),window.removeEventListener("scroll",this.lazyLoad)},mounted:function(){var e=this;window.addEventListener("resize",this.resizeListener),this.lazy,this.$nextTick((function(){e.checkList.ids=e.selectList.map((function(e){return e.id})),e.checkList.url=e.selectList.map((function(e){return e.url})),(e.list||[]).forEach((function(t){var n;t.isCheck=e.checkList.url.includes(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)})),(e.dataList||[]).forEach((function(t){var n;t.isCheck=e.checkList.url.includes(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)})),e.updateList(e.list)}))},beforeDestroy:function(){window.removeEventListener("resize",this.resizeListener)},methods:P(P({},Object(_.b)("user",["getAccountInfo"])),{},{handleBeforeUpload:function(e){return this.$emit("openCustomUpload","local",e),!1},updateList:function(e,t){var n=this.openWatch,o=this.width;if(n){o&&0!=o||(this.width=this.getWidth());var l=h()(e);if(this.dataList.length<100)this.updateDataList(l,!1);else if(l.length>this.dataList.length){var c=Object(r.a)(l.slice(this.dataList.length));this.updateDataList(c,!0)}else l.length<=this.dataList.length&&(this.dataList=[],this.updateDataList(l,!1))}},refreshCheck:function(){var e=this;this.$nextTick((function(){e.checkList.ids=e.selectList.map((function(e){return null==e?void 0:e.id})),e.checkList.url=e.selectList.map((function(e){return null==e?void 0:e.url})),(e.list||[]).forEach((function(t){var n;t.isCheck=e.checkList.url.includes(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)})),(e.dataList||[]).forEach((function(t){var n;t.isCheck=e.checkList.url.includes(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)})),e.updateList(e.list)}))},goToDetail:function(e){e.name?window.open("/models/detail/".concat(e.id),"_blank"):window.open("/explore/detail/".concat(e.id),"_blank")},goToPersonal:function(e){var t;if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});var n=e.author.id,o=null===(t=this.userInfo)||void 0===t?void 0:t.id,path="/user/"+encodeURIComponent(n);o==n&&(path="/personal"),window.open(path,"_blank")},dynamicList:function(e){var t=this.containerForImg||this.$parent.$refs[this.container]||document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0];if(!t)return e;var n=this.scrollTop-t.offsetTop;return e.filter((function(e){return n-e.top<1500&&e.top-n<2e3}))},getItemTime:function(e){var t=new Date(e),n=t.getFullYear(),o=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(n,"-").concat(o)},processTimeGroups:function(e){for(var i=0;i<e.length;i++){var t,n,o,l,r=e[i];if(null!=r&&null!==(t=r.folder_no)&&void 0!==t&&t.collect_at)if(this.getItemTime(null==r||null===(n=r.folder_no)||void 0===n?void 0:n.collect_at)!==this.lastTime)e.splice(i,0,{timeItem:this.getItemTime(null==r||null===(o=r.folder_no)||void 0===o?void 0:o.collect_at)}),this.lastTime=this.getItemTime(null==r||null===(l=r.folder_no)||void 0===l?void 0:l.collect_at)}return e},updateDataList:function(e,t){var n=this,o=this.dataList,l=this.isCheckAll,r=this.checkList,c=this.WaterFallDeleteLits,d=this.width;e.forEach((function(e){o.forEach((function(t){e.id==t.id&&(e.collect=t.collect,e.isCheck=t.isCheck,e.liked=t.liked)}))}));var v,m,h=e.filter((function(e){return!c.includes(e.id)}));this.isTiemRow&&(t||(this.lastTime=null),this.processTimeGroups(h));for(var i=0;i<h.length;i++){var _=h[i];if(_.timeItem)_.waterWidth=d,_.waterHeight=30;else{var y,C,w,k,I;if(this.$set(_,"hoverd",!1),this.$set(_,"propS",!1),this.$set(_,"rowIndex",-1),!l&&r.ids.includes(_.id)?this.$set(_,"isCheck",r.ids.includes(_.id)):this.$set(_,"isCheck",!!l),l&&!r.ids.includes(_.id))r.ids.push(_.id),null!=_&&null!==(w=_.collect)&&void 0!==w&&w.id&&r.collectIds.push(_.collect.id),null!=_&&null!==(k=_.folder_no)&&void 0!==k&&k.id&&r.folderNos.push(_.folder_no.id),null!=_&&null!==(I=_.banner)&&void 0!==I&&I.url&&r.url.push(_.banner.url),_&&r.info.push(_);_.timeDiff=Object(f.d)(_.created_at,Date.now()),_.waterWidth=d,this.isTiemRow||"gallery"===this.type?_.waterHeight=d:(v=_.banner&&_.banner.width?_.banner.width:308,m=_.banner&&_.banner.height?_.banner.height:308,_.waterHeight=parseInt(m*d/v),isNaN(_.waterHeight)&&(_.waterHeight=320)),null==_||null===(y=_.banner)||void 0===y||!y.url||null!==(C=_.banner)&&void 0!==C&&C.replaceUrl||(_.banner.replaceUrl=_.banner.url),_.errorTime=0}}t?h.forEach((function(e){n.dataList.push(e)})):this.dataList=h,this.waterfall()},checkAll:function(){var e=this;if(this.isCheck){var t=this.dataList.filter((function(e){return!e.timeItem}));this.checkList.ids.length<t.length?(t.forEach((function(t){t.isCheck=!0,e.checkChange(t)})),this.isCheckAll=!0):(t.forEach((function(t){t.isCheck=!1,e.checkChange(t)})),this.isCheckAll=!1)}},clearCheck:function(e){var t=this;e.forEach((function(e){t.dataList.forEach((function(t){e==t.id&&(t.isCheck=!1)})),t.checkList.ids.forEach((function(n,o){e!==n&&e.id!==n||(t.checkList.ids.splice(o,1),t.checkList.collectIds.splice(o,1),t.checkList.folderNos.splice(o,1),t.checkList.url.splice(o,1),t.checkList.info.splice(o,1))}))})),this.$emit("getChecList",this.checkList)},checkChange:function(e){if(e.isCheck){var t,n,o;if(!this.checkList.ids.includes(e.id))this.checkList.ids.push(e.id),null!=e&&null!==(t=e.collect)&&void 0!==t&&t.id&&this.checkList.collectIds.push(e.collect.id),null!=e&&null!==(n=e.folder_no)&&void 0!==n&&n.id&&this.checkList.folderNos.push(e.folder_no.id),null!=e&&null!==(o=e.banner)&&void 0!==o&&o.url&&this.checkList.url.push(e.banner.url),e&&this.checkList.info.push(e)}else{var l,r,c;if(-1==this.checkList.ids.indexOf(e.id))return;if(this.checkList.ids.splice(this.checkList.ids.indexOf(e.id),1),null!=e&&null!==(l=e.collect)&&void 0!==l&&l.id&&this.checkList.collectIds.splice(this.checkList.collectIds.indexOf(e.collect.id),1),null!=e&&null!==(r=e.folder_no)&&void 0!==r&&r.id&&this.checkList.folderNos.splice(this.checkList.folderNos.indexOf(e.folder_no.id),1),null!=e&&null!==(c=e.banner)&&void 0!==c&&c.url&&this.checkList.url.splice(this.checkList.url.indexOf(e.banner.url),1),e){var d=this.checkList.info.findIndex((function(t){return t.id===e.id}));this.checkList.info.splice(d,1)}}this.$emit("getChecList",this.checkList)},changeItemShow:function(e){this.itemShow=e.show,this.itemShowId=e.id,this.handleCollectPopoverClick(e)},moreActions:function(e,t){var n=this;switch(e){case"flag":this.reportArtwork(t.id);break;case"save":this.downloadImg(t);break;case"share":this.sharevisible=!0,this.popTime=setTimeout((function(){n.sharevisible=!1}),1e3);var o="".concat(window.location.origin,"/")+"explore/detail/".concat(t.id);this.$message.success(this.$t("CopiedURLToClipboard")),this.copyTextToClipboard(o);break;case"delete":this.handleWorkDelete(t);break;case"not_interested":Object(y.i)({items:[{action:"not_interested",obj_no:t.id,obj_type:1}]}).then((function(e){var o,l;1e4==(null==e||null===(o=e.status)||void 0===o?void 0:o.code)?(n.$message({message:n.$t("reduceWork"),type:"success"}),t.propS=!1,n.setWaterFallDeleteLits(t.id),n.resizeListener()):n.$message({message:(null==e||null===(l=e.status)||void 0===l?void 0:l.msg)||n.$t("ServerError"),type:"error"})}));break;case"setBg":Object(I.y)({id:t.id}).then((function(e){var o;if(1e4==(null==e||null===(o=e.status)||void 0===o?void 0:o.code))n.$message({message:n.$t("SetSuccess"),type:"success"}),t.propS=!1,n.getAccountInfo();else{var l,r,c=n.$t("ServerError");if(20309==(null==e||null===(l=e.status)||void 0===l?void 0:l.code))c=n.$t("SetBgLimit");else c=null==e||null===(r=e.status)||void 0===r?void 0:r.msg;n.$message({message:c,type:"error"})}}));break;case"appeal":this.appeaData.obj_no=t.id,this.appealShow=!0}},downloadImg:function(e){var t=this.getImageExtensionFromUrl(e.banner.url),n=(e.author?e.id:"image")+"".concat(t);this.saveImg(e.banner.url,n)},getImageExtensionFromUrl:function(e){var t=e.match(/\/([^/]+)$/);return t&&t[1].includes(".")?"."+t[1].split(".").pop().toLowerCase():".jpeg"},handleWorkDelete:function(e){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var n={id:e.id};t.globalLoading=!0,Object(k.a)(n).then((function(n){var o,l;1e4==(null==n||null===(o=n.status)||void 0===o?void 0:o.code)?(t.$message({message:t.$t("deleteSuccess"),type:"success"}),t.setWaterFallDeleteLits(e.id),t.resizeListener()):t.$message({message:(null==n||null===(l=n.status)||void 0===l?void 0:l.msg)||t.$t("ServerError"),type:"error"})})).finally((function(){t.globalLoading=!1}))})).catch((function(e){}))},handleContextMenu:function(e,t){1===t.nsfw&&e.preventDefault()},reportArtwork:function(e){var t=this;this.reportLoading||(this.reportLoading=!0,Object(y.r)({id:e}).then((function(e){var code=e&&e.status?e.status.code:"";[1e4].includes(code)&&l()({message:t.$t("ReportSuccess"),type:"success",duration:5e3})})).finally((function(){t.reportLoading=!1})))},handleClick:function(e,t,n){if(!this.isLoggedIn&&6!==e.type)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});var o=this.list.findIndex((function(i){return i.id===e.id})),l=(o<10?this.list.slice(0,o):this.list.slice(o-10,o)).map((function(e){return e.id})).filter((function(e){return"banner"!=e&&"ai_tool"!=e}));switch(t){case"创作":Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:l,action:"task",obj_no:e.id,obj_type:1})]});var r=Object.assign({},e);"model"===this.type&&["explore","personal"].includes(this.fromPage)&&(r.taskSource=1),this.$EventBus.$emit("openGenerate",{action:1,data:{source:r}});break;case"收藏":Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:l,action:"collection",obj_no:e.id,obj_type:1})]}),this.setCollect(e,n)}},handleCollectPopoverClick:function(e){var t=this.list.findIndex((function(i){return i.id===e.id})),n=(t<10?this.list.slice(0,t):this.list.slice(t-10,t)).map((function(e){return e.id})).filter((function(e){return"banner"!=e&&"ai_tool"!=e}));this.collectDotReportInfo=P(P({},this.dotReportInfo),{},{negative_ids:n,action:"collection",obj_no:e.id,obj_type:1})},handleLinkUpload:function(e,t){if("upload"===(null==t?void 0:t.customType))return this.$emit("openLinkUpload","link"),!1},handleDelete:function(e){this.$emit("deleteUploadImage",e)},handleChange:function(){},handleDetail:function(e,t){var n=this;if("upload"===(null==t?void 0:t.customType))return!1;if(null!=t&&t.uploading)return!1;if(this.isCheck){if(-1==this.checkMax||this.checkList.ids.length<this.checkMax)this.checkList.ids.length==this.dataList.length&&(this.isCheckAll=!0),t.isCheck&&(this.isCheckAll=!1),t.isCheck=!t.isCheck;else if(t.isCheck)this.checkList.ids.length==this.dataList.length&&(this.isCheckAll=!0),t.isCheck&&(this.isCheckAll=!1),t.isCheck=!t.isCheck;else{var o;if(1===this.checkMax)return((null===(o=this.checkList)||void 0===o?void 0:o.ids[0])||"")&&this.dataList.forEach((function(e){n.$set(e,"isCheck",!1)})),void(t.isCheck=!t.isCheck);this.$message({message:this.$t("已超过最大选择上限"),type:"warning"})}return!1}if(this.$logEvent("log_actions",{operation:{artwork:"click_image",model:"click_model",gallery:"click_gallery"}[this.type],behavior_info:t.id}),"activity"!==this.type)if("IMG"!==e.target.tagName&&"cltpop"!==e.target.className&&"img-content"!==e.target.className&&"statusZg"!==e.target.className&&"workInfo"!==e.target.className||"model"!==this.type)if("IMG"!==e.target.tagName&&"cltpop"!==e.target.className&&"img-content"!==e.target.className&&"statusZg"!==e.target.className&&"workInfo"!==e.target.className&&"green-mode-div"!==e.target.className||"artwork"!==this.type)"IMG"!==e.target.tagName&&"img-content"!==e.target.className&&"statusZg"!==e.target.className&&"workInfo"!==e.target.className||"gallery"!==this.type||(Object(y.i)({items:[{action:"view",obj_no:t.id,obj_type:4}]}),this.$router.push("/artWorkDetail/"+t.id));else{if(this.checkGreen(t))return this.$EventBus.$emit("openLoginDialog",{redirect:"/explore/detail/"+t.id,dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});var l=this.list.findIndex((function(i){return i.id===t.id})),r=(l<10?this.list.slice(0,l):this.list.slice(l-10,l)).map((function(e){return e.id})).filter((function(e){return"banner"!=e&&"ai_tool"!=e}));Object(y.i)({items:[P(P({},this.dotReportInfo),{},{negative_ids:r,action:"view",obj_no:t.id,obj_type:1})]}),this.openWin?window.open("/explore/detail/"+t.id,"_blank"):this.$router.push("/explore/detail/"+t.id)}else 3==t.status||4==t.status?this.$router.push({path:"/models/detail/".concat(t.id),query:{type:"other"}}):this.$router.push("/models/detail/".concat(t.id))},imgError:function(e){e.errorTime++,e.errorTime>=2||(this.$refs[e.id][0].src=e.banner.url)},waterfall:function(){var e=this;try{this.heights=[];for(var t=function(){var t=e.dataList[i],n=t.waterHeight,o="artwork"==e.type?0:70;if(t.timeItem){t.left=0;var l=e.getMaxIndex(e.heights);t.top=l>-1?e.heights[l]+e.gap:0,e.heights.forEach((function(l,r){e.heights[r]=t.top+n+o}))}else if(e.heights.length<e.selfCols)if(e.dataList[i-1]&&e.dataList[i-1].timeItem)if(t.left=0,t.top=e.dataList[i-1].top+e.dataList[i-1].waterHeight+e.gap,e.heights[0]){var r=e.heights[0]+n;e.heights=[r+e.gap]}else e.heights.push(t.top+n+o);else t.top=e.dataList[i-1]?e.dataList[i-1].top:0,t.left=e.heights.length*(e.width+e.gap),e.heights.push(t.top+n+o);else{var c=e.getMinIndex(e.heights),d=e.heights[c]+e.gap;t.top=d,t.left=c*(e.width+e.gap),e.heights[c]=d+n+o}},i=0;i<this.dataList.length;i++)t();this.setWaterFallRect()}catch(e){}},getWidth:function(){var e,t;this.selfCols=this.cols;var n=this.containerForImg?this.containerForImg.offsetWidth:(null===(e=this.$parent.$refs[this.container])||void 0===e?void 0:e.offsetWidth)||(null===(t=document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0])||void 0===t?void 0:t.offsetWidth);n||(n=1236),n<1700&&(this.selfCols=6),n<1500&&(this.selfCols=5),n<1240&&(this.selfCols=5),n<980&&(this.selfCols=4),n<730&&(this.selfCols=4),n<500&&this.isPC&&(this.selfCols=1);var o=~~((n-this.selfCols*this.gap-this.gap+32)/this.selfCols);return this.isPC,o>176?o:176},setWaterFallRect:function(){var e=this.containerForImg||this.$parent.$refs[this.container]||document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0],t=Math.max.apply(null,this.heights);this.list.length&&(e.style.height=t+"px",e.style.marginBottom="130px")},getMinIndex:function(e){var t=Math.min.apply(null,e);return e.indexOf(t)},getMaxIndex:function(e){var t=Math.max.apply(null,e);return e.indexOf(t)},resize:function(e){var t=this;if(this.openWatch){var n,o;if(this.containerForImg){if(this.containerForImg.offsetWidth<600)return}else if((null===(n=this.$parent.$refs[this.container])||void 0===n?void 0:n.offsetWidth)<600||(null===(o=document.querySelectorAll(".".concat(this.scrollContainerClassName,">.").concat(this.container))[0])||void 0===o?void 0:o.offsetWidth)<600)return;this.dataList=h()(e).filter((function(e){return!t.WaterFallDeleteLits.includes(e.id)})),this.width=this.getWidth(),this.dataList.forEach((function(e){if(e.timeItem)e.waterWidth=t.width,e.waterHeight=30;else{var n,o;if(t.$set(e,"hoverd",!1),e.timeDiff=Object(f.d)(e.created_at,Date.now()),e.waterWidth=t.width,t.isTiemRow||"gallery"===t.type)e.waterHeight=t.width;else null!=e&&null!==(o=e.banner)&&void 0!==o&&o.width&&(e.waterHeight=parseInt(t.width/(e.banner.width/e.banner.height))),isNaN(e.waterHeight)&&(e.waterHeight=320);null!=e&&null!==(n=e.banner)&&void 0!==n&&n.replaceUrl&&(e.banner.replaceUrl=e.banner.url),e.errorTime=0}})),this.waterfall()}},lazyLoad:function(){this.actived&&this.openWatch},otherUser:function(e,t){var path=t?"/user/"+encodeURIComponent(e.author.id)+"?type=gather":"/user/"+encodeURIComponent(e.author.id);this.userInfo.id==e.author.id&&(path="/personal?tab=gather"),this.openWin?window.open(path,"_blank"):this.$router.push(path)},getPersonalInfoUrl:function(e){var path="/user/"+encodeURIComponent(e.author.id);return this.userInfo.id==e.author.id&&(path="/personal"),path},checkGreen:function(e){return!this.isLoggedIn&&!(null==e||!e.green||![2,"2"].includes(e.green))}})},L=(n(4314),n(4315),n(0)),component=Object(L.a)(M,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"waterfall-container"},[e._l(e.renderList,(function(n,o){var l,r,c,d,v,m;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:null==n?void 0:n.uploading,expression:"item?.uploading"}],key:n.top+","+n.left,staticClass:"waterfall-item",class:{"waterfall-dialog":e.containerForImg},style:{top:n.top+"px",left:n.left+"px"},on:{click:function(t){return t.stopPropagation(),e.handleDetail(t,n)},contextmenu:function(t){return e.handleContextMenu(t,n)}}},["upload"===(null==n?void 0:n.customType)?t("span",{staticClass:"custom-upload-by-link",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleLinkUpload(t,n)}}},[e._v(e._s(e.$t("TaskUploadImageFromUrl")))]):e._e(),e._v(" "),"upload"===(null==n?void 0:n.customType)?t("span",{staticClass:"custom-upload-icon iconfont icon-icon_Upload"}):e._e(),e._v(" "),"upload"!==(null==n?void 0:n.customType)&&"upload"===e.currentTab?t("span",{staticClass:"custom-upload-delete-btn",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleDelete(n)}}},[t("i",{staticClass:"iconfont icon-postDelete"})]):e._e(),e._v(" "),e.setDeffBoxShow(n)?t("div",{staticClass:"deffBox",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[t("div",[e._v(e._s(e.$t("PictureInvalid")))]),e._v(" "),t("div",[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" "),t("span",[e._v(e._s(e.$t("PictureHidden")))])]),e._v(" "),e.isCheck&&n?t("listCheckbox",{on:{change:function(t){return e.checkChange(n)}},model:{value:n.isCheck,callback:function(t){e.$set(n,"isCheck",t)},expression:"item.isCheck"}}):e._e()],1):n.timeItem?t("div",{staticClass:"timeRow",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},[e._v("\n      "+e._s(n.timeItem)+"\n    ")]):t("div",{staticClass:"listCnt marking-item",class:[1===n.banner.nsfw||e.isShowNsfw(n.banner)?"bg-nsfw":""]},[[2,"2"].includes(n.green)&&e.enableGreenMode?t("div",{staticClass:"green-mode-div",staticStyle:{"backdrop-filter":"blur(19px) saturate(160%)",position:"absolute",left:"0",top:"0"},style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}}):e._e(),e._v(" "),t("div",{staticClass:"img-content",style:{width:n.waterWidth+"px",height:n.waterHeight+"px"}},["upload"===(null==n?void 0:n.customType)?t("el-upload",{ref:"imageUpload3",refInFor:!0,staticClass:"custom-image-upload",attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,"on-change":e.handleChange,accept:".jpg,.png,.jpeg,.webp",multiple:"",limit:1,"http-request":function(){},"show-file-list":!1}},[t("i",{staticClass:"iconfont icon-icon_Upload image-upload-icon",staticStyle:{display:"none"},attrs:{slot:"trigger"},slot:"trigger"})]):e._e(),e._v(" "),"upload"!==(null==n?void 0:n.customType)&&6==n.type&&1!=n.banner.nsfw?t("video",{ref:"mainVideo",refInFor:!0,staticClass:"cntVideo",attrs:{src:null===(l=n.banner)||void 0===l?void 0:l.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):"upload"!==(null==n?void 0:n.customType)&&1!=n.banner.nsfw?t("el-image",{staticClass:"cntImg",style:{transform:n.isCheck?"scale(0.85)":null,filter:e.showNs||(e.category?!(null!=n&&null!==(r=n.banner)&&void 0!==r&&r.is_nsfw_plus&&null!==(c=e.userInfo)&&void 0!==c&&c.enable_nsfw_plus&&[2,"2"].includes(null===(d=e.userInfo)||void 0===d||null===(d=d.settings)||void 0===d?void 0:d.nsfw_plus)):null==n||null===(v=n.banner)||void 0===v||!v.is_nsfw_plus)?"":"blur(19px) saturate(160%)"},attrs:{src:null===(m=n.banner)||void 0===m?void 0:m.replaceUrl,fit:"cover",lazy:""}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])]):e._e()],1),e._v(" "),3==n.status||4==n.status?t("div",{staticClass:"statusCnt"},[t("div",{staticClass:"statusZg"}),e._v(" "),t("div",{staticClass:"statusBox",style:{color:4==n.status?"#EF3B3B":"#ffffff"}},[t("i",{staticClass:"iconfont icon-statusBox"}),e._v(" "),t("div",[e._v(e._s(4==n.status?e.$t("notApproved"):e.$t("underReview")))])])]):e._e(),e._v(" "),e.isCheck&&n?t("listCheckbox",{on:{change:function(t){return e.checkChange(n)}},model:{value:n.isCheck,callback:function(t){e.$set(n,"isCheck",t)},expression:"item.isCheck"}}):t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"shade"},[t("p",[e._v(e._s(e.$t("NotPass"))+" "+e._s(e.$t("Auditing")))])]),e._v(" "),("artwork"==e.type?3!=n.type:1==n.status&&"gallery"!==e.type&&"activity"!==e.type)?t("div",{staticClass:"waterfall-hover-try",class:{"prompt-show":!e.isLoggedIn},on:{click:function(t){return t.preventDefault(),e.handleClick(n,"创作")}}},[e._v("\n          "+e._s("artwork"==e.type?e.$t("Remix"):e.$t("Try"))+"\n        ")]):e._e(),e._v(" "),e.isLoggedIn&&1==n.status&&"gallery"!==e.type&&"activity"!==e.type?t("CollectPopover",{staticClass:"CollectPop",attrs:{type:e.type,folder:n,dotReportInfo:e.collectDotReportInfo,from:"waterfall"},on:{showChaneg:e.changeItemShow}}):e._e(),e._v(" "),e.isLoggedIn&&1==n.status&&"gallery"!==e.type&&"activity"!==e.type?t("div",{staticClass:"cltpop",style:{opacity:e.itemShow&&e.itemShowId==n.id?1:0}}):e._e(),e._v(" "),"artwork"===e.type&&n.waterHeight>200?t("div",[t("div",{staticClass:"waterfall-hover-photo"},[t("div",{staticClass:"hoverTop"},[t("span",[e._v(e._s(n.type&&1!=n.type&&3!=n.type?"/grid":"/upscale"))]),e._v(" "),n?t("div",{staticClass:"moreEdit"},[e.isLoggedIn?[t("el-popover",{key:o,ref:"myPopover",refInFor:!0,attrs:{placement:"top-end","popper-class":"water-fall-popover","append-to-body":!1,"visible-arrow":!1,"popper-options":{boundariesElement:"body"},width:"100",trigger:"click"},model:{value:n.propS,callback:function(t){e.$set(n,"propS",t)},expression:"item.propS"}},[t("div",{staticClass:"pop-btns flex"},[t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("flag",n)}}},[e._v("\n                        "+e._s(e.$t("Report"))+"\n                      ")]),e._v(" "),t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("save",n)}}},[e._v("\n                        "+e._s(e.$t("SaveImage"))+"\n                      ")]),e._v(" "),t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("share",n)}}},[e._v("\n                        "+e._s(e.$t("ShareLink"))+"\n                      ")]),e._v(" "),!e.dislikeShow||n.author&&n.author.id==e.userInfo.id?e._e():t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("not_interested",n)}}},[e._v("\n                        "+e._s(e.$t("dislike"))+"\n                      ")]),e._v(" "),n.author&&n.author.id==e.userInfo.id&&n.banner.a_a?t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("appeal",n)}}},[e._v("\n                        "+e._s(e.$t("appeal"))+"\n                      ")]):e._e(),e._v(" "),n.author&&n.author.id==e.userInfo.id?t("button",{on:{click:function(t){return t.preventDefault(),e.moreActions("delete",n)}}},[e._v("\n                        "+e._s(e.$t("Delete"))+"\n                      ")]):e._e()]),e._v(" "),t("div",{class:{"login-waterFall-btn-icon":e.isLoggedIn,"noLogin-waterFall-collect-icon prompt-show":!e.isLoggedIn},attrs:{slot:"reference"},slot:"reference"},[t("i",{staticClass:"iconfont icon-more"})])])]:e._e()],2):e._e()]),e._v(" "),3!=n.type?t("div",{staticClass:"hoverMiddle"},[e._v("\n              "+e._s(n.prompt)+"\n            ")]):e._e()])]):e._e(),e._v(" "),"model"===e.type&&n.base_model.includes("SDXL")?t("div",{staticClass:"modelPoint"},[e._v("\n          "+e._s((null==n?void 0:n.type)+" | XL ")+"\n        ")]):"model"===e.type?t("div",{staticClass:"modelPoint"},[e._v(e._s(null==n?void 0:n.type))]):e._e()],1),e._v(" "),"activity"===e.type?t("div",{staticClass:"activity",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.goToDetail(n)}}},[n.name?t("div",{staticClass:"top-container"},[t("div",{staticClass:"name"},[e._v(e._s(n.name))])]):e._e(),e._v(" "),t("div",{staticClass:"personal-info"},[t("div",{staticClass:"left-info",style:{width:n.name?"100%":"calc(100% - 68px)"}},[n.author?t("BaseAvatar",{attrs:{"user-data":n.author,size:30},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.goToPersonal(n)}}}):e._e(),e._v(" "),t("span",{staticClass:"ellipsis-text",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.goToPersonal(n)}}},[e._v("\n              "+e._s(n.author.name||n.author.id)+"\n            ")])],1)])]):e._e()],1),e._v(" "),"model"===e.type?t("div",{staticClass:"waterfall-hover-model"},[t("span",{staticClass:"ellipsis-text modelName"},[e._v(e._s(n.name))]),e._v(" "),t("div",{staticClass:"hoverBottom"},[n.author?t("div",{staticClass:"flex-center",staticStyle:{"max-width":"50%"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.otherUser(n)}}},[n.author?t("BaseAvatar",{staticStyle:{"margin-right":"6px"},attrs:{size:30,"user-data":n.author}}):e._e(),e._v(" "),t("span",{staticClass:"ellipsis-text"},[e._v(e._s(n.author.name))])],1):t("div"),e._v(" "),1==n.status?t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}}):e._e()])]):e._e()])})),e._v(" "),e.isShowNullRelatedImg?t("div",{staticClass:"null-data-container"},[t("img",{staticClass:"null-image",attrs:{src:n(500),alt:"null_related_image"},on:{load:function(t){return e.$emit("solveScrollbarStyle")}}}),e._v(" "),t("div",{staticClass:"null-tips"},[e._v(e._s(e.$t("NoRelatedWorks")))])]):e._e(),e._v(" "),e.alreadyNoMoreData?t("div",{staticClass:"at-bottom"},[t("div",{staticClass:"dashed-line"}),e._v(" "),t("div",{staticClass:"tips"},[e._v(e._s(e.$t("NoMoreData")))]),e._v(" "),t("div",{staticClass:"dashed-line"})]):e._e(),e._v(" "),e.noSearchData?t("div",{staticClass:"no-search-data-container"},[t("img",{staticClass:"no-search-image",attrs:{src:n(504),alt:"no search data"}}),e._v(" "),t("div",{staticClass:"null-tips"},[e._v(e._s(e.$t("NoSearchData")))])]):e._e(),e._v(" "),t("el-dialog",{attrs:{title:e.$t("appeal"),visible:e.appealShow,width:"500px","modal-append-to-body":!1,"close-on-click-modal":!1,"custom-class":"SaDialog"},on:{"update:visible":function(t){e.appealShow=t}}},[t("div",{staticClass:"appealCnt"},[t("el-input",{attrs:{type:"textarea",placeholder:e.$t("enterAppealCnt"),maxlength:"50","show-word-limit":""},model:{value:e.appeaData.remark,callback:function(t){e.$set(e.appeaData,"remark",t)},expression:"appeaData.remark"}})],1),e._v(" "),t("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.appealShow=!1}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("el-button",{attrs:{loading:e.isAppealLoading},on:{click:function(t){return e.setResourceAppeal(e.appeaData)}}},[e._v(e._s(e.$t("Submit")))])],1)])],2)}),[],!1,null,"5e9b0f05",null);t.default=component.exports;installComponents(component,{CollectPopover:n(63).default,BaseAvatar:n(53).default})},3292:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(16),n(4),n(28),n(137)),r=n(29),c=n(10),d={name:"LinkUploadModal",props:{value:{type:Object,default:function(){return{}}}},components:{SliderItem:l.default},data:function(){return{visible:!1,uploading:!1,linkInput:"",imageInfo:{url:"",width:0,height:0}}},computed:{},methods:{show:function(){this.initData(),this.visible=!0},initData:function(){},handleClose:function(){this.uploading||(this.visible=!1)},handleConfirm:function(){this.$emit("linkImage",this.imageInfo),this.handleClose(),this.linkInput="",this.uploading=!1},handleLinkUpload:function(){this.checkIsImageURL(this.linkInput)?this.uploadImageByLink(this.linkInput):this.$message.warning(this.$t("InputNotAnImageLink"))},closeLinkUploadModal:function(){this.linkInput="",this.uploading=!1},uploadImageByLink:function(){var e=this,t={url:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};this.uploading||(this.uploading=!0,Object(r.uploadImage)(t,"link").then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(n){var o,code,l,r,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.uploading=!1,o=(n||{data:{}}).status.code,![1e4,"10000"].includes(code=void 0===o?"":o)){t.next=12;break}return l=n.data.access_url,e.imageInfo.url=l,t.next=7,Object(c.x)(l);case 7:r=t.sent,e.imageInfo=Object.assign(e.imageInfo,r||{}),e.handleConfirm(),t.next=14;break;case 12:d=30003===code?"UploadImageExceed5MB":"GainFail",e.$message.error(e.$t(d));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(t){e.uploading=!1})))},checkIsImageURL:function(e){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(e)}}},v=d,m=(n(4316),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"easy-link-upload-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"407px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"modal-header"},[t("div",{staticClass:"modal-header-title"},[e._v(e._s(e.$t("TaskUploadImageFromUrl")))]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-content-item"},[t("div",{staticClass:"modal-content-item-label"},[e._v(e._s(e.$t("Link")))]),e._v(" "),t("div",{staticClass:"modal-content-item-content"},[t("el-input",{attrs:{placeholder:e.$t("Link"),disabled:e.uploading,clearable:""},model:{value:e.linkInput,callback:function(t){e.linkInput=t},expression:"linkInput"}})],1)])]),e._v(" "),t("div",{staticClass:"modal-footer"},[t("span",{staticClass:"modal-footer-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("span",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),e.handleLinkUpload()}}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports},3293:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),l=(n(32),n(4),n(137)),r=n(602),c=n(1),d=n(179);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"ControlNetOptionModal",props:["value","source"],inject:["easyTop"],components:{SliderItem:l.default,SelectControlNetModal:r.default,PickOrUploadImageModal:d.default},data:function(){return{visible:!1,viewMore:!1,controlMode:["Balance","Prompt","Controlnet"]}},computed:m(m({},Object(c.c)("creation",["taskUnits","taskSdxlUnits","lab_ctr_units","v2_sd_xl_ctr_units","v2_ctr_units"])),{},{renderOptions:function(){return{min:.01,max:1,step:.05}},taskModules:function(){var e;return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isSDXLModel?this.v2_sd_xl_ctr_units:this.v2_ctr_units},finder:function(){var e=this;return this.taskModules.find((function(t){var n;return(null===(n=e.source)||void 0===n?void 0:n.type)==t.type}))||{}},isShowStyleFidelity:function(){var e,t;return(null===(e=this.finder)||void 0===e?void 0:e.has_style_fidelity)&&"0"===(null===(t=this.source)||void 0===t?void 0:t.control_mode)},isShowResolution:function(){var e;return(null===(e=this.finder)||void 0===e?void 0:e.has_processor_res)&&this.source.isHandle},control_modules:function(){var e;return null===(e=this.finder)||void 0===e?void 0:e.modules},control_models:function(){var e;return null===(e=this.finder)||void 0===e?void 0:e.models}}),methods:{show:function(){this.visible=!0},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},openPickImageModal:function(){var e;this.$logEvent("log_actions",{operation:"click_hide",behavior_info:"on_new_create_flow_page",behavior_info_sub:null===(e=this.source)||void 0===e?void 0:e.type}),this.$refs.pickOrUploadImageModal.openModal([],null)},handlePickImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.changeConfig(null===(e=t[0])||void 0===e?void 0:e.url,"input_image")},handleDelete:function(){var e;this.$logEvent("log_actions",{operation:"click_delete",behavior_info:"on_new_create_flow_page",behavior_info_sub:null===(e=this.source)||void 0===e?void 0:e.type}),this.$emit("delete"),this.handleClose()},changeConfig:function(e,t){var n;"enable"===t&&this.$logEvent("log_actions",{operation:"click_hide",behavior_info:"on_new_create_flow_page",behavior_info_sub:null===(n=this.source)||void 0===n?void 0:n.type});"input_image"===t&&this.$logEvent("log_actions",{operation:"click_switch_picture",behavior_info:"on_new_create_flow_page",behavior_info_sub:e||""}),this.$set(this.source,t,e)},openControlNetSelectPopup:function(){this.$refs.selectControlNetModal.show(this.source)},handleSelect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null!=e&&e.type&&(this.$logEvent("log_actions",{operation:"click_controlnet_type",behavior_info:"on_new_create_flow_page",behavior_info_sub:null==e?void 0:e.type}),this.$set(this.source,"type",null==e?void 0:e.type),this.$set(this.source,"module",null==e?void 0:e.module),this.$set(this.source,"model",null==e?void 0:e.model))}}},f=h,_=(n(4319),n(0)),component=Object(_.a)(f,(function(){var e,t,n,o,l,r,c,d,v=this,m=v._self._c;return m("el-dialog",{attrs:{visible:v.visible,"custom-class":"control-net-option-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(e){v.visible=e}}},[m("div",{staticClass:"modal-content"},[m("div",{staticClass:"modal-content-top"},[m("div",{staticClass:"modal-content-top-left"},[m("span",{staticClass:"modal-content-top-icon",on:{click:v.openPickImageModal}},[m("i",{staticClass:"iconfont icon-a-icon-reselectimg"})])]),v._v(" "),m("div",{staticClass:"modal-content-top-right",on:{click:function(e){return e.stopPropagation(),v.handleDelete()}}},[m("span",{staticClass:"modal-content-top-icon"},[m("i",{staticClass:"el-icon-delete"})])])]),v._v(" "),m("div",{staticClass:"modal-content-item-1"},[m("div",{staticClass:"modal-content-item-cover"},[m("img",{attrs:{src:null===(e=v.source)||void 0===e?void 0:e.input_image,alt:""}})]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("div",{staticClass:"modal-content-item-box-title"},[v._v("Controlnet Type")]),v._v(" "),m("div",{staticClass:"modal-content-item-box-select",on:{click:function(e){return e.stopPropagation(),v.openControlNetSelectPopup.apply(null,arguments)}}},[m("span",{staticClass:"modal-content-item-box-select-text"},[v._v(v._s(v.$t(v.source.type)))]),v._v(" "),m("span",{staticClass:"iconfont icon-edit1 modal-content-item-box-select-icon"})])])]),v._v(" "),m("div",{staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-strength-text"},[v._v(v._s(v.$t("ControlWeight")))]),v._v(" "),m("div",{staticClass:"modal-content-strength-content"},[m("slider-item",{attrs:{"hide-label":!0,value:v.source.weight,precision:null!==(t=v.easyTop)&&void 0!==t&&t.isCommunityFlux?2:1,min:0,max:null!==(n=v.easyTop)&&void 0!==n&&n.isCommunityFlux?1:2,step:null!==(o=v.easyTop)&&void 0!==o&&o.isCommunityFlux?.01:.1},on:{input:function(e){return v.changeConfig(e,"weight")},change:function(e){return v.changeConfig(e,"weight")}}})],1)]),v._v(" "),v.easyTop.isCommunityFlux?v._e():[m("div",{staticClass:"modal-content-item modal-content-item-flex-between"},[m("span",{staticClass:"content-item-label-text"},[v._v("More Settings")]),v._v(" "),m("el-switch",{attrs:{"active-color":"#3F8CFF"},model:{value:v.viewMore,callback:function(e){v.viewMore=e},expression:"viewMore"}})],1),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore,expression:"viewMore"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-item-label"},[v._v("Preprocessor")]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("div",{staticClass:"panel-item",class:[(null===(l=v.source)||void 0===l?void 0:l.isHandle)&&"active-btn"],on:{click:function(e){return e.stopPropagation(),v.changeConfig(!0,"isHandle")}}},[v._v("\n            "+v._s(v.$t("Yes"))+"\n          ")]),v._v(" "),m("div",{staticClass:"panel-item",class:[!(null!==(r=v.source)&&void 0!==r&&r.isHandle)&&"active-btn"],on:{click:function(e){return e.stopPropagation(),v.changeConfig(!1,"isHandle")}}},[v._v("\n            "+v._s(v.$t("No"))+"\n          ")])])]),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore&&"None"!=(null===(c=v.source)||void 0===c?void 0:c.model),expression:"viewMore && source?.model != 'None'"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-item-label"},[v._v(v._s(v.$t("ControlPreprocessingModel")))]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("el-select",{staticClass:"easy-custom-select",attrs:{value:v.source.model,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:function(e){return v.changeConfig(e,"model")}}},v._l(v.control_models,(function(e,i){return m("el-option",{key:"ControlMode_"+i,attrs:{value:e,label:e}},[m("el-tooltip",{attrs:{content:e,placement:"left"}},[m("span",[v._v(v._s(e))])])],1)})),1)],1)]),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore,expression:"viewMore"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-item-label"},[v._v(v._s(v.$t("ControlMode")))]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("el-select",{staticClass:"easy-custom-select",attrs:{value:v.source.control_mode,"popper-class":"custom-select","popper-append-to-body":!1},on:{change:function(e){return v.changeConfig(e,"control_mode")}}},v._l(v.controlMode,(function(e,i){return m("el-option",{key:"ControlMode_"+i,attrs:{value:i,label:v.$t("ControlMode"+e)}},[v._v("\n              "+v._s(v.$t("ControlMode"+e))+"\n            ")])})),1)],1)]),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore&&(null===(d=v.source)||void 0===d?void 0:d.isHandle),expression:"viewMore && source?.isHandle"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-item-label"},[v._v(v._s(v.$t("ControlPreprocessor")))]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("el-select",{staticClass:"easy-custom-select",attrs:{value:v.source.module,"popper-class":"custom-select","popper-append-to-body":!0},on:{change:function(e){return v.changeConfig(e,"module")}}},v._l(v.control_modules,(function(e,i){return m("el-option",{key:"ControlMode_"+i,attrs:{value:e,label:e}},[v._v("\n              "+v._s(e)+"\n            ")])})),1)],1)]),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore&&v.isShowStyleFidelity,expression:"viewMore && isShowStyleFidelity"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-item-label"},[v._v(v._s(v.$t("StyleFidelity")))]),v._v(" "),m("div",{staticClass:"modal-content-item-box"},[m("slider-item",{attrs:{"hide-label":!0,value:v.source.threshold_a,precision:1,min:.1,max:1,step:.1},on:{input:function(e){return v.changeConfig(e,"threshold_a")},change:function(e){return v.changeConfig(e,"threshold_a")}}})],1)]),v._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:v.viewMore&&v.isShowResolution,expression:"viewMore && isShowResolution"}],staticClass:"modal-content-item"},[m("div",{staticClass:"modal-content-strength-text"},[v._v(v._s(v.$t("ControlPreprocessorResolution")))]),v._v(" "),m("div",{staticClass:"modal-content-strength-content"},[m("slider-item",{attrs:{"hide-label":!0,value:v.source.processor_res,min:0,max:2048,step:1},on:{change:function(e){return v.changeConfig(e,"processor_res")}}})],1)])]],2),v._v(" "),m("select-control-net-modal",{ref:"selectControlNetModal",attrs:{fromPage:"optionModal"},on:{confirm:v.handleSelect}}),v._v(" "),m("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:v.handlePickImage}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3294:function(e,t,n){"use strict";n.r(t);n(6),n(32),n(16),n(22),n(65),n(8),n(4);var o=n(137),l=n(401),r=n(179),c=n(57),d=n(99),v={name:"IpMainOptionModal",props:["value","source","menuIndex"],inject:["easyTop"],components:{SliderItem:o.default,generateRedrawModal:l.default,PickOrUploadImageModal:r.default},data:function(){return{visible:!1,rawImgLoading:!0}},computed:{renderOptions:function(){return{min:0,max:1,step:.001}},getCurrentModelType:function(){var e,t=(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.base_model_type)||"",n=Object(d.getCurrentModelType)(t);return n||"sd"},getCustomSizeOptions:function(){var e,t={min:128,max:1024};return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?{min:384,max:1024}:"sd"===this.getCurrentModelType?t:["sdxl","sd3"].includes(this.getCurrentModelType)?{min:128,max:1536}:t}},methods:{show:function(){this.visible=!0},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},openPickImageModal:function(){this.$refs.pickOrUploadImageModal.openModal([],{checkFace:!0})},changeConfig:function(e,t){this.$set(this.source,t,e)},handlePickImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.changeConfig(null===(e=t[0])||void 0===e?void 0:e.url,"image")},handleUpdateImageSize:function(){var e,t,n,o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(null==l||null===(e=l.info)||void 0===e?void 0:e.banner)||(null==l?void 0:l.banner)||{},c=r.width,d=r.height;if(c&&d){var v=JSON.parse(JSON.stringify(this.value)),m={};m=this.convertStudioBaseSize(c,d,this.getCustomSizeOptions),v.width=(null===(t=m)||void 0===t?void 0:t.width)||(null==v?void 0:v.width),v.height=(null===(n=m)||void 0===n?void 0:n.height)||(null==v?void 0:v.height),null==this||null===(o=this.easyTop)||void 0===o||o.updateConfig(v,this.menuIndex)}},convertStudioBaseSize:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=([{code:1,label:"2:3",icon:"icon-a-2_3",sd:{standard:{width:512,height:768}},sdxl:{standard:{width:768,height:1152}},flux:{standard:{width:688,height:1024},quality:{width:1024,height:1536}}},{code:2,label:"1:1",icon:"icon-icon-a-1_11",sd:{standard:{width:768,height:768}},sdxl:{standard:{width:1024,height:1024}},flux:{standard:{width:1024,height:1024},quality:{width:1536,height:1536}}},{code:3,label:"9:16",icon:"icon-a-9_161",sd:{standard:{width:432,height:768}},sdxl:{standard:{width:810,height:1440}},flux:{standard:{width:592,height:1024},quality:{width:864,height:1536}}},{code:4,label:"4:3",icon:"icon-a-4_31",sd:{standard:{width:768,height:576}},sdxl:{standard:{width:1024,height:768}},flux:{standard:{width:1024,height:768},quality:{width:1536,height:1152}}},{code:5,label:"custom",icon:"icon-icon-Custom",sd:{},sdxl:{},flux:{}}]||[]).filter((function(e){return 5!==e.code})).map((function(e){return e.width=e.sd.standard.width,e.height=e.sd.standard.height,e})),l={},r=parseFloat((e/t).toFixed(2)),d=o.find((function(e){var t=parseFloat((e.width/e.height).toFixed(2));return r===t})),v=n;if(d){var m=this.getCurrentModelType;["sd","sdxl"].includes(m)&&(l=d[m].standard),["flux"].includes(m)&&(l=d[m].standard)}else{var h=Object(c.resizeToBaseDimension)(e,t,v.max);l.width=h.width,l.height=h.height,l.isCustom=!0}return l},handleDelete:function(){this.$emit("delete"),this.handleClose()}}},m=v,h=(n(4320),n(0)),component=Object(h.a)(m,(function(){var e,t=this,n=t._self._c;return n("el-dialog",{attrs:{visible:t.visible,"custom-class":"image-to-image-option-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(e){t.visible=e}}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-content-top"},[n("div",{staticClass:"modal-content-top-left"},[n("span",{staticClass:"modal-content-top-icon",on:{click:t.openPickImageModal}},[n("i",{staticClass:"iconfont icon-a-icon-reselectimg"})])]),t._v(" "),n("div",{staticClass:"modal-content-top-right",on:{click:function(e){return e.stopPropagation(),t.handleDelete()}}},[n("span",{staticClass:"modal-content-top-icon"},[n("i",{staticClass:"el-icon-delete"})])])]),t._v(" "),n("div",{staticClass:"modal-content-strength"},[n("div",{staticClass:"modal-content-strength-text"},[t._v("Strength")]),t._v(" "),n("div",{staticClass:"modal-content-strength-content"},[n("slider-item",{attrs:{"hide-label":!0,value:t.source.weight,precision:3,min:t.renderOptions.min,max:t.renderOptions.max,step:t.renderOptions.step},on:{change:function(e){return t.changeConfig(e,"weight")}}})],1)]),t._v(" "),n("div",{staticClass:"modal-content-image-box"},[n("img",{staticClass:"modal-content-image-box-img",attrs:{src:null===(e=t.source)||void 0===e?void 0:e.image,alt:""},on:{load:function(e){t.rawImgLoading=!1},error:function(e){t.rawImgLoading=!1}}})])]),t._v(" "),n("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:t.handlePickImage}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3295:function(e,t,n){"use strict";n.r(t);n(6),n(32),n(16),n(22),n(18),n(65),n(8),n(4),n(28);var o=n(137),l=n(401),r=n(179),c=n(57),d=n(99),v=n(33),m=n(3296),h={name:"ImageToImageOptionModal",props:["value","source","menuIndex"],inject:["easyTop"],components:{SliderItem:o.default,generateRedrawModal:l.default,PickOrUploadImageModal:r.default,SliderSelector:m.default},data:function(){return{visible:!1,rawImgLoading:!0,DEFAULT_STYLE_REFERENCE_LIST:v.DEFAULT_STYLE_REFERENCE_LIST}},computed:{convertToStrengthOptions:function(){return this.DEFAULT_STYLE_REFERENCE_LIST.map((function(e){return{label:e.name,value:e.code,code:e.code,name:e.name}}))},isShowRedraw:function(){var e,t,n,o=!(null!==(e=this.easyTop)&&void 0!==e&&null!==(e=e.currentConfigInfo)&&void 0!==e&&null!==(e=e.controlnet_units)&&void 0!==e&&e.length),l=!(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&null!==(t=t.ipList)&&void 0!==t&&t.length),r="SD 3.5"!==(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.getCurrentModelType);return o&&l&&r},renderOptions:function(){return{min:.01,max:1,step:.05}},getCurrentModelType:function(){var e,t=(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.base_model_type)||"",n=Object(d.getCurrentModelType)(t);return n||"sd"},getCustomSizeOptions:function(){var e,t={min:128,max:1024};return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?{min:384,max:1024}:"sd"===this.getCurrentModelType?t:["sdxl","sd3"].includes(this.getCurrentModelType)?{min:128,max:1536}:t}},watch:{"source.mask":{handler:function(e,t){if(e&&["",null,void 0].includes(t)){this.value.keepDenoisingStrength||this.changeConfig(.7,"denoising_strength");try{var n;if(!/^(http|https):\/\//.test(e))null===(n=this.easyTop)||void 0===n||n.updateConfig({prompt:""},this.menuIndex)}catch(e){}}var o;e&&e!==t&&(null===(o=this.easyTop)||void 0===o||o.updateConfig({ad_model:""},this.menuIndex))},immediate:!0,deep:!0}},methods:{handleAddMore:function(){var e;(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e||null===(e=e.styleReferenceList)||void 0===e?void 0:e.length)>=4?this.$message(this.$t("newGenerate80",{num:4})):(this.$EventBus.$emit("addMoreStyleReference"),this.handleClose())},show:function(){this.visible=!0},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},openPickImageModal:function(){this.$refs.pickOrUploadImageModal.openModal([],null)},changeConfig:function(e,t){this.$set(this.source,t,e)},handleOpenRedrawModal:function(){this.$refs.generateRedrawModal.show(this.source.url)},handlePickImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.changeConfig(null===(e=t[0])||void 0===e?void 0:e.url,"image")},handleUpdateImageSize:function(){var e,t,n,o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(null==l||null===(e=l.info)||void 0===e?void 0:e.banner)||(null==l?void 0:l.banner)||{},c=r.width,d=r.height;if(c&&d){var v=JSON.parse(JSON.stringify(this.value)),m={};m=this.convertStudioBaseSize(c,d,this.getCustomSizeOptions),v.width=(null===(t=m)||void 0===t?void 0:t.width)||(null==v?void 0:v.width),v.height=(null===(n=m)||void 0===n?void 0:n.height)||(null==v?void 0:v.height),null==this||null===(o=this.easyTop)||void 0===o||o.updateConfig(v,this.menuIndex)}},convertStudioBaseSize:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=([{code:1,label:"2:3",icon:"icon-a-2_3",sd:{standard:{width:512,height:768}},sdxl:{standard:{width:768,height:1152}},flux:{standard:{width:688,height:1024},quality:{width:1024,height:1536}}},{code:2,label:"1:1",icon:"icon-icon-a-1_11",sd:{standard:{width:768,height:768}},sdxl:{standard:{width:1024,height:1024}},flux:{standard:{width:1024,height:1024},quality:{width:1536,height:1536}}},{code:3,label:"9:16",icon:"icon-a-9_161",sd:{standard:{width:432,height:768}},sdxl:{standard:{width:810,height:1440}},flux:{standard:{width:592,height:1024},quality:{width:864,height:1536}}},{code:4,label:"4:3",icon:"icon-a-4_31",sd:{standard:{width:768,height:576}},sdxl:{standard:{width:1024,height:768}},flux:{standard:{width:1024,height:768},quality:{width:1536,height:1152}}},{code:5,label:"custom",icon:"icon-icon-Custom",sd:{},sdxl:{},flux:{}}]||[]).filter((function(e){return 5!==e.code})).map((function(e){return e.width=e.sd.standard.width,e.height=e.sd.standard.height,e})),l={},r=parseFloat((e/t).toFixed(2)),d=o.find((function(e){var t=parseFloat((e.width/e.height).toFixed(2));return r===t})),v=n;if(d){var m=this.getCurrentModelType;["sd","sdxl"].includes(m)&&(l=d[m].standard),["flux"].includes(m)&&(l=d[m].standard)}else{var h=Object(c.resizeToBaseDimension)(e,t,v.max);l.width=h.width,l.height=h.height,l.isCustom=!0}return l},updateImageMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$set(this.source,"mask",e),e||this.$set(this.source,"compose_mask",e)},updateMixedImageMask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$set(this.source,"compose_mask",e)},handleDelete:function(){this.$emit("delete"),this.handleClose()},handleStrengthSelect:function(e){this.$set(this.source,"weight",e)}}},f=h,_=(n(4322),n(0)),component=Object(_.a)(f,(function(){var e,t,n,o,l=this,r=l._self._c;return r("el-dialog",{attrs:{visible:l.visible,"custom-class":"style-reference-option-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"386px"},on:{"update:visible":function(e){l.visible=e}}},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-content-top"},[r("div",{staticClass:"modal-content-top-left"},[r("span",{staticClass:"modal-content-top-icon",on:{click:l.openPickImageModal}},[r("i",{staticClass:"iconfont icon-a-icon-reselectimg"})])]),l._v(" "),r("div",{staticClass:"modal-content-top-right",on:{click:function(e){return e.stopPropagation(),l.handleDelete()}}},[r("span",{staticClass:"modal-content-top-icon"},[r("i",{staticClass:"el-icon-delete"})])])]),l._v(" "),r("div",{staticClass:"modal-content-strength"},[r("slider-selector",{attrs:{"model-value":null===(e=l.source)||void 0===e?void 0:e.weight,options:l.convertToStrengthOptions},on:{"update:modelValue":l.handleStrengthSelect}})],1),l._v(" "),r("div",{staticClass:"modal-content-image-box"},[r("img",{staticClass:"modal-content-image-box-img",attrs:{src:(null===(t=l.source)||void 0===t?void 0:t.image)||(null===(n=l.source)||void 0===n?void 0:n.url),alt:""},on:{load:function(e){l.rawImgLoading=!1},error:function(e){l.rawImgLoading=!1}}})]),l._v(" "),(null===(o=l.easyTop)||void 0===o||null===(o=o.currentConfigInfo)||void 0===o||null===(o=o.styleReferenceList)||void 0===o?void 0:o.length)<4?r("div",{staticClass:"modal-content-bottom",on:{click:l.handleAddMore}},[l._v("\n      "+l._s(l.$t("newGenerate83"))+"\n    ")]):l._e()]),l._v(" "),r("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:l.handlePickImage}})],1)}),[],!1,null,null,null);t.default=component.exports},3296:function(e,t,n){"use strict";n.r(t);n(50),n(4);var o={name:"SliderSelector",props:{modelValue:{required:!0},options:{type:Array,required:!0,validator:function(e){return e.every((function(e){return e.hasOwnProperty("label")&&e.hasOwnProperty("value")}))}},disabled:{type:Boolean,default:!1}},data:function(){return{sliderWidth:0,sliderLeft:0}},computed:{sliderStyle:function(){return{width:this.sliderWidth+"px",transform:"translateX(".concat(this.sliderLeft,"px)")}},currentIndex:function(){var e=this;return this.options.findIndex((function(t){return t.value===e.modelValue}))}},watch:{modelValue:{handler:function(e){var t=this;this.$nextTick((function(){var n=t.options.findIndex((function(t){return t.value===e}));t.updateSliderPosition(n)}))},immediate:!0},"$refs.selectorBtns":function(){this.updateSliderPosition(this.currentIndex)}},mounted:function(){var e=this;this.$nextTick((function(){e.updateSliderPosition(e.currentIndex)})),window.addEventListener("resize",this.handleResize)},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:{handleSelect:function(e,t){this.disabled||(this.$emit("update:modelValue",e.value),this.$emit("change",{item:e,index:t,value:e.value}))},updateSliderPosition:function(e){var t,button=null===(t=this.$refs.selectorBtns)||void 0===t?void 0:t[e];button&&(this.sliderWidth=button.offsetWidth,this.sliderLeft=button.offsetLeft-5)},handleResize:function(){this.updateSliderPosition(this.currentIndex)}}},l=(n(4321),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"slider-selector"},[t("div",{staticClass:"slider-background",style:e.sliderStyle}),e._v(" "),e._l(e.options,(function(n,o){return t("button",{key:n.value,ref:"selectorBtns",refInFor:!0,class:["slider-btn",{active:e.modelValue===n.value}],on:{click:function(t){return e.handleSelect(n,o)}}},[e._v("\n    "+e._s(n.label)+"\n  ")])}))],2)}),[],!1,null,"9ed22b5e",null);t.default=component.exports},3297:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8),n(7);var o=n(2),l=(n(6),n(16),n(4),n(179)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"ImageToVideoOptionModal",props:["value","source"],inject:["easyTop"],components:{PickOrUploadImageModal:l.default},data:function(){return{visible:!1,rawImgLoading:!0,frameType:"start"}},computed:d(d({},Object(r.c)("user",["isLoggedIn"])),{},{isShowFirstLastFrame:function(){var e,t;return["first_frame","last_frame"].includes(null==this||null===(e=this.source)||void 0===e?void 0:e.mode)&&(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isStartAndEnd)},getImageUrl:function(){var e,t,n,o;switch(null==this||null===(e=this.source)||void 0===e?void 0:e.mode){case"first_frame":case"last_frame":return"start"===this.frameType?null==this||null===(t=this.source)||void 0===t?void 0:t.firstFrame:null==this||null===(n=this.source)||void 0===n?void 0:n.lastFrame;default:return null==this||null===(o=this.source)||void 0===o?void 0:o.url}}}),methods:{show:function(){this.visible=!0},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},openPickImageModal:function(){this.isLoggedIn&&this.$refs.pickOrUploadImageModal.openModal([],null)},changeConfig:function(e,t){this.$set(this.source,t,e)},handlePickImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(["first_frame","last_frame"].includes(null==this||null===(e=this.source)||void 0===e?void 0:e.mode)){var n,o=this.frameType;this.changeConfig(null===(n=t[0])||void 0===n?void 0:n.url,"start"===o?"firstFrame":"lastFrame")}else{var l;this.changeConfig(null===(l=t[0])||void 0===l?void 0:l.url,"url")}},handleDelete:function(){var e;if(["first_frame","last_frame"].includes(null==this||null===(e=this.source)||void 0===e?void 0:e.mode)){var t,n,o,l=[null===(t=this.source)||void 0===t?void 0:t.firstFrame,null===(n=this.source)||void 0===n?void 0:n.lastFrame].filter(Boolean);if(this.changeConfig("","start"===this.frameType?"firstFrame":"lastFrame"),1===l.length)null===(o=this.easyTop)||void 0===o||o.resetVideoModelDefaultConfig(),this.handleClose()}else{var r;null===(r=this.easyTop)||void 0===r||r.resetVideoModelDefaultConfig(),this.handleClose()}},handleFrameTypeChange:function(e){this.frameType=e},handleExchangeFrames:function(){var e,t,n=null===(e=this.source)||void 0===e?void 0:e.firstFrame;this.source.firstFrame=(null===(t=this.source)||void 0===t?void 0:t.lastFrame)||"",this.source.lastFrame=n||""}}},m=v,h=(n(4323),n(0)),component=Object(h.a)(m,(function(){var e,t,n,o,l,r,c=this,d=c._self._c;return d("el-dialog",{attrs:{visible:c.visible,"custom-class":"image-to-video-option-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(e){c.visible=e}}},[d("div",{staticClass:"modal-content"},[d("div",{staticClass:"modal-content-top"},[d("div",{staticClass:"modal-content-top-left"},[d("span",{staticClass:"modal-content-top-icon",on:{click:c.openPickImageModal}},[d("i",{staticClass:"iconfont icon-a-icon-reselectimg"})])]),c._v(" "),d("div",{staticClass:"modal-content-top-right",on:{click:function(e){return e.stopPropagation(),c.handleDelete()}}},[d("span",{staticClass:"modal-content-top-icon"},[d("i",{staticClass:"el-icon-delete"})])])]),c._v(" "),d("div",{staticClass:"modal-content-image-box"},[c.getImageUrl?[d("img",{staticClass:"modal-content-image-box-img",attrs:{src:c.getImageUrl,alt:""},on:{load:function(e){c.rawImgLoading=!1},error:function(e){c.rawImgLoading=!1}}})]:[d("div",{staticClass:"placeholder-content",on:{click:function(e){return e.stopPropagation(),c.openPickImageModal.apply(null,arguments)}}},[d("i",{staticClass:"iconfont icon-a-icon-addimg2img"}),c._v(" "),d("span",[c._v(c._s(c.$t("UploadImg")))])])]],2),c._v(" "),c.isShowFirstLastFrame?d("div",{staticClass:"modal-content-first-last-frame"},[d("div",{staticClass:"modal-content-first-last-frame-item",class:{active:"start"===c.frameType},on:{click:function(e){return c.handleFrameTypeChange("start")}}},[d("div",{staticClass:"frame-preview",class:{"no-image":!(null!==(e=c.source)&&void 0!==e&&e.firstFrame)}},[null!==(t=c.source)&&void 0!==t&&t.firstFrame?d("img",{attrs:{src:null===(n=c.source)||void 0===n?void 0:n.firstFrame,alt:""}}):d("i",{staticClass:"el-icon-picture-outline"})]),c._v(" "),d("span",{staticClass:"modal-content-first-last-frame-item-text"},[c._v(c._s(c.$t("newGenerate125")))])]),c._v(" "),d("div",{staticClass:"exchange-icon",on:{click:c.handleExchangeFrames}},[d("i",{staticClass:"el-icon-sort"})]),c._v(" "),d("div",{staticClass:"modal-content-first-last-frame-item",class:{active:"end"===c.frameType},on:{click:function(e){return c.handleFrameTypeChange("end")}}},[d("div",{staticClass:"frame-preview",class:{"no-image":!(null!==(o=c.source)&&void 0!==o&&o.lastFrame)}},[null!==(l=c.source)&&void 0!==l&&l.lastFrame?d("img",{attrs:{src:null===(r=c.source)||void 0===r?void 0:r.lastFrame,alt:""}}):d("i",{staticClass:"el-icon-picture-outline"})]),c._v(" "),d("span",{staticClass:"modal-content-first-last-frame-item-text"},[c._v(c._s(c.$t("newGenerate126")))])])]):c._e()]),c._v(" "),d("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:c.handlePickImage}})],1)}),[],!1,null,null,null);t.default=component.exports},3298:function(e,t,n){"use strict";n.r(t);n(19),n(11),n(6),n(12),n(13),n(7);var o=n(3),l=n(2),r=(n(20),n(16),n(22),n(8),n(4),n(137)),c=n(1),d=n(179),v=n(29);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"AnimeToolsModal",inject:["easyTop"],props:{value:{type:Object,default:function(){return{}}}},components:{SliderItem:r.default,PickOrUploadImageModal:d.default},data:function(){return{visible:!1,config:{width:0,height:0,realWidth:0,realHeight:0,cover:"",animatediff:{lora:"",weight:1,category:0},url:"",workInfo:null},timeList:[{label:"shortVersion",value:0},{label:"longVersion",value:1}],motionLoRAVisible:!1,loading:!1,taskLoading:!1,btnLoading:!1}},computed:h(h(h({},Object(c.c)("creation",["taskUpscaler","animationLoraRecommends"])),Object(c.c)("user",["accountSettingsData","userInfo","isCompanyAccount","isLoggedIn"])),{},{setExpend:function(){var e,t=30;return 1===(null===(e=this.config)||void 0===e||null===(e=e.animatediff)||void 0===e?void 0:e.category)&&(t=50),t},renderUpscaleOptions:function(){return(this.taskUpscaler||[]).map((function(e){return{id:e,name:e}}))}}),methods:{handleImageLoad:function(e){var t=e.target.naturalWidth,n=e.target.naturalHeight;this.config.realWidth=t,this.config.realHeight=n,this.loading=!1},handleImageLoadError:function(){this.loading=!1},show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.resetData(),this.initData(e),this.visible=!0},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.animatediff,n=void 0===t?{}:t,o=e.url,l=void 0===o?"":o,r=e.requestParams;this.config.animatediff=Object.assign(this.config.animatediff,n||{}),this.config.url=l||"",this.config.requestParams=r||null},resetData:function(){this.config={width:0,height:0,realWidth:0,realHeight:0,cover:"",animatediff:{lora:"",weight:1,category:0},url:"",requestParams:null},this.btnLoading=!1,this.taskLoading=!1,this.loading=!1},handleClose:function(){this.resetData(),this.visible=!1},handleConfirm:function(){this.handleClose()},changeConfig:function(e,t){["weight","category"].includes(t)?this.$set(this.config.animatediff,t,e):this.$set(this.config,t,e)},handleSelectImage:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return m=(e.length>0&&void 0!==e[0]?e[0]:[])[0]||{},t.config.width=null==m||null===(o=m.info)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.width,t.config.height=null==m||null===(l=m.info)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.height,t.config.realWidth=null==m||null===(r=m.info)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.width,t.config.realHeight=null==m||null===(c=m.info)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.height,t.loading=!0,t.config.url=null==m||null===(d=m.info)||void 0===d||null===(d=d.banner)||void 0===d?void 0:d.url,t.config.requestParams=null,n.next=11,t.handleGetReferInfo(null==m||null===(v=m.info)||void 0===v?void 0:v.id);case 11:case"end":return n.stop()}}),n)})))()},openPickImageModal:function(){this.$refs.pickOrUploadImageModal.openModal()},handleAddMotion:function(){this.motionLoRAVisible=!0},handleDeleteMotion:function(){this.config.cover="",this.config.animatediff.lora=""},setModel:function(e){this.config.animatediff.weight=1,this.config.animatediff.lora=e.value,this.config.cover=e.url,this.motionLoRAVisible=!1},handleGetReferInfo:function(e){var t=this,n={art_work_no:e,task_flow_version:"v2"};this.taskLoading=!0,Object(v.getTaskConfig)(n).then((function(e){var o;if([1e4,"10000"].includes(null==e||null===(o=e.status)||void 0===o?void 0:o.code)){var l=(null==e?void 0:e.data)||{},r=(null==l?void 0:l.art_model)||{},c={art_model_no:r.id,art_model_ver_no:r.model_ver_no,art_work_no:n.art_work_no,action:24,category:1,meta:(null==l?void 0:l.meta)||{}};if(null!=c&&c.meta)try{delete c.meta.hi_res_arg}catch(e){}t.config.requestParams=c}else t.$message.error(e.status.msg||t.$t("ServerError"))})).catch((function(e){})).finally((function(){t.taskLoading=!1}))},handleGenerate:function(){var e=this;if(!this.taskLoading&&!this.btnLoading){var t=JSON.parse(JSON.stringify(this.config.requestParams));t.meta.init_images=[this.config.url],t.meta.animatediff=this.config.animatediff,this.btnLoading=!0;try{var n;null===(n=this.easyTop)||void 0===n||n.handleAnimeGenerate(t).then((function(t){1e4===(null==t?void 0:t.status.code)&&e.handleClose()})).finally((function(){e.btnLoading=!1}))}catch(e){}}}}},_=f,y=(n(4327),n(0)),component=Object(y.a)(_,(function(){var e,t,n,o,l,r,c,d=this,v=d._self._c;return v("el-dialog",{attrs:{visible:d.visible,"custom-class":"easy-upscale-tools-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"","append-to-body":"",width:"320px"},on:{"update:visible":function(e){d.visible=e}}},[v("div",{staticClass:"modal-header"},[v("div",{staticClass:"modal-header-title"},[d._v(d._s(d.$t("AnimGen")))])]),d._v(" "),v("div",{staticClass:"modal-content"},[v("div",{staticClass:"modal-content-item"},[v("div",{staticClass:"modal-content-item-label modal-content-item-label-flex"},[v("span",{staticClass:"modal-content-item-label-text"},[d._v(d._s(d.$t("personalFeed")))]),d._v(" "),v("span",{directives:[{name:"show",rawName:"v-show",value:null===(e=d.config)||void 0===e?void 0:e.url,expression:"config?.url"}],staticClass:"modal-content-item-label-btn",on:{click:function(e){return e.stopPropagation(),d.openPickImageModal.apply(null,arguments)}}},[d._v(d._s(d.$t("selectingMaterialsType1")))])]),d._v(" "),v("div",{staticClass:"modal-content-item-content"},[null!==(t=d.config)&&void 0!==t&&t.url?v("div",{directives:[{name:"loading",rawName:"v-loading",value:d.loading||d.taskLoading,expression:"loading || taskLoading"}],staticClass:"modal-content-item-content-img"},[v("img",{attrs:{src:d.config.url,alt:""},on:{load:d.handleImageLoad,error:d.handleImageLoadError}})]):v("div",{staticClass:"modal-content-item-content-upload-box",on:{click:function(e){return e.stopPropagation(),d.openPickImageModal.apply(null,arguments)}}},[v("span",{staticClass:"iconfont icon-organize modal-content-item-content-add-icon"})])])]),d._v(" "),v("div",{staticClass:"modal-content-item"},[v("div",{staticClass:"modal-content-item-label modal-content-item-label-flex"},[v("span",{staticClass:"modal-content-item-label-text"},[d._v(d._s(d.$t("newGenerate57")))]),d._v(" "),v("span",{directives:[{name:"show",rawName:"v-show",value:null===(n=d.config.animatediff)||void 0===n?void 0:n.lora,expression:"config.animatediff?.lora"}],staticClass:"modal-content-item-label-btn",on:{click:function(e){return e.stopPropagation(),d.handleAddMotion.apply(null,arguments)}}},[d._v(d._s(d.$t("Replace")))])]),d._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:!(null!==(o=d.config.animatediff)&&void 0!==o&&o.lora),expression:"!config.animatediff?.lora"}],staticClass:"modal-content-item-content-add"},[v("div",{staticClass:"modal-content-item-content-add-text"},[d._v(d._s(d.$t("add")))]),d._v(" "),v("div",{staticClass:"modal-content-item-content-add-icon el-icon-circle-plus-outline",on:{click:function(e){return e.stopPropagation(),d.handleAddMotion.apply(null,arguments)}}})]),d._v(" "),null!==(l=d.config.animatediff)&&void 0!==l&&l.lora?v("div",{staticClass:"content-motion-card"},[v("div",{staticClass:"additional-panel-card-item-cover"},[v("video",{attrs:{src:null===(r=d.config)||void 0===r?void 0:r.cover,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}})]),d._v(" "),v("div",{staticClass:"additional-panel-card-item-content"},[v("div",{staticClass:"card-item-content-title"},[v("div",{staticClass:"card-item-content-title-text"},[d._v(d._s(null===(c=d.config.animatediff)||void 0===c?void 0:c.lora))]),d._v(" "),v("i",{staticClass:"el-icon-delete card-item-close-btn",on:{click:function(e){return e.stopPropagation(),d.handleDeleteMotion.apply(null,arguments)}}})]),d._v(" "),v("slider-item",{attrs:{value:d.config.animatediff.weight,min:-1,max:2,step:.05,label:"Strength","hide-label":!0},on:{change:function(e){return d.changeConfig(e,"weight")}}})],1)]):d._e()]),d._v(" "),v("div",{staticClass:"modal-content-item"},[v("div",{staticClass:"modal-content-item-label"},[d._v(d._s(d.$t("taskScalingRatio")))]),d._v(" "),v("div",{staticClass:"modal-content-item-content-panel"},d._l(d.timeList,(function(e,t){return v("div",{key:"method_".concat(t,"_").concat(e.category),staticClass:"panel-item",class:[e.value===d.config.animatediff.category?"active-btn":""],on:{click:function(t){return t.stopPropagation(),d.changeConfig(e.value,"category")}}},[d._v("\n          "+d._s(d.$t(e.label))+"\n        ")])})),0)]),d._v(" "),v("el-button",{staticClass:"easy-upscale-tools-modal-btn",attrs:{loading:d.btnLoading},on:{click:function(e){return e.stopPropagation(),d.handleGenerate.apply(null,arguments)}}},[d._v("\n      "+d._s(d.$t("Generate"))+"\n      "),d.isCompanyAccount?d._e():v("span",{staticClass:"generate-btn-sub"},[d._v("\n        ("+d._s(d.$t("PhysicalExertion"))+": "+d._s(d.setExpend)+" )\n      ")])])],1),d._v(" "),v("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",attrs:{type:"animGen"},on:{confirm:d.handleSelectImage}}),d._v(" "),v("el-dialog",{attrs:{visible:d.motionLoRAVisible,"custom-class":"styleModal",width:"1376px",title:"MotionLoRA","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){d.motionLoRAVisible=e}}},[v("div",{staticClass:"anime-tools-modal-modelList"},d._l(d.animationLoraRecommends,(function(e){var t,n;return v("div",{key:e.value,staticClass:"anime-tools-modal-model-item",class:{"anime-tools-modal-model-item-active":(null===(t=d.config.animatediff)||void 0===t?void 0:t.lora)===e.value},on:{click:function(t){return d.setModel(e)}}},[v("video",{style:{transform:(null===(n=d.config.animatediff)||void 0===n?void 0:n.lora)==e.value?"scale(0.8)":""},attrs:{src:e.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}),d._v(" "),v("div",{staticClass:"anime-tools-modal-model-name"},[d._v(d._s(e.value))])])})),0)])],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},3299:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=n(1);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"categoryPanel",inject:["easyTop"],props:["value","menuIndex"],data:function(){return{categoryMap:{model:"Model",aiApp:"aiapply",character:"digitalHuman"}}},computed:{covertType:function(){var e="app"===(null==this?void 0:this.menuIndex)?"aiApp":"model",t=this.categoryMap[e]||"";return t?this.$t(t):""},getStyle:function(){var e;return{backgroundImage:"url(".concat(null==this||null===(e=this.value)||void 0===e||null===(e=e.categoryInfo)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url,")")}},currentCategoryInfo:function(){var e;return null==this||null===(e=this.value)||void 0===e?void 0:e.categoryInfo},categoryInfo:function(){var e;return null===(e=this.value)||void 0===e?void 0:e.categoryInfo},activeCategory:function(){var e="app"===(null==this?void 0:this.menuIndex)?"aiApp":"model";return e}},methods:c(c({},Object(l.b)("creation",["setCombinedDialogStatus"])),{},{openCategoryModal:function(){this.setCombinedDialogStatus({visible:!0,instanceId:"easyGenerate"})},handleJumpDetail:function(){var e=this.categoryInfo||{},t=window.location.origin;switch(this.activeCategory){case"model":(null==e?void 0:e.id)&&window.open(t+this.localePath("/models/detail/".concat(e.id)),"_blank");break;case"aiApp":(null==e?void 0:e.id)&&window.open(t+this.localePath("/workFlowAppDetail/".concat(e.id)),"_blank");break;case"character":(null==e?void 0:e.id)&&window.open(t+this.localePath("/cyberPubPage/".concat(e.id)),"_blank")}}})},v=(n(4328),n(0)),component=Object(v.a)(d,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"c-easy-model-panel",style:n.getStyle,on:{click:function(e){return e.stopPropagation(),n.openCategoryModal.apply(null,arguments)}}},[o("div",{staticClass:"model-panel-card"},[o("div",{staticClass:"model-panel-card-left"},[o("div",{staticClass:"model-panel-card-left-box"},[o("span",{staticClass:"model-panel-card-left-tag"},[n._v(n._s(n.covertType))])]),n._v(" "),o("div",{staticClass:"model-panel-card-left-text-box"},[o("span",{staticClass:"model-panel-card-left-text"},[n._v(n._s(null===(e=n.value)||void 0===e||null===(e=e.categoryInfo)||void 0===e?void 0:e.name))]),n._v(" "),o("el-tooltip",{attrs:{content:n.$t("view_detail"),placement:"top","open-delay":200}},[o("i",{directives:[{name:"show",rawName:"v-show",value:null===(t=n.value)||void 0===t||null===(t=t.categoryInfo)||void 0===t?void 0:t.id,expression:"value?.categoryInfo?.id"}],staticClass:"iconfont icon-icon-xinxi",on:{click:function(e){return e.stopPropagation(),n.handleJumpDetail.apply(null,arguments)}}})])],1)]),n._v(" "),n._m(0)])])}),[function(){var e=this._self._c;return e("div",{staticClass:"model-panel-card-right"},[e("span",{staticClass:"iconfont icon-select-model-icon"})])}],!1,null,"f2d12842",null);t.default=component.exports},3300:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8);var o=n(3),l=n(2),r=(n(20),n(19),n(6),n(32),n(50),n(22),n(18),n(4),n(7),n(1)),c=n(3441),d=n(80),v=n(29),m=n(10),h=n(35),f=n.n(h);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={name:"workFlowAppParams",provide:function(){return{top:this}},props:["value","source"],inject:["easyTop"],components:{CodeViewer:c.default},data:function(){return{innerChange:!1,workFlowAppData:{},noData:!1,isInitialized:!1,workFlowIndex:0,workFlowList:[],params:{}}},watch:{doorUrl:{handler:function(e){this.handleDoorUrlToInputs()}},categoryInfo:{deep:!0,handler:function(e,t){this.innerChange?this.innerChange=!1:(e&&e.id&&(null==e?void 0:e.id)!==(null==t?void 0:t.id)?this.handleUpdateWorkflow(e.id):(this.params=f()(e),this.updateCategoryInfo(),this.fillImagenNodeUrl()),null!=e&&e.id&&e.retryId&&this.remixWork())}}},mounted:function(){var e,t;null!==(e=this.categoryInfo)&&void 0!==e&&e.id&&this.handleUpdateWorkflow(null===(t=this.categoryInfo)||void 0===t?void 0:t.id)},computed:y(y(y(y({},Object(r.c)("creation",["smart_edit_template_id"])),Object(r.e)("creation",["urlInputs"])),Object(r.c)("user",["isLoggedIn"])),{},{categoryInfo:function(){return this.value.categoryInfo||null},codeViewerHeight:function(){return""},codeViewData:function(){var e;return(null===(e=this.workFlowList[this.workFlowIndex])||void 0===e?void 0:e.inputs)||[]},currentWorkFlow:function(){var e;return y(y({},this.workFlowList[this.workFlowIndex]||{}),{},{ver_no:null===(e=this.workFlowAppData.ver_infos)||void 0===e||null===(e=e[this.workFlowIndex])||void 0===e?void 0:e.ver_no})},doorUrl:function(){var e;return(null===(e=this.easyTop)||void 0===e||null===(e=e.createOpenParams)||void 0===e||null===(e=e.openDoorParams)||void 0===e?void 0:e.workUrl)||""},workFlowTabList:function(){var e,t=this,n=(null===(e=this.workFlowAppData)||void 0===e?void 0:e.ver_infos)||{};return(this.workFlowList||[]).map((function(e,o){var l,r;return{id:t.workFlowAppData.id,labels:null==e?void 0:e.labels,estimateCoins:null==e?void 0:e.estimate_coins,name:(null===(l=n[o])||void 0===l?void 0:l.ver_no_name)||(null==e?void 0:e.name),verNo:null===(r=n[o])||void 0===r?void 0:r.ver_no}}))}}),methods:y(y({},Object(r.d)("creation",["SET_URL_INPUTS"])),{},{handleUpdateWorkflow:function(e){var t,n;null!=this&&null!==(t=this.categoryInfo)&&void 0!==t&&t.id&&(null===(n=this.workFlowAppData)||void 0===n?void 0:n.template_id)===e||(this.params=f()(this.categoryInfo),this.getWorkflowConfig(e))},createTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];try{var t,n,o=Array.isArray(e)&&null!=e&&e.length?e[0]:null;if(o)null==this||null===(n=this.easyTop)||void 0===n||n.updateTask(o);null==this||null===(t=this.easyTop)||void 0===t||t.shouldRefreshList(!0),this.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}})}catch(e){}},getWorkflowConfig:function(e){var t=this,n={template_id:e};return Object(d.e)(n).then(function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(o){var l,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=o.data,(data=void 0===l?{}:l).inputs=(null==data?void 0:data.inputs)||[],data.progress="none",t.workFlowAppData=y(y(y({},t.workFlowAppData),data),{},{template_id:e}),t.handleWorkFlowList(e),t.fillImagenNodeUrl(),t.updateCategoryInfo(),t.workFlowAppData.loading=!1;try{t.$nextTick((function(){var e;t.$refs.codeViewer&&t.$refs.codeViewer.$refs.seedField&&(null===(e=t.$refs.codeViewer.$refs.seedField)||void 0===e||e.initData())}))}catch(e){}return n.abrupt("return",t.workFlowAppData);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).finally((function(){try{t.$set(t.workFlowAppData,"loading",!1)}catch(e){}}))},checkWorkFlowEstimateCoins:function(e){var t,n=this;((null===(t=this.workFlowList)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.inputs)||[]).forEach((function(e){var t;if(null!=e&&null!==(t=e.estimate_coins)&&void 0!==t&&t.length){var o=e.estimate_coins.find((function(t){return t.key==e.val}));n.$set(e,"estimateCoins",(null==o?void 0:o.value)||0)}}))},handleWorkFlowList:function(e){var t,n,o;this.workFlowIndex=0,null===(t=this.$refs)||void 0===t||null===(t=t.codeViewer)||void 0===t||t.changeWorkflow(this.workFlowIndex);var l=((null===(n=this.workFlowAppData)||void 0===n?void 0:n.inputs)||[]).map((function(e){return y(y({},e),{},{val:e.val||""})}));this.workFlowList=[y(y({},this.workFlowAppData),{},{inputs:l})],this.handleDoorUrlToInputs();var r=null===(o=this.workFlowAppData)||void 0===o||null===(o=o.ver_infos)||void 0===o||null===(o=o[1])||void 0===o?void 0:o.ver_no;this.checkWorkFlowEstimateCoins(0),r?this.getSubWorkFlowDetail(e,r):this.remixWork()},getSubWorkFlowDetail:function(e,t){var n=this;Object(d.e)({template_id:e,ver_no:t}).then((function(e){var data=(null==e?void 0:e.data)||{},t=(null==data?void 0:data.inputs)||[];n.$set(n.workFlowList,1,y(y({},data),{},{inputs:t.map((function(e){return y(y({},e),{},{val:e.val||""})}))})),n.remixWork(),n.checkWorkFlowEstimateCoins(1)}))},changeWorkflow:function(e){this.workFlowIndex=e},getWorkFlowInputs:function(e){var t;return e||0===e||(e=this.workFlowIndex),(null===(t=this.workFlowList)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.inputs)||[]},remixWork:function(){var e,t,n,o,l=this;null!==(e=this.categoryInfo)&&void 0!==e&&e.retryId&&Object(v.getMetaInfo)({id:null===(n=this.categoryInfo)||void 0===n?void 0:n.retryId}).then((function(e){var t,n=(null==e||null===(t=e.data)||void 0===t||null===(t=t.meta)||void 0===t?void 0:t.comfyui_inputs)||[];l.checkWorkFlowIndex(e),l.fillFormData(n)}));null!==(t=this.categoryInfo)&&void 0!==t&&t.reMixId&&Object(v.getTaskConfig)({art_work_no:null===(o=this.categoryInfo)||void 0===o?void 0:o.reMixId,source:4}).then((function(e){var t,n=(null==e||null===(t=e.data)||void 0===t||null===(t=t.meta)||void 0===t?void 0:t.comfyui_inputs)||[];l.checkWorkFlowIndex(e),l.fillFormData(n)}))},checkWorkFlowIndex:function(e){var t,n,o=((null==e||null===(t=e.data)||void 0===t?void 0:t.creativity)||{}).ver_no,l=this.workFlowTabList.findIndex((function(e){return e.verNo===o}));this.workFlowIndex=l>=0?l:0,null===(n=this.$refs)||void 0===n||null===(n=n.codeViewer)||void 0===n||n.changeWorkflow(this.workFlowIndex)},fillFormData:function(data){var e=this,t={};data.forEach((function(e){var n="".concat(e.field,"_").concat(e.node_id);t[n]={val:null==e?void 0:e.val,art_model:null==e?void 0:e.art_model}})),this.getWorkFlowInputs().forEach((function(n){var o,l,r,c="".concat(n.field,"_").concat(n.node_id);if(n.val=(null===(o=t[c])||void 0===o?void 0:o.val)||n.val,n.art_model=null===(l=t[c])||void 0===l?void 0:l.art_model,null!=n&&null!==(r=n.estimate_coins)&&void 0!==r&&r.length){var d=n.estimate_coins.find((function(e){return e.key==n.val}));e.$set(n,"estimateCoins",(null==d?void 0:d.value)||0)}}))},changeVal:function(e,t){var n,o=this.getWorkFlowInputs(t),l=e.field,r=e.node_id,c=e.node_type,d=e.val,v=o.find((function(e){return e.field==l&&e.node_id==r&&e.node_type==c}));if(v&&this.$set(v,"val",d),this.isLoggedIn){var m=o.map((function(e){if("image"===e.field)return e.val||""})).filter((function(e){return!!e}));this.SET_URL_INPUTS(m)}if(null!=v&&null!==(n=v.estimate_coins)&&void 0!==n&&n.length){var h=v.estimate_coins.find((function(e){return e.key==d}));this.$set(v,"estimateCoins",(null==h?void 0:h.value)||0)}},changeNodeProperty:function(e,t,data){var n=this.getWorkFlowInputs(),o=e.field,l=e.node_id,r=e.node_type,c=n.find((function(e){return e.field==o&&e.node_id==l&&e.node_type==r}));c&&t&&c&&this.$set(c,t,data)},handleDoorUrlToInputs:function(){if(this.doorUrl)for(var e=Object(m.v)(this.doorUrl),t=this.getWorkFlowInputs(),i=0;i<t.length;i++){var n=t[i];e==n.field&&this.$set(n,"val",this.doorUrl)}},updateCategoryInfo:function(){var e,t,n,o;null!==(e=this.categoryInfo)&&void 0!==e&&e.name||(this.innerChange=!0,this.$EventBus.$emit("updateCategoryInfo",{type:"aiApp",obj:{id:null===(t=this.workFlowAppData)||void 0===t?void 0:t.id,name:null===(n=this.workFlowAppData)||void 0===n?void 0:n.name,banner:{url:null===(o=this.workFlowAppData)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.url}}}))},fillImagenNodeUrl:function(){var e,t,n,o,l,r=f()((null==this||null===(e=this.params)||void 0===e?void 0:e.imgUrlList)||[]);if((null==this||null===(t=this.params)||void 0===t?void 0:t.imgUrlList)&&(this.params.imgUrlList=[]),!this.isLoggedIn||null===(n=this.urlInputs)||void 0===n||!n.length||null!==(o=r)&&void 0!==o&&o.length||(r=f()(this.urlInputs)||[]),null!==(l=r)&&void 0!==l&&l.length){for(var c=this.getWorkFlowInputs(),i=0;i<c.length;i++){var d=c[i];if("image"===d.field){var v=r.shift();d.val=v||""}}this.workFlowList[this.workFlowIndex]&&this.$set(this.workFlowList[this.workFlowIndex],"inputs",c),this.isLoggedIn&&this.SET_URL_INPUTS(r)}}})},w=C,k=(n(4355),n(0)),component=Object(k.a)(w,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"c-workflow-app-params",attrs:{"data-group":"easy-generate-ai-app"}},[o("CodeViewer",{ref:"codeViewer",attrs:{isCreate:!0,height:n.codeViewerHeight,isShowPrevite:!0,codeViewData:n.codeViewData,templateId:null===(e=n.workFlowAppData)||void 0===e?void 0:e.template_id,workFlowTabList:n.workFlowTabList,currentWorkFlow:n.currentWorkFlow,loading:null===(t=n.workFlowAppData)||void 0===t?void 0:t.loading,source:n.source},on:{createTask:n.createTask,changeWorkflow:n.changeWorkflow}})],1)}),[],!1,null,"483dcd83",null);t.default=component.exports},3302:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(12),n(13),n(8);var o=n(14),l=n(30),r=n(2),c=(n(6),n(50),n(22),n(49),n(4),n(7),n(26),n(319)),d=n(80),v=n(3303),m=n(460),h=n(57),f=n(25),_=n(302),y=n(102),C=n(1),w=n(876),k=n(129),I=n(29),x=n(10),T=n(210),S=n(124),O=n(97),P=n(85);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={name:"workFlowAppDetailHistoryPage",inject:["top"],provide:function(){return{workflowTaskView:this}},components:{historyItem:v.default,taskImageViewer:_.default,historyImg:w.default,NoData:k.default,TryCreateMask:c.default,auditDialog:T.a,SaveTo:S.default,commonConfirmModal:O.default},data:function(){return{viewMode:"list",list:[],loading:!1,queryParams:{limit:10},hasMore:!0,showScroll:!0,debounceHandleScroll:function(){},dialogVisible:!1,viewImageList:[],activeCard:null,currentImageIndex:0,manageList:[],manageBtnConfig:[{code:"POST",i18nKey:"Post",icon:"iconfont icon-icon-Posts"},{code:"SAVE",i18nKey:"Save",icon:"iconfont icon-workflow_icon_save"},{code:"DOWNLOAD",i18nKey:"Download",icon:"el-icon-download"},{code:"DELETE",i18nKey:"Delete",icon:"iconfont icon-delete-gpt"},{code:"CANCEL",i18nKey:"Cancel",icon:"iconfont icon-close-btn"}],isInDownloadTask:!1,pollingTimer:null}},watch:{isLoggedIn:{handler:function(e,t){(!t&&e||!e&&t)&&this.handleRefresh()},immediate:!0}},mixins:[m.a],computed:L(L(L(L(L({},Object(C.c)("user",["taskExpireDay","isLoggedIn","userInfo","isCompanyAccount"])),Object(C.e)("payment",["paymentInfo"])),Object(C.e)("user",["collectData","userInfo"])),Object(C.c)("payment",["activeState"])),{},{renderCardList:function(){return this.list.filter((function(e){var t;return[3,"3"].includes(e.status)&&(null==e||null===(t=e.components)||void 0===t?void 0:t.length)}))},getExpirationTime:function(){return this.taskExpireDay},isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)},showExpireTime:function(){var e=this.paymentInfo.productLevel,t=[4,3].includes(e);return this.isLoggedIn&&!t&&0!==this.getExpirationTime},getMessageInfo:function(){var e,t,n={};(n.img_uris=[{url:""}],null!==(e=this.manageList)&&void 0!==e&&e.length)&&(n.img_uris=[null===(t=this.manageList)||void 0===t?void 0:t[0]]);return n},showDateIds:function(){var e=[],t=new Date,n=new Date(t);n.setDate(t.getDate()+1);var o=n;try{(this.list||[]).forEach((function(t){var n=null==t?void 0:t.create_at;Object(x.F)(n,o)||(e.push(t.id),o=n)}))}catch(e){}return e},checkIsShowBackTopBtn:function(){return this.showBackTopBtn&&this.list.length},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)},getBatchSaveParams:function(){return(this.manageList||[]).map((function(e){return{id:null==e?void 0:e.taskId,index:null==e?void 0:e.index}}))}}),mounted:function(){var e=this;this.initScrollBar(),this.debounceHandleScroll=Object(f.debounce)(this.handleScroll,600),this.getList(),this.$EventBus.$on("deleteHistoriesList",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(){var n=e.list.filter((function(e){return e.id!=t}));e.$set(e,"list",n),e.top.changeSelectedId("")};if(n.length){var l,r=e.list.findIndex((function(e){return e.id==t}))||0,c=null===(l=e.list)||void 0===l?void 0:l[r];if(c){var d=c.components.filter((function(e){return!n.includes(e.index)}));d.length?e.$set(e.list[r],"components",d):o()}}else o()}))},destroyed:function(){this.debounceHandleScroll=function(){}},beforeDestroy:function(){this.$EventBus.$off("deleteHistoriesList")},methods:L(L({},Object(C.b)("user",["getAccountInfo"])),{},{handleManageOperate:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"POST":this.sendToPost();break;case"SAVE":this.$refs.saveToPopover.openModal();break;case"DOWNLOAD":this.handleDownloadImages();break;case"DELETE":this.handleImageMangeDeleteImageConfirm();break;case"CANCEL":this.manageList=[],this.stopTask()}},handleSaveSuccess:function(){this.$refs.saveToPopover.handleClose(),this.manageList=[]},settingViewNsfw:function(){var e;this.btnLoading||(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw():this.$refs.auditDialog.showDialog())},applyNsfw:function(){var e=this;this.btnLoading=!0;var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(P.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),e.btnLoading=!1,e.getAccountInfo())})).finally((function(){e.btnLoading=!1}))},doLogEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:e,behavior_info:"on_comfyui_project_editing_page"};t&&(n.behavior_info_sub=t),this.$logEvent("log_actions",n)},viewBigImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.activeCard=e,this.viewImageList=[t],this.dialogVisible=!0},closeViewBigImage:function(){this.dialogVisible=!1,this.viewImageList=[],this.activeCard=null},deleteSingleImg:function(e,t){var n=this,o=t||{},l=o.id,r=void 0===l?"":l,c=o.components,d=(void 0===c?[]:c)[e-1].index,v=void 0===d?-1:d;Object(y.b)({id:r,index:v}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.list.forEach((function(e){var o;e&&(null==e?void 0:e.id)===(null==t?void 0:t.id)&&(n.$set(e,"components",((null==e?void 0:e.components)||[]).filter((function(e){return e.index!==v}))),null!=e&&null!==(o=e.components)&&void 0!==o&&o.length||n.handleDeleteTask(null==e?void 0:e.id))}))}))},updateImageInfo:function(e,source,t,n){var o=this;this.list.forEach((function(l){e&&e===(null==l?void 0:l.id)&&(l.components||[]).forEach((function(e){e.index===source.index&&o.$set(e,t,n)}))}))},insertDataToList:function(e){this.list.unshift(e)},handleDeleteTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.list.findIndex((function(t){return t.id===e}));-1!==t&&this.list.splice(t,1),this.top.changeSelectedId("")},changeViewMode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.doLogEvent(t),this.scrollToTop("instant"),this.viewMode=e},scrollToTop:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var t=this.$refs.scrollWrapper;if(t){t.scrollTo({top:0,behavior:e})}}catch(e){}},handleRefresh:function(){this.list=[],this.hasMore=!0,this.getList()},addHeadItem:function(e){var t=this,n=e||[],o=Object(l.a)(n,1)[0];this.list.unshift(o),setTimeout((function(){t.$refs.scrollWrapper.scrollTop=0}),0)},getList:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=(null===(e=this.$route.params)||void 0===e||e.id,{limit:20,scene:1,source:1});["",null,void 0].includes(n)||(l.time_from=n),this.loading=!0,this.isLoggedIn||(l.g_mode=1),Object(d.g)(l).then((function(e){var n=(null==e?void 0:e.data)||{},r=n.items,c=void 0===r?[]:r,d=n.has_more,v=void 0===d||d;if(t.hasMore=v,null!=l&&l.time_from){var m,f,_=Object(h.objectArrayDeduplicationMerge)(t.list,c||[]),y=null===(m=t.$refs)||void 0===m||null===(m=m.scrollWrapper)||void 0===m?void 0:m.scrollHeight;(f=t.list).push.apply(f,Object(o.a)(_)),y&&_.length&&t.scrollToTop(y,"instant")}else t.list=Array.isArray(c)&&null!=c&&c.length?c:[],t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var e=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===e&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&e>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")},initScrollBar:function(){var e=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){e.$refs.scrollWrapper.removeEventListener("scroll",e.initScrollBarStatus)}))}catch(e){}},initScrollBarStatus:function(){this.showScroll=!0},handleScroll:function(){try{var e=this.$refs.scrollWrapper;try{if(0===e.scrollTop&&0===e.scrollHeight)return}catch(e){}var t=(null==e?void 0:e.scrollHeight)-e.scrollTop;t-=null==e?void 0:e.clientHeight,e&&t<=30&&this.hasMore&&this.handleLoadMore()}catch(e){}},handleLoadMore:function(){var e=this.list.length?this.list[this.list.length-1]:"",t=e?e.create_at:"";this.getList(t)},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).info;console.log("info",t);var n=t.id,o=void 0===n?"":n,l={action:5,task_id:o};this.handleUpdateCancelBtnStatus(o,!0),Object(I.operateTask)(l).then((function(t){var n=(t||{}).status,l=(void 0===n?{}:n).code,code=void 0===l?"":l;if([1e4,"10000"].includes(code)){var r=e.list.findIndex((function(e){return e.id===o}));-1!==r&&e.list.splice(r,1)}else[1e4,"10000"].includes(code)||e.handleTaskError(code),e.$logEvent("log_generates",{work_id:o,operation:"cancel_generate"})})).finally((function(){e.handleUpdateCancelBtnStatus(o,!1)}))},handleTaskError:function(code){var e={7e4:this.$t("taskOperateFailed"),70001:this.$t("taskExceededDailyGenerationLimit"),70002:this.$t("taskQueueFull"),70003:this.$t("taskModelVersionNotSupportVariations"),70009:this.$t("taskModelForbidden"),70008:this.$t("taskArtWorkForbidden"),80008:this.$t("InsufficientBalance"),70045:this.$t("HttpErrorCode_70045")};code&&e[code]?"70045"==code?this.$message.warning(e[code]):this.$message.error(e[code]):this.$message.error(this.$t("ServerError"))},handleUpdateCancelBtnStatus:function(e,t){var n=this;this.list.forEach((function(o){o.id===e&&n.$set(o,"isLoading",t)}))}})},D=$,j=(n(4374),n(0)),component=Object(j.a)(D,(function(){var e,t,n=this,o=n._self._c;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"c-workflow-history-modal"},[o("div",{directives:[{name:"show",rawName:"v-show",value:n.checkIsShowBackTopBtn,expression:"checkIsShowBackTopBtn"}],staticClass:"generate-view-back-top",class:[n.checkIsShowViewNsfw?"":"generate-view-back-top-only"],on:{click:function(e){return n.scrollToTop(0)}}},[o("i",{staticClass:"el-icon-caret-top"})]),n._v(" "),n.checkIsShowViewNsfw?o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:n.enableNsfwMode?n.$t("hideAdultContent"):n.$t("showAdultContent"),placement:"left"}},[o("div",{staticClass:"generate-view-nsfw-plus",on:{click:n.settingViewNsfw}},[o("i",{staticClass:"iconfont",class:n.enableNsfwMode?"icon-work-hide":"icon-work-show"})])]):n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=n.manageList)||void 0===e?void 0:e.length,expression:"manageList?.length"}],staticClass:"easy-task-view-box-top padding-top-32"},[o("div",{staticClass:"easy-task-view-manage"},[o("div",{staticClass:"easy-task-view-manage-info"},[n._v("\n        "+n._s(n.$t("newGenerate11",{number:null===(t=n.manageList)||void 0===t?void 0:t.length}))+"\n      ")]),n._v(" "),o("div",{staticClass:"easy-task-view-manage-operate"},[n._l(n.manageBtnConfig,(function(e){return["DOWNLOAD"===e.code?[o("el-tooltip",{attrs:{content:n.$t("newGenerate54",{num:4}),placement:"top-start",effect:"light"}},[o("div",{key:"manage-btn_".concat(null==e?void 0:e.code),staticClass:"manage-operate-btn",on:{click:function(t){return t.stopPropagation(),n.handleManageOperate(null==e?void 0:e.code)}}},["DOWNLOAD"===e.code?[o("span",{staticClass:"manage-operate-btn-icon",class:[n.isInDownloadTask&&"DOWNLOAD"===e.code?"el-icon-loading":e.icon]})]:[o("span",{staticClass:"manage-operate-btn-icon",class:[e.icon]})],n._v(" "),o("span",{staticClass:"manage-operate-btn-text"},[n._v(n._s(n.$t(e.i18nKey)))])],2)])]:o("div",{key:"manage-btn_".concat(null==e?void 0:e.code),staticClass:"manage-operate-btn",on:{click:function(t){return t.stopPropagation(),n.handleManageOperate(null==e?void 0:e.code)}}},["DOWNLOAD"===e.code?[o("el-tooltip",{attrs:{content:n.$t("newGenerate54",{num:4}),placement:"top-start",effect:"light"}},[o("span",{staticClass:"manage-operate-btn-icon",class:[n.isInDownloadTask&&"DOWNLOAD"===e.code?"el-icon-loading":e.icon]})])]:[o("span",{staticClass:"manage-operate-btn-icon",class:[e.icon]})],n._v(" "),o("span",{staticClass:"manage-operate-btn-text"},[n._v(n._s(n.$t(e.i18nKey)))])],2)]})),n._v(" "),o("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:n.$t("Save"),isBatchSave:!0,allowCreateCollect:!0,batchSaveParams:n.getBatchSaveParams,message:n.getMessageInfo,isColorBtn:!0,showArrowIcon:!1},on:{saveSuccess:n.handleSaveSuccess}})],2)])]),n._v(" "),o("div",{ref:"scrollWrapper",staticClass:"c-easy-task-view-scroll-wrap",class:[n.showScroll?"":"show-scroll-bar"],on:{scroll:n.debounceHandleScroll}},[o("div",{staticClass:"c-easy-task-view"},[o("div",{ref:"scrollContainer",staticClass:"message-list"},[o("div",{staticClass:"messages-wrapper"},[o("div",{staticClass:"scroll-wrapper"},[n._l(n.list,(function(e,t){return[o("history-item",{key:e.id,attrs:{message:e,viewMode:n.viewMode,showTime:n.showDateIds.includes(null==e?void 0:e.id)},on:{deleteTask:n.handleDeleteTask,onRetryWork:n.retryWork,onCancelTask:n.handleCancelTask}})]}))],2)])]),n._v(" "),o("auditDialog",{ref:"auditDialog",on:{confirm:n.applyNsfw}}),n._v(" "),o("common-confirm-modal",{ref:"commonConfirmModal"})],1)])],1)}),[],!1,null,"e6c492f8",null);t.default=component.exports;installComponents(component,{SaveTo:n(124).default})},3303:function(e,t,n){"use strict";n.r(t);n(16);var o=n(2),l=(n(11),n(19),n(6),n(31),n(12),n(13),n(8),n(4),n(43),n(7),n(77),n(1)),r=n(10),c=n(876),d=n(102),v=n(29),m=n(119),h=n(319),f=n(97),_=n(3306),y=n(592);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=n(275),I={name:"historyItem",components:{historyImg:c.default,TryCreateMask:h.default,QuickQueue:m.default,commonConfirmModal:f.default,historyHeader:_.default,MessageOperateBtn:y.default},props:{message:{type:Object,default:function(){return{}},required:!0},viewMode:{type:String,default:""},showTime:{type:Boolean,default:!1}},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),c=t.getHours().toString().padStart(2,"0"),d=t.getMinutes().toString().padStart(2,"0"),v=t.getSeconds().toString().padStart(2,"0");return Object(r.F)(t,new Date)?"".concat(c,":").concat(d,":").concat(v):"".concat(n,"/").concat(o,"/").concat(l," ").concat(c,":").concat(d,":").concat(v)}},data:function(){return{defaultAvatar:k,alreadySave:!1,customColor:"#2E9E60",isLoading:!1,mapObj:{0:!0,1:!0,2:!0,3:!0,4:!0},currentClickBtn:"",trailBtnLoading:!1,hasAccelerated:!1}},watch:{message:{handler:function(e){var t=this;this.$nextTick((function(){t.isLoading=!(null==e||!e.isLoading),t.currentClickBtn=(null==e?void 0:e.loadingBtn)||""}))},deep:!0,immediate:!0}},computed:w(w(w({},Object(l.e)("payment",["paymentInfo"])),Object(l.c)("user",["isLoggedIn"])),{},{getImageList:function(){var e,t,n;return(null==this||null===(e=this.message)||void 0===e||null===(e=e.components)||void 0===e?void 0:e.length)>4?null==this||null===(t=this.message)||void 0===t||null===(t=t.components)||void 0===t?void 0:t.slice(0,4):null==this||null===(n=this.message)||void 0===n?void 0:n.components},computedPercentage:function(){return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===e?0:e}},convertStatusText:function(){var e,t={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return null!==(e=this.message)&&void 0!==e&&e.status_desc?t[this.message.status_desc]:""},isShowExpireTime:function(){var e=this.paymentInfo.productLevel,t=this.message.expiration_time,n=[4,3].includes(e),o=t&&t>0,l=!this.alreadySave;return!n&&(o&&l)},getExpireTime:function(){var e=this.message.expiration_time,t=(new Date).getTime();if(e&&e>t){var n=e-t,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},isShowCancel:function(){var e=this.message,t=e.status,n=e.category,o=e.type,l=![4,"4"].includes(t),r=![4,5,6,10,11,13,23,"23"].includes(o);return l&&![3,"3"].includes(n)&&r},isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)},checkBtnStatus:function(){var e=this;return function(t){var n={disabled:!1,loading:!1};return e.currentClickBtn===t?(n.loading=!0,n.disabled=!1,n):(e.currentClickBtn&&e.currentClickBtn!==t&&(n.loading=!1,n.disabled=!0),n)}},isShowFaster:function(){var e=this.message,t=e.status,n=e.speed_type;return 1==t&&1===n&&!this.hasAccelerated}}),methods:{handleMoreAction:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"TASK_INFO":this.$refs.easyTaskInfoPopup.show();break;case"REFRESH_TASK":this.handleReStart();break;case"DELETE_ALL":this.handleDeleteTask();break;case"SAVE_ALL":this.saveToSever()}},handleReStart:function(){var e,t,n,o={obj:w(w({},(null===(e=this.message)||void 0===e?void 0:e.creativity)||{}),{},{onlyUpdateInfo:!1,retryId:null===(t=this.message)||void 0===t?void 0:t.id,banner:Object.assign({},(null===(n=this.message)||void 0===n||null===(n=n.creativity)||void 0===n?void 0:n.cover)||{})}),type:"aiApp"};this.$EventBus.$emit("updateCategoryInfo",o)},handleDeleteTask:function(){var e=this;if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});try{this.$refs.commonConfirmModal.show({subTitle:"deleteTaskConfirm"}).then((function(){var t;if(null!=e&&null!==(t=e.message)&&void 0!==t&&t.id){var n={ids:[e.message.id]};e.globalLoading=!0,Object(v.deleteTaskRecord)(n).then((function(t){var n,o,l;["10000",1e4].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)?(e.$message.success(e.$t("deleteSuccess")),e.$emit("deleteTask",null==e||null===(o=e.message)||void 0===o?void 0:o.id)):e.$message({message:(null==t||null===(l=t.status)||void 0===l?void 0:l.msg)||e.$t("ServerError"),type:"error"})})).finally((function(){e.globalLoading=!1}))}})).catch((function(e){}))}catch(e){}},updateImageInfo:function(e,source,t,n){this.$emit("updateImageInfo",e,source,t,n)},deleteSingleImg:function(e){var t=this,n=this.message,o=n.id,l=void 0===o?"":o,r=n.components,c=(void 0===r?[]:r)[e-1].index,v=void 0===c?-1:c;Object(d.b)({id:l,index:v}).then((function(){var e;(t.$message({message:t.$t("deleteSuccess"),type:"success"}),t.message.components=t.message.components.filter((function(e){return e.index!==v})),t.message.components.length)||t.$emit("deleteTask",null==t||null===(e=t.message)||void 0===e?void 0:e.id)}))},handleNsfwStatus:function(e){var t=e.index,n=e.canViewNsfw;this.$set(this.mapObj,t,n)},handleTaskReStart:function(){this.$emit("operate",{info:this.message,type:"taskReStart"})},handleTrialFastQueue:function(){var e=this;this.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"click_try"});var t=this.message.id,n=void 0===t?"":t;this.trailBtnLoading=!0,Object(d.c)({id:n}).then((function(t){var n,code=null==t||null===(n=t.status)||void 0===n?void 0:n.code;70010===code?(e.$EventBus.$emit("showBreakDialog","FastQueueTipWeb","basic"),e.$logEvent("log_actions",{operation:"try_quick_queue",behavior_info:"vip_pop_show"})):1e4===code&&(e.hasAccelerated=!0,e.$message.success(e.$t("AccelerateSuccess"))),e.trailBtnLoading=!1}))},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){this.isLoading||(this.$message({message:this.$t("canceTaskNum",{num:3}),type:"info"}),this.$emit("onCancelTask",{info:this.message}))},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var e=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===e&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&e>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")}}},x=I,T=(n(4373),n(0)),component=Object(T.a)(x,(function(){var e,t,n,o,l,r=this,c=r._self._c;return c("div",{staticClass:"c-workflow-history-item"},[r.showTime&&null!==(e=r.message)&&void 0!==e&&e.create_at?c("div",{staticClass:"easy-msg-item-time-box"},[r._v("\n    "+r._s(r._f("formatDateTime")(null===(t=r.message)||void 0===t?void 0:t.create_at,this))+"\n  ")]):r._e(),r._v(" "),c("history-header",{ref:"easyMsgHeader",attrs:{message:r.message,isMyMsg:!0,moreActionsShow:!0,checkPermission:!0,isShowExpireTime:r.isShowExpireTime,expireTime:r.getExpireTime},on:{moreAction:r.handleMoreAction}}),r._v(" "),[2,"2",3,"3"].includes(r.message.status)&&null!==(n=r.message)&&void 0!==n&&null!==(n=n.components)&&void 0!==n&&n.length?c("div",{staticClass:"message-accessories"},[c("div",{staticClass:"media-attachments-container"},[r.message&&Array.isArray(null===(o=r.message)||void 0===o?void 0:o.components)&&null!==(l=r.message)&&void 0!==l&&null!==(l=l.components)&&void 0!==l&&l.length?r._l(r.getImageList,(function(e,t){return c("history-img",{key:"list-item_".concat(t),attrs:{"img-info":e,src:e.url,msgId:r.message.id,nsfw:e.nsfw,width:e.width,height:e.height,message:r.message,imgInfo:e,"operate-number":t+1,"view-status":r.mapObj},on:{viewNsfwStatus:r.handleNsfwStatus,deleteSingleImg:r.deleteSingleImg,saveSuccess:function(e){r.alreadySave=!0}}})})):r._e()],2)]):r._e(),r._v(" "),[1,"1",2,"2",4,"4"].includes(r.message.status)?c("div",{staticClass:"message-process-container"},[[2,"2"].includes(r.message.status)&&r.computedPercentage(r.message)?c("div",{staticClass:"message-process-panel"},[c("el-progress",{staticClass:"message-process-panel-progress",attrs:{percentage:r.computedPercentage(r.message),color:r.customColor,"show-text":!1,"stroke-width":12}})],1):r._e(),r._v(" "),c("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(r.message.status)?[c("span",{staticClass:"process-operate-box-text"},[r._v(r._s(r.$t("TaskStatusWaitingToStart"))+" "),c("span",{staticClass:"message-process-loading-span"})])]:[2,"2"].includes(r.message.status)&&!r.computedPercentage(r.message)?[c("span",{staticClass:"process-operate-box-text"},[r._v(r._s(r.$t("TaskStatusPreparing"))+" "),c("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(r.message.status)?c("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[r._v(r._s(r.convertStatusText))]):c("span",{staticClass:"process-operate-box-text"},[r._v(r._s(r.$t("youHaveCompleted"))),c("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[r._v(r._s(r.computedPercentage(r.message))+"%")]),r._v(" "),c("span",{staticClass:"message-process-loading-span"})]),r._v(" "),r.isShowFaster?c("el-button",{staticClass:"message-process-operate-box-btn fast-queue",attrs:{size:"mini",loading:r.trailBtnLoading},on:{click:r.handleTrialFastQueue}},[c("i",{staticClass:"iconfont icon-trail-fast-queue"}),r._v(" "),c("span",{staticClass:"words"},[r._v(r._s(r.$t("TrialFastQueue")))])]):r._e(),r._v(" "),r.isShowCancel?c("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:r.$t("canceTaskNum",{num:3}),placement:"top-start"}},[c("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:r.isLoading},attrs:{type:"danger",size:"mini"},on:{click:r.handleCancelTask}},[r._v("\n          "+r._s(r.isLoading?"Canceling…":r.$t("CancelJob"))+"\n        ")])],1):r._e(),r._v(" "),[4,"4"].includes(r.message.status)?c("message-operate-btn",{key:"reStart",attrs:{loading:r.checkBtnStatus("reStart").loading,disabled:r.checkBtnStatus("reStart").disabled},on:{click:r.handleTaskReStart}},[c("i",{staticClass:"iconfont icon-refresh-icon2",staticStyle:{"font-size":"18px"}})]):r._e()],2)]):r._e(),r._v(" "),c("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"ba7ac7e6",null);t.default=component.exports},3304:function(e,t,n){"use strict";n.r(t);var o=n(2),l=(n(11),n(6),n(50),n(398),n(16),n(22),n(122),n(399),n(8),n(12),n(13),n(4),n(7),n(26),n(241)),r=n(10);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"LyricAudio",props:{audio:{type:Object,default:function(){return{}}},message:{type:Object,required:!0}},data:function(){return{currentTime:0,currentLyricIndex:-1,formattedLyrics:[],lyricElements:[],scrolling:!1,isPlaying:!1,isMuted:!1,playProgress:0,duration:0,showVolumeSlider:!1,volumeLevel:100,isDraggingVolume:!1}},computed:{lyric:function(){try{return JSON.parse(this.audio.content)}catch(e){return[]}},subTitle:function(){var e;switch((null===(e=this.message)||void 0===e?void 0:e.sub_type)||0){case 55:return this.$t("song_mode1");case 56:return this.$t("song_mode2");default:return""}},isNormalMode:function(){var e;return[23].includes(null===(e=this.message)||void 0===e?void 0:e.task_domain_type)}},created:function(){this.parseLyrics()},watch:{audio:{handler:function(){this.parseLyrics()},deep:!0}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.audioPlayer&&(l.a.register(e),e.initVolume())})),document.addEventListener("mousemove",this.handleVolumeMouseMove),document.addEventListener("mouseup",this.handleVolumeMouseUp)},beforeDestroy:function(){l.a.unregister(this),document.removeEventListener("mousemove",this.handleVolumeMouseMove),document.removeEventListener("mouseup",this.handleVolumeMouseUp)},methods:{stop:function(){this.$refs.audioPlayer&&(this.$refs.audioPlayer.pause(),this.$refs.audioPlayer.currentTime=0,this.isPlaying=!1)},onEnded:function(){var e;this.isPlaying=!1,this.$xyLogEvent({front_operation:"click",entity_name:"audio_end",entity_type:"lyric-audio",event_name:"log_action_front",obj_id:(null===(e=this.audio)||void 0===e?void 0:e.id)||"",obj_info:{is_over:1}})},parseLyrics:function(){this.formattedLyrics=this.lyric.filter((function(section){return section.lines})).flatMap((function(section){return section.lines.map((function(line){return d(d({},line),{},{start:line.start/1e3,end:line.end/1e3})}))})).sort((function(a,b){return a.start-b.start}))},onLoadedMetadata:function(){this.duration=this.audio.duration||this.$refs.audioPlayer.duration},onTimeUpdate:function(){var e=this;if(this.$refs.audioPlayer){this.currentTime=this.$refs.audioPlayer.currentTime;var t=this.$refs.audioPlayer.duration||1;this.playProgress=this.currentTime/t*100;var n=this.formattedLyrics.findIndex((function(t,n,o){return e.currentTime>=t.start&&(n===o.length-1||e.currentTime<o[n+1].start)}));-1!==n&&n!==this.currentLyricIndex&&(this.currentLyricIndex=n,this.scrollToCurrentLyric())}},jumpToTime:function(e){this.$refs.audioPlayer&&(this.$refs.audioPlayer.currentTime=e,this.$refs.audioPlayer.paused&&this.$refs.audioPlayer.play())},scrollToCurrentLyric:function(){var e=this;this.$nextTick((function(){if(e.currentLyricIndex>=0&&e.lyricElements[e.currentLyricIndex]){var t=e.lyricElements[e.currentLyricIndex],n=e.$refs.scrollView;if(!t||!n)return;var o=t.offsetTop,l=n.clientHeight-t.clientHeight-50;e.scrolling=!0,n.scrollTo({top:o-l,behavior:"smooth"}),setTimeout((function(){e.scrolling=!1}),300)}}))},togglePlay:function(){this.$refs.audioPlayer&&(this.isPlaying?this.$refs.audioPlayer.pause():(l.a.stopAllExcept(this),this.$refs.audioPlayer.play()))},toggleMute:function(){this.$refs.audioPlayer&&(this.isMuted=!this.isMuted,this.$refs.audioPlayer.muted=this.isMuted)},prevTrack:function(){this.$emit("prev")},nextTrack:function(){this.$emit("next")},formatTime:function(e){return Object(r.U)(Math.round(e))},seekAudio:function(e){if(this.$refs.audioPlayer){var t=e.currentTarget,n=e.offsetX/t.clientWidth;this.$refs.audioPlayer.currentTime=n*this.$refs.audioPlayer.duration}},setVolumeByClick:function(e){if(this.$refs.audioPlayer){var t=e.currentTarget.clientHeight,n=(t-e.offsetY)/t*100;this.setVolume(n)}},setVolume:function(e){var t=Math.max(0,Math.min(100,e));this.volumeLevel=t,this.$refs.audioPlayer&&(this.$refs.audioPlayer.volume=t/100,localStorage.setItem("lyricAudioVolume",t),t>0&&this.isMuted?(this.isMuted=!1,this.$refs.audioPlayer.muted=!1):0!==t||this.isMuted||(this.isMuted=!0,this.$refs.audioPlayer.muted=!0))},handleVolumeMouseMove:function(e){if(this.isDraggingVolume&&this.showVolumeSlider){var t=document.querySelector(".volume-slider-container");if(t){var rect=t.getBoundingClientRect(),n=rect.height,o=(rect.bottom-e.clientY)/n*100;this.setVolume(o)}}},handleVolumeMouseUp:function(){this.isDraggingVolume=!1},initVolume:function(){if(this.$refs.audioPlayer){var e=localStorage.getItem("lyricAudioVolume");null!==e?(this.volumeLevel=parseFloat(e),this.$refs.audioPlayer.volume=this.volumeLevel/100):this.volumeLevel=100*this.$refs.audioPlayer.volume}}},beforeUpdate:function(){this.lyricElements=[]}},m=(n(4359),n(0)),component=Object(m.a)(v,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"lyric-audio",style:{"--coverUrl":t.isNormalMode?"":"url(".concat(t.audio.cover_url,")")},attrs:{"data-group":"lyric-audio"}},[n("div",{staticClass:"lyric-audio-container"},[n("div",{staticClass:"lyric-audio-content"},[n("div",{staticClass:"lyric-container"},[t.isNormalMode?[n("div",{staticClass:"lyric-bg-img"},[n("img",{attrs:{src:t.audio.cover_url,alt:"封面"}})])]:[n("div",{ref:"scrollView",staticClass:"lyric-scroll-view"},[n("div",{staticClass:"lyric-padding-top"}),t._v(" "),t._l(t.formattedLyrics,(function(e,o){return n("div",{key:o,ref:function(e){e&&(t.lyricElements[o]=e)},refInFor:!0,staticClass:"lyric-item",class:{active:t.currentLyricIndex===o},on:{click:function(n){return t.jumpToTime(e.start)}}},[t._v("\n              "+t._s(e.text)+"\n            ")])})),t._v(" "),n("div",{staticClass:"lyric-padding-bottom"})],2),t._v(" "),n("div",{staticClass:"lyric-active-line"})]],2)]),t._v(" "),n("div",{staticClass:"lyric-audio-control"},[n("div",{staticClass:"progress-bar"},[n("div",{staticClass:"progress-bg",on:{click:t.seekAudio}}),t._v(" "),n("div",{staticClass:"progress-indicator",style:{width:"".concat(t.playProgress,"%")}}),t._v(" "),n("div",{staticClass:"time-indicator"},[n("span",[t._v(t._s(t.formatTime(t.currentTime)))]),t._v(" "),n("span",[t._v(t._s(t.formatTime(t.duration)))])])]),t._v(" "),n("div",{staticClass:"control-container"},[n("div",{staticClass:"audio-info"},[t.isNormalMode?t._e():[n("div",{staticClass:"cover-thumb"},[n("img",{attrs:{src:t.audio.cover_url,alt:"封面"}})]),t._v(" "),n("div",{staticClass:"audio-desc"},[n("div",{staticClass:"audio-title ellipsis"},[t._v(t._s(t.audio.title))]),t._v(" "),n("div",{staticClass:"audio-subtitle"},[t._v(t._s(t.subTitle))])])]],2),t._v(" "),n("div",{staticClass:"player-controls"},[n("button",{staticClass:"control-btn prev",on:{click:t.prevTrack}},[n("i",{staticClass:"iconfont icon-icon-lastsong"})]),t._v(" "),n("button",{staticClass:"control-btn play-pause",attrs:{"data-event":"audio-play","data-id":null===(e=t.audio)||void 0===e?void 0:e.id},on:{click:t.togglePlay}},[n("i",{staticClass:"iconfont",class:t.isPlaying?"icon-bofangz":"icon-zanting1"})]),t._v(" "),n("button",{staticClass:"control-btn next",on:{click:t.nextTrack}},[n("i",{staticClass:"iconfont icon-icon-nextsong"})])]),t._v(" "),n("div",{staticClass:"volume-controls"},[n("button",{staticClass:"volume-btn",on:{click:t.toggleMute,mouseenter:function(e){t.showVolumeSlider=!0}}},[n("i",{staticClass:"iconfont",class:t.isMuted?"icon-icon-home-mute":"icon-icon-volumn"})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showVolumeSlider,expression:"showVolumeSlider"}],staticClass:"volume-slider-container",on:{mouseleave:function(e){t.showVolumeSlider=!1}}},[n("div",{staticClass:"volume-level-indicator"},[t._v(t._s(Math.round(t.volumeLevel))+"%")]),t._v(" "),n("div",{staticClass:"volume-slider-bg",on:{click:t.setVolumeByClick,mousedown:function(e){t.isDraggingVolume=!0}}}),t._v(" "),n("div",{staticClass:"volume-slider-indicator",style:{height:"".concat(t.volumeLevel,"%")}})])])]),t._v(" "),n("audio",{ref:"audioPlayer",attrs:{src:t.audio.url,autoplay:""},on:{timeupdate:t.onTimeUpdate,loadedmetadata:t.onLoadedMetadata,play:function(e){t.isPlaying=!0},pause:function(e){t.isPlaying=!1},ended:t.onEnded}})])])])}),[],!1,null,"72207cf4",null);t.default=component.exports},3305:function(e,t,n){"use strict";n.r(t);n(19),n(31);var o=n(25),l={name:"OneLineEllipsisWithExpand",props:{text:{type:String,required:!0}},data:function(){return{expanded:!1,isOverflow:!1,displayText:"",btnOffsetY:0,debouncedResizeHandler:null}},created:function(){this.debouncedResizeHandler=Object(o.debounce)(this.reliableCalcEllipsis,300)},mounted:function(){this.reliableCalcEllipsis(),window.addEventListener("resize",this.debouncedResizeHandler)},beforeDestroy:function(){this.debouncedResizeHandler.cancel(),window.removeEventListener("resize",this.debouncedResizeHandler),this._detector&&document.body.removeChild(this._detector),this._observer&&this._observer.disconnect()},watch:{text:function(){this.reliableCalcEllipsis()},"$slots.default":{handler:function(){this.reliableCalcEllipsis()},deep:!0},expanded:function(e){e&&this.checkLastLineInExpandedState()}},methods:{checkLastLineInExpandedState:function(){var e=this,content=this.$refs.content;content&&this.expanded&&this.$nextTick((function(){e.$nextTick((function(){var t=content.querySelector("span");if(t){var n=document.createRange();n.selectNodeContents(t);var o=n.getClientRects();if(0!==o.length){var l=o[o.length-1],r=.7*content.clientWidth,c=l.width>r;e.btnOffsetY=c?20:0}}}))}))},toggle:function(){this.expanded=!this.expanded,this.expanded?this.checkLastLineInExpandedState():this.btnOffsetY=0},reliableCalcEllipsis:function(){var e=this;this.$nextTick((function(){e.calcEllipsis()}))},calcEllipsis:function(){var e=this;this.$nextTick((function(){var content=e.$refs.content;if(content){var style=getComputedStyle(content),t=parseFloat(style.lineHeight),n=document.createElement("div");if(n.style.position="absolute",n.style.visibility="hidden",n.style.zIndex="-1",n.style.whiteSpace="pre-wrap",n.style.wordBreak=style.wordBreak,n.style.font=style.font,n.style.fontSize=style.fontSize,n.style.lineHeight=style.lineHeight,n.style.width=content.clientWidth+"px",n.innerText=e.text,document.body.appendChild(n),!(n.scrollHeight>3*t+1))return e.expanded=!0,void(e.isOverflow=!1);for(var o=e.text.length,i=1;i<=e.text.length;i++)if(n.innerText=e.text.slice(0,i),n.scrollHeight>2*t+1){o=i-1;break}for(var l=o,r=e.text.length,c=l+1;c<=e.text.length;c++)if(n.innerText=e.text.slice(0,c),n.scrollHeight>3*t+1){r=c-1;break}var d=e.text.slice(l,r);e.displayText="".concat(e.text.slice(0,o)).concat(d.slice(0,d.length/2-10),"..."),e.expanded=!1,e.isOverflow=!0,document.body.removeChild(n)}}))}}},r=(n(4362),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("div",{ref:"root",staticClass:"smart-ellipsis"},[t("div",{ref:"content",staticClass:"content",class:{expanded:e.expanded}},[e.expanded?[t("span",[e._v(e._s(e.text))])]:[t("span",[e._v(e._s(e.displayText))])]],2),e._v(" "),e.isOverflow?t("button",{staticClass:"expand-btn",style:{transform:"translateY(".concat(e.btnOffsetY,"px)")},on:{click:e.toggle}},[e._v("\n    "+e._s(e.expanded?e.$t("PackUp"):e.$t("viewMore"))+"\n    "),t("i",{class:e.expanded?"el-icon-arrow-up":"el-icon-arrow-down"})]):e._e()])}),[],!1,null,"0fe834ea",null);t.default=component.exports},3306:function(e,t,n){"use strict";n.r(t);n(19),n(16),n(18);var o=n(2),l=n(3),r=(n(20),n(11),n(22),n(6),n(24),n(12),n(13),n(8),n(4),n(43),n(7),n(21),n(77),n(26),n(1)),c=n(10),d=n(878),v=n(46);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"historyHeader",inject:["easyTop"],components:{MessageLoraPopup:d.default},filters:{formatDateTime:function(e){var t=new Date(e),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),d=t.getMinutes().toString().padStart(2,"0"),v=t.getSeconds().toString().padStart(2,"0");return Object(c.F)(t,new Date)?"".concat(r,":").concat(d,":").concat(v):"".concat(n,"/").concat(o,"/").concat(l," ").concat(r,":").concat(d,":").concat(v)}},props:{message:{type:Object,default:function(){return{}},required:!0},isShowExpireTime:{type:[Boolean,Number],default:!1},expireTime:{type:String,default:""},isMyMsg:{type:Boolean,default:!1},moreActionsShow:{type:Boolean,default:!1},checkPermission:{type:Boolean,default:!1},checkIsChannelOwner:{type:Boolean,default:!1}},data:function(){return{isI18nToggled:!1,isFoldPrompt:!0,morePopoverVisible:!1,showFoldBtn:!0,isInDownloadTask:!1,pollingTimer:null}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$EventBus.$on("messageItemPromptWidthUpdate",e.handleResize),e.isI18nToggled=!e.accountSettingsData.is_off_localization,e.checkPromptOverflow();case 3:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.$EventBus.$off("messageItemPromptWidthUpdate",this.handleResize),this.pollingTimer&&window.clearTimeout(this.pollingTimer),this.pollingTimer=null,this.isInDownloadTask=!1},computed:h(h(h({},Object(r.c)("user",["accountSettingsData","isCompanyAccount","isLoggedIn"])),Object(r.e)("payment",["paymentInfo"])),{},{getRenderImageUrl:function(){var e,t=(null===(e=this.message)||void 0===e||null===(e=e.creativity)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url)||"";return t?Object(c.K)(t,"low"):t},allowRefreshOrMoreOperate:function(){return[3,4].includes(this.message.status)},allowRestartOperate:function(){var e,t;return![4,"4","5",5,6,"6",10,"10",2,"2",23,"23",25,"25",26,"26"].includes(null===(e=this.message)||void 0===e?void 0:e.type)&&[1,"1","2",2,3,"3"].includes(null===(t=this.message)||void 0===t?void 0:t.status)},moreActionShow:function(){return[2,4,13].includes(this.message.type)},isStudioMode:function(){return[7,"7","studio",11,"11"].includes(this.message.category)},setI18nPrompt:function(){var e=this.message.local_prompt,t=this.message.prompt?this.message.prompt:"";return this.isI18nToggled?e:t},isVip:function(){var e,t;return!!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState||null!==(t=this.paymentInfo)&&void 0!==t&&t.liteActiveState)}}),methods:{toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var e=(this.paymentInfo||{}).vipType,t=["svip_1","svip_2","svip_1_trial","svip_2_trial","vip_lite"].includes(e)||e.includes("vip_day");this.isVip?t&&this.$EventBus.$emit("showUpgradeDialog","NoExpireTimeTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic")},handleJumpModelDetail:function(e){if(null!=e&&e.id){var t=this.localePath("/workFlowAppDetail/".concat(e.id));window.open(t,"_blank")}},handleLogEvent:function(e){this.$logEvent("log_actions",{operation:e,behavior_info:"on_new_create_flow_page",behavior_info_sub:"on_create_flow_topbar"})},handleClickMore:function(){this.handleLogEvent("click_more")},handleResize:function(){this.checkPromptOverflow()},checkPromptOverflow:function(){var e=this;this.$nextTick((function(){try{var element=e.$refs.promptBox;return void(e.isFoldPrompt?e.showFoldBtn=element.scrollWidth>element.clientWidth:e.showFoldBtn=element.offsetHeight>30)}catch(e){}e.showFoldBtn=!0}))},toggleFoldPromptStatus:function(){this.handleLogEvent("click_view_prompt"),this.isFoldPrompt=!this.isFoldPrompt,this.checkPromptOverflow()},toggleI18nPrompt:function(){this.handleLogEvent("click_translate"),this.isI18nToggled=!this.isI18nToggled,this.checkPromptOverflow()},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";content&&(Object(c.g)(content),this.$message.success(this.$t("CopySuccess")))},handleRefreshTask:function(){if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});this.handleLogEvent("click_retry"),this.$emit("moreAction","REFRESH_TASK")},handleMoreActionClick:function(){return this.isLoggedIn||(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"})),!1},handleMoreAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});this.allowRefreshOrMoreOperate&&(this.handleMoreActionLogEvent(e),"DOWNLOAD_ALL"!==e?this.$emit("moreAction",e):this.handleDownloadImages())},handleMoreActionLogEvent:function(e){var t="";switch(e){case"SAVE_ALL":t="click_save_all";break;case"DOWNLOAD_ALL":t="click_download_all";break;case"TASK_INFO":t="click_task_info";break;case"DELETE_ALL":t="click_delete_all"}t&&this.$logEvent("log_actions",{operation:t,behavior_info:"on_new_create_flow_page"})},handleDownloadImages:function(){var e,t,n=this;if(!this.isInDownloadTask){var o={download_task_id:"",items:[]};o.items=((null===(e=this.message)||void 0===e?void 0:e.components)||[]).map((function(e){var t;return{index:e.index,id:null===(t=n.message)||void 0===t?void 0:t.id}})),null!==(t=o.items)&&void 0!==t&&t.length&&(this.isInDownloadTask=!0,Object(v.easyDownloadAllImages)(o).then((function(e){var t;if(1e4===(null==e||null===(t=e.status)||void 0===t?void 0:t.code)){var o=(null==e?void 0:e.data)||{},l=o.download_task_id,r=void 0===l?"":l;o.url;return n.pollingTask(r)}n.isInDownloadTask=!1})).catch((function(e){n.isInDownloadTask=!1})))}},stopTask:function(){this.pollingTimer&&window.clearTimeout(this.pollingTimer),this.pollingTimer=null,this.isInDownloadTask=!1},pollingTask:function(e){var t=this;return new Promise((function(n,o){t.isInDownloadTask=!0;var l={download_task_id:e,items:[]};t.pollingTimer=setTimeout((function(){Object(v.easyDownloadAllImages)(l).then((function(l){var r,c;if(1e4!==(null==l||null===(r=l.status)||void 0===r?void 0:r.code))return t.pollingTimer&&window.clearTimeout(t.pollingTimer),t.pollingTimer=null,t.$message.error(t.$t("ServerError")),t.isInDownloadTask=!1,void o();var d=(null==l||null===(c=l.data)||void 0===c?void 0:c.url)||"";["",null,void 0].includes(d)?t.pollingTask(e):(t.pollingTimer&&window.clearTimeout(t.pollingTimer),t.pollingTimer=null,t.isInDownloadTask=!1,t.openDownloadLink(d),t.handleClosePopover(),n())})).catch((function(e){t.$message.error(t.$t("ServerError")),t.isInDownloadTask=!1,o()}))}),1e3)}))},openDownloadLink:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=e,a.download="image_download",a.click(),document.body.removeChild(a)}},handleClosePopover:function(){try{this.$refs.myPopover.doClose()}catch(e){}}}},_=f,y=(n(4371),n(4372),n(0)),component=Object(y.a)(_,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C=this,w=C._self._c;return w("div",{staticClass:"c-easy-msg-item-header"},[w("div",{staticClass:"msg-item-header-info-panel"},[w("div",{staticClass:"msg-item-header-info-panel-tag"},[C._v(C._s(C.$t("Swtft_App")))]),C._v(" "),w("div",{staticClass:"msg-item-header-info-panel-prompt-box",class:[C.isFoldPrompt&&"align-items-center"]},[w("div",{ref:"promptBox",staticClass:"info-panel-prompt-box-content",class:[C.isFoldPrompt&&"text-ellipsis"]},[C._v("\n        "+C._s(null===(e=C.message)||void 0===e||null===(e=e.creativity)||void 0===e?void 0:e.name)+"\n      ")]),C._v(" "),w("span",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0].includes(C.setI18nPrompt)&&C.showFoldBtn,expression:"!['', null, void 0].includes(setI18nPrompt) && showFoldBtn"}],staticClass:"info-panel-prompt-box-icon",class:[C.isFoldPrompt?"iconfont icon-add-tag":"el-icon-minus"],on:{click:function(e){return e.stopPropagation(),C.toggleFoldPromptStatus.apply(null,arguments)}}})])]),C._v(" "),w("div",{staticClass:"msg-item-header-operate-bar",class:[!C.isFoldPrompt&&"align-items-flex-start"]},[w("div",{staticClass:"operate-bar-model-card",on:{click:function(e){var t;return e.stopPropagation(),C.handleJumpModelDetail(null===(t=C.message)||void 0===t?void 0:t.creativity)}}},[w("el-image",{staticClass:"operate-bar-model-card-img",attrs:{src:C.getRenderImageUrl}},[w("template",{slot:"error"},[w("div",{staticClass:"operate-bar-model-card-img"})])],2),C._v(" "),w("div",{staticClass:"operate-bar-model-card-info"},[w("div",{staticClass:"operate-bar-model-card-info-title"},[C._v(C._s(C.$t("Swtft_App")))]),C._v(" "),w("div",{staticClass:"operate-bar-model-card-info-sub-title"},[C._v(C._s(null===(t=C.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name))])])],1),C._v(" "),[3,"3"].includes(null===(n=C.message)||void 0===n?void 0:n.status)?w("div",{directives:[{name:"show",rawName:"v-show",value:!["",null,void 0,0].includes(null===(o=C.message)||void 0===o||null===(o=o.components)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.width),expression:"!['', null, void 0, 0].includes(message?.components?.[0]?.width)"}],staticClass:"operate-bar-num-card"},[w("span",{staticClass:"operate-bar-num-card-icon iconfont icon-home_icon_lora"}),C._v(" "),w("span",{staticClass:"operate-bar-num-card-text operate-bar-num-card-text-100"},[C._v(C._s("".concat(null===(l=C.message)||void 0===l||null===(l=l.components)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.width," x ").concat(null===(r=C.message)||void 0===r||null===(r=r.components)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.height))+"px")])]):C._e(),C._v(" "),C.isMyMsg&&C.isLoggedIn?w("el-popover",{attrs:{trigger:"hover","popper-class":"custom-popver"}},[w("div",{staticClass:"easy-task-info-tips"},[w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("TaskID")))]),w("span",{staticClass:"task-info-tips-copy",on:{click:function(e){return C.handleCopyAll(C.message.id)}}},[C._v(C._s(C.message.id)+" "),w("i",{staticClass:"iconfont icon-copy-ops"})])]),C._v(" "),3!==C.message.status||C.isCompanyAccount?C._e():[[1,2,"1","2"].includes(null===(c=C.message)||void 0===c?void 0:c.pub_community)?w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("status")))]),C._v(" "),w("span",{staticClass:"task-pub-status"},[C._v(C._s([2,"2"].includes(null===(d=C.message)||void 0===d?void 0:d.pub_community)?C.$t("createSetting1"):C.$t("createSetting2")))])]):C._e(),C._v(" "),w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("expend")))]),C._v(" "),w("span",{staticClass:"task-info-tips-content"},[w("span",[C._v(C._s(C.$t("tempCoins"))+" : "+C._s(null===(v=C.message)||void 0===v||null===(v=v.deduction_detail)||void 0===v?void 0:v.temp_hashrate))]),C._v(" "),w("span",[C._v(C._s(C.$t("calculateCoins"))+" : "+C._s(null===(m=C.message)||void 0===m||null===(m=m.deduction_detail)||void 0===m?void 0:m.hashrate))])])]),C._v(" "),null!==(h=C.message)&&void 0!==h&&null!==(h=h.deduction_detail)&&void 0!==h&&h.history_hashrate?w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("currentBalance")))]),C._v(" "),w("span",{staticClass:"task-info-tips-content"},[w("span",[C._v(C._s(C.$t("tempCoins"))+" : "+C._s(null===(f=C.message)||void 0===f||null===(f=f.deduction_detail)||void 0===f?void 0:f.after_temp_hashrate))]),C._v(" "),w("span",[C._v(C._s(C.$t("calculateCoins"))+" : "+C._s(null===(_=C.message)||void 0===_||null===(_=_.deduction_detail)||void 0===_?void 0:_.after_hashrate))])])]):C._e(),C._v(" "),C.message.create_at?w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("newGenerate26")))]),C._v(" "),w("span",{staticClass:"task-info-tips-text"},[C._v(C._s(C._f("formatDateTime")(C.message.create_at)))])]):C._e(),C._v(" "),C.isShowExpireTime?w("p",[w("span",{staticClass:"task-info-tips-label"},[C._v(C._s(C.$t("trainExpirationTime")))]),C._v(" "),w("span",{staticClass:"task-info-tips-text",staticStyle:{cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),C.toMall.apply(null,arguments)}}},[C._v(C._s(C.expireTime))])]):C._e()]],2),C._v(" "),w("div",{staticClass:"msg-item-header-operate-bar-refresh-btn",attrs:{slot:"reference"},slot:"reference"},[w("i",{staticClass:"iconfont icon-icon-information"})])]):C._e(),C._v(" "),C.isLoggedIn?C._e():[w("div",{staticClass:"msg-item-header-operate-bar-refresh-btn",on:{click:function(e){return e.stopPropagation(),C.handleMoreActionClick.apply(null,arguments)}}},[w("i",{staticClass:"iconfont icon-icon-information"})])],C._v(" "),w("div",{directives:[{name:"show",rawName:"v-show",value:C.allowRestartOperate,expression:"allowRestartOperate"}],staticClass:"msg-item-header-operate-bar-refresh-btn",on:{click:function(e){return e.stopPropagation(),C.handleRefreshTask.apply(null,arguments)}}},[w("i",{staticClass:"iconfont icon-refresh-icon2"})]),C._v(" "),C.isLoggedIn&&C.moreActionsShow&&C.allowRefreshOrMoreOperate&&null!==(y=C.easyTop)&&void 0!==y&&y.isShowPopup?w("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"easy-msg-item-more-popover","visible-arrow":!1,trigger:"click"},model:{value:C.morePopoverVisible,callback:function(e){C.morePopoverVisible=e},expression:"morePopoverVisible"}},[w("div",{staticClass:"pop-btns flex"},[C.checkPermission||C.checkIsChannelOwner?w("button",{on:{click:function(e){return C.handleMoreAction("DELETE_ALL")}}},[w("span",{staticClass:"pop-btns-icon"},[w("i",{staticClass:"iconfont icon-a-pyDelete1"})]),C._v(" "),w("span",{staticClass:"pop-btns-text"},[C._v(C._s(C.$t("DeleteAll")))])]):C._e()]),C._v(" "),w("div",{staticClass:"msg-item-header-operate-bar-more-btn",attrs:{slot:"reference"},on:{click:C.handleClickMore},slot:"reference"},[w("i",{staticClass:"iconfont icon-more"})])]):C._e(),C._v(" "),C.isLoggedIn?C._e():[w("div",{staticClass:"msg-item-header-operate-bar-more-btn",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),C.handleMoreActionClick.apply(null,arguments)}},slot:"reference"},[w("i",{staticClass:"iconfont icon-more"})])]],2)])}),[],!1,null,"70e04712",null);t.default=component.exports},3307:function(e,t,n){"use strict";n.r(t);n(19),n(6),n(16),n(4),n(21),n(11),n(72),n(89),n(12),n(13),n(43);var o=n(14),l=n(3),r=n(2),c=(n(20),n(32),n(50),n(69),n(22),n(31),n(122),n(49),n(18),n(8),n(177),n(28),n(218),n(113),n(40),n(44),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(7),n(41),n(26),n(29)),d=n(57),v=n(25),m=n(294),h=n(813),f=n(35),_=n.n(f),y=n(106),C=n(1),w=n(85),k=n(9),I=n(210),x=n(1172),T=n(46),S=n(80),O=n(124),P=n(10),M=n(97),L=n(3308),$=n(3309),D=n(3310),j=n(3311),E=n(600),A=n(686),N=n(3312),V=n(563),R=n(796),F=n(102);function B(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return U(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?U(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function U(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W={name:"MessageList",provide:function(){return{easyTaskView:this}},components:{EasyMsgItem:x.default,auditDialog:I.a,SaveTo:O.default,commonConfirmModal:M.default,BackToTop:L.default,NsfwToggle:$.default,MessageManage:D.default,UserGuide:j.default,FilterButton:E.default,EasyMessageImg:A.default,ModeToggle:N.default,EasyMessageAudio:V.default,RetentionTimerButton:R.default},props:{channelId:{type:String,default:""}},mixins:[h.pollMixin],inject:["easyTop"],data:function(){return{manageBtnConfig:[{code:"POST",i18nKey:"Post",icon:"iconfont icon-icon-Posts"},{code:"SAVE",i18nKey:"Save",icon:"iconfont icon-workflow_icon_save"},{code:"DOWNLOAD",i18nKey:"Download",icon:"el-icon-download"},{code:"DELETE",i18nKey:"Delete",icon:"iconfont icon-delete-gpt"},{code:"CANCEL",i18nKey:"Cancel",icon:"iconfont icon-close-btn"}],manageList:[],list:[],debounceHandleScroll:function(){},loading:!1,showBackTopBtn:!1,last1:0,last2:0,timer:null,showScroll:!1,showNoDataContent:!1,keyword:"",btnLoading:!1,debounceResize:function(){},isInDownloadTask:!1,taskVersion:"v2",isLoadingMore:!1,scrollThreshold:200,debounceSearch:function(){},gridContainerWidth:0,visibleButtonCount:3,resizeObserver:null}},computed:z(z(z(z(z({},Object(C.e)("user",["userInfo"])),Object(C.c)("payment",["activeState"])),Object(C.c)("user",["isLoggedIn","isCompanyAccount"])),Object(C.e)("payment",["paymentInfo"])),{},{displayMode:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.viewMode},isShowMessageManage:function(){var e;return(null===(e=this.easyTop)||void 0===e?void 0:e.isShowMessageManage)||!1},taskDomainTypes:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.task_domain_types},useModelSeries:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.use_model_series},saveModes:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.save_modes},timeFrom:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.time_from},timeTo:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.time_to},getMessageInfo:function(){var e,t,n={};(n.img_uris=[{url:""}],null!==(e=this.manageList)&&void 0!==e&&e.length)&&(n.img_uris=[null===(t=this.manageList)||void 0===t?void 0:t[0]]);return n},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},showNewUserGuide:function(){var e=!this.keyword&&this.showNoDataContent&&!this.loading&&!this.list.length,t=!this.isLoggedIn&&!this.loading&&!this.list.length;return e||t},showDateIds:function(){var e=[],t=new Date,n=new Date(t);n.setDate(t.getDate()+1);var o=n;try{(this.list||[]).forEach((function(t){var n=null==t?void 0:t.create_at;Object(P.F)(n,o)||(e.push(t.id),o=n)}))}catch(e){}return e},checkIsShowBackTopBtn:function(){return this.showBackTopBtn&&this.list.length},showMessage:function(){return function(e){var t;return![8,"8"].includes(null==e||null===(t=e.messageInfo)||void 0===t?void 0:t.type)}},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)},groupedList:function(){var e=this,t={};return this.list.forEach((function(n){var o,l=new Date(n.create_at),r=e.formatDate(l);((null==n||null===(o=n.components)||void 0===o?void 0:o.some((function(i){return[0,"0",1,"1"].includes(null==i?void 0:i.type)})))||[1,"1",2,"2"].includes(null==n?void 0:n.status)||[21,23].includes(null==n?void 0:n.task_domain_type))&&(t[r]||(t[r]={date:l,items:[]}),t[r].items.push(n))})),Object.values(t).sort((function(a,b){return b.date-a.date}))},filteredGroupList:function(){var e=this;return this.groupedList.filter((function(t){return t.items.some((function(t){var n;return!![1,"1",2,"2"].includes(null==t?void 0:t.status)||(null===(n=t.components)||void 0===n?void 0:n.some((function(component){return e.showMessage(t)})))}))}))},isImageSelected:function(){return function(e,t){return this.manageList.some((function(n){return n.taskId===e&&n.index===t}))}}}),watch:{"list.length":{handler:function(e){e&&!this.isLoggedIn&&this.list.length&&localStorage.setItem("aiAppGuideVisible",!1)}},manageList:{handler:function(e){0===e.length?this.easyTop.setMessageManage(!1):this.easyTop.isShowMessageManage||this.easyTop.setMessageManage(!0)}},isLoggedIn:{handler:function(e,t){(!t&&e||!e&&t)&&this.refreshPageData()},immediate:!0},taskDomainTypes:{handler:function(e){this.debounceSearch&&this.debounceSearch()}},useModelSeries:{handler:function(e){this.debounceSearch&&this.debounceSearch()}},saveModes:{handler:function(e){this.debounceSearch&&this.debounceSearch()}},timeFrom:{handler:function(e){this.debounceSearch&&this.debounceSearch()}},timeTo:{handler:function(e){this.debounceSearch&&this.debounceSearch()}}},created:function(){},mounted:function(){var e=this;this.init(),this.initScrollBar(),this.debounceHandleScroll=Object(v.debounce)(this.handleScroll,600),this.$EventBus.$on("needScrollBottom",this.checkNeedScrollToBottom),this.debounceResize=Object(v.debounce)(this.handleResize,800),window.addEventListener("resize",this.debounceResize),this.debounceSearch=Object(v.debounce)(this.getHistoryMessage,500),this.$nextTick((function(){e.initResizeObserver()}))},beforeDestroy:function(){this.debounceHandleScroll=null,this.timer&&window.clearTimeout(this.timer),this.timer=null,this.$EventBus.$off("needScrollBottom"),window.removeEventListener("resize",this.debounceResize),this.$EventBus.$off("messageItemPromptWidthUpdate"),this.debounceResize=null,this.debounceSearch=null,this.destroyResizeObserver()},methods:z(z({},Object(C.b)("user",["getAccountInfo"])),{},{handleVideoUpscale:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,source,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:{},l=(null==(source=e.length>1&&void 0!==e[1]?e[1]:{})?void 0:source.url)||"",n.abrupt("return",Object(c.getMetaInfo)({id:null==o?void 0:o.id,task_flow_version:"v2"}).then((function(e){var n,r,c;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var d=(null==e?void 0:e.data)||{},v=d.meta,m=void 0===v?{}:v,h=d.img_uris,f=void 0===h?[]:h,_=o||{},y=_.components,C=void 0===y?[]:y,w=_.id,k=_.local_prompt,I=C[0]||{},x={parent_task_id:w,meta:z(z({},m),{},{width:(null==I?void 0:I.width)||(null==m?void 0:m.width),height:(null==I?void 0:I.height)||(null==m?void 0:m.height),prompt:k||(null==m?void 0:m.prompt),generate_video:z(z({},m.generate_video),{},{video_url:l,generate_video_duration:(null==m||null===(r=m.generate_video)||void 0===r?void 0:r.generate_video_duration)||(null===(c=f[0])||void 0===c?void 0:c.duration)||0})})};return Object(T.easyVideoUpscale)(x).then((function(e){var n=e||{},o=n.data,data=void 0===o?{}:o,l=n.status.code;if([1e4,"10000"].includes(void 0===l?"":l)){var r=z({},data);r.sender_id=t.userInfo.id,r.messageInfo={},r.messageInfo.author={id:r.sender_id,name:t.userInfo.name},r.status=1,r.task_domain_type=13,t.list.unshift(r),t.checkNeedClearSearch(),t.$message.success(t.$t("CreateSuccess")),t.checkUpdateMessageNeedScrollToBottom()}})).finally((function(){}))}})).finally((function(){})));case 4:case"end":return n.stop()}}),n)})))()},areArraysEqual:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;var n=Object(o.a)(e).sort((function(a,b){return a-b})),l=Object(o.a)(t).sort((function(a,b){return a-b}));return n.every((function(e,t){return e===l[t]}))},isAudio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp3",".wav",".m4a",".ogg",".flac",".aac"].some((function(t){return(e||"").toLowerCase().endsWith(t)}))},handleImageOperate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};switch(e){case"extraUpscale":this.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:n,art_work_no:null==o?void 0:o.pub_artwork_no,meta:Object.assign({},_()(null==o?void 0:o.meta)||{},{channel:o.category})}});break;case"upscale":this.handleTaskOperate({info:o,type:"U",btnInfo:{btnType:"U",id:t}});break;case"variations":this.handleTaskOperate({info:o,type:"V",btnInfo:{btnType:"V",id:t}});break;case"removeBackground":this.handleTaskOperate({info:o,type:"removeBackground",imageUrl:n});break;case"animGen":this.handleTaskOperate({info:o,type:"A",btnInfo:{btnType:"A",id:t}});break;case"videoUpscale":this.handleTaskOperate({info:o,type:"videoUpscale",btnInfo:{btnType:"A",id:t}})}},handleDeleteSingleImg:function(e,t){var n=this;Object(F.b)({id:e,index:t}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"});var o=n.list.findIndex((function(t){return t.id===e}));if(-1!==o){var l=n.list[o].components.filter((function(e){return e.index!==t}));n.$set(n.list[o],"components",l),l.length||n.list.splice(o,1)}}))},formatGroupTitle:function(e){var t=new Date,n=new Date(t);return n.setDate(n.getDate()-1),Object(P.F)(e,t)?this.$t("Today"):Object(P.F)(e,n)?this.$t("Yesterday"):this.formatDate(e)},handleComponentClick:function(){this.$EventBus.$emit("needCheckInputPackUp")},handleDebounceScroll:function(){try{this.$EventBus.$emit("needCheckInputPackUp"),this.$EventBus.$emit("closeDownloadVideoPopup"),this.debounceHandleScroll&&this.debounceHandleScroll()}catch(e){}},refreshPageData:function(){var e=this;"PRIVATE"===this.channelId&&(this.last1=0,this.last2=0,this.manageList=[],this.list=[],this.getHistoryMessage().finally((function(){e.showNoDataContent=!0})))},handleResize:function(){this.$EventBus.$emit("messageItemPromptWidthUpdate")},handleSaveSuccess:function(){var e=this;try{(this.list||[]).forEach((function(t){var n,o=e.manageList.filter((function(e){return(null==e?void 0:e.taskId)===(null==t?void 0:t.id)}));if(null!=o&&o.length&&(null==o||null===(n=o[0])||void 0===n?void 0:n.taskId)===(null==t?void 0:t.id)){var l=o.map((function(e){return e.index})),r=JSON.parse(JSON.stringify(t.components));(r||[]).forEach((function(e){l.includes(null==e?void 0:e.index)&&(e.is_saved_personal=!0)})),e.$set(t,"components",r)}}))}catch(e){}this.manageList=[]},updateSelectManageList:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(this.manageList||[]).findIndex((function(e){return(null==t?void 0:t.url)===(null==e?void 0:e.url)&&(null==t?void 0:t.id)===(null==e?void 0:e.taskId)||(null==t?void 0:t.id)===(null==e?void 0:e.taskId)&&(null==e?void 0:e.index)===(null==t?void 0:t.index)}));null!==(e=this.manageList)&&void 0!==e&&e.length||this.$logEvent("log_actions",{operation:"manage_work_popup_show",behavior_info:"on_new_create_flow_page"}),-1===n?-1===n&&this.manageList.length<20&&this.manageList.push(t):this.manageList.splice(n,1)},handleManageOperate:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"DELETE":this.handleImageMangeDeleteImageConfirm();break;case"CANCEL":this.manageList=[]}},handleImageMangeDeleteImageConfirm:function(){var e=this;try{this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){e.handleImageMangeDeleteImage()})).catch((function(e){console.log("err",e)}))}catch(e){}},handleImageMangeDeleteImage:function(){var e=this,t=Array.from(new Set((this.manageList||[]).map((function(e){return e.taskId})))),n=(this.list||[]).filter((function(e){return t.includes(null==e?void 0:e.id)})),o={},l=(n=JSON.parse(JSON.stringify(n))).map((function(t){var n,l=(e.manageList||[]).filter((function(e){return e.taskId===(null==t?void 0:t.id)})).map((function(e){return e.index}));return t.components=(t.components||[]).filter((function(e){return!l.includes(null==e?void 0:e.index)})),(null==t||null===(n=t.components)||void 0===n||!n.length)&&(o[t.id]=1),t})).filter((function(e){var t;return null==e||null===(t=e.components)||void 0===t?void 0:t.length})),r={};r.items=(this.manageList||[]).map((function(e){return{id:null==e?void 0:e.taskId,index:null==e?void 0:e.index}})),Object(S.c)(r).then((function(t){e.list.forEach((function(t){var n=l.find((function(e){return e.id===t.id}));n&&e.$set(t,"components",(null==n?void 0:n.components)||[])})),e.list=e.list.filter((function(e){return!Object.keys(o).includes(null==e?void 0:e.id)})),e.manageList=[]})).finally((function(){}))},settingViewNsfw:function(){var e;this.btnLoading||(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw():this.$refs.auditDialog.showDialog())},applyNsfw:function(){var e=this;this.btnLoading=!0;var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(w.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),e.btnLoading=!1,e.getAccountInfo())})).finally((function(){e.btnLoading=!1}))},handleSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.keyword=e,this.list=[],this.getHistoryMessage()},init:function(){var e=this;this.showNoDataContent=!1,this.$store.dispatch("creation/getTaskOptionsInfo"),this.last1=0,this.last2=0,"PRIVATE"===this.channelId&&this.getHistoryMessage().finally((function(){e.showNoDataContent=!0})),this.pollingMiddleware=new m.default(3e3,(function(){e.fetchTaskData()}))},handleTaskError:function(code){var e={7e4:this.$t("taskOperateFailed"),70001:this.$t("taskExceededDailyGenerationLimit"),70002:this.$t("taskQueueFull"),70003:this.$t("taskModelVersionNotSupportVariations"),70009:this.$t("taskModelForbidden"),70008:this.$t("taskArtWorkForbidden"),70024:this.$t("error_code_70024"),80008:this.$t("InsufficientBalance"),70010:this.$t("error_code_70010"),70011:this.$t("error_code_70011"),70013:this.$t("error_code_70013"),70014:this.$t("error_code_70014"),70015:this.$t("error_code_70015"),70016:this.$t("error_code_70016"),70019:this.$t("error_code_70019"),70023:this.$t("HttpErrorCode_70023")};code&&e[code]?this.$message.error(e[code]):this.$message.error(this.$t("ServerError"))},checkNeedScrollToBottom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,n=this.list.findIndex((function(t){return t.id===e.id})),o=null===(t=this.$refs)||void 0===t?void 0:t.scrollWrapper;-1===n||n!==this.list.length-1||this.showScroll||o.scrollHeight-o.scrollTop<o.clientHeight+e.banner.height&&this.scrollToTop()}catch(e){}},checkUpdateMessageNeedScrollToBottom:function(){try{var e=this.$refs.scrollWrapper;e.scrollHeight-e.scrollTop<=2*e.clientHeight&&this.scrollToTop()}catch(e){}},initScrollBar:function(){var e=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){e.$refs.scrollWrapper.removeEventListener("scroll",e.initScrollBarStatus)}))}catch(e){}},initScrollBarStatus:function(){this.showScroll=!0},getHistoryMessage:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.loading)return Promise.resolve();var l={limit:100};if(this.isLoggedIn||(l.g_mode=1),["",null,void 0].includes(n)||(l.after_id=n),l.keyword=this.keyword,l.save_modes=this.saveModes||[],l.task_domain_types=this.taskDomainTypes||[],l.use_model_series=this.useModelSeries||[],this.timeFrom&&this.timeTo){l.time_from=this.timeFrom;try{l.time_to=new Date(this.timeTo).setHours(23,59,59,999)}catch(e){}}return l.display_mode=(null==this||null===(e=this.easyTop)||void 0===e||null===(e=e.listParams)||void 0===e?void 0:e.viewMode)||1,this.loading=!0,Object(T.easyGetDefaultHistory)(l).then((function(e){if("PRIVATE"!==t.channelId)return e;var n=e.data,data=void 0===n?{}:n;if(l.after_id){var r,c,v=Object(d.objectArrayDeduplicationMerge)(t.list,(null==data?void 0:data.items)||[]);v=t.sortByField(v,"create_at",!1);var m=null===(r=t.$refs)||void 0===r||null===(r=r.scrollWrapper)||void 0===r?void 0:r.scrollHeight;v=v.map((function(e,t){return e.img_uris=((null==e?void 0:e.img_uris)||[]).filter((function(e){return null==e?void 0:e.url})),e.components=(null==e?void 0:e.components)||[],e})),(c=t.list).push.apply(c,Object(o.a)(v)),m&&v.length&&t.scrollToTop(m,"instant")}else t.list=((null==data?void 0:data.items)||[]).map((function(e){return e.img_uris=(e.img_uris||[]).filter((function(e){return null==e?void 0:e.url})),e.components=(null==e?void 0:e.components)||[],e})),t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},sortByField:function(e,t){var n=function(a,b){var e=a[t],n=b[t];return e<n?-1:e>n?1:0};return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?e.sort(n):e.sort((function(a,b){return n(b,a)}))},handleScroll:function(){try{var e=this.$refs.scrollWrapper;try{if(0===e.scrollTop&&0===e.scrollHeight)return;this.showBackTopBtn=e.scrollHeight-e.scrollTop>e.clientHeight+50,window.clearTimeout(this.timer),this.timer=setTimeout(this.isScrollEnd,1500),this.last1=null==e?void 0:e.scrollTop}catch(e){}var t=e.scrollHeight-e.scrollTop-e.clientHeight;e&&t<=100&&this.handleLoadMore()}catch(e){}},isScrollEnd:function(){try{var e=this.$refs.scrollWrapper;this.last2=null==e?void 0:e.scrollTop,this.last2===this.last1&&(this.showScroll=!1)}catch(e){}},handleLoadMore:function(){var e=this.list.length?this.list[this.list.length-1]:"",t=e?e.id:"";this.channelId&&"PRIVATE"===this.channelId&&this.getHistoryMessage(t)},scrollToTop:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";this.$nextTick((function(){try{var o=e.$refs.scrollWrapper;if(o){var l=t?t-200:t;o.scrollTo({top:l,behavior:n})}}catch(e){}}))},handleUpdateData:function(e,data){this.list.forEach((function(t){e===t.id&&Object.assign(t,data)}))},handleUpscale:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_()(source),n={id:(t||{}).info.id,task_flow_version:"v2"};Object(c.getMetaInfo)(n).then((function(n){var o=n||{},l=o.status.code,code=void 0===l?"":l,r=o.data,data=void 0===r?{}:r;return[1e4,"10000"].includes(code)&&(t.info.meta=data.meta,t.info.pub_artwork_no=(null==data?void 0:data.art_work_no)||"",t.info.art_model_no=(null==data?void 0:data.art_model_no)||"",t.info.art_model_ver_no=(null==data?void 0:data.art_model_ver_no)||"",t.info.prompt=t.info.local_prompt||t.info.prompt,e.handleOtherOperate(t)),[1e4,"10000"].includes(code)||e.handleTaskError(code),n}))},handleGetMeta:function(e){var t=this;return Object(c.getMetaInfo)({id:null==e?void 0:e.id,task_flow_version:"v2"}).then((function(n){var o,l;if(1e4===n.status.code){var r=(null==n||null===(o=n.data)||void 0===o?void 0:o.meta)||{},c=t.list.find((function(t){return(null==t?void 0:t.id)===(null==e?void 0:e.id)}));t.$set(c,"meta",Object.assign((null==c?void 0:c.meta)||{},r)),t.$set(c,"art_model",Object.assign((null==c?void 0:c.art_model)||{},(null==n||null===(l=n.data)||void 0===l?void 0:l.art_model)||{}))}})).finally((function(){}))},handleTaskOperate:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(l=e.length>0&&void 0!==e[0]?e[0]:{}).info,c=void 0===r?{}:r,d=l.type,v=void 0===d?"":d,m=l.callback,!["U","V","A","removeBackground","reStart"].includes(v)||null!=c&&c.meta){n.next=5;break}return n.next=5,t.handleGetMeta(c);case 5:n.t0=v,n.next="taskReStart"===n.t0?8:"cancelTask"===n.t0?10:"reStart"===n.t0?12:"extraUpscale"===n.t0?14:"U"===n.t0?16:"V"===n.t0?18:"A"===n.t0?20:"advanced"===n.t0?22:"promptSearch"===n.t0?24:"deleteTask"===n.t0?26:"removeBackground"===n.t0?28:"videoUpscale"===n.t0?30:32;break;case 8:return t.handleReStartTask(c),n.abrupt("break",33);case 10:return t.handleCancelTask(c,m),n.abrupt("break",33);case 12:return 3===(null==c?void 0:c.type)?t.handleVariations(l):t.handleTaskRestart(c),n.abrupt("break",33);case 14:return t.handleExtraUpscale(l),n.abrupt("break",33);case 16:return t.handleUpscale(l),n.abrupt("break",33);case 18:return t.handleVariations(l),n.abrupt("break",33);case 20:return t.handleOtherOperate(l),n.abrupt("break",33);case 22:return t.handleAdvancedOperate(l),n.abrupt("break",33);case 24:return null==t||null===(o=t.top)||void 0===o||o.setTextToImagePrompt(l.prompt),n.abrupt("break",33);case 26:return t.handleDeleteTask(c.id),n.abrupt("break",33);case 28:return t.handleRemoveBackground(l),n.abrupt("break",33);case 30:return t.handleVideoUpscale(c,l),n.abrupt("break",33);case 32:return n.abrupt("break",33);case 33:case"end":return n.stop()}}),n)})))()},handleExtraUpscale:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_()(source),n=t.info,o=void 0===n?{}:n,l=t.data,data=void 0===l?{}:l;try{o.meta.prompt=o.local_prompt||o.meta.prompt;var r=["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res","inpaint_full_res_padding","hi_res_arg","ad_units"];Object.keys(o.meta).forEach((function(e){r.includes(e)&&delete o.meta[e]}))}catch(e){}var d=this.groupTaskOperateParams({operate_number:data.number,action:2,info:o});d.category=o.category||1,d.channel_id="PRIVATE"===this.channelId?"":this.channelId,d.meta.hi_res_arg={image:data.imageUrl,upscaler_1:"4x-UltraSharp",upscaling_resize:2},d.operate_number=data.number||1,Object(c.createTask)(d).then((function(t){var n=t||{},o=n.data,data=void 0===o?{}:o,l=n.status,r=(void 0===l?{}:l).code;if([1e4,"10000"].includes(void 0===r?"":r)){var c=z({},data);c.sender_id=e.userInfo.id,c.messageInfo={},c.messageInfo.author={id:c.sender_id,name:e.userInfo.name},e.list.unshift(c),e.checkNeedClearSearch(),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(y.g)()}catch(e){}}else;})).finally((function(){}))},handleTaskRestart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if([2].includes(null==e?void 0:e.type))this.handleCreateRestartTask(e);else if([5,"5"].includes(e.type))this.$EventBus.$emit("taskUserUpscale",{action:9,url:e.banner.url});else{var t,n,o=e.type||1;if([13,"13"].includes(o))return o=6,void this.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)||(null==e||null===(n=e.components[0])||void 0===n?void 0:n.url),art_work_no:e.pub_artwork_no,meta:_()(e.meta),local_prompt:(null==e?void 0:e.local_prompt)||""}});if([8,"8"].includes(o)&&(o=10),[7,"7"].includes(o)&&(o=9),[11].includes(o)&&(o=13),e&&([7,"7","studio",11].includes(e.category)||24===e.type)){var l,r=(null==e?void 0:e.pub_artwork_no)||"";return Array.isArray(null==e?void 0:e.pub_artwork_nos)&&null!=e&&null!==(l=e.pub_artwork_nos)&&void 0!==l&&l.length&&(r=null==e?void 0:e.pub_artwork_nos[0]),void this.$emit("reload",{action:o,data:{parent_task_id:e.id,id:r,local_prompt:(null==e?void 0:e.local_prompt)||""}})}13!==e.task_domain_type?this.$emit("reload",{action:o,data:{parent_task_id:e.id,id:e.pub_artwork_no,local_prompt:(null==e?void 0:e.local_prompt)||"",meta:_()(e.meta),category:e.category}}):this.$emit("reload",{action:o,data:{parent_task_id:e.parent_id,id:e.id,local_prompt:(null==e?void 0:e.local_prompt)||""}})}},handleCreateRestartTask:function(e){var t,n,o,l=this,r={channel_id:"",model_no:null==e||null===(t=e.ckpts[0])||void 0===t?void 0:t.id,model_ver_no:null==e||null===(n=e.ckpts[0])||void 0===n?void 0:n.model_ver_no,speed_type:2,meta:(null==e?void 0:e.meta)||{}},c=((null===k.L||void 0===k.L?void 0:k.L.flux)||[]).includes(null==e||null===(o=e.ckpts)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.base_model_name);r.meta.seed=Object(d.getRandomSeed)(c),(3===(null==e?void 0:e.type)?T.easyMakeVariation:T.easyImageUpscale)(r).then((function(e){var t;e.data;if(!e||1e4===(null==e||null===(t=e.status)||void 0===t?void 0:t.code)){l.$message.success(l.$t("CreateSuccess"));var n=Object.assign({},r,(null==e?void 0:e.data)||{});n.banner=null,n.img_uris=[],n.components=[],n.status=1,l.updateMessageList(n)}}))},handleRemoveBackground:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=source.info,n=void 0===t?{}:t,o=source.imageUrl,l=void 0===o?"":o,r={action:7,art_work_no:n.pub_artwork_no,parent_task_id:n.id,category:n.category||1};r.meta=_()(n.meta);try{r.meta.prompt=n.local_prompt||n.meta.prompt}catch(e){}return r.meta.hi_res_arg&&delete r.meta.hi_res_arg,r.meta.remove_background={uri:l},r.channel_id="PRIVATE"===this.channelId?"":this.channelId,r.category=n.category||1,Object(c.createTask)(r).then((function(t){var n=t||{},o=(n.data,n.status.code);if([1e4,"10000"].includes(void 0===o?"":o)){var l=Object.assign({},r,(null==t?void 0:t.data)||{});l.banner=null,l.img_uris=[],l.components=[],l.status=1,e.updateMessageList(l),e.$message.success(e.$t("CreateSuccess")),e.checkNeedClearSearch(),e.checkUpdateMessageNeedScrollToBottom();try{Object(y.g)()}catch(e){}}}))},handleDeleteTask:function(e){var t=this.list.findIndex((function(t){return t.id===e}));-1!==t&&this.list.splice(t,1)},handleCopyTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=11===e.type?13:24==e.type?24:1;if(e&&[7,"7","studio"].includes(null==e?void 0:e.category)){var n,o=(null==e?void 0:e.pub_artwork_no)||"";return Array.isArray(null==e?void 0:e.pub_artwork_nos)&&null!=e&&null!==(n=e.pub_artwork_nos)&&void 0!==n&&n.length&&(o=null==e?void 0:e.pub_artwork_nos[0]),void this.$emit("reload",{action:t,data:{parent_task_id:e.id,id:o}})}this.$emit("reload",{action:t,data:{parent_task_id:e.id,id:e.pub_artwork_no}})},handleAdvancedOperate:function(){var source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=source.info,t=void 0===e?{}:e,n=source.btnInfo,o=void 0===n?{}:n;o&&"Make Variations"===o.btnType?this.handleOtherOperate(source):o&&"Web"===o.btnType&&(this.$router.push("/explore/detail/"+t.pub_artwork_no),this.$emit("closePopup"))},handleVariations:function(){var e,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_()(source),n=t.info,o=void 0===n?{}:n,l=t.btnInfo,r=void 0===l?{}:l,c=(t.callback,this.groupTaskOperateParams({operate_number:r.id,action:3,info:o}));this.$emit("reload",{action:3,data:{parent_task_id:null==o?void 0:o.id,id:null==o?void 0:o.id,init_images:null==c||null===(e=c.meta)||void 0===e?void 0:e.init_images}})},handleOtherOperate:function(){var e,t,n=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=_()(source),l=o.info,r=void 0===l?{}:l,d=o.btnInfo,v=void 0===d?{}:d,m=o.callback;r.meta.prompt=r.local_prompt||r.meta.prompt;var h=-1!==v.btnType.indexOf("U")?2:-1!==v.btnType.indexOf("A")?24:3,f=["mask","mask_blur","inpainting_fill","inpainting_mask_invert","inpaint_full_res","inpaint_full_res_padding"];if(2===h&&f.push("hi_res_arg"),Object.keys((null==r?void 0:r.meta)||{}).forEach((function(e){f.includes(e)&&delete r.meta[e]})),null!=r&&null!==(e=r.meta)&&void 0!==e&&null!==(e=e.ad_units)&&void 0!==e&&e.length||delete r.meta.ad_units,2===h)try{r.meta.enable_hr=!1,delete r.meta.ad_units,delete r.meta.hr_upscaler,delete r.meta.hr_scale}catch(e){}var C={action:h,parent_task_id:r.id,operate_number:v.id,meta:r.meta,art_work_no:r.pub_artwork_no,task_id:r.id,number:v.id},w=this.groupTaskOperateParams({operate_number:v.id,action:h,info:r});if([7,11,"studio"].includes(r.category)||24!==C.action||[3,"3"].includes(r.category))w.category=r.category||1,w.speed_type=(null===(t=this.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t?void 0:t.speed_type)||(this.activeState?2:1),this.handleUpdateBtnStatus(C.task_id,v.btnType),w.channel_id="PRIVATE"===this.channelId?"":this.channelId,w.meta.prompt=w.meta.local_prompt||w.meta.prompt,2!==h?3!==h?Object(c.createTask)(w).then((function(e){var t=e||{},o=t.data,data=void 0===o?{}:o,l=t.status,r=(void 0===l?{}:l).code;if([1e4,"10000"].includes(void 0===r?"":r)){m&&m(data);var c=z({},data);c.sender_id=n.userInfo.id,c.messageInfo={},c.messageInfo.author={id:c.sender_id,name:n.userInfo.name},n.list.unshift(c),n.checkNeedClearSearch(),n.updateBtnClickStatus(C),n.$message.success(n.$t("CreateSuccess")),n.checkUpdateMessageNeedScrollToBottom();try{Object(y.g)()}catch(e){}}else;})).finally((function(){n.handleUpdateBtnStatus(C.task_id,"")})):this.handleStudioVariationsTask(w,r,m):this.handleStudioUpscaleTask(w,r,m);else{var k={action:C.action,parent_task_id:r.id,operate_number:v.id,art_work_no:r.pub_artwork_no,meta:null==r?void 0:r.meta};if(24===(null==C?void 0:C.action)){var I=r.img_uris,x=void 0===I?[]:I,T=r.components,S=void 0===T?[]:T,O=S.length?S[v.id-1].url:"";O||(O=x.length?x[v.id-1].url:"");var P=this.list.find((function(e){return(null==e?void 0:e.id)===r.id}))||null;try{var M,L;if(null!=P&&null!==(M=P.art_model)&&void 0!==M&&M.id||null!=source&&null!==(L=source.info)&&void 0!==L&&null!==(L=L.art_model)&&void 0!==L&&L.id){var $,D=(null==P?void 0:P.art_model)||(null==source||null===($=source.info)||void 0===$?void 0:$.art_model);k.art_model_no=(null==D?void 0:D.id)||"",k.art_model_ver_no=(null==D?void 0:D.model_ver_no)||""}}catch(e){}k.meta.init_images=[O]}this.$emit("reload",{data:k,action:C.action})}},handleStudioUpscaleTask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n={};n.model_no=source.art_model_no,n.model_ver_no=source.art_model_ver_no,["channel_id","parent_task_id","meta","speed_type","source"].forEach((function(e){n[e]=source[e]})),Object(T.easyImageUpscale)(n).then((function(o){var l=o||{},r=l.data,data=void 0===r?{}:r,c=l.status,d=(void 0===c?{}:c).code;if([1e4,"10000"].includes(void 0===d?"":d)){t&&t(data);var v=z({},data);v.sender_id=e.userInfo.id,v.messageInfo={},v.messageInfo.author={id:v.sender_id,name:e.userInfo.name},v.art_model_no=n.art_model_no||"",v.status=1,v.banner=null,v.img_uris=[],v.components=[],e.list.unshift(v),e.checkNeedClearSearch(),e.updateBtnClickStatus(n),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(y.g)()}catch(e){}}else;})).catch((function(e){}))},handleStudioVariationsTask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n={};n.model_no=source.art_model_no,n.model_ver_no=source.art_model_ver_no,["channel_id","parent_task_id","meta","speed_type","source"].forEach((function(e){n[e]=source[e]})),Object(T.easyMakeVariation)(n).then((function(o){var l=o||{},r=l.data,data=void 0===r?{}:r,c=l.status,d=(void 0===c?{}:c).code;if([1e4,"10000"].includes(void 0===d?"":d)){t&&t(data);var v=z({},data);v.sender_id=e.userInfo.id,v.messageInfo={},v.messageInfo.author={id:v.sender_id,name:e.userInfo.name},v.art_model_no=n.art_model_no||"",v.status=1,v.banner=null,v.img_uris=[],v.components=[],e.list.unshift(v),e.checkNeedClearSearch(),e.updateBtnClickStatus(n),e.$message.success(e.$t("CreateSuccess")),e.checkUpdateMessageNeedScrollToBottom();try{Object(y.g)()}catch(e){}}else;})).catch((function(e){}))},groupTaskOperateParams:function(){var e,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=source.operate_number,n=void 0===t?1:t,o=source.action,l=void 0===o?1:o,r=source.info,c=void 0===r?{}:r,v={};v.action=l,v.operate_number=n,v.art_work_no=c.pub_artwork_no,v.art_model_no=(null==c?void 0:c.art_model_no)||"",v.art_model_ver_no=(null==c?void 0:c.art_model_ver_no)||"",v.parent_task_id=c.id,v.meta=c.meta;var m=c.img_uris,h=void 0===m?[]:m,f=c.components,_=void 0===f?[]:f;h=null!=_&&_.length?_:h;var y=(null==c||null===(e=c.banner)||void 0===e?void 0:e.url)||"",C=h.length?h[n-1].url:"";return 3===l&&(v.meta.seed=Object(d.getRandomSeed)(),v.meta.init_images=[C],v.meta.controlnet_units=[]),2===l&&(v.meta.init_images=h.length?[C]:[y],v.meta.controlnet_units=[]),v},handleReStartTask:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,n={action:4,task_id:void 0===t?"":t};this.handleUpdateBtnStatus(n.task_id,"reStart"),Object(c.operateTask)(n).then((function(t){var n=(t||{}).status,o=(void 0===n?{}:n).code,code=void 0===o?"":o;if([1e4,"10000"].includes(code)){var l=(t.data||{}).new_task,r=void 0===l?null:l;return-1!==e.list.findIndex((function(e){return e.id===r.id}))?e.list.forEach((function(e){r&&e.id===r.id&&Object.assign(e,r)})):e.list.unshift(r),void e.checkNeedClearSearch()}[1e4,"10000"].includes(code)||e.handleTaskError(code)})).finally((function(){e.handleUpdateBtnStatus(n.task_id,"")}))},handleCancelTask:function(){var e=this,t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,o=void 0===n?"":n,l={action:5,task_id:o};this.isLoggedIn||(l.g_mode=1),this.handleUpdateCancelBtnStatus(o,!0),Object(c.operateTask)(l,!1).then((function(n){e.$message.warning(e.$t("cancelJobSuccess"));var l=(n||{}).status,r=(void 0===l?{}:l).code,code=void 0===r?"":r;if(t&&t(),[1e4,"10000"].includes(code)){var c=e.list.findIndex((function(e){return e.id===o}));-1!==c&&e.list.splice(c,1)}else[1e4,"10000"].includes(code)||e.handleTaskError(code)})).finally((function(){e.handleUpdateCancelBtnStatus(o,!1)}))},handleUpdateBtnStatus:function(e,t){var n=this;this.list.forEach((function(o){o.id===e&&n.$set(o,"loadingBtn",t)}))},handleUpdateCancelBtnStatus:function(e,t){var n=this;this.list.forEach((function(o){o.id===e&&n.$set(o,"isLoading",t)}))},updateBtnClickStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,n=e.task_id,o=e.number;this.list.forEach((function(e){if(e.id===n){var l={action:t,number:o};-1===(e.operation||[]).findIndex((function(e){return e.action===t&&o===e.number}))&&(!Array.isArray(e.operation)||e.operation.push(l))}}))},updateMessageList:function(e){this.checkNeedClearSearch();var t=this.list.findIndex((function(t){return e.id===t.id})),n=z({},e);n.sender_id=this.userInfo.id,n.messageInfo={},n.messageInfo.author={id:n.sender_id,name:this.userInfo.name},-1===t&&this.list.unshift(n),this.checkUpdateMessageNeedScrollToBottom()},checkNeedClearSearch:function(){"PRIVATE"!==this.channelId||["",null,void 0].includes(this.keyword)||this.$EventBus.$emit("clearTaskSearch")},handleDisplayModeChange:function(e){this.displayMode=e},handleImageClick:function(e,component){},handleDownload:function(component){},handleSave:function(e,component){},formatDate:function(e){var t=new Date(e),n=["zhCN","zhTw"].includes(this.$i18n.locale)?"zh-CN":"en-US",o="zh-CN"===n?{weekday:"short",year:"numeric",month:"long",day:"numeric"}:{weekday:"long",day:"numeric",month:"long",year:"numeric"},l=new Intl.DateTimeFormat(n,o).format(t);return"zh-CN"===n&&(l=(l||"").replace(/(日)([^0-9]+)/,"$1 $2")),l},toggleImageSelect:function(e,component){var t=null==component?void 0:component.index,n={taskId:e.id,index:t,url:component.url,prompt:component.prompt,model:component.model,create_at:e.create_at},o=this.manageList.findIndex((function(i){return i.taskId===e.id&&i.index===t}));-1===o&&this.manageList.length>=20?this.$message.warning(this.$t("newGenerate37",{num:20})):-1===o&&this.manageList.length<20?this.manageList.push(n):-1!==o&&this.manageList.splice(o,1)},handleGroupSelect:function(e){var t=this,n=this.getGroupImages(e).filter((function(img){return 1!==(null==img?void 0:img.nsfw)&&3!==(null==img?void 0:img.type)}));if(this.isGroupSelected(e))this.manageList=this.manageList.filter((function(e){return!n.some((function(img){return img.taskId===e.taskId&&img.index===e.index}))}));else{var l,r=n.filter((function(img){return!t.manageList.some((function(e){return e.taskId===img.taskId&&e.index===img.index}))})),c=20-this.manageList.length;if(c>0)(l=this.manageList).push.apply(l,Object(o.a)(r.slice(0,c)))}},isGroupSelected:function(e){var t=this,n=this.getGroupImages(e).filter((function(img){return 1!==(null==img?void 0:img.nsfw)&&3!==(null==img?void 0:img.type)}));return n.length>0&&n.some((function(img){return t.manageList.some((function(e){return e.taskId===img.taskId&&e.index===img.index}))}))},isVideoUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(t){return(e||"").toLowerCase().endsWith(t)}))},getGroupImages:function(e){var t=this;return((null==e?void 0:e.items)||[]).reduce((function(e,n){return t.showMessage(n)&&((null==n?void 0:n.components)||[]).forEach((function(component,t){e.push({taskId:n.id,index:null==component?void 0:component.index,url:component.url,prompt:component.prompt,model:component.model,create_at:n.create_at,nsfw:component.nsfw,type:component.type})})),e}),[])},checkIsAlreadyFeedback:function(e){var t=this;this.list.forEach((function(n){var component=n.components.find((function(t){return t.id===e}));component&&t.$set(component,"is_nsfw_appeal",!0)}))},handleModeToggle:function(){var e,t={viewMode:2===this.displayMode?1:2};null==this||null===(e=this.easyTop)||void 0===e||e.updateListParams(t)},initResizeObserver:function(){var e=this;if("undefined"!=typeof ResizeObserver){var t=this.$refs.scrollContainer;if(t){var n=Object(v.debounce)((function(t){if(t!==e.gridContainerWidth)try{var n,o=(e.list||[]).findIndex((function(e){var t;return 3===e.status&&(null===(t=(null==e?void 0:e.components)||[])||void 0===t?void 0:t.some((function(e){return null==e?void 0:e.url})))}));if(-1===o)return void(e.visibleButtonCount=3);var l=null===(n=document)||void 0===n||null===(n=n.querySelectorAll(".c-history-box.c-history-box-img")[o])||void 0===n?void 0:n.clientWidth;if(e.gridContainerWidth=t,!l||l<220)return void(e.visibleButtonCount=3);if(l>=220)return void(e.visibleButtonCount=6)}catch(e){}}),200);this.resizeObserver=new ResizeObserver((function(e){var t,o=B(e);try{for(o.s();!(t=o.n()).done;){var l=t.value;l.contentRect&&n(l.contentRect.width)}}catch(e){o.e(e)}finally{o.f()}})),this.resizeObserver.observe(t)}}},destroyResizeObserver:function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},isImageShowNsfwBg:function(e,component,t){try{var n=this.$refs.easyMessageImg;if(Array.isArray(n)){var o=n.find((function(n){var o;return(null===(o=n.message)||void 0===o?void 0:o.id)===(null==e?void 0:e.id)&&n.operateNumber===t+1}));return!!o&&o.isShowNsfwBg}return!!n&&n.isShowNsfwBg}catch(e){return console.error("检查NSFW背景状态失败:",e),!1}}})},H=W,K=(n(4405),n(0)),component=Object(K.a)(H,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"c-easy-task-view-box",on:{click:e.handleComponentClick}},[t("retention-timer-button",{attrs:{bottom:"190"}}),e._v(" "),t("mode-toggle",{directives:[{name:"show",rawName:"v-show",value:[2,"2"].includes(e.displayMode),expression:"[2, '2'].includes(displayMode)"}],attrs:{"is-creative-mode":e.displayMode,showBackTop:!(e.showNewUserGuide||!e.checkIsShowBackTopBtn)},on:{toggle:e.handleModeToggle}}),e._v(" "),t("back-to-top",{directives:[{name:"show",rawName:"v-show",value:!e.showNewUserGuide&&e.checkIsShowBackTopBtn,expression:"!showNewUserGuide && checkIsShowBackTopBtn"}],attrs:{"show-nsfw":e.checkIsShowViewNsfw},on:{"scroll-top":function(t){return e.scrollToTop(0)}}}),e._v(" "),!e.showNewUserGuide&&e.checkIsShowViewNsfw?t("nsfw-toggle",{attrs:{"enable-mode":e.enableNsfwMode},on:{toggle:e.settingViewNsfw}}):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showNewUserGuide&&e.isShowMessageManage,expression:"!showNewUserGuide && isShowMessageManage"}],staticClass:"easy-task-view-box-top padding-top-32"},[t("message-manage",{attrs:{"manage-list":e.manageList},on:{"manage-operate":e.handleManageOperate,"save-success":e.handleSaveSuccess}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showNewUserGuide,expression:"!showNewUserGuide"}],ref:"scrollWrapper",staticClass:"c-easy-task-view-scroll-wrap",class:[e.showScroll?"":"show-scroll-bar"],on:{scroll:e.handleDebounceScroll}},[t("div",{staticClass:"c-easy-task-view"},[t("div",{ref:"scrollContainer",staticClass:"message-list"},[t("div",{staticClass:"messages-wrapper"},[t("div",{staticClass:"scroll-wrapper"},[[2,"2"].includes(e.displayMode)?t("div",{ref:"pureImageList",staticClass:"pure-image-list"},[e._l(e.filteredGroupList,(function(n){return[t("div",{key:"$title_".concat(n.date),staticClass:"date-group-title"},[t("div",{staticClass:"title-content"},[t("span",[e._v(e._s(e.formatGroupTitle(n.date)))]),e._v(" "),t("div",{staticClass:"select-all-btn",class:{selected:e.isGroupSelected(n)},on:{click:function(t){return t.stopPropagation(),e.handleGroupSelect(n)}}},[t("i",{class:[e.isGroupSelected(n)?"el-icon-remove-outline":"el-icon-circle-plus-outline"]}),e._v(" "),t("span",{staticClass:"btn-text"},[e._v(e._s(e.isGroupSelected(n)?e.$t("newGenerate102"):e.$t("newGenerate86")))])])])]),e._v(" "),t("div",{key:"grid_".concat(n.date),staticClass:"pure-image-grid"},[e._l(n.items,(function(n){return[[1,"1",2,"2"].includes(null==n?void 0:n.status)?[t("div",{staticClass:"pure-image-item"},[t("div",{staticClass:"pure-message-task-item"},[t("div",{staticClass:"image-progress"},[t("el-progress",{staticClass:"pure-image-grid-progress",attrs:{type:"circle",percentage:null==n?void 0:n.process,"stroke-width":5,"define-back-color":"#4A4852","text-color":"#fff",color:["#1FC0E8"]}})],1)])])]:e._e(),e._v(" "),[e._l(((null==n?void 0:n.components)||[]).filter((function(e){return[0,1,"0","1",3,"3"].includes(e.type)})),(function(component,o){var l;return[e.showMessage(n)?t("div",{key:"".concat(n.id,"_").concat(o),staticClass:"pure-image-item",class:{selected:e.isImageSelected(n.id,null==component?void 0:component.index),"pure-audio-item":e.isAudio(component.url)},on:{click:function(t){return e.handleImageClick(n,component)}}},[t("div",{staticClass:"image-wrapper"},[e.isAudio(component.url)?t("EasyMessageAudio",{attrs:{url:null==component?void 0:component.url,title:null==component?void 0:component.title,coverUrl:null==component?void 0:component.cover_url,"operate-number":o+1,viewMode:"pure",message:n,loraModels:n},on:{copyGenerationData:e.handleCopyTask}}):t("easy-message-img",{ref:"easyMessageImg",refInFor:!0,staticClass:"pure-message-image-item",attrs:{src:null==component?void 0:component.url,nsfw:component.nsfw,imageInfo:component,message:n,msgId:n.id,viewMode:"pure",showHoverMaskButton:!1,loraModels:n,"operate-number":o+1,showSaveFlag:!1},on:{deleteSingleImg:e.handleDeleteSingleImg,imageOperate:function(t,o,l){return e.handleImageOperate(t,o,l,n)},copyGenerationData:e.handleCopyTask}}),e._v(" "),1===(null==component?void 0:component.nsfw)||3===(null==component?void 0:component.type)||e.isImageShowNsfwBg(n,component,o)?e._e():t("div",{staticClass:"select-indicator",class:[(null===(l=e.manageList)||void 0===l?void 0:l.length)&&"select-indicator-btn-show"],on:{click:function(t){return t.stopPropagation(),e.toggleImageSelect(n,component)}}},[t("i",{staticClass:"el-icon-check"})])],1)]):e._e()]}))]]}))],2)]}))],2):[e._l(e.list,(function(n){return[n.id&&e.showMessage(n)?t("easy-msg-item",{key:n.id||n.message_id,attrs:{message:n,"task-from":"",channelId:e.channelId,showTime:e.showDateIds.includes(null==n?void 0:n.id),visibleButtonCount:e.visibleButtonCount},on:{operate:e.handleTaskOperate,copyGenerationData:e.handleCopyTask,updateData:e.handleUpdateData}}):e._e()]}))]],2)])])])]),e._v(" "),e.showNewUserGuide?t("user-guide"):e._e(),e._v(" "),t("audit-dialog",{ref:"auditDialog",on:{confirm:e.applyNsfw}}),e._v(" "),t("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"284e5ec4",null);t.default=component.exports;installComponents(component,{RetentionTimerButton:n(796).default,EasyMessageAudio:n(563).default,EasyMessageImg:n(686).default,EasyMsgItem:n(1172).default})},3308:function(e,t,n){"use strict";n.r(t);var o={name:"BackToTop",props:{showNsfw:{type:Boolean,default:!1}}},l=(n(4399),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-view-back-top",class:{"generate-view-back-top-only":!e.showNsfw},on:{click:function(t){return e.$emit("scroll-top",0)}}},[t("i",{staticClass:"el-icon-caret-top"})])}),[],!1,null,"c7b4769a",null);t.default=component.exports},3309:function(e,t,n){"use strict";n.r(t);var o={name:"NsfwToggle",props:{enableMode:{type:Boolean,required:!0}}},l=(n(4400),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.enableMode?e.$t("hideAdultContent"):e.$t("showAdultContent"),placement:"left"}},[t("div",{staticClass:"generate-view-nsfw-plus",on:{click:function(t){return e.$emit("toggle")}}},[t("i",{staticClass:"iconfont",class:e.enableMode?"icon-work-hide":"icon-work-show"})])])}),[],!1,null,"68db153a",null);t.default=component.exports},3310:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8);var o=n(2),l=(n(16),n(22),n(4),n(7),n(26),n(1)),r=n(124),c=n(46),d=(n(80),n(97)),v=n(54);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"MessageManage",components:{SaveTo:r.default,commonConfirmModal:d.default},inject:["easyTop"],props:{manageList:{type:Array,default:function(){return[]}}},data:function(){return{isInDownloadTask:!1,pollingTimer:null,baseButtons:[{code:"POST",i18nKey:"post_v",icon:"iconfont icon-icon-release"},{code:"CANCEL",i18nKey:"Cancel",icon:"iconfont icon-close-btn"}],fullButtons:[{code:"Film",i18nKey:"createFilm",icon:"iconfont icon-Film-selected"},{code:"POST",i18nKey:"post_v",icon:"iconfont icon-icon-release"},{code:"SAVE",i18nKey:"Save",icon:"iconfont icon-workflow_icon_save"},{code:"DOWNLOAD",i18nKey:"Download",icon:"el-icon-download"},{code:"DELETE",i18nKey:"Delete",icon:"iconfont icon-delete-gpt"},{code:"CANCEL",i18nKey:"Cancel",icon:"iconfont icon-close-btn"}]}},computed:h(h(h(h({},Object(l.c)("payment",["activeState"])),Object(l.c)("user",["isCompanyAccount"])),Object(l.e)("payment",["paymentInfo"])),{},{isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},manageBtnConfig:function(){return this.fullButtons},getMessageInfo:function(){var e,t,n={};(n.img_uris=[{url:""}],null!==(e=this.manageList)&&void 0!==e&&e.length)&&(n.img_uris=[null===(t=this.manageList)||void 0===t?void 0:t[0]]);return n},getBatchSaveParams:function(){return(this.manageList||[]).map((function(e){return{id:null==e?void 0:e.taskId,index:null==e?void 0:e.index}}))}}),methods:h(h({},Object(l.b)("videoEditor",["setSelectedMediaList"])),{},{handleManageOperate:function(e){switch(this.handleLogEvent(e),e){case"Film":this.handleFilm();break;case"POST":this.handlePost();break;case"SAVE":this.$refs.saveToPopover.openModal();break;case"DOWNLOAD":this.handleDownloadImages();break;case"DELETE":case"CANCEL":this.$emit("manage-operate",e),this.easyTop.setMessageManage(!1)}},handleFilm:function(){if(this.manageList.length){var e=[];this.manageList.forEach((function(t){e.push(t.info)})),e.length>0&&this.setSelectedMediaList(e),this.$router.push(this.localePath("/video-editor")),this.$logEvent("log_actions",{operation:"click_video_edit",behavior_info:"on_createflow_page"})}else this.$message.warning(this.$t("selectOneWork"))},handlePost:function(){this.manageList.length?this.$EventBus.$emit("openContribution",{selectedData:this.manageList,types:[v.CONTRIBUTION_TYPE_ENUM.WORK],source:"task"}):this.$message.warning(this.$t("selectOneWork"))},handleDownloadImages:function(){var e,t,n=this;if((null===(e=this.manageList)||void 0===e?void 0:e.length)>4&&!this.isVip)this.$EventBus.$emit("showBreakDialog","newGenerate55","basic");else if(!this.isInDownloadTask){var o={download_task_id:"",items:this.getBatchSaveParams};null!==(t=o.items)&&void 0!==t&&t.length&&(this.isInDownloadTask=!0,Object(c.easyDownloadAllImages)(o).then((function(e){var t;if(1e4===(null==e||null===(t=e.status)||void 0===t?void 0:t.code)){var o=((null==e?void 0:e.data)||{}).download_task_id,l=void 0===o?"":o;return n.pollingTask(l)}n.isInDownloadTask=!1})).catch((function(){n.isInDownloadTask=!1})))}},handleSaveSuccess:function(){this.$refs.saveToPopover.handleClose(),this.$emit("save-success")},handleLogEvent:function(e){var t="",n="";switch(e){case"POST":t="click_post";break;case"SAVE":t="click_organize",n=(this.manageList||[]).map((function(e){return e.url}));break;case"DOWNLOAD":t="click_download";break;case"DELETE":t="click_delete"}if(t){var o={operation:t,behavior_info:"on_new_create_flow_page"};n&&(o.behavior_info_sub=n),this.$logEvent("log_actions",o)}},pollingTask:function(e){var t=this;return new Promise((function(n,o){t.isInDownloadTask=!0;var l={download_task_id:e,items:[]};t.pollingTimer=setTimeout((function(){Object(c.easyDownloadAllImages)(l).then((function(l){var r,c;if(1e4!==(null==l||null===(r=l.status)||void 0===r?void 0:r.code))return t.stopPolling(),t.$message.error(t.$t("ServerError")),void o();var d=(null==l||null===(c=l.data)||void 0===c?void 0:c.url)||"";["",null,void 0].includes(d)?t.pollingTask(e):(t.stopPolling(),t.openDownloadLink(d),n())})).catch((function(e){t.$message.error(t.$t("ServerError")),t.stopPolling(),o()}))}),1e3)}))},stopPolling:function(){this.pollingTimer&&window.clearTimeout(this.pollingTimer),this.pollingTimer=null,this.isInDownloadTask=!1},openDownloadLink:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e){var a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=e,a.download="image_download",a.click(),document.body.removeChild(a)}}}),beforeDestroy:function(){this.stopPolling()}},_=f,y=(n(4401),n(0)),component=Object(y.a)(_,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"easy-task-view-manage"},[n("div",{staticClass:"easy-task-view-manage-info"},[t._v("\n    "+t._s(t.$t("newGenerate11",{number:null===(e=t.manageList)||void 0===e?void 0:e.length}))+"\n  ")]),t._v(" "),n("div",{staticClass:"easy-task-view-manage-operate"},[t._l(t.manageBtnConfig,(function(e){return["DOWNLOAD"===e.code?[n("el-tooltip",{key:"manage-btn-tooltip_".concat(null==e?void 0:e.code),attrs:{content:t.$t("newGenerate54",{num:4}),placement:"top-start",effect:"light"}},[n("div",{key:"manage-btn_".concat(null==e?void 0:e.code),staticClass:"manage-operate-btn",on:{click:function(n){return n.stopPropagation(),t.handleManageOperate(null==e?void 0:e.code)}}},["DOWNLOAD"===e.code?[n("span",{staticClass:"manage-operate-btn-icon",class:[t.isInDownloadTask&&"DOWNLOAD"===e.code?"el-icon-loading":e.icon]})]:[n("span",{staticClass:"manage-operate-btn-icon",class:[e.icon]})],t._v(" "),n("span",{staticClass:"manage-operate-btn-text"},[t._v(t._s(t.$t(e.i18nKey)))])],2)])]:n("div",{key:"manage-btn_".concat(null==e?void 0:e.code),staticClass:"manage-operate-btn",on:{click:function(n){return n.stopPropagation(),t.handleManageOperate(null==e?void 0:e.code)}}},["DOWNLOAD"===e.code?[n("el-tooltip",{attrs:{content:t.$t("newGenerate54",{num:4}),placement:"top-start",effect:"light"}},[n("span",{staticClass:"manage-operate-btn-icon",class:[t.isInDownloadTask&&"DOWNLOAD"===e.code?"el-icon-loading":e.icon]})])]:[n("span",{staticClass:"manage-operate-btn-icon",class:[e.icon]})],t._v(" "),n("span",{staticClass:"manage-operate-btn-text"},[t._v(t._s(t.$t(e.i18nKey)))])],2)]})),t._v(" "),n("save-to",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:t.$t("Save"),isBatchSave:!0,allowCreateCollect:!0,batchSaveParams:t.getBatchSaveParams,message:t.getMessageInfo,isColorBtn:!0,showArrowIcon:!1},on:{saveSuccess:t.handleSaveSuccess}})],2),t._v(" "),n("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"3fda51b8",null);t.default=component.exports;installComponents(component,{SaveTo:n(124).default})},3311:function(e,t,n){"use strict";n.r(t);var o={name:"UserGuide",inject:["easyTop"],data:function(){return{aiAppGuideVisible:!0}},computed:{isAiApp:function(){var e;return"app"==(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)},isVideo:function(){var e;return"generateVideo"===(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)},showUserGuideImageBox:function(){var e,t,n,o,l="app"===(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab),r="generateVideo"===(null===(t=this.easyTop)||void 0===t?void 0:t.currentTab)&&"effect"===(null===(n=this.easyTop)||void 0===n||null===(n=n.currentConfigInfo)||void 0===n?void 0:n.currentVideoTab),c="generateAudio"===(null===(o=this.easyTop)||void 0===o?void 0:o.currentTab);return!(l||r||c||this.isVideo)}},watch:{"easyTop.categoryInfo":function(e){this.setAiAppGuideVisible()}},mounted:function(){this.getAiAppGuideVisible()},methods:{getAiAppGuideVisible:function(){this.aiAppGuideVisible="false"!=localStorage.getItem("aiAppGuideVisible")},setAiAppGuideVisible:function(){this.isAiApp&&(this.aiAppGuideVisible=!1,localStorage.setItem("aiAppGuideVisible",!1))}}},l=(n(4402),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-guide-box"},[t("div",{staticClass:"user-guide-box-icon"}),e._v(" "),t("div",{staticClass:"user-guide-box-title"},[t("div",{staticClass:"user-guide-box-title-liner"},[e._v(e._s(e.$t("newGenerate39")))]),e._v(" "),t("div",{staticClass:"user-guide-box-title-text"},[e._v(e._s(e.$t("newGenerate40")))])]),e._v(" "),e.showUserGuideImageBox?t("div",{staticClass:"user-guide-image-box"}):e._e(),e._v(" "),e.isAiApp&&e.aiAppGuideVisible?t("div",{staticClass:"ai-app-guide-box"},[t("div",{staticClass:"ai-app-guide-item top"},[e._m(0),e._v(" "),t("div",{staticClass:"ai-app-guide-item-text-title"},[e._v(e._s(e.$t("ai_app_guide_first")))])]),e._v(" "),t("div",{staticClass:"ai-app-guide-item middle"},[e._m(1),e._v(" "),t("div",{staticClass:"ai-app-guide-item-text-title"},[e._v(e._s(e.$t("ai_app_guide_second")))])]),e._v(" "),t("div",{staticClass:"ai-app-guide-item bottom"},[e._m(2),e._v(" "),t("div",{staticClass:"ai-app-guide-item-text-title"},[e._v(e._s(e.$t("ChatCreate")))])])]):e._e(),e._v(" "),e.isVideo?t("div",{staticClass:"video-generate-guide-box"},[t("div",{staticClass:"video-generate-guide-item left"},[e._m(3),e._v(" "),t("div",{staticClass:"video-generate-guide-item-text-title"},[e._v(e._s(e.$t("UploadImage")))]),e._v(" "),t("img",{staticClass:"video-generate-guide-left-num-icon",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250701/f605b8db-2101-4a7f-a9e5-b62d95a3069d.webp",alt:""}})])]):e._e(),e._v(" "),e.isVideo?t("div",{staticClass:"video-generate-guide-box video-generate-guide-box-right"},[t("div",{staticClass:"video-generate-guide-item right"},[e._m(4),e._v(" "),t("div",{staticClass:"video-generate-guide-item-text-title"},[e._v(e._s(e.$t("video_generate_guide_second")))]),e._v(" "),t("img",{staticClass:"video-generate-guide-right-num-icon",attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250701/7818e352-f2da-4824-9ae9-70901cfd559a.webp",alt:""}})])]):e._e()])}),[function(){var e=this._self._c;return e("div",{staticClass:"ai-app-guide-item-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250626/8bef0ed5-cdd9-40a3-b1f9-34510856fa70.webp",alt:""}})])},function(){var e=this._self._c;return e("div",{staticClass:"ai-app-guide-item-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250626/1c6e7bb7-f80c-4045-be69-dfa9e837a832.webp",alt:""}}),this._v(" "),e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250626/bc969341-6bf5-4b82-8679-a7efce253086.webp",alt:""}})])},function(){var e=this._self._c;return e("div",{staticClass:"ai-app-guide-item-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250626/75f062e7-6630-461c-89b4-17b21b0719ef.webp",alt:""}})])},function(){var e=this._self._c;return e("div",{staticClass:"video-generate-guide-item-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250701/9499d39e-e181-4793-9ea7-a2eb5d569679.webp",alt:""}})])},function(){var e=this._self._c;return e("div",{staticClass:"video-generate-guide-item-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250701/0633b8cb-4b49-454e-8ee7-c6724a77dfd2.webp",alt:""}})])}],!1,null,"ee763a92",null);t.default=component.exports},3312:function(e,t,n){"use strict";n.r(t);n(16),n(24);var o={name:"ModeToggle",props:{isCreativeMode:{type:[String,Number],required:!0},showBackTop:{type:Boolean}}},l=(n(4403),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("el-tooltip",{staticClass:"item",class:{"generate-view-mode-toggle-no-back":!e.showBackTop},attrs:{effect:"dark",content:[1,"1"].includes(e.isCreativeMode)?e.$t("newGenerate104"):e.$t("newGenerate103"),placement:"left"}},[t("div",{staticClass:"generate-view-mode-toggle",on:{click:function(t){return e.$emit("toggle")}}},[t("i",{staticClass:"iconfont",class:[1,"1"].includes(e.isCreativeMode)?"icon-a-imagemode":"icon-icon-menu-generate-default"})])])}),[],!1,null,"40de3b1c",null);t.default=component.exports},3313:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(7);var o=n(3),l=n(2),r=(n(20),n(16),n(8),n(4),n(26),n(175)),c=n(1),d=n(29),v=n(9),m=n(25);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={name:"VideoExtensionModal",props:{getParams:{type:Function,default:function(){}}},watch:{prompt:{handler:function(){this.throttledClick&&this.throttledClick()}},negative_prompt:{handler:function(){this.throttledClick&&this.throttledClick()}},isGenerateMode:{handler:function(){this.throttledClick&&this.throttledClick()}},generateVideoDuration:{handler:function(){this.throttledClick&&this.throttledClick()}}},data:function(){return{visible:!1,loading:!1,prompt:"",negative_prompt:"",cost:0,costTimer:null,sale:0,videoInfo:{meta:{prompt:""}},detailInfo:{},initLoading:!1,generate:{gen_mode:0},generate_video:{generate_video_duration:5},videoDuration:[{code:5,label:"5s"},{code:10,label:"10s"}],throttledClick:function(){}}},computed:f(f(f({},Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("payment",["paymentInfo"])),{},{isGenerateMode:function(){var e;return null==this||null===(e=this.generate)||void 0===e?void 0:e.gen_mode},generateVideoDuration:function(){var e;return null==this||null===(e=this.generate_video)||void 0===e?void 0:e.generate_video_duration},coverUrl:function(){var e;return(null===(e=this.videoInfo)||void 0===e?void 0:e.url)||""},isVipFun:function(){var e=this.paymentInfo||{},t=e.activeState,n=e.liteActiveState;return t||n||this.isCompanyAccount},canUseUnlimitedQueue:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.infiniteQueue}}),mounted:function(){this.throttledClick=Object(m.throttle)(this.getEstimatedCost,1e3)},beforeDestroy:function(){this.throttledClick=null},methods:{changeVideoConfig:function(e){this.generate_video.generate_video_duration=e},changeConfig:function(e,t){if("gen_mode"===t&&1===e&&!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog",{dot:!1}),void this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"});(this.isVipFun||"gen_mode"!==t||1!==e)&&(this.canUseUnlimitedQueue||this.isCompanyAccount||1!==e)?this.generate.gen_mode=e:this.$EventBus.$emit("showBreakDialog","UpgradeQualityModel","standard","",["standard","professional","master"])},resetData:function(){this.detailInfo={},this.prompt="",this.generate.gen_mode=0,this.generate_video.generate_video_duration=5},show:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.resetData(),t.visible=!0,t.videoInfo=JSON.parse(JSON.stringify(e)),l=t.videoInfo||{},r=l.isTask,c=void 0!==r&&r,t.prompt=(null===(o=t.videoInfo)||void 0===o?void 0:o.prompt)||"",n.next=7,t.getMetaInfo(c);case 7:t.getEstimatedCost();case 8:case"end":return n.stop()}}),n)})))()},getEstimatedCost:function(){var e=this,t=this.handleParams();this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null),this.costTimer=setTimeout((function(){Object(r.b)(f({},t)).then((function(t){var n=(null==t?void 0:t.data)||{},o=n.calculate_coins,l=n.discount_off_rate;e.cost=o,e.sale=l})).catch((function(t){e.cost=0,e.sale=0}))}),1e3)},getMetaInfo:function(){var e,t,n,o,l=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c={task_flow_version:"v2",id:null===(e=this.videoInfo)||void 0===e||null===(e=e.info)||void 0===e?void 0:e.id};return r?(this.initLoading=!0,(r?d.getMetaInfo:d.getTaskConfig)(c).then((function(e){var t;[1e4,"10000"].includes(null==e||null===(t=e.status)||void 0===t?void 0:t.code)&&(l.detailInfo=(null==e?void 0:e.data)||{},l.displayConfig())})).finally((function(){l.initLoading=!1}))):(this.detailInfo=(null===(t=this.videoInfo)||void 0===t?void 0:t.info)||{},this.detailInfo.art_model_no=(null==this||null===(n=this.detailInfo)||void 0===n||null===(n=n.art_model)||void 0===n?void 0:n.id)||"",this.detailInfo.art_model_ver_no=(null==this||null===(o=this.detailInfo)||void 0===o||null===(o=o.art_model)||void 0===o?void 0:o.model_ver_no)||"",void this.displayConfig())},displayConfig:function(){var e,t,n=(null==this||null===(e=this.videoInfo)||void 0===e?void 0:e.isImageOperation)||!1,o=(null==this||null===(t=this.detailInfo)||void 0===t?void 0:t.meta)||{};if(n)this.generate_video.generate_video_duration=5,this.generate.gen_mode=0;else{var l,r,c,d=[5,10].includes(null==o||null===(l=o.generate_video)||void 0===l?void 0:l.generate_video_duration);this.generate_video.generate_video_duration=d?null==o||null===(r=o.generate_video)||void 0===r?void 0:r.generate_video_duration:5,this.generate.gen_mode=(null==o||null===(c=o.generate)||void 0===c?void 0:c.gen_mode)||0}},close:function(){this.visible=!1},handleParams:function(){var e,t,n,o,l,r,c,d,m={},h=(this.videoInfo||{}).isTask,_=void 0!==h&&h;(m.model_no=(null==this||null===(e=this.detailInfo)||void 0===e?void 0:e.art_model_no)||"",m.model_ver_no=(null==this||null===(t=this.detailInfo)||void 0===t?void 0:t.art_model_ver_no)||"",_)&&(m.parent_task_id=(null===(d=this.videoInfo)||void 0===d||null===(d=d.info)||void 0===d?void 0:d.id)||"");m.meta=f({},(null===(n=this.detailInfo)||void 0===n?void 0:n.meta)||{}),m.meta.prompt=this.prompt||"",m.meta.negative_prompt=this.negative_prompt||"";var y;(m.meta.generate_video=Object.assign({},{relevance:.5,camera_control_option:{mode:"Camera Movement",offset:0},generate_video_duration:5,image_opts:[]},(null==m||null===(o=m.meta)||void 0===o?void 0:o.generate_video)||{},this.generate_video),m.meta.generate_video.init_extend_video_url=(null===(l=this.videoInfo)||void 0===l||null===(l=l.info)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||(null===(r=this.videoInfo)||void 0===r||null===(r=r.info)||void 0===r||null===(r=r.meta)||void 0===r||null===(r=r.generate_video)||void 0===r?void 0:r.init_extend_video_url)||"",null!==(c=m.meta.generate_video)&&void 0!==c&&c.init_extend_video_url)||(m.meta.generate_video.init_extend_video_url=(null===(y=this.videoInfo)||void 0===y||null===(y=y.info)||void 0===y||null===(y=y.img_uris)||void 0===y||null===(y=y[0])||void 0===y?void 0:y.url)||"");try{var C,w;if(m.meta.generate=Object.assign({},(null==m||null===(C=m.meta)||void 0===C?void 0:C.generate)||{},this.generate),!_)m.meta.generate_video.init_extend_video_url=(null===(w=this.videoInfo)||void 0===w||null===(w=w.info)||void 0===w||null===(w=w.meta)||void 0===w||null===(w=w.generate_video)||void 0===w?void 0:w.init_extend_video_url)||""}catch(e){}return m.ss=v.e.GenerateCreate,m},videoProlongGenerate:function(e){var t=this;if(!this.isLoggedIn)return this.$EventBus.$emit("openLoginDialog"),!0;if(this.isVipFun){this.loading=!0;var n=this.handleParams();Object(r.h)(n).then((function(e){t.$emit("updateList",(null==e?void 0:e.data)||{}),t.close(),t.$message.success(t.$t("CreateSuccess"))})).finally((function(){t.loading=!1}))}else this.$EventBus.$emit("showBreakDialog","videoProlong_vip_tips2","basic")}}},y=_,C=(n(4406),n(0)),component=Object(C.a)(y,(function(){var e,t,o=this,l=o._self._c;return l("el-dialog",{attrs:{visible:o.visible,width:"320px","show-close":!1,modal:!1,"custom-class":"custom-dialog video-prolong-dialog",top:"10vh"},on:{"update:visible":function(e){o.visible=e}}},[l("template",{slot:"title"},[l("p",{staticClass:"video-prolong-title"},[o._v("\n      "+o._s(o.$t("videoProlong"))+"\n      "),l("img",{attrs:{src:n(136),alt:""}})])]),o._v(" "),l("div",{directives:[{name:"loading",rawName:"v-loading",value:o.initLoading,expression:"initLoading"}],staticClass:"prolong-video-pop"},[l("div",{staticClass:"prolong-video-cover"},[l("div",{staticClass:"cover-box",attrs:{"data-tag":o.$t("videoProlong_original")}},[l("img",{attrs:{src:o.coverUrl,alt:""}})])]),o._v(" "),l("div",{staticClass:"generate-mode-panel-item"},[l("div",{staticClass:"panel-item-label"},[l("span",{staticClass:"generate-mode-panel-label-text"},[o._v(o._s(o.$t("newGenerate5")))]),o._v(" "),l("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:o.$t("newGenerate108"),placement:"top-start"}},[l("i",{staticClass:"custom-tips el-icon-warning"})])],1),o._v(" "),l("div",{staticClass:"panel-item-content"},[l("div",{staticClass:"panel-item",class:[0===(null===(e=o.generate)||void 0===e?void 0:e.gen_mode)?"active-btn":""],on:{click:function(e){return e.stopPropagation(),o.changeConfig(0,"gen_mode")}}},[o._v("\n          "+o._s(o.$t("newGenerate44"))+"\n        ")]),o._v(" "),l("div",{staticClass:"panel-item",class:[1===(null===(t=o.generate)||void 0===t?void 0:t.gen_mode)?"active-btn":""],on:{click:function(e){return e.stopPropagation(),o.changeConfig(1,"gen_mode")}}},[o.isCompanyAccount?o._e():l("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),o._v("\n          "+o._s(o.$t("newGenerate45"))+"\n        ")])])]),o._v(" "),l("div",{staticClass:"generate-mode-panel-item"},[l("div",{staticClass:"panel-item-label"},[l("span",{staticClass:"generate-mode-panel-label-text"},[o._v(o._s(o.$t("Duration")))])]),o._v(" "),l("div",{staticClass:"panel-item-content panel-item-content-2"},o._l(o.videoDuration,(function(i){return l("div",{key:"videoDuration_".concat(i.code),staticClass:"panel-item",class:[o.generate_video.generate_video_duration===i.code?"active-btn":""],on:{click:function(e){return e.stopPropagation(),o.changeVideoConfig(i.code,"generate_video_duration")}}},[o._v("\n          "+o._s(i.label)+"\n        ")])})),0)]),o._v(" "),l("div",{staticClass:"prolong-video-prompt custom-form"},[l("p",[o._v(o._s(o.$t("Prompt")))]),o._v(" "),l("el-input",{attrs:{type:"textarea",rows:3,placeholder:o.$t("ai_video_generation_prompt")},model:{value:o.prompt,callback:function(e){o.prompt=e},expression:"prompt"}})],1),o._v(" "),l("div",{staticClass:"prolong-video-prompt custom-form"},[l("p",[o._v(o._s(o.$t("NegativePrompts")))]),o._v(" "),l("el-input",{attrs:{type:"textarea",rows:3,placeholder:o.$t("negativePromptsPlaceholder")},model:{value:o.negative_prompt,callback:function(e){o.negative_prompt=e},expression:"negative_prompt"}})],1),o._v(" "),o.isLoggedIn?l("el-button",{class:{"no-sale":!o.sale},attrs:{type:"primary","data-sale":"".concat(o.sale,"% Off"),loading:o.loading},on:{click:o.videoProlongGenerate}},[o._v(o._s(o.$t("Generate"))+"("+o._s(o.$t("expend"))+": "+o._s(o.cost)+")")]):l("el-button",{staticClass:"no-sale",attrs:{type:"primary"},on:{click:o.videoProlongGenerate}},[o._v(o._s(o.$t("Generate")))])],1)],2)}),[],!1,null,"22c83784",null);t.default=component.exports},3314:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(89),n(69),n(18),n(12),n(13),n(28),n(43),n(40),n(7),n(41);var o=n(14),l=n(3),r=n(2),c=(n(20),n(19),n(6),n(16),n(31),n(8),n(4),n(113),n(21),n(90),n(92),n(26),n(879)),d=n(1),v=n(25),m=n(603),h=n(470),f=n(179),_=n(97),y=n(85),C=n(33),w=n(469),k=n(3315),I=n(99);function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return T(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function T(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={name:"VideoInputArea",inject:["easyTop"],props:["value","menuIndex"],components:{SpecialEffectsAppSelect:c.default,RandomPromptPopup:m.default,ImageToImageCard:h.default,PickOrUploadImageModal:f.default,commonConfirmModal:_.default,VideoUploadBox:w.default,VideoCustomTextarea:k.default},data:function(){return{removeCameraMarkers:I.removeCameraMarkers,typeOptions:[{key:C.VIDEO_CREATION_MODE.IMG_TO_VIDEO,icon:"iconfont icon-a-icon-VideoGeneration",label:"newGenerate106",tooltip:""},{key:C.VIDEO_CREATION_MODE.IMG_TO_LIVE2D,icon:"iconfont icon-a-icon-VideoGeneration",label:"newGenerate122",tooltip:""},{key:C.VIDEO_CREATION_MODE.TXT_TO_VIDEO,icon:"iconfont icon-Txt2Vid",label:"newGenerate105",tooltip:""},{key:C.VIDEO_CREATION_MODE.MULTI_IMG_TO_VIDEO,icon:"iconfont icon-a-icon-VideoGeneration",label:"multi_image",tooltip:""},{key:C.VIDEO_CREATION_MODE.EFFECT,icon:"iconfont icon-Effect",label:"Effect",tooltip:""}],VIDEO_CREATION_MODE:C.VIDEO_CREATION_MODE,effectPopoverVisible:!1,debounceGenerate:function(){},throttleSetSmartPromptStatus:function(){},debounceHandleImagePrompt:function(){},inputSize:{minRows:1,maxRows:3},isShowSale:!1,currentPlaceholder:this.showPlaceholder,originalPlaceholder:this.showPlaceholder,smartPromptStatus:!1,smartPromptLoading:!1,smartPromptLimit:!1}},watch:{previewImage:{handler:function(e,t){e&&e!==t&&this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO&&this.handlePreviewImageChange("watch")},deep:!0},showPlaceholder:{handler:function(e){this.currentPlaceholder=e,this.originalPlaceholder=e},immediate:!0}},computed:O(O({},Object(d.c)("user",["isCompanyAccount","isLoggedIn","userInfo","getSmartPromptStatus"])),{},{isNotLoginAndIsVideoGenerate:function(){var e;return!this.isLoggedIn&&"generateVideo"===(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)},showPlaceholder:function(){var e;return e=this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO?"create_prompt_image":"create_prompt_video",this.$t(e)},specialEffectsOutputNodes:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.SpecialEffectsAppInfo)||void 0===e||null===(e=e.templateInfo)||void 0===e||null===(e=e.inputs)||void 0===e?void 0:e.length)||1},checkIsShowDisable:function(){var e,t,n,o;return this.currentType===C.VIDEO_CREATION_MODE.EFFECT?!(null!==(e=this.effectImageList)&&void 0!==e&&null!==(e=e.slice(0,this.specialEffectsOutputNodes))&&void 0!==e&&e.every((function(e){return null==e?void 0:e.url}))&&null!==(t=this.specialEffectsAppInfo)&&void 0!==t&&t.id):this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO||this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_LIVE2D?0===(null===(n=this.value)||void 0===n||null===(n=n.imageToVideoList)||void 0===n?void 0:n.length):this.currentType===C.VIDEO_CREATION_MODE.TXT_TO_VIDEO&&!Object(I.removeCameraMarkers)(null==this||null===(o=this.value)||void 0===o?void 0:o.prompt)},getTabList:function(){var e,t=this;return"multiImage"===(null===(e=this.value)||void 0===e?void 0:e.currentVideoTab)?this.typeOptions.filter((function(e){return e.key===C.VIDEO_CREATION_MODE.MULTI_IMG_TO_VIDEO})):this.typeOptions.filter((function(e){var n;return null===(n=t.easyTop)||void 0===n||null===(n=n.videoModelSupportTabs)||void 0===n?void 0:n.includes(null==e?void 0:e.key)}))},isShowTranslate:function(){var e,t,n;return(null===(e=this.value)||void 0===e?void 0:e.isTranslate)&&""!==(null===(t=this.value)||void 0===t?void 0:t.prompt)&&""!==(null===(n=this.value)||void 0===n?void 0:n.local_prompt)},getDiscountOffText:function(){var e;return"".concat(null===(e=this.easyTop)||void 0===e?void 0:e.discountOff,"% Off")},currentType:function(){var e;return(null==this||null===(e=this.value)||void 0===e?void 0:e.currentVideoInputToolTab)||""},showImageToVideoUpload:function(){return this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO||this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_LIVE2D},showVideoEffectUpload:function(){return this.currentType===C.VIDEO_CREATION_MODE.EFFECT},showEffectBtn:function(){return this.currentType===C.VIDEO_CREATION_MODE.EFFECT},showUploadArea:function(){return[C.VIDEO_CREATION_MODE.IMG_TO_VIDEO,C.VIDEO_CREATION_MODE.IMG_TO_LIVE2D,C.VIDEO_CREATION_MODE.EFFECT].includes(this.currentType)},isVideo:function(){var e,t=this;if(null==this||null===(e=this.specialEffectsAppInfo)||void 0===e||null===(e=e.cover)||void 0===e||!e.url)return!1;return[".mp4",".webm",".ogg"].some((function(e){var n;return((null==t||null===(n=t.specialEffectsAppInfo)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url)||"").toLowerCase().endsWith(e)}))},specialEffectsAppInfo:function(){var e;return(null==this||null===(e=this.value)||void 0===e?void 0:e.SpecialEffectsAppInfo)||{}},specialEffectsAppOutputNodes:function(){var e;return(null===(e=this.specialEffectsAppInfo)||void 0===e||null===(e=e.templateInfo)||void 0===e||null===(e=e.inputs)||void 0===e?void 0:e.length)||1},effectImageList:function(){var e;return(null==this||null===(e=this.value)||void 0===e?void 0:e.specialEffectsImageList)||[]},previewImage:function(){var e,t,n,o,l=(null==this||null===(e=this.value)||void 0===e?void 0:e.imageToVideoList)||[];return(null==l||null===(t=l[0])||void 0===t?void 0:t.firstFrame)||(null==l||null===(n=l[0])||void 0===n?void 0:n.lastFrame)||(null==l||null===(o=l[0])||void 0===o?void 0:o.url)},showLockParamsBtn:function(){var e=this.value,t=e.prompt,n=e.imageToVideoList;return t||(null==n?void 0:n.length)}}),mounted:function(){this.debounceGenerate=Object(v.debounce)(this.handleGenerate,500),this.throttleSetSmartPromptStatus=Object(v.throttle)(this.setSmartPromptStatus,1e3),this.debounceHandleImagePrompt=Object(v.throttle)(this.handleImagePromptStateChange,1e3),this.$EventBus.$on("closeAllGeneratePopup",this.handleCloseEffectSelectPopup),this.smartPromptStatus=this.getSmartPromptStatus||!this.isLoggedIn,this.handlePreviewImageChange("mounted")},beforeDestroy:function(){this.$EventBus.$off("closeAllGeneratePopup",this.handleCloseEffectSelectPopup),this.debounceHandleImagePrompt=null,this.throttleSetSmartPromptStatus=null},methods:O(O({},Object(d.b)("user",["updateAccountSettings"])),{},{openCameraControl:function(){var e;null===(e=this.$refs.videoCustomTextarea)||void 0===e||e.openCameraControl()},resetState:function(){var e;null!==(e=this.easyTop)&&void 0!==e&&null!==(e=e.config)&&void 0!==e&&e.generateVideo&&(this.easyTop.config.generateVideo.isImageToVideoInitData=!1,this.easyTop.config.generateVideo.isNeedSmartPrompt=!1)},handlePreviewImageChange:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"watch",o=null===(e=this.easyTop)||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.generateVideo)||void 0===e?void 0:e.isImageToVideoInitData,l=null===(t=this.easyTop)||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.generateVideo)||void 0===t?void 0:t.isNeedSmartPrompt;("mounted"!==n||l||o)&&(!o||l?this.smartPromptLimit?this.resetState():(this.resetState(),this.debounceHandleImagePrompt()):this.resetState())},handleCloseEffectSelectPopup:function(){try{var e;null===(e=this.$refs)||void 0===e||null===(e=e.specialEffectsAppSelect)||void 0===e||e.handleClose()}catch(e){}},handleKeyCode:function(e){if(13==e.keyCode)if(e.metaKey||e.altKey){var t=this.value.prompt,n=document.querySelector("#easyGenerateVideoInput"),o=n.selectionStart,l=n.selectionEnd,r=t.slice(0,o)+"\n"+t.slice(l);n.focus(),setTimeout((function(){n.setSelectionRange(o+1,o+1),n.focus()}),10),this.changeConfig(r,"prompt")}else e.preventDefault(),this.debounceGenerate&&this.debounceGenerate()},handleCustomKeyCode:function(e){13==e.keyCode&&(e.metaKey||e.altKey||(e.preventDefault(),this.debounceGenerate&&this.debounceGenerate()))},changeConfig:function(e,t){var n,o=JSON.parse(JSON.stringify(this.value));"prompt"===t&&o.isTranslate&&(o.isTranslate=!1),t&&(o[t]=e),null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(o,this.menuIndex)},handleTypeChange:function(e){var t,n=this;this.currentType!==e&&(null==this||null===(t=this.easyTop)||void 0===t||t.changeCurrentVideoInputToolTab(e),this.$nextTick((function(){n.currentPlaceholder=n.showPlaceholder,n.originalPlaceholder=n.showPlaceholder})))},handleOpenPickWorkModal:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isLoggedIn?t&&["imageToVideo","imageToLive2D"].includes(t.type)&&null!==(e=this.value)&&void 0!==e&&null!==(e=e.imageToVideoList)&&void 0!==e&&e.length?this.$message.warning(this.$t("newGenerate81")):this.$refs.pickOrUploadImageModal.openModal([],t||null):this.$EventBus.$emit("openLoginDialog",{dot:!1})},handleAddImageToVideoImage:function(){if(this.isLoggedIn){var e={type:this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO?"imageToVideo":"imageToLive2D"};this.$refs.pickOrUploadImageModal.openModal([],e)}},handleAddEffectImage:function(e){if(this.isLoggedIn){var t={type:"effectImage",index:e};this.$refs.pickOrUploadImageModal.openModal([],t)}else this.$EventBus.$emit("openLoginDialog",{dot:!1})},handleEffectSelect:function(e){var t,n=this,o=(null==e?void 0:e.sub_title)||"";null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig({SpecialEffectsAppInfo:e,prompt:o},this.menuIndex),setTimeout((function(){n.effectPopoverVisible=!1}),100)},handleDeleteEffectImage:function(e){var t;null===(t=this.easyTop)||void 0===t||t.deleteEffectImage(e)},checkNotAllowQualityMode:function(){var e,t,n;return(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.hasEnableImageToImage)&&(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isSDXLModel)&&(null==this||null===(n=this.easyTop)||void 0===n?void 0:n.isEnableQuality)},handleGenerate:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,m,h,f,_,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=function(){var t,n;if((null===(t=e.value)||void 0===t||null===(t=t.imageToVideoList)||void 0===t?void 0:t.length)>0&&null!==(n=e.value)&&void 0!==n&&null!==(n=n.imageToVideoList[0])&&void 0!==n&&n.lastFrame)try{var o,l,r,c=JSON.parse(JSON.stringify(e.value));if(null===(o=e.value)||void 0===o||null===(o=o.imageToVideoList[0])||void 0===o||!o.firstFrame)c.imageToVideoList[0].firstFrame=null===(r=e.value)||void 0===r||null===(r=r.imageToVideoList[0])||void 0===r?void 0:r.lastFrame;c.imageToVideoList[0].lastFrame="",e.easyTop.updateConfig(c,e.menuIndex),null!==(l=e.value)&&void 0!==l&&null!==(l=l.imageToVideoList)&&void 0!==l&&l[0]&&(e.value.imageToVideoList[0].lastFrame="")}catch(e){console.error("清空尾帧失败",e)}},c=e.easyTop,d=e.value,v=(null==c||null===(n=c.videoModelParams)||void 0===n||null===(n=n.i2v_model_param)||void 0===n?void 0:n.frame_ctl)||[],m=(null==d||null===(o=d.imageToVideoList)||void 0===o?void 0:o[0])||{},h=(null==c?void 0:c.isStartAndEnd)&&d.currentVideoInputToolTab===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO,v.includes(2)||!h){t.next=11;break}if(!m.lastFrame||m.firstFrame){t.next=9;break}return e.$message.warning(e.$t("kl10_model_not_support_only_last_frame")),t.abrupt("return");case 9:t.next=12;break;case 11:r();case 12:if(!e.checkIsShowDisable){t.next=14;break}return t.abrupt("return");case 14:if(!e.checkNotAllowQualityMode()){t.next=25;break}return t.prev=15,t.next=18,null===(f=e.$refs)||void 0===f||null===(f=f.commonConfirmModal)||void 0===f?void 0:f.show({subTitle:"newGenerate46"}).then((function(){var t,n=JSON.parse(JSON.stringify(e.value));Object.assign(n,{generate:{gen_mode:0}}),null==e||null===(t=e.easyTop)||void 0===t||t.updateConfig(n,e.menuIndex)}));case 18:null===(_=e.easyTop)||void 0===_||_.handleGenerate(),t.next=23;break;case 21:t.prev=21,t.t0=t.catch(15);case 23:t.next=26;break;case 25:null===(y=e.easyTop)||void 0===y||y.handleGenerate();case 26:null===(l=e.$refs.videoCustomTextarea)||void 0===l||l.closeCameraControl();case 27:case"end":return t.stop()}}),t,null,[[15,21]])})))()},handlePickImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&["imageToVideo","imageToLive2D"].includes(t.type)){var n;if(t.isDrag){var l,r,c=(null===(l=this.easyTop)||void 0===l||null===(l=l.config)||void 0===l||null===(l=l.generateVideo)||void 0===l?void 0:l.imageToVideoList)||[],d=[O(O({},c[0]),{},{firstFrame:e[0].url,url:e[0].url})];return c.length>1&&d.push.apply(d,Object(o.a)(c.slice(1))),void(null===(r=this.easyTop)||void 0===r||r.updateConfig({imageToVideoList:d},this.menuIndex))}null===(n=this.easyTop)||void 0===n||n.addImageToVideo(e[0],t.type)}else{var v;if(t&&"effectImage"===t.type)null===(v=this.easyTop)||void 0===v||v.updateEffectImage(e[0],t.index)}},handleViewMore:function(){},handleDeleteEffect:function(e){var t;e.stopPropagation(),null==this||null===(t=this.easyTop)||void 0===t||t.updateConfig({SpecialEffectsAppInfo:null},this.menuIndex),e.preventDefault()},handleDeleteImageToVideo:function(e){var t;null===(t=this.easyTop)||void 0===t||t.deleteImageToVideo(e)},handleFocus:function(){this.currentPlaceholder=""},handleBlur:function(){this.currentPlaceholder=this.originalPlaceholder},getSmartPrompt:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,line,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.smartPromptLoading=!0,r="",c=null!==(o=t.easyTop)&&void 0!==o&&o.isSeaArtStream?"framepack":"",null!==(l=t.easyTop)&&void 0!==l&&l.isKLModel&&(c="kling"),n.next=7,fetch("/api/stream/tool/prompt/image",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",token:t.$cookies.get("T"),"Accept-Language":t.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-App-Id":"web_global_seaart","X-Device-Id":t.$cookies.get("deviceId")},body:JSON.stringify({image_url:e,scene:c})});case 7:d=n.sent,v=d.body.getReader(),m=new TextDecoder("utf-8"),h="";case 11:return n.next=14,v.read();case 14:if(f=n.sent,_=f.done,y=f.value,!_){n.next=19;break}return n.abrupt("break",53);case 19:if(!(C=m.decode(y,{stream:!0})).includes('"code":10624')){n.next=27;break}if(t.isLoggedIn){n.next=24;break}return t.$EventBus.$emit("openLoginDialog"),n.abrupt("break",53);case 24:return t.smartPromptLimit=!0,t.$message.error("".concat(t.$t("smart_prompt")).concat(t.$t("todayMax"))),n.abrupt("break",53);case 27:if(!C.includes('"code":20000')){n.next=30;break}return t.$EventBus.$emit("openLoginDialog"),n.abrupt("break",53);case 30:w=(h+=C).split("\n"),h=w.pop()||"",k=x(w),n.prev=34,k.s();case 36:if((I=k.n()).done){n.next=43;break}if(""!==(line=I.value).trim()){n.next=40;break}return n.abrupt("continue",41);case 40:if(line.startsWith("data: "))try{"---end---"!==(text=line.slice(6))&&(r+=text,t.changeConfig(r,"prompt"))}catch(e){console.error("解析数据失败:",e)}case 41:n.next=36;break;case 43:n.next=48;break;case 45:n.prev=45,n.t0=n.catch(34),k.e(n.t0);case 48:return n.prev=48,k.f(),n.finish(48);case 51:n.next=11;break;case 53:t.smartPromptLoading=!1,n.next=60;break;case 56:n.prev=56,n.t1=n.catch(0),t.$message.error("".concat(t.$t("smart_prompt")).concat(t.$t("comicPage17"))),t.smartPromptLoading=!1;case 60:case"end":return n.stop()}}),n,null,[[0,56],[34,45,48,51]])})))()},setSmartPromptStatus:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn){t.next=4;break}return e.smartPromptStatus=!e.smartPromptStatus,e.handleImagePromptStateChange(),t.abrupt("return");case 4:return e.$logEvent("log_actions",{operation:"click_ai_prompt",behavior_info:"on_createflow_page"}),t.next=7,Object(y.c)({mode:1,task_image_prompt_switch:e.smartPromptStatus?1:0});case 7:n=t.sent,1e4===n.status.code&&(e.smartPromptStatus=!e.smartPromptStatus,e.updateAccountSettings({task_image_prompt_switch:e.smartPromptStatus?0:1}),e.handleImagePromptStateChange());case 10:case"end":return t.stop()}}),t)})))()},handleImagePromptStateChange:function(){this.smartPromptStatus&&this.previewImage&&this.currentType===C.VIDEO_CREATION_MODE.IMG_TO_VIDEO&&this.getSmartPrompt(this.previewImage)},toggleLockParamsStatus:function(){var e;null===(e=this.easyTop)||void 0===e||e.updateConfig(O(O({},this.value),{},{isLockParams:!this.value.isLockParams}),this.menuIndex)}})},M=P,L=(n(4411),n(0)),component=Object(L.a)(M,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S=this,O=S._self._c;return O("div",{staticClass:"c-video-input-area"},[O("div",{staticClass:"type-selector"},S._l(S.getTabList,(function(e){return O("button",{key:e.key,staticClass:"type-btn",class:{active:S.currentType===e.key},attrs:{title:e.tooltip},on:{click:function(t){return S.handleTypeChange(e.key)}}},[O("i",{class:e.icon}),S._v(" "),O("span",{staticClass:"btn-text"},[S._v(S._s(S.$t(e.label)))])])})),0),S._v(" "),O("div",{staticClass:"main-area"},[O("div",{directives:[{name:"show",rawName:"v-show",value:S.showUploadArea,expression:"showUploadArea"}],staticClass:"upload-area"},[S.smartPromptLoading?O("div",{staticClass:"upload-area-mask"},[O("div",{staticClass:"loading-wrapper"},[O("div",{staticClass:"custom-loading"}),S._v(" "),O("span",{staticClass:"loading-text"},[S._v(S._s(S.$t("analyzing_1"))+"...")])])]):S._e(),S._v(" "),S.showImageToVideoUpload?[O("VideoUploadBox",{attrs:{scene:"panel"},on:{uploadHandleConfirm:function(e,t){return S.handlePickImage(e,{type:S.currentType===S.VIDEO_CREATION_MODE.IMG_TO_VIDEO?"imageToVideo":"imageToLive2D",isDrag:t})}}},[null!==(e=S.value)&&void 0!==e&&null!==(e=e.imageToVideoList)&&void 0!==e&&e.length?S._l(S.value.imageToVideoList,(function(image,i){return O("image-to-image-card",{key:"imageToVideo_".concat(i),attrs:{value:S.value,type:"imageToVideo",cardInfo:image,"menu-index":S.menuIndex},on:{delete:function(e){return S.handleDeleteImageToVideo(i)}}})})):[O("button",{staticClass:"upload-btn",on:{click:S.handleAddImageToVideoImage}},[O("i",{staticClass:"iconfont icon-a-addimg"})])]],2)]:S._e(),S._v(" "),S.showVideoEffectUpload?[O("div",{staticClass:"effect-image-wrapper"},[null!==(t=S.effectImageList[0])&&void 0!==t&&t.url?O("div",{staticClass:"effect-image-preview",on:{click:function(e){return S.handleAddEffectImage(0)}}},[O("img",{staticClass:"preview-media",attrs:{src:S.effectImageList[0].url,alt:""}}),S._v(" "),O("span",{staticClass:"image-box-top-btn image-box-top-btn-right",on:{click:function(e){return e.stopPropagation(),S.handleDeleteEffectImage(0)}}},[O("i",{staticClass:"el-icon-close"})]),S._v(" "),S._m(0)]):O("button",{staticClass:"upload-btn",on:{click:function(e){return S.handleAddEffectImage(0)}}},[O("i",{staticClass:"iconfont icon-a-addimg"})])]),S._v(" "),S.specialEffectsAppOutputNodes>=2?O("div",{staticClass:"effect-image-wrapper"},[null!==(n=S.effectImageList[1])&&void 0!==n&&n.url?O("div",{staticClass:"effect-image-preview",on:{click:function(e){return S.handleAddEffectImage(1)}}},[O("img",{staticClass:"preview-media",attrs:{src:S.effectImageList[1].url,alt:""}}),S._v(" "),O("span",{staticClass:"image-box-top-btn image-box-top-btn-right",on:{click:function(e){return e.stopPropagation(),S.handleDeleteEffectImage(1)}}},[O("i",{staticClass:"el-icon-close"})]),S._v(" "),S._m(1)]):O("button",{staticClass:"upload-btn",on:{click:function(e){return S.handleAddEffectImage(1)}}},[O("i",{staticClass:"iconfont icon-a-addimg"})])]):S._e()]:S._e(),S._v(" "),S.showEffectBtn?O("div",{staticClass:"effect-divider"}):S._e(),S._v(" "),S.showEffectBtn?O("SpecialEffectsAppSelect",{ref:"specialEffectsAppSelect",on:{select:S.handleEffectSelect,"view-more":S.handleViewMore},model:{value:S.effectPopoverVisible,callback:function(e){S.effectPopoverVisible=e},expression:"effectPopoverVisible"}},[O("div",{staticClass:"effect-trigger-wrapper"},[null!==(o=S.specialEffectsAppInfo)&&void 0!==o&&o.id?O("div",{staticClass:"effect-preview"},[S.isVideo&&null!==(l=S.specialEffectsAppInfo)&&void 0!==l&&null!==(l=l.cover)&&void 0!==l&&l.url?O("video",{staticClass:"preview-media",attrs:{src:null===(r=S.specialEffectsAppInfo)||void 0===r||null===(r=r.cover)||void 0===r?void 0:r.url,muted:"",loop:"",autoplay:"",playsinline:""},domProps:{muted:!0}}):O("img",{staticClass:"preview-media",attrs:{src:null===(c=S.specialEffectsAppInfo)||void 0===c||null===(c=c.cover)||void 0===c?void 0:c.url,alt:""}}),S._v(" "),O("span",{staticClass:"image-box-top-btn image-box-top-btn-right",on:{click:function(e){return e.stopPropagation(),S.handleDeleteEffect.apply(null,arguments)}}},[O("i",{staticClass:"el-icon-close"})]),S._v(" "),O("div",{staticClass:"type-icon"},[O("i",{staticClass:"iconfont icon-Effect"})])]):O("div",{staticClass:"effect-btn-wrapper"},[O("div",{staticClass:"effect-btn-layer effect-btn-layer-3"}),S._v(" "),O("div",{staticClass:"effect-btn-layer effect-btn-layer-2"}),S._v(" "),O("button",{staticClass:"effect-btn effect-btn-layer-1"},[O("i",{staticClass:"iconfont icon-Effect"})])])])]):S._e()],2),S._v(" "),O("div",{staticClass:"input-area",class:{"text-to-video":"txt2video"===S.currentType}},[O("div",{staticClass:"input-text-box"},[O("video-custom-textarea",{ref:"videoCustomTextarea",attrs:{placeholder:S.currentPlaceholder,value:S.value.prompt},on:{input:function(e){return S.changeConfig(e,"prompt")}},nativeOn:{keydown:function(e){return S.handleCustomKeyCode.apply(null,arguments)}}})],1)]),S._v(" "),O("div",{staticClass:"action-area"},[O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("smart_prompt_tip"),placement:"top-start"}},[S.currentType===S.VIDEO_CREATION_MODE.IMG_TO_VIDEO?O("div",{staticClass:"top-input-box-right-icon",class:{"top-input-box-right-icon-active":S.smartPromptStatus},on:{click:function(e){return S.throttleSetSmartPromptStatus()}}},[O("i",{staticClass:"iconfont icon-zhinengtishi smart-prompt-icon"})]):S._e()]),S._v(" "),O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("inputCamera_$5"),placement:"top-start"}},[O("div",{staticClass:"top-input-box-right-icon",attrs:{"data-event":"add_movie_shot_button","data-desc":"aiVideo","data-type":"add_movie_shot"},on:{click:S.openCameraControl}},[O("i",{staticClass:"iconfont icon-Camera"})])]),S._v(" "),O("random-prompt-popup",{ref:"randomPromptPopup",on:{openPickImageModal:S.handleOpenPickWorkModal}},[O("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:S.$t("newGenerate70"),placement:"top-start"}},[O("div",{staticClass:"top-input-box-right-icon"},[O("i",{staticClass:"iconfont icon-search-magic"})])])],1),S._v(" "),S.isNotLoginAndIsVideoGenerate?[O("div",{staticClass:"generate-btn",class:{"generate-btn-disable":S.checkIsShowDisable},on:{click:S.debounceGenerate}},[S._v("\n          "+S._s(S.$t("Generate"))+"\n        ")])]:O("div",{staticClass:"generate-btn",class:[S.checkIsShowDisable&&"generate-btn-disable",!!(S.removeCameraMarkers(S.value.prompt)||null!==(d=S.easyTop)&&void 0!==d&&d.notNeedCheckPrompt)&&(null===(v=S.easyTop)||void 0===v?void 0:v.isShowDiscountOff)&&"generate-btn-discount"],attrs:{"data-discount-off":S.getDiscountOffText},on:{click:function(e){return S.debounceGenerate()}}},[null!==(m=S.value)&&void 0!==m&&m.generateing?[O("span",{staticClass:"el-icon-loading"})]:S._e(),S._v("\n        "+S._s(S.$t("Generate"))+"\n        "),null!==(h=S.easyTop)&&void 0!==h&&h.isVideoModel&&null!==(f=S.easyTop)&&void 0!==f&&f.isShowDiscountOff?[!(S.removeCameraMarkers(S.value.prompt)||null!==(_=S.easyTop)&&void 0!==_&&_.notNeedCheckPrompt)||null!==(y=S.value)&&void 0!==y&&y.generateing||S.isCompanyAccount?S._e():O("span",{staticClass:"generate-btn-sub-spacial"},[O("i",{staticClass:"iconfont icon-trail-fast-queue"}),S._v(" "),null!==(C=S.easyTop)&&void 0!==C&&C.getDiscountOffBeforeNum?O("span",{staticClass:"generate-btn-sub-delete-text"},[S._v(S._s((null===(w=S.easyTop)||void 0===w?void 0:w.getDiscountOffBeforeNum)||0))]):S._e(),S._v(" "),O("span",{staticClass:"generate-btn-sub-normal-text"},[S._v(S._s(S.easyTop.calcCost>=0?S.easyTop.calcCost:null===(k=S.easyTop)||void 0===k?void 0:k.computedCost))])])]:["effect"===S.currentType&&0===S.easyTop.calcCost?[O("el-tooltip",{attrs:{effect:"dark",content:S.$t("workFlow31"),placement:"top"},model:{value:S.isShowSale,callback:function(e){S.isShowSale=e},expression:"isShowSale"}},[O("i",{staticClass:"iconfont icon-a-icon-ContactUs",on:{click:function(e){e.stopPropagation(),S.isShowSale=!S.isShowSale}}})])]:[S.checkIsShowDisable||!(S.removeCameraMarkers(S.value.prompt)||null!==(I=S.easyTop)&&void 0!==I&&I.notNeedCheckPrompt)||null!==(x=S.value)&&void 0!==x&&x.generateing||S.isCompanyAccount?S._e():O("span",{staticClass:"generate-btn-sub"},[S._v("\n              ("+S._s(S.$t("PhysicalExertion"))+": "+S._s(S.easyTop.calcCost>0?S.easyTop.calcCost:null===(T=S.easyTop)||void 0===T?void 0:T.computedCost)+" )\n            ")])]]],2)],2)]),S._v(" "),O("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:S.handlePickImage}}),S._v(" "),O("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"type-icon"},[e("i",{staticClass:"iconfont icon-icon-fenggecankao"})])},function(){var e=this._self._c;return e("div",{staticClass:"type-icon"},[e("i",{staticClass:"iconfont icon-icon-fenggecankao"})])}],!1,null,"455d2610",null);t.default=component.exports},3315:function(e,t,n){"use strict";n.r(t);var o=n(30),l=n(14),r=n(3),c=(n(19),n(6),n(32),n(50),n(69),n(16),n(11),n(72),n(89),n(73),n(22),n(31),n(49),n(243),n(8),n(4),n(524),n(18),n(28),n(43),n(218),n(21),n(40),n(140),n(44),n(92),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(7),n(41),n(20),n(3316)),d=n(268);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return m(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function m(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}var h={name:"VideoCustomTextarea",components:{VideoCameraControl:c.default},inject:["easyTop"],props:{value:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{isInternalUpdate:!1,isComposing:!1,isEmpty:!0,activeGroup:"",activeAction:"",activeActions:[],activeStandingId:"",contentMapping:{},lastCursorPosition:null,cameraConfig:null,loadingCameraConfig:!1,isClient:!1,ssrContent:""}},watch:{"easyTop.isShowPopup":{handler:function(e){e||this.closeCameraControl()},immediate:!0},value:function(e,t){var n,o=this;if(this.isInternalUpdate||this.isComposing)this.isInternalUpdate=!1;else{var l=(null===(n=this.$refs.videoInputTextarea)||void 0===n?void 0:n.innerText)||"";e!==l?this.$nextTick(Object(r.a)(regeneratorRuntime.mark((function t(){var n,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.$refs.videoInputTextarea){t.next=9;break}return t.next=3,o.convertCombinedContentToHtml(e);case 3:if(n=t.sent,l=window.getSelection(),r=l.rangeCount>0?l.getRangeAt(0).cloneRange():null,o.$refs.videoInputTextarea.innerHTML=n,r&&document.activeElement===o.$refs.videoInputTextarea)try{l.removeAllRanges(),l.addRange(r)}catch(e){}o.checkEmpty();case 9:case"end":return t.stop()}}),t)})))):e||l||(this.isEmpty=!0,this.$refs.videoInputTextarea&&this.$refs.videoInputTextarea.classList.add("empty"))}},placeholder:function(){var e=this;this.$nextTick((function(){e.checkEmpty()}))}},created:function(){this.value&&this.createSsrCompatibleContent()},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isClient=!0,!e.value||!e.$refs.videoInputTextarea){t.next=6;break}return t.next=4,e.convertCombinedContentToHtml(e.value);case 4:n=t.sent,e.$refs.videoInputTextarea.innerHTML=n;case 6:e.checkEmpty(),"undefined"!=typeof document&&document.addEventListener("click",e.handleGlobalClick);case 8:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){"undefined"!=typeof document&&document.removeEventListener("click",this.handleGlobalClick)},methods:{createSsrCompatibleContent:function(){var e=this,t=this.value.replace(/{{camera:\[(.*?)\]:camera}}/g,(function(t,n){var o=n.split(",").map((function(t){return e.$t(t)||t})).join(",");return"[Camera: ".concat(o,"]")}));this.ssrContent=t},handleCameraGroupItemClick:function(e){this.processSelection({type:"group",groupId:e.id,options:e.options||[],selectedId:e.id})},handleActionBtnItemClick:function(e,t){this.processSelection({type:"action",groupId:t.id,options:[e],selectedId:e.id,isMainShot:1===t.options.length})},processSelection:function(e){var element=this.$refs.videoInputTextarea;element&&(this.activeStandingId?this.handleExistingStanding(element,e):this.getStandingCount()>=3?this.showToast(this.$t("inputCamera_$7")):this.addNewContent(e))},handleExistingStanding:function(element,e){var t=element.querySelector('[data-standing-id="'.concat(this.activeStandingId,'"]'));if(t){var n=t.getAttribute("data-selection-id"),o=t.getAttribute("data-selection-type"),l=t.getAttribute("data-group-id");e.type===o?"action"!==e.type||"action"!==o?n===e.selectedId&&o===e.type?(this.removeHtmlContent(t),this.clearActiveState()):this.replaceActiveContent(e,t):this.handleActionSelection(e,t,l):this.replaceActiveContent(e,t)}else this.clearActiveState()},handleActionSelection:function(e,t,n){var o=t.getAttribute("data-combined-content");if(o){var r=o.match(/{{camera:\[(.*?)\]:camera}}/);if(r&&r[1]){var c=r[1].split(","),d=e.options[0].id,v=c.indexOf(d);if(-1===v){var m=this.checkConflictingGroupId(c,e.groupId);if(m.found){var h=Object(l.a)(c);return h[m.index]=e.options[0].id,void this.updateStandingWithReplacedAction(t,h,m.index,e.options[0])}e.groupId===n?this.replaceActiveContent(e,t):this.handleAddNewAction(e,t,c)}else this.handleRemoveExistingAction(t,c,v)}}},handleRemoveExistingAction:function(e,t,n){var o=Object(l.a)(t);if(o.splice(n,1),0===o.length)return this.removeHtmlContent(e),void this.clearActiveState();this.updateStandingAfterRemoval(e,o,n)},checkConflictingGroupId:function(e,t){var n,o=null===(n=this.$refs.videoCameraControl)||void 0===n?void 0:n.config;if(!o||!o.camera_config)return{found:!1,index:-1};for(var i=0;i<e.length;i++){var l,r=e[i],c=v(o.camera_config);try{for(c.s();!(l=c.n()).done;){var d=l.value;if(d.options){var m,h=v(d.options);try{for(h.s();!(m=h.n()).done;){if(m.value.id===r&&d.id===t)return{found:!0,index:i}}}catch(e){h.e(e)}finally{h.f()}}}}catch(e){c.e(e)}finally{c.f()}}return{found:!1,index:-1}},handleAddNewAction:function(e,t,n){n.length>=3?this.showToast(this.$t("inputCamera_$6")):e.isMainShot&&this.checkHasMainShot(t)?this.showToast(this.$t("inputCamera_$8")):this.addActionToExistingStanding(e,t,n)},clearActiveState:function(){this.activeGroup="",this.activeAction="",this.activeActions=[],this.activeStandingId=""},createStandingElement:function(e){var t=this,n=e.standingId,o=e.groupId,l=e.selectionId,r=e.selectionType,c=e.combinedContent,d=e.displayText.split(",").map((function(e){return t.$t(e)||e})).join(","),v='<span class="standing" contenteditable="false"\n        data-group-id="'.concat(o,'"\n        data-standing-id="').concat(n,'"\n        data-selection-id="').concat(l,'"\n        data-selection-type="').concat(r,'"\n        data-combined-content="').concat(c,'">\n          &nbsp;\n          <span class="standing-content">\n            <span class="standing-text">').concat(d,'</span>\n            <i class="iconfont icon-guanbi2"></i>\n          </span>\n          &nbsp;\n        </span>');return this.contentMapping[c]=v,{combinedContent:c,displayText:d,baseHtmlContent:v}},generateContentFromSelection:function(e,t){var n,o=e.options.map((function(option){return option.desc}));n="group"===e.type?[e.groupId]:e.options.map((function(option){return option.id}));var l="{{camera:[".concat(n.join(","),"]:camera}}"),r="".concat(o.join(","));return this.createStandingElement({standingId:t,groupId:e.groupId,selectionId:e.selectedId,selectionType:e.type,combinedContent:l,displayText:r})},insertHtmlToTextarea:function(e,t){var element=this.$refs.videoInputTextarea;element&&this.isClient&&(document.activeElement===element?this.insertAtCursor(element,e,t):this.lastCursorPosition?this.insertAtSavedPosition(element,e,t):this.appendHtmlToEnd(element,e),this.checkEmpty(),this.handleInputWithCombinedContent(element,t))},insertAtCursor:function(element,e,t){if(this.isClient){var n=window.getSelection();if(0!==n.rangeCount){var o=n.getRangeAt(0);if(element.contains(o.commonAncestorContainer)){o.deleteContents();var l=document.createElement("div");l.innerHTML=e;for(var r=document.createDocumentFragment();l.firstChild;)r.appendChild(l.firstChild);o.insertNode(r),o.collapse(!1),n.removeAllRanges(),n.addRange(o)}}}},insertAtSavedPosition:function(element,e,t){if(this.isClient)try{var n=document.createRange();if(n.setStart(this.lastCursorPosition.startContainer,this.lastCursorPosition.startOffset),n.setEnd(this.lastCursorPosition.endContainer,this.lastCursorPosition.endOffset),!element.contains(n.commonAncestorContainer))throw new Error("保存的位置不在编辑区域内");n.deleteContents();var o=document.createElement("div");o.innerHTML=e;for(var l=document.createDocumentFragment();o.firstChild;)l.appendChild(o.firstChild);n.insertNode(l),this.lastCursorPosition=null}catch(t){console.error("恢复光标位置失败:",t),this.lastCursorPosition=null,this.appendHtmlToEnd(element,e)}},appendHtmlToEnd:function(element,e){var t=document.createElement("div");for(t.innerHTML=e;t.firstChild;)element.appendChild(t.firstChild)},openCameraControl:function(){this.$refs.videoCameraControl.handleOpenCameraControl()},closeCameraControl:function(){this.$refs.videoCameraControl.closeCameraControl()},checkEmpty:function(){var element=this.$refs.videoInputTextarea;if(element){var text=element.innerText.trim();this.isEmpty=""===text,element.classList.toggle("empty",this.isEmpty)}},handleFocus:function(){this.checkEmpty(),this.saveCursorPosition()},handleBlur:function(e){this.checkEmpty()},handleCopy:function(e){e.preventDefault();var t=window.getSelection();if(0!==t.rangeCount){var n=t.getRangeAt(0).cloneContents(),o=document.createElement("div");o.appendChild(n),o.querySelectorAll(".standing").forEach((function(e){return e.remove()}));var l=o.textContent||o.innerText||"";e.clipboardData.setData("text/plain",l)}},handlePaste:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,element,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),o=e.clipboardData.getData("text/plain")){n.next=4;break}return n.abrupt("return");case 4:return t.saveCursorPosition(),n.next=7,t.convertCombinedContentToHtml(o);case 7:l=n.sent,element=t.$refs.videoInputTextarea,document.activeElement===element?t.insertHtmlAtCursor(l):t.lastCursorPosition?t.insertAtSavedPosition(element,l):t.appendHtmlToEnd(element,l),t.checkEmpty(),r=t.getContentWithCombinedFormat(element),t.isInternalUpdate=!0,t.$emit("input",r);case 14:case"end":return n.stop()}}),n)})))()},insertHtmlAtCursor:function(html){if(this.isClient){var e=window.getSelection();if(0!==e.rangeCount){var t=e.getRangeAt(0);if(this.$refs.videoInputTextarea.contains(t.commonAncestorContainer)){t.deleteContents();var n=document.createElement("div");n.innerHTML=html;for(var o=document.createDocumentFragment();n.firstChild;)o.appendChild(n.firstChild);t.insertNode(o),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}}},handleCompositionStart:function(e){this.isComposing=!0,this.saveCursorPosition(),this.checkEmpty()},handleCompositionEnd:function(e){this.isComposing=!1,this.checkEmpty(),this.saveCursorPosition(),this.handleInput(e)},handleInput:function(e){if(this.checkEmpty(),!this.isComposing){this.isInternalUpdate=!0,this.saveCursorPosition();var t=this.getContentWithCombinedFormat(e.target);this.$emit("input",t)}},handleInputWithCombinedContent:function(element,e){this.isInternalUpdate=!0,this.checkEmpty();var t=this.getContentWithCombinedFormat(element);this.$emit("input",t)},getContentWithCombinedFormat:function(element){var e=element.cloneNode(!0);return e.querySelectorAll(".standing").forEach((function(e){var t=e.getAttribute("data-combined-content");if(t){var n=document.createTextNode(t);e.parentNode.replaceChild(n,e)}else console.error("standing元素缺少data-combined-content属性:",e)})),e.textContent||e.innerText||""},convertCombinedContentToHtml:function(content){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(content){t.next=2;break}return t.abrupt("return","");case 2:return t.next=4,e.loadCameraConfigIfNeeded(content);case 4:return n=e.replaceKnownContent(content),t.abrupt("return",e.processNewCameraContent(n));case 6:case"end":return t.stop()}}),t)})))()},loadCameraConfigIfNeeded:function(content){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=/{{camera:\[(.*?)\]:camera}}/g,o=new Set;null!==(l=n.exec(content));)r=l[1],r.split(",").forEach((function(e){return o.add(e)}));if(!(o.size>0)||e.loadingCameraConfig){t.next=6;break}return t.next=6,e.loadCameraConfig(Array.from(o));case 6:case"end":return t.stop()}}),t)})))()},loadCameraConfig:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,v,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:[],n.prev=1,t.loadingCameraConfig=!0,r=[],c=[],o.forEach((function(e){e.includes("film")?r.push(e):c.push(e)})),v=t.filterExistingIds(r,"camera_group"),m=t.filterExistingIds(c,"camera_config"),0!==v.length||0!==m.length||!t.cameraConfig){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,Object(d.c)({film_ids:v,ids:m});case 12:1e4===(null==(h=n.sent)||null===(l=h.status)||void 0===l?void 0:l.code)&&(t.cameraConfig?t.mergeCameraConfig(h.data):t.cameraConfig=h.data),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(1),console.error("获取分镜配置失败:",n.t0);case 19:return n.prev=19,t.loadingCameraConfig=!1,n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[1,16,19,22]])})))()},filterExistingIds:function(e,t){var n=this;return this.cameraConfig&&this.cameraConfig[t]?e.filter((function(e){return"camera_group"===t?!n.cameraConfig[t].some((function(t){return t.id===e})):!n.cameraConfig[t].some((function(t){return t.options&&t.options.some((function(option){return option.id===e}))}))})):e},mergeCameraConfig:function(e){var t=this;e.camera_group&&e.camera_group.length>0&&(this.cameraConfig.camera_group||(this.cameraConfig.camera_group=[]),e.camera_group.forEach((function(e){-1===t.cameraConfig.camera_group.findIndex((function(t){return t.id===e.id}))&&t.cameraConfig.camera_group.push(e)}))),e.camera_config&&e.camera_config.length>0&&(this.cameraConfig.camera_config||(this.cameraConfig.camera_config=[]),e.camera_config.forEach((function(e){var n=t.cameraConfig.camera_config.find((function(t){return t.id===e.id}));n?e.options&&e.options.length>0&&(n.options||(n.options=[]),e.options.forEach((function(e){n.options.find((function(option){return option.id===e.id}))||n.options.push(e)}))):t.cameraConfig.camera_config.push(e)})))},replaceKnownContent:function(content){for(var e=content,t=0,n=Object.entries(this.contentMapping);t<n.length;t++){var l=Object(o.a)(n[t],2),r=l[0],c=l[1],d=c.match(/data-standing-id="([^"]+)"/),v=d?d[1]:"",m=this.activeStandingId===v?c.replace('class="standing"','class="standing active"'):c,h=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),f=new RegExp(h,"g");e=e.replace(f,m)}return e},processNewCameraContent:function(content){for(var e,t=/{{camera:\[(.*?)\]:camera}}/g,n=content;null!==(e=t.exec(content));){var o=e[0],l=e[1];if(!this.isContentAlreadyProcessed(o)){var r=this.createStandingHtmlFromIds(l,o),c=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=new RegExp(c,"g");n=n.replace(d,r)}}return n},isContentAlreadyProcessed:function(content){return Object.keys(this.contentMapping).includes(content)},createStandingHtmlFromIds:function(e,t){var n=e.split(","),o=this.getContentInfo(n),l=o.selectionType,r=o.descriptions,c=o.groupId,d=o.selectionId,v=this.generateUniqueId(),m="".concat(r.join(","));return this.createStandingElement({standingId:v,groupId:c,selectionId:d,selectionType:l,combinedContent:t,displayText:m}).baseHtmlContent},getContentInfo:function(e){var t=[],n="",o="action",l=e[0];if(1===e.length&&e[0].includes("film")){o="group";var r=e[0];n=r,l=r,t=this.processFilmGroupInfo(r).descriptions}else{var c=this.processActionInfo(e);t=c.descriptions,n=c.groupId}return{selectionType:o,descriptions:t,groupId:n,selectionId:l}},processFilmGroupInfo:function(e){var t=this,n=[];if(!this.cameraConfig||!this.cameraConfig.camera_group)return n.push(this.$t(e)||e),{descriptions:n};var o,l=!1,r=v(this.cameraConfig.camera_group);try{for(r.s();!(o=r.n()).done;){var c=o.value;if(c.id===e){if(c.options&&Array.isArray(c.options))c.options.forEach((function(option){var desc=option.desc||option.id;n.push(t.$t(desc)||desc)}));else{var desc=c.desc||e;n.push(this.$t(desc)||desc)}l=!0;break}}}catch(e){r.e(e)}finally{r.f()}return l||n.push(this.$t(e)||e),{descriptions:n}},processActionInfo:function(e){var t=this,n=[],o="";return this.cameraConfig&&this.cameraConfig.camera_config?(e.forEach((function(e){var l,r=!1,c=v(t.cameraConfig.camera_config);try{for(c.s();!(l=c.n()).done;){var d=l.value;if(d.options){var m,h=v(d.options);try{for(h.s();!(m=h.n()).done;){var option=m.value;if(option.id===e){var desc=option.desc||e;n.push(t.$t(desc)||desc),o||(o=d.id),r=!0;break}}}catch(e){h.e(e)}finally{h.f()}if(r)break}}}catch(e){c.e(e)}finally{c.f()}r||n.push(t.$t(e)||e)})),{descriptions:n,groupId:o}):(n.push.apply(n,Object(l.a)(e.map((function(e){return t.$t(e)||e})))),{descriptions:n,groupId:o})},getStandingCount:function(){var element=this.$refs.videoInputTextarea;return element?element.querySelectorAll(".standing").length:0},generateUniqueId:function(){return"standing_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)},showToast:function(e){this.$message.error(e)},addNewContent:function(e){if(e.options&&Array.isArray(e.options)){var t=this.generateUniqueId();this.activeStandingId=t,"group"===e.type?(this.activeGroup=e.selectedId,this.activeAction="",this.activeActions=[]):"action"===e.type&&(this.activeGroup=e.groupId,this.activeAction=e.selectedId,this.activeActions=e.options.map((function(option){return option.id})));var n=this.generateContentFromSelection(e,t),o=n.baseHtmlContent.replace('class="standing"','class="standing active"');this.contentMapping[n.combinedContent]=n.baseHtmlContent,this.insertHtmlToTextarea(o,n.combinedContent),this.$refs.videoInputTextarea.blur()}},replaceActiveContent:function(e,t){if(e.options&&Array.isArray(e.options)){for(var n=t.getAttribute("data-standing-id"),l=0,r=Object.entries(this.contentMapping);l<r.length;l++){var c=Object(o.a)(r[l],2),d=c[0];if(c[1].includes('data-standing-id="'.concat(n,'"'))){delete this.contentMapping[d];break}}var v=this.generateContentFromSelection(e,n);this.updateStandingElement(t,{standingId:n,groupId:e.groupId,selectionId:e.selectedId,selectionType:e.type,combinedContent:v.combinedContent,displayText:v.displayText}),t.classList.contains("active")||t.classList.add("active"),"group"===e.type?(this.activeGroup=e.selectedId,this.activeAction="",this.activeActions=[]):"action"===e.type&&(this.activeGroup=e.groupId,this.activeAction=e.selectedId,this.activeActions=e.options.map((function(option){return option.id}))),this.emitUpdatedContent()}},emitUpdatedContent:function(){var element=this.$refs.videoInputTextarea;if(element){this.isInternalUpdate=!0,this.checkEmpty();var e=this.getContentWithCombinedFormat(element);this.$emit("input",e)}},updateHighlightStatus:function(){var element=this.$refs.videoInputTextarea;if(element&&(element.querySelectorAll(".standing").forEach((function(e){e.classList.remove("active")})),this.activeStandingId)){var e=element.querySelector('[data-standing-id="'.concat(this.activeStandingId,'"]'));e&&e.classList.add("active")}},handleTextareaClick:function(e){var t=e.target;if(this.saveCursorPosition(),t.classList.contains("icon-guanbi2")){e.stopPropagation();var n=t.closest(".standing");if(n)return this.removeHtmlContent(n),void this.clearActiveState()}var o=t.closest(".standing");if(o){e.stopPropagation();var l=o.getAttribute("data-group-id"),r=o.getAttribute("data-standing-id"),c=o.getAttribute("data-selection-id"),d=o.getAttribute("data-selection-type"),v=o.getAttribute("data-combined-content");if(l&&r){if(this.activeStandingId=r,"group"===d)this.activeGroup=c,this.activeAction="",this.activeActions=[];else if("action"===d){this.activeGroup=l;var m=v.match(/{{camera:\[(.*?)\]:camera}}/);if(m&&m[1]){var h=m[1].split(",");this.activeAction=h.length>0?h[0]:"",this.activeActions=h}else this.activeAction=c,this.activeActions=[c]}this.updateHighlightStatus(),this.$refs.videoInputTextarea.blur(),this.openCameraControl(),this.$refs.videoCameraControl&&this.$refs.videoCameraControl.switchTabByType(d)}}else(this.activeGroup||this.activeStandingId||this.activeAction||this.activeActions.length>0)&&(this.clearActiveState(),this.updateHighlightStatus())},handleGlobalClick:function(e){if(this.isClient){var element=this.$refs.videoInputTextarea,t=this.$refs.videoCameraControl,n=element&&element.contains(e.target)||t&&t.$el&&t.$el.contains(e.target),o=e.target.closest(".camera_group_item"),l=e.target.closest(".action_btn_item");n||o||l||!(this.activeGroup||this.activeStandingId||this.activeAction||this.activeActions.length>0)||(this.clearActiveState(),this.updateHighlightStatus())}},removeHtmlContent:function(e){for(var t=e.getAttribute("data-standing-id"),n=0,l=Object.entries(this.contentMapping);n<l.length;n++){var r=Object(o.a)(l[n],2),c=r[0];if(r[1].includes('data-standing-id="'.concat(t,'"'))){delete this.contentMapping[c];break}}var d=e.previousSibling,v=e.nextSibling;e.remove(),d&&d.nodeType===Node.TEXT_NODE&&" "===d.textContent&&d.remove(),v&&v.nodeType===Node.TEXT_NODE&&" "===v.textContent&&v.remove(),this.emitUpdatedContent()},addActionToExistingStanding:function(e,t,n){for(var r=t.getAttribute("data-standing-id"),c=t.getAttribute("data-group-id"),d=t.getAttribute("data-selection-type"),v=0,m=Object.entries(this.contentMapping);v<m.length;v++){var h=Object(o.a)(m[v],2),f=h[0];if(h[1].includes('data-standing-id="'.concat(r,'"'))){delete this.contentMapping[f];break}}var _=t.querySelector(".standing-text"),y=_?_.textContent:"",C=e.options[0].id,w=e.options[0].desc,k=this.$t(w)||w,I=[].concat(Object(l.a)(n),[C]),x=y?"".concat(y,",").concat(k):k,T="{{camera:[".concat(I.join(","),"]:camera}}");this.updateStandingElement(t,{standingId:r,groupId:c,selectionId:C,selectionType:d,combinedContent:T,displayText:x}),this.activeAction=C,this.activeActions=I,this.emitUpdatedContent()},updateStandingAfterRemoval:function(e,t,n){for(var l=e.getAttribute("data-standing-id"),r=e.getAttribute("data-group-id"),c=e.getAttribute("data-selection-type"),d=t.length>0?t[0]:"",v=0,m=Object.entries(this.contentMapping);v<m.length;v++){var h=Object(o.a)(m[v],2),f=h[0];if(h[1].includes('data-standing-id="'.concat(l,'"'))){delete this.contentMapping[f];break}}var _=e.querySelector(".standing-text"),y=_?_.textContent:"",C=y?y.split(","):[];n>=0&&n<C.length&&C.splice(n,1);var w="{{camera:[".concat(t.join(","),"]:camera}}"),k=C.join(",");this.updateStandingElement(e,{standingId:l,groupId:r,selectionId:d,selectionType:c,combinedContent:w,displayText:k}),this.activeAction="",this.activeActions=t,this.emitUpdatedContent()},checkHasMainShot:function(e){var t,n=e.getAttribute("data-combined-content");if(!n)return!1;var o=n.match(/{{camera:\[(.*?)\]:camera}}/);if(!o||!o[1])return!1;var l=o[1].split(","),r=null===(t=this.$refs.videoCameraControl)||void 0===t?void 0:t.config;if(!r)return!1;if(r.camera_config){var c,d=v(r.camera_config);try{for(d.s();!(c=d.n()).done;){var m=c.value;if(m.options&&1===m.options.length){var h,f=v(m.options);try{for(f.s();!(h=f.n()).done;){var option=h.value;if(l.includes(option.id))return!0}}catch(e){f.e(e)}finally{f.f()}}}}catch(e){d.e(e)}finally{d.f()}}return!1},updateStandingWithReplacedAction:function(e,t,n,r){for(var c=e.getAttribute("data-standing-id"),d=e.getAttribute("data-group-id"),v=e.getAttribute("data-selection-type"),m=0,h=Object.entries(this.contentMapping);m<h.length;m++){var f=Object(o.a)(h[m],2),_=f[0];if(f[1].includes('data-standing-id="'.concat(c,'"'))){delete this.contentMapping[_];break}}var y=e.querySelector(".standing-text"),C=y?y.textContent:"",w=C?C.split(","):[],k=this.$t(r.desc)||r.desc;n>=0&&n<w.length?w[n]=k:w.length>0?w[0]=k:w.push(k);var I="{{camera:[".concat(t.join(","),"]:camera}}"),x=w.join(",");this.updateStandingElement(e,{standingId:c,groupId:d,selectionId:r.id,selectionType:v,combinedContent:I,displayText:x}),this.activeAction=r.id,this.activeActions=Object(l.a)(t),this.emitUpdatedContent()},saveCursorPosition:function(){if(this.isClient){var element=this.$refs.videoInputTextarea;if(element){var e=window.getSelection();if(e.rangeCount>0){var t=e.getRangeAt(0);element.contains(t.commonAncestorContainer)&&(this.lastCursorPosition={startContainer:t.startContainer,startOffset:t.startOffset,endContainer:t.endContainer,endOffset:t.endOffset})}}}},updateStandingElement:function(element,e){e.standingId;var t=e.groupId,n=e.selectionId,o=e.selectionType,l=e.combinedContent,r=e.displayText;element.setAttribute("data-group-id",t),element.setAttribute("data-selection-id",n),element.setAttribute("data-selection-type",o),element.setAttribute("data-combined-content",l);var c=element.querySelector(".standing-text");c?c.textContent=r:element.innerHTML='<span class="standing-text">'.concat(r,'</span><i class="iconfont icon-guanbi2"></i>');var d=element.outerHTML.replace(" active","");return this.contentMapping[l]=d,element}}},f=h,_=(n(4410),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("video-camera-control",{ref:"videoCameraControl",attrs:{activeGroup:e.activeGroup,activeActions:e.activeActions,"data-group":"camera_group_control"},on:{"camera-group-item-click":e.handleCameraGroupItemClick,"action-btn-item-click":e.handleActionBtnItemClick}},[t("div",{ref:"videoInputTextarea",staticClass:"video-custom-textarea",attrs:{contenteditable:"true","data-placeholder":e.placeholder},domProps:{innerHTML:e._s(e.isClient?"":e.ssrContent)},on:{copy:e.handleCopy,paste:e.handlePaste,input:e.handleInput,compositionstart:e.handleCompositionStart,compositionend:e.handleCompositionEnd,focus:e.handleFocus,blur:e.handleBlur,click:e.handleTextareaClick}})])}),[],!1,null,"6d5246c1",null);t.default=component.exports},3316:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(72),n(89),n(69),n(31),n(18),n(4),n(28),n(43),n(40),n(7),n(41),n(26);var o=n(268);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return r(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,c=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function r(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}var c={name:"VideoCameraControl",components:{MediaPreview:n(3317).default},props:{activeGroup:{type:String,default:""},activeActions:{type:Array,default:function(){return[]}}},data:function(){return{isShowCameraControl:!1,config:null,activeTab:"camera_group",tabList:[{label:"inputCamera_$2",value:"camera_group"},{label:"inputCamera_$3",value:"camera_config"}],loading:!1}},watch:{isShowCameraControl:function(e){var t=this;e&&!this.config&&this.getCameraConfig(),e&&(this.activeActions.length>0?this.activeTab="camera_config":this.activeGroup&&(this.activeTab="camera_group"),this.$nextTick((function(){setTimeout((function(){t.scrollToActiveElement()}),300)})))},activeGroup:function(e){var t=this;e&&this.isShowCameraControl&&this.$nextTick((function(){t.scrollToActiveElement()}))},activeActions:{handler:function(e){var t=this;e.length>0&&this.isShowCameraControl&&this.$nextTick((function(){t.scrollToActiveElement()}))},deep:!0}},mounted:function(){},methods:{handleOpenCameraControl:function(){this.isShowCameraControl=!0},closeCameraControl:function(){this.isShowCameraControl=!1},switchTabByType:function(e){"group"===e?this.activeTab="camera_group":"action"===e&&(this.activeTab="camera_config")},getCameraConfig:function(){var e=this;this.loading=!0,Object(o.c)({}).then((function(t){var n;1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)&&(e.config=null==t?void 0:t.data,e.initItemsPlayState(),e.$nextTick((function(){setTimeout((function(){e.scrollToActiveElement()}),100)})))})).finally((function(){e.loading=!1}))},handleTabClick:function(e){this.activeTab=e},initItemsPlayState:function(){var e=this;if(this.config)for(var t in this.config)this.config[t].forEach((function(t){e.$set(t,"shouldPlay",!1),e.$set(t,"activeVideoUrl",null)}))},isVideoFormat:function(e){if(!e)return!1;var t=e.toLowerCase();return[".mp4",".webm",".ogg",".avi",".mov"].some((function(e){return t.includes(e)}))},handleItemMouseEnter:function(e){this.isVideoFormat(e.url)&&this.$set(e,"shouldPlay",!0)},handleItemMouseLeave:function(e){this.isVideoFormat(e.url)&&this.$set(e,"shouldPlay",!1)},handleActionBtnMouseEnter:function(e,t){var n=this;e.url&&this.isVideoFormat(e.url)&&(this.$set(t,"shouldPlay",!1),this.$set(t,"activeVideoUrl",e.url),this.$nextTick((function(){n.$set(t,"shouldPlay",!0)})))},handleActionBtnMouseLeave:function(e){this.$set(e,"activeVideoUrl",null),this.$set(e,"shouldPlay",!1)},handleCameraGroupItemClick:function(e){this.$emit("camera-group-item-click",e)},handleActionBtnItemClick:function(e,t){this.$emit("action-btn-item-click",e,t)},scrollToActiveElement:function(){if(this.config){var e=document.querySelector(".video-camera-control-content-list");if(e)if("camera_group"===this.activeTab&&this.activeGroup){var t=e.querySelector(".activeGroupItem");t&&this.scrollElementIntoView(e,t)}else if("camera_config"===this.activeTab&&this.activeActions.length>0){var n=e.querySelectorAll(".action_btn_item.activeActionItem");if(!n||0===n.length)return;var o,r=e.getBoundingClientRect(),c=!1,d=l(n);try{for(d.s();!(o=d.n()).done;){var v=o.value.getBoundingClientRect();if(v.top>=r.top&&v.bottom<=r.bottom){c=!0;break}}}catch(e){d.e(e)}finally{d.f()}if(!c){var m=n[0].closest(".camera_config_item");m&&this.scrollElementIntoView(e,m)}}}},scrollElementIntoView:function(e,element){if(e&&element){var t=e.getBoundingClientRect(),n=element.getBoundingClientRect();if(!(n.top>=t.top&&n.bottom<=t.bottom)){var o=element.offsetTop-e.offsetTop-20;e.scrollTo({top:o,behavior:"smooth"})}}}}},d=(n(4409),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{placement:"bottom-end","visible-arrow":!1,"popper-class":"video-camera-control-popover",trigger:"manual"},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0),model:{value:e.isShowCameraControl,callback:function(t){e.isShowCameraControl=t},expression:"isShowCameraControl"}},[t("div",{staticClass:"video-camera-control-content"},[t("div",{staticClass:"video-camera-control-content-header"},[t("span",{staticClass:"video-camera-control-content-header-title"},[e._v(e._s(e.$t("inputCamera_$1")))]),e._v(" "),t("div",{staticClass:"video-camera-control-content-header-right"},[t("i",{staticClass:"iconfont icon-close",on:{click:function(t){e.isShowCameraControl=!1}}})])]),e._v(" "),t("div",{staticClass:"video-camera-control-content-tab"},e._l(e.tabList,(function(n,o){return t("div",{key:n.value,staticClass:"video-camera-control-content-tab-item",class:{active:e.activeTab===n.value},on:{click:function(t){return e.handleTabClick(n.value)}}},[t("span",{staticClass:"video-camera-control-content-tab-item-title"},[e._v(e._s(e.$t(n.label)))])])})),0),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"video-camera-control-content-body"},[e._l(e.config,(function(n,o){return e.config?[e.activeTab===o?t("div",{key:o,staticClass:"video-camera-control-content-list"},e._l(n,(function(n){return t("div",{key:n.id,staticClass:"video-camera-control-content-body-item"},["camera_group"==e.activeTab?t("div",{staticClass:"camera_group_item",class:{activeGroupItem:e.activeGroup===n.id},attrs:{"data-event":"movie_shot","data-desc":"aiVideo","data-type":"cinematic_shots"},on:{click:function(t){return e.handleCameraGroupItemClick(n)}}},[t("div",{staticClass:"main_camera_group_item",on:{mouseenter:function(t){return e.handleItemMouseEnter(n)},mouseleave:function(t){return e.handleItemMouseLeave(n)}}},[e.isVideoFormat(n.url)?t("MediaPreview",{attrs:{cover:n.cover,url:n.url,shouldPlay:n.shouldPlay||e.activeGroup===n.id}}):t("img",{attrs:{src:n.cover,alt:""}})],1),e._v(" "),t("div",{staticClass:"camera_group_item_desc"},[e._v(e._s(e.$t(n.desc)))])]):e._e(),e._v(" "),"camera_config"==e.activeTab?t("div",{staticClass:"camera_config_item"},[e.isVideoFormat(n.activeVideoUrl||n.url)?t("MediaPreview",{key:n.activeVideoUrl||n.url,attrs:{cover:n.cover,url:n.activeVideoUrl||n.url,shouldPlay:n.shouldPlay}}):t("img",{attrs:{src:n.cover,alt:""}}),e._v(" "),t("div",{staticClass:"action_btn"},[t("div",{staticClass:"action_btn_list"},e._l(n.options,(function(o){return t("div",{key:o.id,staticClass:"action_btn_item",class:{activeActionItem:e.activeActions.includes(o.id)},attrs:{"data-event":"movie_shot","data-desc":"aiVideo","data-type":"free_selection"},on:{click:function(t){return e.handleActionBtnItemClick(o,n)},mouseenter:function(t){return e.handleActionBtnMouseEnter(o,n)},mouseleave:function(t){return e.handleActionBtnMouseLeave(n)}}},[t("i",{staticClass:"iconfont",class:o.icon}),e._v(" "),t("span",[e._v(e._s(e.$t(o.desc)))])])})),0)])],1):e._e()])})),0):e._e()]:e._e()})),e._v(" "),e.config?t("div",{staticClass:"tips"},[e._v(e._s(e.$t("inputCamera_$4")))]):e._e()],2)])])}),[],!1,null,null,null);t.default=component.exports},3317:function(e,t,n){"use strict";n.r(t);var o={name:"MediaPreview",props:{cover:{type:String,required:!0},url:{type:String,required:!0},shouldPlay:{type:Boolean,default:!1}},watch:{shouldPlay:function(e){e?this.playVideo():this.pauseVideo()},url:function(e,t){var n=this;e!==t&&this.$nextTick((function(){n.shouldPlay&&n.resetAndPlay()}))}},methods:{playVideo:function(){var video=this.$refs.video;video&&video.play().catch((function(e){console.warn("视频播放失败:",e)}))},pauseVideo:function(){var video=this.$refs.video;video&&(video.currentTime=0,video.pause())},resetAndPlay:function(){var video=this.$refs.video;video&&(video.currentTime=0,this.playVideo())}}},l=(n(4408),n(0)),component=Object(l.a)(o,(function(){var e=this;return(0,e._self._c)("video",{ref:"video",attrs:{src:e.url,poster:e.cover,muted:"",loop:"",preload:"metadata"},domProps:{muted:!0}})}),[],!1,null,"96c11a26",null);t.default=component.exports},3318:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(18);var o=n(2),l=n(3),r=(n(20),n(6),n(16),n(12),n(13),n(8),n(4),n(7),n(28),n(128));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={emits:["create"],data:function(){return{visible:!1,modelInfo:{}}},mounted:function(){this.getRecommendedEffect()},methods:{isMp4:function(e){return!!e&&/\.mp4$/i.test(e)},getRecommendedEffect:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,c,v,m,h,f,_,y,C,w,k,I,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.c)({source:1});case 2:o=t.sent,1e4===(null===(n=o.status)||void 0===n?void 0:n.code)&&(e.modelInfo=(null===(l=o.data)||void 0===l?void 0:l.task_guide)||{},null!==e.modelInfo.banner&&[2,1e4].includes(e.modelInfo.obj_type)&&(e.modelInfo=d(d({},e.modelInfo),{},{name:null!==(c=null!==(v=null===(m=e.modelInfo)||void 0===m?void 0:m.title[e.$i18n.locale])&&void 0!==v?v:e.$t(null===(h=e.modelInfo)||void 0===h||null===(h=h.title)||void 0===h?void 0:h.title))&&void 0!==c?c:"",description:null!==(f=null!==(_=null===(y=e.modelInfo)||void 0===y?void 0:y.desc[e.$i18n.locale])&&void 0!==_?_:e.$t(null===(C=e.modelInfo)||void 0===C||null===(C=C.desc)||void 0===C?void 0:C.title))&&void 0!==f?f:""})),e.modelInfo.showed_video_guide&&null!==e.modelInfo.banner&&(e.visible=!0,e.$xyLogEvent({front_operation:"exposure",entity_name:"video_model_recommend_modal_exposure",entity_type:"video_model_recommend_modal",event_name:"exposure",obj_id:null===(w=e.modelInfo)||void 0===w?void 0:w.model_id,position:"generate_video_effect_recommend_modal",obj_info:{base_model:null===(k=e.modelInfo)||void 0===k?void 0:k.base_model,model_id:null===(I=e.modelInfo)||void 0===I?void 0:I.model_id,model_ver_no:null===(x=e.modelInfo)||void 0===x?void 0:x.model_ver_no}})));case 4:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.visible=!1,Object(r.a)({source:1,behavior:"enterPage"});case 2:case"end":return t.stop()}}),t)})))()},handleCreate:function(){this.close(),this.$emit("create",this.modelInfo)}}},m=(n(4413),n(0)),component=Object(m.a)(v,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y=this,C=y._self._c;return C("el-popover",{ref:"modelPopover",attrs:{"popper-class":"recommend-model-popover",placement:"right","visible-arrow":!1,width:"328",trigger:"manual"},model:{value:y.visible,callback:function(e){y.visible=e},expression:"visible"}},[C("div",{staticClass:"model-popover-content"},[C("div",{staticClass:"model-popover-content-title"},[C("span",{staticClass:"model-popover-content-title-text"},[y._v(y._s(null===(e=y.modelInfo)||void 0===e?void 0:e.name))]),y._v(" "),C("i",{staticClass:"iconfont icon-guanbi1",attrs:{"data-event":"video_model_recommend_modal_close","data-id":null===(t=y.modelInfo)||void 0===t?void 0:t.model_id,"data-info":JSON.stringify({base_model:null===(n=y.modelInfo)||void 0===n?void 0:n.base_model,model_id:null===(o=y.modelInfo)||void 0===o?void 0:o.model_id,model_ver_no:null===(l=y.modelInfo)||void 0===l?void 0:l.model_ver_no})},on:{click:y.close}})]),y._v(" "),C("div",{staticClass:"model-popover-content-body"},[C("div",{staticClass:"model-popover-content-body-item"},[C("span",{staticClass:"model-popover-content-body-item-text"},[y._v(y._s(null===(r=y.modelInfo)||void 0===r?void 0:r.description))])]),y._v(" "),C("div",{staticClass:"model-popover-content-body-item"},[y.isMp4(null===(c=y.modelInfo.banner)||void 0===c?void 0:c.url)?C("video",{staticClass:"model-popover-content-body-item-img",attrs:{src:null===(d=y.modelInfo.banner)||void 0===d?void 0:d.url,autoplay:"",muted:"",loop:"",playsinline:""},domProps:{muted:!0}}):C("img",{staticClass:"model-popover-content-body-item-img",attrs:{src:null===(v=y.modelInfo.banner)||void 0===v?void 0:v.url}})]),y._v(" "),C("div",{staticClass:"model-popover-content-body-item",on:{click:y.handleCreate}},[C("div",{staticClass:"generate-btn",attrs:{"data-event":"video_model_recommend_modal_generate","data-id":null===(m=y.modelInfo)||void 0===m?void 0:m.model_id,"data-info":JSON.stringify({base_model:null===(h=y.modelInfo)||void 0===h?void 0:h.base_model,model_id:null===(f=y.modelInfo)||void 0===f?void 0:f.model_id,model_ver_no:null===(_=y.modelInfo)||void 0===_?void 0:_.model_ver_no})}},[y._v("\n          "+y._s(y.$t("Generate"))+"\n        ")])])])])])}),[],!1,null,"5861c082",null);t.default=component.exports},3319:function(e,t,n){"use strict";n.r(t);var o=n(604),l=n(3320),r=n(3326),c=n(3329),d={name:"audioParamsPanel",components:{AudioTabs:o.default,lipSync:l.default,aiMusic:r.default,aiVoice:c.default},props:["value","menuIndex"],inject:["easyTop"],data:function(){return{}},computed:{currentParamsComponent:function(){var component="";switch(this.value.currentAudioTab){case"videoAddLipSync":component="lipSync";break;case"aiVoice":component="aiMusic";break;case"videoAddMusic":component="aiVoice"}return component},currentValue:function(){var e="";switch(this.value.currentAudioTab){case"videoAddLipSync":e="lipSyncParams";break;case"aiVoice":e="aiVoice";break;case"videoAddMusic":e="videoAddMusic"}return this.value[e]}}},v=d,m=(n(4436),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"audio-params-panel dot-group"},[t("audio-tabs",{attrs:{value:e.value.currentAudioTab},on:{"update:value":function(t){return e.$set(e.value,"currentAudioTab",t)}}}),e._v(" "),t(e.currentParamsComponent,e._g({tag:"component",attrs:{value:e.currentValue,"menu-index":e.menuIndex},on:{"update:value":function(t){e.currentValue=t}}},e.$listeners))],1)}),[],!1,null,"073961c8",null);t.default=component.exports},3320:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),l=n(2),r=(n(20),n(19),n(32),n(16),n(18),n(24),n(65),n(4),n(21),n(40),n(41),n(26),n(141),n(142),n(109),n(1)),c=n(38),d=n(46),v=n(29),m=n(175),h=n(292),f=n(820),_=n(880),y=n(881),C=n(3321),w=n(882),k=n(883),I=n(9);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={name:"lipSync",inject:["easyTop"],mixins:[f.default],components:{SelectVideo:_.default,SampleVideo:y.default,LipSyncParamsDialog:C.default,AudioClipDialog:w.default,VipPrivateCreate:k.default},props:["value","menuIndex"],data:function(){return{sale:0,cost:0,calculate_coins_before_discount:0,loading:!1,showLipSyncDialog:!1,costTimer:null,detailInfo:{},checkLoading:!1}},computed:T(T(T(T({},Object(r.c)("creation",["video_config"])),Object(r.c)("user",["isLoggedIn"])),Object(r.c)("aiAudio",["emotionList"])),{},{sampleVideoList:function(){var e;return(null===(e=this.video_config)||void 0===e?void 0:e.lip_sync)||[]},createBtnDisabled:function(){var e,t="lipSyncText"===this.value.lipSyncTab&&this.value.audioParams.prompt,n="lipSyncUpload"===this.value.lipSyncTab&&this.value.audioParams.localAudio.url;return!(null!==(e=this.value.videoInfo)&&void 0!==e&&e.url&&(t||n))},currentLang:function(){return this.$cookies.get("lang")||this.$i18n.locale||"en"},showSelectAudioInfo:function(){var text="".concat(this.$t("audio_for_lipsync_mode1"),"/").concat(this.$t("audio_for_lipsync_mode2"));if("lipSyncText"===this.value.lipSyncTab&&this.value.audioParams.audioTts.duration){var e,t=this.value.audioParams,n=this.emotionList.find((function(e){return e.id===t.emotion}));text="".concat(t.audioTts.duration,"s | ").concat((null===(e=t.timbre)||void 0===e?void 0:e.title)||""," | ").concat(t.speed,"x | ").concat(this.$t((null==n?void 0:n.label)||""))}else if("lipSyncUpload"===this.value.lipSyncTab&&this.value.audioParams.localAudio.url){var o=this.value.audioParams,l=o.clipAudio.url?o.clipAudio.duration.toFixed(1):o.localAudio.duration.toFixed(1);text=this.$t("audio_clip_prompt2",{x:l})}return text},disabledButtonTips:function(){var e;return null!==(e=this.value.videoInfo)&&void 0!==e&&e.url?"lipSyncText"!==this.value.lipSyncTab||this.value.audioParams.prompt?"lipSyncUpload"!==this.value.lipSyncTab||this.value.audioParams.localAudio.url?"":this.$t("creation-tips_audio"):this.$t("creation-tips_text"):this.$t("creation-tips_video")}}),watch:{"value.videoInfo":{handler:function(){var e,t,n;(this.getEstimatedCost(),null!==(e=this.value.videoInfo)&&void 0!==e&&e.id)?(this.getMetaInfo(null===(t=this.value.videoInfo)||void 0===t?void 0:t.isTask),null!==(n=this.value.videoInfo)&&void 0!==n&&n.needCheckVideo&&this.handleVideoChange(this.value.videoInfo,!0)):this.detailInfo={}},immediate:!0,deep:!0},"value.audioParams.timbre.id":{handler:function(e){e||this.getVoiceList()}}},mounted:function(){var e;null!==(e=this.value)&&void 0!==e&&null!==(e=e.audioParams)&&void 0!==e&&null!==(e=e.timbre)&&void 0!==e&&e.id||this.getVoiceList()},beforeDestroy:function(){this.showLipSyncDialog=!1},methods:{handleCLick:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,m,h,f,_,y,C,audio,video;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(d=e.length>0&&void 0!==e[0]?e[0]:"",t.isLoggedIn){n.next=4;break}return t.$EventBus.$emit("openLoginDialog"),n.abrupt("return");case 4:if(t.loading=!0,v=(null===(o=t.detailInfo)||void 0===o?void 0:o.id)||"",m={model_no:(null===(l=t.detailInfo)||void 0===l||null===(l=l.art_model)||void 0===l?void 0:l.id)||"",model_ver_no:(null===(r=t.detailInfo)||void 0===r||null===(r=r.art_model)||void 0===r?void 0:r.model_ver_no)||"",meta:{generate_video:{origin_task_id:v,audio_to_lip_video:{audio_uri:""},video_url:""}}},null!==(c=t.value.videoInfo)&&void 0!==c&&c.isTask?null!==(h=t.detailInfo)&&void 0!==h&&null!==(h=h.meta)&&void 0!==h&&null!==(h=h.generate_video)&&void 0!==h&&h.origin_task_id&&(m.meta.generate_video.origin_task_id=null===(f=t.detailInfo)||void 0===f||null===(f=f.meta)||void 0===f||null===(f=f.generate_video)||void 0===f?void 0:f.origin_task_id):m.meta.generate_video.origin_task_id=(null===(_=t.detailInfo)||void 0===_||null===(_=_.task)||void 0===_?void 0:_.task_id)||"","lipSyncText"!==t.value.lipSyncTab){n.next=38;break}if(t.value.audioParams.audioTts.url||d){n.next=32;break}if(n.prev=10,t.value.audioParams.audioTts.file){n.next=14;break}return n.next=14,t.getAudioFile();case 14:return n.next=16,t.uploadFile(t.value.audioParams.audioTts.file);case 16:if(!(C=n.sent)){n.next=24;break}if(t.value.audioParams.audioTts.url=C,t.checkAudioDuration(t.value.audioParams.audioTts,t.value.videoInfo)){n.next=22;break}return t.loading=!1,n.abrupt("return");case 22:n.next=26;break;case 24:return t.loading=!1,n.abrupt("return");case 26:n.next=32;break;case 28:return n.prev=28,n.t0=n.catch(10),t.loading=!1,n.abrupt("return");case 32:m.meta.generate_video.audio_to_lip_video.audio_uri=d||t.value.audioParams.audioTts.url,m.meta.generate_video.video_url=t.value.videoInfo.url,m.meta.prompt=t.value.audioParams.prompt,m.meta.generate_video.audio_to_lip_video.voice_id=null===(y=t.value.audioParams.timbre)||void 0===y?void 0:y.id,n.next=46;break;case 38:if("lipSyncUpload"!==t.value.lipSyncTab){n.next=46;break}if(audio=t.value.audioParams.clipAudio.url?t.value.audioParams.clipAudio:t.value.audioParams.localAudio,video=t.value.videoInfo,d||t.checkAudioDuration(audio,video)){n.next=44;break}return t.loading=!1,n.abrupt("return");case 44:m.meta.generate_video.audio_to_lip_video.audio_uri=d||audio.url,m.meta.generate_video.video_url=video.url;case 46:t.generateLipSyncTask(m);case 47:case"end":return n.stop()}}),n,null,[[10,28]])})))()},getVoiceList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.d)({type:e.type});case 2:o=t.sent,data=o.data,1e4===o.status.code&&null!=data&&null!==(n=data.items)&&void 0!==n&&n.length&&(e.value.audioParams.timbre=(null==data?void 0:data.items[0])||{});case 6:case"end":return t.stop()}}),t)})))()},getMetaInfo:function(){var e,t,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l={task_flow_version:"v2"};return o?l.id=null===(e=this.value.videoInfo)||void 0===e?void 0:e.id:l.art_work_no=null===(t=this.value.videoInfo)||void 0===t?void 0:t.id,(o?v.getMetaInfo:v.getTaskConfig)(l).then((function(e){var t;[1e4,"10000"].includes(null==e||null===(t=e.status)||void 0===t?void 0:t.code)?n.detailInfo=(null==e?void 0:e.data)||{}:n.detailInfo={}})).finally((function(){}))},checkAudioDuration:function(audio,video){return!(audio.duration>video.duration)||(this.$refs.audioClipDialog&&this.$refs.audioClipDialog.show(audio.url,Number(video.duration).toFixed(1),audio.name),!1)},handleAudioClipConfirm:function(e){this.handleCLick(e.url)},generateLipSyncTask:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(h.a)(e);case 3:(l=n.sent)&&1e4===(null==l||null===(o=l.status)||void 0===o?void 0:o.code)?(null!=l&&null!==(r=l.data)&&void 0!==r&&r.id?(t.$message.success(t.$t("CreateSuccess")),null==t||t.easyTop.updateTask(T(T({},null==l?void 0:l.data),{},{status:1,task_domain_type:20})),t.showLipSyncDialog=!1):t.$message.error(t.$t("comicPage17")),t.loading=!1):(t.loading=!1,t.$message.error(t.$t("comicPage17"))),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),t.loading=!1,t.$message.error(t.$t("comicPage17"));case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},handleVideoLoadedMetadata:function(video){this.value.videoInfo.duration=video.duration},getAudioFile:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,d,v,m,h,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=e.value.audioParams.timbre||{},l={author_id:(null==o||null===(n=o.author)||void 0===n?void 0:n.id)||"",scene:"trial",timbre_id:(null==o?void 0:o.id)||"",text:e.value.audioParams.prompt,speed:e.value.audioParams.speed,emotion:e.value.audioParams.emotion,ss:I.e.GenerateCreate},t.next=5,Object(c.db)(l);case 5:if(1e4!==(r=t.sent).status.code){t.next=14;break}return v=(null===(d=r.data)||void 0===d?void 0:d.url)||"",t.next=10,e.generateAudioFile(v);case 10:(m=t.sent)&&(e.value.audioParams.audioTts.file=m,e.value.audioParams.audioTts.name=m.name,e.value.audioParams.audioTts.duration=(null===(h=r.data)||void 0===h?void 0:h.duration)||0),t.next=21;break;case 14:t.t0=null==r||null===(f=r.status)||void 0===f?void 0:f.code,t.next=70026===t.t0?17:19;break;case 17:return e.$message.error(e.$t("HttpErrorCode_70026")),t.abrupt("break",20);case 19:e.$message.error(r.status.msg||e.$t("comicPage17"));case 20:e.loading=!1;case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(0),console.error(t.t1);case 26:case"end":return t.stop()}}),t,null,[[0,23]])})))()},generateAudioFile:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.saveAudioData(e);case 3:return n.next=5,t.createAudioBlob();case 5:return o=n.sent,l=new File([o],"audio.aac",{type:"audio/aac"}),n.abrupt("return",l);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",null);case 13:return n.prev=13,t.chunks=[],n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[0,10,13,16]])})))()},beforeUpload:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.file.raw,["video/mp4","video/quicktime"].includes(o.type)){n.next=6;break}return t.$message.error(t.$t("upload_video_error1")),n.abrupt("return",!1);case 6:if(o.size<=104857600){n.next=11;break}return t.$message.error(t.$t("upload_video_error2")),n.abrupt("return",!1);case 11:return n.prev=11,n.next=14,new Promise((function(e,n){var l=document.createElement("video");l.preload="metadata";var r=window.URL||window.webkitURL,c=r.createObjectURL(o);l.src=c,l.onloadedmetadata=function(){r.revokeObjectURL(c);var o=l.duration;if(o<2||o>10)n(t.$t("upload_video_error3"));else{var d=l.videoWidth,v=l.videoHeight;d>=720&&d<=1920&&v>=720&&v<=1920?e(!0):n(t.$t("upload_video_error4"))}},l.onerror=function(){r.revokeObjectURL(c),n(t.$t("uploadError"))}}));case 14:return l=n.sent,n.abrupt("return",l);case 18:return n.prev=18,n.t0=n.catch(11),t.$message.error(n.t0),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[11,18]])})))()},checkVideo:function(video){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=video.url){t.next=3;break}return t.abrupt("return",!0);case 3:return t.abrupt("return",new Promise((function(t,o){Object(d.easyCheckVideo)({url:n}).then((function(n){var l;1e4===(null==n||null===(l=n.status)||void 0===l?void 0:l.code)?t(n.data.result):o(n.status.msg||e.$t("comicPage17"))})).catch((function(e){o(e)}))})));case 4:case"end":return t.stop()}}),t)})))()},handleVideoChange:function(e){var t=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(l=t.length>1&&void 0!==t[1]&&t[1])&&(n.value.videoInfo.needCheckVideo=!1),n.checkLoading=!0,r=!1,o.prev=4,o.next=7,n.checkVideo(e);case 7:r=o.sent,o.next=14;break;case 10:return o.prev=10,o.t0=o.catch(4),n.checkLoading=!1,o.abrupt("return");case 14:if(n.checkLoading=!1,r){o.next=19;break}return n.$message.error(n.$t("audio_clip_warn1")),l&&(n.value.videoInfo={id:"",url:"",isTask:!1}),o.abrupt("return");case 19:n.value.videoInfo={id:(null==e?void 0:e.id)||"",url:(null==e?void 0:e.url)||"",isTask:!1};case 20:case"end":return o.stop()}}),o,null,[[4,10]])})))()},handleVideoSampleChange:function(e){this.value.videoInfo={id:"",url:(null==e?void 0:e.url)||"",duration:(null==e?void 0:e.duration)||0,isTask:!1}},handleLipSyncParamsDialog:function(){this.showLipSyncDialog=!this.showLipSyncDialog},getEstimatedCost:function(){var e,t=this,n={meta:{generate_video:{generate_video_duration:(null===(e=this.value.videoInfo)||void 0===e?void 0:e.duration)||0,audio_to_lip_video:{}}}};this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null),this.costTimer=setTimeout((function(){Object(m.b)(T({},n)).then((function(e){var n=(null==e?void 0:e.data)||{},o=n.calculate_coins,l=n.discount_off_rate,r=n.calculate_coins_before_discount;t.cost=o,t.sale=l,t.calculate_coins_before_discount=r||0})).catch((function(e){t.cost=0,t.sale=0,t.calculate_coins_before_discount=0}))}),1e3)}}},O=S,P=(n(4426),n(0)),component=Object(P.a)(O,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"lip-sync-params",attrs:{"data-group":"video-lipsync-params"}},[t("div",{staticClass:"lip-sync-params-content"},[t("div",{staticClass:"content-item"},[t("select-video",{attrs:{value:e.value.videoInfo,"show-cover-img":!1,title:"selectingMaterialsType3",selectVideoTips:"upload_video",tips:"upload_video_text",tabListKeys:["upload","pick"],fileTypes:["video"],beforeUpload:e.beforeUpload,personalWorksQueryObj:{duration:10,min_duration:2,resolutions:["720","1080"]},videoCategory:64,checkLoading:e.checkLoading,checkLoadingText:e.$t("audio_clip_load")},on:{"update:value":function(t){return e.$set(e.value,"videoInfo",t)},change:e.handleVideoChange,loadedMetadata:e.handleVideoLoadedMetadata}}),e._v(" "),t("div",{staticClass:"tips"},[t("i",{staticClass:"el-icon-warning"}),e._v("\n        "+e._s(e.$t("audio_clip_warn3"))+"\n      ")]),e._v(" "),t("sample-video",{attrs:{value:e.sampleVideoList,limit:5,"data-event":"lipsync_sample_video"},on:{change:e.handleVideoSampleChange}}),e._v(" "),t("div",{staticClass:"params-item"},[t("div",{staticClass:"params-item-title"},[e._v(e._s(e.$t("audio_for_lipsync_title")))]),e._v(" "),t("div",{staticClass:"params-item-content"},[t("el-tooltip",{attrs:{content:e.showSelectAudioInfo,placement:"top"}},[t("span",{staticClass:"ellipsis"},[e._v(e._s(e.showSelectAudioInfo))])]),e._v(" "),t("div",{staticClass:"params-item-content-right",on:{click:e.handleLipSyncParamsDialog}},[t("i",{staticClass:"iconfont icon-icon-uploadmanu"})])],1)]),e._v(" "),t("vip-private-create")],1)]),e._v(" "),t("el-tooltip",{attrs:{content:e.disabledButtonTips,disabled:!e.createBtnDisabled,placement:"top"}},[t("el-button",{class:{"no-sale":!e.sale,disabled:e.createBtnDisabled},attrs:{type:"primary","data-sale":"".concat(e.sale,"% Off"),disabled:e.createBtnDisabled,"data-id":"video-lipsync-generate",loading:e.loading},on:{click:function(t){return t.preventDefault(),function(){return e.handleCLick()}.apply(null,arguments)}}},[e._v(e._s(e.$t("Generate"))+"("+e._s(e.$t("expend"))+":\n      "),e.calculate_coins_before_discount?t("span",{staticClass:"generate-before-discount"},[e._v(e._s(e.calculate_coins_before_discount))]):e._e(),e._v("\n      "+e._s(e.cost)+")")])],1),e._v(" "),t("lip-sync-params-dialog",{attrs:{visible:e.showLipSyncDialog,value:e.value},on:{"update:visible":function(t){e.showLipSyncDialog=t},"update:value":function(t){e.value=t}}}),e._v(" "),t("audio-clip-dialog",{ref:"audioClipDialog",on:{confirm:e.handleAudioClipConfirm}})],1)}),[],!1,null,"1b5fa488",null);t.default=component.exports},3321:function(e,t,n){"use strict";n.r(t);var o=n(604),l=n(3322),r=n(3324),c={name:"LipSyncParamsDialog",components:{AudioTabs:o.default,lipSyncText:l.default,lipSyncUpload:r.default},props:{visible:{type:Boolean,default:!1},value:{type:Object,default:function(){return{}}}},data:function(){return{tabs:[{label:"audio_for_lipsync_mode1",id:"lipSyncText"},{label:"audio_for_lipsync_mode2",id:"lipSyncUpload"}]}},mounted:function(){},methods:{handleClose:function(){this.$emit("update:visible",!1),this.$emit("close")}}},d=(n(4424),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,modal:!1,title:"","custom-class":"lip-sync-params-dialog","show-close":!1,top:"0px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"lip-sync-params-dialog-header"},[t("span",{staticClass:"lip-sync-params-dialog-header-title"},[e._v(e._s(e.$t("audio_for_lipsync_title")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1",on:{click:e.handleClose}})]),e._v(" "),t("div",{staticClass:"lip-sync-params-dialog-content"},[t("audio-tabs",{attrs:{tabs:e.tabs,value:e.value.lipSyncTab,"active-type":"underline"},on:{"update:value":function(t){return e.$set(e.value,"lipSyncTab",t)}}}),e._v(" "),t(e.value.lipSyncTab,{tag:"component",attrs:{value:e.value},on:{"update:value":function(t){e.value=t}}})],1)])}),[],!1,null,"7652fc1d",null);t.default=component.exports},3322:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(18),n(3323)),r=n(256),c=n(1),d=n(9);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var m={name:"LipSyncText",props:{value:{type:Object,default:function(){return{}}}},data:function(){return{DETECT_SENSITIVE_WORDS_SCENE_VALUE:d.e}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(c.c)("aiAudio",["emotionList"])),components:{SelectVoiceTimbre:l.default,audioPlayer:r.a},methods:{changeEmotion:function(e){this.value.audioParams.emotion=e,this.resetAudioTtsFile()},changeSpeed:function(e){this.value.audioParams.speed=e,this.resetAudioTtsFile()},resetAudioTtsFile:function(e){this.value.audioParams.audioTts={file:"",url:"",name:"",duration:0}},fileGenerated:function(e){this.value.audioParams.audioTts={file:e.file,url:"",name:e.name,duration:e.duration}}}},h=m,f=(n(4419),n(0)),component=Object(f.a)(h,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"lip-sync-text"},[n("div",{staticClass:"lip-sync-text-input"},[n("el-input",{attrs:{type:"textarea",placeholder:t.$t("audio_for_text"),resize:"none",rows:4,maxlength:50},on:{change:t.resetAudioTtsFile},model:{value:t.value.audioParams.prompt,callback:function(e){t.$set(t.value.audioParams,"prompt",e)},expression:"value.audioParams.prompt"}}),t._v(" "),n("div",{staticClass:"lip-sync-text-input-tip"},[n("audio-player",{ref:"audioPlayer",attrs:{item:t.value.audioParams.timbre,playIconCustomStyle:{position:"unset"},customClass:"tip-audio-player",modelPlay:"",disabled:0===t.value.audioParams.prompt.length,saveAudioFileOptions:{shouldSaveFile:!0,onFileGenerated:t.fileGenerated},extraParams:{speed:t.value.audioParams.speed,emotion:t.value.audioParams.emotion,text:t.value.audioParams.prompt,ss:t.DETECT_SENSITIVE_WORDS_SCENE_VALUE.GenerateCreate}}}),t._v(" "),null!==(e=t.value.audioParams.audioTts)&&void 0!==e&&e.duration?n("span",{staticClass:"tip-audio-player-text"},[t._v(t._s(t.$t("audio_for_time")+": "+t.value.audioParams.audioTts.duration+"s"))]):n("span",{staticClass:"tip-audio-player-text ellipsis"},[t._v(t._s(t.$t("audio_for_time_trial")))])],1)],1),t._v(" "),n("div",{staticClass:"lip-sync-text-item"},[n("div",{staticClass:"lip-sync-text-item-title"},[n("span",[t._v(t._s(t.$t("audio_selection")))])]),t._v(" "),n("div",{staticClass:"lip-sync-text-item-content"},[n("select-voice-timbre",{attrs:{value:t.value.audioParams.timbre,voiceExtraParams:{speed:t.value.audioParams.speed,emotion:t.value.audioParams.emotion,text:t.value.audioParams.prompt,ss:t.DETECT_SENSITIVE_WORDS_SCENE_VALUE.GenerateCreate}},on:{"update:value":function(e){return t.$set(t.value.audioParams,"timbre",e)},change:t.resetAudioTtsFile,fileGenerated:t.fileGenerated}})],1)]),t._v(" "),n("div",{staticClass:"lip-sync-text-item"},[n("div",{staticClass:"lip-sync-text-item-title"},[n("span",[t._v(t._s(t.$t("audio_speed")))]),t._v(" "),n("span",{staticClass:"title-right"},[t._v(t._s(t.value.audioParams.speed)+"x")])]),t._v(" "),n("div",{staticClass:"lip-sync-text-item-content"},[n("el-slider",{staticClass:"speed-slider-item",attrs:{value:t.value.audioParams.speed,min:.5,max:2,step:.1,"show-tooltip":!1},on:{input:t.changeSpeed,change:t.resetAudioTtsFile}})],1)]),t._v(" "),n("div",{staticClass:"lip-sync-text-item"},[n("div",{staticClass:"lip-sync-text-item-title"},[n("span",[t._v(t._s(t.$t("audio_emotion")))])]),t._v(" "),n("div",{staticClass:"lip-sync-text-item-content"},[n("div",{staticClass:"emotion-content"},t._l(t.emotionList,(function(e){return n("div",{key:e.id,staticClass:"emotion-item",class:{active:t.value.audioParams.emotion===e.id},on:{click:function(n){return t.changeEmotion(e.id)}}},[n("span",[t._v(t._s(t.$t(e.label)))])])})),0)])])])}),[],!1,null,"f83f19a8",null);t.default=component.exports},3323:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(256)),r=n(292),c={name:"SelectVoiceTimbre",components:{audioPlayer:l.a},props:{value:{type:Object,default:function(){return{}}},voiceExtraParams:{type:Object,default:function(){return{}}}},data:function(){return{type:0,types:[{label:"All",value:0},{label:"audio_type1",value:1},{label:"audio_type2",value:2},{label:"audio_type3",value:3},{label:"audio_type4",value:4},{label:"audio_type5",value:5},{label:"audio_type6",value:6},{label:"audio_type7",value:7}],left:0,voiceList:[],recentVoiceId:""}},computed:{currentLang:function(){return this.$cookies.get("lang")||this.$i18n.locale||"en"}},mounted:function(){this.getVoiceList(),this.getRecentVoice()},methods:{getVoiceList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.d)({type:e.type});case 2:n=t.sent,data=n.data,1e4===n.status.code&&(e.voiceList=(null==data?void 0:data.items)||[],0!==e.type||e.value.id||e.$emit("update:value",e.voiceList[0]));case 6:case"end":return t.stop()}}),t)})))()},getRecentVoice:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.c)();case 2:n=t.sent,data=n.data,1e4===n.status.code&&(e.recentVoiceId=(null==data?void 0:data.id)||"");case 6:case"end":return t.stop()}}),t)})))()},handleTypeChange:function(e){this.type=e,this.getVoiceList()},handleTimbreChange:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$emit("update:value",e),this.$emit("change",e),t&&this.$refs["audioPlayer"+e.id]&&this.$refs["audioPlayer"+e.id][0]&&this.$refs["audioPlayer"+e.id][0].handleClickPlay()},onFileGenerated:function(e){this.$emit("fileGenerated",e)},handleControls:function(e){if("left"===e){if(this.left>=0)return void(this.left=0);this.left+=180}else{if(Math.abs(this.left)>=this.$refs.selectVoiceTimbreType.offsetWidth)return;this.left-=180}}}},d=c,v=(n(4418),n(0)),component=Object(v.a)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-voice-timbre"},[t("div",{staticClass:"select-voice-timbre-header"},[t("div",{ref:"selectVoiceTimbreType",staticClass:"select-voice-timbre-type",style:{left:e.left+"px"}},e._l(e.types,(function(n){return t("span",{key:n.value,staticClass:"select-voice-timbre-type-item",class:{active:e.type===n.value},attrs:{"data-id":n.value},on:{click:function(t){return e.handleTypeChange(n.value)}}},[e._v(e._s(e.$t(n.label)))])})),0),e._v(" "),t("div",{staticClass:"select-voice-timbre-type-controls"},[t("div",[t("div",{on:{click:function(t){return e.handleControls("left")}}},[t("i",{staticClass:"el-icon-arrow-left"})]),e._v(" "),t("div",{on:{click:function(t){return e.handleControls("right")}}},[t("i",{staticClass:"el-icon-arrow-right"})])])])]),e._v(" "),t("div",{staticClass:"select-voice-timbre-content"},e._l(e.voiceList,(function(n){return t("div",{key:n.id,staticClass:"select-voice-timbre-content-item",class:{active:e.value.id===n.id},attrs:{"data-id":n.id},on:{click:function(t){return e.handleTimbreChange(n,!1)}}},[t("div",{staticClass:"select-voice-timbre-content-item-icon"},[t("audio-player",{ref:"audioPlayer"+n.id,refInFor:!0,attrs:{item:n,playIconCustomStyle:{position:"unset"},customClass:"select-voice-timbre-content-item-icon-play",modelPlay:"",saveAudioFileOptions:{shouldSaveFile:e.voiceExtraParams.text&&e.voiceExtraParams.text.length>0,onFileGenerated:e.onFileGenerated},extraParams:e.voiceExtraParams.text&&e.voiceExtraParams.text.length>0?e.voiceExtraParams:{}},on:{clickPlay:function(t){return e.handleTimbreChange(n,!1)}}})],1),e._v(" "),t("div",{staticClass:"select-voice-timbre-content-item-title ellipsis"},[t("el-tooltip",{attrs:{content:n.title,placement:"top"}},[t("span",{staticClass:"ellipsis"},[e._v(e._s(n.title))])])],1),e._v(" "),e.recentVoiceId===n.id?t("div",{staticClass:"select-voice-timbre-content-item-used"},[e._v("\n        "+e._s(e.$t("recentlyUsed"))+"\n      ")]):e._e()])})),0)])}),[],!1,null,"31493f07",null);t.default=component.exports},3324:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(89),n(69),n(31),n(49),n(18),n(24),n(65),n(4),n(28),n(43),n(40),n(41);var o=n(821),l=n(3325),r=n(882);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return d(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function d(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}var v={name:"LipSyncUpload",mixins:[o.a],props:{value:{type:Object,default:function(){return{}}}},components:{AudioPlay:l.default,AudioClipDialog:r.default},data:function(){return{fileList:[],uploadedFiles:[],createForm:{audios:[]},acceptTypes:".mp3,.wav,.aac,.m4a,audio/mpeg,audio/wav,audio/aac,audio/m4a",uploadCategory:59}},watch:{"createForm.audios":{handler:function(e){var t=e.length>0?e[0]:{url:"",name:"",duration:0};this.value.audioParams.localAudio=Object.assign(this.value.audioParams.localAudio,t)},deep:!0},"value.audioParams.localAudio":{handler:function(e){this.handleConfirm({}),this.value.audioParams.localAudio.duration&&this.value.videoInfo.duration&&this.value.audioParams.localAudio.duration>this.value.videoInfo.duration&&this.handleEdit()},deep:!0}},mounted:function(){this.value.audioParams.localAudio.url&&this.createForm.audios.push(this.value.audioParams.localAudio)},methods:{handleBeforeUpload:function(e){e&&(/\.(mp3|wav|aac|m4a)$/i.test(e.name)?e.size/1024/1024<20?this.beforeUpload(e):this.$message.error(this.$t("Explanation_text2")):this.$message.error(this.$t("upload_audio_error1")))},getTotalDuration:function(e){return 0},handleDelete:function(audio){this.createForm.audios.splice(0,1),this.fileList.splice(0,1),this.uploadedFiles.splice(0,1),this.handleConfirm({})},handleEdit:function(){this.$refs.audioPlay&&this.$refs.audioPlay.stopPlay(),this.$refs.audioClipDialog&&this.$refs.audioClipDialog.show(this.value.audioParams.localAudio.url,Number(this.value.videoInfo.duration)>0?Number(this.value.videoInfo.duration).toFixed(1):0,this.value.audioParams.localAudio.name)},handleConfirm:function(e){var audio={url:e.url||"",name:e.name||"",duration:e.duration||0};this.value.audioParams.clipAudio=Object.assign(this.value.audioParams.clipAudio,audio)},handlePaste:function(e){if(!(this.createForm.audios.length>0)){var t,n=null,o=c((e.clipboardData||e.originalEvent.clipboardData).items);try{for(o.s();!(t=o.n()).done;){var l=t.value;if("file"===l.kind){var r=l.getAsFile();if(r&&/audio/i.test(r.type)){e.preventDefault(),n=r;break}}}}catch(e){o.e(e)}finally{o.f()}n?this.handleBeforeUpload(n):this.$message.warning(this.$t("upload_audio_error1"))}}}},m=(n(4423),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"lip-sync-upload",on:{paste:e.handlePaste}},[0===e.createForm.audios.length?t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.isCoverLoading2,expression:"isCoverLoading2"}],staticClass:"audio-upload",attrs:{action:"#",drag:"","before-upload":e.handleBeforeUpload,disabled:e.isCoverLoading2,accept:e.acceptTypes,"file-list":e.fileList,"show-file-list":!1}},[t("div",{staticClass:"audio-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[t("i",{staticClass:"iconfont icon-icon-Uploadlocaldubbing"}),e._v(" "),t("span",{staticClass:"tip1"},[e._v(e._s(e.$t("upload_audio")))]),e._v(" "),t("span",{staticClass:"tip2"},[e._v(e._s(e.$t("upload_audio_prompt1"))+"。"+e._s(e.$t("upload_audio_prompt2")))])])]):e._e(),e._v(" "),e.createForm.audios.length>0?t("div",{staticClass:"audio-upload no-background"},[e.value.audioParams.clipAudio.url?t("audio-play",{ref:"audioPlay",attrs:{audio:e.value.audioParams.clipAudio},on:{"update:audio":function(t){return e.$set(e.value.audioParams,"clipAudio",t)},edit:e.handleEdit,delete:e.handleDelete}}):t("audio-play",{ref:"audioPlay",attrs:{audio:e.value.audioParams.localAudio},on:{"update:audio":function(t){return e.$set(e.value.audioParams,"localAudio",t)},edit:e.handleEdit,delete:e.handleDelete}})],1):e._e(),e._v(" "),t("div",{staticClass:"audio-upload-tip"},[t("i",{staticClass:"iconfont icon-icon-information"}),e._v(" "),t("span",{staticClass:"tip2"},[e._v(e._s(e.$t("upload_audio_prompt3")))])]),e._v(" "),t("audio-clip-dialog",{ref:"audioClipDialog",on:{confirm:e.handleConfirm}})],1)}),[],!1,null,"f1fc40c2",null);t.default=component.exports},3325:function(e,t,n){"use strict";n.r(t);n(18),n(19);var o={name:"AudioPlay",props:{audio:{type:Object,required:!0}},data:function(){return{isPlaying:!1,duration:0,currentTime:0}},computed:{progressPercentage:function(){return this.duration>0?this.currentTime/this.duration*100:0},currentTimeFormatted:function(){return this.formatTime(this.currentTime)},durationFormatted:function(){return this.formatTime(this.duration)}},methods:{togglePlay:function(){this.$refs.audio&&(this.isPlaying?this.$refs.audio.pause():this.$refs.audio.play(),this.isPlaying=!this.isPlaying)},stopPlay:function(){this.$refs.audio&&this.$refs.audio.pause(),this.isPlaying=!1},updateProgress:function(){this.$refs.audio&&(this.currentTime=this.$refs.audio.currentTime)},onLoadedMetadata:function(){this.$refs.audio&&(this.duration=this.$refs.audio.duration,this.audio.duration=this.duration)},onEnded:function(){this.isPlaying=!1,this.currentTime=0,this.$refs.audio.currentTime=0},onError:function(e){console.log("onError",e)},setProgress:function(e){var t=this.$refs.progressBar.clientWidth,n=e.offsetX,o=this.duration;this.currentTime=n/t*o,this.$refs.audio&&(this.$refs.audio.currentTime=this.currentTime)},formatTime:function(time){var e=Math.floor(time/60),t=Math.floor(time%60);return"".concat(e,":").concat(t<10?"0"+t:t)},handleEdit:function(){this.$emit("edit",this.audio)},handleDelete:function(){this.$emit("delete",this.audio)}}},l=(n(4420),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"audio-player"},[t("div",{staticClass:"audio-container"},[t("div",{staticClass:"play-button",on:{click:e.togglePlay}},[e.isPlaying?t("i",{staticClass:"iconfont icon-icon-pulse"}):t("i",{staticClass:"iconfont icon-play"})]),e._v(" "),t("div",{staticClass:"audio-info-container"},[t("div",{staticClass:"audio-info"},[t("div",{staticClass:"audio-name ellipsis"},[e._v(e._s(e.audio.name))]),e._v(" "),t("div",{staticClass:"audio-controls"},[t("div",{staticClass:"edit-button",on:{click:e.handleEdit}},[t("i",{staticClass:"iconfont icon-icon-musiccut"})]),e._v(" "),t("div",{staticClass:"delete-button",on:{click:e.handleDelete}},[t("i",{staticClass:"iconfont icon-work-delete"})])])]),e._v(" "),t("div",{staticClass:"audio-time"},[t("span",[e._v(e._s(e.currentTimeFormatted))]),e._v(" "),t("span",{staticClass:"total-time"},[e._v(e._s(e.durationFormatted))])]),e._v(" "),t("div",{ref:"progressBar",staticClass:"audio-progress",on:{click:e.setProgress}},[t("div",{staticClass:"progress-bar",style:{width:e.progressPercentage+"%"}})])])]),e._v(" "),t("audio",{ref:"audio",attrs:{src:e.audio.url},on:{timeupdate:e.updateProgress,loadedmetadata:e.onLoadedMetadata,error:e.onError,ended:e.onEnded}})])}),[],!1,null,"4a2b602d",null);t.default=component.exports},3326:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(8),n(7);var o=n(2),l=(n(19),n(6),n(32),n(4),n(92),n(26),n(1)),r=n(604),c=n(97),d=n(884),v=n(3327),m=n(3328),h=n(46),f=n(175),_=n(9);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={name:"aiMusic",inject:["easyTop"],components:{AudioTabs:r.default,CommonInput:d.default,BaseSlideTab:v.default,commonConfirmModal:c.default,CommonModel:m.default},props:["value","menuIndex"],data:function(){return{loading:!1,costTimer:null,sale:0,cost:0,randomLyricLoading:!1,randomStyleLoading:!1,tabs:[{label:"song_mode1",id:"vocalSongs"},{label:"song_mode2",id:"instrumentalSongs"}],styleTab:"style",lyricTitle:""}},mounted:function(){},watch:{"value.generateMode":{handler:function(e){this.getEstimatedCost()},immediate:!0},value:{handler:function(e){""===e.prompt&&(this.value.prompt=this.$t("songstyle_category1_label1"))},immediate:!0}},computed:C(C(C({},Object(l.c)("user",["isLoggedIn"])),Object(l.c)("aiAudio",["audioStyleList","audioRandomStyleList"])),{},{renderStyleList:function(){var e=this;return this.audioStyleList.filter((function(t){return"vocalSongs"===e.value.generateMode||"voice"!==t.id}))},randomStyleList:function(){var e=this;return this.audioRandomStyleList.filter((function(t){return t.type===e.value.generateMode}))},styleTabContent:function(){var e,t=this;return null===(e=this.renderStyleList.find((function(e){return e.id===t.styleTab})))||void 0===e?void 0:e.children},disabledButtonTips:function(){return"vocalSongs"!==this.value.generateMode||this.value.lyrics?this.value.prompt?"":this.$t("song_warn3"):this.$t("song_warn2")},createBtnDisabled:function(){var e,t,n,o="instrumentalSongs"===(null===(e=this.value)||void 0===e?void 0:e.generateMode)||""!==(null===(t=this.value)||void 0===t||null===(t=t.lyrics)||void 0===t?void 0:t.trim()),l=""!==(null===(n=this.value)||void 0===n||null===(n=n.prompt)||void 0===n?void 0:n.trim());return!o||!l}}),methods:{handleOpenModelRecipe:function(e){this.$emit("openModelRecipe",e)},handleModelChange:function(e){var t;this.value.modelInfo=e,null===(t=this.easyTop)||void 0===t||t.closeInspirationWin(!0)},handleRandomLyric:function(){var e=this;this.randomLyricLoading=!0;var t=this.value.lyrics;t||(t=this.value.prompt||this.$t(this.getRandomStyle())),Object(h.easyRandomLyric)({prompt:t,ss:_.e.GenerateCreate}).then((function(t){1e4===t.status.code&&(e.value.lyrics=t.data.lyrics,e.lyricTitle=t.data.title)})).catch((function(t){switch(t.code){case 10612:e.$message.error(e.$t("song_warn5"));break;case 10627:e.$message.error(e.$t("audio_Inpu_detection1",{X:e.$t("song_lyric")}))}})).finally((function(){e.randomLyricLoading=!1}))},handleRandomStyle:function(){this.randomStyleLoading=!0,this.value.prompt=this.$t(this.getRandomStyle()),this.randomStyleLoading=!1},getRandomStyle:function(){return this.randomStyleList[Math.floor(Math.random()*this.randomStyleList.length)].label},handleParams:function(){var e={};return"vocalSongs"===this.value.generateMode&&(e={lyrics:this.value.lyrics,title:this.lyricTitle}),{meta:{prompt:this.value.prompt||"",generate_audio:e}}},handleClick:function(){var e,t=this;if(this.isLoggedIn){null==this||null===(e=this.easyTop)||void 0===e||e.closeInspirationWin(!0),this.loading=!0;var n=this.handleParams();n.ss=_.e.GenerateCreate,Object(h.easyTextToMusic)(n).then((function(e){var n;null!=e&&null!==(n=e.data)&&void 0!==n&&n.id&&(t.$message.success(t.$t("CreateSuccess")),null==t||t.easyTop.updateTask(C(C({},null==e?void 0:e.data),{},{status:1,task_domain_type:21})))})).catch((function(e){switch(e.code){case 10612:t.$message.error(t.$t("song_warn5"));break;case 10625:t.$message.error(t.$t("audio_Inpu_detection1",{X:t.$t("songstyle")}));break;case 10627:t.$message.error(t.$t("audio_Inpu_detection1",{X:t.$t("song_lyric")}))}})).finally((function(){t.loading=!1}))}else this.$EventBus.$emit("openLoginDialog")},handleClearLyrics:function(){var e=this;this.value.lyrics&&this.$refs.commonConfirmModal.show({subTitle:"song_warn1"}).then((function(){e.value.lyrics=""})).catch((function(){}))},handleStyleChange:function(e){var t=this.value.prompt.length;this.value.prompt+="".concat(t>0?",":"").concat(this.$t(e.label))},getEstimatedCost:function(){var e=this,t={action:30,sub_type:"vocalSongs"===this.value.generateMode?55:56,meta:{}};this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null),this.costTimer=setTimeout((function(){Object(f.b)(C({},t)).then((function(t){var n=(null==t?void 0:t.data)||{},o=n.calculate_coins,l=n.discount_off_rate;e.cost=o,e.sale=l})).catch((function(t){e.cost=0,e.sale=0}))}),1e3)}}},k=(n(4431),n(0)),component=Object(k.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ai-music",attrs:{"data-group":"text-music-params"}},[t("div",{staticClass:"ai-music-content"},[t("div",{staticClass:"ai-music-content-item"},[t("CommonModel",{on:{openModelRecipe:e.handleOpenModelRecipe}}),e._v(" "),t("div",{staticClass:"params-item"},[t("div",{staticClass:"params-item-title"},[e._v("\n          "+e._s(e.$t("newGenerate5"))+"\n        ")]),e._v(" "),t("div",{staticClass:"params-item-content"},[t("audio-tabs",{attrs:{value:e.value.generateMode,activeType:"button",tabs:e.tabs},on:{"update:value":function(t){return e.$set(e.value,"generateMode",t)},change:function(t){e.styleTab="style"}}})],1)]),e._v(" "),"vocalSongs"===e.value.generateMode?t("CommonInput",{directives:[{name:"loading",rawName:"v-loading",value:e.randomLyricLoading,expression:"randomLyricLoading"}],attrs:{title:"song_lyric",value:e.value.lyrics,placeholder:e.$t("song_lyric_prompt1"),tooltipContent:"song_lyric_prompt2",maxLength:3e3,autosize:{minRows:4,maxRows:8},clearable:""},on:{"update:value":function(t){return e.$set(e.value,"lyrics",t)},clear:e.handleClearLyrics,change:function(t){e.lyricTitle=""}},scopedSlots:e._u([{key:"handleBtn",fn:function(){return[t("div",{staticClass:"song-random-title random-style",attrs:{"data-id":"song_lyric_auto","data-event":"aisong_random"},on:{click:e.handleRandomLyric}},[t("i",{staticClass:"iconfont icon-mofabang2"}),e._v(" "),t("span",{staticClass:"song-random-title-text"},[e._v(e._s(e.$t("song_lyric_auto")))])])]},proxy:!0}],null,!1,2673361393)}):e._e(),e._v(" "),t("CommonInput",{attrs:{title:"songstyle",value:e.value.prompt,placeholder:"vocalSongs"===e.value.generateMode?e.$t("songstyle_prompt1"):e.$t("songstyle_prompt2"),maxLength:300,clearable:"",showBottomBorder:""},on:{"update:value":function(t){return e.$set(e.value,"prompt",t)},clear:function(t){e.value.prompt=""}},scopedSlots:e._u([{key:"handleBtn",fn:function(){return[t("div",{class:["song-random-title",{"random-loading":e.randomStyleLoading}],attrs:{"data-id":"song_style_auto","data-evnet":"aisong_random"},on:{click:e.handleRandomStyle}},[t("i",{staticClass:"iconfont icon-suijishushengcheng"}),e._v(" "),t("span",{staticClass:"song-random-title-text"},[e._v(e._s(e.$t("songstyle_auto")))])])]},proxy:!0},{key:"bottom",fn:function(){return[t("BaseSlideTab",{attrs:{tabs:e.renderStyleList,"data-event":"ai_music_style",step:120,currentTab:e.styleTab,tabContent:e.styleTabContent},on:{"update:currentTab":function(t){e.styleTab=t},"update:current-tab":function(t){e.styleTab=t},contentChange:e.handleStyleChange}})]},proxy:!0}])})],1)]),e._v(" "),t("el-tooltip",{attrs:{content:e.disabledButtonTips,disabled:!e.createBtnDisabled,placement:"top"}},[t("el-button",{class:{"no-sale":!e.sale,disabled:e.createBtnDisabled},attrs:{type:"primary","data-sale":"".concat(e.sale,"% Off"),disabled:e.createBtnDisabled,loading:e.loading,"data-id":"text-music-generate","data-event":"ai_music_generate"},on:{click:function(t){return t.preventDefault(),e.handleClick.apply(null,arguments)}}},[e._v(e._s(e.$t("Generate"))+"("+e._s(e.$t("expend"))+": "+e._s(e.cost)+")")])],1),e._v(" "),t("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"236221e9",null);t.default=component.exports},3327:function(e,t,n){"use strict";n.r(t);n(24);var o={name:"BaseSlideTab",components:{SwipeableList:n(52).default},props:{tabs:{type:Array,default:function(){return[]}},currentTab:{type:String,default:""},tabContent:{type:Array,default:function(){return[]}},currentContentId:{type:String,default:""},step:{type:Number,default:180},dataEvent:{type:String,default:""}},data:function(){return{left:0}},methods:{handleControls:function(e){if("left"===e){if(this.left>=0)return void(this.left=0);this.left+=this.step}else{if(this.$refs.baseSlideTabType.offsetWidth-Math.abs(this.left)<=this.step)return;this.left-=this.step}},handleTabChange:function(e){this.$emit("update:currentTab",e),this.$emit("tabChange",e)},handleContentChange:function(e){this.$emit("update:currentContentId",e.id),this.$emit("contentChange",e)}}},l=(n(4428),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"base-slide-tab"},[t("div",{staticClass:"base-slide-tab-header"},[t("div",{ref:"baseSlideTabType",staticClass:"base-slide-tab-type",style:{left:e.left+"px"}},[t("SwipeableList",{attrs:{top:"0px",iconBntWidth:26}},e._l(e.tabs,(function(n){return t("span",{key:n.id,staticClass:"base-slide-tab-type-item",class:{active:e.currentTab===n.id},attrs:{"data-id":n.id,"data-event":e.dataEvent},on:{click:function(t){return e.handleTabChange(n.id)}}},[e._v(e._s(e.$t(n.label)))])})),0)],1)]),e._v(" "),t("div",{staticClass:"base-slide-tab-content"},e._l(e.tabContent,(function(n){return t("div",{key:n.id,staticClass:"base-slide-tab-content-item"},[e._t("content",(function(){return[t("div",{class:["base-slide-tab-content-item-content",{active:e.currentContentId===n.id}],attrs:{"data-id":n.id,"data-event":e.dataEvent+"_content"},on:{click:function(t){return e.handleContentChange(n)}}},[e._v("\n          "+e._s(e.$t(n.label))+"\n        ")])]}),{item:n})],2)})),0)])}),[],!1,null,"291a9e06",null);t.default=component.exports;installComponents(component,{SwipeableList:n(52).default})},3328:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(18);var o={name:"CommonModel",props:{modelList:{type:Array,default:function(){return[]}},modelInfo:{type:Object,default:function(){}}},data:function(){return{popoverVisible:!1,isFirstClickMusicInspiration:!0}},computed:{},methods:{handleModelClick:function(e){this.$refs.modelPopover&&this.$refs.modelPopover.doClose(),this.$emit("modelChange",e)},handleOpenMusicInspirationLibrary:function(){this.isFirstClickMusicInspiration&&(this.isFirstClickMusicInspiration=!1),this.$emit("openModelRecipe","music")}}},l=(n(4429),n(4430),n(0)),component=Object(l.a)(o,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"common-model",attrs:{"data-group":"audio-model-params"}},[t._m(0),t._v(" "),n("div",{staticClass:"model-panel-card"},[t.modelList.length>0?n("el-popover",{ref:"modelPopover",attrs:{"popper-class":"audio-model-popover",placement:"bottom","visible-arrow":!1,width:"100%"},model:{value:t.popoverVisible,callback:function(e){t.popoverVisible=e},expression:"popoverVisible"}},[n("div",{staticClass:"model-panel-card-list"},t._l(t.modelList,(function(e){var o;return n("div",{key:e.id,staticClass:"model-panel-card-list-item",class:{active:(null===(o=t.modelInfo)||void 0===o?void 0:o.id)===e.id},attrs:{"data-id":e.id,"data-event":"model-select"},on:{click:function(n){return t.handleModelClick(e)}}},[n("div",{staticClass:"model-panel-card-list-item-left"},[n("img",{attrs:{src:e.cover,alt:"model-img"}})]),t._v(" "),n("div",{staticClass:"model-panel-card-list-item-right"},[n("span",{staticClass:"model-panel-card-list-item-right-name ellipsis"},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"model-panel-card-list-item-right-description line-two"},[t._v(t._s(null==e?void 0:e.description))])]),t._v(" "),n("div",{staticClass:"model-panel-card-list-item-tag"},[n("span",{staticClass:"model-panel-card-list-item-tag-text"},[t._v(t._s((null==e?void 0:e.status)||"Hot"))])])])})),0),t._v(" "),n("div",{staticClass:"model-panel-card-info",attrs:{slot:"reference"},slot:"reference"},[n("div",{staticClass:"model-panel-card-info-left"},[n("span",{staticClass:"model-panel-card-info-left-text-tag"},[t._v(t._s(t.$t("Versions")))]),t._v(" "),n("span",{staticClass:"model-panel-card-info-left-text-text ellipsis"},[t._v(t._s(null===(e=t.modelInfo)||void 0===e?void 0:e.name))])]),t._v(" "),n("div",{staticClass:"model-panel-card-info-right"},[n("i",{class:t.popoverVisible?"el-icon-caret-bottom":"el-icon-caret-right"})])])]):t._e(),t._v(" "),n("div",{staticClass:"model-panel-card-bottom",attrs:{"data-type":"aiMusic","data-event":"music-model-inspiration-btn"},on:{click:function(e){return e.stopPropagation(),t.handleOpenMusicInspirationLibrary.apply(null,arguments)}}},[n("div",{staticClass:"model-panel-card-bottom-text"},[t._v("\n        "+t._s(t.$t("model_recipe"))+"\n        "),t.isFirstClickMusicInspiration?n("span",{staticClass:"tips-icon-new"},[t._v("NEW")]):t._e()])])],1)])}),[function(){var e=this._self._c;return e("div",{staticClass:"background-media"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/web/music_model_bg.png",alt:"ai-audio-bg-img"}})])}],!1,null,"488dc376",null);t.default=component.exports},3329:function(e,t,n){"use strict";n.r(t);n(18),n(6),n(12),n(13),n(8),n(7);var o=n(3),l=n(2),r=(n(20),n(11),n(72),n(16),n(4),n(26),n(1)),c=n(25),d=n(175),v=n(292),m=n(29),h=n(46),f=n(885),_=n(880),y=n(883),C=n(884),w=n(881),k=n(3330),I=n(9);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={name:"aiVoice",props:["value","menuIndex"],inject:["easyTop"],components:{SwitchToInput:f.default,SelectVideo:_.default,VipPrivateCreate:y.default,CommonInput:C.default,SampleVideo:w.default,AudioWaveform:k.default},data:function(){return{loading:!1,cost:0,costTimer:null,sale:0,detailInfo:{},initLoading:!1,throttledClick:function(){},isCollapse:!1,checkLoading:!1,reversePromptShow:!1,reversePrompt:""}},created:function(){this.throttledClick=Object(c.throttle)(this.getEstimatedCost,1e3),this.throttledClick()},beforeDestroy:function(){this.throttledClick=null,this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null)},computed:T(T(T({},Object(r.c)("creation",["audio_config"])),Object(r.c)("user",["isLoggedIn"])),{},{sampleAudioList:function(){var e;return(null===(e=this.audio_config)||void 0===e?void 0:e.effect_demo)||[]},createBtnDisabled:function(){return!this.value.paramsForm.prompt},disabledButtonTips:function(){return this.$t("SE_warn")}}),watch:{"value.paramsForm":{handler:function(){this.throttledClick&&this.throttledClick()},deep:!0,immediate:!0},"value.videoInfo":{handler:function(){var e,t,n;null!==(e=this.value.videoInfo)&&void 0!==e&&e.id?(this.getMetaInfo(null===(t=this.value.videoInfo)||void 0===t?void 0:t.isTask),null!==(n=this.value.videoInfo)&&void 0!==n&&n.needCheckVideo&&this.handleVideoChange(this.value.videoInfo,!0)):this.detailInfo={};this.throttledClick&&this.throttledClick()},deep:!0,immediate:!0},detailInfo:{handler:function(){this.throttledClick&&this.throttledClick()},deep:!0}},methods:{handleAudioEnter:function(e,t){this.$refs["audioWaveform"+t]&&this.$refs["audioWaveform"+t].play()},handleAudioLeave:function(e,t){this.$refs["audioWaveform"+t]&&this.$refs["audioWaveform"+t].pause()},reversePromptHandle:function(e){e&&(this.value.paramsForm.prompt=this.reversePrompt),this.reversePrompt="",this.reversePromptShow=!1},getEstimatedCost:function(){var e,t=this,n=this.handleParams();n.sub_type=48,null!==(e=this.value.videoInfo)&&void 0!==e&&e.url||(n={task_domain_type:23,sub_type:57,meta:{}}),this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null),this.costTimer=setTimeout((function(){Object(d.b)(T({},n)).then((function(e){var n=(null==e?void 0:e.data)||{},o=n.calculate_coins,l=n.discount_off_rate;t.cost=o,t.sale=l})).catch((function(e){t.cost=0,t.sale=0}))}),1e3)},handleAudioEnded:function(e){this.$xyLogEvent({front_operation:"click",entity_name:"ai_voice_sample_audio",entity_type:"ai_voice_sample_audio",event_name:"log_action_front",obj_id:(null==e?void 0:e.id)||"",obj_info:{is_over:1}})},handleParams:function(){var e,t,n,o,l,r,c,d,v=(null===(e=this.detailInfo)||void 0===e?void 0:e.id)||"",m={model_no:null===(t=this.detailInfo)||void 0===t||null===(t=t.art_model)||void 0===t?void 0:t.id,model_ver_no:null===(n=this.detailInfo)||void 0===n||null===(n=n.art_model)||void 0===n?void 0:n.model_ver_no,meta:{prompt:this.value.paramsForm.prompt,generate_audio:{origin_task_id:v,video_opts:[{uri:(null===(o=this.value.videoInfo)||void 0===o?void 0:o.url)||""}]}}};null!==(l=this.value.videoInfo)&&void 0!==l&&l.isTask?null!==(r=this.detailInfo)&&void 0!==r&&null!==(r=r.meta)&&void 0!==r&&null!==(r=r.generate_audio)&&void 0!==r&&r.origin_task_id&&(m.meta.generate_audio.origin_task_id=null===(c=this.detailInfo)||void 0===c||null===(c=c.meta)||void 0===c||null===(c=c.generate_audio)||void 0===c?void 0:c.origin_task_id):m.meta.generate_audio.origin_task_id=(null===(d=this.detailInfo)||void 0===d||null===(d=d.task)||void 0===d?void 0:d.task_id)||"";return this.value.paramsForm.enableNegativePrompts&&(m.meta.negative_prompt=this.value.paramsForm.negative_prompt),m},handleTextToAudioParams:function(){var e,t,n;return{meta:{prompt:(null===(e=this.value)||void 0===e||null===(e=e.paramsForm)||void 0===e?void 0:e.prompt)||"",negative_prompt:(null===(t=this.value)||void 0===t||null===(t=t.paramsForm)||void 0===t?void 0:t.negative_prompt)||"",generate_audio:{audio_duration:(null===(n=this.value)||void 0===n||null===(n=n.paramsForm)||void 0===n?void 0:n.duration)||5}}}},getMetaInfo:function(){var e,t,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l={task_flow_version:"v2"};return o?l.id=null===(e=this.value.videoInfo)||void 0===e?void 0:e.id:l.art_work_no=null===(t=this.value.videoInfo)||void 0===t?void 0:t.id,this.initLoading=!0,(o?m.getMetaInfo:m.getTaskConfig)(l).then((function(e){var t;[1e4,"10000"].includes(null==e||null===(t=e.status)||void 0===t?void 0:t.code)&&(n.detailInfo=(null==e?void 0:e.data)||{})})).finally((function(){n.initLoading=!1}))},addMusic:function(e){var t,n=this;if(this.isLoggedIn){this.$logEvent("log_actions",{operation:"click_generate",behavior_info:"on_createflow_page",behavior_info_sub:"ai_audio"}),this.loading=!0;var o=!(null!==(t=this.value)&&void 0!==t&&null!==(t=t.videoInfo)&&void 0!==t&&t.url),l=o?this.handleTextToAudioParams():this.handleParams();l.ss=I.e.GenerateCreate,(o?h.easyTextToAudio:v.f)(l).then((function(e){var t;null!=e&&null!==(t=e.data)&&void 0!==t&&t.id&&(n.$message.success(n.$t("CreateSuccess")),null==n||n.easyTop.updateTask(T(T({},null==e?void 0:e.data),{},{status:1,task_domain_type:o?23:17})))})).finally((function(){n.loading=!1}))}else this.$EventBus.$emit("openLoginDialog")},handleVideoChange:function(e){var t=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(r=t.length>1&&void 0!==t[1]&&t[1])&&(n.value.videoInfo.needCheckVideo=!1),n.checkLoading=!0,c="",o.prev=4,o.next=7,n.checkVideo(e);case 7:c=o.sent,o.next=13;break;case 10:o.prev=10,o.t0=o.catch(4),console.error("checkVideo error",o.t0);case 13:if(n.checkLoading=!1,c&&(n.reversePrompt=c,n.value.paramsForm.prompt?n.reversePromptShow=!0:n.value.paramsForm.prompt=n.reversePrompt),!r){o.next=17;break}return o.abrupt("return");case 17:n.value.videoInfo={id:(null==e?void 0:e.id)||"",isTask:!1,origin_task_id:"",url:(null==e?void 0:e.url)||"",coverUrl:(null==e||null===(l=e.info)||void 0===l||null===(l=l.cover)||void 0===l?void 0:l.url)||""};case 18:case"end":return o.stop()}}),o,null,[[4,10]])})))()},checkVideo:function(video){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=video.url){t.next=3;break}return t.abrupt("return");case 3:return t.abrupt("return",new Promise((function(t,o){Object(h.easyVideoFrameDescription)({uri:n}).then((function(n){var l;1e4===(null==n||null===(l=n.status)||void 0===l?void 0:l.code)?t(n.data.description):o(n.status.msg||e.$t("comicPage17"))})).catch((function(e){o(e)}))})));case 4:case"end":return t.stop()}}),t)})))()},handleAudioChange:function(e){this.value.paramsForm.prompt=e.content},svgIconUrl:function(e){return"https://image.cdn2.seaart.me/static/web/audio-bg".concat(e,".svg")}}},O=S,P=(n(4434),n(4435),n(0)),component=Object(P.a)(O,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"ai-voice",attrs:{"data-group":"video-audio-params"}},[o("div",{staticClass:"ai-voice-params"},[o("div",{staticClass:"ai-voice-content"},[o("CommonInput",{attrs:{title:"SE_prompt",value:n.value.paramsForm.prompt,placeholder:n.$t("SE_sample_prompt"),maxLength:3e3,autosize:{minRows:4,maxRows:4},showBottomBorder:""},on:{"update:value":function(e){return n.$set(n.value.paramsForm,"prompt",e)}},scopedSlots:n._u([{key:"bottom",fn:function(){return[n.reversePromptShow?o("div",{staticClass:"reverse-prompt-tips"},[o("span",{staticClass:"reverse-prompt-tips-title"},[o("i",{staticClass:"el-icon-warning"}),n._v(n._s(n.$t("SE_confirm")))]),n._v(" "),o("div",{staticClass:"reverse-prompt-tips-content"},[n._v(n._s(n.reversePrompt))]),n._v(" "),o("div",{staticClass:"reverse-prompt-tips-btn"},[o("el-button",{staticClass:"reverse-prompt-tips-btn-cancel",attrs:{type:"text"},on:{click:function(e){return n.reversePromptHandle(!1)}}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("el-button",{staticClass:"reverse-prompt-tips-btn-confirm",attrs:{type:"text"},on:{click:function(e){return n.reversePromptHandle(!0)}}},[n._v(n._s(n.$t("Confirm")))])],1)]):n._e(),n._v(" "),o("SampleVideo",{attrs:{value:n.sampleAudioList,title:"SE_sample_voice",limit:3,"data-event":"ai_voice_sample_audio"},on:{"update:value":function(e){n.sampleAudioList=e},change:n.handleAudioChange},scopedSlots:n._u([{key:"contentItem",fn:function(e){var t=e.item,l=e.index;return[o("el-tooltip",{attrs:{"popper-class":"sample-audio-item",placement:"bottom",width:"100",enterable:!1}},[o("div",{staticClass:"sample-audio-item-content",attrs:{slot:"content"},slot:"content"},[o("AudioWaveform",{ref:"audioWaveform"+l,attrs:{icon:n.svgIconUrl(l),url:t.url,name:t.name},on:{ended:function(e){return n.handleAudioEnded(t)}}})],1),n._v(" "),o("div",{class:["sample-audio-item-info","sample-audio-item-info-"+l],attrs:{"data-id":t.id},on:{mouseenter:function(e){return n.handleAudioEnter(t,l)},mouseleave:function(e){return n.handleAudioLeave(t,l)}}},[o("img",{staticClass:"audio-bg",attrs:{src:n.svgIconUrl(l),alt:""}}),n._v(" "),o("div",{staticClass:"sample-audio-item-info-name"},[n._v(n._s(t.name))])])])]}}])})]},proxy:!0}])}),n._v(" "),o("div",{staticClass:"params-settings"},[o("select-video",{attrs:{title:"SE_load_video",tips:"SE_load_video_text",checkLoading:n.checkLoading,checkLoadingText:n.$t("audio_clip_load"),value:n.value.videoInfo},on:{"update:value":function(e){return n.$set(n.value,"videoInfo",e)},change:n.handleVideoChange}}),n._v(" "),null!==(e=n.value.videoInfo)&&void 0!==e&&e.url?o("vip-private-create"):n._e()],1),n._v(" "),o("div",{staticClass:"params-settings advanced-settings"},[o("div",{staticClass:"additional-panel-title",class:{"additional-panel-title-active":n.isCollapse},on:{click:function(e){e.stopPropagation(),n.isCollapse=!n.isCollapse}}},[o("span",{staticClass:"additional-panel-title-text"},[n._v(n._s(n.$t("AdvancedConfig")))]),n._v(" "),o("span",{staticClass:"additional-panel-title-icon",class:[n.isCollapse?"el-icon-caret-bottom":"el-icon-caret-top"]})]),n._v(" "),n.isCollapse?[null!==(t=n.value.videoInfo)&&void 0!==t&&t.url?n._e():o("div",{staticClass:"params-settings-item"},[o("div",{staticClass:"params-settings-item-label"},[n._v(n._s(n.$t("SE_time")))]),n._v(" "),o("div",{staticClass:"params-settings-item-content"},[o("el-slider",{staticClass:"speed-slider-item",attrs:{min:3,max:10,step:1,"show-tooltip":!1},model:{value:n.value.paramsForm.duration,callback:function(e){n.$set(n.value.paramsForm,"duration",e)},expression:"value.paramsForm.duration"}}),n._v(" "),o("span",[n._v(n._s(n.value.paramsForm.duration)+"s")])],1)]),n._v(" "),o("switch-to-input",{attrs:{switchKey:"enableNegativePrompts",inputKey:"negative_prompt",label:"NegativePrompts",tips:"newGenerate128"},model:{value:n.value.paramsForm,callback:function(e){n.$set(n.value,"paramsForm",e)},expression:"value.paramsForm"}})]:n._e()],2)],1)]),n._v(" "),o("el-tooltip",{attrs:{content:n.disabledButtonTips,disabled:!n.createBtnDisabled,placement:"top"}},[o("el-button",{staticClass:"generate-btn",class:{"no-sale":!n.sale,disabled:n.createBtnDisabled},attrs:{type:"primary","data-sale":"".concat(n.sale,"% Off"),disabled:n.createBtnDisabled,loading:n.loading,"data-id":"video-audio-generate"},on:{click:n.addMusic}},[n._v(n._s(n.$t("Generate"))+"("+n._s(n.$t("expend"))+": "+n._s(n.cost)+")")])],1)],1)}),[],!1,null,"76431493",null);t.default=component.exports},3330:function(e,t,n){"use strict";n.r(t);n(18);var o=n(3),l=n(14),r=(n(20),n(19),n(199),n(4),n(43),n(77),n(7),n(26),{name:"AudioWaveform",props:{url:{type:String,required:!0,default:""},name:{type:String,required:!0,default:""},icon:{type:String,default:""},loop:{type:Boolean,default:!0}},data:function(){return{currentTime:0,duration:0,waveformBars:[],progressPercentage:0,audioContext:null,audioBuffer:null,isPlaying:!1,canvasWidth:250,canvasHeight:60,canvas:null,ctx:null,devicePixelRatio:1,barWidth:2,barGap:1,barCount:80,targetProgressPercentage:0,animatedProgressPercentage:0,lastRenderTime:0,animationId:null,resizeObserver:null}},mounted:function(){var e=this;this.$nextTick((function(){e.initializeCanvas(),e.initializeAudioContext(),setTimeout((function(){e.setupInitialRender()}),100)}))},beforeDestroy:function(){this.cleanup()},methods:{initializeCanvas:function(){return!!this.$refs.waveformCanvas&&(this.canvas=this.$refs.waveformCanvas,this.ctx=this.canvas.getContext("2d"),!!this.ctx&&(this.devicePixelRatio=window.devicePixelRatio||1,!0))},setupCanvasOptimization:function(){if(!this.canvas||!this.ctx)return!1;var e=this.$refs.waveformContainer;if(!e)return!1;var rect=e.getBoundingClientRect();return this.canvasWidth=rect.width>0?rect.width:218,this.canvasHeight=60,this.canvas.width=this.canvasWidth*this.devicePixelRatio,this.canvas.height=this.canvasHeight*this.devicePixelRatio,this.canvas.style.width=this.canvasWidth+"px",this.canvas.style.height=this.canvasHeight+"px",this.ctx.scale(this.devicePixelRatio,this.devicePixelRatio),this.barCount=Math.floor(this.canvasWidth/(this.barWidth+this.barGap)),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",!0},setupInitialRender:function(){this.setupCanvasOptimization()&&(this.generateInitialWaveform(),this.setupResizeObserver(),this.renderWaveform())},generateInitialWaveform:function(){this.waveformBars=[];for(var i=0;i<this.barCount;i++){var e=40*Math.random()+10;this.waveformBars.push({height:e,volume:e/100})}},updateCanvasSize:function(){this.setupCanvasOptimization()&&(this.waveformBars.length!==this.barCount&&(0===this.waveformBars.length?this.generateInitialWaveform():this.adjustWaveformData()),this.renderWaveform())},adjustWaveformData:function(){if(0!==this.waveformBars.length){for(var e=Object(l.a)(this.waveformBars),t=[],i=0;i<this.barCount;i++){var n=Math.floor(i/this.barCount*e.length);t.push(e[n]||{height:20,volume:.2})}this.waveformBars=t}},setupResizeObserver:function(){var e=this;window.ResizeObserver&&!this.resizeObserver&&(this.resizeObserver=new ResizeObserver((function(){e.updateCanvasSize()})),this.resizeObserver.observe(this.$refs.waveformContainer))},requestRender:function(){var e=this;this.animationId||(this.animationId=requestAnimationFrame((function(){e.updateAnimation(),e.renderWaveform(),e.animationId=null,e.isPlaying&&Math.abs(e.targetProgressPercentage-e.animatedProgressPercentage)>.1&&e.requestRender()})))},updateAnimation:function(){var e=this.targetProgressPercentage-this.animatedProgressPercentage;Math.abs(e)>.01?this.animatedProgressPercentage+=.15*e:this.animatedProgressPercentage=this.targetProgressPercentage},initializeAudioContext:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.error("Failed to initialize audio context:",e)}case 1:case"end":return t.stop()}}),t)})))()},generateWaveformFromAudio:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,i,c,d,v,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.url&&e.audioContext){t.next=3;break}return e.generateFallbackWaveform(),t.abrupt("return");case 3:return t.prev=3,t.next=6,fetch(e.url,{mode:"cors",credentials:"omit"});case 6:if((n=t.sent).ok){t.next=9;break}throw new Error("HTTP error! status: ".concat(n.status));case 9:return t.next=11,n.arrayBuffer();case 11:return o=t.sent,t.next=14,e.audioContext.decodeAudioData(o);case 14:for(e.audioBuffer=t.sent,l=e.audioBuffer.getChannelData(0),r=Math.floor(l.length/e.barCount),e.waveformBars=[],i=0;i<e.barCount;i++){for(d=(c=i*r)+r,v=0,m=c;m<d&&m<l.length;m++)v=Math.max(v,Math.abs(l[m]));(h=100*v)<2?h=0:(h=Math.max(h,5),h=Math.min(h,90)),e.waveformBars.push({height:h,volume:v})}t.next=24;break;case 21:t.prev=21,t.t0=t.catch(3),e.generateFallbackWaveform();case 24:case"end":return t.stop()}}),t,null,[[3,21]])})))()},generateFallbackWaveform:function(){this.waveformBars=[];for(var i=0;i<this.barCount;i++){var e=void 0;e=Math.random()<.2?0:70*Math.random()+10,this.waveformBars.push({height:e,volume:e/100})}},renderWaveform:function(){var e=this;if(this.ctx&&this.canvas){var t=this.canvasWidth,n=this.canvasHeight;if(0!==t&&0!==n)if(this.ctx.clearRect(0,0,t,n),0!==this.waveformBars.length){var o=this.waveformBars.length,l=Math.max(1,(t-(o-1)*this.barGap)/o),r=Math.floor(this.animatedProgressPercentage/100*o);this.waveformBars.forEach((function(t,c){var d,v=c*(l+e.barGap),m=t.height;if(0!==m){if(c<r)d="#A55BD3";else if(c===r){var progress=e.animatedProgressPercentage/100*o%1;d="rgba(148, 84, 190, ".concat(.5+.5*progress,")")}else d="#555555";var h=Math.max(1,m/100*n),f=n-h;e.ctx.fillStyle=d,e.drawRoundedRect(v,f,l,h,1)}}))}else this.drawPlaceholder(t,n)}},drawRoundedRect:function(e,t,n,o,l){if(!(n<=0||o<=0)){var r=Math.min(l,n/2,o/2);try{this.ctx.beginPath(),this.ctx.moveTo(e+r,t),this.ctx.lineTo(e+n-r,t),this.ctx.quadraticCurveTo(e+n,t,e+n,t+r),this.ctx.lineTo(e+n,t+o-r),this.ctx.quadraticCurveTo(e+n,t+o,e+n-r,t+o),this.ctx.lineTo(e+r,t+o),this.ctx.quadraticCurveTo(e,t+o,e,t+o-r),this.ctx.lineTo(e,t+r),this.ctx.quadraticCurveTo(e,t,e+r,t),this.ctx.closePath(),this.ctx.fill()}catch(l){this.ctx.fillRect(e,t,n,o)}}},drawPlaceholder:function(e,t){try{this.ctx.fillStyle="#555555",this.ctx.font="14px Arial",this.ctx.textAlign="center",this.ctx.fillText("Loading waveform...",e/2,t/2),this.ctx.textAlign="start"}catch(e){console.error("绘制占位内容失败:",e)}},onAudioLoaded:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.duration=e.$refs.audioElement.duration,t.next=3,e.generateWaveformFromAudio();case 3:e.updateCanvasSize();case 4:case"end":return t.stop()}}),t)})))()},onAudioError:function(e){this.$emit("audio-error",e),this.generateFallbackWaveform(),this.renderWaveform()},play:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.audioContext||"suspended"!==e.audioContext.state){t.next=4;break}return t.next=4,e.audioContext.resume();case 4:return e.$refs.audioElement.currentTime=0,e.currentTime=0,e.targetProgressPercentage=0,e.animatedProgressPercentage=0,t.next=10,e.$refs.audioElement.play();case 10:e.isPlaying=!0,e.$emit("play"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e.$emit("play-error",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))()},pause:function(){try{this.$refs.audioElement.pause(),this.isPlaying=!1,this.$emit("pause")}catch(e){this.$emit("pause-error",e)}},onAudioPlaying:function(){this.isPlaying=!0},onAudioPaused:function(){this.isPlaying=!1},onTimeUpdate:function(){var audio=this.$refs.audioElement;if(this.currentTime=audio.currentTime,this.duration=audio.duration||0,this.duration>0){var e=this.currentTime/this.duration*100;Math.abs(e-this.targetProgressPercentage)>.1&&(this.targetProgressPercentage=e,this.requestRender())}},onAudioEnded:function(){this.$emit("ended"),this.currentTime=0,this.targetProgressPercentage=0,this.animatedProgressPercentage=0,this.loop&&(this.requestRender(),this.play())},formatTime:function(time){if(!time||isNaN(time))return"00:00";var e=Math.floor(time/60),t=Math.floor(time%60);return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))},cleanup:function(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.$refs.audioElement&&(this.$refs.audioElement.pause(),this.$refs.audioElement.src="",this.$refs.audioElement.load()),this.audioContext&&"closed"!==this.audioContext.state&&this.audioContext.close()}}}),c=(n(4433),n(0)),component=Object(c.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"audio-waveform-container"},[t("div",{staticClass:"audio-name"},[t("img",{staticClass:"audio-name-icon",attrs:{src:e.icon,alt:"icon"}}),e._v(" "),t("div",{staticClass:"audio-name-text ellipsis"},[e._v(e._s(e.name))])]),e._v(" "),t("div",{staticClass:"waveform-wrapper"},[t("div",{ref:"waveformContainer",staticClass:"waveform-container"},[t("canvas",{ref:"waveformCanvas",staticClass:"waveform-canvas",attrs:{width:e.canvasWidth,height:e.canvasHeight}})])]),e._v(" "),t("div",{staticClass:"time-display"},[t("span",{staticClass:"current-time"},[e._v(e._s(e.formatTime(e.currentTime)))]),e._v(" "),t("span",{staticClass:"total-time"},[e._v(e._s(e.formatTime(e.duration)))])]),e._v(" "),t("audio",{ref:"audioElement",attrs:{src:e.url,preload:"auto",crossorigin:"anonymous"},on:{loadedmetadata:e.onAudioLoaded,timeupdate:e.onTimeUpdate,playing:e.onAudioPlaying,pause:e.onAudioPaused,ended:e.onAudioEnded,error:e.onAudioError}})])}),[],!1,null,"486d144c",null);t.default=component.exports},3331:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(31),n(26),n(20),n(179)),r=n(46),c=n(29),d=n(10),v={components:{PickOrUploadImageModal:l.default},data:function(){return{dialogVisible:!1,currentImage:null,isParsingImage:!1,pollTimer:null,deductionResult:[],isDeductionSuccess:!1}},methods:{showModal:function(e){var image=e.image,t=e.result,n=void 0===t?[]:t,o=e.isDeduction,l=void 0!==o&&o;this.currentImage=image,this.deductionResult=n,l&&this.handleDeductionPrompt(),this.dialogVisible=!0},handleOpenPickImageModal:function(){this.cancelPoll(),this.$refs.pickOrUploadImageModal.openModal()},handlePickImage:function(e){var t;this.deductionResult=[],this.currentImage=null===(t=e[0])||void 0===t?void 0:t.url,this.isParsingImage=!1,this.handleDeductionPrompt()},handleAiPickImage:function(e){this.deductionResult=[],this.currentImage=e,this.isParsingImage=!1,this.handleDeductionPrompt()},handleDeductionPrompt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isParsingImage=!0,t.prev=1,t.next=4,Object(r.easyDeductionPrompt)({meta:{img_2_text:{uri:e.currentImage}}});case 4:1e4===(n=t.sent).status.code?e.handleFetchTaskProcess(n.data.id):(e.isParsingImage=!1,e.handleTaskFailed()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.handleTaskFailed();case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},handleFetchTaskProcess:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=3;break}return t.isParsingImage=!1,n.abrupt("return");case 3:return t.cancelPoll(),n.prev=4,n.next=7,Object(c.batchFetchTaskProcess)({task_ids:[e]});case 7:if(1e4!==(o=n.sent).status.code){n.next=22;break}if(3!==(l=o.data.items[0]).status){n.next=15;break}return t.isParsingImage=!1,t.cancelPoll(),t.handleTaskSuccess(l),n.abrupt("return");case 15:if(4!==l.status&&(2===l.status||1===l.status)){n.next=19;break}return t.isParsingImage=!1,t.handleTaskFailed(),n.abrupt("return");case 19:t.pollTimer=setTimeout((function(){t.handleFetchTaskProcess(e)}),1e3),n.next=24;break;case 22:t.isParsingImage=!1,t.handleTaskFailed();case 24:n.next=30;break;case 26:n.prev=26,n.t0=n.catch(4),t.isParsingImage=!1,t.handleTaskFailed();case 30:case"end":return n.stop()}}),n,null,[[4,26]])})))()},handleTaskSuccess:function(e){this.isDeductionSuccess=!0,this.deductionResult=null==e?void 0:e.reverse_local_prompts.slice(0,2),localStorage.setItem("deductionResult",JSON.stringify({image:this.currentImage,result:this.deductionResult})),this.$store.dispatch("payment/getPaymentInfo")},handleTaskFailed:function(){this.isDeductionSuccess=!1,this.$message.error(this.$t("AnalyzingFail")),localStorage.removeItem("deductionResult"),this.isParsingImage=!1,this.deductionResult=[],this.currentImage=null,this.dialogVisible=!1},handleCopyText:function(text){text&&(Object(d.g)(text),this.$message.success(this.$t("CopySuccess")))},handleUseText:function(text){this.dialogVisible=!1,text&&this.$emit("useText",text)},cancelPoll:function(){this.pollTimer&&(clearTimeout(this.pollTimer),this.pollTimer=null)},handleClose:function(){(this.isDeductionSuccess||this.isParsingImage)&&localStorage.setItem("deductionResult",JSON.stringify({image:this.currentImage,result:this.deductionResult}))}},destroyed:function(){this.cancelPoll()}},m=(n(4437),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":!0,"show-close":!1,"destroy-on-close":!1,top:"60px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[t("div",{staticClass:"prompt-word-modal-content",attrs:{"data-group":"deduction-prompt-modal"}},[t("div",{staticClass:"prompt-word-modal-header"},[t("div",{staticClass:"prompt-word-modal-header-title"},[e._v(e._s(e.$t("prompt_word_modal_title")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1 header-close",on:{click:function(t){e.dialogVisible=!1}}})]),e._v(" "),t("div",{staticClass:"prompt-word-modal-body"},[t("div",{staticClass:"upload-file-box"},[t("img",{attrs:{src:e.currentImage,alt:"","data-id":e.currentImage}}),e._v(" "),t("div",{staticClass:"upload-file-box-btn",on:{click:e.handleOpenPickImageModal}},[t("i",{staticClass:"iconfont icon-icon_Upload"}),e._v(" "),t("span",[e._v(e._s(e.$t("CreativeCenterPopup33")))])])]),e._v(" "),t("div",{staticClass:"iamge-des"},[e._v("\n        "+e._s(e.$t("ImageDescription"))+"\n      ")]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isParsingImage,expression:"isParsingImage"}],staticClass:"image-des-box",attrs:{"element-loading-text":e.$t("digitalHumanLoading"),"element-loading-background":"#10151F"}},[t("div",{staticClass:"image-des-title"},[e._v(e._s(e.$t("TagDescription")))]),e._v(" "),t("div",{staticClass:"iamge-des-content"},[e._v(e._s(e.deductionResult[0]))]),e._v(" "),t("div",{staticClass:"image-des-btn-box"},[t("div",{staticClass:"image-des-btn-box-item copy",class:{disabled:!e.deductionResult[0]},attrs:{"data-id":"deduction-prompt-modal-copy-1"},on:{click:function(t){return e.handleCopyText(e.deductionResult[0])}}},[e._v("\n            "+e._s(e.$t("copy"))+"\n          ")]),e._v(" "),t("div",{staticClass:"image-des-btn-box-item use-btn",class:{disabled:!e.deductionResult[0]},attrs:{"data-id":"deduction-prompt-modal-use-1"},on:{click:function(t){return e.handleUseText(e.deductionResult[0])}}},[e._v("\n            "+e._s(e.$t("workFlow46"))+"\n          ")])])]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isParsingImage,expression:"isParsingImage"}],staticClass:"image-des-box",attrs:{"element-loading-text":e.$t("digitalHumanLoading"),"element-loading-background":"#10151F"}},[t("div",{staticClass:"image-des-title"},[e._v(e._s(e.$t("NaturalLanguage")))]),e._v(" "),t("div",{staticClass:"iamge-des-content"},[e._v(e._s(e.deductionResult[1]))]),e._v(" "),t("div",{staticClass:"image-des-btn-box"},[t("div",{staticClass:"image-des-btn-box-item copy",class:{disabled:!e.deductionResult[1]},attrs:{"data-id":"deduction-prompt-modal-copy-2"},on:{click:function(t){return e.handleCopyText(e.deductionResult[1])}}},[e._v("\n            "+e._s(e.$t("copy"))+"\n          ")]),e._v(" "),t("div",{staticClass:"image-des-btn-box-item use-btn",class:{disabled:!e.deductionResult[1]},attrs:{"data-id":"deduction-prompt-modal-use-2"},on:{click:function(t){return e.handleUseText(e.deductionResult[1])}}},[e._v("\n            "+e._s(e.$t("workFlow46"))+"\n          ")])])])])]),e._v(" "),t("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:e.handlePickImage}})],1)}),[],!1,null,"28247c32",null);t.default=component.exports},3332:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8);var o=n(3),l=n(2),r=(n(20),n(16),n(4),n(7),n(3124)),c=(n(4438),n(46)),d=n(1),v=n(1127),m=n.n(v);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={props:{isInitGuide:{type:Boolean,default:!1},isGenerate:{type:Boolean,default:!1}},inject:["driverContainer"],watch:{isInitGuide:function(e){e?this.tryInitGuide():this.driverObj&&this.destroyGuide()},"$i18n.locale":{handler:function(e){e&&this.getTemplate()}}},data:function(){return{template:[],driverObj:null,loading:!1,hasInitGuide:!1,imageLoadedCount:0}},mounted:function(){var e=this;this.getTemplate(),this.handleInputHeightChange();var t=document.querySelector("#generate-btn");t&&t.addEventListener("click",(function(){e.destroyGuide()}))},computed:f(f({},Object(d.e)("app",["ABInfo"])),Object(d.c)("user",["isLoggedIn"])),methods:{getTemplate:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c.easyGetCreationGuidanceTemplate)();case 3:1e4===(n=t.sent).status.code&&(e.template=(null===(o=n.data)||void 0===o?void 0:o.items)||[]),e.imageLoadedCount=0,e.template.length||(e.loading=!1),e.$nextTick((function(){var t=e.$el.querySelectorAll(".content-img img");0===t.length?e.loading=!1:t.forEach((function(img){img.complete&&e.handleImageLoad()}))})),e.tryInitGuide();case 9:case"end":return t.stop()}}),t)})))()},handleImageLoad:function(){this.imageLoadedCount++,this.imageLoadedCount>=this.template.length&&(this.loading=!1),this.hasInitGuide&&this.driverObj&&this.driverObj.refresh()},tryInitGuide:function(){var e=this;localStorage.getItem("creationGuideDone")||this.isInitGuide&&this.template.length>0&&!this.isLoggedIn&&!this.hasInitGuide&&(this.hasInitGuide=!0,this.$nextTick((function(){e.initGuide()})))},addGesture:function(e){var t=document.createElement("div");t.className="custom-dom",t.innerHTML='\n                  <div class="custom-arrow"></div>\n                  <div class="custom-img-wrapper">\n                    <img class="custom-img" src="'.concat(m.a,'" alt="" />\n                  </div>\n                  <div class="water-ripple"></div>\n                '),e.arrow.appendChild(t)},handleCreationSteps:function(){var e,t=this;return{A:[{element:"#creation-guidance-template",popover:{title:this.$t("select_template"),description:this.$t("select_template_desc"),showButtons:["next","close"],side:"top",align:"center",onPopoverRender:function(e,n){n.config,n.state;t.addGesture(e)},onNextClick:function(){var e=Math.floor(Math.random()*t.template.length);t.handleClickItem(t.template[e])}}}],B:[{element:"#creation-guidance-template",popover:{title:this.$t("select_template"),description:this.$t("select_template_desc"),showButtons:["next","close"],closeBtnText:'<i class="iconfont icon-close"></i>',side:"top",align:"center",onNextClick:function(){var e=Math.floor(Math.random()*t.template.length);t.handleClickItem(t.template[e])},onCloseClick:function(){t.destroyGuide()},onPopoverRender:function(e,n){n.config,n.state;t.addGesture(e),e.closeButton.innerHTML='<i class="iconfont icon-close" data-event="creation-guidance-template-close-click" data-id="close-creation-guidance-template"></i>',e.closeButton.addEventListener("click",(function(){t.destroyGuide()}))}}},{element:"#generate-btn",popover:{title:this.$t("ChatCreate"),description:this.$t("click_create_desc"),doneBtnText:this.$t("Done"),side:"bottom",align:"end",popoverClass:"custom-popover-guidance custom-popover-guidance-create",onPopoverRender:function(e,n){n.config,n.state;e.nextButton.classList.contains("driver-guidance-done-btn")||e.nextButton.classList.add("driver-guidance-done-btn");var o=document.querySelector("#generate-btn");o&&!o.classList.contains("driver-active-element")&&o.classList.add("driver-active-element"),t.addGesture(e)},onNextClick:function(){t.destroyGuide()}}}]}[null===(e=this.ABInfo)||void 0===e?void 0:e.task_generation_guide_gray]},initGuide:function(){var e,t=this;["C","D"].includes(null===(e=this.ABInfo)||void 0===e?void 0:e.task_generation_guide_gray)||(localStorage.setItem("creationGuideDone","1"),this.$nextTick((function(){t.driverObj=Object(r.a)({showProgress:!0,allowClose:!1,showButtons:["next","previous"],nextBtnText:t.$t("NextStep"),prevBtnText:t.$t("PreNext"),doneBtnText:t.$t("Done"),popoverClass:"custom-popover-guidance",steps:t.handleCreationSteps(),container:t.driverContainer&&t.driverContainer()}),t.driverObj.drive()})))},handleClickItem:function(e){var t,n;if(this.isGenerate)return this.$message.warning(this.$t("fastToolsProcessTips"));"A"===(null===(t=this.ABInfo)||void 0===t?void 0:t.task_generation_guide_gray)?this.destroyGuide():this.driverObj&&this.driverObj.drive(1),this.$emit("clickItem",{itemId:e.id,actionType:null===(n=this.ABInfo)||void 0===n?void 0:n.task_generation_guide_gray})},destroyGuide:function(){this.driverObj&&(this.driverObj.destroy(),this.driverObj=null)},handleInputHeightChange:function(){var e=this,t=new MutationObserver((function(){e.driverObj&&e.driverObj.refresh()})),n=document.querySelector(".easy-generate-content-right-top");n&&t.observe(n,{attributes:!0,childList:!0,subtree:!0})}},destroyed:function(){var e=this;this.destroyGuide();var t=document.querySelector("#generate-btn");t&&t.removeEventListener("click",(function(){e.destroyGuide()}))}},y=(n(4439),n(4440),n(0)),component=Object(y.a)(_,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"creation-guidance-template",attrs:{id:"creation-guidance-template","data-group":"creation-guidance-template"}},[t("div",{staticClass:"creation-guidance-template-title"},[t("h4",[e._v(e._s(e.$t("creation_guidance_template_title")))]),e._v(" "),t("h5",[e._v(e._s(e.$t("creation_guidance_template_desc")))])]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"creation-guidance-template-content"},e._l(e.template,(function(n){var o;return t("div",{key:n.id,staticClass:"creation-guidance-template-content-item",attrs:{"data-event":"creation-guidance-template-item-click","data-id":n.id},on:{click:function(t){return e.handleClickItem(n)}}},[t("div",{staticClass:"item-title"},[t("div",{staticClass:"title"},[e._v(e._s(null==n?void 0:n.title))]),e._v(" "),t("div",{staticClass:"sub-title"},[e._v(e._s(null==n?void 0:n.desc))])]),e._v(" "),t("div",{staticClass:"content-img"},[t("img",{attrs:{src:null==n||null===(o=n.cover)||void 0===o?void 0:o.url,alt:""},on:{load:e.handleImageLoad}})]),e._v(" "),t("div",{staticClass:"remix-btn"},[t("div",{staticClass:"remix-btn-text"},[e._v(e._s(e.$t("Remix")))])])])})),0)])}),[],!1,null,"72d00b92",null);t.default=component.exports},3333:function(e,t,n){"use strict";n.r(t);n(16),n(21);var o=n(2),l=n(14),r=n(3),c=(n(20),n(19),n(32),n(11),n(6),n(22),n(18),n(12),n(13),n(8),n(4),n(7),n(426)),d=n(3334),v=n(46),m=n(324),h=n(161),f=n(145);n(25);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={components:{RecipeDetail:d.default,InfiniteScrollLoad:c.default},mixins:[f.a],props:{modelData:{type:Object,default:function(){}}},watch:{modelKey:function(e){this.renderKey++,this.visible&&e&&(this.$refs.recipeDetail.closeModal(),this.filterObj={order_by:"hot",model_gen_opts:[""]},this.resetInitState(),this.getModelRecipeList()),this.visible=!1,this.scrollPosition=0,this.isFirstLoad=!0}},computed:{modelKey:function(){return"".concat(this.modelData.art_model_no||"").concat(this.modelData.art_model_ver_no||"")}},data:function(){return{visible:!1,timeList:[{label:this.$t("blog_all"),value:"hot"},{label:this.$t("months"),value:"month_hot"},{label:this.$t("week"),value:"week_hot"},{label:this.$t("days"),value:"day_hot"}],compositionList:[{label:this.$t("blog_all"),value:""},{label:this.$t("OnlyShowWithLora"),value:"lora"}],modelRecipeList:[],hasMore:!0,limit:20,loading:!1,nextCursor:"",filterObj:{order_by:"hot",model_gen_opts:[""]},renderKey:0,isFirstLoad:!0,scrollPosition:0,jilufilterObj:{order_by:"hot",model_gen_opts:[""]}}},methods:{showModal:function(){var e=this;this.renderKey++,this.isFirstLoad&&(this.resetInitState(),this.isFirstLoad=!1,this.getModelRecipeList()),this.visible?this.closeModal():(this.$xyLogEvent({front_operation:"exposure",entity_name:"model-recipe-popover",entity_type:"create-model-recipe"}),this.visible=!0,this.$nextTick((function(){e.$refs.infiniteScroll&&(e.$refs.infiniteScroll.$el.scrollTop=e.scrollPosition,e.filterObj=e.jilufilterObj)})))},closeModal:function(e){var t=this;if(this.$refs.infiniteScroll){var n=this.$refs.infiniteScroll.$el;this.scrollPosition=n.scrollTop,this.jilufilterObj=JSON.parse(JSON.stringify(this.filterObj))}var o=function(){t.visible=!1,t.filterObj={order_by:"hot",model_gen_opts:[""]},t.$refs.recipeDetail.closeModal()};e?o():this.visible&&this.$refs.recipeDetail.visible?(this.$refs.recipeDetail.closeModal(),this.$nextTick((function(){t.$refs.infiniteScroll&&(t.$refs.infiniteScroll.$el.scrollTop=t.scrollPosition)}))):o()},getModelRecipeList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasMore&&!e.loading&&e.visible){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,t.next=5,Object(v.getModelRecipe)({model_id:e.modelData.art_model_no,model_ver_id:e.modelData.art_model_ver_no,limit:e.limit,cursor:e.nextCursor,order_by:e.filterObj.order_by,model_gen_opts:e.filterObj.model_gen_opts}).finally((function(){e.loading=!1}));case 5:1e4===(n=t.sent).status.code&&(e.modelRecipeList=[].concat(Object(l.a)(e.modelRecipeList),Object(l.a)(n.data.items.map((function(e){return y(y({},e),{},{curr_page:n.data.curr_page})})))),e.hasMore=n.data.has_more,e.nextCursor=n.data.next_cursor);case 7:case"end":return t.stop()}}),t)})))()},handleCreateRecipe:function(e){this.$emit("RecipeRemix",e)},handleRecipeItemClick:function(e){this.$refs.recipeDetail.showModal(e.id)},handleFilter:function(e,t){var n=this;this.renderKey++,{order_by:function(){n.filterObj.order_by=e},model_gen_opts:function(){n.filterObj.model_gen_opts=[e]}}[t](),this.$refs.recipeDetail.closeModal(),this.resetInitState(),this.getModelRecipeList()},handleResetFilter:function(){this.filterObj={order_by:"hot",model_gen_opts:[""]},this.resetInitState(),this.getModelRecipeList()},resetInitState:function(){this.loading=!1,this.hasMore=!0,this.nextCursor="",this.modelRecipeList=[]},clearCache:function(){this.resetInitState(),this.isFirstLoad=!0},handleUseParams:function(e){this.$emit("useParams",e)},assembleParams:function(e){var t,n,o,r,c,d,v,m=(null==e?void 0:e.used_models.map((function(e){return y(y({},e),{},{id:e.id,name:e.name,banner:e.banner,model_type:e.model_type})})))||[],h=[];(null!=e&&null!==(t=e.origin_meta)&&void 0!==t&&null!==(t=t.controlnet_units)&&void 0!==t&&t.length&&(null==e||e.origin_meta.controlnet_units.forEach((function(e){h.push({mode:"ctr_net",image:{url:e.input_image},ctr_net_cond:e})}))),null!=e&&null!==(n=e.origin_meta)&&void 0!==n&&null!==(n=n.init_images)&&void 0!==n&&n.length&&(null==e||e.origin_meta.init_images.forEach((function(e){h.push({mode:"img2img",image:{url:e}})}))),null!=e&&null!==(o=e.origin_meta)&&void 0!==o&&null!==(o=o.lab_base)&&void 0!==o&&null!==(o=o.conds)&&void 0!==o&&o.length)&&(null==e||null===(v=e.origin_meta)||void 0===v||null===(v=v.lab_base)||void 0===v||v.conds.forEach((function(e){h.push({mode:"StyleReference"===e.mode?"style_ref":"ImagePrompt"===e.mode?"img2img":"ip_maintain",image:{url:e.image}})})));return{title:"",cover:{url:null==e||null===(r=e.cover)||void 0===r?void 0:r.url,width:null==e||null===(c=e.cover)||void 0===c?void 0:c.width,height:null==e||null===(d=e.cover)||void 0===d?void 0:d.height},artwork_id:null==e?void 0:e.id,used_models:Object(l.a)(m),meta:{cfg_scale:e.origin_meta.cfg_scale,clip_skip:e.origin_meta.clip_skip,width:e.origin_meta.width,height:e.origin_meta.height,negative_prompt:e.origin_meta.negative_prompt,prompt:e.origin_meta.prompt,sampler_name:e.origin_meta.sampler_name,steps:e.origin_meta.steps,vae:e.origin_meta.vae,use_image_conditions:h}}},handleNoteVitor:function(e){var t=arguments,n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var source,l,r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return source=t.length>1&&void 0!==t[1]?t[1]:"inspiration_records",o.next=3,Object(v.getModelRecipeDetail)({id:e});case 3:1e4===(l=o.sent).status.code&&(r=l.data,c=Object(h.a)({render:function(e){return e(m.default,{props:{params:n.assembleParams(r),saveParams:y(y({},r),{},{meta:y({},r.origin_meta)}),source:source},on:{close:function(){c.close()},save:function(){c.close()}}})}}));case 5:case"end":return o.stop()}}),o)})))()},handleNoteListModal:function(){this.$emit("openNoteListModal",{source:"inspiration_notes"})},hasNoteFunction:function(e){var t,n=null==e||null===(t=e.action_capability)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.find((function(e){return"supportMetaNote"===e.val}));return n}},beforeDestroy:function(){this.resetInitState()}},w=C,k=(n(4444),n(4445),n(0)),component=Object(k.a)(w,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{"popper-class":"model-recipe-popover",placement:"right","visible-arrow":!1,width:"328",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"model-recipe",attrs:{"data-group":"model-recipe"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{staticClass:"model-recipe-title"},[t("span",[e._v(e._s(e.$t("RecipeLibrary")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1",on:{click:e.closeModal}})]),e._v(" "),t("div",{staticClass:"model-recipe-content"},[t("div",{staticClass:"model-recipe-content-operation"},[t("el-popover",{staticClass:"model-recipe-filter-popover",attrs:{placement:"bottom-start",width:"240",trigger:"hover"}},[t("div",{staticClass:"filter-popover-content"},[t("div",{staticClass:"filter-popover-content-item"},[t("span",{staticClass:"filter-popover-content-item-label"},[e._v(e._s(e.$t("Time")))]),e._v(" "),t("div",{staticClass:"filter-popover-content-item-list"},e._l(e.timeList,(function(n){return t("div",{key:n.value,staticClass:"filter-popover-content-item-list-item",class:{active:e.filterObj.order_by===n.value},attrs:{"data-id":n.value},on:{click:function(t){return e.handleFilter(n.value,"order_by")}}},[e.filterObj.order_by===n.value?t("i",{staticClass:"iconfont icon-icon-event-confirm"}):e._e(),e._v("\n                  "+e._s(n.label)+"\n                ")])})),0)]),e._v(" "),t("div",{staticClass:"filter-popover-content-item"},[t("span",{staticClass:"filter-popover-content-item-label"},[e._v(e._s(e.$t("Composition")))]),e._v(" "),t("div",{staticClass:"filter-popover-content-item-list"},e._l(e.compositionList,(function(n){return t("div",{key:n.value,staticClass:"filter-popover-content-item-list-item",class:{active:e.filterObj.model_gen_opts.includes(n.value)},attrs:{"data-id":n.value},on:{click:function(t){return e.handleFilter(n.value,"model_gen_opts")}}},[e.filterObj.model_gen_opts.includes(n.value)?t("i",{staticClass:"iconfont icon-icon-event-confirm"}):e._e(),e._v("\n                  "+e._s(n.label)+"\n                ")])})),0)]),e._v(" "),t("div",{staticClass:"model-recipe-filter-reset",on:{click:e.handleResetFilter}},[e._v("\n              "+e._s(e.$t("resetSelection"))+"\n            ")])]),e._v(" "),t("div",{staticClass:"model-recipe-filter",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"model-recipe-filter-item"},[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("div",{staticClass:"model-recipe-filter-arrow"})])]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("ViewYourNote"),placement:"top"}},[t("i",{staticClass:"iconfont icon-NotebookPen",attrs:{"data-id":"recipe-open-note"},on:{click:e.handleNoteListModal}})])],1),e._v(" "),t("InfiniteScrollLoad",{key:e.renderKey,ref:"infiniteScroll",style:{height:"calc(100vh - 240px)"},attrs:{autoLoad:!1,noMore:!e.hasMore,showNoMore:!1},on:{"load-more":e.getModelRecipeList},scopedSlots:e._u([{key:"loading",fn:function(){return[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"loading-box"})]},proxy:!0}])},[e.modelRecipeList.length?t("div",{staticClass:"model-recipe-list",attrs:{"data-event":"model-recipe-list"}},e._l(e.modelRecipeList,(function(n,o){var l;return t("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibility,expression:"handleVisibility"}],key:n.id,staticClass:"model-recipe-item",attrs:{"data-id":n.id,"data-index":o,"data-pt":n.curr_page,"data-info":JSON.stringify({id:n.id,cindex:o,pt:n.curr_page})},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRecipeItemClick(n)}}},[t("img",{attrs:{src:null==n||null===(l=n.cover)||void 0===l?void 0:l.url,alt:""}}),e._v(" "),t("div",{staticClass:"btn-box"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("Remix"),placement:"top"}},[t("div",{staticClass:"remix-btn",attrs:{"data-id":n.id,"data-index":o,"data-pt":n.curr_page},on:{click:function(t){return t.stopPropagation(),e.handleCreateRecipe(n.id)}}},[e._v("\n                  Remix\n                ")])])],1)])})),0):t("div",{staticClass:"empty-box"},[t("div",{staticClass:"empty-box-text"},[e._v(e._s(e.$t("noMoreRecipe")))]),e._v(" "),t("div",{staticClass:"empty-box-text"},[e._v(e._s(e.$t("createRecipe")))])])])],1)]),e._v(" "),t("RecipeDetail",{ref:"recipeDetail",attrs:{"base-model-type":e.modelData.base_model_type},on:{useParams:e.handleUseParams,remix:e.handleCreateRecipe,note:e.handleNoteVitor}})],1)}),[],!1,null,"042a70f4",null);t.default=component.exports;installComponents(component,{InfiniteScrollLoad:n(426).default})},3334:function(e,t,n){"use strict";n.r(t);n(18);var o=n(3),l=(n(20),n(6),n(32),n(16),n(769),n(65),n(4),n(43),n(21),n(10)),r=n(46),c=n(162),d=n(99),v=n(57),m={props:{baseModelType:{type:String,default:""}},data:function(){return{visible:!1,loading:!1,dataId:"",detailInfo:{},prompt:"",isTranslate:!1,translateLoading:!1}},computed:{modelList:function(){var e;return(null===(e=this.detailInfo)||void 0===e||null===(e=e.used_models)||void 0===e?void 0:e.filter((function(e){return"Checkpoint"!==e.model_type})))||[]},hasNote:function(){var e;return null===(e=this.detailInfo)||void 0===e||null===(e=e.action_capability)||void 0===e||null===(e=e.permission)||void 0===e?void 0:e.find((function(e){return"supportMetaNote"===e.val}))},getCurrentBaseModelType:function(){var e=this.baseModelType||"",t=Object(d.getCurrentModelType)(e);return t||"sd"},getCustomSizeOptions:function(){var e,t={min:128,max:1024},n={min:384,max:1024};return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?n:"sd"===this.getCurrentModelType?t:null!=this&&this.isSpecialILModel?{min:512,max:1536}:null!=this&&this.isSpecialILModel3?{min:512,max:2048}:["sdxl"].includes(this.getCurrentModelType)?{min:128,max:1536}:"SD 3.5"===this.getCurrentModelType?n:"HiDream"===this.getCurrentModelType?{min:768,max:1360}:"SeaDream"===this.getCurrentModelType?{min:512,max:1472}:t}},methods:{isNotNil:function(e){return null!=e},showModal:function(e){this.dataId=e,this.visible||(this.visible=!0,this.$xyLogEvent({front_operation:"exposure",entity_name:"model-recipe-detail",entity_type:"model-recipe-detail"})),this.isTranslate=!1,this.getRecipeDetail(e)},closeModal:function(){this.visible=!1,this.detailInfo={},this.prompt="",this.isTranslate=!1,this.translateLoading=!1},getRecipeDetail:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.next=3,Object(r.getModelRecipeDetail)({id:e});case 3:1e4===(null==(l=n.sent)||null===(o=l.status)||void 0===o?void 0:o.code)&&(t.detailInfo=l.data,t.prompt=l.data.origin_meta.prompt),t.loading=!1;case 6:case"end":return n.stop()}}),n)})))()},handleCopyPrompt:function(){Object(l.g)(this.prompt),this.$message.success(this.$t("CopySuccess"))},handleTranslatePrompt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isTranslate&&e.prompt){t.next=4;break}return e.prompt=(null===(n=e.detailInfo)||void 0===n||null===(n=n.origin_meta)||void 0===n?void 0:n.prompt)||"",e.isTranslate=!1,t.abrupt("return");case 4:return e.isTranslate=!e.isTranslate,e.translateLoading=!0,o=e.$i18n.locale,l={zhCN:"zh-cn",zhTW:"zh-tw"}[o]||o,t.next=11,Object(c.a)(e.prompt,{to:l});case 11:r=t.sent,e.prompt=r.text,e.translateLoading=!1;case 14:case"end":return t.stop()}}),t)})))()},handleOriginMeta:function(){var e,t=null===(e=this.detailInfo)||void 0===e?void 0:e.origin_meta,n={width:t.width,height:t.height,cfg_scale:t.cfg_scale,steps:t.steps,seed:t.seed,vae:t.vae,sampler_name:t.sampler_name};if(0===n.width&&delete n.width,0===n.height&&delete n.height,n.width&&n.height){var o=Object(v.resizeToBaseDimension)(n.width,n.height,this.getCustomSizeOptions.max);n.width=o.width,n.height=o.height}return{params:n,paramsType:"AdvancedConfig"}},handleUseParams:function(e){var t=this,n={prompt:function(){return{params:t.prompt,paramsType:"Prompt"}},used_models:function(){return{params:t.modelList,paramsType:"Lora"}},origin_meta:function(){return t.handleOriginMeta()},negative_prompt:function(){var e;return{params:null===(e=t.detailInfo)||void 0===e||null===(e=e.origin_meta)||void 0===e?void 0:e.negative_prompt,paramsType:"NegativePrompt"}}};this.$emit("useParams",n[e]())},handleRemix:function(){this.$emit("remix",this.detailInfo.id)},handleNoteVitor:function(){this.hasNote&&this.$emit("note",this.detailInfo.id,"inspiration_notes")},formatWeight:function(e){if(Number.isInteger(e))return e;var t=e.toString();return t.includes(".")?t.split(".")[1].length<=2?parseFloat(t):parseFloat(e.toFixed(2)):e},handleModelClick:function(e){e&&window.open("/models/detail/".concat(e),"_blank")}}},h=(n(4442),n(4443),n(0)),component=Object(h.a)(m,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x=this,T=x._self._c;return T("el-popover",{ref:"recipeDetailPopover",staticClass:"recipe-detail-popover",attrs:{"popper-class":"model-recipe-popover recipe-detail-popover",placement:"right","visible-arrow":!1,width:"450",trigger:"manual"},model:{value:x.visible,callback:function(e){x.visible=e},expression:"visible"}},[T("div",{staticClass:"recipe-detail-popover-content",attrs:{"data-group":"recipe-detail-popover-content"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[T("div",{staticClass:"recipe-detail-title"},[T("span",[x._v(x._s(x.$t("RecipeLibrary")))]),x._v(" "),T("i",{staticClass:"iconfont icon-guanbi1",on:{click:function(e){x.visible=!1}}})]),x._v(" "),T("div",{directives:[{name:"loading",rawName:"v-loading",value:x.loading,expression:"loading"}],staticClass:"recipe-detail-content"},[T("div",{staticClass:"detail-img-box"},[T("el-image",{attrs:{src:null===(e=x.detailInfo)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.url,"preview-src-list":[null===(t=x.detailInfo)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.url],fit:"contain"}})],1),x._v(" "),x.prompt?T("div",{staticClass:"detail-info-prompt"},[T("div",{staticClass:"title"},[T("div",{staticClass:"title-left"},[T("span",[x._v(x._s(x.$t("Prompt")))]),x._v(" "),T("i",{staticClass:"iconfont icon-codeCopy1",on:{click:x.handleCopyPrompt}}),x._v(" "),T("i",{staticClass:"iconfont icon-i18n_prompt",on:{click:x.handleTranslatePrompt}})]),x._v(" "),T("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:x.$t("ApplyThisCombo"),placement:"top"}},[T("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"recipe-use-prompt"},on:{click:function(e){return x.handleUseParams("prompt")}}})])],1),x._v(" "),T("div",{staticClass:"content"},[x._v("\n          "+x._s(x.translateLoading?"":x.prompt)+"\n          "),x.translateLoading?T("div",{staticClass:"loading-icon"},[T("span"),x._v(" "),T("span"),x._v(" "),T("span"),x._v(" "),T("span"),x._v(" "),T("span"),x._v(" "),T("span")]):x._e()])]):x._e(),x._v(" "),x.modelList.length?T("div",{staticClass:"detail-info-models module-box"},[T("div",{staticClass:"title"},[T("div",{staticClass:"title-left"},[T("span",[x._v("Lora")])]),x._v(" "),T("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:x.$t("ApplyThisCombo"),placement:"top"}},[T("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"recipe-use-lora"},on:{click:function(e){return x.handleUseParams("used_models")}}})])],1),x._v(" "),T("div",{staticClass:"content"},x._l(x.modelList,(function(e){var t;return T("div",{key:e.id,staticClass:"lora-item",attrs:{"data-id":e.id,"data-event":"model-recipe-detail-lora"},on:{click:function(t){return x.handleModelClick(e.id)}}},[T("div",{staticClass:"model-cover"},[T("img",{attrs:{src:null==e||null===(t=e.banner)||void 0===t?void 0:t.url,alt:"model-cover"}}),x._v(" "),x.isNotNil(null==e?void 0:e.weight)?T("div",{staticClass:"model-tag"},[x._v(x._s(x.formatWeight(e.weight)))]):x._e()]),x._v(" "),T("div",{staticClass:"model-desc"},[T("div",{staticClass:"model-type"},[x._v("\n                "+x._s("TextualInversion"===(null==e?void 0:e.model_type)?"Embedding":"LoCon"===(null==e?void 0:e.model_type)?"LyCORIS":null==e?void 0:e.model_type)+"\n              ")]),x._v(" "),T("div",{staticClass:"model-name"},[x._v(x._s(e.name))])])])})),0)]):x._e(),x._v(" "),T("div",{staticClass:"detail-info-advanced-settings module-box"},[T("div",{staticClass:"title"},[T("div",{staticClass:"title-left"},[T("span",[x._v(x._s(x.$t("AdvancedConfig")))])]),x._v(" "),T("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:x.$t("ApplyThisCombo"),placement:"top"}},[T("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"recipe-use-advanced-settings"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),x.handleUseParams("origin_meta")}}})])],1),x._v(" "),T("div",{staticClass:"content"},[null!==(n=x.detailInfo)&&void 0!==n&&null!==(n=n.origin_meta)&&void 0!==n&&n.width&&null!==(o=x.detailInfo)&&void 0!==o&&null!==(o=o.origin_meta)&&void 0!==o&&o.height?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("Size")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(l=x.detailInfo)||void 0===l||null===(l=l.origin_meta)||void 0===l?void 0:l.width)+" x "+x._s(null===(r=x.detailInfo)||void 0===r||null===(r=r.origin_meta)||void 0===r?void 0:r.height))])])]):x._e(),x._v(" "),null!==(c=x.detailInfo)&&void 0!==c&&null!==(c=c.origin_meta)&&void 0!==c&&c.cfg_scale?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("CFGScale")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(d=x.detailInfo)||void 0===d||null===(d=d.origin_meta)||void 0===d?void 0:d.cfg_scale))])])]):x._e(),x._v(" "),x.isNotNil(null===(v=x.detailInfo)||void 0===v||null===(v=v.origin_meta)||void 0===v?void 0:v.steps)?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("Steps")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(m=x.detailInfo)||void 0===m||null===(m=m.origin_meta)||void 0===m?void 0:m.steps))])])]):x._e(),x._v(" "),x.isNotNil(null===(h=x.detailInfo)||void 0===h||null===(h=h.origin_meta)||void 0===h?void 0:h.seed)?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("RandomSeed")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(f=x.detailInfo)||void 0===f||null===(f=f.origin_meta)||void 0===f?void 0:f.seed))])])]):x._e(),x._v(" "),null!==(_=x.detailInfo)&&void 0!==_&&null!==(_=_.origin_meta)&&void 0!==_&&_.vae?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("VAE")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(y=x.detailInfo)||void 0===y||null===(y=y.origin_meta)||void 0===y?void 0:y.vae))])])]):x._e(),x._v(" "),null!==(C=x.detailInfo)&&void 0!==C&&null!==(C=C.origin_meta)&&void 0!==C&&C.sampler_name?T("div",{staticClass:"advanced-settings-item"},[T("div",{staticClass:"advanced-settings-item-label"},[T("span",[x._v(x._s(x.$t("SamplingMethod")))])]),x._v(" "),T("div",{staticClass:"advanced-settings-item-value"},[T("span",[x._v(x._s(null===(w=x.detailInfo)||void 0===w||null===(w=w.origin_meta)||void 0===w?void 0:w.sampler_name))])])]):x._e()])]),x._v(" "),null!==(k=x.detailInfo)&&void 0!==k&&null!==(k=k.origin_meta)&&void 0!==k&&k.negative_prompt?T("div",{staticClass:"detail-info-prompt"},[T("div",{staticClass:"title"},[T("div",{staticClass:"title-left"},[T("span",[x._v(x._s(x.$t("NegativePrompts")))])]),x._v(" "),T("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:x.$t("ApplyThisCombo"),placement:"top"}},[T("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"recipe-use-negative-prompt"},on:{click:function(e){return x.handleUseParams("negative_prompt")}}})])],1),x._v(" "),T("div",{staticClass:"content"},[x._v("\n          "+x._s(null===(I=x.detailInfo)||void 0===I||null===(I=I.origin_meta)||void 0===I?void 0:I.negative_prompt)+"\n        ")])]):x._e()]),x._v(" "),T("div",{staticClass:"recipe-detail-footer"},[T("div",{staticClass:"recipe-detail-footer-item left-btn",class:{disabled:!x.hasNote},attrs:{"data-id":x.detailInfo.id,"data-event":"model-recipe-detail-note-vitor"},on:{click:x.handleNoteVitor}},[T("i",{staticClass:"iconfont icon-NotebookPen"}),x._v("\n        "+x._s(x.$t("NoteVitor"))+"\n      ")]),x._v(" "),T("div",{staticClass:"recipe-detail-footer-item right-btn",attrs:{"data-id":x.detailInfo.id,"data-event":"model-recipe-detail-remix"},on:{click:x.handleRemix}},[x._v("\n        "+x._s(x.$t("Remix"))+"\n      ")])])])])}),[],!1,null,"7356d202",null);t.default=component.exports},3335:function(e,t,n){"use strict";n.r(t);n(92),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(14),l=n(3),r=n(2),c=(n(20),n(19),n(50),n(49),n(24),n(26),n(3336)),d=n(3337),v=n(3125),m=n(948),h=n(1),f=n(3126),_=n(10),y=n(628);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={components:{Empty:c.default,ChatList:d.default},props:{isShowCreativeAssistant:{type:Boolean,default:!1},currentTab:{type:Object,default:function(){return{}}},calcCost:{type:Number,default:0}},data:function(){return{chatList:[],inputValue:"",currentAssistantMessage:null,isGenerating:!1,chatInstance:null,isComposing:!1,hasMoreData:!0,isLoadingMore:!1,convId:"",next_cursor:"",msgId:"",isShowChatListGoBottomBtn:!1,sendMessageCount:0,streamParser:null,hasllm:!1,hsagen:!1,hasedit:!1,scrollStatusDebounceTimer:null,lastScrollTop:0,scrollDirection:"none",lastScrollTime:0,scrollThreshold:1,userScrollThreshold:2e3,lastUserScrollTime:0,initScrollTimer:null}},computed:w(w({},Object(h.c)("user",["isLoggedIn"])),{},{isGeneratingOrProcessing:function(){return this.isGenerating},sessionId:function(){return Object(_.q)("".concat(this.convId).concat(window.location.href).concat(this.$cookies.get("deviceId")))}}),watch:{isLoggedIn:function(e){this.msgId="",this.next_cursor="",this.convId="",this.hasMoreData=!0,this.isLoadingMore=!1,this.chatList=[],this.currentAssistantMessage=null,this.getSessionTopic()},isShowCreativeAssistant:function(e){e&&this.$xyLogEvent({front_operation:"exposure",entity_name:"image_generation_creation_flow_prompt_assistant_popup",entity_type:"creative-assistant-container"})},isGenerating:function(e){e&&(this.isShowChatListGoBottomBtn=!1,this.scrollStatusDebounceTimer&&(clearTimeout(this.scrollStatusDebounceTimer),this.scrollStatusDebounceTimer=null))}},methods:{loadMore:function(){this.isLoadingMore=!0,this.getSessionHistory(!1)},getSessionTopic:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.c)();case 2:1e4===(n=t.sent).status.code&&(e.convId=(null===(o=n.data)||void 0===o||null===(o=o.conv_items)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.conv_id)||"",e.convId&&e.getSessionHistory(!0));case 4:case"end":return t.stop()}}),t)})))()},getSessionHistory:function(){var e=arguments,t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var l,r,c,d,v,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=!(e.length>0&&void 0!==e[0])||e[0],t.hasMoreData){n.next=3;break}return n.abrupt("return");case 3:return r=null,c=0,d=0,l||(r=document.querySelector(".chat-list-container"))&&(c=r.scrollHeight,d=r.scrollTop),n.next=9,Object(m.b)({conv_id:t.convId,cursor:t.next_cursor,limit:30});case 9:1e4===(v=n.sent).status.code&&(t.isLoadingMore=!1,t.hasMoreData=v.data.has_more,t.next_cursor=v.data.next_cursor,f=Object(y.transformHistoryMessages)(null===(h=v.data)||void 0===h||null===(h=h.messages)||void 0===h?void 0:h.reverse())||[],t.chatList=[].concat(Object(o.a)(f),Object(o.a)(t.chatList)),l?t.scrollToBottom():t.$nextTick((function(){if(r){var e=r.scrollHeight-c;r.scrollTop=d+e}})));case 11:case"end":return n.stop()}}),n)})))()},adjustHeight:function(){var e=this;this.$nextTick((function(){var textarea=e.$refs.promptInput;if(textarea){if(!e.inputValue.trim())return void(textarea.style.height="26px");textarea.style.height="26px";var t=textarea.scrollHeight;t>26&&(textarea.style.height=Math.min(t,124)+"px")}}))},handleCompositionStart:function(){this.isComposing=!0},handleCompositionEnd:function(){this.isComposing=!1},handleEnter:function(e){this.isComposing||(e.preventDefault(),this.sendMessage())},handleShiftEnter:function(e){var t=this;this.$nextTick((function(){t.adjustHeight()}))},validateSendConditions:function(){var e=this;return this.isComposing?(setTimeout((function(){e.sendMessage()}),100),!1):this.inputValue.trim()&&!this.isGeneratingOrProcessing},createUserMessage:function(){var e=Object(y.formatUserMessage)(this.inputValue);this.chatList.push(e)},createTempAssistantMessage:function(){var e=Date.now()+Math.random();return this.currentAssistantMessage=Object(y.formatAssistantMessage)(e,this.$t("generating_now")||"正在生成中...",!0),this.chatList.push(this.currentAssistantMessage),e},createChatConfig:function(){var e=this;return Object(y.createChatConfig)({convId:this.convId,msgId:this.msgId,inputValue:this.inputValue,baseModelType:this.currentTab.base_model_type,onopen:function(t,n){return e.handleSseOpen(t,n)},onmessage:function(data){return e.handleSseMessage(data)},onerror:function(t){return e.handleSseError(t)},onclose:function(){return e.handleSseClose()},retryDelay:2e3,maxRetries:3,disableRetry:!1})},handleSseOpen:function(e,t){this.isLoggedIn||(this.sendMessageCount+=1,localStorage.setItem("sendMessageCount",this.sendMessageCount)),t["x-resp-msg-id"]&&(this.msgId=t["x-resp-msg-id"])},handleSseMessage:function(data){if(this.chatInstance&&this.chatInstance.getConnectionStatus()&&data.choices&&data.choices.length>0){var e=data.choices[0],t=e.delta;this.handleAssistantMessageStart(data,t),this.handleMessageContent(t),this.handleMessageEnd(e)}},handleAssistantMessageStart:function(data,e){var t=this;if(e&&"assistant"===e.role){var n=data.id||Date.now()+Math.random();if(this.currentAssistantMessage&&this.currentAssistantMessage.isTemp){var o=this.chatList.findIndex((function(e){return e.id===t.currentAssistantMessage.id}));-1!==o&&(this.$set(this.chatList[o],"id",n),this.$set(this.chatList[o],"text",""),this.$set(this.chatList[o],"isTemp",!1),this.currentAssistantMessage=this.chatList[o])}else this.currentAssistantMessage||(this.currentAssistantMessage={id:n,text:"",type:"assistant"},this.chatList.push(this.currentAssistantMessage))}},handleMessageContent:function(e){e&&void 0!==e.content&&this.currentAssistantMessage&&""!==e.content&&(this.streamParser||this.initStreamParser(),this.streamParser.processChunk(e.content))},initStreamParser:function(){var e=this;this.streamParser=new f.default((function(t){e.updateMessageContent(t)}),(function(t){e.$nextTick((function(){e.$forceUpdate()}))}),{promptStartMarker:"'''",promptEndMarker:"'''"})},updateMessageContent:function(e){var t=this;if(this.currentAssistantMessage){var n=this.chatList.findIndex((function(e){return e.id===t.currentAssistantMessage.id}));if(-1!==n){if(this.streamParser.hasMultipleParts())this.$set(this.chatList[n],"hasMultipleParts",!0),this.$set(this.chatList[n],"contentParts",Object(o.a)(e)),this.$set(this.chatList[n],"text","");else{var l=e.length>0?e[0].text:"";this.$set(this.chatList[n],"text",l),this.$set(this.chatList[n],"hasMultipleParts",!1),this.$set(this.chatList[n],"contentParts",[])}this.currentAssistantMessage.id===this.chatList[n].id&&(this.currentAssistantMessage=this.chatList[n]),this.$nextTick((function(){setTimeout((function(){t.smartScrollToBottom()}),50)}))}}},isNearBottom:function(){var e=document.querySelector(".chat-list-container");if(!e)return!1;var t=e.scrollTop;return e.scrollHeight-t-e.clientHeight<=200},smartScrollToBottom:function(){this.shouldAutoScroll()&&this.executeScrollToBottom()},executeScrollToBottom:function(){this.$nextTick((function(){var e=document.querySelector(".chat-list-container");if(e)try{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}catch(t){console.error("滚动失败:",t),e.scrollTop=e.scrollHeight}}))},shouldAutoScroll:function(){var e=document.querySelector(".chat-list-container");if(!e)return!1;var t=e.scrollTop,n=e.scrollHeight-t-e.clientHeight,o=Date.now();return!("up"===this.scrollDirection&&o-this.lastUserScrollTime<this.userScrollThreshold)&&(n<=50&&(this.scrollDirection="none"),n<=200&&"up"!==this.scrollDirection)},getScrollDirection:function(){return this.scrollDirection},isAtBottom:function(){var e=document.querySelector(".chat-list-container");if(!e)return!1;var t=e.scrollTop;return e.scrollHeight-t-e.clientHeight<=5},isAtTop:function(){var e=document.querySelector(".chat-list-container");return!!e&&e.scrollTop<=5},getScrollPercentage:function(){var e=document.querySelector(".chat-list-container");if(!e)return 0;var t=e.scrollTop,n=e.scrollHeight-e.clientHeight;return n<=0?0:Math.round(t/n*100)},handleMessageEnd:function(e){"end_turn"===e.finish_reason&&(this.streamParser&&(this.streamParser.finalize(),this.streamParser=null),this.finalizeMessageParsing(),this.currentAssistantMessage=null,this.isGenerating=!1)},finalizeMessageParsing:function(){var e=this;if(this.currentAssistantMessage){var t=this.chatList.findIndex((function(t){return t.id===e.currentAssistantMessage.id}));if(-1!==t){var n=this.chatList[t];if(n.hasMultipleParts&&n.contentParts){var o=Object(y.checkAndUpdatePromptParts)(n.contentParts),l=o.hasChanges,r=o.updatedParts;l&&this.$set(this.chatList,t,w(w({},n),{},{contentParts:r}))}}}},handleSseError:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r={10200:t.$t("ServerError"),2e4:t.$t("task_fail_visitor_system_cancle")},c=r[null==e||null===(o=e.status)||void 0===o?void 0:o.code]||"",2e4===(null==e||null===(l=e.status)||void 0===l?void 0:l.code)&&t.$EventBus.$emit("openLoginDialog",{callBack:function(){t.sendMessageCount=0,localStorage.removeItem("sendMessageCount")}}),!t.streamParser||!t.currentAssistantMessage||t.currentAssistantMessage.isTemp){n.next=14;break}return n.prev=4,t.streamParser.forceFlush(),n.next=8,t.$nextTick();case 8:t.finalizeMessageParsing(),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(4),console.error("处理错误时刷新缓冲数据失败:",n.t0);case 14:t.currentAssistantMessage&&t.currentAssistantMessage.isTemp?-1!==(d=t.chatList.findIndex((function(e){return e.id===t.currentAssistantMessage.id})))&&(t.$set(t.chatList[d],"text",c||t.$t("audioCreateFail")),t.$set(t.chatList[d],"isTemp",!1)):t.currentAssistantMessage||t.chatList.push({id:Date.now()+Math.random(),text:c||t.$t("audioCreateFail"),type:"assistant"}),t.currentAssistantMessage=null,t.isGenerating=!1,t.streamParser&&(t.streamParser=null),t.scrollToBottom();case 19:case"end":return n.stop()}}),n,null,[[4,11]])})))()},handleSseClose:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.streamParser||!e.currentAssistantMessage||e.currentAssistantMessage.isTemp){t.next=11;break}return t.prev=1,e.streamParser.forceFlush(),t.next=5,e.$nextTick();case 5:e.finalizeMessageParsing(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("连接关闭时刷新缓冲数据失败:",t.t0);case 11:e.currentAssistantMessage&&e.currentAssistantMessage.isTemp&&-1!==(n=e.chatList.findIndex((function(t){return t.id===e.currentAssistantMessage.id})))&&(e.$set(e.chatList[n],"text",e.$t("connection_lost")),e.$set(e.chatList[n],"isTemp",!1)),e.currentAssistantMessage=null,e.isGenerating=!1,e.streamParser&&(e.streamParser=null);case 15:case"end":return t.stop()}}),t,null,[[1,8]])})))()},finalizeSend:function(){this.inputValue="",this.adjustHeight(),this.scrollToBottom()},setupChatInstance:function(){this.chatInstance&&this.chatInstance.close(),this.chatInstance=new v.a(this.createChatConfig()),this.chatInstance.connect()},createSession:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.convId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(m.a)();case 4:1e4===(n=t.sent).status.code&&(e.convId=n.data.conv_id);case 6:case"end":return t.stop()}}),t)})))()},sendMessage:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn||!(e.sendMessageCount>0)){t.next=3;break}return e.$EventBus.$emit("openLoginDialog",{callBack:function(){e.sendMessageCount=0,localStorage.removeItem("sendMessageCount"),e.sendMessage()}}),t.abrupt("return");case 3:if(e.validateSendConditions()){t.next=5;break}return t.abrupt("return");case 5:return e.hasllm=!0,t.next=8,e.createSession();case 8:e.isGenerating=!0,e.createUserMessage(),e.createTempAssistantMessage(),e.setupChatInstance(),e.finalizeSend();case 13:case"end":return t.stop()}}),t)})))()},stopGeneration:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.streamParser){t.next=11;break}return t.prev=1,e.streamParser.forceFlush(),t.next=5,e.$nextTick();case 5:e.finalizeMessageParsing(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("处理缓冲数据时出错:",t.t0);case 11:return e.chatInstance&&e.chatInstance.close(),e.currentAssistantMessage&&(e.currentAssistantMessage.isTemp?-1!==(n=e.chatList.findIndex((function(t){return t.id===e.currentAssistantMessage.id})))&&e.chatList.splice(n,1):e.chatList.findIndex((function(t){return t.id===e.currentAssistantMessage.id}))),e.currentAssistantMessage=null,e.isGenerating=!1,e.msgId="",e.streamParser&&(e.streamParser=null),t.next=19,e.$nextTick();case 19:e.scrollToBottom();case 20:case"end":return t.stop()}}),t,null,[[1,8]])})))()},scrollToBottom:function(){this.$nextTick((function(){var e=document.querySelector(".chat-list-container");e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}))},close:function(){var e=this;this.$emit("close"),setTimeout((function(){e.hasllm=!1,e.hsagen=!1,e.hasedit=!1}),100)},handleGeneratePrompt:function(e){this.hsagen=!0,this.$emit("generate-prompt",e)},handleModifyPrompt:function(e){this.hasedit=!0,this.$emit("modify-prompt",e),this.$xyLogEvent({front_operation:"click",entity_name:"immediately_modify",entity_type:"image_generation_creation_flow_prompt_assistant_popup",obj_info:{session_id:this.sessionId}})},handleScrollStatusChange:function(e){var t=this;this.isGenerating?this.isShowChatListGoBottomBtn=!1:(this.scrollStatusDebounceTimer&&clearTimeout(this.scrollStatusDebounceTimer),this.scrollStatusDebounceTimer=setTimeout((function(){t.isGenerating||(t.isShowChatListGoBottomBtn=e)}),150))},handleUserScroll:function(){var e=document.querySelector(".chat-list-container");if(e){var t=e.scrollTop,n=Date.now(),o=t-this.lastScrollTop;Math.abs(o)>this.scrollThreshold&&(o>0?this.scrollDirection="down":(this.scrollDirection="up",this.lastUserScrollTime=n),this.lastScrollTime=n),this.lastScrollTop=t}},initScrollListener:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(t>40)){if(this.$refs.chatList){var n=this.$refs.chatList.$el;if(n)return void n.addEventListener("scroll",this.handleUserScroll)}this.initScrollTimer=setTimeout((function(){e.initScrollListener(t+1)}),100)}}},mounted:function(){var e=this;this.sendMessageCount=localStorage.getItem("sendMessageCount")||0,this.adjustHeight(),this.getSessionTopic(),this.$nextTick((function(){e.initScrollListener()}))},beforeDestroy:function(){this.chatInstance&&this.chatInstance.close(),this.streamParser&&(this.streamParser=null),this.scrollStatusDebounceTimer&&(clearTimeout(this.scrollStatusDebounceTimer),this.scrollStatusDebounceTimer=null);var e=document.querySelector(".chat-list-container");e&&e.removeEventListener("scroll",this.handleUserScroll),clearTimeout(this.initScrollTimer),this.initScrollTimer=null}},I=k,x=(n(4448),n(0)),component=Object(x.a)(I,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"creative-assistant-container",class:{"is-show":e.isShowCreativeAssistant},attrs:{"data-group":"image_generation_creation_flow_prompt_assistant_popup"}},[t("div",{staticClass:"creative-assistant-header"},[t("div",{staticClass:"title"},[t("span",[e._v(e._s(e.$t("CreativeAssistant")))])]),e._v(" "),t("div",{staticClass:"close-btn",attrs:{"data-event":"close_popup","data-info":JSON.stringify({hasllm:e.hasllm,hsagen:e.hsagen,hasedit:e.hasedit})},on:{click:e.close}},[t("i",{staticClass:"iconfont icon-guanbi1"})])]),e._v(" "),t("div",{staticClass:"main-container"},[t("div",{staticClass:"content-container"},[e.chatList.length>0?t("ChatList",{ref:"chatList",attrs:{chatList:e.chatList,hasMoreData:e.hasMoreData,isLoadingMore:e.isLoadingMore,calcCost:e.calcCost,currentTypingId:e.currentAssistantMessage?e.currentAssistantMessage.id:null},on:{"load-more":e.loadMore,"generate-prompt":e.handleGeneratePrompt,"modify-prompt":e.handleModifyPrompt,"scroll-status-change":e.handleScrollStatusChange}}):e._e(),e._v(" "),0===e.chatList.length?t("Empty"):e._e(),e._v(" "),e.isShowChatListGoBottomBtn&&!e.isGenerating?t("div",{staticClass:"chat-list-go-bottom-btn",on:{click:e.scrollToBottom}},[t("i",{staticClass:"iconfont icon-zhankai2"})]):e._e()],1),e._v(" "),t("div",{staticClass:"footer"},[t("form",{staticClass:"input-form",on:{submit:function(t){return t.preventDefault(),e.sendMessage.apply(null,arguments)}}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"promptInput",staticClass:"prompt-input",attrs:{placeholder:e.$t("CreativeAssistant_input_placeholder"),disabled:e.isGeneratingOrProcessing,rows:"1"},domProps:{value:e.inputValue},on:{input:[function(t){t.target.composing||(e.inputValue=t.target.value)},e.adjustHeight],keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.handleEnter.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.shiftKey?t.ctrlKey||t.altKey||t.metaKey?null:e.handleShiftEnter.apply(null,arguments):null}],compositionstart:e.handleCompositionStart,compositionend:e.handleCompositionEnd}}),e._v(" "),e.isGeneratingOrProcessing?t("button",{staticClass:"send-btn",attrs:{type:"button"},on:{click:e.stopGeneration}},[t("i",{staticClass:"iconfont icon-zanting"})]):t("button",{staticClass:"send-btn",class:{disabled:!e.inputValue.trim()||e.isGeneratingOrProcessing},attrs:{type:"submit","data-event":"send_ocon",disabled:!e.inputValue.trim()||e.isGeneratingOrProcessing}},[t("i",{staticClass:"iconfont icon-dibu"})])])])])])}),[],!1,null,"79de7baa",null);t.default=component.exports},3336:function(e,t,n){"use strict";n.r(t);var o={data:function(){return{}}},l=(n(4446),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-container"},[t("i",{staticClass:"iconfont icon-robot"}),e._v(" "),t("p",[e._v(e._s(e.$t("CreativeAssistant_empty_title")))]),e._v(" "),t("span",[e._v(e._s(e.$t("CreativeAssistant_empty_sub")))])])}),[],!1,null,"55cac710",null);t.default=component.exports},3337:function(e,t,n){"use strict";n.r(t);n(19),n(24),n(31),n(4),n(113),n(90),n(92),n(7);var o={props:{chatList:{type:Array,default:function(){return[]}},currentTypingId:{type:[String,Number],default:null},hasMoreData:{type:Boolean,default:!0},isLoadingMore:{type:Boolean,default:!1},calcCost:{type:Number,default:0}},data:function(){return{observer:null,scrollContainer:null}},mounted:function(){this.initIntersectionObserver(),this.initScrollListener()},beforeDestroy:function(){this.destroyObserver(),this.destroyScrollListener()},watch:{chatList:{handler:function(){var e=this;this.$nextTick((function(){e.checkScrollStatus()}))},deep:!0}},methods:{handleGeneratePromptVisibility:function(e,t,n){t&&this.$xyLogEvent({front_operation:"exposure",entity_name:"immediately_generation",entity_type:n,entity_info:String(e.entity_info)})},initIntersectionObserver:function(){var e=this;if(this.$refs.loadMoreSentinel){this.observer=new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&e.hasMoreData&&!e.isLoadingMore&&e.handleLoadMore()}))}),{root:null,rootMargin:"20px",threshold:.1}),this.observer.observe(this.$refs.loadMoreSentinel)}},destroyObserver:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},handleLoadMore:function(){this.$emit("load-more")},isTyping:function(e){return this.currentTypingId===e},isPromptMessage:function(text){return!(!text||"string"!=typeof text)&&(text.startsWith("'''")&&text.endsWith("'''")&&text.length>6)},getPromptContent:function(text){return this.isPromptMessage(text)?text.slice(3,-3).trim():text},getDisplayText:function(e){return void 0!==e.displayText?e.displayText:"prompt"===e.type?this.getPromptContent(e.text):e.text||""},getPromptDisplayText:function(e){return this.getDisplayText(e)},isPromptComplete:function(e){if(!e.isPrompt)return!1;if(this.isTyping(e.id))return!1;var text=e.text||"";return text.startsWith("'''")&&text.endsWith("'''")&&text.length>6},handleGeneratePrompt:function(e){var t=this.getPromptContent(e.text);this.$emit("generate-prompt",t)},handleModifyPrompt:function(e){var t=this.getPromptContent(e.text);this.$emit("modify-prompt",t)},initScrollListener:function(){var e=this;this.scrollContainer=this.$el,this.scrollContainer&&(this.scrollContainer.addEventListener("scroll",this.handleScroll),this.$nextTick((function(){e.checkScrollStatus()})))},destroyScrollListener:function(){this.scrollContainer&&(this.scrollContainer.removeEventListener("scroll",this.handleScroll),this.scrollContainer=null)},handleScroll:function(){this.checkScrollStatus()},checkScrollStatus:function(){if(this.scrollContainer&&0!==this.chatList.length){var e=this.scrollContainer,t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight,l=n>o,r=!(n-t-o<=15)&&this.chatList.length>0&&l;this.$emit("scroll-status-change",r)}else this.$emit("scroll-status-change",!1)}}},l=(n(4447),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"chat-list-container"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasMoreData,expression:"hasMoreData"}],ref:"loadMoreSentinel",staticClass:"load-more-sentinel"},[e.isLoadingMore?t("div",{staticClass:"loading-indicator"},[t("span",{staticClass:"loading-text"},[e._v(e._s(e.$t("Loading"))+"...")])]):e._e()]),e._v(" "),e._l(e.chatList,(function(n,o){return t("div",{key:"".concat(n.id,"-").concat(o),staticClass:"chat-list-item",class:{"user-message":"user"===n.type,"prompt-message":"assistant"===n.type,"has-multiple-parts":n.hasMultipleParts}},[n.hasMultipleParts?t("div",{staticClass:"multi-content"},e._l(n.contentParts,(function(o,l){return t("div",{key:"".concat(n.id,"-part-").concat(l),staticClass:"content-part"},["normal"===o.type?t("div",{staticClass:"normal-part"},[t("div",{staticClass:"message-content"},[e._v(e._s(e.getDisplayText(o)))])]):t("div",{staticClass:"prompt-part"},[t("div",{staticClass:"prompt-header"},[t("span",{staticClass:"prompt-title"},[e._v(e._s(e.$t("recommend_prompt")||"推荐提示词"))])]),e._v(" "),t("div",{staticClass:"prompt-text"},[e._v(e._s(e.getDisplayText(o)))]),e._v(" "),"prompt"===o.type&&o.isComplete&&!n.isTemp?t("div",{staticClass:"prompt-actions"},[t("button",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleGeneratePromptVisibility,expression:"handleGeneratePromptVisibility"}],staticClass:"action-btn",attrs:{"data-event":"immediate_generation","data-index":Number(l),"data-info":JSON.stringify({entity_info:l,cauculate:e.calcCost})},on:{click:function(t){return e.handleGeneratePrompt({text:o.text})}}},[t("i",{staticClass:"iconfont icon-Lightning"}),e._v(" "),t("span",{staticClass:"generate-btn-sub-normal-text"},[e._v(e._s(e.calcCost))]),e._v(" "),t("span",{staticClass:"generate-btn-sub-normal-text-2"},[e._v(e._s(e.$t("oc_generator_btn")||"立即生成"))])]),e._v(" "),t("button",{staticClass:"action-btn",on:{click:function(t){return e.handleModifyPrompt({text:o.text})}}},[t("i",{staticClass:"iconfont icon-edit-03"}),e._v(" "),t("span",{staticClass:"generate-btn-sub-normal-text-2"},[e._v(e._s(e.$t("prompt_modify_btn")||"修改提示词"))])])]):e._e()])])})),0):n.isPrompt?t("div",{staticClass:"prompt-content"},[t("div",{staticClass:"prompt-header"},[t("span",{staticClass:"prompt-title"},[e._v(e._s(e.$t("recommend_prompt")||"推荐提示词"))])]),e._v(" "),t("div",{staticClass:"prompt-text"},[e._v(e._s(e.getPromptContent(n.text)))]),e._v(" "),!n.isTemp&&e.isPromptComplete(n)?t("div",{staticClass:"prompt-actions"},[t("button",{staticClass:"action-btn",on:{click:function(t){return e.handleGeneratePrompt(n)}}},[t("i",{staticClass:"iconfont icon-dibu",staticStyle:{transform:"none"}}),e._v(" "),t("span",[e._v(e._s(e.$t("copilot_generator_btn")||"立即生成"))])]),e._v(" "),t("button",{staticClass:"action-btn",on:{click:function(t){return e.handleModifyPrompt(n)}}},[t("i",{staticClass:"iconfont icon-edit"}),e._v(" "),t("span",[e._v(e._s(e.$t("prompt_modify_btn")||"修改提示词"))])])]):e._e()]):t("div",{staticClass:"message-content"},[e._v(e._s(n.text))])])}))],2)}),[],!1,null,"0d8128f8",null);t.default=component.exports},3338:function(e,t,n){"use strict";n.r(t);n(16),n(21);var o=n(14),l=n(2),r=n(3),c=(n(20),n(19),n(11),n(6),n(22),n(31),n(18),n(12),n(13),n(8),n(4),n(7),n(426)),d=n(3339),v=n(3340),m=n(46),h=n(324),f=n(161),_=n(145),y=n(25);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"VideoInspirationLibrary",components:{InspirationDetail:d.default,InfiniteScrollLoad:c.default,PreviewVideo:v.default},mixins:[_.a],emits:["useParams","RecipeRemix"],props:{modelData:{type:Object,default:function(){}}},watch:{modelKey:function(e){this.renderKey++,this.visible&&e&&(this.$refs.recipeDetail.closeModal(),this.filterObj={order_by:"hot",model_gen_opts:[""]},this.resetInitState(),this.getModelRecipeList()),this.visible=!1,this.scrollPosition=0,this.isFirstLoad=!0}},computed:{modelKey:function(){return"".concat(this.modelData.art_model_no||"").concat(this.modelData.art_model_ver_no||"")}},data:function(){return{visible:!1,timeList:[{label:this.$t("blog_all"),value:"hot"},{label:this.$t("months"),value:"month_hot"},{label:this.$t("week"),value:"week_hot"},{label:this.$t("days"),value:"day_hot"}],compositionList:[{label:this.$t("blog_all"),value:""},{label:this.$t("OnlyShowWithLora"),value:"lora"}],modelRecipeList:[],hasMore:!0,limit:20,loading:!1,nextCursor:"",filterObj:{order_by:"hot",model_gen_opts:[""]},renderKey:0,isFirstLoad:!0,scrollPosition:0,maxConcurrentLoads:6,loadingQueue:[],loadedQueue:[]}},methods:{handleVideoLoading:function(){var e=this,t=this.modelRecipeList.filter((function(i){return!e.loadedQueue.includes(i.id)})).slice(0,this.maxConcurrentLoads),n=Object(y.cloneDeep)(this.loadingQueue);t.forEach((function(e){n.push(e.id)})),this.loadingQueue=n},handleVideoLoaded:function(e){this.loadedQueue.push(e.id),this.loadingQueue=this.loadingQueue.filter((function(t){return t!==e.id})),this.handleVideoLoading()},showModal:function(){var e=this;this.isFirstLoad&&(this.resetInitState(),this.isFirstLoad=!1,this.getModelRecipeList()),this.visible?this.closeModal():(this.$xyLogEvent({front_operation:"exposure",entity_name:"create-video-model-inspiration-popover",entity_type:"inspiration_library_aiVideo",obj_desc:"aiVideo"}),this.visible=!0,this.$nextTick((function(){e.$refs.infiniteScroll&&(e.$refs.infiniteScroll.$el.scrollTop=e.scrollPosition)})))},closeModal:function(e){var t=this;if(this.$refs.infiniteScroll){var n=this.$refs.infiniteScroll.$el;this.scrollPosition=n.scrollTop}var o=function(){t.visible=!1,t.filterObj={order_by:"hot",model_gen_opts:[""]},t.$refs.recipeDetail.closeModal()};e?o():this.visible&&this.$refs.recipeDetail.visible?(this.$refs.recipeDetail.closeModal(),this.$nextTick((function(){t.$refs.infiniteScroll&&(t.$refs.infiniteScroll.$el.scrollTop=t.scrollPosition)}))):o()},getModelRecipeList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasMore&&!e.loading&&e.visible){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,t.next=5,Object(m.getModelRecipe)({model_id:e.modelData.art_model_no,model_ver_id:e.modelData.art_model_ver_no,limit:e.limit,cursor:e.nextCursor,order_by:e.filterObj.order_by,model_gen_opts:e.filterObj.model_gen_opts,scene:"video"}).finally((function(){e.loading=!1}));case 5:1e4===(n=t.sent).status.code&&(l=n.data.items.map((function(e){return w(w({},e),{},{curr_page:n.data.curr_page})})),e.modelRecipeList=[].concat(Object(o.a)(e.modelRecipeList),Object(o.a)(l)),e.hasMore=n.data.has_more,e.nextCursor=n.data.next_cursor,e.handleVideoLoading());case 7:case"end":return t.stop()}}),t)})))()},handleCreateRecipe:function(e){this.$emit("RecipeRemix",e)},handleRecipeItemClick:function(e){this.$refs.recipeDetail.showModal(e.id)},handleFilter:function(e,t){var n=this;this.renderKey++,{order_by:function(){n.filterObj.order_by=e},model_gen_opts:function(){n.filterObj.model_gen_opts=[e]}}[t](),this.$refs.recipeDetail.closeModal(),this.resetInitState(),this.getModelRecipeList()},handleResetFilter:function(){this.filterObj={order_by:"hot",model_gen_opts:[""]},this.resetInitState(),this.getModelRecipeList()},resetInitState:function(){this.loading=!1,this.hasMore=!0,this.nextCursor="",this.modelRecipeList=[],this.loadingQueue=[],this.loadedQueue=[]},clearCache:function(){this.resetInitState(),this.isFirstLoad=!0},handleUseParams:function(e){this.$emit("useParams",e)},assembleParams:function(e){var t,n,l,r,c,d,v,m=(null==e?void 0:e.used_models.map((function(e){return w(w({},e),{},{id:e.id,name:e.name,banner:e.banner,model_type:e.model_type})})))||[],h=[];(null!=e&&null!==(t=e.origin_meta)&&void 0!==t&&null!==(t=t.controlnet_units)&&void 0!==t&&t.length&&(null==e||e.origin_meta.controlnet_units.forEach((function(e){h.push({mode:"ctr_net",image:{url:e.input_image},ctr_net_cond:e})}))),null!=e&&null!==(n=e.origin_meta)&&void 0!==n&&null!==(n=n.init_images)&&void 0!==n&&n.length&&(null==e||e.origin_meta.init_images.forEach((function(e){h.push({mode:"img2img",image:{url:e}})}))),null!=e&&null!==(l=e.origin_meta)&&void 0!==l&&null!==(l=l.lab_base)&&void 0!==l&&null!==(l=l.conds)&&void 0!==l&&l.length)&&(null==e||null===(v=e.origin_meta)||void 0===v||null===(v=v.lab_base)||void 0===v||v.conds.forEach((function(e){h.push({mode:"StyleReference"===e.mode?"style_ref":"ImagePrompt"===e.mode?"img2img":"ip_maintain",image:{url:e.image}})})));return{title:"",cover:{url:null==e||null===(r=e.cover)||void 0===r?void 0:r.url,width:null==e||null===(c=e.cover)||void 0===c?void 0:c.width,height:null==e||null===(d=e.cover)||void 0===d?void 0:d.height},artwork_id:null==e?void 0:e.id,used_models:Object(o.a)(m),meta:{cfg_scale:e.origin_meta.cfg_scale,clip_skip:e.origin_meta.clip_skip,width:e.origin_meta.width,height:e.origin_meta.height,negative_prompt:e.origin_meta.negative_prompt,prompt:e.origin_meta.prompt,sampler_name:e.origin_meta.sampler_name,steps:e.origin_meta.steps,vae:e.origin_meta.vae,use_image_conditions:h}}},handleNoteVitor:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(m.getModelRecipeDetail)({id:e});case 2:1e4===(o=n.sent).status.code&&(l=o.data,r=Object(f.a)({render:function(e){return e(h.default,{props:{params:t.assembleParams(l),saveParams:w(w({},l),{},{meta:w({},l.origin_meta)})},on:{close:function(){r.close()},save:function(){r.close()}}})}}));case 4:case"end":return n.stop()}}),n)})))()}},beforeDestroy:function(){this.resetInitState()}},I=(n(4452),n(4453),n(0)),component=Object(I.a)(k,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{"popper-class":"model-recipe-popover",placement:"right","visible-arrow":!1,width:"328",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"model-recipe",attrs:{"data-group":"model-recipe"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{staticClass:"model-recipe-title"},[t("span",[e._v(e._s(e.$t("RecipeLibrary")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1",on:{click:e.closeModal}})]),e._v(" "),t("div",{staticClass:"model-recipe-content"},[t("div",{staticClass:"model-recipe-content-operation"},[t("el-popover",{staticClass:"model-recipe-filter-popover",attrs:{placement:"bottom-start",width:"240",trigger:"hover"}},[t("div",{staticClass:"filter-popover-content"},[t("div",{staticClass:"filter-popover-content-item"},[t("span",{staticClass:"filter-popover-content-item-label"},[e._v(e._s(e.$t("Time")))]),e._v(" "),t("div",{staticClass:"filter-popover-content-item-list"},e._l(e.timeList,(function(n){return t("div",{key:"generate-video-inspiration-library-time-"+n.value,staticClass:"filter-popover-content-item-list-item",class:{active:e.filterObj.order_by===n.value},attrs:{"data-id":n.value,"data-event":"video-model-inspiration-filter-time","data-desc":"aiVideo"},on:{click:function(t){return e.handleFilter(n.value,"order_by")}}},[e.filterObj.order_by===n.value?t("i",{staticClass:"iconfont icon-icon-event-confirm"}):e._e(),e._v("\n                  "+e._s(n.label)+"\n                ")])})),0)]),e._v(" "),t("div",{staticClass:"filter-popover-content-item"},[t("span",{staticClass:"filter-popover-content-item-label"},[e._v(e._s(e.$t("Composition")))]),e._v(" "),t("div",{staticClass:"filter-popover-content-item-list"},e._l(e.compositionList,(function(n){return t("div",{key:"generate-video-inspiration-library-composition-"+n.value,staticClass:"filter-popover-content-item-list-item",class:{active:e.filterObj.model_gen_opts.includes(n.value)},attrs:{"data-id":n.value,"data-event":"video-model-inspiration-filter-composition","data-desc":"aiVideo"},on:{click:function(t){return e.handleFilter(n.value,"model_gen_opts")}}},[e.filterObj.model_gen_opts.includes(n.value)?t("i",{staticClass:"iconfont icon-icon-event-confirm"}):e._e(),e._v("\n                  "+e._s(n.label)+"\n                ")])})),0)]),e._v(" "),t("div",{staticClass:"model-recipe-filter-reset",on:{click:e.handleResetFilter}},[e._v("\n              "+e._s(e.$t("resetSelection"))+"\n            ")])]),e._v(" "),t("div",{staticClass:"model-recipe-filter",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"model-recipe-filter-item"},[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("div",{staticClass:"model-recipe-filter-arrow"})])])],1),e._v(" "),t("InfiniteScrollLoad",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:"generate-video-inspiration-library-"+e.renderKey,ref:"infiniteScroll",style:{height:"calc(100vh - 240px)"},attrs:{autoLoad:!1,noMore:!e.hasMore,showNoMore:!1},on:{"load-more":e.getModelRecipeList}},[e.modelRecipeList.length?t("div",{staticClass:"model-recipe-list",attrs:{"data-event":"video-model-inspiration-list","data-desc":"aiVideo"}},e._l(e.modelRecipeList,(function(n,o){var l,r;return t("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibility,expression:"handleVisibility"}],key:"generate-video-inspiration-library-"+n.id,staticClass:"model-recipe-item",attrs:{"data-id":n.id,"data-index":o,"data-pt":n.curr_page,"data-event":"video-model-inspiration-item","data-desc":"aiVideo","data-info":JSON.stringify({id:n.id,index:o,obj_pt:String(n.curr_page)})},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRecipeItemClick(n)}}},[null!=n&&null!==(l=n.cover)&&void 0!==l&&l.video?t("PreviewVideo",{attrs:{"video-src":null==n||null===(r=n.cover)||void 0===r?void 0:r.video,alt:(null==n?void 0:n.title)||"",isLoading:e.loadingQueue.includes(n.id),isLoaded:e.loadedQueue.includes(n.id)},on:{loaded:function(t){return e.handleVideoLoaded(n,o)},error:function(t){return e.handleVideoLoaded(n,o)}}}):e._e(),e._v(" "),t("div",{staticClass:"btn-box"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("Remix"),placement:"top"}},[t("div",{staticClass:"remix-btn",attrs:{"data-id":n.id,"data-index":o,"data-pt":n.curr_page,"data-event":"video-model-inspiration-remix","data-info":JSON.stringify({id:n.id,index:o,obj_pt:String(n.curr_page)}),"data-desc":"aiVideo"},on:{click:function(t){return t.stopPropagation(),e.handleCreateRecipe(n.id)}}},[e._v("\n                  Remix\n                ")])])],1)],1)})),0):t("div",{staticClass:"empty-box"},[t("div",{staticClass:"empty-box-text"},[e._v(e._s(e.$t("noMoreRecipe")))])])])],1)]),e._v(" "),t("InspirationDetail",{ref:"recipeDetail",attrs:{"base-model-type":e.modelData.base_model_type},on:{useParams:e.handleUseParams,remix:e.handleCreateRecipe}})],1)}),[],!1,null,"5f574d58",null);t.default=component.exports;installComponents(component,{InfiniteScrollLoad:n(426).default})},3339:function(e,t,n){"use strict";n.r(t);n(18);var o=n(3),l=(n(20),n(6),n(32),n(16),n(769),n(65),n(4),n(43),n(21),n(10)),r=n(46),c=n(162),d=n(99),v={name:"VideoInspirationDetail",props:{baseModelType:{type:String,default:""}},data:function(){return{visible:!1,loading:!1,dataId:"",detailInfo:{},prompt:"",isTranslate:!1,translateLoading:!1}},computed:{imageList:function(){var e;return(null===(e=this.detailInfo)||void 0===e||null===(e=e.origin_meta)||void 0===e||null===(e=e.generate_video)||void 0===e?void 0:e.image_opts)||[]},modelList:function(){var e;return(null===(e=this.detailInfo)||void 0===e||null===(e=e.used_models)||void 0===e?void 0:e.filter((function(e){return"Checkpoint"!==e.model_type})))||[]},hasNote:function(){var e;return null===(e=this.detailInfo)||void 0===e||null===(e=e.action_capability)||void 0===e||null===(e=e.permission)||void 0===e?void 0:e.find((function(e){return"supportMetaNote"===e.val}))},getCurrentBaseModelType:function(){var e=this.baseModelType||"",t=Object(d.getCurrentModelType)(e);return t||"sd"}},methods:{isNotNil:function(e){return null!=e},showModal:function(e){this.dataId=e,this.visible||(this.visible=!0,this.$xyLogEvent({front_operation:"exposure",entity_name:"create-video-model-inspiration-detail-popover",entity_type:"inspiration_library_aiVideo",obj_desc:"aiVideo"})),this.isTranslate=!1,this.getRecipeDetail(e)},closeModal:function(){this.visible=!1,this.detailInfo={},this.prompt="",this.isTranslate=!1,this.translateLoading=!1},getRecipeDetail:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.next=3,Object(r.getModelRecipeDetail)({id:e});case 3:1e4===(null==(l=n.sent)||null===(o=l.status)||void 0===o?void 0:o.code)&&(t.detailInfo=l.data,t.prompt=l.data.origin_meta.prompt),t.loading=!1;case 6:case"end":return n.stop()}}),n)})))()},handleCopyPrompt:function(){Object(l.g)(this.prompt),this.$message.success(this.$t("CopySuccess"))},handleTranslatePrompt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isTranslate&&e.prompt){t.next=4;break}return e.prompt=(null===(n=e.detailInfo)||void 0===n||null===(n=n.origin_meta)||void 0===n?void 0:n.prompt)||"",e.isTranslate=!1,t.abrupt("return");case 4:return e.isTranslate=!e.isTranslate,e.translateLoading=!0,o=e.$i18n.locale,l={zhCN:"zh-cn",zhTW:"zh-tw"}[o]||o,t.next=11,Object(c.a)(e.prompt,{to:l});case 11:r=t.sent,e.prompt=r.text,e.translateLoading=!1;case 14:case"end":return t.stop()}}),t)})))()},handleOriginMeta:function(){var e,t=null===(e=this.detailInfo)||void 0===e?void 0:e.origin_meta,n={width:t.width,height:t.height,seed:t.seed};return 0===n.width&&delete n.width,0===n.height&&delete n.height,{params:n,paramsType:"AdvancedConfig"}},handleUseParams:function(e){var t=this,n={prompt:function(){return{params:t.prompt,paramsType:"Prompt"}},used_models:function(){return{params:t.modelList,paramsType:"Lora"}},origin_meta:function(){return t.handleOriginMeta()},negative_prompt:function(){var e;return{params:null===(e=t.detailInfo)||void 0===e||null===(e=e.origin_meta)||void 0===e?void 0:e.negative_prompt,paramsType:"NegativePrompt"}},image_opts:function(){return{params:t.imageList,paramsType:"ImageOptions"}}};this.$emit("useParams",n[e]())},handleRemix:function(){this.$emit("remix",this.detailInfo.id)},formatWeight:function(e){if(Number.isInteger(e))return e;var t=e.toString();return t.includes(".")?t.split(".")[1].length<=2?parseFloat(t):parseFloat(e.toFixed(2)):e},handleModelClick:function(e){e&&window.open("/models/detail/".concat(e),"_blank")}}},m=(n(4449),n(4450),n(0)),component=Object(m.a)(v,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y,C=this,w=C._self._c;return w("el-popover",{ref:"recipeDetailPopover",staticClass:"recipe-detail-popover",attrs:{"popper-class":"model-recipe-popover recipe-detail-popover",placement:"right","visible-arrow":!1,width:"450",trigger:"manual"},model:{value:C.visible,callback:function(e){C.visible=e},expression:"visible"}},[w("div",{staticClass:"recipe-detail-popover-content",attrs:{"data-group":"recipe-detail-popover-content"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[w("div",{staticClass:"recipe-detail-title"},[w("span",[C._v(C._s(C.$t("RecipeLibrary")))]),C._v(" "),w("i",{staticClass:"iconfont icon-guanbi1",on:{click:function(e){C.visible=!1}}})]),C._v(" "),w("div",{directives:[{name:"loading",rawName:"v-loading",value:C.loading,expression:"loading"}],staticClass:"recipe-detail-content"},[w("div",{staticClass:"detail-img-box"},[null!==(e=C.detailInfo)&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.video?[w("video",{attrs:{src:null===(t=C.detailInfo)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.video,poster:null===(n=C.detailInfo)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url,autoplay:"",muted:"",loop:""},domProps:{muted:!0}})]:[null!==(o=C.detailInfo)&&void 0!==o&&null!==(o=o.cover)&&void 0!==o&&o.url?w("el-image",{attrs:{src:null===(l=C.detailInfo)||void 0===l||null===(l=l.cover)||void 0===l?void 0:l.url,"preview-src-list":[null===(r=C.detailInfo)||void 0===r||null===(r=r.cover)||void 0===r?void 0:r.url],fit:"contain"}}):C._e()]],2),C._v(" "),C.imageList.length?w("div",{staticClass:"detail-info-image-opts"},[w("div",{staticClass:"title"},[w("div",{staticClass:"title-left"},[w("span",[C._v(C._s(C.$t("ImageOptions")))])]),C._v(" "),w("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:C.$t("ApplyThisCombo"),placement:"top"}},[w("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"video-model-inspiration-image-opts","data-event":"video-model-inspiration-detail-image-opts","data-name":"model-recipe-detail_add","data-desc":"aiVideo"},on:{click:function(e){return C.handleUseParams("image_opts")}}})])],1),C._v(" "),w("div",{staticClass:"content"},C._l(C.imageList,(function(e){return w("el-image",{key:"generate-video-inspiration-detail-image-"+e.url,attrs:{src:e.url,"preview-src-list":[e.url],fit:"contain"}})})),1)]):C._e(),C._v(" "),C.prompt?w("div",{staticClass:"detail-info-prompt"},[w("div",{staticClass:"title"},[w("div",{staticClass:"title-left"},[w("span",[C._v(C._s(C.$t("Prompt")))]),C._v(" "),w("i",{staticClass:"iconfont icon-codeCopy1",on:{click:C.handleCopyPrompt}}),C._v(" "),w("i",{staticClass:"iconfont icon-i18n_prompt",on:{click:C.handleTranslatePrompt}})]),C._v(" "),w("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:C.$t("ApplyThisCombo"),placement:"top"}},[w("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"video-model-inspiration-prompt","data-event":"video-model-inspiration-detail-prompt","data-name":"model-recipe-detail_add","data-desc":"aiVideo"},on:{click:function(e){return C.handleUseParams("prompt")}}})])],1),C._v(" "),w("div",{staticClass:"content"},[C._v("\n          "+C._s(C.translateLoading?"":C.prompt)+"\n          "),C.translateLoading?w("div",{staticClass:"loading-icon"},[w("span"),C._v(" "),w("span"),C._v(" "),w("span"),C._v(" "),w("span"),C._v(" "),w("span"),C._v(" "),w("span")]):C._e()])]):C._e(),C._v(" "),C.modelList.length?w("div",{staticClass:"detail-info-models module-box"},[w("div",{staticClass:"title"},[w("div",{staticClass:"title-left"},[w("span",[C._v("Lora")])]),C._v(" "),w("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:C.$t("ApplyThisCombo"),placement:"top"}},[w("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"video-model-inspiration-lora","data-event":"video-model-inspiration-detail-lora","data-name":"model-recipe-detail_add","data-desc":"aiVideo"},on:{click:function(e){return C.handleUseParams("used_models")}}})])],1),C._v(" "),w("div",{staticClass:"content"},C._l(C.modelList,(function(e){var t;return w("div",{key:"generate-video-inspiration-detail-model-"+e.id,staticClass:"lora-item",on:{click:function(t){return C.handleModelClick(e.id)}}},[w("div",{staticClass:"model-cover"},[w("img",{attrs:{src:null==e||null===(t=e.banner)||void 0===t?void 0:t.url,alt:"model-cover"}}),C._v(" "),C.isNotNil(null==e?void 0:e.weight)?w("div",{staticClass:"model-tag"},[C._v(C._s(C.formatWeight(e.weight)))]):C._e()]),C._v(" "),w("div",{staticClass:"model-desc"},[w("div",{staticClass:"model-type"},[C._v("\n                "+C._s("TextualInversion"===(null==e?void 0:e.model_type)?"Embedding":"LoCon"===(null==e?void 0:e.model_type)?"LyCORIS":null==e?void 0:e.model_type)+"\n              ")]),C._v(" "),w("div",{staticClass:"model-name"},[C._v(C._s(e.name))])])])})),0)]):C._e(),C._v(" "),w("div",{staticClass:"detail-info-advanced-settings module-box"},[w("div",{staticClass:"title"},[w("div",{staticClass:"title-left"},[w("span",[C._v(C._s(C.$t("AdvancedConfig")))])])]),C._v(" "),w("div",{staticClass:"content"},[null!==(c=C.detailInfo)&&void 0!==c&&null!==(c=c.cover)&&void 0!==c&&c.width&&null!==(d=C.detailInfo)&&void 0!==d&&null!==(d=d.cover)&&void 0!==d&&d.height?w("div",{staticClass:"advanced-settings-item"},[w("div",{staticClass:"advanced-settings-item-label"},[w("span",[C._v(C._s(C.$t("Size")))])]),C._v(" "),w("div",{staticClass:"advanced-settings-item-value"},[w("span",[C._v(C._s(null===(v=C.detailInfo)||void 0===v||null===(v=v.cover)||void 0===v?void 0:v.width)+" x "+C._s(null===(m=C.detailInfo)||void 0===m||null===(m=m.cover)||void 0===m?void 0:m.height))])])]):C._e(),C._v(" "),C.isNotNil(null===(h=C.detailInfo)||void 0===h||null===(h=h.origin_meta)||void 0===h?void 0:h.seed)?w("div",{staticClass:"advanced-settings-item"},[w("div",{staticClass:"advanced-settings-item-label"},[w("span",[C._v(C._s(C.$t("RandomSeed")))])]),C._v(" "),w("div",{staticClass:"advanced-settings-item-value"},[w("span",[C._v(C._s(null===(f=C.detailInfo)||void 0===f||null===(f=f.origin_meta)||void 0===f?void 0:f.seed))])])]):C._e()])]),C._v(" "),null!==(_=C.detailInfo)&&void 0!==_&&null!==(_=_.origin_meta)&&void 0!==_&&_.negative_prompt?w("div",{staticClass:"detail-info-prompt"},[w("div",{staticClass:"title"},[w("div",{staticClass:"title-left"},[w("span",[C._v(C._s(C.$t("NegativePrompts")))])]),C._v(" "),w("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:C.$t("ApplyThisCombo"),placement:"top"}},[w("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"video-model-inspiration-negative-prompt","data-event":"video-model-inspiration-detail-negative-prompt","data-name":"model-recipe-detail_add","data-desc":"aiVideo"},on:{click:function(e){return C.handleUseParams("negative_prompt")}}})])],1),C._v(" "),w("div",{staticClass:"content"},[C._v("\n          "+C._s(null===(y=C.detailInfo)||void 0===y||null===(y=y.origin_meta)||void 0===y?void 0:y.negative_prompt)+"\n        ")])]):C._e()]),C._v(" "),w("div",{staticClass:"recipe-detail-footer"},[w("div",{staticClass:"recipe-detail-footer-item right-btn",attrs:{"data-id":C.detailInfo.id,"data-event":"video-model-inspiration-detail-remix","data-name":"model-recipe-detail-remix","data-desc":"aiVideo"},on:{click:C.handleRemix}},[C._v("\n        "+C._s(C.$t("Remix"))+"\n      ")])])])])}),[],!1,null,"adfaef84",null);t.default=component.exports},3340:function(e,t,n){"use strict";n.r(t);n(18),n(24),n(26);var o={name:"PreviewVideo",props:{videoSrc:{type:String,required:!0},alt:{type:String,default:""},autoLoadDelay:{type:Number,default:100},isLoading:{type:Boolean,default:!1},isLoaded:{type:Boolean,default:!1}},data:function(){return{loadDelayTimeout:null}},computed:{isWaiting:function(){return!this.isLoading&&!this.isLoaded}},methods:{cleanup:function(){if(this.loadDelayTimeout&&(clearTimeout(this.loadDelayTimeout),this.loadDelayTimeout=null),this.$refs.videoEl){var video=this.$refs.videoEl;video.paused||video.pause()}},handleCanPlay:function(){var e=this;console.log("视频可以播放了:",{videoSrc:this.videoSrc}),this.loadDelayTimeout=setTimeout((function(){e.loadDelayTimeout&&(e.$emit("loaded"),e.loadDelayTimeout=null)}),this.autoLoadDelay)},handleVideoPlay:function(e){if(!this.isLoading&&!this.isWaiting){var video=e.target;video.paused&&video.play().catch((function(e){"AbortError"!==e.name&&console.warn("Video play error:",e)})),this.$emit("play",e)}},handleVideoPause:function(e){if(!this.isLoading&&!this.isWaiting){var video=e.target;video.paused||video.pause(),this.$emit("pause",e)}}},beforeDestroy:function(){this.cleanup()}},l=(n(4451),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"preview-video-wrapper"},[e.isWaiting?t("div",{staticClass:"video-waiting"},[e._m(0),e._v(" "),t("div",{staticClass:"waiting-text"},[e._v(e._s(e.$t("waiting")))])]):e.isLoading?t("div",{staticClass:"video-loading"},[t("div",{staticClass:"loading-spinner"}),e._v(" "),t("div",{staticClass:"loading-text"},[e._v(e._s(e.$t("loading")))])]):e._e(),e._v(" "),e.isWaiting?e._e():t("div",{staticClass:"video-container",class:{loaded:e.isLoaded}},[t("video",{ref:"videoEl",attrs:{src:e.videoSrc,alt:e.alt,muted:"",loop:"",preload:"metadata"},domProps:{muted:!0},on:{canplay:e.handleCanPlay,mouseenter:e.handleVideoPlay,mouseleave:e.handleVideoPause}})])])}),[function(){var e=this._self._c;return e("div",{staticClass:"waiting-icon"},[e("i",{staticClass:"iconfont icon-shipin"})])}],!1,null,"c9ec69f6",null);t.default=component.exports},3341:function(e,t,n){"use strict";n.r(t);var o=n(2),l=n(14),r=n(3),c=(n(20),n(11),n(19),n(6),n(22),n(12),n(13),n(8),n(4),n(7),n(426)),d=n(3342),v=n(292),m=n(145),h=n(903),f=n(241);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={name:"MusicInspirationLibrary",components:{InspirationDetail:d.default,InfiniteScrollLoad:c.default,LocalAudioPlayer:h.a},inject:["easyTop"],mixins:[m.a],emits:["useParams","RecipeRemix"],props:{},watch:{modelKey:function(e){this.renderKey++,this.visible&&e&&(this.$refs.recipeDetail.closeModal(),this.resetInitState(),this.getModelRecipeList()),this.visible=!1,this.scrollPosition=0,this.isFirstLoad=!0}},computed:{modelKey:function(){return""}},data:function(){return{visible:!1,modelRecipeList:[],hasMore:!0,page:1,page_size:20,loading:!1,renderKey:0,isFirstLoad:!0,scrollPosition:0}},methods:{showModal:function(){var e=this;this.renderKey++,this.isFirstLoad&&(this.resetInitState(),this.isFirstLoad=!1,this.getModelRecipeList()),this.visible?this.closeModal():(this.$xyLogEvent({front_operation:"exposure",entity_name:"create-music-model-inspiration-popover",entity_type:"inspiration_library_aiMusic",obj_category:"aiMusic"}),this.visible=!0,this.$nextTick((function(){e.$refs.infiniteScroll&&(e.$refs.infiniteScroll.$el.scrollTop=e.scrollPosition)})))},closeModal:function(e){var t=this;if(f.a.stopAllExcept(),this.$refs.infiniteScroll){var n=this.$refs.infiniteScroll.$el;this.scrollPosition=n.scrollTop}var o=function(){t.visible=!1,t.$refs.recipeDetail.closeModal()};e?o():this.visible&&this.$refs.recipeDetail.visible?(this.$refs.recipeDetail.closeModal(),this.$nextTick((function(){t.$refs.infiniteScroll&&(t.$refs.infiniteScroll.$el.scrollTop=t.scrollPosition)})),console.log(this.scrollPosition)):o()},getModelRecipeList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasMore&&!e.loading&&e.visible){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,t.next=5,Object(v.b)({page:e.page,page_size:e.page_size}).finally((function(){e.loading=!1}));case 5:1e4===(n=t.sent).status.code&&(e.modelRecipeList=[].concat(Object(l.a)(e.modelRecipeList),Object(l.a)(n.data.items.map((function(e){var t;return y(y({},e),{},{info:(null===(t=e.components)||void 0===t?void 0:t[0])||{}})})))),e.hasMore=n.data.has_more,e.hasMore&&e.page++);case 7:case"end":return t.stop()}}),t)})))()},handleCreateRecipe:function(e){this.$emit("RecipeRemix",e)},handleRecipeItemClick:function(e){this.$refs.recipeDetail.showModal(e)},resetInitState:function(){this.loading=!1,this.hasMore=!0,this.page=1,this.modelRecipeList=[]},clearCache:function(){this.resetInitState(),this.isFirstLoad=!0},handleUseParams:function(e){this.$emit("useParams",e)}},beforeDestroy:function(){this.resetInitState()}},w=(n(4457),n(4458),n(0)),component=Object(w.a)(C,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{"popper-class":"music-model-recipe-popover",placement:"right","visible-arrow":!1,width:"328",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"model-recipe",attrs:{"data-group":"music-model-recipe"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{staticClass:"model-recipe-title"},[t("span",[e._v(e._s(e.$t("RecipeLibrary")))]),e._v(" "),t("i",{staticClass:"iconfont icon-guanbi1",on:{click:e.closeModal}})]),e._v(" "),t("div",{staticClass:"model-recipe-content"},[t("InfiniteScrollLoad",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:"generate-video-inspiration-library-"+e.renderKey,ref:"infiniteScroll",style:{height:"calc(100vh - 240px)"},attrs:{autoLoad:!1,noMore:!e.hasMore,showNoMore:!1},on:{"load-more":e.getModelRecipeList}},[e.modelRecipeList.length?t("div",{staticClass:"model-recipe-list",attrs:{"data-event":"music-model-recipe-list"}},e._l(e.modelRecipeList,(function(n,o){var l;return t("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibility,expression:"handleVisibility"}],key:"generate-video-inspiration-library-"+n.id,staticClass:"model-recipe-item",attrs:{"data-id":n.id,"data-index":o,"data-event":"music-model-inspiration-item","data-info":JSON.stringify({id:n.id,cindex:o})},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRecipeItemClick(n)}}},[t("img",{attrs:{src:null==n||null===(l=n.info)||void 0===l?void 0:l.cover_url,alt:""}}),e._v(" "),t("div",{staticClass:"local-audio-player-box"},[t("LocalAudioPlayer",{attrs:{data:n.info},on:{click:function(e){e.stopPropagation()}}})],1),e._v(" "),t("div",{staticClass:"btn-box"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("Remix"),placement:"top"}},[t("div",{staticClass:"remix-btn",attrs:{"data-id":n.id,"data-index":o,"data-event":"music-model-inspiration-remix","data-info":JSON.stringify({id:n.id,index:o,pt:1}),"data-type":"aiMusic"},on:{click:function(t){return t.stopPropagation(),e.handleCreateRecipe(n)}}},[e._v("\n                  Remix\n                ")])])],1)])})),0):t("div",{staticClass:"empty-box"},[t("div",{staticClass:"empty-box-text"},[e._v(e._s(e.$t("noMoreRecipe")))])])])],1)]),e._v(" "),t("InspirationDetail",{ref:"recipeDetail",on:{useParams:e.handleUseParams,remix:e.handleCreateRecipe}})],1)}),[],!1,null,"1c870f2c",null);t.default=component.exports;installComponents(component,{InfiniteScrollLoad:n(426).default})},3342:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(8),n(10)),r=n(162),c={name:"MusicInspirationDetail",props:{},data:function(){return{timeFormat:l.U,visible:!1,loading:!1,detailInfo:{},prompt:"",isTranslate:!1,translateLoading:!1,lyric:"",isLyricTranslate:!1,lyricTranslateLoading:!1}},computed:{},methods:{showModal:function(e){var t;console.log(e),this.detailInfo=e||{},this.lyric=(null===(t=this.detailInfo)||void 0===t?void 0:t.prompt)||"";try{var n;this.prompt=JSON.parse(null===(n=this.detailInfo)||void 0===n?void 0:n.attr).prompt}catch(e){this.prompt=""}this.visible||(this.visible=!0,this.$xyLogEvent({front_operation:"exposure",entity_name:"create-music-model-inspiration-detail-popover",entity_type:"inspiration_library_aiMusic",obj_category:"aiMusic"})),this.isTranslate=!1,this.isLyricTranslate=!1},closeModal:function(){this.visible=!1,this.detailInfo={},this.prompt="",this.isTranslate=!1,this.translateLoading=!1,this.lyric="",this.isLyricTranslate=!1,this.lyricTranslateLoading=!1},handleCopyPrompt:function(e){Object(l.g)(e),this.$message.success(this.$t("CopySuccess"))},handleTranslatePrompt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isTranslate&&e.prompt){t.next=4;break}try{e.prompt=JSON.parse(null===(n=e.detailInfo)||void 0===n?void 0:n.attr).prompt}catch(t){e.prompt=""}return e.isTranslate=!1,t.abrupt("return");case 4:return e.isTranslate=!e.isTranslate,e.translateLoading=!0,o=e.$i18n.locale,l={zhCN:"zh-cn",zhTW:"zh-tw"}[o]||o,t.next=11,Object(r.a)(e.prompt,{to:l});case 11:c=t.sent,e.prompt=c.text,e.translateLoading=!1;case 14:case"end":return t.stop()}}),t)})))()},handleTranslateLyric:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isLyricTranslate&&e.lyric){t.next=4;break}return e.lyric=(null===(n=e.detailInfo)||void 0===n?void 0:n.prompt)||"",e.isLyricTranslate=!1,t.abrupt("return");case 4:return e.isLyricTranslate=!e.isLyricTranslate,e.lyricTranslateLoading=!0,o=e.$i18n.locale,l={zhCN:"zh-cn",zhTW:"zh-tw"}[o]||o,t.next=11,Object(r.a)(e.lyric,{to:l});case 11:c=t.sent,e.lyric=c.text,e.lyricTranslateLoading=!1;case 14:case"end":return t.stop()}}),t)})))()},handleUseParams:function(e){var t=this,n={prompt:function(){return{params:t.prompt,paramsType:"Prompt"}},lyric:function(){return{params:t.lyric,paramsType:"Lyric"}}};this.$emit("useParams",n[e]())},handleRemix:function(){this.$emit("remix",this.detailInfo)}}},d=(n(4454),n(4455),n(0)),component=Object(d.a)(c,(function(){var e,t,n,o,l,r,c=this,d=c._self._c;return d("el-popover",{ref:"recipeDetailPopover",staticClass:"recipe-detail-popover",attrs:{"popper-class":"model-recipe-popover recipe-detail-popover",placement:"right","visible-arrow":!1,width:"450",trigger:"manual"},model:{value:c.visible,callback:function(e){c.visible=e},expression:"visible"}},[d("div",{staticClass:"recipe-detail-popover-content",attrs:{"data-group":"music-recipe-detail-popover-content"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[d("div",{staticClass:"recipe-detail-title"},[d("span",[c._v(c._s(c.$t("RecipeLibrary")))]),c._v(" "),d("i",{staticClass:"iconfont icon-guanbi1",on:{click:function(e){c.visible=!1}}})]),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.loading,expression:"loading"}],staticClass:"recipe-detail-content"},[d("div",{staticClass:"detail-img-box"},[null!==(e=c.detailInfo)&&void 0!==e&&null!==(e=e.info)&&void 0!==e&&e.cover_url?[d("img",{attrs:{src:null===(t=c.detailInfo)||void 0===t||null===(t=t.info)||void 0===t?void 0:t.cover_url,alt:""}})]:[null!==(n=c.detailInfo)&&void 0!==n&&null!==(n=n.cover)&&void 0!==n&&n.url?d("el-image",{attrs:{src:null===(o=c.detailInfo)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.url,"preview-src-list":[null===(l=c.detailInfo)||void 0===l||null===(l=l.cover)||void 0===l?void 0:l.url],fit:"contain"}}):c._e()]],2),c._v(" "),c.lyric?d("div",{staticClass:"detail-info-prompt"},[d("div",{staticClass:"title"},[d("div",{staticClass:"title-left"},[d("span",[c._v(c._s(c.$t("song_lyric")))]),c._v(" "),d("i",{staticClass:"iconfont icon-codeCopy1",on:{click:function(e){return c.handleCopyPrompt(c.lyric)}}}),c._v(" "),d("i",{staticClass:"iconfont icon-i18n_prompt",on:{click:c.handleTranslateLyric}})]),c._v(" "),d("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:c.$t("ApplyThisCombo"),placement:"top"}},[d("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"music-model-inspiration-lyric","data-event":"music-model-inspiration-detail-lyric","data-name":"model-recipe-detail_add","data-type":"aiMusic"},on:{click:function(e){return c.handleUseParams("lyric")}}})])],1),c._v(" "),d("div",{staticClass:"content"},[d("div",{staticClass:"lyric-content-box",domProps:{innerHTML:c._s(c.lyricTranslateLoading?"":c.lyric)}}),c._v(" "),c.lyricTranslateLoading?d("div",{staticClass:"loading-icon"},[d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span")]):c._e()])]):c._e(),c._v(" "),c.prompt?d("div",{staticClass:"detail-info-prompt"},[d("div",{staticClass:"title"},[d("div",{staticClass:"title-left"},[d("span",[c._v(c._s(c.$t("songstyle")))]),c._v(" "),d("i",{staticClass:"iconfont icon-codeCopy1",on:{click:function(e){return c.handleCopyPrompt(c.prompt)}}}),c._v(" "),d("i",{staticClass:"iconfont icon-i18n_prompt",on:{click:c.handleTranslatePrompt}})]),c._v(" "),d("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:c.$t("ApplyThisCombo"),placement:"top"}},[d("i",{staticClass:"iconfont icon-add-icon",attrs:{"data-id":"music-model-inspiration-prompt","data-event":"music-model-inspiration-detail-prompt","data-name":"model-recipe-detail_add","data-type":"aiMusic"},on:{click:function(e){return c.handleUseParams("prompt")}}})])],1),c._v(" "),d("div",{staticClass:"content"},[c._v("\n          "+c._s(c.translateLoading?"":c.prompt)+"\n          "),c.translateLoading?d("div",{staticClass:"loading-icon"},[d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span"),c._v(" "),d("span")]):c._e()])]):c._e(),c._v(" "),d("div",{staticClass:"detail-info-advanced-settings module-box"},[d("div",{staticClass:"title"},[d("div",{staticClass:"title-left"},[d("span",[c._v(c._s(c.$t("AdvancedConfig")))])])]),c._v(" "),d("div",{staticClass:"content"},[d("div",{staticClass:"advanced-settings-item"},[d("div",{staticClass:"advanced-settings-item-label"},[d("span",[c._v(c._s(c.$t("Duration")))])]),c._v(" "),d("div",{staticClass:"advanced-settings-item-value"},[d("span",[c._v(c._s(c.timeFormat((null===(r=c.detailInfo)||void 0===r||null===(r=r.info)||void 0===r?void 0:r.duration)||0)))])])])])])]),c._v(" "),d("div",{staticClass:"recipe-detail-footer"},[d("div",{staticClass:"recipe-detail-footer-item right-btn",attrs:{"data-id":c.detailInfo.id,"data-event":"music-model-inspiration-detail-remix","data-name":"model-recipe-detail-remix","data-type":"aiMusic"},on:{click:c.handleRemix}},[c._v("\n        "+c._s(c.$t("Remix"))+"\n      ")])])])])}),[],!1,null,"73fe83a0",null);t.default=component.exports},3343:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),l=n(2),r=(n(20),n(4),n(113),n(128)),c=n(39),d=n(1),v=n(78);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"NewVersionNoticeModal",data:function(){return{visible:!1,newVersionNoticeModelInfo:{}}},computed:h(h(h({},Object(d.c)("user",["userInfo","isCompanyAccount","isLoggedIn"])),Object(d.e)("payment",["paymentInfo"])),{},{isVideo:function(){var e,t=(null===(e=this.newVersionNoticeModelInfo)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url)||"";return t.toLowerCase().endsWith(".mp4")||t.toLowerCase().endsWith(".webm")}}),mounted:function(){this.getNewVersionNoticeModel()},methods:{checkIsOpen:function(){var e=this;return new Promise((function(t,n){var o,l;if((null===(o=e.paymentInfo)||void 0===o?void 0:o.activeState)||(null===(l=e.paymentInfo)||void 0===l?void 0:l.liteActiveState)||e.isCompanyAccount||!e.isLoggedIn)return t(!1);Object(c.g)({type:0}).then((function(e){var n=null==e?void 0:e.data;t(n)})).catch((function(e){t(!1)}))}))},getIsOpenStats:function(){var e;return!!(null===v.b||void 0===v.b||null===(e=v.b.storage)||void 0===e?void 0:e.isPopupShownToday(null===v.a||void 0===v.a?void 0:v.a.HALF_PRICE))},getNewVersionNoticeModel:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,c,d,v,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.userInfo)&&void 0!==n&&n.id){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(r.c)({source:13});case 4:if(l=t.sent,1e4!==(null===(o=l.status)||void 0===o?void 0:o.code)){t.next=17;break}if(v=(null===(c=l.data)||void 0===c?void 0:c.task_guide)||{},e.newVersionNoticeModelInfo=v,!v.showed_video_guide||null===(d=v.banner)||void 0===d||!d.url){t.next=17;break}return t.next=11,e.checkIsOpen();case 11:if(m=t.sent,e.getIsOpenStats()||!m){t.next=15;break}return t.abrupt("return");case 15:e.$logEvent("log_actions",{operation:"create_flow_guide_show",behavior_info:"on_create_flow_guide_popup"}),e.visible=!0;case 17:case"end":return t.stop()}}),t)})))()},closeNewVersionNoticeModel:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.a)(e);case 2:case"end":return t.stop()}}),t)})))()},resetData:function(){this.visible=!1,this.newVersionNoticeModelInfo={}},handleClose:function(e){var t=1===e?"click_exit":"click_cancel";this.$logEvent("log_actions",{operation:t,behavior_info:"on_create_flow_guide_popup"}),this.closeNewVersionNoticeModel({source:13,behavior:"enterPage"}),this.resetData()},handleConfirm:function(){var e,t;this.$logEvent("log_actions",{operation:"click_confirm",behavior_info:"on_create_flow_guide_popup"}),this.closeNewVersionNoticeModel({source:13,behavior:"enterPage"}),this.$emit("confirm",{portalParams:{targetTab:"generateVideo",id:null===(e=this.newVersionNoticeModelInfo)||void 0===e?void 0:e.model_id,model_ver_no:null===(t=this.newVersionNoticeModelInfo)||void 0===t?void 0:t.model_ver_no}}),this.resetData()}}},_=(n(4460),n(0)),component=Object(_.a)(f,(function(){var e,t,o=this,l=o._self._c;return l("el-dialog",{attrs:{visible:o.visible,"custom-class":"easy-new-version-notice-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,modal:!0,"modal-append-to-body":"","append-to-body":"",width:"492px"},on:{"update:visible":function(e){o.visible=e}}},[l("div",{staticClass:"easy-new-version-notice-modal-body"},[l("div",{staticClass:"easy-new-version-notice-modal-header"},[o.isVideo?[l("video",{staticClass:"easy-new-version-notice-modal-header-video",attrs:{src:null===(e=o.newVersionNoticeModelInfo)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url,autoplay:"",loop:"",muted:"",playsinline:""},domProps:{muted:!0}})]:[l("img",{staticClass:"easy-new-version-notice-modal-header-img",attrs:{src:null===(t=o.newVersionNoticeModelInfo)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url,alt:""}})],o._v(" "),l("span",{staticClass:"modal-header-close",on:{click:function(e){return e.stopPropagation(),o.handleClose(1)}}},[l("i",{staticClass:"el-icon-close"})])],2),o._v(" "),l("div",{staticClass:"easy-new-version-notice-modal-content"},[l("div",{staticClass:"easy-new-version-notice-modal-content-title"},[l("img",{attrs:{src:n(541),alt:""}}),o._v(" "),l("span",{staticClass:"easy-new-version-notice-modal-content-title-text"},[o._v(o._s(o.$t("newGenerate25")))])]),o._v(" "),l("div",{staticClass:"easy-new-version-notice-modal-content-sub-title"},[o._v("\n        "+o._s(o.$t("new_generate_tip1"))+"\n      ")]),o._v(" "),l("div",{staticClass:"easy-new-version-notice-modal-content-footer"},[l("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(e){return e.stopPropagation(),o.handleConfirm.apply(null,arguments)}}},[o._v("\n          "+o._s(o.$t("sketch_btn"))+"\n        ")])])])])])}),[],!1,null,null,null);t.default=component.exports},3397:function(e,t,n){"use strict";n.r(t);n(11),n(72),n(18),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=n(3),r=(n(20),n(128));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={data:function(){return{modelInfo:{}}},mounted:function(){this.getRecommendModel()},methods:{getRecommendModel:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,c,v,m,h,f,_;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.c)({source:1});case 2:1e4===(n=t.sent).status.code&&(e.modelInfo=n.data.task_guide,null!==e.modelInfo.banner&&(e.modelInfo=d(d({},e.modelInfo),{},{name:null!==(o=null!==(l=null===(c=e.modelInfo)||void 0===c?void 0:c.title[e.$i18n.locale])&&void 0!==l?l:null===(v=e.modelInfo)||void 0===v||null===(v=v.title)||void 0===v?void 0:v.title)&&void 0!==o?o:"",description:null!==(m=null!==(h=null===(f=e.modelInfo)||void 0===f?void 0:f.desc[e.$i18n.locale])&&void 0!==h?h:null===(_=e.modelInfo)||void 0===_||null===(_=_.desc)||void 0===_?void 0:_.title)&&void 0!==m?m:""})),e.modelInfo.showed_video_guide&&null!==e.modelInfo.banner&&(e.$emit("open"),e.$logEvent("log_actions",{operation:"video_generate_popup",behavior_info:"on_video_generate_popup"})));case 4:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(r.a)({source:1,behavior:"enterPage"}),e.$emit("close");case 2:case"end":return t.stop()}}),t)})))()},handleCreate:function(){this.$logEvent("log_actions",{operation:"click_create",behavior_info:"on_video_generate_popup"}),this.close(),this.$emit("create",this.modelInfo)}}},m=(n(5468),n(0)),component=Object(m.a)(v,(function(){var e,t,n,o=this,l=o._self._c;return l("div",{staticClass:"model-popover-content"},[l("div",{staticClass:"model-popover-content-title"},[l("span",{staticClass:"model-popover-content-title-text"},[o._v(o._s(null===(e=o.modelInfo)||void 0===e?void 0:e.name))]),o._v(" "),l("i",{staticClass:"iconfont icon-guanbi1",on:{click:o.close}})]),o._v(" "),l("div",{staticClass:"model-popover-content-body"},[l("div",{staticClass:"model-popover-content-body-item"},[l("span",{staticClass:"model-popover-content-body-item-text"},[o._v(o._s(null===(t=o.modelInfo)||void 0===t?void 0:t.description))])]),o._v(" "),l("div",{staticClass:"model-popover-content-body-item"},[l("img",{staticClass:"model-popover-content-body-item-img",attrs:{src:null===(n=o.modelInfo.banner)||void 0===n?void 0:n.url}})]),o._v(" "),l("div",{staticClass:"model-popover-content-body-item",on:{click:o.handleCreate}},[l("div",{staticClass:"generate-btn"},[o._v(o._s(o.$t("Generate")))])])])])}),[],!1,null,"9df30c68",null);t.default=component.exports},3441:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13);var o=n(14),l=n(3),r=n(2),c=(n(20),n(19),n(32),n(22),n(18),n(24),n(65),n(8),n(4),n(28),n(140),n(44),n(7),n(26),n(1)),d=n(80),v=n(1243),m=n(1234),h=n(1235),f=n(1236),_=n(1237),y=n(1238),C=n(1239),w=n(1240),k=n(1241),I=n(1242),x=n(402),T=n(412),S=n(626),O=n(27),P=n(35),M=n.n(P);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D={name:"CodeViewer",mixins:[x.a],inject:["top"],props:{codeViewData:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},isCreate:{type:Boolean,default:!1},templateId:{type:String,default:""},loading:{type:Boolean,default:!1},isShowPrevite:{type:Boolean,default:!1},source:{type:Number,default:0},workFlowTabList:{type:Array,default:function(){return[]}},currentWorkFlow:{type:Object,default:function(){}}},components:{InputField:v.default,ImageField:m.default,CheckpointField:h.default,LoraField:f.default,SliderField:_.default,SelectField:y.default,SeedField:C.default,VideoField:w.default,AudioField:k.default,PreviteSwitchEle:T.a,PopularFastApp:I.default,SwitchWorkFlowApp:S.default},data:function(){return{debounceGenerate:function(){},isGenerating:!1,storagekey:"ai_app_field_guest",index:0,isHavePendingTask:!1}},computed:$($($({},Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("payment",["paymentInfo"])),{},{getCodeStyle:function(){return{height:this.height}},getComponentsStyle:function(){return{height:this.isCreate?"calc(100% - 68px)":"100%"}},isShowConsume:function(){var e;return 4==(null===(e=this.top)||void 0===e||null===(e=e.workFlowAppData)||void 0===e||null===(e=e.permission)||void 0===e?void 0:e.source)},isShowEstimateCoins:function(){var e=this.top||{},data=e.workFlowTabList[e.workFlowIndex];return 0!==(null==data?void 0:data.estimateCoins)},getEstimatedCost:function(){var e=this.codeViewData.find((function(e){var t=e.field,n=e.node_type;return"model"==t&&"SeaArtSD3"==n}));return"sd3-turbo"==(null==e?void 0:e.val)?30:45},getEstimateCoins:function(){var e;if(null!==(e=this.top)&&void 0!==e&&e.workFlowAppData){var t,n,o=this.top||{},l=o.workFlowTabList,r=o.workFlowIndex,c=o.workFlowList,d=l[r]||{},v=d.labels,m=d.estimateCoins,h=(null==c||null===(t=c[r])||void 0===t?void 0:t.inputs)||[],f=0;return null!=h&&h.length&&h.forEach((function(e){f+=e.estimateCoins||0})),{estimate_coins:f||m||0,discount:(null==v||null===(n=v[0])||void 0===n||null===(n=n.match(/^.*?%/))||void 0===n?void 0:n[0])||""}}return{estimate_coins:0,discount:""}},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount}}),watch:{isLoggedIn:function(){this.handleGuestStorageField(),this.handlePending()},codeViewData:{handler:function(e){var t=this;this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.itemsComponentRef)||void 0===e||e.scrollTo({top:0,behavior:"smooth"})}))}}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.debounceGenerate=e.handleGenerate,e.handleGuestStorageField(),t.prev=2,t.next=5,e.loadCaptcha();case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(2);case 9:case"end":return t.stop()}}),t,null,[[2,7]])})))()},beforeDestroy:function(){this.debounceGenerate=function(){}},methods:{handlePending:function(){this.isHavePendingTask&&this.isLoggedIn&&(this.isHavePendingTask=!1,this.handleGenerate())},changeWorkflow:function(e){this.index=e,this.$emit("changeWorkflow",e)},handleGuestStorageField:function(){var e=this;if(this.isLoggedIn){var t=this.$route.params.id,n=localStorage.getItem("".concat(this.storagekey)),l=n?JSON.parse(n):{},r=[];for(var c in l){var d=M()(l[c])||[];r.push.apply(r,Object(o.a)(d)),delete l[c]}for(var v=function(){var input=e.codeViewData[i],n=input.node_id,o=input.node_type,l=r.find((function(e){return t===e.id&&e.nodeId===n&&e.nodeType===o}));if(!l||input.val)return 1;e.$set(input,"val",l.url)},i=0;i<this.codeViewData.length;i++)v();this.saveGuestStorageField(r.map((function(e){return{category:e.category,url:e.url,width:e.width,height:e.height}})),!0)}},saveGuestStorageField:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=e&&e.length){var o={items:e};Object(O.b)(o).then((function(){n&&localStorage.removeItem("".concat(t.storagekey))}))}},fieldMap:function(){var e=this,t=this.$createElement;return this.codeViewData.map((function(n){var o=n.type,l=n.node_id,r=n.node_type,c=n.field,d="".concat(e.index,"_").concat(l,"_").concat(r,"_").concat(c),I=[t(v.default,{class:"item-component",attrs:{itemData:n,index:e.index,currentWorkFlow:e.currentWorkFlow},key:d}),t(m.default,{class:"item-component",attrs:{itemData:n,storagekey:e.storagekey,index:e.index,currentWorkFlow:e.currentWorkFlow},on:{uploadSuccess:e.saveGuestStorageField},key:d}),t(h.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d}),t(f.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d}),t(_.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d}),t(y.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d}),t(C.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},ref:"seedField",key:d}),t(w.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d}),t(k.default,{class:"item-component",attrs:{itemData:n,currentWorkFlow:e.currentWorkFlow},key:d})];return(null==I?void 0:I[o-1])||""}))},checkAllFields:function(){var e=this;return new Promise((function(t,n){for(var o=[],l=!0,r=function(){var t=e.codeViewData[i],n=t.field,r=t.node_id,c=t.node_type,d=t.val,v=t.value_type,title=t.title;if(!d)return l=!1,setTimeout((function(){e.$message.warning(e.$t("collectCreate11",{name:"[".concat(title,"]")}))}),100*i),1;switch(v){case 1:d+="";break;case 2:d=Number(Math.round(d));break;case 3:d=Number(d)}o.push({field:n,node_id:r,node_type:c,val:d})},i=0;i<e.codeViewData.length;i++)r();l?t(o):n()}))},handleGenerate:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,l,r,c,v,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isGenerating){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.checkAllFields();case 4:return c=t.sent,e.isGenerating=!0,t.next=8,e.updateCaptcha("cmfy_app");case 8:v=(null==e?void 0:e.templateId)||"",(null===(n=e.$refs)||void 0===n||null===(n=n.seedField)||void 0===n?void 0:n.isRandom)&&(null===(l=e.$refs)||void 0===l||null===(l=l.seedField)||void 0===l||l.changeSeedMode("random")),m={apply_id:v,inputs:c,ver_no:1==e.index?null===(r=e.workFlowTabList)||void 0===r||null===(r=r[1])||void 0===r?void 0:r.verNo:void 0},e.captchaToken&&(m.g_recaptcha_token=e.captchaToken),e.isLoggedIn||(m.g_mode=1,e.$logEvent("log_actions",{operation:"click_generate",behavior_info:"on_swift_ai_detail_page",behavior_info_sub:"guest_visit"})),e.$logEvent("log_actions",{operation:"click_generate",behavior_info:"on_new_create_flow_page"}),m.task_flow_version="v2",40001===e.source&&(m.source=40001,m.channel_id=e.$route.query.project_id),Object(d.f)(m).then((function(t){var n,l=t.data,r=l.id,c=l.scene,d=void 0===c?"":c,code=t.status.code,m={70010:["showBreakDialog","VipTip","basic"],70039:["showVipComputingDialog","vipDialogComputedTit2",{fromVideo:"video_task_generate"===d}],80008:e.isVip?["showVipComputingDialog","",{fromVideo:"video_task_generate"===d}]:["showNotVipComputingDialog"]};if(code&&m[code])(n=e.$EventBus).$emit.apply(n,Object(o.a)(m[code]));else if(1e4===code&&e.$message.success(e.$t("CreateSuccess")),r){var h,f=[{id:r,process:0,components:[],expiration_time:0,deduction_detail:{},status_desc:"waiting",status:1,creativity:{name:null===(h=e.top)||void 0===h||null===(h=h.workFlowAppData)||void 0===h?void 0:h.name,id:v},task_domain_type:2,create_at:Date.now(),speed_type:e.isVip?2:1}];e.$emit("createTask",f)}})).catch((function(t){2e4==t.code&&(e.isHavePendingTask=!0)})).finally((function(){e.isGenerating=!1}));case 17:case"end":return t.stop()}}),t)})))()}},render:function(){var e,t,n,o,l,r,c=this,d=arguments[0],v=d("el-tooltip",{class:"item",attrs:{effect:"dark",content:this.$t("workFlow31"),placement:"top"}},[d("span",{class:"el-icon-question generate-tips"})]),m=d("div",{class:"estimated-cost"},["(",this.$t("expend"),": ",this.getEstimatedCost," ",this.$t("coin"),")"]),h=d("div",{class:"estimate-coins"},[this.getEstimateCoins.discount?d("span",{class:"estimate-coins-sub"},[d("i",{class:"iconfont icon-trail-fast-queue estimate-coins-sub-icon"}),d("span",{class:"estimate-coins-sub-delete-text"},[(this.getEstimateCoins.estimate_coins/(1-parseFloat(this.getEstimateCoins.discount.replace("%",""))/100)).toFixed(2)]),d("span",{class:"estimate-coins-sub-normal-text"},[this.getEstimateCoins.estimate_coins])]):d("span",["(",this.$t("estimatedCost"),":",this.getEstimateCoins.estimate_coins,")"])]),f=function(e,text){var t={free:"free-guest-mode-badge",discount:"discount-badge"};return d("span",{class:t[e]},[d("span",{class:"".concat(t[e],"-text")},[text])])},_=d("div",{class:"generate-btn-wrapper",attrs:{"data-event":"ai-app-detail-generate-btn","data-group":"create-ai-app-detail","data-id":"".concat(null===(e=this.currentWorkFlow)||void 0===e?void 0:e.id,"@").concat(null===(t=this.currentWorkFlow)||void 0===t?void 0:t.ver_no),"data-desc":"创作流ai应用创作按钮"}},[d("el-button",{class:"generate-btn flex-center",on:{click:this.debounceGenerate},attrs:{loading:this.isGenerating}},[(l=((null===(o=c.top)||void 0===o?void 0:o.workFlowAppData)||{}).is_free_guest_mode,r=c.getEstimateCoins.discount,d("div",{class:"flex-center"},[l&&f("free",c.$t("blog_try")),c.isLoggedIn&&r&&f("discount","".concat(r," Off")),d("span",{class:"txt"},[c.$t("Generate")]),c.isLoggedIn&&!c.isShowConsume&&(c.isShowEstimateCoins?h:v)])),this.isLoggedIn&&this.isShowConsume&&m])]);return d("div",{class:"code-viewer",style:this.getCodeStyle,directives:[{name:"loading",value:this.loading}]},[d("div",{class:"items-component width-height-hundred",ref:"itemsComponentRef",style:this.getComponentsStyle},[this.workFlowTabList.length>1&&d(S.default,{attrs:{tabList:this.workFlowTabList},on:{change:this.changeWorkflow},model:{value:c.index,callback:function(e){c.index=e}}}),d(T.a,{attrs:{isShowPrevite:this.isShowPrevite},class:"previte-switch"}),this.fieldMap(),d(I.default,{attrs:{info:null==this||null===(n=this.top)||void 0===n||null===(n=n.value)||void 0===n?void 0:n.categoryInfo}})]),this.isCreate&&_])}},j=D,E=(n(4354),n(0)),component=Object(E.a)(j,undefined,undefined,!1,null,"50f69ac2",null);t.default=component.exports},363:function(e,t,n){"use strict";n.r(t);var o={components:{NodeTips:n(182).default},props:{itemData:{type:Object,default:function(){}},title:{type:String,default:""},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{isOpen:!0,scrollHeight:0,isTextEllipsis:!1}},mounted:function(){this.checkTextEllipsis(),this.updateScrollHeight()},computed:{getStyle:function(){return{maxHeight:this.isOpen?"".concat(this.scrollHeight+20,"px"):"0px",padding:this.isOpen?"10px 0":"0px",borderTop:this.isOpen?"1px solid rgba(255, 255, 255, 0.06)":"0"}}},methods:{handleClick:function(){this.isOpen=!this.isOpen,this.updateScrollHeight()},updateScrollHeight:function(){var e=this;this.$nextTick((function(){var t;e.scrollHeight=(null===(t=e.$refs.content)||void 0===t?void 0:t.scrollHeight)||0}))},checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.titleRef;t&&(e.isTextEllipsis=t.scrollWidth>t.clientWidth)}))}}},l=(n(4332),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"collapse-components"},[t("div",{staticClass:"collapse-components-top",on:{click:e.handleClick}},[t("div",{staticClass:"collapse-components-top-left"},[t("el-tooltip",{attrs:{content:e.title,placement:"top",disabled:!e.isTextEllipsis,"open-delay":300}},[t("span",{ref:"titleRef",staticClass:"collapse-components-top-left-title overflow-ellipsis"},[e._v(e._s(e.title))])]),e._v(" "),t("NodeTips",{attrs:{itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}})],1),e._v(" "),t("i",{staticClass:"el-icon-arrow-down collapse-components-top-icon",class:{"is-open":e.isOpen}})]),e._v(" "),t("div",{ref:"content",staticClass:"collapse-components-content",style:e.getStyle},[e._t("default")],2)])}),[],!1,null,"3a9c7ba6",null);t.default=component.exports},3908:function(e,t,n){"use strict";n(1591)},4006:function(e,t,n){"use strict";n(1651)},4007:function(e,t,n){"use strict";n(1652)},4054:function(e,t,n){"use strict";n(1695)},406:function(e,t,n){"use strict";n.r(t);n(4);var o=n(128),l={name:"changeVerNew",props:["item","disabled","base_models"],data:function(){return{show:!1,list:[],loading:!1}},watch:{show:{handler:function(e){var t=this,n=!(this.list||[]).some((function(e){var n;return(null==e?void 0:e.id)===(null===(n=t.item)||void 0===n?void 0:n.id)}));if(e&&n){if(this.loading)return;this.loading=!0,this.list=[];var l={model_id:this.item.id};this.base_models&&(l.base_models=this.base_models),Object(o.g)(l).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.list=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[])})).finally((function(){t.loading=!1}))}}}},methods:{selectItem:function(e){this.$emit("selectItem",e),this.show=!1},openPopup:function(){this.show=!0},closePopup:function(){this.show=!1}}},r=(n(4092),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("el-popover",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closePopup,expression:"closePopup"}],attrs:{placement:"bottom",trigger:"click","visible-arrow":!1,disabled:e.disabled},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"verList"},e._l(e.list,(function(n,o){return t("div",{key:o,on:{click:function(t){return e.selectItem(n)}}},[e._v(e._s(n.version_no))])})),0),e._v(" "),t("div",{staticClass:"change-ver-new",attrs:{slot:"reference"},on:{click:function(e){e.stopPropagation()}},slot:"reference"},[t("span",[e._v(e._s(e.item.version_name))]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])}),[],!1,null,"634e0931",null);t.default=component.exports},4061:function(e,t,n){"use strict";n(1702)},4062:function(e,t,n){"use strict";n(1703)},4063:function(e,t,n){"use strict";n(1704)},4064:function(e,t,n){"use strict";n(1705)},4065:function(e,t,n){"use strict";n(1706)},407:function(e,t,n){"use strict";n.r(t);var o=n(14),l=(n(19),n(16),n(22),n(18),n(11),n(72),n(89),n(69),n(31),n(12),n(13),n(28),n(43),n(120)),r=n(3),c=n(2),d=(n(20),n(6),n(32),n(50),n(398),n(122),n(49),n(399),n(185),n(8),n(4),n(177),n(21),n(40),n(152),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(7),n(41),n(33)),v=n(9),m=n(3266),h=n(859),f=n(3275),_=n(1),y=n(25),C=n(63),w=n(45),k=n(3121),I=n(138),x=n(253),T=n(52),S=n(239),O=n(474),P=n(36),M=n(27),L=n(56),$=n(71),D=n(861),j=n(862),E=n(863),A=n(3279),N=n(860),V=n(3280),R=n(3281),F=n(145),B=n(864),U=n(865),G=n(99),z=n(10),W=["ord"];function H(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return K(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?K(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function K(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q={name:"CombinedSelectionDialog",mixins:[w.a,k.countPointMixIn,F.a],provide:function(){return{CombinedSelectionDialog:this}},inject:{easyTop:{default:null}},components:{ModelItemDes:E.default,RecentlyItem:A.default,NoData:N.default,SquareList:m.default,ModelItem:j.default,FastAppItem:D.default,FilterModel:V.default,FilterFastApp:R.default,comfyItem:O.a,CollectPopover:C.default,modelPayNum:I.default,changeVer:x.default,SwiperList:T.default,LenovoInput:S.default,CombinedSelectionSearch:f.default,CombinedSelectionLenovoSearch:h.default,HyBannerCard:B.default,HyVidepEffectsPop:U.default},props:{checkedId:{type:String,default:""},source:{type:String,default:"CreativeFlow"},subSource:{type:String,default:""},baseModelType:{type:String,default:""},instanceId:{type:String,default:""},baseModelList:{type:Array,default:function(){return[]}}},data:function(){return{baseModels:[],baseModelMap:{},curCategoryId:"",isClearCurTagFromSearch:!1,customTabType:null,hideScroll2:!1,scrollTop:0,pageConfigCache:null,pageConfigCacheTimestamp:null,pageConfigUpdateData:null,mockFeaturesTagObj:{content_type:"6",id:"features",i18nKey:"Recommend",type:"custom_tag"},myQueryParams:{model:{order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},videoModel:{order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},imgModel:{order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},aiApp:{order_by:"new",publish_status:0,comfy_ui_type:2},loraImgModel:{order_by:"new",publish_status:0,model_types:["LORA","DoRA","LoCon","TextualInversion"],base_models:this.ADDITION_MODEL_TYPES},loraVideoModel:{order_by:"new",publish_status:0,model_types:["LORA","DoRA","LoCon","TextualInversion"],base_models:this.ADDITION_MODEL_TYPES}},collectCommonParams:{order_by:"new",start_at:0,end_at:0,after:0,artwork_types:[],model_types:["Checkpoint"]},collectQueryParams:{model:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),videoModel:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),imgModel:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),aiApp:X({type:"bookmarks",time_to:0,source_type:8},this.collectCommonParams)},itemScroll:null,list:[],visible:!1,pageConfig:[{name:"Collect",id:"collect",showTab:!0,content_type:"collect"},{name:"Mine",id:"mine",showTab:!0,content_type:"mine"}],categoryOption:[{content_type:"videoModel",i18nKey:"motivatingTitle1",id:"videoModel"},{content_type:"imgModel",i18nKey:"motivatingTitle1",id:"imgModel"},{content_type:"aiApp",i18nKey:"aiapply",id:"aiApp"}],pageLoading:!1,hasMore:!0,pageInfo:{page:1,page_size:35,total:0},debounceHandleScroll:null,gridNum:6,modalWidth:"1326px",myTab:"model",realTab:"features",activeTabDynamicTitle:"",keyword:"",dynamicListMap:{modelList:P.getModelSquare,modelRecommend:P.getModelSquareRecommend,characterList:P.getCharacterSquare,characterRecommend:P.getCharacterSquareRecommend,recent:P.getRecentSquare,fastAppList:P.getFastAppSquare,follow:P.getModelSquareAttention},additionModelTypes:[{label:"LORA",value:"LORA"}]}},watch:{keyword:{handler:function(e){this.curCategoryId=""},immediate:!0},isOpenCombinedDialog:{handler:function(e){var t=this;this.instanceId&&this.instanceId!==this.currentDialogInstanceId||this.$nextTick((function(){e?t.openModal():t.handleClose()}))},immediate:!0},visible:{handler:function(e){e||(this.curCategoryId="",this.isClearCurTagFromSearch=!1,this.sessionID="",this.$refs.squareList&&(this.$refs.squareList.relatedSearchWords=[],this.$refs.squareList.currentTagId=""))},immediate:!0}},computed:X(X(X(X(X(X({},Object(_.c)(["isSupportWebp"])),Object(_.e)("user",["collectData","cdnHost","token"])),Object(_.c)("user",["userInfo","isLoggedIn"])),Object(_.c)("creation",["isOpenCombinedDialog"])),Object(_.e)("creation",["currentDialogInstanceId"])),{},{isFilterNotUsedAdditionalModel:function(){var e=this;return function(t){return!e.isAdditionalModel||e.isAdditionalModel&&(e.ADDITION_MODEL_TYPES||[]).includes(null==t?void 0:t.content_sub_type)}},dynamicPageConfig:function(){var e,t=Object(o.a)(this.pageConfig),n=t.find((function(e){return"recent"===e.id}));this.visible&&(["generateImage","generateVideo","imageTrainModel","app"].includes(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)?n||t.push({name:"recentlyUsed",id:"recent",showTab:!0,content_type:"recent"}):t=t.filter((function(e){return"recent"!==e.id})));return Object(o.a)(t)},selectedId:function(){var e;return this.checkedId||(null===(e=this.easyTop)||void 0===e||null===(e=e.categoryInfo)||void 0===e?void 0:e.id)||null},isModelType:function(){return["model","imgModel","videoModel","loraImgModel","loraVideoModel"].includes(this.currentActiveTab)},isShowModelFilter:function(){return["model","imgModel","videoModel","loraImgModel","loraVideoModel","imageTrainModel"].includes(this.myTab)},isShowModelItem:function(){return["model","imgModel","videoModel","loraImgModel","loraVideoModel"].includes(this.myTab)},IMG_MODELS:function(){var e=this;return v.b.filter((function(t){return!e.VIDEO_MODELS.includes(t)}))},VIDEO_MODELS:function(){return Object.values(d.VIDEO_MODEL_LIST)},ADDITION_MODEL_TYPES:function(){return Object(G.getAdditionalModels)(this.baseModelType)},isVideoModel:function(){return"generateVideo"===this.currentTab},isImageModel:function(){return"generateImage"===this.currentTab},isImageTrainModel:function(){return"imageTrainModel"===this.currentTab},renderCategoryOption:function(){var e=this;return this.categoryOption.filter((function(t){return t.content_type===e.outInitTab}))},outInitTab:function(){return{generateImage:"imgModel",generateVideo:"videoModel",app:"aiApp",loraVideoModel:"loraVideoModel",loraImgModel:"loraImgModel",imageTrainModel:"image_train_model"}[this.currentTab]||"model"},isAdditionalModel:function(){return["loraVideoModel","loraImgModel"].includes(this.subSource)},currentActiveTab:{get:function(){return null!==this.customTabType?this.customTabType:this.outInitTab},set:function(e){this.customTabType=e}},currentTab:function(){var e;return this.subSource||(null===(e=this.easyTop)||void 0===e?void 0:e.currentTab)||"model"},isShowModuleData:function(){return this.dynamicData&&!this.searchIng},isShowSquareList:function(){return"squareMixRecommend"!==this.currentActiveTab&&this.dynamicData&&!this.isVideoModel},isShowListNoData:function(){return!this.list.length&&!this.pageLoading},isShowNoModuleData:function(){var e;return!(null!==(e=this.curActiveTabObj)&&void 0!==e&&null!==(e=e.modules)&&void 0!==e&&e.length||this.pageLoading)},isShowRecently:function(){return function(e){return!1}},isShowFastAppFilter:function(){return"aiApp"===this.myTab&&"collect"!==this.currentActiveTab},isShowTag:function(){var e=this;return function(t){return[6,"6"].includes(t.content_type)&&"squareMixRecommend"!==e.currentActiveTab}},curPageIndex:function(){var e=this;return(this.pageConfig.filter((function(e){return!0===e.showTab}))||[]).findIndex((function(t){var n;return t.id===(null===(n=e.curActiveTabObj)||void 0===n?void 0:n.id)}))},searchIng:function(){return this.keyword||!1},active_id:function(){var e,t;return["collect","mine","recent"].includes(null===(e=this.curActiveTabObj)||void 0===e?void 0:e.id)?"-":null===(t=this.curActiveTabObj)||void 0===t?void 0:t.id},isShowMackTag:function(){var e,t=null===(e=this.curActiveTabObj)||void 0===e||null===(e=e.modules)||void 0===e?void 0:e.find((function(e){return"6"===e.content_type}));return"squareMixRecommend"!==this.currentActiveTab&&!t||"squareMixRecommend"==this.currentActiveTab},emptyNumber:function(){var e,t;return 6===this.gridNum?18-(null===(e=this.list)||void 0===e?void 0:e.length):15-(null===(t=this.list)||void 0===t?void 0:t.length)},activeTabs:function(){var e=this.pageConfig.map((function(e){return e.content_type}))||[],t=this.pageConfig.map((function(e){return e.route}))||[];return[].concat(Object(o.a)(e),Object(o.a)(t))},curActiveTabObj:function(){var e=this;return(this.currentActiveTab?this.pageConfig.find((function(t){return t.content_type===e.currentActiveTab}))||null:this.pageConfig.find((function(e){return e.showTab})))||{}},dynamicData:function(){return!["mine","collect","recent"].includes(this.currentActiveTab)},isUseTagFilter:function(){return this.dynamicData&&"features"!==this.realTab},activeTabClass:function(){return function(e,t){var n=e.id,o=void 0===n?"":n,l=e.content_type,r=void 0===l?"":l,c=this.dynamicData?o:r;return c&&c===("static"===t?this.myTab:this.realTab)?"tab-active":""}},shouldShowRecommendBox:function(){return function(e){return"recent"!==e.type&&![6,"6"].includes(e.content_type)&&(null==e?void 0:e.elList)&&(null==e?void 0:e.elList.length)&&"25"!==e.content_type}},shouldShowMoreButton:function(){var e=this;return function(t){var n;return e.activeTabs.includes(t.link||"")&&e.currentActiveTab!==t.link&&(null===(n=e.curActiveTabObj)||void 0===n?void 0:n.route)!==t.link}},dataInfo:function(){var e=this;return function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=t.id,r=t.obj_type,c=t.pt,d=e.curActiveTabObj,v=d.name,m=d.modules,h=void 0===m?[]:m,f=d.id,title=d.title,_=o?null==h?void 0:h.findIndex((function(e){return e.id===o})):-1,y=o?null==h?void 0:h[_]:{title:e.$t(v),id:f},C=y.title,w=y.id,k=e.pageConfig.findIndex((function(t){return t.content_type===e.currentActiveTab}));return X({id:l,type:r,pt:c,cindex:n,mIndex:_,search_scene:"create_flow_model",position:"popup,".concat(f,",").concat(title||C,",").concat(k,",").concat(w,",").concat(C,",").concat(_,",").concat(n)},e.getLogEventParams())}},getSwiperListHeight:function(){var e=this;return function(t){return[13,"13"].includes(t.content_type)?"260px":null!=t&&t.elList&&2===(null==t?void 0:t.elList[0].obj_type)&&5===e.gridNum?"340px":"300px"}}}),beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceResize=null,this.$refs.wrapper&&this.$refs.wrapper.removeEventListener("scroll",this.debouncedHandleScroll),this.debouncedHandleScroll.cancel()},mounted:function(){var e,t=this;null===(e=this.$refs.wrapper)||void 0===e||e.addEventListener("scroll",this.debouncedHandleScroll),this.debounceHandleScroll=Object(y.debounce)(this.handleScroll,600),this.debounceResize=Object(y.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.resetSessionId(),this.$nextTick((function(){t.handleResize()}))},created:function(){this.debouncedHandleScroll=Object(y.debounce)(this.handleScroll,200)},methods:X(X(X(X({},Object(_.d)("creation",["SET_COMBINED_DIALOG_STATUS","SET_CURRENT_DIALOG_INSTANCE_ID"])),Object(_.b)("user",["recordEnableUsePresetConfig"])),Object(_.b)("creation",["setCombinedDialogStatus"])),{},{handleTrainMyLora:function(){var e=this.localePath("/loraTrainingEdit?DSType=1"),t=location.origin+e;t&&window.open(t,"_blank")},getLogEventParams:function(){var e,t,n=this.$refs.filterModel,o=this.$refs.squareList,filter=(null==this?void 0:this.dynamicData)?null!=o&&null!==(e=o.baseModelSelect)&&void 0!==e&&e.length?1:0:null!=n&&null!==(t=n.queryParam)&&void 0!==t&&null!==(t=t.base_models)&&void 0!==t&&t.length?1:0,l=null==o?void 0:o.tagIndex,r=null,c=null==o?void 0:o.currentTagId,d=null==this?void 0:this.curCategoryId;return r=c?"5-".concat(c):d?"4-".concat(d):1,{source_channel:null==this?void 0:this.sourceChannel,source_value:r,filter:filter,sort_value:l}},resetSessionId:function(){this.sessionID=Object(z.r)({prefix:"create_flow"})},getBaseModels:function(){var e=this;return Object($.a)({scene:this.isVideoModel?6:5}).then((function(t){var n;1e4===t.status.code&&(e.baseModels=(null===(n=t.data)||void 0===n||null===(n=n.base_model_select_options)||void 0===n?void 0:n.map((function(t){return e.baseModelMap[t.val]=t.vals||[],t.val})))||[]);return t}))},handleLogEventFn:function(e){var t={operation:"more",position:e,obj_type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""};this.$logEvent("log_actions",t)},handleMouseLeave:function(){this.hideScroll2=!0},handleMouseEnter:function(){this.hideScroll2=!1},setPageConfigCache:function(data){var e={data:data,timestamp:Date.now()};localStorage.setItem("taskConfigCache",JSON.stringify(e)),this.pageConfigCache=data,this.pageConfigCacheTimestamp=e.timestamp},getPageConfigCache:function(){var e=localStorage.getItem("taskConfigCache");if(e){var t=JSON.parse(e);return this.pageConfigCache=t.data,this.pageConfigCacheTimestamp=t.timestamp,t}return null},isCacheExpired:function(){if(!this.pageConfigCacheTimestamp)return!0;return Date.now()-this.pageConfigCacheTimestamp>3e5},unFavorite:function(e){var t=e.id;if("collect"===this.currentActiveTab){var n=this.list.findIndex((function(e){return e.id===t}));this.list.splice(n,1)}},handleScrollTop:function(){var e=this;this.$nextTick((function(){try{e.$refs.wrapper.scrollTop=0}catch(e){}}))},handleScroll:function(e){var t=e.target;if(t){var n=t.scrollHeight-(t.scrollTop+t.clientHeight);this.scrollTop=t.scrollTop,n<200&&!this.isLoading&&this.load()}},load:function(){this.pageLoading||"squareMixRecommend"===this.currentActiveTab||("collect"!==this.currentActiveTab?"mine"!==this.currentActiveTab?"recent"!==this.currentActiveTab?this.$refs.squareList&&this.$refs.squareList.updateList("add"):this.getRecentList():this.getMyList():this.getCollectList())},handleClickMore:function(e){var t,n;this.handleLogEventFn("create_flow,".concat(null===(t=this.curActiveTabObj)||void 0===t?void 0:t.id,",").concat(null===(n=this.curActiveTabObj)||void 0===n?void 0:n.title,",").concat(this.curPageIndex,",").concat(e.id,",").concat(e.title),null==e?void 0:e.elList[0].obj_type),this.currentActiveTab=e.content_type,this.initData()},handleFilter:function(e){var t,n,l=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=X({},e);Array.isArray(c.base_models)&&0===c.base_models.length&&(this.isImageTrainModel?c.base_models=this.baseModelList||[]:c.base_models=(null===(n=this.myQueryParams[this.myTab])||void 0===n?void 0:n.base_models)||[]);this.resetParams(),this.pageInfo.page=1,null!=e&&null!==(t=e.base_models)&&void 0!==t&&t.length&&(e.base_models=e.base_models.flatMap((function(e){var t;return[e].concat(Object(o.a)((null===(t=l.baseModelMap)||void 0===t?void 0:t[e])||[]))}))),this.$logEvent("model_filter_click",{value:e.base_models,source_channel:this.sourceChannel}),"mine"===this.currentActiveTab&&(this.myQueryParams[this.myTab]=X(X(X({},this.myQueryParams[this.myTab]),c),this.pageInfo),this.getMyList("filter",r)),"collect"===this.currentActiveTab&&(this.collectQueryParams[this.myTab]=X(X(X({},this.collectQueryParams[this.myTab]),c),this.pageInfo),this.getCollectList("filter",r)),"recent"===this.currentActiveTab&&(this.collectQueryParams[this.myTab]=X(X(X({},this.collectQueryParams[this.myTab]),c),this.pageInfo),this.getRecentList("filter",r))},changeScroll:function(){var e=this;this.$refs.listItem.forEach((function(t,n){t.classList.contains("tab-active")&&(e.itemScroll={value:t.getBoundingClientRect().left,index:n})}))},resetParams:function(){var e=this;this.$nextTick((function(){var t,n;null===(t=e.$refs.lenovoSearch)||void 0===t||t.resetSearch(),null===(n=e.$refs.Search)||void 0===n||n.resetSearch(),e.$refs.squareList&&e.$refs.squareList.initData()})),this.keyword="",this.hasMore=!0,this.list=[],this.pageInfo={page:1,page_size:35,total:0},this.collectCommonParams={order_by:"new",start_at:0,end_at:0,after:0,artwork_types:[],model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS};var t={};["loraImgModel","loraVideoModel"].includes(this.subSource)&&(t.model_types=this.additionModelTypes.map((function(e){return e.value})),t.base_models=this.ADDITION_MODEL_TYPES,this.collectCommonParams=X(X({},this.collectCommonParams),t)),this.myQueryParams={model:X({order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},t),videoModel:X({order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},t),imgModel:X({order_by:"new",publish_status:0,model_types:["Checkpoint"],base_models:this.isVideoModel?this.VIDEO_MODELS:this.IMG_MODELS},t),loraImgModel:X({order_by:"new",publish_status:0,model_types:["LORA","DoRA","LoCon","TextualInversion"],base_models:this.ADDITION_MODEL_TYPES},t),loraVideoModel:X({order_by:"new",publish_status:0,model_types:["LORA","DoRA","LoCon","TextualInversion"],base_models:this.ADDITION_MODEL_TYPES},t),aiApp:{order_by:"new",publish_status:0,comfy_ui_type:2}},this.collectQueryParams={model:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),videoModel:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),imgModel:X({type:"bookmarks",model_types:["Checkpoint"]},this.collectCommonParams),aiApp:X({type:"bookmarks",source_type:8,time_to:0},this.collectCommonParams)}},handleClickCategory:function(e){this.resetSessionId(),this.isEmitTagEvent=!0,this.curCategoryId=e.id,this.$refs.squareList.activeTagIndex=null,this.$refs.squareList.currentTagId="",e.id?this.realTab=e.tags:this.realTab="features",e.id?this.$refs.squareList.updateList("tab",!0,e.name):this.$refs.squareList.updateList("tab")},handleClickTab:function(e){var t=this;this.isEmitTagEvent=!0,this.currentTabId=e.id,""===e.id?this.sourceChannel=1:this.sourceChannel=3,this.pageLoading||(this.dynamicData?(this.realTab=e.id,this.activeTabDynamicTitle=e.title):this.myTab=e.content_type,this.$nextTick((function(){t.changeScroll()})),this.initData("tab"))},initData:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:"",t.handleScrollTop(),"tab"===o&&"features"!==t.realTab||(t.$refs.squareList&&t.$refs.squareList.initData(),t.resetParams()),n.t0=t.currentActiveTab,n.next="mine"===n.t0?6:"collect"===n.t0?9:"recent"===n.t0?12:15;break;case 6:return n.next=8,t.getMyList();case 8:case 11:case 14:return n.abrupt("break",26);case 9:return n.next=11,t.getCollectList();case 12:return n.next=14,t.getRecentList();case 15:if("tab"!==o||"features"===t.realTab||!t.$refs.squareList){n.next=18;break}return t.$refs.squareList.updateList("tab"),n.abrupt("return");case 18:if(["mine","collect","recent"].includes(t.currentActiveTab)){n.next=24;break}if(l=t.getStaticModules(),l.every((function(e){return!(!Array.isArray(e.elList)||0===e.elList.length)&&e.elList.every((function(e){return e&&e.stat}))}))){n.next=24;break}return n.next=24,t.getPageConfig(!0);case 24:return n.next=26,t.getModuleList();case 26:case"end":return n.stop()}}),n)})))()},getStaticModules:function(){var e=[];if(this.curActiveTabObj&&Array.isArray(this.curActiveTabObj.modules)){var t,n=H(this.curActiveTabObj.modules);try{for(n.s();!(t=n.n()).done;){var o=t.value;"static"===o.type&&"6"!==o.content_type&&e.push(o)}}catch(e){n.e(e)}finally{n.f()}}return e},isCurrentRoute:function(e){var t=this.$route.params.ptype,n=void 0===t?"/":t;return"/"===n?"/"===e:e.includes(n)},getPageConfig:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,d,data,v,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]&&e[0],t.pageLoading=!0,n.prev=2,n.next=5,Object(P.getComponentsConfigV2)({parent_id:"task",type:"page",active_id:t.active_id,with_ver_info:1});case 5:if(c=n.sent,d=c.status,data=c.data,1e4!==(null==d?void 0:d.code)){n.next=20;break}if(v=(null==data?void 0:data.items.map((function(e){return X({},e)})).sort((function(a,b){return a.ord-b.ord})).map((function(e){e.ord;return Object(l.a)(e,W)})))||[],m=[].concat(Object(o.a)(v),[{name:"Collect",id:"collect",showTab:!0,content_type:"collect"},{name:"Mine",id:"mine",showTab:!0,content_type:"mine"},{name:"recentlyUsed",id:"recent",showTab:!0,content_type:"recent"}]),!r){n.next=18;break}return h=t.pageConfig.findIndex((function(e){return e.id===t.curActiveTabObj.id})),t.pageConfig[h]=m[h],t.curActiveTabObj.modules=m[h].modules,t.setPageConfigCache(t.pageConfig),n.next=17,t.getModuleList();case 17:return n.abrupt("return");case 18:t.pageConfig=m,t.setPageConfigCache(m);case 20:n.next=24;break;case 22:n.prev=22,n.t0=n.catch(2);case 24:return n.prev=24,t.pageLoading=!1,n.finish(24);case 27:case"end":return n.stop()}}),n,null,[[2,22,24,27]])})))()},handleSearch:function(e,t,n){var o;(e?this.sessionID=Object(z.r)({prefix:"create_flow"}):(this.resetParams(),this.sessionID=""),this.keyword=e,this.pageInfo.page=1,this.hasMore=!0,this.$refs.squareList)&&(null===(o=this.$refs)||void 0===o||null===(o=o.squareList)||void 0===o||o.resetViewData(),"components"===t&&this.$refs.squareList.updateList("search",!0,e,n));"myOrCollect"===t?("mine"===this.currentActiveTab&&this.getMyList(),"collect"===this.currentActiveTab&&this.getCollectList(),"recent"===this.currentActiveTab&&this.getRecentList()):(this.realTab="features",this.sourceChannel=4,this.isEmitSearchEvent=!0),this.handleScrollTop()},handleItemSelect:function(e){var t=(e||{}).obj;if(this.$emit("getData",{data:t,source:this.source,subSource:this.subSource}),this.isAdditionalModel)return this.$emit("handleSelectAdditionalModel",e),void this.handleClose();this.$EventBus.$emit("updateCategoryInfo",e),this.handleClose()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1326px",this.gridNum=6):(this.modalWidth="1110px",this.gridNum=5)}catch(e){}},handleClickTopTab:function(e){if(this.curCategoryId="","collect"===e.content_type?this.sourceChannel=5:"mine"===e.content_type?this.sourceChannel=6:"recent"===e.content_type?(this.sourceChannel=7,this.$xyLogEvent({front_operation:"model_recent_tab_click",event_name:"log_action_model_recent_tab_click"})):this.sourceChannel=1,!this.pageLoading){var t,n,o;if(this.currentActiveTab=(null==e?void 0:e.content_type)||null,["mine","collect","recent"].includes(this.currentActiveTab))(null===(t=this.$refs)||void 0===t?void 0:t.filterModel)&&(null===(n=this.$refs)||void 0===n||null===(n=n.filterModel)||void 0===n||n.filterReset(!0));if(this.$logEvent("log_actions",{operation:"click_navigation_tab",position:"create_flow,".concat(this.curActiveTabObj.id||this.currentActiveTab,",").concat(this.curActiveTabObj.title||this.currentActiveTab,",").concat(this.curPageIndex)}),this.dynamicData)this.realTab="features";else this.myTab=(null===(o=this.renderCategoryOption[0])||void 0===o?void 0:o.content_type)||"model";this.initData()}},getCollectList:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var l,r,c,d,m,h,f,_,y,C,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"",c=e.length>1&&void 0!==e[1]&&e[1],t.isLoggedIn||"aiApp"!==t.myTab){n.next=5;break}return t.$EventBus.$emit("openLoginDialog",{callBack:function(){t.getCollectList(r,c)}}),n.abrupt("return");case 5:if(!t.pageLoading){n.next=7;break}return n.abrupt("return");case 7:if(t.hasMore){n.next=9;break}return n.abrupt("return");case 9:return d={aiApp:M.v,imgModel:L.s,videoModel:L.s,model:L.s},m=d[t.myTab],(h=X(X(X({},t.collectQueryParams[t.myTab]),t.pageInfo),{},{after:(null===(l=t.list[t.list.length-1])||void 0===l||null===(l=l.collect)||void 0===l?void 0:l.collect_at)||0})).keyword=t.keyword,h.ss=v.e.GenerateSearch,h.refer="task",["model","imgModel","videoModel"].includes(t.myTab)&&("filter"!==r||c||0===h.base_models.length)&&(h.base_models=t.isAdditionalModel?t.ADDITION_MODEL_TYPES:t.baseModels),n.prev=16,t.pageLoading=!0,n.next=20,m(h);case 20:_=n.sent,1e4===(null===(f=_.status)||void 0===f?void 0:f.code)&&(1===h.page&&null!==(y=_.data)&&void 0!==y&&y.time_ms&&(t.collectQueryParams[t.myTab].time_to=_.data.time_ms),t.list=1===t.pageInfo.page?(null===(C=_.data)||void 0===C?void 0:C.items)||[]:[].concat(Object(o.a)(t.list),Object(o.a)((null===(w=_.data)||void 0===w?void 0:w.items)||[]))||[],t.hasMore=_.data.has_more,t.hasMore&&t.pageInfo.page++),t.pageLoading=!1,n.next=28;break;case 25:n.prev=25,n.t0=n.catch(16),t.pageLoading=!1;case 28:case"end":return n.stop()}}),n,null,[[16,25]])})))()},getMyList:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var l,r,c,d,m,h,f,_,y,C;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=e.length>0&&void 0!==e[0]?e[0]:"",r=e.length>1&&void 0!==e[1]&&e[1],t.isLoggedIn){n.next=5;break}return t.$EventBus.$emit("openLoginDialog",{callBack:function(){t.getMyList(l,r)}}),n.abrupt("return");case 5:if(!t.pageLoading){n.next=7;break}return n.abrupt("return");case 7:if(t.hasMore){n.next=9;break}return n.abrupt("return");case 9:return c={aiApp:M.t,model:L.l,imgModel:L.l,videoModel:L.l},d=c[t.myTab],m=X(X({},t.myQueryParams[t.myTab]),t.pageInfo),["model","imgModel","videoModel"].includes(t.myTab)&&(m.with_ver_info=1,("filter"!==l||r)&&(m.base_models=t.isAdditionalModel?m.base_models:t.baseModels)),m.keyword=t.keyword,m.ss=v.e.GenerateSearch,m.refer="task",n.prev=16,t.pageLoading=!0,n.next=20,d(m);case 20:f=n.sent,1e4===(null===(h=f.status)||void 0===h?void 0:h.code)&&(t.list=1===t.pageInfo.page?(null===(_=f.data)||void 0===_?void 0:_.items)||[]:[].concat(Object(o.a)(t.list),Object(o.a)((null===(y=f.data)||void 0===y?void 0:y.items)||[]))||[],t.hasMore=null==f||null===(C=f.data)||void 0===C?void 0:C.has_more,t.hasMore&&t.pageInfo.page++,t.pageLoading=!1),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(16),t.pageLoading=!1;case 27:case"end":return n.stop()}}),n,null,[[16,24]])})))()},getRecentList:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var l,r,c,d,m,h,f,_,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"",c=e.length>1&&void 0!==e[1]&&e[1],!t.pageLoading){n.next=4;break}return n.abrupt("return");case 4:if(t.hasMore){n.next=6;break}return n.abrupt("return");case 6:return(d=X(X(X({},t.collectQueryParams[t.myTab]),t.pageInfo),{},{after:(null===(l=t.list[t.list.length-1])||void 0===l||null===(l=l.collect)||void 0===l?void 0:l.collect_at)||0})).keyword=t.keyword,["model","imgModel","videoModel"].includes(t.myTab)&&("filter"!==r||c)&&(d.base_models=t.isAdditionalModel?d.base_models:t.baseModels),"aiApp"===t.myTab&&(d.comfy_ui_type=3,d.source_types=[14],delete d.model_types,delete d.base_models),n.prev=10,t.pageLoading=!0,d.ss=v.e.GenerateSearch,n.next=15,Object(P.getRecentSquare)(d);case 15:h=n.sent,1e4===(null===(m=h.status)||void 0===m?void 0:m.code)&&(1===d.page&&null!==(f=h.data)&&void 0!==f&&f.time_ms&&(t.collectQueryParams[t.myTab].time_to=h.data.time_ms),t.list=1===t.pageInfo.page?(null===(_=h.data)||void 0===_?void 0:_.items)||[]:[].concat(Object(o.a)(t.list),Object(o.a)((null===(y=h.data)||void 0===y?void 0:y.items)||[]))||[],t.hasMore=h.data.has_more,t.hasMore&&t.pageInfo.page++),t.pageLoading=!1,n.next=23;break;case 20:n.prev=20,n.t0=n.catch(10),t.pageLoading=!1;case 23:case"end":return n.stop()}}),n,null,[[10,20]])})))()},initializeAndUpdateArray:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.map((function(e){if(n&&e.id!==n)return e;if(e.modules&&Array.isArray(e.modules)){var o=e.modules.map((function(e){var n=t.find((function(data){return data.id===e.id}));return n&&n.items?X(X({},e),{},{elList:n.items}):X(X({},e),{},{elList:e.elList||[]})}));return X(X({},e),{},{modules:o})}return n===e.id&&1===t.length?X(X({},e),{},{elList:t[0].items}):e}))},getModuleList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,I,x,T,S,O,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=(null===(n=e.curActiveTabObj)||void 0===n?void 0:n.modules)||[]).length){t.next=3;break}return t.abrupt("return");case 3:e.pageLoading=!0,t.prev=4,l=[],r=[],c=H(o);try{for(c.s();!(d=c.n()).done;)"6"!==(v=d.value).content_type&&("static"===v.type&&v.elList&&v.elList.length&&l.push(v),"static"!==v.type&&r.push(v))}catch(e){c.e(e)}finally{c.f()}if(!(l.length>0)){t.next=18;break}return m=l.flatMap((function(e){return e.elList})),h=m.map((function(e){return{obj_id:e.id||"",obj_type:e.obj_type}})),t.next=14,e.getStaticData2(h);case 14:if(f=t.sent){_=H(l);try{for(_.s();!(y=_.n()).done;)C=y.value,w=e.mergeArrays(C.elList,f),C.elList=w||C.elList}catch(e){_.e(e)}finally{_.f()}}k=H(l);try{for(k.s();!(I=k.n()).done;)x=I.value,e.pageConfig=e.initializeAndUpdateArray(e.pageConfig,[{id:x.id,items:x.elList}],e.curActiveTabObj.id)}catch(e){k.e(e)}finally{k.f()}case 18:if(!(r.length>0)){t.next=38;break}T=H(r),t.prev=20,T.s();case 22:if((S=T.n()).done){t.next=30;break}return O=S.value,t.next=26,e.getDynamicList(O.type);case 26:(data=t.sent)&&(e.pageConfig=e.initializeAndUpdateArray(e.pageConfig,[{id:O.id,items:data}],e.curActiveTabObj.id));case 28:t.next=22;break;case 30:t.next=35;break;case 32:t.prev=32,t.t0=t.catch(20),T.e(t.t0);case 35:return t.prev=35,T.f(),t.finish(35);case 38:t.next=43;break;case 40:t.prev=40,t.t1=t.catch(4),console.error("Error fetching component list:",t.t1);case 43:return t.prev=43,e.pageLoading=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[4,40,43,46],[20,32,35,38]])})))()},getStaticData2:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(P.getStaticDataMoreDetails)({items:e});case 3:if(l=t.sent,1e4!==(null===(n=l.status)||void 0===n?void 0:n.code)||null===(o=l.data)||void 0===o||!o.items){t.next=6;break}return t.abrupt("return",l.data.items.map((function(e){return{id:e.id,stat:e.stat,collect:e.collect,liked:e.liked,obj_type:e.obj_type}})));case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error fetching static data for getStaticData2:",t.t0);case 11:return t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getDynamicList:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o={model:[2],imgModel:[2],videoModel:[2],aiApp:[14],squareMixRecommend:[]},l=t.dynamicListMap[e]){n.next=4;break}return n.abrupt("return");case 4:if((r={order_by:"new",page:1,page_size:20}).source_types=o[t.currentActiveTab],"recent"!==e){n.next=10;break}if(t.isLoggedIn){n.next=9;break}return n.abrupt("return");case 9:r.page_size="squareMixRecommend"!==t.currentActiveTab?30:20;case 10:return t.isModelType&&(r.with_ver_info=1,r.model_types=["Checkpoint"],r.base_models=t.baseModels),["loraImgModel","loraVideoModel"].includes(t.subSource)&&(r.model_types=t.additionModelTypes.map((function(e){return e.value})),r.base_models=t.ADDITION_MODEL_TYPES),n.prev=12,n.next=15,l(r);case 15:if(d=n.sent,v=d.status,data=d.data,1e4!==(null==v?void 0:v.code)||null==data||null===(c=data.items)||void 0===c||!c.length){n.next=20;break}return n.abrupt("return",data.items);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(12),console.error("Error fetching dynamic data for type ".concat(e,":"),n.t0);case 25:return n.abrupt("return",null);case 26:case"end":return n.stop()}}),n,null,[[12,22]])})))()},mergeArrays:function(e,t){var n=new Map(t.map((function(e){return["".concat(e.id).concat(e.obj_type),e]})));return e.map((function(e){var t=n.get("".concat(e.id).concat(e.obj_type));return t?X(X({},e),t):e}))},openModal:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAdditionalModel||e.isImageTrainModel){t.next=3;break}return t.next=3,e.getBaseModels();case 3:if(e.isImageTrainModel&&(e.baseModels=e.baseModelList,null===(n=e.$refs)||void 0===n||null===(n=n.squareList)||void 0===n||n.resetViewData()),e.visible=!0,e.$refs.squareList&&e.$refs.squareList.initData(),e.resetParams(),o=e.getPageConfigCache(),t.prev=8,!o){t.next=22;break}if(l=localStorage.getItem("lastLang")||null,r=e.$cookies.get("lang")||null,l&&(!l||l===r)){t.next=16;break}return t.next=15,e.getPageConfig();case 15:return t.abrupt("return");case 16:if(e.pageConfig=e.pageConfigCache,!e.isCacheExpired()){t.next=20;break}return t.next=20,e.getPageConfig();case 20:t.next=24;break;case 22:return t.next=24,e.getPageConfig();case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(8),console.log("开启模态窗--ERROR",t.t0);case 29:return t.prev=29,e.setTabVisible(),t.finish(29);case 32:case"end":return t.stop()}}),t,null,[[8,26,29,32]])})))()},setTabVisible:function(){var e=this;this.pageConfig.forEach((function(t,n){var o=["collect","mine","recent"].includes(t.content_type)||!e.currentActiveTab;e.$set(e.pageConfig[n],"showTab",!!o||t.content_type===e.currentActiveTab),t.content_type===e.currentActiveTab&&e.handleClickTopTab(t)}))},handleClose:function(e){var t=this;this.visible=!1,this.SET_COMBINED_DIALOG_STATUS(!1),this.$nextTick((function(){t.$refs.squareList&&(t.$refs.squareList.recommendList=[],t.$refs.squareList.HyHomeFormsRefInitFilter()),t.customTabType=null,t.resetParams(),t.pageConfigUpdateData&&(t.setPageConfigCache(t.pageConfigUpdateData),t.pageConfigUpdateData=null),t.$cookies.get("lang")&&!t.pageLoading&&localStorage.setItem("lastLang",t.$cookies.get("lang")),"handle"===e&&t.logWindowCloseTime()}))}})},Y=Q,Z=(n(4269),n(0)),component=Object(Z.a)(Y,(function(){var e,t,n,l,r,c=this,d=c._self._c;return d("el-dialog",{ref:"styleModal",attrs:{visible:c.visible,width:c.modalWidth,height:"auto","custom-class":"easy-style-modal ".concat("generateVideo"==(null===(e=c.easyTop)||void 0===e?void 0:e.currentTab)?"video":""),"modal-append-to-body":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,"append-to-body":"",center:""},on:{"update:visible":function(e){c.visible=e},close:c.handleClose}},[d("template",{slot:"title"},[d("div",c._g({staticClass:"easy-style-modal-header"},{mouseleave:c.handleMouseLeave,mouseenter:c.handleMouseEnter}),[d("div",{staticClass:"easy-style-modal-header-tabs"},[d("SwiperList",{attrs:{iconBntWidth:28,scrollChange:c.itemScroll,top:"0",listGap:"32px"}},c._l(c.dynamicPageConfig,(function(e,t){var n;return d("div",{directives:[{name:"show",rawName:"v-show",value:e.showTab,expression:"item.showTab"}],key:"top_tab_".concat(e.id,"_").concat(t),staticClass:"header-tabs-item",class:[((null===(n=c.curActiveTabObj)||void 0===n?void 0:n.id)===(null==e?void 0:e.id)||c.currentActiveTab===(null==e?void 0:e.content_type))&&"header-tabs-item-active"],attrs:{"data-id":null==e?void 0:e.id},on:{click:function(t){return t.stopPropagation(),c.handleClickTopTab(e)}}},[c._v("\n            "+c._s(c.$t(e.name)||(null==e?void 0:e.title))+"\n          ")])})),0)],1),c._v(" "),c.isAdditionalModel?d("div",{staticClass:"header-top-button",style:{marginRight:["loraImgModel","loraVideoModel"].includes(c.currentActiveTab)?"0px":"24px"},on:{click:function(e){return e.stopPropagation(),c.handleTrainMyLora.apply(null,arguments)}}},[c._v("\n        "+c._s(c.$t("trainMyLora"))+"\n      ")]):c._e(),c._v(" "),c.dynamicData||c.isAdditionalModel&&"recent"===c.currentActiveTab?c._e():d("CombinedSelectionSearch",{ref:"Search",on:{search:function(e){return c.handleSearch(e,"myOrCollect")}}}),c._v(" "),c.dynamicData&&!this.isVideoModel?d("CombinedSelectionLenovoSearch",{ref:"lenovoSearch",attrs:{baseModelTypes:c.additionModelTypes.map((function(e){return e.value})),isAdditionalModel:c.isAdditionalModel,modelTypes:c.ADDITION_MODEL_TYPES,baseModels:c.baseModels},on:{search:function(e,t){return c.handleSearch(e,"components",t)},close:c.handleClose},model:{value:c.keyword,callback:function(e){c.keyword=e},expression:"keyword"}}):c._e(),c._v(" "),d("div",{staticClass:"header-close-btn",on:{click:function(e){return e.stopPropagation(),function(){return c.handleClose("handle")}.apply(null,arguments)}}},[d("i",{staticClass:"el-icon-close"})])],1)]),c._v(" "),d("div",c._g({ref:"wrapper",staticClass:"wrapper",on:{"&scroll":function(e){return c.handleScroll.apply(null,arguments)}}},{mouseleave:c.handleMouseLeave,mouseenter:c.handleMouseEnter}),[c.dynamicData?c._e():d("div",{staticClass:"wrapper-top"},[d("div",{staticClass:"category-box"},c._l(c.renderCategoryOption,(function(e,t){return d("div",{key:"tab_".concat(null==e?void 0:e.content_type,"_").concat(t)},[d("div",{ref:"listItem",refInFor:!0,staticClass:"wrapper-top-item",class:[c.activeTabClass(e,"static")],on:{click:function(t){return t.stopPropagation(),c.handleClickTab(e)}}},[c._v("\n            "+c._s(c.$t(e.i18nKey))+"\n          ")])])})),0),c._v(" "),d("div"),c._v(" "),d("div",{staticClass:"wrapper-top-filter"},[c.isShowModelFilter?d("FilterModel",{ref:"filterModel",attrs:{baseModels:c.isAdditionalModel?c.ADDITION_MODEL_TYPES:c.baseModels,isAdditionalModel:c.isAdditionalModel,additionModelTypes:c.additionModelTypes,curCode:c.currentActiveTab},on:{handleFilter:c.handleFilter}}):c._e(),c._v(" "),c.isShowFastAppFilter?d("FilterFastApp",{on:{handleFilter:c.handleFilter}}):c._e()],1)]),c._v(" "),d("div",{staticClass:"wrapper-container"},[c.isShowModuleData?d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.pageLoading,expression:"pageLoading"}],staticClass:"wrapper-container-1",style:{gap:c.isUseTagFilter?"0":"22px",marginTop:c.dynamicData?"16px":"0px"}},[c.isShowNoModuleData?[d("NoData")]:[null!==(t=c.curActiveTabObj)&&void 0!==t&&null!==(t=t.categories)&&void 0!==t&&t.length&&(c.isImageModel||c.isAdditionalModel||c.isImageTrainModel)?[d("SwiperList",{attrs:{iconBntWidth:28,scrollChange:c.itemScroll,top:"0"}},c._l([{id:"",i18nKey:"Recommend"}].concat(Object(o.a)(null===(n=c.curActiveTabObj)||void 0===n?void 0:n.categories)),(function(e,t){return d("div",{key:"tab_".concat(null==e?void 0:e.id,"_").concat(t)},[d("div",{ref:"listItem",refInFor:!0,staticClass:"wrapper-top-item",class:{"tab-active":c.curCategoryId===e.id},on:{click:function(t){return t.stopPropagation(),c.handleClickCategory(e)}}},[c._v("\n                  "+c._s(e.i18nKey?c.$t(e.i18nKey):e.name)+"\n                ")])])})),0)]:c._e(),c._v(" "),c._l(null===(l=c.curActiveTabObj)||void 0===l?void 0:l.modules,(function(e){return[c.isShowTag(e)?[d("SwiperList",{key:e.id,attrs:{iconBntWidth:28,scrollChange:c.itemScroll,top:"0"}},[d("div",{ref:"listItem",refInFor:!0,staticClass:"wrapper-top-item",class:[c.activeTabClass(c.mockFeaturesTagObj,"dynamic")],on:{click:function(e){return e.stopPropagation(),c.handleClickTab(c.mockFeaturesTagObj)}}},[c._v("\n                  "+c._s(c.$t(c.mockFeaturesTagObj.i18nKey))+"\n                ")]),c._v(" "),c._l(e.elList,(function(e,t){return d("div",{key:"tab_".concat(null==e?void 0:e.id,"_").concat(t)},[c.isFilterNotUsedAdditionalModel(e)?d("div",{ref:"listItem",refInFor:!0,staticClass:"wrapper-top-item",class:[c.activeTabClass(e,"dynamic")],on:{click:function(t){return t.stopPropagation(),c.handleClickTab(e)}}},[c._v("\n                    "+c._s(e.i18nKey?c.$t(e.i18nKey):e.title)+"\n                  ")]):c._e()])}))],2)]:c._e(),c._v(" "),c.isUseTagFilter?c._e():[c.isShowRecently(e)?d("SwiperList",{key:e.id,attrs:{scrollChange:c.itemScroll,bntTop:"-20px",iconBntWidth:28,height:"98px",top:"0px",listGap:"15px"}},c._l(null==e?void 0:e.elList,(function(t,n){var o,l;return d("div",{key:"recently_".concat(n),staticClass:"card-item card-item-rence"},[c.isFilterNotUsedAdditionalModel(t)?d("RecentlyItem",{attrs:{item:t,isAdditionalModel:c.isAdditionalModel,logEventPosition:"create_flow,".concat(null===(o=c.curActiveTabObj)||void 0===o?void 0:o.id,",").concat(null===(l=c.curActiveTabObj)||void 0===l?void 0:l.title,",").concat(c.curPageIndex,",").concat(e.id,",").concat(e.title,",").concat(n)},on:{handleItemSelect:c.handleItemSelect}}):c._e()],1)})),0):c._e(),c._v(" "),[25,"25"].includes(e.content_type)?d("HyBannerCard",{attrs:{info:e,marginBottom:0,isModelPop:!0,source:c.subSource},on:{handleItemSelect:c.handleItemSelect}}):c._e(),c._v(" "),c.shouldShowRecommendBox(e)?d("div",{key:e.id,staticClass:"recommend-box dot-group"},[d("div",{staticClass:"recommend-header"},[d("div",[c._v("\n                    "+c._s(e.title)+"\n                  ")]),c._v(" "),c.shouldShowMoreButton(e)?d("div",{staticClass:"recommend-header-more",on:{click:function(t){return c.handleClickMore(e)}}},[c._v("\n                    "+c._s(c.$t("more"))+"\n                    "),d("i",{staticClass:"el-icon-arrow-right"})]):c._e()]),c._v(" "),d("SwiperList",{attrs:{scrollChange:c.itemScroll,top:"0",bntTop:"-20px",iconBntWidth:28,height:c.getSwiperListHeight(e),listGap:"16px"}},[c._l(null==e?void 0:e.elList,(function(t,n){var o,l,r,v,m,h;return[c.isFilterNotUsedAdditionalModel(t)?d("div",{key:"ele_".concat(null==t?void 0:t.id,"_").concat(n),staticClass:"card-item",attrs:{"data-info":JSON.stringify(c.dataInfo(t,n,null==e?void 0:e.id))}},[[13,"13"].includes(e.content_type)?[d("HyVidepEffectsPop",{attrs:{item:t,index:n},on:{handleClose:c.handleClose}})]:24==+(null==e?void 0:e.content_type)?[2===(null==t?void 0:t.obj_type)?d("ModelItemDes",{attrs:{logEventPosition:"create_flow,".concat(null===(o=c.curActiveTabObj)||void 0===o?void 0:o.id,",").concat(null===(l=c.curActiveTabObj)||void 0===l?void 0:l.title,",").concat(c.curPageIndex,",").concat(c.isUseTagFilter?c.realTab:e.id,",").concat(c.isUseTagFilter?c.activeTabDynamicTitle:e.title,",").concat(n),item:t,selectedId:c.selectedId,logData:c.dataInfo(t,n,null==e?void 0:e.id),isAdditionalModel:c.isAdditionalModel,additionalBaseModels:c.ADDITION_MODEL_TYPES},on:{handleItemSelect:c.handleItemSelect}}):c._e()]:[2===(null==t?void 0:t.obj_type)?d("ModelItem",{attrs:{logEventPosition:"create_flow,".concat(null===(r=c.curActiveTabObj)||void 0===r?void 0:r.id,",").concat(null===(v=c.curActiveTabObj)||void 0===v?void 0:v.title,",").concat(c.curPageIndex,",").concat(c.isUseTagFilter?c.realTab:e.id,",").concat(c.isUseTagFilter?c.activeTabDynamicTitle:e.title,",").concat(n),item:t,selectedId:c.selectedId,logData:c.dataInfo(t,n,null==e?void 0:e.id),isAdditionalModel:c.isAdditionalModel,additionalBaseModels:c.ADDITION_MODEL_TYPES},on:{handleItemSelect:c.handleItemSelect}}):c._e()],c._v(" "),[14,60,20].includes(null==t?void 0:t.obj_type)?d("FastAppItem",{attrs:{logEventPosition:"create_flow,".concat(null===(m=c.curActiveTabObj)||void 0===m?void 0:m.id,",").concat(null===(h=c.curActiveTabObj)||void 0===h?void 0:h.title,",").concat(c.curPageIndex,",").concat(c.isUseTagFilter?c.realTab:e.id,",").concat(c.isUseTagFilter?c.activeTabDynamicTitle:e.title,",").concat(n),item:t,firstIndex:0===n,lastIndex:n===(null==e?void 0:e.elList.length)-1,selectedId:c.selectedId,logData:c.dataInfo(t,n,null==e?void 0:e.id)},on:{handleItemSelect:c.handleItemSelect}}):c._e()],2):c._e()]}))],2)],1):c._e()]]}))]],2):c._e(),c._v(" "),c.dynamicData?c._e():d("div",{staticClass:"wrapper-container-2",style:{minHeight:c.list.length?"80vh":"40vh"}},[d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.pageLoading,expression:"pageLoading"}],staticClass:"loading-box"}),c._v(" "),c.list.length?[d("div",{staticClass:"components-list-wrapper",style:{gridTemplateColumns:"repeat(".concat(c.gridNum,", 1fr)")}},[c._l(c.list,(function(e,t){return d("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:c.handleVisibility,expression:"handleVisibility"}],key:t,staticClass:"card-item",attrs:{"data-info":JSON.stringify(c.dataInfo(e,t))}},[c.isShowModelItem?d("ModelItem",{attrs:{item:e,selectedId:c.selectedId,logData:c.dataInfo(e,t),isAdditionalModel:c.isAdditionalModel,additionalBaseModels:c.ADDITION_MODEL_TYPES},on:{unFavorite:c.unFavorite,handleItemSelect:c.handleItemSelect}}):c._e(),c._v(" "),"aiApp"===c.myTab?d("FastAppItem",{attrs:{item:e,selectedId:c.selectedId,logData:c.dataInfo(e,t)},on:{unFavorite:c.unFavorite,handleItemSelect:c.handleItemSelect}}):c._e()],1)})),c._v(" "),c.emptyNumber>0?c._l(c.emptyNumber,(function(e){return d("div",{key:"empty"+e,staticClass:"card-item-empty",style:{height:c.list.length&&2===c.list[0].obj_type&&5===c.gridNum?"340px":"280px"}})})):c._e()],2)]:c._e(),c._v(" "),c.isShowListNoData?[d("NoData")]:c._e()],2),c._v(" "),c.isShowSquareList?d("SquareList",{ref:"squareList",attrs:{baseModels:c.baseModels,baseModelType:c.baseModelType,source:null===(r=c.easyTop)||void 0===r?void 0:r.currentTab,subSource:c.subSource,isAdditionalModel:c.isAdditionalModel,isImageTrainModel:c.isImageTrainModel,activeTab:c.dynamicData?c.currentActiveTab:c.myTab,gridNum:c.gridNum,"margin-top":c.searchIng||c.isUseTagFilter?"16px":"22px","source-channel":c.sourceChannel,activeTabInfo:c.curActiveTabObj},on:{handleItemSelect:c.handleItemSelect},model:{value:c.keyword,callback:function(e){c.keyword=e},expression:"keyword"}}):c._e()],1)])],2)}),[],!1,null,"094b9a71",null);t.default=component.exports;installComponents(component,{NoData:n(129).default})},4092:function(e,t,n){"use strict";n(1733)},4157:function(e,t,n){"use strict";n(1799)},4158:function(e,t,n){"use strict";n(1800)},4159:function(e,t,n){"use strict";n(1801)},4231:function(e,t,n){"use strict";n(1808)},4232:function(e,t,n){"use strict";n(1809)},4233:function(e,t,n){"use strict";n(1810)},4249:function(e,t,n){"use strict";n(1825)},4250:function(e,t,n){"use strict";n(1826)},4251:function(e,t,n){"use strict";n(1827)},4252:function(e,t,n){"use strict";n(1828)},4253:function(e,t,n){"use strict";n(1829)},4254:function(e,t,n){"use strict";n(1830)},4262:function(e,t,n){"use strict";n(1838)},4263:function(e,t,n){"use strict";n(1839)},4264:function(e,t,n){"use strict";n(1840)},4265:function(e,t,n){"use strict";n(1841)},4269:function(e,t,n){"use strict";n(1845)},4271:function(e,t,n){"use strict";n(1847)},4272:function(e,t,n){"use strict";n(1848)},4273:function(e,t,n){"use strict";n(1849)},4275:function(e,t,n){"use strict";n(1851)},4276:function(e,t,n){"use strict";n(1852)},4277:function(e,t,n){"use strict";n(1853)},4280:function(e,t,n){"use strict";n(1856)},4281:function(e,t,n){"use strict";n(1857)},4286:function(e,t,n){"use strict";n(1862)},4287:function(e,t,n){"use strict";n(1863)},4288:function(e,t,n){"use strict";n(1864)},4289:function(e,t,n){"use strict";n(1865)},4290:function(e,t,n){"use strict";n(1866)},4295:function(e,t,n){"use strict";n(1870)},4296:function(e,t,n){"use strict";n(1871)},4297:function(e,t,n){"use strict";n(1872)},4298:function(e,t,n){"use strict";n(1873)},4299:function(e,t,n){"use strict";n(1874)},4300:function(e,t,n){"use strict";n(1875)},4301:function(e,t,n){"use strict";n(1876)},4308:function(e,t,n){"use strict";n(1878)},4309:function(e,t,n){"use strict";n(1879)},4310:function(e,t,n){"use strict";n(1880)},4311:function(e,t,n){"use strict";n(1881)},4312:function(e,t,n){"use strict";n(1882)},4313:function(e,t,n){"use strict";n(1883)},4314:function(e,t,n){"use strict";n(1884)},4315:function(e,t,n){"use strict";n(1885)},4316:function(e,t,n){"use strict";n(1886)},4317:function(e,t,n){"use strict";n(1887)},4318:function(e,t,n){"use strict";n(1888)},4319:function(e,t,n){"use strict";n(1889)},4320:function(e,t,n){"use strict";n(1890)},4321:function(e,t,n){"use strict";n(1891)},4322:function(e,t,n){"use strict";n(1892)},4323:function(e,t,n){"use strict";n(1893)},4324:function(e,t,n){"use strict";n(1894)},4325:function(e,t,n){"use strict";n(1895)},4326:function(e,t,n){"use strict";n(1896)},4327:function(e,t,n){"use strict";n(1897)},4328:function(e,t,n){"use strict";n(1898)},4329:function(e,t,n){"use strict";n(1899)},4330:function(e,t,n){"use strict";n(1900)},4331:function(e,t,n){"use strict";n(1901)},4332:function(e,t,n){"use strict";n(1902)},4333:function(e,t,n){"use strict";n(1903)},4334:function(e,t,n){"use strict";n(1904)},4336:function(e,t,n){"use strict";n(1906)},4337:function(e,t,n){"use strict";n(1907)},4338:function(e,t,n){"use strict";n(1908)},4339:function(e,t,n){"use strict";n(1909)},4340:function(e,t,n){"use strict";n(1910)},4343:function(e,t,n){"use strict";n(1913)},4344:function(e,t,n){"use strict";n(1914)},4345:function(e,t,n){"use strict";n(1915)},4346:function(e,t,n){"use strict";n(1916)},4347:function(e,t,n){"use strict";n(1917)},4348:function(e,t,n){"use strict";n(1918)},4350:function(e,t,n){"use strict";n(1920)},4351:function(e,t,n){"use strict";n(1921)},4353:function(e,t,n){"use strict";n(1923)},4354:function(e,t,n){"use strict";n(1924)},4355:function(e,t,n){"use strict";n(1925)},4356:function(e,t,n){"use strict";n(1926)},4358:function(e,t,n){"use strict";n(1928)},4359:function(e,t,n){"use strict";n(1929)},4360:function(e,t,n){"use strict";n(1930)},4361:function(e,t,n){"use strict";n(1931)},4362:function(e,t,n){"use strict";n(1932)},4363:function(e,t,n){"use strict";n(1933)},4364:function(e,t,n){"use strict";n(1934)},4365:function(e,t,n){"use strict";n(1935)},4366:function(e,t,n){"use strict";n(1936)},4367:function(e,t,n){"use strict";n(1937)},4368:function(e,t,n){"use strict";n(1938)},4369:function(e,t,n){"use strict";n(1939)},4370:function(e,t,n){"use strict";n(1940)},4371:function(e,t,n){"use strict";n(1941)},4372:function(e,t,n){"use strict";n(1942)},4373:function(e,t,n){"use strict";n(1943)},4374:function(e,t,n){"use strict";n(1944)},4380:function(e,t,n){"use strict";n(1950)},4381:function(e,t,n){"use strict";n(1951)},4383:function(e,t,n){"use strict";n(1953)},4384:function(e,t,n){"use strict";n(1954)},4385:function(e,t,n){"use strict";n(1955)},4386:function(e,t,n){"use strict";n(1956)},4394:function(e,t,n){"use strict";n(1963)},4395:function(e,t,n){"use strict";n(1964)},4396:function(e,t,n){"use strict";n(1965)},4397:function(e,t,n){"use strict";n(1966)},4398:function(e,t,n){"use strict";n(1967)},4399:function(e,t,n){"use strict";n(1968)},4400:function(e,t,n){"use strict";n(1969)},4401:function(e,t,n){"use strict";n(1970)},4402:function(e,t,n){"use strict";n(1971)},4403:function(e,t,n){"use strict";n(1972)},4405:function(e,t,n){"use strict";n(1974)},4406:function(e,t,n){"use strict";n(1975)},4407:function(e,t,n){"use strict";n(1976)},4408:function(e,t,n){"use strict";n(1977)},4409:function(e,t,n){"use strict";n(1978)},4410:function(e,t,n){"use strict";n(1979)},4411:function(e,t,n){"use strict";n(1980)},4413:function(e,t,n){"use strict";n(1982)},4414:function(e,t,n){"use strict";n(1983)},4415:function(e,t,n){"use strict";n(1984)},4416:function(e,t,n){"use strict";n(1985)},4417:function(e,t,n){"use strict";n(1986)},4418:function(e,t,n){"use strict";n(1987)},4419:function(e,t,n){"use strict";n(1988)},4420:function(e,t,n){"use strict";n(1989)},4421:function(e,t,n){"use strict";n(1990)},4422:function(e,t,n){"use strict";n(1991)},4423:function(e,t,n){"use strict";n(1992)},4424:function(e,t,n){"use strict";n(1993)},4425:function(e,t,n){"use strict";n(1994)},4426:function(e,t,n){"use strict";n(1995)},4427:function(e,t,n){"use strict";n(1996)},4428:function(e,t,n){"use strict";n(1997)},4429:function(e,t,n){"use strict";n(1998)},4430:function(e,t,n){"use strict";n(1999)},4431:function(e,t,n){"use strict";n(2e3)},4432:function(e,t,n){"use strict";n(2001)},4433:function(e,t,n){"use strict";n(2002)},4434:function(e,t,n){"use strict";n(2003)},4435:function(e,t,n){"use strict";n(2004)},4436:function(e,t,n){"use strict";n(2005)},4437:function(e,t,n){"use strict";n(2006)},4439:function(e,t,n){"use strict";n(2007)},4440:function(e,t,n){"use strict";n(2008)},4442:function(e,t,n){"use strict";n(2010)},4443:function(e,t,n){"use strict";n(2011)},4444:function(e,t,n){"use strict";n(2012)},4445:function(e,t,n){"use strict";n(2013)},4446:function(e,t,n){"use strict";n(2014)},4447:function(e,t,n){"use strict";n(2015)},4448:function(e,t,n){"use strict";n(2016)},4449:function(e,t,n){"use strict";n(2017)},4450:function(e,t,n){"use strict";n(2018)},4451:function(e,t,n){"use strict";n(2019)},4452:function(e,t,n){"use strict";n(2020)},4453:function(e,t,n){"use strict";n(2021)},4454:function(e,t,n){"use strict";n(2022)},4455:function(e,t,n){"use strict";n(2023)},4457:function(e,t,n){"use strict";n(2025)},4458:function(e,t,n){"use strict";n(2026)},4459:function(e,t,n){"use strict";n(2027)},4460:function(e,t,n){"use strict";n(2028)},469:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8);var o=n(30),l=n(2),r=(n(16),n(22),n(18),n(4),n(21),n(90),n(7),n(901)),c=n(583),d=n(1);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={mixins:[c.a],components:{GuestUpload:r.a},props:{uploadObj:{type:Object,default:function(){}},enableDragUpload:{type:Boolean,default:!0}},computed:m({},Object(d.c)("user",["isLoggedIn"])),data:function(){return{guestUploadStorageMapId:"generate_video_or_effect_guest",imgUrl:"",resultList:[],uploading:!1,category:20,isDragOver:!1,isDragUpload:!1,isFromSeaArtDrag:!1}},methods:{handleUpload:function(){this.isLoggedIn&&this.$emit("handleUpload")},handleDelete:function(){this.$emit("handleDelete")},removeImage:function(){this.imgUrl="",this.resultList.forEach((function(e){e.url=""})),this.uploading=!1},setGuestUploadSrcData:function(e){var t=Object(o.a)(e,1)[0];this.removeImage(),this.imgUrl=t.url,this.resultList=[{url:this.imgUrl,prompt:""}];var n=this.isDragUpload;this.isDragUpload&&this.isFromSeaArtDrag&&this.$xyLogEvent({front_operation:"click",entity_name:"generate_video_drag_upload_success",entity_type:"generate_video_drag_upload",event_name:"log_action_front",obj_desc:"aiVideo",obj_info:{status:!0}}),this.$emit("uploadHandleConfirm",[t],n),this.isDragUpload=!1,this.isFromSeaArtDrag=!1,this.storageGuestUploadTempData&&this.storageGuestUploadTempData([m(m({},t),{},{category:this.category})])},startGuestPendingUploadFile:function(){this.uploading=!0},uploadFail:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.uploading=!1,this.isDragUpload&&this.isFromSeaArtDrag&&this.$xyLogEvent({front_operation:"click",entity_name:"generate_video_drag_upload_fail",entity_type:"generate_video_drag_upload",event_name:"log_action_front",obj_desc:"aiVideo",obj_info:{status:!1}}),this.isDragUpload=!1,this.isFromSeaArtDrag=!1,this.saveGuestPendingUploadFile&&this.saveGuestPendingUploadFile(t.map((function(t){return m(m({},t),{},{category:e.category})})))},handleLoggedUserUploadSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.uploading=!1;var t=this.isDragUpload;this.isDragUpload&&this.isFromSeaArtDrag&&this.$xyLogEvent({front_operation:"click",entity_name:"generate_video_drag_upload_success",entity_type:"generate_video_drag_upload",event_name:"log_action_front",obj_desc:"aiVideo",obj_info:{status:!0}}),this.$emit("uploadHandleConfirm",e,t),this.isDragUpload=!1,this.isFromSeaArtDrag=!1},handleDragEnter:function(e){e.preventDefault(),e.stopPropagation(),!this.uploading&&this.enableDragUpload&&(this.isDragOver=!0)},handleDragLeave:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,n=e.relatedTarget;n&&t.contains(n)||(this.isDragOver=!1)},handleDrop:function(e){var t;if(e.preventDefault(),e.stopPropagation(),this.isDragOver=!1,!this.uploading&&this.enableDragUpload){var n=e.dataTransfer.files,o=e.dataTransfer.getData("text/uri-list");if(o&&null!==(t=String(o))&&void 0!==t&&t.includes("seaart"))this.handleDragUrl(o);else if(n.length>0){var l=n[0];l.type.startsWith("image/")&&this.processDragFile(l)}}},handleDragUrl:function(e){var t={url:e};this.isDragUpload=!0,this.isFromSeaArtDrag=!0,this.setGuestUploadSrcData([t])},processDragFile:function(e){if(e){var t={name:e.name,raw:e,percentage:0,status:"ready",uid:Date.now(),size:e.size};this.isDragUpload=!0,this.isFromSeaArtDrag=!1,this.uploading=!0,this.$refs.guestUploadRef?this.$refs.guestUploadRef.handleChange(t,[t]):this.$refs.hiddenGuestUploadRef?this.$refs.hiddenGuestUploadRef.handleChange(t,[t]):(this.uploading=!1,this.$emit("handleDragUpload",t))}}}},f=h,_=(n(4275),n(0)),component=Object(_.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"video-upload-box"},[e.isLoggedIn?[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"upload-content",class:{"drag-over":e.enableDragUpload&&e.isDragOver},on:{dragover:function(t){return t.preventDefault(),e.handleDragEnter.apply(null,arguments)},dragleave:function(t){return t.preventDefault(),e.handleDragLeave.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.handleDrop.apply(null,arguments)}}},[e._t("default")],2),e._v(" "),t("GuestUpload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"hiddenGuestUploadRef",attrs:{fileTypes:["image"],category:e.category,uploadObj:e.uploadObj},on:{onUploadStart:function(t){e.uploading=!0},onUploadSuccess:e.handleLoggedUserUploadSuccess,onUploadFail:e.uploadFail}})]:[t("GuestUpload",{ref:"guestUploadRef",attrs:{fileTypes:["image"],category:e.category,uploadObj:e.uploadObj,"data-event":"generate_video_guest_upload_btn"},on:{onUploadStart:function(t){e.uploading=!0},onUploadSuccess:e.setGuestUploadSrcData,onUploadFail:e.uploadFail}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"upload-content",class:{"drag-over":e.enableDragUpload&&e.isDragOver},on:{dragover:function(t){return t.preventDefault(),e.handleDragEnter.apply(null,arguments)},dragleave:function(t){return t.preventDefault(),e.handleDragLeave.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.handleDrop.apply(null,arguments)}}},[e._t("default")],2)])]],2)}),[],!1,null,"e131998c",null);t.default=component.exports},470:function(e,t,n){"use strict";n.r(t);n(6),n(32),n(16),n(18),n(8),n(4);var o=n(3290),l=n(3293),r=n(3294),c=n(3295),d=n(33),v=n(3297),m={name:"ImageToImageCard",components:{ImageToImageOptionModal:o.default,ControlNetOptionModal:l.default,IpMainOptionModal:r.default,StyleReferenceOptionModal:c.default,ImageToVideoOptionModal:v.default},inject:["easyTop"],props:{cardInfo:{type:Object,default:function(){return{}}},value:{type:Object,default:function(){return{}}},type:{type:String,default:""},menuIndex:{type:String,default:""}},data:function(){return{}},computed:{showImageWeight:function(){var e="imageToVideo"!==this.type,t="imageToLive2D"!==this.type;return e&&t},getImageUrl:function(){var e,t,n,o,l,r,c,d,v="";return"IpMaintain"===this.type||"styleReference"===this.type?null===(e=this.cardInfo)||void 0===e?void 0:e.image:(v=this.cardInfo.url||(null===(t=this.cardInfo)||void 0===t?void 0:t.input_image),["imageToVideo","imageToLive2D"].includes(this.type)?"first_frame"===(null===(n=this.cardInfo)||void 0===n?void 0:n.mode)||"last_frame"===(null===(o=this.cardInfo)||void 0===o?void 0:o.mode)?(null===(r=this.cardInfo)||void 0===r?void 0:r.firstFrame)||(null===(c=this.cardInfo)||void 0===c?void 0:c.lastFrame)||(null===(d=this.cardInfo)||void 0===d?void 0:d.url):null===(l=this.cardInfo)||void 0===l?void 0:l.url:v)},isDisable:function(){return!1},getWeightText:function(){var e,t,n=this,text="";if("image"===this.type)return null===(e=this.cardInfo)||void 0===e?void 0:e.denoising_strength;if(["controlNet","IpMaintain"].includes(this.type))return null===(t=this.cardInfo)||void 0===t?void 0:t.weight;if("styleReference"===this.type){var o=d.DEFAULT_STYLE_REFERENCE_LIST.find((function(e){var t;return e.code===(null===(t=n.cardInfo)||void 0===t?void 0:t.weight)}));text=(null==o?void 0:o.name)||""}return text},getTypeText:function(){var e,t,text="";if("image"===this.type)return"img2img";if(["controlNet"].includes(this.type))return null===(e=this.cardInfo)||void 0===e?void 0:e.type;("IpMaintain"===this.type&&(text=this.$t("studio46")),"styleReference"===this.type&&(text=this.$t("newGenerate79")),"imageToVideo"===this.type)&&(text="live2d"===(null==this||null===(t=this.source)||void 0===t?void 0:t.mode)?this.$t("newGenerate122"):this.$t("newGenerate106"));return text},getIconClass:function(){return{image:"icon-icon_imageToImage",IpMaintain:"icon-personal_info",controlNet:"icon-icon_conditionToImage",styleReference:"icon-icon-fenggecankao",imageToVideo:"icon-pause",imageToLive2D:"icon-pause"}[this.type]||""}},methods:{handleDisable:function(){var e;"controlNet"===this.type&&this.$logEvent("log_actions",{operation:"click_hide",behavior_info:"on_new_create_flow_page",behavior_info_sub:null===(e=this.cardInfo)||void 0===e?void 0:e.type});this.$emit("changeEnableStatus",this.cardInfo),this.$set(this.cardInfo,"enable",!1)},handleEnable:function(){this.$emit("changeEnableStatus",this.cardInfo),this.$set(this.cardInfo,"enable",!0)},handleDelete:function(){if("IpMaintain"!==this.type)"image"!==this.type?("controlNet"===this.type&&this.$emit("delete"),"styleReference"===this.type&&this.$emit("delete"),"imageToVideo"===this.type&&this.$emit("delete")):this.easyTop.updateConfig({imageToImageList:[]},this.menuIndex);else try{var e=JSON.parse(JSON.stringify(this.value));e.ipList=[],e.lab_base.conds=(e.lab_base.conds||[]).filter((function(e){return"IpMaintain"!==(null==e?void 0:e.mode)})),this.easyTop.updateConfig(e,this.menuIndex)}catch(e){}},handleOpenModal:function(){if(!this.isDisable){var e;if("image"===this.type&&this.$refs.imageToImageOptionModal.show(),"controlNet"===this.type)this.$refs.controlNetOptionModal.show(),this.$logEvent("log_actions",{operation:"click_delete",behavior_info:"on_new_create_flow_page",behavior_info_sub:null===(e=this.cardInfo)||void 0===e?void 0:e.type});"IpMaintain"===this.type&&this.$refs.ipMainOptionModal.show(),"styleReference"===this.type&&this.$refs.styleReferenceOptionModal.show(),"imageToVideo"===this.type&&this.$refs.imageToVideoOptionModal.show()}}}},h=(n(4324),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-image-to-image-card",class:[e.isDisable&&"image-to-image-card-disable","imageToVideo"===e.type&&"image-to-video-image-card"]},[t("div",{staticClass:"image-box"},[e.getImageUrl?t("img",{attrs:{src:e.getImageUrl,alt:""}}):e._e()]),e._v(" "),t("div",{staticClass:"image-box-mask",class:[e.isDisable&&"image-box-mask-black"],on:{click:function(t){return t.stopPropagation(),e.handleOpenModal.apply(null,arguments)}}},[e.getImageUrl?t("span",{staticClass:"image-box-top-btn image-box-top-btn-right",on:{click:function(t){return t.stopPropagation(),e.handleDelete.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-close"})]):e._e(),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.isDisable,expression:"isDisable"}],staticClass:"image-box-top-enable-btn",on:{click:function(t){return t.stopPropagation(),e.handleEnable.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-switch-button"}),t("span",[e._v("Enable")])])]),e._v(" "),"imageToVideo"===e.type&&e.getImageUrl?t("div",{staticClass:"type-icon"},[t("i",{staticClass:"iconfont icon-icon-fenggecankao"})]):e._e(),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.isDisable&&e.showImageWeight,expression:"!isDisable && showImageWeight"}],staticClass:"image-box-weight"},[e._v(e._s(e.getWeightText))]),e._v(" "),"imageToVideo"!==e.type?t("div",{staticClass:"image-box-bottom"},[t("div",{staticClass:"image-box-bottom-text"},[t("span",{staticClass:"image-box-bottom-text-icon iconfont",class:e.getIconClass}),e._v(" "),t("span",{staticClass:"image-box-bottom-text-content"},[e._v(e._s(e.getTypeText))])]),e._v(" "),t("span",{staticClass:"image-box-bottom-icon el-icon-caret-bottom"})]):e._e(),e._v(" "),t("image-to-image-option-modal",{ref:"imageToImageOptionModal",attrs:{value:e.cardInfo,source:e.cardInfo,"menu-index":e.menuIndex}}),e._v(" "),t("image-to-video-option-modal",{ref:"imageToVideoOptionModal",attrs:{value:e.cardInfo,source:e.cardInfo,"menu-index":e.menuIndex}}),e._v(" "),t("control-net-option-modal",{ref:"controlNetOptionModal",attrs:{value:e.cardInfo,source:e.cardInfo,"menu-index":e.menuIndex},on:{delete:e.handleDelete}}),e._v(" "),t("ip-main-option-modal",{ref:"ipMainOptionModal",attrs:{value:e.cardInfo,source:e.cardInfo,"menu-index":e.menuIndex},on:{delete:e.handleDelete}}),e._v(" "),t("style-reference-option-modal",{ref:"styleReferenceOptionModal",attrs:{value:e.cardInfo,source:e.cardInfo,"menu-index":e.menuIndex},on:{delete:e.handleDelete}})],1)}),[],!1,null,"bcd09564",null);t.default=component.exports},471:function(e,t,n){"use strict";n.r(t);n(19),n(31),n(24);var o=n(25),l={name:"textOverflowArea",props:{lineNum:{type:Number,default:4},showExport:{type:Boolean,default:!0},whiteSpace:{type:String,default:"normal"}},data:function(){return{key:Object(o.uniqueId)("text-overflow-area"),packUpStatus:!1,showExpBtn:!1,lineNumTemp:0,bottom:"-22px",maxHeight:""}},watch:{packUpStatus:{handler:function(e){e?(this.lineNumTemp=999,this.maxHeight="none"):(this.lineNumTemp=this.lineNum,this.maxHeight="calc(".concat(this.lineNum," * var(--base-size-20))"))},immediate:!0}},mounted:function(){this.lineNumTemp=this.lineNum,this.getBtnHeight();new MutationObserver(this.handleShowExp).observe(this.$refs.textContent,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})},methods:{getBtnHeight:function(){var e=this.$refs.optBtn.offsetHeight;this.bottom="-".concat(e,"px")},handleShowExp:function(){try{var e=this.$refs.textContent;e.scrollHeight>e.clientHeight&&(this.showExpBtn=!0,this.getBtnHeight())}catch(e){}}}},r=(n(4358),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-overflow-area"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.packUpStatus,expression:"packUpStatus"},{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"exp",attrs:{type:"checkbox",id:e.key},domProps:{checked:Array.isArray(e.packUpStatus)?e._i(e.packUpStatus,null)>-1:e.packUpStatus},on:{change:function(t){var n=e.packUpStatus,o=t.target,l=!!o.checked;if(Array.isArray(n)){var r=e._i(n,null);o.checked?r<0&&(e.packUpStatus=n.concat([null])):r>-1&&(e.packUpStatus=n.slice(0,r).concat(n.slice(r+1)))}else e.packUpStatus=l}}}),e._v(" "),t("div",{ref:"textContent",staticClass:"text",style:{"--bottom":e.bottom,"-webkit-line-clamp":e.lineNumTemp,"max-height":e.maxHeight,"white-space":e.whiteSpace}},[t("label",{directives:[{name:"show",rawName:"v-show",value:e.showExport&&e.showExpBtn,expression:"showExport && showExpBtn"}],ref:"optBtn",staticClass:"btn",attrs:{for:e.key,"data-content":e.packUpStatus?e.$t("PackUp"):e.$t("Unfold")}}),e._v(" "),e._t("default")],2)])}),[],!1,null,"8a477b20",null);t.default=component.exports},5320:function(e,t,n){"use strict";n(2746)},5468:function(e,t,n){"use strict";n(2886)},561:function(e,t,n){"use strict";n.r(t);n(19),n(11),n(6),n(12),n(13),n(4),n(7);var o=n(14),l=n(2),r=(n(16),n(22),n(8),n(1)),c=n(596),d=n(137),v=n(288);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"EasyAdvanceRepairModal",props:{value:{type:Object,default:function(){return{}}},isShowUpscale:{type:Boolean,default:!0}},components:{AdditionalPanelCardItem:c.default,SliderItem:d.default,EasyStyleModal:v.default},data:function(){return{visible:!1,enableAdModel:!1,config:{hr_upscaler:"",ad_model:"",ad_units:{lora:{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""},restore_faces:!1},characterRepairSelectList:[{code:"face",i18nKey:"repairType1"},{code:"hand",i18nKey:"repairType2"},{code:"body",i18nKey:"repairType3"}],showLora:!1,showPrompt:!1,showNegativePrompt:!1}},computed:h(h({},Object(r.c)("creation",["hr_upscaler"])),{},{renderList:function(){var e=(this.hr_upscaler||[]).map((function(e){return{label:e,code:e}}));return[{code:"",label:this.$t("none")}].concat(Object(o.a)(e))}}),methods:{handleSelectModel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"LORA"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")&&(this.config.ad_units.lora=h({model_id:e.id,weight:1},e),this.showLora=!0),this.$refs.easyStyleModal.handleClose()},handleDeleteLora:function(){this.config.ad_units.lora={},this.showLora=!1},openLoraPick:function(){this.$refs.easyStyleModal.openModal("LORA")},changeConfig:function(e,t){["ad_confidence","ad_denoising_strength"].includes(t)?this.$set(this.config.ad_units,t,e):this.$set(this.config,t,e)},handleChangeWeight:function(e){try{this.config.ad_units.lora.weight=e}catch(e){}},handleDeleteModel:function(){this.config.ad_units.lora={}},handleSelectRepairChange:function(e){this.config.ad_model=e?"face":""},changeShowLoraStatus:function(){this.showLora=!this.showLora},changeShowPromptStatus:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";["el-textarea__inner"].includes(null==e||null===(t=e.target)||void 0===t?void 0:t.className)||("negative_prompt"!==n?this.showPrompt=!this.showPrompt:this.showNegativePrompt=!this.showNegativePrompt)},show:function(){this.resetData(),this.initData(),this.visible=!0},resetData:function(){this.enableAdModel=!1,this.config={hr_upscaler:"",ad_model:"",ad_units:{lora:{},ad_denoising_strength:.3,ad_confidence:.3,prompt:"",negative_prompt:""},restore_faces:!1},this.showLora=!1,this.showPrompt=!1,this.showNegativePrompt=!1},initData:function(){this.config.hr_upscaler=this.value.hr_upscaler,this.config.ad_model=this.value.ad_model,this.enableAdModel=""!==this.value.ad_model,this.config.ad_units=JSON.parse(JSON.stringify(this.value.ad_units)),this.config.restore_faces=this.value.restore_faces},handleClose:function(){this.visible=!1},handleConfirm:function(){this.$emit("updateData",this.config),this.handleClose()},selectRepair:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config.ad_model=null==e?void 0:e.code}}},_=f,y=(n(4287),n(0)),component=Object(y.a)(_,(function(){var e,t,n=this,o=n._self._c;return o("el-dialog",{attrs:{visible:n.visible,"custom-class":"easy-advance-repair-modal custom-dialog",title:n.$t("AdvancedRepair"),"destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(e){n.visible=e}}},[o("div",{staticClass:"modal-header"},[o("div",{staticClass:"modal-header-title"}),n._v(" "),o("span",{staticClass:"modal-header-close",on:{click:function(e){return e.stopPropagation(),n.handleClose()}}},[o("i",{staticClass:"el-icon-close"})])]),n._v(" "),o("div",{staticClass:"modal-content"},[n.isShowUpscale?o("div",{staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-label"},[n._v(n._s(n.$t("taskTabUpscale")))]),n._v(" "),o("div",{staticClass:"modal-content-item-content"},[o("el-select",{staticClass:"easy-custom-select",attrs:{"popper-append-to-body":!0,"popper-class":"custom-select"},model:{value:n.config.hr_upscaler,callback:function(e){n.$set(n.config,"hr_upscaler",e)},expression:"config.hr_upscaler"}},n._l(n.renderList,(function(e,i){return o("el-option",{key:"method_"+i,attrs:{label:e.label,value:e.code}},[o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"dark",content:e.label,placement:"top-start"}},[o("span",[n._v(n._s(e.label))])])],1)})),1)],1)]):n._e(),n._v(" "),o("div",{staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-label modal-content-item-label-flex"},[o("span",{staticClass:"content-item-label-text"},[n._v(n._s(n.$t("RestoreFaces")))]),n._v(" "),o("el-switch",{attrs:{"active-color":"#3F8CFF"},model:{value:n.config.restore_faces,callback:function(e){n.$set(n.config,"restore_faces",e)},expression:"config.restore_faces"}})],1)]),n._v(" "),o("div",{staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-label modal-content-item-label-flex"},[o("span",{staticClass:"content-item-label-text"},[n._v(n._s(n.$t("characterRepair")))]),n._v(" "),o("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:n.handleSelectRepairChange},model:{value:n.enableAdModel,callback:function(e){n.enableAdModel=e},expression:"enableAdModel"}})],1)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-content"},n._l(n.characterRepairSelectList,(function(e,t){return o("div",{key:"method_".concat(t,"_").concat(e.code),staticClass:"panel-item",class:[e.code===n.config.ad_model?"active-btn":""],on:{click:function(t){return t.stopPropagation(),n.selectRepair(e)}}},[n._v("\n          "+n._s(n.$t(e.i18nKey))+"\n        ")])})),0)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item-card"},[o("div",{staticClass:"lora-panel-title",class:[n.showLora&&"lora-panel-title-no-margin"],on:{click:function(e){var t;e.stopPropagation(),null!==(t=n.config)&&void 0!==t&&null!==(t=t.ad_units)&&void 0!==t&&null!==(t=t.lora)&&void 0!==t&&t.id?n.changeShowLoraStatus():n.openLoraPick()}}},[o("span",{staticClass:"lora-panel-title-text"},[n._v(n._s(n.$t("LoRA")))]),n._v(" "),o("span",{staticClass:"lora-panel-title-icon",class:null!==(e=n.config)&&void 0!==e&&null!==(e=e.ad_units)&&void 0!==e&&null!==(e=e.lora)&&void 0!==e&&e.id?n.showLora?"el-icon-arrow-up":"el-icon-arrow-down":"el-icon-circle-plus-outline"})]),n._v(" "),null!==(t=n.config)&&void 0!==t&&null!==(t=t.ad_units)&&void 0!==t&&null!==(t=t.lora)&&void 0!==t&&t.id?o("additional-panel-card-item",{directives:[{name:"show",rawName:"v-show",value:n.showLora,expression:"showLora"}],staticStyle:{"margin-top":"8px"},attrs:{showWarning:!1,modelInfo:n.config.ad_units.lora},on:{deleteItem:n.handleDeleteLora,changeWeight:n.handleChangeWeight}}):n._e()],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-label"},[n._v(n._s(n.$t("redrawingNoiseIntensity")))]),n._v(" "),o("div",{staticClass:"modal-content-item-content"},[o("slider-item",{attrs:{"hide-label":!0,value:n.config.ad_units.ad_denoising_strength,min:0,max:.5,step:.05},on:{change:function(e){return n.changeConfig(e,"ad_denoising_strength")}}})],1)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item"},[o("div",{staticClass:"modal-content-item-label"},[n._v(n._s(n.$t("Confidence")))]),n._v(" "),o("div",{staticClass:"modal-content-item-content"},[o("slider-item",{attrs:{"hide-label":!0,value:n.config.ad_units.ad_confidence,min:0,max:1,step:.1},on:{change:function(e){return n.changeConfig(e,"ad_confidence")}}})],1)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item-card",on:{click:function(e){return e.stopPropagation(),n.changeShowPromptStatus(e,"prompt")}}},[o("div",{staticClass:"lora-panel-title",class:[n.showPrompt&&"lora-panel-title-no-margin"]},[o("span",{staticClass:"lora-panel-title-text"},[n._v(n._s(n.$t("Prompt")))]),n._v(" "),o("span",{staticClass:"lora-panel-title-icon",class:n.showPrompt?"el-icon-arrow-up":"el-icon-arrow-down"})]),n._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:n.showPrompt,expression:"showPrompt"}],staticClass:"custom-input modal-content-item-card-input",attrs:{type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},model:{value:n.config.ad_units.prompt,callback:function(e){n.$set(n.config.ad_units,"prompt",e)},expression:"config.ad_units.prompt"}})],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!==n.config.ad_model,expression:"config.ad_model !== ''"}],staticClass:"modal-content-item-card",on:{click:function(e){return e.stopPropagation(),n.changeShowPromptStatus(e,"negative_prompt")}}},[o("div",{staticClass:"lora-panel-title",class:[n.showNegativePrompt&&"lora-panel-title-no-margin"]},[o("span",{staticClass:"lora-panel-title-text"},[n._v(n._s(n.$t("NegativePrompts")))]),n._v(" "),o("span",{staticClass:"lora-panel-title-icon",class:n.showNegativePrompt?"el-icon-arrow-up":"el-icon-arrow-down"})]),n._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:n.showNegativePrompt,expression:"showNegativePrompt"}],staticClass:"custom-input modal-content-item-card-input",attrs:{type:"textarea",autosize:{minRows:1.5,maxRows:3},max:1e3},model:{value:n.config.ad_units.negative_prompt,callback:function(e){n.$set(n.config.ad_units,"negative_prompt",e)},expression:"config.ad_units.negative_prompt"}})],1)]),n._v(" "),o("div",{staticClass:"modal-footer"},[o("span",{staticClass:"modal-footer-btn",on:{click:function(e){return e.stopPropagation(),n.handleClose()}}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(e){return e.stopPropagation(),n.handleConfirm()}}},[n._v(n._s(n.$t("Confirm")))])]),n._v(" "),o("easy-style-modal",{ref:"easyStyleModal",attrs:{"model-type":"LORA",inTask:!0,"hide-embedding":!0,"is-studio-mode":!0},on:{selectModel:n.handleSelectModel,deleteItem:n.handleDeleteModel}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default,EasyStyleModal:n(288).default})},562:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(7);var o=n(2),l=(n(6),n(32),n(8),n(4),n(137)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"EasyModeModal",inject:["easyTop"],props:{value:{type:Object,default:function(){return{}}},isAnimeEnhanceEnable:{type:Boolean,default:!1},isShowEngineMode:{type:Boolean,default:!0}},components:{SliderItem:l.default},data:function(){return{visible:!1,config:{vae:"vae-ft-mse-840000-ema-pruned",clip_skip:2,category:1,mode:1},modeList:[{code:1,value:0,label:"默认",i18nKey:"createModeType1",tips:"",logEvent:"default"},{code:2,value:1,label:"海艺V6",i18nKey:"createModeType2",tips:"createModeTips2",isVip:!0,logEvent:"seaArt_2.0"},{code:3,value:2,label:"海艺2.1",i18nKey:"createModeType6",tips:"createModeTips6",isVip:!0,logEvent:"seaArt_2.1"}],loading:!1}},computed:d(d(d({},Object(r.c)("creation",["taskVae","sd_xl_vae"])),Object(r.c)("user",["accountSettingsData","isCompanyAccount"])),{},{handleVaeList:function(){var e;return null!==(e=this.easyTop)&&void 0!==e&&e.isSDXLModel?this.sd_xl_vae:this.taskVae.filter((function(e){return"sdxl_vae"!==e}))},isVipFun:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.activeState)||(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)||this.isCompanyAccount},isOnlyVipLite:function(){var e,t;return!(null!==(e=this.paymentInfo)&&void 0!==e&&e.activeState)&&!this.isCompanyAccount&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.liteActiveState)},canUseUnlimitedQueue:function(){var e;return null===(e=this.paymentInfo)||void 0===e?void 0:e.infiniteQueue},queueRenderList:function(){return[{code:1,i18nKey:"NormalQueue",tips:"",show:!this.isVipFun},{code:2,i18nKey:"SubsBottomTerms2",tips:"",isVip:!0,show:this.isVipFun},{code:3,i18nKey:"UnlimitedQueue",tips:this.UnlimitedQueueTip,isVip:!0,show:!0}].filter((function(e){return e.show}))},UnlimitedQueueTip:function(){return this.isCompanyAccount?"ToBUnlimitedQueueTip":"UnlimitedQueueTip"},isStudioMode:function(){return!1}}),methods:d(d(d({},Object(r.b)("user",["getAccountInfo"])),Object(r.c)("payment",["paymentInfo"])),{},{show:function(){this.initData(),this.visible=!0},initData:function(){var e=this,t=this.modeList.find((function(t){var n;return t.value===(null===(n=e.value)||void 0===n||null===(n=n.generate)||void 0===n?void 0:n.mode)}));this.config.mode=t?null==t?void 0:t.code:1,this.config.vae=this.value.vae,this.config.clip_skip=this.value.clip_skip},handleClose:function(){this.visible=!1},handleConfirm:function(){var e=JSON.parse(JSON.stringify(this.config)),t=this.modeList.find((function(t){return t.code===(null==e?void 0:e.mode)}));e.mode=t?null==t?void 0:t.value:0,this.$logEvent("log_actions",{operation:"click_engine_select",behavior_info:"on_new_create_flow_page",behavior_info_sub:null==t?void 0:t.logEvent}),this.$emit("updateData",e),this.handleClose()},changeConfig:function(e,t){this.$set(this.config,t,e)}})},m=(n(4288),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"easy-mode-modal-modal custom-dialog",title:e.$t("VAE"),"destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"320px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"modal-header"},[t("div",{staticClass:"modal-header-title"}),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"modal-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isAnimeEnhanceEnable,expression:"!isAnimeEnhanceEnable"}],staticClass:"modal-content-item"},[t("div",{staticClass:"modal-content-item-label"},[e._v("\n        "+e._s(e.$t("VAE"))+"\n        "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t("vaeTips"),placement:"top-start"}},[t("i",{staticClass:"custom-tips el-icon-warning"})])],1),e._v(" "),t("div",{staticClass:"modal-content-item-content"},[t("el-select",{staticClass:"easy-custom-select",attrs:{"popper-append-to-body":!0,"popper-class":"custom-select vae-custom-select"},model:{value:e.config.vae,callback:function(t){e.$set(e.config,"vae",t)},expression:"config.vae"}},e._l(e.handleVaeList,(function(n,i){return t("el-option",{key:"method_"+i,attrs:{label:n,value:n}},[t("el-tooltip",{attrs:{content:n,placement:"left"}},[t("span",[e._v(e._s(n))])])],1)})),1)],1)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isAnimeEnhanceEnable,expression:"!isAnimeEnhanceEnable"}],staticClass:"modal-content-item"},[t("div",{staticClass:"modal-content-item-label"},[e._v("\n        "+e._s(e.$t("clipSkip"))+"\n        "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t("clipSkipTips"),placement:"top-start"}},[t("i",{staticClass:"custom-tips el-icon-warning"})])],1),e._v(" "),t("div",{staticClass:"modal-content-item-content"},[t("slider-item",{attrs:{"hide-label":!0,"show-tooltip":!1,value:e.config.clip_skip,min:1,max:5},on:{change:function(t){return e.changeConfig(t,"clip_skip")}}})],1)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isAnimeEnhanceEnable&&e.isShowEngineMode,expression:"!isAnimeEnhanceEnable && isShowEngineMode"}],staticClass:"modal-content-item"},[t("div",{staticClass:"modal-content-item-label"},[e._v("\n        "+e._s(e.$t("newGenerate7"))+"\n        "),t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t("newGenerate8"),placement:"top-start"}},[t("i",{staticClass:"custom-tips el-icon-warning"})])],1),e._v(" "),t("div",{staticClass:"modal-content-item-content"},[t("el-select",{staticClass:"easy-custom-select",attrs:{"popper-append-to-body":!0,"popper-class":"custom-select vae-custom-select"},model:{value:e.config.mode,callback:function(t){e.$set(e.config,"mode",t)},expression:"config.mode"}},e._l(e.modeList,(function(n,i){return t("el-option",{key:"mode_"+i,attrs:{label:e.$t(n.i18nKey),value:n.code}})})),1)],1)])]),e._v(" "),t("div",{staticClass:"modal-footer"},[t("span",{staticClass:"modal-footer-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},563:function(e,t,n){"use strict";n.r(t);n(19),n(50),n(16),n(22),n(24),n(4),n(43),n(77);var o=n(241),l=n(97),r=n(298),c=n(10),d=n(35),v=n.n(d),m={name:"EasyMessageAudio",components:{EasyTaskImageViewer:r.default,commonConfirmModal:l.default},props:{message:{type:Object,required:!0},url:{type:String,required:!0},title:{type:String,default:""},coverUrl:{type:String,default:""},showDelete:{type:Boolean,default:!0},menuOptions:{type:Array,default:function(){return[{label:"Delete",command:"delete"}]}},loraModels:{type:Object,default:function(){}},operateNumber:{type:Number,default:0},viewMode:{type:String,default:""}},data:function(){return{audioState:"initial",currentTime:0,duration:0,isDragging:!1,audioElement:null,dialogVisible:!1}},computed:{progressWidth:function(){return 0===this.duration?"0%":"".concat(this.currentTime/this.duration*100,"%")},viewAudioList:function(){var e=this.message,t=e.banner,n=void 0===t?{}:t,o=e.components,l=void 0===o?[]:o;e.preprocess_images,e.type;if(Array.isArray(l))return(v()(l||[])||[]).map((function(e,t){return e.operateNumber=t+1,e}));Object.assign({},v()(n),{operateNumber:1})},currentImageIndex:function(){var e,t=this;return-1===(e=this.viewAudioList.findIndex((function(e){return e.operateNumber===t.operateNumber})))?0:e},subTitle:function(){var e;switch((null===(e=this.message)||void 0===e?void 0:e.sub_type)||0){case 55:return this.$t("song_mode1");case 56:return this.$t("song_mode2");default:return""}},isNormalMode:function(){var e;return[23].includes(null===(e=this.message)||void 0===e?void 0:e.task_domain_type)}},mounted:function(){this.initAudioPlayer()},beforeDestroy:function(){this.destroyAudioPlayer()},methods:{openViewMusic:function(){o.a.stopAllExcept(null),this.dialogVisible=!0},closeViewTaskImage:function(){this.dialogVisible=!1},initAudioPlayer:function(){var e=this;this.audioElement=new Audio(this.url),this.audioElement.addEventListener("timeupdate",this.onTimeUpdate),this.audioElement.addEventListener("loadedmetadata",this.onLoaded),this.audioElement.addEventListener("ended",this.onEnded),this.audioElement.addEventListener("play",this.onPlay),this.audioElement.addEventListener("pause",this.onPause),o.a.register(this.audioElement),this.audioElement.stop=function(){e.audioElement.pause(),e.audioElement.currentTime=0,e.audioState="paused"}},destroyAudioPlayer:function(){this.audioElement&&(this.audioElement.stop(),this.audioElement.removeEventListener("timeupdate",this.onTimeUpdate),this.audioElement.removeEventListener("loadedmetadata",this.onLoaded),this.audioElement.removeEventListener("ended",this.onEnded),this.audioElement.removeEventListener("play",this.onPlay),this.audioElement.removeEventListener("pause",this.onPause),o.a.unregister(this.audioElement),this.audioElement=null)},handleUpdateModelName:function(e,t){"pure"===this.viewMode&&Object.assign(this.message,t||{}),this.$emit("updateModelName",e,t)},togglePlay:function(){var e=this;if(this.audioElement)if("initial"===this.audioState||"paused"===this.audioState){this.audioState="loading",o.a.stopAllExcept(this.audioElement);var t=this.audioElement.play();void 0!==t&&t.then((function(){e.audioState="playing"})).catch((function(){e.audioState="paused"}))}else"playing"===this.audioState&&(this.audioElement.pause(),this.audioState="paused")},onTimeUpdate:function(){this.isDragging||(this.currentTime=this.audioElement.currentTime)},onLoaded:function(){this.duration=this.audioElement.duration},onEnded:function(){var e;this.audioState="paused",this.currentTime=0,this.$xyLogEvent({front_operation:"click",entity_name:"audio_end",entity_type:"easy-message-audio",event_name:"log_action_front",obj_id:null===(e=this.message)||void 0===e||null===(e=e.components)||void 0===e||null===(e=e[this.operateNumber-1])||void 0===e?void 0:e.id,obj_info:{is_over:1}})},onPlay:function(){this.audioState="playing"},onPause:function(){this.audioState="paused"},startDrag:function(e){this.isDragging=!0,this.updateProgressFromEvent(e)},onDrag:function(e){this.isDragging&&this.updateProgressFromEvent(e)},stopDrag:function(e){this.isDragging&&(this.isDragging=!1,this.updateProgressFromEvent(e),this.audioElement&&(this.audioElement.currentTime=this.currentTime,"playing"===this.audioState&&this.audioElement.play()))},updateProgressFromEvent:function(e){var rect=this.$refs.progressBar.getBoundingClientRect(),t=(e.clientX-rect.left)/rect.width;t=Math.max(0,Math.min(1,t)),this.currentTime=this.duration*t},formatTime:function(e){if(isNaN(e)||!isFinite(e))return"00:00";var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))},handleCommand:function(e){var t=this;switch(e){case"download":this.handleDownload();break;case"delete":this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){t.$emit("delete",t.operateNumber)})).catch((function(){}));break;default:this.$emit("command",e)}},handleDownload:function(){Object(c.L)({url:this.url,fileName:this.title})}}},h=(n(4394),n(4395),n(0)),component=Object(h.a)(m,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"easy-message-audio",class:{"pure-mode":"pure"===t.viewMode,"normal-mode":t.isNormalMode},attrs:{"data-group":"create-audio-play"}},[t.isNormalMode?t._e():n("img",{staticClass:"audio-cover",attrs:{src:t.coverUrl,alt:"cover"}}),t._v(" "),n("div",{class:["audio-body",{"normal-mode-audio-body":t.isNormalMode}],on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openViewMusic.apply(null,arguments)}}},[n("div",{staticClass:"audio-container"},[n("div",{staticClass:"audio-left"},[n("div",{staticClass:"play-button"},[t.coverUrl?n("img",{class:{"img-rotate":"playing"===t.audioState},attrs:{src:t.coverUrl,alt:"cover"}}):t._e(),t._v(" "),n("div",{staticClass:"icon-container",class:{"icon-container-playing":"playing"===t.audioState}},[n("div",{staticClass:"icon-container-bg",attrs:{"data-id":null===(e=t.message)||void 0===e||null===(e=e.components)||void 0===e||null===(e=e[t.operateNumber-1])||void 0===e?void 0:e.id,"data-event":"audio-play"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.togglePlay.apply(null,arguments)}}},["loading"===t.audioState?n("i",{staticClass:"el-icon-loading"}):"playing"===t.audioState?n("i",{staticClass:"iconfont icon-icon-pulse"}):n("i",{staticClass:"iconfont icon-zanting1"})])])])]),t._v(" "),"pure"===t.viewMode||t.isNormalMode?t._e():n("div",{staticClass:"audio-content"},[n("div",{staticClass:"audio-info"},[n("div",{staticClass:"audio-title"},[t._v(t._s(t.title))]),t._v(" "),n("div",{staticClass:"audio-subtitle"},[t._v(t._s(t.subTitle))])])]),t._v(" "),"pure"!==t.viewMode&&t.isNormalMode?n("div",{staticClass:"audio-progress",on:{click:function(e){e.stopPropagation()}}},[n("div",{ref:"progressBar",staticClass:"progress-bar",on:{mousedown:function(e){return e.stopPropagation(),t.startDrag.apply(null,arguments)},mousemove:function(e){return e.stopPropagation(),t.onDrag.apply(null,arguments)},mouseup:function(e){return e.stopPropagation(),t.stopDrag.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.stopDrag.apply(null,arguments)},click:function(e){e.stopPropagation()}}},[n("div",{staticClass:"progress-current",style:{width:t.progressWidth}}),t._v(" "),n("div",{staticClass:"progress-handle",style:{left:t.progressWidth}})]),t._v(" "),n("div",{staticClass:"time-info"},[n("span",{staticClass:"current-time"},[t._v(t._s(t.formatTime(t.currentTime)))]),t._v(" "),n("span",{staticClass:"total-time"},[t._v(t._s(t.formatTime(t.duration)))])])]):t._e(),t._v(" "),"pure"!==t.viewMode?n("div",{staticClass:"audio-right",on:{click:function(e){e.stopPropagation()}}},[n("i",{staticClass:"iconfont icon-Download",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleCommand("download")}}}),t._v(" "),n("el-popover",{ref:"myPopover",attrs:{"append-to-body":!1,placement:"bottom-end","popper-class":"easy-msg-item-more-popover","visible-arrow":!1,trigger:"hover"}},[n("div",{staticClass:"pop-btns flex"},t._l(t.menuOptions,(function(e,o){return n("button",{key:o,attrs:{command:e.command},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.handleCommand(e.command)}}},[t._v("\n              "+t._s(t.$t(e.label))+"\n            ")])})),0),t._v(" "),n("div",{staticClass:"msg-item-header-operate-bar-more-btn",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"iconfont icon-more"})])])],1):t._e()]),t._v(" "),"pure"===t.viewMode||t.isNormalMode?t._e():n("div",{staticClass:"audio-progress",on:{click:function(e){e.stopPropagation()}}},[n("div",{ref:"progressBar",staticClass:"progress-bar",on:{mousedown:function(e){return e.stopPropagation(),t.startDrag.apply(null,arguments)},mousemove:function(e){return e.stopPropagation(),t.onDrag.apply(null,arguments)},mouseup:function(e){return e.stopPropagation(),t.stopDrag.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.stopDrag.apply(null,arguments)},click:function(e){e.stopPropagation()}}},[n("div",{staticClass:"progress-current",style:{width:t.progressWidth}}),t._v(" "),n("div",{staticClass:"progress-handle",style:{left:t.progressWidth}})]),t._v(" "),n("div",{staticClass:"time-info"},[n("span",{staticClass:"current-time"},[t._v(t._s(t.formatTime(t.currentTime)))]),t._v(" "),n("span",{staticClass:"total-time"},[t._v(t._s(t.formatTime(t.duration)))])])])]),t._v(" "),t.dialogVisible?n("easy-task-image-viewer",{staticClass:"message-img-viewer",attrs:{operateNumber:t.operateNumber,"on-close":t.closeViewTaskImage,message:t.message,msgId:t.message.id,"url-list":t.viewAudioList,"initial-index":t.currentImageIndex,loraModels:t.loraModels,"show-operate-btn":!0},on:{onlyCloseViewer:t.closeViewTaskImage,setLoraModel:function(e){return t.$emit("setLoraModel",e)},updateModelName:t.handleUpdateModelName,copyGenerationData:function(e){return t.$emit("copyGenerationData",t.message)}}}):t._e(),t._v(" "),n("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"38a6889b",null);t.default=component.exports;installComponents(component,{EasyTaskImageViewer:n(298).default})},5650:function(e,t,n){"use strict";n(3066)},5657:function(e,t,n){"use strict";n(3073)},5661:function(e,t,n){"use strict";n(3078)},5662:function(e,t,n){"use strict";n(3079)},5663:function(e,t,n){"use strict";n(3080)},5664:function(e,t,n){"use strict";n(3081)},5688:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=n(3),d=n(30),v=(n(20),n(18),n(243),n(40),n(41),n(280));function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={RegisterPopup:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5826))},ActivationDialogInPage:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5871))},TransferInPageDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5865))},TrialPayResultDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5827))},VipComputingDialogMini:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5872))},HyAssembleModal:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5828))},HyConfirmModal:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5829))},DailyStaminaPopup:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5867))},PaymentFormDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,367))},ActivityClaimDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5873))},AwaitingOrderDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5874))},NotVipComputingStayDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5875))},GRechargeDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5876))},ImageEditingModal:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5830))},ReviveDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5747))},SubscriptionSelectDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5781))},BreakDialogNew:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5877))},LikeCollectDialog:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5868))},ImageDetailPop:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5831))},NotVipComputingStayDialogV2:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(99),n.e(23),n.e(37)]).then(n.bind(null,5878))}},_={name:"DialogManager",data:function(){return{activeDialogs:{},defaultZIndex:4010}},created:function(){this.initEventBus()},updated:function(){var e=this;Object.entries(this.activeDialogs).forEach((function(t){var n,o,l=Object(d.a)(t,2),r=l[0],dialog=l[1],c=e.$refs[r];c&&c[0]&&(dialog.ref=c[0],dialog.pendingShow&&(null===(n=(o=dialog.ref).show)||void 0===n||n.call(o,dialog.pendingShow),dialog.pendingShow=null))}))},methods:{initEventBus:function(){this.$EventBus.$on("showDialog",this.showDialog),this.$EventBus.$on("hideDialog",this.hideDialog)},getHighestZIndex:function(){return v.a.nextZIndex()},showDialog:function(e){var t=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,data,d,v,dialog,component;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.name,l=e.props,r=void 0===l?{}:l,c=e.data,data=void 0===c?{}:c,!t.activeDialogs[o]){n.next=7;break}return(dialog=t.activeDialogs[o]).zIndex=t.getHighestZIndex(),Object.keys(r).length>0&&(dialog.props=h({},r)),null===(d=dialog.ref)||void 0===d||null===(v=d.show)||void 0===v||v.call(d,data),n.abrupt("return");case 7:if(f[o]){n.next=10;break}return console.error("Dialog component ".concat(o," not found in registry")),n.abrupt("return");case 10:return n.prev=10,n.next=13,f[o]();case 13:component=n.sent,t.$set(t.activeDialogs,o,{component:component.default,props:r,ref:null,pendingShow:data,zIndex:t.getHighestZIndex()}),t.$nextTick((function(){var e,n,dialog=t.activeDialogs[o],l=t.$refs[o];l&&l[0]&&(dialog.ref=l[0],dialog.pendingShow&&(null===(e=(n=dialog.ref).show)||void 0===e||e.call(n,dialog.pendingShow),dialog.pendingShow=null))})),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(10),console.error("Failed to load dialog: ".concat(o),n.t0);case 21:case"end":return n.stop()}}),n,null,[[10,18]])})))()},hideDialog:function(e){var t,n;this.activeDialogs[e]&&(null===(t=this.activeDialogs[e].ref)||void 0===t||null===(n=t.hide)||void 0===n||n.call(t),this.$delete(this.activeDialogs,e))}},beforeDestroy:function(){this.$EventBus.$off("showDialog"),this.$EventBus.$off("hideDialog")}},y=_,C=n(0),component=Object(C.a)(y,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"dialog-manager"},e._l(e.activeDialogs,(function(dialog,n){return t(dialog.component,e._b({key:n,ref:n,refInFor:!0,tag:"component"},"component",r(r({},dialog.props),{},{dialogZIndex:dialog.zIndex||e.defaultZIndex}),!1))})),1)}),[],!1,null,null,null);t.default=component.exports},5698:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(24),n(9));function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={props:{type:{type:String,default:""},options:{type:[Object,Array,String,Number,Boolean,Function],default:function(){return{}}},confirm:{type:Function,default:function(){}},close:{type:Function,default:function(){}},destroy:{type:Function,default:function(){}}},data:function(){return{component:"",value:!0,popupParam:l.fb}},watch:{type:function(e){var t=this;this.component=function(e){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(134)]).then(function(){var o=[n(6393)("".concat(t.type,".vue"))];e.apply(null,o)}.bind(this)).catch(n.oe)}}},methods:{onConfirm:function(e){"function"==typeof this.confirm&&this.confirm(e)},onClose:function(e){this.value=!1,"function"==typeof this.close&&this.close(e)}},render:function(e){var t;return e("div",{},[e("div",{class:"popup_parent",style:c(c({},(null===(t=this.options)||void 0===t?void 0:t.style)||{}),{},{display:this.value?"block":"none",zIndex:this.popupParam.patface.z})},[e(this.component,{directives:[{name:this.value?"popupFixed":null}],props:c({},this.$props)})])])}},v=(n(5320),n(0)),component=Object(v.a)(d,undefined,undefined,!1,null,"66e413c0",null);t.default=component.exports},5711:function(e,t,n){"use strict";n.r(t);n(18);var o=n(2),l=(n(11),n(6),n(22),n(8),n(12),n(13),n(4),n(7),n(79)),r=n(10),c=n(9),d=n(71);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"PublishPop",data:function(){return{formData:{name:"",category:"",intro:"",publish_type:"",type:2,cover:{width:720,height:720,uri:""}},categoryList:[],tpl_id:"",flag:!0,agree:!0,loading:!1,rules:{name:[{required:!0,message:this.$ti("pleaseEnte"),trigger:"change"}],category:[{required:!0,message:this.$ti("PleaseEnterModelCategoryTags"),trigger:"change"}]}}},props:{options:{type:Object,default:function(){return{}}}},mounted:function(){this.getTagType()},methods:{getTagType:function(){var e,t=this,n=localStorage.getItem("userInfo")?null===(e=JSON.parse(localStorage.getItem("userInfo")).settings)||void 0===e?void 0:e.lang_code:"en";Object(d.d)({show_area:"design_template"}).then((function(e){t.categoryList=e.data.length?e.data.map((function(e){return{label:e[c.r[n]],value:e.id}})):[]}))},cancel:function(){this.$parent.onClose(),this.reset()},closePop:function(){this.$parent.destroy()},copyLink:function(){var path=window.location.href+"/detail/"+this.tpl_id;Object(r.g)(path),this.options.copySuccess()},reset:function(){this.formData={name:"",category:"",intro:"",publish_type:"",type:1,cover:{width:720,height:720,uri:""}},this.$refs.formData.resetFields()},$ti:function(text){return this.options.$t(text)},goPage:function(){var path="/editBoard/detail/"+this.tpl_id;window.open(path,"_blank")},submit:function(){var e=this;this.$refs.formData.validate((function(t){t&&(e.loading=!0,e.formData.cover={width:parseInt(e.options.width),height:parseInt(e.options.height),uri:e.options.url},Object(l.F)(m(m({},e.formData),{},{id:e.options.id,task_id:e.options.task_id,publish_type:e.agree?2:1})).then((function(t){e.flag=!1,e.tpl_id=t.data.tpl_id,e.$message.success(e.$ti("PulishSuccess"))})).finally((function(){e.loading=!1})))}))}}},f=(n(5650),n(0)),component=Object(f.a)(h,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"PublishPop"},[e.flag?t("div",{staticClass:"before"},[t("img",{staticClass:"pic",attrs:{src:e.options.url}}),e._v(" "),t("el-form",{ref:"formData",staticClass:"custom-form",attrs:{model:e.formData,rules:e.rules}},[t("div",{staticClass:"flex"},[t("el-form-item",{attrs:{label:e.$ti("trainName"),prop:"name"}},[t("el-input",{staticClass:"inp",attrs:{maxlength:"100",placeholder:e.$ti("pleaseEnte")},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$ti("categoryTags"),prop:"category"}},[t("el-select",{staticClass:"inp",attrs:{"popper-class":"custom-select",placeholder:e.$ti("PleaseEnterModelCategoryTags"),"popper-append-to-body":!1},model:{value:e.formData.category,callback:function(t){e.$set(e.formData,"category",t)},expression:"formData.category"}},e._l(e.categoryList,(function(e,n){return t("el-option",{key:n,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$ti("Desc"),props:"name"}},[t("el-input",{attrs:{placeholder:e.$ti("pleaseEnte")},model:{value:e.formData.intro,callback:function(t){e.$set(e.formData,"intro",t)},expression:"formData.intro"}})],1)],1),e._v(" "),t("div",{staticClass:"footer"},[t("div",{staticClass:"agree"}),e._v(" "),t("div",{staticClass:"button"},[t("div",{staticClass:"cancel btn pointer",on:{click:e.cancel}},[e._v(e._s(e.$ti("Cancel")))]),e._v(" "),t("div",{staticClass:"publish btn pointer",on:{click:e.submit}},[e._v(e._s(e.$ti("Publish")))])])])],1):t("div",{staticClass:"after"},[t("i",{staticClass:"el-icon-close close_publish",on:{click:e.closePop}}),e._v(" "),t("i",{staticClass:"iconfont icon-Group Group"}),e._v(" "),t("p",{staticClass:"line_1"},[e._v(e._s(e.$ti("tempSuccess")))]),e._v(" "),t("div",{staticClass:"foot"},[t("span",{staticClass:"share",on:{click:e.copyLink}},[t("i",{staticClass:"iconfont icon-a-copylink"}),e._v(" "),t("span",[e._v(e._s(e.$ti("CopyLink")))])]),e._v(" "),t("span",{staticClass:"view",on:{click:e.goPage}},[t("i",{staticClass:"iconfont icon-a-Vector206Stroke",staticStyle:{"font-size":"14px"}}),e._v(" "),t("span",[e._v(e._s(e.$ti("viewTem")))])])])])])}),[],!1,null,"7be9648a",null);t.default=component.exports},5847:function(e,t,n){"use strict";n.r(t);var o={name:"VideoGenerate"},l=n(0),component=Object(l.a)(o,(function(){return(0,this._self._c)("div",[this._v("视频生成页面")])}),[],!1,null,null,null);t.default=component.exports},5848:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(19),n(24),n(597)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"ImageSizeSelector",components:{ImageSizeOptionsPopup:l.default},inject:{easyTop:{default:function(){return{}}}},props:{value:{type:Object,default:function(){return{width:768,height:768}}},isShowImageSize:{type:Boolean,default:!0},isShowSpecialEffects:{type:Boolean,default:!1},isShowSizeText:{type:Boolean,default:!0},isShowVideoSize:{type:Boolean,default:!1},imageSizeOptions:{type:Array,default:function(){return[]}},renderVideoSizeOptions:{type:Array,default:function(){return[]}},currentImageSize:{type:Number,default:2},getCurrentModelType:{type:String,default:""},getCustomSizeOptions:{type:Object,default:function(){return{min:320,max:2048}}}},data:function(){return{isLockSize:!1,aspectRatio:1}},computed:d(d({},Object(r.c)(["isCompanyAccount"])),{},{showAspectRatio:function(){if(this.value.width&&this.value.height){var e=this.getGCD(this.value.width,this.value.height);if(e)return"".concat(this.value.width/e," : ").concat(this.value.height/e)}return""}}),watch:{"value.width":function(e){this.isLockSize&&e&&this.value.height&&(this.aspectRatio=e/this.value.height)},"value.height":function(e){this.isLockSize&&e&&this.value.width&&(this.aspectRatio=this.value.width/e)}},mounted:function(){this.value.width&&this.value.height&&(this.aspectRatio=this.value.width/this.value.height)},methods:{getGCD:function(a,b){return 0===b?a:this.getGCD(b,a%b)},changeLockStatus:function(){this.isLockSize=!this.isLockSize,this.isLockSize&&this.value.width&&this.value.height&&(this.aspectRatio=this.value.width/this.value.height)},handleUpdateSize:function(e){this.$emit("update-size",e)},handleUpdateVideoSize:function(e){this.$emit("update-video-size",e)},customSizeChange:function(e,t){this.$emit("custom-size-change",{width:e,height:this.value.height,type:t})}}},m=(n(5657),n(0)),component=Object(m.a)(v,(function(){var e,t,n,o=this,l=o._self._c;return o.isShowImageSize?l("div",{directives:[{name:"show",rawName:"v-show",value:!o.isShowSpecialEffects,expression:"!isShowSpecialEffects"}],staticClass:"generate-mode-panel-item"},[l("div",{staticClass:"generate-mode-panel-item-title"},[l("div",{staticClass:"panel-item-label"},[l("span",{staticClass:"generate-mode-panel-label-text"},[o._v(o._s(o.$t("newGenerate6")))])]),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:o.isShowSizeText,expression:"isShowSizeText"}],staticClass:"current-size"},[o._v(o._s(o.value.width)+" x "+o._s(o.value.height))])]),o._v(" "),o.isShowVideoSize?[l("div",{staticClass:"panel-item-content",class:[null!==(e=o.easyTop)&&void 0!==e&&e.isTongYiFast||null!==(t=o.easyTop)&&void 0!==t&&t.isTongYiProfessional||null!==(n=o.easyTop)&&void 0!==n&&n.isPixVerse?"panel-item-content-5":"panel-item-content-3"]},o._l(o.renderVideoSizeOptions,(function(e){var t,n;return l("div",{key:e.code,staticClass:"panel-item",class:[(null===(t=o.value)||void 0===t?void 0:t.width)===e.width&&(null===(n=o.value)||void 0===n?void 0:n.height)===e.height?"active-btn":""],on:{click:function(t){return t.stopPropagation(),o.handleUpdateVideoSize(e)}}},[l("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),o._v(" "),l("span",{staticClass:"panel-item-label"},[o._v(o._s(e.label))])])})),0)]:[l("div",{staticClass:"panel-item-content panel-item-content-5 column-gap-4 panel-grid-5"},[o._l(o.imageSizeOptions,(function(e){return[5===e.code?[l("image-size-options-popup",{key:"ImageSizeOptionsPopup_".concat(e.code),ref:"ImageSizeOptionsPopup",refInFor:!0,attrs:{currentImageSize:o.currentImageSize,modelType:o.getCurrentModelType},on:{applySize:o.handleUpdateSize}},[l("div",{key:e.code,staticClass:"panel-item",class:["panel-item-custom",![1,2,3,4].includes(o.currentImageSize)&&"panel-item-active"]},[l("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),o._v(" "),l("span",{staticClass:"panel-item-label panel-item-label-overflow",attrs:{title:o.$t(null==e?void 0:e.label)}},[o._v(o._s(o.$t(null==e?void 0:e.label)))])])])]:[l("div",{key:e.code,staticClass:"panel-item",class:[5===e.code&&"panel-item-custom",e.code===o.currentImageSize&&"panel-item-active"],on:{click:function(t){return t.stopPropagation(),o.handleUpdateSize(e)}}},[l("span",{staticClass:"iconfont panel-item-icon",class:["".concat(e.icon)]}),o._v(" "),5===e.code?[l("span",{staticClass:"panel-item-label panel-item-label-overflow",attrs:{title:o.$t(null==e?void 0:e.label)}},[o._v(o._s(o.$t(null==e?void 0:e.label)))])]:l("span",{staticClass:"panel-item-label"},[o._v(o._s(e.label))])],2)]]}))],2),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:5===o.currentImageSize,expression:"currentImageSize === 5"}],staticClass:"custom-size-box"},[l("div",{staticClass:"custom-size-box-item"},[l("span",{staticClass:"custom-size-box-item-text-before"},[o._v("Width")]),o._v(" "),l("el-input-number",{key:"custom_width_input",staticClass:"easy-input-number custom-size-box-item-input-number",attrs:{value:o.value.width,controls:!1,min:o.getCustomSizeOptions.min,max:o.getCustomSizeOptions.max,step:1,disabled:5!==o.currentImageSize||o.isLockSize},on:{change:function(e){return o.customSizeChange(e,"width")}}}),o._v(" "),l("span",{staticClass:"custom-size-box-item-text-after"},[o._v("px")])],1),o._v(" "),l("div",{staticClass:"custom-size-box-item-lock",class:[o.isLockSize&&"active-btn"],on:{click:function(e){return e.stopPropagation(),o.changeLockStatus.apply(null,arguments)}}},[l("i",{staticClass:"iconfont",class:[o.isLockSize?"icon-collectLock":"icon-lock-open-variant-outline"]})]),o._v(" "),l("div",{staticClass:"custom-size-box-item"},[l("span",{staticClass:"custom-size-box-item-text-before"},[o._v("Height")]),o._v(" "),l("el-input-number",{key:"custom_height_input",staticClass:"easy-input-number custom-size-box-item-input-number",attrs:{value:o.value.height,controls:!1,min:o.getCustomSizeOptions.min,max:o.getCustomSizeOptions.max,step:1,disabled:5!==o.currentImageSize||o.isLockSize},on:{change:function(e){return o.customSizeChange(e,"height")}}}),o._v(" "),l("span",{staticClass:"custom-size-box-item-text-after"},[o._v("px")])],1)]),o._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:5===o.currentImageSize,expression:"currentImageSize === 5"}],staticClass:"custom-size-box"},[l("div",{staticClass:"custom-size-box-slider-item"},[l("el-slider",{staticClass:"easy-slider-item",attrs:{value:o.value.width,min:o.getCustomSizeOptions.min,max:o.getCustomSizeOptions.max,step:1,disabled:5!==o.currentImageSize,"show-tooltip":!1},on:{input:function(e){return o.customSizeChange(e,"width")}}})],1),o._v(" "),l("div",{staticClass:"custom-size-box-slider-item-ratio"},[o._v("\n        "+o._s(o.showAspectRatio)+"\n      ")]),o._v(" "),l("div",{staticClass:"custom-size-box-slider-item"},[l("el-slider",{staticClass:"easy-slider-item",attrs:{value:o.value.height,min:o.getCustomSizeOptions.min,max:o.getCustomSizeOptions.max,step:1,disabled:5!==o.currentImageSize,"show-tooltip":!1},on:{input:function(e){return o.customSizeChange(e,"height")}}})],1)])]],2):o._e()}),[],!1,null,"ef62115e",null);t.default=component.exports},5852:function(e,t,n){"use strict";n.r(t);var o={name:"CreativeAssistantIcon",methods:{handleClick:function(){this.$emit("mousedown")}}},l=(n(5661),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"creative-assistant-icon",on:{mousedown:function(t){return t.stopPropagation(),e.handleClick.apply(null,arguments)}}},[t("svg",{attrs:{width:"29",height:"29",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("g",{staticClass:"effect-group"},[t("circle",{staticClass:"main-circle",attrs:{cx:"14.5",cy:"14.5",r:"9.8",fill:"#D9D9D9"}}),e._v(" "),t("g",{staticClass:"glow-effect",attrs:{filter:"url(#filter0_f_10002_176729)"}},[t("path",{staticClass:"path-fill-1",attrs:{d:"M15.2 24.5C7.1 25.1 5.1 23.4 5.1 19.8C5.0 18.3 5.7 17.2 6.8 16.7C5.3 21.6 7.2 23.7 15.2 24.5Z",fill:"url(#paint0_linear_10002_176729)"}})]),e._v(" "),t("g",{staticClass:"path-animation-1",attrs:{filter:"url(#filter1_f_10002_176729)"}},[t("path",{staticClass:"path-fill-2",attrs:{d:"M21.7 6.9C19.9 4.6 16.8 5.0 15.6 5.5C2.9 13.1 2.7 22.1 8.3 23.5C27.4 26.4 24.0 9.8 21.7 6.9Z",fill:"url(#paint1_linear_10002_176729)"}})]),e._v(" "),t("g",{staticClass:"path-animation-2",attrs:{filter:"url(#filter2_f_10002_176729)"}},[t("path",{staticClass:"path-fill-3",attrs:{d:"M26.1 14.5C25.4 5.6 19.2 4.5 16.3 5.1C17.1 5.2 19.3 5.8 21.4 6.8C23.9 8.1 24.3 11.1 26.1 14.5Z",fill:"#2B32B5"}})]),e._v(" "),t("circle",{staticClass:"inner-circle",attrs:{cx:"14.5",cy:"14.5",r:"8.1",fill:"#272727"}}),e._v(" "),t("g",{staticClass:"path-animation-3",attrs:{filter:"url(#filter3_f_10002_176729)"}},[t("path",{staticClass:"path-fill-4",attrs:{d:"M8.6 20.4C7.6 19.4 7.3 17.3 7.3 15.6C7.2 13.4 16.3 9.6 18.4 8.7C20.6 7.9 19.3 9.6 17.1 10.9C14.9 12.2 14.1 14.7 15.4 16.4C16.6 18.1 15.0 22.8 14.1 22.8C12.8 22.8 10.3 22.1 8.6 20.4Z",fill:"#101622"}})]),e._v(" "),t("g",{staticClass:"path-animation-4",attrs:{filter:"url(#filter4_f_10002_176729)"}},[t("path",{staticClass:"path-fill-5",attrs:{d:"M10.8 22.6C6.7 19.2 7.1 14.1 7.8 12.0C7.9 11.6 8.8 10.0 10.8 7.7C6.5 8.5 5.3 14.9 5.7 16.6C6.1 18.3 6.1 19.2 10.8 22.6Z",fill:"url(#paint2_linear_10002_176729)"}})]),e._v(" "),t("g",{staticClass:"path-animation-5",attrs:{filter:"url(#filter5_f_10002_176729)"}},[t("path",{staticClass:"path-fill-6",attrs:{d:"M23.1 9.8C26.1 14.5 28.6 24.3 14.1 24.7C17.9 22.6 26.1 22.6 23.1 9.8Z",fill:"#239CCA"}})]),e._v(" "),t("g",{staticClass:"path-animation-6",attrs:{filter:"url(#filter6_f_10002_176729)"}},[t("path",{staticClass:"path-fill-7",attrs:{d:"M17.1 23.9C16.3 20.5 17.1 19.0 17.5 17.5C18.3 15.8 19.3 15.8 21.8 15.8C22.4 15.8 23.9 15.3 23.9 16.6C23.9 19.6 17.8 26.6 17.1 23.9Z",fill:"#732E71"}})]),e._v(" "),t("g",{staticClass:"path-animation-7",attrs:{filter:"url(#filter7_f_10002_176729)"}},[t("path",{staticClass:"path-fill-8",attrs:{d:"M18.8 8.1C9.3 6.4 7.8 14.8 8.2 19.2C7.0 19.2 4.8 18.7 4.8 16.6C5.2 1.7 17.6 5.1 18.8 8.1Z",fill:"#7B69D6"}})]),e._v(" "),t("g",{staticClass:"path-animation-8",staticStyle:{"mix-blend-mode":"overlay"},attrs:{filter:"url(#filter8_f_10002_176729)"}},[t("path",{staticClass:"path-fill-9",attrs:{d:"M5.6 12.5C5.4 10.5 7.4 8.1 8.6 7.2C10.1 5.9 13.0 5.9 13.9 5.9C14.8 5.9 16.2 7.2 13.0 7.2C9.8 7.2 7.4 12.5 7.1 13.6C6.8 14.9 5.9 14.9 5.6 12.5Z",fill:"#D8DAFF"}})]),e._v(" "),t("g",{staticClass:"path-animation-9",attrs:{filter:"url(#filter9_f_10002_176729)"}},[t("path",{staticClass:"path-fill-10",attrs:{d:"M7.7 19.5C6.5 18.2 6.2 15.7 6.2 14.6C6.4 13.0 6.7 10.5 5.8 12.8C4.7 15.8 6.0 18.2 6.6 19.5C7.3 20.8 8.7 21.8 10.6 21.7C9.8 21.4 9.2 21.1 7.7 19.5Z",fill:"#D9D9D9"}})]),e._v(" "),t("rect",{staticClass:"eye-left",attrs:{x:"10.9",y:"10.9",width:"2.9",height:"5.1",rx:"1.45",fill:"#D9D9D9"}}),e._v(" "),t("rect",{staticClass:"eye-right",attrs:{x:"16.7",y:"10.9",width:"2.9",height:"5.1",rx:"1.45",fill:"#D9D9D9"}})]),e._v(" "),t("defs",[t("filter",{attrs:{id:"filter0_f_10002_176729",x:"4",y:"15.6",width:"12.2",height:"10",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.5",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter1_f_10002_176729",x:"0",y:"0",width:"29",height:"29",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"2.3",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter2_f_10002_176729",x:"14.1",y:"2.9",width:"14",height:"13.8",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"1.1",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter3_f_10002_176729",x:"6.4",y:"7.6",width:"14",height:"16.2",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.5",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter4_f_10002_176729",x:"4",y:"6.1",width:"8.4",height:"18.1",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.8",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter5_f_10002_176729",x:"12.3",y:"7.9",width:"15",height:"18.6",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.9",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter6_f_10002_176729",x:"13.4",y:"12.3",width:"14",height:"15.6",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"1.7",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter7_f_10002_176729",x:"1.4",y:"2.1",width:"20.9",height:"20.5",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"1.7",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter8_f_10002_176729",x:"4.4",y:"4.7",width:"11.9",height:"11.1",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.6",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("filter",{attrs:{id:"filter9_f_10002_176729",x:"4.4",y:"10.9",width:"7.3",height:"11.8",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[t("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),e._v(" "),t("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}}),e._v(" "),t("feGaussianBlur",{attrs:{stdDeviation:"0.5",result:"effect1_foregroundBlur_10002_176729"}})],1),e._v(" "),t("linearGradient",{attrs:{id:"paint0_linear_10002_176729",x1:"5.9",y1:"19.8",x2:"12.3",y2:"25.9",gradientUnits:"userSpaceOnUse"}},[t("stop",{attrs:{"stop-color":"#6D51D9"}}),e._v(" "),t("stop",{attrs:{offset:"1","stop-color":"#26A2C4"}})],1),e._v(" "),t("linearGradient",{attrs:{id:"paint1_linear_10002_176729",x1:"20.9",y1:"5.8",x2:"14.8",y2:"24.1",gradientUnits:"userSpaceOnUse"}},[t("stop",{attrs:{"stop-color":"#4157B7"}}),e._v(" "),t("stop",{attrs:{offset:"1","stop-color":"#4D36A1"}})],1),e._v(" "),t("linearGradient",{attrs:{id:"paint2_linear_10002_176729",x1:"7.3",y1:"12.4",x2:"8.2",y2:"22.6",gradientUnits:"userSpaceOnUse"}},[t("stop",{attrs:{"stop-color":"#7668FE"}}),e._v(" "),t("stop",{attrs:{offset:"1","stop-color":"#2A97B5"}})],1)],1)])])}),[],!1,null,"3ee38eec",null);t.default=component.exports},5853:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(7);var o=n(3),l=n(2),r=(n(20),n(16),n(8),n(4),n(26),n(175)),c=n(292),d=n(1),v=n(29),m=n(25);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={name:"VideoExtensionModal",components:{SwitchToInput:n(885).default},watch:{paramsForm:{handler:function(){this.throttledClick&&this.throttledClick()},deep:!0}},data:function(){return{visible:!1,loading:!1,prompt:"",cost:0,costTimer:null,sale:0,videoInfo:{meta:{prompt:""}},detailInfo:{},initLoading:!1,paramsForm:{enableAiMatchMusic:!1,enableTextDescription:!1,prompt:"",enableNegativePrompts:!1,negative_prompt:""},throttledClick:function(){}}},computed:f(f({},Object(d.c)("user",["isLoggedIn"])),{},{coverUrl:function(){var e;return(null===(e=this.videoInfo)||void 0===e?void 0:e.url)||""}}),mounted:function(){this.throttledClick=Object(m.throttle)(this.getEstimatedCost,1e3)},beforeDestroy:function(){this.throttledClick=null,this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null)},methods:{resetData:function(){this.detailInfo={},this.paramsForm={enableAiMatchMusic:!0,enableTextDescription:!1,prompt:"",enableNegativePrompts:!1,negative_prompt:""},this.cost=0,this.sale=0},show:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.resetData(),t.visible=!0,t.videoInfo=JSON.parse(JSON.stringify(e)),l=t.videoInfo||{},r=l.isTask,c=void 0!==r&&r,t.prompt=(null===(o=t.videoInfo)||void 0===o?void 0:o.prompt)||"",n.next=7,t.getMetaInfo(c);case 7:t.getEstimatedCost();case 8:case"end":return n.stop()}}),n)})))()},getEstimatedCost:function(){var e=this,t=this.handleParams();t.sub_type=48,this.costTimer&&(clearTimeout(this.costTimer),this.costTimer=null),this.costTimer=setTimeout((function(){Object(r.b)(f({},t)).then((function(t){var n=(null==t?void 0:t.data)||{},o=n.calculate_coins,l=n.discount_off_rate;e.cost=o,e.sale=l})).catch((function(t){e.cost=0,e.sale=0}))}),1e3)},getMetaInfo:function(){var e,t,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l={task_flow_version:"v2",id:null===(e=this.videoInfo)||void 0===e||null===(e=e.info)||void 0===e?void 0:e.id};return o?(this.initLoading=!0,(o?v.getMetaInfo:v.getTaskConfig)(l).then((function(e){var t;[1e4,"10000"].includes(null==e||null===(t=e.status)||void 0===t?void 0:t.code)&&(n.detailInfo=(null==e?void 0:e.data)||{})})).finally((function(){n.initLoading=!1}))):(this.detailInfo=(null===(t=this.videoInfo)||void 0===t?void 0:t.info)||{},void this.displayConfig())},displayConfig:function(){var meta=(this.detailInfo||{}).meta,e=!(null==meta||!meta.prompt);this.paramsForm={enableAiMatchMusic:!e,enableTextDescription:e,prompt:(null==meta?void 0:meta.prompt)||"",enableNegativePrompts:!(null==meta||!meta.negative_prompt),negative_prompt:(null==meta?void 0:meta.negative_prompt)||""}},close:function(){this.visible=!1},handleParams:function(){var e,t,n,o,l,r=(null===(e=this.videoInfo)||void 0===e||null===(e=e.info)||void 0===e||null===(e=e.meta)||void 0===e||null===(e=e.generate_audio)||void 0===e?void 0:e.origin_task_id)||"",c={model_no:this.detailInfo.art_model_no,model_ver_no:this.detailInfo.art_model_ver_no,meta:{generate_audio:{origin_task_id:r||(null===(t=this.videoInfo)||void 0===t||null===(t=t.info)||void 0===t?void 0:t.id)||"",video_opts:[{uri:(null===(n=this.videoInfo)||void 0===n||null===(n=n.info)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.url)||""}]}}};null!==(o=this.videoInfo)&&void 0!==o&&o.isTask||(c.meta.generate_audio.video_opts=[{uri:(null===(l=this.videoInfo)||void 0===l||null===(l=l.info)||void 0===l||null===(l=l.meta)||void 0===l||null===(l=l.generate_audio)||void 0===l||null===(l=l.video_opts)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.uri)||""}]);return this.paramsForm.enableTextDescription&&(c.meta.prompt=this.paramsForm.prompt),this.paramsForm.enableNegativePrompts&&(c.meta.negative_prompt=this.paramsForm.negative_prompt),c},addMusic:function(e){var t=this;if(this.isLoggedIn){this.$logEvent("log_actions",{operation:"click_create",behavior_info:"on_video_create_flow_page"}),this.loading=!0;var n=this.handleParams();Object(c.f)(n).then((function(e){t.$emit("updateList",(null==e?void 0:e.data)||{}),t.close(),t.$message.success(t.$t("CreateSuccess"))})).finally((function(){t.loading=!1}))}else this.$EventBus.$emit("openLoginDialog")}}},y=_,C=(n(5662),n(0)),component=Object(C.a)(y,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,width:"320px","show-close":!1,modal:!1,"custom-class":"custom-dialog add-music-dialog"},on:{"update:visible":function(t){e.visible=t}}},[t("template",{slot:"title"},[t("p",{staticClass:"add-music-title"},[e._v("\n      "+e._s(e.$t("video_music"))+"\n    ")])]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.initLoading,expression:"initLoading"}],staticClass:"add-music-pop"},[t("div",{staticClass:"add-music-pop-content"},[t("div",{staticClass:"source-cover"},[t("p",[e._v(e._s(e.$t("videoProlong_source")))]),e._v(" "),t("div",{staticClass:"cover-box",attrs:{"data-tag":e.$t("videoProlong_original")}},[t("img",{attrs:{src:e.coverUrl,alt:""}})])]),e._v(" "),t("switch-to-input",{attrs:{switchKey:"enableAiMatchMusic",label:"ai_match_music",needInput:!1},on:{switchChange:function(t){e.paramsForm.enableTextDescription=!e.paramsForm.enableAiMatchMusic}},model:{value:e.paramsForm,callback:function(t){e.paramsForm=t},expression:"paramsForm"}}),e._v(" "),t("switch-to-input",{attrs:{switchKey:"enableTextDescription",inputKey:"prompt",label:"text_description"},on:{switchChange:function(t){e.paramsForm.enableAiMatchMusic=!e.paramsForm.enableTextDescription}},model:{value:e.paramsForm,callback:function(t){e.paramsForm=t},expression:"paramsForm"}}),e._v(" "),t("switch-to-input",{attrs:{switchKey:"enableNegativePrompts",inputKey:"negative_prompt",label:"NegativePrompts",tips:"newGenerate128"},model:{value:e.paramsForm,callback:function(t){e.paramsForm=t},expression:"paramsForm"}})],1),e._v(" "),t("el-button",{class:{"no-sale":!e.sale,disabled:e.paramsForm.enableTextDescription&&""===e.paramsForm.prompt},attrs:{type:"primary","data-sale":"".concat(e.sale,"% Off"),disabled:e.paramsForm.enableTextDescription&&""===e.paramsForm.prompt,loading:e.loading},on:{click:e.addMusic}},[e._v(e._s(e.$t("Generate"))+"("+e._s(e.$t("expend"))+": "+e._s(e.cost)+")")])],1)],2)}),[],!1,null,"0fddf028",null);t.default=component.exports},5854:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=n(1);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var c={data:function(){return{isShowDialog:!1,message:{}}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(l.c)("user",["isCompanyAccount"])),methods:{openDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isShowDialog=!0,this.message=e},closeDialog:function(){this.isShowDialog=!1,this.message={}}}},d=c,v=(n(5663),n(0)),component=Object(v.a)(d,(function(){var e,t,n,o,l,r,c,d,v,m=this,h=m._self._c;return h("el-dialog",{staticClass:"consume-dialog custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",visible:m.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){m.isShowDialog=e}}},[h("div",{staticClass:"task-info-tips"},[h("p",[h("span",[m._v("\n        "+m._s(m.$t("TaskID"))+"\n      ")]),m._v(" "),h("span",[m._v("\n        "+m._s(null===(e=m.message)||void 0===e?void 0:e.id)+"\n      ")])]),m._v(" "),3!==(null===(t=m.message)||void 0===t?void 0:t.status)||m.isCompanyAccount?m._e():[[1,2,"1","2"].includes(null===(n=m.message)||void 0===n?void 0:n.pub_community)?h("p",[h("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("status")))]),m._v(" "),h("span",{staticClass:"task-pub-status"},[m._v("\n          "+m._s([2,"2"].includes(null===(o=m.message)||void 0===o?void 0:o.pub_community)?m.$t("createSetting1"):m.$t("createSetting2"))+"\n        ")])]):m._e(),m._v(" "),h("p",[h("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("expend")))]),m._v(" "),h("span",{staticClass:"task-info-tips-content"},[h("span",[m._v("\n            "+m._s(m.$t("tempCoins"))+" :\n            "+m._s(null===(l=m.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.temp_hashrate)+"\n          ")]),m._v(" "),h("span",[m._v("\n            "+m._s(m.$t("calculateCoins"))+" :\n            "+m._s(null===(r=m.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.hashrate)+"\n          ")])])]),m._v(" "),null!==(c=m.message)&&void 0!==c&&null!==(c=c.deduction_detail)&&void 0!==c&&c.history_hashrate?h("p",[h("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("currentBalance")))]),m._v(" "),h("span",{staticClass:"task-info-tips-content"},[h("span",[m._v("\n            "+m._s(m.$t("tempCoins"))+" :\n            "+m._s(null===(d=m.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_temp_hashrate)+"\n          ")]),m._v(" "),h("span",[m._v("\n            "+m._s(m.$t("calculateCoins"))+" :\n            "+m._s(null===(v=m.message)||void 0===v||null===(v=v.deduction_detail)||void 0===v?void 0:v.after_hashrate)+"\n          ")])])]):m._e()]],2)])}),[],!1,null,"ff411b52",null);t.default=component.exports},5855:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(6),n(4);var o={name:"mineCharacterFilter",data:function(){return{queryParam:{order_by:"new",publish_status:0},orders:[{key:"New",value:"new"},{key:"Hot",value:"hot"}],statusArr:[{key:"Publish",value:1},{key:"offShelf",value:2}],selectedStatus:[]}},computed:{paramsCount:function(){var e;return(null===(e=this.selectedStatus)||void 0===e?void 0:e.length)||0}},methods:{handleFilter:function(e,t){"sort"===t?this.queryParam.order_by=e:(this.selectedStatus.includes(e)?this.selectedStatus=this.selectedStatus.filter((function(t){return t!==e})):this.selectedStatus.push(e),[0,2].includes(this.selectedStatus.length)?this.queryParam.publish_status=0:this.queryParam.publish_status=this.selectedStatus[0]);this.$emit("handleFilter",this.queryParam)},filterReset:function(){this.selectedStatus=[],this.queryParam={order_by:"new",publish_status:0},this.$emit("handleFilter",this.queryParam)}}},l=(n(5664),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[t("div",{staticClass:"filter-content"},[t("div",{staticClass:"title"},[e._v(e._s(e.$t("Sorting")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.orders,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.queryParam.order_by===n.value},on:{click:function(t){return e.handleFilter(n.value,"sort")}}},[e.queryParam.order_by===n.value?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n        "+e._s(e.$t(n.key))+"\n      ")])})),0),e._v(" "),t("div",{staticClass:"title"},[e._v(e._s(e.$t("status")))]),e._v(" "),t("div",{staticClass:"filter"},e._l(e.statusArr,(function(n){return t("div",{key:n.value,staticClass:"item-filter",class:{active:e.selectedStatus.includes(n.value)},on:{click:function(t){return e.handleFilter(n.value,"status")}}},[e.selectedStatus.includes(n.value)?t("i",{staticClass:"el-icon-check"}):e._e(),e._v("\n        "+e._s(e.$t(n.key))+"\n      ")])})),0),e._v(" "),t("div",{staticClass:"filter-reset",on:{click:e.filterReset}},[e._v("\n      "+e._s(e.$t("resetSelection"))+"\n    ")])]),e._v(" "),t("el-badge",{staticClass:"item",attrs:{slot:"reference",hidden:0===e.paramsCount,value:e.paramsCount},slot:"reference"},[t("div",{staticClass:"filter-box"},[t("div",[t("i",{staticClass:"iconfont icon-a-filterIcon"}),e._v(" "),t("span",[e._v(e._s(e.$t("Filter")))])]),e._v(" "),t("i",{staticClass:"el-icon-arrow-down"})])])],1)}),[],!1,null,"06c911b7",null);t.default=component.exports},591:function(e,t,n){"use strict";n.r(t);n(31),n(24);var o={name:"ImageHoverButtons",components:{SaveTo:n(124).default},props:{topButtons:{type:Array,default:function(){return[]}},bottomButtons:{type:Array,default:function(){return[]}},maxVisibleBottomButtons:{type:Number,default:6},showSpecialConfig:{type:Boolean,default:!0},visibleButtonCount:{type:Number,default:3},operateNumber:{type:Number,default:1},message:{type:Object,default:function(){}},hideBottomButtons:{type:Boolean,default:!1},maxVisibleTopButtons:{type:Number,default:3}},data:function(){return{}},computed:{visibleBottomButtons:function(){var e=this.visibleButtonCount;return e>this.maxVisibleBottomButtons&&(e=this.maxVisibleBottomButtons),e>this.bottomButtons.length?this.bottomButtons:this.bottomButtons.slice(0,e)},hiddenBottomButtons:function(){var e=this.visibleButtonCount;return e>this.maxVisibleBottomButtons&&(e=this.maxVisibleBottomButtons),e>this.bottomButtons.length?[]:this.bottomButtons.slice(e)}},mounted:function(){},beforeDestroy:function(){},methods:{handleButtonClick:function(button){"save"!==button.code&&this.$emit("buttonClick",button)},handleSaveSuccess:function(){this.$emit("saveSuccess")},handleMoreButtonClick:function(button){this.handleButtonClick(button)}}},l=(n(4061),n(4062),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"image-hover-buttons"},[e.topButtons&&e.topButtons.length?t("div",{staticClass:"button-group top-buttons",class:[0===e.maxVisibleTopButtons&&"top-buttons-no-gap"]},[e._l(e.topButtons,(function(button,n){return[n<e.maxVisibleTopButtons?t("el-tooltip",{key:"top-button-".concat(n),attrs:{content:e.$t(button.tips)||"",placement:"top",effect:"light"}},["save"===button.code?[t("save-to",{ref:"SaveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:e.message,operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[t("div",{staticClass:"button-item",attrs:{"data-group":"create-task-image","data-type":"hover-button","data-id":button.code,"data-desc":"创作流图片顶部悬停按钮","data-event":button.code},on:{click:function(t){return e.handleButtonClick(button)}}},[t("i",{class:button.icon})])])]:[t("div",{key:"top-button-2-".concat(n),staticClass:"button-item",class:{"button-item-disabled":null==button?void 0:button.disabled},attrs:{"data-group":"create-task-image","data-type":"hover-button","data-id":button.code,"data-desc":"创作流图片顶部悬停按钮","data-event":button.code},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(button)}}},[t("i",{class:button.icon})])]],2):e._e()]})),e._v(" "),e.topButtons.length>e.maxVisibleTopButtons?t("div",{staticClass:"button-item more-button"},[t("el-popover",{attrs:{trigger:"hover",placement:"bottom","popper-class":"image-hover-more-menu-popover"}},[t("div",{staticClass:"more-menu"},e._l(e.topButtons.slice(e.maxVisibleTopButtons),(function(button,n){return t("el-tooltip",{key:"top-more-".concat(n),attrs:{content:e.$t(button.tips)||"",placement:"left",effect:"light",disabled:!button.tips,"popper-class":"task-image-viewer-popover"}},[t("div",{staticClass:"menu-item",class:{"menu-item-disabled":null==button?void 0:button.disabled},attrs:{"data-group":"create-task-image","data-type":"hover-button","data-id":button.code,"data-desc":"创作流图片顶部悬停按钮","data-event":button.code},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(button)}}},[button.icon?t("i",{class:button.icon}):e._e(),e._v(" "),t("span",[e._v(e._s(e.$t(button.label)||""))])])])})),1),e._v(" "),t("i",{staticClass:"el-icon-more",attrs:{slot:"reference"},slot:"reference"})])],1):e._e(),e._v(" "),e.$scopedSlots["special-config"]?t("div",{staticClass:"divider"}):e._e(),e._v(" "),e.$scopedSlots["special-config"]?t("div",{staticClass:"button-item"},[e._t("special-config")],2):e._e()],2):e._e(),e._v(" "),e.bottomButtons&&e.bottomButtons.length&&!e.hideBottomButtons?t("div",{ref:"bottomButtonsRef",staticClass:"button-group bottom-buttons"},[e._l(e.visibleBottomButtons,(function(button,n){return t("el-tooltip",{key:"bottom-".concat(n),attrs:{content:e.$t(button.tips)||"",placement:"top",effect:"light",disabled:!button.tips,"popper-class":"task-image-viewer-popover"}},[t("div",{staticClass:"button-item",class:{"hd-button":button.isHD},attrs:{"data-group":"create-task-image","data-type":"hover-button","data-id":button.code,"data-desc":"创作流图片底部悬停按钮","data-event":button.code},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(button)}}},[button.icon?t("i",{class:button.icon}):e._e()])])})),e._v(" "),e.hiddenBottomButtons.length>0?t("div",{ref:"moreButtonRef",staticClass:"button-item more-button"},[t("el-popover",{attrs:{trigger:"hover",placement:"bottom-end","popper-class":"image-hover-more-menu-popover"}},[t("div",{staticClass:"more-menu"},e._l(e.hiddenBottomButtons,(function(button,n){return t("el-tooltip",{key:"more-".concat(n),attrs:{content:e.$t(button.tips)||"",placement:"left",effect:"light",disabled:!button.tips,"popper-class":"task-image-viewer-popover"}},[t("div",{staticClass:"menu-item",attrs:{"data-group":"create-task-image","data-type":"hover-button","data-id":button.code,"data-desc":"创作流图片顶部悬停按钮","data-event":button.code},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(button)}}},[button.icon?t("i",{class:button.icon}):e._e(),e._v(" "),t("span",[e._v(e._s(e.$t(button.label)||""))])])])})),1),e._v(" "),t("i",{staticClass:"el-icon-more",attrs:{slot:"reference"},slot:"reference"})])],1):e._e()],2):e._e()])}),[],!1,null,"5d0deb52",null);t.default=component.exports;installComponents(component,{SaveTo:n(124).default})},596:function(e,t,n){"use strict";n.r(t);n(18);var o=n(14),l=(n(19),n(16),n(73),n(4),n(113),n(21),n(137)),r=n(10),c=n(9),d=n(406),v=n(33),m={name:"AdditionalPanelCardItem",inject:["easyTop"],components:{SliderItem:l.default,changeVerNew:d.default},props:{modelInfo:{type:Object,default:function(){return{}}},type:{type:String,default:""},showWarning:{type:Boolean,default:!0}},computed:{isVideo:function(){var e,t=null==this||null===(e=this.modelInfo)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url;if(!t)return!1;return[".mp4",".webm",".ogg"].some((function(e){return(t||"").toLowerCase().endsWith(e)}))},getWeightOptions:function(){var e,t={min:-1,max:2,step:.05};return["SD 1.5","SDXL 1.0","Pony","Illustrious","Flux.1 S","Flux.1 D"].includes(null==this||null===(e=this.modelInfo)||void 0===e?void 0:e.base_model)&&(t.min=-2.5,t.max=7),t},getWeightTips:function(){var e,t;return(null===(e=this.modelInfo)||void 0===e?void 0:e.weight)>2||(null===(t=this.modelInfo)||void 0===t?void 0:t.weight)<-1?this.$t("loraWeightTips"):""},checkStudioLoraType:function(){var e,t=this.modelInfo.base_model,n=null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.base_model_type,l=["SD 3"],r=["SDXL 1.0","SDXL 0.9","SDXL Turbo","SDXL 1.0 LCM","SDXL Lightning","Pony"].concat(Object(o.a)(c.L.sdxl)),d=["SD 1.5","SD 2.0","SD 1.4","SD 2.1 768","SD 2.1","SD 2.0 768","SD 1.5 LCM"].concat(Object(o.a)(c.L.other)),m=(null===c.L||void 0===c.L?void 0:c.L.sd35)||[],h=r.includes(n)||(n||"").includes("SDXL"),f=d.includes(n),_=l.includes(n),y=((null===c.L||void 0===c.L?void 0:c.L.flux)||[]).includes(n),C=m.includes(n),w=r.includes(t)||(t||"").includes("SDXL"),k=d.includes(t),I=l.includes(t),x=((null===c.L||void 0===c.L?void 0:c.L.flux)||[]).includes(t),T=m.includes(t)&&n===t,S="hunyuan_1.0"===Object(v.checkVideoModelType)(n),O="hunyuan_1.0"===Object(v.checkVideoModelType)(t);return S&&!O||h&&!w||f&&!k||_&&!I||y&&!x||C&&!T},getTriggerWords:function(){var e;return((null===(e=this.modelInfo)||void 0===e?void 0:e.trained_words)||[]).join(",")}},data:function(){return{}},methods:{handleUpdateVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("updateVersion",e)},handleOpenPopup:function(){try{var e;null===(e=this.$refs.versionPanelSelect)||void 0===e||e.openPopup()}catch(e){}},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(r.g)(content),this.$message.success(this.$t("CopySuccess"))},changeConfig:function(e,t){this.$emit("changeWeight",e)},handleDelete:function(){this.$emit("deleteItem",this.modelInfo)},changeUrl:function(e){return Object(r.K)(e,"high")},viewModel:function(){var e;if(null!==(e=this.modelInfo)&&void 0!==e&&e.id){var t=this.localePath("/models/detail/".concat(this.modelInfo.id));window.open(t,"_blank")}}}},h=m,f=(n(4271),n(0)),component=Object(f.a)(h,(function(){var e,t,n,o,l,r,c,d,v,m,h,f=this,_=f._self._c;return _("div",{staticClass:"c-additional-panel-card-item"},[_("div",{staticClass:"card-item-close-btn",on:{click:function(e){return e.stopPropagation(),f.handleDelete.apply(null,arguments)}}},[_("i",{staticClass:"el-icon-close"})]),f._v(" "),_("div",{staticClass:"additional-panel-card-item-cover",on:{click:function(e){return e.stopPropagation(),f.viewModel()}}},[null!==(e=f.modelInfo)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.url?[f.isVideo?_("video",{staticClass:"cover-video",attrs:{src:null===(t=f.modelInfo)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url,muted:"",loop:"",autoplay:"",playsinline:""},domProps:{muted:!0}}):_("el-image",{attrs:{src:f.modelInfo.banner&&f.changeUrl(f.modelInfo.banner.url)}},[_("template",{slot:"placeholder"},[_("i",{staticClass:"el-icon-loading image-loading"})]),f._v(" "),_("template",{slot:"error"},[_("img",{staticClass:"select-model-image",attrs:{src:f.modelInfo&&f.modelInfo.banner?f.modelInfo.banner.url:"",alt:""}})])],2)]:_("p",{staticClass:"empty-img"},[f._v(f._s(f.$t("EmptyBannerText")))]),f._v(" "),f.checkStudioLoraType?f._e():_("div",{staticClass:"version-panel",on:{click:function(e){return e.stopPropagation(),f.handleOpenPopup.apply(null,arguments)}}},[_("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:null===(n=f.modelInfo)||void 0===n?void 0:n.version_name,placement:"top"}},[_("div",{staticClass:"version-panel-text"},[f._v(f._s(null===(o=f.modelInfo)||void 0===o?void 0:o.version_name))])]),f._v(" "),_("div",{staticClass:"version-panel-icon el-icon-caret-bottom"}),f._v(" "),_("change-ver-new",{directives:[{name:"show",rawName:"v-show",value:null===(l=f.modelInfo)||void 0===l?void 0:l.version_name,expression:"modelInfo?.version_name"}],ref:"versionPanelSelect",staticClass:"version-panel-select",staticStyle:{opacity:"0 !important"},attrs:{from:"styleModal",item:f.modelInfo,base_models:[null===(r=f.modelInfo)||void 0===r?void 0:r.base_model]},on:{selectItem:f.handleUpdateVersion}})],1),f._v(" "),f.showWarning?_("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"embedding"===f.type?f.$t("newGenerate132",{text:(null===(c=f.modelInfo)||void 0===c?void 0:c.base_model)||""}):f.$t("newGenerate131",{text:(null===(d=f.modelInfo)||void 0===d?void 0:d.base_model)||""}),placement:"top-start"}},[_("div",{directives:[{name:"show",rawName:"v-show",value:f.checkStudioLoraType,expression:"checkStudioLoraType"}],staticClass:"lora-type-not-match"},[_("span",{staticClass:"iconfont icon-warn"}),f._v(" "),_("span",{staticClass:"model-type-info"},[f._v(f._s((null===(v=f.modelInfo)||void 0===v?void 0:v.base_model)||""))])])]):f._e()],2),f._v(" "),_("div",{staticClass:"additional-panel-card-item-content"},[_("div",{staticClass:"card-item-content-title",attrs:{title:(null===(m=f.modelInfo)||void 0===m?void 0:m.name)||""},on:{click:function(e){return e.stopPropagation(),f.viewModel()}}},[f._v("\n      "+f._s(null===(h=f.modelInfo)||void 0===h?void 0:h.name)+"\n    ")]),f._v(" "),_("slider-item",{directives:[{name:"show",rawName:"v-show",value:"embedding"!==f.type,expression:"type !== 'embedding'"}],attrs:{value:f.modelInfo.weight,min:f.getWeightOptions.min,max:f.getWeightOptions.max,step:f.getWeightOptions.step,hideSlider:"embedding"===f.type,tips:f.getWeightTips,label:"embedding"===f.type?f.$t("embedding3"):"Strength"},on:{change:function(e){return f.changeConfig(e,"weight")}}})],1)])}),[],!1,null,"659b23c0",null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},597:function(e,t,n){"use strict";n.r(t);var o=n(30),l=(n(6),n(16),n(22),n(24),n(8),n(4),n(21),n(7),n(99)),r={name:"ImageSizeOptionsPopup",inject:["easyTop"],data:function(){return{visible:!1,imageOptions:l.IMAGE_SIZE_OPTIONS_MORE}},props:{currentImageSize:{type:[String,Number],default:""},modelType:{type:[String],default:""}},computed:{isCustom:function(){var e;return null===(e=this.customOptions)||void 0===e?void 0:e.length},customOptions:function(){var e,t=null===(e=this.easyTop)||void 0===e||null===(e=e.modelParams)||void 0===e||null===(e=e.resolution_param)||void 0===e?void 0:e.options;if(null!=t&&t.length)return t.map((function(e,i){return{code:i+6,label:e.aspect_ratio,width:e.width,height:e.height}}))},verticalList:function(){var e,t=this;if(null!==(e=this.customOptions)&&void 0!==e&&e.length){var n=[];return this.customOptions.forEach((function(e,i){var t=e.label.split(":"),l=Object(o.a)(t,2),r=l[0];+l[1]>+r&&n.push(e)})),n}return["HiDream","SeaDream"].includes(this.modelType)?this.imageOptions.filter((function(e){return"vertical"===(null==e?void 0:e.type)})).filter((function(e){return Object.keys(e).includes(t.modelType)&&5!==e.code})):"IL"===this.modelType?this.imageOptions.filter((function(e){return"vertical"===(null==e?void 0:e.type)})).filter((function(e){return Object.keys(e).includes(t.modelType)})):this.imageOptions.filter((function(e){return"vertical"===(null==e?void 0:e.type)}))},horizontalList:function(){var e,t=this;if(null!==(e=this.customOptions)&&void 0!==e&&e.length){var n=[];return this.customOptions.forEach((function(e){var t=e.label.split(":"),l=Object(o.a)(t,2);+l[0]>+l[1]&&n.push(e)})),n}var l=this.imageOptions;return"SeaDream"!==this.modelType&&(l=l.filter((function(e){return"21:9"!==e.label}))),["HiDream","SeaDream"].includes(this.modelType)?l.filter((function(e){return"horizontal"===(null==e?void 0:e.type)})).filter((function(e){return Object.keys(e).includes(t.modelType)&&5!==e.code})).reverse():"IL"===this.modelType?l.filter((function(e){return"horizontal"===(null==e?void 0:e.type)})).filter((function(e){return Object.keys(e).includes(t.modelType)})).reverse():l.filter((function(e){return"horizontal"===(null==e?void 0:e.type)})).reverse()}},methods:{handleClose:function(){this.visible=!1},handleClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("applySize",e)}}},c=r,d=(n(4273),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-popover",{ref:"imageSizeOptionsPopup",attrs:{title:"",trigger:"click","popper-class":"image-size-options-popup","append-to-body":!0,"visible-arrow":!1,placement:"right-start"},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"image-size-options-popup-header"},[t("div",{staticClass:"image-size-options-popup-header-title"},[e._v(e._s(e.$t("newGenerate6")))]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"image-size-options-popup-content"},[t("div",{staticClass:"image-size-options-popup-content-top"},[t("div",{staticClass:"content-top-item"},[t("div",{staticClass:"iconfont icon-a-2_3"}),e._v(" "),t("div",{staticClass:"content-top-item-label"},[e._v(e._s(e.$t("newGenerate71")))])]),e._v(" "),t("div",{staticClass:"content-top-item"},[t("div",{staticClass:"iconfont icon-a-4_31"}),e._v(" "),t("div",{staticClass:"content-top-item-label"},[e._v(e._s(e.$t("newGenerate72")))])])]),e._v(" "),t("div",{staticClass:"image-size-options-popup-content-main"},[t("div",{staticClass:"main-content-box"},e._l(e.verticalList,(function(n){return t("span",{key:"v_".concat(null==n?void 0:n.code),staticClass:"main-content-box-item",class:[(null==n?void 0:n.code)===e.currentImageSize&&"active-item"],attrs:{"data-id":null==n?void 0:n.label},on:{click:function(t){return e.handleClick(n)}}},[e._v("\n          "+e._s(null==n?void 0:n.label)+"\n        ")])})),0),e._v(" "),t("div",{staticClass:"main-content-box"},e._l(e.horizontalList,(function(n){return t("span",{key:"h_".concat(null==n?void 0:n.code),staticClass:"main-content-box-item",class:[(null==n?void 0:n.code)===e.currentImageSize&&"active-item"],attrs:{"data-id":null==n?void 0:n.code},on:{click:function(t){return e.handleClick(n)}}},[e._v("\n          "+e._s(null==n?void 0:n.label)+"\n        ")])})),0)]),e._v(" "),t("div",{staticClass:"image-size-options-content-item",class:[2===e.currentImageSize&&"active-item"],on:{click:function(t){return e.handleClick(e.isCustom?{label:"1:1"}:{code:2})}}},[e._v("\n      1:1\n    ")]),e._v(" "),"HiDream"!==e.modelType?t("div",{staticClass:"image-size-options-content-item",class:[5===e.currentImageSize&&"active-item"],on:{click:function(t){return e.handleClick(e.isCustom?{custom:!0}:{code:5})}}},[e._v("\n      "+e._s(e.$t("newGenerate43"))+"\n    ")]):e._e()])])}),[],!1,null,null,null);t.default=component.exports},598:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13),n(7);var o=n(2),l=(n(6),n(16),n(22),n(8),n(4),n(83)),r=n(469),c=n(1);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"VideoUpload",components:{HyUploadModal:l.default,VideoUploadBox:r.default},inject:["easyTop"],props:{value:{type:Object,default:function(){return{}}},isEndImg:{type:Boolean,default:!1},baseModel:{type:String,default:""},menuIndex:{type:String,default:""}},data:function(){return{loading:!1,activeImgTab:"first_frame"}},computed:v(v(v({},Object(c.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),Object(c.c)("payment",["paymentInfo"])),{},{isTongYiProfessional:function(){var e,t;return(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isTongYiProfessional)||(null==this||null===(t=this.easyTop)||void 0===t?void 0:t.isTongYiFast)},tip:function(){return this.$t(this.isTongYiProfessional?"uploadWanAiTips":"newGenerate127")},uploadObj:function(){return this.isTongYiProfessional?{fileMaxSize:10,minWh:[360,360],maxWh:[2e3,2e3],accept:".jpg,.png,.jpeg,.webp,.bmp"}:{fileMaxSize:10,minWh:[300,300],minProportion:[1,2.5],maxProportion:[2.5,1]}},getTitle:function(){return this.$t("selectImage")},source:function(){var e;return(null===(e=this.imgList)||void 0===e?void 0:e[0])||{}},imgList:function(){var e,t;return(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.imageToVideoList)||(null===(t=this.value)||void 0===t?void 0:t.imageToVideoList)||[]},getImageUrl:function(){var e,t,n,o;switch(null===(e=this.source)||void 0===e?void 0:e.mode){case"first_frame":case"last_frame":return"first_frame"===this.activeImgTab?null==this||null===(t=this.source)||void 0===t?void 0:t.firstFrame:null==this||null===(n=this.source)||void 0===n?void 0:n.lastFrame;default:return null==this||null===(o=this.source)||void 0===o?void 0:o.url}},isVip:function(){var e,t;return(null===(e=this.paymentInfo)||void 0===e?void 0:e.productLevel)&&(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)>1},hasFirstFrame:function(){var e;return null===(e=this.value)||void 0===e||null===(e=e.imageToVideoList)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.firstFrame},hasLastFrame:function(){var e;return null===(e=this.value)||void 0===e||null===(e=e.imageToVideoList)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.lastFrame},openLastFrame:function(){var e,t;return null!==(e=this.easyTop)&&void 0!==e&&e.isKL15Model?this.isVip:null!==(t=this.easyTop)&&void 0!==t&&t.isKL10Model?this.hasFirstFrame:this.hasFirstFrame&&this.isVip},lastFrameTips:function(){var e,t;if(!(this.isVip||null!==(e=this.easyTop)&&void 0!==e&&e.isKL10Model))return this.$t("VIPOnly");var n=this.$t("newGenerate126");return this.hasFirstFrame||null!==(t=this.easyTop)&&void 0!==t&&t.isKL15Model||(n=this.$t("PleaseUploadFirstFrame")),n}}),watch:{"easyTop.currentModelType":{handler:function(e){this.activeImgTab="first_frame"}},isEndImg:{handler:function(e){e||(this.activeImgTab="first_frame")}}},methods:{handleUpload:function(){null!=this&&this.isLoggedIn&&this.$refs.pickOrUploadImageModal.openModal()},handlePickImage:function(e){var t,n,o=null==e?void 0:e[0];if(null==this||null===(t=this.imgList)||void 0===t||!t.length){var l,r="img2Live2d"===this.value.currentVideoInputToolTab?"imageToLive2D":"imageToVideo";return null==this||null===(l=this.easyTop)||void 0===l||l.addImageToVideo(o,r,this.activeImgTab),void this.$EventBus.$emit("needCheckInputPackUp","paramsPanel")}["first_frame","last_frame"].includes(null==this||null===(n=this.source)||void 0===n?void 0:n.mode)?this.changeConfig(null==o?void 0:o.url,"first_frame"===this.activeImgTab?"firstFrame":"lastFrame"):this.changeConfig(null==o?void 0:o.url,"url")},changeConfig:function(e,t){var n,o=this,l=JSON.parse(JSON.stringify(this.value)),r=((null==l?void 0:l.imageToVideoList)||[]).map((function(n){return o.$set(n,t,e),n}));l.imageToVideoList=r||[],null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(l,this.menuIndex)},validImg:function(e){var t=null==e?void 0:e[0],n=t.url,o=t.width,l=t.height;t.size;if(!n)return"";if(o<300||l<300)return this.$t("tavern38",{number:300});var r=o/l;return r<.4||r>2.5?this.$t("ImageSizeExceedsError"):""},setImgItem:function(e,t){var n=e.url,o=e.width,l=e.height;Object.assign(this.value.meta.generate_video.image_opts[t],{url:n,width:o,height:l})},handleDelete:function(){var e;if(["first_frame","last_frame"].includes(null==this||null===(e=this.source)||void 0===e?void 0:e.mode)){var t,n,o,l=[null===(t=this.source)||void 0===t?void 0:t.firstFrame,null===(n=this.source)||void 0===n?void 0:n.lastFrame].filter(Boolean);if(this.changeConfig("","first_frame"===this.activeImgTab?"firstFrame":"lastFrame"),1===l.length)null===(o=this.easyTop)||void 0===o||o.resetVideoModelDefaultConfig(),this.activeImgTab="first_frame"}else{var r;null===(r=this.easyTop)||void 0===r||r.resetVideoModelDefaultConfig(),this.activeImgTab="first_frame"}},handleMove:function(){var e;if(this.hasLastFrame&&this.hasFirstFrame){var t=JSON.parse(JSON.stringify(this.value)),n=((null==t?void 0:t.imageToVideoList)||[]).map((function(e){var t=null==e?void 0:e.firstFrame;return e.firstFrame=(null==e?void 0:e.lastFrame)||"",e.lastFrame=t||"",e}));t.imageToVideoList=n||[],null==this||null===(e=this.easyTop)||void 0===e||e.updateConfig(t,this.menuIndex)}},checkLastFrame:function(){var e;this.openLastFrame?this.activeImgTab="last_frame":this.isVip||null!==(e=this.easyTop)&&void 0!==e&&e.isKL10Model||this.$EventBus.$emit("showBreakDialog","vip_endframe_tips","standard","",["standard","professional","master"])}}},h=(n(4276),n(0)),component=Object(h.a)(m,(function(){var e,t,n,o,l,r,c=this,d=c._self._c;return d("div",{staticClass:"video-upload"},[d("p",{staticClass:"title"},[c._v(c._s(c.getTitle))]),c._v(" "),d("div",{staticClass:"upload-content"},[d("VideoUploadBox",{attrs:{scene:"panel",uploadObj:c.uploadObj},on:{uploadHandleConfirm:c.handlePickImage}},[d("div",{staticClass:"upload-show"},[c.getImageUrl?[d("div",{staticClass:"handle-btn reupload-btn",on:{click:c.handleUpload}},[d("Icon",{attrs:{name:"a-icon-reselectimg",size:"16",color:"#fff"}})],1),c._v(" "),d("div",{staticClass:"handle-btn delete-btn",on:{click:function(e){return e.stopPropagation(),c.handleDelete.apply(null,arguments)}}},[d("Icon",{attrs:{name:"a-pyDelete1",size:"16",color:"#fff"}})],1),c._v(" "),d("img",{attrs:{src:c.getImageUrl,alt:""}})]:d("div",{staticClass:"upload-box",on:{click:c.handleUpload}},[d("Icon",{attrs:{name:"a-icon-addimg2img",size:"20"}}),c._v(" "),d("p",[c._v(c._s(c.$t("click_upload_or_drag")))]),c._v(" "),d("span",{staticClass:"upload-tip"},[c._v(c._s(c.tip))])],1)],2)]),c._v(" "),c.isEndImg?d("div",{staticClass:"upload-change"},[d("div",{staticClass:"upload-change-item",class:{active:"first_frame"===c.activeImgTab,"cover-item":null===(e=c.source)||void 0===e?void 0:e.firstFrame},attrs:{"data-event":"generate_video_first_frame_click","data-id":null===(t=c.easyTop)||void 0===t||null===(t=t.currentConfigInfo)||void 0===t?void 0:t.art_model_no},on:{click:function(e){c.activeImgTab="first_frame"}}},[d("div",{staticClass:"item-upload",style:{backgroundImage:"url(".concat(null===(n=c.source)||void 0===n?void 0:n.firstFrame,")")}}),c._v(" "),d("el-tooltip",{attrs:{effect:"light",content:c.$t("newGenerate125"),placement:"top"}},[d("div",{staticClass:"text-ellipsis"},[c._v(c._s(c.$t("newGenerate125")))])])],1),c._v(" "),d("Icon",{attrs:{name:"icon-move"},nativeOn:{click:function(e){return c.handleMove.apply(null,arguments)}}}),c._v(" "),d("div",{staticClass:"upload-change-item",class:{active:"last_frame"===c.activeImgTab,"cover-item":null===(o=c.source)||void 0===o?void 0:o.lastFrame,"disabled-item":!c.openLastFrame},attrs:{"data-event":"generate_video_last_frame_click","data-id":null===(l=c.easyTop)||void 0===l||null===(l=l.currentConfigInfo)||void 0===l?void 0:l.art_model_no},on:{click:c.checkLastFrame}},[d("div",{staticClass:"item-upload",style:{backgroundImage:"url(".concat(null===(r=c.source)||void 0===r?void 0:r.lastFrame,")")}}),c._v(" "),d("el-tooltip",{attrs:{effect:"light",content:c.lastFrameTips,placement:"top"}},[d("div",{staticClass:"text-ellipsis"},[c._v(c._s(c.$t("newGenerate126")))])])],1)],1):c._e()],1),c._v(" "),d("HyUploadModal",{ref:"pickOrUploadImageModal",attrs:{isSingleSelect:"",uploadObj:c.uploadObj,category:57},on:{onConfirm:c.handlePickImage}})],1)}),[],!1,null,"417366bb",null);t.default=component.exports},599:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(2),l=(n(16),n(22),n(8),n(83)),r=n(469),c=n(1);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"SpecialEffectsImage",inject:["easyTop"],components:{HyUploadModal:l.default,VideoUploadBox:r.default},props:{value:{type:Object,default:function(){return{}}},isEndImg:{type:Boolean,default:!1},baseModel:{type:String,default:""},source:{type:Object,default:function(){return{}}},menuIndex:{type:String,default:""},scene:{type:String,default:""}},computed:v(v({},Object(c.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),{},{getTitle:function(){return this.$t("selectImage")},getImageUrl:function(){var e;return null==this||null===(e=this.source)||void 0===e?void 0:e.url},isGuestScene:function(){return["fastToolsEffect","generateEffect"].includes(this.scene)}}),data:function(){return{loading:!1,activeImgTab:"first_frame",uploadObj:{fileMaxSize:10,minWh:[300,300],minProportion:[1,2.5],maxProportion:[2.5,1]}}},methods:{handleUpload:function(){this.isGuestScene&&!this.isLoggedIn||(null!=this&&this.isLoggedIn?this.$refs.pickOrUploadImageModal.openModal():this.$EventBus.$emit("openLoginDialog",{dot:!1}))},handlePickImage:function(e){var t=null==e?void 0:e[0];this.$set(this.source,"url",null==t?void 0:t.url)},changeConfig:function(e,t){var n,o=this,l=JSON.parse(JSON.stringify(this.value)),r=((null==l?void 0:l.imageToVideoList)||[]).map((function(n){return o.$set(n,t,e),n}));l.imageToVideoList=r||[],null==this||null===(n=this.easyTop)||void 0===n||n.updateConfig(l,this.menuIndex)},validImg:function(e){var t=null==e?void 0:e[0],n=t.url,o=t.width,l=t.height;t.size;if(!n)return"";if(o<300||l<300)return this.$t("tavern38",{number:300});var r=o/l;return r<.4||r>2.5?this.$t("ImageSizeExceedsError"):""},handleDelete:function(){this.$set(this.source,"url","")}}},h=(n(4280),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-special-effects-image"},[t("p",{staticClass:"title"},[e._v(e._s(e.getTitle))]),e._v(" "),t("div",{staticClass:"upload-content"},[e.isGuestScene?t("VideoUploadBox",{attrs:{scene:"panel",uploadObj:e.uploadObj},on:{uploadHandleConfirm:e.handlePickImage}},[t("div",{staticClass:"upload-show"},[e.getImageUrl?[t("div",{staticClass:"handle-btn reupload-btn",on:{click:e.handleUpload}},[t("Icon",{attrs:{name:"a-icon-reselectimg",size:"16",color:"#fff"}})],1),e._v(" "),t("div",{staticClass:"handle-btn delete-btn",on:{click:function(t){return t.stopPropagation(),e.handleDelete.apply(null,arguments)}}},[t("Icon",{attrs:{name:"a-pyDelete1",size:"16",color:"#fff"}})],1),e._v(" "),t("img",{attrs:{src:e.getImageUrl,alt:""}})]:t("div",{staticClass:"upload-box",on:{click:e.handleUpload}},[t("Icon",{attrs:{name:"a-icon-addimg2img",size:"20"}}),e._v(" "),t("p",[e._v(e._s(e.$t("click_upload_or_drag")))]),e._v(" "),t("span",{staticClass:"upload-tip"},[e._v(e._s(e.$t("newGenerate127")))])],1)],2)]):[t("div",{staticClass:"upload-show"},[e.getImageUrl?[t("div",{staticClass:"handle-btn reupload-btn",on:{click:e.handleUpload}},[t("Icon",{attrs:{name:"a-icon-reselectimg",size:"16",color:"#fff"}})],1),e._v(" "),t("div",{staticClass:"handle-btn delete-btn",on:{click:function(t){return t.stopPropagation(),e.handleDelete.apply(null,arguments)}}},[t("Icon",{attrs:{name:"a-pyDelete1",size:"16",color:"#fff"}})],1),e._v(" "),t("img",{attrs:{src:e.getImageUrl,alt:""}})]:t("div",{staticClass:"upload-box",on:{click:e.handleUpload}},[t("Icon",{attrs:{name:"a-icon-addimg2img",size:"20"}}),e._v(" "),t("p",[e._v(e._s(e.$t("UploadImg")))]),e._v(" "),t("span",{staticClass:"upload-tip"},[e._v(e._s(e.$t("newGenerate127")))])],1)],2)]],2),e._v(" "),t("HyUploadModal",{ref:"pickOrUploadImageModal",attrs:{isSingleSelect:"",uploadObj:e.uploadObj,category:57},on:{onConfirm:e.handlePickImage}})],1)}),[],!1,null,"5b4900ce",null);t.default=component.exports},600:function(e,t,n){"use strict";n.r(t);n(24);var o={name:"FilterButton",props:{count:{type:[Number,String],default:0}},methods:{handleClick:function(){this.$emit("filter-click")}}},l=(n(4301),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"top-bar-main-filter",on:{click:e.handleClick}},[t("span",{staticClass:"top-bar-main-filter-text iconfont icon-a-icon-morefilter"}),e._v(" "),e.count?t("span",{staticClass:"filter-count"},[e._v(e._s(e.count))]):e._e()])}),[],!1,null,"3ef57d20",null);t.default=component.exports},601:function(e,t,n){"use strict";n.r(t);n(16),n(21);var o=n(2),l=(n(1877),n(47),n(816)),r=n.n(l);n(11),n(6),n(49),n(12),n(13),n(8),n(4),n(7);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var d={name:"FilterOptionPopup",inject:{easyTop:{default:function(){return null}}},components:{DatePicker:r.a},props:{listParams:{type:Object,default:function(){return{}}},scene:{type:String,default:""}},data:function(){return{visible:!1,displayMethod:"creative",typeCollapsed:!1,selectedTypes:[],selectedModel:"sd1",saveState:"",timeFilter:"all",times:[],task_domain_types:[{label:"Swtft_App",value:2},{label:"Txt2Img",value:3},{label:"TaskUploadImage",value:4},{label:"conditionToImage",value:5},{label:"Upscaling",value:6},{label:"taskTabUpscale",value:7},{label:"AnimGen",value:8},{label:"GetDescriptors",value:9},{label:"newGenerate105",value:11},{label:"newGenerate106",value:12},{label:"newGenerate107",value:13},{label:"videoProlong",value:14},{label:"video_music",value:17},{label:"audio_tab2",value:20},{label:"audio_song",value:21},{label:"SE_T2SE",value:23}],use_model_series:[{label:"newGenerate89",value:1,tooltip:"newGenerate96",type:"normal"},{label:"newGenerate90",value:2,tooltip:"newGenerate97",type:"normal"},{label:"newGenerate91",value:3,tooltip:"newGenerate98",type:"normal"},{label:"newGenerate92",value:4,tooltip:"newGenerate99",type:"normal"},{label:"SeaArt Ultra",value:5,tooltip:"",type:"video"},{label:"SeaArt Depth",value:6,tooltip:"",type:"video"},{label:"SeaArt Lite",value:7,tooltip:"",type:"video"},{label:"SeaArt Sparkle",value:8,tooltip:"",type:"video"},{label:"Hunyuan Video",value:9,tooltip:"",type:"video"},{label:"SeaArt Turbo",value:10,tooltip:"",type:"video"},{label:"SeaArt Plus",value:11,tooltip:"",type:"video"}]}},computed:{displayMode:function(){var e;return null===(e=this.listParams)||void 0===e?void 0:e.viewMode},getRenderNormalModelList:function(){return this.use_model_series.filter((function(e){return"normal"===e.type}))},getRenderVideoModelList:function(){return this.use_model_series.filter((function(e){return"video"===e.type}))}},methods:{disabledDate:function(time){return time.getTime()>Date.now()},handleClose:function(){this.visible=!1},handleMethodChange:function(e){var t,n={viewMode:e};null==this||null===(t=this.easyTop)||void 0===t||t.updateListParams(n),this.$emit("filter-change",this.getFilterParams()),this.handleClose(),this.$logEvent("log_actions",{operation:2===e?"click_pure_image_mode":"click_create_mode",behavior_info:"on_createflow_page"})},toggleType:function(e){var t,n,o,l=null===(t=this.listParams)||void 0===t||null===(t=t.task_domain_types)||void 0===t?void 0:t.indexOf(e);l>-1?null===(n=this.listParams)||void 0===n||n.task_domain_types.splice(l,1):null===(o=this.listParams)||void 0===o||o.task_domain_types.push(e);this.$logEvent("log_actions",{operation:"click_type_filter",behavior_info:"on_createflow_top_filter",behavior_info_sub:e}),this.$emit("filter-change",this.getFilterParams())},handleModelChange:function(e){var t,n,o,l=null===(t=this.listParams)||void 0===t||null===(t=t.use_model_series)||void 0===t?void 0:t.indexOf(e);l>-1?null===(n=this.listParams)||void 0===n||n.use_model_series.splice(l,1):null===(o=this.listParams)||void 0===o||o.use_model_series.push(e);this.$logEvent("log_actions",{operation:"click_model_filter",behavior_info:"on_createflow_top_filter",behavior_info_sub:e}),this.$emit("filter-change",this.getFilterParams())},handleSaveStateChange:function(e){var t;(null===(t=this.listParams)||void 0===t||null===(t=t.save_modes)||void 0===t?void 0:t[0])===e?this.listParams.save_modes=[]:this.listParams.save_modes=[e],this.$emit("filter-change",this.getFilterParams())},handleReset:function(){var e;this.displayMethod="creative",this.selectedTypes=[],this.selectedModel="sd1",this.saveState="",this.times=[],this.timeFilter="all",null==this||null===(e=this.easyTop)||void 0===e||e.shouldRefreshList(),this.$emit("filter-change",this.getFilterParams())},getFilterParams:function(){var e,t={};return"custom"===this.timeFilter&&2===(null==this||null===(e=this.times)||void 0===e?void 0:e.length)?(t.time_from=this.times[0],t.time_to=this.times[1]):(t.time_from="",t.time_to=""),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({displayMethod:this.displayMethod,types:this.selectedTypes,model:this.selectedModel,saveState:this.saveState},t)},handleTimeFilterChange:function(e){if(this.timeFilter=e,"all"===e){var t;this.times=[];null==this||null===(t=this.easyTop)||void 0===t||t.updateListParams({time_from:"",time_to:""}),this.$emit("filter-change",this.getFilterParams())}},setCheckTime:function(){var e,t,n={time_from:"",time_to:""};"custom"===this.timeFilter&&2===(null==this||null===(e=this.times)||void 0===e?void 0:e.length)&&(n.time_from=this.times[0],n.time_to=this.times[1]),null==this||null===(t=this.easyTop)||void 0===t||t.updateListParams(n),this.$emit("filter-change",this.getFilterParams())}}},v=d,m=(n(4308),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("el-popover",{ref:"filterOptionPopupPopover",attrs:{title:"",trigger:"click","popper-class":"filter-option-popup","append-to-body":!0,"visible-arrow":!1},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"filter-content"},[t("div",{staticClass:"filter-header"},[t("span",{staticClass:"filter-title"},[e._v(e._s(e.$t("Filter")))]),e._v(" "),t("span",{staticClass:"close-icon el-icon-close",on:{click:e.handleClose}})]),e._v(" "),"oldGenerate"!==e.scene?t("div",{staticClass:"filter-section"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("newGenerate100")))]),e._v(" "),t("div",{staticClass:"display-method-buttons"},[t("div",{staticClass:"method-button",class:{active:1===e.displayMode},on:{click:function(t){return e.handleMethodChange(1)}}},[t("i",{staticClass:"iconfont icon-icon-menu-generate-default"}),e._v(" "),t("span",{staticClass:"method-button-text"},[e._v("\n            "+e._s(e.$t("newGenerate84"))+"\n          ")])]),e._v(" "),t("div",{staticClass:"method-button",class:{active:2===e.displayMode},on:{click:function(t){return e.handleMethodChange(2)}}},[t("i",{staticClass:"iconfont icon-a-imagemode"}),e._v(" "),t("span",{staticClass:"method-button-text"},[e._v("\n            "+e._s(e.$t("newGenerate85"))+"\n          ")])])])]):e._e(),e._v(" "),t("div",{staticClass:"filter-section"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("Time")))]),e._v(" "),t("div",{staticClass:"time-filter-buttons"},[t("div",{staticClass:"time-filter-button",class:{active:"all"===e.timeFilter},on:{click:function(t){return e.handleTimeFilterChange("all")}}},[e._v("\n          "+e._s(e.$t("All"))+"\n        ")]),e._v(" "),t("div",{staticClass:"time-filter-button",class:{active:"custom"===e.timeFilter},on:{click:function(t){return e.handleTimeFilterChange("custom")}}},[e._v("\n          "+e._s(e.$t("Customization"))+"\n        ")])]),e._v(" "),"custom"===e.timeFilter?t("div",{staticClass:"date-picker-container"},[t("date-picker",{attrs:{"popper-class":"checkTIme",type:"daterange","value-format":"timestamp","range-separator":"~","start-placeholder":e.$t("startDate"),"end-placeholder":e.$t("endDate"),"disabled-date":e.disabledDate},on:{change:e.setCheckTime},model:{value:e.times,callback:function(t){e.times=t},expression:"times"}})],1):e._e()]),e._v(" "),"oldGenerate"!==e.scene?t("div",{staticClass:"filter-section"},[t("div",{staticClass:"section-header"},[t("span",{staticClass:"section-title"},[e._v(e._s(e.$t("Type")))]),e._v(" "),t("span",{staticClass:"collapse-text",on:{click:function(t){e.typeCollapsed=!e.typeCollapsed}}},[e._v("\n          "+e._s(e.typeCollapsed?e.$t("newGenerate88"):e.$t("newGenerate87"))+"\n        ")])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.typeCollapsed,expression:"!typeCollapsed"}],staticClass:"filter-tags"},e._l(e.task_domain_types,(function(n){var o;return t("div",{key:n.value,staticClass:"tag",class:{active:null===(o=e.listParams)||void 0===o||null===(o=o.task_domain_types)||void 0===o?void 0:o.includes(n.value)},on:{click:function(t){return e.toggleType(n.value)}}},[e._v("\n          "+e._s(e.$t(n.label))+"\n        ")])})),0)]):e._e(),e._v(" "),"oldGenerate"!==e.scene?t("div",{staticClass:"filter-section"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("newGenerate138")))]),e._v(" "),t("div",{staticClass:"model-options"},e._l(e.getRenderNormalModelList,(function(n){var o;return t("div",{key:n.value,staticClass:"model-option",class:{active:null===(o=e.listParams)||void 0===o||null===(o=o.use_model_series)||void 0===o?void 0:o.includes(n.value)},on:{click:function(t){return e.handleModelChange(n.value)}}},[e._v("\n          "+e._s(e.$t(n.label))+"\n          "),t("el-tooltip",{attrs:{content:e.$t(n.tooltip),placement:"top"}},[t("i",{staticClass:"iconfont icon-icon-information1"})])],1)})),0)]):e._e(),e._v(" "),"oldGenerate"!==e.scene?t("div",{staticClass:"filter-section"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("newGenerate137")))]),e._v(" "),t("div",{staticClass:"model-options"},e._l(e.getRenderVideoModelList,(function(n){var o;return t("div",{key:n.value,staticClass:"model-option",class:{active:null===(o=e.listParams)||void 0===o||null===(o=o.use_model_series)||void 0===o?void 0:o.includes(n.value)},on:{click:function(t){return e.handleModelChange(n.value)}}},[e._v("\n          "+e._s(n.label)+"\n          "),null!=n&&n.tooltip?t("el-tooltip",{attrs:{content:e.$t(n.tooltip),placement:"top"}},[t("i",{staticClass:"iconfont icon-icon-information1"})]):e._e()],1)})),0)]):e._e(),e._v(" "),t("div",{staticClass:"reset-button",on:{click:e.handleReset}},[e._v("\n      "+e._s(e.$t("newGenerate95"))+"\n    ")])])])}),[],!1,null,null,null);t.default=component.exports},602:function(e,t,n){"use strict";n.r(t);n(16),n(21),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),l=(n(32),n(4),n(9)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"SelectControlNetModal",inject:["easyTop"],props:{fromPage:{type:String,default:""}},data:function(){return{visible:!1,modelCover:l.t,selectItem:null}},computed:d(d({},Object(r.c)("creation",["taskUnits","taskSdxlUnits","lab_ctr_units","v2_sd_xl_ctr_units","v2_ctr_units","v2_flux_ctr_units"])),{},{taskModules:function(){var e,t;return null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux?this.v2_flux_ctr_units:null!=this&&null!==(t=this.easyTop)&&void 0!==t&&t.isSDXLModel?this.v2_sd_xl_ctr_units:this.v2_ctr_units},hideModel:function(){return"preview"===(null==this?void 0:this.menuIndex)?["none","reference_only"]:["none"]},getSelectClass:function(){return function(e){var t;return this.selectItem&&(null===(t=this.selectItem)||void 0===t?void 0:t.type)===(null==e?void 0:e.type)?"select-control-net-item-active":""}}}),methods:{show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.resetData(),this.selectItem=e,this.visible=!0},resetData:function(){this.selectItem=null},handleClose:function(){this.visible=!1},handleConfirm:function(){var e,t,n=this;if(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isCommunityFlux&&null!=this&&null!==(t=this.easyTop)&&void 0!==t&&null!==(t=t.currentConfigInfo)&&void 0!==t&&null!==(t=t.controlnet_units)&&void 0!==t&&t.length&&"optionModal"!==this.fromPage)this.$message(this.$t("newGenerate81"));else{var o={},l=this.taskModules.find((function(i){return n.selectItem&&n.selectItem.type==i.type}))||{};o.model=(null==l?void 0:l.default_model)||"None",o.module=(null==l?void 0:l.default_module)||"none",o.type=this.selectItem.type,this.$emit("confirm",o),this.handleClose()}},handleClick:function(e){this.selectItem=e}}},m=v,h=(n(4311),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"select-control-net-modal custom-dialog",title:e.$t("ControlNet"),"destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"",width:"1058px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"modal-header"},[t("div",{staticClass:"modal-header-title"},[e._v(e._s(e.$t("ControlNet")))]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"select-control-net--modal-content"},e._l(e.taskModules,(function(n,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.hideModel.includes(n.type),expression:"!hideModel.includes(item.type)"}],key:"model_"+i,staticClass:"image-card-item-content",class:[e.getSelectClass(n)],on:{click:function(t){return e.handleClick(n)}}},[t("div",{staticClass:"image-card-item-content-img"},[t("img",{attrs:{src:null==n?void 0:n.covers[0],alt:""}})]),e._v(" "),t("div",{staticClass:"image-card-item-content-img"},[null!=n&&n.covers[1]?t("img",{attrs:{src:null==n?void 0:n.covers[1],alt:""}}):e._e()]),e._v(" "),t("div",{staticClass:"image-card-item-content-text"},[t("div",{staticClass:"image-card-item-content-title"},[e._v(e._s(e.$t(n.type)))]),e._v(" "),t("div",{staticClass:"image-card-item-content-subtitle"},[e._v("\n          "+e._s(e.$t(n.type+"_Tips"))+"\n        ")])])])})),0),e._v(" "),t("div",{staticClass:"select-control-net--modal-footer"},[t("span",{staticClass:"modal-footer-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports},603:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(3),l=n(2),r=(n(8),n(20),n(1));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"RandomPromptPopup",inject:["easyTop"],mixins:[n(817).promptPolishMixIn],data:function(){return{visible:!1,isLoading:!1}},computed:d(d({},Object(r.c)("user",["isLoggedIn"])),{},{isShowDescribe:function(){var e,t,n=!(null!=this&&null!==(e=this.easyTop)&&void 0!==e&&e.isMiniMax),o=!(null!=this&&null!==(t=this.easyTop)&&void 0!==t&&t.isVideoModel);return n&&o},isShowPromptPolish:function(){var e,t,n=(null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.prompt)||"";return(null==this||null===(t=this.easyTop)||void 0===t||!t.isVideoModel)&&(n&&n.length<100)}}),methods:{handleStartPromptPolish:function(){var e;this.handlePromptPolish((null===(e=this.easyTop)||void 0===e||null===(e=e.currentConfigInfo)||void 0===e?void 0:e.prompt)||"","updatePrompt")},updatePrompt:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null==this||null===(e=this.easyTop)||void 0===e||e.updatePrompt(t)},onClose:function(){this.visible=!1},changeRandom:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,e.$EventBus.$emit("resetInputPackUpStatus"),t.next=5,null===(n=e.easyTop)||void 0===n?void 0:n.getRandomPrompt("click");case 5:e.isLoading=!1,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.isLoading=!1;case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},openPickImageModal:function(){var e=localStorage.getItem("deductionResult");if(e){var t=JSON.parse(e),image=t.image,n=t.result;this.easyTop.handleOpenDeductionPrompt({image:image,result:n})}else this.$emit("openPickImageModal",{type:"imageDescribe"})}}},m=v,h=(n(4313),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return t("el-popover",{ref:"randomPromptPopup",attrs:{title:"",trigger:"click","popper-class":"random-prompt-popup","append-to-body":!0,"visible-arrow":!1,placement:"bottom-end"},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowPromptPolish,expression:"isShowPromptPolish"}],staticClass:"random-prompt-popup-card-item",on:{click:e.handleStartPromptPolish}},[t("div",{staticClass:"popup-card-item-title"},[t("span",{staticClass:"popup-card-item-title-icon iconfont icon-gpt-advance",class:[e.isPromptPolishing&&"random-prompt-loading"]}),e._v(" "),t("span",{staticClass:"popup-card-item-title-text"},[e._v(e._s(e.$t("newGenerate134")))])]),e._v(" "),t("div",{staticClass:"popup-card-item-content"},[e._v("\n      "+e._s(e.$t("newGenerate135"))+"\n    ")])]),e._v(" "),t("div",{staticClass:"random-prompt-popup-card-item",on:{click:e.changeRandom}},[t("div",{staticClass:"popup-card-item-title"},[t("span",{staticClass:"popup-card-item-title-icon iconfont icon-dice-square",class:[e.isLoading&&"random-prompt-loading"]}),e._v(" "),t("span",{staticClass:"popup-card-item-title-text"},[e._v(e._s(e.$t("newGenerate28")))])]),e._v(" "),t("div",{staticClass:"popup-card-item-content"},[e._v("\n      "+e._s(e.$t("newGenerate29"))+"\n    ")])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowDescribe,expression:"isShowDescribe"}],staticClass:"random-prompt-popup-card-item",on:{click:function(t){return t.stopPropagation(),e.openPickImageModal.apply(null,arguments)}}},[t("div",{staticClass:"popup-card-item-title"},[t("span",{staticClass:"popup-card-item-title-icon iconfont icon-icon-describe"}),e._v(" "),t("span",{staticClass:"popup-card-item-title-text"},[e._v(e._s(e.$t("newGenerate30")))])]),e._v(" "),t("div",{staticClass:"popup-card-item-content"},[e._v(e._s(e.$t("newGenerate31")))])])])}),[],!1,null,null,null);t.default=component.exports},604:function(e,t,n){"use strict";n.r(t);var o={name:"AudioTabs",props:{value:{type:String,default:"videoAddMusic"},tabs:{type:Array,default:function(){return[{label:"Audio_songtab",id:"aiVoice"},{label:"Audio_liptab",id:"videoAddLipSync"},{label:"Audio_effecttab",id:"videoAddMusic"}]}},activeType:{type:String,default:"border"}},data:function(){return{}},methods:{handleTabClick:function(e){this.$emit("update:value",e),this.$emit("change",e)}}},l=(n(4414),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"audio-tabs",class:[e.activeType]},e._l(e.tabs,(function(n){return t("div",{key:n.id,staticClass:"audio-tab-item",class:[e.value===n.id&&e.activeType],attrs:{"data-event":"audio-tab-click","data-id":n.id},on:{click:function(t){return e.handleTabClick(n.id)}}},[t("div",{staticClass:"audio-tab-item-title"},[e._v(e._s(e.$t(n.label)))])])})),0)}),[],!1,null,"750d1750",null);t.default=component.exports},626:function(e,t,n){"use strict";n.r(t);n(18),n(24);var o={name:"SwtichWorkFlow",model:{prop:"active"},props:{tabList:{type:Array,default:function(){return[]}},active:{type:Number,default:0}},data:function(){return{visibleMap:{}}},mounted:function(){this.checkTextEllipsis()},methods:{checkTextEllipsis:function(){var e=this;this.$nextTick((function(){var t=e.$refs.tabContainer;if(t)for(var n=t.querySelectorAll(".workflow-item"),i=0;i<n.length;i++){var o=n[i];e.$set(e.visibleMap,i,o.scrollWidth>o.clientWidth)}}))},changeWorkflow:function(e){this.$emit("update:index",e),this.$emit("change",e)}}},l=(n(4353),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"workflow-selector"},[t("div",{ref:"tabContainer",staticClass:"tab-container"},[e._l(e.tabList,(function(n,o){return[t("el-tooltip",{attrs:{content:n.name,placement:"top",disabled:!e.visibleMap[o],"open-delay":300}},[t("div",{key:o,staticClass:"workflow-item",class:{active:e.active===o},on:{click:function(t){return e.changeWorkflow(o)}}},[e._v("\n          "+e._s(n.name)+"\n        ")])])]}))],2)])}),[],!1,null,"eb0a611c",null);t.default=component.exports},686:function(e,t,n){"use strict";n.r(t);n(16),n(11),n(12),n(13),n(7);var o=n(3),l=n(14),r=n(2),c=(n(20),n(19),n(6),n(32),n(50),n(22),n(18),n(24),n(8),n(4),n(28),n(113),n(21),n(44),n(26),n(279)),d=n(102),v=n(38),m=n(57),h=n(35),f=n.n(h),_=n(10),y=n(1),C=n(124),w=(n(25),n(298)),k=n(97),I=n(85),x=n(210),T=n(877),S=n(200),O=n(54),P=n(832),M=n(9),L=n(591),$=n(33),D=n(46),j=n(849),E=n(99),A=n(850);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R={name:"EasyMessageImg",components:{EasyTaskImageViewer:w.default,SaveTo:C.default,AiChatCreateConfirm:c.a,commonConfirmModal:k.default,auditDialog:x.a,CreateConfig:T.default,DownloadVideoPop:S.default,AIAppsImageViewer:P.a,ImageHoverButtons:L.default,FeedBackWin:j.default,reportArtworkWin:A.default},inject:["easyTop","easyTaskView"],props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},showSaveFlag:{type:Boolean,default:!1},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},isMaskBlur:{type:Boolean,default:!1},gridBanner:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},viewStatus:{type:Object,default:function(){return{0:!0,1:!0,2:!0,3:!0,4:!0}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},viewMode:{type:[String],default:""},showHoverMaskButton:{type:Boolean,default:!0},imageInfo:{type:Object,default:function(){}},visibleButtonCount:{type:Number,default:3}},data:function(){return{flag:!0,loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:374,imageURLValid:!0,imageUrl:"",canViewNsfw:!1,checked:!1,alreadySave:!1,hoverBtnList:$.IMAGE_OPERATION_BTN_LIST,hide:!1,faceSwapBtns:[{code:"imageEditing",icon:"icon-zhineng",useText:!1,order:4,tips:"SmartImageEditing",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"Post",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],isAlreadyFeedback:!1,feedbackExpireTime:""}},computed:V(V(V(V(V({},Object(y.c)(["isSupportWebp"])),Object(y.c)("user",["userInfo","isCompanyAccount","isLoggedIn"])),Object(y.c)("creation",["smart_edit_template_id"])),Object(y.e)("user",["cdnHost"])),{},{isManageSelect:function(){return this.isEnableSubmit&&"pure"!==this.viewMode},maxVisibleTopButtonsNum:function(){return"pure"===this.viewMode||this.isShowNsfwIcon&&!this.canViewNsfw?0:3},checkIsAlreadyFeedback:function(){var e;return this.isAlreadyFeedback||(null===(e=this.imageInfo)||void 0===e?void 0:e.is_nsfw_appeal)},getTopButtons:function(){var e,t=this;if(1===this.nsfw){var n,o=this.isAlreadyFeedback||(null==this||null===(n=this.imageInfo)||void 0===n?void 0:n.is_nsfw_appeal),r=["feedback","deleteSingleImg"];return this.hoverBtnList.filter((function(e){return r.includes(e.code)})).map((function(e){return"feedback"===e.code?V(V({},e),{},{tips:o?"feedbackTips3":"feedbackTips1"}):e}))}var c=((null==this||null===(e=this.imageInfo)||void 0===e||null===(e=e.action_capability)||void 0===e?void 0:e.basic)||[]).map((function(e){return e.val})).filter((function(e){return"supportFeedback"!==e}));this.isShowNsfwIcon&&(c=this.canViewNsfw&&"pure"!==this.viewMode?[].concat(Object(l.a)(c),["supportFeedback","supportReport"]):["supportDelete","supportFeedback","supportReport"]);var d=c.map((function(code){return t.hoverBtnList.find((function(e){return e.permissionKey===code}))})).filter(Boolean);return this.showSaveFlag&&(d=d.filter((function(e){return"save"!==e.code}))),d},getBottomButtons:function(){var e,t=this;return 1===this.nsfw?[]:((null==this||null===(e=this.imageInfo)||void 0===e||null===(e=e.action_capability)||void 0===e?void 0:e.hover)||[]).map((function(e){return V(V({},t.hoverBtnList.find((function(t){return t.permissionKey===e.val}))),{},{creativityTemplateId:e.creativity_template_id})})).filter(Boolean)},NotShowMask:function(){var e;return 16===(null===(e=this.message)||void 0===e?void 0:e.task_domain_type)&&1===this.nsfw||!this.isMaskBlur&&!this.isLoggedIn},isAudioVideo:function(){return this.message&&[17,20].includes(this.message.task_domain_type)},isVideoUrl:function(){return function(link){if(!link)return!1;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(link||"").toLowerCase().endsWith(e)}))}},isSeaArtFilmModel:function(){var e,t,n,o=(null===(e=(null==this||null===(t=this.message)||void 0===t||null===(t=t.ckpts)||void 0===t?void 0:t[0])||{})||void 0===e?void 0:e.base_model_name)||"";return null===M.L||void 0===M.L||null===(n=M.L.SeaDream)||void 0===n?void 0:n.includes(o)},getImageSize:function(){return"pure"===this.viewMode?{}:{"max-width":"".concat(this.baseImageWidth,"px"),"min-width":"".concat(150,"px")}},getImageRenderAspectRatio:function(){var e,t={};if("pure"===this.viewMode)return{};var n=(null==this||null===(e=this.message)||void 0===e?void 0:e.components[0])||{},o=n.width,l=n.height,r=this.isAspectRatioExtreme(o,l);return o&&l&&o!==l&&(o<384||l<384||r)&&(t.aspectRatio=o>l?"2/1":"1/2"),t},getMessageInfo:function(){return Object.assign((null==this?void 0:this.message)||[],{img_uris:this.message.components})},isShowChat:function(){return!this.hide&&1!=this.nsfw&&!this.isCompanyAccount&&!this.$isChinaSite&&[1,2,7,8,3,13,11,25,4,29,23,26,"1","2","7","8","3","13","11","25","4","29","23","26"].includes(this.message.type)&&[1,5,"1","5",11,"11",10,"10"].includes(this.message.category)},covertI18n:function(){var e=this;return function(t){return"upscale"===(null==t?void 0:t.code)?e.isStudioMode?"".concat(e.$t("WorkUpscale")).replace("2048*2048","3072*3072"):e.$t("WorkUpscale"):e.$t(null==t?void 0:t.tips)}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus&&this.isMyMsg},isShowSaveTo:function(){var e,t=this.message.components,n=void 0===t?[]:t;return!!n.length&&(!(null!==(e=n[this.operateNumber-1])&&void 0!==e&&e.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},isEnableSubmit:function(){return!this.isShowNsfwBg&&!this.error&&!this.loading&&!this.isMaskBlur&&this.isLoggedIn},isShowNotSelectBox:function(){var e;return!(null!==(e=this.message)&&void 0!==e&&null!==(e=e.banner)&&void 0!==e&&e.is_submit)},selectPostList:function(){var e;return(null==this||null===(e=this.top)||void 0===e?void 0:e.postSelectList)||[]},enableSubmit:function(){var e;return null==this||null===(e=this.top)||void 0===e?void 0:e.enableSubmit},showPostBtn:function(){var e;return(null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_submit)&&!this.isShowNsfwBg&&this.isMyMsg&&!this.isCompanyAccount},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},getRenderUrl:function(){var e,t=((null===(e=this.message)||void 0===e?void 0:e.components)||[]).findIndex((function(e){return 1!==e.nsfw}));if(-1!==t){var n,o=null===(n=this.message)||void 0===n||null===(n=n.components[t])||void 0===n?void 0:n.url;return(o=o?Object(_.K)(o,"high"):"")||"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")}return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var e="";return 1===this.nsfw||(e=this.checkIsShowViewNsfw&&this.isMyMsg?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===e)},isMyMsg:function(){var e,t;return(null===(e=this.message)||void 0===e||null===(e=e.messageInfo)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id)===this.userInfo.id||!(null!==(t=this.message)&&void 0!==t&&t.messageInfo)},isSdModel:function(){var e,t;return[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isStudioMode:function(){var e,t;return["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.channel)||["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.category)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw&&this.isMyMsg?(null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&!this.canViewNsfw:1===this.nsfw);var e},isShowHover:function(){var e;return!(!this.checkIsShowViewNsfw||!this.isMyMsg)&&((null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&!this.canViewNsfw)},isNsfwPlus:function(){var e,t;return"pure"===this.viewMode?(null==this||null===(t=this.imageInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==this.nsfw:(null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus)&&1!==this.nsfw},isShowOperateBtn:function(){var e,t=[11,12,13,14,15,17,19,20,25].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.task_domain_type),n=[1,3,"1","3",5,"5",7,"7",11,8,"8",2,"2",11,"13",13,24,"24","25",25,"4",4,29,"29",23,"23",26,"26"].includes(this.message.type),o=t||n,l=!this.isBlur&&!this.error;return o&&l},convertPictureWidthAndHeight:function(){var e=this.message.banner,t=(void 0===e?{}:e)||{},n=t.width,o=void 0===n?200:n,l=t.height,r=void 0===l?200:l,c=Object(m.resizeImage)(o,r,this.baseImageWidth);return"pure"===this.viewMode||isNaN(c.height)?{}:{width:"".concat(c.width,"px"),height:"".concat(c.height,"px")}},covertSmallWidth:function(){var e=this.message.banner,t=(void 0===e?{}:e).width;return(void 0===t?0:t)<=200?{minWidth:"".concat(150,"px"),maxWidth:"".concat(150,"px")}:{}},viewImageList:function(){var e=this,t=this.message,n=t.banner,o=void 0===n?{}:n,l=t.components,r=void 0===l?[]:l,c=(t.preprocess_images,t.type),d=void 0===c?"":c;return Array.isArray(r)&&[10,"10"].includes(d)?(f()(r||[])||[]).map((function(e,t){return e.operateNumber=t+1,e})).filter((function(t){return e.checkIsShowViewNsfw&&e.isMyMsg&&e.enableNsfwMode?![1,"1"].includes(t.nsfw)&&e.viewStatus[t.operateNumber]:![1,"1"].includes(t.nsfw)})):(Array.isArray(r)&&r.length?(f()(r||[])||[]).map((function(e,t){return e.operateNumber=t+1,e})).filter((function(t){return e.checkIsShowViewNsfw&&e.isMyMsg&&e.enableNsfwMode?![1,"1"].includes(t.nsfw)&&e.viewStatus[t.operateNumber]:![1,"1"].includes(t.nsfw)})):[Object.assign({},f()(o),{operateNumber:1})]).filter((function(e){return[0,1,"0","1"].includes(e.type)}))},currentImageIndex:function(){var e,t=this;return-1===(e=this.viewImageList.findIndex((function(e){return e.operateNumber===t.operateNumber})))?0:e},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)},getImageManageList:function(){var e;return null==this||null===(e=this.easyTaskView)||void 0===e?void 0:e.manageList}}),mounted:function(){this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode,this.updatePureModeViewNsfwStatus()},watch:{src:{handler:function(e){e&&"string"==typeof e&&(this.imageUrl=this.isSupportWebp?Object(_.K)(e,"high"):this.src)},immediate:!0},enableNsfwMode:{handler:function(e,t){t&&t!==e&&(this.flag=!0),this.isMyMsg&&this.flag&&(this.canViewNsfw=this.checkIsShowViewNsfw&&this.enableNsfwMode)},deep:!0,immediate:!0},canViewNsfw:{handler:function(e){this.$emit("viewNsfwStatus",{index:this.operateNumber,canViewNsfw:!this.isMyMsg||this.canViewNsfw,isGrid:!!Object.keys(this.gridBanner||{}).length})},deep:!0,immediate:!0},getImageManageList:{handler:function(e){e&&(this.checked=-1!==this.checkInList())},immediate:!0,deep:!0}},methods:V(V(V({},Object(y.b)("user",["getAccountInfo"])),Object(y.d)("user",["SET_USER_INFO"])),{},{handleButtonClick:function(data){var code=null==data?void 0:data.code;"deleteSingleImg"!==code||"pure"!==this.viewMode?code&&this.handleClick(code,data):this.handlePureModeDeleteSingleImg()},handlePureModeDeleteSingleImg:function(){var e=this;this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){var t,n,o=null==e||null===(t=e.imageInfo)||void 0===t?void 0:t.index;e.$emit("deleteSingleImg",null==e||null===(n=e.message)||void 0===n?void 0:n.id,o)})).catch((function(e){console.log("err",e)}))},updatePureModeViewNsfwStatus:function(){if("pure"===this.viewMode)try{this.$set(this.imageInfo,"canViewNsfw",this.canViewNsfw)}catch(e){}},mouseEnterVideo:function(){try{if(this.$refs.videoRef){var e=this.$refs.videoRef;e.play().catch((function(t){console.error("视频播放失败:",t),"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch((function(e){console.error("尝试静音播放也失败:",e)})))}))}}catch(e){console.error("鼠标移入播放视频错误:",e)}},mouseLeaveVideo:function(){this.$refs.videoRef&&this.$refs.videoRef.pause()},handImageBtns:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,t={chat:"click_chat",aiGenerateVideo:"click_image_to_video"};t[e]&&this.$logEvent("log_actions",{operation:t[e],behavior_info:"on_image_detail_page"})},openLogin:function(){this.isLoggedIn||(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"click_login_now",behavior_info:"on_new_create_flow_page"}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}))},isAspectRatioExtreme:function(e,t){try{return e/t>=2||t/e>=2}catch(e){return!1}},handleGenerate:function(){this.$emit("copyGenerationData",this.message)},handleUpdateModelName:function(e,t){"pure"===this.viewMode&&Object.assign(this.message,t||{}),this.$emit("updateModelName",e,t)},handleConfirm:function(){this.handleChat()},handleSaveSuccess:function(e){var t;this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"}),this.alreadySave=!0;var n=((null==this||null===(t=this.message)||void 0===t?void 0:t.components)||[]).findIndex((function(t){return(null==t?void 0:t.index)===e}));["",null,void 0,-1].includes(n)?this.$emit("saveSuccess",this.operateNumber-1):this.$emit("saveSuccess",n)},handleClickCheck:function(){var e,t=this.checkInList();(null===(e=this.getImageManageList)||void 0===e?void 0:e.length)>=20&&-1===t&&!this.checked?this.$message.warning(this.$t("newGenerate37",{num:20})):(this.checked=!this.checked,this.updateDataToPostSelectList(this.checked))},checkInList:function(){var e=this;try{var t,n,o={taskId:this.message.id,index:null==this||null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.index,url:this.imageUrl};if("pure"===this.viewMode)o.index=null==this||null===(n=this.imageInfo)||void 0===n?void 0:n.index;return(this.getImageManageList||[]).findIndex((function(t){var n,l;return(null==o?void 0:o.url)===(null==t?void 0:t.url)&&(null===(n=e.message)||void 0===n?void 0:n.id)===(null==t?void 0:t.taskId)||(null===(l=e.message)||void 0===l?void 0:l.id)===(null==t?void 0:t.taskId)&&(null==t?void 0:t.index)===(null==o?void 0:o.index)}))}catch(e){}},updateDataToPostSelectList:function(e){var t,n,o,l,r,c,d,v,m,h,f,_={id:this.message.id,url:null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url,width:(null===(n=this.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.width)||0,height:(null===(o=this.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.height)||0,info:{id:this.message.id,obj_type:1,sub_obj_type:this.isVideoUrl(null===(l=this.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)?7:1,cover:{url:(null===(r=this.message)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)||"",width:(null===(c=this.message)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.width)||0,height:(null===(d=this.message)||void 0===d||null===(d=d.banner)||void 0===d?void 0:d.height)||0,nsfw:(null===(v=this.message)||void 0===v||null===(v=v.banner)||void 0===v?void 0:v.nsfw)||0}}},y={taskId:this.message.id,index:null==this||null===(m=this.message)||void 0===m||null===(m=m.banner)||void 0===m?void 0:m.index,url:this.viewImageList[this.currentImageIndex].url,id:this.message.id,info:_};"pure"===this.viewMode&&(y.index=null==this||null===(f=this.imageInfo)||void 0===f?void 0:f.index);null==this||null===(h=this.easyTaskView)||void 0===h||h.updateSelectManageList(y)},deleteSingleImg:function(){var e=this;this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){e.$emit("deleteSingleImg",e.operateNumber)})).catch((function(e){console.log("err",e)}))},handleDeleteSingleImg:function(){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"pure"!==this.viewMode?this.$emit("deleteSingleImg",1,t):this.$emit("deleteSingleImg",null==this||null===(e=this.message)||void 0===e?void 0:e.id,t)},handleCheckChange:function(e){var t=this.checkInList();if(this.selectPostList.length>=20&&-1===t&&e)return this.$message.warning(this.$t("newGenerate37",{num:20})),void(this.checked=!1);this.updateDataToPostSelectList(this.checked)},handleSinglePost:function(){var e,t,n={taskId:this.message.id,index:null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.index,url:this.viewImageList[this.currentImageIndex].url};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_hover",behavior_info_sub:n.url});var o={16:["faceswap"],17:["ai voice"],20:["ai voice","ai video"]},l=(null==o?void 0:o[null===(t=this.message)||void 0===t?void 0:t.task_domain_type])||[],r={types:[O.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[n],remoteParams:{tags:l}};this.$EventBus.$emit("openContribution",r)},settingViewNsfw:function(){var e;this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.isMyMsg&&(this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog())},applyNsfw:function(){var e=this;if(!(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.canViewNsfw=!this.canViewNsfw,void this.updatePureModeViewNsfwStatus();var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(I.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully"))})).finally((function(){e.flag=!1;var data=f()(e.userInfo);data.is_audit=1,e.SET_USER_INFO(data),e.canViewNsfw=!e.canViewNsfw,e.updatePureModeViewNsfwStatus()}))},handleShowNsfwImageUrl:function(){var e,t,n=null==this||null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.is_nsfw_plus;"pure"===this.viewMode&&(n=null==this||null===(t=this.imageInfo)||void 0===t?void 0:t.is_nsfw_plus);return n&&!this.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(e){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",f()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var e=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){e.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(_.K)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){var e;this.isLoggedIn&&(1===this.nsfw||"pure"===this.viewMode&&this.isShowNsfwIcon&&!this.canViewNsfw||this.isShowHover||(null!==(e=this.getImageManageList)&&void 0!==e&&e.length?this.handleClickCheck():this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(e){1===this.nsfw&&e.preventDefault()},handleChat:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,m,h,f,_,y,C,w,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _={height:(null===(n=e.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height)||(null===(o=e.message)||void 0===o||null===(o=o.meta)||void 0===o?void 0:o.height),width:(null===(l=e.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.width)||(null===(r=e.message)||void 0===r||null===(r=r.meta)||void 0===r?void 0:r.width),id:null===(c=e.message)||void 0===c?void 0:c.id,url:e.imageUrl||(null===(d=e.message)||void 0===d||null===(d=d.banner)||void 0===d?void 0:d.url),source_account_id:(null===(m=e.message)||void 0===m||null===(m=m.messageInfo)||void 0===m||null===(m=m.author)||void 0===m?void 0:m.id)||(null===(h=e.userInfo)||void 0===h?void 0:h.id),channel:"task"},t.next=3,Object(v.S)({channel:"task",source_id:_.id});case 3:if(y=t.sent,C=(null==y?void 0:y.data)||{},w=C.can,2!==(void 0===w?2:w)){t.next=8;break}return e.$message.warning(e.$t("chatFail")),t.abrupt("return");case 8:if(!e.isShowSaveTo||1===e.nsfw){t.next=12;break}return t.next=11,e.handleSave(_);case 11:return t.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(_)),k="/cyberPubPage/".concat(null===(f=e.message)||void 0===f?void 0:f.id,"?quickChat=true&source=work"),window.open(e.localePath(k),"_blank");case 15:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,v,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.length>0&&void 0!==e[0]?e[0]:null,l=t.message,r=l.id,c=void 0===r?"":r,v=l.components,m=(void 0===v?[]:v)[t.operateNumber-1].index,h=void 0===m?"":m,Object(d.a)({folder_no:"default",id:c,index:h}).then((function(){if(t.handleSaveSuccess(h),o){var e;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(e=t.message)||void 0===e?void 0:e.id,"?quickChat=true&source=work");window.open(t.localePath(n),"_blank")}})).catch((function(e){console.log("saveFail",e)}));case 4:case"end":return n.stop()}}),n)})))()},handlePlayNow:function(e){var t,n,o=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[void 0,null,""].includes(e)?this.getImageUrl||"":l,c=[void 0,null,""].includes(e)?(null===(t=this.message.components[this.operateNumber-1])||void 0===t?void 0:t.index)||0:e,d={doorCode:this.isVideoUrl(r)?"aiVideoApp":"aiImageApp",artWorkNo:"",workUrl:r||"",source:"task",objType:1,taskReferIndex:c,taskId:null==this||null===(n=this.message)||void 0===n?void 0:n.id,onAfterAction:function(){o.$EventBus.$emit("hideDialog","HyAssembleModal")}};this.$EventBus.$emit("showDialog",{name:"HyAssembleModal",data:d})},handleReport:function(){this.$refs.reportArtworkWin.show()},handleClick:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,data,c,d,m,h,f,y,C,w,k,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"",data=e.length>1&&void 0!==e[1]?e[1]:{},t.handleLogEvent(r),[11,12,13,14,15,17,20].includes(null==t||null===(o=t.message)||void 0===o?void 0:o.task_domain_type)&&t.handleVideoHoverBtnLogEvent(r),!["feedback"].includes(r)){n.next=7;break}return t.handleFeedback(),n.abrupt("return");case 7:if(!["report"].includes(r)){n.next=10;break}return t.handleReport(),n.abrupt("return");case 10:if(!["deleteSingleImg"].includes(r)){n.next=13;break}return t.deleteSingleImg(),n.abrupt("return");case 13:if(!["post"].includes(r)){n.next=16;break}return t.handleSinglePost(),n.abrupt("return");case 16:if(!["save"].includes(r)){n.next=19;break}return t.$refs.saveToPopover.doShow(),n.abrupt("return");case 19:if(!["chat"].includes(r)){n.next=30;break}return n.next=22,Object(v.S)({channel:"task",source_id:null===(c=t.message)||void 0===c?void 0:c.id});case 22:if(d=n.sent,m=d.data.character_id,void 0===m?"":m){n.next=28;break}t.$refs.aiChatCreateConfirm.show(),n.next=30;break;case 28:return n.next=30,t.handleChat();case 30:if(!["playNow"].includes(r)){n.next=33;break}return t.handlePlayNow(),n.abrupt("return");case 33:if(!["aiGenerateVideo"].includes(r)){n.next=37;break}if(t.getImageUrl){n.next=36;break}return n.abrupt("return");case 36:t.$EventBus.$emit("openEasyVideoRecModal",t.getImageUrl);case 37:if(!["videoExtension"].includes(r)){n.next=44;break}if(t.getImageUrl){n.next=40;break}return n.abrupt("return");case 40:return w=(null===(h=(null==t||null===(f=t.message)||void 0===f||null===(f=f.ckpts)||void 0===f?void 0:f[0])||{})||void 0===h?void 0:h.base_model_name)||"",t.$logEvent("log_actions",{operation:"click_video_extension",behavior_info:"on_new_create_flow_page",behavior_info_sub:w}),t.$EventBus.$emit("openEasyVideoExtension",{url:(null===(y=t.message)||void 0===y||null===(y=y.banner)||void 0===y?void 0:y.cover_url)||(null===(C=t.message)||void 0===C||null===(C=C.banner)||void 0===C?void 0:C.url),info:t.message,isTask:!0,isImageOperation:!0}),n.abrupt("return");case 44:if(!["videoExtendFrame"].includes(r)){n.next=50;break}if(t.getImageUrl){n.next=47;break}return n.abrupt("return");case 47:return(null===(k=(null==t||null===(I=t.message)||void 0===I||null===(I=I.ckpts)||void 0===I?void 0:I[0])||{})||void 0===k?void 0:k.base_model_name)||"",t.$EventBus.$emit("openEasyVideoFrameInterpolation",{url:(null===(x=t.message)||void 0===x||null===(x=x.banner)||void 0===x?void 0:x.cover_url)||(null===(T=t.message)||void 0===T||null===(T=T.banner)||void 0===T?void 0:T.url),info:t.message,isTask:!0,isImageOperation:!0}),n.abrupt("return");case 50:if(!["download"].includes(r)){n.next=53;break}return Object(_.e)(null===(S=t.message)||void 0===S||null===(S=S.banner)||void 0===S?void 0:S.url)?(M=(null===(O=t.message)||void 0===O||null===(O=O.banner)||void 0===O?void 0:O.title)||"",Object(_.L)({url:null===(P=t.message)||void 0===P||null===(P=P.banner)||void 0===P?void 0:P.url,fileName:M})):Object(_.M)(null===(L=t.message)||void 0===L||null===(L=L.banner)||void 0===L?void 0:L.url),n.abrupt("return");case 53:if(!["addMusic"].includes(r)){n.next=57;break}return t.$logEvent("log_actions",{operation:"click_video_voice_over",behavior_info:"on_video_create_flow_page"}),t.handleVideoAddMusic(),n.abrupt("return");case 57:if(!["lipsync"].includes(r)){n.next=60;break}return t.handleVideoAddLipSync(),n.abrupt("return");case 60:if(!["3D"].includes(r)){n.next=63;break}return t.handle3DApplication(data),n.abrupt("return");case 63:if(!["imageEditing"].includes(r)){n.next=68;break}if(t.smart_edit_template_id){n.next=66;break}return n.abrupt("return");case 66:return t.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:t.smart_edit_template_id},imgUrlList:[(null===($=t.message)||void 0===$||null===($=$.banner)||void 0===$?void 0:$.cover_url)||(null===(D=t.message)||void 0===D||null===(D=D.banner)||void 0===D?void 0:D.url)]}}),n.abrupt("return");case 68:if(!["aiErase"].includes(r)){n.next=71;break}return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:(null===(j=t.message)||void 0===j||null===(j=j.banner)||void 0===j?void 0:j.cover_url)||(null===(E=t.message)||void 0===E||null===(E=E.banner)||void 0===E?void 0:E.url),type:"aiErase",appId:data.creativityTemplateId,callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}})}}}),n.abrupt("return");case 71:if(!["partialRedrawing"].includes(r)){n.next=74;break}return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:(null===(A=t.message)||void 0===A||null===(A=A.banner)||void 0===A?void 0:A.cover_url)||(null===(N=t.message)||void 0===N||null===(N=N.banner)||void 0===N?void 0:N.url),type:"partialRedrawing",appId:data.creativityTemplateId,callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}})}}}),n.abrupt("return");case 74:if(!["expandImage"].includes(r)){n.next=77;break}return t.$EventBus.$emit("showDialog",{name:"ImageEditingModal",appId:data.creativityTemplateId,data:{url:(null===(V=t.message)||void 0===V||null===(V=V.banner)||void 0===V?void 0:V.cover_url)||(null===(R=t.message)||void 0===R||null===(R=R.banner)||void 0===R?void 0:R.url),appId:data.creativityTemplateId,type:"expandImage",callback:function(data){var e,n;null==t||null===(e=t.easyTop)||void 0===e||e.updateTask(data),null==t||null===(n=t.easyTop)||void 0===n||n.shouldRefreshList(!0),t.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}})}}}),n.abrupt("return");case 77:t.$emit("imageOperate",r,t.operateNumber,null===(l=t.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url);case 78:case"end":return n.stop()}}),n)})))()},checkCanFeedback:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.imageInfo.is_nsfw_appeal){t.next=3;break}return e.$message.warning(e.$t("feedbackTips3")),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(D.checkAndShowFeedback)();case 6:if(1e4===(null==(l=t.sent)||null===(n=l.status)||void 0===n?void 0:n.code)){t.next=9;break}return t.abrupt("return");case 9:if(null==l||null===(o=l.data)||void 0===o||!o.feedback_expire_time){t.next=12;break}return e.$message.warning("".concat(e.$t("feedback_tips")," ").concat(Object(E.formatDateTime)(Number(l.data.feedback_expire_time)))),t.abrupt("return");case 12:e.$refs.feedBackWin.show(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[3,15]])})))()},handleFeedback:function(){this.checkCanFeedback()},submitFeedback:function(){var e,t,n=this,desc=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o={appeal:{index:null==this||null===(e=this.imageInfo)||void 0===e?void 0:e.index,task_id:null===(t=this.message)||void 0===t?void 0:t.id,remark:desc}};Object(D.feedbackNSFWImage)(o).then((function(e){var t,o;if(10100===(null==e||null===(t=e.status)||void 0===t?void 0:t.code))return n.$message.warning(n.$t("feedbackTips3")),void n.$refs.feedBackWin.handleClose(!0);var l=(null==e||null===(o=e.data)||void 0===o?void 0:o.result)||{};((null==l?void 0:l.success)||!1)&&(n.$message.success(n.$t("feedbackTips2")),n.isAlreadyFeedback=!0,n.easyTaskView.checkIsAlreadyFeedback(n.imageInfo.id))})).finally((function(){n.$refs.feedBackWin.handleClose(!0)}))},handleVideoAddMusic:function(){var e,t,n;this.easyTop.handleAudioNavigation({data:{videoInfo:{id:null===(e=this.message)||void 0===e?void 0:e.id,isTask:!0,url:null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url,coverUrl:null===(n=this.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.cover_url,needCheckVideo:!0},prompt:"",negative_prompt:""}})},handleVideoAddLipSync:function(){var e,t;this.easyTop.handleAudioNavigation({data:{currentAudioTab:"videoAddLipSync",videoInfo:{id:null===(e=this.message)||void 0===e?void 0:e.id,isTask:!0,url:null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url,duration:0,needCheckVideo:!0}}})},handle3DApplication:function(data){var e,t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:(null==data?void 0:data.creativityTemplateId)||""},imgUrlList:[(null===(e=this.message)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.cover_url)||(null===(t=this.message)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.url)||n.url]}})},handleViewNsfwFeedback:function(e){this.checkCanFeedback()},checkAndShowFeedback:function(e){if(null!=e&&e.is_nsfw_appeal){var t=e.feedbackExpireTime?"".concat(this.$t("feedback_tips")," ").concat(e.feedbackExpireTime):this.$t("feedbackTips3");return this.$message.warning(t),!0}return!1},handleLogEvent:function(e){var t,n="";switch(e){case"extraUpscale":n="click_optifine";break;case"chat":n="click_chat";break;case"upscale":n="click_superscore";break;case"variations":n="click_variant";break;case"imageEditing":n="click_smart_image_modification";break;case"post":n="click_post";break;case"save":n="click_save"}n&&this.$logEvent("log_actions",{operation:n,behavior_info:"on_create_flow_detail_page",behavior_info_sub:null===(t=this.message)||void 0===t?void 0:t.id})},handleVideoSave:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.message,l=o.id,r=void 0===l?"":l,c=o.components,v=e.index||0,Object(d.a)({folder_no:"default",id:r,index:v}).then((function(){t.handleSaveSuccess(v),t.$message.success(t.$t("SaveSuccess"))})).catch((function(e){console.log("saveFail",e)}));case 3:case"end":return n.stop()}}),n)})))()},handleImageOperate:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if([11,12,13,14,15,17,20].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.task_domain_type)&&this.handleVideoHoverBtnLogEvent(t,"detail"),"save"!==t){if("playNow"===t)return this.handlePlayNow(null==n?void 0:n.index,null==n?void 0:n.url),void this.closeViewBigImage();if("report"!==t)if("feedback"!==t){if("addMusic"===t)return this.handleVideoAddMusic(),void this.closeViewBigImage();if("lipsync"===t)return this.handleVideoAddLipSync(),void this.closeViewBigImage();if("3D"===t)return this.handle3DApplication(o,n),void this.closeViewBigImage();this.$emit("imageOperate",t,n.operateNumber,n.url),this.closeViewBigImage()}else this.handleViewNsfwFeedback(null==n?void 0:n.index);else this.handleReport()}else this.handleVideoSave(n)},handleVideoHoverBtnLogEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";switch(e){case"post":n="click_post";break;case"videoUpscale":n="click_superscore";break;case"save":n="click_save";break;case"download":n="click_download"}n&&this.$logEvent("log_actions",{operation:n,behavior_info:"detail"===t?"on_create_flow_work_detail_page":"on_video_create_flow_page"})},handleAiGenerateVideo:function(e){this.closeViewBigImage(),this.$EventBus.$emit("openEasyVideoRecModal",e)},handleConfirmReport:function(){var e=this;setTimeout((function(){e.$refs.reportArtworkWin.setLoading(!1),e.$message.success(e.$t("ReportSuccess")),e.$refs.reportArtworkWin.handleClose()}),1500)}})},F=R,B=(n(4380),n(4381),n(0)),component=Object(B.a)(F,(function(){var e,t,n,o,l,r,c=this,d=c._self._c;return d("div",{staticClass:"c-media-attachments-container"},[c.isLoggedIn||c.loading||!c.isMaskBlur?c._e():d("div",{staticClass:"visitor-mask-box",on:{click:function(e){return c.openLogin()}}},[c._m(0),c._v(" "),d("div",{staticClass:"visitor-mask-box-text"},[c._v(c._s(c.$t("check_image")))])]),c._v(" "),d("div",{staticClass:"attachments-wrap",class:[c.checked&&"pure"!==c.viewMode?"attachments-wrap-checked":"",!c.isLoggedIn&&!c.loading&&c.isMaskBlur&&"visitor-mask","pure"===c.viewMode&&"attachments-wrap-no-border-radius"]},[d("div",{staticClass:"message-attachment-media",on:{mouseenter:c.mouseEnterVideo,mouseleave:c.mouseLeaveVideo}},[d("div",{staticClass:"image-content"},[d("div",{staticClass:"image-content-wrap",class:[1===c.nsfw?"image-content-wrap-background":""],style:c.getImageSize},[d("div",{directives:[{name:"lazyload-media",rawName:"v-lazyload-media"}],staticClass:"image-render-box"},[1===c.nsfw?[d("img",{staticClass:"media-attachments-img image-opacity-0",style:c.loading?c.convertPictureWidthAndHeight:c.getImageRenderAspectRatio,attrs:{"data-src":c.getRenderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:c.onLoad,error:c.onError,contextmenu:function(e){return c.handleContextMenu(e)}}})]:[c.isVideoUrl(c.src)?d("div",{staticClass:"video-mark"},[d("i",{staticClass:"iconfont icon-icon-tag-creation"})]):c._e(),c._v(" "),24==c.message.type||c.isVideoUrl(c.src)?d("video",{ref:"videoRef",staticClass:"media-attachments-video",class:[c.loading?"image-opacity-0":"",c.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px",width:"".concat(c.baseImageWidth,"px")},attrs:{"data-src":c.getImageUrl,width:c.width,loop:"",controls:!1},domProps:{muted:!c.isAudioVideo},on:{canplay:function(e){c.loading=!1},click:c.viewBigImage,error:c.onError,contextmenu:function(e){return c.handleContextMenu(e)}}}):d("img",{staticClass:"media-attachments-img",class:[c.loading?"":"media-attachments-img-show",c.loading?"image-opacity-0":"",c.isShowNsfwBg?"blurBackground":""],style:c.loading?c.convertPictureWidthAndHeight:c.getImageRenderAspectRatio,attrs:{"data-src":c.getImageUrl,width:c.width,height:c.height,alt:"",decoding:"async",loading:"lazy"},on:{load:c.onLoad,error:c.onError,click:c.viewBigImage,contextmenu:function(e){return c.handleContextMenu(e)}}})],c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:c.loading&&1!==c.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[d("div",{staticClass:"loading-wrapper-inner"},[d("span",{staticClass:"spinner",attrs:{role:"img","aria-label":c.$t("Loading")}},[c._m(1)])])]),c._v(" "),c.isShowNsfwIcon?[d("div",{directives:[{name:"show",rawName:"v-show",value:!c.canViewNsfw,expression:"!canViewNsfw"}],staticClass:"generate-view-nsfw-plus-warning"},[d("i",{staticClass:"iconfont icon-jubao2"})]),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:c.canViewNsfw,expression:"canViewNsfw"}],staticClass:"generate-view-nsfw-plus",on:{click:function(e){return e.stopPropagation(),c.settingViewNsfw.apply(null,arguments)}}},[d("i",{staticClass:"iconfont",class:c.canViewNsfw?"icon-work-hide":"icon-work-show"})])]:c._e(),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:c.showSaveFlag&&1!==c.nsfw,expression:"showSaveFlag && nsfw !== 1"}],staticClass:"save-status-flag"},[d("i",{staticClass:"iconfont icon-yibaocun"})]),c._v(" "),c.isManageSelect?[d("div",{staticClass:"image-manage-check-btn",class:[c.checked&&"image-manage-check-btn-active",(null===(e=c.getImageManageList)||void 0===e?void 0:e.length)&&"image-manage-check-btn-show"],style:{display:null!==(t=c.easyTop)&&void 0!==t&&t.isShowMessageManage?"flex":""},on:{click:function(e){return e.stopPropagation(),c.handleClickCheck()}}},[d("span",{staticClass:"image-manage-check-btn-icon el-icon-check"})])]:c._e(),c._v(" "),c.NotShowMask?c._e():[d("ImageHoverButtons",{directives:[{name:"show",rawName:"v-show",value:c.isShowOperateBtn&&!(null!==(n=c.getImageManageList)&&void 0!==n&&n.length)&&c.isShowImage&&c.src&&!c.loading&&![0,"0"].includes(this.operateNumber)&&(c.showHoverMaskButton||c.isShowNsfwIcon&&"pure"===c.viewMode&&c.canViewNsfw)||1===c.nsfw||c.isShowNsfwIcon&&!c.canViewNsfw,expression:"\n                  (isShowOperateBtn &&\n                    !getImageManageList?.length &&\n                    isShowImage &&\n                    src &&\n                    !loading &&\n                    ![0, '0'].includes(this.operateNumber) &&\n                    (showHoverMaskButton || (isShowNsfwIcon && viewMode === 'pure' && canViewNsfw))) ||\n                  nsfw === 1 ||\n                  (isShowNsfwIcon && !canViewNsfw)\n                "}],staticClass:"image-hover-mask",class:{"image-hover-mask-view":c.isShowNsfwIcon&&!c.canViewNsfw},attrs:{topButtons:c.getTopButtons,bottomButtons:c.getBottomButtons,maxVisibleBottomButtons:6,maxVisibleTopButtons:c.maxVisibleTopButtonsNum,hideBottomButtons:c.isShowNsfwIcon&&!c.canViewNsfw||"pure"===c.viewMode,visibleButtonCount:c.visibleButtonCount,operateNumber:c.operateNumber,message:c.getMessageInfo},on:{buttonClick:c.handleButtonClick,saveSuccess:function(){var e;return c.handleSaveSuccess(null===(e=c.imageInfo)||void 0===e?void 0:e.index)}},scopedSlots:c._u([c.isShowNsfwIcon?{key:"special-config",fn:function(){return[d("i",{staticClass:"iconfont",class:c.canViewNsfw?"icon-work-hide":"icon-work-show",on:{click:function(e){return e.stopPropagation(),c.settingViewNsfw.apply(null,arguments)}}})]},proxy:!0}:null],null,!0)})]],2)]),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:c.error&&!c.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[d("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),c._v(" "),d("span",{staticClass:"image-load-error-text",on:{click:function(e){return e.stopPropagation(),c.clickReloadImage.apply(null,arguments)}}},[c._v(c._s(c.$t("reloadImage")))])])])]),c._v(" "),[23,26].includes(null===(o=c.message)||void 0===o?void 0:o.type)?[c.dialogVisible?d("AIAppsImageViewer",{staticClass:"work-message-img-viewer",staticStyle:{"z-index":"2500"},attrs:{"on-close":c.closeViewBigImage,"initial-index":c.currentImageIndex,"show-operate-btn":!0,hoverBtnRenderList:c.faceSwapBtns,message:c.message,"url-list":c.viewImageList,customForm:!0,"is-from-generate":!0,"is-from-history":!0,"is-show-save-btn":c.isShowSaveTo,nsfw:c.nsfw},on:{onlyCloseViewer:c.closeViewBigImage,onClickBtns:c.handImageBtns,imageOperate:c.handleImageOperate,saveSuccess:c.handleSaveSuccess,copyGenerationData:c.handleGenerate,handleDeleteSingleImg:c.deleteSingleImg,openEasyVideoRecModal:c.handleAiGenerateVideo},scopedSlots:c._u([{key:"customContent",fn:function(){return[d("CreateConfig",{attrs:{info:c.message}})]},proxy:!0}],null,!1,1028422645)}):c._e()]:[1,2].includes(null===(l=c.message)||void 0===l?void 0:l.task_domain_type)?[c.dialogVisible?d("easy-task-image-viewer",{staticClass:"work-message-img-viewer",attrs:{"on-close":c.closeViewBigImage,"initial-index":c.currentImageIndex,"show-operate-btn":!0,message:c.message,"url-list":c.viewImageList,customForm:!0,loraModels:c.loraModels,checkIsShowViewNsfw:c.checkIsShowViewNsfw},on:{onlyCloseViewer:c.closeViewBigImage,imageOperate:c.handleImageOperate,onClickBtns:c.handImageBtns,updateModelName:c.handleUpdateModelName,handleDeleteSingleImg:c.handleDeleteSingleImg},scopedSlots:c._u([{key:"customContent",fn:function(){return[d("CreateConfig",{attrs:{info:c.message}})]},proxy:!0}],null,!1,1028422645)}):c._e()]:[c.dialogVisible?d("easy-task-image-viewer",{staticClass:"message-img-viewer",attrs:{operateNumber:c.operateNumber,nsfw:c.nsfw,"on-close":c.closeViewBigImage,"initial-index":c.currentImageIndex,"show-operate-btn":c.isShowOperateBtn,message:c.getMessageInfo,"url-list":c.viewImageList,msgId:c.message.id,loraModels:c.loraModels,customForm:[1,2].includes(null===(r=c.message)||void 0===r?void 0:r.task_domain_type),checkIsShowViewNsfw:c.checkIsShowViewNsfw},on:{imageOperate:c.handleImageOperate,updateModelName:c.handleUpdateModelName,handleAnimate:function(e){return c.handleClick("animGen")},handleImageEditing:function(e){return c.handleClick("imageEditing")},saveSuccess:c.handleSaveSuccess,copyGenerationData:c.handleGenerate,onlyCloseViewer:c.closeViewBigImage,setLoraModel:function(e){return c.$emit("setLoraModel",e)},handleDeleteSingleImg:c.handleDeleteSingleImg}}):c._e()]],2),c._v(" "),d("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task",fromPage:"newTask"},on:{confirm:c.handleConfirm}}),c._v(" "),d("common-confirm-modal",{ref:"commonConfirmModal"}),c._v(" "),d("auditDialog",{ref:"auditDialog",on:{confirm:c.applyNsfw}}),c._v(" "),d("feed-back-win",{ref:"feedBackWin",on:{submitFeedback:c.submitFeedback}}),c._v(" "),d("report-artwork-win",{ref:"reportArtworkWin",attrs:{title:c.$t("Tip")},on:{confirm:c.handleConfirmReport}},[d("div",{staticClass:"jubao-content-box"},[d("div",{staticClass:"icon-box"},[d("i",{staticClass:"iconfont icon-jubao2"})]),c._v(" "),d("div",{staticClass:"tips-box"},[d("p",{staticClass:"tips1"},[c._v(c._s(c.$t("newGenerate38")))]),c._v(" "),d("p",{staticClass:"tips2"},[c._v(c._s(c.$t("jubao_tips")))])])])])],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"visitor-mask-box-icon"},[e("i",{staticClass:"iconfont icon-a-shoushijiaohu1"})])},function(){var e=this._self._c;return e("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[e("span",{staticClass:"item-2VgEex"}),e("span",{staticClass:"item-2VgEex"})])}],!1,null,"54e5d57c",null);t.default=component.exports;installComponents(component,{EasyTaskImageViewer:n(298).default})},848:function(e,t,n){"use strict";n.r(t);n(31),n(24);var o={name:"ImageActionButtons",props:{visible:{type:Boolean,default:!0},buttons:{type:Array,default:function(){return[]}},maxVisibleButtons:{type:Number,default:3},iconStyle:{type:String,default:""},gap:{type:Number,default:10},iconFontsize:{type:String,default:""}},computed:{visibleButtons:function(){return this.buttons.slice(0,this.maxVisibleButtons)},hiddenButtons:function(){return this.buttons.length>this.maxVisibleButtons?this.buttons.slice(this.maxVisibleButtons):[]}},methods:{handleButtonClick:function(e){this.$emit("button-click",e)}}},l=(n(4054),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return e.visible?t("div",{staticClass:"image-action-buttons",style:{gap:e.gap+"px"}},[e._l(e.visibleButtons,(function(n,o){return[t("el-tooltip",{attrs:{content:e.$t(n.label),placement:"top"}},[t("div",{key:n.code,class:["action-button",e.iconStyle],attrs:{"data-group":"create-task-image-viewer","data-type":"detail-edit-button","data-id":n.code,"data-event":n.code,"data-desc":"创作流图片详情顶部按钮组"},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(n)}}},[t("i",{class:[n.icon,e.iconFontsize]})])])]})),e._v(" "),e.hiddenButtons.length>0?t("div",{class:["action-button","more-button",e.iconStyle]},[t("el-popover",{attrs:{trigger:"hover",placement:"bottom-end","popper-class":"image-hover-more-menu-popover"}},[t("div",{staticClass:"more-menu"},e._l(e.hiddenButtons,(function(n){return t("el-tooltip",{key:n.type,attrs:{content:e.$t(n.label)||"",placement:"left",effect:"light",disabled:!n.label,"popper-class":"task-image-viewer-popover"}},[t("div",{staticClass:"menu-item",attrs:{"data-group":"create-task-image-viewer","data-type":"detail-edit-button","data-id":n.code,"data-event":n.code,"data-desc":"创作流图片详情顶部按钮组"},on:{click:function(t){return t.stopPropagation(),e.handleButtonClick(n)}}},[t("i",{class:n.icon}),e._v(" "),t("span",[e._v(e._s(e.$t(n.label)))])])])})),1),e._v(" "),t("i",{staticClass:"el-icon-more",attrs:{slot:"reference"},slot:"reference"})])],1):e._e()],2):e._e()}),[],!1,null,"5a357090",null);t.default=component.exports},849:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),{name:"FeedBackWin",data:function(){return{isShowFeedBackWin:!1,desc:"",isLoading:!1}},methods:{show:function(){this.isShowFeedBackWin=!0,this.desc=""},handleClose:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.isLoading=!1),this.isLoading||(this.isShowFeedBackWin=!1,this.isLoading=!1)},handleConfirm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.desc){t.next=3;break}return e.$message.warning(e.$t("feedback—pleaseEnter")),t.abrupt("return");case 3:return e.isLoading=!0,t.next=6,e.$emit("submitFeedback",e.desc);case 6:case"end":return t.stop()}}),t)})))()}}}),r=l,c=(n(4063),n(4064),n(0)),component=Object(c.a)(r,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"feed-back-win-dialog",attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,modal:!0,"modal-append-to-body":"","append-to-body":"",title:"".concat(e.$t("pink_img_feedback")),visible:e.isShowFeedBackWin,width:"465px","before-close":e.handleClose},on:{"update:visible":function(t){e.isShowFeedBackWin=t}}},[t("div",{staticClass:"feed-back-win-dialog-content"},[t("p",{staticClass:"title"},[e._v(e._s(e.$t("you_feedback_translate"))+":")]),e._v(" "),t("el-input",{staticClass:"desc-input",attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"".concat(e.$t("pleaseEnte")),maxlength:"200"},model:{value:e.desc,callback:function(t){e.desc=t},expression:"desc"}})],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"close-btn",on:{click:e.handleClose}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"confirm",attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,"a99e69b6",null);t.default=component.exports},850:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),{name:"ReportArtworkWin",props:{title:{type:String,default:"",required:!0}},data:function(){return{is:!1,isLoading:!1,isShow:!1}},methods:{show:function(){this.isShow=!0},handleClose:function(){this.isShow=!1,this.isLoading||(this.isLoading=!1)},handleConfirm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isLoading=!0,e.$emit("confirm");case 2:case"end":return t.stop()}}),t)})))()},setLoading:function(e){this.isLoading=e}}}),r=(n(4065),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"win-dialog",attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,modal:!0,"modal-append-to-body":"","append-to-body":"",title:e.title,visible:e.isShow,"before-close":e.handleClose},on:{"update:visible":function(t){e.isShow=t}}},[t("div",{staticClass:"win-dialog-content"},[e._t("default")],2),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"close-btn",on:{click:e.handleClose}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"confirm",attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,"5e446e54",null);t.default=component.exports},856:function(e,t,n){"use strict";n.r(t);n(4);var o={name:"SelectModelConfirmModal",data:function(){return{visible:!1,options:null,list:[],resolve:null,reject:null}},methods:{show:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.resetData(),this.options=n,this.list=t,this.visible=!0,new Promise((function(t,n){e.resolve=t,e.reject=n}))},resetData:function(){this.list=[],this.options=null,this.resolve=null,this.reject=null},handleClose:function(){if(this.visible=!1,this.reject)return this.reject(!1)},handleConfirm:function(){if(this.visible=!1,this.resolve)return this.resolve(!0)}}},l=o,r=(n(4231),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,"custom-class":"easy-select-model-confirm-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"","append-to-body":"",width:"407px"},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"easy-select-model-confirm-modal-header"},[t("div",{staticClass:"modal-header-title"},[e._v(e._s(e.$t("Tip")))]),e._v(" "),t("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[t("i",{staticClass:"el-icon-close"})])]),e._v(" "),t("div",{staticClass:"easy-select-model-confirm-modal-content"},[t("div",{staticClass:"modal-content-left"},[t("div",{staticClass:"warning-icon-box"},[t("i",{staticClass:"iconfont icon-warn"})])]),e._v(" "),t("div",{staticClass:"modal-content-right"},[t("div",{staticClass:"modal-content-right-title"},[e._v(e._s(e.$t("newGenerate22")))]),e._v(" "),t("div",{staticClass:"modal-content-right-tag-box"},e._l(e.list,(function(n,o){return t("span",{key:"tag_item_".concat(o),staticClass:"modal-content-right-tag-item"},[e._v(e._s(e.$t(n))+"\n        ")])})),0),e._v(" "),t("div",{staticClass:"modal-content-right-sub-title"},[e._v(e._s(e.$t("newGenerate23")))])])]),e._v(" "),t("div",{staticClass:"easy-select-model-confirm-modal-footer"},[t("span",{staticClass:"modal-footer-btn",on:{click:function(t){return t.stopPropagation(),e.handleClose()}}},[e._v(e._s(e.$t("Cancel")))]),e._v(" "),t("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),e.handleConfirm()}}},[e._v(e._s(e.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports},859:function(e,t,n){"use strict";n.r(t);var o=n(2),l=n(3),r=(n(20),n(11),n(6),n(16),n(22),n(4),n(12),n(13),n(8),n(7),n(26),n(82)),c=n(98),d=n(423),v=n(9),m=n(696);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _="",y={components:{LenovoPanel:d.default},inject:["CombinedSelectionDialog"],props:{value:{type:String,default:""},baseModels:{type:Array,default:function(){return[]}},baseModelTypes:{type:Array,default:function(){return[]}},isAdditionalModel:{type:Boolean,default:!1},modelTypes:{type:Array,default:function(){return[]}}},watch:{value:{handler:function(e){this.keyword=e}}},data:function(){return{is_preset:"",keyIndex:-1,keyword:"",isFocus:!1,showMockBox:!1,searchNoDataImg:n(669),debounceGetRelatedList:Object(c.a)(this.getRelatedList,500),associateList:[],searchPlaceholder:{model:"searchModelPlaceHolder",imgModel:"searchModelPlaceHolder",videoModel:"searchModelPlaceHolder",aiApp:"searchWorkflowAppPlaceHolder",collect:"Search",mine:"Search",image_train_model:"searchModelPlaceHolder"}}},computed:{isShowLeftStyle:function(){return this.CombinedSelectionDialog.isUseTagFilter},currentActiveTab:function(){return this.CombinedSelectionDialog.currentActiveTab||""},placeHolder:function(){return this.searchPlaceholder[this.currentActiveTab]||"Search"},showAssociate:function(){return this.isFocus&&this.keyword},searchType:function(){return v.x[this.currentActiveTab]}},methods:{resetSearch:function(){this.keyword="",this.$emit("input","")},handleSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",o=this.keyword;this.searchType;this.$nextTick((function(){e.$refs.inputRef.blur()})),this.$emit("search",t||o,n)},searchLog:function(e){this.$logEvent("log_actions",{operation:"type_search",behavior_info:{1:"work",2:"model",6:"tag",8:"user",7:"post",13:"workFlow",14:"swtftApp",11:"designTemplate",9:"tavern"}[e]||"work"})},inputText:function(e){this.CombinedSelectionDialog.isClearCurTagFromSearch=!0,this.CombinedSelectionDialog.sessionID=Object(m.a)(),e&&this.debounceGetRelatedList(e)},onKeydown:function(){var e=this.associateList[this.keyIndex];e?this.handAssoriateItem(e):this.handleSearch()},onKeyWordUp:function(){var e=document.querySelector("#associateListId"),t=this.associateList.length;t&&(this.keyIndex--,this.keyIndex<=0&&(this.keyIndex=0),this.associateList.forEach((function(e){e.active=!1})),this.associateList[this.keyIndex].active=!0,this.keyIndex<t-4&&(e.scrollTop-=150))},onKeyWordDown:function(){var e=document.querySelector("#associateListId"),t=this.associateList.length-1;this.associateList.length&&(this.keyIndex++,this.keyIndex>=t&&(this.keyIndex=t),this.associateList.forEach((function(e){e.active=!1})),this.associateList[this.keyIndex].active=!0,this.keyIndex>4&&(e.scrollTop+=150))},onFocusFn:function(){this.isFocus=!0,this.showMockBox=!0,_=this.keyword,this.keyword&&this.debounceGetRelatedList()},onBlurFn:function(){var e=this;this.isFocus=!1,setTimeout((function(){e.showMockBox=!1}),200)},clearText:function(){var e=this;this.keyword="",this.$emit("input",""),this.associateList=[],this.$nextTick((function(){e.$refs.inputRef&&e.$refs.inputRef.focus()})),this.handleSearch()},handMaskBox:function(){this.keyword=_,this.$emit("input",this.keyword)},beforeUpload:function(e){return!!["image/jpeg","image/png","image/jpg","image/webp"].includes(e.type)||(this.$message.error(this.$t("AllowImageFiles")),!1)},handAssoriateItem:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o={art_model:"model",quick_app:"aiApp"}[e.source],l={obj:{name:(null==e?void 0:e.title)||"",id:null==e?void 0:e.source_id,banner:{url:(null==e?void 0:e.cover)||""}},type:o},"model"!==o){n.next=6;break}return t.handleSearch(null==e?void 0:e.title,"model"),n.abrupt("return");case 6:t.$EventBus.$emit("updateCategoryInfo",l),t.$nextTick((function(){t.$refs.inputRef&&t.$refs.inputRef.blur()})),t.$emit("close");case 9:case"end":return n.stop()}}),n)})))()},findMore:function(){this.handleSearch()},getRelatedList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.keyword;if(""!==t){var n={prefix:t,source_type:this.searchType,except_num:10,scene:"task_popup",ss:v.e.GenerateSearch};2===this.searchType&&(n.type="Checkpoint"),2===this.searchType&&(n.base_models=this.baseModels),this.isAdditionalModel&&(n.type="",n.model_types=this.baseModelTypes,n.base_models=this.modelTypes),Object(r.e)(n).then((function(t){var n,o=(null==t||null===(n=t.data)||void 0===n?void 0:n.items)||[];e.associateList=o.map((function(e){return f(f({},e),{},{active:!1})})),e.keyIndex=-1})).catch((function(t){150002===t.code&&(e.associateList=[])}))}else this.associateList=[]}}},C=y,w=(n(4249),n(0)),component=Object(w.a)(C,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"home-search",class:{"home-search-2":e.isShowLeftStyle}},[t("div",{staticClass:"flex justify-between items-center"},[t("el-input",{ref:"inputRef",staticClass:"style-content__search-input",attrs:{placeholder:e.$t(e.placeHolder),type:"input",resize:"none",maxlength:"2000"},on:{input:e.inputText,focus:e.onFocusFn,blur:e.onBlurFn},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onKeydown.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onKeyWordUp.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onKeyWordDown.apply(null,arguments)}]},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[t("i",{staticClass:"iconfont search-icon icon-search",attrs:{slot:"prefix"},slot:"prefix"}),e._v(" "),e.keyword?t("i",{staticClass:"el-input__icon el-icon-circle-close",attrs:{slot:"suffix"},on:{click:e.clearText},slot:"suffix"}):e._e()])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showAssociate,expression:"showAssociate"}],staticClass:"associate-content",class:{"associate-content-left":e.isShowLeftStyle},on:{mousedown:function(e){e.preventDefault()}}},[t("div",{staticClass:"item-list",attrs:{id:"associateListId"}},[t("LenovoPanel",{ref:"LenovoPanelRef",attrs:{list:e.associateList,keyword:e.keyword,showType:e.searchType},on:{onClick:e.handAssoriateItem,mousedown:function(e){e.preventDefault()}}})],1),e._v(" "),e.associateList.length>0?t("div",{staticClass:"more-item",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.findMore.apply(null,arguments)},mousedown:function(e){e.preventDefault()}}},[e._v("\n      "+e._s(e.$t("viewMore"))+"\n    ")]):e._e(),e._v(" "),0===e.associateList.length?[t("div",{staticClass:"no-search-box"},[t("el-image",{staticStyle:{width:"90px",height:"66px"},attrs:{src:e.searchNoDataImg}}),e._v(" "),t("p",[e._v(e._s(e.$t("NoSearchData")))])],1)]:e._e()],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showMockBox,expression:"showMockBox"}],staticClass:"mock-associate-box",on:{click:e.handMaskBox}})])}),[],!1,null,"ad0d8d94",null);t.default=component.exports;installComponents(component,{LenovoPanel:n(423).default})},860:function(e,t,n){"use strict";n.r(t);var o={name:"CombinedSelectDialogNoData"},l=(n(4250),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"style-content__list-empty"},[t("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),e._v(" "),t("p",[e._v(e._s(e.$t("NoResultsFound")))])],1)}),[],!1,null,"8b3b931c",null);t.default=component.exports;installComponents(component,{SvgIcon:n(115).default})},861:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(14),l=n(2),r=(n(19),n(16),n(18),n(138)),c=n(253),d=n(63),v=n(9),m=n(45),h=n(10),f=n(1),_=n(108),y=n(251);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"fastAppItem",components:{CollectPopover:d.default,changeVer:c.default,modelPayNum:r.default,HyColorfulBorder:_.default,FlagItem:y.default},mixins:[m.a],inject:["easyTop","CombinedSelectionDialog"],props:{logEventPosition:{type:String,default:""},item:{type:Object,default:function(){}},firstIndex:{type:Boolean,default:!1},lastIndex:{type:Boolean,default:!1},activeTopTab:{type:String,default:""},logData:{type:Object,default:function(){}}},data:function(){return{showImage:!0,formatNumberForeign:h.p,modelType:"Checkpoint",callBackObj:null}},computed:w(w({},Object(f.c)("user",["userInfo","isLoggedIn"])),{},{isShowImage:function(){return"image"===this.mediaType},isShowVideo:function(){return"video"===this.mediaType},mediaType:function(){return this.itemCover?this.itemCover instanceof Object?this.itemCover.url?"mp4"===this.itemCover.url.split(".").pop().toLowerCase()?"video":"image":"none":"mp4"===this.itemCover.split(".").pop().toLowerCase()?"video":"image":"none"},isShowEmpty:function(){return["",null,void 0].includes(this.itemCover)&&!this.isShowNsfw},isShowNsfw:function(){var e,t,n,o,l,r;return 1===(null===(e=this.item)||void 0===e?void 0:e.nsfw)||1===(null===(t=this.item)||void 0===t?void 0:t.nsfw_plus)||1===(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.nsfw)||1===(null===(o=this.item)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.nsfw_plus)||1===(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.nsfw)||1===(null===(r=this.item)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.nsfw_plus)},selectedId:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.selectedId},authorAvatar:function(){var e;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.head)||""},itemAuthorName:function(){var e,t;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.name)||(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||""},itemName:function(){var e,t,n;return(null===(e=this.item)||void 0===e?void 0:e.name)||(null===(t=this.item)||void 0===t||null===(t=t.comfy_ui)||void 0===t?void 0:t.name)||(null===(n=this.item)||void 0===n?void 0:n.title)||""},itemCover:function(){var e,t,n,o,l;return(null===(e=this.item)||void 0===e||null===(e=e.stream)||void 0===e?void 0:e.url3)||(null===(t=this.item)||void 0===t||null===(t=t.comfy_ui)||void 0===t?void 0:t.cover)||(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url)||(null===(o=this.item)||void 0===o?void 0:o.cover)||(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||""},getImageUrl:function(){var e="";return this.itemCover?e=Object(h.K)(this.itemCover,this.$imgL):e},getCurrentModelType:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentModelType},isSDXL:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSDXLModel},isSD35:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSd35Model},activeSelectModel:function(){var e,t;return((null===(e=this.item)||void 0===e?void 0:e.id)||(null===(t=this.item)||void 0===t?void 0:t.model_id))===this.selectedId?"select-model-active":""},getModels:function(){var e=v.L.sd,t=v.L.sdxl,n=v.L.flux,l=v.L.sd35,r=v.L.pony,c=void 0===r?[]:r,d=v.L.other,m=void 0===d?[]:d,h=[].concat(Object(o.a)(e),Object(o.a)(l),Object(o.a)(t),Object(o.a)(n),Object(o.a)(m));return{sd:this.SDmodel||[].concat(Object(o.a)(e),Object(o.a)(m)),sdxl:this.SDXLmodel||t,sd35:l,flux:n,allBaseModels:h,pony:c}},convertModelFlag:function(){return"APP"},isSelect:function(){var e,t;return((null===(e=this.item)||void 0===e?void 0:e.id)||(null===(t=this.item)||void 0===t?void 0:t.model_id))===this.selectedId},logExposureParams:function(){var e,t,n,o={type:this.item.obj_type,id:this.item.id,pt:this.item.pt||"",position:(null==this||null===(e=this.logData)||void 0===e?void 0:e.position)||"",index:null==this||null===(t=this.logData)||void 0===t?void 0:t.cindex,mIndex:null==this||null===(n=this.logData)||void 0===n?void 0:n.mIndex};return JSON.stringify(o)}}),methods:{handleClickCollect:function(){this.handleLogEventFn(this.item.collect?"collect":"cancel_collect"),this.setCollect(this.item,"swtft_app")},playVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.play()},pauseVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.pause()},handleImageError:function(){this.showImage=!1},handleLogEventFn:function(e){var t,n,o={operation:e,behavior_info:null===(t=this.item)||void 0===t?void 0:t.id,obj_type:14};null!==(n=this.CombinedSelectionDialog)&&void 0!==n&&n.dynamicModel&&this.logEventPosition&&(o.position=this.logEventPosition),this.$logEvent("log_actions",o)},addFavoriteCallback:function(){this.handleLogEventFn("collect")},unFavoriteCallback:function(e){this.$emit("unFavorite",e),this.handleLogEventFn("collect")},otherUser:function(){var e,t,n,path="/user/"+encodeURIComponent(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id);(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null===(n=this.item)||void 0===n||null===(n=n.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},handleDetail:function(){var e,t;this.handleLogEventFn("detail"),(null===(e=this.item)||void 0===e?void 0:e.id)&&window.open("/workFlowAppDetail/".concat(null===(t=this.item)||void 0===t?void 0:t.id))},handleSelect:function(e){var t,n;this.handleLogEventFn("click"),"hover-pop"===(null===(t=e.target)||void 0===t?void 0:t.className)&&(this.callBackObj={name:this.itemName,id:null===(n=this.item)||void 0===n?void 0:n.id,banner:{url:this.itemCover||""}},this.$emit("handleItemSelect",{obj:this.callBackObj,type:"aiApp"}))}}},I=(n(4251),n(0)),component=Object(I.a)(k,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_=this,y=_._self._c;return y("HyColorfulBorder",{attrs:{showBorder:_.item.edging&&!_.isSelect,borderColor:[null===(e=_.item.cover_web_color)||void 0===e?void 0:e.shallow_color,null===(t=_.item.cover_web_color)||void 0===t?void 0:t.deep_color]}},[y("div",{staticClass:"content__list-item",class:[_.activeSelectModel],attrs:{"data-event":"module-box-click","data-id":_.item.id,"data-pt":_.item.pt,"data-type":_.item.obj_type,"data-desc":_.item.obj_type,"data-index":null===(n=_.logData)||void 0===n?void 0:n.cindex,"data-position":null===(o=_.logData)||void 0===o?void 0:o.position,"data-sessionid":null===(l=_.logData)||void 0===l?void 0:l.session_id,"data-requestid":null===(r=_.logData)||void 0===r?void 0:r.request_id,"data-searchkeyword":null===(c=_.logData)||void 0===c?void 0:c.search_keyword,"data-ensearchkeyword":null===(d=_.logData)||void 0===d?void 0:d.en_search_keyword,"data-mindex":null===(v=_.logData)||void 0===v?void 0:v.mIndex},on:{click:function(e){return e.stopPropagation(),_.handleSelect(e)},mouseenter:_.playVideo,mouseleave:_.pauseVideo}},[y("div",{staticClass:"hover-pop"},[y("div",{staticClass:"collect-popover-container"},[y("CollectPopover",{attrs:{type:"swtft_app",folder:_.item,from:"waterfall"},on:{unFavorite:_.unFavoriteCallback,addFavorite:_.addFavoriteCallback}})],1),_._v(" "),y("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),_.handleDetail.apply(null,arguments)}}},[_._v("\n        "+_._s(_.$t("Details"))+"\n      ")])]),_._v(" "),y("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"item-image-wrapper",class:{"bg-nsfw":_.isShowNsfw}},[_.isShowEmpty?y("div",{staticClass:"list-item-image-card-image"},[y("div",{staticClass:"image-empty"},[_._v(_._s(_.$t("EmptyBannerText")))])]):_._e(),_._v(" "),_.isShowImage?y("img",{staticClass:"list-item-image-card-image gl-exposure-node",attrs:{"data-src":_.getImageUrl||_.itemCover,"log-exposure":_.logExposureParams}}):_._e(),_._v(" "),_.isShowVideo?y("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:_.isShowNsfw?"blur(19px) saturate(160%)":""},attrs:{src:_.isShowNsfw?"":_.itemCover,loop:"",muted:"",controls:!1,playsinline:""},domProps:{muted:!0}}):_._e(),_._v(" "),y("div",{staticClass:"info-handle-box"},[y("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[y("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[_._v("\n            "+_._s(_.itemName)+"\n          ")]),_._v(" "),y("div",{staticClass:"title"},[y("FlagItem",{directives:[{name:"show",rawName:"v-show",value:_.item.corner_mark,expression:"item.corner_mark"}],attrs:{type:_.item.corner_mark}}),_._v(" "),y("span",[_._v(_._s(_.itemName))])],1)]),_._v(" "),y("div",{staticClass:"subTitle"},[_._v(_._s(_.item.sub_title))]),_._v(" "),y("div",{staticClass:"user"},[y("div",{staticClass:"author-box",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),_.otherUser.apply(null,arguments)}}},[_.authorAvatar&&_.showImage?y("div",{staticClass:"authorHead"},[y("img",{directives:[{name:"webp",rawName:"v-webp",value:_.$imgL,expression:"$imgL"}],attrs:{src:_.authorAvatar,alt:"searArt.AI"},on:{error:_.handleImageError}})]):y("div",{staticClass:"authorHead"},[_._v(_._s(_.itemAuthorName[0]))]),_._v(" "),y("div",{staticClass:"authorName overflow-ellipsis"},[_._v(_._s(_.itemAuthorName))])]),_._v(" "),y("div",{staticClass:"num-box"},[y("div",{staticClass:"funItem"},[y("i",{staticClass:"iconfont icon-icon-play"}),_._v(" "),y("span",[_._v(_._s(_.formatNumberForeign((null===(m=_.item.stat)||void 0===m?void 0:m.num_of_task)||0)))])]),_._v(" "),y("div",{staticClass:"funItem",staticStyle:{margin:"0"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),_.handleClickCollect.apply(null,arguments)}}},[y("i",{staticClass:"iconfont",class:_.setCollectData(_.item)}),_._v(" "),(null===(h=_.item.stat)||void 0===h?void 0:h.num_of_collection)>0?y("span",[_._v("\n                "+_._s(_.formatNumberForeign((null===(f=_.item.stat)||void 0===f?void 0:f.num_of_collection)||0))+"\n              ")]):_._e()])])])],1)]),_._v(" "),_.convertModelFlag?[y("span",{staticClass:"model-type-flag"},[_._v("\n        "+_._s(_.convertModelFlag)+"\n      ")])]:_._e()],2)])}),[],!1,null,"2cd6e343",null);t.default=component.exports;installComponents(component,{CollectPopover:n(63).default})},862:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(14),l=n(2),r=(n(19),n(16),n(18),n(21),n(26),n(138)),c=n(253),d=n(63),v=n(9),m=n(45),h=n(10),f=n(1),_=n(97),y=n(108),C=n(251),w=n(815);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x={name:"modelItem",components:{commonConfirmModal:_.default,CollectPopover:d.default,changeVer:c.default,modelPayNum:r.default,HyColorfulBorder:y.default,FlagItem:C.default},mixins:[m.a,w.cardLogMixIn],inject:["easyTop","CombinedSelectionDialog"],props:{logEventPosition:{type:String,default:""},item:{type:Object,default:function(){}},firstIndex:{type:Boolean,default:!1},lastIndex:{type:Boolean,default:!1},activeTopTab:{type:String,default:""},logData:{type:Object,default:function(){}},isAdditionalModel:{type:Boolean,default:!1},additionalBaseModels:{type:Array,default:function(){return[]}}},data:function(){return{showImage:!0,model_type_map:{LORA:"LoRa",Checkpoint:"Checkpoint"},formatNumberForeign:h.p,modelType:"Checkpoint",callBackObj:null,selectModelData:null}},computed:I(I(I({},Object(f.e)("user",["collectData","cdnHost","token"])),Object(f.c)("user",["userInfo","isLoggedIn","getEnableUsePresetConfig"])),{},{mediaType:function(){return this.itemCover?this.itemCover instanceof Object?this.itemCover.url?"mp4"===this.itemCover.url.split(".").pop().toLowerCase()?"video":"image":"none":"mp4"===this.itemCover.split(".").pop().toLowerCase()?"video":"image":"none"},isShowEmpty:function(){return["",null,void 0].includes(this.itemCover)&&!this.isShowNsfw},isShowImage:function(){return"image"===this.mediaType},isShowVideo:function(){return"video"===this.mediaType},isShowNsfw:function(){var e,t,n,o,l,r;return 1===(null===(e=this.item)||void 0===e?void 0:e.nsfw)||1===(null===(t=this.item)||void 0===t?void 0:t.nsfw_plus)||1===(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.nsfw)||1===(null===(o=this.item)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.nsfw_plus)||1===(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.nsfw)||1===(null===(r=this.item)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.nsfw_plus)},collectOperation:function(){return"collect"===this.curPageCode?"cancel_collect":this.item.collect?"collect":"cancel_collect"},curPageCode:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e||null===(e=e.curPage)||void 0===e?void 0:e.code},getModelType:function(){var e,t=this.item,n=t.content_type,o=t.content_sub_type,l=t.type,r=void 0===l?"":l,c=t.base_model,d=void 0===c?"":c,m=(null===(e=this.item)||void 0===e?void 0:e.art_model)||{},h=m.type,f=void 0===h?"":h,_=m.base_model,y=n||r||f,C=o||d||(void 0===_?"":_),w={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:this.$t("embedding1")}[y]||y,k=(null===v.L||void 0===v.L?void 0:v.L.flux)||[],I="Pony"===C,x=C;return"Illustrious"===C?w+" | IL ":"NoobAI"===C?w+" | NAI ":C.includes("SDXL")&&!I?w+" | XL ":"HiDream"===C?w+" | HID ":"SeaArt Film"===C?w+" | SAF ":k.includes(x)?w+" | F1 ":w},gridNum:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.gridNum},selectedId:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.selectedId},authorAvatar:function(){var e;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.head)||""},itemAuthorName:function(){var e,t;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.name)||(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||""},itemName:function(){var e,t,n;return(null===(e=this.item)||void 0===e?void 0:e.title)||(null===(t=this.item)||void 0===t||null===(t=t.art_model)||void 0===t?void 0:t.name)||(null===(n=this.item)||void 0===n?void 0:n.name)||""},itemCover:function(){var e,t,n,o,l;return(null===(e=this.item)||void 0===e||null===(e=e.stream)||void 0===e?void 0:e.url3)||(null===(t=this.item)||void 0===t||null===(t=t.comfy_ui)||void 0===t?void 0:t.cover)||(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url)||(null===(o=this.item)||void 0===o?void 0:o.cover)||(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||""},itemCoverObj:function(){var e,t;return(null===(e=this.item)||void 0===e?void 0:e.cover)||(null===(t=this.item)||void 0===t?void 0:t.banner)||{}},getImageUrl:function(){var e="";return this.itemCover?e=Object(h.K)(this.itemCover,this.$imgL):e},getCurrentModelType:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentModelType},isSDXL:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSDXLModel},isSD35:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSd35Model},getBaseModel:function(){var e,t=this.getModels.sd;return this.isAdditionalModel?this.additionalBaseModels||[]:(t=this.isSDXL?this.getModels.sdxl:this.getModels.sd,this.isSDXL&&(t="Checkpoint"===this.modelType?[]:this.getModels.sd,"Checkpoint"===this.modelType&&(t=this.getModels.allBaseModels)),"flux"===this.getCurrentModelType&&(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isCommunityFlux)?Object(o.a)(v.L.flux):Object(o.a)(t))},activeSelectModel:function(){var e,t;return((null===(e=this.item)||void 0===e?void 0:e.id)||(null===(t=this.item)||void 0===t?void 0:t.model_id))===this.selectedId?"select-model-active":""},isSelect:function(){var e,t;return((null===(e=this.item)||void 0===e?void 0:e.id)||(null===(t=this.item)||void 0===t?void 0:t.model_id))===this.selectedId},getModels:function(){var e=v.L.sd,t=v.L.sdxl,n=v.L.flux,l=v.L.sd35,r=v.L.pony,c=void 0===r?[]:r,d=v.L.other,m=void 0===d?[]:d,h=[].concat(Object(o.a)(e),Object(o.a)(l),Object(o.a)(t),Object(o.a)(n),Object(o.a)(m));return{sd:this.SDmodel||[].concat(Object(o.a)(e),Object(o.a)(m)),sdxl:this.SDXLmodel||t,sd35:l,flux:n,allBaseModels:h,pony:c}},isVideoType:function(){var e;return 7===(null===(e=this.item)||void 0===e?void 0:e.sub_obj_type)},logExposureParams:function(){var e,t,n,o={type:this.item.obj_type,id:this.item.id,pt:this.item.pt||"",position:(null==this||null===(e=this.logData)||void 0===e?void 0:e.position)||"",index:null==this||null===(t=this.logData)||void 0===t?void 0:t.cindex,mIndex:null==this||null===(n=this.logData)||void 0===n?void 0:n.mIndex,obj_filter:this.item.obj_filter};return JSON.stringify(o)}}),methods:{handleClickCollect:function(){this.handleLogEventFn(this.collectOperation),this.setCollect(this.item,"model")},playVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.play()},pauseVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.pause()},handleImageError:function(){this.showImage=!1},handleLogEventFn:function(e){var t,n,o={operation:e,behavior_info:null===(t=this.item)||void 0===t?void 0:t.id,obj_type:2};null!==(n=this.CombinedSelectionDialog)&&void 0!==n&&n.dynamicModel&&this.logEventPosition&&(o.position=this.logEventPosition),this.$logEvent("log_actions",o)},addFavoriteCallback:function(){this.handleLogEventFn("collect")},unFavoriteCallback:function(e){this.$emit("unFavorite",e),this.handleLogEventFn("collect")},otherUser:function(){var e,t,path="/user/"+encodeURIComponent(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id);this.userInfo.id===(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},handleDetail:function(){var e,t;this.handleLogEventFn("detail"),(null===(e=this.item)||void 0===e?void 0:e.id)&&window.open("/models/detail/".concat(null===(t=this.item)||void 0===t?void 0:t.id))},selectItem:function(e,t,n){var o,l;if(null!==(o=this.item)&&void 0!==o&&o.child&&this.item.child.length>0&&(this.item.child[0].title=e.version_no),t.model_ver_no=e.model_ver_id,t.version_name=e.version_no,t.base_model=e.base_model_name,t.modelTags=Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[],t.trained_words=Array.isArray(null==e?void 0:e.trained_words)?null==e?void 0:e.trained_words:[],null!==(l=e.sample)&&void 0!==l&&null!==(l=l.banner)&&void 0!==l&&l.url){var r,c,d;if(t.cover)if(t.cover instanceof Object)t.cover.url=null===(c=e.sample)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.url;else t.cover=null===(d=e.sample)||void 0===d?void 0:d.banner;t.banner&&(t.banner.url=null===(r=e.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)}else t.cover&&t.cover instanceof Object&&(t.cover.url=""),t.banner&&(t.banner.url="");if(n){var v,m,h,f,_,y,C,w,k,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R,F,B,U,G,z,W,H,K,J;this.callBackObj=I(I({name:this.itemName,id:null==t?void 0:t.id,banner:{url:this.itemCover||"",width:(null===(v=this.itemCoverObj)||void 0===v?void 0:v.width)||(null===(m=this.item)||void 0===m?void 0:m.cover_width)||0,height:(null===(h=this.itemCoverObj)||void 0===h?void 0:h.height)||(null===(f=this.item)||void 0===f?void 0:f.cover_height)||0,nsfw:(null===(_=this.itemCoverObj)||void 0===_?void 0:_.nsfw)||(null===(y=this.item)||void 0===y?void 0:y.nsfw)||0,is_nsfw_plus:(null===(C=this.itemCoverObj)||void 0===C?void 0:C.nsfw_plus)||(null===(w=this.item)||void 0===w?void 0:w.nsfw_plus)||!1,green:(null===(k=this.itemCoverObj)||void 0===k?void 0:k.green)||(null===(x=this.item)||void 0===x?void 0:x.green)||0,has_meta:(null===(T=this.itemCoverObj)||void 0===T?void 0:T.has_meta)||0}},t),{},{base_model:(null===(S=this.item)||void 0===S?void 0:S.content_sub_type)||(null===(O=this.item)||void 0===O?void 0:O.base_model)||(null===(P=this.item)||void 0===P||null===(P=P.art_model)||void 0===P?void 0:P.base_model),type:(null===(M=this.item)||void 0===M?void 0:M.content_type)||(null===(L=this.item)||void 0===L?void 0:L.type)||(null===($=this.item)||void 0===$||null===($=$.art_model)||void 0===$?void 0:$.type),version_name:(null===(D=this.item)||void 0===D?void 0:D.version_name)||(null!==(j=this.item)&&void 0!==j&&j.child&&this.item.child.length>0?null===(E=this.item)||void 0===E?void 0:E.child[0].title:(null===(A=this.item)||void 0===A||null===(A=A.art_model)||void 0===A?void 0:A.version_name)||""),is_agency_fee:(null===(N=this.item)||void 0===N?void 0:N.is_agency_fee)||!1,agency_fee:(null===(V=this.item)||void 0===V?void 0:V.agency_fee)||0,payment_way:(null===(R=this.item)||void 0===R?void 0:R.payment_way)||0,sample_ids:(null===(F=this.item)||void 0===F?void 0:F.sample_ids)||null,model_ver_no:(null===(B=this.item)||void 0===B?void 0:B.model_ver_no)||(null!==(U=this.item)&&void 0!==U&&U.child&&this.item.child.length>0?null===(G=this.item)||void 0===G?void 0:G.child[0].id:(null===(z=this.item)||void 0===z||null===(z=z.art_model)||void 0===z?void 0:z.ver_id)||"")}),this.selectModelData={model:this.callBackObj,model_type:(null===(W=this.item)||void 0===W?void 0:W.content_type)||(null===(H=this.item)||void 0===H?void 0:H.type),isPreset:"preset",usePreset:!1};var X=1===(null===(K=this.item)||void 0===K?void 0:K.is_preset)||1===(null===(J=this.item)||void 0===J||null===(J=J.art_model)||void 0===J?void 0:J.is_preset)?"preset":"";this.handleConfirm(X)}},handleConfirm:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isAdditionalModel)return this.selectModelData.usePreset=!1,this.selectModelData.isPreset="",void this.sendData();this.selectModelData.usePreset=!0;var o=!["imageTrainModel"].includes(null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.currentTab);if(n&&this.getEnableUsePresetConfig&&o){var l,r,c=!0;if(this.isLoggedIn)c=null===(l=this.userInfo)||void 0===l?void 0:l.shot_task_v2_preset_meta_popup,null!==(r=this.userInfo)&&void 0!==r&&r.shot_task_v2_preset_meta_popup||localStorage.setItem("presetModelNotTips",1);else c=!localStorage.getItem("presetModelNotTips");if(c)this.$refs.commonConfirmModal.show({subTitle:"newGenerate60",fromPage:"modelPreset"}).then((function(){t.selectModelData.usePreset=!0,t.selectModelData.isPreset="preset",t.$logEvent("log_actions",{operation:"click_try_it_now",behavior_info:"on_model_config_popup"}),t.sendData()})).catch((function(){t.selectModelData.usePreset=!1,t.sendData()}));else this.selectModelData.usePreset=!0,this.selectModelData.isPreset="preset",this.sendData()}else this.selectModelData.usePreset=!1,this.sendData()},sendData:function(){var e=this;this.isAdditionalModel?this.$emit("handleItemSelect",{obj:this.callBackObj,type:"additionalModel"}):(this.$emit("handleItemSelect",{obj:this.callBackObj,type:"model"}),setTimeout((function(){e.$EventBus.$emit("selectModel",e.selectModelData),e.selectModelData=null}),10))},handleSelect:function(e,t){var n,o,l,r,c,d,v,m,h,f,_,y,C,w,k,x,T,S,O,P,M,L,$,D,j,E,A,N,V;if(this.handleLogEventFn(t),["hover-pop","use"].includes(null===(n=e.target)||void 0===n?void 0:n.className)){this.callBackObj=I(I({name:this.itemName,id:null===(o=this.item)||void 0===o?void 0:o.id,banner:{url:this.itemCover||"",width:(null===(l=this.itemCoverObj)||void 0===l?void 0:l.width)||0,height:(null===(r=this.itemCoverObj)||void 0===r?void 0:r.height)||0,nsfw:null===(c=this.itemCoverObj)||void 0===c?void 0:c.url,is_nsfw_plus:(null===(d=this.itemCoverObj)||void 0===d?void 0:d.nsfw_plus)||(null===(v=this.item)||void 0===v?void 0:v.nsfw_plus)||!1,green:(null===(m=this.itemCoverObj)||void 0===m?void 0:m.green)||(null===(h=this.item)||void 0===h?void 0:h.green)||0,has_meta:(null===(f=this.itemCoverObj)||void 0===f?void 0:f.has_meta)||0}},this.item),{},{base_model:(null===(_=this.item)||void 0===_?void 0:_.content_sub_type)||(null===(y=this.item)||void 0===y?void 0:y.base_model),type:(null===(C=this.item)||void 0===C?void 0:C.content_type)||(null===(w=this.item)||void 0===w?void 0:w.type),version_name:(null===(k=this.item)||void 0===k?void 0:k.version_name)||(null!==(x=this.item)&&void 0!==x&&x.child&&this.item.child.length>0?null===(T=this.item)||void 0===T?void 0:T.child[0].title:(null===(S=this.item)||void 0===S||null===(S=S.art_model)||void 0===S?void 0:S.version_name)||""),is_agency_fee:(null===(O=this.item)||void 0===O?void 0:O.is_agency_fee)||!1,agency_fee:(null===(P=this.item)||void 0===P?void 0:P.agency_fee)||0,payment_way:(null===(M=this.item)||void 0===M?void 0:M.payment_way)||0,sample_ids:(null===(L=this.item)||void 0===L?void 0:L.sample_ids)||null,model_ver_no:(null===($=this.item)||void 0===$?void 0:$.model_ver_no)||(null!==(D=this.item)&&void 0!==D&&D.child&&this.item.child.length>0?this.item.child[0].id:(null===(j=this.item)||void 0===j||null===(j=j.art_model)||void 0===j?void 0:j.ver_id)||"")}),this.selectModelData={model:this.callBackObj,model_type:(null===(E=this.item)||void 0===E?void 0:E.content_type)||(null===(A=this.item)||void 0===A?void 0:A.type),isPreset:""};var R=1===(null===(N=this.item)||void 0===N?void 0:N.is_preset)||1===(null===(V=this.item)||void 0===V||null===(V=V.art_model)||void 0===V?void 0:V.is_preset)?"preset":"";this.handleConfirm(R)}}}},T=x,S=(n(4252),n(0)),component=Object(S.a)(T,(function(){var e,t,n,o,l,r,c,d,v,m,h,f,_,y=this,C=y._self._c;return C("HyColorfulBorder",{attrs:{showBorder:y.item.edging&&!y.isSelect,borderColor:[null===(e=y.item.cover_web_color)||void 0===e?void 0:e.shallow_color,null===(t=y.item.cover_web_color)||void 0===t?void 0:t.deep_color]}},[C("div",{staticClass:"content__list-item",class:[y.activeSelectModel],style:{height:5===y.gridNum?"340px":"280px"},attrs:{"data-event":"module-box-click","data-id":y.item.id,"data-pt":y.item.pt,"data-type":y.item.obj_type,"data-index":null===(n=y.logData)||void 0===n?void 0:n.cindex,"data-position":null===(o=y.logData)||void 0===o?void 0:o.position,"data-mindex":null===(l=y.logData)||void 0===l?void 0:l.mIndex,"data-sessionid":null===(r=y.logData)||void 0===r?void 0:r.session_id,"data-requestid":null===(c=y.logData)||void 0===c?void 0:c.request_id,"data-searchkeyword":null===(d=y.logData)||void 0===d?void 0:d.search_keyword,"data-ensearchkeyword":null===(v=y.logData)||void 0===v?void 0:v.en_search_keyword,"data-info":JSON.stringify(y.logData)},on:{click:function(e){return e.stopPropagation(),y.handleSelect(e,"click")},mouseenter:y.playVideo,mouseleave:y.pauseVideo}},[C("div",{staticClass:"hover-pop"},[C("div",{staticClass:"collect-popover-container"},[C("CollectPopover",{attrs:{type:"model",folder:y.item,from:"waterfall"},on:{unFavorite:y.unFavoriteCallback,addFavorite:y.addFavoriteCallback}})],1),y._v(" "),C("div",{staticClass:"detail-button",attrs:{"data-event":"model_info_click","data-info":JSON.stringify(y.getLogEventParams())},on:{click:function(e){return e.stopPropagation(),y.handleDetail.apply(null,arguments)}}},[y._v("\n        "+y._s(y.$t("Details"))+"\n      ")])]),y._v(" "),C("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"item-image-wrapper",class:{"bg-nsfw":y.isShowNsfw},style:{height:5===y.gridNum?"300px":"240px"}},[y.isShowEmpty?C("div",{staticClass:"list-item-image-card-image"},[C("div",{staticClass:"image-empty"},[y._v(y._s(y.$t("EmptyBannerText")))])]):y._e(),y._v(" "),y.isShowImage?C("img",{staticClass:"list-item-image-card-image gl-exposure-node",attrs:{"data-src":y.getImageUrl||y.itemCover,"log-exposure":y.logExposureParams}}):y._e(),y._v(" "),y.isShowVideo?C("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:y.isShowNsfw?"blur(19px) saturate(160%)":""},attrs:{src:y.isShowNsfw?"":y.itemCover,loop:"",muted:"",controls:!1,playsinline:""},domProps:{muted:!0}}):y._e(),y._v(" "),C("div",{staticClass:"info-handle-box"},[C("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[C("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[y._v("\n            "+y._s(y.itemName)+"\n          ")]),y._v(" "),C("div",{staticClass:"title"},[C("FlagItem",{directives:[{name:"show",rawName:"v-show",value:y.item.corner_mark,expression:"item.corner_mark"}],attrs:{type:y.item.corner_mark}}),y._v(" "),C("span",[y._v(y._s(y.itemName))])],1)]),y._v(" "),C("div",{staticClass:"subTitle"},[y._v(y._s(y.item.sub_title))]),y._v(" "),C("div",{staticClass:"user"},[C("div",{staticClass:"author-box",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),y.otherUser.apply(null,arguments)}}},[y.authorAvatar&&y.showImage?C("div",{staticClass:"authorHead"},[C("img",{directives:[{name:"webp",rawName:"v-webp",value:y.$imgL,expression:"$imgL"}],attrs:{src:y.authorAvatar,alt:"searArt.AI"},on:{error:y.handleImageError}})]):C("div",{staticClass:"authorHead"},[y._v(y._s(y.itemAuthorName[0]))]),y._v(" "),C("div",{staticClass:"authorName overflow-ellipsis"},[y._v(y._s(y.itemAuthorName))])]),y._v(" "),C("div",{staticClass:"num-box"},[C("div",{staticClass:"funItem"},[C("i",{staticClass:"iconfont icon-icon-play"}),y._v(" "),C("span",[y._v(y._s(y.formatNumberForeign((null===(m=y.item.stat)||void 0===m?void 0:m.num_of_task)||0)))])]),y._v(" "),C("div",{staticClass:"funItem",staticStyle:{margin:"0"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),y.handleClickCollect.apply(null,arguments)}}},[C("i",{staticClass:"iconfont",class:y.setCollectData(y.item)}),y._v(" "),(null===(h=y.item.stat)||void 0===h?void 0:h.num_of_collection)>=0?C("span",[y._v("\n                "+y._s(y.formatNumberForeign((null===(f=y.item.stat)||void 0===f?void 0:f.num_of_collection)||0))+"\n              ")]):y._e()])])])],1)]),y._v(" "),C("div",{staticClass:"bottom-box"},[C("changeVer",{attrs:{fontSize:"12",from:"styleModal",item:y.item,base_models:y.getBaseModel},on:{selectItem:function(e){return y.selectItem(e,y.item,y.activeSelectModel)}}}),y._v(" "),C("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),y.handleSelect(e,"use")}}},[y._v("\n        "+y._s(y.$t("workFlow46"))+"\n      ")])],1),y._v(" "),C("div",{staticClass:"tag-box"},[C("div",{staticClass:"model-type-flag"},[y._v("\n        "+y._s(y.getModelType)+"\n        "),"Pony"===(null===(_=y.item)||void 0===_?void 0:_.content_sub_type)?[C("span",{staticClass:"pony-span"},[y._v(" | ")]),y._v(" "),C("i",{staticClass:"iconfont icon-icon-horse"})]:y._e()],2),y._v(" "),y.isVideoType?C("div",{staticClass:"video-flag"},[C("i",{staticClass:"iconfont icon-icon-tag-video"})]):y._e()])]),y._v(" "),C("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"131598b0",null);t.default=component.exports;installComponents(component,{CollectPopover:n(63).default})},863:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),l=n(14),r=n(2),c=(n(20),n(19),n(16),n(18),n(21),n(26),n(138)),d=n(253),v=n(63),m=n(9),h=n(45),f=n(10),_=n(1),y=n(97),C=n(815);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I={name:"modelItemDes",components:{commonConfirmModal:y.default,CollectPopover:v.default,changeVer:d.default,modelPayNum:c.default},mixins:[h.a,C.cardLogMixIn],inject:["easyTop","CombinedSelectionDialog"],props:{logEventPosition:{type:String,default:""},item:{type:Object,default:function(){}},activeTopTab:{type:String,default:""},isAdditionalModel:{type:Boolean,default:!1},additionalBaseModels:{type:Array,default:function(){return[]}},logData:{type:Object,default:function(){}}},data:function(){return{showImage:!0,model_type_map:{LORA:"LoRa",Checkpoint:"Checkpoint"},formatNumberForeign:f.p,modelType:"Checkpoint",callBackObj:null,selectModelData:null}},computed:k(k(k({},Object(_.e)("user",["collectData","cdnHost","token"])),Object(_.c)("user",["userInfo","isLoggedIn","getEnableUsePresetConfig"])),{},{mediaType:function(){return this.itemCover?this.itemCover instanceof Object?this.itemCover.url?"mp4"===this.itemCover.url.split(".").pop().toLowerCase()?"video":"image":"none":"mp4"===this.itemCover.split(".").pop().toLowerCase()?"video":"image":"none"},isShowEmpty:function(){return["",null,void 0].includes(this.itemCover)&&!this.isShowNsfw},isShowImage:function(){return"image"===this.mediaType},isShowVideo:function(){return"video"===this.mediaType},isShowNsfw:function(){var e,t,n,o,l,r;return 1===(null===(e=this.item)||void 0===e?void 0:e.nsfw)||1===(null===(t=this.item)||void 0===t?void 0:t.nsfw_plus)||1===(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.nsfw)||1===(null===(o=this.item)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.nsfw_plus)||1===(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.nsfw)||1===(null===(r=this.item)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.nsfw_plus)},collectOperation:function(){return"collect"===this.curPageCode?"cancel_collect":this.item.collect?"collect":"cancel_collect"},curPageCode:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e||null===(e=e.curPage)||void 0===e?void 0:e.code},getModelType:function(){var e,t=this.item,n=t.content_type,o=t.content_sub_type,l=t.type,r=void 0===l?"":l,c=t.base_model,d=void 0===c?"":c,v=(null===(e=this.item)||void 0===e?void 0:e.art_model)||{},h=v.type,f=void 0===h?"":h,_=v.base_model,y=n||r||f,C=o||d||(void 0===_?"":_),w={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:this.$t("embedding1")}[y]||y,k=(null===m.L||void 0===m.L?void 0:m.L.flux)||[],I="Pony"===C,x=C;return"Illustrious"===C?w+" | IL ":"NoobAI"===C?w+" | NAI ":C.includes("SDXL")&&!I?w+" | XL ":"HiDream"===C?w+" | HID ":"SeaArt Film"===C?w+" | SAF ":k.includes(x)?w+" | F1 ":w},gridNum:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.gridNum},selectedId:function(){var e;return null===(e=this.CombinedSelectionDialog)||void 0===e?void 0:e.selectedId},authorAvatar:function(){var e;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.head)||""},itemAuthorName:function(){var e,t;return(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.name)||(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||""},itemName:function(){var e,t,n;return(null===(e=this.item)||void 0===e?void 0:e.title)||(null===(t=this.item)||void 0===t||null===(t=t.art_model)||void 0===t?void 0:t.name)||(null===(n=this.item)||void 0===n?void 0:n.name)||""},itemCover:function(){var e,t,n,o,l;return(null===(e=this.item)||void 0===e||null===(e=e.stream)||void 0===e?void 0:e.url3)||(null===(t=this.item)||void 0===t||null===(t=t.comfy_ui)||void 0===t?void 0:t.cover)||(null===(n=this.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url)||(null===(o=this.item)||void 0===o?void 0:o.cover)||(null===(l=this.item)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)||""},itemCoverObj:function(){var e,t;return(null===(e=this.item)||void 0===e?void 0:e.cover)||(null===(t=this.item)||void 0===t?void 0:t.banner)||{}},getImageUrl:function(){var e="";return this.itemCover?e=Object(f.K)(this.itemCover,this.$imgL):e},getCurrentModelType:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.currentModelType},isSDXL:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSDXLModel},isSD35:function(){var e;return null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isSd35Model},getBaseModel:function(){if(this.isAdditionalModel)return this.additionalBaseModels||[];var e,t=this.getModels.sd;return t=this.isSDXL?this.getModels.sdxl:this.getModels.sd,this.isSDXL&&(t="Checkpoint"===this.modelType?[]:this.getModels.sd,"Checkpoint"===this.modelType&&(t=this.getModels.allBaseModels)),"flux"===this.getCurrentModelType&&(null==this||null===(e=this.easyTop)||void 0===e?void 0:e.isCommunityFlux)?Object(l.a)(m.L.flux):Object(l.a)(t)},activeSelectModel:function(){var e,t;return((null===(e=this.item)||void 0===e?void 0:e.id)||(null===(t=this.item)||void 0===t?void 0:t.model_id))===this.selectedId?"select-model-active":""},getModels:function(){var e=m.L.sd,t=m.L.sdxl,n=m.L.flux,o=m.L.sd35,r=m.L.pony,c=void 0===r?[]:r,d=m.L.other,v=void 0===d?[]:d,h=[].concat(Object(l.a)(e),Object(l.a)(o),Object(l.a)(t),Object(l.a)(n),Object(l.a)(v));return{sd:this.SDmodel||[].concat(Object(l.a)(e),Object(l.a)(v)),sdxl:this.SDXLmodel||t,sd35:o,flux:n,allBaseModels:h,pony:c}},isVideoType:function(){var e;return 7===(null===(e=this.item)||void 0===e?void 0:e.sub_obj_type)},logExposureParams:function(){var e,t,n,o={type:this.item.obj_type,id:this.item.id,pt:this.item.pt||"",position:(null==this||null===(e=this.logData)||void 0===e?void 0:e.position)||"",index:null==this||null===(t=this.logData)||void 0===t?void 0:t.cindex,mIndex:null==this||null===(n=this.logData)||void 0===n?void 0:n.mIndex};return JSON.stringify(o)}}),methods:{extractDominantColor:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.m)(null===(n=e.item)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url);case 2:o=t.sent,e.$set(e.item,"dominantColor","rgb(".concat(o,")"));case 4:case"end":return t.stop()}}),t)})))()},handleClickCollect:function(){this.handleLogEventFn(this.collectOperation),this.setCollect(this.item,"model")},playVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.play()},pauseVideo:function(){this.isShowVideo&&this.$refs.mainVideo&&this.$refs.mainVideo.pause()},handleImageError:function(){this.showImage=!1},handleLogEventFn:function(e){var t,n,o={operation:e,behavior_info:null===(t=this.item)||void 0===t?void 0:t.id,obj_type:2};null!==(n=this.CombinedSelectionDialog)&&void 0!==n&&n.dynamicModel&&this.logEventPosition&&(o.position=this.logEventPosition),this.$logEvent("log_actions",o)},addFavoriteCallback:function(){this.handleLogEventFn("collect")},unFavoriteCallback:function(e){this.$emit("unFavorite",e),this.handleLogEventFn("collect")},otherUser:function(){var e,t,path="/user/"+encodeURIComponent(null===(e=this.item)||void 0===e||null===(e=e.author)||void 0===e?void 0:e.id);this.userInfo.id===(null===(t=this.item)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},handleDetail:function(){var e,t;this.handleLogEventFn("detail"),(null===(e=this.item)||void 0===e?void 0:e.id)&&window.open("/models/detail/".concat(null===(t=this.item)||void 0===t?void 0:t.id))},selectItem:function(e,t,n){var o,l;if(null!==(o=this.item)&&void 0!==o&&o.child&&this.item.child.length>0&&(this.item.child[0].title=e.version_no),t.model_ver_no=e.model_ver_id,t.version_name=e.version_no,t.base_model=e.base_model_name,t.modelTags=Array.isArray(null==e?void 0:e.tags)?null==e?void 0:e.tags:[],t.trained_words=Array.isArray(null==e?void 0:e.trained_words)?null==e?void 0:e.trained_words:[],null!==(l=e.sample)&&void 0!==l&&null!==(l=l.banner)&&void 0!==l&&l.url){var r,c,d;if(t.cover)if(t.cover instanceof Object)t.cover.url=null===(c=e.sample)||void 0===c||null===(c=c.banner)||void 0===c?void 0:c.url;else t.cover=null===(d=e.sample)||void 0===d?void 0:d.banner;t.banner&&(t.banner.url=null===(r=e.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)}else t.cover&&t.cover instanceof Object&&(t.cover.url=""),t.banner&&(t.banner.url="");if(n){var v,m,h,f,_,y,C,w,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V,R,F,B,U,G,z,W,H,K,J;this.callBackObj=k(k({name:this.itemName,id:null==t?void 0:t.id,banner:{url:this.itemCover||"",width:(null===(v=this.itemCoverObj)||void 0===v?void 0:v.width)||(null===(m=this.item)||void 0===m?void 0:m.cover_width)||0,height:(null===(h=this.itemCoverObj)||void 0===h?void 0:h.height)||(null===(f=this.item)||void 0===f?void 0:f.cover_height)||0,nsfw:(null===(_=this.itemCoverObj)||void 0===_?void 0:_.nsfw)||(null===(y=this.item)||void 0===y?void 0:y.nsfw)||0,is_nsfw_plus:(null===(C=this.itemCoverObj)||void 0===C?void 0:C.nsfw_plus)||(null===(w=this.item)||void 0===w?void 0:w.nsfw_plus)||!1,green:(null===(I=this.itemCoverObj)||void 0===I?void 0:I.green)||(null===(x=this.item)||void 0===x?void 0:x.green)||0,has_meta:(null===(T=this.itemCoverObj)||void 0===T?void 0:T.has_meta)||0}},t),{},{base_model:(null===(S=this.item)||void 0===S?void 0:S.content_sub_type)||(null===(O=this.item)||void 0===O?void 0:O.base_model)||(null===(P=this.item)||void 0===P||null===(P=P.art_model)||void 0===P?void 0:P.base_model),type:(null===(M=this.item)||void 0===M?void 0:M.content_type)||(null===(L=this.item)||void 0===L?void 0:L.type)||(null===($=this.item)||void 0===$||null===($=$.art_model)||void 0===$?void 0:$.type),version_name:(null===(D=this.item)||void 0===D?void 0:D.version_name)||(null!==(j=this.item)&&void 0!==j&&j.child&&this.item.child.length>0?null===(E=this.item)||void 0===E?void 0:E.child[0].title:(null===(A=this.item)||void 0===A||null===(A=A.art_model)||void 0===A?void 0:A.version_name)||""),is_agency_fee:(null===(N=this.item)||void 0===N?void 0:N.is_agency_fee)||!1,agency_fee:(null===(V=this.item)||void 0===V?void 0:V.agency_fee)||0,payment_way:(null===(R=this.item)||void 0===R?void 0:R.payment_way)||0,sample_ids:(null===(F=this.item)||void 0===F?void 0:F.sample_ids)||null,model_ver_no:(null===(B=this.item)||void 0===B?void 0:B.model_ver_no)||(null!==(U=this.item)&&void 0!==U&&U.child&&this.item.child.length>0?null===(G=this.item)||void 0===G?void 0:G.child[0].id:(null===(z=this.item)||void 0===z||null===(z=z.art_model)||void 0===z?void 0:z.ver_id)||"")}),this.selectModelData={model:this.callBackObj,model_type:(null===(W=this.item)||void 0===W?void 0:W.content_type)||(null===(H=this.item)||void 0===H?void 0:H.type),isPreset:"preset",usePreset:!1};var X=1===(null===(K=this.item)||void 0===K?void 0:K.is_preset)||1===(null===(J=this.item)||void 0===J||null===(J=J.art_model)||void 0===J?void 0:J.is_preset)?"preset":"";this.handleConfirm(X)}},handleConfirm:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isAdditionalModel)return this.selectModelData.usePreset=!1,this.selectModelData.isPreset="",void this.sendData();if(this.selectModelData.usePreset=!0,t&&this.getEnableUsePresetConfig){var n,o,l=!0;if(this.isLoggedIn)l=null===(n=this.userInfo)||void 0===n?void 0:n.shot_task_v2_preset_meta_popup,null!==(o=this.userInfo)&&void 0!==o&&o.shot_task_v2_preset_meta_popup||localStorage.setItem("presetModelNotTips",1);else l=!localStorage.getItem("presetModelNotTips");if(l)this.$refs.commonConfirmModal.show({subTitle:"newGenerate60",fromPage:"modelPreset"}).then((function(){e.selectModelData.usePreset=!0,e.selectModelData.isPreset="preset",e.$logEvent("log_actions",{operation:"click_try_it_now",behavior_info:"on_model_config_popup"}),e.sendData()})).catch((function(){e.selectModelData.usePreset=!1,e.sendData()}));else this.selectModelData.usePreset=!0,this.selectModelData.isPreset="preset",this.sendData()}else this.selectModelData.usePreset=!1,this.sendData()},sendData:function(){var e=this;this.isAdditionalModel?this.$emit("handleItemSelect",{obj:this.callBackObj,type:"additionalModel"}):(this.$emit("handleItemSelect",{obj:this.callBackObj,type:"model"}),setTimeout((function(){e.$EventBus.$emit("selectModel",e.selectModelData),e.selectModelData=null}),10))},handleSelect:function(e,t){var n,o,l,r,c,d,v,m,h,f,_,y,C,w,I,x,T,S,O,P,M,L,$,D,j,E,A,N,V;if(this.handleLogEventFn(t),["hover-pop","use","bottom-box-btn"].includes(null===(n=e.target)||void 0===n?void 0:n.className)){this.callBackObj=k(k({name:this.itemName,id:null===(o=this.item)||void 0===o?void 0:o.id,banner:{url:this.itemCover||"",width:(null===(l=this.itemCoverObj)||void 0===l?void 0:l.width)||0,height:(null===(r=this.itemCoverObj)||void 0===r?void 0:r.height)||0,nsfw:null===(c=this.itemCoverObj)||void 0===c?void 0:c.url,is_nsfw_plus:(null===(d=this.itemCoverObj)||void 0===d?void 0:d.nsfw_plus)||(null===(v=this.item)||void 0===v?void 0:v.nsfw_plus)||!1,green:(null===(m=this.itemCoverObj)||void 0===m?void 0:m.green)||(null===(h=this.item)||void 0===h?void 0:h.green)||0,has_meta:(null===(f=this.itemCoverObj)||void 0===f?void 0:f.has_meta)||0}},this.item),{},{base_model:(null===(_=this.item)||void 0===_?void 0:_.content_sub_type)||(null===(y=this.item)||void 0===y?void 0:y.base_model),type:(null===(C=this.item)||void 0===C?void 0:C.content_type)||(null===(w=this.item)||void 0===w?void 0:w.type),version_name:(null===(I=this.item)||void 0===I?void 0:I.version_name)||(null!==(x=this.item)&&void 0!==x&&x.child&&this.item.child.length>0?null===(T=this.item)||void 0===T?void 0:T.child[0].title:(null===(S=this.item)||void 0===S||null===(S=S.art_model)||void 0===S?void 0:S.version_name)||""),is_agency_fee:(null===(O=this.item)||void 0===O?void 0:O.is_agency_fee)||!1,agency_fee:(null===(P=this.item)||void 0===P?void 0:P.agency_fee)||0,payment_way:(null===(M=this.item)||void 0===M?void 0:M.payment_way)||0,sample_ids:(null===(L=this.item)||void 0===L?void 0:L.sample_ids)||null,model_ver_no:(null===($=this.item)||void 0===$?void 0:$.model_ver_no)||(null!==(D=this.item)&&void 0!==D&&D.child&&this.item.child.length>0?this.item.child[0].id:(null===(j=this.item)||void 0===j||null===(j=j.art_model)||void 0===j?void 0:j.ver_id)||"")}),this.selectModelData={model:this.callBackObj,model_type:(null===(E=this.item)||void 0===E?void 0:E.content_type)||(null===(A=this.item)||void 0===A?void 0:A.type),isPreset:""};var R=1===(null===(N=this.item)||void 0===N?void 0:N.is_preset)||1===(null===(V=this.item)||void 0===V||null===(V=V.art_model)||void 0===V?void 0:V.is_preset)?"preset":"";this.handleConfirm(R)}}}},x=I,T=(n(4262),n(0)),component=Object(T.a)(x,(function(){var e,t,n,o,l,r,c,d,v,m,h,f=this,_=f._self._c;return _("div",[_("div",{staticClass:"content__list-item",class:[f.activeSelectModel],style:{height:5===f.gridNum?"340px":"280px"},attrs:{"data-event":"module-box-click","data-id":f.item.id,"data-pt":f.item.pt,"data-type":f.item.obj_type,"data-index":null===(e=f.logData)||void 0===e?void 0:e.cindex,"data-position":null===(t=f.logData)||void 0===t?void 0:t.position,"data-mindex":null===(n=f.logData)||void 0===n?void 0:n.mIndex,"data-info":JSON.stringify(f.logData)},on:{click:function(e){return e.stopPropagation(),f.handleSelect(e,"click")},mouseenter:f.playVideo,mouseleave:f.pauseVideo}},[_("div",{staticClass:"hover-pop"},[_("div",{staticClass:"collect-popover-container"},[_("CollectPopover",{attrs:{type:"model",folder:f.item,from:"waterfall"},on:{unFavorite:f.unFavoriteCallback,addFavorite:f.addFavoriteCallback}})],1),f._v(" "),_("div",{staticClass:"detail-button",attrs:{"data-event":"model_info_click","data-info":JSON.stringify(f.getLogEventParams())},on:{click:function(e){return e.stopPropagation(),f.handleDetail.apply(null,arguments)}}},[f._v("\n        "+f._s(f.$t("Details"))+"\n      ")])]),f._v(" "),_("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"item-image-wrapper",class:{"bg-nsfw":f.isShowNsfw},style:{height:5===f.gridNum?"340px":"280px"}},[_("div",{staticClass:"linear-mask",style:{background:"linear-gradient(to bottom, rgba(0, 0, 0, 0) 44%, ".concat(null===(o=f.item)||void 0===o||null===(o=o.cover_web_color)||void 0===o?void 0:o.deep_color," 100%)")}}),f._v(" "),f.isShowEmpty?_("div",{staticClass:"list-item-image-card-image"},[_("div",{staticClass:"image-empty"},[f._v(f._s(f.$t("EmptyBannerText")))])]):f._e(),f._v(" "),f.isShowImage?_("img",{staticClass:"list-item-image-card-image gl-exposure-node",attrs:{"data-src":f.getImageUrl||f.itemCover,alt:"","log-exposure":f.logExposureParams}}):f._e(),f._v(" "),f.isShowVideo?_("video",{ref:"mainVideo",staticClass:"cntVideo",style:{filter:f.isShowNsfw?"blur(19px) saturate(160%)":""},attrs:{src:f.isShowNsfw?"":f.itemCover,loop:"",muted:"",controls:!1,playsinline:""},domProps:{muted:!0}}):f._e(),f._v(" "),_("div",{staticClass:"info-handle-box"},[_("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[_("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[f._v("\n            "+f._s(f.itemName)+"\n          ")]),f._v(" "),_("div",{staticClass:"title"},[f._v(f._s(f.itemName))])]),f._v(" "),_("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[_("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[f._v("\n            "+f._s(null===(l=f.item)||void 0===l?void 0:l.sub_title)+"\n          ")]),f._v(" "),_("div",{staticClass:"model-description"},[f._v("\n            "+f._s(null===(r=f.item)||void 0===r?void 0:r.sub_title)+"\n          ")])]),f._v(" "),_("div",{staticClass:"user"},[_("div",{staticClass:"author-box",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),f.otherUser.apply(null,arguments)}}},[f.authorAvatar&&f.showImage?_("div",{staticClass:"authorHead"},[_("img",{directives:[{name:"webp",rawName:"v-webp",value:f.$imgL,expression:"$imgL"}],attrs:{src:f.authorAvatar,alt:"searArt.AI"},on:{error:f.handleImageError}})]):_("div",{staticClass:"authorHead"},[f._v(f._s(f.itemAuthorName[0]))]),f._v(" "),_("div",{staticClass:"authorName overflow-ellipsis"},[f._v(f._s(f.itemAuthorName))])]),f._v(" "),_("div",{staticClass:"num-box"},[_("div",{staticClass:"funItem"},[_("i",{staticClass:"iconfont icon-icon-play"}),f._v(" "),_("span",[f._v(f._s(f.formatNumberForeign((null===(c=f.item.stat)||void 0===c?void 0:c.num_of_task)||0)))])]),f._v(" "),_("div",{staticClass:"funItem",staticStyle:{margin:"0"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),f.handleClickCollect.apply(null,arguments)}}},[_("i",{staticClass:"iconfont",class:f.setCollectData(f.item)}),f._v(" "),(null===(d=f.item.stat)||void 0===d?void 0:d.num_of_collection)>=0?_("span",[f._v("\n                "+f._s(f.formatNumberForeign((null===(v=f.item.stat)||void 0===v?void 0:v.num_of_collection)||0))+"\n              ")]):f._e()])])])],1),f._v(" "),_("div",{staticClass:"bottom-box-btn-wrapper",style:{background:null===(m=f.item)||void 0===m||null===(m=m.cover_web_color)||void 0===m?void 0:m.deep_color}},[_("div",{staticClass:"bottom-box-btn",on:{click:function(e){return e.stopPropagation(),f.handleSelect(e,"use")}}},[f._v("\n          "+f._s(f.$t("workFlow46"))+"\n        ")])])]),f._v(" "),_("div",{staticClass:"tag-box"},[_("div",{staticClass:"model-type-flag"},[f._v("\n        "+f._s(f.getModelType)+"\n        "),"Pony"===(null===(h=f.item)||void 0===h?void 0:h.content_sub_type)?[_("span",{staticClass:"pony-span"},[f._v(" | ")]),f._v(" "),_("i",{staticClass:"iconfont icon-icon-horse"})]:f._e()],2),f._v(" "),f.isVideoType?_("div",{staticClass:"video-flag"},[_("i",{staticClass:"iconfont icon-icon-tag-video"})]):f._e()])]),f._v(" "),_("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[],!1,null,"2a5fc723",null);t.default=component.exports;installComponents(component,{CollectPopover:n(63).default})},866:function(e,t,n){"use strict";n.r(t);n(32),n(4);var o={name:"MarkImgSelect",model:{prop:"selectValue",event:"onChange"},props:{selectValue:{type:String,default:""},list:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{selectItem:function(){var e=this;return this.list.find((function(t){return t.value===e.selectValue}))||{}}},methods:{handleChange:function(e){var t=this.list.find((function(t){return t.value===e}));this.$emit("onChange",t.value)}}},l=(n(4277),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("el-select",{staticClass:"c-easy-mark-img-select",attrs:{"popper-class":"custom-select",placeholder:"",value:e.selectValue},on:{change:e.handleChange}},[e._l(e.list,(function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}},[t("div",{staticClass:"mark-img-select-item flex_m"},[n.img?[t("img",{staticClass:"folder-img",attrs:{src:n.img,alt:n.label}})]:t("div",{staticClass:"folder-img-fallback"},[t("i",{staticClass:"iconfont icon-home_icon_work"})]),e._v(" "),t("span",{staticClass:"folder-name"},[e._v(e._s(n.label))])],2)])})),e._v(" "),t("div",{staticClass:"mark-img-select-prefix flex_m",attrs:{slot:"prefix"},slot:"prefix"},[e.selectItem.img?[t("img",{staticClass:"folder-img",attrs:{src:e.selectItem.img,alt:e.selectItem.label}})]:t("div",{staticClass:"folder-img-fallback-option"},[t("i",{staticClass:"iconfont icon-home_icon_work"})]),e._v(" "),t("div",{staticClass:"folder-name-basic"},[t("span",{staticClass:"folder-name-title"},[e._v(e._s(e.$t("c_style")))]),e._v(" "),t("span",{staticClass:"folder-name-sub-title line-one"},[e._v(e._s(e.selectItem.label))])])],2)],2)}),[],!1,null,"6f13e2bc",null);t.default=component.exports},867:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(72),n(89),n(6),n(12),n(13),n(28),n(43),n(7),n(41);var o=n(14),l=n(3),r=n(2),c=(n(20),n(69),n(22),n(31),n(122),n(49),n(8),n(4),n(40),n(46)),d=n(80),v=n(161),m=n(433),h=n(1),f=n(599),_=n(10);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return C(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function C(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I={name:"SpecialEffectsAppPanel",components:{SpecialEffectsImage:f.default},props:["value","menuIndex"],inject:["easyTop"],data:function(){return{effectsList:[],effectsListCopy:[],sampleImages:[],displayedSamples:[],samplePageSize:5,remainingSampleIndices:[]}},computed:k(k({},Object(h.c)("creation",["video_config"])),{},{currentEffect:function(){var e;return(null==this||null===(e=this.value)||void 0===e?void 0:e.SpecialEffectsAppInfo)||{}},renderEffectsList:function(){return(this.effectsList||[]).slice(0,6)},specialEffectsImageList:function(){var e;return(null===(e=this.value)||void 0===e?void 0:e.specialEffectsImageList)||[]},specialEffectsOutputNodes:function(){var e;return(null===(e=this.value)||void 0===e||null===(e=e.SpecialEffectsAppInfo)||void 0===e||null===(e=e.templateInfo)||void 0===e||null===(e=e.inputs)||void 0===e?void 0:e.length)||1}}),watch:{currentEffect:{handler:function(e,t){(null==e?void 0:e.id)!==(null==t?void 0:t.id)&&this.updateEffectsList(e)}}},mounted:function(){this.getEffectsList(),this.getSampleImages()},methods:{getEffectsList:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,d,v,m,h,f,C,w,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o={page:1,page_size:6,comfy_ui_type:6,tag_ids:[],offset:"",order_by:""},t.next=4,Object(c.easyVideoEffectTemplateList)(o);case 4:l=t.sent,r=(null==l||null===(n=l.data)||void 0===n?void 0:n.items)||[],d=y(r),t.prev=7,d.s();case 9:if((v=d.n()).done){t.next=22;break}if(null==(h=v.value)||null===(m=h.cover)||void 0===m||!m.url){t.next=20;break}return t.prev=12,t.next=15,Object(_.w)(null==h||null===(f=h.cover)||void 0===f?void 0:f.url);case 15:h.cover.firstFrameUrl=t.sent,t.next=20;break;case 18:t.prev=18,t.t0=t.catch(12);case 20:t.next=9;break;case 22:t.next=27;break;case 24:t.prev=24,t.t1=t.catch(7),d.e(t.t1);case 27:return t.prev=27,d.f(),t.finish(27);case 30:e.effectsList=r,e.effectsListCopy=JSON.parse(JSON.stringify(e.effectsList)),e.effectsList.length>0&&(null!=e&&null!==(C=e.currentEffect)&&void 0!==C&&C.id?e.effectsList.some((function(t){return t.id===e.currentEffect.id}))||e.updateEffectsList(k(k({},e.currentEffect),{},{title:(null===(w=e.currentEffect)||void 0===w?void 0:w.title)||(null===(I=e.currentEffect)||void 0===I?void 0:I.name)})):e.handleSelectEffect(e.effectsList[0])),t.next=37;break;case 35:t.prev=35,t.t2=t.catch(0);case 37:case"end":return t.stop()}}),t,null,[[0,35],[7,24,27,30],[12,18]])})))()},getSampleImages:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.sampleImages=(null==e||null===(n=e.video_config)||void 0===n?void 0:n.effect_instance_image_list)||[],e.refreshDisplayedSamples()}catch(e){}case 1:case"end":return t.stop()}}),t)})))()},refreshDisplayedSamples:function(){var e=this;if(this.sampleImages.length<=this.samplePageSize)this.displayedSamples=Object(o.a)(this.sampleImages);else{(!this.remainingSampleIndices||this.remainingSampleIndices.length<this.samplePageSize)&&(this.remainingSampleIndices=Array.from({length:this.sampleImages.length},(function(e,i){return i})).sort((function(){return.5-Math.random()})));var t=this.remainingSampleIndices.splice(0,this.samplePageSize);this.displayedSamples=t.map((function(t){return e.sampleImages[t]}))}},handleChangeSamples:function(){this.refreshDisplayedSamples()},handleSelectSample:function(e){this.$emit("selectSample",e)},handleSelectEffect:function(e){var t=arguments,n=this;return Object(l.a)(regeneratorRuntime.mark((function o(){var l,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=t.length>1&&void 0!==t[1]&&t[1],o.prev=1,o.next=4,Object(d.h)({template_id:null==e?void 0:e.id});case 4:r=o.sent,n.$emit("selectEffect",k(k({},e),{},{templateInfo:(null==r?void 0:r.data)||{}})),n.updateEffectsList(k(k({},e),{},{templateInfo:(null==r?void 0:r.data)||{},title:(null==e?void 0:e.title)||(null==e?void 0:e.name)})),l&&n.$logEvent("log_actions",{operation:"click_special_effect_area",behavior_info:"on_createflow_page"}),o.next=12;break;case 10:o.prev=10,o.t0=o.catch(1);case 12:case"end":return o.stop()}}),o,null,[[1,10]])})))()},updateEffectsList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.effectsListCopy.some((function(t){return t.id===(null==e?void 0:e.id)}));if(!t&&null!=e&&e.id){var n=JSON.parse(JSON.stringify(this.effectsListCopy));n.unshift(k({},e)),this.effectsList=n.slice(0,6)}if(null!=e&&e.id&&t){var o=JSON.parse(JSON.stringify(this.effectsListCopy));this.effectsList=o.slice(0,6)}},handleViewMore:function(){var e=this,t=Object(v.a)({cached:!0,cacheKey:"taskSelectEffect",render:function(n){return n(m.default,{props:{effect:e.currentEffect},on:{selectEffect:function(n){e.handleSelectEffect(n),t.close()},cancel:function(){t.close()}}})}},this);this.$logEvent("log_actions",{operation:"click_view_more",behavior_info:"on_createflow_page"})}}},x=I,T=(n(4281),n(0)),component=Object(T.a)(x,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"special-effects-panel"},[t("special-effects-image",{key:"effects-img-0",attrs:{source:e.specialEffectsImageList[0],scene:"generateEffect"}}),e._v(" "),t("div",{staticClass:"sample-images-section"},[t("div",{staticClass:"section-header"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("ExampleImages")))]),e._v(" "),t("div",{staticClass:"change-btn",on:{click:e.handleChangeSamples}},[t("i",{staticClass:"el-icon-refresh"}),e._v("\n        "+e._s(e.$t("changeit"))+"\n      ")])]),e._v(" "),t("div",{staticClass:"sample-images-list"},e._l(e.displayedSamples,(function(n,o){return t("div",{key:o,staticClass:"sample-image-item",on:{click:function(t){return e.handleSelectSample(n)}}},[t("img",{attrs:{src:n.url,alt:"sample image"}})])})),0)]),e._v(" "),e.specialEffectsOutputNodes>=2?t("special-effects-image",{key:"effects-img-1",attrs:{source:e.specialEffectsImageList[1],scene:"generateEffect"}}):e._e(),e._v(" "),t("div",{staticClass:"effects-section"},[t("div",{staticClass:"section-header"},[t("div",{staticClass:"section-title"},[e._v(e._s(e.$t("pleaseSelectEffect")))]),e._v(" "),t("div",{staticClass:"view-more",on:{click:e.handleViewMore}},[e._v("\n        "+e._s(e.$t("viewMore"))+"\n        "),t("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),t("div",{staticClass:"effects-grid"},e._l(e.renderEffectsList,(function(n){var o,l,r,c,d,v,m;return t("div",{key:n.id,staticClass:"effect-card",class:{active:n.id===(null===(o=e.currentEffect)||void 0===o?void 0:o.id)},attrs:{"data-event":"special_effect_panel_item","data-id":n.id},on:{click:function(t){return e.handleSelectEffect(n,"needLog")}}},[null!=n&&null!==(l=n.sys_tag)&&void 0!==l&&l[0]?t("div",{staticClass:"effect-tag",class:{hot:"Hot"===(null==n||null===(r=n.sys_tag)||void 0===r?void 0:r[0]),new:"New"===(null==n||null===(c=n.sys_tag)||void 0===c?void 0:c[0])}},[e._v("\n          "+e._s(null==n||null===(d=n.sys_tag)||void 0===d?void 0:d[0])+"\n        ")]):e._e(),e._v(" "),t("el-tooltip",{attrs:{placement:"top","popper-class":"effect-cover-tooltip"},scopedSlots:e._u([{key:"content",fn:function(){var o;return[t("div",{staticClass:"effect-cover-tooltip-content"},[t("img",{attrs:{src:null==n||null===(o=n.cover)||void 0===o?void 0:o.url,alt:"effect cover"}}),e._v(" "),t("div",[e._v(e._s((null==n?void 0:n.title)||(null==n?void 0:n.name)||""))])])]},proxy:!0}],null,!0)},[t("div",{staticClass:"effect-cover"},[t("img",{attrs:{src:(null==n||null===(v=n.cover)||void 0===v?void 0:v.firstFrameUrl)||(null==n||null===(m=n.cover)||void 0===m?void 0:m.url),alt:"effect cover"}})])]),e._v(" "),t("div",{staticClass:"effect-title"},[e._v("\n          "+e._s(n.title||n.name||"")+"\n        ")])],1)})),0)])],1)}),[],!1,null,"77a237ea",null);t.default=component.exports},870:function(e,t,n){"use strict";n.r(t);n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),l=(n(22),n(4),n(137)),r=n(1),c=n(179);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={name:"UpscaleToolsModal",inject:["easyTop"],props:{value:{type:Object,default:function(){return{}}}},components:{SliderItem:l.default,PickOrUploadImageModal:c.default},mounted:function(){},data:function(){return{visible:!1,config:{up_scaler:"4x-UltraSharp",scaling_ratio:2,width:768,height:768,realWidth:0,realHeight:0,url:""},loading:!1,showUploadBtn:!0}},computed:v(v(v({},Object(r.c)("creation",["taskUpscaler"])),Object(r.c)("user",["accountSettingsData","userInfo","isCompanyAccount","isLoggedIn"])),{},{renderUpscaleOptions:function(){return(this.taskUpscaler||[]).map((function(e){return{id:e,name:e}}))},setExpend:function(){var e=1,t=Math.max(this.config.realWidth,this.config.realHeight);t*=this.config.scaling_ratio;return[{min:1024,max:1536,value:1},{min:1536,max:2048,value:3},{min:2048,max:2560,value:4},{min:2560,max:3072,value:6},{min:3072,max:3584,value:8},{min:3584,max:4096,value:10}].forEach((function(n){t>n.min&&t<=n.max&&(e=n.value||2)})),t>4096&&(e=10),e}}),methods:{handleImageLoad:function(e){var t=e.target.naturalWidth,n=e.target.naturalHeight;this.config.realWidth=t,this.config.realHeight=n,this.loading=!1},handleImageLoadError:function(){this.loading=!1},handleGenerate:function(){var e,t=this,n={action:6,category:1};if(n.meta={width:this.config.realWidth,height:this.config.realHeight,hi_res_arg:{image:this.config.url,upscaler_1:this.config.up_scaler,upscaling_resize:this.config.scaling_ratio}},this.config.source&&(n.source=this.config.source),this.config.channel_id&&(n.channel_id=this.config.channel_id),!this.validImageSize(this.config))return this.$message.warning(this.$t("ImageSizeExceedsError"));null===(e=this.easyTop)||void 0===e||e.handleImageExtraUpscale(n).then((function(){t.handleClose()}))},validImageSize:function(e){var t=e.realWidth,n=e.realHeight,o=e.scaling_ratio;return[t,n].every((function(e){return e*o<=4096}))},show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.resetData(),this.initData(e),this.visible=!0},resetData:function(){this.loading=!1,this.config={up_scaler:"4x-UltraSharp",scaling_ratio:2,width:768,height:768,realWidth:0,realHeight:0,url:""}},initData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.showUploadBtn=null===(e=null==t?void 0:t.showUploadBtn)||void 0===e||e,null!=t&&t.url&&(this.loading=!0,this.config.url=(null==t?void 0:t.url)||"",this.config.scaling_ratio=(null==t?void 0:t.upscaling_resize)||2,this.config.up_scaler=(null==t?void 0:t.upscaler_1)||"4x-UltraSharp",this.config.source=(null==t?void 0:t.source)||null,this.config.channel_id=(null==t?void 0:t.channel_id)||null)},handleClose:function(){this.visible=!1},handleConfirm:function(){this.handleClose()},changeConfig:function(e,t){this.$set(this.config,t,e)},handleSelectImage:function(){var e,t,n,o,l,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])[0]||{};this.loading=!0,this.config.width=null==r||null===(e=r.info)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.width,this.config.height=null==r||null===(t=r.info)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.height,this.config.realWidth=null==r||null===(n=r.info)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.width,this.config.realHeight=null==r||null===(o=r.info)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.height,this.config.url=null==r||null===(l=r.info)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url},openPickImageModal:function(){this.$refs.pickOrUploadImageModal.openModal()}}},h=m,f=(n(4326),n(0)),component=Object(f.a)(h,(function(){var e,t=this,n=t._self._c;return n("el-dialog",{attrs:{visible:t.visible,"custom-class":"easy-upscale-tools-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!0,modal:!1,"modal-append-to-body":"","append-to-body":"",width:"320px"},on:{"update:visible":function(e){t.visible=e}}},[n("div",{staticClass:"modal-header"},[n("div",{staticClass:"modal-header-title"},[t._v(t._s(t.$t("taskTabUpscale")))])]),t._v(" "),n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-content-item"},[n("div",{staticClass:"modal-content-item-label modal-content-item-label-flex"},[n("span",{staticClass:"modal-content-item-label-text"},[t._v(t._s(t.$t("newGenerate10")))]),t._v(" "),t.showUploadBtn?n("span",{staticClass:"modal-content-item-label-btn",on:{click:function(e){return e.stopPropagation(),t.openPickImageModal.apply(null,arguments)}}},[t._v(t._s(t.$t("CreativeCenterPopup33")))]):t._e()]),t._v(" "),n("div",{staticClass:"modal-content-item-content"},[null!==(e=t.config)&&void 0!==e&&e.url?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-content-item-content-img"},[n("img",{attrs:{src:t.config.url,alt:""},on:{load:t.handleImageLoad,error:t.handleImageLoadError}})]):n("div",{staticClass:"modal-content-item-content-upload-box",on:{click:function(e){return e.stopPropagation(),t.openPickImageModal.apply(null,arguments)}}},[n("span",{staticClass:"iconfont icon-icon_Upload modal-content-item-content-add-icon"})])])]),t._v(" "),n("div",{staticClass:"modal-content-item"},[n("div",{staticClass:"modal-content-item-label"},[t._v(t._s(t.$t("taskRepairMethod")))]),t._v(" "),n("div",{staticClass:"modal-content-item-content"},[n("el-select",{staticClass:"easy-custom-select",attrs:{"popper-append-to-body":!1,"popper-class":"custom-select"},model:{value:t.config.up_scaler,callback:function(e){t.$set(t.config,"up_scaler",e)},expression:"config.up_scaler"}},t._l(t.renderUpscaleOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t._v(" "),n("div",{staticClass:"modal-content-item"},[n("div",{staticClass:"modal-content-item-label"},[t._v(t._s(t.$t("taskScalingRatio")))]),t._v(" "),n("div",{staticClass:"modal-content-item-content"},[n("slider-item",{attrs:{"show-tooltip":!1,value:t.config.scaling_ratio,"hide-label":!0,min:1,max:4,step:.05,label:t.$t("taskScalingRatio")},on:{change:function(e){return t.changeConfig(e,"scaling_ratio")}}})],1)]),t._v(" "),n("el-button",{staticClass:"easy-upscale-tools-modal-btn",on:{click:function(e){return e.stopPropagation(),t.handleGenerate.apply(null,arguments)}}},[t._v("\n      "+t._s(t.$t("Generate"))+"\n      "),t.isCompanyAccount?t._e():n("span",{staticClass:"generate-btn-sub"},[t._v("\n        ("+t._s(t.$t("PhysicalExertion"))+": "+t._s(t.setExpend)+" )\n      ")])])],1),t._v(" "),n("pick-or-upload-image-modal",{ref:"pickOrUploadImageModal",on:{confirm:t.handleSelectImage}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SliderItem:n(105).default})},871:function(e,t,n){"use strict";n.r(t);n(16);var o=n(3299),l=n(3300),r={name:"CommonParamsPanel",inject:["easyTop"],props:["value","menuIndex","source"],components:{categoryPanel:o.default,workFlowAppParams:l.default},data:function(){return{}},mounted:function(){},computed:{characterId:function(){var e;return(null===(e=this.easyTop)||void 0===e||null===(e=e.categoryInfo)||void 0===e?void 0:e.id)||""},codeViewerHeight:function(){return this.app.isShowBanner?"calc(100vh - 20px - 74px - 46px - 62px)":"calc(100vh - 20px - 74px - 62px)"},codeViewData:function(){var e;return(null===(e=this.workFlowAppData)||void 0===e?void 0:e.inputs)||[]}},methods:{updateCharacterPage:function(e){this.$emit("updateCharacterPage",e)},createTask:function(){}}},c=(n(4356),n(0)),component=Object(c.a)(r,(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"c-common-params-panel",class:{"c-common-params-panel-character hide-scrollbar border-character bg-color-character":"character"===(null===(e=t.easyTop)||void 0===e?void 0:e.activeCategory)}},[n("div",{staticClass:"params-panel-main",class:[["app"].includes(t.menuIndex)&&"params-panel-main-100"]},[n("div",{staticClass:"params-panel-category-wrapper"},[n("category-panel",{attrs:{value:t.value,"menu-index":t.menuIndex}})],1),t._v(" "),n("work-flow-app-params",{attrs:{value:t.value,"menu-index":t.menuIndex,source:t.source}})],1)])}),[],!1,null,"7cbe88ad",null);t.default=component.exports},872:function(e,t,n){"use strict";n.r(t);var o=n(3),l=n(14),r=n(2),c=(n(20),n(72),n(89),n(19),n(6),n(11),n(69),n(73),n(22),n(12),n(13),n(8),n(40),n(7),n(41),n(31),n(18),n(24),n(4),n(28),n(43),n(113),n(51)),d=n(181),v=n(61),m=n(98),h=n(148);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return _(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function _(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={accept:".jpg,.png,.jpeg,.webp",zipMaxSize:10,fileMaxSize:20,minWh:[10,10],maxWh:[1e4,1e4],minProportion:[0,0],maxProportion:[0,0],multiple:!1,limit:2,directUse:!1,other:{}},k=".jpg,.png,.jpeg,.webp",I=".mp4,.mov,.m4v,.mts,.avi,.flv",x=".gif",T={name:"UploadBox",components:{},props:{category:{type:Number,default:2},uploadObj:{type:Object,default:function(){return{}}},fileTypes:{type:Array,default:function(){return["image"]}},videoCategory:{type:Number,default:61},beforeUpload:{type:Function,default:function(){return!0}},storagekey:{type:String,default:""}},watch:{uploadObj:{handler:function(e){var t={image:k,video:I,gif:x},n=this.fileTypes.map((function(e){return t[e]||""})).join(",");this.newUploadObj=C(C({},w),e),this.fileTypes.length&&(this.newUploadObj.accept=n)},deep:!0,immediate:!0}},data:function(){return{debounceCheckFile:Object(m.a)(this.checkFile,500),debounceVideoUpload:Object(m.a)(this.videoUpload,500),UPLOAD:new c.a({type:this.category}),UPLOADVIDEO:new d.a({category:this.category}),uploading:!1,newUploadObj:w}},methods:{reUpload:function(){this.$refs.imageUpload.$el.querySelector(".upload-trigger").click()},checkImageSize:function(e){return new Promise((function(t,n){var o=new FileReader;o.onload=function(e){var img=new Image;img.onload=function(){var e=img.naturalWidth,n=img.naturalHeight;t({width:e,height:n})},img.onerror=function(e){n(!1)},img.src=e.target.result},o.readAsDataURL(e)}))},handleChange:function(e,t){var n=this;if(this.beforeUpload({file:e,fileList:t})){var o=function(e,t){var n=t.split(",");return e.filter((function(e){return n.some((function(t){return e.name.toLowerCase().endsWith(t)}))}))},r=o(t,I),c=o(t,k),d=o(t,x);this.$emit("onUploadStart"),this.debounceCheckFile([].concat(Object(l.a)(c),Object(l.a)(d)),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.debounceVideoUpload(r,(function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=n.newUploadObj,d=[].concat(Object(l.a)(e),Object(l.a)(o)),v=[].concat(Object(l.a)(t),Object(l.a)(r));d.length>0?(n.$message.success(n.$t("UploadSuccess")),n.$emit("onUploadSuccess",d,c)):n.$emit("onUploadFail",v),n.$emit("onUploadEnd"),n.$refs.imageUpload.clearFiles()}))}))}},videoUpload:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,r,c,v;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n.uploading=!0,l=e.map((function(e){var t=new d.a({file:e.raw,category:n.videoCategory});return{fn:t.beforeUpload.bind(t)}})),o.next=4,n.serialPromises(l);case 4:r=o.sent,c=r.filter((function(e){return"fulfilled"===e.status})),n.uploading=!1,c.length>0?(v=c.map((function(e){return{url:e.value.url}})),t&&t(v)):t&&t([]);case 8:case"end":return o.stop()}}),o)})))()},checkFile:function(){var e=arguments.length>1?arguments[1]:void 0,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){return e.raw}));this.checkFileList(t,e)},checkFileList:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,r,c,d,v,m,h,f,_;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n.uploading=!0,l=n.UPLOAD,r=e.map((function(e){return{fn:n.oneFileCheck,param:e}})),o.next=5,n.serialPromises(r);case 5:if(c=o.sent,d=c.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})),c.filter((function(e){return"rejected"===e.status})).map((function(e){return e.reason})),!(d.length>0)){o.next=19;break}return v=d.map((function(e){return{fn:l.startUpload.bind(l),param:e.file,props:e}})),o.next=12,n.serialPromises(v);case 12:m=o.sent,h=m.filter((function(e){return"fulfilled"===e.status})),f=m.filter((function(e){var t;return"rejected"===e.status&&2e4==(null==e||null===(t=e.reason)||void 0===t?void 0:t.code)})),n.uploading=!1,h.length>0?(_=h.map((function(e){var t=e.value,n=e.props;return{url:t,width:n.width,height:n.height}})),t&&t(_)):t&&t([],f.map((function(e){var t=e.props.file;return{raw:t,name:t.name,size:t.size,status:"ready"}}))),o.next=21;break;case 19:n.uploading=!1,t&&t([]);case 21:case"end":return o.stop()}}),o)})))()},oneFileCheck:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(o,l){var r,c,d,m,f,_,y,C,w,k,I,x,T,S;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.UPLOAD,r=t.newUploadObj,!((c=e.size/1024/1024)>r.fileMaxSize)){n.next=6;break}return t.$message.error(t.$t("HttpErrorCode_30003")),l({file:e}),n.abrupt("return",!1);case 6:if(d=e,!("image/gif"===e.type||e.name.toLowerCase().endsWith(".gif")||c>r.zipMaxSize)){n.next=19;break}return n.prev=9,n.next=12,Object(v.a)(d,1024*r.zipMaxSize*1024);case 12:d=n.sent,n.next=19;break;case 15:return n.prev=15,n.t0=n.catch(9),l({file:e}),n.abrupt("return",!1);case 19:return n.next=21,t.checkImageSize(d);case 21:if(m=n.sent){n.next=25;break}return l({file:e}),n.abrupt("return",!1);case 25:f=m.width,_=m.height,y=r.minWh,C=r.maxWh,w=r.minProportion,k=r.maxProportion,I=[{check:Object(h.checkMinWh)(y,f,_),message:"imageRuleMinWh",params:{w:y[0],h:y[1]}},{check:Object(h.checkMaxWh)(C,f,_),message:"imageRuleMaxWh",params:{w:C[0],h:C[1]}},{check:Object(h.checkMinProportion)(w,f,_),message:"imagEaspectRatio",params:{num1:w.join(":"),num2:k.join(":")}},{check:Object(h.checkMaxProportion)(k,f,_),message:"imagEaspectRatio",params:{num1:k.join(":"),num2:w.join(":")}}],x=0,T=I;case 29:if(!(x<T.length)){n.next=38;break}if(!(S=T[x]).check){n.next=35;break}return t.$message.error(t.$t(S.message,S.params)),l({file:e}),n.abrupt("return",!1);case 35:x++,n.next=29;break;case 38:o({file:d,width:f,height:_});case 39:case"end":return n.stop()}}),n,null,[[9,15]])})));return function(e,t){return n.apply(this,arguments)}}())},handleBeforeUploadEmpty:function(e){},fileExceed:function(){this.$message({type:"warning",message:this.$t("UploadImageExceed",{max:this.newUploadObj.limit})})},serialPromises:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,r,c,d,v,param,m,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=[],l=t.newUploadObj.other,r=f(e),n.prev=3,r.s();case 5:if((c=r.n()).done){n.next=19;break}return d=c.value,v=d.fn,param=d.param,m=d.props,n.prev=7,n.next=10,v(param,{other:l});case 10:h=n.sent,o.push({status:"fulfilled",value:h,props:m}),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(7),o.push({status:"rejected",reason:n.t0,props:m});case 17:n.next=5;break;case 19:n.next=24;break;case 21:n.prev=21,n.t1=n.catch(3),r.e(n.t1);case 24:return n.prev=24,r.f(),n.finish(24);case 27:return n.abrupt("return",o);case 28:case"end":return n.stop()}}),n,null,[[3,21,24,27],[7,14]])})))()}}},S=T,O=(n(4333),n(0)),component=Object(O.a)(S,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"hy-upload-box"},[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],ref:"imageUpload",staticClass:"hy-custom-image-upload",attrs:{action:"#",drag:"","auto-upload":!1,multiple:e.newUploadObj.multiple,limit:e.newUploadObj.limit,"show-file-list":!1,disabled:e.uploading,accept:e.newUploadObj.accept,"on-change":e.handleChange,"on-exceed":e.fileExceed}},[t("div",{staticClass:"upload-trigger flex_c_m",attrs:{slot:"trigger"},slot:"trigger"},[t("i",{staticClass:"el-icon-plus"}),e._v(" "),t("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("click_upload_or_drag")))])])])],1)}),[],!1,null,"04ca8193",null);t.default=component.exports},873:function(e,t,n){"use strict";n.r(t);var o={name:"ExampleImage",props:{data:{type:Array,default:function(){return[]}},value:{type:String,default:""}},emits:["selected"],data:function(){return{height:64}},mounted:function(){this.getFieldSampleImageHeight()},methods:{selectImg:function(e){this.$emit("selected",e)},getFieldSampleImageHeight:function(){var e=this;this.$nextTick((function(){e.height=(e.$refs.exampleImagesRef.offsetWidth-40)/5}))}}},l=(n(4334),n(0)),component=Object(l.a)(o,(function(){var e,t=this,n=t._self._c;return null!==(e=t.data)&&void 0!==e&&e.length?n("div",{ref:"exampleImagesRef",staticClass:"example-images"},[n("div",{staticClass:"example-title"},[t._v(t._s(t.$t("ExampleImages")))]),t._v(" "),n("div",{staticClass:"example-images-list"},t._l(t.data,(function(e,o){return n("div",{key:o,staticClass:"example-image",class:{active:t.value===e},style:{height:t.height+"px"},on:{click:function(n){return t.selectImg(e)}}},[n("el-tooltip",{attrs:{"popper-class":"example-image-tooltip",effect:"dark",placement:"top"},scopedSlots:t._u([{key:"content",fn:function(){return[n("img",{staticClass:"example-image-tip",attrs:{src:e}})]},proxy:!0}],null,!0)},[n("img",{attrs:{src:e,alt:"example-image"}})])],1)})),0)]):t._e()}),[],!1,null,"6079d754",null);t.default=component.exports},874:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(19),n(11),n(72),n(89),n(69),n(16),n(31),n(18),n(4),n(28),n(43),n(21),n(40),n(41),n(90),n(92),n(3301));function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return c(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,l=function(){};return{s:l,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw r}}}}function c(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=Array(a);t<a;t++)n[t]=e[t];return n}var d={name:"ImageReversePrompt",inject:["top"],props:{data:{type:Object,default:function(){}}},components:{CircleLoading:l.default},data:function(){return{loading:!1,visible:!1,promptText:""}},watch:{"data.val":{handler:function(){this.reset(2)}},"data.reverse_prompt":{handler:function(){this.reset(1)}}},computed:{idsObj:function(){var e=this.data;return{field:e.field,node_id:e.node_id,node_type:e.node_type}}},mounted:function(){this.reset(1)},methods:{reset:function(source){var e,t;(this.visible=!1,this.loading=!1,this.promptText="",2==source)?(this.top.changeNodeProperty(this.idsObj,"reverse_prompt_visible",this.visible),this.top.changeNodeProperty(this.idsObj,"reverse_prompt",this.promptText)):(this.visible=(null===(e=this.data)||void 0===e?void 0:e.reverse_prompt_visible)||!1,this.promptText=(null===(t=this.data)||void 0===t?void 0:t.reverse_prompt)||"")},switchReverrsePrompt:function(){this.data.val?(this.visible=!this.visible,this.top.changeNodeProperty(this.idsObj,"reverse_prompt_visible",this.visible),!this.promptText&&this.visible&&this.getReverrsePrompt()):this.$message.warning(this.$t("pleaseUoloadImage"))},getReverrsePrompt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,c,d,v,m,h,f,_,y,C,w,k,line,text;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.data.val,!e.loading){t.next=3;break}return t.abrupt("return");case 3:return o=e.data.reverse_model_type,t.prev=4,e.loading=!0,t.next=8,fetch("/api/stream/tool/prompt/image",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",token:e.$cookies.get("T"),"Accept-Language":e.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-Device-Id":e.$cookies.get("deviceId"),"X-App-Id":"web_global_seaart"},body:JSON.stringify({image_url:n,scene:o})});case 8:l=t.sent,c=l.body.getReader(),d=new TextDecoder("utf-8"),v="",m="";case 13:return t.next=16,c.read();case 16:if(h=t.sent,f=h.done,_=h.value,!f){t.next=21;break}return t.abrupt("break",51);case 21:if(!(y=d.decode(_,{stream:!0})).includes('"code":10624')){t.next=25;break}return e.$message.error("".concat(e.$t("ai_app_use_count_limit"),"}")),t.abrupt("break",51);case 25:if(!y.includes('"code":20000')){t.next=28;break}return e.$EventBus.$emit("openLoginDialog"),t.abrupt("break",51);case 28:C=(v+=y).split("\n"),v=C.pop()||"",w=r(C),t.prev=32,w.s();case 34:if((k=w.n()).done){t.next=41;break}if(""!==(line=k.value).trim()){t.next=38;break}return t.abrupt("continue",39);case 38:if(line.startsWith("data: "))try{"---end---"!==(text=line.slice(6))&&(m+=text,e.promptText=m)}catch(e){console.error("解析数据失败:",e)}case 39:t.next=34;break;case 41:t.next=46;break;case 43:t.prev=43,t.t0=t.catch(32),w.e(t.t0);case 46:return t.prev=46,w.f(),t.finish(46);case 49:t.next=13;break;case 51:e.top.changeNodeProperty(e.idsObj,"reverse_prompt",e.promptText),e.loading=!1,t.next=59;break;case 55:t.prev=55,t.t1=t.catch(4),e.$message.error("".concat(e.$t("comicPage17"))),e.loading=!1;case 59:case"end":return t.stop()}}),t,null,[[4,55],[32,43,46,49]])})))()},handleCopy:function(){var e=this;navigator.clipboard.writeText(this.promptText).then((function(){e.$message.success(e.$t("CopySuccess"))})).catch((function(){e.$message.error(e.$t("taskOperateFailed"))}))},handleUsePrompt:function(){var e,t=this.top,n=t.codeViewData,o=t.changeVal,l=(null===(e=this.data)||void 0===e?void 0:e.reverse_node_ids)||[],map={};if(l.length){for(var i=0;i<n.length;i++){var r=n[i];map["".concat(r.node_id,"_").concat(r.node_type,"_").concat(r.field)]=r}for(var c=0;c<l.length;c++){var d=l[c],v=d.node_id,m=d.node_type,h=d.field;map["".concat(v,"_").concat(m,"_").concat(h)]&&o({field:h,node_id:v,node_type:m,val:this.promptText})}this.$emit("use-prompt",this.promptText)}}}},v=(n(4336),n(0)),component=Object(v.a)(d,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"image-reverse-prompt"},[e.loading?t("div",{staticClass:"loading-area"},[t("CircleLoading",{attrs:{"loading-text":e.$t("thinking"),direction:"row"}})],1):[t("div",{staticClass:"prompt-content"},[e._v(e._s(e.promptText))]),e._v(" "),t("div",{staticClass:"function-area"},[t("div",{staticClass:"use-prompt-btn",attrs:{"data-group":"ai-app-smart-prompt-apply","data-desc":"ai应用智能提示-使用提示词"},on:{click:e.handleUsePrompt}},[e._v("\n        "+e._s(e.$t("ai_app_use_smart_prompt"))+"\n      ")]),e._v(" "),t("div",{staticClass:"action-buttons"},[t("i",{staticClass:"iconfont icon-copy-template action-btn",attrs:{"data-group":"ai-app-smart-prompt-copy","data-desc":"ai应用智能提示-复制"},on:{click:e.handleCopy}}),e._v(" "),t("i",{staticClass:"iconfont icon-shuaxin action-btn",attrs:{"data-group":"ai-app-smart-prompt-refresh","data-desc":"ai应用智能提示-刷新"},on:{click:e.getReverrsePrompt}})])])]],2)}),[],!1,null,"1aa35121",null);t.default=component.exports},875:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(6),n(12),n(13);var o=n(3),l=n(2),r=(n(20),n(19),n(199),n(22),n(49),n(449),n(306),n(307),n(8),n(4),n(40),n(350),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(7),n(41),n(26),n(51)),c=n(29),d=n(104),v=n(10),m=n(1),h=n(264),f=n(121),_=n.n(f),y=n(61);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"maskModal",props:{mask:{type:String,default:function(){return""}}},data:function(){return{dialogVisible:!1,intLoading:!0,intImg:{url:"",width:0,height:0,size:50},MasterDrawing:"",intHeight:0,intWidth:0,mouseX:0,mouseY:0,isMousedown:!1,sizeList:[{name:"400%",value:400},{name:"200%",value:200},{name:"125%",value:125},{name:"100%",value:100},{name:"75%",value:75},{name:"50%",value:50},{name:"30%",value:30},{name:"20%",value:20},{name:"10%",value:10},{name:"fitToScreen",value:50},{name:"ai_erase3",value:100}],toolType:"smear",toolList:[{name:this.$t("erasePage1"),icon:"iconfont icon-tumo",value:"smear"},{name:this.$t("fastToolsEraser"),icon:"iconfont icon-icon_zidongcachu",value:"eraser"},{name:this.$t("addMaticSelection"),icon:"iconfont icon-jianyiban",value:"quick"},{name:this.$t("cancelMaticSelection"),icon:"iconfont icon-jianyiban",value:"cancelQuick"}],brushSize:40,canvas:null,context:null,startX:0,startY:0,blankCanvas:"",currentStep:-1,historyList:[],isDrawing:!1,uploading:!1,UPLOAD:new r.a({type:20}),drewPoints:[],rectList:[],imgSegmentUrlList:[],hoverMaskUrl:"",hasHover:!0,debounceHandleMouseMove:null,imagesList:[],loading:!1,inTimes:!1,retryCount:0,jsonUrl:"",imgUrl:"",imgShow:!0,lengthOfLongSide:0,consumption:1,minScaleSize:10,maxScaleSize:400,fieldInfo:null}},watch:{dialogVisible:{handler:function(e){e||(this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing="")}}},components:{generateRectItem:h.default},computed:w(w({},Object(m.c)("user",["isLoggedIn","accountSettingsData","cdnHostFun"])),{},{setCanvasStyle:function(){var e="";if(["smear","eraser"].includes(this.toolType)){var t=this.brushSize;t<10&&(t=10);var n='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 ').concat(t," ").concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat(t/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),o=btoa(n),l="data:image/svg+xml;base64,".concat(o);e="url(".concat(l,") ").concat(t/2," ").concat(t/2,", auto")}return"rectangle"==this.toolType&&(e="url(https://".concat(this.cdnHostFun(),"/20240312/cb26a6cd-7ca5-4e32-a633-df7094cb570d.cur) 8 8, auto")),"noose"==this.toolType&&(e="url(https://".concat(this.cdnHostFun(),"/20240307/3b553f30-1a01-4287-85b9-b1840754b717.cur) 8 8, auto")),"drag"==this.toolType&&(e="grab"),e}}),created:function(){this.debounceHandleMouseMove=Object(d.throttle)(this.handleMouseMove,300)},mounted:function(){document.addEventListener("keydown",this.shortcutKey)},beforeDestroy:function(){document.removeEventListener("keydown",this.shortcutKey)},methods:{setImageZoomIn:function(){this.intImg.size+10>=this.maxScaleSize?this.intImg.size=this.maxScaleSize:this.intImg.size+=10},setImageZoomOut:function(){this.intImg.size-10<=this.minScaleSize?this.intImg.size=this.minScaleSize:this.intImg.size-=10},resetData:function(){this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing="",this.fieldInfo=null},reupload:function(){this.$emit("reupload")},shortcutKey:function(e){(e.ctrlKey||e.metaKey)&&e.shiftKey&&"z"===e.key.toLowerCase()?this.handleNext():(e.ctrlKey||e.metaKey)&&"z"===e.key.toLowerCase()&&this.handlePre()},dwn:function(){Object(v.M)(this.imgUrl)},changeTool:function(e){this.toolType=e.value,this.setDrawType(),["cancelQuick","quick"].includes(this.toolType)&&!this.imgSegmentUrlList.length&&this.getSegmentMaskData()},handleMouseMove:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.checkCoordinate(e.offsetX,e.offsetY,t.imagesList);case 2:(o=n.sent)>=0&&t.hasHover&&t.setHoverMask(o);case 4:case"end":return n.stop()}}),n)})))()},getCacheSegmentMaskData:function(){var e=arguments;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!["",null,void 0].includes(n=e.length>0&&void 0!==e[0]?e[0]:"")){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,_.a.getItem(n);case 5:return o=t.sent,t.abrupt("return",o||null);case 7:case"end":return t.stop()}}),t)})))()},setHoverMask:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0,-1].includes(e)){n.next=3;break}return t.hoverMaskUrl="",n.abrupt("return");case 3:(l=new Image).src=t.imgSegmentUrlList[e],l.onload=Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=document.createElement("canvas")).width=t.intImg.width,n.height=t.intImg.height,(o=n.getContext("2d")).clearRect(0,0,t.intImg.width,t.intImg.height),o.globalCompositeOperation="source-in",o.fillStyle="#fff",o.fillRect(0,0,t.intImg.width,t.intImg.height),o.globalCompositeOperation="source-over",o.drawImage(l,0,0,t.intImg.width,t.intImg.height),t.hoverMaskUrl=n.toDataURL();case 11:case"end":return e.stop()}}),e)})));case 6:case"end":return n.stop()}}),n)})))()},selectRegion:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["cancelQuick","quick"].includes(t.toolType)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.checkCoordinate(e.offsetX,e.offsetY,t.imagesList);case 4:(o=n.sent)>=0&&t.selectSegmentMask(o);case 6:case"end":return n.stop()}}),n)})))()},cancelSelectSegmentMask:function(e){var t=document.createElement("canvas"),n=this.intImg,o=n.width,l=n.height;t.width=o,t.height=l;var r=t.getContext("2d"),c=new Image;c.src=this.imgSegmentUrlList[e],c.onload=function(){for(var e=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<e.length;i+=2)r.drawImage(c,4*e[i],4*e[i+1],o,l);r.drawImage(c,0,0,o,l);for(var t=r.getImageData(0,0,o,l).data,n=this.context.getImageData(0,0,o,l),d=n.data,v=0;v<l;v++)for(var m=0;m<o;m++){var h=4*(v*o+m);t[h+3]>0&&(d[h]=0,d[h+1]=0,d[h+2]=0,d[h+3]=0)}this.context.putImageData(n,0,0)}},selectSegmentMask:function(e){var t=this,n=new Image,o=this.$refs.canvas.getContext("2d"),l=this.intImg,r=l.width,c=l.height;n.src=this.imgSegmentUrlList[e],n.onload=function(){o.globalCompositeOperation=["cancelQuick"].includes(t.toolType)?"destination-out":"source-over";for(var e=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<e.length;i+=2)o.drawImage(n,4*e[i],4*e[i+1],r,c);o.drawImage(n,0,0,r,c),t.saveToHistory()}},checkCoordinate:function(e,t,n){var l=this;return Object(o.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",l.detectClickedImage(e,t,n));case 1:case"end":return o.stop()}}),o)})))()},detectClickedImage:function(e,t,n){for(var o=this.canvas.width/this.canvas.offsetWidth,i=n.length-1;i>=0;i--){var l=n[i],r=parseInt(e*o),c=parseInt(t*o);if(this.checkPixelTransparency(l,r,c))return i}},checkPixelTransparency:function(e,t,n){return 0!==e.data[4*(t+n*e.width)+3]},getSegmentMaskData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,d,v,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.loading||e.imgSegmentUrlList.length||e.uploading)){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,t.next=5,e.getCacheSegmentMaskData(null===(n=e.intImg)||void 0===n?void 0:n.url);case 5:if(!(o=t.sent)||!o.imgSegmentUrlList.length){t.next=12;break}return r=(l=o||{}).imgSegmentUrlList,d=void 0===r?[]:r,v=l.imagesList,m=void 0===v?[]:v,e.imgSegmentUrlList=d,e.imagesList=m,e.loading=!1,t.abrupt("return");case 12:h={action:14,meta:{smart_edit:{uri:e.intImg.url}}},Object(c.createTask)(h).then((function(t){1e4==t.status.code&&e.getTaskInfo([t.data.id])})).catch((function(t){e.loading=!1}));case 14:case"end":return t.stop()}}),t)})))()},getTaskInfo:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o={};if(o.task_ids=e,o.scene=1,!["cancelQuick","quick"].includes(this.toolType))return this.inTimes&&clearTimeout(this.inTimes),this.loading=!1,this.uploading=!1,void(this.intLoading=!1);this.isLoggedIn||(o.g_mode=1),Object(c.batchFetchTaskProcess)(o).then((function(o){var l,r,c,d,v;if(1e4==o.status.code)if(null!==(l=o.data)&&void 0!==l&&l.items[0]&&3==(null===(r=o.data)||void 0===r||null===(r=r.items[0])||void 0===r?void 0:r.status))if(clearTimeout(t.inTimes),t.jsonUrl=null===(v=o.data)||void 0===v?void 0:v.items[0].segment,1==n)t.loadJsonFile(t.jsonUrl);else{var m,h;t.imgUrl=null===(m=o.data)||void 0===m||null===(m=m.items[0])||void 0===m||null===(m=m.img_uris[0])||void 0===m?void 0:m.url;var img=new Image;img.src=null===(h=o.data)||void 0===h||null===(h=h.items[0])||void 0===h||null===(h=h.img_uris[0])||void 0===h?void 0:h.url,img.onload=function(){t.intImg.url=img.src,t.uploading=!1,t.loading=!1,t.intLoading=!1,t.rectList=[],t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.saveToHistory()},img.onerror=function(){t.intImg.url=img.src,t.uploading=!1,t.loading=!1,t.intLoading=!1,t.rectList=[],t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.saveToHistory()}}else null!==(c=o.data)&&void 0!==c&&c.items[0]&&4==(null===(d=o.data)||void 0===d||null===(d=d.items[0])||void 0===d?void 0:d.status)?(clearTimeout(t.inTimes),t.loading=!1,t.intLoading=!1,t.uploading=!1):(clearTimeout(t.inTimes),t.inTimes=setTimeout((function(){t.getTaskInfo(e,n)}),1e3))})).catch((function(e){t.loading=!1,t.uploading=!1,t.intLoading=!1}))},loadJsonFile:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch(t).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initCanvas(null==data?void 0:data.result);case 2:e.loading=!1;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(n){0===e.retryCount?(e.loadJsonFile(t).finally((function(){e.loading=!1})),e.retryCount++):e.$message.error(e.$t("ServerError"))}))},initCanvas:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var data,o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=e.length>0&&void 0!==e[0]?e[0]:[],t.imgSegmentUrlList=data.map((function(e){return"data:image/png;base64,".concat(e.mask_png)})),n.next=4,t.loadAllMask(t.imgSegmentUrlList);case 4:if(t.imagesList=n.sent,!t.imagesList.length){n.next=10;break}return{},l={imgSegmentUrlList:t.imgSegmentUrlList,imagesList:t.imagesList},n.next=10,_.a.setItem(null===(o=t.intImg)||void 0===o?void 0:o.url,l);case 10:case"end":return n.stop()}}),n)})))()},loadAllMask:function(){var e=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.intImg||{},n=t.width,o=t.height,l=(source||[]).map((function(e){return new Promise((function(t,n){var img=new Image;img.onload=function(){return t(img)},img.onerror=function(e){return n(e)},img.src=e}))}));return Promise.all(l).then((function(t){for(var l=[],i=0;i<t.length;i++){var img=t[i],r=document.createElement("canvas");r.width=n,r.height=o;var c=r.getContext("2d");c.drawImage(img,0,0,e.intImg.width,e.intImg.height);var d=c.getImageData(0,0,e.intImg.width,e.intImg.height);d.data;c.putImageData(d,0,0);var v=r.toDataURL();e.$set(e.imgSegmentUrlList,i,v);var m=c.getImageData(0,0,e.intImg.width,e.intImg.height);l.push(m),r=null,c=null}return l}))},show:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fieldInfo=n||null,this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url="",this.imgUrl="",this.MasterDrawing="",this.imagesList=[],this.debounceHandleMouseMove=Object(d.throttle)(this.handleMouseMove,300),this.intLoading=!0,this.$nextTick((function(){t.intImg.url=e,t.MasterDrawing=e,t.dialogVisible=!0,t.imgLoad()}))},intSize:function(){var e=window.innerHeight-240,t=this.intImg.height;this.intImg.width>2*this.intImg.height&&(e=window.innerWidth-100,t=window.innerWidth),this.intImg.size=parseInt(e/t*100)},changeSize:function(e){var t=this;if("fitToScreen"==e.name){var n=this.$refs.draggable;return n.style.left=null,n.style.top=null,void this.$nextTick((function(){t.intSize()}))}this.intImg.size=e.value},setConsumption:function(){this.consumption=1,this.lengthOfLongSide>=1024&&this.lengthOfLongSide<=2048?this.consumption=1.5:this.lengthOfLongSide>=2048&&this.lengthOfLongSide<=4096&&(this.consumption=4)},setDrawType:function(){this.context&&(this.context.globalCompositeOperation="eraser"===this.toolType?"destination-out":"source-over")},imgLoad:function(){this.intLoading=!0;var img=new Image;img.src=this.intImg.url;var e=this;img.onload=function(){e.lengthOfLongSide=Math.max(this.width,this.height),e.setConsumption(),e.intImg.width=this.width,e.intImg.height=this.height,e.intSize(),e.intLoading=!1,e.$nextTick(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canvas=e.$refs.canvas,e.context=e.canvas.getContext("2d"),e.context.fillStyle="rgba(255, 255, 255, 1)",e.context.lineJoin="round",e.context.lineCap="round",e.rectCanvas=e.$refs.rectCanvas,e.rectText=e.rectCanvas.getContext("2d"),e.rectText.strokeStyle="rgba(0,0,0,1)",e.rectText.fillStyle="rgba(255, 255, 255, 1)",e.rectText.lineJoin="round",e.rectText.lineCap="round",e.blankCanvas=e.canvas.toDataURL(),!e.mask){t.next=15;break}return t.next=15,e.displayMaskToCanvas(e.mask);case 15:e.saveToHistory();case 16:case"end":return t.stop()}}),t)}))))},img.onerror=function(){e.$message.error(e.$t("ai_erase4")),e.intLoading=!1}},displayMaskToCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this;return new Promise((function(n,o){var img=new Image;img.onload=function(){t.context.clearRect(0,0,t.canvas.width,t.canvas.height),t.context.drawImage(img,0,0,t.canvas.width,t.canvas.height),n()},img.onerror=function(e){n()},img.src=e}))},downElement:function(e){if("drag"==this.toolType){this.isMousedown=!0;var t=this.$refs.draggable;this.mouseX=e.clientX-t.offsetLeft,this.mouseY=e.clientY-t.offsetTop}},moveElement:function(e){if(this.isMousedown&&"drag"==this.toolType){var t=this.$refs.draggable;t.style.left=e.clientX-this.mouseX+"px",t.style.top=e.clientY-this.mouseY+"px"}},seupElement:function(){"drag"==this.toolType&&(this.isMousedown=!1)},startDrawing:function(e){if(["smear","eraser","noose"].includes(this.toolType))if(this.isDrawing=!0,this.startX=e.offsetX,this.startY=e.offsetY,["smear","eraser"].includes(this.toolType))this.context.strokeStyle="#fff",this.context.lineWidth=this.brushSize<10?10:this.brushSize,this.context.setLineDash([]);else if("noose"==this.toolType){var t=this.$refs.draggable;this.context.strokeStyle="rgba(0,0,0,1)";var n=t.getBoundingClientRect();this.drewPoints.push([{x:e.clientX-n.left,y:e.clientY-n.top}]),this.context.setLineDash([10,5]),this.context.lineWidth=2}},draw:function(e){if(this.isDrawing){var t,n,o=this.canvas.width/this.canvas.offsetWidth;if(this.context.scale(o,o),["smear","eraser"].includes(this.toolType)){var l=e.offsetX,r=e.offsetY;this.context.beginPath(),this.context.moveTo(this.startX,this.startY),this.context.lineTo(l,r),this.context.stroke(),this.startX=l,this.startY=r}else if("noose"==this.toolType){var c,d,v=this.$refs.draggable.getBoundingClientRect();c=e.clientX,d=e.clientY;var m=this.drewPoints[this.drewPoints.length-1];m.push({x:c-v.left,y:d-v.top});var h=m[0],f=m[1],_=m.length;this.context.beginPath(),this.context.moveTo(h.x,h.y);for(var i=1;i<_;i++){var y=(n=f,{x:(t=h).x+(n.x-t.x)/2,y:t.y+(n.y-t.y)/2});this.context.quadraticCurveTo(h.x,h.y,y.x,y.y),h=m[i],f=m[i+1]}this.context.lineTo(h.x,h.y),this.context.stroke()}this.context.scale(1/o,1/o)}},stopDrawing:function(){["smear","noose","eraser"].includes(this.toolType)&&this.isDrawing&&(this.isDrawing=!1,"noose"==this.toolType&&(this.context.closePath(),this.context.stroke(),this.context.fill()),this.saveToHistory())},startRectDrawing:function(e){"rectangle"==this.toolType&&(this.isDrawing=!0,this.startX=e.offsetX,this.startY=e.offsetY)},rectDraw:function(e){var t=this;if(this.isDrawing){var n=e.offsetX,o=e.offsetY;this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height),this.$nextTick((function(){var e=t.rectCanvas.width/t.rectCanvas.offsetWidth;t.rectText.scale(e,e),t.rectText.beginPath(),t.rectText.rect(t.startX,t.startY,n-t.startX,o-t.startY),t.rectText.fill(),t.rectText.stroke(),t.rectText.scale(1/e,1/e)})),this.rectCanvas.style.zIndex=9999}},stopRectDrawing:function(e){if("rectangle"==this.toolType&&this.isDrawing){this.isDrawing=!1,this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height);var t=e.offsetX,n=e.offsetY;this.rectList.push({left:t-this.startX>0?this.startX:t,top:n-this.startY>0?this.startY:n,width:Math.abs(t-this.startX),height:Math.abs(n-this.startY)}),this.saveToHistory(),this.rectCanvas.style.zIndex=2}},rectDelete:function(e){this.rectList.splice(e,1)},rectChange:function(e){this.rectList[e.index].top=e.top,this.rectList[e.index].left=e.left,this.rectList[e.index].width=e.width,this.rectList[e.index].height=e.height},saveToHistory:function(){var e=JSON.parse(JSON.stringify(this.rectList)),t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),img=JSON.parse(JSON.stringify(this.intImg.url));this.currentStep++,1==this.currentStep&&this.historyList.splice(1,this.historyList.length-1),this.historyList.push({currentImageData:t,rects:e,img:img}),this.currentStep=this.historyList.length-1},handlePre:function(){this.historyList.length>0&&this.currentStep>0&&(this.currentStep--,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleNext:function(){this.currentStep<this.historyList.length-1&&(this.currentStep++,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleReset:function(){this.historyList.length>1&&(this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url=this.MasterDrawing,this.imgUrl="",this.imgLoad())},checkImageSize:function(e){var t=this;return new Promise((function(n,o){var l=new FileReader;l.onload=function(e){var img=new Image;img.onload=function(){var e=img.width,o=img.height;t.$set(t,"style",{width:e,height:o});var l=[e,o].every((function(e){return e<=4096}));n(l)},img.onerror=function(){o(!1)},img.src=e.target.result},l.readAsDataURL(e)}))},uploadMaskImage:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,i,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn){t.next=4;break}return e.$EventBus.$emit("openLoginDialog",{dot:!1}),e.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),t.abrupt("return");case 4:if(e.intImg.width){t.next=6;break}return t.abrupt("return");case 6:if(!e.uploading&&!e.loading){t.next=8;break}return t.abrupt("return");case 8:for(e.uploading=!0,e.loading=!0,(n=document.createElement("canvas")).width=e.intImg.width,n.height=e.intImg.height,(o=n.getContext("2d")).clearRect(0,0,n.width,n.height),l=e.context.getImageData(0,0,e.canvas.width,e.canvas.height),i=0;i<l.data.length;i+=4)255===l.data[i]&&255===l.data[i+1]&&255===l.data[i+2]||(l.data[i]=255,l.data[i+1]=255,l.data[i+2]=255);if(o.putImageData(l,0,0),r=e.canvas.width/e.canvas.offsetWidth,e.rectList.length>0&&e.rectList.forEach((function(e){o.fillStyle="rgba(255, 255, 255, 1)",o.beginPath(),o.rect(e.left*r,e.top*r,e.width*r,e.height*r),o.fill()})),(c=n.toDataURL("image/png",.1))!==e.blankCanvas){t.next=27;break}return e.$emit("updateMask",""),e.uploading=!1,e.loading=!1,e.handleClose(),t.abrupt("return");case 27:return e.$emit("updateMask",c),t.next=30,e.handleMixGenerateMask();case 30:case"end":return t.stop()}}),t)})))()},handleMixGenerateMask:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var img;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(img=new Image).setAttribute("crossOrigin","anonymous"),img.src="".concat(e.intImg.url,"?t=").concat(Date.now()),img.onload=function(){var t=document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0}),o=document.createElement("canvas"),l=o.getContext("2d",{willReadFrequently:!0}),r=e.intImg||{},c=r.width,d=r.height;t.width=c,t.height=d,o.width=c,o.height=d,l.clearRect(0,0,t.width,t.height),l.drawImage(img,0,0,c,d,0,0,t.width,t.height),n.clearRect(0,0,t.width,t.height),n.drawImage(e.canvas,0,0,c,d,0,0,t.width,t.height);for(var v=n.getImageData(0,0,t.width,t.height),i=0;i<v.data.length;i+=4)255==v.data[i+3]?v.data[i+3]=0:v.data[i+3]=255,v.data[i]=0,v.data[i+1]=0,v.data[i+2]=0;n.globalCompositeOperation="source-over",n.putImageData(v,0,0),l.globalCompositeOperation="destination-in",l.drawImage(t,0,0);var m=o.toDataURL(),h=e.dataURLToBlob(m),f="clipspace-mask-"+Date.now()+".png";e.uploadMask(h,f)};case 4:case"end":return t.stop()}}),t)})))()},dataURLToBlob:function(e){for(var t=e.split(";base64,"),n=t[0].split(":")[1],o=atob(t[1]),l=new ArrayBuffer(o.length),r=new Uint8Array(l),i=0;i<o.length;i++)r[i]=o.charCodeAt(i);return new Blob([l],{type:n})},uploadMask:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var l,r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l="",o.prev=1,(c=(c=localStorage.getItem("userInfo"))&&JSON.parse(c))&&null!==(r=c)&&void 0!==r&&r.id){o.next=8;break}return n.$EventBus.$emit("openLoginDialog",{dot:!1}),n.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),o.abrupt("return");case 8:if(!(e.size/1024/1024>10)){o.next=18;break}return o.prev=9,o.next=12,Object(y.a)(e,10485760);case 12:e=o.sent,o.next=18;break;case 15:return o.prev=15,o.t0=o.catch(9),o.abrupt("return");case 18:return o.next=20,n.UPLOAD.startUpload(e,{category:20,name:"".concat(t),type:"png",isRedirection:!0}).then((function(e){l=e})).catch((function(e){n.$message.error(n.$t("uploadError"))}));case 20:n.$emit("confirm",l,n.fieldInfo),n.loading=!1,n.uploading=!1,n.handleClose(),o.next=31;break;case 26:o.prev=26,o.t1=o.catch(1),n.$message.error(n.$t("uploadError")),n.loading=!1,n.uploading=!1;case 31:case"end":return o.stop()}}),o,null,[[1,26],[9,15]])})))()},handleClose:function(){this.resetData(),this.dialogVisible=!1}}},I=k,x=(n(4337),n(4338),n(0)),component=Object(x.a)(I,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.dialogVisible,"custom-class":"c-generate-redraw-modal",fullscreen:!0,modal:!1,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.intLoading,expression:"intLoading"}],staticClass:"main"},[t("div",{staticClass:"top"},[t("div",{staticClass:"topItem"},[t("div",{staticClass:"back",on:{click:function(t){e.dialogVisible=!1}}},[t("i",{staticClass:"el-icon-back"})])]),e._v(" "),t("div",{staticClass:"topItem",class:{disabledStyle:e.intLoading}},[t("div",{staticClass:"bntBox"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fastToolsUndo"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:!e.historyList.length||1==e.historyList.length||0==e.currentStep},on:{click:function(t){return e.handlePre()}}},[t("i",{staticClass:"iconfont icon-draw-board-icon3"})])]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fastToolsRedo"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:e.currentStep==e.historyList.length-1},on:{click:function(t){return e.handleNext()}}},[t("i",{staticClass:"iconfont icon-draw-board-icon2"})])]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("S_ResetPrompt"),placement:"bottom"}},[t("div",{staticClass:"bnt",class:{disabledStyle:e.historyList.length<2},on:{click:function(t){return e.handleReset()}}},[t("i",{staticClass:"el-icon-refresh"})])])],1)]),e._v(" "),t("div",{staticClass:"topItem",staticStyle:{visibility:"hidden"}})]),e._v(" "),t("div",{staticClass:"right",class:{disabledStyle:e.intLoading}},[t("div",{staticClass:"dragIcon",on:{click:function(t){"drag"==e.toolType?e.toolType="smear":e.toolType="drag"}}},[t("i",{staticClass:"iconfont icon-zhuashou-copy",style:{color:"drag"==e.toolType?"#4784FF":null}})]),e._v(" "),t("div",{staticClass:"sizeBox"},[t("div",{staticClass:"sizeBnt",class:{disabledStyle:e.intImg.size<=e.minScaleSize},on:{click:e.setImageZoomOut}},[t("i",{staticClass:"el-icon-minus"})]),e._v(" "),t("el-popover",{attrs:{placement:"top",trigger:"hover","visible-arrow":!1,"popper-class":"sizeListBox"}},[t("div",{staticClass:"sizeList"},e._l(e.sizeList,(function(n,o){return t("div",{key:o,staticClass:"sizeItem",on:{click:function(t){return e.changeSize(n)}}},[e._v("\n              "+e._s(e.$t(n.name))+"\n            ")])})),0),e._v(" "),t("div",{staticClass:"sizeNum",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.intImg.size)+"%")])]),e._v(" "),t("div",{staticClass:"sizeBnt",class:{disabledStyle:e.intImg.size>=e.maxScaleSize},on:{click:e.setImageZoomIn}},[t("i",{staticClass:"el-icon-plus"})])],1)]),e._v(" "),t("div",{staticClass:"left",class:{disabledStyle:e.intLoading}},e._l(e.toolList,(function(n,o){return t("div",{key:o,staticClass:"toolItem",class:{activateToolItem:e.toolType==n.value},on:{click:function(t){return e.changeTool(n)}}},[t("i",{class:n.icon}),e._v(" "),t("span",[e._v(e._s(e.$t(n.name)))]),e._v(" "),"smear"==n.value&&"smear"==e.toolType||"eraser"==n.value&&"eraser"==e.toolType?t("div",{staticClass:"lineSize"},[t("span",[e._v(e._s(e.$t("Size")))]),e._v(" "),t("el-slider",{attrs:{"show-input":"","show-input-controls":!1,min:10},model:{value:e.brushSize,callback:function(t){e.brushSize=t},expression:"brushSize"}})],1):e._e()])})),0),e._v(" "),e.intLoading?e._e():t("div",{ref:"draggable",staticClass:"draggable",style:{width:e.intImg.width*e.intImg.size/100+"px",height:e.intImg.height*e.intImg.size/100+"px",cursor:e.setCanvasStyle},attrs:{id:"draggable"},on:{mousedown:function(t){return t.preventDefault(),e.downElement.apply(null,arguments)},mousemove:function(t){return t.preventDefault(),e.moveElement.apply(null,arguments)},mouseup:function(t){return t.preventDefault(),e.seupElement.apply(null,arguments)}}},[e.loading?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"laodMsk"}):e._e(),e._v(" "),e.intImg.url?t("img",{directives:[{name:"show",rawName:"v-show",value:e.imgShow,expression:"imgShow"}],attrs:{src:e.intImg.url,alt:""}}):e._e(),e._v(" "),e.MasterDrawing?t("img",{directives:[{name:"show",rawName:"v-show",value:!e.imgShow,expression:"!imgShow"}],attrs:{src:e.MasterDrawing,alt:""}}):e._e(),e._v(" "),t("canvas",{ref:"canvas",attrs:{width:e.intImg.width,height:e.intImg.height},on:{"&mousedown":function(t){return e.startDrawing.apply(null,arguments)},"&mousemove":function(t){["cancelQuick","quick"].includes(e.toolType)?e.debounceHandleMouseMove(t):e.draw(t)},"&mouseup":function(t){return e.stopDrawing.apply(null,arguments)},mouseenter:function(t){e.hasHover=!0},mouseleave:function(t){e.hasHover=!1,e.hoverMaskUrl="",e.stopDrawing()},mousedown:e.selectRegion}}),e._v(" "),e.hoverMaskUrl?t("img",{staticClass:"segment-image-draw-img-hover-mask",style:{width:e.intImg.width*e.intImg.size/100+"px",height:e.intImg.height*e.intImg.size/100+"px"},attrs:{src:e.hoverMaskUrl,alt:""}}):e._e(),e._v(" "),t("canvas",{directives:[{name:"show",rawName:"v-show",value:"rectangle"==e.toolType,expression:"toolType == 'rectangle'"}],ref:"rectCanvas",staticClass:"rectCanvas",attrs:{width:e.intImg.width,height:e.intImg.height},on:{"&mousedown":function(t){return e.startRectDrawing.apply(null,arguments)},"&mousemove":function(t){return e.rectDraw.apply(null,arguments)},"&mouseup":function(t){return e.stopRectDrawing.apply(null,arguments)}}}),e._v(" "),e._l(e.rectList,(function(n,o){return t("generate-rect-item",{key:"rect"+o,attrs:{item:n,index:o,size:e.intImg.size},on:{delete:e.rectDelete,change:e.rectChange}})}))],2),e._v(" "),t("el-button",{staticClass:"start",class:{disabledStyle:e.intLoading||e.loading},attrs:{disabled:e.intLoading||e.loading,loading:e.uploading},on:{click:e.uploadMaskImage}},[t("span",[e._v(e._s(e.$t("Done")))])])],1)])}),[],!1,null,"09835497",null);t.default=component.exports;installComponents(component,{GenerateRectItem:n(264).default})},876:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(50),n(16),n(22),n(24),n(113),n(21);var c=n(298),d=n(172),v=n(35),m=n.n(v),h=n(10),f=n(1),_=n(124),y=n(85),C=n(210),w=n(877),k=n(57);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T={name:"historyImg",inject:["top","workflowTaskView"],components:{taskImageViewer:c.default,SaveTo:_.default,ElImageViewer:d.a,auditDialog:C.a,CreateConfig:w.default},props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},imgInfo:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},baseSize:{type:String,default:""}},data:function(){return{loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:374,imageUrl:"",checked:!1,alreadySave:!1,hoverBtnList:[{code:"download",icon:"modelDownload",useText:!1,order:5,tips:"DownloadImg",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],bigImageBtns:[{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]}],isShowHoverMask:!1,viewImageList:[]}},computed:x(x(x(x({},Object(f.c)(["isSupportWebp"])),Object(f.c)("user",["userInfo","isCompanyAccount","isLoggedIn"])),Object(f.e)("user",["cdnHost"])),{},{getImageRenderAspectRatio:function(){var e,t={},n=(null==this||null===(e=this.message)||void 0===e||null===(e=e.components)||void 0===e?void 0:e[0])||{},o=n.width,l=n.height,r=this.isAspectRatioExtreme(o,l);return o&&l&&o!==l&&(o<384||l<384||r)&&(t.aspectRatio=o>l?"2/1":"1/2"),t},isEnableSubmit:function(){return!this.isShowNsfwBg&&!this.error&&!this.loading},getImageManageList:function(){var e;return null==this||null===(e=this.workflowTaskView)||void 0===e?void 0:e.manageList},convertPictureWidthAndHeight:function(){var e=this.message.banner,t=(void 0===e?{}:e)||{},n=t.width,o=void 0===n?200:n,l=t.height,r=void 0===l?200:l,c=Object(k.resizeImage)(o,r,this.baseImageWidth);return isNaN(c.height)?{}:{width:"".concat(c.width,"px"),height:"".concat(c.height,"px")}},currentImageIndex:function(){var e,t=this;return-1===(e=this.viewImageList.findIndex((function(e){return e.operateNumber===t.operateNumber})))?0:e},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},getRenderUrl:function(){var e,t=((null===(e=this.message)||void 0===e?void 0:e.components)||[]).findIndex((function(e){return 1!==e.nsfw}));if(-1!==t){var n,o=null===(n=this.message)||void 0===n||null===(n=n.components[t])||void 0===n?void 0:n.url;return(o=o?Object(h.K)(o,"high"):"")||"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")}return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var e="";return 1===this.nsfw||(e=this.checkIsShowViewNsfw?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===e)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw?(null==this||null===(e=this.imgInfo)||void 0===e?void 0:e.is_nsfw_plus)&&!this.imgInfo.canViewNsfw:1===this.nsfw);var e},isShowOperateBtn:function(){return!this.isBlur&&!this.error},isShowHover:function(){var e,t;return!!this.checkIsShowViewNsfw&&((null==this||null===(e=this.imgInfo)||void 0===e?void 0:e.is_nsfw_plus)&&!(null!=this&&null!==(t=this.imgInfo)&&void 0!==t&&t.canViewNsfw))},isNsfwPlus:function(){var e;return(null==this||null===(e=this.imgInfo)||void 0===e?void 0:e.is_nsfw_plus)&&1!==this.nsfw},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},isVideoUrl:function(){var e=this;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(t){return(e.imageUrl||"").toLowerCase().endsWith(t)}))},checkIsShowViewNsfw:function(){var e;return null==this||null===(e=this.userInfo)||void 0===e?void 0:e.enable_nsfw_plus},hoverBtnRenderList:function(){var e=this;return this.hoverBtnList.map((function(t){return t.show=e.isShowBtn(t.code),t})).filter((function(e){return e.show}))},isShowSaveTo:function(){var e,t,n=this.message.components,o=void 0===n?[]:n;return!!o.length&&!(null!==(e=o[this.operateNumber-1])&&void 0!==e&&e.is_saved_personal||null!==(t=o[this.operateNumber-1])&&void 0!==t&&t.alreadySave||this.alreadySave)},isShowBtn:function(){var e={save:[this.isShowSaveTo&&1!==this.nsfw],deleteSingleImg:[!0],download:[1!==this.nsfw]};return function(t){return!!Object.keys(e).includes(t)&&e[t].every((function(e){return!!e}))}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},enableNsfwMode:function(){var e;return![2,"2"].includes(null==this||null===(e=this.userInfo)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.nsfw_plus)}}),mounted:function(){this.$set(this.imgInfo,"canViewNsfw",this.checkIsShowViewNsfw&&this.enableNsfwMode)},watch:{src:{handler:function(e){e&&"string"==typeof e&&(this.imageUrl=this.isSupportWebp?Object(h.K)(e,"high"):this.src)},immediate:!0}},methods:x(x({},Object(f.b)("user",["getAccountInfo"])),{},{openLogin:function(){this.isLoggedIn||(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}))},isAspectRatioExtreme:function(e,t){try{return e/t>=2||t/e>=2}catch(e){return!1}},handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"});try{this.message.components[this.operateNumber-1].alreadySave=!0}catch(e){}this.alreadySave=!0,this.$emit("saveSuccess")},deleteSingleImg:function(){var e=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.$emit("deleteSingleImg",e.operateNumber,e.message)}))},handleShowNsfwImageUrl:function(){var e;return null!=this&&null!==(e=this.imgInfo)&&void 0!==e&&e.is_nsfw_plus&&!this.imgInfo.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(e){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",m()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var e=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){e.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(h.K)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){var e,t=this;1!==this.nsfw&&(this.isShowHover||(this.$logEvent("log_actions",{operation:"view_image",behavior_info:"on_quick_tools_created_records_page"}),console.log(this.viewImageList,this.message,"8888"),this.viewImageList=(m()((null===(e=this.message)||void 0===e?void 0:e.components)||[])||[]).map((function(e,t){return e.operateNumber=t+1,e})).filter((function(e){return t.checkIsShowViewNsfw&&t.enableNsfwMode?![1,"1"].includes(e.nsfw):![1,"1"].includes(null==e?void 0:e.nsfw)})),console.log(this.viewImageList,"this.viewImageList"),this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(e){1===this.nsfw&&e.preventDefault()},downloadImage:function(){Object(h.M)(this.src,this.$t("WorkFlow"))},handleClick:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["deleteSingleImg"].includes(t)?this.deleteSingleImg():"download"!==t?["save"].includes(t)&&(null===(e=this.$refs)||void 0===e||null===(e=e.saveToPopover[0])||void 0===e||e.doShow()):this.downloadImage()},settingViewNsfw:function(){var e;this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.enableNsfwMode||1===(null===(e=this.userInfo)||void 0===e?void 0:e.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog()},applyNsfw:function(){var e=this;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var t={};t.nsfw_plus=this.enableNsfwMode?2:1,t.mode=1,t.age_confirm=!0,Object(y.c)(t).then((function(t){var n=(t||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(e.$message.success(e.$t(e.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),e.getAccountInfo())})).finally((function(){e.$set(e.imgInfo,"canViewNsfw",!e.imgInfo.canViewNsfw)}))}else this.$set(this.imgInfo,"canViewNsfw",!this.imgInfo.canViewNsfw)},handImageBtns:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,t={chat:"click_chat",aiGenerateVideo:"click_image_to_video"};t[e]&&this.$logEvent("log_actions",{operation:t[e],behavior_info:"on_image_detail_page"})}})},S=T,O=(n(4368),n(4369),n(0)),component=Object(O.a)(S,(function(){var e,t,n=this,o=n._self._c;return o("div",{staticClass:"c-history-img"},[n.isLoggedIn||n.loading?n._e():o("div",{staticClass:"visitor-mask-box",on:{click:function(e){return n.openLogin()}}},[n._m(0),n._v(" "),o("div",{staticClass:"visitor-mask-box-text"},[n._v(n._s(n.$t("check_image")))])]),n._v(" "),o("div",{staticClass:"attachments-wrap",class:[n.checked?"attachments-wrap-checked":"",!n.isLoggedIn&&!n.loading&&"visitor-mask"]},[o("div",{staticClass:"message-attachment-media"},[o("div",{staticClass:"image-content"},[o("div",{staticClass:"image-content-wrap",class:[1===n.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(n.baseImageWidth,"px"),"min-width":"".concat(150,"px")}},[o("div",{staticClass:"image-render-box"},[1===n.nsfw?[o("img",{staticClass:"media-attachments-img image-opacity-0",style:n.loading?n.convertPictureWidthAndHeight:n.getImageRenderAspectRatio,attrs:{src:n.getRenderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:n.onLoad,error:n.onError,contextmenu:function(e){return n.handleContextMenu(e)}}})]:[n.isVideoUrl?n._e():o("img",{staticClass:"media-attachments-img",class:[n.loading?"":"media-attachments-img-show",n.loading?"image-opacity-0":"",n.isShowNsfwBg?"blurBackground":""],style:n.loading?n.convertPictureWidthAndHeight:n.getImageRenderAspectRatio,attrs:{src:n.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:n.onLoad,error:n.onError,click:n.viewBigImage,contextmenu:function(e){return n.handleContextMenu(e)}}}),n._v(" "),n.isVideoUrl&&n.getImageUrl?o("video",{class:[n.loading?"image-opacity-0":"",n.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px",width:"".concat(n.baseImageWidth,"px"),height:"".concat(parseInt(n.height*n.baseImageWidth/n.width),"px")},attrs:{src:n.getImageUrl,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{play:function(e){n.loading=!1}}}):n._e()],n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.loading&&1!==n.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[o("div",{staticClass:"loading-wrapper-inner"},[o("span",{staticClass:"spinner",attrs:{role:"img","aria-label":n.$t("Loading")}},[n._m(1)])])]),n._v(" "),n.isShowNsfwIcon?o("div",{staticClass:"generate-view-nsfw-plus",on:{click:function(e){return e.stopPropagation(),n.settingViewNsfw.apply(null,arguments)}}},[o("i",{staticClass:"iconfont",class:null!==(e=n.imgInfo)&&void 0!==e&&e.canViewNsfw?"icon-work-hide":"icon-work-show"})]):n._e(),n._v(" "),n.isEnableSubmit?[o("div",{staticClass:"image-manage-check-btn",class:[n.checked&&"image-manage-check-btn-active",(null===(t=n.getImageManageList)||void 0===t?void 0:t.length)&&"image-manage-check-btn-show"],on:{click:function(e){return e.stopPropagation(),n.handleClickCheck()}}},[o("span",{staticClass:"image-manage-check-btn-icon el-icon-check"})])]:n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowOperateBtn&&n.isShowImage&&n.src&&!n.loading||1===n.nsfw,expression:"(isShowOperateBtn && isShowImage && src && !loading) || nsfw === 1"}],staticClass:"image-hover-mask",on:{click:n.viewBigImage}},[o("div",{staticClass:"image-hover-mask-btn-box"},n._l(n.hoverBtnRenderList,(function(e){var t;return o("el-tooltip",{key:e.code,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:n.$t(null==e?void 0:e.tips)}},["save"!==e.code?o("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),n.handleClick(e.code)}}},[e.useText?[n._v("\n                      "+n._s(e.text)+"\n                    ")]:o("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.icon)})],2):n._e(),n._v(" "),"save"===e.code&&n.isShowSaveTo?o("save-to",{ref:"saveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:n.$t("Save"),message:r(r({},n.message),{},{img_uris:(null===(t=n.message)||void 0===t?void 0:t.components)||[]}),operateNumber:n.operateNumber,showArrowIcon:!1},on:{saveSuccess:n.handleSaveSuccess}},[o("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(e){return e.stopPropagation(),n.handleClick("save")}}},[e.useText?[n._v("\n                        "+n._s(e.text)+"\n                      ")]:o("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(e.icon)})],2)]):n._e()],1)})),1)])],2)]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.error&&!n.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[o("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),n._v(" "),o("span",{staticClass:"image-load-error-text",on:{click:function(e){return e.stopPropagation(),n.clickReloadImage.apply(null,arguments)}}},[n._v(n._s(n.$t("reloadImage")))])])])])]),n._v(" "),n.dialogVisible?o("task-image-viewer",{staticClass:"work-message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":n.closeViewBigImage,"initial-index":n.currentImageIndex,"show-operate-btn":!0,hoverBtnRenderList:n.bigImageBtns,message:n.message,"url-list":n.viewImageList,customForm:!0},on:{onClickBtns:n.handImageBtns},scopedSlots:n._u([{key:"customContent",fn:function(){return[o("CreateConfig",{attrs:{info:n.message}})]},proxy:!0}],null,!1,1028422645)}):n._e(),n._v(" "),o("auditDialog",{ref:"auditDialog",on:{confirm:n.applyNsfw}})],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"visitor-mask-box-icon"},[e("i",{staticClass:"iconfont icon-a-shoushijiaohu1"})])},function(){var e=this._self._c;return e("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[e("span",{staticClass:"item-2VgEex"}),e("span",{staticClass:"item-2VgEex"})])}],!1,null,"ecbcca7a",null);t.default=component.exports;installComponents(component,{SaveTo:n(124).default})},877:function(e,t,n){"use strict";n.r(t);n(18),n(16);var o=n(29),l=n(10),r={props:{info:{type:Object,default:function(){return{}}}},data:function(){return{formList:[]}},computed:{},mounted:function(){this.getMetaInfo()},methods:{isModelItem:function(e){return["CheckpointLoaderSimple","LoraLoader"].includes(e.node_type)},getMetaInfo:function(){var e=this,t=this.info.id;Object(o.getMetaInfo)({id:t}).then((function(t){var n;e.formList=(null==t||null===(n=t.data.meta)||void 0===n?void 0:n.comfyui_inputs)||[]}))},handleJumpDetail:function(){var e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})||{}).art_model,t=void 0===e?{}:e;null!=t&&t.id&&window.open("/models/detail/".concat(null==t?void 0:t.id),"_blank")},isWordsLine:function(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val).length<40},handleCopyAll:function(){var content=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val||"";content&&(this.$message.success(this.$t("CopySuccess")),Object(l.g)(content))}}},c=r,d=(n(4367),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"config-databox"},e._l(e.formList,(function(n,o){var l,r,c;return t("div",{key:n.field+o},[e.isModelItem(n)?[t("div",{staticClass:"easy-tooltip-wraper-model-box"},[t("div",{staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(t){return t.stopPropagation(),e.handleJumpDetail(n)}}},[t("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[t("img",{attrs:{src:null==n||null===(l=n.art_model)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url,alt:""}})]),e._v(" "),t("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[t("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[t("span",{staticClass:"easy-tooltip-model-box-model-type"},[e._v(e._s(e.$t(null==n||null===(r=n.art_model)||void 0===r?void 0:r.type)))])]),e._v(" "),t("div",{staticClass:"easy-tooltip-model-box-model-name"},[e._v("\n              "+e._s((null==n||null===(c=n.art_model)||void 0===c?void 0:c.name)||"")+"\n            ")])])])])]:e._e(),e._v(" "),e.isModelItem(n)?e._e():[n.val&&e.isWordsLine(n)?t("div",{staticClass:"line-cell flex"},[t("div",{staticClass:"title"},[e._v(e._s(n.field||""))]),e._v(" "),t("div",{staticClass:"content"},[e._v(e._s(n.val||""))])]):e._e(),e._v(" "),n.val&&!e.isWordsLine(n)?t("div",{staticClass:"lines-cell"},[t("div",{staticClass:"title flex_m"},[t("span",[e._v(" "+e._s(n.field||""))]),e._v(" "),t("span",{staticClass:"iconfont icon-codeCopy1 copy",on:{click:function(t){return t.stopPropagation(),e.handleCopyAll(n)}}})]),e._v(" "),t("div",{staticClass:"content"},[e._v(e._s(n.val||""))])]):e._e()]],2)})),0)}),[],!1,null,"a50f2b88",null);t.default=component.exports},878:function(e,t,n){"use strict";n.r(t);n(16),n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2);n(22),n(31);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={name:"MessageLoraPopup",props:{message:{type:Object,default:function(){return[]}}},data:function(){return{visible:!1}},computed:{getCoverList:function(){var e,t=((null===(e=this.message)||void 0===e?void 0:e.loras)||[]).map((function(e){var t;return r(r({},e),{},{url:(null==e||null===(t=e.banner)||void 0===t?void 0:t.url)||"",model_type_key:"LoCon"===(null==e?void 0:e.model_type)?"LyCORIS":"TextualInversion"===(null==e?void 0:e.model_type)?"embedding1":null==e?void 0:e.model_type})}));return(null==t?void 0:t.length)>3?t.slice(0,3):t}},methods:{jumpToDetail:function(e){if(null!=e&&e.id){var t=this.localePath("/models/detail/".concat(e.id));window.open(t,"_blank")}}}},d=(n(4370),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"easy-message-lora-popup","visible-arrow":!1,trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[e._t("default")]},proxy:!0}],null,!0)},[t("div",{staticClass:"message-lora-popup-body"},e._l(e.getCoverList,(function(n,o){var l,r;return t("div",{key:"lora_pop_".concat(o),staticClass:"message-lora-list-item",on:{click:function(t){return t.stopPropagation(),e.jumpToDetail(n)}}},[t("div",{staticClass:"message-lora-list-item-cover"},[null!=n&&null!==(l=n.banner)&&void 0!==l&&l.url?t("img",{attrs:{src:null==n||null===(r=n.banner)||void 0===r?void 0:r.url,alt:""}}):e._e()]),e._v(" "),t("div",{staticClass:"message-lora-list-item-content"},[t("div",{staticClass:"message-lora-list-item-content-title"},[t("span",{staticClass:"model-type"},[e._v(e._s(e.$t((null==n?void 0:n.model_type_key)||"LoRA")))]),e._v(" "+e._s((null==n?void 0:n.name)||"")+"\n        ")]),e._v(" "),["",null,void 0].includes(null==n?void 0:n.weight)?e._e():t("div",{staticClass:"message-lora-list-item-content-sub-title"},[e._v("\n          "+e._s(e.$t("Strength"))+" : "+e._s((null==n?void 0:n.weight)||"")+"\n        ")])])])})),0)])}),[],!1,null,null,null);t.default=component.exports},879:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=n(3),r=(n(20),n(46)),c=n(80),d=n(161),v=n(433);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={name:"SpecialEffectsAppSelect",inject:["easyTop"],data:function(){return{visible:!1,effectsList:[]}},computed:{currentEffect:function(){var e;return(null==this||null===(e=this.currentConfigInfo)||void 0===e?void 0:e.SpecialEffectsAppInfo)||{}}},mounted:function(){this.getList()},methods:{getList:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={page:1,page_size:12,comfy_ui_type:6,tag_ids:[],offset:"",order_by:""},t.next=3,Object(r.easyVideoEffectTemplateList)(o);case 3:l=t.sent,e.effectsList=(null==l||null===(n=l.data)||void 0===n?void 0:n.items)||[];case 5:case"end":return t.stop()}}),t)})))()},handleSelectEffect:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(c.h)({template_id:null==e?void 0:e.id});case 2:o=n.sent,t.$emit("select",h(h({},e),{},{templateInfo:(null==o?void 0:o.data)||{}})),t.visible=!1;case 5:case"end":return n.stop()}}),n)})))()},handleViewMore:function(){var e=this,t=Object(d.a)({cached:!0,cacheKey:"taskSelectEffect",render:function(n){return n(v.default,{props:{effect:e.currentEffect},on:{selectEffect:function(n){e.handleSelectEffect(n),t.close()},cancel:function(){t.close()}}})}},this)},handleClose:function(){this.visible=!1}}},_=(n(4407),n(0)),component=Object(_.a)(f,(function(){var e,t,n=this,o=n._self._c;return o("el-popover",{key:(null===(e=n.currentEffect)||void 0===e?void 0:e.id)||"no-effect",attrs:{trigger:null!==(t=n.currentEffect)&&void 0!==t&&t.id?"click":"hover","popper-class":"special-effects-popup","append-to-body":!0,"visible-arrow":!1},scopedSlots:n._u([{key:"reference",fn:function(){return[n._t("default")]},proxy:!0}],null,!0),model:{value:n.visible,callback:function(e){n.visible=e},expression:"visible"}},[o("div",{staticClass:"effects-popup-header"},[o("div",{staticClass:"effects-title"},[n._v("\n      "+n._s(n.$t("Effect"))+"\n      "),o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:n.$t("effectTip1"),placement:"top-start"}},[o("i",{staticClass:"custom-tips el-icon-warning"})])],1),n._v(" "),o("div",{staticClass:"view-more",on:{click:n.handleViewMore}},[n._v("\n      "+n._s(n.$t("viewMore"))+"\n      "),o("i",{staticClass:"el-icon-arrow-right"})])]),n._v(" "),o("div",{staticClass:"effects-grid"},n._l(n.effectsList,(function(e){var t,l,r,c,d;return o("div",{key:e.id,staticClass:"effect-card",on:{click:function(t){return n.handleSelectEffect(e)}}},[o("div",{staticClass:"effect-cover"},[o("img",{attrs:{src:null==e||null===(t=e.cover)||void 0===t?void 0:t.url,alt:"effect cover"}}),n._v(" "),null!=e&&null!==(l=e.sys_tag)&&void 0!==l&&l[0]?o("div",{staticClass:"effect-tag",class:{hot:"Hot"===(null==e||null===(r=e.sys_tag)||void 0===r?void 0:r[0]),new:"New"===(null==e||null===(c=e.sys_tag)||void 0===c?void 0:c[0])}},[n._v("\n          "+n._s(null==e||null===(d=e.sys_tag)||void 0===d?void 0:d[0])+"\n        ")]):n._e()]),n._v(" "),o("div",{staticClass:"effect-title"},[n._v("\n        "+n._s(e.title)+"\n      ")])])})),0)])}),[],!1,null,null,null);t.default=component.exports},880:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),l=(n(24),n(83)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"SelectVideo",components:{HyUploadModal:l.default},props:{value:{type:Object,default:function(){return{}}},menuIndex:{type:String,default:""},title:{type:String,default:"audio_load"},selectVideoTips:{type:String,default:"audio_load_history"},tips:{type:String,default:""},showCoverImg:{type:Boolean,default:!0},tabListKeys:{type:Array,default:function(){return["pick"]}},personalWorksQueryObj:{type:Object,default:function(){return{duration:15}}},beforeUpload:{type:Function,default:function(){return!0}},fileTypes:{type:Array,default:function(){return["video","gif"]}},videoCategory:{type:Number,default:61},checkLoading:{type:Boolean,default:!1},checkLoadingText:{type:String,default:""}},data:function(){return{}},computed:d(d({},Object(r.c)("user",["isLoggedIn"])),{},{getImageUrl:function(){var e,t;return this.showCoverImg?(null===(e=this.value)||void 0===e?void 0:e.coverUrl)||"":(null===(t=this.value)||void 0===t?void 0:t.url)||""}}),methods:{handleUpload:function(){null!=this&&this.isLoggedIn?this.$refs.pickOrUploadImageModal.openModal():this.$EventBus.$emit("openLoginDialog",{dot:!1})},handlePickImage:function(e){this.$emit("change",e[0])},handleDelete:function(){this.$emit("change",{})},handleVideoMouseEnter:function(e){e.target.controls=!0},handleVideoMouseLeave:function(e){e.target.controls=!1},handleVideoLoadedMetadata:function(e){this.$emit("loadedMetadata",e.target)}}},m=(n(4415),n(0)),component=Object(m.a)(v,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-video"},[t("p",{staticClass:"title"},[e._v(e._s(e.$t(e.title)))]),e._v(" "),t("div",{staticClass:"upload-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.checkLoading,expression:"checkLoading"}],staticClass:"upload-show",attrs:{"element-loading-text":e.checkLoadingText+"..."}},[e.getImageUrl?[t("div",{staticClass:"handle-btn reupload-btn",on:{click:function(t){return t.preventDefault(),e.handleUpload.apply(null,arguments)}}},[t("Icon",{attrs:{name:"a-Frame1",size:"16",color:"#fff"}})],1),e._v(" "),t("div",{staticClass:"handle-btn delete-btn",on:{click:function(t){return t.preventDefault(),e.handleDelete.apply(null,arguments)}}},[t("Icon",{attrs:{name:"a-pyDelete1",size:"16",color:"#fff"}})],1),e._v(" "),e.showCoverImg?t("img",{attrs:{src:e.getImageUrl,alt:""}}):t("video",{attrs:{src:e.getImageUrl,muted:"",disablepictureinpicture:"",oncontextmenu:"return false",controlsList:"nodownload nofullscreen noremoteplayback noplaybackrate"},domProps:{muted:!0},on:{loadedmetadata:e.handleVideoLoadedMetadata,mouseenter:e.handleVideoMouseEnter,mouseleave:e.handleVideoMouseLeave}})]:t("div",{staticClass:"upload-box",on:{click:e.handleUpload}},[t("Icon",{attrs:{name:"Frame1",size:"20"}}),e._v(" "),t("p",[e._v(e._s(e.$t(e.selectVideoTips)))]),e._v(" "),e.tips?t("span",{staticClass:"upload-tip"},[e._v(e._s(e.$t(e.tips)))]):e._e()],1)],2)]),e._v(" "),t("HyUploadModal",{ref:"pickOrUploadImageModal",attrs:{isSingleSelect:"",category:57,videoCategory:e.videoCategory,fileTypes:e.fileTypes,tabListKeys:e.tabListKeys,personalWorksQueryObj:e.personalWorksQueryObj,beforeUpload:e.beforeUpload},on:{onConfirm:e.handlePickImage}})],1)}),[],!1,null,"60ed487c",null);t.default=component.exports},881:function(e,t,n){"use strict";n.r(t);var o=n(14),l=(n(49),n(24),n(26),{name:"SampleVideo",props:{value:{type:Array,default:function(){return[]}},limit:{type:Number,default:5},title:{type:String,default:"recommendVideo"},dataEvent:{type:String,default:""}},data:function(){return{isRotating:!1,timer:null,videoList:[]}},mounted:function(){this.getRandomVideoList()},beforeDestroy:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},methods:{getRandomVideoList:function(){if(this.value.length){for(var e=Object(o.a)(this.value),t=[],n=e.length,l=Math.min(this.limit,n),i=0;i<l;i++){var r=Math.floor(Math.random()*e.length);t.push(e.splice(r,1)[0])}this.videoList=t}},changeVideoList:function(){var e=this;this.isRotating=!0,this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){e.isRotating=!1}),1e3),this.getRandomVideoList(),this.$emit("changeList",this.videoList)},handleVideoItemClick:function(e){this.$emit("change",e)}}}),r=(n(4416),n(4417),n(0)),component=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"sample-video"},[t("div",{staticClass:"sample-video-title"},[t("span",[e._v(e._s(e.$t(e.title)))]),e._v(" "),t("div",{staticClass:"sample-video-title-right",on:{click:e.changeVideoList}},[t("i",{staticClass:"el-icon-refresh",class:{"icon-rotating":e.isRotating}}),e._v(" "),t("span",[e._v(e._s(e.$t("changeit")))])])]),e._v(" "),t("div",{staticClass:"sample-video-content"},e._l(e.videoList,(function(n,o){return t("div",{key:n.id,staticClass:"sample-video-item",attrs:{"data-id":n.id,"data-event":e.dataEvent},on:{click:function(t){return e.handleVideoItemClick(n)}}},[e._t("contentItem",(function(){return[t("el-tooltip",{attrs:{"popper-class":"sample-video-item-popover",placement:"top",width:"100",enterable:!1,trigger:"click"}},[t("div",{staticClass:"sample-video-item-popover-video",attrs:{slot:"content"},slot:"content"},[t("video",{attrs:{src:n.url,autoplay:"",muted:"",loop:""},domProps:{muted:!0}})]),e._v(" "),t("img",{attrs:{src:n.cover,alt:"sample-video"}})]),e._v(" "),t("span",{staticClass:"duration"},[e._v(e._s(n.duration)+"s")])]}),{item:n,index:o})],2)})),0)])}),[],!1,null,"7d0703b4",null);t.default=component.exports},882:function(e,t,n){"use strict";n.r(t);var o=n(3),l=(n(20),n(19),n(16),n(306),n(307),n(24),n(65),n(4),n(21),n(350),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(820)),r=n(25),c={name:"AudioClipDialog",mixins:[l.default],data:function(){return{dialogVisible:!1,audioUrl:"",audioName:"",audioFormat:"wav",audioMimeType:"audio/wav",isPlaying:!1,originalDuration:0,videoDuration:0,clipStartTime:0,clipEndTime:0,progressPosition:0,isDragging:!1,dragType:null,dragStartX:0,dragStartClipStart:0,dragStartClipEnd:0,audioContext:null,audioBuffer:null,loading:!1,supportedFormats:{mp3:"audio/mpeg",wav:"audio/wav",flac:"audio/flac",aac:"audio/aac",m4a:"audio/mp4",ogg:"audio/ogg",webm:"audio/webm"},formatSupport:{mp3:!0,wav:!0,flac:!1,aac:!1,m4a:!0,ogg:!1,webm:!1},confirmLoading:!1}},computed:{displayDuration:function(){return"".concat(this.originalDuration.toFixed(1),"s")},clipDuration:function(){return Object(r.subtract)(this.clipEndTime,this.clipStartTime)},audioElement:function(){return this.$refs.audioElement}},mounted:function(){this.checkAudioFormatSupport()},beforeDestroy:function(){this.removeMouseListeners()},methods:{checkAudioFormatSupport:function(){var audio=document.createElement("audio");audio.canPlayType&&(this.formatSupport={mp3:""!==audio.canPlayType("audio/mpeg"),wav:""!==audio.canPlayType("audio/wav"),flac:""!==audio.canPlayType("audio/flac"),aac:""!==audio.canPlayType("audio/aac"),m4a:""!==audio.canPlayType("audio/mp4"),ogg:""!==audio.canPlayType("audio/ogg"),webm:""!==audio.canPlayType("audio/webm")})},show:function(e,t,n){this.dialogVisible=!0,this.audioUrl=e,this.videoDuration=t?Number(t):0,this.loading=!0,this.audioName=n||this.extractFilenameFromUrl(e),this.detectAudioFormat(e),this.preloadAudioData(e)},extractFilenameFromUrl:function(e){var t=e.split("/"),n=t[t.length-1];return decodeURIComponent(n)},detectAudioFormat:function(e){var t=e.split(".").pop().toLowerCase();this.supportedFormats[t]?(this.audioFormat=t,this.audioMimeType=this.supportedFormats[t]):(this.audioFormat="wav",this.audioMimeType="audio/wav")},handleAudioLoaded:function(){this.originalDuration=this.audioElement.duration,this.clipStartTime=0,this.clipEndTime=this.originalDuration,this.videoDuration&&this.originalDuration>this.videoDuration&&(this.clipEndTime=this.videoDuration)},updateProgress:function(){this.audioElement&&this.originalDuration>0&&(this.progressPosition=this.audioElement.currentTime/this.originalDuration*100,this.audioElement.currentTime>this.clipEndTime&&(this.audioElement.pause(),this.audioElement.currentTime=this.clipStartTime,this.isPlaying=!1))},handleAudioEnded:function(){this.isPlaying=!1,this.audioElement.currentTime=this.clipStartTime},togglePlay:function(){var e=this;if(this.audioElement)if(this.isPlaying)this.audioElement.pause(),this.isPlaying=!1;else if(this.audioElement.currentTime=this.clipStartTime,this.audioElement.readyState>=2)this.audioElement.play().catch((function(t){e.$message.error(e.$t("playError")||"播放失败")})),this.isPlaying=!0;else{this.audioElement.addEventListener("canplay",(function t(){e.audioElement.play().catch((function(t){e.$message.error(e.$t("playError")||"播放失败")})),e.isPlaying=!0,e.audioElement.removeEventListener("canplay",t)}))}},drawStaticWave:function(){var canvas=this.$refs.waveCanvas;if(canvas){var e=canvas.getContext("2d");e.clearRect(0,0,627,48),e.fillStyle="#FFF";for(var t=120,n=48*.8,o=[],i=0;i<t;i++)o.push(.6*Math.random()+.25);for(var l=[],r=0;r<o.length;r++){for(var c=0,d=0,v=Math.max(0,r-1);v<=Math.min(o.length-1,r+1);v++)c+=o[v],d++;var m=c/d;Math.random()<.5&&(m*=Math.random()<.5?1.5:.6,m=Math.max(.2,Math.min(1,m))),l.push(m)}for(var h=0;h<t;h++){var f=l[h]*(n-12),_=16+4.983193277310924*h;if(_+2<=611){var y=48-f-12;e.fillRect(_,y,2,f)}}}},startDrag:function(e,t){this.isDragging=!0,this.dragType=t,"region"===t&&(this.dragStartX=e.clientX,this.dragStartClipStart=this.clipStartTime,this.dragStartClipEnd=this.clipEndTime),e.preventDefault(),this.addMouseListeners()},addMouseListeners:function(){window.addEventListener("mousemove",this.handleDrag),window.addEventListener("mouseup",this.stopDrag)},removeMouseListeners:function(){window.removeEventListener("mousemove",this.handleDrag),window.removeEventListener("mouseup",this.stopDrag)},handleDrag:function(e){if(this.isDragging&&!(this.originalDuration<=0)){var rect=this.$el.querySelector(".waveform-container").getBoundingClientRect(),t=rect.width,time=Math.max(0,Math.min(t,e.clientX-rect.left))/t*this.originalDuration;if("region"===this.dragType){var n=(e.clientX-this.dragStartX)/t*this.originalDuration,o=this.dragStartClipEnd-this.dragStartClipStart,l=this.dragStartClipStart+n,r=this.dragStartClipEnd+n;l<0&&(r=(l=0)+o),r>this.originalDuration&&(r=this.originalDuration,l=Math.max(0,r-o)),l=Math.max(0,l),(r=Math.min(this.originalDuration,r))-l<1&&(r>=this.originalDuration?l=Math.max(0,this.originalDuration-1):r=Math.min(this.originalDuration,l+1)),(isNaN(l)||isNaN(r))&&(l=isNaN(l)?0:l,r=isNaN(r)?Math.min(1,this.originalDuration):r),this.clipStartTime=l,this.clipEndTime=r}else"start"===this.dragType?(this.clipStartTime=Math.max(0,Math.min(time,this.clipEndTime-1)),this.videoDuration&&this.clipEndTime-this.clipStartTime>this.videoDuration&&(this.clipStartTime=this.clipEndTime-this.videoDuration)):"end"===this.dragType&&(this.clipEndTime=Math.min(this.originalDuration,Math.max(time,this.clipStartTime+1)),this.videoDuration&&this.clipEndTime-this.clipStartTime>this.videoDuration&&(this.clipEndTime=this.clipStartTime+this.videoDuration));this.isPlaying&&this.audioElement&&(this.audioElement.currentTime<this.clipStartTime||this.audioElement.currentTime>this.clipEndTime)&&(this.audioElement.currentTime=this.clipStartTime)}},stopDrag:function(){this.isDragging&&(this.isDragging=!1,this.removeMouseListeners(),!this.isPlaying&&this.audioElement&&this.togglePlay())},handleConfirm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.videoDuration&&e.clipDuration>e.videoDuration)){t.next=3;break}return e.$message.warning(e.$t("audio_clip_prompt1",{x:e.videoDuration})),t.abrupt("return");case 3:return e.confirmLoading=!0,t.prev=4,t.next=7,e.getClippedAudio();case 7:return n=t.sent,o=e.formatSupport[e.audioFormat]?e.audioFormat:"wav",l=e.supportedFormats[o],r=e.audioName.includes(".")?e.audioName.substr(0,e.audioName.lastIndexOf("."))+"."+o:e.audioName+"."+o,c=new File([n],r,{type:l}),t.next=14,e.uploadFile(c);case 14:if(d=t.sent){t.next=18;break}return e.$message.error(e.$t("audio_clip_mode")+e.$t("uploadError")),t.abrupt("return");case 18:e.$emit("confirm",{url:d,duration:e.clipDuration,file:c,name:e.audioName,format:o}),e.dialogVisible=!1,t.next=25;break;case 22:t.prev=22,t.t0=t.catch(4),e.$message.error(e.$t("audio_clip_mode")+e.$t("uploadError"));case 25:return t.prev=25,e.confirmLoading=!1,t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[4,22,25,28]])})))()},preloadAudioData:function(e){var t=this;this.loading=!0,this.audioContext&&this.audioContext.close(),this.audioContext=new(window.AudioContext||window.webkitAudioContext),fetch(e).then((function(e){if(!e.ok)throw new Error("HTTP错误，状态: ".concat(e.status));return e.arrayBuffer()})).then((function(e){return t.audioContext.decodeAudioData(e)})).then((function(e){t.audioBuffer=e,t.loading=!1,t.$nextTick((function(){t.drawStaticWave()}))})).catch((function(e){t.$message.error("".concat(t.$t("loadError"),": ").concat(e.message||"")),t.loading=!1}))},getClippedAudio:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,l,r,c,d,v,i,m,h,source;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.audioBuffer){t.next=2;break}throw new Error("音频数据未加载");case 2:for(n=e.clipStartTime,o=e.clipEndTime,l=Math.floor((o-n)*e.audioBuffer.sampleRate),r=e.audioContext.createBuffer(e.audioBuffer.numberOfChannels,l,e.audioBuffer.sampleRate),c=0;c<e.audioBuffer.numberOfChannels;c++)for(d=e.audioBuffer.getChannelData(c),v=r.getChannelData(c),i=0;i<l;i++)(m=Math.floor(n*e.audioBuffer.sampleRate)+i)<d.length&&(v[i]=d[m]);return h=new OfflineAudioContext(r.numberOfChannels,r.length,r.sampleRate),(source=h.createBufferSource()).buffer=r,source.connect(h.destination),source.start(0),t.abrupt("return",h.startRendering().then((function(t){var n=e.audioBufferToWav(t);return new Blob([n],{type:"audio/wav"})})));case 13:case"end":return t.stop()}}),t)})))()},audioBufferToWav:function(e){var t=e.numberOfChannels,n=e.length*t*2+44,data=new Uint8Array(n);data[0]=82,data[1]=73,data[2]=70,data[3]=70,data[4]=255&n,data[5]=n>>8&255,data[6]=n>>16&255,data[7]=n>>24&255,data[8]=87,data[9]=65,data[10]=86,data[11]=69,data[12]=102,data[13]=109,data[14]=116,data[15]=32,data[16]=16,data[17]=0,data[18]=0,data[19]=0,data[20]=1,data[21]=0,data[22]=t,data[23]=0;var o=e.sampleRate;data[24]=255&o,data[25]=o>>8&255,data[26]=o>>16&255,data[27]=o>>24&255;var l=o*t*2;data[28]=255&l,data[29]=l>>8&255,data[30]=l>>16&255,data[31]=l>>24&255,data[32]=2*t,data[33]=0,data[34]=16,data[35]=0,data[36]=100,data[37]=97,data[38]=116,data[39]=97;var r=e.length*t*2;data[40]=255&r,data[41]=r>>8&255,data[42]=r>>16&255,data[43]=r>>24&255;for(var c=44,i=0;i<e.length;i++)for(var d=0;d<t;d++){var v=Math.max(-1,Math.min(1,e.getChannelData(d)[i])),m=v<0?32768*v:32767*v;data[c++]=255&m,data[c++]=m>>8&255}return data},handleDialogClosed:function(){this.audioElement&&this.audioElement.pause(),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.audioUrl="",this.audioName="",this.audioFormat="wav",this.audioMimeType="audio/wav",this.isPlaying=!1,this.originalDuration=0,this.clipStartTime=0,this.clipEndTime=0,this.progressPosition=0,this.audioBuffer=null,this.loading=!1,this.confirmLoading=!1,this.dialogVisible=!1,this.$emit("close")}}},d=(n(4421),n(4422),n(0)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.dialogVisible,"custom-class":"audio-clip-dialog",modal:!0,"append-to-body":"",title:e.$t("audio_clip_mode"),width:"730px"},on:{close:e.handleDialogClosed}},[t("div",{staticClass:"dialog-content"},[e.videoDuration?t("div",{staticClass:"info-tip"},[t("i",{staticClass:"el-icon-info"}),e._v(" "),t("span",[e._v(e._s(e.$t("audio_clip_prompt1",{x:e.videoDuration})))])]):e._e(),e._v(" "),e.audioName?t("div",{staticClass:"audio-info"},[t("span",{staticClass:"audio-name"},[t("i",{staticClass:"iconfont icon-icon-Music-Line"}),e._v("\n        "+e._s(e.audioName)+"\n      ")]),e._v(" "),t("span",{staticClass:"audio-duration"},[e._v(e._s(e.displayDuration))])]):e._e(),e._v(" "),t("div",{staticClass:"audio-player"},[t("div",{staticClass:"play-button",on:{click:e.togglePlay}},[t("i",{staticClass:"iconfont",class:e.isPlaying?"icon-icon-pulse":"icon-yuyinbofang"})]),e._v(" "),t("div",{staticClass:"waveform-wrapper"},[t("div",{staticClass:"waveform-container"},[e.loading?t("div",{staticClass:"loading-container"},[t("i",{staticClass:"el-icon-loading"}),e._v(" "),t("span",[e._v(e._s(e.$t("loading_tip")))])]):e._e(),e._v(" "),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],ref:"waveCanvas",attrs:{width:"624",height:"48"}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isPlaying,expression:"isPlaying"}],staticClass:"progress-indicator",style:{left:e.progressPosition+"%"}}),e._v(" "),t("div",{staticClass:"clip-mask left-mask",style:{width:e.clipStartTime/e.originalDuration*100+"%"}}),e._v(" "),t("div",{staticClass:"clip-mask right-mask",style:{left:e.clipEndTime/e.originalDuration*100+"%",width:100*(1-e.clipEndTime/e.originalDuration)+"%"}}),e._v(" "),t("div",{staticClass:"clip-region",style:{left:e.clipStartTime/e.originalDuration*100+"%",width:(e.clipEndTime-e.clipStartTime)/e.originalDuration*100+"%"}},[t("div",{staticClass:"region-handle left-handle",on:{mousedown:function(t){return e.startDrag(t,"start")}}}),e._v(" "),t("div",{staticClass:"region-body",on:{mousedown:function(t){return e.startDrag(t,"region")}}}),e._v(" "),t("div",{staticClass:"region-handle right-handle",on:{mousedown:function(t){return e.startDrag(t,"end")}}})])])])]),e._v(" "),t("audio",{ref:"audioElement",attrs:{src:e.audioUrl,preload:"metadata"},on:{loadedmetadata:e.handleAudioLoaded,timeupdate:e.updateProgress,ended:e.handleAudioEnded}}),e._v(" "),t("div",{staticClass:"action-buttons"},[t("el-button",{staticClass:"confirm-btn",attrs:{loading:e.confirmLoading},on:{click:e.handleConfirm}},[e._v("\n        "+e._s(e.$t("confirm_clip"))+"\n      ")])],1)])])}),[],!1,null,"0c728602",null);t.default=component.exports},883:function(e,t,n){"use strict";n.r(t);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),l=(n(16),n(4),n(85)),r=n(1);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={name:"VipPrivateCreate",components:{VideoExplainPopover:n(385).a},props:{},data:function(){return{createSetting:1}},computed:d(d({},Object(r.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),Object(r.c)("payment",["paymentInfo"])),watch:{"userInfo.settings.is_auto_pub_community":{handler:function(e){this.createSetting=e?1:2},immediate:!0},isLoggedIn:{handler:function(e){!e&&(this.createSetting=1)},immediate:!0,deep:!0}},methods:d(d({},Object(r.b)("user",["getAccountInfo"])),{},{handleCreateSettingSelectChange:function(e){return this.isLoggedIn?[2,"2"].includes(e)&&!this.paymentInfo.show_auto_pub_switch?(this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic"),void(this.createSetting=1)):void(this.isLoggedIn&&this.saveSettings(e)):(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),void(this.createSetting=1))},saveSettings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n={};n.auto_pub_community=t,n.mode=1,Object(l.c)(n).then((function(n){var o=(n||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(e.$message.success(e.$t("SaveSuccess")),e.createSetting=t,e.getAccountInfo())})).finally((function(){}))}})},m=v,h=(n(4425),n(0)),component=Object(h.a)(m,(function(){var e=this,t=e._self._c;return e.isCompanyAccount?e._e():t("div",{staticClass:"vip-private-create"},[t("div",{staticClass:"label-box"},[t("span",{staticClass:"label-text"},[e._v(e._s(e.$t("newGenerate12")))]),e._v(" "),t("img",{staticClass:"vip-icon",attrs:{src:n(136),alt:"vip-icon"}}),e._v(" "),t("VideoExplainPopover",{key:"private",staticClass:"custom-tips",attrs:{type:"private",placement:"top-start"}},[t("span",{attrs:{slot:"reference"},slot:"reference"},[t("i",{staticClass:"el-icon-warning"})])])],1),e._v(" "),t("el-switch",{attrs:{"active-color":"#3F8CFF","active-value":2,"inactive-value":1},on:{change:e.handleCreateSettingSelectChange},model:{value:e.createSetting,callback:function(t){e.createSetting=t},expression:"createSetting"}})],1)}),[],!1,null,"bcc2d558",null);t.default=component.exports},884:function(e,t,n){"use strict";n.r(t);n(24);var o={name:"CommonInput",props:{value:{type:String,default:""},title:{type:String,default:""},placeholder:{type:String,default:""},clearable:{type:Boolean,default:!1},maxLength:{type:Number,default:50},tooltipContent:{type:String,default:""},autosize:{type:[Boolean,Object],default:function(){return{minRows:4,maxRows:4}}},showBottomBorder:{type:Boolean,default:!1}},methods:{handleClear:function(){this.$emit("clear")},handleInputChange:function(e){this.$emit("update:value",e),this.$emit("change",e)}}},l=(n(4427),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"common-input"},[t("div",{staticClass:"common-input-title"},[t("span",{staticClass:"common-input-title-text ellipsis"},[e._v(e._s(e.$t(e.title))+"\n\n      "),e.tooltipContent?t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t(e.tooltipContent),placement:"top-start"}},[t("i",{staticClass:"custom-tips el-icon-warning"})]):e._e()],1),e._v(" "),e._t("rightTitle")],2),e._v(" "),t("div",{staticClass:"common-input-divider"}),e._v(" "),t("div",{staticClass:"common-input-content"},[t("el-input",{attrs:{value:e.value,type:"textarea",placeholder:e.$t(e.placeholder),resize:"none",autosize:e.autosize,maxlength:e.maxLength},on:{input:e.handleInputChange}}),e._v(" "),t("div",{staticClass:"common-input-handle"},[t("div",{staticClass:"common-input-handle-text"},[e._t("handleBtn")],2),e._v(" "),e.clearable&&e.value.length?t("i",{staticClass:"iconfont icon-delete-gpt",on:{click:e.handleClear}}):e._e()])],1),e._v(" "),e.showBottomBorder?t("div",{staticClass:"common-input-divider bottom-divider"}):e._e(),e._v(" "),e._t("bottom")],2)}),[],!1,null,"3de711d5",null);t.default=component.exports},885:function(e,t,n){"use strict";n.r(t);var o={name:"SwitchToInput",props:{label:{type:String,default:""},tips:{type:String,default:""},switchKey:{type:String,default:"enableNegativePrompts"},inputKey:{type:String,default:"negative_prompt"},needInput:{type:Boolean,default:!0},value:{type:Object,default:function(){return{}}}},methods:{switchChange:function(e){this.$emit("switchChange",e)}}},l=(n(4432),n(0)),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"switch-to-input"},[t("div",{staticClass:"advance-setting-panel-item advance-setting-panel-item-flex"},[t("div",{staticClass:"panel-item-label"},[t("span",{staticClass:"generate-mode-panel-label-text"},[e._v(e._s(e.$t(e.label)))]),e._v(" "),e.tips?t("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:e.$t(e.tips),placement:"top-start"}},[t("i",{staticClass:"custom-tips el-icon-warning"})]):e._e()],1),e._v(" "),t("el-switch",{attrs:{"active-color":"#3F8CFF"},on:{change:e.switchChange},model:{value:e.value[e.switchKey],callback:function(t){e.$set(e.value,e.switchKey,t)},expression:"value[switchKey]"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.value[e.switchKey]&&e.needInput,expression:"value[switchKey] && needInput"}],staticClass:"advance-setting-panel-item"},[t("div",{staticClass:"negative-prompt-input"},[t("el-input",{staticClass:"top-input-area-input",attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},resize:"none",maxlength:2048,placeholder:e.$t("pleaseEnte")},model:{value:e.value[e.inputKey],callback:function(t){e.$set(e.value,e.inputKey,t)},expression:"value[inputKey]"}})],1)])])}),[],!1,null,"90844e9c",null);t.default=component.exports},97:function(e,t,n){"use strict";n.r(t);n(4);var o={name:"commonConfirmModal",data:function(){return{visible:!1,options:null,resolve:null,reject:null,fromPage:"",notNotice:!1,btnStyle:""}},methods:{show:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.resetData(),this.options=t,this.visible=!0,this.btnStyle=(null==t?void 0:t.btnStyle)||"",this.fromPage=(null==t?void 0:t.fromPage)||"",new Promise((function(t,n){e.resolve=t,e.reject=n}))},resetData:function(){this.options=null,this.resolve=null,this.reject=null,this.fromPage="",this.notNotice=!1},handleClose:function(){if(this.visible=!1,this.handleNotNoticeStatus(),this.reject)return this.reject(!1)},handleNotNoticeStatus:function(){"modelPreset"===this.fromPage&&this.notNotice&&(this.$store.dispatch("user/recordEnableUsePresetNotNotice"),localStorage.setItem("presetModelNotTips",this.notNotice?1:2))},handleConfirm:function(){if(this.visible=!1,this.handleNotNoticeStatus(),this.resolve)return this.resolve(!0)}}},l=o,r=(n(4157),n(0)),component=Object(r.a)(l,(function(){var e,t,n=this,o=n._self._c;return o("el-dialog",{staticClass:"easy-common-confirm-modal-dialog",attrs:{visible:n.visible,"custom-class":"easy-common-confirm-modal custom-dialog","destroy-on-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,modal:!0,"append-to-body":"",width:"407px"},on:{"update:visible":function(e){n.visible=e}}},[o("div",{staticClass:"easy-select-model-confirm-modal-header"},[o("div",{staticClass:"modal-header-title"},[n._v(n._s(n.$t("Tip")))]),n._v(" "),o("span",{staticClass:"modal-header-close",on:{click:function(e){return e.stopPropagation(),n.handleClose()}}},[o("i",{staticClass:"el-icon-close"})])]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-content"},[o("div",{staticClass:"modal-content-left"},[o("div",{staticClass:"warning-icon-box"},[o("i",{staticClass:"iconfont icon-warn"})])]),n._v(" "),o("div",{staticClass:"modal-content-right"},[o("div",{staticClass:"modal-content-right-title"},[n._v(n._s(n.$t("newGenerate38")))]),n._v(" "),n.options&&null!==(e=n.options)&&void 0!==e&&e.subTitle?o("div",{staticClass:"modal-content-right-sub-title"},[n._v(n._s(n.$t(null===(t=n.options)||void 0===t?void 0:t.subTitle)))]):n._e(),n._v(" "),"modelPreset"===n.fromPage?[o("div",{staticClass:"modal-content-no-notice-check"},[o("el-checkbox",{staticClass:"presets-model-option-checkbox",model:{value:n.notNotice,callback:function(e){n.notNotice=e},expression:"notNotice"}},[n._v("\n            "+n._s(n.$t("teach_video_tips"))+"\n          ")])],1)]:n._e()],2)]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-footer"},[o("span",{staticClass:"modal-footer-btn",on:{click:function(e){return e.stopPropagation(),n.handleClose()}}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",style:n.btnStyle,on:{click:function(e){return e.stopPropagation(),n.handleConfirm()}}},[n._v(n._s(n.$t("Confirm")))])])])}),[],!1,null,null,null);t.default=component.exports}}]);