(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{126:function(t,e,n){"use strict";n(16),n(18);var o=n(3),r=n(2),l=(n(20),n(19),n(6),n(32),n(50),n(31),n(24),n(8),n(11),n(12),n(13),n(4),n(43),n(21),n(40),n(92),n(7),n(41),n(26),n(1195)),c=n(87),d=n(1),h=n(3134),v=n(10),f=n(300),m=n(1196);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w=n(505),C=n(4512),k={name:"PaymentForm",inject:{top:{default:function(){return{dotFrom:""}}}},props:{initMount:{type:Boolean,default:!0},defaultThirdType:{type:Number,default:9},disabledMethods:{type:Array,default:function(){return[]}},goodsId:{type:[Number,String],default:""},isFreeTry:{type:Boolean,default:!1},showFreeTry:{type:Boolean,default:!0},purchParams:{type:Object,default:function(){return{}}},upgrade:{type:[Number,Boolean],default:0},isSubscription:{type:Boolean,default:!0},btnLabel:{type:String,default:""},backToCheck:{type:Boolean,default:!1},from:{type:String,default:""},showBack:{type:Boolean,default:!0},thirdParty:{type:Boolean,default:!1},apiParams:{type:Object,default:function(){return{}}}},components:{PaymentCheck:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,3438))},PaymentIntermediateDisplay:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16),n.e(184)]).then(n.bind(null,5739))},PaymentRightInfo:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5782))}},watch:{inPaymentForm:function(t){t&&(this.$emit(t),"in-waiting"===t&&(this.clearAwaitingOrder(),this.updatePopupStatusInfo(),this.canShowAwaitingOrderDialog=!1))},inCreating:function(t){this.$emit("in-loading",t)}},computed:y(y(y(y({},Object(d.e)("payment",["paymentInfo","adyenFailed","adyenPaymenMethods","cardType","paymentGrayInfo"])),Object(d.e)("user",["userInfo"])),Object(d.e)("creation",["generateViewShow"])),{},{pageLocation:function(){var t,path=(null===(t=this.$route)||void 0===t?void 0:t.path)||"/";return(path=path.trim()||"/")+(this.generateViewShow?"_task_flow":"")},$isChinaSite:function(){return!1},allMethods:function(){var t,e=this,n=[{name:"onerway",i18n:"Credit Card",newWindow:!1,icon:"adyen-icon.png",type:12},{name:"Credit Card",i18n:"Credit Card",newWindow:!1,icon:"adyen-icon.png",type:9},{name:"AliPay",i18n:"alipay",newWindow:!1,icon:"alipay-icon.png",type:9},{name:"Google Pay",i18n:"Google Pay",newWindow:!1,icon:"googlepay-icon.png",type:9},{name:"PIX",i18n:"PIX",newWindow:!0,icon:"pix-icon.png",type:1},{name:"Paypal",i18n:"Paypal",newWindow:!0,icon:"paypal-icon.png",type:10}];(this.isShowPayermax||(n=n.filter((function(t){return 1!==t.type}))),this.useTry&&(n=n.filter((function(t){return![1,10].includes(t.type)}))),this.isShowAlipay||(n=n.filter((function(t){return"AliPay"!==t.name}))),this.thirdParty&&(n=n.filter((function(t){return 9===t.type}))),this.upgrade&&this.defaultThirdType)&&(0===(null===(t=n=n.filter((function(t){return t.type===e.defaultThirdType})))||void 0===t?void 0:t.length)&&this.$message.warning(this.$t("noPaymentMethod")),8===this.defaultThirdType&&this.$message.warning(this.$t("bandStripe")));return n="onerway"!==this.cardType||this.thirdParty?n.filter((function(t){return 12!==t.type})):n.filter((function(t){return"Credit Card"!==t.name})),this.disabledMethods.length&&(n=n.filter((function(t){return!e.disabledMethods.includes(t.type)}))),n},creditCard:function(){return this.allMethods.find((function(t){return"Credit Card"===t.name}))},trueUpgrade:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)&&this.upgrade},btnTxt:function(){return this.isSubscription?"SubscribeNow":"businesSwiperBtn1"},isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")},isShowBillingAddress:function(){var t,e,n=(null===(t=this.$route.query)||void 0===t?void 0:t.country_code)||(null===(e=this.userInfo)||void 0===e?void 0:e.current_country_code);return["US","UK","GB","CA"].includes(n)},isShowAlipay:function(){var t;return"CN"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isShowPayermax:function(){var t;return"BR"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isBindAdyen:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.bind_adyen},isYearly:function(){return!!this.goodsId&&("number"==typeof this.goodsId?this.goodsId.toString():this.goodsId).includes("sub_yearly")},shouldShowNewRightInfo:function(){var t;return!!this.$slots.default&&!0===(null===(t=this.paymentGrayInfo)||void 0===t?void 0:t.checkout_popup)},showRightContent:function(){return!!this.$slots.default},isOneTimePurchase:function(){return!this.isSubscription&&!this.trueUpgrade||!(!this.activeMethod||[6,8,9,12].includes(this.activeMethod.type))},enhancedStateData:function(){var t,e,n=Object(l.a)({goodsId:this.goodsId,isSubscription:this.isSubscription,useTry:this.useTry,upgrade:this.upgrade,isOneTimePurchase:this.isOneTimePurchase});return{goodsId:this.goodsId,benefit_type:n,order_id:this.thirdOrderId||"pending",thirdOrderId:this.thirdOrderId||"pending",isSubscription:this.isSubscription,useTry:this.useTry,upgrade:this.upgrade,isOneTimePurchase:this.isOneTimePurchase,paymentMethod:(null===(t=this.activeMethod)||void 0===t?void 0:t.name)||"unknown",paymentMethodType:(null===(e=this.activeMethod)||void 0===e?void 0:e.type)||"unknown",card_type:this.isOneClickPaymentMode?1:2}}}),data:function(){return{AdyenCheckout:null,activeMethod:null,selectAdyenMethod:{brands:["visa","mc","cup","jcb"],name:"Credit Card",type:"scheme"},thirdOrderId:"",adyenComponent:null,adyenTempAction:null,adyenTempPayment:null,inPaymentForm:"in-form",paymentState:"idle",paymentStateData:{},stateMachine:null,unsubscribeStateChange:null,qrCode:null,wechatBtnLoading:!1,wechatBtnDisabled:!1,useTry:!1,backToClose:!1,inCreating:!1,onerwayTransactionId:"",loadOnerway:!1,onerwayOrderCache:{withTrial:null,withoutTrial:null,normal:null},lottieOptions:{animationData:f,loop:!0,autoplay:!0},canShowAwaitingOrderDialog:!0,savedPaymentData:{holderName:"",billingAddress:{}},paymentTimeoutTimer:null,paymentStartTime:null,isOneClickPaymentMode:!1}},mounted:function(){var t=this;if(this.initStateMachine(),this.loadAdyenCheckout(),Object(v.I)("https://cdn.jsdelivr.net/npm/@adyen/adyen-web@latest/dist/adyen.css"),this.autoPay(),this.useTry=this.isFreeTry&&"mall"!==this.from,this.adyenPaymenMethods||this.getAdyenPaymentMethod(),this.initMount){var e=this.allMethods.find((function(e){return e.type===t.defaultThirdType}));e||(e=this.creditCard),"onerway"!==this.cardType||this.thirdParty||(e=this.allMethods.find((function(t){return 12===t.type}))),e&&this.selectMethod(e)}if(["sub_yearly","sub_monthly","sub_weekly"].some((function(e){return t.goodsId.includes(e)}))){var n={payGoodsId:this.goodsId,payLastTime:(new Date).toISOString().slice(0,10)};localStorage.setItem("payGoodsInfo",JSON.stringify(n))}this.$nextTick((function(){t.logPaymentFormExposure()}))},beforeDestroy:function(){this.unsubscribeStateChange&&(this.unsubscribeStateChange(),this.unsubscribeStateChange=null),this.stateMachine&&(this.stateMachine.destroy(),this.stateMachine=null),this.clearPaymentTimeout(),this.destroyAdyenComponent(),this.thirdOrderId="",this.onerwayTransactionId="",this.adyenTempAction=null,this.adyenTempPayment=null,this.paymentState="idle",this.paymentStateData={},this.inPaymentForm="in-form",this.clearSavedPaymentData(),this.canShowAwaitingOrderDialog=!0},methods:y(y(y(y({},Object(d.b)("payment",["getPaymentInfo","setAdyenFailed","setSubThirdType","getAdyenPaymentMethod","clearAwaitingOrder","updatePopupStatusInfo"])),Object(d.b)("user",["getAccountInfo"])),Object(d.d)("payment",["SET_AWAITING_ORDER_HAS_LOCAL_INFO"])),{},{getEnhancedStateDataWithTimestamp:function(){return y(y({},this.enhancedStateData),{},{timestamp:Date.now()})},initStateMachine:function(){var t=this,e=this.activeMethod?{type:this.activeMethod.type,name:this.activeMethod.name}:null;this.stateMachine=new h.a(e),this.startPaymentTimeout(),this.unsubscribeStateChange=this.stateMachine.onStateChange((function(e,n,data){t.handleStateChange(e,n,data)})),console.log("[PaymentForm] 状态机初始化完成",{initialPaymentMethod:e})},handleStateChange:function(t,e,data){console.log("[PaymentForm] 状态变化: ".concat(e," -> ").concat(t),data),this.stateMachine.needsIntermediatePage(t)?(this.paymentState=t,this.paymentStateData=y(y(y({},this.paymentStateData),data),this.getEnhancedStateDataWithTimestamp()),this.inPaymentForm="in-processing",console.log("[PaymentForm] 显示中间状态页面: ".concat(t))):this.stateMachine.isFormState(t)?(this.inPaymentForm="in-form",console.log("[PaymentForm] 显示支付表单: ".concat(t))):console.warn("[PaymentForm] 默认不处理的状态: ".concat(t))},startPaymentTimeout:function(){var t=this;this.clearPaymentTimeout(),this.paymentStartTime=Date.now();var e=this.stateMachine.constructor.TIMEOUT_CONFIG.PAYMENT_TIMEOUT;console.log("[PaymentForm] 30分钟支付超时计时开始",e),this.paymentTimeoutTimer=setTimeout((function(){console.warn("[PaymentForm] 30分钟支付超时触发"),"in-waiting"===t.inPaymentForm||t.stateMachine.isFinalState()||t.stateMachine.transition("payment_timeout",{reason:"global_payment_timeout",originalState:t.paymentState,timestamp:Date.now(),paymentStartTime:t.paymentStartTime,waitTime:"30 minutes",paymentMethod:t.activeMethod})}),e),console.log("[PaymentForm] 30分钟支付超时计时已开始")},stopPaymentTimeout:function(){this.clearPaymentTimeout(),this.paymentStartTime=null,console.log("[PaymentForm] 30分钟支付超时计时已停止")},loadAdyenCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.e(27).then(n.t.bind(null,6365,7));case 3:o=e.sent,t.AdyenCheckout=o.default,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load Adyen Checkout:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},initPayments:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.adyenPaymenMethods){e.next=3;break}return e.next=3,t.getAdyenPaymentMethod();case 3:case"end":return e.stop()}}),e)})))()},handleBack:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&"in-waiting"!==this.inPaymentForm&&this.canShowAwaitingOrderDialog;"in-waiting"===this.inPaymentForm&&(this.$refs.paymentCheck.getPaymentOnce(),this.$refs.paymentCheck.stopPoll()),this.backToCheck?this.$emit("in-pay-back",t):"in-waiting"!==this.inPaymentForm||this.backToClose?(this.qrCode=null,this.$emit("in-pay-back",t),this.$refs.paymentCheck.stopPoll()):this.inPaymentForm="in-form"},startCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initPayments();case 2:return(o=null===(n=t.adyenPaymenMethods)||void 0===n?void 0:n.paymentMethods)&&(t.selectAdyenMethod=o.find((function(e){return e.name===t.activeMethod.name}))),e.next=6,t.loadAdyenCheckout();case 6:if(t.AdyenCheckout&&t.selectAdyenMethod){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.createAndMountAdyenComponent();case 10:case"end":return e.stop()}}),e)})))()},createAdyenCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="production".includes("production")?"live_Q2TOAFSMXNDDZIHVMRZZ3DRK2MGQQ6OX":"test_W6R5OPPNSJG2HNO2ZJ5DNOUORIJJY53E",l=(null===(n=t.paymentInfo)||void 0===n?void 0:n.adyen_client_key)||r,c={locale:Object(m.a)(t.$i18n.locale),clientKey:l,environment:"production".includes("production")?"production":"test",showPayButton:!0,paymentMethodsResponse:t.adyenPaymenMethods,onPaymentCompleted:function(t,component){console.log("onPaymentCompleted result: "+t)},onSubmit:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n,component){var o,r,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onSubmit:",n,component),t.savePaymentFormData(null==n?void 0:n.data),t.adyenTempPayment=null==n||null===(o=n.data)||void 0===o?void 0:o.paymentMethod,p={adyen_payment_method:t.adyenTempPayment,browser_info:null==n||null===(r=n.data)||void 0===r?void 0:r.browserInfo,origin:null==n||null===(l=n.data)||void 0===l?void 0:l.origin},e.next=6,t.purchaseGoodsFun(9,y({},p));case 6:console.log("onSubmit: 创建完订单 adyenTempAction","p",p,t.adyenTempAction,"thirdOrderId",t.thirdOrderId),t.adyenTempAction&&component.handleAction(t.adyenTempAction);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onAdditionalDetails:function(e,component){var n;console.log("onAdditionalDetails:",e,component);var o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.details)||void 0===n?void 0:n.threeDSResult)||"";o&&t.checkThreeDResult(o)},onError:function(e,component){console.error("onError:",e.name,e.message,e.stack,component),t.reRenderAdyen()}},e.abrupt("return",new t.AdyenCheckout(c));case 4:case"end":return e.stop()}}),e)})))()},reRenderAdyen:function(){var t=this;this.isOneClickPaymentMode=!1,this.destroyAdyenComponent(),this.$nextTick((function(){t.recreateAdyenComponent()}))},destroyAdyenComponent:function(){this.adyenComponent&&(this.adyenComponent.unmount(),this.adyenComponent=null)},createAndMountAdyenComponent:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.AdyenCheckout&&t.selectAdyenMethod){e.next=4;break}return console.warn("[PaymentForm] Adyen Checkout 或选择的方法不可用"),e.abrupt("return");case 4:return e.next=6,t.createAdyenCheckout();case 6:n=e.sent,o=t.getPrefillData(),r=y({hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress,billingAddressMode:"partial",buttonType:"pay",buttonLocale:Object(m.a)(t.$i18n.locale)},Object.keys(o).length>0&&{data:o}),t.adyenComponent=n.create(t.selectAdyenMethod.type,r),t.adyenComponent.mount(t.$refs["adyen".concat(t.selectAdyenMethod.type)]),console.log("[PaymentForm] Adyen组件创建完成",r),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("[PaymentForm] 创建Adyen组件失败:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()},recreateAdyenComponent:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createAndMountAdyenComponent();case 2:case"end":return e.stop()}}),e)})))()},purchaseGoodsFun:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,d,h,v,f,m,_,w,C,k,O,x,T,S,D,P,I,$;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=t.length>0&&void 0!==t[0]?t[0]:9,d=t.length>1&&void 0!==t[1]?t[1]:{},!e.inCreating){n.next=4;break}return n.abrupt("return");case 4:if(e.$refs.paymentCheck.stopPoll(),l!==(null===(o=e.activeMethod)||void 0===o?void 0:o.type)&&e.selectMethod(e.allMethods.find((function(t){return t.type===l}))),e.showProcessingState(),!e.upgrade){n.next=12;break}if(!e.trueUpgrade){n.next=12;break}return n.next=11,e.setUpgrade(l,d);case 11:return n.abrupt("return");case 12:if([6,8,9,12].includes(l)&&e.isSubscription){if(v=c.p,h=y(y({cp_product_id:e.goodsId,with_trial:e.useTry,change_type:1,third_plat_type:l,page_location:e.pageLocation,sub_source:e.isOneClickPaymentMode?"one_click":"manual"},e.purchParams),d),8===(null===(f=e.activeMethod)||void 0===f?void 0:f.type)){h.client_reference_id="";try{(_=Rewardful&&(null===(m=Rewardful)||void 0===m?void 0:m.referral)||"")&&(h.client_reference_id=_)}catch(t){console.log("Rewardful, error",t)}}}else v=c.o,h=y(y({cp_product_id:e.goodsId,os:"1",quantity:1,third_plat_type:l,page_location:e.pageLocation,sub_source:e.isOneClickPaymentMode?"one_click":"manual"},e.purchParams),d);return e.thirdParty&&e.goodsId&&(v=c.b,h=y({transaction_id:e.goodsId,third_plat_type:l},d)),(null==e||null===(r=e.top)||void 0===r?void 0:r.dotFrom)&&(h.from=e.top.dotFrom),5===l&&(e.wechatBtnLoading=!0),e.inCreating=!0,n.prev=17,n.next=20,v(h);case 20:if(C=n.sent,e.stateMachine&&e.stateMachine.handleApiResponse(C),k=C.data,O=k.PaymentUrl,x=k.ThirdOrderId,T=k.AdyenAction,x&&(e.thirdOrderId=x,console.log("[PaymentForm] 订单ID已设置: ".concat(x))),12!==l){n.next=34;break}if(S=e.isSubscription?e.useTry?"withTrial":"withoutTrial":"normal",!O){n.next=32;break}return e.onerwayOrderCache[S]={transactionId:O,orderId:x,timestamp:Date.now()},e.onerwayTransactionId=O,n.next=32,e.renderOnerwayForm(O);case 32:n.next=35;break;case 34:9===(null===(w=e.activeMethod)||void 0===w?void 0:w.type)&&T?(e.handleAction(T),e.hideProcessingState()):O&&5!==l?(D=window.screen.height/2-300,P=window.screen.width/2-400,e.showWaitPayment(),window.open(O,"newWindow","height=600,width=800,top=".concat(D,",left=").concat(P))):5===l&&(e.wechatBtnLoading=!1,e.wechatBtnDisabled=!0,setTimeout((function(){e.wechatBtnDisabled=!1}),3e5),e.appendQrCode(O));case 35:n.next=43;break;case 37:n.prev=37,n.t0=n.catch(17),console.error("purchaseGoodsFun:",n.t0),e.canShowAwaitingOrderDialog=!1,e.stateMachine.handleApiResponse(n.t0),9===(null===(I=e.activeMethod)||void 0===I?void 0:I.type)?e.setAdyenFailed():12===l&&($=e.isSubscription?e.useTry?"withTrial":"withoutTrial":"normal",e.onerwayOrderCache[$]=null,e.$message.error(e.$t("CreateOrderFailed")));case 43:return n.prev=43,e.inCreating=!1,n.finish(43);case 46:case"end":return n.stop()}}),n,null,[[17,37,43,46]])})))()},checkThreeDResult:function(t){var e=this,n={three_ds_result:t,adyen_payment_method:this.adyenTempPayment};this.stateMachine&&this.stateMachine.transition("threeds_verifying",{threeDResult:t,timestamp:Date.now(),paymentMethod:this.activeMethod,order_id:this.thirdOrderId||"unknown",thirdOrderId:this.thirdOrderId||"unknown",notificationMessage:this.$t("threeds_verifying_notification")}),Object(c.a)(n).then((function(t){var n;if(e.stateMachine&&e.stateMachine.handleApiResponse(t),1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data.order_id;e.thirdOrderId=o,e.$emit("check-payment-status",{type:9,order_id:o}),e.showWaitPayment()}})).catch((function(t){console.log("checkThreeDs error",t),e.stateMachine&&e.stateMachine.handleApiResponse(t),e.reRenderAdyen()}))},setUpgrade:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(console.log("setUpgrade",t,e),8!=t){o.next=4;break}return n.$message.warning(n.$t("bandStripe")),o.abrupt("return");case 4:return l=y({change_type:1,cp_product_id:null==n?void 0:n.goodsId,third_plat_type:t,page_location:n.pageLocation,sub_source:n.isOneClickPaymentMode?"one_click":"manual"},e),(null==n||null===(r=n.top)||void 0===r?void 0:r.dotFrom)&&(l.from=n.top.dotFrom),n.inCreating=!0,o.next=9,Object(c.q)(l).then((function(e){var o=e.data,r=o.PaymentUrl,l=o.ThirdOrderId,c=o.AdyenAction;l&&(n.thirdOrderId=l),9===t&&c?(n.handleAction(c),n.hideProcessingState()):12!==t&&r?window.open(r):(n.$message.success(n.$t("OperateSuccess")),n.$refs.paymentCheck.paySuccess())})).catch((function(t){console.error("setUpgrade error",t),n.stateMachine.handleApiResponse(t),n.$message.error(n.$t("paymentFailed"))})).finally((function(){n.inCreating=!1}));case 9:case"end":return o.stop()}}),o)})))()},paymentSuccess:function(){this.stopPaymentTimeout(),this.saveSubType(this.activeMethod.type),this.$emit("pay-success"),this.clearAwaitingOrder(),this.updatePopupStatusInfo(),this.inPaymentForm="in-form",this.isYahoo},paymentError:function(t){var e=t.type;this.stopPaymentTimeout(),this.inPaymentForm="in-form",9===e&&this.reRenderAdyen()},saveSubType:function(t){var e,n;1!==(null===(e=this.paymentInfo)||void 0===e?void 0:e.purchaseType)&&this.isSubscription&&this.setSubThirdType(t),"Credit Card"===(null===(n=this.activeMethod)||void 0===n?void 0:n.name)&&this.getAccountInfo()},showWaitPayment:function(){this.stopPaymentTimeout(),this.inPaymentForm="in-waiting"},appendQrCode:function(t){var e=this;this.$refs.QRCodeContainer[0].innerHTML="",this.$nextTick((function(){var n=e.$refs.QRCodeContainer[0];e.qrCode=new w(n,{text:t,width:85,height:85}),e.$refs.paymentCheck.pollGetPaymentStatus(5)}))},handleAction:function(t){var e=JSON.parse(t),n=e.action,o=e.merchantReference;n?this.adyenTempAction=n:o?(this.thirdOrderId=o,this.$emit("check-payment-status",{type:9,order_id:o}),this.showWaitPayment()):console.log("create error, no action or merchantReference")},autoPay:function(){var t,e=this;2===(null===(t=this.userInfo)||void 0===t?void 0:t.trial_order_pay_popup)&&this.isYearly||!this.isBindAdyen||this.adyenFailed||this.upgrade&&9!==this.defaultThirdType&&"Credit Card"!==this.defaultThirdType||(this.inPaymentForm="in-reuse",this.$confirm(this.$t("adyenConfirmTitle"),this.$t("Tip"),{distinguishCancelAndClose:!0,confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("switch"),customClass:"ai-face-swap-confirm"}).then((function(){e.isOneClickPaymentMode=!0,e.purchaseGoodsFun(9),e.backToClose=!0,e.$logEvent("log_actions",{operation:"click_confirm",behavior_info:"on_repay_popup"}),e.$xyLogEvent({front_operation:"click",entity_name:"click_confirm",entity_type:"on_repay_popup"})})).catch((function(t){"cancel"===t?(e.isOneClickPaymentMode=!1,e.inPaymentForm="in-form",e.$logEvent("log_actions",{operation:"click_switch",behavior_info:"on_repay_popup"}),e.$xyLogEvent({front_operation:"click",entity_name:"click_switch",entity_type:"on_repay_popup"})):e.$emit("in-pay-back")})).finally((function(){e.$logEvent("log_order",{source:"credit_repurchase_popup"}),e.$xyLogEvent({front_operation:"click",entity_name:"log_order",entity_type:"on_repay_popup",obj_info:{source:"credit_repurchase_popup"}})})))},initOnerwayPayment:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.length>0&&void 0!==t[0]&&t[0],12===(null===(o=e.activeMethod)||void 0===o?void 0:o.type)){n.next=3;break}return n.abrupt("return");case 3:if(l=e.isSubscription?e.useTry?"withTrial":"withoutTrial":"normal",r||!e.onerwayOrderCache[l]){n.next=11;break}return c=e.onerwayOrderCache[l],n.next=8,e.renderOnerwayForm(c.transactionId);case 8:return e.thirdOrderId=c.orderId,e.onerwayTransactionId=c.transactionId,n.abrupt("return");case 11:return n.next=13,e.purchaseGoodsFun(12);case 13:case"end":return n.stop()}}),n)})))()},renderOnerwayForm:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:o={zhCN:"zh-cn",zhTW:"zh-tw"}[e.$i18n.locale]||e.$i18n.locale,r={container:"pacypay_checkout",locale:o,environment:"production".includes("production")?"production":"sandbox",mode:"CARD",config:{subProductType:"DIRECT"},onPaymentCompleted:function(t){var n=t.data;if("20000"===t.respCode)switch(n.status){case"S":e.showWaitPayment();break;case"R":window.location.href=n.redirectUrl;break;default:e.$message.error(e.$t("paymentFailed")),e.handlePaymentFailure()}else e.$message.error(e.$t("paymentFailed")),e.handlePaymentFailure()},onError:function(t){console.log("error",t),e.$message.error(e.$t("paymentFailed")),e.handlePaymentFailure()}},new C(t,r);case 6:case"end":return n.stop()}}),n)})))()},handlePaymentFailure:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isSubscription?t.useTry?"withTrial":"withoutTrial":"normal",t.onerwayOrderCache[n]=null,e.next=4,t.initOnerwayPayment(!0);case 4:case"end":return e.stop()}}),e)})))()},switchTry:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t||![1,10].includes(null===(o=e.activeMethod)||void 0===o?void 0:o.type)){n.next=3;break}return e.selectMethod(e.creditCard),n.abrupt("return");case 3:if(12!==(null===(r=e.activeMethod)||void 0===r?void 0:r.type)){n.next=6;break}return n.next=6,e.initOnerwayPayment();case 6:case"end":return n.stop()}}),n)})))()},selectMethod:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("selectMethod",t,e.adyenPaymenMethods),e.activeMethod&&e.activeMethod.name!==t.name&&e.logPaymentMethodSwitch(t),e.activeMethod=t,e.stateMachine&&e.stateMachine.setPaymentMethod(t),9!==t.type){n.next=8;break}e.startCheckout(),n.next=11;break;case 8:if(12!==t.type){n.next=11;break}return n.next=11,e.initOnerwayPayment();case 11:case"end":return n.stop()}}),n)})))()},showProcessingState:function(){this.inPaymentForm="in-processing",this.paymentState="processing",this.paymentStateData=y(y({},this.getEnhancedStateDataWithTimestamp()),{},{activeMethod:this.activeMethod}),this.stateMachine&&this.stateMachine.startPayment(this.activeMethod)},hideProcessingState:function(){"in-processing"===this.inPaymentForm&&(this.inPaymentForm="in-form",this.paymentStateData={})},handleRetry:function(){console.log("[PaymentForm] 处理重试操作，当前状态:",this.paymentState),this.restartPaymentFlow()},restartPaymentFlow:function(){console.log("[PaymentForm] 智能重启支付流程"),this.stateMachine&&this.stateMachine.startPayment(this.activeMethod),this.resetPaymentForm()},resetPaymentForm:function(){var t,e;this.hideProcessingState(),this.inPaymentForm="in-form",9===(null===(t=this.activeMethod)||void 0===t?void 0:t.type)?this.reRenderAdyen():12===(null===(e=this.activeMethod)||void 0===e?void 0:e.type)&&this.initOnerwayPayment(!0)},handleCancel:function(){this.hideProcessingState(),this.handleBack(!0)},handleChangePayment:function(){this.resetPaymentForm(),this.switchToNextPaymentMethod()},switchToNextPaymentMethod:function(){var t,e=this,n=this.allMethods.findIndex((function(t){var n;return t.name===(null===(n=e.activeMethod)||void 0===n?void 0:n.name)}));if(this.allMethods.length<=1)console.log("[C4] 只有一种支付方式，保持不变");else{var o=(n+1)%this.allMethods.length,r=this.allMethods[o];console.log("[C4] 切换支付方式:",{from:null===(t=this.activeMethod)||void 0===t?void 0:t.name,to:null==r?void 0:r.name,currentIndex:n,nextIndex:o}),this.selectMethod(r)}},logPaymentFormExposure:function(){this.$xyLogEvent({front_operation:"exposure",entity_name:"payment_method_area_exposure",entity_type:"payment_method_exposure",obj_info:{benefit_type:this.enhancedStateData.benefit_type,third_type:Object(l.b)(this.allMethods)}})},logPaymentMethodSwitch:function(t){this.$xyLogEvent({front_operation:"click",entity_name:"payment_method_area_switch",entity_type:"payment_method_switch",obj_id:this.goodsId})},handleIntermediateStateChange:function(t){console.log("PaymentForm 收到中间状态变化:",t),this.paymentState=t.to,t.data&&(this.paymentStateData=y(y(y({},this.paymentStateData),t.data),this.getEnhancedStateDataWithTimestamp()))},savePaymentFormData:function(data){try{var t,e;if(data&&(null!==(t=data.paymentMethod)&&void 0!==t&&t.holderName||data.billingAddress))this.savedPaymentData={holderName:(null===(e=data.paymentMethod)||void 0===e?void 0:e.holderName)||"",billingAddress:data.billingAddress||{}},console.log("[PaymentForm] 已保存支付表单数据用于预填充")}catch(t){console.warn("[PaymentForm] 保存支付数据失败:",t)}},getPrefillData:function(){return this.savedPaymentData.holderName||Object.keys(this.savedPaymentData.billingAddress||{}).length>0?(console.log("[PaymentForm] 使用预填充数据重新创建表单"),this.savedPaymentData):{}},clearSavedPaymentData:function(){this.savedPaymentData={holderName:"",billingAddress:{}},console.log("[PaymentForm] 已清理保存的支付数据")},clearPaymentTimeout:function(){this.paymentTimeoutTimer&&(clearTimeout(this.paymentTimeoutTimer),this.paymentTimeoutTimer=null)}})},O=k,x=(n(4517),n(4518),n(0)),component=Object(x.a)(O,(function(){var t,e,o,r,l,c=this,d=c._self._c;return d("div",{staticClass:"payment-content",attrs:{"data-event-group":"event_payment_form"}},[c.$slots.default?d("div",{directives:[{name:"show",rawName:"v-show",value:"in-processing"!==c.inPaymentForm,expression:"inPaymentForm !== 'in-processing'"}],staticClass:"close-icon flex-center",on:{click:function(t){return c.handleBack(!0)}}},[d("i",{staticClass:"el-icon-close"})]):c._e(),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:"in-form"===c.inPaymentForm,expression:"inPaymentForm === 'in-form'"}],staticClass:"in-payment-content w-full flex"},[d("div",{staticClass:"left",style:{width:c.thirdParty?"100%":""}},[d("div",{directives:[{name:"show",rawName:"v-show",value:c.showBack,expression:"showBack"}],staticClass:"back-to",on:{click:function(t){return c.handleBack(!1)}}},[d("i",{staticClass:"el-icon-arrow-left"}),c._v(c._s(c.$slots.default?c.$t("changePlan"):c.$t("Back"))+"\n      ")]),c._v(" "),d("div",{staticClass:"select-methods"},[d("div",{staticClass:"select-txt flex justify-between items-center"},[c._v("\n          "+c._s(c.$t("PaymentMethod"))+"\n          "),d("div",{staticClass:"switch"},[c.isFreeTry?d("el-switch",{directives:[{name:"show",rawName:"v-show",value:c.showFreeTry,expression:"showFreeTry"}],attrs:{"active-color":"#13ce66","inactive-color":"#636466","inactive-text":c.$t("try3Days"),disabled:c.loadOnerway},on:{change:c.switchTry},model:{value:c.useTry,callback:function(t){c.useTry=t},expression:"useTry"}}):c._e()],1)]),c._v(" "),c.$isChinaSite?d("div",{staticClass:"haiyi-methods"},c._l(c.allMethods,(function(t,e){return d("div",{key:t.name+e,class:t.name},[d("div",{staticClass:"box"},[5===t.type?d("div",{directives:[{name:"show",rawName:"v-show",value:c.qrCode,expression:"qrCode"}],ref:"QRCodeContainer",refInFor:!0,staticClass:"QR-code div"}):c._e(),c._v(" "),d("img",{directives:[{name:"show",rawName:"v-show",value:!c.qrCode||4===t.type,expression:"!qrCode || item.type === 4"}],staticClass:"icon",attrs:{src:n(499)("./".concat(t.icon)),alt:"alipay-icon"}})]),c._v(" "),d("el-button",{staticClass:"btn",attrs:{loading:5===t.type&&c.wechatBtnLoading},on:{click:function(e){return c.purchaseGoodsFun(t.type)}}},[c._v("\n              "+c._s(c.$t(t.i18n))+" "),d("i",{staticClass:"el-icon-arrow-right"})])],1)})),0):d("div",{staticClass:"methods"},c._l(c.allMethods,(function(t,e){var o;return d("div",{key:t.name+e,staticClass:"method-item",class:{active:(null===(o=c.activeMethod)||void 0===o?void 0:o.name)===t.name},on:{click:function(e){return c.selectMethod(t)}}},["Google Pay"===t.name?[d("img",{staticClass:"google-pay-icon",attrs:{src:n(1048),alt:""}})]:d("div",{staticClass:"method-name w-full flex-center"},[c._v(c._s(c.$t(t.i18n)))])],2)})),0)]),c._v(" "),c.activeMethod&&!c.$isChinaSite?d("div",{staticClass:"payment-form flex items-center"},[c.inCreating?d("lottie",{staticClass:"payment-loading",attrs:{options:c.lottieOptions,height:110,width:110}}):c._e(),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:"onerway"===(null===(t=c.activeMethod)||void 0===t?void 0:t.name),expression:"activeMethod?.name === 'onerway'"}],attrs:{id:"pacypay_checkout"}}),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:"Credit Card"===(null===(e=c.activeMethod)||void 0===e?void 0:e.name),expression:"activeMethod?.name === 'Credit Card'"}],ref:"adyenscheme",staticClass:"adyen-payment w-full"}),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:"AliPay"===(null===(o=c.activeMethod)||void 0===o?void 0:o.name),expression:"activeMethod?.name === 'AliPay'"}],ref:"adyenalipay",staticClass:"alipay-payment w-full"}),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:"Google Pay"===(null===(r=c.activeMethod)||void 0===r?void 0:r.name),expression:"activeMethod?.name === 'Google Pay'"}],ref:"adyengooglepay",staticClass:"googlepay-payment w-full"}),c._v(" "),d("div",{directives:[{name:"show",rawName:"v-show",value:![9,12].includes(null===(l=c.activeMethod)||void 0===l?void 0:l.type),expression:"![9, 12].includes(activeMethod?.type)"}],staticClass:"other-payment flex items-center w-full"},[d("div",{staticClass:"other-payment-btn w-full",on:{click:function(t){var e;return c.purchaseGoodsFun(null===(e=c.activeMethod)||void 0===e?void 0:e.type)}}},[c._v("\n            "+c._s(c.btnLabel?c.$t(c.btnLabel):c.$t(c.btnTxt))+"\n          ")])])],1):c._e()]),c._v(" "),c.showRightContent?d("div",{staticClass:"right"},[c.shouldShowNewRightInfo?d("PaymentRightInfo",{attrs:{goodsId:c.goodsId,upgrade:c.upgrade,useTry:c.useTry,isSubscription:c.isSubscription,context:"payment",purchParams:c.purchParams,activeMethod:c.activeMethod,isOneTimePurchase:c.isOneTimePurchase,apiParams:c.apiParams}}):c._t("default")],2):c._e()]),c._v(" "),d("PaymentIntermediateDisplay",{directives:[{name:"show",rawName:"v-show",value:"in-processing"===c.inPaymentForm,expression:"inPaymentForm === 'in-processing'"}],attrs:{"current-state":c.paymentState,"state-data":c.paymentStateData},on:{"state-change":c.handleIntermediateStateChange,retry:c.handleRetry,cancel:c.handleCancel,"change-payment":c.handleChangePayment}}),c._v(" "),d("payment-check",{directives:[{name:"show",rawName:"v-show",value:"in-waiting"===c.inPaymentForm,expression:"inPaymentForm === 'in-waiting'"}],ref:"paymentCheck",attrs:{activeMethod:c.activeMethod,thirdOrderId:c.thirdOrderId},on:{success:c.paymentSuccess,paymentError:c.paymentError,back:function(t){return c.handleBack(!1)}}})],1)}),[],!1,null,"153b7336",null);e.a=component.exports},127:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(28),n(44),n(90),n(1197)),l=n(1),c=n(125),d=n.n(c);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"RightPart",props:{activation:{type:Boolean,default:!1},showBg:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},showAvatar:{type:Boolean,default:!0},showStep:{type:Boolean,default:!0},currency:{type:String,default:"US$"},currentPlan:{type:String,default:"SVIPPlanBeginner"}},components:{},computed:v(v({},Object(l.e)("user",["cdnHost"])),{},{randomPersonData:function(){var t=r.a[Math.floor(Math.random()*r.a.length)],e=(this.$i18n.locale?this.$i18n.locale:"en").toLowerCase().startsWith("zh");return v(v({},t),{},{title:e?t.titleZh:t.titleEn,content:e?t.contentZh:t.contentEn,avatar:t.avatar.replace("image2.cdn.seaart.me",this.cdnHost)})}}),data:function(){return{}},mounted:function(){},methods:{formatDate:function(){return d()().add(3,"day").format("YYYY-MM-DD")},toMall:function(){window.open(this.localePath("/mall"),"_blank")}}},m=(n(4519),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-part",class:{bgImg:t.showBg}},[t.showText?e("div",{staticClass:"renew-content"},[e("div",{staticClass:"renew-sign"},[t._v("“")]),t._v(" "),e("div",{staticClass:"renew-txt"},[t._v(t._s(t.randomPersonData.content))])]):t._e(),t._v(" "),t.showStep?e("div",{staticClass:"steps"},[e("div",{staticClass:"step up"},[e("div",{staticClass:"left-step"},[e("div",{staticClass:"left-icon"},[e("svg-icon",{staticClass:"icon",attrs:{"icon-class":"blueHeart"}})],1),t._v(" "),e("div",{staticClass:"left-line"})]),t._v(" "),e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("vipDialogNewTitle")))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t("vipDialogNewDesc1",{unit:t.currency,plan:t.$t(t.currentPlan)})))])])]),t._v(" "),e("div",{staticClass:"step"},[t._m(0),t._v(" "),e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.formatDate()))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t("vipDialogNewDesc2")))])])])]):t._e(),t._v(" "),t.showAvatar?e("div",{staticClass:"avatar-content"},[t.randomPersonData.avatar?e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t.randomPersonData.avatar,alt:"avatar"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})]):t._e(),t._v(" "),e("div",{staticClass:"person-info"},[e("div",{staticClass:"name"},[t._v(t._s(t.randomPersonData.name))]),t._v(" "),e("div",{staticClass:"title"},[t._v(t._s(t.randomPersonData.title))])])]):t._e(),t._v(" "),!t.activation&&t.showStep?e("div",{staticClass:"renew-txt"},[t._v(t._s(t.randomPersonData.content))]):t._e(),t._v(" "),t.activation?e("div",{staticClass:"to-mall",on:{click:t.toMall}},[t._v(t._s(t.$t("ActivationTip",{plan:t.$t(t.currentPlan)})))]):t._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"left-step"},[t("div",{staticClass:"left-icon"},[t("i",{staticClass:"icon iconfont icon-ring"})]),this._v(" "),t("div",{staticClass:"left-line"})])}],!1,null,"4bb1ccf9",null);e.a=component.exports;installComponents(component,{SvgIcon:n(115).default})},1568:function(t,e,n){t.exports={}},1858:function(t,e,n){t.exports={}},1859:function(t,e,n){t.exports={}},1911:function(t,e,n){t.exports={}},1912:function(t,e,n){t.exports={}},1922:function(t,e,n){t.exports={}},1952:function(t,e,n){t.exports={}},2079:function(t,e,n){t.exports={}},2080:function(t,e,n){t.exports={}},2081:function(t,e,n){t.exports={}},2140:function(t,e,n){t.exports={}},2141:function(t,e,n){t.exports={}},2142:function(t,e,n){t.exports={}},2143:function(t,e,n){t.exports={}},2144:function(t,e,n){t.exports={}},2145:function(t,e,n){t.exports={}},2146:function(t,e,n){t.exports={}},2147:function(t,e,n){t.exports={}},2148:function(t,e,n){t.exports={}},2149:function(t,e,n){t.exports={}},2150:function(t,e,n){t.exports={}},2151:function(t,e,n){t.exports={}},2152:function(t,e,n){t.exports={}},2153:function(t,e,n){t.exports={}},2156:function(t,e,n){t.exports={}},2157:function(t,e,n){t.exports={}},2158:function(t,e,n){t.exports={}},2159:function(t,e,n){t.exports={}},2160:function(t,e,n){t.exports={}},2161:function(t,e,n){t.exports={}},2162:function(t,e,n){t.exports={}},2163:function(t,e,n){t.exports={}},2164:function(t,e,n){t.exports={}},2165:function(t,e,n){t.exports={}},2166:function(t,e,n){t.exports={}},2168:function(t,e,n){t.exports={}},2169:function(t,e,n){t.exports={}},2170:function(t,e,n){t.exports={}},2171:function(t,e,n){t.exports={}},2172:function(t,e,n){t.exports={}},2173:function(t,e,n){t.exports={}},2174:function(t,e,n){t.exports={}},2175:function(t,e,n){t.exports={}},2176:function(t,e,n){t.exports={}},2177:function(t,e,n){t.exports={}},2178:function(t,e,n){t.exports={}},2179:function(t,e,n){t.exports={}},2180:function(t,e,n){t.exports={}},2181:function(t,e,n){t.exports={}},2182:function(t,e,n){t.exports={}},2183:function(t,e,n){t.exports={}},2184:function(t,e,n){t.exports={}},2185:function(t,e,n){t.exports={}},2186:function(t,e,n){t.exports={}},2187:function(t,e,n){t.exports={}},2188:function(t,e,n){t.exports={}},2189:function(t,e,n){t.exports={}},2190:function(t,e,n){t.exports={}},2191:function(t,e,n){t.exports={}},2192:function(t,e,n){t.exports={}},2242:function(t,e,n){t.exports={}},2243:function(t,e,n){t.exports={}},2244:function(t,e,n){t.exports={}},2245:function(t,e,n){t.exports={}},2246:function(t,e,n){t.exports={}},2247:function(t,e,n){t.exports={}},2249:function(t,e,n){t.exports={}},2283:function(t,e,n){t.exports={}},2287:function(t,e,n){t.exports={}},2288:function(t,e,n){t.exports={}},2289:function(t,e,n){t.exports={}},2290:function(t,e,n){t.exports={}},2291:function(t,e,n){t.exports={}},2292:function(t,e,n){t.exports={}},2293:function(t,e,n){t.exports={}},2464:function(t,e,n){t.exports={}},2552:function(t,e,n){t.exports={}},2553:function(t,e,n){t.exports={}},2554:function(t,e,n){t.exports={}},2556:function(t,e,n){t.exports={}},2558:function(t,e,n){t.exports={}},2559:function(t,e,n){t.exports={}},2560:function(t,e,n){t.exports={}},2563:function(t,e,n){t.exports={}},2564:function(t,e,n){t.exports={}},2565:function(t,e,n){t.exports={}},2586:function(t,e,n){t.exports={}},2620:function(t,e,n){t.exports={}},2621:function(t,e,n){t.exports={}},2622:function(t,e,n){t.exports={}},2623:function(t,e,n){t.exports={}},2624:function(t,e,n){t.exports={}},2656:function(t,e,n){t.exports={}},2657:function(t,e,n){t.exports={}},2658:function(t,e,n){t.exports={}},2660:function(t,e,n){t.exports={}},2661:function(t,e,n){t.exports={}},2662:function(t,e,n){t.exports={}},2663:function(t,e,n){t.exports={}},2664:function(t,e,n){t.exports={}},2665:function(t,e,n){t.exports={}},2666:function(t,e,n){t.exports={}},2667:function(t,e,n){t.exports={}},2668:function(t,e,n){t.exports={}},2669:function(t,e,n){t.exports={}},2670:function(t,e,n){t.exports={}},2671:function(t,e,n){t.exports={}},2672:function(t,e,n){t.exports={}},2673:function(t,e,n){t.exports={}},2674:function(t,e,n){t.exports={}},2675:function(t,e,n){t.exports={}},2676:function(t,e,n){t.exports={}},2677:function(t,e,n){t.exports={}},2678:function(t,e,n){t.exports={}},2679:function(t,e,n){t.exports={}},2680:function(t,e,n){t.exports={}},2681:function(t,e,n){t.exports={}},2682:function(t,e,n){t.exports={}},2781:function(t,e,n){t.exports={}},2782:function(t,e,n){t.exports={}},2783:function(t,e,n){t.exports={}},2784:function(t,e,n){t.exports={}},2785:function(t,e,n){t.exports={}},2786:function(t,e,n){t.exports={}},2787:function(t,e,n){t.exports={}},2788:function(t,e,n){t.exports={}},2789:function(t,e,n){t.exports={}},2792:function(t,e,n){t.exports={}},2793:function(t,e,n){t.exports={}},2794:function(t,e,n){t.exports={}},2795:function(t,e,n){t.exports={}},2796:function(t,e,n){t.exports={}},2797:function(t,e,n){t.exports={}},2798:function(t,e,n){t.exports={}},2799:function(t,e,n){t.exports={}},2800:function(t,e,n){t.exports={}},2801:function(t,e,n){t.exports={}},2802:function(t,e,n){t.exports={}},2803:function(t,e,n){t.exports={}},2804:function(t,e,n){t.exports={}},2805:function(t,e,n){t.exports={}},2806:function(t,e,n){t.exports={}},2807:function(t,e,n){t.exports={}},2808:function(t,e,n){t.exports={}},2809:function(t,e,n){t.exports={}},2810:function(t,e,n){t.exports={}},2811:function(t,e,n){t.exports={}},2812:function(t,e,n){t.exports={}},2813:function(t,e,n){t.exports={}},2814:function(t,e,n){t.exports={}},2815:function(t,e,n){t.exports={}},2816:function(t,e,n){t.exports={}},2907:function(t,e,n){t.exports={}},2908:function(t,e,n){t.exports={}},2942:function(t,e,n){t.exports={}},2943:function(t,e,n){t.exports={}},2944:function(t,e,n){t.exports={}},2945:function(t,e,n){t.exports={}},2946:function(t,e,n){t.exports={}},2947:function(t,e,n){t.exports={}},2948:function(t,e,n){t.exports={}},2983:function(t,e,n){t.exports={}},2984:function(t,e,n){t.exports={}},2985:function(t,e,n){t.exports={}},2986:function(t,e,n){t.exports={}},2987:function(t,e,n){t.exports={}},2988:function(t,e,n){t.exports={}},2989:function(t,e,n){t.exports={}},2990:function(t,e,n){t.exports={}},2991:function(t,e,n){t.exports={}},2992:function(t,e,n){t.exports={}},2993:function(t,e,n){t.exports={}},2994:function(t,e,n){t.exports={}},2995:function(t,e,n){t.exports={}},2996:function(t,e,n){t.exports={}},2997:function(t,e,n){t.exports={}},2998:function(t,e,n){t.exports={}},2999:function(t,e,n){t.exports={}},3e3:function(t,e,n){t.exports={}},3001:function(t,e,n){t.exports={}},3003:function(t,e,n){t.exports={}},3005:function(t,e,n){t.exports={}},3006:function(t,e,n){t.exports={}},3007:function(t,e,n){t.exports={}},3008:function(t,e,n){t.exports={}},3009:function(t,e,n){t.exports={}},3010:function(t,e,n){t.exports={}},3012:function(t,e,n){t.exports={}},3013:function(t,e,n){t.exports={}},3014:function(t,e,n){t.exports={}},3015:function(t,e,n){t.exports={}},3016:function(t,e,n){t.exports={}},3017:function(t,e,n){t.exports={}},3018:function(t,e,n){t.exports={}},3019:function(t,e,n){t.exports={}},3020:function(t,e,n){t.exports={}},3021:function(t,e,n){t.exports={}},3026:function(t,e,n){t.exports={}},3028:function(t,e,n){t.exports={}},3040:function(t,e,n){t.exports={}},3041:function(t,e,n){t.exports={}},3042:function(t,e,n){t.exports={}},3050:function(t,e,n){t.exports={}},3051:function(t,e,n){t.exports={}},3052:function(t,e,n){t.exports={}},3053:function(t,e,n){t.exports={}},3054:function(t,e,n){t.exports={}},3056:function(t,e,n){t.exports={}},3198:function(t,e,n){"use strict";n.r(e);n(16),n(18),n(11),n(12),n(13);var o=n(14),r=n(2),l=n(3),c=(n(20),n(19),n(6),n(32),n(50),n(22),n(49),n(8),n(4),n(28),n(21),n(40),n(44),n(7),n(41),n(141),n(142),n(109),n(1)),d=n(172),h=n(905),v=n(82),f=n(906),m=n(51),_=n(907),y=n(52),w=n(178),C=n(133),k=n(213),O=n(181),x=n(403),T=n(61),S=n(9),D=n(71),P=n(277),I=n.n(P),$=n(566),j=n(35),L=n.n(j),M=n(212),E=n(80);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N=S.s.map((function(t){return{key:t,value:""}})),R={name:"workflowPublish",components:{publishTopBar:h.a,effectExampleItem:f.a,exampleImgList:_.a,SwipeableList:y.default,LoadingStatus:k.default,draggable:I.a,Multilingual:$.default,ElImageViewer:d.a,MyEditor:M.default},mixins:[x.videoCoverMixIn],provide:function(){return{top:this}},data:function(){return{bigImgDialogVisible:!1,viewBigImgType:"introduction",agree:!0,allowPublish:!0,allowPromotion:!0,activeImg:"",activeIndex:-1,currentPageType:"publish",exampleItemLimit:10,titleMaxlength:80,descMaxLength:3e3,formData:{name:"",name_18n_lang:{},is_modify_name:!1,content:"",desc_18n_lang:{},is_modify_desc:!1,samples:[],categories:[]},rules:{name:[{required:!0,message:this.$t("comfyUpLoad4"),trigger:["change","blur"]}],content:{required:!0,message:this.$t("pleaseEnte")},samples:[{required:!0,message:this.$t("workFlow30"),trigger:["change","blur"]}],categories:[{required:!0,message:this.$t("comfyUpLoad7"),trigger:["change","blur"]}]},selectList:[],intRmdTag:[],loading:!1,imageLoading:!1,UPLOAD:new m.a({type:2}),isPosting:!1,itemScroll:null,itemScrollLeft:null,loadingFormData:!1,isSubmitSuccess:!1,workflowConfig:{},workflowFormInfo:null,workflowInfo:null,isReady:!1,inputData:[],outputData:[],inputDataTemplate:{},selectInputData:[],selectOutputData:[],dragIndex:-1,work_flow_id:"",template_id:"",fromPage:"",showCustomTitle:!1,uploadingVideo:!1}},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.work_flow_id=t.$route.params.id,t.template_id=(null===(n=t.$route.query)||void 0===n?void 0:n.template_id)||"",t.resetFormData(),e.next=5,t.getWorkflowConfig();case 5:if(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.template_id){e.next=10;break}return e.next=8,t.getFullInfo(t.work_flow_id);case 8:e.next=12;break;case 10:return e.next=12,t.getWorkflowInfo();case 12:t.getTagList(),t.isReady=!0;case 14:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.fromPage=""},computed:A(A({},Object(c.e)("user",["cdnHost"])),{},{getBigImg:function(){var t=this.$i18n.locale;return["zhCN","en","ja"].includes(t)?"https://".concat(this.cdnHost,"/static/comfyui/").concat(this.viewBigImgType,"/web_").concat(t,".webp"):"https://".concat(this.cdnHost,"/static/comfyui/").concat(this.viewBigImgType,"/web_en.webp")},acceptImage:function(){return this.enableUploadVideo?".jpg,.jpeg,.png,.webp,.gif":".jpg,.jpeg,.png,.webp"},enableUploadVideo:function(){var t;return null==this||null===(t=this.workflowConfig)||void 0===t?void 0:t.enable_video_cover},getDynamicHref:function(){return function(t){var e="Terms"===t,n=this.$i18n.locale?this.$i18n.locale:"en";return Object(w.a)(n,e,this.$isChinaSite)}},getInputDataConfig:function(){var t,e=this;return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_input_param)||[]).reduce((function(pre,t){var n=t.options.map((function(n){var o=A({},n);return e.showCustomTitle&&!["",null,void 0].includes(null==t?void 0:t.title)?o.label="".concat(o.node_id,"-").concat(t.node_type," (").concat(t.title,") -").concat(n.field):o.label="".concat(o.node_id,"-").concat(t.node_type,"-").concat(n.field),o.nodeKey="".concat(t.node_type,"-").concat(n.field),o.node_type=t.node_type,o}));return pre.push.apply(pre,Object(o.a)(n)),pre}),[])},getCustomNodeTitle:function(){var t,e={};return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_input_param)||[]).forEach((function(t){null!=t&&t.title&&(e[t.node_type]=t.title)})),e},getOutputDataConfig:function(){var t;return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_output_param)||[]).map((function(t){var e=A({},t);return e.label="".concat(e.node_id,"-").concat(t.node_type),e}))},getInputDataList:function(){return(this.inputData||[]).map((function(t){var e=A({},t);return e.val="",e.option=A({values:[]},(null==t?void 0:t.option)||{}),e}))},getImageUrl:function(){return function(t){var e=(null==t?void 0:t.url)||"";if([2,"2"].includes(null==t?void 0:t.type)&&null!=t&&t.url){e=t.url.replace(/\.(mp4)/g,"_low.webp")}return e}}}),methods:{viewBigImage:function(t){this.viewBigImgType=t,this.bigImgDialogVisible=!0},handleMultilingual:function(t){var e=t.type,data=t.data,n=data.lang,o=data.originText,r={};n.forEach((function(t){r[t.key]=t.value})),"workflowName"===e&&(this.formData.is_modify_name=this.formData.name!==o,this.formData.name_18n_lang=r,this.formData.name=o)},handleChangeName:function(){this.formData.is_modify_name=!0},changeEditor:function(t){t&&(this.formData.is_modify_desc=!0,this.$refs.infoForm.validateField("content"))},getLang:function(t){var e=L()(N);return Object.keys(t).forEach((function(n){var o=e.findIndex((function(t){return t.key===n}));-1!==o?e[o].value=t[n]:e.push({key:n,value:t[n]})})),e},openTranslateModal:function(t){var e=this,n=[];n="workflowName"===t.type?this.getLang(this.formData.name_18n_lang):this.getLang(this.formData.desc_18n_lang),this.$refs.translateModal.open(A(A({},t),{},{originText:this.formData.name,lang:n,beforeValidate:function(t){return e.batchQuerySensitiveWords({items:[{texts:t.lang.map((function(t){return{text:t.value,category:"workflow_multilingual_setting",point_type:"app-encapsulation-app-name-multilingual-settings@description"}})),type:S.e.TitleDescription}]})}}))},dragstart:function(t){this.dragIndex=t},dragenter:function(t,e){if(t.preventDefault(),this.dragIndex!==e){var n=this.inputData[this.dragIndex];this.inputData.splice(this.dragIndex,1),this.inputData.splice(e,0,n),this.dragIndex=e}},dragover:function(t,e){t.preventDefault()},getWorkflowPublish:function(t){var e=this;Object(C.i)(t).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=o.content,content=void 0===r?"":r,l=o.name,c=void 0===l?"":l,d=o.samples,h=void 0===d?[]:d,v=o.categories,f=void 0===v?[]:v,m=o.inputs,_=void 0===m?[]:m,y=o.outputs,w=void 0===y?[]:y,C=o.permission,k=void 0===C?{}:C;o.type;null!==(n=e.$route.query)&&void 0!==n&&n.template_id&&(e.workflowInfo=Object.assign({},(null==t?void 0:t.data)||{})),e.formData.samples=h,e.formData.content=content,e.formData.name=c,e.allowPublish=2===(null==k?void 0:k.primary),e.allowPromotion=1===(null==k?void 0:k.ad),e.inputData=Array.isArray(_)?_:[],e.outputData=Array.isArray(w)?w:[],e.formData.categories=(f||[]).map((function(t){return null==t?void 0:t.value})).filter((function(t){return!!t}))})).finally((function(){e.loadingFormData=!1}))},getFullInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e={};e.id=t,this.loadingFormData=!0,this.getWorkflowPublish(e)},changeVal:function(){},handleSelectInputFiled:function(source){if((this.selectInputData=[],source)&&!(this.inputData||[]).find((function(t){return t.node_id===(null==source?void 0:source.node_id)&&t.node_type===(null==source?void 0:source.node_type)&&t.field===source.field}))){var t=[1,"1"].includes(source.type)?this.$t("pleaseEnte"):this.$t("Pls_select"),e={desc:"",field:source.field,node_id:null==source?void 0:source.node_id,node_type:source.node_type,title:"".concat(t).concat(source.field),type:source.type,value_type:source.value_type};this.inputData.push(e)}},handleSelectOutputFiled:function(t){if((this.selectOutputData=[],t)&&!(this.outputData||[]).find((function(e){return e.node_id===(null==t?void 0:t.node_id)&&e.node_type===t.node_type}))){var e={node_id:t.node_id,node_type:t.node_type};this.outputData.push(e)}},getWorkflowInfo:function(){var t=this,e={};e.id=this.$route.params.id,this.loading=!0,Object(C.f)(e).then((function(e){var n,o,r=(null==e?void 0:e.data)||{},l=null==e||null===(n=e.data)||void 0===n?void 0:n.data;try{l=JSON.parse(l)}catch(t){}if(t.workflowInfo=A(A({},r),{},{data:l}),3===(null===(o=t.workflowInfo)||void 0===o?void 0:o.source))return t.getComfyUiInfo()})).finally((function(){t.loading=!1}))},handleChange:function(){},handlePromotionChange:function(){},getComfyUiInfo:function(){var t,e={};e.id=null===(t=this.workflowInfo)||void 0===t?void 0:t.source_id,this.loadingFormData=!0,this.getWorkflowPublish(e)},handleChangePageType:function(t){var e;if(this.fromPage&&[this.fromPage].includes("workflow")){[this.fromPage].includes("workflow")&&"click_back_to_work_page",[this.fromPage].includes("workFlowDetail")&&"click_back_to_publish_template_page"}(null===(e=window)||void 0===e?void 0:e.history.length)>2?this.$router.back():this.$router.push(this.localePath("/"))},handleRemoveImage:function(t){var e=this.formData.samples.findIndex((function(e){return t.url&&e.url===(null==t?void 0:t.url)}));this.formData.samples.length&&this.formData.samples.splice(e,1)},carouselChange:function(t){this.activeIndex=t,this.changeScroll()},imgItemChange:function(t){this.$refs.imgCnt.setActiveItem(t),this.changeScroll()},getItemScrollLeft:function(){var t=this;this.$nextTick((function(){t.$refs.listItem&&t.$refs.listItem.forEach((function(e){var n;null!==(n=e.classList)&&void 0!==n&&n.contains("imgActivate")&&(t.itemScrollLeft=e.getBoundingClientRect().left)}))}))},changeScroll:function(){var t=this;this.$nextTick((function(){t.$refs.listItem.forEach((function(e,n){e.classList.contains("imgActivate")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))}))},resetFormData:function(){this.isSubmitSuccess=!1},handleSelect:function(i){var t;this.activeImg=(null==this||null===(t=this.formData)||void 0===t?void 0:t.samples[i])||""},changeTag:function(){},filterMethod:function(){var t=this;this.$nextTick((function(){try{t.$refs.tagSelect.$el.querySelector(".el-select__input").setAttribute("maxlength",30)}catch(t){}}))},remoteMethod:function(t){var e=this;t&&Object(v.d)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.selectList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.selectList.push({title:t.title,id:t.title})})))}))},setIntRmdTag:function(t){var e,n=this;t&&(this.selectList=[].concat(Object(o.a)(this.intRmdTag),Object(o.a)(null===(e=this.formData)||void 0===e?void 0:e.categories.filter((function(t){return!n.intRmdTag.find((function(e){return e.title===t.title}))})))))},handleChangeTab:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.agree?(this.currentPageType=t,this.$EventBus.$emit("updateCollapseStatus")):this.$message.warning(this.$t("PleaseTTOSAPP"))},getTagList:function(){var t=this;Object(D.d)({show_area:"workflow"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){return e.title=e[S.r[t.$i18n.locale]],e})),t.$set(t,"selectList",n)})).catch((function(t){console.log("err",t)}))},getWorkflowConfig:function(){var t=this;return Object(C.g)().then((function(e){var n=A(A({},t.workflowConfig),(null==e?void 0:e.data)||{});t.$set(t,"workflowConfig",n),window.workflowConfig=t.workflowConfig})).catch((function(t){}))},handleImageUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/webp"],l=["image/gif"].includes(t.type),!e.isPosting){n.next=5;break}return n.abrupt("return");case 5:if(e.enableUploadVideo&&r.push("image/gif"),r.includes(t.type)){n.next=9;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 9:if(!(c=t)||c.size){n.next=12;break}return n.abrupt("return",!1);case 12:if(!(l&&c.size/1024/1024>5)){n.next=15;break}return e.$message.warning(e.$t("UploadImageExceedCustomMB",{number:5})),n.abrupt("return",!1);case 15:if(l||!(c.size/1024/1024>10)){n.next=26;break}return n.prev=16,n.next=19,Object(T.a)(c,10485760);case 19:c=n.sent,n.next=26;break;case 22:return n.prev=22,n.t0=n.catch(16),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 26:return n.next=28,e.checkImageSize(t);case 28:if(d=n.sent,e.base64RoleUrl=d.url||"",!e.imageLoading){n.next=32;break}return n.abrupt("return");case 32:return e.imageLoading=!0,o.startUpload(c,{category:68}).then((function(t){var n={width:d.width,height:d.height,type:3,url:t};e.formData.samples.length<e.exampleItemLimit&&(e.formData.samples.push(n),e.$refs.infoForm.clearValidate("samples")),e.imageLoading=!1})).catch((function(t){e.$message.error(e.$t("uploadError")),e.imageLoading=!1})),n.abrupt("return",!1);case 35:case"end":return n.stop()}}),n,null,[[16,22]])})))()},handleVideoUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isPosting){n.next=2;break}return n.abrupt("return");case 2:if(e.uploadingVideo=!0,["video/mp4"].includes(t.type)){n.next=7;break}return e.uploadingVideo=!1,n.abrupt("return",e.$message.warning(e.$t("OnlySupportVideo")));case 7:if(o=t.size,!(o>5242880)){n.next=14;break}return e.$message.warning(e.$t("ExceedingNumberMB",{number:5})),e.uploadingVideo=!1,n.abrupt("return");case 14:return r=URL.createObjectURL(t),n.next=17,e.getVideoBasicInfo(r);case 17:return l=n.sent,URL.revokeObjectURL(r),e.handleUploadVideo(t,l),n.abrupt("return",!1);case 21:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};new O.a({file:t,category:56}).beforeUpload().then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(o){var r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o.url,l={width:null==n?void 0:n.width,height:null==n?void 0:n.height,duration:Math.ceil((null==n?void 0:n.duration)||0),type:2,url:r},e.formData.samples.length<e.exampleItemLimit&&(e.formData.samples.push(l),e.$refs.infoForm.clearValidate("samples")),e.uploadingVideo=!1;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.uploadingVideo=!1}))},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},handleConfirm:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,param,r,l,content,c,d,h,v,f,m,_,y,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPosting&&!t.isSubmitSuccess){e.next=3;break}return e.abrupt("return");case 3:if(param={},r=!0,t.$refs.infoForm.validate((function(e,object){null!=object&&object.content&&t.$xyLogEvent({front_operation:"click",entity_name:"publish_popup_not_filled_description_error",entity_type:"class_p-workflow-publish",obj_desc:"comfyui_workflow"}),r=e})),r){e.next=8;break}return e.abrupt("return");case 8:if(t.agree){e.next=11;break}return t.$message.warning(t.$t("PleaseTTOSAPP")),e.abrupt("return");case 11:return t.isPosting=!0,param.id=t.workflowInfo.id,["",null,void 0].includes(t.template_id)&&(param.work_flow_id=t.work_flow_id),l=t.formData,content=l.content,c=l.desc_18n_lang,d=l.is_modify_desc,h=l.name,v=l.name_18n_lang,f=l.is_modify_name,m=l.samples,_=l.categories,e.prev=15,e.next=18,t.batchQuerySensitiveWords({items:[{texts:[{text:h,category:"app_name",point_type:"app-encapsulation-app-name@description"},{text:content,category:"content",point_type:"app-encapsulation-introduction@description"}],type:S.e.TitleDescription}]});case 18:e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(15),t.isPosting=!1,e.abrupt("return");case 24:param.desc_18n_lang=c,param.is_modify_desc=d,param.name=h,param.content=content,param.name_18n_lang=v,param.is_modify_name=f,param.samples=m,param.publish=t.allowPublish?1:2,param.categories=_||[],y=3!==(null===(n=t.workflowInfo)||void 0===n?void 0:n.source)&&["",null,void 0].includes(t.template_id)?C.l:C.m,3===(null===(o=t.workflowInfo)||void 0===o?void 0:o.source)&&(param.id=null===(w=t.workflowInfo)||void 0===w?void 0:w.source_id),y(param).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.isSubmitSuccess=!0,t.$message.success(t.$t("CreativeCenterPopup30")),t.$router.push(t.localePath({path:"/personal",query:{tab:"WorkflowAIAPP"}})))})).finally((function(){t.isPosting=!1}));case 36:case"end":return e.stop()}}),e,null,[[15,20]])})))()},handleDeleteInputData:function(t,e){var n=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){-1!==e&&n.inputData.splice(e,1)}))},handleDeleteOutputData:function(t,e){var n=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){-1!==e&&n.outputData.splice(e,1)}))},batchQuerySensitiveWords:function(t){var e=this,n={app_name:"app_name",content:"Introduction",workflow_multilingual_setting:"workflow_multilingual_setting"};return new Promise((function(o,r){Object(E.b)(t).then((function(t){var l,data=(null==t?void 0:t.data)||{};if(1e4!==(null==t||null===(l=t.status)||void 0===l?void 0:l.code)&&r(!1),null!=data&&data.has_sensitive_word){var c=data.sensitive_categories||[];e.$message.error(e.$t("audio_Inpu_detection1",{X:e.$t(n[c[0]])})),r(!1)}else o(!0)})).catch((function(t){r(!1)}))}))}},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPage=(null==e?void 0:e.name)||""}))}},B=R,U=(n(4718),n(4719),n(0)),component=Object(U.a)(B,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"p-workflow-publish"},[e.isReady?[n("publish-top-bar",{attrs:{type:"workflow"},on:{changePageType:e.handleChangePageType}}),e._v(" "),n("div",{staticClass:"workflow-publish-container"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingFormData,expression:"loadingFormData"}],staticClass:"workflow-publish-container-left"},[n("div",{staticClass:"publish-container-left-container"},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],ref:"infoForm",staticClass:"custom-form",attrs:{"label-position":"top",model:e.formData,rules:e.rules}},[n("el-form-item",{attrs:{label:e.$t("trainName"),prop:"name"}},[n("div",{staticClass:"translate-btn",on:{click:function(t){e.openTranslateModal({title:e.$t("trainName"),type:"workflowName"})}}},[e._v("\n                "+e._s(e.$t("Multilingual"))+"\n              ")]),e._v(" "),n("el-input",{staticClass:"title-input",attrs:{placeholder:e.$t("WorkflowNameTip"),"show-word-limit":"",maxlength:e.titleMaxlength},on:{change:e.handleChangeName},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("Introduction"),prop:"content"}},[n("MyEditor",{attrs:{isErr:!1,uploadCategory:70,placeholder:"Please describe what your workflow does, how to use it, and what results users can expect. ",defaultProps:{mode:"simple"}},on:{onChange:e.changeEditor},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"samples"}},[n("template",{slot:"label"},[n("span",{staticClass:"big-img-icon-wrap"},[e._v("\n                  "+e._s(e.$t("CoverImg"))+"\n                  "),n("i",{staticClass:"iconfont icon-help-icon big-img-icon",on:{click:function(t){return e.viewBigImage("cover")}}})])]),e._v(" "),n("div",{staticClass:"effect-example-upload-box"},[n("div",{staticClass:"upload-item-wrap"},[e.formData.samples.length<10?n("div",{staticClass:"upload-item"},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.imageLoading,expression:"imageLoading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleImageUpload,disabled:e.imageLoading,accept:e.acceptImage,"http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("UploadImg")))]),e._v(" "),n("div",{staticClass:"upload-item-text-tips"},[e._v(e._s(e.$t("ComfyuiUploadImgTips")))])])])],1):e._e(),e._v(" "),e.enableUploadVideo&&e.formData.samples.length<10?n("div",{staticClass:"upload-item"},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadingVideo,expression:"uploadingVideo"}],key:"videoUpload",ref:"videoUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleVideoUpload,disabled:e.uploadingVideo,accept:"video/mp4","http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("selectingMaterialsType3")))])])])],1):e._e()]),e._v(" "),null!==(t=e.formData)&&void 0!==t&&null!==(t=t.samples)&&void 0!==t&&t.length?[n("draggable",{staticClass:"effect-example-upload-box-list",model:{value:e.formData.samples,callback:function(t){e.$set(e.formData,"samples",t)},expression:"formData.samples"}},e._l(e.formData.samples,(function(t,o){return n("effect-example-item",{key:o,attrs:{source:t},on:{removeImage:function(t){return e.handleRemoveImage(t,o)}}})})),1)]:e._e()],2)],2),e._v(" "),n("el-form-item",{attrs:{label:e.$t("categoryTags"),prop:"categories"}},[n("el-select",{ref:"tagSelect",staticClass:"show-tag",staticStyle:{width:"100%"},attrs:{"value-key":"title",placeholder:e.$t("TagsAssociationTips"),multiple:"","multiple-limit":5,"popper-class":"show-tag-select",clearable:"",filterable:"","default-first-option":""},on:{change:e.changeTag},model:{value:e.formData.categories,callback:function(t){e.$set(e.formData,"categories",t)},expression:"formData.categories"}},e._l(e.selectList,(function(t,i){return n("el-option",{key:"tag_".concat(t.id+i),attrs:{label:t.title,value:t.id}})})),1)],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],staticClass:"bottom-btn-box"},[n("div",{staticClass:"bottom-checkbox-wrap"},[n("el-checkbox",{model:{value:e.agree,callback:function(t){e.agree=t},expression:"agree"}},[e._v(e._s(e.$t("workFlow26"))),n("a",{staticClass:"bottom-checkbox-title",attrs:{target:"“_blank”",href:e.getDynamicHref("Terms")}},[e._v(e._s(e.$t("comfyUpLoad3")))])]),e._v(" "),n("el-checkbox",{on:{change:e.handleChange},model:{value:e.allowPublish,callback:function(t){e.allowPublish=t},expression:"allowPublish"}},[e._v(e._s(e.$t("PublishWorkflowToCommunity")))])],1),e._v(" "),n("el-button",{staticClass:"publish-btn",attrs:{type:"primary",loading:e.isPosting,"data-event":"publish_popup_publish_button","data-desc":"comfyui_workflow",disabled:e.isPosting},on:{click:function(t){return e.handleConfirm()}}},[e._v(e._s(e.$t("releaseName"))+"\n            ")]),e._v(" "),n("div",{staticClass:"publish-btn-tips"},[e._v("\n              "+e._s(e.$t("motivatingTitle"))+"\n              "),n("a",{staticClass:"bottom-checkbox-title",attrs:{"data-event":"publish_workflow_profits_url","data-group":"publish_as_workflow_popup",target:"“_blank”",href:e.localePath("/creationCenter/dataCenterWorkflow")}},[e._v(e._s(e.$t("comfyui_publish_guide_text9")))])])],1)],1)]),e._v(" "),n("div",{staticClass:"workflow-publish-container-right"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],staticClass:"image-view-area",style:{width:"100%"}},[n("div",{staticClass:"imgInfo"},[n("el-carousel",{ref:"imgCnt",attrs:{autoplay:!1,arrow:"never","initial-index":e.activeIndex,"indicator-position":"none"},on:{change:function(t,n){return e.carouselChange(t)}}},e._l(e.formData.samples,(function(t,e){return n("el-carousel-item",{key:e},[[2,"2"].includes(null==t?void 0:t.type)?n("video",{staticClass:"img-info-video",style:{maxWidth:"100%",maxHeight:"100%"},attrs:{src:null==t?void 0:t.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):n("img",{attrs:{src:t.url||t.cover,alt:""}})])})),1)],1),e._v(" "),n("div",{staticClass:"imgList"},[n("swipeable-list",{attrs:{scrollLeftnum:e.itemScrollLeft,scrollChange:e.itemScroll,top:"0px",height:"100%",isShowIconBtn:!1,needInScroll:!0}},e._l(e.formData.samples,(function(t,o){return n("div",{key:o,ref:"listItem",refInFor:!0,staticClass:"imgItem",class:{imgActivate:o===e.activeIndex},on:{click:function(t){return e.imgItemChange(o)}}},[n("img",{attrs:{src:e.getImageUrl(t),alt:""}})])})),0)],1)])])])]:n("LoadingStatus",{attrs:{bgColor:"#02050e"}}),e._v(" "),e.bigImgDialogVisible?n("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":function(){e.bigImgDialogVisible=!1},"url-list":[e.getBigImg]}}):e._e(),e._v(" "),n("Multilingual",{ref:"translateModal",on:{handleMultilingual:e.handleMultilingual}})],2)}),[],!1,null,"2bdf7edb",null);e.default=component.exports;installComponents(component,{MyEditor:n(212).default,SwipeableList:n(52).default,LoadingStatus:n(213).default,Multilingual:n(566).default})},3436:function(t,e,n){"use strict";n.r(e);n(16),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(19),n(31),n(21),n(26),n(1)),l=n(58),c=n(300),d=n(558),h=n(461);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"PaymentStatusDialog2",data:function(){return{isShowDialog:!1,paymentData:{},defaultOptions:{animationData:c},confettiTimer:null,confettiCount:0}},mounted:function(){var t=this;this.$EventBus.$on("openPaymentStatusDialog2",(function(e){var n,o,r,data=e.data;if(localStorage.removeItem("half_discount_end_time"),t.isShowDialog=!0,t.paymentData=data,null!=data&&data.is_paid&&t.$nextTick((function(){t.playConfettiAnimation()})),window.fbq){var l,c,d=(null===(l=t.$store.state.user)||void 0===l||null===(l=l.userInfo)||void 0===l?void 0:l.email)||"";if(fbq("track","Purchase",{currency:"USD",value:(null===(c=t.paymentData)||void 0===c||null===(c=c.Product)||void 0===c?void 0:c.price)||0}),d&&t.$fbConversion)try{var v;t.$fbConversion.trackPurchase((null===(v=t.paymentData)||void 0===v||null===(v=v.Product)||void 0===v?void 0:v.price)||0,"USD",d)}catch(t){console.error("Facebook转化API调用失败:",t)}}window.uetq&&(console.log("bing执行付费上报！！"),t.$bing_tracking.trackEvent({eve:"Subscribe Now",otherParams:{currency:"USD",revenue_value:(null===(r=t.paymentData)||void 0===r||null===(r=r.Product)||void 0===r?void 0:r.price)||0}}));Object(h.a)("checkout",{value:(null===(n=t.paymentData)||void 0===n||null===(n=n.Product)||void 0===n?void 0:n.price)||0,currency:"USD"}),t.$yandexMetrika.purchase((null===(o=t.paymentData)||void 0===o||null===(o=o.Product)||void 0===o?void 0:o.price)||0)}))},beforeDestroy:function(){this.$EventBus.$off("openPaymentStatusDialog2"),this.confettiTimer&&(clearTimeout(this.confettiTimer),this.confettiTimer=null),d.a.reset()},computed:f(f({},Object(r.c)("user",["userInfo"])),{},{getExpiryTime:function(){return Object(l.i)(this.paymentData.payment_at,"yyyy-MM-dd hh:mm:ss")},getVIPCardName:function(){var t;return this.$t(this.isLite?"vip_lite_card_name":"vip_card_name",{number:null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.day_num})},getSVIPCardName:function(){var t=this;return function(e){var n=e.Product,o=n.level,r=n.type,l=2===r?"months":4===r?"week":"years";return"".concat(t.$t(["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][o-1])," /\n\t\t\t\t").concat(t.$t(l))}},getPhotoName:function(){if(this.isPhoto){var t,e=((null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.cp_product_id)||"").slice(-2);return this.$t("aiAvatarNumber",{num:e})}return""},isLite:function(){var t;return null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t||null===(t=t.cp_product_id)||void 0===t?void 0:t.includes("lite")},isPhoto:function(){var t;return null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.cp_product_id.includes("ai_photo")},getPrice:function(){var t;if(null!==(t=this.paymentData)&&void 0!==t&&null!==(t=t.Product)&&void 0!==t&&t.local_price_web){var e,n,o,r=null===(e=this.paymentData)||void 0===e?void 0:e.Product;return(null==r||null===(n=r.local_price_web)||void 0===n?void 0:n.currency)+(null==r||null===(o=r.local_price_web)||void 0===o?void 0:o.price)}return""}}),methods:{close:function(){this.isShowDialog=!1,this.paymentData={}},handleDone:function(){this.isShowDialog=!1},playConfettiAnimation:function(){var t=this;this.confettiCount=0,this.confettiTimer&&(clearTimeout(this.confettiTimer),this.confettiTimer=null);var e=document.querySelector(".payment-status-dialog2 .el-dialog");if(e){var n=e.getBoundingClientRect(),o=window.innerHeight,r=window.innerWidth,l=n.top/o,c=n.left/r,h=(n.left+n.width)/r,v=function e(){if(t.confettiCount>=5||!t.isShowDialog)t.confettiTimer=null;else{var n=function(t,e){return Math.random()*(e-t)+t};Object(d.a)({particleCount:n(50,100),angle:n(55,125),spread:n(50,70),origin:{y:Math.max(.25,l+.1),x:n(c+.1,h-.1)},colors:["#FF5252","#FFD740","#40C4FF","#69F0AE","#FF4081","#7C4DFF"],startVelocity:n(25,45),gravity:1.2,ticks:400,shapes:["circle","square"],zIndex:9999,disableForReducedMotion:!0}),t.confettiCount++;var o=n(200,500);t.confettiTimer=setTimeout(e,o)}};v(),setTimeout((function(){t.isShowDialog&&t.confettiCount<5&&v()}),50),setTimeout((function(){t.isShowDialog&&t.confettiCount<5&&v()}),100)}}}},_=(n(5490),n(0)),component=Object(_.a)(m,(function(){var t,e,o,r,l,c=this,d=c._self._c;return d("el-dialog",{staticClass:"payment-status-dialog2",attrs:{top:"calc(50vh - 168px)",width:"350px",visible:c.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!1,modal:!1},on:{"update:visible":function(t){c.isShowDialog=t},closed:c.close}},[null!==(t=c.paymentData)&&void 0!==t&&t.is_paid?d("div",{staticClass:"confetti-container"}):c._e(),c._v(" "),d("div",{staticClass:"payment-status-dialog2-container"},[null!==(e=c.paymentData)&&void 0!==e&&e.is_paid?d("div",{staticClass:"ribbon-decoration"},[d("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250218/d24155c9-5b89-40ad-93dc-fa2a8a4491a4.png",alt:"ribbon"}})]):c._e(),c._v(" "),null!==(o=c.paymentData)&&void 0!==o&&o.is_paid?d("div",{staticClass:"celebration-icon"},[d("img",{attrs:{src:n(541),alt:"celebrate"}})]):c._e(),c._v(" "),null!==(r=c.paymentData)&&void 0!==r&&r.Product?d("div",{staticClass:"finish"},[d("div",{staticClass:"tip"},[c._v(c._s(c.$t("PaymentSuccessful"))+" !")]),c._v(" "),d("div",{staticClass:"name"},[5===c.paymentData.Product.type?d("div",{staticClass:"vipcard detail-div"},[c._v("\n          "+c._s(c.getVIPCardName)+"\n          "),d("img",{staticClass:"icon",attrs:{src:n(754),alt:"vip icon"}})]):[2,3,4].includes(c.paymentData.Product.type)?d("div",{staticClass:"svip-text"},[c._v("SVIP")]):c.isPhoto?d("div",{staticClass:"photo"},[c._v("\n          "+c._s(c.getPhotoName)+"\n        ")]):0===(null===(l=c.paymentData)||void 0===l||null===(l=l.Product)||void 0===l?void 0:l.type)?d("div",{staticClass:"game"}):d("div",{staticClass:"credits detail-div"},[c._v("\n          "+c._s(c.paymentData.Product.calculate_coins)+"\n          "),d("img",{staticClass:"icon",attrs:{src:n(169),alt:"credits icon"}})])]),c._v(" "),d("div",{staticClass:"content"},[d("div",{staticClass:"item-content total"},[d("div",{staticClass:"label"},[c._v(c._s(c.$t("Total"))+":")]),c._v(" "),d("div",{staticClass:"detail"},[c._v("\n            "+c._s(c.getPrice)+"\n            "),[2,3,4].includes(c.paymentData.Product.type)?d("span",{staticClass:"type"},[c._v("\n              "+c._s(c.getSVIPCardName(c.paymentData))+"\n            ")]):c.isPhoto?d("span",{staticClass:"type"},[c._v("\n              "+c._s(c.getPhotoName)+"\n            ")]):c._e()])]),c._v(" "),d("div",{staticClass:"item-content order-number"},[d("div",{staticClass:"label"},[c._v(c._s(c.$t("OrderNumber"))+":")]),c._v(" "),d("div",{staticClass:"detail"},[c._v("\n            "+c._s(c.paymentData.order_no)+"\n          ")])]),c._v(" "),d("div",{staticClass:"item-content payment-time"},[d("div",{staticClass:"label"},[c._v(c._s(c.$t("PaymentTime"))+":")]),c._v(" "),d("div",{staticClass:"detail"},[c._v("\n            "+c._s(c.getExpiryTime)+"\n          ")])])]),c._v(" "),d("el-button",{staticClass:"done-btn",on:{click:c.handleDone}},[c._v("\n        "+c._s(c.$t("Done"))+"\n      ")])],1):c._e()])])}),[],!1,null,null,null);e.default=component.exports},3438:function(t,e,n){"use strict";n.r(e);n(16),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(18),n(21),n(26),n(1)),c=n(87),d=n(300);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"PaymentCheck",props:{activeMethod:{type:Object,default:function(){return{}}},thirdOrderId:{type:String,default:""}},computed:v(v({},Object(l.e)("user",["userInfo"])),{},{getName:function(){var t,e=(null===(t=this.activeMethod)||void 0===t?void 0:t.name)||"";return"onerway"==e&&(e="Credit Card"),this.$t(e)},isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")}}),data:function(){return{intervalId:null,loading:!1,defaultOptions:{animationData:d}}},beforeDestroy:function(){this.intervalId&&this.stopPoll()},methods:v(v({},Object(l.b)("payment",["getPaymentInfo"])),{},{pollGetPaymentStatus:function(t){var e=this;this.thirdOrderId&&t&&(this.intervalId=setInterval(Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.getPaymentOnce(t);case 1:case"end":return n.stop()}}),n)}))),3e3))},getPaymentOnce:function(t){var e=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,l,data;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]&&e[1],!n.loading){o.next=3;break}return o.abrupt("return");case 3:return n.loading=!0,o.prev=4,o.next=7,Object(c.j)({third_type:t,order_id:n.thirdOrderId});case 7:l=o.sent,n.loading=!1,null!=(data=l.data)&&data.is_paid?(n.paySuccess(),n.$EventBus.$emit("openPaymentStatusDialog2",{data:data}),n.isYahoo,localStorage.setItem("getRewards",JSON.stringify({dueTime:0}))):r&&n.$message.info(n.$t("paymentWaitTxt")),o.next=19;break;case 13:o.prev=13,o.t0=o.catch(4),n.loading=!1,n.stopPoll(),n.$emit("paymentError",{type:t}),console.log("error",o.t0);case 19:case"end":return o.stop()}}),o,null,[[4,13]])})))()},handleCancel:function(){this.loading||this.$emit("back")},paySuccess:function(){var t=this,e=setTimeout((function(){t.getPaymentInfo(),clearTimeout(e)}),1e3);this.$emit("success")},stopPoll:function(){clearInterval(this.intervalId)}})},m=f,_=(n(5580),n(0)),component=Object(_.a)(m,(function(){var t,e,o,r,l,c,d=this,h=d._self._c;return h("div",{staticClass:"wait-payment-content flex-center"},[h("div",{staticClass:"wait-payment"},[d.loading?h("lottie",{staticClass:"loading-anime",attrs:{options:d.defaultOptions,height:110,width:110}}):d._e(),d._v(" "),null!==(t=d.activeMethod)&&void 0!==t&&t.icon?h("div",{staticClass:"wait-icon"},[h("img",{attrs:{src:n(499)("./".concat(null===(e=d.activeMethod)||void 0===e?void 0:e.icon)),alt:(null===(o=d.activeMethod)||void 0===o?void 0:o.icon)||"img-cover",loading:"lazy"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})]):d._e(),d._v(" "),h("div",{staticClass:"wait-method"},[d._v(d._s(d.$t("waitMethod",{method:d.getName})))]),d._v(" "),[9,12].includes(null===(r=d.activeMethod)||void 0===r?void 0:r.type)?[h("div",{staticClass:"wait-title"},[d._v("\n        "+d._s(d.$t("waitPayTxt2",{btn:d.$t("Done")}))+"\n      ")])]:[h("div",{staticClass:"wait-title"},[d._v("\n        "+d._s(d.$t("waitPayPls",{type:d.$t(null===(l=d.activeMethod)||void 0===l?void 0:l.i18n)}))+"\n      ")]),d._v(" "),h("div",{staticClass:"wait-payment-txt"},[d._v("\n        "+d._s(d.$t("waitPayTxt",{btn:d.$t("Done")}))+"\n      ")])],d._v(" "),h("div",{staticClass:"btns flex justify-center"},[9!==(null===(c=d.activeMethod)||void 0===c?void 0:c.type)?h("el-button",{staticClass:"btn-cancel btn",on:{click:d.handleCancel}},[d._v(d._s(d.$t("Cancel")))]):d._e(),d._v(" "),h("el-button",{staticClass:"btn-done btn",attrs:{type:"primary"},on:{click:function(t){var e;return d.getPaymentOnce(null===(e=d.activeMethod)||void 0===e?void 0:e.type,!0)}}},[d._v(d._s(d.$t("Done")))])],1)],2)])}),[],!1,null,"8f791420",null);e.default=component.exports},3439:function(t,e,n){"use strict";n(4);var o={name:"creaCharacterConfirmModal",data:function(){return{visible:!1,options:null,resolve:null,reject:null}},methods:{show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.resetData(),this.options=e,this.visible=!0,new Promise((function(e,n){t.resolve=e,t.reject=n}))},resetData:function(){this.options=null,this.resolve=null,this.reject=null},handleClose:function(){if(this.visible=!1,this.reject)return this.reject(!1)},handleConfirm:function(){if(this.visible=!1,this.resolve)return this.resolve(!0)}}},r=o,l=(n(5154),n(0)),component=Object(l.a)(r,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:n.visible,"custom-class":"easy-common-confirm-modal custom-dialog","destroy-on-close":!1,modal:!1,"modal-append-to-body":"","append-to-body":""},on:{"update:visible":function(t){n.visible=t}}},[o("div",{staticClass:"easy-select-model-confirm-modal-header"},[o("div",{staticClass:"modal-header-title"},[n._v(n._s(n.$t("Tip")))]),n._v(" "),o("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),n.handleClose()}}},[o("i",{staticClass:"el-icon-close"})])]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-content"},[o("div",{staticClass:"modal-content-left"},[o("div",{staticClass:"warning-icon-box"},[o("i",{staticClass:"iconfont icon-warn"})])]),n._v(" "),o("div",{staticClass:"modal-content-right"},[o("div",{staticClass:"modal-content-right-title"},[n._v(n._s(n.$t("createCharacterTip")))]),n._v(" "),null!==(t=n.options)&&void 0!==t&&t.subTitle?[Array.isArray(n.options.subTitle)?n._l(n.options.subTitle,(function(t,e){return o("div",{key:e,staticClass:"modal-content-right-sub-title",domProps:{innerHTML:n._s(t)}})})):[o("div",{staticClass:"modal-content-right-sub-title"},[n._v("\n            "+n._s(null===(e=n.options)||void 0===e?void 0:e.subTitle)+"\n          ")])]]:n._e()],2)]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-footer"},[o("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),n.handleConfirm()}}},[n._v(n._s(n.$t("Confirm")))])])])}),[],!1,null,"c2f73bb8",null);e.a=component.exports},366:function(t,e,n){"use strict";n(19),n(16),n(31),n(18),n(21),n(11),n(12),n(13);var o=n(14),r=n(2),l=(n(6),n(32),n(398),n(22),n(49),n(399),n(8),n(4),n(378),n(7),n(56)),c=n(27),d=n(1),h=n(10),v=n(25),f=n(29),m=n(63),_=n(45),y=n(138),w=n(253),C=n(52),k=n(9),O=n(71),x=n(239),T=void 0;function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P={name:"workflowStyleModal",mixins:[_.a],components:{CollectPopover:m.default,modelPayNum:y.default,changeVer:w.default,SwipeableList:C.default,LenovoInput:x.default},props:{selectList:{type:Array,default:function(){return[]}},placeholder:{type:String,default:function(){return null==T?void 0:T.$t("TaskStylePlaceHolder")}},isPaintingBoard:{type:Boolean,default:!1},isSDXL:{type:Boolean,default:!1},SDXLmodel:{type:Array,default:function(){return null}},SDmodel:{type:Array,default:function(){return null}},inTask:{type:Boolean,default:!0}},data:function(){return{visible:!1,activeTab:"mine",timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:this.getTimestamps().startTimestamp,endTime:this.getTimestamps().endTimestamp},{name:"week",startTime:this.getWeekTimeRange().startTimestamp,endTime:this.getWeekTimeRange().endTimestamp},{name:"months",startTime:this.getMonthTimestampRange().startTimestamp,endTime:this.getMonthTimestampRange().endTimestamp}],tagIndex:"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],tabList:[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],queryOptionsList:[{label:"综合推荐",value:"comprehensive",order:1,i18nKey:"styleModal1"},{label:"最近使用",value:"recent",order:2,i18nKey:"recentlyUsed"},{label:"我的收藏",value:"collect",order:3,i18nKey:"MyCollection"},{label:"我的模型",value:"bookmarks_choose",order:4,i18nKey:"MyModel"},{label:"更多推荐",value:"recommend",order:5,i18nKey:"FindGoodPictures"}],queryParam:{order_by:"hot",keyword:"",created:"",model_type:"LORA"},list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,limit:60,total:0},debounceHandleScroll:null,gridNum:5,modalWidth:"1340px",debounceResize:null,showType:"",modelOption:[],itemScroll:null,modelType:"LORA",comfyUiNode:null,queryType:"comprehensive",baseModelSelect:[],modelTypes:["Checkpoint","LoRA"],tabShowTagEmpty:!1,showTagEmpty:!1,keyWordCopy:"",baseModels:[],baseModelMap:{}}},computed:D(D(D({},Object(d.e)("user",["collectData","cdnHost","token"])),{},{showEmptyResult:function(){var t=!this.loading,e=!this.renderList.length&&!this.hotRecentUsedList.length,n="mine"===this.activeTab&&!["comprehensive"].includes(this.queryType);return t&&e&&n},lang:function(){return this.$i18n.locale},renderBaseModels:function(){},getTitle:function(){var t={Checkpoint:"Checkpoint",LORA:"LoRA",TextualInversion:this.$t("embedding1")}[this.modelType]||this.modelType;return"".concat(this.$t("selectModels"),"(").concat(t,")")},getModels:function(){var t=k.L.sd,e=k.L.sd3,n=k.L.sd35,r=k.L.sdxl,l=k.L.flux,c=[].concat(Object(o.a)(t),Object(o.a)(e),Object(o.a)(n),Object(o.a)(r),Object(o.a)(l));return{sd:this.SDmodel||t,sd35:n,sd3:e,sdxl:this.SDXLmodel||r,allBaseModels:c}},getBaseModel:function(){return this.baseModels},showRecommendText:function(){return!this.loading&&this.hotUsedList.length&&"mine"===this.activeTab&&"comprehensive"===this.queryType},isNoRecentUsed:function(){return!this.loading&&!this.renderList.length&&"recent"===this.queryType&&this.showRecommendText},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},activeTabClass:function(){return function(t){return t&&t===this.activeTab?"tab-active":""}}},Object(d.c)(["isSupportWebp"])),{},{getImageUrl:function(){return function(t){var e="";return t.banner&&!["",null,void 0].includes(t.banner.url)?e=Object(h.K)(t.banner.url,this.$imgL):e}},activeSelectModel:function(){return function(t){return this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}))?"select-model-active":""}},renderList:function(){return this.list},hotUsedList:function(){return this.hotRecentUsedList},convertTabText:function(){return function(t){var e="LORA"===this.modelType?"MyStyle":"MyModel";return t.title?t.title:"bookmarks_choose"===t.type?this.$t(e):this.$t(t.i18nKey)}}}),beforeDestroy:function(){this.debounceHandleScroll=null},watch:{hotRecentUsedList:{handler:function(t){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.hotRecentUsedList[i].id&&this.selectList[e].art_model_ver_no_name&&this.hotRecentUsedList[i].version_name){this.hotRecentUsedList[i].version_name=this.selectList[e].art_model_ver_no_name,this.hotRecentUsedList[i].banner.url=this.selectList[e].model_cover;break}}},list:{handler:function(t){for(var i=0;i<this.list.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.list[i].id&&this.selectList[e].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[e].art_model_ver_no_name,this.list[i].banner.url=this.selectList[e].model_cover;break}}}},mounted:function(){var t=this;this.debounceHandleScroll=Object(v.debounce)(this.handleScroll,600),this.debounceResize=Object(v.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){t.handleResize()})),this.getBaseModels()},methods:{getBaseModels:function(){var t=this;Object(O.a)({scene:7}).then((function(e){var n;1e4===e.status.code&&(t.baseModels=(null===(n=e.data)||void 0===n||null===(n=n.base_model_select_options)||void 0===n?void 0:n.map((function(e){return t.baseModelMap[e.val]=e.vals||[],e.val})))||[])}))},onFilter:function(t,e){var n=this;this.loading||(this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"===this.queryType&&(this.tagIndex="hot"),this.checkGetList())},onFilterReset:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.$logEvent("log_actions",{operation:"click_choose_model_type",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}),this.baseModelSelect=[],t||this.checkGetList())},changeQueryType:function(){this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"click_comprehensive_recommendation_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"})},checkGetList:function(){"comprehensive"!==this.queryType?"recent"===this.queryType?this.handleGetRecentUsed():this.handleSearch():this.handleGetComList()},handleGetComList:function(){var t=this;this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to");var e={},n=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel;return n.length&&(n=n.flatMap((function(e){var n;return[e].concat(Object(o.a)((null===(n=t.baseModelMap)||void 0===n?void 0:n[e])||[]))}))),e.base_models=n,e.model_type=this.modelType||"LORA",this.loading=!0,Object(f.getModelComprehensive)(e).then((function(e){var n=e||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var l=Array.isArray(null==data?void 0:data.hot_used_items)?data.hot_used_items:[],c=Array.isArray(null==data?void 0:data.items)?data.items:[];t.noMore=!0;var d={},h=(c||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return d[e.id]||(d[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}));t.list=h.length<=10?h:h.slice(0,10),t.hotRecentUsedList=(l||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return d[e.id]||(d[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType})).map((function(e){var n,o=(e.banner||{}).nsfw;[1,"1"].includes(void 0===o?0:o)&&(e.banner=Object.assign((null===(n=e)||void 0===n?void 0:n.banner)||{},{url:t.nsfwUrl}));var r=t.findSelectItem(e);return r&&(e=Object.assign(e,r)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.tagIndex==n.id&&(e=n.icon)})),e},handleCommand:function(t){this.tagIndex=t,this.queryParam.order_by=this.tagIndex,this.handleSearch()},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.start_at=t.startTime,this.queryParam.end_at=t.endTime,this.handleSearch()},getTimestamps:function(){var t=new Date;return{startTimestamp:t-864e5,endTimestamp:t.getTime()}},getWeekTimeRange:function(){var t=new Date;return{startTimestamp:t-6048e5,endTimestamp:t.getTime()}},getMonthTimestampRange:function(){var t=new Date;t.getFullYear(),t.getMonth();return{startTimestamp:t-2592e6,endTimestamp:t.getTime()}},changeScroll:function(){var t=this;this.$refs.listItem.forEach((function(e,n){e.classList.contains("tab-active")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))},getTag:function(){var t=this;Object(O.d)({show_area:"model"}).then((function(e){if(1e4===e.status.code){var n=e.data||[];n.length&&n.forEach((function(e){e.title=e[k.r[t.$i18n.locale]]})),t.tabList=[].concat(Object(o.a)(t.tabList),Object(o.a)(n))}}))},collectionBar:function(){var t=this;Object(c.J)({type:2}).then((function(e){1e4===e.status.code&&(t.modelOption=[{label:t.$t("All"),value:""}],e.data.items.forEach((function(e){t.modelOption.push({label:e.name,value:e.id})})))}))},changeType:function(t){this.list=[],this.pageInfo={page:1,limit:60,total:0},this.handleSearch()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1340px",this.gridNum=5):(this.modalWidth="1071px",this.gridNum=4)}catch(t){}},selectItem:function(t,e,n){var o,r;(e.model_ver_no=t.model_ver_id,e.version_name=t.version_no,e.base_model=t.base_model_name,e.modelTags=Array.isArray(null==t?void 0:t.tags)?null==t?void 0:t.tags:[],null!==(o=t.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?e.banner.url=null===(r=t.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url:e.banner.url="";n&&this.$emit("selectModel",e)},openModal:function(t){var e=this,n=t.modelType,o=void 0===n?"LORA":n,r=t.node,l=void 0===r?null:r,c=t.pickWidget,d=void 0===c?null:c;if(this.resetData(),this.comfyUiNode=l,this.modelType=o,this.pickWidget=d,this.token&&this.collectionBar(),this.queryParam.model_type=this.modelType||"",this.tabList=[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],this.activeTab="mine",this.queryType="comprehensive",this.getTag(),!this.token)return this.getList(),void(this.visible=!0);this.$nextTick((function(){e.getRecentUsedModel().finally((function(){e.loading=!1,e.list.length&&e.list.length>=10?(e.activeTab="mine",e.queryType="recent"):(e.activeTab="mine",e.queryType="comprehensive",e.hotRecentUsedList=[],e.checkGetList())})),e.visible=!0}))},handleClose:function(){this.visible=!1,this.resetData()},resetData:function(){this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.list=[],this.activeTab="mine",this.queryType="comprehensive",this.loading=!1,this.noMore=!1,this.modelType="LORA"},handleViewMore:function(){this.activeTab="",this.handleTabClick("mine","recommend")},handleTabClick:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t===this.activeTab||this.loading||(this.activeTab=t,this.queryType="mine"===t?n||"comprehensive":"recommend",this.$nextTick((function(){e.changeScroll()})),this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"click_choose_model_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}))},screenAll:function(){this.activeTab="mine",this.baseModelSelect=[],this.modelTypeSelect=[],this.queryParam.order_by="hot",this.queryParam.created="",this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.$logEvent("log_actions",{operation:"click_search",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}),this.handleSearch()},handleSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.list=[],this.hotRecentUsedList=[],Reflect.deleteProperty(this.queryParam,"time_to"),"recent"===this.queryType&&(this.queryType="recommend"),"comprehensive"===this.queryType&&(this.queryType="recommend"),this.getList(),"dot"===t&&this.$logEvent("log_actions",{operation:"click_choose_model_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"})},handleScroll:function(){var t=this.$refs.scrollWrapper;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-30&&"recent"!==this.queryType&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n={collect:"bookmarks",recommend:"community",bookmarks_choose:"bookmarks_choose"}[JSON.parse(JSON.stringify(this.queryType))]||"",o={page:this.pageInfo.page,page_size:this.pageInfo.limit,type:n};if(this.inTask&&(o.refer="task"),"bookmarks"===o.type){var r=0;o.folder_no=this.showType;try{var c,d=this.list.length?this.list[this.list.length-1]:null;r=(null==d||null===(c=d.collect)||void 0===c?void 0:c.collect_at)||0,o.after=1===o.page?0:r}catch(t){}}["recent","collect","bookmarks","bookmarks_choose","recommend","comprehensive","mine"].includes(this.activeTab)||(o.tags=[this.activeTab],o.type="community"),o.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,Object.assign(o,this.queryParam),(""!==this.queryParam.keyword&&"recommend"===this.queryType?l.q:l.s)(o).then((function(n){var o=n||{},r=o.status,l=void 0===r?{}:r,c=o.data,data=void 0===c?{}:c,d=l.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(e.noMore=!data.has_more,t){var h=e.list.map((function(t){return t.id})),v=(n.data.items||[]).filter((function(t){return!h.includes(t.id)})).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));e.list=e.list.concat(v)}else e.list=(n.data.items||[]).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));1===e.pageInfo.page&&(e.queryParam.time_to=n.data.time_ms),e.pageInfo.page++,e.loading=!1,e.keyWordCopy=e.queryParam.keyword,e.noDataView()}})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))}},noDataView:function(){var t=!this.loading,e=!this.list.length,n="mine"!==this.activeTab,o=""===this.queryParam.keyword,r=t&&e&&n&&o,l=t&&e&&n&&!o;this.tabShowTagEmpty=r,this.showTagEmpty=l},findSelectItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(t)){var e=this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}));return t=e||t}return null},handleSelect:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(["cltpop","use"].includes(null===(t=(arguments.length>2?arguments[2]:void 0).target)||void 0===t?void 0:t.className)){if(n)return void this.$message.warning(this.$t("CannotSelectedRepeatedly"));this.$emit("selectModel",{info:e,node:this.comfyUiNode,modelType:this.modelType,pickWidget:this.pickWidget}),this.handleClose()}},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getRecentUsedModel()},getRecentUsedModel:function(){var t=this,e={};return e.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,"TextualInversion"===this.modelType&&(e.model_type="TextualInversion"),this.loading=!0,Object(f.getRecentUsed)(e).then((function(e){console.log(e);var n=e||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var l=Array.isArray(data.items)?data.items:[],c={};t.list=(l||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return c[e.id]||(c[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType&&"f8172af6747ec762bcf847bd60fdf7cd"!==(null==e?void 0:e.id)})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},handleDetail:function(t){(null==t?void 0:t.id)&&window.open(this.localePath("/models/detail/".concat(t.id)),"_blank")},convertModelFlag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getModels.sdxl,n=(this.getModels.sd,this.getModels.sd3),o=(null===k.L||void 0===k.L?void 0:k.L.flux)||[],r=(t.type,t.base_model),l=void 0===r?"":r,c=e.includes(l)||(l||"").includes("SDXL"),d=n.includes(l);return o.includes(l)?"Flux":d?"SD3":c?"SDXL":""}}},I=P,$=(n(4341),n(4342),n(0)),component=Object($.a)(I,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{ref:"styleModal",attrs:{title:n.getTitle,visible:n.visible,width:n.modalWidth,height:"auto","custom-class":"c-workflow-style-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":!0,center:""},on:{"update:visible":function(t){n.visible=t},close:function(t){return n.onFilterReset(!0)}}},[o("div",{staticClass:"style-content-wrapper"},[o("div",{staticClass:"style-content__header"},[o("swipeable-list",{attrs:{scrollChange:n.itemScroll,top:"15px"}},[o("div",{staticClass:"style-content__header-tabs"},n._l(n.tabList,(function(t,e){return o("div",{key:"tab_".concat(null==t?void 0:t.id,"_").concat(e)},[o("div",{ref:"listItem",refInFor:!0,staticClass:"style-content__header-tabs-item",class:[n.activeTabClass(t.id)],on:{click:function(e){return e.stopPropagation(),n.handleTabClick(t.id)}}},[n._v("\n              "+n._s(n.convertTabText(t))+"\n            ")])])})),0)])],1),n._v(" "),o("div",{staticClass:"style-content__search-box"},[o("div",[n._e(),n._v(" "),o("LenovoInput",{attrs:{width:404,screen:{activeTab:n.activeTab,baseModelSelect:n.baseModelSelect.length?n.baseModelSelect:n.getBaseModel,modelType:n.modelType},isLoca:"creative",clearable:"",placeholder:"LORA"===n.modelType?n.$t("TaskStylePlaceHolder"):n.$t("TaskModelPlaceHolder")},on:{onScreen:function(t){return n.handleSearch("dot")},clear:function(t){return n.handleSearch("dot")}},model:{value:n.queryParam.keyword,callback:function(t){n.$set(n.queryParam,"keyword",t)},expression:"queryParam.keyword"}}),n._v(" "),o("span",{staticClass:"style-content__search-btn style-content__search-btn-gra-border",on:{click:function(){return""!=n.queryParam.keyword&&n.handleSearch("dot")}}},[o("span",[n._v(n._s(n.$t("Search")))])])],1),n._v(" "),o("div",{staticClass:"search-right"},[o("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[o("div",{staticClass:"filterCnt"},[o("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[n._v(n._s(n.$t("BaseModel")))]),n._v(" "),o("div",{staticClass:"filterList"},n._l(n.getBaseModel,(function(t,e){return o("div",{key:e,staticClass:"filterItem",class:{AfilterItem:n.baseModelSelect.includes(t)},on:{click:function(e){return n.onFilter(t,2)}}},[n.baseModelSelect.includes(t)?o("i",{staticClass:"el-icon-check"}):n._e(),n._v(" "),o("span",[n._v(n._s("TextualInversion"===t?n.$t("embedding1"):t))])])})),0),n._v(" "),o("div",{staticClass:"filterReset graBorder",on:{click:function(t){return n.onFilterReset(!1)}}},[n._v("\n              "+n._s(n.$t("resetSelection"))+"\n            ")])]),n._v(" "),o("el-badge",{staticClass:"item",attrs:{slot:"reference",value:null===(t=n.baseModelSelect)||void 0===t?void 0:t.length,hidden:0==(null===(e=n.baseModelSelect)||void 0===e?void 0:e.length)},slot:"reference"},[o("div",{staticClass:"filterBox"},[o("div",[o("i",{staticClass:"iconfont icon-a-filterIcon"}),n._v(" "),o("span",[n._v(n._s(n.$t("Filter")))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})])])],1),n._v(" "),"mine"===n.activeTab&&"collect"===n.queryType&&n.modelOption.length>0?o("el-select",{staticClass:"showType custom-select",class:n.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:n.changeType},model:{value:n.showType,callback:function(t){n.showType=t},expression:"showType"}},n._l(n.modelOption,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1):n._e(),n._v(" "),"mine"===n.activeTab?o("el-select",{staticClass:"showType custom-select",class:n.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:n.changeQueryType},model:{value:n.queryType,callback:function(t){n.queryType=t},expression:"queryType"}},n._l(n.queryOptionsList,(function(t){return o("el-option",{key:t.value,attrs:{label:n.$t(t.i18nKey),value:t.value}})})),1):n._e(),n._v(" "),["recent","collect","bookmarks","bookmarks_choose","recommend","mine"].includes(n.activeTab)?n._e():o("div",{staticClass:"Screening"},[o("el-dropdown",{attrs:{trigger:"hover"},on:{command:n.handleTimeCommand}},[o("div",{staticClass:"el-dropdown-link selectTime"},[o("div",[o("i",{staticClass:"el-icon-time"}),n._v(" "),o("span",[n._v(n._s(n.$t(n.timeName)))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.timeTypeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t}},[o("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1),n._v(" "),o("el-dropdown",{attrs:{trigger:"hover"},on:{command:n.handleCommand}},[o("div",{staticClass:"el-dropdown-link"},[o("div",[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(n.setIcon())}),n._v(" "),o("span",[n._v(n._s(n.$t(n.tagIndex.charAt(0).toUpperCase()+n.tagIndex.slice(1))))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.typeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t.id}},[o("div",{staticClass:"el-dropdown-item"},[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),n._v(" "),o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1)],1)],1)]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"style-content__list-wrapper",class:[n.isNoRecentUsed?"style-content__list-wrapper-no-margin":""],style:{gridTemplateColumns:"repeat(".concat(n.gridNum,", 1fr)")},on:{scroll:n.handleScroll}},[n.renderList.length?n._l(n.renderList,(function(t){var e;return o("div",{key:t.id,staticClass:"style-content__list-item",class:[n.activeSelectModel(t)],on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[o("div",{staticClass:"top-box"},[t.is_agency_fee?o("div",{staticClass:"payNum"},[o("modelPayNum",{attrs:{number:t.agency_fee}})],1):n._e()]),n._v(" "),o("div",{staticClass:"cltpop"},[o("div",{staticClass:"collect-popover-container"},[o("CollectPopover",{attrs:{type:"model",folder:t,from:"waterfall"}})],1),n._v(" "),o("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),n.handleDetail(t)}}},[n._v("\n              "+n._s(n.$t("Details"))+"\n            ")])]),n._v(" "),o("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==t||null===(e=t.banner)||void 0===e?void 0:e.url)?o("div",{staticClass:"list-item-image-card-image"},[o("div",{staticClass:"image-empty"},[n._v(n._s(n.$t("EmptyBannerText")))])]):o("el-image",{staticClass:"list-item-image-card-image",attrs:{src:n.getImageUrl(t)}},[o("template",{slot:"error"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:t&&t.banner?t.banner.url:"",alt:""}})])],2)],1),n._v(" "),o("div",{staticClass:"list-item-image-mask"},[o("div",{staticClass:"list-item-image-mask-row"},[o("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:t.name}},[n._v(n._s(t.name))])]),n._v(" "),o("div",{staticClass:"list-item-image-mask-row"},[o("changeVer",{attrs:{from:"styleModal",item:t,base_models:n.getBaseModel},on:{selectItem:function(e){return n.selectItem(e,t,n.activeSelectModel(t))}}}),n._v(" "),o("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[n._v("\n                "+n._s(n.$t("workFlow46"))+"\n              ")])],1)]),n._v(" "),"Pony"===(null==t?void 0:t.base_model)?[o("span",{staticClass:"model-type-flag"},[n._v("\n              "+n._s("TextualInversion"===n.modelType?n.$t("embedding1"):n.modelType)),o("span",{staticClass:"model-type-flag-line"},[n._v("|")]),o("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[o("span",{directives:[{name:"show",rawName:"v-show",value:""!==n.convertModelFlag(t),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[n._v(n._s(n.convertModelFlag(t)))])]],2)})):n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showRecommendText,expression:"showRecommendText"}],staticClass:"recommend-text",style:{gridColumn:"span ".concat(n.gridNum)}},[o("div",{staticClass:"recommend-text-line"}),n._v(" "),o("div",{staticClass:"recommend-text-main"},[n._v(n._s(n.$t("styleModalLineText")))]),n._v(" "),o("div",{staticClass:"recommend-text-line"})]),n._v(" "),!n.loading&&n.hotUsedList.length&&"mine"===n.activeTab&&["comprehensive"].includes(n.queryType)?[n._l(n.hotUsedList,(function(t){var e;return o("div",{key:"hot_".concat(t.id),staticClass:"style-content__list-item",class:[n.activeSelectModel(t)],on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[o("div",{staticClass:"top-box"},[t.is_agency_fee?o("div",{staticClass:"payNum",attrs:{num:""}},[o("modelPayNum",{attrs:{number:t.agency_fee}})],1):n._e()]),n._v(" "),o("div",{staticClass:"cltpop"},[o("div",{staticClass:"collect-popover-container"},[o("CollectPopover",{attrs:{type:"model",folder:t,from:"waterfall"}})],1),n._v(" "),o("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),n.handleDetail(t)}}},[n._v("\n              "+n._s(n.$t("Details"))+"\n            ")])]),n._v(" "),o("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==t||null===(e=t.banner)||void 0===e?void 0:e.url)?o("div",{staticClass:"list-item-image-card-image"},[o("div",{staticClass:"image-empty"},[n._v(n._s(n.$t("EmptyBannerText")))])]):o("el-image",{staticClass:"list-item-image-card-image",attrs:{src:n.getImageUrl(t)}},[o("template",{slot:"error"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:t&&t.banner?t.banner.url:"",alt:""}})])],2),n._v(" "),o("div",{staticClass:"list-item-image-mask"},[o("div",{staticClass:"list-item-image-mask-row"},[o("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:t.name}},[n._v(n._s(t.name))])]),n._v(" "),o("div",{staticClass:"list-item-image-mask-row"},[o("changeVer",{attrs:{item:t,base_models:n.getBaseModel},on:{selectItem:function(e){return n.selectItem(e,t,n.activeSelectModel(t))}}}),n._v(" "),o("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[n._v("\n                  "+n._s(n.$t("workFlow46"))+"\n                ")])],1)])],1),n._v(" "),"Pony"===(null==t?void 0:t.base_model)?[o("span",{staticClass:"model-type-flag"},[n._v("\n              "+n._s("TextualInversion"===n.modelType?n.$t("embedding1"):n.modelType)),o("span",{staticClass:"model-type-flag-line"},[n._v("|")]),o("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[o("span",{directives:[{name:"show",rawName:"v-show",value:""!==n.convertModelFlag(t),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[n._v(n._s(n.convertModelFlag(t)))])]],2)})),n._v(" "),o("div",{staticClass:"show-more-item",style:{gridColumn:"span ".concat(n.gridNum)}},[o("span",{staticClass:"show-more-item-btn",on:{click:function(t){return t.stopPropagation(),n.handleViewMore()}}},[o("span",{staticClass:"show-more-item-btn-text"},[n._v(n._s(n.$t("viewMore")))]),n._v(" "),o("i",{staticClass:"iconfont icon-icon-direction-down show-more-item-btn-icon"})])])]:n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),"LORA"===n.modelType&&"mine"===n.activeTab&&["recent"].includes(n.queryType)&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n          "+n._s(n.$t("styleRecent"))+"\n        ")]:"LORA"===n.modelType&&["collect"].includes(n.queryType)&&"mine"===n.activeTab&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n          "+n._s(n.$t("styleCollect"))+"\n        ")]:[n._v(n._s(n.$t("NoResultsFound")))]],2),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showTagEmpty,expression:"showTagEmpty"}],staticClass:"tag-empty-box flex_c_m"},[o("div",{staticClass:"item flex_c"},[o("p",[n._v(n._s(n.$t("screenTagNodata",{keyword:n.keyWordCopy?' "'.concat(n.keyWordCopy,'" '):""})))]),n._v(" "),o("div",{staticClass:"btn",on:{click:n.screenAll}},[n._v(n._s(n.$t("screenAll")))])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.tabShowTagEmpty,expression:"tabShowTagEmpty"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),o("p",[n._v(n._s(n.$t("NoResultsFound")))])],1)],2)])])}),[],!1,null,"5a8b3aea",null);e.a=component.exports;installComponents(component,{SwipeableList:n(52).default,LenovoInput:n(239).default,CollectPopover:n(63).default,SvgIcon:n(115).default})},385:function(t,e,n){"use strict";n(6),n(12),n(13),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(11),n(72),n(19),n(16),n(24),n(65),n(8),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"VideoExplainPopover",props:{type:{type:String,required:!0},placement:{type:String,default:"bottom-start"},showBtn:{type:Boolean,default:!0},openDelay:{type:Number,default:500},isVideoModel:{type:Boolean,default:!1}},data:function(){return{yearList:[],contentConfig:{quality:{title:"qualityMode",description:"video_explain_popover_quality_1",subDesc:"video_explain_popover_common_subdesc",videoBaseName:"quality"},private:{title:"newGenerate12",description:"video_explain_popover_private_1",subDesc:"video_explain_popover_common_subdesc",videoBaseName:"private"},free:{title:"daily_rights_2",description:"daily_rights_2_tip_new",subDesc:"video_explain_popover_common_subdesc",videoBaseName:"free"},fast:{title:"newShopTips7",description:"video_explain_popover_fast_1",subDesc:"video_explain_popover_common_subdesc",videoBaseName:"fast"}},goodsInfo:{}}},computed:d(d(d({},Object(l.e)("payment",["paymentInfo"])),Object(l.c)("user",["isCompanyAccount","isLoggedIn","userInfo"])),{},{getTitle:function(){return this.$t(this.contentConfig[this.type].title)},getDescription:function(){return this.$t(this.contentConfig[this.type].description)},getSubDesc:function(){var t=this.contentConfig[this.type].subDesc,e=this.$t(this.contentConfig[this.type].title);return this.$t(t,{mode:e})},vipLevel:function(){var t;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)||0},isOnlyVipLite:function(){var t,e;return!(null!==(t=this.paymentInfo)&&void 0!==t&&t.activeState)&&!this.isCompanyAccount&&(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},canUseUnlimitedQueue:function(){var t;return null===(t=this.paymentInfo)||void 0===t?void 0:t.infiniteQueue},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},showBtnComputed:function(){if(!this.showBtn)return!1;if(!this.isVip)return!0;if(1===this.vipLevel){if(!this.isVideoModel&&"free"===this.type)return!0;if(this.isVideoModel&&"quality"===this.type)return!0}return!1},paymentData:function(){var t=this.yearList||[];return Array.isArray(t)&&0!==t.length?t[0]:null},lowestPrice:function(){var t,e,n,o;if(!this.paymentData)return"";var r=null!==(t=null===(e=this.paymentData)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price)&&void 0!==t?t:.13,l=null!==(n=null===(o=this.paymentData)||void 0===o||null===(o=o.local_price_web)||void 0===o?void 0:o.currency)&&void 0!==n?n:"$",c=r?(r/30).toFixed(2):"0.13";return this.$t("lowest_price_per_day",{unit:l,price:c})},getVideoUrl:function(){var t,e=this.contentConfig[this.type];if(!e)return"";if(!this.isLoggedIn&&0===Object.keys(this.goodsInfo).length)return"";var code=(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)||this.goodsInfo.country_code,n="default";["JP"].includes(code)?n="jp":["KR","PH","MY","VN","TH","SG"].includes(code)?n="asia":["US","GB","FR","DE","RU","IT","TR","PT","ES","BR"].includes(code)&&(n="euus");var o=e.videoBaseName;return"quality"===this.type&&(o+=this.isVideoModel?"_video":"_image"),"https://image.cdn2.seaart.me//static/web_video/".concat(n,"_").concat(o,".mp4")}}),methods:d(d({},Object(l.b)("payment",["getSubscriptionList"])),{},{handleUnlock:function(){if(this.isLoggedIn){var t={quality:"hover_SpecificPop_BreakDialog",private:"hover_generate-popup_sibling_index_2",free:"hover_SpecificPop_UnlimitedQueue",fast:"hover_SpecificPop_FastQueue"}[this.type]||"",e=["basic","standard","professional"];switch(this.type){case"quality":this.isVideoModel&&this.isVip?this.$EventBus.$emit("showUpgradeDialog","UpgradeQualityModel","standard",{dotFrom:t}):this.$EventBus.$emit("showBreakDialog","updateQualityTips","basic",void 0,e,{dotFrom:t});break;case"free":this.isVip?this.$EventBus.$emit("showUpgradeDialog","UnlimitedQueueTipWeb","standard",{dotFrom:t}):this.$EventBus.$emit("showBreakDialog","UnlimitedQueueTipWeb","standard",void 0,e,{dotFrom:t});break;case"private":this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic",void 0,e,{dotFrom:t})}}else this.$EventBus.$emit("openLoginDialog",{dot:!1})},handleShow:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={quality:"hover_SpecificPop_BreakDialog",private:"hover_generate-popup_sibling_index_2",free:"hover_SpecificPop_UnlimitedQueue",fast:"hover_SpecificPop_FastQueue"},t.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:o[t.type]||"SpecificPop_BreakDialog"}),e.next=5,t.getSubscriptionList({isSaveData:t.isLoggedIn});case 5:r=e.sent,t.yearList=(null==r||null===(n=r.data)||void 0===n?void 0:n.year)||[],t.goodsInfo=null==r?void 0:r.data,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t.yearList=[];case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}})},v=(n(4282),n(4283),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("el-popover",t._g(t._b({staticClass:"video-explain-popover-container",attrs:{placement:t.placement,"append-to-body":!0,"open-delay":t.openDelay,trigger:"hover","popper-class":"video-explain-popover"},on:{show:t.handleShow}},"el-popover",t.$attrs,!1),t.$listeners),[e("div",{staticClass:"video-explain-modal-main dot-group"},[e("div",{staticClass:"popover-content"},[e("div",{staticClass:"popover-title"},[e("span",{staticClass:"title-text"},[t._v(t._s(t.getTitle))])]),t._v(" "),e("div",{staticClass:"popover-body"},[e("div",{staticClass:"popover-desc"},[t._v(t._s(t.getDescription))]),t._v(" "),t.isVip?t._e():e("div",{staticClass:"popover-sub-desc"},[t._v(t._s(t.getSubDesc))]),t._v(" "),e("div",{staticClass:"popover-video"},[e("video",{attrs:{src:t.getVideoUrl,autoplay:"",width:"100%",height:"100%",loop:"",muted:""},domProps:{muted:!0}})])]),t._v(" "),t.showBtnComputed?e("div",{staticClass:"popover-footer"},[e("div",{staticClass:"generate-btn",attrs:{"data-event":"video_explain_popover_unlock_now"},on:{click:t.handleUnlock}},[t._v("\n          "+t._s(t.$t("UnlockNow"))+"\n          "),t.lowestPrice?e("span",{staticClass:"price-tag"},[t._v(t._s(t.lowestPrice))]):t._e()])]):t._e()])]),t._v(" "),t._t("reference",null,{slot:"reference"})],2)}),[],!1,null,"10b588fc",null);e.a=component.exports},3885:function(t,e,n){"use strict";n(1568)},412:function(t,e,n){"use strict";n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(16),n(4),n(1)),l=n(85),c=n(385);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"previteSwitchEle",components:{VideoExplainPopover:c.a},props:{isShowPrevite:{type:Boolean,default:!1}},data:function(){return{switchLoading:!1,createSetting:1}},computed:h(h({},Object(r.c)("user",["isLoggedIn","userInfo"])),Object(r.c)("payment",["paymentInfo"])),watch:{"userInfo.settings.is_auto_pub_community":{handler:function(t){this.createSetting=t?1:2},immediate:!0},isLoggedIn:{handler:function(t){!t&&(this.createSetting=1)},immediate:!0,deep:!0}},methods:h(h({},Object(r.b)("user",["getAccountInfo"])),{},{handleCreateSettingSelectChange:function(t){var e;return this.handleLogEvent("createSetting",[2,"2"].includes(t)?"open":"colse"),console.log(this.isLoggedIn,"登录状态"),this.isLoggedIn?![2,"2"].includes(t)||null!==(e=this.paymentInfo)&&void 0!==e&&e.show_auto_pub_switch?void(this.isLoggedIn&&this.saveSettings(t)):(this.$EventBus.$emit("showBreakDialog","PrivateWorkTipWeb","basic"),void(this.createSetting=1)):(this.$EventBus.$emit("openLoginDialog",{dot:!1}),this.$logEvent("log_actions",{operation:"register_popup",behavior_info:"on_new_createflow_page"}),void(this.createSetting=1))},saveSettings:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.switchLoading=!0;var n={auto_pub_community:e,mode:1};Object(l.c)(n).then((function(n){var o=(n||{}).status.code;["10000",1e4].includes(void 0===o?"":o)&&(t.$message.success(t.$t("SaveSuccess")),t.createSetting=e,t.getAccountInfo(5))})).finally((function(){t.switchLoading=!1}))},handleLogEvent:function(t,e){var n="",o="";if("createSetting"===t)n="click_private_model",o=e;n&&this.$logEvent("log_actions",{operation:n,behavior_info:"on_new_createflow_page",behavior_info_sub:o})}}),render:function(){var t=this,e=arguments[0];return this.isShowPrevite&&e("div",{class:"previte-item"},[e("div",{class:"previte-item-label-box"},[e("span",{class:"previte-item-label-text"},[this.$t("newGenerate12")]),e("img",{class:"previte-item-icon",attrs:{src:n(136),alt:"vip-icon"}}),e(c.a,{key:"private",attrs:{type:"private"},class:"custom-tips"},[e("span",{slot:"reference"},[e("i",{class:"el-icon-warning"})])])]),e("el-switch",{attrs:{disabled:this.switchLoading,"active-color":"#3f8cff","active-value":2,"inactive-value":1,"data-event":"click_switch","data-id":this.createSetting},on:{change:this.handleCreateSettingSelectChange},model:{value:t.createSetting,callback:function(e){t.createSetting=e}}})])}},f=v,m=(n(4352),n(0)),component=Object(m.a)(f,undefined,undefined,!1,null,"c6ba45d4",null);e.a=component.exports},4282:function(t,e,n){"use strict";n(1858)},4283:function(t,e,n){"use strict";n(1859)},4341:function(t,e,n){"use strict";n(1911)},4342:function(t,e,n){"use strict";n(1912)},4352:function(t,e,n){"use strict";n(1922)},4382:function(t,e,n){"use strict";n(1952)},4517:function(t,e,n){"use strict";n(2079)},4518:function(t,e,n){"use strict";n(2080)},4519:function(t,e,n){"use strict";n(2081)},462:function(t,e,n){"use strict";n(16),n(65),n(21),n(11),n(12),n(13),n(7);var o=n(14),r=n(2),l=(n(6),n(32),n(50),n(22),n(31),n(24),n(8),n(4),n(28),n(140),n(1)),c=n(475),d=(n(43),n(77),n(26),{name:"CountDown",props:{minutes:{type:Number,default:0},existingCountdown:{type:Object,default:null}},data:function(){return{displayHours:"00",displayMinutes:"00",displaySeconds:"00",timer:null,endTime:null}},watch:{existingCountdown:{handler:function(t){t&&!this.minutes&&(this.displayHours=t.hours,this.displayMinutes=t.minutes,this.displaySeconds=t.seconds)},immediate:!0},minutes:{handler:function(t){t>0&&this.startCountDown()},immediate:!0}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{startCountDown:function(){var t=this;this.endTime=(new Date).getTime()+60*this.minutes*1e3,this.timer=setInterval((function(){var e=(new Date).getTime(),n=t.endTime-e;if(n<0)return clearInterval(t.timer),void t.$emit("timeUp");var o=Math.floor(n/36e5),r=Math.floor(n%36e5/6e4),l=Math.floor(n%6e4/1e3);t.displayHours=o.toString().padStart(2,"0"),t.displayMinutes=r.toString().padStart(2,"0"),t.displaySeconds=l.toString().padStart(2,"0")}),1e3)}}}),h=(n(5568),n(0)),v=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",[e("span",[t._v(t._s(t.displayHours))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(t.displayMinutes))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(t.displaySeconds))])])}),[],!1,null,"5e4ac650",null).exports,f=n(9);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"UserDaily",inject:["top"],props:{title:{type:String,default:""},isNewUser:{type:Boolean,default:!0},defaultSelected:{type:String,default:""},showSelectMethods:{type:Boolean,default:!0},hiddenItems:{type:Array,default:function(){return["free","master"]}},forceFreeTry:{type:Boolean,default:!1},replaceStandard:{type:Boolean,default:!1},withCover:{type:Boolean,default:!1},hideMore:{type:Boolean,default:!1},needReverse:{type:Boolean,default:!1},countDown:{type:Number,default:0},hideBasicYearlyTotal:{type:Boolean,default:!1}},components:{RightsComponent:c.a,CountDown:v},data:function(){return{activeTab:"yearly",selectedLevel:"basic",levelArr:[],apiMonetaryUnit:"",clickCover:!1,internalHiddenItems:[]}},mounted:function(){this.getGoodsData(),this.getUserStatus()},destroyed:function(){this.clickCover=!1},computed:_(_(_(_({},Object(l.e)("user",["cdnHost","userInfo"])),Object(l.e)("payment",["paymentInfo","halfDiscountCountdown","paymentGrayInfo"])),Object(l.c)("unsubscribe",["prevPlanId","userFreeTryStatus","userPauseStatus"])),{},{isT1Country:function(){var t;return f.qb.includes(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},effectiveHiddenItems:function(){return this.internalHiddenItems},getTitle:function(){var t,e=!this.isNewUser||null!==(t=this.paymentInfo)&&void 0!==t&&t.svipExpiryTime?"old_daily_title":"new_daily_title";return this.inActivity&&(e="old_daily_title_".concat(this.maxDiscount)),this.title&&(e=this.title),this.$t(e)},maxDiscount:function(){var t=this.levelArr.filter((function(t){return null==t?void 0:t.discount})).map((function(t){return t.discount}));return t.length?Math.max.apply(Math,Object(o.a)(t)):0},inActivity:function(){var t=this.levelArr.filter((function(i){return null==i?void 0:i.discount}));return null==t?void 0:t.length},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},getDiscount:function(){var t="save20";return this.inActivity&&(t="save".concat(this.maxDiscount)),this.$t(t)},isMonthly:function(){return"monthly"===this.activeTab},isYearly:function(){return"yearly"===this.activeTab},isWeekly:function(){return"weekly"===this.activeTab},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({basic:"ToB_beginnerPlan",standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan",web_trial:"StandardPlan"}[e])}},isProfessional:function(){return"professional"==this.selectedLevel},isFreeTry:function(){var t,e=this;if(this.forceFreeTry)return!0;var n=this.levelArr.find((function(i){return i.label==e.selectedLevel}));return this.isYearly&&this.isNewUser&&!this.isProfessional&&!(null!==(t=this.paymentInfo)&&void 0!==t&&t.svipExpiryTime)&&!(null!=n&&n.discount&&this.isYearly)},getBtnLabel:function(){var t=this,e=this.isYearly?"Upgrade20off":"SubscribeNow",n=this.levelArr.find((function(i){return i.label==t.selectedLevel})),o=this.isMonthly?null==n?void 0:n.monthly_id:null==n?void 0:n.yearly_id;return null!=n&&n.discount&&this.isYearly&&(e="Upgrade".concat(this.maxDiscount,"off")),this.isFreeTry&&!this.title&&(e="StartFreeTrial"),this.prevPlanId!==o||2!==this.userFreeTryStatus&&!this.userPauseStatus||(e="PlanRecoveryNow"),this.$t(e)},getMarginTop:function(){return{marginTop:this.isNewUser?"33px":"52px"}},showWeekly:function(){var t,e;return!(null===(t=this.paymentGrayInfo)||void 0===t||!t.show_weekly)&&("NotVipComputingTitle"===this.title&&[2,3,6].includes(null===(e=this.paymentInfo)||void 0===e?void 0:e.userType))},filteredLevelArr:function(){if(this.isWeekly&&"NotVipComputingTitle"===this.title){var t,e=null===(t=this.paymentInfo)||void 0===t?void 0:t.userType;if(2===e)return this.levelArr.filter((function(t){return"professional"===t.label}));if([3,6].includes(e))return this.levelArr.filter((function(t){return["standard","professional"].includes(t.label)}))}return this.levelArr}}),watch:{defaultSelected:{handler:function(t){t&&(this.selectedLevel=t)},immediate:!0},hiddenItems:{handler:function(t){this.internalHiddenItems=Object(o.a)(t),this.levelArr.length>0&&this.getGoodsData()},immediate:!0}},methods:_(_(_({},Object(l.b)("unsubscribe",["getUserStatus"])),Object(l.b)("payment",["getSubscriptionList"])),{},{handleTimeUp:function(){this.$emit("timeUp")},handleClose:function(){this.top.close(),"NotVipComputingTitle"===this.title&&this.$EventBus.$emit("userHasCanRewards")},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;this.getSubscriptionList({forceRefresh:this.hideMore}).then((function(e){var n=e.data,data=void 0===n?{}:n;t.handleData(data)}))},handleData:function(data){var t=this,e=data||{},n=e.month,o=void 0===n?[]:n,r=e.year,l=void 0===r?[]:r,c=e.week,d=void 0===c?[]:c,h=e.web_trial,v=l.map((function(t,e){var n;return _(_({},t),{},{monthly_id:o[e].id,original_price:o[e].price,original_price_cn:o[e].price_cn,weekly_id:d[e].id,weekly_price:null===(n=d[e].local_price_web)||void 0===n?void 0:n.price})}));if(this.levelArr=v.map((function(e){var n=e.id,o=e.monthly_id,r=e.weekly_id,l=e.price_month,c=e.original_price,d=e.price_month_cn,h=e.original_price_cn,v=e.price,f=e.price_cn,m=e.local_price_web,_=e.activity,y=e.discount,w=e.weekly_price;return t.apiMonetaryUnit||(t.apiMonetaryUnit=null==m?void 0:m.currency),{discount:y,activity:_,label:{sub_yearly1:"basic",sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"master"}[n],monthly_id:o,yearly_id:n,weekly_id:r,original_m_p_en:c,now_m_p_en:l,original_m_p_zh:h,now_m_p_zh:d,now_total_price_en:v,now_total_price_cn:f,now_m_p:null==m?void 0:m.price,original_m_p:null==m?void 0:m.price_old,monetaryUnit:null==m?void 0:m.currency,weekly_price:w}})),this.replaceStandard&&h){var f=this.levelArr.findIndex((function(i){return"standard"===i.label}));if(f>-1){var m=h.id,y=h.price_month,w=h.price_month_cn,C=h.price,k=h.price_cn,O=h.local_price_web;Object.assign(this.levelArr[f],{yearly_id:m,now_m_p_en:y,now_m_p_zh:w,now_total_price_en:C,now_total_price_cn:k,now_m_p:null==O?void 0:O.price,original_m_p:null==O?void 0:O.price_old,monetaryUnit:null==O?void 0:O.currency})}}this.needReverse&&this.levelArr.reverse(),this.setDefaultLevel()},changeMethods:function(t){var e=this;(this.activeTab=t,this.isWeekly)&&(this.filteredLevelArr.find((function(i){return i.label===e.selectedLevel}))||(this.selectedLevel=this.filteredLevelArr[0].label))},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r,c=e.weekly_id,d=void 0===c?"":c,h=this.isWeekly?d:this.isMonthly?o:l;this.$emit("subscriptionNow",{goods_id:h,useFree:this.isFreeTry,btnLabel:this.getBtnLabel})},handleClickCover:function(){this.clickCover=!0,this.$emit("clickCover")},setDefaultLevel:function(){var t;if(null!==(t=this.paymentGrayInfo)&&void 0!==t&&t.show_weekly&&"NotVipComputingTitle"===this.title){var e=localStorage.getItem("payGoodsInfo")?JSON.parse(localStorage.getItem("payGoodsInfo")):{},n=e.payGoodsId,o=!1;if(e.payLastTime===(new Date).toISOString().slice(0,10)&&n){var r=n.match(/(\d)$/);if(r){var label={1:"basic",2:"standard",3:"professional",4:"master"}[r[1]],l=this.levelArr.find((function(i){return i.label===label&&"master"!==i.label}));if(l){var c,d;n.includes("week")&&null!==(c={2:["professional"],3:["standard","professional"],6:["standard","professional"]}[null===(d=this.paymentInfo)||void 0===d?void 0:d.userType])&&void 0!==c&&c.includes(l.label)?(this.selectedLevel=l.label,this.activeTab="weekly",o=!0):(n.includes("year")||n.includes("month"))&&(this.selectedLevel=l.label,this.activeTab=n.includes("year")?"yearly":"monthly",o=!0)}}}if(!o){var h,v=null===(h=this.paymentInfo)||void 0===h?void 0:h.userType;[1,4].includes(v)?this.activeTab="yearly":[2,3,5].includes(v)?this.activeTab="monthly":6===v&&(this.activeTab="weekly"),this.selectedLevel="standard"}}}})},w=(n(5569),Object(h.a)(y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-daily"},[e("div",{staticClass:"user-daily-close flex-center",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),t.withCover&&!t.clickCover?e("div",{staticClass:"cover"},[e("div",{staticClass:"cover-title"},[t._v(t._s(t.$t("hey")+" 👏"))]),t._v(" "),e("div",{staticClass:"cover-content",domProps:{innerHTML:t._s(t.$t("newUserOffer",{discount:t.maxDiscount}))}}),t._v(" "),e("div",{staticClass:"cover-footer"},[e("el-button",{staticClass:"cover-footer-btn",on:{click:t.handleClickCover}},[t._v(t._s(t.$t("Upgrade".concat(t.maxDiscount,"off"))))])],1)]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.withCover||t.clickCover,expression:"!withCover || clickCover"}],staticClass:"left",class:t.selectedLevel},[t.countDown?e("div",{staticClass:"one-time-title flex flex-col items-center"},[e("div",{staticClass:"title1"},[t._v(t._s(t.$t("oneTimeTitle1")))]),t._v(" "),e("div",{staticClass:"title2",domProps:{innerHTML:t._s(t.$t("oneTimeTitle2"))}}),t._v(" "),e("div",{staticClass:"title-tag"},[e("span",[t._v(t._s(t.$t("oneTimeTitle3")))])])]):e("div",{staticClass:"left-title"},[t._v("\n      "+t._s(t.getTitle)+"\n    ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelectMethods,expression:"showSelectMethods"}],staticClass:"left-methods"},[t.showWeekly?e("div",{staticClass:"left-methods-monthly",class:{active:t.isWeekly},on:{click:function(e){return t.changeMethods("weekly")}}},[t._v("\n        "+t._s(t.$t("PayWeekly"))+"\n      ")]):t._e(),t._v(" "),e("div",{staticClass:"left-methods-monthly",class:{active:t.isMonthly},on:{click:function(e){return t.changeMethods("monthly")}}},[t._v("\n        "+t._s(t.$t("PayMonthly"))+"\n      ")]),t._v(" "),e("div",{staticClass:"left-methods-yearly",class:{active:t.isYearly},on:{click:function(e){return t.changeMethods("yearly")}}},[t._v("\n        "+t._s(t.$t("PayYearly"))+"\n        "),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.isYearly,expression:"!isYearly"}],staticClass:"icon",attrs:{src:t.getGif,alt:"icon"}}),t._v(" "),e("span",{staticClass:"discount"},[t._v("\n          "+t._s(t.getDiscount)+"\n        ")])])]),t._v(" "),e("div",{staticClass:"left-level",class:{"left-level-special":t.isWeekly}},t._l(t.filteredLevelArr,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:!t.effectiveHiddenItems.includes(n.label),expression:"!effectiveHiddenItems.includes(item.label)"}],key:n.label,staticClass:"item-level",class:{active:t.selectedLevel==n.label},on:{click:function(e){t.selectedLevel=n.label}}},[null!=n&&n.discount&&t.isYearly?e("div",{staticClass:"goods-discount flex-center",style:t.getBg},[t._v("\n          "+t._s("".concat(null==n?void 0:n.discount,"% OFF"))+"\n        ")]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isYearly&&(t.countDown||!t.countDown&&(null==n?void 0:n.discount)&&t.halfDiscountCountdown),expression:"isYearly && (countDown || (!countDown && item?.discount && halfDiscountCountdown))"}],staticClass:"countdown-box flex-center",class:{"with-discount":null==n?void 0:n.discount}},[e("CountDown",{attrs:{minutes:t.countDown,existingCountdown:t.halfDiscountCountdown},on:{timeUp:t.handleTimeUp}})],1),t._v(" "),e("div",{staticClass:"item-level-label"},[t._v("\n          "+t._s(t.getLabel(n.label))+"\n        ")]),t._v(" "),t.isWeekly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n            "+t._s(null==n?void 0:n.monetaryUnit)+"\n          ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n            "+t._s(n.weekly_price)+"\n          ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n            "+t._s(t.$t("week"))+"\n          ")])]):t.isMonthly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n            "+t._s(null==n?void 0:n.monetaryUnit)+"\n          ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n            "+t._s(n.original_m_p)+"\n          ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n            "+t._s(t.$t("Month"))+"\n          ")])]):e("div",{staticClass:"item-level-price item-level-yearly"},[e("div",{staticClass:"top"},[e("span",{staticClass:"sign"},[t._v("\n              "+t._s(null==n?void 0:n.monetaryUnit)+"\n            ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n              "+t._s(n.now_m_p)+"\n            ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n              "+t._s(t.$t("Month"))+"\n            ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"basic"!==(null==n?void 0:n.label)||!t.hideBasicYearlyTotal,expression:"item?.label !== 'basic' || !hideBasicYearlyTotal"}],staticClass:"bottom"},[e("div",{staticClass:"now-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.now_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])]),t._v(" "),e("div",{staticClass:"original-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.original_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])])])])])})),0),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.hideMore,expression:"!hideMore"}],staticClass:"left-more",style:t.getMarginTop,on:{click:t.toMall}},[t._v("\n      "+t._s(t.$t("viewMore"))+"\n      "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isFreeTry&&!t.title,expression:"isFreeTry && !title"}],staticClass:"left-pay"},[e("div",{staticClass:"left-pay-desc"},[e("div",{staticClass:"left-pay-desc-top"},[e("span",[t._v(t._s(t.$t("dueToday")))]),t._v(" "),e("span",[t._v("("+t._s(t.$t("ThreeDayTrial"))+")")])]),t._v(" "),e("div",{staticClass:"left-pay-desc-bottom"},[t._v(t._s(t.$t("UCanCancleTrial")))])]),t._v(" "),e("span",{staticClass:"left-pay-amount"},[t._v(t._s(t.apiMonetaryUnit)+"0")])]),t._v(" "),e("el-button",{staticClass:"left-btn",style:t.getMarginTop,on:{click:t.subscriptionNow}},[t._v("\n      "+t._s(t.getBtnLabel)+"\n    ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("RightsComponent",{attrs:{selectedLevel:t.selectedLevel,hiddenItems:t.effectiveHiddenItems}})],1)])}),[],!1,null,"76031ae2",null));e.a=w.exports},4702:function(t,e,n){"use strict";n(2140)},4703:function(t,e,n){"use strict";n(2141)},4704:function(t,e,n){"use strict";n(2142)},4705:function(t,e,n){"use strict";n(2143)},4706:function(t,e,n){"use strict";n(2144)},4707:function(t,e,n){"use strict";n(2145)},4708:function(t,e,n){"use strict";n(2146)},4709:function(t,e,n){"use strict";n(2147)},4710:function(t,e,n){"use strict";n(2148)},4711:function(t,e,n){"use strict";n(2149)},4712:function(t,e,n){"use strict";n(2150)},4713:function(t,e,n){"use strict";n(2151)},4714:function(t,e,n){"use strict";n(2152)},4715:function(t,e,n){"use strict";n(2153)},4718:function(t,e,n){"use strict";n(2156)},4719:function(t,e,n){"use strict";n(2157)},4720:function(t,e,n){"use strict";n(2158)},4721:function(t,e,n){"use strict";n(2159)},4723:function(t,e,n){"use strict";n(2160)},4724:function(t,e,n){"use strict";n(2161)},4725:function(t,e,n){"use strict";n(2162)},4726:function(t,e,n){"use strict";n(2163)},4727:function(t,e,n){"use strict";n(2164)},4728:function(t,e,n){"use strict";n(2165)},4729:function(t,e,n){"use strict";n(2166)},4731:function(t,e,n){"use strict";n(2168)},4732:function(t,e,n){"use strict";n(2169)},4733:function(t,e,n){"use strict";n(2170)},4734:function(t,e,n){"use strict";n(2171)},4735:function(t,e,n){"use strict";n(2172)},4736:function(t,e,n){"use strict";n(2173)},4737:function(t,e,n){"use strict";n(2174)},4738:function(t,e,n){"use strict";n(2175)},4739:function(t,e,n){"use strict";n(2176)},4740:function(t,e,n){"use strict";n(2177)},4741:function(t,e,n){"use strict";n(2178)},4742:function(t,e,n){"use strict";n(2179)},4743:function(t,e,n){"use strict";n(2180)},4744:function(t,e,n){"use strict";n(2181)},4745:function(t,e,n){"use strict";n(2182)},4746:function(t,e,n){"use strict";n(2183)},4747:function(t,e,n){"use strict";n(2184)},4748:function(t,e,n){"use strict";n(2185)},4749:function(t,e,n){"use strict";n(2186)},475:function(t,e,n){"use strict";n(19),n(11),n(12),n(13),n(8),n(7);var o=n(2),r=(n(6),n(16),n(4),n(21),n(1)),l=n(585),c=n(565);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"RightsComponent",props:{selectedLevel:{type:String,default:"basic"},hiddenItems:{type:Array,default:function(){return[]}}},components:{CTooltip:c.default},data:function(){return{rightsTitleArr:l.e,freeRights:l.b,basicRights:l.a,standardRights:l.f,professionalRights:l.d,masterRights:l.c,isBottom:!1}},mounted:function(){},computed:h(h({},Object(r.e)("user",["cdnHost"])),{},{versionRights:function(){return[{key:"free",className:"free-version",label:"Free",rights:this.freeRights},{key:"basic",className:"basic-version",label:"ToB_beginnerPlan",rights:this.basicRights},{key:"standard",className:"standard-version",label:"StandardPlan",rights:this.standardRights},{key:"professional",className:"professional-version",label:"ToB_professionalPlan",rights:this.professionalRights},{key:"master",className:"master-version",label:"MasterPlan",rights:this.masterRights}]},getBgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20250317/2b0f3d49-e85d-4067-a7de-ab7de991b9fd.webp")},getArrowClasses:function(){return{reverse:this.isBottom,basic:"basic"===this.selectedLevel,standard:"standard"===this.selectedLevel,professional:"professional"===this.selectedLevel,master:"master"===this.selectedLevel,pulse:!this.isBottom}},handleLabel:function(){var t=this;return function(label,e,n){var o=label;return 0==e&&(o="".concat(o," / ").concat(t.$t("Day"))),o}},filteredVersionRights:function(){var t=this;return this.versionRights.filter((function(e){return!t.hiddenItems.includes(null==e?void 0:e.key)}))}}),methods:{handleClose:function(){this.top.close()},scrollWatch:function(){var t=this.$refs.contents,e=t.scrollHeight-t.scrollTop===t.clientHeight;this.isBottom=e},arrowClick:function(){var t=this.$refs.contents;if(this.isBottom)t.scrollTo({top:0,behavior:"smooth"});else{var e=t.scrollHeight-t.clientHeight;t.scrollTo({top:e,behavior:"smooth"})}}}},f=(n(5567),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rights-components"},[e("img",{staticClass:"rights-components-bg",attrs:{src:t.getBgUrl,alt:"bg"}}),t._v(" "),e("div",{ref:"contents",staticClass:"rights-components-contents",class:t.selectedLevel,on:{scroll:t.scrollWatch}},[e("div",{staticClass:"rights-desc"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("Feature")))]),t._v(" "),t._l(t.rightsTitleArr,(function(n,i){return e("div",{key:"right_".concat(i),staticClass:"value"},[e("span",[t._v(t._s(t.$t(n.label)))]),t._v(" "),null!=n&&n.tip?e("CTooltip",{staticStyle:{"margin-left":"5px"},attrs:{font:16,content:n.tip}}):t._e()],1)}))],2),t._v(" "),t._l(t.filteredVersionRights,(function(n,o){return e("div",{key:"col_".concat(n.key),class:[n.className,"version-column",n.key===t.selectedLevel?"sweep-column":""],style:{"animation-delay":"".concat(.1*o+.2,"s")}},[e("div",{directives:[{name:"show",rawName:"v-show",value:n.key===t.selectedLevel,expression:"version.key === selectedLevel"}],staticClass:"sweep-effect"}),t._v(" "),e("div",{staticClass:"label"},[t._v(t._s(t.$t(n.label)))]),t._v(" "),t._l((null==n?void 0:n.rights)||[],(function(o,i){return e("div",{key:"right_".concat(n.key,"_").concat(i),staticClass:"value",style:{"animation-delay":"".concat(.03*i+.3,"s")}},["boolean"==typeof o.label?e("span",{staticClass:"icon"},[e("i",{class:[o.label?"el-icon-check":"el-icon-close",{"animate-ping":o.label&&n.key===t.selectedLevel}]})]):e("span",[t._v(t._s(t.handleLabel(o.label,i,n.key)))])])}))],2)}))],2),t._v(" "),e("i",{staticClass:"iconfont icon-icon-arrows-under",class:t.getArrowClasses,on:{click:t.arrowClick}})])}),[],!1,null,"8b701aa6",null);e.a=component.exports;installComponents(component,{CTooltip:n(565).default})},4750:function(t,e,n){"use strict";n(2187)},4751:function(t,e,n){"use strict";n(2188)},4752:function(t,e,n){"use strict";n(2189)},4753:function(t,e,n){"use strict";n(2190)},4754:function(t,e,n){"use strict";n(2191)},4755:function(t,e,n){"use strict";n(2192)},4805:function(t,e,n){"use strict";n(2242)},4806:function(t,e,n){"use strict";n(2243)},4807:function(t,e,n){"use strict";n(2244)},4808:function(t,e,n){"use strict";n(2245)},4809:function(t,e,n){"use strict";n(2246)},4810:function(t,e,n){"use strict";n(2247)},4812:function(t,e,n){"use strict";n(2249)},4846:function(t,e,n){"use strict";n(2283)},4849:function(t,e,n){"use strict";n(2287)},4850:function(t,e,n){"use strict";n(2288)},4851:function(t,e,n){"use strict";n(2289)},4852:function(t,e,n){"use strict";n(2290)},4853:function(t,e,n){"use strict";n(2291)},4854:function(t,e,n){"use strict";n(2292)},4855:function(t,e,n){"use strict";n(2293)},5029:function(t,e,n){"use strict";n(2464)},5120:function(t,e,n){"use strict";n(2552)},5121:function(t,e,n){"use strict";n(2553)},5122:function(t,e,n){"use strict";n(2554)},5124:function(t,e,n){"use strict";n(2556)},5126:function(t,e,n){"use strict";n(2558)},5127:function(t,e,n){"use strict";n(2559)},5128:function(t,e,n){"use strict";n(2560)},5131:function(t,e,n){"use strict";n(2563)},5132:function(t,e,n){"use strict";n(2564)},5133:function(t,e,n){"use strict";n(2565)},5154:function(t,e,n){"use strict";n(2586)},5188:function(t,e,n){"use strict";n(2620)},5189:function(t,e,n){"use strict";n(2621)},5190:function(t,e,n){"use strict";n(2622)},5191:function(t,e,n){"use strict";n(2623)},5192:function(t,e,n){"use strict";n(2624)},5224:function(t,e,n){"use strict";n(2656)},5225:function(t,e,n){"use strict";n(2657)},5226:function(t,e,n){"use strict";n(2658)},5228:function(t,e,n){"use strict";n(2660)},5230:function(t,e,n){"use strict";n(2661)},5231:function(t,e,n){"use strict";n(2662)},5232:function(t,e,n){"use strict";n(2663)},5233:function(t,e,n){"use strict";n(2664)},5234:function(t,e,n){"use strict";n(2665)},5235:function(t,e,n){"use strict";n(2666)},5236:function(t,e,n){"use strict";n(2667)},5237:function(t,e,n){"use strict";n(2668)},5238:function(t,e,n){"use strict";n(2669)},5239:function(t,e,n){"use strict";n(2670)},5242:function(t,e,n){"use strict";n(2671)},5243:function(t,e,n){"use strict";n(2672)},5244:function(t,e,n){"use strict";n(2673)},5245:function(t,e,n){"use strict";n(2674)},5246:function(t,e,n){"use strict";n(2675)},5247:function(t,e,n){"use strict";n(2676)},5248:function(t,e,n){"use strict";n(2677)},5249:function(t,e,n){"use strict";n(2678)},5250:function(t,e,n){"use strict";n(2679)},5251:function(t,e,n){"use strict";n(2680)},5252:function(t,e,n){"use strict";n(2681)},5253:function(t,e,n){"use strict";n(2682)},5359:function(t,e,n){"use strict";n(2781)},5360:function(t,e,n){"use strict";n(2782)},5361:function(t,e,n){"use strict";n(2783)},5362:function(t,e,n){"use strict";n(2784)},5363:function(t,e,n){"use strict";n(2785)},5364:function(t,e,n){"use strict";n(2786)},5365:function(t,e,n){"use strict";n(2787)},5366:function(t,e,n){"use strict";n(2788)},5367:function(t,e,n){"use strict";n(2789)},5370:function(t,e,n){"use strict";n(2792)},5371:function(t,e,n){"use strict";n(2793)},5372:function(t,e,n){"use strict";n(2794)},5373:function(t,e,n){"use strict";n(2795)},5374:function(t,e,n){"use strict";n(2796)},5375:function(t,e,n){"use strict";n(2797)},5376:function(t,e,n){"use strict";n(2798)},5377:function(t,e,n){"use strict";n(2799)},5378:function(t,e,n){"use strict";n(2800)},5379:function(t,e,n){"use strict";n(2801)},5380:function(t,e,n){"use strict";n(2802)},5381:function(t,e,n){"use strict";n(2803)},5382:function(t,e,n){"use strict";n(2804)},5383:function(t,e,n){"use strict";n(2805)},5384:function(t,e,n){"use strict";n(2806)},5385:function(t,e,n){"use strict";n(2807)},5386:function(t,e,n){"use strict";n(2808)},5387:function(t,e,n){"use strict";n(2809)},5388:function(t,e,n){"use strict";n(2810)},5389:function(t,e,n){"use strict";n(2811)},5390:function(t,e,n){"use strict";n(2812)},5391:function(t,e,n){"use strict";n(2813)},5392:function(t,e,n){"use strict";n(2814)},5393:function(t,e,n){"use strict";n(2815)},5394:function(t,e,n){"use strict";n(2816)},5490:function(t,e,n){"use strict";n(2907)},5491:function(t,e,n){"use strict";n(2908)},5525:function(t,e,n){"use strict";n(2942)},5526:function(t,e,n){"use strict";n(2943)},5527:function(t,e,n){"use strict";n(2944)},5528:function(t,e,n){"use strict";n(2945)},5529:function(t,e,n){"use strict";n(2946)},5530:function(t,e,n){"use strict";n(2947)},5531:function(t,e,n){"use strict";n(2948)},5567:function(t,e,n){"use strict";n(2983)},5568:function(t,e,n){"use strict";n(2984)},5569:function(t,e,n){"use strict";n(2985)},5570:function(t,e,n){"use strict";n(2986)},5571:function(t,e,n){"use strict";n(2987)},5572:function(t,e,n){"use strict";n(2988)},5573:function(t,e,n){"use strict";n(2989)},5574:function(t,e,n){"use strict";n(2990)},5575:function(t,e,n){"use strict";n(2991)},5576:function(t,e,n){"use strict";n(2992)},5577:function(t,e,n){"use strict";n(2993)},5578:function(t,e,n){"use strict";n(2994)},5579:function(t,e,n){"use strict";n(2995)},5580:function(t,e,n){"use strict";n(2996)},5581:function(t,e,n){"use strict";n(2997)},5582:function(t,e,n){"use strict";n(2998)},5583:function(t,e,n){"use strict";n(2999)},5584:function(t,e,n){"use strict";n(3e3)},5585:function(t,e,n){"use strict";n(3001)},5587:function(t,e,n){"use strict";n(3003)},5589:function(t,e,n){"use strict";n(3005)},5590:function(t,e,n){"use strict";n(3006)},5591:function(t,e,n){"use strict";n(3007)},5592:function(t,e,n){"use strict";n(3008)},5593:function(t,e,n){"use strict";n(3009)},5594:function(t,e,n){"use strict";n(3010)},5596:function(t,e,n){"use strict";n(3012)},5597:function(t,e,n){"use strict";n(3013)},5598:function(t,e,n){"use strict";n(3014)},5599:function(t,e,n){"use strict";n(3015)},5600:function(t,e,n){"use strict";n(3016)},5601:function(t,e,n){"use strict";n(3017)},5602:function(t,e,n){"use strict";n(3018)},5603:function(t,e,n){"use strict";n(3019)},5604:function(t,e,n){"use strict";n(3020)},5605:function(t,e,n){"use strict";n(3021)},5610:function(t,e,n){"use strict";n(3026)},5612:function(t,e,n){"use strict";n(3028)},5624:function(t,e,n){"use strict";n(3040)},5625:function(t,e,n){"use strict";n(3041)},5626:function(t,e,n){"use strict";n(3042)},5634:function(t,e,n){"use strict";n(3050)},5635:function(t,e,n){"use strict";n(3051)},5636:function(t,e,n){"use strict";n(3052)},5637:function(t,e,n){"use strict";n(3053)},5638:function(t,e,n){"use strict";n(3054)},5640:function(t,e,n){"use strict";n(3056)},5720:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13);var o=n(30),r=n(2),l=(n(19),n(6),n(16),n(22),n(8),n(4),n(21),n(7),n(41),n(26),n(1)),c={data:function(){return{modeType:"poster",modeList:[{label:this.$t("generateCanvas"),value:"generate"},{label:this.$t("realtimeCanvas"),value:"live"},{label:this.$t("designCanvas"),value:"poster"}]}},methods:{changeModeType:function(t){this.modeType=t;["generate","live"].includes(t)&&this.$router.push(this.localePath({path:"/editBoard"}))},backPage:function(){this.$router.back()}}},d=(n(5224),n(0)),h=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-action-box flex_m"},[e("div",{staticClass:"back-btn flex_c_m",on:{click:t.backPage}},[e("i",{staticClass:"iconfont icon-back"})]),t._v(" "),e("el-select",{staticClass:"custom-select-transparent my-el-select",attrs:{value:t.modeType,"popper-class":"painting-board-select select-canvas my-el-option"},on:{change:t.changeModeType}},t._l(t.modeList,(function(t){return e("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})})),1)],1)}),[],!1,null,"4addff14",null).exports,v={inject:["top"],data:function(){return{imgUrl:""}},methods:{showFontList:function(){this.top.baseData.leftMenu.showDrawer||(this.top.baseData.leftMenu.showDrawer=!0),this.top.baseData.leftMenu.actMenu="fontSizeList"},setTypefaceUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(1===t.length){var e=Object(o.a)(t,1)[0];this.imgUrl=e.fontStyle.familyImg}t.length>1&&(this.imgUrl="")}}},f=v,m=(n(5225),Object(d.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"font-select-box flex_m",on:{click:t.showFontList}},[e("div",{staticClass:"img-item flex_m"},[e("img",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl,expression:"imgUrl"}],attrs:{src:t.imgUrl}}),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.imgUrl,expression:"!imgUrl"}]},[t._v(t._s(t.$t("typeface")))])]),t._v(" "),t._m(0)])}),[function(){var t=this._self._c;return t("div",{staticClass:"icon-item flex_c_m"},[t("i",{staticClass:"el-icon-arrow-down"})])}],!1,null,"70a47067",null).exports),_=n(14),y=n(76),w={inject:["top"],data:function(){return{num:12}},methods:{getIds:function(t){var e=this.top.getActiveLayer().map((function(t){return t.layerId}));e.length&&t&&t(e)},changeSize:function(t){var e=this;this.num=t,this.getIds((function(n){var o={fontStyle:{size:t}};e.top.setIdItem(n,o),e.$nextTick((function(){var t=n.map((function(t){return document.querySelector("#layer-".concat(t))}));y.a.emit("$E_updateLayerRect",t),e.top.setPosterInfoFn()}))}))},setLayerFontSize:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t.fontStyle.size})),e=Math.max.apply(Math,Object(_.a)(t));this.num=e||12}}},C=w,k=(n(5226),Object(d.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e("el-input-number",{staticClass:"my-input-number",attrs:{value:t.num,size:"mini",min:12,max:1e3,step:2,precision:0},on:{change:t.changeSize}})],1)}),[],!1,null,"d084fd14",null).exports),O=(n(18),n(2659),n(47),n(1151)),x=n.n(O),T=n(5227),S=(n(24),{props:{list:{type:Array,default:function(){return[]}},inx:{type:Number,default:0}},data:function(){return{}},computed:{item:function(){return this.list[this.inx]}},methods:{handleToo:function(){var t=this.list,e=this.inx;++e>t.length-1&&(e=0),this.$emit("onToggle",e)}}}),D=(n(5228),Object(d.a)(S,(function(){var t=this,e=t._self._c;return e("div",{on:{click:t.handleToo}},[e("i",{class:["iconfont","icon-item",t.item.icon],style:{fontSize:t.item.size+"px"}})])}),[],!1,null,"dc329440",null).exports),P={inject:["top"],directives:{Clickoutside:n(5229).a},components:{ToggleToo:D,ElColorPicker:x.a},data:function(){return{actTool:"fontColor",tools:T.a,color:"none"}},mounted:function(){document.addEventListener("click",this.handleClose)},beforeDestroy:function(){document.removeEventListener("click",this.handleClose)},methods:{updateStatus:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.tools,r=e.length;if(1===r){var l=Object(o.a)(e,1)[0],c={fontBold:"bold",fontItalic:"italic",underline:"underline",strikethrough:"strikeout",fontCase:"case"};n.forEach((function(e){var n=l.fontStyle[c[e.name]];if("fontColor"===e.name&&(t.color=l.fontStyle.color),"justifying"===e.name){e.actInx={left:0,center:1,right:2}[l.fontStyle.textAlign]}c[e.name]&&(e.active=n)}))}(r>1||0===r)&&(n.forEach((function(t){t.active=!1,"justifying"===t.name&&(t.actInx=0)})),this.color="none")},handleTool:function(t){var e=t.name;t.active=!t.active,this[e]&&this[e](t)},getIds:function(t){var e=this.top.getActiveLayer().map((function(t){return t.layerId}));e.length&&t&&t(e)},fontColor:function(t){t.active=!1},selectColor:function(t){this.top.getActiveLayer().filter((function(t){return"wordLayer"===t.type})).map((function(t){return document.querySelector("#layer-".concat(t.layerId))})).forEach((function(e){e.querySelector(".words-content-box").style.color=t}))},fontColorOk:function(t){var e=this;this.getIds((function(n){var o={fontStyle:{color:t}};e.top.setIdItem(n,o),e.top.setPosterInfoFn()}))},handleClose:function(){this.top.getActiveLayer().forEach((function(t){if("wordLayer"===t.type){var sub=document.querySelector("#layer-".concat(t.layerId)).querySelector(".words-content-box"),e=t.fontStyle.color;sub.style.color="none"===e?"#000":e}}))},fontBold:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{bold:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},fontItalic:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{italic:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},underline:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{underline:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},strikethrough:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{strikeout:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},fontCase:function(){},lock:function(){},toggleJustifying:function(t,e){var n=this,o=t.list[e];t.actInx=e,t.text=o.text,this.getIds((function(t){var e={fontStyle:{textAlign:o.name}};n.top.setIdItem(t,e),n.top.setPosterInfoFn()}))}}},I=P,$=(n(5230),{inject:["top"],components:{FontSelect:m,FontSizeNum:k,UseTools:Object(d.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tools-list-box flex"},t._l(t.tools,(function(n){return e("div",{key:n.name,staticClass:"tool-item flex_c_m",class:n.active&&"active"},[e("el-tooltip",{attrs:{effect:"dark",content:"".concat(t.$t(n.text))}},["fontColor"===n.name?[e("div",{staticClass:"color-item",on:{click:function(e){return t.handleTool(n)}}},[e("p",[t._v("A")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"none"===t.color,expression:"color === 'none'"}],staticClass:"line linein"}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"none"!==t.color,expression:"color !== 'none'"}],staticClass:"line",style:{background:t.color}}),t._v(" "),e("el-color-picker",{staticClass:"color-picker",attrs:{size:"mini"},on:{"active-change":t.selectColor,change:t.fontColorOk},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)]:t._e(),t._v(" "),"justifying"===n.name?[e("toggle-too",{attrs:{inx:n.actInx,list:n.list},on:{onToggle:function(e){t.toggleJustifying(n,e)}}})]:[e("i",{class:["iconfont","icon-item",n.icon],style:{fontSize:n.size+"px"},on:{click:function(e){return t.handleTool(n)}}})]],2)],1)})),0)}),[],!1,null,"272e3763",null).exports},data:function(){return{showFontTool:!1}},mounted:function(){y.a.on("$E_setToolsStatus",this.setToolsStatus),y.a.on("$E_toggleFontTool",this.toggleFontTool)},methods:{setToolsStatus:function(){var t=this.top.getActiveLayer();if(t.length){var e=this.$refs.FontSizeNumRef,n=this.$refs.UseToolsRef,o=this.$refs.FontSelectRef;e&&e.setLayerFontSize(t),n&&n.updateStatus(t),o&&o.setTypefaceUrl(t)}},toggleFontTool:function(){var t=this.top.baseData.eleList.filter((function(t){return"wordLayer"===t.type&&t.active}));this.showFontTool=!!t.length}}}),j=(n(5231),Object(d.a)($,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"middle-tool-box flex_c_m"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showFontTool,expression:"showFontTool"}],staticClass:"flex_c_m"},[e("font-select",{ref:"FontSelectRef"}),t._v(" "),e("font-size-num",{ref:"FontSizeNumRef"}),t._v(" "),e("use-tools",{ref:"UseToolsRef"})],1)])}),[],!1,null,"07069608",null).exports),L=(n(73),n(360)),M=n(1154),E={inject:["top"],components:{UserPopover:L.a},data:function(){return{}},methods:{toFeedback:function(){window.open("https://aihelp.net/questionnaire/#/?formId=6c101e48f801480eb2e97fd9d4fe5f0f","_blank")},fontCssStr:function(){var t=this.top.baseData.eleList.filter((function(t){return"wordLayer"===t.type&&"none"!==t.family})).map((function(t){var e=t.fontStyle;return'@font-face {\n          font-family: "'.concat(e.family,'";\n          src: url("').concat(e.familyPath,'")\n            format("truetype");\n          }')})),style=document.createElement("style");style.type="text/css",style.id="fontStyleTagId",style.innerHTML=t.join(""),document.body.appendChild(style)},leadingOut:function(){var t=this,e=this.top.baseData.whiteBoard.zoom,o=document.querySelector("#workScaleBoxid"),r=(new Date).getTime(),l=navigator.userAgent,c=l.indexOf("Safari")>-1&&-1===l.indexOf("Chrome");this.top.baseData.whiteBoard.zoom=100,this.top.exportLoading=!0,this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.$logEvent("log_actions",{operation:"click_export",behavior_info:"on_canvas_fuction_page"});var d=function(n){var link=document.createElement("a"),o=document.querySelector("#fontStyleTagId");t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1,o&&o.parentNode.removeChild(o),link.href=n,link.download=r+".png",link.click()};this.$nextTick((function(){c?n(634)(o,{dpi:300,useCORS:!0,allowTaint:!1,scale:1}).then((function(canvas){if(canvas){var t=canvas.toDataURL();d(t)}})).catch((function(){t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1})):(t.fontCssStr(),Object(M.a)(o).then((function(t){t&&d(t)})).catch((function(){t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1})))}))}}},F=(n(5232),{components:{LeftAction:h,MiddleTool:j,RightAction:Object(d.a)(E,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-action-box flex_m"},[e("div",{staticClass:"feed-back flex_c_m",on:{click:t.toFeedback}},[e("i",{staticClass:"iconfont icon-icon_wenjuan"}),t._v(" "),e("span",[t._v(t._s(t.$t("Feedback")))])]),t._v(" "),e("div",{staticClass:"publish-btn flex_c_m",on:{click:t.leadingOut}},[e("i",{staticClass:"iconfont icon-icon-daochu"}),t._v(" "),e("span",[t._v(t._s(t.$t("leadingOut")))])]),t._v(" "),t.top.token?e("UserPopover"):e("el-button",{staticClass:"login-btn"},[t._v("\n    "+t._s(t.$t("Login"))+"\n  ")])],1)}),[],!1,null,"df56eaa6",null).exports},data:function(){return{}}}),A=(n(5233),Object(d.a)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-nav-box flex"},[e("left-action"),t._v(" "),e("middle-tool"),t._v(" "),e("right-action")],1)}),[],!1,null,"0bc5324a",null).exports),N=(n(28),n(151),n(32),n(236)),R={props:{category:{type:Array,default:function(){return[]}},currentCategory:{type:String,default:"all"}},data:function(){return{categoryMoreName:"more"}},methods:{changeTag:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$emit("changeTag",t),this.categoryMoreName=n?null===(e=this.category.find((function(e){return e.value===t})))||void 0===e?void 0:e.label:"more"}}},B=R,U=(n(5234),Object(d.a)(B,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"category"},[t._l(t.category.filter((function(t){return null==t?void 0:t.isMore})),(function(n){return e("div",{key:n.value,staticClass:"item-category flex-center",class:{active:t.currentCategory===n.value},on:{click:function(e){return t.changeTag(n.value,!1)}}},[t._v("\n    "+t._s(t.$t(n.label))+"\n  ")])})),t._v(" "),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.changeTag}},[e("div",{staticClass:"item-category flex-center",class:{active:"more"!=t.categoryMoreName}},[t._v("\n      "+t._s(t.$t("".concat(t.categoryMoreName)))+"\n    ")]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.category.filter((function(t){return!(null!=t&&t.isMore)})),(function(n){return e("el-dropdown-item",{key:n.value,attrs:{command:n.value}},[t._v("\n        "+t._s(t.$t(null==n?void 0:n.label))+"\n      ")])})),1)],1)],2)}),[],!1,null,"92b37aee",null).exports),V=n(166);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var G={components:{CategoryTags:U},inject:["top"],data:function(){return{list:[],currentCategory:"all",category:[],categoryMoreName:"more",type:"normal",keywords:"",searchList:[],isHaveMore:!1,moreList:[],moreLoading:!1,paramsData:{page:1,page_size:50,category:"",type:1}}},mounted:function(){this.getList()},computed:H(H({},Object(l.c)("user",["cdnHostFun"])),{},{isShowClassify:function(){var t=this;return function(e){return(null==e?void 0:e.items.length)&&(t.currentCategory===e.category||"all"===t.currentCategory)}}}),methods:{getList:function(){var t=this;this.top.token&&(this.moreLoading=!0,Object(N.c)({type:1}).then((function(e){var n=e.data.items,o=void 0===n?[]:n;t.list=o.map((function(e){return e.label=t.initCategoryName(e.category),e})),t.initCategory(o),t.moreLoading=!1})))},initCategory:function(t){this.category=t.map((function(t,e){return{value:t.category,label:null==t?void 0:t.label,isMore:e<4}})),this.category.unshift({value:"all",label:"All",isMore:!0})},changeTag:function(t){this.currentCategory=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_material"),behavior_info:"on_canvas_detail_page"})},getMore:function(t){var e=this;this.moreLoading=!0,this.type="more",t&&(this.paramsData.category=t.category),Object(N.c)(this.paramsData).then((function(n){var data=n.data;e.isHaveMore?e.moreList=[{items:e.paramsData.page>1?e.moreList[0].items.concat(data):data,label:t?null==t?void 0:t.label:e.moreList[0].label}]:e.moreList=[{items:data,label:t.label}],e.isHaveMore=!(data.length<50),e.moreLoading=!1}))},closeSeeMore:function(){this.type="normal",this.moreList=[],this.paramsData.page=1,this.isHaveMore=!1},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.material,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getMore())}},initCategoryName:function(t){return"use"===t?"recentlyUsed":t.includes("/")?"canvas_".concat(t.split("/")[0]):"canvas_".concat(t)},keywordsChange:function(t){!t.target.value&&(this.type="normal")},search:function(){var t=this;this.keywords&&Object(N.c)({type:1,name:this.keywords}).then((function(e){t.type="search",t.searchList=(null==e?void 0:e.data)||[]}))},clear:function(){this.keywords="",this.searchList=[],this.type="normal"},handleUse:function(t){var e=this;if(!t)return this.$message.error();var n=t.id,o=void 0===n?"":n;Object(V.d)({url:t.image}).then((function(n){var r,l=n.realWidth,c=n.realHeight,d=n.renderWidth,h=n.renderHeight,v=e.top.baseData.eleList,f=Object(V.g)(v),param={type:"imgLayer",width:d,height:h,z:f,name:"".concat(e.$t("Layer")).concat(f),imgStyle:{imgSrc:t.image||"",realWidth:l,realHeight:c}},m=null===(r=e.list.find((function(t){return"use"==t.category})))||void 0===r?void 0:r.items;m.find((function(t){return(null==t?void 0:t.id)==o}))?Object(N.f)({id:o}).then((function(){e.top.initLayerStatus(),e.top.addLayerItem(param);var n=m.filter((function(t){return(null==t?void 0:t.id)!=o}));n.unshift(t),e.$set(e.list[0],"items",n)})):Object(N.f)({id:o}).then((function(){e.top.initLayerStatus(),e.top.addLayerItem(param),m.unshift(t)}))}))}}},z=(n(5235),Object(d.a)(G,(function(){var t=this,e=t._self._c;return e("div",{ref:"material",staticClass:"material-panel",on:{scroll:t.isScrollBottom}},[e("div",{directives:[{name:"show",rawName:"v-show",value:"more"!=t.type,expression:"type != 'more'"}],staticClass:"input-search"},[e("i",{staticClass:"iconfont icon-min-search",on:{click:t.search}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:t.$t("minSearch")},domProps:{value:t.keywords},on:{change:t.keywordsChange,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),t._v(" "),t.keywords.length>0?e("i",{staticClass:"el-icon-close",on:{click:t.clear}}):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"search"==t.type,expression:"type == 'search'"}],staticClass:"search-box"},[t.searchList.length?e("div",{staticClass:"search-content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("SearchResults")))]),t._v(" "),e("div",{staticClass:"content-box"},t._l(t.searchList,(function(n){return e("div",{key:null==n?void 0:n.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:(null==n?void 0:n.image)||"",alt:"image"}})])})),0)]):e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("NoSearchResultsTip")))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"more"==t.type,expression:"type == 'more'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("div",{staticClass:"classify-container"},t._l(t.moreList,(function(n){return e("div",{key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",{on:{click:t.closeSeeMore}},[e("i",{staticClass:"iconfont icon-back"}),t._v(t._s(t.$t(null==n?void 0:n.label)))])]),t._v(" "),e("div",{staticClass:"content-box"},t._l(n.items,(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"normal"==t.type,expression:"type == 'normal'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("CategoryTags",{attrs:{currentCategory:t.currentCategory,category:t.category},on:{changeTag:t.changeTag}}),t._v(" "),e("div",{staticClass:"classify-container"},t._l(t.list,(function(n,o){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowClassify(n),expression:"isShowClassify(classify)"}],key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",[t._v(t._s(t.$t(null==n?void 0:n.label)))]),t._v(" "),"use"!=n.category?e("span",{staticClass:"text",on:{click:function(e){return t.getMore(n,o)}}},[t._v(t._s(t.$t("viewMore")))]):t._e()]),t._v(" "),n.isHaveMore?t._e():e("div",{staticClass:"content-box"},t._l(n.items.filter((function(t){return null==t?void 0:t.id})),(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)],1)])}),[],!1,null,"6dbed654",null)),Y=z.exports,J=(n(3474),{inject:["top"],data:function(){return{}},methods:{handleWord:function(t){var text=t.text,e=t.size,n=t.bold,o=this.top.baseData.eleList,r=Object(V.g)(o),l="<div>".concat(this.$t(text),"</div>"),param={type:"wordLayer",z:r,name:"".concat(this.$t("Layer")).concat(r),fontStyle:{innerHTML:l,size:e,bold:n}};this.top.initLayerStatus(),this.top.addLayerItem(param)},lookFontStyle:function(){this.top.baseData.leftMenu.actMenu="fontSizeList"}}}),K=(n(5236),Object(d.a)(J,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"works-panel-box"},[e("div",{staticClass:"add-words-btn flex_c_m",on:{click:function(e){return t.handleWord({text:"addMintext",size:24,bold:!1})}}},[t._v("\n    "+t._s(t.$t("addWordsBox"))+"\n  ")]),t._v(" "),e("div",{staticClass:"words-title flex_m"},[e("div",{staticClass:"left"},[t._v(t._s(t.$t("wordsStyleInit")))]),t._v(" "),e("div",{staticClass:"right",on:{click:t.lookFontStyle}},[t._v(t._s(t.$t("viewMore"))+" >")])]),t._v(" "),e("div",{staticClass:"words-list-box"},[e("div",{staticClass:"item",staticStyle:{"font-size":"28px"},on:{click:function(e){return t.handleWord({text:"addTitleText",size:120,bold:!0})}}},[t._v("\n      "+t._s(t.$t("addTitleText"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item",staticStyle:{"font-size":"18px"},on:{click:function(e){return t.handleWord({text:"addTitlefuText",size:50,bold:!0})}}},[t._v("\n      "+t._s(t.$t("addTitlefuText"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item",staticStyle:{"font-size":"14px"},on:{click:function(e){return t.handleWord({text:"addWordsText",size:24,bold:!1})}}},[t._v("\n      "+t._s(t.$t("addWordsText"))+"\n    ")])])])}),[],!1,null,"ee159ad4",null).exports),Q=n(3),X=(n(20),n(49),n(51)),Z=n(61),tt={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:20,category:"posterLocalMaterials",type:2},isHaveMore:!1,isUploading:!1,UPLOAD:new X.a({type:35})}},mounted:function(){this.top.token&&this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(N.c)(this.paramsData).then((function(e){var data=e.data,n=t.paramsData,o=n.page,r=n.page_size;t.list=o>1?t.list.concat(data):data,t.isHaveMore=!(data.length<r),t.loading=!1}))},addProductImg:function(t){var e=this,image=t.image;Object(V.d)({url:image}).then((function(t){var n=t.realWidth,o=t.realHeight,r=t.renderWidth,l=t.renderHeight,c=e.top.baseData.eleList,d=Object(V.g)(c),param={type:"imgLayer",width:r,height:l,z:d,name:"".concat(e.$t("Layer")).concat(d),imgStyle:{imgSrc:image||"",realWidth:n,realHeight:o}};e.top.initLayerStatus(),e.top.addLayerItem(param)}))},handleBeforeUpload:function(t){var e=this;return Object(Q.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=["image/jpeg","image/png","image/jpg","image/webp"],!e.isUploading){n.next=3;break}return n.abrupt("return");case 3:if(o.includes(t.type)){n.next=6;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 6:if(!t||t.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(!(t.size/1024/1024>10)){n.next=19;break}return n.prev=9,n.next=12,Object(Z.a)(t,10485760);case 12:t=n.sent,n.next=19;break;case 15:return n.prev=15,n.t0=n.catch(9),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 19:return e.isUploading=!0,e.UPLOAD.startUpload(t).then((function(t){e.saveToList(t)})).finally((function(){e.isUploading=!1})),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[9,15]])})))()},saveToList:function(image){var t=this,param={items:[{category:"posterLocalMaterials",image:image,name:""}]};Object(N.g)(param).then((function(e){t.$message.success(t.$t("UploadSuccess")),setTimeout((function(){t.isUploading=!1,t.getList()}),1e3)}))},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){Object(N.a)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},handleDownload:function(t){var img=new Image;img.crossOrigin="anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="product.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},this.$message.success(this.$t("OperateSuccess"))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.product,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},et=(n(5237),Object(d.a)(tt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"product",staticClass:"product",on:{scroll:t.isScrollBottom}},[e("div",{staticClass:"product-list"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.isUploading,expression:"isUploading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"product-list-item",attrs:{action:"#","before-upload":t.handleBeforeUpload,disabled:t.isUploading,accept:".jpg, .jpeg, .png, .webp","http-request":function(){},"show-file-list":!1}},[e("div",{attrs:{slot:"trigger"},slot:"trigger"},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",{staticClass:"upload-text"},[t._v(t._s(t.$t("SelectingMaterials")))])])]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"product-list-item",on:{click:function(e){return t.addProductImg(n)}}},[e("img",{attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon right36",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-delete"})]),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownload(n.image)}}},[e("i",{staticClass:"el-icon-download"})])])}))],2)])}),[],!1,null,"a3db745c",null).exports);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var nt={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:50,category:"mine",type:2},isHaveMore:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["cdnHostFun"])),mounted:function(){this.top.token&&this.getList(),y.a.on("$E_getMineList",this.getList)},methods:{getList:function(){var t=this;this.loading=!0,Object(N.c)(this.paramsData).then((function(e){var data=e.data;t.list=t.paramsData.page>1?t.list.concat(data):data,t.isHaveMore=!(data.length<50),t.loading=!1}))},handleUse:function(t){var e=this,image=t.image;Object(V.d)({url:image}).then((function(t){var n=t.realWidth,o=t.realHeight,r=t.renderWidth,l=t.renderHeight,c=e.top.baseData.eleList,d=Object(V.g)(c),param={type:"imgLayer",width:r,height:l,z:d,name:"".concat(e.$t("Layer")).concat(d),imgStyle:{imgSrc:image||"",realWidth:n,realHeight:o}};e.top.initLayerStatus(),e.top.addLayerItem(param)}))},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){try{Object(N.a)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))}catch(t){console.log(t)}})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.minematerial,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},at=nt,ot=(n(5238),Object(d.a)(at,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"minematerial",staticClass:"mine-panel",on:{scroll:t.isScrollBottom}},[t.list.length?e("div",{staticClass:"content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("All")))]),t._v(" "),e("div",{staticClass:"materials"},t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"item-material",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"item-material-icon flex_c_m",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-close"})])])})),0)]):t._e(),t._v(" "),0!==t.list.length||t.loading?t._e():e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("no_data")))])])])}),[],!1,null,"1554b44c",null).exports);n(50),n(122);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct={inject:["top"],data:function(){return{}},computed:lt(lt({},Object(l.c)("user",["cdnHostFun"])),{},{renderLayer:function(){return this.top.baseData.eleList.sort((function(a,b){return b.z-a.z}))},getActiveList:function(){return this.top.baseData.eleList.filter((function(t){return t.active}))||[]},selectedLayer:function(){return this.getActiveList.map((function(t){return t.layerId}))},operationBtns:function(){return[{type:"copy",hoverTips:"copy",icon:"el-icon-document-copy"},{type:"down",hoverTips:"MoveDown",icon:"el-icon-arrow-down",hide:1!=this.selectedLayer.length},{type:"up",hoverTips:"MoveUp",icon:"el-icon-arrow-up",hide:1!=this.selectedLayer.length},{type:"delete",hoverTips:"canvas_delete_hover",icon:"el-icon-delete"}]}}),mounted:function(){y.a.on("$E_downLayer",this.downLayer),y.a.on("$E_upLayer",this.upLayer),y.a.on("$E_copyLayer",this.copyLayer),y.a.on("$E_deleteLayer",this.deleteLayer),y.a.on("$E_toTopLayer",this.toTopLayer),y.a.on("$E_toBottomLayer",this.toBottomLayer)},methods:{handleClick:function(t){this.top.initLayerStatus(),t.active=!0,y.a.emit("$E_LayerTopShowArea"),y.a.emit("$E_setActiveLayerList")},handleOperations:function(t){this["".concat(t,"Layer")]()},downLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e})),r=this.renderLayer.length-1;if(n<r){n+=1;var l=this.renderLayer[n].layerId;this.top.setLayerReplace({oid:e,tid:l,keys:["z"]})}else n=r;this.top.setPosterInfoFn()},upLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e}));if(n>0){n-=1;var r=this.renderLayer[n].layerId;this.top.setLayerReplace({oid:e,tid:r,keys:["z"]})}else n=0;this.top.setPosterInfoFn()},toTopLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e})),r=this.renderLayer.filter((function(t,i){return i<n})).map((function(t){return t.layerId})),l=this.renderLayer[0].z;this.top.baseData.eleList.forEach((function(t){r.includes(t.layerId)&&(t.z-=1)})),this.top.setIdItem([e],{z:l})},toBottomLayer:function(){var t=this.renderLayer.length-1,e=this.top.getActiveIds(),n=Object(o.a)(e,1)[0],r=this.renderLayer.findIndex((function(t){return t.layerId===n})),l=this.renderLayer.filter((function(t,i){return i>r})).map((function(t){return t.layerId})),c=this.renderLayer[t].z;this.top.baseData.eleList.forEach((function(t){l.includes(t.layerId)&&(t.z+=1)})),this.top.setIdItem([n],{z:c})},copyLayer:function(){var t=this,e=this.top.getActiveLayer();this.top.initLayerStatus(),e.forEach((function(e){var n=t.top.baseData.eleList,o=Object(V.g)(n),r=JSON.parse(JSON.stringify(e));r.z=o,r.name="".concat(t.$t("Layer")).concat(o),r.x+=20,r.y+=20,t.top.addLayerItem(r)})),this.top.setPosterInfoFn()},deleteLayer:function(){var t=this.top.baseData.eleList.filter((function(t){return!1===t.active}));this.top.baseData.eleList=t,y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.top.setPosterInfoFn()},showLayer:function(t){t.show=!t.show,t.active=!1},lockLayer:function(t){t.lock=!t.lock,t.active=!1}}},ut=(n(5239),Object(d.a)(ct,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"layer-list-max"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.renderLayer.length>0,expression:"renderLayer.length > 0"}],staticClass:"title"},[t._v(t._s(t.$t("Layer")))]),t._v(" "),e("div",{staticClass:"list-box"},[t._l(t.renderLayer,(function(n){return e("div",{key:n.layerId,staticClass:"item flex_c_m",class:n.active&&"iacitve"},[e("div",{staticClass:"left flex_c_m"},[e("i",{staticClass:"iconfont",class:n.show?"icon-work-show":"icon-work-hide",on:{click:function(e){return t.showLayer(n)}}})]),t._v(" "),e("div",{staticClass:"center flex_m",on:{click:function(e){return t.handleClick(n)}}},["imgLayer"===n.type?[e("img",{staticClass:"la-img",attrs:{src:n.imgStyle.imgSrc,alt:"layer"}})]:t._e(),t._v(" "),"wordLayer"===n.type?[e("i",{staticClass:"iconfont icon-icon-T word-icon"})]:t._e(),t._v(" "),e("span",{staticClass:"la-name"},[t._v(t._s(n.name))])],2),t._v(" "),e("div",{staticClass:"right flex_c_m"})])})),t._v(" "),0===t.renderLayer.length?e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("no_data")))])]):t._e()],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.selectedLayer.length,expression:"selectedLayer.length"}],staticClass:"bottom-btns flex_c_m"},t._l(t.operationBtns,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:!n.hide,expression:"!item.hide"}],key:n.type,staticClass:"item-btn flex_c_m",on:{click:function(e){return t.handleOperations(n.type)}}},[e("el-tooltip",{attrs:{effect:"dark",disabled:!n.hoverTips,content:t.$t(n.hoverTips)}},[e("i",{class:n.icon})])],1)})),0)])}),[],!1,null,"77bc237e",null).exports),pt=(n(5240),n(5241)),ht={inject:["top"],components:{Tree:n.n(pt).a},data:function(){return{list:[],defaultProps:{children:"fonts",label:"label"}}},mounted:function(){this.getFontList()},methods:{getFontList:function(){var t=this;Object(N.b)({}).then((function(e){t.list=e.data.items}))},handleNodeClick:function(t){var e=this,n=this.top.getActiveIds(),o=t.file_path,label=t.label,r=t.cover;if(n.length&&o){var l=new FontFace(label,"url(".concat(o,")"));this.top.setIdItem(n,{loading:!0}),l.load().then((function(){e.top.setIdItem(n,{loading:!1,fontStyle:{family:label,familyPath:o,familyImg:r}}),document.fonts.add(l),e.top.setPosterInfoFn(),y.a.emit("$E_setToolsStatus")}))}}}},vt=(n(5242),{inject:["top"],components:{MaterialPanel:Y,WordsPanel:K,UploadPanel:et,MinePanel:ot,LayerList:ut,FontList:Object(d.a)(ht,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"font-list-page"},[e("tree",{staticClass:"font-el-tree",attrs:{data:t.list,props:t.defaultProps,"empty-text":t.$t("no_data"),accordion:"","highlight-current":!0},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.node;return e("div",{},[o.data.cover?t._e():e("div",{staticClass:"tree-item"},[e("span",[t._v(t._s(o.label))])]),t._v(" "),o.data.cover?e("div",{staticClass:"tree-item"},[e("img",{attrs:{src:o.data.cover}})]):t._e()])}}])})],1)}),[],!1,null,"affa6b3c",null).exports},data:function(){return{}},computed:{leftMenu:function(){return this.top.baseData.leftMenu}},methods:{toggleMenuBard:function(){var t=this.top.baseData.leftMenu.showDrawer;this.top.baseData.leftMenu.showDrawer=!t},toggleLayerList:function(){this.top.baseData.leftMenu.showDrawer||(this.top.baseData.leftMenu.showDrawer=!0),this.top.baseData.leftMenu.actMenu="layerList"}}}),ft=(n(5243),{inject:["top"],components:{LeftDrawer:Object(d.a)(vt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-drawer",class:t.leftMenu.showDrawer?"show-menu":"hide-menu"},["material"===t.leftMenu.actMenu?e("MaterialPanel"):t._e(),t._v(" "),"characters"===t.leftMenu.actMenu?e("WordsPanel"):t._e(),t._v(" "),"upload"===t.leftMenu.actMenu?e("UploadPanel"):t._e(),t._v(" "),"mine"===t.leftMenu.actMenu?e("MinePanel"):t._e(),t._v(" "),e("LayerList",{directives:[{name:"show",rawName:"v-show",value:"layerList"===t.leftMenu.actMenu,expression:"leftMenu.actMenu === 'layerList'"}]}),t._v(" "),e("FontList",{directives:[{name:"show",rawName:"v-show",value:"fontSizeList"===t.leftMenu.actMenu,expression:"leftMenu.actMenu === 'fontSizeList'"}]}),t._v(" "),e("div",{staticClass:"open-btn",on:{click:t.toggleMenuBard}},[e("i",{class:"el-icon-arrow-".concat(t.leftMenu.showDrawer?"left":"right")})]),t._v(" "),e("div",{staticClass:"layer-btn flex_c_m",on:{click:t.toggleLayerList}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("Layer")}},[e("i",{staticClass:"iconfont icon-icon_tuceng"})])],1)],1)}),[],!1,null,"2e7396a6",null).exports},data:function(){return{menuList:[{label:"Material",name:"material",icon:"icon-icon_sucai",size:18},{label:"seoEraser_example_text",name:"characters",icon:"icon-icon-T",size:22},{label:"Upload",name:"upload",icon:"icon-icon-upload",size:22},{label:"Mine",name:"mine",icon:"icon-icon_wode",size:18}]}},methods:{changeMenu:function(t){this.top.baseData.leftMenu.showDrawer=!0,this.top.baseData.leftMenu.actMenu=t.name}}}),mt=(n(5244),Object(d.a)(ft,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-menu-box"},[e("div",{staticClass:"menu-list"},t._l(t.menuList,(function(n){return e("div",{key:n.label,staticClass:"item",class:{active:t.top.baseData.leftMenu.actMenu===n.name},on:{click:function(e){return t.changeMenu(n)}}},[e("div",{staticClass:"icon"},[e("i",{staticClass:"iconfont",class:n.icon,style:{fontSize:n.size+"px"}})]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t(n.label)))])])})),0),t._v(" "),e("left-drawer")],1)}),[],!1,null,"02b26bc2",null).exports),gt=(n(92),n(321)),_t=n(265),yt=(n(5705),n(98)),bt=n(208),wt={inject:["top"],name:"WordItem",components:{LineLoading:bt.default},props:{item:{type:Object,default:function(){return{}}},moveableRef:{type:Object,default:function(){return{}}},comKey:{type:String,default:""}},data:function(){return{fsize:40,updateTextDataFn:Object(yt.a)(this.updateTextData,1e3)}},computed:{FS:function(){return this.item.fontStyle},textDecoration:function(){var t=this.item.fontStyle;return[t.underline?"underline":"",t.strikeout?"line-through":""].filter((function(t){return""!==t})).join(" ")}},methods:{changeText:function(t){var e=this.item,n=document.querySelector("#layer-".concat(e.layerId)),o=n.querySelector(".words-content-box").clientHeight;n.style.height="".concat(o,"px"),this.moveableRef.updateRect()},updateTextData:function(t){var e=t.htmlStr,n=t.width,o=t.height,r=this.item.layerId,l={width:n,height:o,fontStyle:{innerHTML:e}};this.top.setIdItem([r],l),this.top.setPosterInfo()},blurText:function(t){var e=this.item,n=document.querySelector("#layer-".concat(e.layerId)),o=t.target.innerHTML,r=n.style,l=r.width,c=r.height,param={htmlStr:o,width:parseInt(l.trim()),height:parseInt(c.trim())};this.updateTextData(param)}}},Ct=(n(5245),Object(d.a)(wt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.item.show,expression:"item.show"}],staticClass:"word-item-box layer-item",style:{zIndex:t.item.z,width:0===t.item.width?"auto":"".concat(t.item.width,"px"),height:0===t.item.height?"auto":"".concat(t.item.height,"px"),transform:"translate(".concat(t.item.x,"px, ").concat(t.item.y,"px) rotate(").concat(t.item.rotate,"deg)")},attrs:{id:"layer-".concat(t.item.layerId),"data-id":t.item.layerId,"data-type":t.item.type,"data-lock":t.item.lock+""}},[e("div",{staticClass:"words-content-box",style:{fontSize:t.FS.size+"px",color:"none"===t.FS.color?"#000":t.FS.color,fontWeight:t.FS.bold?"bold":"unset",fontStyle:t.FS.italic?"italic":"unset",textDecoration:t.textDecoration,textAlign:t.FS.textAlign,fontFamily:t.FS.family},attrs:{contenteditable:t.item.active},domProps:{innerHTML:t._s(t.FS.innerHTML)},on:{input:t.changeText,blur:t.blurText}}),t._v(" "),e("line-loading",{directives:[{name:"show",rawName:"v-show",value:t.item.loading,expression:"item.loading"}],staticClass:"loding-box"})],1)}),[],!1,null,"562501cd",null).exports),kt={name:"ImgItem",props:{item:{type:Object,default:function(){return{}}},comKey:{type:String,default:""}},data:function(){return{}},methods:{onResize:function(t){t.target.style.width="".concat(t.width,"px"),t.target.style.height="".concat(t.height,"px"),t.target.style.transform=t.drag.transform}}},Ot=(n(5246),Object(d.a)(kt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.item.show,expression:"item.show"}],staticClass:"img-item-box layer-item",style:{zIndex:t.item.z,width:t.item.width+"px",height:t.item.height+"px",transform:"translate(".concat(t.item.x,"px, ").concat(t.item.y,"px) rotate(").concat(t.item.rotate,"deg)")},attrs:{id:"layer-".concat(t.item.layerId),"data-id":t.item.layerId,"data-type":t.item.type,"data-lock":t.item.lock+""}},[e("img",{staticClass:"img-tag",attrs:{src:t.item.imgStyle.imgSrc}})])}),[],!1,null,"77769a5f",null).exports),xt={inject:["top"],data:function(){return{}},computed:{board:function(){return this.top.baseData.whiteBoard}},methods:{changeSize:function(t,e){this.top.baseData.whiteBoard[e]=t,this.top.baseData.whiteBoard.x=0,this.top.baseData.whiteBoard.y=0,this.top.setPosterInfoFn()},resizeBoard:function(){var t=this;this.$confirm(this.$t("posterRemoveTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){t.top.baseData.eleList=[],t.top.setPosterInfoFn()})).catch((function(){t.$message({type:"info",message:t.$t("Cancel")})}))}}},Tt=(n(5247),Object(d.a)(xt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"board-title-nav flex_m"},[e("div",{staticClass:"left flex"},[e("div",{staticClass:"box"},[e("span",{staticClass:"words"},[t._v("W")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.board.width,step:1,precision:0,controls:!1,min:t.board.min,max:t.board.max},on:{change:function(e){return t.changeSize(e,"width")}}})],1),t._v(" "),e("div",{staticClass:"box"},[e("span",{staticClass:"words"},[t._v("H")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.board.height,step:1,precision:0,controls:!1,min:t.board.min,max:t.board.max},on:{change:function(e){return t.changeSize(e,"height")}}})],1)]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"btn-item flex_m",on:{click:t.resizeBoard}},[e("i",{staticClass:"iconfont icon-zhonghui"}),t._v(" "),e("span",[t._v(t._s(t.$t("S_ResetPrompt")))])])])])}),[],!1,null,"362dea9c",null).exports),St={inject:["top"],data:function(){return{offset:{left:-1e3,top:-1e3},btnList:[{label:"",type:"copy",icon:"icon-copy-ops"},{label:"",type:"del",icon:"icon-delete-gpt"},{label:"",type:"more",icon:"icon-editModel"}]}},mounted:function(){y.a.on("$E_LayerTopShowArea",this.showArea),y.a.on("$E_LayerTopHideArea",this.hideArea)},methods:{showArea:function(){var t=this,e=this.top.getActiveLayer();if(0===e.length)return this.offset.left=-1e3,void(this.offset.top=-1e3);if(1===e.length){var n=Object(o.a)(e,1)[0],r=document.querySelector("#layer-".concat(n.layerId)).getBoundingClientRect();this.offset.left=r.x,this.offset.top=r.y-50}e.length>1&&setTimeout((function(){var e=document.querySelector(".moveable-area").getBoundingClientRect();t.offset.left=e.x,t.offset.top=e.y-50}),300)},hideArea:function(){this.offset.left=-1e3,this.offset.top=-1e3},handMoer:function(t){var e=t.pageX,n=t.pageY,r=this.top.getActiveLayer();if(1===r.length){var l=Object(o.a)(r,1)[0],param={target:document.querySelector("#layer-".concat(l.layerId)),pageX:e,pageY:n};y.a.emit("$E_showRightMenu",param)}if(r.length>1){var c={target:document.querySelector(".moveable-area"),pageX:e,pageY:n};y.a.emit("$E_showRightMenu",c)}},layercopy:function(){var t=this;y.a.emit("$E_copyLayer"),this.$nextTick((function(){t.showArea()}))},layerdel:function(){y.a.emit("$E_deleteLayer"),this.hideArea()},handTopItem:function(t,e){var n=e.type;"more"!==n?this["layer".concat(n)]():this.handMoer(t)}}},Dt=(n(5248),Object(d.a)(St,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-area-box",style:{left:t.offset.left+"px",top:t.offset.top+"px"},attrs:{"data-darg":"no"}},[e("div",{staticClass:"btn-list flex",attrs:{"data-darg":"no"}},t._l(t.btnList,(function(n){return e("div",{key:n.type,staticClass:"item flex_c_m",attrs:{"data-darg":"no"},on:{click:function(e){return t.handTopItem(e,n)}}},[e("i",{class:["iconfont",n.icon],attrs:{"data-darg":"no"}})])})),0)])}),[],!1,null,"0db03504",null).exports),Pt=n(3186);function It(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?It(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var jt={inject:["top"],data:function(){return{offset:{left:-1e3,top:-1e3},singleArr:[],rightEvent:null}},mounted:function(){y.a.on("$E_showRightMenu",this.showRightMenu),y.a.on("$E_hideRightMenu",this.closeMenu),document.body.appendChild(this.$refs.rightMenuRef),document.addEventListener("click",this.closeMenu)},beforeDestroy:function(){document.body.removeChild(this.$refs.rightMenuRef),document.removeEventListener("click",this.closeMenu)},methods:{showRightMenu:function(t){var e,n=t.target,r=t.pageY,l=t.pageX,c=Object(V.c)(n,"layer-item");if(!this.top.baseData.whiteBoard.isHandBoard){if(this.rightEvent=t,c){var d=c.getAttribute("data-id"),h=c.getAttribute("data-type"),v=this.top.getIdlayer([d]);Object(o.a)(v,1)[0];this.singleArr=Pt.b,this.singleArr.forEach((function(t){"saveToMyGallery"===t.value&&(t.show="imgLayer"===h)})),this.top.initLayerStatus(),this.top.setIdItem([d],{active:!0}),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),this.offset.left=l,this.offset.top=r}(null==n||null===(e=n.classList)||void 0===e?void 0:e.contains("moveable-area"))&&(this.singleArr=Pt.a,this.offset.left=l,this.offset.top=r)}},closeMenu:function(t){(null==t?void 0:t.target)&&"no"===t.target.getAttribute("data-darg")||(this.offset.left=-1e3,this.offset.top=-1e3)},saveMyimgs:function(){var t=this,e=this.top.getActiveLayer(),param={items:[{category:"mine",image:Object(o.a)(e,1)[0].imgStyle.imgSrc}]};Object(N.g)(param).then((function(e){t.$message.success(t.$t("OperateSuccess")),y.a.emit("$E_getMineList")}))},handItem:function(t){var e=t.value;"saveToMyGallery"===e&&this.saveMyimgs(),"copy"===e&&(y.a.emit("$E_copyLayer"),this.$nextTick((function(){y.a.emit("$E_LayerTopShowArea")}))),"Delete"===e&&(y.a.emit("$E_deleteLayer"),y.a.emit("$E_LayerTopHideArea")),"toTop"===e&&y.a.emit("$E_toTopLayer"),"toBottom"===e&&y.a.emit("$E_toBottomLayer"),"moveUp"===e&&y.a.emit("$E_upLayer"),"moveDown"===e&&y.a.emit("$E_downLayer"),this.$emit("onRightItem",$t($t({},t),{},{event:this.rightEvent})),this.$emit("E_LayerTopHideArea")}}},Lt=(n(5249),Object(d.a)(jt,(function(){var t=this,e=t._self._c;return e("div",{ref:"rightMenuRef",staticClass:"right-menu-box",style:{left:t.offset.left+"px",top:t.offset.top+"px"}},t._l(t.singleArr,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:n.show,expression:"item.show"}],key:n.upscale,staticClass:"menu-item flex_m"},[e("div",{staticClass:"left",on:{click:function(e){return t.handItem(n)}}},[t._v(t._s(t.$t(n.label)))]),t._v(" "),e("div",{staticClass:"right",on:{click:function(e){return t.handItem(n)}}},[e("i",{staticClass:"ri-icon",class:n.rightIcon})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.children,expression:"item.children"}],staticClass:"sub-list"},t._l(n.children,(function(sub){return e("div",{key:sub.value,staticClass:"menu-item flex_m"},[e("div",{staticClass:"left",on:{click:function(e){return t.handItem(sub)}}},[t._v(t._s(t.$t(sub.label)))]),t._v(" "),e("div",{staticClass:"right",on:{click:function(e){return t.handItem(sub)}}},[e("i",{staticClass:"ri-icon",class:sub.rightIcon})])])})),0)])})),0)}),[],!1,null,"1756da9c",null).exports),Mt=n(1230),Et={corner:!1,bothSides:!1},Ft={},At={inject:["top"],components:{Selecto:gt.a,Moveable:_t.a,LayerWords:Ct,LayerImage:Ot,BoardTitle:Tt,RightMenu:Lt,LayerTopArea:Dt},data:function(){return{moveableRef:null,moveableProps:{draggable:!0,rotatable:!0,origin:!1,scalable:!1,resizable:!0,rotationPosition:"bottom"},keepRatio:!1,renderDirections:["nw","n","ne","w","e","sw","s","se"],dragging:!1,translate:{x1:0,y1:0},targets:[]}},computed:{eleList:function(){return this.top.baseData.eleList},zoom:function(){return this.top.baseData.whiteBoard.zoom/100},board:function(){return this.top.baseData.whiteBoard}},mounted:function(){this.moveableRef=this.$refs.moveableRef,y.a.on("$E_updateLayerRect",this.updateLayerRect),y.a.on("$E_setActiveLayerList",this.setActiveLayerList)},methods:{onSelectStart:function(t){var e=this.$refs.moveableRef,n=t.inputEvent.target,o=e.isMoveableElement(n),r=this.targets.some((function(t){return t===n||t.contains(n)})),l="true"===n.getAttribute("data-lock"),c=this.board.isHandBoard,d="no"===n.getAttribute("data-darg");(o||r||l||c||d)&&t.stop()},onSelectEnd:function(t){var e=this.$refs.moveableRef,n=t.selected;t.isDragStart&&(t.inputEvent.preventDefault(),e.waitToChangeTarget().then((function(){e.dragStart(t.inputEvent)}))),window.getSelection().removeAllRanges();var r=this.top.baseData.eleList,l=void 0===r?[]:r;if(this.top.initLayerStatus(),n.forEach((function(t){var e=t.getAttribute("data-id"),n=l.find((function(t){var n=t.layerId===e,o=!t.lock;return n&&o}));n&&(n.active=!0)})),1===n.length){var c=Object(o.a)(n,1)[0].getAttribute("data-type");"wordLayer"===c&&(this.renderDirections=["nw","ne","w","e","sw","se"]),"imgLayer"===c&&(this.renderDirections=["nw","n","ne","w","e","sw","s","se"])}this.setActiveLayerList(),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),y.a.emit("$E_LayerTopShowArea")},setActiveLayerList:function(){var t=this;this.$nextTick((function(){var e=t.top.baseData.eleList,n=[];e.forEach((function(t){var e=t.active,o=t.layerId,r=document.querySelector("#layer-".concat(o));e&&r&&n.push(r)})),t.targets=n}))},onRender:function(t){t.target.style.cssText+=t.cssText,y.a.emit("$E_LayerTopHideArea"),y.a.emit("$E_hideRightMenu")},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText})),y.a.emit("$E_LayerTopHideArea"),y.a.emit("$E_hideRightMenu")},clickItem:function(t){var e=t.target;"wordLayer"===e.getAttribute("data-type")&&setTimeout((function(){var t=e.querySelector(".words-content-box");t&&t.focus()}),0)},onClickGroup:function(t){this.$refs.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},dragLogic:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(V.f)(t.lastEvent.transform).translate,r=Object(o.a)(n,2),l=r[0],c=r[1];this.top.setIdItem([e],{x:l,y:c})}},onDragEnd:function(t){this.dragLogic(t),this.top.setPosterInfoFn(),y.a.emit("$E_LayerTopShowArea")},onDragGroupEnd:function(t){var e=this;t.events.forEach((function(em){e.dragLogic(em)})),this.top.setPosterInfoFn(),y.a.emit("$E_LayerTopShowArea")},rotateLogic:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(V.f)(t.lastEvent.afterTransform),r=n.rotate,l=n.translate,c=Object(o.a)(l,2),d=c[0],h=c[1];this.top.setIdItem([e],{rotate:r,x:d,y:h})}},onRotateEnd:function(t){this.rotateLogic(t),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},onRotateGroupEnd:function(t){var e=this;t.events.forEach((function(em){e.rotateLogic(em)})),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},resizeStartLogic:function(t,e){var n=Object(Mt.a)(e),o=n.corner,r=n.bothSides;Et.corner=o,Et.bothSides=r,Ft=Object(Mt.b)(t),this.keepRatio=o},onResizeStart:function(t){this.resizeStartLogic([t.target],t.direction),t.setMin([10,10])},orResizeGroupStart:function(t){this.resizeStartLogic(t.targets,t.direction),t.setMin([50,50])},resizeLogic:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Et.corner,n=Et.bothSides;e&&(t.forEach((function(t){var e=t.target,n=t.width,o=e.getAttribute("data-id");"wordLayer"===e.getAttribute("data-type")&&(Ft[o].afterWidth=n)})),Object(Mt.c)(Ft)),n&&t.forEach((function(t){var e=t.target,n=t.width,o=e.getAttribute("data-id");if("wordLayer"===e.getAttribute("data-type")){var r=Ft[o].beforeSize;Ft[o].afterWidth=n,Ft[o].afterSize=r||12}}))},onResize:function(t){this.resizeLogic([t])},onResizeGroup:function(t){this.resizeLogic(t.events)},updateLayerRect:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){var n=e.getAttribute("data-type"),r=e.getAttribute("data-id");if("imgLayer"===n){var l=e.style,c=l.transform,d=l.width,h=l.height,v=Object(V.f)(c).translate,f=Object(o.a)(v,2),m=f[0],_=f[1],y={width:parseInt(d.trim()),height:parseInt(h.trim()),x:m,y:_};t.top.setIdItem([r],y)}if("wordLayer"===n){var w=e.querySelector(".words-content-box");if(!w)return;var C=w.clientHeight,k=w.clientWidth;e.style.height="".concat(C,"px"),e.style.width="".concat(k,"px");var O=e.style,x=O.transform,T=O.width,S=O.height,D=Object(V.f)(x).translate,P=Object(o.a)(D,2),I=P[0],$=P[1],j=w.style.fontSize,L={width:parseInt(T.trim()),height:parseInt(S.trim()),x:I,y:$,fontStyle:{size:parseInt(j.trim())}};t.top.setIdItem([r],L)}})),e.some((function(t){return"wordLayer"===t.getAttribute("data-type")}))&&y.a.emit("$E_setToolsStatus"),this.moveableRef.updateRect()},onResizeEnd:function(t){this.updateLayerRect([t.target]),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},onResizeGroupEnd:function(t){var e=t.events.map((function(em){return em.target}));this.updateLayerRect(e),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},startDrag:function(t){var e=this.top.baseData.whiteBoard,n=e.x,o=e.y;e.isHandBoard&&(this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.dragging=!0,this.translate.x1=t.clientX-n,this.translate.y1=t.clientY-o,document.addEventListener("mousemove",this.dragIng))},dragIng:function(t){var e=this.translate,n=e.x1,o=e.y1;this.dragging&&(this.top.baseData.whiteBoard.x=t.clientX-n,this.top.baseData.whiteBoard.y=t.clientY-o)},endDrag:function(){var t=this.top.baseData.whiteBoard.isHandBoard;this.dragging=!1,document.removeEventListener("mousemove",this.dragIng),t&&this.top.setPosterInfoFn()},handleRightClick:function(t){t.preventDefault(),y.a.emit("$E_showRightMenu",t)},onRightItem:function(t){},handleMouseWheel:function(t){t.preventDefault();var e=t.deltaY<0;this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),e?this.top.baseData.whiteBoard.y+=50:this.top.baseData.whiteBoard.y-=50}}},Nt=At,Rt=(n(5250),Object(d.a)(Nt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"works-area-box flex_c_m",attrs:{id:"workAreaMaxId"},on:{mousedown:t.startDrag,mouseup:t.endDrag,contextmenu:t.handleRightClick,wheel:t.handleMouseWheel}},[e("div",{staticClass:"poster-area-box",style:{width:"".concat(t.board.width*t.zoom,"px"),height:"".concat(t.board.height*t.zoom+40,"px"),transform:"translate(".concat(t.board.x,"px, ").concat(t.board.y,"px)")},attrs:{id:"workBoxId"}},[e("board-title",{style:{width:"".concat(t.board.width*t.zoom,"px")},attrs:{"data-html2canvas-ignore":"true"}}),t._v(" "),e("div",{staticClass:"poster-whiteboard",style:{transform:"scale(".concat(t.zoom,")"),width:t.board.width+"px",height:t.board.height+"px"},attrs:{id:"workScaleBoxid"}},[t._l(t.eleList,(function(n){return["wordLayer"===n.type?e("layer-words",{key:n.layerId,ref:"LayerWordsRef",refInFor:!0,attrs:{item:n,comKey:n.layerId,moveableRef:t.moveableRef}}):t._e(),t._v(" "),"imgLayer"===n.type?e("layer-image",{key:n.layerId,ref:"LayerImageRef",refInFor:!0,attrs:{item:n,comKey:n.layerId}}):t._e()]}))],2)],1),t._v(" "),e("Moveable",t._b({ref:"moveableRef",attrs:{target:t.targets,keepRatio:t.keepRatio,renderDirections:t.renderDirections},on:{click:t.clickItem,clickGroup:t.onClickGroup,render:t.onRender,renderGroup:t.onRenderGroup,dragEnd:t.onDragEnd,dragGroupEnd:t.onDragGroupEnd,rotateEnd:t.onRotateEnd,rotateGroupEnd:t.onRotateGroupEnd,resize:t.onResize,resizeStart:t.onResizeStart,resizeEnd:t.onResizeEnd,resizeGroup:t.onResizeGroup,resizeGroupStart:t.orResizeGroupStart,resizeGroupEnd:t.onResizeGroupEnd}},"Moveable",t.moveableProps,!1)),t._v(" "),e("Selecto",{ref:"selectoRef",attrs:{dragContainer:"#workAreaMaxId",selectableTargets:[".layer-item"],hitRate:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"],ratio:0},on:{dragStart:t.onSelectStart,selectEnd:t.onSelectEnd}}),t._v(" "),e("right-menu",{on:{onRightItem:t.onRightItem}}),t._v(" "),e("layer-top-area")],1)}),[],!1,null,"78eb3509",null).exports),Bt={inject:["top"],data:function(){return{}},computed:{board:function(){return this.top.baseData.whiteBoard}},methods:{changeSize:function(t){this.top.baseData.whiteBoard.zoom=t,y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.top.initLayerStatus(),this.top.setPosterInfoFn()},changeHand:function(t){this.top.baseData.whiteBoard.isHandBoard=!t,this.top.setPosterInfoFn()}}},Ut=(n(5251),Object(d.a)(Bt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"zoom-board-box flex_m"},[e("div",{staticClass:"hand-move flex_c_m",class:t.board.isHandBoard&&"hand-active",on:{click:function(e){return t.changeHand(t.board.isHandBoard)}}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("move")}},[e("i",{staticClass:"iconfont icon-zhuashou-copy"})])],1),t._v(" "),e("el-input-number",{staticClass:"my-input-number",attrs:{value:t.board.zoom,size:"mini",min:10,max:500,step:10,precision:0},on:{change:t.changeSize}})],1)}),[],!1,null,"1ea6fc34",null).exports),Vt=n(213),Wt=n(1231);function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var Ht={name:"posterBoard",provide:function(){return{top:this}},components:{TopNav:A,LeftMenu:mt,WorksArea:Rt,ZoomBoard:Ut,LoadingStatus:Vt.default,LineLoading:bt.default},data:function(){return{baseData:Wt.b,setPosterInfoFn:Object(yt.a)(this.setPosterInfo,1e3),posterLoading:!0,exportLoading:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.e)("user",["token"])),mounted:function(){document.querySelector("body").classList.add("poster-board-page"),this.getPosterDetail()},beforeDestroy:function(){document.querySelector("body").classList.remove("poster-board-page")},methods:{getPosterDetail:function(){var t=this,e=this.$route.query,n=e.id,o=e.live;this.posterLoading=!0,setTimeout((function(){t.posterLoading=!1}),1e4),Object(N.e)({id:n}).then((function(e){var r,l;e.data?r=JSON.parse(null===(l=e.data)||void 0===l?void 0:l.json_str):r=JSON.parse(JSON.stringify(Wt.b));r.eleList.forEach((function(t){t.active=!1})),r.leftMenu.actMenu="characters",r.whiteBoard.min=40,r.whiteBoard.max=3125,r.whiteBoard.isHandBoard=!1,"yes"===o?(t.baseData=r,Object(N.d)({id:n}).then((function(e){var n,o=JSON.parse(null===(n=e.data)||void 0===n?void 0:n.json_str).liveModel,l=o.width,c=o.height,d=o.result,h=t.baseData.eleList;h.length||(t.baseData.whiteBoard.width=l,t.baseData.whiteBoard.height=c);var v=h.some((function(t){return t.imgStyle.imgSrc===d}));Object(V.e)(r.eleList,(function(){t.posterLoading=!1})),v||Object(V.d)({url:d}).then((function(e){var n=e.realWidth,o=e.realHeight,r=e.renderWidth,l=e.renderHeight,c=Object(V.g)(h),param={type:"imgLayer",width:r,height:l,z:c,name:"".concat(t.$t("Layer")).concat(c),imgStyle:{imgSrc:d,realWidth:n,realHeight:o}};t.addLayerItem(param)}))}))):(t.baseData=r,Object(V.e)(r.eleList,(function(){t.posterLoading=!1})))}))},setPosterInfo:function(){var t={id:this.$route.query.id,json_str:JSON.stringify(this.baseData)};Object(N.h)(t).then((function(t){}))},addLayerItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(V.a)(Wt.a,t);e.layerId=Object(V.b)(),e.active=!0,this.baseData.eleList.push(e),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),this.$nextTick((function(){y.a.emit("$E_LayerTopShowArea")})),this.setPosterInfoFn()},setIdItem:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.baseData.eleList;n.forEach((function(o,i){var r=o.layerId;if(e.includes(r)){var l=Object(V.a)(o,data);t.$set(n,i,l)}}))},initLayerStatus:function(){this.baseData.eleList.forEach((function(t){t.active=!1}))},getActiveLayer:function(){return this.baseData.eleList.filter((function(t){return t.active}))||[]},getIdlayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.baseData.eleList.filter((function(e){return t.includes(e.layerId)}))||[]},getActiveIds:function(){return this.getActiveLayer().map((function(t){return t.layerId}))},setLayerReplace:function(data){var t=data.oid,e=data.tid,n=data.keys,r=void 0===n?[]:n,l=this.baseData.eleList,c=l.filter((function(e){return e.layerId===t})),d=Object(o.a)(c,1)[0],h=l.filter((function(t){return t.layerId===e})),v=Object(o.a)(h,1)[0];r.forEach((function(t){var e=d[t],n=v[t];d[t]=n,v[t]=e}))}}},Gt=Ht,zt=(n(5252),n(5253),Object(d.a)(Gt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"poster-max-box"},[e("top-nav"),t._v(" "),e("left-menu"),t._v(" "),e("works-area"),t._v(" "),e("zoom-board"),t._v(" "),t.posterLoading?e("LoadingStatus",{staticClass:"poster-max-loading",attrs:{bgColor:"#02050e"}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.exportLoading,expression:"exportLoading"}],staticClass:"screenshot-lod"},[e("line-loading"),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t("ai_dance_loading_toast")))])],1)],1)}),[],!1,null,"3276a808",null));e.default=zt.exports;installComponents(zt,{LoadingStatus:n(213).default})},5722:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13);var o=n(120),r=n(30),l=n(3),c=n(2),d=(n(20),n(19),n(32),n(50),n(22),n(18),n(8),n(4),n(40),n(7),n(41),n(290)),h=n(827),v=n(14),f=(n(16),n(49),n(21),n(26),n(319)),m=n(80),_=n(36),y=(n(122),n(43),n(77),n(1)),w=n(10);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(24),n(28),n(113);var O=n(276);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(73),n(65),n(177),n(44);var S=n(279),D=n(102),P=n(38),I=n(75),$=n(156),j=n(280),L=n(35),M=n.n(L),E=n(29),F=n(209),A=(n(9),n(471)),N=n(33),R=n(200),B=n(54),U=n(144),V=n(124),W=n(943),H=n(46),G=n(165);function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var J={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},K=Object($.a)()?"DOMMouseScroll":"mousewheel",Q={components:{ViewImage:F.a,AiChatCreateConfirm:S.a,textOverflowArea:A.default,DownloadVideoPop:R.default,ShareDialog:U.default,SaveTo:V.default,ImageActionButtons:W.a},name:"AiAppImageViewer",props:{operateNumber:{type:Number,default:function(){return 1}},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},showOperateBtn:{type:Boolean,default:function(){return!1}},message:{type:Object,default:function(){return{}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},hoverBtnRenderList:{type:Array,default:function(){return[]}},nsfw:{type:Number,default:2},customForm:{type:Boolean,default:!1},isFromHistory:{type:Boolean,default:!1},isShowSaveBtn:{type:Boolean,default:!1},checkIsShowViewNsfw:{type:Boolean,default:!1}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(w.F)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:J.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},isI18nToggled:!1,intLoraModel:[],getMetaLoading:!1,alreadySave:!1,workId:"",metaInfo:{}}},computed:Y(Y(Y(Y({},Object(y.c)(["isSupportWebp"])),Object(y.c)("user",["accountSettingsData","isCompanyAccount","userInfo"])),Object(y.c)("creation",["studioStyle","lab_styles","smart_edit_template_id"])),{},{isNsfwPlus:function(){var t,e;return(null==this||null===(t=this.currentImgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==(null==this||null===(e=this.currentImgInfo)||void 0===e?void 0:e.nsfw)},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},getActionButtons:function(){var t,e,n=((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.basic)||[]).map((function(t){return t.val})).filter((function(t){return"supportFeedback"!==t}));return this.isShowNsfwIcon&&(n=[].concat(Object(v.a)(n),["supportFeedback","supportReport"])),null!=this&&null!==(e=this.currentImgInfo)&&void 0!==e&&e.is_saved_personal&&(n=n.filter((function(t){return"supportSave"!==t}))),n.map((function(t){return N.IMAGE_OPERATION_BTN_LIST.find((function(e){return e.permissionKey===t}))})).filter(Boolean).map((function(t){return Y(Y({},t),{},{type:t.code})}))},checkIsAlreadyFeedback:function(){var t;return null===(t=this.currentImgInfo)||void 0===t?void 0:t.is_nsfw_appeal},editButtons:function(){var t;return((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.edit)||[]).map((function(t){return Y(Y({},N.IMAGE_OPERATION_BTN_LIST.find((function(e){return(null==e?void 0:e.permissionKey)===t.val}))),{},{creativityTemplateId:t.creativity_template_id})})).filter(Boolean).map((function(t){return Y(Y({},t),{},{type:t.code})}))},moreButtons:function(){var t;return((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.extend)||[]).map((function(t){return Y(Y({},N.IMAGE_OPERATION_BTN_LIST.find((function(e){return(null==e?void 0:e.permissionKey)===t.val}))),{},{creativityTemplateId:t.creativity_template_id})})).filter(Boolean).map((function(t){return Y(Y({},t),{},{type:t.code})}))},inviteCode:function(){var t;return(null===(t=this.userInfo)||void 0===t?void 0:t.invite_user_code)||""},getModelList:function(){var t,e,n,o=(null===(t=this.message)||void 0===t?void 0:t.art_model)||{};o=Y(Y({},o),{},{type:"Checkpoint"});var r=((null===(e=this.message.meta)||void 0===e?void 0:e.lora_models)||[]).map((function(t){return Y(Y(Y({},t),(null==t?void 0:t.art_model)||{}),{},{type:"LORA"})}));return o&&null!==(n=o)&&void 0!==n&&n.id?[o].concat(Object(v.a)(r)):r},isMyMsg:function(){var t,e;return(null===(t=this.message)||void 0===t||null===(t=t.messageInfo)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)===this.userInfo.id||!(null!==(e=this.message)&&void 0!==e&&e.messageInfo)},isShowSaveTo:function(){var t,e=this.message.img_uris,n=void 0===e?[]:e;return!!n.length&&(!(null!==(t=n[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},renderBtn:function(){var t,e=this,map={post:{type:"post",label:"Post",tip:"PostTips"},animGen:{type:"animGen",label:"AnimGen",tip:"AnimTips"},extraUpscale:{type:"extraUpscale",label:"ai_tools_1",tip:"ExtraUpscale"},upscale:{type:"upscale",label:"OriginalityUpscale",tip:"WorkUpscale"},variations:{type:"variations",label:"Variations",tip:"WorkVariations"},removeBackground:{type:"removeBackground",label:"RemoveBackground"},chat:{type:"chat",label:"gpt_tab_chat",tip:"createChartacterToChat"},aiGenerateVideo:{type:"aiGenerateVideo",label:"ImageToVideo",tip:"ImageToVideoTip"},share:{type:"share",label:"Share",icon:"icons-Share",tip:""}},n=[],o=["deleteSingleImg","save","post","animGen","chat"],r=null,l=null,c=null;if(this.hoverBtnRenderList.forEach((function(t){var d=Y(Y({},t),map[t.code]);"upscale"===t.code&&e.isStudioMode&&d.tip&&d.tip.replace("2048*2048","3072*3072"),!o.includes(t.code)&&n.push(d),"post"===t.code&&(r=d),"animGen"===t.code&&(l=d),"chat"===t.code&&(c=d)})),l&&n.unshift(l),r&&n.unshift(r),c&&n.push(c),n.push({type:"download",label:"Download",icon:"modelDownload",tip:"SG_DownloadHover"}),this.isFromHistory&&((n=n.filter((function(t){return"aiGenerateVideo"!==t.type&&"chat"!==t.type&&"post"!==t.type&&"save"!==t.type&&"download"!==t.type&&"deleteSingleImg"!==t.type}))).unshift({type:"aiGenerateVideo",label:"ImageToVideo",icon:"a-icon-VideoGeneration",tip:"ImageToVideoTip"}),(this.isImageUrl(this.currentImg)||this.isVideoUrl(this.currentImg))&&n.push({type:"play",label:"remix_magic",icon:"iconfont icon-play1",tip:"play_tips"}),n.push({type:"chat",label:"gpt_tab_chat",icon:"a-home-top-personl1",tip:"createChartacterToChat"}),n.push({type:"share",label:"Share",icon:"icons-Share",tip:""}),this.isShowSaveBtn||(n=n.filter((function(t){return"save"!==t.type})))),this.isVideoUrl(this.currentImg)){var d=["chat","aiGenerateVideo"];n=n.filter((function(t){return!d.includes(t.type)}))}if([11,12,13,14].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.task_domain_type)){var h,v,f;n=[{type:"videoExtension",icon:"a-Videoextension",label:"videoProlong",tips:"videoProlong_tips"},{type:"videoUpscale",icon:"icon-HD",label:"IntelligentUpscale",tips:"HD_video"},{type:"post",icon:"post-icon2",label:"VideoSubmission",tips:""},{type:"save",icon:"save",label:"Save",tips:"Save"},{type:"download",label:"Download",icon:"modelDownload",tip:"Download"}],(this.hoverBtnRenderList||[]).some((function(t){return"save"===t.code}))||(n=n.filter((function(t){return"save"!==(null==t?void 0:t.type)})));var m=((null==this||null===(h=this.message)||void 0===h?void 0:h.ckpts)||[]).some((function(t){return(null==t?void 0:t.base_model_name)===N.VIDEO_MODEL_LIST["hunyuan_1.0"]}));((null===(v=this.currentImgInfo)||void 0===v?void 0:v.operation_labels)||[]).includes("videoExtend")||(n=n.filter((function(t){return"videoExtension"!==(null==t?void 0:t.type)}))),![13,14].includes(null==this||null===(f=this.message)||void 0===f?void 0:f.task_domain_type)&&m||(n=n.filter((function(t){return"videoUpscale"!==(null==t?void 0:t.type)})))}return n},studioRenderList:function(){var t=this;return(this.lab_styles||[]).map((function(e){var n="labStyle_".concat(e.value.replace(/\s/g,""));return{label:t.$t(n)||e.value,id:e.value}}))},getStudioStyle:function(){var t,e=(null===(t=this.message.meta)||void 0===t||null===(t=t.lab_base)||void 0===t?void 0:t.style_selections)||[];return(this.studioRenderList||[]).filter((function(t){return e.includes(t.id)})).map((function(t){return t.label})).join("、")||""},isSdModel:function(){var t,e;return[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.channel)||[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.category)},isStudioMode:function(){var t,e;return["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.channel)||["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.category)},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.getImageUrl(this.urlList[this.index].url)},currentImgInfo:function(){return this.urlList[this.index]},imgStyle:function(){var t=this.transform,e=t.scale,n=t.deg,o=t.offsetX,r=t.offsetY,l=t.enableTransition,style={transform:"scale(".concat(e,") rotate(").concat(n,"deg)"),transition:l?"transform .3s":"","margin-left":"".concat(o,"px"),"margin-top":"".concat(r,"px")};return this.mode===J.CONTAIN&&(style.maxWidth=style.maxHeight="100%"),style},viewerZIndex:function(){var t=j.a.nextZIndex();return this.zIndex>t?this.zIndex:t},setI18nPrompt:function(){var t=this.message.local_prompt,e=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?t:e},convertTaskType:function(){var t;return G.b[null===(t=this.message)||void 0===t?void 0:t.task_domain_type]||G.c[this.message.type]||""}}),watch:{accountSettingsData:{handler:function(t){this.isI18nToggled=!t.is_off_localization},deep:!0},index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg:function(t){var e=this;this.$nextTick((function(){var t,n=null===(t=e.$refs)||void 0===t||null===(t=t.img)||void 0===t?void 0:t[0];null!=n&&n.complete||(e.loading=!0)}))}},methods:{handlePlay:function(){this.hide(),this.$emit("onPlay",this.currentImg,this.index)},handleJumpDetail:function(t){["",null,void 0].includes(null==t?void 0:t.id)||window.open("/models/detail/".concat(null==t?void 0:t.id),"_blank")},init:function(){var t,e=this;if(this.msgId){this.getMetaLoading=!0;var n=this.loraModels&&0===Object.keys(this.loraModels).length,o=["",null,void 0].includes(null===(t=this.message)||void 0===t?void 0:t.art_model_name),r=![this.loraModels&&this.loraModels[this.msgId]];[n,o,r].some((function(t){return t}))?Object(E.getMetaInfo)({id:this.msgId,task_flow_version:"v2"}).then((function(t){var o,r,l;if(1e4===t.status.code){e.intLoraModel=(null===(o=t.data.meta)||void 0===o?void 0:o.lora_models)||[];var c={};c[e.msgId]=e.intLoraModel;var d=(null==t||null===(r=t.data)||void 0===r?void 0:r.art_model_name)||"";if(e.$emit("uploadMate",null==t?void 0:t.data),["",null,void 0].includes(null===(l=e.message)||void 0===l?void 0:l.art_model_name)&&(e.$set(e.message,"art_model_name",d),null!=t&&t.data)){var h={},v=null==t?void 0:t.data;h.meta=(null==v?void 0:v.meta)||{},h.art_model=(null==v?void 0:v.art_model)||{},e.$emit("updateModelName",d,null==t?void 0:t.data)}n&&e.$emit("setLoraModel",c)}})).finally((function(){e.getMetaLoading=!1})):this.getMetaLoading=!1,this.intLoraModel&&!this.intLoraModel.length&&(this.intLoraModel=this.loraModels[this.msgId]||[])}},handleConfirm:function(){this.handleChat()},viewImage:function(t){this.$refs.viewImage.show(t,this.$refs.img[0],2)},isVideoUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t||"").toLowerCase().endsWith(e)}))},isAudioUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp3",".wav",".m4a",".ogg",".flac",".aac"].some((function(e){return(t||"").toLowerCase().endsWith(e)}))},isImageUrl:function(){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")},openLora:function(t){window.open("/models/detail/"+t.art_model.id)},hide:function(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var t=this;this._keyDownHandler=function(e){switch(e.stopPropagation(),e.keyCode){case 27:t.hide();break;case 32:t.toggleMode();break;case 37:t.prev();break;case 38:t.handleActions("zoomIn");break;case 39:t.next();break;case 40:t.handleActions("zoomOut")}},this._mouseWheelHandler=Object($.b)((function(e){var n,o=e.wheelDelta?e.wheelDelta:-e.detail;["el-image-viewer__canvas task-image-viewer__canvas","el-image-viewer__img task-image-viewer__img"].includes(null==e||null===(n=e.target)||void 0===n?void 0:n.className)&&(o>0?t.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):t.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1}))})),Object(I.e)(document,"keydown",this._keyDownHandler),Object(I.e)(document,K,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(I.d)(document,"keydown",this._keyDownHandler),Object(I.d)(document,K,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(t){this.loading=!1},handleImgError:function(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown:function(t){var e=this;if(!this.loading&&0===t.button){var n=this.transform,o=n.offsetX,r=n.offsetY,l=t.pageX,c=t.pageY;this._dragHandler=Object($.b)((function(t){e.transform.offsetX=o+t.pageX-l,e.transform.offsetY=r+t.pageY-c})),Object(I.e)(document,"mousemove",this._dragHandler),Object(I.e)(document,"mouseup",(function(t){Object(I.d)(document,"mousemove",e._dragHandler)})),t.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var t=Object.keys(J),e=(Object.values(J).indexOf(this.mode)+1)%t.length;this.mode=J[t[e]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var t=this.urlList.length;this.index=(this.index-1+t)%t}},next:function(){if(!this.isLast||this.infinite){var t=this.urlList.length;this.index=(this.index+1)%t}},handleActions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=Y({zoomRate:.2,rotateDeg:90,enableTransition:!0},e),o=n.zoomRate,r=n.rotateDeg,l=n.enableTransition,c=this.transform;switch(t){case"zoomOut":c.scale>.2&&(c.scale=parseFloat((c.scale-o).toFixed(3)));break;case"zoomIn":c.scale=parseFloat((c.scale+o).toFixed(3));break;case"clocelise":c.deg+=r;break;case"anticlocelise":c.deg-=r}c.enableTransition=l}},handleOperateBtnClick:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,f,m,_,y,C,k,O,x,T;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:k=(null===(o=e.urlList)||void 0===o||null===(o=o[e.index||0])||void 0===o?void 0:o.url)||"",e.handleLogEvent(null==t?void 0:t.type),n.t0=t.type,n.next="chat"===n.t0?5:"post"===n.t0?11:"animGen"===n.t0?13:"download"===n.t0?15:"aiGenerateVideo"===n.t0?17:"videoExtension"===n.t0?26:"save"===n.t0?31:"deleteSingleImg"===n.t0?33:"Share"===n.t0?35:"playNow"===n.t0?37:"imageEditing"===n.t0?39:"extraUpscale"===n.t0?41:"removeBackground"===n.t0?43:"aiErase"===n.t0||"expandImage"===n.t0||"partialRedrawing"===n.t0?47:"videoUpscale"===n.t0?49:"videoExtendFrame"===n.t0?51:"addMusic"===n.t0?53:"lipsync"===n.t0?56:"3D"===n.t0?58:"report"===n.t0?60:"feedback"===n.t0?62:64;break;case 5:return n.next=7,Object(P.S)({channel:"task",source_id:null===(r=e.message)||void 0===r?void 0:r.id});case 7:return O=n.sent,x=O.data.character_id,(void 0===x?"":x)?e.handleChat():e.$refs.aiChatCreateConfirm.show(),n.abrupt("break",66);case 11:return e.handlePost(),n.abrupt("break",66);case 13:return e.handleAnimate(),n.abrupt("break",66);case 15:return Object(w.M)(null===(l=e.urlList)||void 0===l||null===(l=l[e.index||0])||void 0===l?void 0:l.url),n.abrupt("break",66);case 17:if(k){n.next=20;break}return n.abrupt("return");case 20:if(!e.isFromHistory){n.next=23;break}return e.$emit("openEasyVideoRecModal",k),n.abrupt("return");case 23:return e.$EventBus.$emit("openEasyVideoRecModal",k),e.$emit("onlyCloseViewer"),n.abrupt("break",66);case 26:if(k){n.next=28;break}return n.abrupt("return");case 28:return e.$EventBus.$emit("openEasyVideoExtension",{url:null===(c=e.currentImgInfo)||void 0===c?void 0:c.cover_url,info:Y(Y({},e.message),{},{banner:e.currentImgInfo||{}}),isTask:!0}),e.$emit("onlyCloseViewer"),n.abrupt("break",66);case 31:return null===(d=e.$refs)||void 0===d||null===(d=d.saveToPopover)||void 0===d||d.doShow(),n.abrupt("break",66);case 33:return e.$emit("handleDeleteSingleImg",t.type,M()(e.urlList[e.index])),n.abrupt("break",66);case 35:return e.handleShare(M()(e.urlList[e.index])),n.abrupt("break",66);case 37:return e.handlePlay(),n.abrupt("break",66);case 39:return e.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:e.smart_edit_template_id},imgUrlList:[k]}}),n.abrupt("break",66);case 41:return e.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:k}}),n.abrupt("break",66);case 43:return n.next=45,e.handleGetMeta();case 45:return e.handleRemoveBackground(k),n.abrupt("break",66);case 47:return e.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:k,type:t.type,appId:t.creativityTemplateId,callback:function(data){e.$EventBus.$emit("openGenerate",{action:0,data:data}),e.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),e.$emit("onlyCloseViewer")}}}),n.abrupt("break",66);case 49:return e.$EventBus.$emit("openGenerate",{action:13,data:{scene:"ai-tools-play",isTask:!0,parent_task_id:null===(h=e.message)||void 0===h?void 0:h.id}}),n.abrupt("break",66);case 51:return e.$EventBus.$emit("openGenerate",{action:19,data:{scene:"ai-tools-play",isTask:!0,parent_task_id:null===(v=e.message)||void 0===v?void 0:v.id}}),n.abrupt("break",66);case 53:return T=null===(f=e.urlList)||void 0===f?void 0:f[e.index||0].cover_url,e.$EventBus.$emit("openGenerate",{action:1,data:{openType:"AUDIO",videoInfo:{id:null===(m=e.message)||void 0===m?void 0:m.id,isTask:!0,url:null===(_=e.urlList)||void 0===_?void 0:_[e.index||0].url,coverUrl:T},prompt:"",negative_prompt:""},taskVersion:"v2"}),n.abrupt("break",66);case 56:return e.$EventBus.$emit("openGenerate",{action:1,data:{openType:"AUDIO",currentAudioTab:"videoAddLipSync",videoInfo:{id:null===(y=e.message)||void 0===y?void 0:y.id,isTask:!0,url:null===(C=e.urlList)||void 0===C?void 0:C[e.index||0].url,taskSource:0},prompt:""},taskVersion:"v2"}),n.abrupt("break",66);case 58:return e.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:(null==t?void 0:t.creativityTemplateId)||""},imgUrlList:[k]}}),n.abrupt("break",66);case 60:return e.$message.success(e.$t("ReportSuccess")),n.abrupt("break",66);case 62:return e.handleAppeal(),n.abrupt("break",66);case 64:return e.$emit("imageOperate",t.type,M()(e.urlList[e.index])),n.abrupt("break",66);case 66:e.$emit("onClickBtns",t);case 67:case"end":return n.stop()}}),n)})))()},handleLogEvent:function(t){t&&this.$xyLogEvent({front_operation:"click",entity_name:"ai_apps_image_viewer_btn_click",entity_type:"ai_app_detail_page",obj_id:this.message.id,obj_info:{obj_pt:t}})},handleShare:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,path,image;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.workId=e.message.id,n.next=3,Object(m.d)({items:[{folder_no:"default",id:e.message.id,index:t.index}],scene:"task_item_share"});case 3:1e4===(o=n.sent).status.code&&(e.$emit("saveSuccess"),o.data.items[0].artwork_no?(path="".concat(window.location.origin,"/explore/detail/").concat(o.data.items[0].artwork_no)+(e.inviteCode?"?u_code=".concat(e.inviteCode):""),image=(null==t?void 0:t.url)||t.cover_url||"",e.$refs.shareDialog.show(path,image,"share","work-flow-detail")):e.$message.error(e.$t(o.data.items[0].result_desc)));case 5:case"end":return n.stop()}}),n)})))()},getImageUrl:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},handleChat:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v,f,m,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v={height:null===(n=t.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height,width:null===(o=t.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.width,id:null===(r=t.message)||void 0===r?void 0:r.id,url:t.currentImg||(null===(l=t.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url),source_account_id:(null===(c=t.message)||void 0===c||null===(c=c.messageInfo)||void 0===c||null===(c=c.author)||void 0===c?void 0:c.id)||(null===(d=t.userInfo)||void 0===d?void 0:d.id),channel:"task"},e.next=3,Object(P.S)({channel:"task",source_id:v.id});case 3:if(f=e.sent,m=(null==f?void 0:f.data)||{},_=m.can,2!==(void 0===_?2:_)){e.next=8;break}return t.$message.warning(t.$t("chatFail")),e.abrupt("return");case 8:if(!t.isShowSaveTo||1===t.nsfw){e.next=12;break}return e.next=11,t.handleSave(v);case 11:return e.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(v)),y="/cyberPubPage/".concat(null===(h=t.message)||void 0===h?void 0:h.id,"?quickChat=true&source=work"),window.open(t.localePath(y),"_blank");case 15:case"end":return e.stop()}}),e)})))()},handleSave:function(){var t=arguments,e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]?t[0]:null,console.log("handleSave"),r=e.message,l=r.id,c=void 0===l?"":l,d=r.img_uris,h=(void 0===d?[]:d)[e.operateNumber-1].index,v=void 0===h?"":h,Object(D.a)({folder_no:"default",id:c,index:v}).then((function(){if(e.$emit("saveSuccess"),o){var t;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(t=e.message)||void 0===t?void 0:t.id,"?quickChat=true&source=work");window.open(e.localePath(n),"_blank")}})).catch((function(t){console.log("saveFail",t)}));case 5:case"end":return n.stop()}}),n)})))()},handlePost:function(){var t={taskId:this.message.id,url:this.currentImg,index:this.currentImgInfo.index};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_details",behavior_info_sub:t.url});var e={types:[B.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[t]};this.$EventBus.$emit("openContribution",e),this.hide()},handleAnimate:function(){this.$emit("handleAnimate"),this.hide()},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(content)||(Object(w.g)(content),this.$message.success(this.$t("CopySuccess")))},handleDownloadClick:function(){var t=this;this.$nextTick((function(){var e,n=t.$refs.downloadVideoPop;n&&(null==n||null===(e=n.$el)||void 0===e||e.click())}))},deleteSingleImg:function(){this.$emit("handleDeleteSingleImg",this.urlList[this.index].type,M()(this.urlList[this.index]))},handleAppeal:function(){var t,e,n=this;if(this.checkIsAlreadyFeedback)this.$message.warning(this.$t("feedbackTips3"));else{var o={appeal:{index:null===(t=this.currentImgInfo)||void 0===t?void 0:t.index,task_id:null===(e=this.message)||void 0===e?void 0:e.id}};Object(H.feedbackNSFWImage)(o).then((function(t){var e,o=(null==t||null===(e=t.data)||void 0===e?void 0:e.result)||{};((null==o?void 0:o.success)||!1)&&(n.updateImageInfo(n.message.id,n.currentImgInfo.index,"is_nsfw_appeal",!0),n.$message.success(n.$t("feedbackTips2")))})).finally((function(){}))}},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},handleGetMeta:function(){var t,e=this;return Object(E.getMetaInfo)({id:null===(t=this.message)||void 0===t?void 0:t.id,task_flow_version:"v2"}).then((function(t){1e4===t.status.code&&(e.metaInfo=(null==t?void 0:t.data)||{})})).finally((function(){}))},handleRemoveBackground:function(t){var e,n,o=this,r=Object.assign({},null===(e=this.metaInfo)||void 0===e?void 0:e.meta,{init_images:[t],hi_res_arg:void 0,remove_background:{uri:t}}),l={action:7,art_work_no:null===(n=this.metaInfo)||void 0===n?void 0:n.art_work_no,meta:r};Object(E.createTask)(l).then((function(t){o.$EventBus.$emit("openGenerate",{action:0,data:t.data})}))}},mounted:function(){this.init(),this.isI18nToggled=!this.accountSettingsData.is_off_localization,this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},X=Q,Z=(n(5375),n(5376),n(0)),component=Object(Z.a)(X,(function(){var t,e,n,o,r,l,c,d,h,v,f,m,_,y,w,C,k,O=this,x=O._self._c;return x("transition",{attrs:{name:"viewer-fade"}},[x("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper c-easy-task-image-viewer",style:{"z-index":O.viewerZIndex},attrs:{tabindex:"-1"}},[x("div",{staticClass:"el-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:O.handleMaskClick.apply(null,arguments)}}}),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__chat",on:{click:O.handleChat}},[x("i",{staticClass:"iconfont icon-a-home-top-personl1"})]),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:O.hide}},[x("i",{staticClass:"el-icon-close"})]),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__download",on:{click:function(t){return O.handleOperateBtnClick({type:"download"})}}},[x("i",{staticClass:"iconfont icon-icon-Download"})]),O._v(" "),O.showOperateBtn?O._e():x("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[x("div",{staticClass:"el-image-viewer__actions__inner"},[x("i",{staticClass:"el-icon-zoom-out",on:{click:function(t){return O.handleActions("zoomOut")}}}),O._v(" "),x("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){return O.handleActions("zoomIn")}}}),O._v(" "),x("i",{staticClass:"el-image-viewer__actions__divider"}),O._v(" "),x("i",{class:O.mode.icon,on:{click:O.toggleMode}}),O._v(" "),x("i",{staticClass:"el-image-viewer__actions__divider"}),O._v(" "),x("i",{staticClass:"el-icon-refresh-left",on:{click:function(t){return O.handleActions("anticlocelise")}}}),O._v(" "),x("i",{staticClass:"el-icon-refresh-right",on:{click:function(t){return O.handleActions("clocelise")}}})])]),O._v(" "),x("div",{staticClass:"el-image-viewer__canvas task-image-viewer__canvas"},[O.isSingle?O._e():[x("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!O.infinite&&O.isFirst},on:{click:O.prev}},[x("i",{staticClass:"el-icon-arrow-left"})]),O._v(" "),x("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!O.infinite&&O.isLast},on:{click:O.next}},[x("i",{staticClass:"el-icon-arrow-right"})])],O._v(" "),O._l(O.urlList,(function(t,i){return[i!==O.index||O.isVideoUrl(O.currentImg)?i===O.index?x("video",{key:i,staticClass:"el-image-viewer__img task-image-viewer__img",style:O.imgStyle,attrs:{src:O.currentImg,autoplay:"",loop:"",muted:"",controls:"",controlsList:"nodownload"},domProps:{muted:!0},on:{play:O.handleImgLoad}}):O._e():x("img",{directives:[{name:"webp",rawName:"v-webp",value:O.$imgH,expression:"$imgH"}],key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img task-image-viewer__img",style:O.imgStyle,attrs:{src:O.currentImg,referrerpolicy:"no-referrer"},on:{load:O.handleImgLoad,mousedown:O.handleMouseDown,click:function(t){return O.viewImage(O.currentImg)}}})]})),O._v(" "),O.isSingle||O.isAudioUrl(O.currentImg)?O._e():[x("div",{staticClass:"indicator-box"},O._l(O.urlList,(function(t,i){return x("span",{key:"indicator_".concat(i),staticClass:"indicator-box-item",class:[O.index===i&&"indicator-box-item-active"]})})),0)]],2),O._v(" "),O.showOperateBtn?x("div",{staticClass:"task-image-viewer__side-bar"},[x("div",{staticClass:"header-image-viewer"},[x("div",{staticClass:"flex"},[null!==(t=O.getActionButtons)&&void 0!==t&&t.length?x("image-action-buttons",{attrs:{visible:!0,buttons:O.getActionButtons,iconStyle:"iconStyle",iconFontsize:"iconFontsize",gap:4,maxVisibleButtons:3},on:{"button-click":O.handleOperateBtnClick}},[x("SaveTo",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:O.$t("Save"),message:T(T({},O.message),{},{img_uris:(null===(e=O.message)||void 0===e?void 0:e.components)||[]}),operateNumber:O.operateNumber,showArrowIcon:!1},on:{saveSuccess:function(t){return O.$emit("saveSuccess")}}})],1):O._e()],1),O._v(" "),x("span",{on:{click:O.hide}},[x("i",{staticClass:"el-icon-close el-image-viewer-close"})])]),O._v(" "),x("div",{staticClass:"booderbtm"}),O._v(" "),x("div",{staticClass:"task-image-viewer__side-bar-box"},[null!==(n=O.editButtons)&&void 0!==n&&n.length?x("div",{staticClass:"edit-group mrgin-bt8"},[x("div",{staticClass:"group-title"},[O._v(O._s(O.$t("Edit")))]),O._v(" "),x("div",{staticClass:"button-row"},O._l(O.editButtons,(function(t){return x("el-tooltip",{key:t.code,attrs:{content:O.$t(t.tips),disabled:!t.tips,"open-delay":200,placement:"bottom",effect:"light","popper-class":"task-image-viewer-popover"}},[x("div",{staticClass:"button",on:{click:function(e){return e.stopPropagation(),O.handleOperateBtnClick(t)}}},[x("span",{staticClass:"icon"},[x("i",{class:t.icon})]),O._v(" "),x("span",{staticClass:"label"},[O._v(O._s(O.$t(t.label)))])])])})),1)]):O._e(),O._v(" "),null!==(o=O.moreButtons)&&void 0!==o&&o.length?x("div",{staticClass:"more-group"},[x("div",{staticClass:"group-title"},[O._v(O._s(O.$t("more")))]),O._v(" "),x("div",{staticClass:"button-row"},O._l(O.moreButtons,(function(t){return x("el-tooltip",{key:t.code,attrs:{content:O.$t(t.tips),disabled:!t.tips,placement:"bottom","open-delay":200,"popper-class":"task-image-viewer-popover",effect:"light"}},[x("div",{staticClass:"button",on:{click:function(e){return e.stopPropagation(),O.handleOperateBtnClick(t)}}},[x("span",{staticClass:"icon"},[x("i",{class:t.icon})]),O._v(" "),x("span",{staticClass:"label"},[O._v(O._s(O.$t(t.label)))])])])})),1)]):O._e(),O._v(" "),x("div",{staticClass:"task-image-viewer__generation-data"},[O._v("\n          "+O._s(O.$t("GenerationData"))+"\n        ")]),O._v(" "),O.customForm?O._e():x("div",{staticClass:"task-image-viewer__prompt-box",class:[O.currentImgInfo&&[0,"0"].includes(O.currentImgInfo.operateNumber)?"task-image-viewer__prompt-box-margin-top":""]},[x("div",{staticClass:"task-image-viewer__prompt-title"},[x("span",{staticClass:"prompt-title-text"},[O._v(O._s(O.$t("Prompt")))]),O._v(" "),x("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(t){return t.stopPropagation(),O.handleCopyAll(O.setI18nPrompt)}}})]),O._v(" "),x("text-overflow-area",{staticClass:"prompt-text-overflow"},[O._v(O._s(O.setI18nPrompt))]),O._v(" "),null!==(r=O.message)&&void 0!==r&&null!==(r=r.meta)&&void 0!==r&&r.negative_prompt?[x("div",{staticClass:"task-image-viewer__prompt-title"},[x("span",{staticClass:"prompt-title-text"},[O._v(O._s(O.$t("NegativePrompts")))]),O._v(" "),x("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(t){var e;return t.stopPropagation(),O.handleCopyAll(null===(e=O.message)||void 0===e||null===(e=e.meta)||void 0===e?void 0:e.negative_prompt)}}})]),O._v(" "),x("text-overflow-area",{staticClass:"prompt-text-overflow"},[O._v(O._s((null===(l=O.message)||void 0===l||null===(l=l.meta)||void 0===l?void 0:l.negative_prompt)||""))])]:O._e(),O._v(" "),x("div",{staticClass:"easy-tooltip-wraper-params-box"},[x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("newGenerate27")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(O.$t(O.convertTaskType)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("newGenerate26")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(O._f("formatDateTime")(O.message.create_at)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("imageDimensions")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v("\n                "+O._s("".concat(null===(c=O.message)||void 0===c||null===(c=c.components[0])||void 0===c?void 0:c.width," x ").concat(null===(d=O.message)||void 0===d||null===(d=d.components[0])||void 0===d?void 0:d.height))+" px\n              ")])]),O._v(" "),[11,12,13].includes(null===(h=O.message)||void 0===h?void 0:h.task_domain_type)?x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Duration")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s((null===(v=O.message)||void 0===v||null===(v=v.components[0])||void 0===v?void 0:v.duration)||0)+"s")])]):O._e(),O._v(" "),[11,12,13].includes(null===(f=O.message)||void 0===f?void 0:f.task_domain_type)?O._e():[x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Seed")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(m=O.message)||void 0===m||null===(m=m.meta)||void 0===m?void 0:m.seed))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Sampler")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(_=O.message)||void 0===_||null===(_=_.meta)||void 0===_?void 0:_.sampler_name))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Steps")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(y=O.message)||void 0===y||null===(y=y.meta)||void 0===y?void 0:y.steps))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("CFGScale")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(w=O.message.meta)||void 0===w?void 0:w.cfg_scale))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("clipSkip")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s((null===(C=O.message)||void 0===C||null===(C=C.meta)||void 0===C?void 0:C.clip_skip)||""))])])]],2)],2),O._v(" "),O.customForm?O._e():[null!==(k=O.getModelList)&&void 0!==k&&k.length?x("div",{directives:[{name:"show",rawName:"v-show",value:!O.loading,expression:"!loading"}],staticClass:"easy-tooltip-wraper-model-box"},O._l(O.getModelList,(function(t,e){var n,o,r;return x("div",{key:"model_i_".concat(e),staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(e){return e.stopPropagation(),O.handleJumpDetail(t)}}},[x("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[O.isVideoUrl(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)?x("video",{attrs:{src:null==t||null===(o=t.banner)||void 0===o?void 0:o.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):x("img",{attrs:{src:null==t||null===(r=t.banner)||void 0===r?void 0:r.url,alt:""}})]),O._v(" "),x("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[x("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[x("span",{staticClass:"easy-tooltip-model-box-model-type"},[O._v(O._s(O.$t(null==t?void 0:t.type)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-model-box-model-name"},[O._v(O._s((null==t?void 0:t.name)||""))])])])})),0):O._e()],O._v(" "),O.customForm?[O._t("customContent")]:O._e()],2)]):O._e(),O._v(" "),x("view-image",{ref:"viewImage"}),O._v(" "),x("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task",fromPage:"newTask"},on:{confirm:O.handleConfirm}}),O._v(" "),x("ShareDialog",{ref:"shareDialog",attrs:{type:"artwork",workId:O.workId}})],1)])}),[],!1,null,"34398afc",null),tt=component.exports;installComponents(component,{SaveTo:n(124).default,ShareDialog:n(144).default});var et=n(172),it=n(85),nt=n(210),at={props:{info:{type:Object,default:function(){return{}}}},data:function(){return{formList:[]}},computed:{},mounted:function(){this.getMetaInfo()},methods:{isModelItem:function(t){return["CheckpointLoaderSimple","LoraLoader"].includes(t.node_type)},getMetaInfo:function(){var t=this,e=this.info.id;Object(E.getMetaInfo)({id:e}).then((function(e){var n;t.formList=(null==e||null===(n=e.data.meta)||void 0===n?void 0:n.comfyui_inputs)||[]}))},handleJumpDetail:function(){var t=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})||{}).art_model,e=void 0===t?{}:t;null!=e&&e.id&&window.open("/models/detail/".concat(null==e?void 0:e.id),"_blank")},isWordsLine:function(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val).length<40},handleCopyAll:function(){var content=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val||"";content&&(this.$message.success(this.$t("CopySuccess")),Object(w.g)(content))}}},ot=at,st=(n(5377),Object(Z.a)(ot,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"config-databox"},t._l(t.formList,(function(n,o){var r,l,c;return e("div",{key:n.field+o},[t.isModelItem(n)?[e("div",{staticClass:"easy-tooltip-wraper-model-box"},[e("div",{staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(e){return e.stopPropagation(),t.handleJumpDetail(n)}}},[e("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[e("img",{attrs:{src:null==n||null===(r=n.art_model)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url,alt:""}})]),t._v(" "),e("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[e("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[e("span",{staticClass:"easy-tooltip-model-box-model-type"},[t._v(t._s(t.$t(null==n||null===(l=n.art_model)||void 0===l?void 0:l.type)))])]),t._v(" "),e("div",{staticClass:"easy-tooltip-model-box-model-name"},[t._v("\n              "+t._s((null==n||null===(c=n.art_model)||void 0===c?void 0:c.name)||"")+"\n            ")])])])])]:t._e(),t._v(" "),t.isModelItem(n)?t._e():[n.val&&t.isWordsLine(n)?e("div",{staticClass:"line-cell flex"},[e("div",{staticClass:"title"},[t._v(t._s(n.field||""))]),t._v(" "),e("div",{staticClass:"content"},[t._v(t._s(n.val||""))])]):t._e(),t._v(" "),n.val&&!t.isWordsLine(n)?e("div",{staticClass:"lines-cell"},[e("div",{staticClass:"title flex_m"},[e("span",[t._v(" "+t._s(n.field||""))]),t._v(" "),e("span",{staticClass:"iconfont icon-codeCopy1 copy",on:{click:function(e){return e.stopPropagation(),t.handleCopyAll(n)}}})]),t._v(" "),e("div",{staticClass:"content"},[t._v(t._s(n.val||""))])]):t._e()]],2)})),0)}),[],!1,null,"6defe540",null).exports),lt=n(301);function ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pt={name:"historyImg",inject:["top"],provide:function(){return{easyTop:this.top}},components:{AiAppsImageViewer:tt,ElImageViewer:et.a,auditDialog:nt.a,CreateConfig:st,SelectVideoModelModal:lt.default,SaveTo:V.default,ShowNsfw:O.default},props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},imgInfo:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},baseSize:{type:String,default:""}},data:function(){return{loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:200,imageUrl:"",checked:!1,alreadySave:!1,hoverBtnList:[{code:"play",icon:"icon_play",useText:!1,order:3,tips:"play_tips",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"download",icon:"modelDownload",useText:!1,order:5,tips:"DownloadImg",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"Post",show:!0,showTypeOptions:[]}],bigImageBtns:[{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"Post",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],isShowHoverMask:!1,isVideoPlay:!1}},computed:ut(ut(ut(ut({},Object(y.c)(["isSupportWebp"])),Object(y.c)("user",["userInfo","isCompanyAccount","isLoggedIn"])),Object(y.e)("user",["cdnHost"])),{},{currentImageIndex:function(){var t,e=this;return-1===(t=this.viewImageList.findIndex((function(t){return t.operateNumber===e.operateNumber})))?0:t},checkIsAlreadyFeedback:function(){var t;return null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_appeal},viewImageList:function(){var t=this,e=[],n=this.message.components,o=void 0===n?[]:n;return Array.isArray(o)&&o.length&&(e=(M()(o)||[]).map((function(t,e){return t.operateNumber=e+1,t})).filter((function(e){if(t.checkIsShowViewNsfw&&t.enableNsfwMode)return![1,"1"].includes(e.nsfw)&&(null==e?void 0:e.canViewNsfw);var n=[0,1,"0","1"].includes(e.type);return![1,"1"].includes(null==e?void 0:e.nsfw)&&n}))),e},getTooltipContent:function(){var t=this;return function(e){return"play"===e.code?"".concat(t.$t("play"),"：")+" "+t.$t(null==e?void 0:e.tips):t.$t(null==e?void 0:e.tips)}},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var t="";return 1===this.nsfw||(t=this.checkIsShowViewNsfw?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===t)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw?(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!this.imgInfo.canViewNsfw:1===this.nsfw);var t},isShowOperateBtn:function(){return!this.isBlur&&!this.error},isShowHover:function(){var t,e;return!!this.checkIsShowViewNsfw&&((null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!(null!=this&&null!==(e=this.imgInfo)&&void 0!==e&&e.canViewNsfw))},isNsfwPlus:function(){var t;return(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==this.nsfw},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},isVideoUrl:function(){var t=this;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t.imageUrl||"").toLowerCase().endsWith(e)}))},isImageUrl:function(){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(this.imageUrl)},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},hoverBtnRenderList:function(){var t=this;return this.hoverBtnList.map((function(e){return e.show=t.isShowBtn(e.code),e})).filter((function(t){return t.show}))},isShowSaveTo:function(){var t,e,n=this.message.components,o=void 0===n?[]:n;return!!o.length&&!(null!==(t=o[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal||null!==(e=o[this.operateNumber-1])&&void 0!==e&&e.alreadySave||this.alreadySave)},isShowBtn:function(){var t={save:[this.isShowSaveTo&&1!==this.nsfw],play:[1!==this.nsfw&&(this.isVideoUrl||this.isImageUrl)],aiGenerateVideo:[1!==this.nsfw&&!this.isVideoUrl],post:[1!==this.nsfw]};return function(e){return!!Object.keys(t).includes(e)&&t[e].every((function(t){return!!t}))}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)}}),mounted:function(){this.$set(this.imgInfo,"canViewNsfw",this.checkIsShowViewNsfw&&this.enableNsfwMode)},beforeDestroy:function(){document.body.style.overflow=""},watch:{src:{handler:function(t){t&&"string"==typeof t&&(this.imageUrl=this.isSupportWebp?Object(w.K)(t,"high"):this.src)},immediate:!0},dialogVisible:function(t){try{document.body.style.overflow=t?"hidden":""}catch(t){document.body.style.overflow=""}}},methods:ut(ut({},Object(y.b)("user",["getAccountInfo"])),{},{handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"});try{this.message.components[this.operateNumber-1].alreadySave=!0}catch(t){}this.alreadySave=!0,this.$emit("saveSuccess")},deleteSingleImg:function(){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("deleteSingleImg",t.operateNumber,t.message)}))},handleShowNsfwImageUrl:function(){var t;return null!=this&&null!==(t=this.imgInfo)&&void 0!==t&&t.is_nsfw_plus&&!this.imgInfo.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(t){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",M()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var t=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){t.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(w.K)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){1!==this.nsfw&&(this.isShowHover||(this.$logEvent("log_actions",{operation:"view_image",behavior_info:"on_quick_tools_created_records_page"}),this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(t){1===this.nsfw&&t.preventDefault()},downloadImage:function(){Object(w.M)(this.src,this.$t("WorkFlow"))},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(["deleteSingleImg"].includes(t))this.deleteSingleImg();else if("download"!==t){if("aiGenerateVideo"===t)return console.log("图生视频"),void this.handleAiGenerateVideo();var e;if(["post"].includes(t))this.handlePost();else if(["play"].includes(t))this.openPlayModal(!1,this.imgInfo.url,this.imgInfo.index);else if(["save"].includes(t))null===(e=this.$refs)||void 0===e||null===(e=e.saveToPopover[0])||void 0===e||e.doShow()}else this.downloadImage()},settingViewNsfw:function(){var t;this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.enableNsfwMode||1===(null===(t=this.userInfo)||void 0===t?void 0:t.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog()},applyNsfw:function(){var t=this;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var e={};e.nsfw_plus=this.enableNsfwMode?2:1,e.mode=1,e.age_confirm=!0,Object(it.c)(e).then((function(e){var n=(e||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(t.$message.success(t.$t(t.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),t.getAccountInfo())})).finally((function(){t.$set(t.imgInfo,"canViewNsfw",!t.imgInfo.canViewNsfw)}))}else this.$set(this.imgInfo,"canViewNsfw",!this.imgInfo.canViewNsfw)},handImageBtns:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,e={chat:"click_chat",aiGenerateVideo:"click_image_to_video"};e[t]&&this.$logEvent("log_actions",{operation:e[t],behavior_info:"on_image_detail_page"})},handleAiGenerateVideo:function(){console.log("图生视频",this.src),this.$logEvent("log_actions",{operation:"click_video_generate",behavior_info:"on_quick_ai_history_record"}),this.isLoggedIn?this.handleSelectVideoModel({},this.src):this.$EventBus.$emit("openLoginDialog")},handleSelectVideoModel:function(t,e){console.log("选择视频模型",t,e);var n=Object.assign({},t,{imageToVideoUrl:e});this.$EventBus.$emit("openGenerate",{action:0,taskVersion:"v2",data:{source:n}})},handlePost:function(){var t={taskId:this.message.id,index:this.imgInfo.index,url:this.imgInfo.url},e={types:[B.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[t]};this.$EventBus.$emit("openContribution",e)},openPlayModal:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r=Object(w.v)(n);e?this.$logEvent("log_actions",{operation:"click_play_around",behavior_info:"on_quick_ai_history_record",behavior_info_sub:"detail_page"}):this.$logEvent("log_actions",{operation:"click_play_around",behavior_info:"on_quick_ai_history_record"}),this.$EventBus.$emit("showDialog",{name:"HyAssembleModal",data:{doorCode:"video"==r?"aiVideoApp":"aiImageApp",workUrl:n,source:7,taskReferIndex:o,taskId:this.message.id,onAfterAction:function(){t.$EventBus.$emit("hideDialog","HyAssembleModal")}}})},handleVideoSave:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.message,r=o.id,l=void 0===r?"":r,c=o.components,d=t.index||0,Object(D.a)({folder_no:"default",id:l,index:d}).then((function(){e.handleSaveSuccess()})).catch((function(t){console.log("saveFail",t)}));case 3:case"end":return n.stop()}}),n)})))()},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},handleAppeal:function(){var t,e,n=this;if(this.checkIsAlreadyFeedback)this.$message.warning(this.$t("feedbackTips3"));else{var o={appeal:{index:null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.index,task_id:null===(e=this.message)||void 0===e?void 0:e.id}};Object(H.feedbackNSFWImage)(o).then((function(t){var e,o=(null==t||null===(e=t.data)||void 0===e?void 0:e.result)||{};((null==o?void 0:o.success)||!1)&&(n.updateImageInfo(n.message.id,n.imgInfo.index,"is_nsfw_appeal",!0),n.$message.success(n.$t("feedbackTips2")))})).finally((function(){}))}},handleMouseEnter:function(){var t=this.$refs.videoRef;!this.isVideoUrl||this.isShowNsfwIcon&&this.isShowNsfwBg||1==this.nsfw?this.isVideoPlay=!1:(this.isVideoPlay=!0,null==t||t.play())},handleMouseLeave:function(){this.isVideoPlay=!1;var t=this.$refs.videoRef;t&&(t.currentTime=0,null==t||t.pause())}})},ht=pt,vt=(n(5378),n(5379),Object(Z.a)(ht,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-history-img"},[e("div",{staticClass:"attachments-wrap"},[e("div",{staticClass:"message-attachment-media"},[e("div",{staticClass:"image-content"},[e("div",{staticClass:"image-content-wrap",class:[1===t.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(t.baseSize),"min-width":"".concat(t.baseSize,"px")}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.nsfw,expression:"nsfw === 1"}],staticClass:"nsfw-flag"},[t._v("NSFW")]),t._v(" "),e("div",{staticClass:"image-render-box",on:{mouseover:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isVideoUrl&&!t.isVideoPlay&&!t.isShowNsfwBg,expression:"isVideoUrl && !isVideoPlay && !isShowNsfwBg"}],staticClass:"video-tag"},[e("i",{staticClass:"iconfont icon-icon-tag-creation"})]),t._v(" "),1===t.nsfw?[e("img",{staticClass:"media-attachments-img image-opacity-0",attrs:{src:t.renderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:t.onLoad,error:t.onError,contextmenu:function(e){return t.handleContextMenu(e)}}})]:[t.isVideoUrl?t._e():e("img",{staticClass:"media-attachments-img",class:[t.loading?"":"media-attachments-img-show",t.loading?"image-opacity-0":"",t.isShowNsfwBg?"blurBackground":""],attrs:{src:t.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:t.onLoad,error:t.onError,click:t.viewBigImage,contextmenu:function(e){return t.handleContextMenu(e)}}}),t._v(" "),t.isVideoUrl&&t.getImageUrl?e("video",{ref:"videoRef",class:["media-attachments-video",t.loading?"image-opacity-0":"",t.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px"},attrs:{src:t.getImageUrl,loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{canplay:t.onLoad,error:t.onError}}):t._e()],t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading&&1!==t.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[e("div",{staticClass:"loading-wrapper-inner"},[e("span",{staticClass:"spinner",attrs:{role:"img","aria-label":t.$t("Loading")}},[t._m(0)])])]),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isShowNsfwBg&&t.isShowNsfwIcon,expression:"isShowNsfwBg && isShowNsfwIcon"}],staticClass:"generate-view-nsfw-warning iconfont icon-report"}),t._v(" "),e("ShowNsfw",{attrs:{"is-show-nsfw-icon":t.isShowNsfwIcon,"img-info":t.imgInfo},on:{settingViewNsfw:t.settingViewNsfw,deleteSingleImg:t.deleteSingleImg,handleAppeal:t.handleAppeal}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSaveTo,expression:"!isShowSaveTo"}],staticClass:"save-status-flag"},[e("i",{staticClass:"iconfont icon-yibaocun"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowOperateBtn&&t.isShowImage&&t.src&&!t.loading||1===t.nsfw,expression:"(isShowOperateBtn && isShowImage && src && !loading) || nsfw === 1"}],staticClass:"image-hover-mask",on:{click:t.viewBigImage}},[e("div",{staticClass:"image-hover-mask-btn-box"},t._l(t.hoverBtnRenderList,(function(n){var o;return e("el-tooltip",{key:n.code,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:t.getTooltipContent(n)}},["save"!==n.code?e("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",attrs:{"data-event":"ai_app_history_hover_click_btn","data-type":n.code,"data-id":t.message.id,"data-info":JSON.stringify({obj_pt:n.code})},on:{click:function(e){return e.stopPropagation(),t.handleClick(n.code)}}},[n.useText?[t._v("\n                      "+t._s(n.text)+"\n                    ")]:e("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(n.icon)})],2):t._e(),t._v(" "),"save"===n.code&&t.isShowSaveTo?e("save-to",{ref:"saveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:t.$t("Save"),message:k(k({},t.message),{},{img_uris:(null===(o=t.message)||void 0===o?void 0:o.components)||[]}),operateNumber:t.operateNumber,showArrowIcon:!1},on:{saveSuccess:t.handleSaveSuccess}},[e("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",attrs:{"data-event":"ai_app_history_hover_click_btn","data-type":n.code,"data-id":t.message.id,"data-info":JSON.stringify({obj_pt:n.code})},on:{click:function(e){return e.stopPropagation(),t.handleClick("save")}}},[n.useText?[t._v("\n                        "+t._s(n.text)+"\n                      ")]:e("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(n.icon)})],2)]):t._e()],1)})),1)])],2)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.error&&!t.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[e("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),t._v(" "),e("span",{staticClass:"image-load-error-text",on:{click:function(e){return e.stopPropagation(),t.clickReloadImage.apply(null,arguments)}}},[t._v(t._s(t.$t("reloadImage")))])])])])]),t._v(" "),t.dialogVisible?e("AiAppsImageViewer",{staticClass:"work-message-img-viewer",staticStyle:{"z-index":"999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!0,hoverBtnRenderList:t.bigImageBtns,message:t.message,"url-list":t.viewImageList,customForm:!0,"is-from-history":!0,"is-show-save-btn":t.isShowSaveTo,checkIsShowViewNsfw:t.checkIsShowViewNsfw},on:{onClickBtns:t.handImageBtns,openEasyVideoRecModal:t.handleAiGenerateVideo,handleDeleteSingleImg:t.deleteSingleImg,onPlay:function(e,n){return t.openPlayModal(!0,e,n)},saveSuccess:t.handleSaveSuccess,updateImageInfo:t.updateImageInfo},scopedSlots:t._u([{key:"customContent",fn:function(){return[e("CreateConfig",{attrs:{info:t.message}})]},proxy:!0}],null,!1,1028422645)}):t._e(),t._v(" "),e("auditDialog",{ref:"auditDialog",on:{confirm:t.applyNsfw}}),t._v(" "),e("SelectVideoModelModal",{ref:"selectVideoModelModal",attrs:{changeBtnColor:!0},on:{confirm:t.handleSelectVideoModel}})],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"3a85662e",null)),ft=vt.exports;installComponents(vt,{ShowNsfw:n(276).default,SaveTo:n(124).default});var mt=n(619),gt=n(119),_t=n(424),yt=n(425),bt=n(289),wt=n(586),Ct={name:"ProgressBar",props:{value:{type:Number,default:function(){return 0}}}},kt=(n(5380),Object(Z.a)(Ct,(function(){var t=this._self._c;return t("div",{staticClass:"progress-container"},[t("div",{staticClass:"progress-bar",style:{width:"".concat(this.value,"%")}})])}),[],!1,null,"cda999f8",null).exports);function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tt=n(275),St={name:"historyItem",components:{historyImg:ft,historyModel:mt.a,TryCreateMask:f.default,QuickQueue:gt.default,CFile:_t.default,CText:yt.default,CAudio:bt.default,ModelViewer:wt.a,ProgressBar:kt},inject:["top"],props:{message:{type:Object,default:function(){return{}},required:!0},viewMode:{type:String,default:""}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(w.F)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{defaultAvatar:Tt,alreadySave:!1,customColor:"#2E9E60",isLoading:!1}},watch:{isShowHistory:function(t){var e=this;t&&this.$nextTick((function(){var t=e.$refs.textRef;t&&(Array.isArray(t)?t.forEach((function(t){null==t||t.isShowToggle()})):t.isShowToggle())}))},isShowCancel:{handler:function(t){this.postTaskCancelExposureLog()}}},computed:xt(xt(xt(xt({},Object(y.e)("payment",["paymentInfo"])),Object(y.c)("user",["isLoggedIn"])),Object(y.e)("app",["ABInfo"])),{},{isNewProcessBar:function(){return"B"==this.ABInfo.ai_app_process_bar},isShowHistory:function(){var t;return 2===(null===(t=this.top)||void 0===t?void 0:t.actVal)},getComponentsArr:function(){var t,e=(null===(t=this.message)||void 0===t?void 0:t.components)||[],n={4:1,2:2,3:3,0:4,1:5,6:6};return e.sort((function(a,b){var t=String(a.type),e=String(b.type);return n[t]-n[e]}))},computedPercentage:function(){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===t?0:t}},convertStatusText:function(){var t,e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return null!==(t=this.message)&&void 0!==t&&t.status_desc?e[this.message.status_desc]:""},isShowExpireTime:function(){var t=this.paymentInfo.productLevel,e=this.message.expiration_time,n=[4,3].includes(t),o=e&&e>0,r=!this.alreadySave;return!n&&(o&&r)},getExpireTime:function(){var t=this.message.expiration_time,e=(new Date).getTime();if(t&&t>e){var n=t-e,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},isShowCancel:function(){var t=this.message,e=t.status,n=t.category,o=t.type,r=![4,"4"].includes(e),l=![4,5,6,10,11,13,23,"23"].includes(o);return r&&![3,"3"].includes(n)&&l},isVip:function(){var t,e;return!!(null!==(t=this.paymentInfo)&&void 0!==t&&t.activeState||null!==(e=this.paymentInfo)&&void 0!==e&&e.liteActiveState)},taskFailData:function(){var t,data={show:!1,tips:""};if(3==(null===(t=this.message)||void 0===t?void 0:t.speed_type))return data;var e=this.getComponentsArr.filter((function(t){return![2,3,4,6].includes(t.type)&&1===t.nsfw}));if(this.isLoggedIn){var n,o=(null===(n=this.message)||void 0===n?void 0:n.task_return)||{},r=o.sub_status,l=void 0===r?0:r,c=o.used,d=void 0===c?0:c,h=o.hashrate,v=void 0===h?0:h,f=o.temp_hashrate,m=void 0===f?0:f;if(301==l&&(data.show=!0,data.tips=this.$t("task_fail_content_violation")),302==l){var _=d||"",y="";d<=0&&v>0&&(_="".concat(v).concat(this.$t("coin"))),d<=0&&m>0&&(y="".concat(m).concat(this.$t("tempCoins"))),data.show=!0,data.tips=this.$t("task_fail_more_content_violation",{cost:_,unit:y})}411==l&&(data.show=!0,data.tips=this.$t("task_fail_system_cancle"))}else{var w;null!=e&&e.length&&(data.show=!0,data.tips=this.$t("task_fail_visitor_content_violation")),"sysCancelDesc"==(null===(w=this.message)||void 0===w?void 0:w.status_desc)&&(data.show=!0,data.tips=this.$t("task_fail_visitor_system_cancle"))}return data}}),mounted:function(){this.postTaskCancelExposureLog()},methods:{postTaskCancelExposureLog:function(){this.isShowCancel&&[1,"1",2,"2",4,"4"].includes(this.message.status)&&this.$xyLogEvent({front_operation:"exposure",entity_type:"message-process-operate-box-btn",entity_name:"cancelTask",obj_id:"cancelTask",obj_category:"ai_app",obj_pt:this.isNewProcessBar?"new_create_workflow_add_task_duration":"old_create_workflow_task_progress_percentage"})},handleModelOperation:function(t,e){var n=e.modelUrl,o=this.message.components;if("delete"===t){var r=(void 0===o?[]:o).findIndex((function(t){return t.url===n}));-1!==r&&this.deleteSingleImg(r+1)}},show3DModel:function(t){var e=t.url;this.$refs.modelViewer.show({url:e,createTime:this.message.create_at,id:this.message.id})},handleDeleteTask:function(){var t=this;this.isLoggedIn?this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e=t.message.id;e&&Object(E.deleteTaskRecord)({ids:[e]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.$emit("deleteTask",e)}))})):this.$EventBus.$emit("openLoginDialog")},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},deleteSingleImg:function(t){var e=this,n=this.message,o=n.id,r=void 0===o?"":o,l=n.components,c=(void 0===l?[]:l)[t-1].index,d=void 0===c?-1:c;Object(D.b)({id:r,index:d}).then((function(){var t;(e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.message.components=e.message.components.filter((function(t){return t.index!==d})),e.message.components.length)||e.$emit("deleteTask",null==e||null===(t=e.message)||void 0===t?void 0:t.id)}))},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){this.isLoading||this.$emit("onCancelTask",{info:this.message})},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var t=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===t&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&t>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")},jumpWork:function(data){var t=data.creativity.id,e=this.localePath("/workFlowAppDetail/".concat(t));window.open(e,"_blank")}}},Dt=St,Pt=(n(5381),Object(Z.a)(Dt,(function(){var t,e,o,r,l,c,d,h,v,f,m,_,y,w,C,k=this,O=k._self._c;return O("div",{staticClass:"c-workflow-history-item"},[O("div",{staticClass:"workflow-history-item-header",class:{"mb-10":k.isNewProcessBar}},[O("div",{staticClass:"workflow-history-item__title"},[O("img",{staticClass:"workflow-history-item__avatar",attrs:{src:k.defaultAvatar,alt:"Avatar"}}),k._v(" "),O("el-tooltip",{attrs:{effect:"dark",content:null===(t=k.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name,placement:"top"}},[O("div",{staticClass:"workflow-history-item__title-task-tag"},[O("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return k.jumpWork(k.message)}}},[k._v(k._s(null===(e=k.message)||void 0===e||null===(e=e.creativity)||void 0===e?void 0:e.name))])])]),k._v(" "),O("div",{staticClass:"workflow-history-item__btn-box"},[k.taskFailData.show?O("div",{staticClass:"task-info-icon-box"},[O("el-tooltip",{attrs:{effect:"dark",content:k.taskFailData.tips,placement:"top"}},[O("img",{staticClass:"task-info-icon",attrs:{src:n(750),alt:"task_fail"}})])],1):k._e(),k._v(" "),O("div",{staticClass:"task-info-icon-box"},[O("img",{staticClass:"task-info-icon",attrs:{src:n(666),alt:"task_fail"},on:{click:function(t){return k.retryWork(k.message)}}})]),k._v(" "),O("div",{staticClass:"task-info-icon-box"},[O("el-popover",{attrs:{trigger:"click","popper-class":"custom-popver"}},[O("div",{staticClass:"task-info-tips"},[O("p",[O("span",[k._v(k._s(k.$t("TaskID")))]),O("span",[k._v(k._s(k.message.id))])]),k._v(" "),3===k.message.status?[[1,2,"1","2"].includes(null===(o=k.message)||void 0===o?void 0:o.pub_community)?O("p",[O("span",{staticClass:"task-info-tips-label"},[k._v(k._s(k.$t("status")))]),k._v(" "),O("span",{staticClass:"task-pub-status"},[k._v(k._s([2,"2"].includes(null===(r=k.message)||void 0===r?void 0:r.pub_community)?k.$t("createSetting1"):k.$t("createSetting2")))])]):k._e(),k._v(" "),O("p",[O("span",{staticClass:"task-info-tips-label"},[k._v(k._s(k.$t("expend")))]),k._v(" "),O("span",{staticClass:"task-info-tips-content"},[O("span",[k._v(k._s(k.$t("tempCoins"))+" : "+k._s(null===(l=k.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.temp_hashrate))]),k._v(" "),O("span",[k._v(k._s(k.$t("calculateCoins"))+" : "+k._s(null===(c=k.message)||void 0===c||null===(c=c.deduction_detail)||void 0===c?void 0:c.hashrate))])])]),k._v(" "),null!==(d=k.message)&&void 0!==d&&null!==(d=d.deduction_detail)&&void 0!==d&&d.history_hashrate?O("p",[O("span",{staticClass:"task-info-tips-label"},[k._v(k._s(k.$t("currentBalance")))]),k._v(" "),O("span",{staticClass:"task-info-tips-content"},[O("span",[k._v(k._s(k.$t("tempCoins"))+" : "+k._s(null===(h=k.message)||void 0===h||null===(h=h.deduction_detail)||void 0===h?void 0:h.after_temp_hashrate))]),k._v(" "),O("span",[k._v(k._s(k.$t("calculateCoins"))+" : "+k._s(null===(v=k.message)||void 0===v||null===(v=v.deduction_detail)||void 0===v?void 0:v.after_hashrate))])])]):k._e(),k._v(" "),k.isNewProcessBar?O("p",[O("span",{staticClass:"task-info-tips-label"},[k._v(k._s(k.$t("newGenerate26")))]),k._v(" "),O("span",{staticClass:"task-info-tips-content"},[k.message.create_at?O("span",[k._v(" "+k._s(k._f("formatDateTime")(k.message.create_at))+" ")]):k._e()])]):k._e()]:k._e()],2),k._v(" "),O("img",{staticClass:"task-info-icon",staticStyle:{"vertical-align":"bottom"},attrs:{slot:"reference",src:n(751),alt:""},slot:"reference"})])],1),k._v(" "),O("div",{staticClass:"task-info-icon-box"},[O("img",{staticClass:"task-info-icon",attrs:{src:n(749),alt:"task_fail"},on:{click:k.handleDeleteTask}})])])],1)]),k._v(" "),k.isNewProcessBar?k._e():O("div",{staticClass:"workflow-history-item__title-time"},[k.message.create_at?O("span",[k._v(" "+k._s(k._f("formatDateTime")(k.message.create_at))+" ")]):k._e(),k._v(" "),O("span",{directives:[{name:"show",rawName:"v-show",value:k.isShowExpireTime,expression:"isShowExpireTime"}],staticClass:"expire-time-text",on:{click:function(t){return t.stopPropagation(),k.toMall.apply(null,arguments)}}},[k._v("\n      "+k._s(k.getExpireTime)+"\n    ")])]),k._v(" "),[2,"2",3,"3"].includes(k.message.status)?O("div",{staticClass:"workflow-history-image-container",class:[1===(null===(f=k.message)||void 0===f||null===(f=f.components)||void 0===f?void 0:f.length)&&"workflow-history-image-container-full"]},[!k.isLoggedIn&&null!==(m=k.message)&&void 0!==m&&null!==(m=m.components)&&void 0!==m&&m.length?O("TryCreateMask",{attrs:{behavior_info:"on_swift_ai_detail_page",reg_source:"swift_ai_detail_page"}}):k._e(),k._v(" "),k._l(k.getComponentsArr,(function(t,e){return[4==t.type?O("div",{key:"list-item-file_".concat(e),staticClass:"c-history-box c-history-box-file"},[O("CFile",{attrs:{file:{url:t.url}}})],1):2==t.type?O("div",{key:"list-item-text_".concat(e),staticClass:"c-history-box c-history-box-text"},[O("CText",{ref:"textRef",refInFor:!0,attrs:{text:null==t?void 0:t.content,backgroundColor:"#20212B"}})],1):3==t.type?O("div",{key:"list-item-audio_".concat(e),staticClass:"c-history-box c-history-box-audio"},[O("CAudio",{attrs:{audio:{url:t.url}}})],1):6==t.type?O("div",{key:"list-item-model_".concat(e),staticClass:"c-history-box c-history-box-model"},[O("history-model",{attrs:{message:t},on:{"view-model":function(e){return k.show3DModel(t)}}})],1):O("div",{key:"list-item-img_".concat(e),staticClass:"c-history-box c-history-box-img"},[O("history-img",{attrs:{src:t.url,nsfw:t.nsfw,width:t.width,height:t.height,"operate-number":e+1,"img-info":t,message:k.message},on:{updateImageInfo:k.updateImageInfo,deleteSingleImg:k.deleteSingleImg,saveSuccess:function(t){k.alreadySave=!0},retryWork:k.retryWork}})],1)]}))],2):k._e(),k._v(" "),[1,"1",2,"2",4,"4"].includes(k.message.status)?O("div",{staticClass:"message-process-container"},[[2,"2"].includes(k.message.status)&&k.computedPercentage(k.message)?O("div",{staticClass:"message-process-panel"},[k.isNewProcessBar?O("ProgressBar",{attrs:{value:k.computedPercentage(k.message)}}):O("el-progress",{attrs:{percentage:k.computedPercentage(k.message),color:k.customColor,"show-text":!1,"stroke-width":7}})],1):k._e(),k._v(" "),O("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(k.message.status)?[O("div",{staticClass:"process-operate-box-wrap"},[O("span",{staticClass:"process-operate-box-text"},[k._v(k._s(k.$t("TaskStatusWaitingToStart"))+"\n            "),O("span",{staticClass:"message-process-loading-span"})]),k._v(" "),O("div",{staticClass:"process-operate-box-wrap-quick"},[O("QuickQueue",{attrs:{quickOptions:k.message,quickStyle:{height:"26px",fontSize:"12px"}}})],1)])]:[2,"2"].includes(k.message.status)&&!k.computedPercentage(k.message)?[O("span",{staticClass:"process-operate-box-text"},[k._v(k._s(k.$t("TaskStatusPreparing"))+" "),O("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(k.message.status)?O("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[k._v(k._s(k.convertStatusText))]):O("span",{staticClass:"process-operate-box-text"},[k.isNewProcessBar&&null!==(_=k.message)&&void 0!==_&&null!==(_=_.estimate_time)&&void 0!==_&&_.min_time&&null!==(y=k.message)&&void 0!==y&&null!==(y=y.estimate_time)&&void 0!==y&&y.max_time?[k._v("\n          "+k._s(k.$t("ai_app_genarate_time_estimate",{estimate:"".concat(null===(w=k.message)||void 0===w||null===(w=w.estimate_time)||void 0===w?void 0:w.min_time,"-").concat(null===(C=k.message)||void 0===C||null===(C=C.estimate_time)||void 0===C?void 0:C.max_time)}))+"\n          "),O("span",{staticClass:"message-process-loading-span"})]:[k._v("\n          "+k._s(k.$t("youHaveCompleted"))+"\n          "),O("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[k._v("\n            "+k._s(k.computedPercentage(k.message))+"%\n          ")]),k._v(" "),O("span",{staticClass:"message-process-loading-span"})]],2),k._v(" "),O("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:k.$t("canceTaskNum",{num:3}),placement:"top"}},[k.isShowCancel?O("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:k.isLoading},attrs:{type:"danger",size:"mini","data-type":"ai_app","data-group":"message-process-operate-box-btn","data-event":"cancelTask","data-id":"cancelTask","data-pt":k.isNewProcessBar?"new_create_workflow_add_task_duration":"old_create_workflow_task_progress_percentage"},on:{click:k.handleCancelTask}},[k._v("\n          "+k._s(k.isLoading?"".concat(k.$t("canceling"),"..."):k.$t("Cancel"))+"\n        ")]):k._e()],1)],2)]):k._e(),k._v(" "),O("ModelViewer",{ref:"modelViewer",on:{handleOperation:k.handleModelOperation}})],1)}),[],!1,null,"cb4dc088",null)),It=Pt.exports;installComponents(Pt,{TryCreateMask:n(319).default,CFile:n(424).default,CText:n(425).default,CAudio:n(289).default,QuickQueue:n(119).default});var $t=n(460),jt=n(57),Lt=n(25),Mt=n(302),Et={name:"historyApplyList",props:{list:{type:Array,default:function(){return[]}}},methods:{handleClick:function(t){this.$route.params.id===t.id?this.$emit("setActiveTab"):(this.$logEvent("log_actions",{operation:"click",behavior_info:"on_ai_app_detail_page_app_tab",behavior_info_sub:t.id}),this.$router.push(this.localePath("/workFlowAppDetail/".concat(t.id))))}}},Ft=(n(5382),Object(Z.a)(Et,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"history-apply-list"},[e("div",{staticClass:"image-grid"},t._l(t.list,(function(n,o){return e("div",{key:n.id||o,staticClass:"image-card",on:{click:function(e){return t.handleClick(n)}}},[e("div",{staticClass:"image-container"},[e("div",{staticClass:"image-create"},[t._v("\n          "+t._s(t.$t("Try"))+"\n        ")]),t._v(" "),e("img",{staticClass:"image",attrs:{decoding:"async",loading:"lazy",src:n.cover.url,alt:n.title}}),t._v(" "),e("div",{staticClass:"image-title ellipsis-line"},[t._v(t._s(n.title))])])])})),0)])}),[],!1,null,"2b1bf500",null).exports),At=n(129);function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Bt={name:"workFlowAppDetailHistoryPage",inject:["top"],data:function(){return{viewMode:"list",list:[],loading:!1,queryParams:{limit:10},params:{page:1,page_size:35,order_by:"",offset:"",tag_ids:[],source_types:[24]},hasMore:!0,showScroll:!0,debounceHandleScroll:function(){},dialogVisible:!1,viewImageList:[],activeCard:null,currentImageIndex:0,tabs:[{label:this.$t("Tasks"),value:"create"},{label:this.$t("recentlyUsed"),value:"apply"}],activeTab:"create",applyList:[]}},watch:{},mixins:[$t.a],computed:Rt(Rt(Rt({},Object(y.c)("user",["taskExpireDay","isLoggedIn","userInfo"])),Object(y.e)("payment",["paymentInfo"])),{},{renderCardList:function(){return this.list.filter((function(t){var e;return[3,"3"].includes(t.status)&&(null==t||null===(e=t.components)||void 0===e?void 0:e.length)}))},getExpirationTime:function(){return this.taskExpireDay},isVip:function(){var t,e;return!!(null!==(t=this.paymentInfo)&&void 0!==t&&t.activeState||null!==(e=this.paymentInfo)&&void 0!==e&&e.liteActiveState)},showExpireTime:function(){var t=this.paymentInfo.productLevel,e=[4,3].includes(t);return this.isLoggedIn&&!e&&0!==this.getExpirationTime}}),components:{historyItem:It,taskImageViewer:Mt.default,historyImg:ft,NoData:At.default,TryCreateMask:f.default,historyApplyList:Ft},mounted:function(){var t=this;this.initScrollBar(),this.isLoggedIn&&(this.getApplyList(),this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_ai_app_detail_page_app_tab",behavior_info_sub:"Recently Used"})),this.debounceHandleScroll=Object(Lt.debounce)(this.handleScroll,600),this.getList(),this.$EventBus.$on("deleteHistoriesList",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(){var n=t.list.filter((function(t){return t.id!=e}));t.$set(t,"list",n),t.top.changeSelectedId("")};if(n.length){var r,l=t.list.findIndex((function(t){return t.id==e}))||0,c=null===(r=t.list)||void 0===r?void 0:r[l];if(c){var d=c.components.filter((function(t){return!n.includes(t.index)}));d.length?t.$set(t.list[l],"components",d):o()}}else o()}))},destroyed:function(){this.debounceHandleScroll=function(){}},methods:{doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},viewBigImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.activeCard=t,this.viewImageList=[e],this.dialogVisible=!0},closeViewBigImage:function(){this.dialogVisible=!1,this.viewImageList=[],this.activeCard=null},deleteSingleImg:function(t,e){var n=this,o=e||{},r=o.id,l=void 0===r?"":r,c=o.components,d=(void 0===c?[]:c)[t-1].index,h=void 0===d?-1:d;Object(D.b)({id:l,index:h}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.list.forEach((function(t){var o;t&&(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(n.$set(t,"components",((null==t?void 0:t.components)||[]).filter((function(t){return t.index!==h}))),null!=t&&null!==(o=t.components)&&void 0!==o&&o.length||n.handleDeleteTask(null==t?void 0:t.id))}))}))},updateImageInfo:function(t,e,n,o){var r,l=this.list.find((function(e){return e.id===t})),c=null==l||null===(r=l.components)||void 0===r?void 0:r.find((function(t){return t.index===e}));this.$set(c,n,o)},insertDataToList:function(t){this.list.unshift(t)},handleDeleteTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.list.findIndex((function(e){return e.id===t}));-1!==e&&this.list.splice(e,1),this.top.changeSelectedId("")},changeViewMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.doLogEvent(e),this.scrollToTop("instant"),this.viewMode=t},setActiveTab:function(){this.$emit("setActiveTab")},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleRefresh:function(){this.list=[],this.hasMore=!0,this.getList()},addHeadItem:function(t){var e=this,n=t||[],o=Object(r.a)(n,1)[0];this.list.unshift(o),this.activeTab="create",setTimeout((function(){e.$refs.scrollWrapper.scrollTop=0}),0),this.getApplyList()},getApplyList:function(){var t=this;this.isLoggedIn&&Object(_.getRecentSquare)(this.params).then((function(e){var n=((null==e?void 0:e.data)||{}).items,o=void 0===n?[]:n;1e4===e.status.code&&(t.applyList=o)}))},getList:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=(null===(t=this.$route.params)||void 0===t||t.id,{limit:20,scene:1});["",null,void 0].includes(n)||(o.time_from=n),this.loading=!0,this.isLoggedIn||(o.g_mode=1),Object(m.g)(o).then((function(t){var n=(null==t?void 0:t.data)||{},r=n.items,l=void 0===r?[]:r,c=n.has_more,d=void 0===c||c;if(e.hasMore=d,null!=o&&o.time_from){var h,f,m=Object(jt.objectArrayDeduplicationMerge)(e.list,l||[]),_=null===(h=e.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(f=e.list).push.apply(f,Object(v.a)(m)),_&&m.length&&e.scrollToTop(_,"instant")}else e.list=Array.isArray(l)&&null!=l&&l.length?l:[],e.scrollToTop(0,"instant")})).finally((function(){e.loading=!1}))},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var t=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===t&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&t>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,"create"===this.activeTab&&t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.create_at:"";this.getList(e)},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).info;console.log("info",e);var n=e.id,o=void 0===n?"":n,r={action:5,task_id:o};this.handleUpdateCancelBtnStatus(o,!0),this.$logEvent("log_actions",{operation:"click_cancel_task",behavior_info:"on_quick_ai_app_page"}),Object(E.operateTask)(r).then((function(e){var n=e||{},r=n.status,l=void 0===r?{}:r,c=n.data,data=void 0===c?{}:c,d=l.code,code=void 0===d?"":d;if([1e4,"10000"].includes(code)){var h=(null==data?void 0:data.task_return)||{},v=h.sub_status,f=void 0===v?0:v,m=h.used,_=void 0===m?0:m,y=h.free_num,w=h.remain_num,C=h.hashrate,k=void 0===C?0:C,O=h.temp_hashrate,x=void 0===O?0:O;if(401==f)t.$message.success(t.$t("task_fail_free_cancle",{freeCount:y,remainCount:w}));else{var T=_||"",S="";_<=0&&k>0&&(T="".concat(k).concat(t.$t("coin"))),_<=0&&x>0&&(S="".concat(x).concat(t.$t("tempCoins"))),t.$message.success(t.$t("task_fail_cancle",{cost:T,unit:S}))}var D=t.list.findIndex((function(t){return t.id===o}));-1!==D&&t.list.splice(D,1)}else[1e4,"10000"].includes(code)||t.handleTaskError(code),t.$logEvent("log_generates",{work_id:o,operation:"cancel_generate"})})).finally((function(){t.handleUpdateCancelBtnStatus(o,!1)}))},handleTaskError:function(code){var t={7e4:this.$t("taskOperateFailed"),70001:this.$t("taskExceededDailyGenerationLimit"),70002:this.$t("taskQueueFull"),70003:this.$t("taskModelVersionNotSupportVariations"),70009:this.$t("taskModelForbidden"),70008:this.$t("taskArtWorkForbidden"),80008:this.$t("InsufficientBalance"),70045:this.$t("HttpErrorCode_70045")};code&&t[code]?"70045"==code?this.$message.warning(t[code]):this.$message.error(t[code]):this.$message.error(this.$t("ServerError"))},handleUpdateCancelBtnStatus:function(t,e){var n=this;this.list.forEach((function(o){o.id===t&&n.$set(o,"isLoading",e)}))},changeTab:function(t){t!==this.activeTab&&(this.activeTab=t,"apply"===t&&this.$logEvent("log_actions",{operation:"click_app_tab",behavior_info:"on_ai_app_detail_page"}))}}},Ut=Bt,Vt=(n(5383),Object(Z.a)(Ut,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-workflow-history-modal"},[t.isLoggedIn?e("div",{staticClass:"workflow-history-modal__tabs"},t._l(t.tabs,(function(n){return e("div",{key:n.value,staticClass:"workflow-history-modal__tab-item",class:{"workflow-history-modal__tab-active":t.activeTab===n.value},on:{click:function(e){return t.changeTab(n.value)}}},[t._v("\n      "+t._s(n.label)+"\n    ")])})),0):t._e(),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"workflow-history-modal__content",class:["grid"===t.viewMode&&"card-flex-content"],on:{scroll:t.debounceHandleScroll}},["grid"===t.viewMode&&"create"===t.activeTab?[t._l(t.renderCardList,(function(n,i){return[t.isLoggedIn?t._e():e("TryCreateMask",{key:"try-create-mask_".concat(i),attrs:{behavior_info:"on_swift_ai_detail_page",reg_source:"swift_ai_detail_page"}}),t._v(" "),t._l((null==n?void 0:n.components)||[],(function(o,r){return[e("history-img",{key:"card-image_".concat(i,"_").concat(r),staticClass:"history-image-card",attrs:{src:o.url,nsfw:o.nsfw,width:o.width,height:o.height,"operate-number":r+1,"img-info":o,message:n},on:{deleteSingleImg:t.deleteSingleImg,updateImageInfo:t.updateImageInfo}})]}))]}))]:t._e(),t._v(" "),"list"===t.viewMode&&"create"===t.activeTab?t._l(t.list,(function(n){return e("history-item",{key:n.id,attrs:{message:n,viewMode:t.viewMode},on:{deleteTask:t.handleDeleteTask,onRetryWork:t.retryWork,onCancelTask:t.handleCancelTask,updateImageInfo:t.updateImageInfo}})})):t._e(),t._v(" "),"apply"===t.activeTab?[e("history-apply-list",{attrs:{list:t.applyList},on:{setActiveTab:t.setActiveTab}})]:t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&("create"===t.activeTab&&t.list.length&&!t.hasMore||"apply"===t.activeTab&&t.applyList.length),expression:"\n        !loading &&\n        ((activeTab === 'create' && list.length && !hasMore) || (activeTab === 'apply' && applyList.length))\n      "}],staticClass:"workflow-history-modal-no-more"},[t._v("\n      "+t._s(t.$t("workFlow35"))+"\n    ")]),t._v(" "),"create"===t.activeTab&&!t.list.length||"apply"===t.activeTab&&!t.applyList.length?e("no-data"):t._e()],2),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"loadBox"}),t._v(" "),t.dialogVisible?e("task-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!1,message:t.activeCard,"url-list":t.viewImageList}}):t._e()],1)}),[],!1,null,"1c518cd9",null)),Wt=Vt.exports;installComponents(Vt,{TryCreateMask:n(319).default,NoData:n(129).default});var qt=n(63),Ht=n(429),Gt=n(45),zt=n(58),Yt=n(82),Jt=n(53),Kt=n(608);function Qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Zt={name:"ContentViewerTop",props:{workFlowAppData:{type:Object,default:function(){}}},inject:["commentTabRef"],components:{Evaluate:Ht.default,CollectPopover:qt.default,BaseAvatar:Jt.default,HyMorePopover:Kt.default},mixins:[Gt.a],data:function(){var t;return{formatNumberForeign:w.p,isFollow:(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.is_follow)||!1,moreList:[{ctype:"report",isBack:!0},{ctype:"noLike",isBack:!0}]}},computed:Xt(Xt(Xt({},Object(y.e)("user",["userInfo"])),Object(y.c)("user",["isLoggedIn"])),{},{original:function(){var t;return 1===(null===(t=this.workFlowAppData.permission)||void 0===t?void 0:t.source)},getUpdateTime:function(){var t;return(null===(t=this.workFlowAppData)||void 0===t?void 0:t.update_at)||""},formatUpdateTime:function(){return this.getUpdateTime?Object(zt.i)(this.getUpdateTime,"yyyy-MM-dd hh:mm:ss"):""},getAuthorHead:function(){var t;return null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.head},getHeadStyle:function(){return{"background-color":this.getAuthorHead?"transparent":"#ADB8CD"}},getLetter:function(){var t,e=(null===(t=this.workFlowAppData)||void 0===t?void 0:t.author)||{},n=e.id,o=void 0===n?"":n,r=e.name,l=void 0===r?"":r;return l?l[0].toUpperCase():o[0].toUpperCase()},isShowJumper:function(){var t,e=this.workFlowAppData,n=e.author,o=void 0===n?{}:n,r=e.type;return(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null==o?void 0:o.id)&&4!=r},targetItem:function(){var t=this.workFlowAppData||{},e=t.id,n=void 0===e?"":e,o=t.obj_type;return{id:n,obj_type:void 0===o?13:o,view_domain:"detail"}}}),methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},handleToComment:function(){var t="function"==typeof this.commentTabRef?this.commentTabRef():this.commentTabRef;t&&"function"==typeof t.switchToCommentTab&&t.switchToCommentTab(),this.$nextTick((function(){setTimeout((function(){var t=document.querySelector("#workflow-comment-section");if(t){var e=t.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:e-200,behavior:"smooth"})}else{var n=document.querySelector(".right-works-box");if(n){var o=n.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:o-200,behavior:"smooth"})}}}),300)}))},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))},goWorkflow:function(){var t,e=this.workFlowAppData,n=e.id,o=void 0===n?"":n,r=e.author,l=void 0===r?{}:r,path="/workflow?id="+o+"&source="+((null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null==l?void 0:l.id)?3:4)+"&source_id="+o;this.$router.push(this.localePath({path:path}))},goPublish:function(){var t,e=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"",path="/aiapp/publish/".concat(e,"?template_id=").concat(e);window.open(path,"_blank")},handleMark:function(){this.isLoggedIn?this.setCollectData(this.workFlowAppData).includes("icon-collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.workFlowAppData,"swtft_app")):this.$refs.collectPopover.visible=!0:this.$EventBus.$emit("openLoginDialog")},setFollowUser:function(t){var e,n=this,o={follow_account_no:(null===(e=this.workFlowAppData)||void 0===e?void 0:e.author).id||""};(t?Yt.f:Yt.g)(o).then((function(){n.isFollow=!t}))},goToCreationCenter:function(){this.original&&(this.$logEvent("log_actions",{operation:"click_creator_revenue_center",behavior_info:location.href}),this.$router.push("/creationCenter"))}}},te=(n(5384),Object(Z.a)(Zt,(function(){var t,e,n,o,r,l,c,d,h,v,f,m,_,y,w,C,k=this,O=k._self._c;return O("div",{staticClass:"content-viewer-top"},[O("div",{staticClass:"content-viewer-top-info space-between"},[O("div",{staticClass:"content-viewer-top-info-left flex_m"},[[0,1].includes(null===(t=k.workFlowAppData)||void 0===t?void 0:t.show_reward_plan)?O("div",{staticClass:"content-viewer-top-info-type flex-center",style:{cursor:k.original?"pointer":"default"},attrs:{"data-event":"click_type_original"},on:{click:k.goToCreationCenter}},[O("svg-icon",{attrs:{"icon-class":k.original?"modelOriginal":"modelReship"}}),k._v(" "),O("div",{staticClass:"txt"},[k._v(k._s(k.original?k.$t("Original")+" - "+k.$t("motivatingTitle"):k.$t("Reship")))])],1):k._e(),k._v(" "),O("h1",{staticClass:"title overflow-ellipsis"},[k._v("\n        "+k._s(k.workFlowAppData.name)+"\n      ")]),k._v(" "),k.workFlowAppData.id?O("Evaluate",{staticClass:"evaluate-box",attrs:{from:"comfyuiAppDetail",evaluateData:k.workFlowAppData}}):k._e()],1)]),k._v(" "),O("div",{staticClass:"content-viewer-top-info space-user"},[null!==(e=k.workFlowAppData)&&void 0!==e&&e.author?O("div",{staticClass:"content-viewer-top-info-author"},[O("div",{staticClass:"head",style:k.getHeadStyle,on:{click:k.jumpToOtherUser}},[O("BaseAvatar",{attrs:{"user-data":k.workFlowAppData.author,size:24,theme:"dark"}})],1),k._v(" "),O("div",{staticClass:"name flex-center overflow-ellipsis",on:{click:k.jumpToOtherUser}},[O("a",{staticClass:"personal-info-a overflow-ellipsis",attrs:{href:k.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[k._v("\n          "+k._s((null===(n=k.workFlowAppData)||void 0===n?void 0:n.author.name)||(null===(o=k.workFlowAppData)||void 0===o?void 0:o.author.id))+"\n        ")])])]):k._e(),k._v(" "),O("div",{staticClass:"follow-btn",attrs:{"data-event":k.isFollow?"click_unfollow":"click_follow","data-id":null===(r=k.workFlowAppData)||void 0===r||null===(r=r.author)||void 0===r?void 0:r.id},on:{click:function(t){return k.setFollowUser(k.isFollow)}}},[k._v("\n      "+k._s(k.isFollow?k.$t("Followed"):k.$t("Follows"))+"\n    ")]),k._v(" "),k.getUpdateTime?O("div",{staticClass:"content-viewer-top-info-date"},[k._v(k._s(k.formatUpdateTime)+" "+k._s(k.$t("renew")))]):k._e(),k._v(" "),O("div",{staticClass:"content-viewer-top-info-right"},[O("div",{staticClass:"stats-container"},[O("div",{staticClass:"stats-item"},[O("span",{staticClass:"stats-value"},[k._v(k._s(k.formatNumberForeign(null===(l=k.workFlowAppData)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_view)))]),k._v(" "),O("span",{staticClass:"stats-label"},[k._v(k._s(k.$t("Viewed")))])]),k._v(" "),O("div",{staticClass:"stats-item"},[O("span",{staticClass:"stats-value"},[k._v(k._s(k.formatNumberForeign(null===(c=k.workFlowAppData)||void 0===c||null===(c=c.stat)||void 0===c?void 0:c.num_of_task)))]),k._v(" "),O("span",{staticClass:"stats-label"},[k._v(k._s(k.$t("workFlow46")))])])]),k._v(" "),O("div",{staticClass:"action-buttons"},[O("div",{staticClass:"action-btn collect-btn",on:{click:k.handleMark}},[O("CollectPopover",{ref:"collectPopover",attrs:{hideBtn:!0,type:"swtft_app",folder:k.workFlowAppData}},[O("div",{staticClass:"collect-btn"},[O("i",{staticClass:"iconfont",class:k.setCollectData(k.workFlowAppData)})]),k._v(" "),null!==(d=k.workFlowAppData)&&void 0!==d&&null!==(d=d.stat)&&void 0!==d&&d.num_of_collection?k._e():O("span",{staticClass:"action-text"},[k._v(k._s(k.$t("Collect")))]),k._v(" "),(null===(h=k.workFlowAppData)||void 0===h||null===(h=h.stat)||void 0===h?void 0:h.num_of_collection)>0?O("span",{staticClass:"collect-num"},[k._v("\n              "+k._s(k.formatNumberForeign(null===(v=k.workFlowAppData)||void 0===v||null===(v=v.stat)||void 0===v?void 0:v.num_of_collection))+"\n            ")]):k._e()])],1),k._v(" "),O("div",{staticClass:"action-btn comment-btn",on:{click:k.handleToComment}},[O("i",{staticClass:"iconfont icon-comment"}),k._v(" "),null!==(f=k.workFlowAppData)&&void 0!==f&&null!==(f=f.stat)&&void 0!==f&&f.num_of_comment?k._e():O("span",{staticClass:"action-text"},[k._v(k._s(k.$t("comment")))]),k._v(" "),(null===(m=k.workFlowAppData)||void 0===m||null===(m=m.stat)||void 0===m?void 0:m.num_of_comment)>0?O("span",{staticClass:"action-count"},[k._v("\n            "+k._s(k.formatNumberForeign((null===(_=k.workFlowAppData)||void 0===_||null===(_=_.stat)||void 0===_?void 0:_.num_of_comment)||0))+"\n          ")]):k._e()]),k._v(" "),O("div",{staticClass:"action-btn share-btn",on:{click:function(t){return k.$emit("onHandShare")}}},[O("i",{staticClass:"iconfont icon-share-icon"}),k._v(" "),null!==(y=k.workFlowAppData)&&void 0!==y&&null!==(y=y.stat)&&void 0!==y&&y.num_of_share?k._e():O("span",{staticClass:"action-text"},[k._v(k._s(k.$t("Share")))]),k._v(" "),(null===(w=k.workFlowAppData)||void 0===w||null===(w=w.stat)||void 0===w?void 0:w.num_of_share)>0?O("span",{staticClass:"action-count"},[k._v("\n            "+k._s(k.formatNumberForeign((null===(C=k.workFlowAppData)||void 0===C||null===(C=C.stat)||void 0===C?void 0:C.num_of_share)||0))+"\n          ")]):k._e()]),k._v(" "),O("div",{directives:[{name:"show",rawName:"v-show",value:k.isShowJumper,expression:"isShowJumper"}],staticClass:"action-btn edit-btn"},[O("el-popover",{attrs:{placement:"bottom-end","popper-class":"workflow-app-popover jumper","append-to-body":!1,"visible-arrow":!1,trigger:"click"}},[O("div",{staticClass:"content"},[O("div",{staticClass:"item",on:{click:k.goWorkflow}},[k._v(k._s(k.$t("comfyui_enter"))+" ComfyUI")]),k._v(" "),O("div",{staticClass:"item",on:{click:k.goPublish}},[k._v("\n                "+k._s(k.$t("workflow_app_publish"))+"\n              ")])]),k._v(" "),O("div",{staticClass:"edit-btn-content flex-center",attrs:{slot:"reference"},slot:"reference"},[O("i",{staticClass:"icon-jumper iconfont icon-edit-03"}),k._v(" "),O("span",[k._v(k._s(k.$t("Edit")))])])])],1),k._v(" "),O("HyMorePopover",{attrs:{list:k.moreList,targetItem:k.targetItem,placement:"bottom-end"}},[O("div",{staticClass:"action-btn more-btn"},[O("i",{staticClass:"iconfont icon-Ellipsis1"})])])],1)])])])}),[],!1,null,"793fe594",null)),ee=te.exports;installComponents(te,{SvgIcon:n(115).default,Evaluate:n(429).default,BaseAvatar:n(53).default,CollectPopover:n(63).default});var ie=n(34);function ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var ae={data:function(){return{isShowDialog:!1,message:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ne(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(y.c)("user",["isCompanyAccount"])),methods:{openDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isShowDialog=!0,this.message=t},closeDialog:function(){this.isShowDialog=!1,this.message={}}}},oe=ae,se=(n(5385),Object(Z.a)(oe,(function(){var t,e,n,o,r,l,c,d,h,v=this,f=v._self._c;return f("el-dialog",{staticClass:"consume-dialog custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",visible:v.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){v.isShowDialog=t}}},[f("div",{staticClass:"task-info-tips"},[f("p",[f("span",[v._v("\n        "+v._s(v.$t("TaskID"))+"\n      ")]),v._v(" "),f("span",[v._v("\n        "+v._s(null===(t=v.message)||void 0===t?void 0:t.id)+"\n      ")])]),v._v(" "),3!==(null===(e=v.message)||void 0===e?void 0:e.status)||v.isCompanyAccount?v._e():[[1,2,"1","2"].includes(null===(n=v.message)||void 0===n?void 0:n.pub_community)?f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("status")))]),v._v(" "),f("span",{staticClass:"task-pub-status"},[v._v("\n          "+v._s([2,"2"].includes(null===(o=v.message)||void 0===o?void 0:o.pub_community)?v.$t("createSetting1"):v.$t("createSetting2"))+"\n        ")])]):v._e(),v._v(" "),f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("expend")))]),v._v(" "),f("span",{staticClass:"task-info-tips-content"},[f("span",[v._v("\n            "+v._s(v.$t("tempCoins"))+" :\n            "+v._s(null===(r=v.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.temp_hashrate)+"\n          ")]),v._v(" "),f("span",[v._v("\n            "+v._s(v.$t("calculateCoins"))+" :\n            "+v._s(null===(l=v.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.hashrate)+"\n          ")])])]),v._v(" "),null!==(c=v.message)&&void 0!==c&&null!==(c=c.deduction_detail)&&void 0!==c&&c.history_hashrate?f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("currentBalance")))]),v._v(" "),f("span",{staticClass:"task-info-tips-content"},[f("span",[v._v("\n            "+v._s(v.$t("tempCoins"))+" :\n            "+v._s(null===(d=v.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_temp_hashrate)+"\n          ")]),v._v(" "),f("span",[v._v("\n            "+v._s(v.$t("calculateCoins"))+" :\n            "+v._s(null===(h=v.message)||void 0===h||null===(h=h.deduction_detail)||void 0===h?void 0:h.after_hashrate)+"\n          ")])])]):v._e()]],2)])}),[],!1,null,"38c0509a",null).exports),re={name:"ContentViewerImages",inject:["top"],props:{workFlowAppData:{type:Object,default:function(){}}},components:{ConsumePopover:se,ElImageViewer:et.a},data:function(){return{isDescOverSize:!1,isShowMoreDesc:!0,currentIndex:1,displayMode:"default",imgBtns:[{icon:"icon-icon_xiazai",key:"download",label:"Download"},{icon:"icon-baocun",key:"save",label:"Save"},{icon:"icon-shanchu3",key:"delete",label:"Delete"}],thumbnailTopStatus:"edit",selectedArr:[],dialogVisible:!1,isTwo:!1,threeCarouse:!1}},computed:{getProgress:function(){return this.workFlowAppData.progress},getList:function(){var t=this.workFlowAppData,e=t.selectedId,n=t.histories,o={};e&&(o=n&&n.find((function(t){return t.id==e}))||{});var r=e?o.components:this.workFlowAppData.samples,l=[],c=[];if(r.forEach((function(t,e){c.push(t);var n=e+1;(n%2==0||1===r.length||n%2!=0&&n===r.length)&&(l.push(c),c=[])})),this.isTwo=2===l.length,this.isTwo){var d=l;l=l.concat(d)}return l},getSamples:function(){var t=this.workFlowAppData,e=t.selectedId,n=t.histories,o={};return e&&(o=n&&n.find((function(t){return t.id==e}))||{}),e?o.components:this.workFlowAppData.samples},handleCarousel:function(){return[{twoBox:this.isTwo},{elseBox:!this.isTwo},{isTowCarouse:this.isTwo&&!this.threeCarouse},{isThreeCarouse:this.threeCarouse}]},filterXss:function(){return function(t){return ie.default.prototype.xss(t)}},getMoreClass:function(){return[this.isShowMoreDesc?"is-open":"is-close"]},operateBtns:function(){var t="default"==this.displayMode;return[{icon:"icon-SVG2",key:"checkInfos",label:"ViewOriginalDescription"},{icon:"icon-icon_grid",key:"thumbnailView",label:"ThumbnailDisplay",hide:!t},{icon:"icon-morenzhanshi",key:"defaultView",label:"DefaultDisplay",hide:t},{icon:"icon-baocun",key:"saveAll",label:"SaveAllPictures"},{icon:"icon-shanchu3",key:"deleteAll",label:"DeleteAllPictures"}]},isShowOperates:function(){var t;return null===(t=this.workFlowAppData)||void 0===t?void 0:t.selectedId},isVideo:function(){return function(t){return Object(w.H)(t)}},getViewerSrc:function(){return this.getSamples.map((function(t){return t.url}))},getTags:function(){var t;return(null===(t=this.workFlowAppData)||void 0===t?void 0:t.categories)||[]}},watch:{"workFlowAppData.desc":{handler:function(){var t=this;this.$nextTick((function(){try{var e=document.querySelector(".content-viewer-desc")||{};t.isDescOverSize=(null==e?void 0:e.offsetHeight)>24,t.isDescOverSize&&(t.isShowMoreDesc=!1)}catch(t){}}))},immediate:!0},dialogVisible:function(t){try{document.body.style.overflow=t?"hidden":""}catch(t){document.body.style.overflow=""}}},mounted:function(){this.$EventBus.$on("$E_sethandleSwiper",this.sethandleSwiper)},methods:{handlePrev:function(){var t=this.$refs.carousel;t&&t.prev()},handleNext:function(){var t=this.$refs.carousel;t&&t.next()},handleSwiper:function(t){this.threeCarouse=this.isTwo&&t>=2,this.currentIndex=t+1},sethandleSwiper:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.carousel;this.currentIndex=t+1,e&&e.setActiveItem(t)},getMessage:function(){var t=this.workFlowAppData,e=t.selectedId,n=void 0===e?"":e,o=t.histories;return(void 0===o?[]:o).find((function(t){return t.id==n}))},handleOperate:function(t){var e=this;switch(t){case"checkInfos":var n=this.getMessage();this.$refs.consumePopover.openDialog(n);break;case"thumbnailView":this.displayMode="thumbnail";break;case"defaultView":this.displayMode="default";break;case"saveAll":this.handleSaveTask();break;case"deleteAll":this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.handleDeleteTask()}))}},handleSaveTask:function(){var t=this,e=this.workFlowAppData.selectedId,n=void 0===e?"":e;if(n){var o=this.getSamples.map((function(t){return{folder_no:"default",id:n,index:t.index}}));Object(m.d)({items:o}).then((function(){t.$EventBus.$emit("saveHistories",n),t.$message.success(t.$t("SaveToPersonalCenter"))}))}},handleDeleteTask:function(){var t=this,e=this.workFlowAppData.selectedId,n=void 0===e?"":e;n&&Object(E.deleteTaskRecord)({ids:[n]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.initData(),t.$EventBus.$emit("deleteHistories",n),t.$EventBus.$emit("deleteHistoriesList",n)}))},initData:function(){this.currentIndex=1,this.displayMode="default",this.thumbnailTopStatus="edit",this.selectedArr=[],this.top.changeSelectedId("")},handleBigPic:function(i,t){this.currentIndex=2*i+t,this.dialogVisible=!0}}},le=re,ce=(n(5386),Object(Z.a)(le,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"content-viewer-images"},[null!==(t=e.workFlowAppData)&&void 0!==t&&t.desc?n("div",{staticClass:"content-viewer-images-top",class:e.getMoreClass},[n("div",{staticClass:"content-viewer-desc",domProps:{innerHTML:e._s(e.filterXss(e.workFlowAppData.desc))}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isDescOverSize,expression:"isDescOverSize"}],staticClass:"switch-btn",on:{click:function(t){e.isShowMoreDesc=!e.isShowMoreDesc}}},[e._v("\n      "+e._s(e.isShowMoreDesc?e.$t("PackUp"):e.$t("more"))+"\n      "),n("i",{staticClass:"el-icon-arrow-up"})])]):e._e(),e._v(" "),e.getTags.length?n("div",{staticClass:"content-viewer-images-contentstag-bar"},e._l(e.getTags,(function(t){return n("a",{key:t.value,staticClass:"tag-item",attrs:{href:e.localePath("/tagInfo/swiftapp/".concat(t.value)),target:"_blank",rel:"noopener noreferrer"}},[e._v("\n      #"+e._s(t.name)+"\n    ")])})),0):e._e(),e._v(" "),n("div",{staticClass:"content-viewer-images-contents"},[n("el-popover",{attrs:{placement:"bottom-end","popper-class":"workflow-app-popover operate","append-to-body":!1,"visible-arrow":!1,trigger:"hover"}},[n("div",{staticClass:"content"},e._l(e.operateBtns,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hide,expression:"!item.hide"}],key:t.key,staticClass:"item",on:{click:function(n){return e.handleOperate(t.key)}}},[n("i",{staticClass:"iconfont",class:t.icon}),e._v(" "),n("div",{staticClass:"label"},[e._v("\n            "+e._s(e.$t(t.label))+"\n          ")])])})),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"more-operates flex-center",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"iconfont icon-menu"})])]),e._v(" "),n("div",{class:e.handleCarousel},[n("el-carousel",{directives:[{name:"show",rawName:"v-show",value:"default"==e.displayMode,expression:"displayMode == 'default'"}],ref:"carousel",staticClass:"carouselBox",attrs:{"indicator-position":e.getList.length>1?"outside":"none",arrow:e.getList.length>1?"always":"never",autoplay:!1,"initial-index":e.currentIndex-1},on:{change:e.handleSwiper}},e._l(e.getList,(function(t,o){return n("el-carousel-item",{key:"img-".concat(t.index||o),staticClass:"swiper-item"},e._l(e.getList[o],(function(t,r){return n("div",{key:r,staticClass:"swiper-item-box"},[e.isVideo(t.url)?n("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:"",src:t.url},domProps:{muted:!0}}):n("div",{staticClass:"cover-box"},[n("img",{staticClass:"picture",attrs:{src:t.url,alt:e.workFlowAppData.desc},on:{click:function(t){return e.handleBigPic(o,r)}}})])])})),0)})),1)],1)],1),e._v(" "),n("ConsumePopover",{ref:"consumePopover"}),e._v(" "),e.dialogVisible?n("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"initial-index":e.currentIndex,"on-close":function(){return e.dialogVisible=!1},"url-list":e.getViewerSrc}}):e._e()],1)}),[],!1,null,"1ed8b85a",null).exports);function de(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ue(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?de(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pe={name:"ContentViewerHistories",inject:["top"],props:{workFlowAppData:{type:Object,default:function(){}}},mixins:[$t.a],data:function(){return{debounceHandleScroll:null,loading:!1,hasMore:!0,list:[],isOpen:!0,scrollHeight:0}},mounted:function(){var t=this;this.updateScrollHeight(),this.debounceHandleScroll=Object(Lt.debounce)(this.handleScroll,600),this.$EventBus.$on("saveHistories",(function(e){t.list.find((function(t){return t.id==e})).expiration_time=-1})),this.$EventBus.$on("addHistories",(function(e,n){var o,r;"front"==e?(o=t.list).unshift.apply(o,Object(v.a)(n)):(r=t.list).push.apply(r,Object(v.a)(n))})),this.$EventBus.$on("deleteHistories",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(){var n=t.list.filter((function(t){return t.id!=e}));t.$set(t,"list",n),t.top.changeSelectedId("")};if(n.length){var r,l=t.list.findIndex((function(t){return t.id==e}))||0,c=null===(r=t.list)||void 0===r?void 0:r[l];if(c){var d=c.components.filter((function(t){return!n.includes(t.index)}));d.length?t.$set(t.list[l],"components",d):o()}}else o()}))},beforeDestroy:function(){this.debounceHandleScroll=null,this.$EventBus.$off("saveHistories"),this.$EventBus.$off("addHistories"),this.$EventBus.$off("deleteHistories")},computed:ue(ue({},Object(y.c)("user",["isLoggedIn","taskExpireDay"])),{},{getGroups:function(){return this.list.filter((function(t){return["waiting","processing","finish"].includes(t.status_desc)}))},getClasses:function(){var t=this;return function(e){var n;return{active:(null==e?void 0:e.id)==(null===(n=t.workFlowAppData)||void 0===n?void 0:n.selectedId),disabled:["waiting","processing"].includes(e.status_desc)}}},getCircumference:function(){return function(progress){return"".concat(29*Math.PI*(3.6*progress/180)," 1000")}},isVideo:function(){return function(t){return Object(w.H)(t)}},isShowExpireTime:function(){return function(t){return t&&t>0}},getExpireTime:function(){var t=this;return function(e){var n=(new Date).getTime();if(e&&e>n){var o=e-n,r=Math.floor(o/864e5);return r?t.$t("num_days",{param:r}):t.$t("ExpiresSoon")}return t.$t("num_days",{param:0})}},getStyle:function(){return{maxHeight:this.isOpen?"".concat(this.scrollHeight+20,"px"):"0px",padding:this.isOpen?"10px 0":"0px",borderTop:this.isOpen?"1px solid rgba(255, 255, 255, 0.06)":"0"}},getExpirationTime:function(){return this.taskExpireDay}}),watch:{isLoggedIn:{handler:function(t){this.hasMore=!0,this.list=[],t&&this.getList()},immediate:!0},list:{handler:function(t){this.updateScrollHeight(),this.top.updateHistories(t)},deep:!0,immediate:!0}},methods:{handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;if(e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore){var n=this.list.length,o=n?this.list[n-1]:"",r=o?o.create_at:"";this.getList(r)}}catch(t){}},getList:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o={limit:50,template_id:(null===(t=this.$route.params)||void 0===t?void 0:t.id)||""};n&&(o.time_from=n),this.loading=!0,Object(m.g)(o).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=o.items,l=o.has_more,c=void 0===l||l;e.hasMore=c,(n=e.list).push.apply(n,Object(v.a)(r||[]))})).finally((function(){e.loading=!1}))},handleClick:function(t){var e=t.status_desc;["waiting","processing"].includes(e)||this.top.changeSelectedId((null==t?void 0:t.id)||"")},handleCollapseClick:function(){this.isOpen=!this.isOpen,this.updateScrollHeight()},updateScrollHeight:function(){var t=this;this.$nextTick((function(){var e;t.scrollHeight=(null===(e=t.$refs.content)||void 0===e?void 0:e.scrollHeight)||0}))},toMall:function(){this.$router.push(this.localePath({path:"/mall"}))}}},he=pe,ve=(n(5387),Object(Z.a)(he,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-viewer-histories"},[e("div",{staticClass:"collapse-components-top",on:{click:t.handleCollapseClick}},[e("span",{staticClass:"collapse-components-top-title"},[e("span",[t._v(t._s(t.$t("workFlow11")))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:![void 0,0,null,""].includes(t.getExpirationTime),expression:"![undefined, 0, null, ''].includes(getExpirationTime)"}],staticClass:"longest-expiration-time"},[e("span",{staticClass:"times"},[t._v("\n          "+t._s(t.$t("workFlow5",{num:t.getExpirationTime}))+"\n        ")]),t._v(" "),e("span",{staticClass:"to-mall",on:{click:function(e){return e.stopPropagation(),t.toMall.apply(null,arguments)}}},[t._v("\n          "+t._s(t.$t("workFlow4"))+"\n        ")])])]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down collapse-components-top-icon",class:{"is-open":t.isOpen}})]),t._v(" "),e("div",{ref:"content",staticClass:"collapse-components-content",style:t.getStyle},[t.getGroups.length?e("div",{ref:"scrollWrapper",staticClass:"content-viewer-histories-images",on:{scroll:t.debounceHandleScroll}},t._l(t.getGroups,(function(n,o){var r,l,c,d;return e("div",{key:"group-".concat(o),staticClass:"item-group flex-center",class:t.getClasses(n),on:{click:function(e){return t.handleClick(n)}}},["finish"==n.status_desc?e("div",{staticClass:"item-group-generated"},[t.isVideo(null==n||null===(r=n.components)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.url)?e("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:!1,src:null==n||null===(l=n.components)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.url},domProps:{muted:!0}}):e("img",{staticClass:"picture",attrs:{src:null==n||null===(c=n.components)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.url,alt:"group image"}}),t._v(" "),e("div",{staticClass:"img-num flex-center"},[e("i",{staticClass:"iconfont icon-imgNum"}),t._v(" "),e("span",[t._v(t._s((null==n||null===(d=n.components)||void 0===d?void 0:d.length)||0))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowExpireTime(null==n?void 0:n.expiration_time),expression:"isShowExpireTime(item?.expiration_time)"}],staticClass:"expiration-time flex-center"},[t._v("\n            "+t._s(t.getExpireTime(null==n?void 0:n.expiration_time))+"\n          ")])]):e("div",{staticClass:"item-group-generating flex-center"},[e("div",{staticClass:"progress"},[t._v(t._s(n.process)+" %")]),t._v(" "),e("svg",{staticClass:"progress-ring",attrs:{width:"62",height:"62"}},[e("circle",{staticClass:"progress-ring-circle",attrs:{"stroke-dasharray":t.getCircumference(n.process),"stroke-dashoffset":0,r:"29",cx:"31",cy:"31",fill:"transparent","stroke-width":"3"}})])])])})),0):e("div",{staticClass:"content-viewer-histories-empty flex-center"},[t._v("-- "+t._s(t.$t("workFlow35"))+" -- ~")])])])}),[],!1,null,"385ab57a",null)),fe=ve.exports,me={model:{prop:"actVal",event:"onChange"},props:{actVal:{type:Number,default:1},bline:{type:Boolean,default:!0},list:{type:Array,default:function(){return[]}}},data:function(){return{formatNumberForeign:w.p}},methods:{changeTab:function(t){this.$emit("onChange",t.value)}}},ge=(n(5388),Object(Z.a)(me,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tabs-box flex",class:t.bline&&"tab-bline"},[t._l(t.list,(function(n){return[n.show?e("div",{key:n.value,staticClass:"item flex_m",class:t.actVal===n.value&&"active",attrs:{"data-id":n.value,"data-event":"click_tab"},on:{click:function(e){return t.changeTab(n)}}},[e("span",[t._v(t._s(t.$t(n.label)))]),t._v(" "),n.icon?e("i",{class:[n.icon]}):t._e(),t._v(" "),n.vnum?e("div",{staticClass:"num-text flex_m"},[t._v("\n        "+t._s(t.formatNumberForeign(n.vnum||0))+"\n      ")]):t._e()]):t._e()]}))],2)}),[],!1,null,"271ea810",null).exports),_e=n(171),ye=n(64),be=n(467),we=n(858);function Ce(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Oe={components:{homeList:_e.a,HyWaterfallFlowList:ye.default,NoData:At.default,PreferenceSelect:be.default,TimerSelect:we.default},inject:["top"],props:{logEventData:{type:Object,default:function(){return{}}}},data:function(){return{isReq:!1,listData:[],pageObj:{page:1,page_size:35,offset:""},formData:{order_by:"new",timeType:"All",time_from:null,time_to:null},orderbyList:[{name:"Hot",id:"hot",icon:"hot",show:!0},{name:"New",id:"new",icon:"new1",show:!0}],hasMore:!0,isFirstLoad:!1}},computed:ke(ke(ke({},Object(y.c)("user",["isLoggedIn"])),Object(y.e)("app",["ABInfo"])),{},{hasTemp:function(){var t;return(null===(t=this.top.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)>0},waterfallHeight:function(){return this.listData.length>4?700:350},isControlGuest:function(){return"A"==this.ABInfo.ai_app_detail_related_works_login}}),watch:{"formData.order_by":{handler:function(){this.exposureTimeFilterLogEvent()}}},mounted:function(){this.getList(),this.exposureTypeFilterLogEvent(),this.exposureTimeFilterLogEvent()},methods:{getList:function(){var t,e=this;if(!(this.isReq||this.isControlGuest&&!this.isLoggedIn&&this.pageObj.page>1)&&this.hasMore){this.isReq=!0;var n=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"",o=this.formData,r=o.time_from,l=o.time_to,c=o.order_by,d=o.timeType,time="All"===d?"":"".concat(d,"_"),param=ke(ke({},this.pageObj),{},{page_size:this.isControlGuest&&!this.isLoggedIn?30:this.pageObj.page_size,order_by:"".concat(time).concat(c),time_from:r,time_to:l,artwork_types:[1,3,4,6,7],related_id:n});Object(_.getWaterHomeArtwork)(param).then((function(t){var n,o,r,l,c=(null===(n=t.data)||void 0===n?void 0:n.items)||[];e.listData=e.listData.concat(c),e.pageObj.offset=(null===(o=t.data)||void 0===o?void 0:o.offset)||"",e.pageObj.page++,e.isReq=!1,e.hasMore=(null===(r=t.data)||void 0===r?void 0:r.has_more)||!1,99!==(null===(l=e.top)||void 0===l||null===(l=l.workFlowAppData)||void 0===l?void 0:l.artwork_visible_for)||e.isLoggedIn||(e.pageObj.offset="",e.pageObj.page=1,e.listData=[]),param.offset&&1!=param.page||null!=c&&c.length||e.isFirstLoad||e.$emit("onEmpty"),e.isFirstLoad=!0})).catch((function(){e.isReq=!1}))}},openLogin:function(){this.$logEvent("log_actions",{operation:"login_in_now",behavior_info:"on_swtft_app_detail_page"}),this.$EventBus.$emit("openLoginDialog")},changeTime:function(data){var t=data.startTime,e=data.endTime;this.formData.time_from=t,this.formData.time_to=e,this.listData=[],this.pageObj.page=1,this.pageObj.offset="",this.getList(),this.$logEvent("log_actions",{operation:"click_filter_time",behavior_info:"on_ai_app_detail_page",behavior_info_sub:this.formData.timeType})},changePreference:function(){this.listData=[],this.pageObj.page=1,this.pageObj.offset="",this.getList(),this.$logEvent("log_actions",{operation:"click_filter_content",behavior_info:"on_ai_app_detail_page",behavior_info_sub:this.formData.order_by})},exposureTypeFilterLogEvent:function(){this.$logEvent("log_actions",{operation:"exposure_filter_content",behavior_info:"on_ai_app_detail_page"})},exposureTimeFilterLogEvent:function(){"new"!=this.formData.order_by&&this.$logEvent("log_actions",{operation:"exposure_filter_time",behavior_info:"on_ai_app_detail_page"})}}},xe=(n(5389),Object(Z.a)(Oe,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workseo-box"},[e("div",{staticClass:"screen-box"},["new"!=t.formData.order_by?e("TimerSelect",{staticClass:"item",on:{onChangeItem:t.changeTime},model:{value:t.formData.timeType,callback:function(e){t.$set(t.formData,"timeType",e)},expression:"formData.timeType"}}):t._e(),t._v(" "),e("PreferenceSelect",{staticClass:"item",attrs:{list:t.orderbyList},on:{onChange:t.changePreference},model:{value:t.formData.order_by,callback:function(e){t.$set(t.formData,"order_by",e)},expression:"formData.order_by"}})],1),t._v(" "),e("div",{staticClass:"wraper-seo",class:{"nologin-work":!t.isLoggedIn&&!t.isControlGuest},style:{height:t.isLoggedIn||t.isControlGuest?"auto":t.waterfallHeight+"px"}},[e("div",{ref:"wraper",staticClass:"wraper"},[e("HyWaterfallFlowList",{attrs:{list:t.listData,container:"wraper",fixedHeight:t.isLoggedIn||t.isControlGuest?0:t.waterfallHeight,closeVirtualList:!1,isReverseLoad:!0,logEventData:t.logEventData},on:{load:t.getList}})],1),t._v(" "),t.listData.length?t._e():e("no-data",{staticClass:"page-seo"}),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isReq,expression:"isReq"}],staticClass:"loadBox"}),t._v(" "),t.isControlGuest?t._e():e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoggedIn&&t.listData.length,expression:"!isLoggedIn && listData.length"}],staticClass:"login-panel flex_c_m"},[e("div",{staticClass:"login-btn"},[e("div",{staticClass:"text"},[t._v(t._s(t.$t("loginLookWorks")))]),t._v(" "),e("div",{staticClass:"btn flex_c_m",on:{click:t.openLogin}},[t._v("\n          "+t._s(t.$t("loginNow"))+"\n        ")])])])],1)])}),[],!1,null,"8b5a6294",null)),Te=xe.exports;installComponents(xe,{NoData:n(129).default});var Se={components:{CmtComments:n(116).default},inject:["top"],data:function(){return{modelInfo:this.top.workFlowAppData,dotReportInfo:{category:"default",view_domain:"details_model",batch_id:"",action:"",obj_no:"",obj_type:13,negative_ids:[]}}},mounted:function(){},methods:{commentEnd:function(data){this.$message({message:this.$t("commentSuc"),type:"success"}),this.$emit("onCommentEnd",data)}}},De=Object(Z.a)(Se,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"workflow-comment-section"}},[e("CmtComments",{ref:"cmtComments",attrs:{infos:t.modelInfo,type:13,dotReportInfo:t.dotReportInfo,naturalScroll:"",inputPosition:"top",isReverseLoad:!0},on:{onCommentEnd:t.commentEnd}})],1)}),[],!1,null,"a2bf0fe4",null),Pe=De.exports;installComponents(De,{CmtComments:n(116).default});var Ie=n(27),$e=n(145),je=n(474);function Le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Le(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ee={mixins:[Gt.a,$e.a],components:{NoData:At.default,comfyItem:je.a},data:function(){return{isReq:!1,listData:[],pageObj:{page:1,page_size:20,offset:0},formData:{order_by:"recommend",comfy_ui_type:2,run_available:0,batch:1}}},computed:Me(Me({},Object(y.c)("user",["isLoggedIn","accountSettingsData"])),Object(y.e)("user",["userInfo"])),mounted:function(){this.getList(),this.exposureLogEvent()},methods:Me(Me({},Object(y.b)("user",["getAccountInfo"])),{},{getList:function(){var t=this;if(!this.isReq){this.isReq=!0;var e=this.$route.params,param=Me(Me(Me({},this.pageObj),this.formData),{},{id:e.id});Object(Yt.b)(param).then((function(e){var n,o,r=(null===(n=e.data)||void 0===n?void 0:n.items)||[];t.listData=t.listData.concat(r),t.pageObj.offset=(null===(o=e.data)||void 0===o?void 0:o.offset)||0,t.pageObj.page++,t.isReq=!1})).catch((function(){t.isReq=!1}))}},moreActions:function(t,e){var n=this,o=e.id,r=void 0===o?"":o,l=e.obj_type;switch(t){case"delete":this.$logEvent("log_actions",{operation:"click_delete",behavior_info:"on_personal_center",behavior_info_sub:l});this.$confirm(this.$t({13:"comfyui_delete_tips"}[l]||"canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(Ie.l)({ids:[r],category:2,obj_type:l}).then((function(t){var e;1e4==(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&n.$message({message:n.$t("deleteSuccess"),type:"success"})}))})).catch((function(t){console.log("err",t)}));break;case"pinOrNot":this.$logEvent("log_actions",{operation:"click_top_to_overview",behavior_info:"on_personal_center",behavior_info_sub:l});var c={obj_id:r,obj_type:l};null!=e&&e.isTop&&(c.up_type="down"),Object(Ie.bb)(c).then((function(t){var o;1e4==(null==t||null===(o=t.status)||void 0===o?void 0:o.code)&&(n.$message({message:n.$t(null!=e&&e.isTop?"UnpinSuccess":"PinSuccess"),type:"success"}),n.$set(e,"isTop",!e.isTop))}))}},handleBox:function(t){var e;this.$logEvent("log_actions",{operation:"click_relationed_recommendation",behavior_info:"on_ai_app_detail_page",behavior_info_sub:(null==t||null===(e=t.comfy_ui)||void 0===e?void 0:e.name)||""})},handleRefresh:function(){},adminHandle:function(t){this.setWaterFallDeleteLits(t)},exposureLogEvent:function(){this.$logEvent("log_actions",{operation:"exposure_relationed_recommendation",behavior_info:"on_ai_app_detail_page"})}})},Fe=(n(5390),Object(Z.a)(Ee,(function(){var t=this,e=t._self._c;return e("div",[t.listData.length?e("div",{staticClass:"anli-workapp-box"},t._l(t.listData,(function(n){return e("div",{key:n.id,staticClass:"item-box",attrs:{"data-id":n.id},on:{click:function(e){return t.handleBox(n)}}},[13==n.obj_type||14==n.obj_type?e("comfyItem",{attrs:{item:n,list:t.listData},on:{moreActions:t.moreActions,change:function(e){return t.adminHandle(n.id)},click:function(e){return t.clickItem(n)}}}):t._e()],1)})),0):t._e(),t._v(" "),t.listData.length?t._e():e("NoData")],1)}),[],!1,null,"cc3696cc",null)),Ae=Fe.exports;function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}installComponents(Fe,{NoData:n(129).default});var Re={inject:["top"],mixins:[],components:{Tabs:ge,WorkSeo:Te,CommentList:Pe,AnliWorkFlowApp:Ae},provide:function(){return{commentTabRef:this}},data:function(){return{actVal:1,tabList:[{label:"relatedWorks",value:1,vnum:this.top.workFlowAppData.stat.num_of_artwork,show:!0},{label:"ntsPopTitCom",value:2,vnum:this.top.workFlowAppData.stat.num_of_comment,show:!0},{label:"ExploreRelated",value:3,show:!0}]}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(y.c)("user",["isLoggedIn"])),watch:{"top.workFlowAppData.artwork_visible_for":{handler:function(t){99===t&&this.isLoggedIn&&(this.actVal=2,this.tabList[0].show=!1),99!==t||this.isLoggedIn||(this.tabList[0].vnum=0,this.$refs.workSeoRef.listData=[])},deep:!0}},mounted:function(){this.exposureLogEvent()},methods:{switchToCommentTab:function(){this.actVal=2},commentEnd:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.tabList[1].vnum=data.commTotal},onEmpty:function(){var t;(null==this||null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t||null===(t=t.stat)||void 0===t?void 0:t.num_of_artwork)&&(this.tabList[0].show=!1,this.actVal=2)},changeTab:function(t){3===t&&this.$logEvent("log_actions",{operation:"click_related_works",behavior_info:"on_createflow_page_ai_app_tab"})},exposureLogEvent:function(){this.$logEvent("log_actions",{operation:"exposure_relationed_recommendation_tab",behavior_info:"on_ai_app_detail_page"})}}},Be=Re,Ue=(n(5391),Object(Z.a)(Be,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-works-box"},[e("Tabs",{staticClass:"tabs",attrs:{list:t.tabList},on:{onChange:t.changeTab},model:{value:t.actVal,callback:function(e){t.actVal=e},expression:"actVal"}}),t._v(" "),e("WorkSeo",{directives:[{name:"show",rawName:"v-show",value:1===t.actVal,expression:"actVal === 1"}],ref:"workSeoRef",attrs:{logEventData:{tab:1}},on:{onEmpty:t.onEmpty}}),t._v(" "),e("CommentList",{directives:[{name:"show",rawName:"v-show",value:2===t.actVal,expression:"actVal === 2"}],on:{onCommentEnd:t.commentEnd}}),t._v(" "),e("AnliWorkFlowApp",{directives:[{name:"show",rawName:"v-show",value:3===t.actVal,expression:"actVal === 3"}]})],1)}),[],!1,null,"6d242912",null)),Ve=Ue.exports;installComponents(Ue,{CommentList:n(1179).default});var We=n(250),qe={name:"ContentViewer",inject:["top"],props:{workFlowAppData:{type:Object,default:function(){}}},provide:function(){var t=this;return{commentTabRef:function(){return t.$refs.rightWorks}}},components:{ContentViewerTop:ee,ContentViewerImages:ce,ContentViewerHistories:fe,RightWorks:Ve,PageSeo:We.a},data:function(){return{}},mounted:function(){},computed:{hasTemp:function(){var t;return(null===(t=this.workFlowAppData.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)>0}},methods:{}},He=(n(5392),Object(Z.a)(qe,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"content-viewer"},[o("ContentViewerTop",{attrs:{workFlowAppData:n.workFlowAppData},on:{onHandShare:function(t){return n.$emit("onHandShare")}}}),n._v(" "),o("ContentViewerImages",{attrs:{workFlowAppData:n.workFlowAppData}}),n._v(" "),o("RightWorks",{ref:"rightWorks"}),n._v(" "),null!==(t=n.top)&&void 0!==t&&null!==(t=t.pageSEO)&&void 0!==t&&t.tempList?o("PageSeo",{attrs:{tempList:null===(e=n.top)||void 0===e||null===(e=e.pageSEO)||void 0===e?void 0:e.tempList}}):n._e()],1)}),[],!1,null,"16d5529c",null).exports),Ge=n(39),ze=["content"];function Ye(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ye(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ke={name:"workFlowAppDetail",components:{BackIcon:d.default,CodeViewer:h.a,GenerateResults:Wt,ContentViewer:He,PageSeo:We.a,Tabs:ge,ShareDialog:U.default},provide:function(){return{top:this}},inject:["app"],data:function(){return{workFlowAppData:{},pageSEO:{tempList:[],title:"",key_words:"",meta_description:""},noData:!1,actVal:1,tabList:[{label:"startGenerate",value:1,show:!0},{label:"workFlow11",value:2,show:!0}],workFlowIndex:0,workFlowList:[]}},watch:{$route:{handler:function(){this.remixWork()},deep:!0}},mounted:function(){var t,e,n;(null===(t=this.$route.params)||void 0===t?void 0:t.id)&&Object(Ge.i)({items:[{category:"default",view_domain:"details",action:"view",obj_no:null===(e=this.$route.params)||void 0===e?void 0:e.id,obj_type:13}]}),this.$EventBus.$on("$_workDetailRemix",this.workDetailRemix),this.init(),null===(n=this.$refs)||void 0===n||null===(n=n.codeViewer)||void 0===n||null===(n=n.$refs)||void 0===n||null===(n=n.seedField)||void 0===n||n.initData(),this.getDetailDynamicData(this.workFlowAppData),this.postGuestExposureLog()},computed:Je(Je(Je({},Object(y.c)("user",["isLoggedIn"])),Object(y.e)("app",["ABInfo"])),{},{codeViewData:function(){var t;return(null===(t=this.workFlowList)||void 0===t||null===(t=t[this.workFlowIndex])||void 0===t?void 0:t.inputs)||[]},currentWorkFlow:function(){var t;return Je(Je({},this.workFlowList[this.workFlowIndex]||{}),{},{ver_no:null===(t=this.workFlowAppData.ver_infos)||void 0===t||null===(t=t[this.workFlowIndex])||void 0===t?void 0:t.ver_no})},codeViewerHeight:function(){return this.app.bannerTotallyShow?"calc(100vh - 20px - 64px - 46px - 60px)":"calc(100vh - 20px - 64px - 60px)"},isShowConsume:function(){var t;return 4==(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.source)},workFlowTabList:function(){var t,e=this,n=(null===(t=this.workFlowAppData)||void 0===t?void 0:t.ver_infos)||{};return(this.workFlowList||[]).map((function(t,o){var r,l,c;return{id:null===(r=e.workFlowAppData)||void 0===r?void 0:r.id,labels:null==t?void 0:t.labels,estimateCoins:null==t?void 0:t.estimate_coins,name:(null===(l=n[o])||void 0===l?void 0:l.ver_no_name)||(null==t?void 0:t.name),verNo:null===(c=n[o])||void 0===c?void 0:c.ver_no}}))},isControlGuest:function(){return"A"==this.ABInfo.ai_app_detail_related_works_login}}),methods:{postGuestExposureLog:function(){this.isLoggedIn||this.$xyLogEvent({front_operation:"exposure",entity_type:"ai-app-detail-page",entity_name:"ai-app-detail-generate",obj_category:this.isControlGuest?"new_artwork_login_restriction_removed":"old_artwork_login_restriction"})},init:function(){var t,e;this.workFlowIndex=0;var n=((null===(t=this.workFlowAppData)||void 0===t?void 0:t.inputs)||[]).map((function(t){return Je(Je({},t),{},{val:t.val||""})}));this.workFlowList=[Je(Je({},this.workFlowAppData),{},{inputs:n})];var o=this.$route.query.imageUrl;if(o){o=decodeURIComponent(o);for(var r=Object(w.v)(o),l=this.getWorkFlowInputs(),i=0;i<l.length;i++){var c=l[i];if("image"===r&&"image"===c.field){c.val=o;break}}}var d=null===(e=this.workFlowAppData)||void 0===e||null===(e=e.ver_infos)||void 0===e||null===(e=e[1])||void 0===e?void 0:e.ver_no;this.checkWorkFlowEstimateCoins(0),d?this.getSubWorkFlowDetail(d):this.remixWork()},getSubWorkFlowDetail:function(t){var e,n=this,o=null===(e=this.$route.params)||void 0===e?void 0:e.id;Object(m.e)({template_id:o,ver_no:t}).then((function(t){var data=(null==t?void 0:t.data)||{},e=(null==data?void 0:data.inputs)||[];n.$set(n.workFlowList,1,Je(Je({},data),{},{inputs:e.map((function(t){return Je(Je({},t),{},{val:t.val||""})}))})),n.checkWorkFlowEstimateCoins(1),n.remixWork()}))},changeWorkflow:function(t){this.workFlowIndex=t},getDetailDynamicData:function(data){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.u)({obj_id:data.id,obj_type:13});case 2:n=e.sent,t.workFlowAppData=Object.assign({},t.workFlowAppData,Je(Je({},n),{},{stat:Je(Je({},t.workFlowAppData.stat),n.stat)}));case 4:case"end":return e.stop()}}),e)})))()},checkWorkFlowEstimateCoins:function(t){var e,n=this;((null===(e=this.workFlowList)||void 0===e||null===(e=e[t])||void 0===e?void 0:e.inputs)||[]).forEach((function(t){var e;if(null!=t&&null!==(e=t.estimate_coins)&&void 0!==e&&e.length){var o=t.estimate_coins.find((function(e){return e.key==t.val}));n.$set(t,"estimateCoins",(null==o?void 0:o.value)||0)}}))},getWorkFlowInputs:function(t){var e;return t||0===t||(t=this.workFlowIndex),(null===(e=this.workFlowList)||void 0===e||null===(e=e[t])||void 0===e?void 0:e.inputs)||[]},remixWork:function(){var t,e=this,n=null===(t=this.$route.query)||void 0===t?void 0:t.task;if(n){var o=n.split("-"),l=Object(r.a)(o,2),c=l[0],d=l[1];this.actVal=1,"retry"===c&&Object(E.getMetaInfo)({id:d}).then((function(t){var n,o=(null==t||null===(n=t.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];e.checkWorkFlowIndex(t),e.fillFormData(o)})),"mix"===c&&Object(E.getTaskConfig)({art_work_no:d,source:4}).then((function(t){var n,o=(null==t||null===(n=t.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];e.checkWorkFlowIndex(t),e.fillFormData(o)}))}},checkWorkFlowIndex:function(t){var e,n,o=((null==t||null===(e=t.data)||void 0===e?void 0:e.creativity)||{}).ver_no,r=this.workFlowTabList.findIndex((function(t){return t.verNo===o}));this.workFlowIndex=r>=0?r:0,null===(n=this.$refs)||void 0===n||null===(n=n.codeViewer)||void 0===n||n.changeWorkflow(this.workFlowIndex)},workDetailRemix:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).artwork_id;this.actVal=1,Object(E.getTaskConfig)({art_work_no:e,source:4}).then((function(e){var n,o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];t.fillFormData(o)}))},fillFormData:function(data){var t=this,e={};data.forEach((function(t){var n="".concat(t.field,"_").concat(t.node_id);e[n]={val:null==t?void 0:t.val,art_model:null==t?void 0:t.art_model}})),this.getWorkFlowInputs().forEach((function(n){var o,r,l,c="".concat(n.field,"_").concat(n.node_id);if(n.val=(null===(o=e[c])||void 0===o?void 0:o.val)||n.val,n.art_model=null===(r=e[c])||void 0===r?void 0:r.art_model,null!=n&&null!==(l=n.estimate_coins)&&void 0!==l&&l.length){var d=n.estimate_coins.find((function(t){return t.key==n.val}));t.$set(n,"estimateCoins",(null==d?void 0:d.value)||0)}}))},changeVal:function(t,e){var n,o=t.field,r=t.node_id,l=t.node_type,c=t.val,d=this.getWorkFlowInputs(e).find((function(t){return t.field==o&&t.node_id==r&&t.node_type==l}));if(d&&this.$set(d,"val",c),null!=d&&null!==(n=d.estimate_coins)&&void 0!==n&&n.length){var h=d.estimate_coins.find((function(t){return t.key==c}));this.$set(d,"estimateCoins",(null==h?void 0:h.value)||0)}},changeSelectedId:function(t){this.workFlowAppData.selectedId=t},updateHistories:function(t){this.$set(this.workFlowAppData,"histories",t)},changeTab:function(t){},createTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.actVal=2,this.tabList[1].icon="",this.$refs.GenerateResultsRef.addHeadItem(t)},handShare:function(){var t,e,n=this.workFlowAppData,o=n.author,r=n.samples,l=n.id,c=n.type,d=null==r||null===(t=r[0])||void 0===t?void 0:t.url,h=window.location.href,v=(null==o?void 0:o.id)+"_"+l,f=this.$route.params;Object(Ge.i)({items:[{category:"default",view_domain:"details",action:"share",obj_no:null===(e=this.$route.params)||void 0===e?void 0:e.id,obj_type:13}]}),this.$refs.ShareDialog.show(h,d,v,"",l,c),this.getDetailDynamicData(this.workFlowAppData),this.$logEvent("log_actions",{operation:"click_share",behavior_info:f.id})},retryWork:function(data){var t=this,e=this.$route.params,n=data.creativity.id,o=data.id;if(e.id===n)this.actVal=1,Object(E.getMetaInfo)({id:o}).then((function(e){var n,o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];t.checkWorkFlowIndex(e),t.fillFormData(o)}));else{var r="/workFlowAppDetail/".concat(n,"?task=retry-").concat(o);this.$router.push(r)}},changeNodeProperty:function(t,e,data){var n=this.getWorkFlowInputs(),o=t.field,r=t.node_id,l=t.node_type,c=n.find((function(t){return t.field==o&&t.node_id==r&&t.node_type==l}));c&&e&&c&&this.$set(c,e,data)}},asyncData:function(t){return Object(l.a)(regeneratorRuntime.mark((function e(){var n,l,c,d,h,v,data,f,m,_,title,y,w,C,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,l=t.params,t.error,c=l.id,e.prev=2,e.next=5,Promise.all([n.$post("/api/v1/creativity/square/template/detail",{template_id:c}),n.$post("/api/v1/fast_ai/detail",{name:c})]);case 5:return h=e.sent,v=Object(r.a)(h,2),data=v[0].data,f=v[1].data,_=(m=f||{}).module,title=m.title,y=m.meta_description,w=m.key_words,C=null!=_&&_.length?_.map((function(t){var content=t.content;return Je(Je({},Object(o.a)(t,ze)),{},{content:JSON.parse(content)})})):[],k=(null==data||null===(d=data.inputs)||void 0===d?void 0:d.map((function(t){return Je({val:""},t)})))||[],data.inputs=k,data.selectedId="",data.progress="none",e.abrupt("return",{workFlowAppData:Je({},data),pageSEO:{tempList:C,title:title,key_words:w,meta_description:y}});case 18:return e.prev=18,e.t0=e.catch(2),e.abrupt("return",{noData:!0});case 21:case"end":return e.stop()}}),e,null,[[2,18]])})))()},head:function(){var t,e,n,o=this.workFlowAppData||{},r=o.desc,l=o.name,c=o.samples,d=o.stat,h=o.author,v=o.permission,f=o.id,m=this.pageSEO||{},title=m.title,_=m.key_words,y=m.meta_description,w=4==(null==v?void 0:v.source);title=this.$t(title)||(w?this.$t("Sd3SeoTitle"):"".concat(this.$t("SeaArt")," AI | ")+l);var desc=this.$t(y)||(w?this.$t("Sd3SeoDesc"):r),C="https://www.seaart.ai/workFlowAppDetail/".concat(f);return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(_)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc},{hid:"og:image",name:"og:image",content:null!=c&&c.length?null===(t=c[0])||void 0===t?void 0:t.url:""},{hid:"og:site_name",property:"og:site_name",content:"https://www.seaart.ai"},{hid:"og:url",property:"og:url",content:C},{name:"twitter:url",content:C},{hid:"twitter:image",name:"twitter:image",content:null!=c&&c.length?null===(e=c[0])||void 0===e?void 0:e.url:""},{property:"twitter:image",content:null!=c&&c.length?null===(n=c[0])||void 0===n?void 0:n.url:""},{name:"twitter:title",content:title},{name:"twitter:description",content:desc},{name:"twitter:site",content:"@SeaArt_Ai"},{name:"twitter:creator",content:(null==h?void 0:h.name)||"@SeaArt_Ai"},{name:"twitter:card",content:"summary_large_image"}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"SoftwareApplication",name:l,offers:{"@type":"Offer",price:"0",priceCurrency:"USD"},aggregateRating:{"@type":"AggregateRating",ratingValue:(null==d?void 0:d.rating)||1,ratingCount:(null==d?void 0:d.num_of_task)||1e4},creator:{name:(null==h?void 0:h.name)||"SeaArt","@type":"Person"}}}],__dangerouslyDisableSanitizers:["script"]}}},Qe=Ke,Xe=(n(5393),n(5394),Object(Z.a)(Qe,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workflow-app-detail width-height-hundred fit-page my-workf-max",attrs:{"data-group":"page-ai-app"}},[t.noData?e("div",{staticClass:"workflow-app-detail-content no-data"},[e("img",{staticClass:"null-image",attrs:{src:n(668),alt:"null_image"}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("WorkflowAppNoData")))])]):e("div",{staticClass:"workflow-app-detail-content width-height-hundred"},[e("div",{staticClass:"detail-content"},[e("div",{staticClass:"left-code-viewer",attrs:{"data-group":"aiapp-left-code-viewer"}},[e("div",{staticClass:"left-tabs flex"},[e("BackIcon"),t._v(" "),e("Tabs",{attrs:{list:t.tabList,bline:!1},on:{onChange:t.changeTab},model:{value:t.actVal,callback:function(e){t.actVal=e},expression:"actVal"}})],1),t._v(" "),e("CodeViewer",{directives:[{name:"show",rawName:"v-show",value:1===t.actVal,expression:"actVal === 1"}],ref:"codeViewer",attrs:{isCreate:!0,isShowPrevite:!0,height:t.codeViewerHeight,codeViewData:t.codeViewData,workFlowTabList:t.workFlowTabList,currentWorkFlow:t.currentWorkFlow},on:{createTask:t.createTask,changeWorkflow:t.changeWorkflow}}),t._v(" "),e("GenerateResults",{directives:[{name:"show",rawName:"v-show",value:2===t.actVal,expression:"actVal === 2"}],ref:"GenerateResultsRef",style:{height:t.codeViewerHeight},on:{setActiveTab:function(e){t.actVal=1},onRetryWork:t.retryWork}})],1),t._v(" "),e("ContentViewer",{staticClass:"right-content-viewer",attrs:{workFlowAppData:t.workFlowAppData,"data-group":"aiapp-right-content-viewer"},on:{onHandShare:t.handShare}})],1)]),t._v(" "),e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("ShareDialog",{ref:"ShareDialog"})],1)}),[],!1,null,"2cb34bba",null));e.default=Xe.exports;installComponents(Xe,{BackIcon:n(290).default,ShareDialog:n(144).default})},5728:function(t,e,n){"use strict";n.r(e);n(11),n(72),n(89),n(69),n(31),n(12),n(13),n(7);var o=n(30),r=n(3),l=n(2),c=(n(20),n(19),n(6),n(16),n(73),n(22),n(18),n(24),n(243),n(8),n(4),n(28),n(43),n(21),n(40),n(44),n(41),n(26),n(141),n(142),n(109),n(83)),d=n(1),h=n(125),v=n.n(h),f=n(787).a,m=(n(4702),n(0)),_=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"c-workflow-version-info-modal",attrs:{title:t.$t("workFlow47"),visible:t.visible,width:"475px",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"version-info-title"},[e("span",{staticClass:"version-info-title-text"},[t._v(t._s(t.$t("workFlow48")))]),t._v(" "),e("span",{staticClass:"version-info-title-icon iconfont icon-icon_wenjuan",on:{click:function(e){return e.stopPropagation(),t.openFeedBack()}}})]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"version-info-node-info"},[e("el-collapse",{on:{change:t.handleChange},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[t._l(t.templateData,(function(n,o){return[e("el-collapse-item",{key:"".concat(n.package,"_").concat(o),staticClass:"version-info-node-info-item",attrs:{title:"".concat(n.package," (").concat(n.node_num,")"),name:n.package}},[t._l(n.nodes,(function(r){return[e("span",{key:"".concat(n.package,"_").concat(o,"_").concat(r.name),staticClass:"child-node-item"},[t._v(t._s(r.name))])]}))],2)]}))],2)],1)])}),[],!1,null,null,null).exports;function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"workFlowHeader",inject:["top"],props:{showBadge:{type:Boolean,default:!1}},components:{workflowVersionInfoModal:_},data:function(){return{title:""}},mounted:function(){this.initTitle()},beforeDestroy:function(){this.clearWorkflowTitleCache()},beforeRouteLeave:function(t,e,n){this.clearWorkflowTitleCache(),n()},computed:w(w({},Object(d.e)("user",["userInfo"])),{},{isSelfWorkflow:function(){var t,e,n,o,r=(null==this?void 0:this.userInfo).id,l=void 0===r?"":r,c=l&&l===(null===(t=this.top)||void 0===t||null===(t=t.workflowInfo)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id),d=null===(e=this.$route.query)||void 0===e?void 0:e.workId,h=!(null!==(n=this.$route.query)&&void 0!==n&&n.workId||null!==(o=this.$route.query)&&void 0!==o&&o.id);return c||d||h}}),methods:{openTutorial:function(){this.$logEvent("log_actions",{operation:"click_guide",behavior_info:"on_comfyui_project_editing_page"}),window.open("https://docs.seaart.ai/seaart-comfyui-wiki","_blank")},openFeedBack:function(){try{window.open("https://aihelp.net/questionnaire/#/?formId=1a9a30d2b11545e5beba287164f8b05d","_blank")}catch(t){}},initTitle:function(){try{var t,e=sessionStorage.getItem("workflow_title"),n=(e?JSON.parse(e):{}).title,title=void 0===n?"":n;if(title)title=(null===(t=title)||void 0===t?void 0:t.length)>25?title.slice(0,25):title;else title=v()().format("YYYY-MM-DD HH:mm"),sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:title}));this.title=title}catch(t){}},backPreview:function(){var t;(null===(t=history)||void 0===t?void 0:t.length)>1?this.$router.back():this.$router.push(this.localePath("/"))},handleTitleChange:function(t){[null,void 0,""].includes(t)||sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:t}))},openVersionInfoModal:function(){this.$refs.workflowVersionInfoModal.openModal()},handleClick:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null!==(t=this.userInfo)&&void 0!==t&&t.id||["openCreateWorkflowModal","clearWorkFlow"].includes(e)?this.$emit("command",e):this.$EventBus.$emit("openLoginDialog")},updateTitle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.title=t||v()().format("YYYY-MM-DD HH:mm"),sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:this.title}))},clearWorkflowTitleCache:function(){try{sessionStorage.removeItem("workflow_title")}catch(t){console.warn("清除workflow_title缓存失败:",t)}}}},k=C,O=(n(4703),n(4704),Object(m.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-work-flow-header"},[e("div",{staticClass:"work-flow-header-item-left"},[e("div",{staticClass:"back-preview-btn",on:{click:function(e){return e.stopPropagation(),t.backPreview.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),t.isSelfWorkflow?e("div",{staticClass:"header-item-left-box"},[e("div",{staticClass:"header-btn",on:{click:function(e){return t.handleClick("openCreateWorkflowModal")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-workflow_icon_new header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow15"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return t.handleClick("openHistoryRecordModal")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-workflow_icon_folder_open header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow3"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("clearWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-workflow_icon_clear header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow13"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.openVersionInfoModal()}}},[e("div",{staticClass:"header-btn-inner"},[e("span",{staticClass:"header-btn-icon el-icon-info"}),t._v("\n          "+t._s(t.$t("workFlow47"))+"\n        ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showBadge,expression:"showBadge"}],staticClass:"header-btn-badge"},[t._v("New")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.openTutorial()}}},[e("div",{staticClass:"header-btn-inner"},[e("span",{staticClass:"header-btn-icon iconfont icon-icon-Tutorial"}),t._v("\n          "+t._s(t.$t("Guides"))+"\n        ")])])]):t._e()]),t._v(" "),e("div",{staticClass:"work-flow-header-item-title"},[e("div",[e("el-popover",{attrs:{placement:"bottom",title:"",width:"200",trigger:"click","popper-class":"work-flow-header-title-popup-wrap","visible-arrow":!0,content:""}},[e("div",{staticClass:"header-item-title-btn",attrs:{slot:"reference"},slot:"reference"},[e("span",{staticClass:"header-item-title-btn-content"},[t._v(t._s(t.title))]),t._v(" "),e("span",{staticClass:"header-item-title-btn-icon el-icon-edit"})]),t._v(" "),e("div",{staticClass:"work-flow-header-title-wrap custom-form"},[e("el-input",{staticClass:"work-flow-header-title-input",attrs:{placeholder:t.$t("pleaseEnte"),maxlength:"25"},on:{change:t.handleTitleChange},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])],1)]),t._v(" "),e("div",{staticClass:"work-flow-header-item-right"},[e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.openFeedBack()}}},[e("div",{staticClass:"header-btn-inner"},[e("span",{staticClass:"header-btn-icon iconfont icon-icon_wenjuan"}),t._v("\n        "+t._s(t.$t("Feedback"))+"\n      ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("saveAsWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.top.saveAsWorkflowLoading,expression:"!top.saveAsWorkflowLoading"}],staticClass:"iconfont icon-a-icon-SaveAs header-btn-icon"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.top.saveAsWorkflowLoading,expression:"top.saveAsWorkflowLoading"}],staticClass:"header-btn-icon el-icon-loading"}),t._v("\n        "+t._s(t.isSelfWorkflow?t.$t("SaveAs"):t.$t("workFlow12"))+"\n      ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isSelfWorkflow,expression:"isSelfWorkflow"}],staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("saveWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.top.saveWorkflowLoading,expression:"!top.saveWorkflowLoading"}],staticClass:"iconfont icon-workflow_icon_save header-btn-icon"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.top.saveWorkflowLoading,expression:"top.saveWorkflowLoading"}],staticClass:"header-btn-icon el-icon-loading"}),t._v("\n        "+t._s(t.$t("Save"))+"\n      ")])]),t._v(" "),e("el-dropdown",{attrs:{placement:"bottom"},on:{command:t.handleClick}},[e("div",{staticClass:"header-btn"},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-icon-Download header-btn-icon"}),t._v("\n          "+t._s(t.$t("Download"))+"\n        ")])]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"downloadWorkFlow"}},[e("span",{staticStyle:{color:"rgba(255, 255, 255, 0.8)"}},[t._v(t._s(t.$t("leadingOut")))])]),t._v(" "),e("el-dropdown-item",{attrs:{command:"downloadWorkFlowApi"}},[e("span",{staticStyle:{color:"rgba(255, 255, 255, 0.8)"}},[t._v(t._s(t.$t("leadingOut"))+"(API)")])])],1)],1),t._v(" "),t.isSelfWorkflow?e("div",{staticClass:"header-btn header-btn-gradient",attrs:{"data-event":"workflow_page_top_right_corner_function_area_publish_button","data-desc":"comfyui_workflow"},on:{click:function(e){return e.stopPropagation(),t.handleClick("publishWorkFlow")}}},[e("img",{staticClass:"header-btn-gradient-icon",attrs:{src:n(1054),alt:""}}),t._v(" "),e("div",{staticClass:"header-btn-inner"},[t._v("\n        "+t._s(t.$t("releaseName"))+"\n      ")])]):t._e()],1),t._v(" "),e("workflow-version-info-modal",{ref:"workflowVersionInfoModal"})],1)}),[],!1,null,"762ce646",null)),x=O.exports,T=n(14),S=(n(32),n(50),n(49),n(133)),D=(n(122),n(77),n(10));function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(113);var $=n(276);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(65),n(177);var M=n(279),E=n(102),F=n(38),A=n(75),N=n(156),R=n(280),B=n(35),U=n.n(B),V=n(29),W=n(209),H=n(9),G=n(471),z=n(33),Y=n(200),J=n(54),K=n(144),Q=n(80),X=n(124),Z=n(943),tt=n(46),et=n(165);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var at={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},ot=Object(N.a)()?"DOMMouseScroll":"mousewheel",st={components:{ViewImage:W.a,AiChatCreateConfirm:M.a,textOverflowArea:G.default,DownloadVideoPop:Y.default,ShareDialog:K.default,SaveTo:X.default,ImageActionButtons:Z.a},name:"ComfyUIImageViewer",props:{operateNumber:{type:Number,default:function(){return 1}},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},showOperateBtn:{type:Boolean,default:function(){return!1}},message:{type:Object,default:function(){return{}}},msgId:{type:String,default:""},loraModels:{type:Object,default:function(){}},hoverBtnRenderList:{type:Array,default:function(){return[]}},nsfw:{type:Number,default:2},customForm:{type:Boolean,default:!1},isFromHistory:{type:Boolean,default:!1},isShowSaveBtn:{type:Boolean,default:!1},checkIsShowViewNsfw:{type:Boolean,default:!1}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(D.F)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:at.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},isI18nToggled:!1,intLoraModel:[],getMetaLoading:!1,alreadySave:!1,workId:"",metaInfo:{}}},computed:nt(nt(nt(nt({},Object(d.c)(["isSupportWebp"])),Object(d.c)("user",["accountSettingsData","isCompanyAccount","userInfo"])),Object(d.c)("creation",["studioStyle","lab_styles","smart_edit_template_id"])),{},{isNsfwPlus:function(){var t,e;return(null==this||null===(t=this.currentImgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==(null==this||null===(e=this.currentImgInfo)||void 0===e?void 0:e.nsfw)},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},getActionButtons:function(){var t,e,n=((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.basic)||[]).map((function(t){return t.val})).filter((function(t){return"supportFeedback"!==t}));return this.isShowNsfwIcon&&(n=[].concat(Object(T.a)(n),["supportFeedback","supportReport"])),null!=this&&null!==(e=this.currentImgInfo)&&void 0!==e&&e.is_saved_personal&&(n=n.filter((function(t){return"supportSave"!==t}))),n.map((function(t){return z.IMAGE_OPERATION_BTN_LIST.find((function(e){return e.permissionKey===t}))})).filter(Boolean).map((function(t){return nt(nt({},t),{},{type:t.code})}))},checkIsAlreadyFeedback:function(){var t;return null===(t=this.currentImgInfo)||void 0===t?void 0:t.is_nsfw_appeal},editButtons:function(){var t;return((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.edit)||[]).map((function(t){return nt(nt({},z.IMAGE_OPERATION_BTN_LIST.find((function(e){return(null==e?void 0:e.permissionKey)===t.val}))),{},{creativityTemplateId:t.creativity_template_id})})).filter(Boolean).map((function(t){return nt(nt({},t),{},{type:t.code})}))},moreButtons:function(){var t;return((null==this||null===(t=this.currentImgInfo)||void 0===t||null===(t=t.action_capability)||void 0===t?void 0:t.extend)||[]).map((function(t){return nt(nt({},z.IMAGE_OPERATION_BTN_LIST.find((function(e){return(null==e?void 0:e.permissionKey)===t.val}))),{},{creativityTemplateId:t.creativity_template_id})})).filter(Boolean).map((function(t){return nt(nt({},t),{},{type:t.code})}))},inviteCode:function(){var t;return(null===(t=this.userInfo)||void 0===t?void 0:t.invite_user_code)||""},getModelList:function(){var t,e,n,o=(null===(t=this.message)||void 0===t?void 0:t.art_model)||{};o=nt(nt({},o),{},{type:"Checkpoint"});var r=((null===(e=this.message.meta)||void 0===e?void 0:e.lora_models)||[]).map((function(t){return nt(nt(nt({},t),(null==t?void 0:t.art_model)||{}),{},{type:"LORA"})}));return o&&null!==(n=o)&&void 0!==n&&n.id?[o].concat(Object(T.a)(r)):r},isMyMsg:function(){var t,e;return(null===(t=this.message)||void 0===t||null===(t=t.messageInfo)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)===this.userInfo.id||!(null!==(e=this.message)&&void 0!==e&&e.messageInfo)},isShowSaveTo:function(){var t,e=this.message.img_uris,n=void 0===e?[]:e;return!!n.length&&(!(null!==(t=n[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal)&&this.isMyMsg&&!this.alreadySave)},renderBtn:function(){var t,e=this,map={post:{type:"post",label:"Post",tip:"PostTips"},animGen:{type:"animGen",label:"AnimGen",tip:"AnimTips"},extraUpscale:{type:"extraUpscale",label:"ai_tools_1",tip:"ExtraUpscale"},upscale:{type:"upscale",label:"OriginalityUpscale",tip:"WorkUpscale"},variations:{type:"variations",label:"Variations",tip:"WorkVariations"},removeBackground:{type:"removeBackground",label:"RemoveBackground"},chat:{type:"chat",label:"gpt_tab_chat",tip:"createChartacterToChat"},aiGenerateVideo:{type:"aiGenerateVideo",label:"ImageToVideo",tip:"ImageToVideoTip"},share:{type:"share",label:"Share",icon:"icons-Share",tip:""}},n=[],o=["deleteSingleImg","save","post","animGen","chat"],r=null,l=null,c=null;if(this.hoverBtnRenderList.forEach((function(t){var d=nt(nt({},t),map[t.code]);"upscale"===t.code&&e.isStudioMode&&d.tip&&d.tip.replace("2048*2048","3072*3072"),!o.includes(t.code)&&n.push(d),"post"===t.code&&(r=d),"animGen"===t.code&&(l=d),"chat"===t.code&&(c=d)})),l&&n.unshift(l),r&&n.unshift(r),c&&n.push(c),n.push({type:"download",label:"Download",icon:"modelDownload",tip:"SG_DownloadHover"}),this.isFromHistory&&((n=n.filter((function(t){return"aiGenerateVideo"!==t.type&&"chat"!==t.type&&"post"!==t.type&&"save"!==t.type&&"download"!==t.type&&"deleteSingleImg"!==t.type}))).unshift({type:"aiGenerateVideo",label:"ImageToVideo",icon:"a-icon-VideoGeneration",tip:"ImageToVideoTip"}),(this.isImageUrl(this.currentImg)||this.isVideoUrl(this.currentImg))&&n.push({type:"play",label:"remix_magic",icon:"iconfont icon-play1",tip:"play_tips"}),n.push({type:"chat",label:"gpt_tab_chat",icon:"a-home-top-personl1",tip:"createChartacterToChat"}),n.push({type:"share",label:"Share",icon:"icons-Share",tip:""}),this.isShowSaveBtn||(n=n.filter((function(t){return"save"!==t.type})))),this.isVideoUrl(this.currentImg)){var d=["chat","aiGenerateVideo"];n=n.filter((function(t){return!d.includes(t.type)}))}if([11,12,13,14].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.task_domain_type)){var h,v,f;n=[{type:"videoExtension",icon:"a-Videoextension",label:"videoProlong",tips:"videoProlong_tips"},{type:"videoUpscale",icon:"icon-HD",label:"IntelligentUpscale",tips:"HD_video"},{type:"post",icon:"post-icon2",label:"VideoSubmission",tips:""},{type:"save",icon:"save",label:"Save",tips:"Save"},{type:"download",label:"Download",icon:"modelDownload",tip:"Download"}],(this.hoverBtnRenderList||[]).some((function(t){return"save"===t.code}))||(n=n.filter((function(t){return"save"!==(null==t?void 0:t.type)})));var m=((null==this||null===(h=this.message)||void 0===h?void 0:h.ckpts)||[]).some((function(t){return(null==t?void 0:t.base_model_name)===z.VIDEO_MODEL_LIST["hunyuan_1.0"]}));((null===(v=this.currentImgInfo)||void 0===v?void 0:v.operation_labels)||[]).includes("videoExtend")||(n=n.filter((function(t){return"videoExtension"!==(null==t?void 0:t.type)}))),![13,14].includes(null==this||null===(f=this.message)||void 0===f?void 0:f.task_domain_type)&&m||(n=n.filter((function(t){return"videoUpscale"!==(null==t?void 0:t.type)})))}return n},studioRenderList:function(){var t=this;return(this.lab_styles||[]).map((function(e){var n="labStyle_".concat(e.value.replace(/\s/g,""));return{label:t.$t(n)||e.value,id:e.value}}))},getStudioStyle:function(){var t,e=(null===(t=this.message.meta)||void 0===t||null===(t=t.lab_base)||void 0===t?void 0:t.style_selections)||[];return(this.studioRenderList||[]).filter((function(t){return e.includes(t.id)})).map((function(t){return t.label})).join("、")||""},isSdModel:function(){var t,e;return[5,"5","sdxl"].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.channel)||[5,"5","sdxl"].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.category)},isStudioMode:function(){var t,e;return["studio",7,"7",11].includes(null==this||null===(t=this.message)||void 0===t?void 0:t.channel)||["studio",7,"7",11].includes(null==this||null===(e=this.message)||void 0===e?void 0:e.category)},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.getImageUrl(this.urlList[this.index].url)},currentImgInfo:function(){return this.urlList[this.index]},imgStyle:function(){var t=this.transform,e=t.scale,n=t.deg,o=t.offsetX,r=t.offsetY,l=t.enableTransition,style={transform:"scale(".concat(e,") rotate(").concat(n,"deg)"),transition:l?"transform .3s":"","margin-left":"".concat(o,"px"),"margin-top":"".concat(r,"px")};return this.mode===at.CONTAIN&&(style.maxWidth=style.maxHeight="100%"),style},viewerZIndex:function(){var t=R.a.nextZIndex();return this.zIndex>t?this.zIndex:t},setI18nPrompt:function(){var t=this.message.local_prompt,e=this.message.meta?this.message.meta.prompt:"";return this.isI18nToggled?t:e},convertTaskType:function(){var t;return et.b[null===(t=this.message)||void 0===t?void 0:t.task_domain_type]||et.c[this.message.type]||""}}),watch:{accountSettingsData:{handler:function(t){this.isI18nToggled=!t.is_off_localization},deep:!0},index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg:function(t){var e=this;this.$nextTick((function(){var t,n=null===(t=e.$refs)||void 0===t||null===(t=t.img)||void 0===t?void 0:t[0];null!=n&&n.complete||(e.loading=!0)}))}},methods:{handlePlay:function(){this.hide(),this.$emit("onPlay",this.currentImg,this.index)},handleJumpDetail:function(t){["",null,void 0].includes(null==t?void 0:t.id)||window.open("/models/detail/".concat(null==t?void 0:t.id),"_blank")},init:function(){var t,e=this;if(this.msgId){this.getMetaLoading=!0;var n=this.loraModels&&0===Object.keys(this.loraModels).length,o=["",null,void 0].includes(null===(t=this.message)||void 0===t?void 0:t.art_model_name),r=![this.loraModels&&this.loraModels[this.msgId]];[n,o,r].some((function(t){return t}))?Object(V.getMetaInfo)({id:this.msgId,task_flow_version:"v2"}).then((function(t){var o,r,l;if(1e4===t.status.code){e.intLoraModel=(null===(o=t.data.meta)||void 0===o?void 0:o.lora_models)||[];var c={};c[e.msgId]=e.intLoraModel;var d=(null==t||null===(r=t.data)||void 0===r?void 0:r.art_model_name)||"";if(e.$emit("uploadMate",null==t?void 0:t.data),["",null,void 0].includes(null===(l=e.message)||void 0===l?void 0:l.art_model_name)&&(e.$set(e.message,"art_model_name",d),null!=t&&t.data)){var h={},v=null==t?void 0:t.data;h.meta=(null==v?void 0:v.meta)||{},h.art_model=(null==v?void 0:v.art_model)||{},e.$emit("updateModelName",d,null==t?void 0:t.data)}n&&e.$emit("setLoraModel",c)}})).finally((function(){e.getMetaLoading=!1})):this.getMetaLoading=!1,this.intLoraModel&&!this.intLoraModel.length&&(this.intLoraModel=this.loraModels[this.msgId]||[])}},handleConfirm:function(){this.handleChat()},viewImage:function(t){this.$refs.viewImage.show(t,this.$refs.img[0],2)},isVideoUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t||"").toLowerCase().endsWith(e)}))},isAudioUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[".mp3",".wav",".m4a",".ogg",".flac",".aac"].some((function(e){return(t||"").toLowerCase().endsWith(e)}))},isImageUrl:function(){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")},openLora:function(t){window.open("/models/detail/"+t.art_model.id)},hide:function(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall:function(){var t=this;this._keyDownHandler=function(e){switch(e.stopPropagation(),e.keyCode){case 27:t.hide();break;case 32:t.toggleMode();break;case 37:t.prev();break;case 38:t.handleActions("zoomIn");break;case 39:t.next();break;case 40:t.handleActions("zoomOut")}},this._mouseWheelHandler=Object(N.b)((function(e){var n,o=e.wheelDelta?e.wheelDelta:-e.detail;["el-image-viewer__canvas task-image-viewer__canvas","el-image-viewer__img task-image-viewer__img"].includes(null==e||null===(n=e.target)||void 0===n?void 0:n.className)&&(o>0?t.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):t.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1}))})),Object(A.e)(document,"keydown",this._keyDownHandler),Object(A.e)(document,ot,this._mouseWheelHandler)},deviceSupportUninstall:function(){Object(A.d)(document,"keydown",this._keyDownHandler),Object(A.d)(document,ot,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(t){this.loading=!1},handleImgError:function(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown:function(t){var e=this;if(!this.loading&&0===t.button){var n=this.transform,o=n.offsetX,r=n.offsetY,l=t.pageX,c=t.pageY;this._dragHandler=Object(N.b)((function(t){e.transform.offsetX=o+t.pageX-l,e.transform.offsetY=r+t.pageY-c})),Object(A.e)(document,"mousemove",this._dragHandler),Object(A.e)(document,"mouseup",(function(t){Object(A.d)(document,"mousemove",e._dragHandler)})),t.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var t=Object.keys(at),e=(Object.values(at).indexOf(this.mode)+1)%t.length;this.mode=at[t[e]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var t=this.urlList.length;this.index=(this.index-1+t)%t}},next:function(){if(!this.isLast||this.infinite){var t=this.urlList.length;this.index=(this.index+1)%t}},handleActions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=nt({zoomRate:.2,rotateDeg:90,enableTransition:!0},e),o=n.zoomRate,r=n.rotateDeg,l=n.enableTransition,c=this.transform;switch(t){case"zoomOut":c.scale>.2&&(c.scale=parseFloat((c.scale-o).toFixed(3)));break;case"zoomIn":c.scale=parseFloat((c.scale+o).toFixed(3));break;case"clocelise":c.deg+=r;break;case"anticlocelise":c.deg-=r}c.enableTransition=l}},handleOperateBtnClick:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,f,m,_,y,w,C,k,O,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:C=(null===(o=e.urlList)||void 0===o||null===(o=o[e.index||0])||void 0===o?void 0:o.url)||"",e.handleLogEvent(null==t?void 0:t.type),n.t0=t.type,n.next="chat"===n.t0?5:"post"===n.t0?11:"animGen"===n.t0?13:"download"===n.t0?15:"aiGenerateVideo"===n.t0?17:"videoExtension"===n.t0?26:"save"===n.t0?31:"deleteSingleImg"===n.t0?33:"Share"===n.t0?35:"playNow"===n.t0?37:"imageEditing"===n.t0?39:"extraUpscale"===n.t0?41:"removeBackground"===n.t0?43:"aiErase"===n.t0||"expandImage"===n.t0||"partialRedrawing"===n.t0?47:"videoUpscale"===n.t0?49:"videoExtendFrame"===n.t0?51:"addMusic"===n.t0?53:"lipsync"===n.t0?56:"3D"===n.t0?58:"report"===n.t0?60:"feedback"===n.t0?62:64;break;case 5:return n.next=7,Object(F.S)({channel:"task",source_id:null===(r=e.message)||void 0===r?void 0:r.id});case 7:return k=n.sent,O=k.data.character_id,(void 0===O?"":O)?e.handleChat():e.$refs.aiChatCreateConfirm.show(),n.abrupt("break",66);case 11:return e.handlePost(),n.abrupt("break",66);case 13:return e.handleAnimate(),n.abrupt("break",66);case 15:return Object(D.M)(null===(l=e.urlList)||void 0===l||null===(l=l[e.index||0])||void 0===l?void 0:l.url),n.abrupt("break",66);case 17:if(C){n.next=20;break}return n.abrupt("return");case 20:if(!e.isFromHistory){n.next=23;break}return e.$emit("openEasyVideoRecModal",C),n.abrupt("return");case 23:return e.$EventBus.$emit("openEasyVideoRecModal",C),e.$emit("onlyCloseViewer"),n.abrupt("break",66);case 26:if(C){n.next=28;break}return n.abrupt("return");case 28:return e.$EventBus.$emit("openEasyVideoExtension",{url:null===(c=e.currentImgInfo)||void 0===c?void 0:c.cover_url,info:nt(nt({},e.message),{},{banner:e.currentImgInfo||{}}),isTask:!0}),e.$emit("onlyCloseViewer"),n.abrupt("break",66);case 31:return null===(d=e.$refs)||void 0===d||null===(d=d.saveToPopover)||void 0===d||d.doShow(),n.abrupt("break",66);case 33:return e.$emit("handleDeleteSingleImg",t.type,U()(e.urlList[e.index])),n.abrupt("break",66);case 35:return e.handleShare(U()(e.urlList[e.index])),n.abrupt("break",66);case 37:return e.handlePlay(),n.abrupt("break",66);case 39:return e.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:e.smart_edit_template_id},imgUrlList:[C]}}),n.abrupt("break",66);case 41:return e.$EventBus.$emit("openGenerate",{action:6,data:{imageUrl:C}}),n.abrupt("break",66);case 43:return n.next=45,e.handleGetMeta();case 45:return e.handleRemoveBackground(C),n.abrupt("break",66);case 47:return e.$EventBus.$emit("showDialog",{name:"ImageEditingModal",data:{url:C,type:t.type,appId:t.creativityTemplateId,callback:function(data){e.$EventBus.$emit("openGenerate",{action:0,data:data}),e.$EventBus.$emit("showDialog",{name:"GRechargeDialog",data:{}}),e.$emit("onlyCloseViewer")}}}),n.abrupt("break",66);case 49:return e.$EventBus.$emit("openGenerate",{action:13,data:{scene:"ai-tools-play",isTask:!0,parent_task_id:null===(h=e.message)||void 0===h?void 0:h.id}}),n.abrupt("break",66);case 51:return e.$EventBus.$emit("openGenerate",{action:19,data:{scene:"ai-tools-play",isTask:!0,parent_task_id:null===(v=e.message)||void 0===v?void 0:v.id}}),n.abrupt("break",66);case 53:return x=null===(f=e.urlList)||void 0===f?void 0:f[e.index||0].cover_url,e.$EventBus.$emit("openGenerate",{action:1,data:{openType:"AUDIO",videoInfo:{id:null===(m=e.message)||void 0===m?void 0:m.id,isTask:!0,url:null===(_=e.urlList)||void 0===_?void 0:_[e.index||0].url,coverUrl:x},prompt:"",negative_prompt:""},taskVersion:"v2"}),n.abrupt("break",66);case 56:return e.$EventBus.$emit("openGenerate",{action:1,data:{openType:"AUDIO",currentAudioTab:"videoAddLipSync",videoInfo:{id:null===(y=e.message)||void 0===y?void 0:y.id,isTask:!0,url:null===(w=e.urlList)||void 0===w?void 0:w[e.index||0].url,taskSource:0},prompt:""},taskVersion:"v2"}),n.abrupt("break",66);case 58:return e.$EventBus.$emit("openGenerate",{action:1,data:{activeCategory:"aiApp",creativity:{id:(null==t?void 0:t.creativityTemplateId)||""},imgUrlList:[C]}}),n.abrupt("break",66);case 60:return e.$message.success(e.$t("ReportSuccess")),n.abrupt("break",66);case 62:return e.handleAppeal(),n.abrupt("break",66);case 64:return e.$emit("imageOperate",t.type,U()(e.urlList[e.index])),n.abrupt("break",66);case 66:e.$emit("onClickBtns",t);case 67:case"end":return n.stop()}}),n)})))()},handleLogEvent:function(t){t&&this.$xyLogEvent({front_operation:"click",entity_name:"comfyui_image_viewer_btn_click",entity_type:"comfyui_detail_page",obj_id:this.message.id,obj_info:{obj_pt:t}})},handleShare:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,path,image;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.workId=e.message.id,n.next=3,Object(Q.d)({items:[{folder_no:"default",id:e.message.id,index:t.index}],scene:"task_item_share"});case 3:1e4===(o=n.sent).status.code&&(e.$emit("saveSuccess"),o.data.items[0].artwork_no?(path="".concat(window.location.origin,"/explore/detail/").concat(o.data.items[0].artwork_no)+(e.inviteCode?"?u_code=".concat(e.inviteCode):""),image=(null==t?void 0:t.url)||t.cover_url||"",e.$refs.shareDialog.show(path,image,"share","work-flow")):e.$message.error(e.$t(o.data.items[0].result_desc)));case 5:case"end":return n.stop()}}),n)})))()},getImageUrl:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},handleChat:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v,f,m,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v={height:null===(n=t.message)||void 0===n||null===(n=n.banner)||void 0===n?void 0:n.height,width:null===(o=t.message)||void 0===o||null===(o=o.banner)||void 0===o?void 0:o.width,id:null===(r=t.message)||void 0===r?void 0:r.id,url:t.currentImg||(null===(l=t.message)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url),source_account_id:(null===(c=t.message)||void 0===c||null===(c=c.messageInfo)||void 0===c||null===(c=c.author)||void 0===c?void 0:c.id)||(null===(d=t.userInfo)||void 0===d?void 0:d.id),channel:"task"},e.next=3,Object(F.S)({channel:"task",source_id:v.id});case 3:if(f=e.sent,m=(null==f?void 0:f.data)||{},_=m.can,2!==(void 0===_?2:_)){e.next=8;break}return t.$message.warning(t.$t("chatFail")),e.abrupt("return");case 8:if(!t.isShowSaveTo||1===t.nsfw){e.next=12;break}return e.next=11,t.handleSave(v);case 11:return e.abrupt("return");case 12:localStorage.setItem("createParams",JSON.stringify(v)),y="/cyberPubPage/".concat(null===(h=t.message)||void 0===h?void 0:h.id,"?quickChat=true&source=work"),window.open(t.localePath(y),"_blank");case 15:case"end":return e.stop()}}),e)})))()},handleSave:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]?t[0]:null,console.log("handleSave"),r=e.message,l=r.id,c=void 0===l?"":l,d=r.img_uris,h=(void 0===d?[]:d)[e.operateNumber-1].index,v=void 0===h?"":h,Object(E.a)({folder_no:"default",id:c,index:v}).then((function(){if(e.$emit("saveSuccess"),o){var t;localStorage.setItem("createParams",JSON.stringify(o));var n="/cyberPubPage/".concat(null===(t=e.message)||void 0===t?void 0:t.id,"?quickChat=true&source=work");window.open(e.localePath(n),"_blank")}})).catch((function(t){console.log("saveFail",t)}));case 5:case"end":return n.stop()}}),n)})))()},handlePost:function(){var t={taskId:this.message.id,url:this.currentImg,index:this.currentImgInfo.index};this.$logEvent("log_actions",{operation:"click_post_picture_button",behavior_info:"on_creative_flow_details",behavior_info_sub:t.url});var e={types:[J.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[t]};this.$EventBus.$emit("openContribution",e),this.hide()},handleAnimate:function(){this.$emit("handleAnimate"),this.hide()},handleCopyAll:function(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["",null,void 0].includes(content)||(Object(D.g)(content),this.$message.success(this.$t("CopySuccess")))},handleDownloadClick:function(){var t=this;this.$nextTick((function(){var e,n=t.$refs.downloadVideoPop;n&&(null==n||null===(e=n.$el)||void 0===e||e.click())}))},deleteSingleImg:function(){this.$emit("handleDeleteSingleImg",this.urlList[this.index].type,U()(this.urlList[this.index]))},handleAppeal:function(){var t,e,n=this;if(this.checkIsAlreadyFeedback)this.$message.warning(this.$t("feedbackTips3"));else{var o={appeal:{index:null===(t=this.currentImgInfo)||void 0===t?void 0:t.index,task_id:null===(e=this.message)||void 0===e?void 0:e.id}};Object(tt.feedbackNSFWImage)(o).then((function(t){var e,o=(null==t||null===(e=t.data)||void 0===e?void 0:e.result)||{};((null==o?void 0:o.success)||!1)&&(n.updateImageInfo(n.message.id,n.currentImgInfo.index,"is_nsfw_appeal",!0),n.$message.success(n.$t("feedbackTips2")))})).finally((function(){}))}},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},handleGetMeta:function(){var t,e=this;return Object(V.getMetaInfo)({id:null===(t=this.message)||void 0===t?void 0:t.id,task_flow_version:"v2"}).then((function(t){1e4===t.status.code&&(e.metaInfo=(null==t?void 0:t.data)||{})})).finally((function(){}))},handleRemoveBackground:function(t){var e,n,o=this,r=Object.assign({},null===(e=this.metaInfo)||void 0===e?void 0:e.meta,{init_images:[t],hi_res_arg:void 0,remove_background:{uri:t}}),l={action:7,art_work_no:null===(n=this.metaInfo)||void 0===n?void 0:n.art_work_no,meta:r};Object(V.createTask)(l).then((function(t){o.$EventBus.$emit("openGenerate",{action:0,data:t.data})}))}},mounted:function(){this.init(),this.isI18nToggled=!this.accountSettingsData.is_off_localization,this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},lt=st,ct=(n(4706),n(4707),Object(m.a)(lt,(function(){var t,e,n,o,r,l,c,d,h,v,f,m,_,y,w,C,k,O=this,x=O._self._c;return x("transition",{attrs:{name:"viewer-fade"}},[x("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper c-easy-task-image-viewer",style:{"z-index":O.viewerZIndex},attrs:{tabindex:"-1"}},[x("div",{staticClass:"el-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:O.handleMaskClick.apply(null,arguments)}}}),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__chat",on:{click:O.handleChat}},[x("i",{staticClass:"iconfont icon-a-home-top-personl1"})]),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:O.hide}},[x("i",{staticClass:"el-icon-close"})]),O._v(" "),O.showOperateBtn?O._e():x("span",{staticClass:"el-image-viewer__btn el-image-viewer__download",on:{click:function(t){return O.handleOperateBtnClick({type:"download"})}}},[x("i",{staticClass:"iconfont icon-icon-Download"})]),O._v(" "),O.showOperateBtn?O._e():x("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[x("div",{staticClass:"el-image-viewer__actions__inner"},[x("i",{staticClass:"el-icon-zoom-out",on:{click:function(t){return O.handleActions("zoomOut")}}}),O._v(" "),x("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){return O.handleActions("zoomIn")}}}),O._v(" "),x("i",{staticClass:"el-image-viewer__actions__divider"}),O._v(" "),x("i",{class:O.mode.icon,on:{click:O.toggleMode}}),O._v(" "),x("i",{staticClass:"el-image-viewer__actions__divider"}),O._v(" "),x("i",{staticClass:"el-icon-refresh-left",on:{click:function(t){return O.handleActions("anticlocelise")}}}),O._v(" "),x("i",{staticClass:"el-icon-refresh-right",on:{click:function(t){return O.handleActions("clocelise")}}})])]),O._v(" "),x("div",{staticClass:"el-image-viewer__canvas task-image-viewer__canvas"},[O.isSingle?O._e():[x("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!O.infinite&&O.isFirst},on:{click:O.prev}},[x("i",{staticClass:"el-icon-arrow-left"})]),O._v(" "),x("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!O.infinite&&O.isLast},on:{click:O.next}},[x("i",{staticClass:"el-icon-arrow-right"})])],O._v(" "),O._l(O.urlList,(function(t,i){return[i!==O.index||O.isVideoUrl(O.currentImg)?i===O.index?x("video",{key:i,staticClass:"el-image-viewer__img task-image-viewer__img",style:O.imgStyle,attrs:{src:O.currentImg,autoplay:"",loop:"",muted:"",controls:"",controlsList:"nodownload"},domProps:{muted:!0},on:{play:O.handleImgLoad}}):O._e():x("img",{directives:[{name:"webp",rawName:"v-webp",value:O.$imgH,expression:"$imgH"}],key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img task-image-viewer__img",style:O.imgStyle,attrs:{src:O.currentImg,referrerpolicy:"no-referrer"},on:{load:O.handleImgLoad,mousedown:O.handleMouseDown,click:function(t){return O.viewImage(O.currentImg)}}})]})),O._v(" "),O.isSingle||O.isAudioUrl(O.currentImg)?O._e():[x("div",{staticClass:"indicator-box"},O._l(O.urlList,(function(t,i){return x("span",{key:"indicator_".concat(i),staticClass:"indicator-box-item",class:[O.index===i&&"indicator-box-item-active"]})})),0)]],2),O._v(" "),O.showOperateBtn?x("div",{staticClass:"task-image-viewer__side-bar"},[x("div",{staticClass:"header-image-viewer"},[x("div",{staticClass:"flex"},[null!==(t=O.getActionButtons)&&void 0!==t&&t.length?x("image-action-buttons",{attrs:{visible:!0,buttons:O.getActionButtons,iconStyle:"iconStyle",iconFontsize:"iconFontsize",gap:4,maxVisibleButtons:3},on:{"button-click":O.handleOperateBtnClick}},[x("SaveTo",{ref:"saveToPopover",attrs:{type:"artwork",category:!0,title:O.$t("Save"),message:L(L({},O.message),{},{img_uris:(null===(e=O.message)||void 0===e?void 0:e.components)||[]}),operateNumber:O.operateNumber,showArrowIcon:!1},on:{saveSuccess:function(t){return O.$emit("saveSuccess")}}})],1):O._e()],1),O._v(" "),x("span",{on:{click:O.hide}},[x("i",{staticClass:"el-icon-close el-image-viewer-close"})])]),O._v(" "),x("div",{staticClass:"booderbtm"}),O._v(" "),x("div",{staticClass:"task-image-viewer__side-bar-box"},[null!==(n=O.editButtons)&&void 0!==n&&n.length?x("div",{staticClass:"edit-group mrgin-bt8"},[x("div",{staticClass:"group-title"},[O._v(O._s(O.$t("Edit")))]),O._v(" "),x("div",{staticClass:"button-row"},O._l(O.editButtons,(function(t){return x("el-tooltip",{key:t.code,attrs:{content:O.$t(t.tips),disabled:!t.tips,"open-delay":200,placement:"bottom",effect:"light","popper-class":"task-image-viewer-popover"}},[x("div",{staticClass:"button",on:{click:function(e){return e.stopPropagation(),O.handleOperateBtnClick(t)}}},[x("span",{staticClass:"icon"},[x("i",{class:t.icon})]),O._v(" "),x("span",{staticClass:"label"},[O._v(O._s(O.$t(t.label)))])])])})),1)]):O._e(),O._v(" "),null!==(o=O.moreButtons)&&void 0!==o&&o.length?x("div",{staticClass:"more-group"},[x("div",{staticClass:"group-title"},[O._v(O._s(O.$t("more")))]),O._v(" "),x("div",{staticClass:"button-row"},O._l(O.moreButtons,(function(t){return x("el-tooltip",{key:t.code,attrs:{content:O.$t(t.tips),"open-delay":200,disabled:!t.tips,placement:"bottom","popper-class":"task-image-viewer-popover",effect:"light"}},[x("div",{staticClass:"button",on:{click:function(e){return e.stopPropagation(),O.handleOperateBtnClick(t)}}},[x("span",{staticClass:"icon"},[x("i",{class:t.icon})]),O._v(" "),x("span",{staticClass:"label"},[O._v(O._s(O.$t(t.label)))])])])})),1)]):O._e(),O._v(" "),x("div",{staticClass:"task-image-viewer__generation-data"},[O._v("\n          "+O._s(O.$t("GenerationData"))+"\n        ")]),O._v(" "),O.customForm?O._e():x("div",{staticClass:"task-image-viewer__prompt-box",class:[O.currentImgInfo&&[0,"0"].includes(O.currentImgInfo.operateNumber)?"task-image-viewer__prompt-box-margin-top":""]},[x("div",{staticClass:"task-image-viewer__prompt-title"},[x("span",{staticClass:"prompt-title-text"},[O._v(O._s(O.$t("Prompt")))]),O._v(" "),x("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(t){return t.stopPropagation(),O.handleCopyAll(O.setI18nPrompt)}}})]),O._v(" "),x("text-overflow-area",{staticClass:"prompt-text-overflow"},[O._v(O._s(O.setI18nPrompt))]),O._v(" "),null!==(r=O.message)&&void 0!==r&&null!==(r=r.meta)&&void 0!==r&&r.negative_prompt?[x("div",{staticClass:"task-image-viewer__prompt-title"},[x("span",{staticClass:"prompt-title-text"},[O._v(O._s(O.$t("NegativePrompts")))]),O._v(" "),x("span",{staticClass:"iconfont icon-codeCopy1 prompt-title-copy",on:{click:function(t){var e;return t.stopPropagation(),O.handleCopyAll(null===(e=O.message)||void 0===e||null===(e=e.meta)||void 0===e?void 0:e.negative_prompt)}}})]),O._v(" "),x("text-overflow-area",{staticClass:"prompt-text-overflow"},[O._v(O._s((null===(l=O.message)||void 0===l||null===(l=l.meta)||void 0===l?void 0:l.negative_prompt)||""))])]:O._e(),O._v(" "),x("div",{staticClass:"easy-tooltip-wraper-params-box"},[x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("newGenerate27")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(O.$t(O.convertTaskType)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("newGenerate26")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(O._f("formatDateTime")(O.message.create_at)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("imageDimensions")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v("\n                "+O._s("".concat(null===(c=O.message)||void 0===c||null===(c=c.components[0])||void 0===c?void 0:c.width," x ").concat(null===(d=O.message)||void 0===d||null===(d=d.components[0])||void 0===d?void 0:d.height))+" px\n              ")])]),O._v(" "),[11,12,13].includes(null===(h=O.message)||void 0===h?void 0:h.task_domain_type)?x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Duration")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s((null===(v=O.message)||void 0===v||null===(v=v.components[0])||void 0===v?void 0:v.duration)||0)+"s")])]):O._e(),O._v(" "),[11,12,13].includes(null===(f=O.message)||void 0===f?void 0:f.task_domain_type)?O._e():[x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Seed")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(m=O.message)||void 0===m||null===(m=m.meta)||void 0===m?void 0:m.seed))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Sampler")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(_=O.message)||void 0===_||null===(_=_.meta)||void 0===_?void 0:_.sampler_name))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("Steps")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(y=O.message)||void 0===y||null===(y=y.meta)||void 0===y?void 0:y.steps))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("CFGScale")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s(null===(w=O.message.meta)||void 0===w?void 0:w.cfg_scale))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item"},[x("div",{staticClass:"easy-tooltip-params-item-title"},[O._v(O._s(O.$t("clipSkip")))]),O._v(" "),x("div",{staticClass:"easy-tooltip-params-item-content"},[O._v(O._s((null===(C=O.message)||void 0===C||null===(C=C.meta)||void 0===C?void 0:C.clip_skip)||""))])])]],2)],2),O._v(" "),O.customForm?O._e():[null!==(k=O.getModelList)&&void 0!==k&&k.length?x("div",{directives:[{name:"show",rawName:"v-show",value:!O.loading,expression:"!loading"}],staticClass:"easy-tooltip-wraper-model-box"},O._l(O.getModelList,(function(t,e){var n,o,r;return x("div",{key:"model_i_".concat(e),staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(e){return e.stopPropagation(),O.handleJumpDetail(t)}}},[x("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[O.isVideoUrl(null==t||null===(n=t.banner)||void 0===n?void 0:n.url)?x("video",{attrs:{src:null==t||null===(o=t.banner)||void 0===o?void 0:o.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):x("img",{attrs:{src:null==t||null===(r=t.banner)||void 0===r?void 0:r.url,alt:""}})]),O._v(" "),x("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[x("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[x("span",{staticClass:"easy-tooltip-model-box-model-type"},[O._v(O._s(O.$t(null==t?void 0:t.type)))])]),O._v(" "),x("div",{staticClass:"easy-tooltip-model-box-model-name"},[O._v(O._s((null==t?void 0:t.name)||""))])])])})),0):O._e()],O._v(" "),O.customForm?[O._t("customContent")]:O._e()],2)]):O._e(),O._v(" "),x("view-image",{ref:"viewImage"}),O._v(" "),x("AiChatCreateConfirm",{ref:"aiChatCreateConfirm",attrs:{source:"task",fromPage:"newTask"},on:{confirm:O.handleConfirm}}),O._v(" "),x("ShareDialog",{ref:"shareDialog",attrs:{type:"artwork",workId:O.workId}})],1)])}),[],!1,null,"cbc469f0",null)),ut=ct.exports;function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(ct,{SaveTo:n(124).default,ShareDialog:n(144).default});var vt={name:"historyImg",inject:["top"],provide:function(){return{easyTop:this.top}},components:{ComfyUIImageViewer:ut,SelectVideoModelModal:n(301).default,SaveTo:X.default,ShowNsfw:$.default},props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},imgInfo:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},baseSize:{type:String,default:""}},data:function(){return{loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:200,imageUrl:"",checked:!1,alreadySave:!1,hoverBtnList:[{code:"play",icon:"icon_play",useText:!1,order:3,tips:"play_tips",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]},{code:"download",icon:"modelDownload",useText:!1,order:5,show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"Post",show:!0,showTypeOptions:[]}],bigImageBtns:[{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]},{code:"post",icon:"post-icon2",useText:!1,order:5,tips:"Post",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],isShowHoverMask:!1,isVideoPlay:!1}},computed:ht(ht(ht(ht({},Object(d.c)(["isSupportWebp"])),Object(d.c)("user",["userInfo","isCompanyAccount","isLoggedIn"])),Object(d.e)("user",["cdnHost"])),{},{getVideoStyle:function(){return{borderRadius:"8px",width:"".concat(this.baseImageWidth,"px"),height:"".concat(parseInt(this.height*this.baseImageWidth/this.width),"px")}},currentImageIndex:function(){var t,e=this;return-1===(t=this.viewImageList.findIndex((function(t){return t.operateNumber===e.operateNumber})))?0:t},checkIsAlreadyFeedback:function(){var t;return null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_appeal},viewImageList:function(){var t=this,e=[],n=this.message.components,o=void 0===n?[]:n;return Array.isArray(o)&&o.length&&(e=U()(o).map((function(t,e){return t.operateNumber=e+1,t})).filter((function(e){if(t.checkIsShowViewNsfw&&t.enableNsfwMode)return![1,"1"].includes(e.nsfw)&&(null==e?void 0:e.canViewNsfw);var n=[0,1,"0","1"].includes(e.type);return![1,"1"].includes(null==e?void 0:e.nsfw)&&n}))),e},getTooltipContent:function(){var t=this;return function(e){return"play"===e.code?"".concat(t.$t("play"),"：")+" "+t.$t(null==e?void 0:e.tips):t.$t(null==e?void 0:e.tips)}},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var t="";return 1===this.nsfw||(t=this.checkIsShowViewNsfw?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===t)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw?(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!this.imgInfo.canViewNsfw:1===this.nsfw);var t},isShowOperateBtn:function(){return!this.isBlur&&!this.error},isShowHover:function(){var t,e;return!!this.checkIsShowViewNsfw&&((null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!(null!=this&&null!==(e=this.imgInfo)&&void 0!==e&&e.canViewNsfw))},isNsfwPlus:function(){var t;return(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==this.nsfw},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},isVideoUrl:function(){var t=this;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t.imageUrl||"").toLowerCase().endsWith(e)}))},isImageUrl:function(){return/^https?:\/\/.*\.(jpg|jpeg|png|webp)$/i.test(this.imageUrl)},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},hoverBtnRenderList:function(){var t=this;return this.hoverBtnList.map((function(e){return e.show=t.isShowBtn(e.code),e})).filter((function(t){return t.show}))},isShowSaveTo:function(){var t,e,n=this.message.components,o=void 0===n?[]:n;return!!o.length&&!(null!==(t=o[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal||null!==(e=o[this.operateNumber-1])&&void 0!==e&&e.alreadySave||this.alreadySave)},isShowBtn:function(){var t={save:[this.isShowSaveTo&&1!==this.nsfw],play:[1!==this.nsfw&&(this.isVideoUrl||this.isImageUrl)],aiGenerateVideo:[1!==this.nsfw&&!this.isVideoUrl],post:[1!==this.nsfw]};return function(e){return!!Object.keys(t).includes(e)&&t[e].every((function(t){return!!t}))}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)}}),mounted:function(){this.$set(this.imgInfo,"canViewNsfw",this.checkIsShowViewNsfw&&this.enableNsfwMode)},watch:{src:{handler:function(t){t&&"string"==typeof t&&(this.imageUrl=this.isSupportWebp?Object(D.K)(t,"high"):this.src)},immediate:!0}},methods:{handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"});try{this.message.components[this.operateNumber-1].alreadySave=!0}catch(t){}this.alreadySave=!0,this.$emit("saveSuccess")},deleteSingleImg:function(){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("deleteSingleImg",t.operateNumber,t.message)}))},handleShowNsfwImageUrl:function(){var t;return null!=this&&null!==(t=this.imgInfo)&&void 0!==t&&t.is_nsfw_plus&&!this.imgInfo.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(t){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",U()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var t=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){t.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(D.K)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){1!==this.nsfw&&(this.isShowHover||(this.$logEvent("log_actions",{operation:"exposure",behavior_info:"on_comfyui_detail_page",behavior_info_sub:"zoom_in"}),this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(t){1===this.nsfw&&t.preventDefault()},downloadImage:function(){Object(D.M)(this.src,this.$t("WorkFlow"))},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.handleLogEvent(t),["deleteSingleImg"].includes(t))this.deleteSingleImg();else if("download"!==t){var e;if(["save"].includes(t))null===(e=this.$refs)||void 0===e||null===(e=e.saveToPopover[0])||void 0===e||e.doShow();"aiGenerateVideo"!==t?"post"!==t?"play"!==t||this.openPlayModal(!1):this.handlePost():this.handleAiGenerateVideo()}else this.downloadImage()},handleLogEvent:function(t){var e="";switch(t){case"save":e="click_save";break;case"post":e="click_post";break;case"aiGenerateVideo":e="click_video_generate"}e&&(this.isVideoUrl?this.$logEvent("log_actions",{operation:e,behavior_info:"on_comfyui_detail_page",behavior_info_sub:"video_work"}):this.$logEvent("log_actions",{operation:e,behavior_info:"on_comfyui_detail_page",behavior_info_sub:"image_history_record"}))},settingViewNsfw:function(){this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.$set(this.imgInfo,"canViewNsfw",!this.imgInfo.canViewNsfw)},handleAiGenerateVideo:function(){this.isLoggedIn?this.handleSelectVideoModel({},this.src):this.$EventBus.$emit("openLoginDialog")},handleSelectVideoModel:function(t,e){var n=Object.assign({},t,{imageToVideoUrl:e});this.$EventBus.$emit("openGenerate",{action:0,taskVersion:"v2",data:{source:n}})},handlePost:function(){var t={taskId:this.message.id,index:this.imgInfo.index,url:this.imgInfo.url},e={types:[J.CONTRIBUTION_TYPE_ENUM.WORK],source:"task",selectedData:[t],remoteParams:{tags:["faceswap"]}};this.$EventBus.$emit("openContribution",e)},openPlayModal:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.$logEvent("log_actions",{operation:"click_play_around",behavior_info:"on_comfyui_detail_page",behavior_info_sub:"zoom_in"}):this.$logEvent("log_actions",{operation:"click_play_around",behavior_info:"on_comfyui_detail_page",behavior_info_sub:"image_history_record"}),this.$EventBus.$emit("showDialog",{name:"HyAssembleModal",data:{doorCode:this.isVideoUrl?"aiVideoApp":"aiImageApp",workUrl:this.imgInfo.url,source:7,taskReferIndex:this.imgInfo.index,taskId:this.message.id,onAfterAction:function(){t.$EventBus.$emit("hideDialog","HyAssembleModal")}}})},handleVideoSave:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.message,r=o.id,l=void 0===r?"":r,c=o.components,d=t.index||0,Object(E.a)({folder_no:"default",id:l,index:d}).then((function(){e.handleSaveSuccess()})).catch((function(t){console.log("saveFail",t)}));case 3:case"end":return n.stop()}}),n)})))()},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},handleAppeal:function(){var t,e,n=this;if(this.checkIsAlreadyFeedback)this.$message.warning(this.$t("feedbackTips3"));else{var o={appeal:{index:null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.index,task_id:null===(e=this.message)||void 0===e?void 0:e.id}};Object(tt.feedbackNSFWImage)(o).then((function(t){var e,o=(null==t||null===(e=t.data)||void 0===e?void 0:e.result)||{};((null==o?void 0:o.success)||!1)&&(n.updateImageInfo(n.message.id,n.imgInfo.index,"is_nsfw_appeal",!0),n.$message.success(n.$t("feedbackTips2")))})).finally((function(){}))}},handleMouseEnter:function(){var t=this.$refs.videoRef;!this.isVideoUrl||this.isShowNsfwIcon&&this.isShowNsfwBg||1==this.nsfw||(this.isVideoPlay=!0,null==t||t.play())},handleMouseLeave:function(){this.isVideoPlay=!1;var t=this.$refs.videoRef;t&&(t.currentTime=0,null==t||t.pause())}}},ft=vt,mt=(n(4708),n(4709),Object(m.a)(ft,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-history-img"},[e("div",{staticClass:"attachments-wrap"},[e("div",{staticClass:"message-attachment-media"},[e("div",{staticClass:"image-content"},[e("div",{staticClass:"image-content-wrap",class:[1===t.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(t.baseSize),"min-width":"".concat(t.baseSize,"px")}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.nsfw,expression:"nsfw === 1"}],staticClass:"nsfw-flag"},[t._v("NSFW")]),t._v(" "),e("div",{staticClass:"image-render-box",on:{mouseover:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isVideoUrl&&!t.isVideoPlay&&!t.isShowNsfwBg,expression:"isVideoUrl && !isVideoPlay && !isShowNsfwBg"}],staticClass:"video-tag"},[e("i",{staticClass:"iconfont icon-icon-tag-creation"})]),t._v(" "),1===t.nsfw?[e("img",{staticClass:"media-attachments-img image-opacity-0",attrs:{src:t.renderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:t.onLoad,error:t.onError,contextmenu:function(e){return t.handleContextMenu(e)}}})]:[t.isVideoUrl?t._e():e("img",{staticClass:"media-attachments-img",class:[t.loading?"":"media-attachments-img-show",t.loading?"image-opacity-0":"",t.isShowNsfwBg?"blurBackground":""],attrs:{src:t.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:t.onLoad,error:t.onError,click:t.viewBigImage,contextmenu:function(e){return t.handleContextMenu(e)}}}),t._v(" "),t.isVideoUrl&&t.getImageUrl?e("video",{ref:"videoRef",class:["media-attachments-video",t.loading?"image-opacity-0":"",t.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px"},attrs:{src:t.getImageUrl,autoplay:t.isVideoPlay,loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{canplay:t.onLoad,error:t.onError}}):t._e()],t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading&&1!==t.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[e("div",{staticClass:"loading-wrapper-inner"},[e("span",{staticClass:"spinner",attrs:{role:"img","aria-label":t.$t("Loading")}},[t._m(0)])])]),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isShowNsfwBg&&t.isShowNsfwIcon,expression:"isShowNsfwBg && isShowNsfwIcon"}],staticClass:"generate-view-nsfw-warning iconfont icon-report"}),t._v(" "),e("ShowNsfw",{attrs:{"is-show-nsfw-icon":t.isShowNsfwIcon,"img-info":t.imgInfo},on:{settingViewNsfw:t.settingViewNsfw,deleteSingleImg:t.deleteSingleImg,handleAppeal:t.handleAppeal}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowSaveTo,expression:"!isShowSaveTo"}],staticClass:"save-status-flag"},[e("i",{staticClass:"iconfont icon-yibaocun"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowOperateBtn&&t.isShowImage&&t.src&&!t.loading||1===t.nsfw,expression:"(isShowOperateBtn && isShowImage && src && !loading) || nsfw === 1"}],staticClass:"image-hover-mask",on:{click:t.viewBigImage}},[e("div",{staticClass:"image-hover-mask-btn-box"},[t._l(t.hoverBtnRenderList,(function(n){var o;return[e("el-tooltip",{key:n.code,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:t.getTooltipContent(n)}},["save"!==n.code?e("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",attrs:{"data-event":"comfyui_history_hover_click_btn","data-type":n.code,"data-id":t.message.id,"data-info":JSON.stringify({obj_pt:n.code})},on:{click:function(e){return e.stopPropagation(),t.handleClick(n.code)}}},[n.useText?[t._v("\n                        "+t._s(n.text)+"\n                      ")]:e("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(n.icon)})],2):t._e(),t._v(" "),"save"===n.code&&t.isShowSaveTo?e("save-to",{ref:"saveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:t.$t("Save"),message:I(I({},t.message),{},{img_uris:(null===(o=t.message)||void 0===o?void 0:o.components)||[]}),operateNumber:t.operateNumber,showArrowIcon:!1},on:{saveSuccess:t.handleSaveSuccess}},[e("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",attrs:{"data-event":"comfyui_history_hover_click_btn","data-type":n.code,"data-id":t.message.id,"data-info":JSON.stringify({obj_pt:n.code})},on:{click:function(e){return e.stopPropagation(),t.handleClick("save")}}},[n.useText?[t._v("\n                          "+t._s(n.text)+"\n                        ")]:e("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(n.icon)})],2)]):t._e()],1)]}))],2)])],2)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.error&&!t.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[e("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),t._v(" "),e("span",{staticClass:"image-load-error-text",on:{click:function(e){return e.stopPropagation(),t.clickReloadImage.apply(null,arguments)}}},[t._v(t._s(t.$t("reloadImage")))])])])])]),t._v(" "),t.dialogVisible?e("ComfyUIImageViewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"1999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!0,hoverBtnRenderList:t.bigImageBtns,"is-from-history":!0,message:t.message,"url-list":t.viewImageList,"is-show-save-btn":t.isShowSaveTo,checkIsShowViewNsfw:t.checkIsShowViewNsfw},on:{openEasyVideoRecModal:t.handleAiGenerateVideo,handleDeleteSingleImg:t.deleteSingleImg,onPlay:function(e){return t.openPlayModal(!0)},saveSuccess:t.handleSaveSuccess,updateImageInfo:t.updateImageInfo}}):t._e(),t._v(" "),e("SelectVideoModelModal",{ref:"selectVideoModelModal",attrs:{changeBtnColor:!0},on:{confirm:t.handleSelectVideoModel}})],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"4ed4fb04",null)),gt=mt.exports;installComponents(mt,{ShowNsfw:n(276).default,SaveTo:n(124).default});var _t=n(619),yt=(n(119),n(424)),bt=n(425),wt=n(289),Ct=n(586),kt={name:"ErrorDialog",props:{visible:{type:Boolean,default:!1},errorType:{type:String,default:""},errorMessage:{type:String,default:""}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{handleClose:function(){this.$emit("update:visible",!1),this.$emit("close")}}},Ot=(n(4710),Object(m.a)(kt,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":"",center:"","custom-class":"error-tips-dialog",width:"283px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"error-tips-content"},[e("h3",{staticClass:"error-tips-title"},[t._v(t._s(t.$t("ImportModelTips")))]),t._v(" "),e("div",{staticClass:"error-tips-message"},[t.errorType?e("div",[t._v(t._s(t.errorType)+":")]):t._e(),t._v(" "),t.errorMessage?e("div",[t._v("-"+t._s(t.errorMessage))]):t._e()]),t._v(" "),e("div",{staticClass:"error-tips-footer"},[e("el-button",{staticClass:"error-tips-close-btn",on:{click:t.handleClose}},[t._v(t._s(t.$t("close")))])],1)])])}),[],!1,null,"04cbb2ad",null).exports);function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St=n(275),Dt={name:"historyItem",components:{historyImg:gt,historyModel:_t.a,CFile:yt.default,CText:bt.default,CAudio:wt.default,ModelViewer:Ct.a,ErrorDialog:Ot},props:{message:{type:Object,default:function(){return{}},required:!0},viewMode:{type:String,default:""},showHistoryModal:{type:Boolean,default:!1},isFreeCreate:{type:Boolean,default:!1}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(D.F)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{defaultAvatar:St,customColor:"#2E9E60",alreadySave:!1,isLoading:!1,errorDialogVisible:!1,errorType:"",errorMessage:"",isShowRetry:!0}},computed:Tt(Tt(Tt({},Object(d.e)("payment",["paymentInfo"])),Object(d.c)("user",["isLoggedIn"])),{},{getComponentsArr:function(){var t,e=(null===(t=this.message)||void 0===t?void 0:t.components)||[],n={4:1,2:2,3:3,0:4,1:5,6:6};return e.sort((function(a,b){var t=String(a.type),e=String(b.type);return n[t]-n[e]}))},getTitle:function(){var t;return(null===(t=this.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name)||this.$t("beenDeleted")},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},computedPercentage:function(){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===t?0:t}},convertStatusText:function(){var t,e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return null!==(t=this.message)&&void 0!==t&&t.status_desc?e[this.message.status_desc]:""},taskFailData:function(){var t,data={show:!1,tips:""};if(3==(null===(t=this.message)||void 0===t?void 0:t.speed_type))return data;var e=this.getComponentsArr.filter((function(t){return![2,3,4,6].includes(t.type)&&1===t.nsfw}));if(this.isLoggedIn){var n,o=(null===(n=this.message)||void 0===n?void 0:n.task_return)||{},r=o.sub_status,l=void 0===r?0:r,c=o.used,d=void 0===c?0:c,h=o.hashrate,v=void 0===h?0:h,f=o.temp_hashrate,m=void 0===f?0:f;if(301==l&&(data.show=!0,data.tips=this.$t("task_fail_content_violation")),302==l){var _=d||"",y="";d<=0&&v>0&&(_="".concat(v).concat(this.$t("coin"))),d<=0&&m>0&&(y="".concat(m).concat(this.$t("tempCoins"))),data.show=!0,data.tips=this.$t("task_fail_more_content_violation",{cost:_,unit:y})}411==l&&(data.show=!0,data.tips=this.$t("task_fail_system_cancle"))}else{var w;null!=e&&e.length&&(data.show=!0,data.tips=this.$t("task_fail_visitor_content_violation")),"sysCancelDesc"==(null===(w=this.message)||void 0===w?void 0:w.status_desc)&&(data.show=!0,data.tips=this.$t("task_fail_visitor_system_cancle"))}return data},isWithin30Days:function(){var t=new Date(this.message.create_at),e=new Date,n=Math.abs(e-t);return Math.ceil(n/864e5)<=30}}),watch:{showHistoryModal:function(t){if(t){var e=this.$refs.textRef;if(!e)return;if(!Array.isArray(e))return void e.isShowToggle();e.forEach((function(t){null==t||t.isShowToggle()}))}}},methods:{handleRetryClick:function(){var t=this;this.isShowRetry=!1,this.$emit("retry",Tt(Tt({},this.message.creativity),{},{task_id:this.message.id})),setTimeout((function(){t.isShowRetry=!0}),1e3)},handleModelOperation:function(t,e){var n=e.modelUrl,o=this.message.components;if("delete"===t){var r=(void 0===o?[]:o).findIndex((function(t){return t.url===n}));-1!==r&&this.deleteSingleImg(r+1)}},show3DModel:function(t){var e=t.url;this.$refs.modelViewer.show({url:e,createTime:this.message.create_at,id:this.message.id})},handleDeleteTask:function(){var t=this;this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e=t.message.id;e&&Object(V.deleteTaskRecord)({ids:[e]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.$emit("deleteTask",e)}))}))},updateImageInfo:function(t,e,n,o){this.$emit("updateImageInfo",t,e,n,o)},deleteSingleImg:function(t){var e=this,n=this.message,o=n.id,r=void 0===o?"":o,l=n.components,c=(void 0===l?[]:l)[t-1].index,d=void 0===c?-1:c;Object(E.b)({id:r,index:d}).then((function(){var t;(e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.message.components=e.message.components.filter((function(t){return t.index!==d})),e.message.components.length)||e.$emit("deleteTask",null==e||null===(t=e.message)||void 0===t?void 0:t.id)}))},handleError:function(t){var e=this;Object(V.getMetaInfo)({id:(null==t?void 0:t.id)||""}).then((function(t){var n={};try{var o,r=(null==t||null===(o=t.data)||void 0===o||null===(o=o.comfyui_current_node)||void 0===o?void 0:o.error)||"{}";n=JSON.parse(r)}catch(t){n={},console.error("解析错误信息失败:",t)}var l=n,c=l.exception_type,d=void 0===c?"":c,h=l.exception_message,v=void 0===h?"":h;d||v?(e.errorType=d,e.errorMessage=v,e.errorDialogVisible=!0):e.$message.warning(e.$t("No detailed error information"))}))}}},Pt=Dt,It=(n(4711),Object(m.a)(Pt,(function(){var t,e,o,r,l,c,d,h,v,f=this,m=f._self._c;return m("div",{staticClass:"c-workflow-history-item"},[m("div",{staticClass:"workflow-history-item-header"},[m("div",{staticClass:"workflow-history-item__title"},[m("img",{staticClass:"workflow-history-item__avatar",attrs:{src:f.defaultAvatar,alt:"Avatar"}}),f._v(" "),m("div",{staticClass:"workflow-history-item__title-task-tag overflow-ellipsis",attrs:{title:f.getTitle}},[f._v(f._s(f.getTitle))]),f._v(" "),m("div",{staticClass:"workflow-history-item__btn-box"},[f.taskFailData.show?m("div",{staticClass:"task-info-icon-box"},[m("el-tooltip",{attrs:{effect:"dark",content:f.taskFailData.tips,placement:"top"}},[m("img",{staticClass:"task-info-icon",attrs:{src:n(750),alt:"task_fail"}})])],1):f._e(),f._v(" "),null!==(t=f.message)&&void 0!==t&&null!==(t=t.creativity)&&void 0!==t&&t.is_support_retry&&f.isWithin30Days?m("div",{staticClass:"task-info-icon-box"},[m("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:f.isShowRetry,expression:"isShowRetry"}],attrs:{effect:"dark",content:f.$t("comfyui_retry_tips"),placement:"top"}},[m("img",{staticClass:"task-info-icon",attrs:{src:n(666),alt:"task_fail"},on:{click:f.handleRetryClick}})]),f._v(" "),m("img",{directives:[{name:"show",rawName:"v-show",value:!f.isShowRetry,expression:"!isShowRetry"}],staticClass:"task-info-icon",attrs:{src:n(666),alt:"task_fail"},on:{click:f.handleRetryClick}})],1):f._e(),f._v(" "),m("div",{staticClass:"task-info-icon-box"},[m("el-popover",{attrs:{trigger:"click","popper-class":"custom-popver"}},[m("div",{staticClass:"task-info-tips"},[m("p",[m("span",[f._v(f._s(f.$t("TaskID")))]),m("span",[f._v(f._s(f.message.id))])]),f._v(" "),3===f.message.status?[[1,2,"1","2"].includes(null===(e=f.message)||void 0===e?void 0:e.pub_community)?m("p",[m("span",{staticClass:"task-info-tips-label"},[f._v(f._s(f.$t("status")))]),f._v(" "),m("span",{staticClass:"task-pub-status"},[f._v(f._s([2,"2"].includes(null===(o=f.message)||void 0===o?void 0:o.pub_community)?f.$t("createSetting1"):f.$t("createSetting2")))])]):f._e(),f._v(" "),m("p",[m("span",{staticClass:"task-info-tips-label"},[f._v(f._s(f.$t("expend")))]),f._v(" "),m("span",{staticClass:"task-info-tips-content"},[m("span",[f._v(f._s(f.$t("tempCoins"))+" : "+f._s(null===(r=f.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.temp_hashrate))]),f._v(" "),m("span",[f._v(f._s(f.$t("calculateCoins"))+" : "+f._s(null===(l=f.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.hashrate))])])]),f._v(" "),null!==(c=f.message)&&void 0!==c&&null!==(c=c.deduction_detail)&&void 0!==c&&c.history_hashrate?m("p",[m("span",{staticClass:"task-info-tips-label"},[f._v(f._s(f.$t("currentBalance")))]),f._v(" "),m("span",{staticClass:"task-info-tips-content"},[m("span",[f._v(f._s(f.$t("tempCoins"))+" : "+f._s(null===(d=f.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_temp_hashrate))]),f._v(" "),m("span",[f._v(f._s(f.$t("calculateCoins"))+" : "+f._s(null===(h=f.message)||void 0===h||null===(h=h.deduction_detail)||void 0===h?void 0:h.after_hashrate))])])]):f._e()]:f._e()],2),f._v(" "),m("img",{staticClass:"task-info-icon",staticStyle:{"vertical-align":"bottom"},attrs:{slot:"reference",src:n(751),alt:""},slot:"reference"})])],1),f._v(" "),m("div",{staticClass:"task-info-icon-box"},[m("img",{staticClass:"task-info-icon",attrs:{src:n(749),alt:"task_fail"},on:{click:f.handleDeleteTask}})])])])]),f._v(" "),m("div",{staticClass:"workflow-history-item__title-time"},[f.message.create_at?m("div",{staticClass:"workflow-history-item__title-create-time"},[f._v("\n      "+f._s(f._f("formatDateTime")(f.message.create_at))+"\n    ")]):f._e()]),f._v(" "),[2,"2",3,"3"].includes(f.message.status)?m("div",{staticClass:"workflow-history-image-container",class:[1===(null===(v=f.message)||void 0===v||null===(v=v.components)||void 0===v?void 0:v.length)&&"workflow-history-image-container-full"]},[f._l(f.getComponentsArr,(function(t,e){return[4==t.type?m("div",{key:"list-item-file_".concat(e),staticClass:"c-history-box c-history-box-file"},[m("CFile",{attrs:{file:{url:t.url}}})],1):2==t.type?m("div",{key:"list-item-text_".concat(e),staticClass:"c-history-box c-history-box-text"},[m("CText",{ref:"textRef",refInFor:!0,attrs:{text:null==t?void 0:t.content}})],1):3==t.type?m("div",{key:"list-item-audio_".concat(e),staticClass:"c-history-box c-history-box-audio"},[m("CAudio",{attrs:{audio:{url:t.url}}})],1):6==t.type?m("div",{key:"list-item-model_".concat(e),staticClass:"c-history-box c-history-box-model"},[m("history-model",{attrs:{message:t},on:{"view-model":function(e){return f.show3DModel(t)}}})],1):m("div",{key:"list-item-img_".concat(e),staticClass:"c-history-box c-history-box-img"},[m("history-img",{attrs:{src:t.url,nsfw:t.nsfw,width:t.width,height:t.height,"operate-number":e+1,"img-info":t,message:f.message},on:{updateImageInfo:f.updateImageInfo,deleteSingleImg:f.deleteSingleImg,saveSuccess:function(t){f.alreadySave=!0}}})],1)]}))],2):f._e(),f._v(" "),[1,"1",2,"2",4,"4"].includes(f.message.status)?m("div",{staticClass:"message-process-container"},[[2,"2"].includes(f.message.status)&&f.computedPercentage(f.message)?m("div",{staticClass:"message-process-panel"},[m("el-progress",{attrs:{percentage:f.computedPercentage(f.message),color:f.customColor,"show-text":!1,"stroke-width":7}})],1):f._e(),f._v(" "),m("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(f.message.status)?[m("div",{staticClass:"process-operate-box-wrap"},[m("span",{staticClass:"process-operate-box-text"},[f._v(f._s(f.$t("TaskStatusWaitingToStart"))+" "),m("span",{staticClass:"message-process-loading-span"})]),f._v(" "),m("div",{staticClass:"process-operate-box-wrap-quick"},[m("QuickQueue",{attrs:{quickOptions:f.message,quickStyle:{height:"26px",fontSize:"12px"}}})],1)])]:[2,"2"].includes(f.message.status)&&!f.computedPercentage(f.message)?[m("span",{staticClass:"process-operate-box-text"},[f._v(f._s(f.$t("TaskStatusPreparing"))+" "),m("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(f.message.status)?m("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[f._v("\n        "+f._s(f.convertStatusText)+"\n        "),["sysCancelDesc","sysTimeoutDesc"].includes(f.message.status_desc)?m("el-tooltip",{attrs:{placement:"top",content:f.$t("TaskErrorTip")}},[m("i",{staticClass:"iconfont icon-icon-xinxi task-info-icon system-error-icon",on:{click:function(t){return f.handleError(f.message)}}})]):f._e()],1):m("span",{staticClass:"process-operate-box-text"},[f._v(f._s(f.$t("youHaveCompleted"))),m("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[f._v(f._s(f.computedPercentage(f.message))+"%")]),f._v(" "),m("span",{staticClass:"message-process-loading-span"})]),f._v(" "),[1,2,"1","2"].includes(f.message.status)?m("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:f.$t("canceTaskNum",{num:3}),placement:"top-start"}},[m("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:f.isLoading},attrs:{type:"danger",size:"mini"},on:{click:function(t){return f.$emit("cancelTask",f.message)}}},[f._v("\n          "+f._s(f.isLoading?"Canceling…":f.$t("Cancel"))+"\n        ")])],1):f._e()],2)]):f._e(),f._v(" "),m("ModelViewer",{ref:"modelViewer",on:{handleOperation:f.handleModelOperation}}),f._v(" "),m("ErrorDialog",{attrs:{visible:f.errorDialogVisible,"error-type":f.errorType,"error-message":f.errorMessage},on:{"update:visible":function(t){f.errorDialogVisible=t},close:function(t){f.errorDialogVisible=!1}}})],1)}),[],!1,null,"4d8bb57e",null)),$t=It.exports;installComponents(It,{CFile:n(424).default,CText:n(425).default,CAudio:n(289).default,QuickQueue:n(119).default,ErrorDialog:n(1288).default});var jt=n(460),Lt=n(57),Mt=n(25),Et=n(302);function Ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ft(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Nt={name:"historyPage",inject:["top"],props:["showHistoryModal","isFreeCreate"],data:function(){return{viewMode:"list",list:[],loading:!1,queryParams:{limit:10},hasMore:!0,showScroll:!0,debounceHandleScroll:function(){},dialogVisible:!1,viewImageList:[],activeCard:null,currentImageIndex:0,hasEmittedHistoryModalShow:!1}},mixins:[jt.a],computed:At(At({},Object(d.c)("user",["isLoggedIn"])),{},{getCardImageList:function(){return function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){return[0,1,"0","1"].includes(t.type)}))}},showNoMore:function(){return!this.loading&&!this.hasMore&&this.list.length>0},renderCardList:function(){return this.list.filter((function(t){var e;return[3,"3"].includes(t.status)&&(null==t||null===(e=t.components)||void 0===e?void 0:e.length)}))}}),components:{historyItem:$t,taskImageViewer:Et.default,historyImg:gt},mounted:function(){this.initScrollBar(),this.debounceHandleScroll=Object(Mt.debounce)(this.handleScroll,600),null!=this&&this.isLoggedIn&&this.getList()},destroyed:function(){this.debounceHandleScroll=null},methods:{handleUpdateTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("updateTask",t)},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},viewBigImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.activeCard=t,this.viewImageList=[e],this.dialogVisible=!0},closeViewBigImage:function(){this.dialogVisible=!1,this.viewImageList=[],this.activeCard=null},deleteSingleImg:function(t,e){var n=this,o=e||{},r=o.id,l=void 0===r?"":r,c=o.components,d=(void 0===c?[]:c)[t-1].index,h=void 0===d?-1:d;Object(E.b)({id:l,index:h}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.list.forEach((function(t){var o;t&&(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(n.$set(t,"components",((null==t?void 0:t.components)||[]).filter((function(t){return t.index!==h}))),null!=t&&null!==(o=t.components)&&void 0!==o&&o.length||n.handleDeleteTask(null==t?void 0:t.id))}))}))},updateImageInfo:function(t,e,n,o){var r,l=this.list.find((function(e){return e.id===t})),c=null==l||null===(r=l.components)||void 0===r?void 0:r.find((function(t){return t.index===e}));this.$set(c,n,o)},insertDataToList:function(t){this.list.unshift(t)},handleRetry:function(t){this.$emit("retry",t)},handleDeleteTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.list.findIndex((function(e){return e.id===t}));-1!==e&&this.list.splice(e,1)},changeViewMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.doLogEvent(e),this.scrollToTop("instant"),this.viewMode=t},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleRefresh:function(){this.list=[],this.hasMore=!0,this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={limit:20,scene:2};["",null,void 0].includes(e)||(n.time_from=e),this.loading=!0,Object(S.h)(n).then((function(e){var o=(null==e?void 0:e.data)||{},r=o.items,l=void 0===r?[]:r,c=o.has_more,d=void 0===c||c;if(t.hasMore=d,null!=n&&n.time_from){var h,v,f=Object(Lt.objectArrayDeduplicationMerge)(t.list,l||[]),m=null===(h=t.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(v=t.list).push.apply(v,Object(T.a)(f)),m&&f.length&&t.scrollToTop(m,"instant")}else t.list=Array.isArray(l)&&null!=l&&l.length?l:[],t.scrollToTop(0,"instant"),t.hasEmittedHistoryModalShow||(t.hasEmittedHistoryModalShow=!0,t.$emit("getHistoryModalShow",0!==t.list.length))})).finally((function(){t.loading=!1}))},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.create_at:"";this.getList(e)},handleCancelTask:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.$logEvent("log_actions",{operation:"click_cancel_task",behavior_info:"on_comfyui_page"});var o=e.id,r=void 0===o?"":o,l={action:5,task_id:r};this.handleUpdateCancelBtnStatus(r,!0),Object(V.operateTask)(l).then((function(e){var o=e||{},l=o.status,c=void 0===l?{}:l,d=o.data,data=void 0===d?{}:d,h=c.code,code=void 0===h?"":h;if(n&&n(),[1e4,"10000"].includes(code)){var v=(null==data?void 0:data.task_return)||{},f=v.sub_status,m=void 0===f?0:f,_=v.used,y=void 0===_?0:_,w=v.free_num,C=v.remain_num,k=v.hashrate,O=void 0===k?0:k,x=v.temp_hashrate,T=void 0===x?0:x;if(401==m)t.$message.success("".concat(t.$t("cancelJobSuccess"),", ").concat(t.$t("task_fail_free_cancle",{freeCount:w,remainCount:C})));else{var S=y||"",D="";y<=0&&O>0&&(S="".concat(O).concat(t.$t("coin"))),y<=0&&T>0&&(D="".concat(T).concat(t.$t("tempCoins"))),t.$message.success("".concat(t.$t("cancelJobSuccess"),", ").concat(t.$t("task_fail_cancle",{cost:S,unit:D})))}var P=t.list.findIndex((function(t){return t.id===r}));-1!==P&&t.list.splice(P,1)}else[1e4,"10000"].includes(code)||t.handleTaskError(code)})).finally((function(){t.handleUpdateCancelBtnStatus(r,!1)}))},handleTaskError:function(code){var t={70045:this.$t("HttpErrorCode_70045")};code&&t[code]?this.$message.warning(t[code]):this.$message.error(this.$t("ServerError"))},handleUpdateCancelBtnStatus:function(t,e){var n=this;this.list.forEach((function(o){o.id===t&&n.$set(o,"isLoading",e)}))}}},Rt=Nt,Bt=(n(4712),Object(m.a)(Rt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-workflow-history-modal"},[e("div",{staticClass:"workflow-history-modal__header"},[e("div",{staticClass:"workflow-history-modal__header-left"},[e("i",{staticClass:"iconfont icon-workflow_icon_list workflow-history-modal__header-icon",class:["list"===t.viewMode&&"header-icon-active"],on:{click:function(e){return e.stopPropagation(),t.changeViewMode("list","click_history_create_info")}}}),t._v(" "),e("i",{staticClass:"iconfont icon-workflow_icon_grid workflow-history-modal__header-icon",class:["grid"===t.viewMode&&"header-icon-active"],on:{click:function(e){return e.stopPropagation(),t.changeViewMode("grid","click_thumbnail_display")}}})]),t._v(" "),e("div",{staticClass:"workflow-history-modal__header-right"},[e("span",{staticClass:"workflow-history-modal__header-icon el-icon-refresh header-icon-active",on:{click:function(e){return e.stopPropagation(),t.handleRefresh()}}})])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"workflow-history-modal__content",class:["grid"===t.viewMode&&"card-flex-content"],on:{scroll:t.debounceHandleScroll}},["grid"===t.viewMode?[t._l(t.renderCardList,(function(n,i){return[t._l(t.getCardImageList(null==n?void 0:n.components),(function(o,r){return[e("history-img",{key:"card-image_".concat(i,"_").concat(r),staticClass:"history-image-card",attrs:{src:o.url,nsfw:o.nsfw,width:o.width,height:o.height,"operate-number":r+1,"img-info":o,message:n},on:{deleteSingleImg:t.deleteSingleImg,updateImageInfo:t.updateImageInfo}})]}))]}))]:t._e(),t._v(" "),"list"===t.viewMode?[t._l(t.list,(function(n){return[e("history-item",{key:n.id,attrs:{showHistoryModal:t.showHistoryModal,"is-free-create":t.isFreeCreate,message:n,viewMode:t.viewMode},on:{updateImageInfo:t.updateImageInfo,deleteTask:t.handleDeleteTask,retry:t.handleRetry,cancelTask:t.handleCancelTask,updateTask:t.handleUpdateTask}})]}))]:t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showNoMore,expression:"showNoMore"}],staticClass:"workflow-history-modal-no-more"},[t._v(t._s(t.$t("workFlow35")))])],2),t._v(" "),t.dialogVisible?e("task-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!1,message:t.activeCard,"url-list":t.viewImageList}}):t._e()],1)}),[],!1,null,"00aa9fca",null).exports),Ut=n(3198),Vt=n(908),Wt=n(366);function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Gt={name:"PublishModal",data:function(){return{dialogVisible:!1,id:""}},mounted:function(){},computed:Ht(Ht({},Object(d.e)("user",["cdnHost"])),{},{workflowPreview:function(){return"https://".concat(this.cdnHost,"/static/upload/20250624/0d98da62-4765-4caa-ab78-35dc4f81bf40.png")},appPreview:function(){return"https://".concat(this.cdnHost,"/static/upload/20250624/2383812b-b1ff-43df-8d20-4e40185e30b4.png")}}),methods:{handleOpen:function(t){this.dialogVisible=!0,this.id=t},handleClose:function(){this.dialogVisible=!1,this.id=""},goTutorial:function(){window.open("https://docs.seaart.ai/seaart-comfyui-wiki/how-to-publish-as-an-ai-app","_blank")},handlePublish:function(t){var path="/workflow/publish";"aiapp"===t&&(path="/aiapp/publish"),this.$logEvent("log_actions",{operation:"aiapp"===t?"click_publish_ai_app":"click_publish_workflow",behavior_info:"on_comfyui_project_editing_page"}),window.open(this.localePath("".concat(path,"/").concat(this.id)),"_blank"),this.handleClose()}}},zt=(n(4721),Object(m.a)(Gt,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,"show-close":!0,"custom-class":"publish-modal"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[e("div",{staticClass:"modal-header flex-center"},[e("h2",{staticClass:"modal-title"},[t._v(t._s(t.$t("WorkflowPublishDialog1")))]),t._v(" "),e("el-button",{staticClass:"close-btn",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})])],1),t._v(" "),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"content-section workflow-section"},[e("div",{staticClass:"preview-box-workflow"},[e("img",{staticClass:"preview-image",attrs:{src:t.workflowPreview,alt:"Workflow preview"}})]),t._v(" "),e("h3",{staticClass:"section-title"},[t._v(t._s(t.$t("WorkFlow")))]),t._v(" "),e("p",{staticClass:"section-desc"},[t._v(t._s(t.$t("comfyui_publish_text1")))]),t._v(" "),e("p",{staticClass:"reward-text"},[e("span",[t._v(t._s(t.$t("comfyui_publish_guide_text8")))])]),t._v(" "),e("el-button",{staticClass:"action-btn workflow-btn",attrs:{type:"default","data-event":"publish_popup_publish_workflow_button","data-desc":"comfyui_workflow"},on:{click:function(e){return t.handlePublish("workflow")}}},[t._v("\n        "+t._s(t.$t("PublishWorkflow"))+"\n      ")]),t._v(" "),e("div",{staticClass:"tutorial-link",attrs:{"data-event":"publish_popup_view_tutorial_button","data-desc":"comfyui_workflow"},on:{click:t.goTutorial}},[t._v("\n        "+t._s(t.$t("ViewTutorial"))+"\n      ")])],1),t._v(" "),e("div",{staticClass:"content-section ai-section"},[e("div",{staticClass:"preview-box-workflow"},[e("img",{staticClass:"preview-image",attrs:{src:t.appPreview,alt:"Workflow preview"}})]),t._v(" "),e("h3",{staticClass:"section-title"},[t._v(t._s(t.$t("aiapp")))]),t._v(" "),e("p",{staticClass:"section-desc"},[t._v("\n        "+t._s(t.$t("WorkflowPublishDialog3"))+"\n      ")]),t._v(" "),e("p",{staticClass:"reward-text"},[e("span",[t._v(t._s(t.$t("WorkflowPublishDialog4")))])]),t._v(" "),e("el-button",{staticClass:"action-btn app-btn",attrs:{type:"default"},on:{click:function(e){return t.handlePublish("aiapp")}}},[t._v("\n        "+t._s(t.$t("PublishAiApp"))+"\n      ")]),t._v(" "),e("div",{staticClass:"tutorial-link",on:{click:t.goTutorial}},[t._v("\n        "+t._s(t.$t("ViewTutorial"))+"\n      ")])],1)])])}),[],!1,null,"1bf306f8",null).exports),Yt=n(51),Jt=n(181),Kt=n(3182),Qt=n(4722),Xt=n(213),Zt=n(121),te=n.n(Zt);function ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ee(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ne={name:"createWorkflowModal",data:function(){return{visible:!1,list:[],hasMore:!0,loading:!1,debounceHandleScroll:null,showScroll:!0,activeId:"",nowTime:new Date,retryCount:0,templateData:"",templateFileLoading:!1,activeTab:"",checked:!1,tabList:[],shouldShow:!0}},computed:ie(ie({},Object(d.e)("user",["userInfo"])),{},{formatDate:function(t){var e=this;return function(t){if(!t)return"";var n=new Date(t),o=e.nowTime.getTime()-n.getTime(),r=Math.floor(o/1e3),l=Math.floor(o/6e4),c=Math.floor(o/36e5),d=Math.floor(o/864e5);return r<60?e.$t("workFlow9",{num:r}):l<60?e.$t("workFlow6",{num:l}):c<24?e.$t("workFlow7",{num:c}):e.$t("workFlow8",{num:d})}},setList:function(){var t=this;try{return this.list.find((function(e){return e.class===t.activeTab})).items}catch(t){return[]}}}),mounted:function(){var t=this;this.interval=setInterval((function(){t.$set(t,"nowTime",new Date)}),6e4),this.initScrollBar(),this.debounceHandleScroll=Object(Mt.debounce)(this.handleScroll,600),this.initCheckedStatus()},beforeDestroy:function(){this.interval&&clearInterval(this.interval),this.debounceHandleScroll=null},methods:{getTagList:function(t){var e=this;Object(S.k)().then((function(n){var o,r,l;1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)&&(e.tabList=(null==n||null===(r=n.data)||void 0===r?void 0:r.classes)||[],e.activeTab=null===(l=e.tabList[0])||void 0===l?void 0:l.class,e.getList(t))}))},checkModalDisplayStatus:function(){return Object(r.a)(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,te.a.getItem("workflow_modal_no_show_14_days");case 3:if(e=t.sent,n=Date.now(),!e){t.next=14;break}if(!(e+12096e5>n)){t.next=11;break}return t.abrupt("return",{shouldShow:!1,checked:!0});case 11:return t.next=13,te.a.removeItem("workflow_modal_no_show_14_days");case 13:case 14:return t.abrupt("return",{shouldShow:!0,checked:!1});case 17:return t.prev=17,t.t0=t.catch(0),t.abrupt("return",{shouldShow:!0,checked:!1});case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()},initCheckedStatus:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkModalDisplayStatus();case 2:n=e.sent,o=n.checked,t.checked=o;case 5:case"end":return e.stop()}}),e)})))()},handleCheckedChange:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.$xyLogEvent({front_operation:"click",event_name:"create_workflow_modal_add_checkbox",entity_type:"14天内不在展示-checkbox"}),n.prev=1,!t){n.next=7;break}return n.next=5,te.a.setItem("workflow_modal_no_show_14_days",Date.now());case 5:n.next=9;break;case 7:return n.next=9,te.a.removeItem("workflow_modal_no_show_14_days");case 9:n.next=13;break;case 11:n.prev=11,n.t0=n.catch(1);case 13:case"end":return n.stop()}}),n,null,[[1,11]])})))()},shouldShowModal:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkModalDisplayStatus();case 2:return n=e.sent,o=n.shouldShow,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))()},openModal:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t,!n.t0){n.next=5;break}return n.next=4,e.shouldShowModal();case 4:n.t0=n.sent;case 5:if(e.shouldShow=n.t0,e.resetData(),!t||e.shouldShow){n.next=9;break}return n.abrupt("return");case 9:e.getTagList(t),t||(e.visible=!0);case 11:case"end":return n.stop()}}),n)})))()},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$emit("command",t,!0)},applyTemplate:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(o=(t.length>0&&void 0!==t[0]?t[0]:{})||{}).file_url,l=void 0===r?"":r,c=o.name,d=void 0===c?"":c,e.templateData="",e.templateFileLoading=!0,n.next=6,e.loadJsonFile(l);case 6:e.templateFileLoading=!1,e.templateData&&e.$emit("applyTemplate",e.templateData,d);case 8:case"end":return n.stop()}}),n)})))()},loadJsonFile:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:"",n.next=3,te.a.getItem(o);case 3:if(!(l=n.sent)){n.next=8;break}return e.templateData=l||{},e.templateFileLoading=!1,n.abrupt("return");case 8:return n.abrupt("return",fetch(o).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.templateData=data||{},!e.templateData){t.next=4;break}return t.next=4,te.a.setItem(o,e.templateData);case 4:e.templateFileLoading=!1;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){0===e.retryCount?(e.loadJsonFile(o),e.retryCount++):e.$message.error(e.$t("ServerError"))})));case 9:case"end":return n.stop()}}),n)})))()},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.activeId=t},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},resetData:function(){this.list=[],this.loading=!1,this.hasMore=!0,this.activeId="",this.retryCount=0,this.templateData="",this.templateFileLoading=!1},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(n,o){var r,l=null===(r=t.tabList)||void 0===r?void 0:r.map((function(t){return t.class}));t.loading=!0,Object(S.j)({category:l}).then((function(n){var o=(null==n?void 0:n.data)||{},r=o.categories,l=void 0===r?[]:r,c=o.has_more,d=void 0!==c&&c;t.hasMore=d,t.list=Array.isArray(l)&&null!=l&&l.length?l:[],t.scrollToTop(0,"instant"),e&&(t.visible=!0)})).finally((function(){t.loading=!1,n(!0)}))}))},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleClose:function(){this.visible=!1,this.$emit("closeWorkflowModal")},handleConfirm:function(){this.$emit("loadJson",this.activeId),this.handleClose()},handleDelete:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n&&(null==n?void 0:n.id)===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.workId)||this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){Object(S.c)({id:null==n?void 0:n.id}).then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var r=(e.list||[]).findIndex((function(t){return(null==t?void 0:t.id)===n.id}));e.list.splice(r,1),(null==n?void 0:n.id)===e.activeId&&(e.activeId=""),e.$emit("removeQuery",null==n?void 0:n.id)}}))})).catch((function(){}))}}},ae=ne,oe=(n(4723),Object(m.a)(ae,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"create-workflow-modal",attrs:{title:e.$t("workFlow45"),visible:e.visible,width:"1346px","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"create-template-box flex"},[n("div",{staticClass:"create-template-tab"},e._l(e.tabList,(function(t){return n("div",{key:t.class,staticClass:"create-template-tab-item",class:{active:e.activeTab===t.class},attrs:{"data-event":"create_workflow_modal_tab","data-type":t.class,"data-desc":"创建工作流模版tab"},on:{click:function(n){e.activeTab=t.class}}},[e._v("\n        "+e._s(t.class_name)+"\n      ")])})),0),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"create-template-list-box",on:{scroll:e.debounceHandleScroll}},[n("div",{staticClass:"create-template-list-add-box flex_lr"},[n("div",{staticClass:"reate-template-list-add-box-left flex"},[n("div",{staticClass:"create-template-list-item-add flex_m",attrs:{"data-event":"create_workflow_modal_add_local_file","data-desc":"从本地文件-添加"},on:{click:function(t){return t.stopPropagation(),e.handleClick("createByLocalFile")}}},[n("div",{staticClass:"list-item-title-icon iconfont icon-shangchuanchanpin"}),e._v(" "),n("div",{staticClass:"list-item-title"},[e._v(e._s(e.$t("workFlow19")))])]),e._v(" "),n("div",{staticClass:"create-template-list-item-add flex_m",attrs:{"data-event":"create_workflow_modal_add","data-desc":"创建工作流模版-添加"},on:{click:function(t){return t.stopPropagation(),e.handleClick("createByEmpty")}}},[n("div",{staticClass:"list-item-title-icon iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"list-item-title"},[e._v(e._s(e.$t("workFlow16")))])])]),e._v(" "),e.shouldShow?n("div",{staticClass:"create-template-list-add-box-right flex_m"},[n("el-checkbox",{on:{change:e.handleCheckedChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._v(" "),n("div",{staticClass:"create-template-list-add-box-right-text"},[e._v(e._s(e.$t("no_show_14_days")))]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("no_show_14_days_tip"),placement:"top"}},[n("i",{staticClass:"iconfont icon-help-icon"})])],1):e._e()]),e._v(" "),n("div",{staticClass:"create-template-list",style:{gap:(null===(t=e.setList)||void 0===t?void 0:t.length)>10?"14px":"16px"}},e._l(e.setList,(function(t,o){return n("div",{key:e.activeTab+"-"+o,staticClass:"create-template-list-item",attrs:{"data-event":"create_workflow_modal_list_item","data-desc":t.name},on:{click:function(n){return n.stopPropagation(),e.applyTemplate(t)}}},[t.cover?n("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"create-template-list-item-image-wrapper"},[n("img",{staticClass:"create-template-list-item-image",attrs:{"data-src":t.cover,loading:"lazy",decoding:"async",alt:t.name}})]):e._e(),e._v(" "),n("div",{staticClass:"list-item-bottom"},[n("div",{staticClass:"list-item-bottom-title overflow-ellipsis"},[e._v(e._s(t.name))]),e._v(" "),n("div",{staticClass:"node-num-title"},[e._v(e._s(t.intro))])])])})),0)])])])}),[],!1,null,null,null).exports),se=n(239),re=n(52),le=n(71),ce=(n(378),n(251)),de=n(56),ue=n(36),pe=n(63),he=n(45),ve=n(138),fe=n(253);function me(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?me(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _e={mixins:[he.a],components:{CollectPopover:pe.default,modelPayNum:ve.default,changeVer:fe.default,SwipeableList:re.default,LenovoInput:se.default,FlagItem:ce.default},props:{currentActiveTab:{type:String,default:"model"},isSearch:{type:Boolean,default:!1},gridNum:{type:Number,default:6},baseModels:{type:Array,default:H.b},comfyUiBaseModels:{type:Array,default:H.b},selectList:{type:Array,default:function(){return[]}},inTask:{type:Boolean,default:!0}},data:function(){return Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({formatNumberForeign:D.p,baseModelSelect:[],timeInit:[{name:"All",name2:"click_All_filter",startTime:null,endTime:null},{name:"days",name2:"click_days_filter",startTime:Object(D.B)().startTimestamp,endTime:Object(D.B)().endTimestamp},{name:"week",name2:"click_week_filter",startTime:Object(D.C)().startTimestamp,endTime:Object(D.C)().endTimestamp},{name:"months",name2:"click_months_filter",startTime:Object(D.A)().startTimestamp,endTime:Object(D.A)().endTimestamp}],typeOption:[{name:"Hot",id:"hot",value:3,icon:"hot"},{name:"New",id:"new",value:4,icon:"new1"}],tagIndex:"hot",modelType:"LORA",timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:this.getTimestamps().startTimestamp,endTime:this.getTimestamps().endTimestamp},{name:"week",startTime:this.getWeekTimeRange().startTimestamp,endTime:this.getWeekTimeRange().endTimestamp},{name:"months",startTime:this.getMonthTimestampRange().startTimestamp,endTime:this.getMonthTimestampRange().endTimestamp}],queryParam:{order_by:"hot",keyword:"",created:""},activeTab:"recommend",list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,limit:60,total:0},comfyUiNode:null},"baseModelSelect",[]),"tabShowTagEmpty",!1),"showTagEmpty",!1),"keyWordCopy","")},computed:ge(ge(ge(ge({},Object(d.e)("user",["collectData","cdnHost","token"])),Object(d.c)("user",["userInfo"])),{},{showEmptyResult:function(){var t=!this.loading,e=!this.list.length&&!this.hotRecentUsedList.length,n="recommend"===this.activeTab;return t&&e&&n},setTypeOption:function(){return"recommend"!==this.activeTab?this.typeOption.filter((function(t){return"hot"===t.id||"new"===t.id})):this.typeOption},getBaseModels:function(){return"model"===this.currentActiveTab&&"recommend"===this.activeTab&&""===this.queryParam.keyword?this.baseModels.filter((function(t){return!["SeaArt Film","Illustrious 3.5"].includes(t)})):this.comfyUiBaseModels},getModels:function(){var t=H.L.sd,e=H.L.sd3,n=H.L.sd35,o=H.L.sdxl,r=H.L.flux;return{sd:t,sd35:n,sd3:e,sdxl:o,allBaseModels:[].concat(Object(T.a)(t),Object(T.a)(e),Object(T.a)(n),Object(T.a)(o),Object(T.a)(r))}},setIcon:function(){var t=this;try{var e=this.typeOption.find((function(e){return t.tagIndex==e.id}));return e.icon||e}catch(t){return"homeIcon1"}},dataInfo:function(){var t=this;return function(e,n){return{id:e.id,type:e.obj_type,pt:e.pt,cindex:n,mIndex:"",search_keyword:t.queryParam.keyword,search_scene:"create_flow_model_".concat(t.modelType),position:"popup,".concat(t.activeTab,",").concat(t.currentActiveTab,",").concat(t.modelType,",,,瀑布流,,").concat(n)}}},isNoRecentUsed:function(){return!this.loading&&!this.list.length&&"recent"===this.currentActiveTab},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")}},Object(d.c)(["isSupportWebp"])),{},{getImageUrl:function(){return function(t){var e="";return t.banner&&!["",null,void 0].includes(t.banner.url)?e=Object(D.K)(t.banner.url,this.$imgL):e}},activeSelectModel:function(){return function(t){return this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}))?"select-model-active":""}},convertModelFlag:function(){var t=this;return function(e){if("model"===t.currentActiveTab&&"recommend"===t.activeTab)return t.getModelType(e);var n=t.getModels.sdxl,o=t.getModels.sd3,r=(null===H.L||void 0===H.L?void 0:H.L.flux)||[],l=(e.type,e.base_model),c=void 0===l?"":l,d=n.includes(c)||(c||"").includes("SDXL"),h=o.includes(c);return r.includes(c)?"Flux":h?"SD3":d?"SDXL":""}},getModelType:function(){var t=this;return function(e){var n=e.content_type,o=e.content_sub_type,r=e.type,l=void 0===r?"":r,c=e.base_model,d=void 0===c?"":c,h=(null==e?void 0:e.art_model)||{},v=h.type,f=void 0===v?"":v,m=h.base_model,_=n||l||f,y=o||d||(void 0===m?"":m),w={LORA:"LoRA",LoCon:"LyCORIS",TextualInversion:t.$t("embedding1")}[_]||_,C=(null===H.L||void 0===H.L?void 0:H.L.flux)||[],k="Pony"===y,O=y;return"Illustrious"===y?w+" | IL ":"NoobAI"===y?w+" | NAI ":y.includes("SDXL")&&!k?w+" | XL ":"HiDream"===y?w+" | HID ":"SeaArt Film"===y?w+" | SAF ":C.includes(O)?w+" | F1 ":w}}}),watch:{currentActiveTab:{handler:function(){this.activeTab="recommend",this.queryParam.keyword="",this.checkGetList()}},hotRecentUsedList:{handler:function(t){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.hotRecentUsedList[i].id&&this.selectList[e].art_model_ver_no_name&&this.hotRecentUsedList[i].version_name){this.hotRecentUsedList[i].version_name=this.selectList[e].art_model_ver_no_name,this.hotRecentUsedList[i].banner.url=this.selectList[e].model_cover;break}}},list:{handler:function(t){for(var i=0;i<this.list.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.list[i].id&&this.selectList[e].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[e].art_model_ver_no_name,this.list[i].banner.url=this.selectList[e].model_cover;break}}}},methods:{handleClickCollect:function(t){this.setCollect(t,"model")},onFilter:function(t,e){var n=this;this.loading||(this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"===this.activeTab&&(this.tagIndex="hot"),this.checkGetList())},onFilterReset:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.baseModelSelect=[],t||this.checkGetList())},changeQueryType:function(){this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:""},this.checkGetList()},checkGetList:function(){"recent"===this.currentActiveTab?this.handleGetRecentUsed():this.handleSearch(this.queryParam.keyword)},handleCommand:function(t){this.tagIndex=t,this.queryParam.order_by=this.tagIndex,this.handleSearch(this.queryParam.keyword)},handleTimeCommand:function(t){this.timeName=t.name,"All"!==this.timeName&&"hot"===this.tagIndex&&"recommend"===this.activeTab?this.queryParam.order_by="".concat({months:"month",days:"day",week:"week",All:""}[this.timeName],"_").concat(this.tagIndex):(this.queryParam.order_by=this.tagIndex,this.queryParam.start_at=t.startTime,this.queryParam.end_at=t.endTime),this.handleSearch(this.queryParam.keyword)},getTimestamps:function(){var t=new Date;return{startTimestamp:t-864e5,endTimestamp:t.getTime()}},getWeekTimeRange:function(){var t=new Date;return{startTimestamp:t-6048e5,endTimestamp:t.getTime()}},getMonthTimestampRange:function(){var t=new Date;t.getFullYear(),t.getMonth();return{startTimestamp:t-2592e6,endTimestamp:t.getTime()}},selectItem:function(t,e,n){var o,r,l;(null!=e&&e.child&&e.child.length>0&&(e.child[0].title=t.version_no),this.$set(e,"model_ver_no",t.model_ver_id),this.$set(e,"version_name",t.version_no),this.$set(e,"base_model",t.base_model_name),e.modelTags=Array.isArray(null==t?void 0:t.tags)?null==t?void 0:t.tags:[],null!==(o=t.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?(e&&e.banner&&(e.banner.url=null===(r=t.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url),e&&e.cover&&(e.cover.url=null===(l=t.sample)||void 0===l||null===(l=l.banner)||void 0===l?void 0:l.url)):(e&&e.banner&&(e.banner.url=""),e&&e.cover&&(e.cover.url=""));n&&this.$emit("selectModel",e)},initData:function(t){var e=t.modelType,n=void 0===e?"LORA":e;this.resetData(),this.activeTab="recommend",this.modelType=n,this.getList()},resetData:function(){this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:""},this.list=[],this.loading=!1,this.noMore=!1},handleTabClick:function(t){this.activeTab=t,this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:""},this.onFilterReset()},parentReset:function(){this.tagIndex="hot",this.timeName="All",this.$emit("parentReset")},screenAll:function(){this.baseModelSelect=[],this.modelTypeSelect=[],this.queryParam.order_by="hot",this.queryParam.created="",this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.parentReset(),this.handleSearch()},handleSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.list=[],this.hotRecentUsedList=[],this.queryParam.keyword=t,Reflect.deleteProperty(this.queryParam,"time_to"),"recommend"===this.activeTab&&""!==this.queryParam.keyword&&(this.queryParam.order_by="hot"),this.getList()},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n={collect:"bookmarks",model:"community",bookmarks_choose:"bookmarks_choose"}[JSON.parse(JSON.stringify(this.currentActiveTab))]||"",o={page:this.pageInfo.page,page_size:this.pageInfo.limit,type:n};if(this.inTask&&(o.refer="task"),"bookmarks"===o.type){var r=0;try{var l,c=this.list.length?this.list[this.list.length-1]:null;r=(null==c||null===(l=c.collect)||void 0===l?void 0:l.collect_at)||0,o.after=1===o.page?0:r}catch(t){}}["recommend"].includes(this.activeTab)||"model"!==this.currentActiveTab||(o.tags=[this.activeTab],o.type="community"),"recommend"===this.activeTab&&"model"===this.currentActiveTab&&""===this.queryParam.keyword?(o.with_ver_info=1,o.scene="comfyui",delete o.type,o.model_types=[this.modelType]):o.model_type=this.modelType;var d="recommend"===this.activeTab&&"model"===this.currentActiveTab,h=""!==this.queryParam.keyword;o.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModels,Object.assign(o,this.queryParam),(h?de.q:d?ue.getWaterfallModel:de.s)(o).then((function(n){var o=n||{},r=o.status,l=void 0===r?{}:r,c=o.data,data=void 0===c?{}:c,d=l.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(e.noMore=!data.has_more,t){var h=e.list.map((function(t){return t.id})),v=(n.data.items||[]).filter((function(t){return!h.includes(t.id)})).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));e.list=e.list.concat(v)}else e.list=(n.data.items||[]).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));1===e.pageInfo.page&&(e.queryParam.time_to=n.data.time_ms),e.pageInfo.page++,e.loading=!1,e.keyWordCopy=e.queryParam.keyword,e.noDataView()}})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))}},noDataView:function(){var t=!this.loading,e=!this.list.length,n="recommend"!==this.activeTab,o=""===this.queryParam.keyword,r=t&&e&&n&&o,l=t&&e&&n&&!o;this.tabShowTagEmpty=r,this.showTagEmpty=l},findSelectItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(t)){var e=this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}));return t=e||t}return null},handleSelect:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(["cltpop","use"].includes(null===(t=(arguments.length>2?arguments[2]:void 0).target)||void 0===t?void 0:t.className)){if(n)return void this.$message.warning(this.$t("CannotSelectedRepeatedly"));this.$emit("selectModel",e),this.resetData()}},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getRecentUsedModel()},getRecentUsedModel:function(){var t=this,e={};return e.base_models=this.baseModelSelect.length?this.baseModelSelect:this.comfyUiBaseModels,"TextualInversion"===this.modelType&&(e.model_type="TextualInversion"),this.loading=!0,Object(V.getRecentUsed)(e).then((function(e){var n=e||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var l=Array.isArray(data.items)?data.items:[],c={};t.list=(l||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return c[e.id]||(c[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType&&"f8172af6747ec762bcf847bd60fdf7cd"!==(null==e?void 0:e.id)})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},handleDetail:function(t){(null==t?void 0:t.id)&&window.open(this.localePath("/models/detail/".concat(t.id)),"_blank")},otherUser:function(t){var e,n,path="/user/"+encodeURIComponent(null==t||null===(e=t.author)||void 0===e?void 0:e.id);this.userInfo.id===(null==t||null===(n=t.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")}}},ye=_e,be=(n(4724),Object(m.a)(ye,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"square"},[o("div",{staticClass:"style-content__search-box"},[o("div",{directives:[{name:"show",rawName:"v-show",value:"model"===n.currentActiveTab&&"recommend"===n.activeTab&&!n.isSearch,expression:"currentActiveTab === 'model' && activeTab === 'recommend' && !isSearch"}],staticClass:"square-header-title"},[n._v("\n      "+n._s(n.$t("square"))+"\n    ")]),n._v(" "),o("div",{staticClass:"search-right",class:{"search-right-recommend":"model"!==n.currentActiveTab}},[o("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[o("div",{staticClass:"filterCnt"},[o("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[n._v(n._s(n.$t("BaseModel")))]),n._v(" "),o("div",{staticClass:"filterList"},n._l(n.getBaseModels,(function(t,e){return o("div",{key:e,staticClass:"filterItem",class:{AfilterItem:n.baseModelSelect.includes(t)},on:{click:function(e){return n.onFilter(t,2)}}},[n.baseModelSelect.includes(t)?o("i",{staticClass:"el-icon-check"}):n._e(),n._v(" "),o("span",[n._v(n._s("TextualInversion"===t?n.$t("embedding1"):t))])])})),0),n._v(" "),o("div",{staticClass:"filterReset graBorder",on:{click:function(t){return n.onFilterReset(!1)}}},[n._v("\n            "+n._s(n.$t("resetSelection"))+"\n          ")])]),n._v(" "),o("el-badge",{staticClass:"item",attrs:{slot:"reference",value:null===(t=n.baseModelSelect)||void 0===t?void 0:t.length,hidden:0==(null===(e=n.baseModelSelect)||void 0===e?void 0:e.length)},slot:"reference"},[o("div",{staticClass:"filterBox"},[o("div",[o("i",{staticClass:"iconfont icon-a-filterIcon"}),n._v(" "),o("span",[n._v(n._s(n.$t("Filter")))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})])])],1),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"model"===n.currentActiveTab&&!n.isSearch,expression:"currentActiveTab === 'model' && !isSearch"}],staticClass:"Screening"},[o("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"hot"===n.tagIndex,expression:"tagIndex === 'hot'"}],attrs:{trigger:"hover"},on:{command:n.handleTimeCommand}},[o("div",{staticClass:"el-dropdown-link selectTime"},[o("div",[o("i",{staticClass:"el-icon-time"}),n._v(" "),o("span",[n._v(n._s(n.$t(n.timeName)))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{staticClass:"custom-dropdown custom-dropdown-fcc",attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.timeTypeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t}},[o("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1),n._v(" "),o("el-dropdown",{attrs:{trigger:"hover"},on:{command:n.handleCommand}},[o("div",{staticClass:"el-dropdown-link"},[o("div",[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(n.setIcon)}),n._v(" "),o("span",[n._v(n._s(n.$t(n.tagIndex.charAt(0).toUpperCase()+n.tagIndex.slice(1))))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{staticClass:"custom-dropdown custom-dropdown-fcc",attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.setTypeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t.id}},[o("div",{staticClass:"el-dropdown-item"},[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),n._v(" "),o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1)],1)],1)]),n._v(" "),o("div",{staticClass:"square-square-list",style:{gridTemplateColumns:"repeat(".concat(n.gridNum,", 1fr)"),minHeight:n.list.length?"40vh":"15vh"}},[n.list.length?n._l(n.list,(function(t,e){var r,l,c,d,h,v,f,m,_,y,w,C,k,O,x;return o("div",{key:t.id,staticClass:"style-content__list-item",class:[n.activeSelectModel(t)],style:{height:5===n.gridNum?"340px":"280px"},attrs:{"data-event":"comfyui-".concat(n.modelType,"-model-popup-list-item"),"data-type":n.modelType,"data-id":null==t?void 0:t.id,"data-index":e,"data-position":"popup,".concat(n.activeTab,",").concat(n.modelType,",,,瀑布流,,").concat(e),"data-desc":"comfyui模型选择列表项点击","data-info":JSON.stringify(n.dataInfo(t,e))},on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[o("div",{staticClass:"top-box"},[t.is_agency_fee?o("div",{staticClass:"payNum"},[o("modelPayNum",{attrs:{number:t.agency_fee}})],1):n._e()]),n._v(" "),o("div",{staticClass:"cltpop"},[o("div",{staticClass:"collect-popover-container"},[o("CollectPopover",{attrs:{type:"model",folder:t,from:"waterfall"}})],1),n._v(" "),o("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),n.handleDetail(t)}}},[n._v("\n            "+n._s(n.$t("Details"))+"\n          ")])]),n._v(" "),o("div",{staticClass:"list-item-image-wrapper",style:{height:5===n.gridNum?"300px":"240px"}},[["",null,void 0].includes(null==t||null===(r=t.banner)||void 0===r?void 0:r.url)&&["",null,void 0].includes(null==t||null===(l=t.cover)||void 0===l?void 0:l.url)?o("div",{staticClass:"list-item-image-card-image"},[o("div",{staticClass:"image-empty"},[n._v(n._s(n.$t("EmptyBannerText")))])]):o("el-image",{staticClass:"list-item-image-card-image",attrs:{src:n.getImageUrl(t)}},[o("template",{slot:"error"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:"recommend"===n.activeTab?null===(c=t.cover)||void 0===c?void 0:c.url:null===(d=t.banner)||void 0===d?void 0:d.url,alt:""}})])],2)],1),n._v(" "),o("div",{staticClass:"info-handle-box"},[o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"top"}},[o("div",{staticClass:"tooltip-txt-fcc",attrs:{slot:"content"},slot:"content"},[n._v("\n              "+n._s((null==t?void 0:t.title)||(null==t||null===(h=t.art_model)||void 0===h?void 0:h.name)||(null==t?void 0:t.name)||"")+"\n            ")]),n._v(" "),o("div",{staticClass:"title"},[o("FlagItem",{directives:[{name:"show",rawName:"v-show",value:t.corner_mark,expression:"item.corner_mark"}],attrs:{type:t.corner_mark}}),n._v(" "),o("span",[n._v(n._s((null==t?void 0:t.title)||(null==t||null===(v=t.art_model)||void 0===v?void 0:v.name)||(null==t?void 0:t.name)))])],1)]),n._v(" "),o("div",{staticClass:"subTitle"},[n._v(n._s(t.sub_title))]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"recent"!==n.currentActiveTab,expression:"currentActiveTab !== 'recent'"}],staticClass:"user"},[o("div",{staticClass:"author-box",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.otherUser(t)}}},[null!=t&&null!==(f=t.author)&&void 0!==f&&f.head?o("div",{staticClass:"authorHead"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],attrs:{src:null==t||null===(m=t.author)||void 0===m?void 0:m.head,alt:"searArt.AI"}})]):o("div",{staticClass:"authorHead"},[n._v(n._s((null==t||null===(_=t.author)||void 0===_?void 0:_.name[0])||(null==t||null===(y=t.author)||void 0===y?void 0:y.id[0])))]),n._v(" "),o("div",{staticClass:"authorName overflow-ellipsis"},[n._v(n._s((null==t||null===(w=t.author)||void 0===w?void 0:w.name)||(null==t||null===(C=t.author)||void 0===C?void 0:C.id)))])]),n._v(" "),o("div",{staticClass:"num-box"},[o("div",{staticClass:"funItem"},[o("i",{staticClass:"iconfont icon-icon-play"}),n._v(" "),o("span",[n._v(n._s(n.formatNumberForeign((null===(k=t.stat)||void 0===k?void 0:k.num_of_task)||0)))])]),n._v(" "),o("div",{staticClass:"funItem",staticStyle:{margin:"0"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.handleClickCollect(t)}}},[o("i",{staticClass:"iconfont",class:n.setCollectData(t)}),n._v(" "),(null===(O=t.stat)||void 0===O?void 0:O.num_of_collection)>=0?o("span",[n._v("\n                  "+n._s(n.formatNumberForeign((null===(x=t.stat)||void 0===x?void 0:x.num_of_collection)||0))+"\n                ")]):n._e()])])])],1),n._v(" "),o("div",{staticClass:"bottom-box"},[o("changeVer",{attrs:{fontSize:"12",from:"styleModal",item:t,base_models:n.getBaseModels},on:{selectItem:function(e){return n.selectItem(e,t,n.activeSelectModel(t))}}}),n._v(" "),o("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[n._v("\n            "+n._s(n.$t("workFlow46"))+"\n          ")])],1),n._v(" "),"Pony"===(null==t?void 0:t.base_model)?[o("span",{staticClass:"model-type-flag"},[n._v("\n            "+n._s("TextualInversion"===n.modelType?n.$t("embedding1"):n.modelType)),o("span",{staticClass:"model-type-flag-line"},[n._v("|")]),o("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[o("span",{directives:[{name:"show",rawName:"v-show",value:""!==n.convertModelFlag(t),expression:"convertModelFlag(item) !== ''"}],staticClass:"model-type-flag"},[n._v(n._s(n.convertModelFlag(t)))])]],2)})):n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),"LORA"===n.modelType&&"recommend"===n.activeTab&&["recent"].includes(n.currentActiveTab)&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n        "+n._s(n.$t("styleRecent"))+"\n      ")]:"LORA"===n.modelType&&["collect"].includes(n.currentActiveTab)&&"recommend"===n.activeTab&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n        "+n._s(n.$t("styleCollect"))+"\n      ")]:[n._v(n._s(n.$t("NoResultsFound")))]],2),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showTagEmpty,expression:"showTagEmpty"}],staticClass:"tag-empty-box flex_c_m"},[o("div",{staticClass:"item flex_c"},[o("p",[n._v(n._s(n.$t("screenTagNodata",{keyword:n.keyWordCopy?' "'.concat(n.keyWordCopy,'" '):""})))]),n._v(" "),o("div",{staticClass:"btn",on:{click:n.screenAll}},[n._v(n._s(n.$t("screenAll")))])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.tabShowTagEmpty,expression:"tabShowTagEmpty"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),o("p",[n._v(n._s(n.$t("NoResultsFound")))])],1),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"loading-box"})],2)])}),[],!1,null,"937b0c82",null)),we=be.exports;installComponents(be,{CollectPopover:n(63).default,SvgIcon:n(115).default});var Ce=n(865),ke=n(863);function Oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Te={name:"NewWorkflowStyleModal",mixins:[n(145).a],provide:function(){return{CombinedSelectionDialog:this}},components:{SwiperList:re.default,LenovoInput:se.default,SquareList:we,HyVidepEffectsPop:Ce.default,ModelItemDes:ke.default},data:function(){return{visible:!1,comfyUiNode:null,pickWidget:"",itemScroll:null,modelType:"Checkpoint",modalWidth:"1326px",keyword:"",pageConfig:[{name:"Model",id:"model",showTab:!0,content_type:"model"},{name:"Collect",id:"collect",showTab:!0,content_type:"collect"},{name:"Mine",id:"bookmarks_choose",showTab:!0,content_type:"bookmarks_choose"},{name:"recentlyUsed",id:"recent",showTab:!0,content_type:"recent"}],currentActiveTab:"model",activeTab:"recommend",additionModelTypes:[{label:"LORA",value:"LORA"},{label:"DoRA",value:"DoRA"},{label:"LyCORIS",value:"LoCon"},{label:"embedding1",value:"TextualInversion"}],isSearch:!1,baseModels:[],comfyUiBaseModels:[],tabList:[{type:"recommend",id:"recommend",order:1,i18nKey:"Recommend"}],gridNum:6,modules:[],taskId:""}},computed:xe(xe({},Object(d.e)("user",["collectData","cdnHost","token"])),{},{setTabList:function(){return"model"===this.currentActiveTab?this.tabList:[{type:"model",id:"model",order:1,i18nKey:"Model"}]},dataInfo:function(){var t=this;return function(e,n){var o,r,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.event_name="comfyui-".concat(t.modelType,"-model-popup"),t.entity_type=t.modelType;var c=e.id,d=e.obj_type,h=e.pt,v=l?null===(o=t.modules)||void 0===o?void 0:o.findIndex((function(t){return t.id===l})):-1,f=l?null===(r=t.modules)||void 0===r?void 0:r[v]:{title:t.$t("mode"),id:"mode"},m=f.title,_=f.id,y=t.pageConfig.findIndex((function(e){return e.content_type===t.currentActiveTab}));return{id:c,type:d,pt:h,cindex:n,event_name:"comfyui-".concat(t.modelType,"-model-popup"),mIndex:v,search_keyword:t.keyword,position:"popup,".concat(t.taskId,",").concat("mode",",").concat(y,",").concat(_,",").concat(m,",").concat(v,",").concat(n,",").concat(t.currentActiveTab)}}},getSwiperListHeight:function(){var t=this;return function(e){return[13,"13"].includes(e.content_type)?"260px":null!=e&&e.elList&&2===(null==e?void 0:e.elList[0].obj_type)&&5===t.gridNum?"340px":"300px"}},convertTabText:function(){return function(t){var e="LORA"===this.modelType?"MyStyle":"MyModel";return t.title?t.title:"bookmarks_choose"===t.type?this.$t(e):this.$t(t.i18nKey)}}}),mounted:function(){var t=this;window.addEventListener("resize",this.handleResize),this.$nextTick((function(){t.handleResize()})),this.getTag(),this.getBaseModels(5),this.getBaseModels(7)},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:{openModal:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.modelType,r=void 0===o?"LORA":o,l=t.node,c=void 0===l?null:l,d=t.pickWidget,h=void 0===d?null:d,e.pickWidget=h,e.comfyUiNode=c,e.getPageConfig(r),e.visible=!0,e.modelType=r,e.$nextTick((function(){e.$refs.squareList.initData({modelType:r,node:c,pickWidget:h})}));case 7:case"end":return n.stop()}}),n)})))()},handleClickTopTab:function(t){"model"!==t.content_type?this.activeTab="model":this.activeTab="recommend",this.reset(),this.currentActiveTab=t.content_type,this.$refs.squareList.onFilterReset(!0)},reset:function(){this.keyword="",this.isSearch=!1},handleClose:function(){this.visible=!1,this.activeTab="recommend",this.currentActiveTab="model",this.reset(),this.$refs.squareList.resetData(),this.$cookies.get("lang")&&localStorage.setItem("lastLang",this.$cookies.get("lang"))},handleResize:Object(Mt.debounce)((function(){try{window.innerWidth>1400?(this.modalWidth="1326px",this.gridNum=6):(this.modalWidth="1110px",this.gridNum=5)}catch(t){}}),500),handleSearch:function(){this.isSearch=!!this.keyword,this.$refs.squareList.handleSearch(this.keyword)},getBaseModels:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;Object(le.a)({scene:e}).then((function(n){1e4===n.status.code&&(5===e?t.baseModels=n.data.base_model_select_options.map((function(t){return t.val})):t.comfyUiBaseModels=n.data.base_model_select_options.map((function(t){return t.val})))}))},getTag:function(){var t=this;Object(le.d)({show_area:"model"}).then((function(e){if(1e4===e.status.code){var n=e.data||[];n.length&&n.forEach((function(e){e.title=e[H.r[t.$i18n.locale]]})),t.tabList=[].concat(Object(T.a)(t.tabList),Object(T.a)(n))}}))},changeScroll:function(){var t=this;this.$refs.listItem.forEach((function(e,n){e.classList.contains("tab-active")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))},handleTabClick:function(t){var e=this;t!==this.activeTab&&(this.activeTab=t,this.reset(),this.$nextTick((function(){e.changeScroll()})),this.$refs.squareList.handleTabClick(t))},handleScroll:Object(Mt.debounce)((function(t){var e=t.target;if(e){var n=e.scrollHeight-(e.scrollTop+e.clientHeight);this.scrollTop=e.scrollTop,n<200&&!this.isLoading&&"recent"!==this.currentActiveTab&&this.$refs.squareList&&this.$refs.squareList.getList(!0)}}),200),selectModel:function(t){var e=JSON.parse(JSON.stringify(t));t.title&&(e.name=t.title),e.model_ver_no&&e.version_name||(e.model_ver_no=e.child[0].id,e.version_name=e.child[0].title),this.$emit("selectModel",{info:e,node:this.comfyUiNode,modelType:this.modelType,pickWidget:this.pickWidget}),this.handleClose()},getPageConfig:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,data,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.getPageConfigCache(),r=localStorage.getItem("lastLang")||null,l=e.$cookies.get("lang")||null,r&&(!r||r===l)&&null!==o){n.next=16;break}return n.prev=4,n.next=7,Object(ue.getComponentsConfigV2)({parent_id:"task",type:"page",with_ver_info:1});case 7:c=n.sent,d=c.status,data=c.data,1e4===(null==d?void 0:d.code)&&(h=null==data?void 0:data.items.find((function(e){return"LORA"===t?"loraImgModel"===e.content_type:"model"===e.content_type})),e.modules=null==h?void 0:h.modules,e.taskId=null==h?void 0:h.id,e.setPageConfigCache(null==data?void 0:data.items)),n.next=14;break;case 12:n.prev=12,n.t0=n.catch(4);case 14:n.next=19;break;case 16:v=o.find((function(e){return"LORA"===t?"loraImgModel"===e.content_type:"model"===e.content_type})),e.modules=null==v?void 0:v.modules,e.taskId=null==v?void 0:v.id;case 19:case"end":return n.stop()}}),n,null,[[4,12]])})))()},getPageConfigCache:function(){var t=localStorage.getItem("comfyuiTaskConfigCache");if(t){var e=JSON.parse(t);return Date.now()-e.timestamp>3e5?null:e.data}return null},setPageConfigCache:function(data){var t={data:data,timestamp:Date.now()};localStorage.setItem("comfyuiTaskConfigCache",JSON.stringify(t))}}},Se=Te,De=(n(4725),Object(m.a)(Se,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{ref:"styleModal",attrs:{visible:e.visible,width:e.modalWidth,height:"auto","custom-class":"easy-style-modal","modal-append-to-body":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,"append-to-body":"",center:""},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[n("template",{slot:"title"},[n("div",{staticClass:"easy-style-modal-header"},[n("div",{staticClass:"easy-style-modal-header-tabs"},[n("SwiperList",{attrs:{iconBntWidth:28,scrollChange:e.itemScroll,top:"0",listGap:"32px"}},e._l(e.pageConfig,(function(t,o){return n("div",{key:"top_tab_".concat(t.id,"_").concat(o),staticClass:"header-tabs-item",class:[e.currentActiveTab===(null==t?void 0:t.content_type)&&"header-tabs-item-active"],attrs:{"data-event":"comfyui-".concat(e.modelType,"-model-popup-top-tab"),"data-type":null==t?void 0:t.content_type,"data-id":null==t?void 0:t.id},on:{click:function(n){return n.stopPropagation(),e.handleClickTopTab(t)}}},[e._v("\n            "+e._s(e.$t(t.name)||(null==t?void 0:t.title))+"\n          ")])})),0)],1),e._v(" "),n("LenovoInput",{attrs:{width:400,screen:{activeTab:e.activeTab,baseModelSelect:"model"===e.currentActiveTab&&"recommend"===e.activeTab?e.baseModels:e.comfyUiBaseModels,modelType:e.modelType},isLoca:"creative",clearable:"",placeholder:"LORA"===e.modelType?e.$t("TaskStylePlaceHolder"):e.$t("TaskModelPlaceHolder")},on:{onScreen:function(t){return e.handleSearch()},clear:function(t){return e.handleSearch()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),n("div",{staticClass:"header-close-btn",on:{click:function(t){return t.stopPropagation(),function(){return e.handleClose("handle")}.apply(null,arguments)}}},[n("i",{staticClass:"el-icon-close"})])],1)]),e._v(" "),n("div",{ref:"wrapper",staticClass:"wrapper",on:{"&scroll":function(t){return e.handleScroll.apply(null,arguments)}}},[n("div",{staticClass:"wrapper-container"},[[n("SwiperList",{attrs:{iconBntWidth:28,scrollChange:e.itemScroll,top:"0"}},e._l(e.setTabList,(function(t,o){return n("div",{key:"tab_".concat(null==t?void 0:t.id,"_").concat(o)},[n("div",{ref:"listItem",refInFor:!0,staticClass:"wrapper-top-item",class:[t.id===e.activeTab?"tab-active":""],attrs:{"data-event":"comfyui-".concat(e.modelType,"-model-popup-tab"),"data-type":null==t?void 0:t.type,"data-id":null==t?void 0:t.id,"data-desc":"comfyui模型选择标签切换"},on:{click:function(n){return n.stopPropagation(),e.handleTabClick(t.id)}}},[e._v("\n              "+e._s(e.convertTabText(t))+"\n            ")])])})),0)],e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:(null===(t=e.modules)||void 0===t?void 0:t.length)&&"recommend"===e.activeTab&&!e.isSearch&&"TextualInversion"!=e.modelType,expression:"modules?.length && activeTab === 'recommend' && !isSearch && modelType != 'TextualInversion'"}],staticClass:"wrapper-container-1"},[e._l(e.modules,(function(t){return[n("div",{key:t.id,staticClass:"recommend-box"},[n("div",{staticClass:"recommend-header"},[n("div",[e._v("\n                "+e._s(t.title)+"\n              ")])]),e._v(" "),n("SwiperList",{attrs:{scrollChange:e.itemScroll,top:"0",bntTop:"-20px",iconBntWidth:28,height:e.getSwiperListHeight(t),listGap:"16px"}},[e._l(null==t?void 0:t.elList,(function(o,r){return[n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibility,expression:"handleVisibility"}],key:"ele_".concat(null==o?void 0:o.id,"_").concat(r),staticClass:"card-item",attrs:{"data-info":JSON.stringify(e.dataInfo(o,r,null==t?void 0:t.id))}},[[2===(null==o?void 0:o.obj_type)?n("ModelItemDes",{attrs:{logEventPosition:e.dataInfo(o,r,null==t?void 0:t.id).position,item:o,logData:e.dataInfo(o,r,null==t?void 0:t.id)},on:{handleItemSelect:function(t){return e.selectModel(t.obj)}}}):e._e()]],2)]}))],2)],1)]}))],2),e._v(" "),n("SquareList",{ref:"squareList",attrs:{isSearch:e.isSearch,currentActiveTab:e.currentActiveTab,gridNum:e.gridNum,baseModels:e.baseModels,comfyUiBaseModels:e.comfyUiBaseModels,modelType:e.modelType},on:{parentReset:e.reset,selectModel:e.selectModel}})],2)])],2)}),[],!1,null,"168c13d9",null)),Pe=De.exports;installComponents(De,{LenovoInput:n(239).default});var Ie=n(1288),$e={name:"ComfyuiLoading",props:{percentage:{type:Number,default:0}}},je=(n(4726),Object(m.a)($e,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"comfyui-loading"},[e("div",{staticClass:"comfyui-loading-box"},[e("img",{staticClass:"logo",attrs:{src:n(1056),alt:"comfyuiLoading"}}),t._v(" "),e("div",{staticClass:"flex_lr_m"},[e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-bar-inner",style:{width:t.percentage+"%"}}),t._v(" "),e("div",{staticClass:"progress-bar-glow"})]),t._v(" "),e("span",{staticClass:"progress-bar-text"},[t._v(t._s(t.percentage)+"%")])]),t._v(" "),e("div",{staticClass:"loading-text-container"},[e("div",{staticClass:"loading-text loading-text-1"},[t._v(t._s(t.$t("loading_text")))]),t._v(" "),e("div",{staticClass:"loading-text loading-text-2"},[t._v(t._s(t.$t("comfyui_publish_guide_text7")))])])])])}),[],!1,null,"26689e8f",null).exports),Le={name:"GuideModal",props:{showHistoryModal:{type:Boolean,default:!1}},data:function(){return{visible:!1}},methods:{openModal:function(){this.visible=!0},closeModal:function(){this.visible=!1},handleRelease:function(){this.$emit("command","publishWorkFlow")}}},Me=(n(4727),Object(m.a)(Le,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"guide-modal",style:{right:t.showHistoryModal?"430px":"30px"}},[e("svg-icon",{staticClass:"icon",attrs:{"icon-class":"groupComfyui"}}),t._v(" "),e("img",{staticClass:"congratulate-icon",attrs:{src:n(1049),alt:""}}),t._v(" "),e("div",{staticClass:"guide-modal-title"},[e("div",{staticClass:"title-text"},[t._v(t._s(t.$t("congratulations"))+"！")]),t._v(" "),e("div",{staticClass:"title-text"},[t._v(t._s(t.$t("comfyui_publish_guide_text1")))]),t._v(" "),e("div",{staticClass:"title-text-2"},[t._v(t._s(t.$t("comfyui_publish_guide_text2")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content"},[e("div",{staticClass:"guide-modal-content-item flex_lr_m"},[e("div",{staticClass:"guide-modal-content-item-title flex_m"},[e("i",{staticClass:"iconfont icon-icon-publish"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_publish_guide_text3")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content-item-text"},[t._v("50 "+t._s(t.$t("coin")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content-item flex_lr_m"},[e("div",{staticClass:"guide-modal-content-item-title flex_m"},[e("i",{staticClass:"iconfont icon-icon-workflow"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_publish_guide_text4")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content-item-text"},[t._v(t._s(t.$t("comfyui_publish_guide_text6")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content-item flex_lr_m"},[e("div",{staticClass:"guide-modal-content-item-title flex_m"},[e("i",{staticClass:"iconfont icon-icon-aiapp"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_publish_guide_text5")))])]),t._v(" "),e("div",{staticClass:"guide-modal-content-item-text"},[t._v(t._s(t.$t("comfyui_publish_guide_text6")))])])]),t._v(" "),e("div",{staticClass:"guide-modal-button",attrs:{"data-group":"first_complate_publish_guide_popup","data-event":"publish_button"},on:{click:t.handleRelease}},[t._v("\n    "+t._s(t.$t("releaseName"))+"\n  ")]),t._v(" "),e("div",{staticClass:"guide-modal-button-close flex_line_c_m",attrs:{"data-group":"first_complate_publish_guide_popup","data-event":"close_button"},on:{click:t.closeModal}},[e("i",{staticClass:"iconfont icon-close"})])],1)}),[],!1,null,"69da9b0f",null)),Ee=Me.exports;function Fe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return Ae(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ae(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function Ae(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(Me,{SvgIcon:n(115).default});var Be={name:"workFLow",components:{workFlowHeader:x,historyPage:Bt,workflowPublish:Ut.default,historyRecordModal:Vt.a,workflowStyleModal:Wt.a,LoadingStatus:Xt.default,createWorkflowModal:oe,workflowPublishModal:zt,ComfyuiLoading:je,HyUploadMoald:c.default,newWorkflowStyleModal:Pe,GuideModal:Ee},provide:function(){return{top:this}},data:function(){return{nodeId:"",isComfyuiLoading:!1,percentage:0,progressTimer:null,loading:!0,workFlowApp:null,workFlowGraph:null,showHistoryModal:!1,workflowInfo:null,UPLOAD:new Yt.a({type:20}),UPLOADVIDEO:new Jt.a({category:20}),saveWorkflowLoading:!1,saveAsWorkflowLoading:!1,isGenerating:!1,taskInfo:{},workflowConfig:{categories:[],controlnet:[],nodes:[],vae:[]},generateCost:0,lastOutput:[],timer:null,autoSaveTimer:null,canPublish:1,isReady:!1,showVersionUpdateFlag:!1,retryCount:0,apiData:"",uiData:"",isFreeCreate:!0,containPaidNode:!1,messageListener:null,isFirstVisit:!1}},computed:Re(Re({},Object(d.c)("user",["userInfo","isLoggedIn"])),{},{getIframeUrl:function(){var t,e="";e=(null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.origin)||"https://www.seaart.ai";var n="1752908269449",o=n?"?t=".concat(n):"";return"".concat(e,"/comfyui/").concat(o)},upModalObj:function(){var t;return{template_id:(null===(t=this.workflowInfo)||void 0===t?void 0:t.id)||"",sub_category:1}},currentPageType:function(){var t,e,n="create";return null!==(t=this.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.id&&(n="create"),null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId&&(n="edit"),n}}),watch:{containPaidNode:{handler:function(t){t&&(this.isFreeCreate=!1,this.initData())},immediate:!0}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var iframe;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.startProgressLoading(),t.checkFirstVisit(),(iframe=document.getElementById("myIframe"))?(iframe.addEventListener("load",(function(){t.isReady=!0})),iframe.addEventListener("error",(function(){t.isReady=!0}))):t.isReady=!0,t.$EventBus.$off("openWorkflowSelectModel"),window.workflow_upload=t.UPLOAD,window.workflow_upload_video=t.UPLOADVIDEO,e.next=9,t.getWorkflowConfig();case 9:return e.next=11,t.initWorkflow();case 11:t.initVersionInfo();try{document.body.classList.add("litegraph")}catch(t){}t.messageListener=function(e){e.origin===location.origin&&t.handleComfyuiMessage(e.data)},window.addEventListener("message",t.messageListener),t.$EventBus.$on("openWorkflowSelectModel",(function(e){var n=e.node,o=e.pickWidget,r=e.inputName,l=e.inputData,c=e.modelType;t.$refs.newWorkflowStyleModal.openModal({modelType:c,node:n,pickWidget:o,inputName:r,inputData:l})}));case 16:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.progressTimer&&(clearInterval(this.progressTimer),this.progressTimer=null),this.timer&&clearTimeout(this.timer),this.timer=null,this.autoSaveTimer&&clearInterval(this.autoSaveTimer),this.autoSaveTimer=null,this.loading=!1,this.workFlowGraph=null,this.showHistoryModal=!1,this.$EventBus.$off("openWorkflowSelectModel"),this.messageListener&&(window.removeEventListener("message",this.messageListener),this.messageListener=null),this.isFirstVisit=!1,sessionStorage.removeItem("hasVisitedWorkflow")},methods:{checkFirstVisit:function(){var t=sessionStorage.getItem("hasVisitedWorkflow");this.isFirstVisit=!!t},uploadHandleConfirm:function(t){var e=Object(o.a)(t,1)[0];this.postMsgToIframe({type:"uploadImageInfo",data:Re({nodeId:this.nodeId},e)})},startProgressLoading:function(){var t=this;this.progressTimer&&clearInterval(this.progressTimer),this.percentage=0,this.progressTimer=setInterval((function(){if(t.percentage<95){var e=Math.max(1,Math.floor((95-t.percentage)/30));t.percentage=Math.min(95,Math.floor(t.percentage+e))}else clearInterval(t.progressTimer),t.progressTimer=null}),400)},handleApplyTemplate:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n.closeCreateWorkflowModal(),Object.keys((null===(r=n.$route)||void 0===r?void 0:r.query)||[]).length&&n.$router.replace({query:{}}),n.workflowInfo=null,l=t,n.$refs.workFlowHeader.updateTitle(e),n.postMsgToIframe({type:"loadGraphData",data:l});case 6:case"end":return o.stop()}}),o)})))()},handleReloadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={};n.id=e,this.loading=!0,Object(S.f)(n).then((function(e){var n,o,r=(null==e?void 0:e.data)||{},l=null==e||null===(n=e.data)||void 0===n?void 0:n.data;try{l=JSON.parse(l)}catch(t){}t.workflowInfo=Re(Re({},r),{},{data:l}),t.$router.replace({query:{workId:null==t||null===(o=t.workflowInfo)||void 0===o?void 0:o.id}});try{["",null,void 0].includes(null==r?void 0:r.name)||(t.$refs.workFlowHeader.title=r.name,sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:r.name})))}catch(t){}t.postMsgToIframe({type:"loadGraphData",data:l})})).finally((function(){t.loading=!1}))},getWorkflowConfig:function(){var t=this;return Object(S.g)().then((function(e){t.workflowConfig=Object.assign(t.workflowConfig,e.data||{}),window.workflowConfig=t.workflowConfig})).catch((function(t){}))},initWorkflow:function(){var t,e;return null!==(t=this.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.id?this.getOtherWorkflowData():null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId?this.getSelfWorkflowData():void 0},handleRemoveQuery:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&e===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id)&&this.$router.replace({query:{}});try{delete this.workflowInfo.id}catch(t){}},initVersionInfo:function(){var t=(this.workflowConfig||{}).package_node_url,e=void 0===t?"":t;e&&this.checkVersionInfo(e)},initOpenCreateModal:function(){var t,e,n=this,o=localStorage.getItem("workflow_retry_json");if(o){var r=JSON.parse(o);this.postMsgToIframe({type:"loadGraphData",data:r}),localStorage.removeItem("workflow_retry_json")}else if(null!==(t=this.$route.query)&&void 0!==t&&t.id||null!==(e=this.$route.query)&&void 0!==e&&e.workId){var l,c=Re({},Kt.a);this.postMsgToIframe({type:"loadGraphData",data:(null==this||null===(l=this.workflowInfo)||void 0===l?void 0:l.data)||c})}else this.$nextTick((function(){n.openCreateWorkflowModal(!0)}))},checkVersionInfo:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,te.a.getItem(t);case 2:if(!(o=n.sent)){n.next=8;break}return l=o||[],e.showVersionUpdateFlag=(l||[]).some((function(t){return!(null==t||!t.node_has_new)})),e.retryCount=0,n.abrupt("return");case 8:return n.abrupt("return",fetch(t).then((function(t){return t.ok,t.json()})).then(function(){var n=Object(r.a)(regeneratorRuntime.mark((function n(data){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=data||[])){n.next=5;break}return e.retryCount=0,n.next=5,te.a.setItem(t,o);case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){0===e.retryCount&&(e.checkVersionInfo(t),e.retryCount++)})));case 9:case"end":return n.stop()}}),n)})))()},getOtherWorkflowData:function(){var t,e=this,n={};return n.template_id=null===(t=this.$route.query)||void 0===t?void 0:t.id,Object(S.d)(n).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=null==t||null===(n=t.data)||void 0===n?void 0:n.data;try{r=JSON.parse(r)}catch(t){}e.workflowInfo=Re(Re({},o),{},{data:r});try{["",null,void 0].includes(null==o?void 0:o.name)||(e.$refs.workFlowHeader.title=o.name,sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:o.name})))}catch(t){}})).catch((function(t){}))},getSelfWorkflowData:function(){var t,e=this,n={};return n.id=null===(t=this.$route.query)||void 0===t?void 0:t.workId,Object(S.f)(n).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=null==t||null===(n=t.data)||void 0===n?void 0:n.data;try{r=JSON.parse(r)}catch(t){}e.workflowInfo=Re(Re({},o),{},{data:r})})).catch((function(t){}))},handleGenerate:Object(Mt.debounce)(Object(r.a)(regeneratorRuntime.mark((function t(){var e,n,o,r,l,c,d,h,v,f,m,_,y,w=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.clearNodeErrorMessage(),null!==(e=this.userInfo)&&void 0!==e&&e.id){t.next=4;break}return this.$EventBus.$emit("openLoginDialog"),t.abrupt("return");case 4:if(!this.isGenerating){t.next=6;break}return t.abrupt("return");case 6:return this.isGenerating=!0,c=((null==this||null===(n=this.workFlowApp)||void 0===n||null===(n=n.graph)||void 0===n?void 0:n._nodes)||[]).filter((function(t){return t&&(null==t?void 0:t.valueControl)})).map((function(t){var e;return null===(e=t.valueControl)||void 0===e?void 0:e.afterQueued()})),t.next=10,Promise.all(c);case 10:if(d={},this.isFreeCreate&&(d.speed_type=3),null===(o=this.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.workId){t.next=16;break}d.work_flow_id=null==this||null===(h=this.workflowInfo)||void 0===h?void 0:h.id,t.next=19;break;case 16:return t.next=18,this.handleSaveWorkflow();case 18:d.work_flow_id=null==this||null===(v=this.workflowInfo)||void 0===v?void 0:v.id;case 19:null!==(r=this.$route)&&void 0!==r&&null!==(r=r.query)&&void 0!==r&&r.source&&(m=Number(null===(f=this.$route)||void 0===f||null===(f=f.query)||void 0===f?void 0:f.source),!isNaN(m)&&(d.source=m)),null!==(l=this.$route)&&void 0!==l&&null!==(l=l.query)&&void 0!==l&&l.source_id&&(d.source_id=null===(_=this.$route)||void 0===_||null===(_=_.query)||void 0===_?void 0:_.source_id),this.showHistoryModal||(this.showHistoryModal=!0),this.postMsgToIframe({type:"queuePrompt"}),y=setInterval((function(){w.apiData&&(clearInterval(y),d.api_data=w.apiData,d.data=w.uiData,w.apiData="",w.uiData="",w.handleGenerateTask(d))}),1e3);case 24:case"end":return t.stop()}}),t,this)}))),1e3),handleGenerateTask:function(t){var e=this;this.isGenerating=!0,Object(S.b)(t).then((function(n){var o,r;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data,l=null==data?void 0:data.id,c=sessionStorage.getItem("workflow_title"),d=(c?JSON.parse(c):{}).title,h=(void 0===d?"":d)||e.$t("workFlow3"),v={id:l,status:1,process:0},f=null===(r=e.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.workId;f&&(v.creativity={name:h,is_support_retry:!0,id:f,type:1}),e.taskInfo={},e.taskInfo.api_data=t.api_data,e.taskInfo.taskId=l,e.taskInfo.status=1,e.taskInfo.process=0,e.taskInfo.uiData=t.data,e.taskInfo.speed_type=t.speed_type,e.$refs.historyPage.insertDataToList(v),e.postMsgToIframe({type:"postTaskInfo",data:e.taskInfo})}})).catch((function(t){console.log("error",t)})).finally((function(){e.isGenerating=!1}))},handleSelectModel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.info,n=void 0===e?{}:e,o=t.modelType,r=t.node,l=t.pickWidget,c="".concat(n.id,"@").concat(n.model_ver_no),d="".concat(n.name,"-").concat(n.version_name);this.postMsgToIframe({type:"onModelPicked",data:{node:r,pickWidget:l,id:c,name:d,modelType:o}})},handleUpdateTask:function(){var t,e,n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=o||{},l=r.status,c=r.comfyui_current_node,d=void 0===c?{}:c;null!=o&&o.id&&o.id===(null===(t=this.taskInfo)||void 0===t?void 0:t.taskId)&&(this.$set(this.taskInfo,"status",l),3!==l||100!==o.process||this.isFirstVisit||(sessionStorage.setItem("hasVisitedWorkflow",!0),this.isFirstVisit=!0,this.$nextTick((function(){n.$refs.guideModal.openModal()})))),null!==(e=Object.keys(d))&&void 0!==e&&e.length&&this.postMsgToIframe({type:"nodesError",data:{comfyui_current_node:d}})},formatExecutionError:function(t){if(null==t)return"(unknown error)";var e=t.traceback.join(""),n=(t.node_id,t.node_type);return"Error occurred when executing ".concat(n,":\n\n").concat(t.exception_message,"\n\n").concat(e)},formatPromptError:function(t){if(null==t)return"(unknown error)";if("string"==typeof t)return t;if(t.stack&&t.message)return t.toString();if(t.response){var e=t.response.error.message;t.response.error.details&&(e+=": "+t.response.error.details);for(var n=0,r=Object.entries(t.response.node_errors);n<r.length;n++){var l=Object(o.a)(r[n],2),c=(l[0],l[1]);e+="\n"+c.class_type+":";var d,h=Fe(c.errors);try{for(h.s();!(d=h.n()).done;){var v=d.value;e+="\n    - "+v.message+": "+v.details}}catch(t){h.e(t)}finally{h.f()}}return e}return"(unknown error)"},clearNodeErrorMessage:function(){try{this.workFlowApp.lastExecutionError=null,this.workFlowApp.lastNodeErrors=null,this.workFlowApp.ui.dialog.close(),this.workFlowApp.draw(!0,!0)}catch(t){}},openCreateWorkflowModal:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{this.$xyLogEvent({front_operation:"click",event_name:t?"log_action_front_create_workflow_auto":"log_action_front_create_workflow",entity_type:"create_workflow_modal"}),this.$refs.createWorkflowModal.openModal(t)}catch(t){}},closeCreateWorkflowModal:function(){try{this.$refs.createWorkflowModal.handleClose()}catch(t){}},handleClick:Object(Mt.debounce)((function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(t){case"openCreateWorkflowModal":this.openCreateWorkflowModal();break;case"clearWorkFlow":this.doLogEvent("click_clear_comfyui"),this.clearWorkFlow();break;case"createByEmpty":this.handleCreateByEmpty(e);break;case"createByImageToImage":this.doLogEvent("create_comfyui_template","image_to_image"),this.handleCreateByImageToImage();break;case"createByTextToImage":this.doLogEvent("create_comfyui_template","text_to_image"),this.handleCreateByTextToImage();break;case"createByLocalFile":this.handleCreateByLocalFile(e);break;case"openHistoryRecordModal":this.doLogEvent("click_open_comfyui"),this.openHistoryRecordModal();break;case"saveWorkFlow":this.doLogEvent("click_save_comfyui_template"),this.handleSaveWorkflow();break;case"saveAsWorkFlow":this.doLogEvent("click_save_as_comfyui_template"),this.handleSaveAsWorkflow();break;case"viewHistory":this.doLogEvent("click_view_history"),this.handleViewHistory();break;case"downloadWorkFlow":this.doLogEvent("click_download"),this.handleDownloadWorkflow();break;case"downloadWorkFlowApi":this.doLogEvent("click_download"),this.handleDownloadWorkflow("api");break;case"publishWorkFlow":this.doLogEvent("click_publish"),this.handlePublish()}}),1e3),doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},openHistoryRecordModal:function(){this.saveWorkflowLoading||this.saveAsWorkflowLoading||this.$refs.historyRecordModal.openModal()},handleSaveWorkflow:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v,f,m,_,y,w,C,k,O,x,T,D,title;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.saveWorkflowLoading){e.next=2;break}return e.abrupt("return");case 2:return t.saveWorkflowLoading=!0,h={action:1},v="",f="",t.postMsgToIframe({type:"getBothJson"}),e.next=9,t.getJsonData();case 9:if(m=e.sent,_=m.uiData,y=m.apiData,f=y,!["none","",void 0,void 0,null].includes(v=_)){e.next=18;break}return t.$message.warning(t.$t("SaveFailed")),t.saveWorkflowLoading=!1,e.abrupt("return");case 18:null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.id&&(h.action=1,h.source=4),null!==(o=t.$route.query)&&void 0!==o&&o.id||null!==(r=t.$route.query)&&void 0!==r&&r.workId||(h.action=1,h.source=1),null!==(l=t.$route.query)&&void 0!==l&&l.workId&&(h.action=2,h.id=null===(w=t.$route.query)||void 0===w?void 0:w.workId),null!==(c=t.$route)&&void 0!==c&&null!==(c=c.query)&&void 0!==c&&c.source&&(k=Number(null===(C=t.$route)||void 0===C||null===(C=C.query)||void 0===C?void 0:C.source),h.source=isNaN(k)?4:k),null!==(d=t.$route)&&void 0!==d&&null!==(d=d.query)&&void 0!==d&&d.source_id&&(h.source_id=null===(O=t.$route)||void 0===O||null===(O=O.query)||void 0===O?void 0:O.source_id),h.data=v,h.api_data=f,h.action="edit"===t.currentPageType?2:1;try{x=sessionStorage.getItem("workflow_title"),T=x?JSON.parse(x):{},D=T.title,title=void 0===D?"":D,h.name=title||t.$t("workFlow3")}catch(t){console.log("error",t)}return e.abrupt("return",Object(S.q)(h).then((function(e){var n;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var o,r,l=(null==e?void 0:e.data)||{},c=l.work_flow,d=l.publish_state,v=void 0===d?2:d;if(t.workflowInfo=Object.assign(t.workflowInfo||{},(null==h?void 0:h.cover)||{},c||{}),t.canPublish=v,1===h.action)console.log("this?.workflowInfo?.id ----\x3e",null==t||null===(o=t.workflowInfo)||void 0===o?void 0:o.id),t.$router.replace({query:{workId:null==t||null===(r=t.workflowInfo)||void 0===r?void 0:r.id}});t.$message.success(t.$t("workflow51"))}else t.$message.warning(t.$t("SaveFailed"))})).finally((function(){t.saveWorkflowLoading=!1})));case 28:case"end":return e.stop()}}),e)})))()},handleSaveAsWorkflow:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,f,m,_,y,w,C,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.saveAsWorkflowLoading){e.next=2;break}return e.abrupt("return");case 2:return t.saveAsWorkflowLoading=!0,d={action:1},h="",f="",t.postMsgToIframe({type:"getBothJson"}),e.next=9,t.getJsonData();case 9:if(m=e.sent,_=m.uiData,y=m.apiData,f=y,!["none","",void 0,void 0,null].includes(h=_)){e.next=18;break}return t.$message.warning(t.$t("SaveFailed")),t.saveAsWorkflowLoading=!1,e.abrupt("return");case 18:null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.id&&(d.source=4),null!==(o=t.$route.query)&&void 0!==o&&o.id||null!==(r=t.$route.query)&&void 0!==r&&r.workId||(d.source=1),null!==(l=t.$route)&&void 0!==l&&null!==(l=l.query)&&void 0!==l&&l.source&&(C=Number(null===(w=t.$route)||void 0===w||null===(w=w.query)||void 0===w?void 0:w.source),d.source=isNaN(C)?4:C),null!==(c=t.$route)&&void 0!==c&&null!==(c=c.query)&&void 0!==c&&c.source_id&&(d.source_id=null===(k=t.$route)||void 0===k||null===(k=k.query)||void 0===k?void 0:k.source_id),d.data=h,d.api_data=f;try{d.name=v()().format("YYYY-MM-DD HH:mm")}catch(t){console.log("error",t)}return e.abrupt("return",Object(S.q)(d).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?t.$message.success(t.$t("workflow51")):t.$message.warning(t.$t("SaveFailed"))})).finally((function(){t.saveAsWorkflowLoading=!1})));case 26:case"end":return e.stop()}}),e)})))()},handleRetry:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$logEvent("log_actions",{operation:"click_retry",behavior_info:"on_comfyui_page"}),o=t.id,r=t.type,l=t.name,c=t.task_id,d=S.f,[3,4].includes(r)&&(d=S.i),h="",n.prev=5,n.next=8,d({id:o,task_id:c});case 8:f=n.sent,h=null==f||null===(v=f.data)||void 0===v?void 0:v.data,h=JSON.parse(h),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),console.log("error",n.t0);case 16:m=e.$createElement,Object(Ie.errorDialog)({h:m,title:"Tip",contentMain:"OverwriteWorkflow",contentSub:"OverwriteWorkflowTip",confirmText:"OpenInNewPage",cancelText:"OpenInCurrentPage",distinguishCancelAndClose:!0}).then((function(){h&&(localStorage.setItem("workflow_retry_json",JSON.stringify(h)),window.open(e.localePath("/workflow"),"_blank"))})).catch((function(t){"cancel"===t&&h&&(e.$refs.workFlowHeader.title=l,sessionStorage.setItem("workflow_title",JSON.stringify({id:"",title:l})),e.postMsgToIframe({type:"loadGraphData",data:h}))}));case 18:case"end":return n.stop()}}),n,null,[[5,13]])})))()},getJsonData:function(){var t=this;return new Promise((function(e,n){var o=setInterval((function(){if(t.uiData&&t.apiData){clearInterval(o);var n=t.uiData;t.uiData="";var r=t.apiData;t.apiData="",e({uiData:n,apiData:r})}}),1e3)}))},handleViewHistory:function(){this.showHistoryModal=!this.showHistoryModal},checkImageSize:function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t}))},handleDownloadWorkflow:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,f,m,_,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:"",r=sessionStorage.getItem("workflow_title"),l=r?JSON.parse(r):{},c=l.title,d="".concat(void 0===c?"":c,o?"_api.json":".json"),e.postMsgToIframe({type:"getBothJson"}),n.next=7,e.getJsonData();case 7:h=n.sent,v=h.uiData,f=h.apiData,m=new Blob([o?f:v],{type:"application/json"}),_=URL.createObjectURL(m),(a=document.createElement("a")).href=_,a.download=d,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout((function(){var t,e;null===(t=document)||void 0===t||null===(t=t.body)||void 0===t||t.removeChild(a),null===(e=window)||void 0===e||null===(e=e.URL)||void 0===e||e.revokeObjectURL(_)}),0);case 19:case"end":return n.stop()}}),n)})))()},handlePublish:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="",c="",t.postMsgToIframe({type:"getBothJson"}),e.next=5,t.getJsonData();case 5:return d=e.sent,h=d.uiData,v=d.apiData,c=h,f={api_data:l=v},null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.source_id&&(f.template_id=null===(m=t.$route)||void 0===m||null===(m=m.query)||void 0===m?void 0:m.source_id),e.next=14,t.handleSaveWorkflow();case 14:if(2!==t.canPublish){e.next=17;break}return t.$message.error(t.$t("workFlow32")),e.abrupt("return");case 17:t.workflowInfo.ui_json=c,t.workflowInfo.api_json=l,_=(null===(o=t.workflowInfo)||void 0===o?void 0:o.id)||(null===(r=t.$route.query)||void 0===r?void 0:r.workId),t.$refs.workflowPublishModal.handleOpen(_);case 21:case"end":return e.stop()}}),e)})))()},checkHasWorkFlow:function(){var t,e,n=this,o=this,r=!1;return null==this||null===(t=this.workFlowGraph)||void 0===t||null===(t=t._nodes)||void 0===t||!t.length||null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId||(r=!0),new Promise((function(t,e){r?n.$confirm(o.$t("workFlow2"),o.$t("Tip"),{confirmButtonText:n.$t("Confirm"),cancelButtonText:n.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(e){t("confirm")})).catch((function(){t("cancel")})):t("confirm")}))},clearWorkFlow:function(){var t=this;this.$confirm(this.$t("workFlow1"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.workId){e.next=3;break}return e.next=3,Object(S.a)({id:null===(r=t.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.workId});case 3:t.postMsgToIframe({type:"clean"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){}))},handleCreateByEmpty:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]&&t[0],n.next=3,e.checkHasWorkFlow();case 3:if("cancel"!==n.sent){n.next=6;break}return n.abrupt("return");case 6:r&&e.closeCreateWorkflowModal(),Object.keys((null===(o=e.$route)||void 0===o?void 0:o.query)||[]).length&&e.$router.replace({query:{}}),e.workflowInfo=null,e.postMsgToIframe({type:"clean"}),e.clearWorkflowName();case 11:case"end":return n.stop()}}),n)})))()},clearWorkflowName:function(){this.$refs.workFlowHeader.updateTitle()},handleCreateByImageToImage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkHasWorkFlow();case 2:if("cancel"!==e.sent){e.next=5;break}return e.abrupt("return");case 5:Object.keys((null===(n=t.$route)||void 0===n?void 0:n.query)||[]).length&&t.$router.replace({query:{}}),t.workflowInfo=null,o=Re({},Qt.a),t.postMsgToIframe({type:"loadGraphData",data:o});case 9:case"end":return e.stop()}}),e)})))()},handleCreateByTextToImage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkHasWorkFlow();case 2:if("cancel"!==e.sent){e.next=5;break}return e.abrupt("return");case 5:Object.keys((null===(n=t.$route)||void 0===n?void 0:n.query)||[]).length&&t.$router.replace({query:{}}),t.workflowInfo=null,o=Re({},Kt.a),t.postMsgToIframe({type:"loadGraphData",data:o});case 9:case"end":return e.stop()}}),e)})))()},handleCreateByLocalFile:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]&&t[0],e.$confirm(e.$t("workFlow2"),e.$t("Tip"),{confirmButtonText:e.$t("Confirm"),cancelButtonText:e.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){o&&e.closeCreateWorkflowModal(),e.createByLocalFile()})).catch((function(){}));case 2:case"end":return n.stop()}}),n)})))()},createByLocalFile:function(){var t;Object.keys((null===(t=this.$route)||void 0===t?void 0:t.query)||[]).length&&this.$router.replace({query:{}}),this.workflowInfo=null,this.postMsgToIframe({type:"createByLocalFile"}),this.clearWorkflowName()},initData:function(){this.postMsgToIframe({type:"initData",data:{Generate:this.$t("Generate"),daily_rights_2:this.$t("daily_rights_2"),workFlow31:this.$t("workFlow31"),isFreeCreate:this.isFreeCreate}})},handleComfyuiMessage:function(data){var t=this,e=data.type,n=data.info;switch(e){case"openWorkflowSelectModel":var o=n.modelType,r=n.ckptNameWidget,l=n.node;n.params;this.$EventBus.$emit("openWorkflowSelectModel",{modelType:o,pickWidget:JSON.parse(r),node:l});break;case"getBothJson":var c=n.uiData,d=n.apiData;this.uiData=c,this.apiData=d;break;case"comfyuiReady":this.percentage=100,this.initData(),setTimeout((function(){t.isComfyuiLoading=!0,t.initOpenCreateModal()}),1e3);break;case"loadGraphDataSuccess":default:break;case"changeContainPaid":this.containPaidNode=n;break;case"handleGenerate":this.handleGenerate();break;case"freeCreateChange":this.freeCreateChange(n);break;case"openImageUploadModal":this.nodeId=n.nodeId,this.$refs.hyUploadMoald.openModal()}},postMsgToIframe:function(data){var t,iframe=null===(t=document.getElementById("myIframe"))||void 0===t?void 0:t.contentWindow;iframe&&iframe.postMessage(data,"*")},freeCreateChange:function(t){if(this.isFreeCreate=t,this.containPaidNode&&t)return this.$message.warning(this.$t("NotSupportFreeCreate")),this.isFreeCreate=!1,void this.initData();this.$logEvent("log_actions",{operation:"click_free_generate",behavior_info:"on_comfyui_create_page"})}}},Ue=Be,Ve=(n(4728),n(4729),Object(m.a)(Ue,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-work-flow"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isReady,expression:"isReady"}],staticClass:"p-work-flow-box"},[e("work-flow-header",{ref:"workFlowHeader",attrs:{showBadge:t.showVersionUpdateFlag},on:{command:t.handleClick}}),t._v(" "),e("client-only",[t.isComfyuiLoading?t._e():e("ComfyuiLoading",{attrs:{percentage:t.percentage}}),t._v(" "),e("iframe",{attrs:{id:"myIframe",src:t.getIframeUrl,width:"100%",height:"100%",frameborder:"0"}})],1),t._v(" "),t.isLoggedIn?e("div",{staticClass:"history-page-btn",style:{right:t.showHistoryModal?"400px":"0"},on:{click:function(e){return e.stopPropagation(),t.handleViewHistory.apply(null,arguments)}}},[e("i",{class:t.showHistoryModal?"el-icon-d-arrow-right":"iconfont icon-workflow_icon_lishi"})]):t._e(),t._v(" "),t.isLoggedIn?e("history-page",{directives:[{name:"show",rawName:"v-show",value:t.showHistoryModal,expression:"showHistoryModal"}],ref:"historyPage",attrs:{"is-free-create":t.isFreeCreate,showHistoryModal:t.showHistoryModal},on:{updateTask:t.handleUpdateTask,getHistoryModalShow:function(e){return t.showHistoryModal=e},retry:t.handleRetry}}):t._e(),t._v(" "),t.isLoggedIn?e("history-record-modal",{ref:"historyRecordModal",on:{loadJson:t.handleReloadData,removeQuery:t.handleRemoveQuery}}):t._e(),t._v(" "),e("new-workflow-style-modal",{ref:"newWorkflowStyleModal",on:{selectModel:t.handleSelectModel}}),t._v(" "),e("create-workflow-modal",{ref:"createWorkflowModal",on:{command:t.handleClick,applyTemplate:t.handleApplyTemplate}}),t._v(" "),e("workflow-publish-modal",{ref:"workflowPublishModal"}),t._v(" "),e("HyUploadMoald",{ref:"hyUploadMoald",attrs:{"is-need-login":!1,category:20,isSingleSelect:"",uploadObj:{other:t.upModalObj},recentlyUsedQueryObj:t.upModalObj,personalWorksQueryObj:t.upModalObj},on:{onConfirm:t.uploadHandleConfirm}}),t._v(" "),e("GuideModal",{ref:"guideModal",attrs:{showHistoryModal:t.showHistoryModal},on:{command:t.handleClick}})],1),t._v(" "),e("LoadingStatus",{directives:[{name:"show",rawName:"v-show",value:!t.isReady,expression:"!isReady"}],attrs:{bgColor:"#02050e"}})],1)}),[],!1,null,"3aa6d590",null));e.default=Ve.exports;installComponents(Ve,{LoadingStatus:n(213).default})},5730:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(16),n(18),n(1)),c=(n(31),{components:{},props:{workFlowData:{type:Object,default:function(){return{}}}},data:function(){return{currentItemUrl:"",dialogVisible:!1}},computed:{pictureList:function(){for(var t,e,n,o=(null===(t=this.workFlowData)||void 0===t||null===(t=t.samples)||void 0===t?void 0:t.filter((function(t){return t.url})))||[{url:null===(e=this.workFlowData)||void 0===e?void 0:e.cover,support_remix:!1,support_detail:!1,id:null===(n=this.workFlowData)||void 0===n?void 0:n.id}],r=[],i=0;i<o.length;i+=2)r.push(o.slice(i,i+2));return r}},methods:{handleRemix:function(){this.$emit("goPage")},mediaType:function(t){var e=null==t?void 0:t.split(".").pop();return["mp4","mov","avi","wmv","flv","mkv"].includes(e)?"video":"image"},handleClick:function(t){this.currentItemUrl=t.url,this.dialogVisible=!0}}}),d=(n(5359),n(5360),n(0)),h=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"picture-wall",attrs:{"data-group":"newDetail-picture-wall"}},[e("el-carousel",{class:{"picture-wall-carousel":t.pictureList.length<2},attrs:{"indicator-position":"none",autoplay:!1,height:"508px"}},t._l(t.pictureList,(function(n,o){return e("el-carousel-item",{key:o},[e("div",{staticClass:"carousel-content",class:{"carousel-content-1":1==n.length}},t._l(n,(function(n){return e("div",{key:n.id,staticClass:"picture-wall-item"},["image"===t.mediaType(null==n?void 0:n.url)?e("div",{staticClass:"image-bg",style:{backgroundImage:"url(".concat(n.url,")")}}):t._e(),t._v(" "),n.url&&"image"===t.mediaType(null==n?void 0:n.url)?[e("el-image",{attrs:{src:n.url,"preview-src-list":[n.url],alt:""}})]:t._e(),t._v(" "),n.url&&"video"===t.mediaType(n.url)?e("video",{attrs:{src:n.url,autoplay:"",loop:"",controls:!1,muted:""},domProps:{muted:!0},on:{click:function(e){return t.handleClick(n)}}}):t._e(),t._v(" "),e("div",{staticClass:"remix-btn",attrs:{"data-event":"artwork_cover_remix_hover","data-desc":"workFlowDetail","data-id":t.workFlowData.id},on:{click:function(e){return t.handleRemix(n)}}},[t._v("\n            "+t._s(t.$t("Remix"))+"\n          ")])],2)})),0)])})),1),t._v(" "),e("el-dialog",{attrs:{visible:t.dialogVisible,fullscreen:"","append-to-body":!0,"custom-class":"picture-wall-video-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("video",{staticStyle:{width:"99vw",height:"90vh","object-fit":"contain"},attrs:{src:t.currentItemUrl,autoplay:"",loop:"",controls:!0,muted:""},domProps:{muted:!0}})])],1)}),[],!1,null,"4b9520ea",null).exports,v={name:"Tags",props:{tags:{type:Array,default:function(){return[]}}},data:function(){return{isExpanded:!1,showExpandArrow:!1}},mounted:function(){this.checkOverflow(),window.addEventListener("resize",this.checkOverflow)},beforeDestroy:function(){window.removeEventListener("resize",this.checkOverflow)},watch:{tags:{handler:function(){var t=this;this.$nextTick((function(){t.checkOverflow()}))},immediate:!0}},methods:{checkOverflow:function(){if(this.$refs.tagsContainer){var t=this.$refs.tagsContainer,e=t.style.height;t.style.height="auto";var n=t.scrollHeight;t.style.height=e,this.showExpandArrow=n>28}},toggleExpand:function(){this.isExpanded=!this.isExpanded}}},f=(n(5361),Object(d.a)(v,(function(){var t=this,e=t._self._c;return e("div",{ref:"tagsContainer",staticClass:"tags",class:{"tags-expanded":t.isExpanded}},[t._l(t.tags,(function(n,o){return e("div",{key:o,staticClass:"tags-item"},[t._v("#"+t._s(n.name))])})),t._v(" "),t.showExpandArrow&&!t.isExpanded?e("div",{staticClass:"tags-arrow tags-arrow-down",on:{click:t.toggleExpand}},[e("i",{staticClass:"iconfont icon-arrow_01"})]):t._e(),t._v(" "),t.isExpanded?e("div",{staticClass:"tags-arrow tags-arrow-up",on:{click:t.toggleExpand}},[e("i",{staticClass:"iconfont icon-arrow_01"})]):t._e()],2)}),[],!1,null,"5aeb541e",null).exports),m=n(14),_=(n(32),n(72),n(89),n(69),n(22),n(185),n(28),n(43),n(40),n(92),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(41),n(9)),y=n(162);function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return C(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?C(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function C(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}var k={name:"ModelIntroduction",components:{TranslateLoading:n(428).default},props:{workFlowData:{type:Object,default:function(){}}},data:function(){return{languageList:_.ab,translateLoading:!1,filterRichText:_.S,isTranslated:!1,isExpanded:!1,isShowMore:!1,originModelDesc:"",currentDesc:""}},computed:{currentLanguage:function(){var t,e=this,n=null===(t=_.ab.find((function(t){return t.value===e.$i18n.locale})))||void 0===t?void 0:t.name;return this.$t(n)}},watch:{"workFlowData.content":{handler:function(t){var e=this;this.currentDesc=t,this.originModelDesc=t,this.$nextTick((function(){e.checkOverflow()}))},immediate:!0}},methods:{checkOverflow:function(){var t;if(this.$refs.modelIntroductionContent&&null!==(t=this.workFlowData)&&void 0!==t&&t.content){var e=this.$refs.modelIntroductionContent;e.style.height="auto";var n=e.scrollHeight;this.isShowMore=n>300,this.isShowMore?e.style.height="300px":e.style.height="auto"}},translateRichText:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,f,_,C,i,k,O,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return","");case 2:if((o=document.createElement("div")).innerHTML=t,r=[],l=new Map,c=function t(e){if(e.nodeType===Node.TEXT_NODE&&e.textContent.trim()){var text=e.textContent.trim();text&&(r.push(text),l.has(text)||l.set(text,[]),l.get(text).push(e))}for(var n=0,o=Array.from(e.childNodes);n<o.length;n++){t(o[n])}},d=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,o=[],r="",l=w(t);try{for(l.s();!(e=l.n()).done;){var text=e.value;(r+"\n"+text).length>n?(r&&o.push(r),r=text):r=r?r+"\n"+text:text}}catch(t){l.e(t)}finally{l.f()}return r&&o.push(r),o},n.prev=8,c(o),0!==r.length){n.next=12;break}return n.abrupt("return",t);case 12:h=d(r),v=e.$i18n.locale,f={zhCN:"zh-cn",zhTW:"zh-tw"}[v]||v,_=5,C=[],i=0;case 19:if(!(i<h.length)){n.next=29;break}return k=h.slice(i,i+_),O=k.map((function(text){return Object(y.a)(text,{to:f})})),n.next=24,Promise.all(O);case 24:x=n.sent,C.push.apply(C,Object(m.a)(x));case 26:i+=_,n.next=19;break;case 29:return C.forEach((function(t,e){var n=h[e],o=t.text.split("\n");n.split("\n").forEach((function(text,i){var t=l.get(text);t&&t.forEach((function(t){t.textContent=o[i]||""}))}))})),n.abrupt("return",o.innerHTML);case 33:return n.prev=33,n.t0=n.catch(8),console.error("Rich text translation failed:",n.t0),n.abrupt("return",t);case 37:case"end":return n.stop()}}),n,null,[[8,33]])})))()},translateModelDesc:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isTranslated=!t.isTranslated,e.prev=1,t.isTranslated){e.next=5;break}return t.originModelDesc&&(t.currentDesc=t.originModelDesc),e.abrupt("return");case 5:return t.originModelDesc||(t.originModelDesc=t.currentDesc),t.translateLoading=!0,e.next=9,t.translateRichText(t.currentDesc);case 9:n=e.sent,t.currentDesc=n,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t.isTranslated=!1,t.originModelDesc&&(t.currentDesc=t.originModelDesc);case 17:return e.prev=17,t.translateLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))()}}},O=k,x=(n(5362),Object(d.a)(O,(function(){var t,e=this,n=e._self._c;return null!==(t=e.workFlowData)&&void 0!==t&&t.content?n("div",{staticClass:"model-introduction"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.translateLoading,expression:"!translateLoading"}],ref:"modelIntroductionContent",staticClass:"model-introduction-content",class:{"model-introduction-content-expanded":e.isExpanded,"model-introduction-content-show-more":e.isShowMore&&!e.isExpanded},domProps:{innerHTML:e._s(e.filterRichText(e.currentDesc))}}),e._v(" "),e.translateLoading?n("TranslateLoading"):e._e(),e._v(" "),n("div",{staticClass:"model-introduction-more"},[e.isShowMore?n("div",{staticClass:"model-introduction-more-item",class:{"model-introduction-more-item-expanded":e.isExpanded},attrs:{"data-event":"description_toolbar_open_detail_button","data-desc":"workFlowDetail","data-id":e.isExpanded?"close":"open"},on:{click:function(t){e.isExpanded=!e.isExpanded}}},[n("span",[e._v(e._s(e.isExpanded?e.$t("PackUp"):e.$t("viewMore")))]),e._v(" "),n("i",{staticClass:"arrow",class:{"icon-arrow-expanded":e.isExpanded}})]):e._e(),e._v(" "),n("div",{staticClass:"model-introduction-more-item translate-model-desc",on:{click:e.translateModelDesc}},[e._v("\n      "+e._s(e.isTranslated?e.$t("cancel_translate"):e.$t("OneClickTranslation"))+"\n    ")])])],1):e._e()}),[],!1,null,"e9a4452a",null)),T=x.exports;installComponents(x,{TranslateLoading:n(428).default});n(26);var S={props:{workFlowData:{type:Object,default:function(){}}},data:function(){return{messageListener:null,loading:!0,isFullscreen:!1,isAnimating:!1}},computed:{getIframeUrl:function(){var t,e="";return e=(null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.origin)||"https://www.seaart.ai","".concat(e,"/comfyui/?preview=true")}},mounted:function(){var t=this;this.messageListener=function(e){e.origin===location.origin&&t.handleComfyuiMessage(e.data)},window.addEventListener("message",this.messageListener),document.addEventListener("keydown",this.handleKeydown)},beforeDestroy:function(){this.messageListener&&(window.removeEventListener("message",this.messageListener),this.messageListener=null),document.removeEventListener("keydown",this.handleKeydown)},methods:{handleComfyuiMessage:function(data){"comfyuiReady"===data.type&&this.initOpenCreateModal()},postMsgToIframe:function(data){var t,iframe=null===(t=document.getElementById("myIframe"))||void 0===t?void 0:t.contentWindow;iframe&&iframe.postMessage(data,"*")},initOpenCreateModal:function(){this.loading=!1;var t=JSON.parse(this.workFlowData.preview_data);this.postMsgToIframe({type:"loadGraphData",data:t})},toggleFullscreen:function(){var t=this;this.isAnimating||(this.isFullscreen?(this.isAnimating=!0,setTimeout((function(){t.isFullscreen=!1,document.body.style.overflow="",t.isAnimating=!1}),400)):(this.isFullscreen=!0,document.body.style.overflow="hidden"))},handleKeydown:function(t){"Escape"===t.key&&this.isFullscreen&&this.toggleFullscreen()}}},D=(n(5363),Object(d.a)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"comfyui-node-preview"},[e("div",{staticClass:"comfyui-node-preview-title flex_lr_m"},[e("div",[t._v("\n      "+t._s(t.$t("node_preview"))+"\n      "),e("span",{staticClass:"comfyui-node-preview-title-num"},[t._v(t._s(t.workFlowData.node_num)+" nodes")])]),t._v(" "),e("div",{staticClass:"comfyui-node-preview-title-right",attrs:{"data-event":"workflow_node_toolbar_full_screen_button","data-desc":"workFlowDetail"},on:{click:t.toggleFullscreen}},[e("i",{staticClass:"iconfont icon-a-Trackingshot"}),t._v(" "+t._s(t.$t("FullScreen"))+"\n    ")])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"comfyui-node-preview-content",class:{fullscreen:t.isFullscreen,"closing-animation":t.isAnimating&&t.isFullscreen}},[t.isFullscreen?e("div",{staticClass:"fullscreen-close",on:{click:t.toggleFullscreen}},[e("i",{staticClass:"iconfont icon-shouqi"})]):t._e(),t._v(" "),e("client-only",[e("iframe",{attrs:{id:"myIframe",src:t.getIframeUrl,width:"100%",height:"100%",frameborder:"0"}})])],1)])}),[],!1,null,"e7a1a0d2",null).exports),P=n(10);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var $={components:{PictureWall:h,Tags:f,ModelIntroduction:T,CmtComments:n(116).default,ComfyuiNodePreview:D},data:function(){return{formatNumberForeign:P.p,currentIndex:0,screenheight:"0px",dialogVisible:!1,commentCount:0}},props:{workFlowData:{type:Object,default:function(){return{}}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.e)("user",["userInfo"])),methods:{goPage:function(){this.$emit("goPage")},updateCountNum:function(t){this.commentCount=t}}},j=$,L=(n(5364),Object(d.a)(j,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"WorkFlowCon"},[n("div",{staticClass:"work-content"},[n("PictureWall",{attrs:{workFlowData:e.workFlowData},on:{goPage:e.goPage}}),e._v(" "),n("Tags",{attrs:{tags:e.workFlowData.categories}}),e._v(" "),n("ModelIntroduction",{attrs:{workFlowData:e.workFlowData}}),e._v(" "),n("ComfyuiNodePreview",{attrs:{workFlowData:e.workFlowData}}),e._v(" "),n("div",{staticClass:"cmt-comments-container"},[n("div",{staticClass:"cmt-comments-container-title"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("comment")))]),e._v(" "),n("span",{staticClass:"count"},[e._v(e._s(e.formatNumberForeign(e.commentCount)))])]),e._v(" "),null!==(t=e.workFlowData)&&void 0!==t&&t.id?n("CmtComments",{ref:"cmtComments",attrs:{type:13,infos:e.workFlowData,inputPosition:"top",isShowCommentCount:!1},on:{updateCountNum:e.updateCountNum}}):e._e()],1)],1)])}),[],!1,null,"43afbf84",null)),M=L.exports;installComponents(L,{CmtComments:n(116).default});n(19),n(21);var E=n(45),F=n(53),A=n(25);function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var B={name:"AuthorInfo",components:{BaseAvatar:F.default},mixins:[E.a],props:{activeImg:{type:Object,default:function(){return{}}},type:{type:String,default:"work"}},watch:{appealShow:{handler:function(t){t||(this.appeaData={obj_no:"",obj_type:1,remark:""})}}},computed:R(R(R({},Object(l.e)("user",["userInfo"])),Object(l.c)("payment",["paymentInfo"])),{},{inviteCode:function(){return this.userInfo.invite_user_code},determineSelfWork:function(){var t,e;return(null==this||null===(t=this.activeImg)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)}}),data:function(){return{popovervisible:!1,appealShow:!1,appeaData:{obj_no:"",obj_type:1,remark:""}}},methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.activeImg)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))},openAppealShow:function(){this.appeaData.obj_no=this.activeImg.id,this.appealShow=!0,this.popovervisible=!1},share:function(){var t,e,n={work:"/explore/detail/",model:"/models/detail/",imgGather:"/artWorkDetail/",video:"/video/"}[this.type]||"/explore/detail/",o=null===(t=this.$route)||void 0===t||null===(t=t.params)||void 0===t?void 0:t.id,r=this.localePath("".concat(n).concat(o,"?u_code=").concat(this.inviteCode)),l="".concat(window.location.origin).concat(r),c=null===(e=this.activeImg)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url;this.$refs.inviteDialog.show(l,c)},handleMark:function(){this.isLoggedIn?this.setCollectData(this.activeImg).includes("collect_selected")&&this.setCollect(this.activeImg,"artwork"):this.$EventBus.$emit("openLoginDialog")},hidePopover:function(){this.popovervisible=!1},handleFollow:function(){var t;if(this.isLoggedIn){var e=(null===(t=this.activeImg)||void 0===t?void 0:t.type)||this.type;e="string"==typeof e?e.toUpperCase():"";var n=["CHECKPOINT","LORA"].includes(e.toUpperCase())?this.activeImg.type:this.type;this.setFollow(this.activeImg,n)}else this.$EventBus.$emit("openLoginDialog")}}},U=(n(5365),Object(d.a)(B,(function(){var t,e,n,o,r,l=this,c=l._self._c;return c("div",{staticClass:"author flex"},[null!==(t=l.activeImg)&&void 0!==t&&t.author?c("div",{staticClass:"left flex"},[c("div",{staticClass:"head",style:{"background-color":null!==(e=l.activeImg)&&void 0!==e&&null!==(e=e.author)&&void 0!==e&&e.head?"transparent":"#ADB8CD"},on:{click:l.jumpToOtherUser}},[c("BaseAvatar",{attrs:{userData:null===(n=l.activeImg)||void 0===n?void 0:n.author,size:40,theme:"dark"}})],1),l._v(" "),c("div",{staticClass:"name",on:{click:l.jumpToOtherUser}},[c("a",{staticClass:"personal-info-a",attrs:{href:l.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[l._v("\n        "+l._s((null===(o=l.activeImg)||void 0===o?void 0:o.author.name)||(null===(r=l.activeImg)||void 0===r?void 0:r.author.id))+"\n      ")])])]):l._e(),l._v(" "),c("div",{staticClass:"right"},[l.determineSelfWork?l._e():c("el-button",{staticClass:"follow",attrs:{loading:l.followLoading},on:{click:l.handleFollow}},[l._v("\n      "+l._s("followed"==l.setFollowData(l.activeImg)?l.$t("Followed"):l.$t("Follow"))+"\n    ")])],1)])}),[],!1,null,"50d98546",null)),V=U.exports;installComponents(U,{BaseAvatar:n(53).default});var W=n(63),H=n(240),G={props:{workFlowData:{type:Object,default:function(){}}},components:{Author:H.default},data:function(){return{formatNumberForeign:P.p}},methods:{handleClickAuthorInfo:function(){this.$xyLogEvent({front_operation:"click",entity_name:"right_toolbar_author_information_hot_area",entity_type:"comfyui_workflow",obj_desc:"workFlowDetail"})}}},z=(n(5366),Object(d.a)(G,(function(){var t=this,e=t._self._c;return t.workFlowData.author?e("div",{staticClass:"user-profile-container"},[e("Author",{attrs:{type:"model",activeImg:t.workFlowData,showRight:!1,size:60},on:{handleClickAuthorInfo:t.handleClickAuthorInfo},scopedSlots:t._u([{key:"name",fn:function(){var n,o,r,l,c,d;return[e("div",{staticClass:"nums"},[e("div",{staticClass:"nums-item"},[e("i",{staticClass:"iconfont icon-icon-following1"}),t._v(" "),e("span",[t._v(t._s(t.formatNumberForeign(null!==(n=null===(o=t.workFlowData)||void 0===o||null===(o=o.author)||void 0===o?void 0:o.follower_cnt)&&void 0!==n?n:0)))])]),t._v(" "),e("div",{staticClass:"nums-item"},[e("i",{staticClass:"iconfont icon-collect-gpt"}),t._v(" "),e("span",[t._v(t._s(t.formatNumberForeign(null!==(r=null===(l=t.workFlowData)||void 0===l||null===(l=l.author)||void 0===l?void 0:l.num_of_collect)&&void 0!==r?r:0)))])]),t._v(" "),e("div",{staticClass:"nums-item"},[e("i",{staticClass:"iconfont icon-eye1"}),t._v(" "),e("span",[t._v(t._s(t.formatNumberForeign(null!==(c=null===(d=t.workFlowData)||void 0===d||null===(d=d.author)||void 0===d?void 0:d.num_of_view)&&void 0!==c?c:0)))])])])]},proxy:!0},{key:"follow",fn:function(){return[e("i",{staticClass:"iconfont icon-user-plus"})]},proxy:!0}],null,!1,4051196771)})],1):t._e()}),[],!1,null,"49bc77ec",null)),Y=z.exports;installComponents(z,{Author:n(240).default});n(141),n(142),n(109);var J=n(618),K=n(526);function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var X={mixins:[E.a],components:{CollectPopover:W.default,modelDownload:J.a},props:{workFlowData:{type:Object,default:function(){}},dotReportInfo:{type:Object,default:function(){}}},data:function(){return{formatNumberForeign:P.p,downloadFlag:!0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["isLoggedIn"])),methods:{handleCreate:function(){this.$emit("goPage")},handleMark:function(){this.isLoggedIn?this.setCollectData(this.workFlowData).includes("icon-collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.workFlowData,"workflow")):this.$refs.collectPopover.visible=!0:this.$EventBus.$emit("openLoginDialog")},dotDownload:function(){var t=this;if(this.isLoggedIn){if(this.downloadFlag){if(2===this.workFlowData.permission.download)return this.$message.warning(this.$t("isDownload"));this.downloadFlag=!1,setTimeout((function(){t.downloadFlag=!0}),2e3),Object(K.c)({template_id:this.workFlowData.id}).then((function(e){t.handleBold(e.data),t.workFlowData.stat.num_of_download++}))}}else this.$EventBus.$emit("openLoginDialog")},handleBold:function(data){var t=new Blob([data.data],{type:"application/json"}),e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=this.workFlowData.name,n.click()}}},Z=X,tt=(n(5367),Object(d.a)(Z,(function(){var t,e,n,o=this,r=o._self._c;return r("div",{staticClass:"btns-container"},[r("div",{staticClass:"btns-container-item create-btn",attrs:{"data-event":"right_toolbar_run_button","data-id":o.workFlowData.id,"data-desc":"workFlowDetail"},on:{click:o.handleCreate}},[r("i",{staticClass:"iconfont icon-creation_small"}),o._v(" "),r("span",[o._v(o._s(o.$t("run")))]),o._v(" "),r("span",[o._v("("+o._s(o.formatNumberForeign((null===(t=o.workFlowData)||void 0===t||null===(t=t.stat)||void 0===t?void 0:t.num_of_task)||0))+")")])]),o._v(" "),r("div",{staticClass:"btns-container-item btn-collect",on:{click:function(t){return t.stopPropagation(),o.handleMark.apply(null,arguments)}}},[r("CollectPopover",{ref:"collectPopover",attrs:{hideBtn:!0,type:"workflow",folder:o.workFlowData,dotReportInfo:o.dotReportInfo}},[r("div",{staticClass:"btns-container-item-collect",attrs:{"data-event":"right_toolbar_favorite_button","data-desc":"workFlowDetail","data-id":o.workFlowData.id}},[r("i",{staticClass:"iconfont",class:o.setCollectData(o.workFlowData)}),o._v(" "),r("span",[o._v(o._s(o.$t("Collect")))]),o._v(" "),r("span",[o._v("("+o._s(o.formatNumberForeign((null===(e=o.workFlowData)||void 0===e||null===(e=e.stat)||void 0===e?void 0:e.num_of_collection)||0))+")")])])])],1),o._v(" "),r("div",{staticClass:"btns-container-item",attrs:{"data-event":"right_toolbar_download_button","data-id":o.workFlowData.id,"data-desc":"workFlowDetail"},on:{click:function(t){return t.stopPropagation(),o.dotDownload.apply(null,arguments)}}},[r("i",{staticClass:"iconfont icon-icon-download"}),o._v(" "),r("span",[o._v(o._s(o.$t("Download")))]),o._v(" "),r("span",[o._v("("+o._s(o.formatNumberForeign((null===(n=o.workFlowData)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_download)||0))+")")])])])}),[],!1,null,"392fd4bc",null)),et=tt.exports;installComponents(tt,{CollectPopover:n(63).default});var it=n(429),nt=n(125),at=n.n(nt),ot=n(608);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct={mixins:[E.a],components:{Evaluate:it.default,HyMorePopover:ot.default},props:{workFlowData:{type:Object,default:function(){}}},data:function(){return{dayjs:at.a,isNil:A.isNil,moreList:[{ctype:"report",isBack:!0},{ctype:"noLike",isBack:!0}]}},computed:lt(lt({},Object(l.c)("user",["userInfo","isCompanyAccount"])),{},{targetItem:function(){var t=this.workFlowData||{},e=t.id,n=void 0===e?"":e,o=t.obj_type;return{id:n,obj_type:void 0===o?13:o,view_domain:"detail"}}})},ut=(n(5370),Object(d.a)(ct,(function(){var t,e,n=this,o=n._self._c;return o("div",{staticClass:"version-detail-container"},[o("div",{staticClass:"version-detail-container-title flex_lr_m"},[n._v("\n    "+n._s(n.$t("workflow_details"))+"\n    "),o("HyMorePopover",{attrs:{list:n.moreList,targetItem:n.targetItem,placement:"top-end"}})],1),n._v(" "),o("div",{staticClass:"version-detail-container-content"},[o("div",{staticClass:"version-detail-container-content-item"},[o("div",{staticClass:"left"},[n._v("\n        "+n._s(n.$t("Type"))+"\n      ")]),n._v(" "),o("div",{staticClass:"right"},[n._v(n._s(n.$t("WorkFlow")))])]),n._v(" "),o("div",{staticClass:"version-detail-container-content-item"},[o("div",{staticClass:"left"},[n._v("\n        "+n._s(n.$t("rating"))+"\n      ")]),n._v(" "),o("div",{staticClass:"right"},[o("Evaluate",{attrs:{"data-event":"model_detail_v2_rating","data-id":n.workFlowData.id,evaluateData:n.workFlowData,obj_type:13}})],1)]),n._v(" "),o("div",{staticClass:"version-detail-container-content-item"},[o("div",{staticClass:"left"},[n._v("\n        "+n._s(n.$t("publishTime"))+"\n      ")]),n._v(" "),o("div",{staticClass:"right"},[n._v("\n        "+n._s(null!==(t=n.workFlowData)&&void 0!==t&&t.create_at?n.dayjs(null===(e=n.workFlowData)||void 0===e?void 0:e.create_at).format("YYYY-MM-DD"):"-")+"\n      ")])]),n._v(" "),o("div",{staticClass:"version-detail-container-content-item"},[o("div",{staticClass:"left"},[n._v("\n        "+n._s(n.$t("status"))+"\n      ")]),n._v(" "),o("div",{staticClass:"right"},[n._v(n._s(1!==n.workFlowData.type?n.$t("yesRun"):"-"))])])])])}),[],!1,null,"af0ad38a",null)),pt=ut.exports;installComponents(ut,{Evaluate:n(429).default});var ht={props:{workFlowData:{type:Object,default:function(){return{}}}},data:function(){return{isExpanded:!1}}},vt=(n(5371),Object(d.a)(ht,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"node-info-container"},[n("div",{staticClass:"node-info-container-title flex_lr_m"},[n("span",[e._v(" "+e._s(e.$t("node_info"))+" ("+e._s(e.workFlowData.node_num)+")")]),e._v(" "),n("i",{staticClass:"iconfont icon-icon-arrow3",class:{"rotate-down":e.isExpanded},attrs:{"data-event":"right_toolbar_node_info","data-desc":"workFlowDetail","data-id":e.isExpanded?"close":"open"},on:{click:function(t){e.isExpanded=!e.isExpanded}}})]),e._v(" "),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isExpanded,expression:"isExpanded"}],staticClass:"node-info-container-content"},e._l(null===(t=e.workFlowData)||void 0===t?void 0:t.node_group,(function(t){return n("div",{key:t.id},[n("div",{staticClass:"node-info-container-content-title"},[e._v(e._s(t.title)+"("+e._s(t.count)+")")]),e._v(" "),null!=t&&t.nodes.length?e._l(null==t?void 0:t.nodes,(function(t,o){return n("div",{key:o,staticClass:"node-info-container-content-item"},[e._v("\n            "+e._s(t.value)+"\n          ")])})):e._e()],2)})),0)])],1)}),[],!1,null,"7d6fd855",null).exports),ft={data:function(){return{dotReportInfo:{category:"default",view_domain:"details_one",batch_id:""}}},props:{workFlowData:{type:Object,default:function(){return{style:{background:"none"},stat:{}}}}},components:{UserProfile:Y,CreateCollectDownload:et,VersionDetail:pt,NodeInfo:vt,WorkFLowAuthor:V,CollectPopover:W.default},methods:{goPage:function(){this.$emit("goPage")}}},mt=(n(5372),Object(d.a)(ft,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"RightParams"},[e("UserProfile",{attrs:{workFlowData:t.workFlowData}}),t._v(" "),e("div",{staticClass:"model-detail-content-right-container"},[e("CreateCollectDownload",{attrs:{workFlowData:t.workFlowData,dotReportInfo:t.dotReportInfo},on:{goPage:t.goPage}}),t._v(" "),e("VersionDetail",{attrs:{workFlowData:t.workFlowData}}),t._v(" "),e("NodeInfo",{attrs:{workFlowData:t.workFlowData}})],1)],1)}),[],!1,null,"b8cb15e0",null).exports),gt=n(290);function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var bt={components:{SwipeableList:n(52).default},props:{workFlowData:{type:Object,default:function(){return{}}}},data:function(){return{modelId:this.$route.params.id,itemScroll:null,dayjs:at.a}},computed:yt(yt({},Object(l.e)("user",["userInfo"])),{},{original:function(){var t;return 1===(null===(t=this.workFlowData.permission)||void 0===t?void 0:t.source)},isOwnCreation:function(){var t,e,n=null===(t=this.userInfo)||void 0===t?void 0:t.id;return n&&(null===(e=this.workFlowData.author)||void 0===e?void 0:e.id)===n}}),methods:{goPage:function(){this.$emit("goPage")},goPublish:function(){var t,e=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"",path="/workflow/publish/".concat(e,"?template_id=").concat(e);window.open(path,"_blank")}}},wt=(n(5373),Object(d.a)(bt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tabs-nav-box"},[e("div",{staticClass:"flex_m tab-title",class:{"tab-title-1":t.isOwnCreation}},[e("div",{staticClass:"left"},[e("div",{staticClass:"title-box"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.original,expression:"original"}],staticClass:"original-tag",attrs:{"data-event":"click_type_original"}},[e("svg-icon",{attrs:{"icon-class":"modelOriginal"}}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(t.$t("Original")))])],1),t._v(" "),e("h1",{staticClass:"title"},[t._v(t._s(t.workFlowData.name))])])]),t._v(" "),e("div",{staticClass:"right"},[t.isOwnCreation?e("div",{staticClass:"edit-btn flex_c_m"},[e("el-popover",{attrs:{placement:"bottom-start","popper-class":"workflow-app-popover jumper","append-to-body":!1,"visible-arrow":!1,trigger:"hover"}},[e("div",{staticClass:"content"},[e("div",{staticClass:"item",attrs:{"data-event":"workflow_detail_comfyui_click","data-id":t.workFlowData.id},on:{click:t.goPage}},[t._v("\n              "+t._s(t.$t("comfyui_enter"))+" ComfyUI\n            ")]),t._v(" "),e("div",{staticClass:"item",attrs:{"data-event":"workflow_detail_workflow_app_publish_click","data-id":t.workFlowData.id},on:{click:t.goPublish}},[t._v("\n              "+t._s(t.$t("workflow_app_publish"))+"\n            ")])]),t._v(" "),e("span",{staticClass:"flex_c_m comfy",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-edit-03"}),t._v(" "),e("span",[t._v(t._s(t.$t("Edit")))])])])],1):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.original,expression:"!original"}],staticClass:"modelType"},[e("svg-icon",{attrs:{"icon-class":"modelReship"}}),t._v(" "),e("span",[t._v(t._s(t.$t("Reship")))])],1),t._v(" "),e("div",{staticClass:"last-update"},[t._v(t._s(t.$t("LastUpdate"))+"："+t._s(t.dayjs(t.workFlowData.update_at).format("YYYY-MM-DD")))])])])])}),[],!1,null,"0010f80e",null)),Ct=wt.exports;function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}installComponents(wt,{SvgIcon:n(115).default});var Ot={name:"workFlowDetail",data:function(){return{workFlowData:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.e)("user",["userInfo"])),components:{WorkFlowCon:M,RightParams:mt,BackIcon:gt.default,TabsNavNew:Ct},watch:{"workFlowData.type":{handler:function(t){var e,n=null===(e=this.$route)||void 0===e||null===(e=e.params)||void 0===e?void 0:e.id;[3,4].includes(t)&&n&&this.$router.push(this.localePath("/workFlowAppDetail/"+n)),this.$xyLogEvent({front_operation:"exposure",entity_name:"workflow-detail-v2",entity_type:"workflow-detail-v2",obj_id:this.$route.params.id})},immediate:!0}},methods:{goPage:function(){var t,e,source=(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null===(e=this.workFlowData.author)||void 0===e?void 0:e.id)?3:4,path="/workflow?id="+this.workFlowData.id+"&source="+source+"&source_id="+this.workFlowData.id;this.$router.push(this.localePath({path:path}))}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,l=o.id,e.prev=2,e.next=5,n.$post("/api/v1/creativity/square/template/detail",{template_id:l});case 5:return c=e.sent,(data=c.data).style={background:"none"},e.abrupt("return",{workFlowData:data||{}});case 11:e.prev=11,e.t0=e.catch(2),console.log("工作流详情页-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))()},head:function(){var t=this.workFlowData.name,title="".concat(t," | ComfyUI Workflow"),desc=this.$t("comfyUiDetailDesc",{name:t});return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}}},xt=Ot,Tt=(n(5374),Object(d.a)(xt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workFlow"},[e("back-icon"),t._v(" "),e("div",{staticClass:"workFlow-detail-main"},[e("TabsNavNew",{attrs:{workFlowData:t.workFlowData},on:{goPage:t.goPage}}),t._v(" "),e("div",{staticClass:"workFlow-detail-content"},[t.workFlowData.id?e("WorkFlowCon",{attrs:{workFlowData:t.workFlowData},on:{goPage:t.goPage}}):t._e(),t._v(" "),e("RightParams",{attrs:{workFlowData:t.workFlowData},on:{goPage:t.goPage}})],1)],1)],1)}),[],!1,null,"73c5522c",null));e.default=Tt.exports;installComponents(Tt,{BackIcon:n(290).default})},5731:function(t,e,n){"use strict";n.r(e);n(16),n(18),n(11),n(12),n(13);var o=n(14),r=n(2),l=n(3),c=(n(20),n(19),n(6),n(32),n(50),n(22),n(31),n(49),n(8),n(4),n(28),n(21),n(40),n(44),n(7),n(41),n(141),n(142),n(109),n(1));n(72),n(89),n(69),n(24),n(43);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return h(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?h(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function h(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}var v={name:"TreeSelect",props:{value:{type:Array,default:function(){return[]}},treeData:{type:Array,default:function(){return[]}},placeholder:{type:String,default:""},maxTags:{type:Number,default:5},categories:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1}},data:function(){return{isOpen:!1,expandedNodes:[],selectedNodes:[],filterText:""}},computed:{isMaxSelected:function(){return this.selectedNodes.length>=this.maxTags},filteredTreeData:function(){var t=this;if(!this.filterText)return this.treeData;var e=this.filterText.toLowerCase();return function n(o){return o.filter((function(o){var r=o.name.toLowerCase().includes(e),l=!1;o.tags&&o.tags.length&&(n(o.tags).length>0&&(l=!0,t.expandedNodes.includes(o.id)||t.expandedNodes.push(o.id)));return r||l}))}(this.treeData)}},watch:{categories:{handler:function(t){this.selectedNodes=t,t&&t.length>0&&this.expandNodesContainingSelectedItems(this.treeData)},deep:!0},treeData:{handler:function(t){this.defaultExpandAll&&this.expandAll(),this.selectedNodes&&this.selectedNodes.length>0&&this.expandNodesContainingSelectedItems(t)},deep:!0}},methods:{filterChildNodes:function(t){var e=this;if(!this.filterText)return t;var n=this.filterText.toLowerCase();return t.filter((function(t){var o=t.name.toLowerCase().includes(n),r=!1;return t.tags&&t.tags.length&&(r=t.tags.some((function(t){return t.name.toLowerCase().includes(n)||t.tags&&t.tags.some((function(t){return t.name.toLowerCase().includes(n)}))})))&&!e.expandedNodes.includes(t.id)&&e.expandedNodes.push(t.id),o||r}))},expandAll:function(){var t=this;!function e(n){n.forEach((function(n){n.tags&&n.tags.length>0&&(t.expandedNodes.push(n.id),e(n.tags))}))}(this.treeData)},collapseAll:function(){this.expandedNodes=[]},toggleDropdown:function(){this.isOpen=!this.isOpen},handleNodeClick:function(t){this.isLeafNode(t)?this.toggleNodeSelection(t):this.toggleNodeExpand(t)},toggleNodeSelection:function(t){var e=this.selectedNodes.findIndex((function(e){return e.id===t.id}));if(e>-1)this.selectedNodes.splice(e,1);else{if(this.selectedNodes.length>=this.maxTags)return;this.selectedNodes.push(t)}this.$emit("input",this.selectedNodes.map((function(t){return t.id}))),this.$emit("change",this.selectedNodes.map((function(t){return t.id})))},toggleNodeExpand:function(t){var e=this.expandedNodes.indexOf(t.id);e>-1?this.expandedNodes.splice(e,1):this.expandedNodes.push(t.id)},isLeafNode:function(t){return!t.tags||0===t.tags.length},isNodeSelected:function(t){return this.selectedNodes.some((function(e){return e.id===t.id}))},clearSelection:function(){this.selectedNodes=[],this.$emit("input",[]),this.$emit("change",[])},confirmSelection:function(){this.isOpen=!1},closeOutside:function(t){this.$el.contains(t.target)||(this.isOpen=!1)},removeTag:function(t){var e=this.selectedNodes.findIndex((function(e){return e.id===t.id}));e>-1&&(this.selectedNodes.splice(e,1),this.$emit("input",this.selectedNodes),this.$emit("change",this.selectedNodes))},handleDeleteKeydown:function(){if(""===this.filterText&&this.selectedNodes.length>0){var t=this.selectedNodes[this.selectedNodes.length-1];this.removeTag(t)}},expandNodesContainingSelectedItems:function(t){var e=this;!function t(n){if(!n||!n.length)return!1;var o,r=!1,l=d(n);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c.tags&&c.tags.length>0){var h=t(c.tags),v=c.tags.some((function(t){return e.selectedNodes.some((function(e){return e.id===t.id}))}));(h||v)&&(e.expandedNodes.includes(c.id)||e.expandedNodes.push(c.id),r=!0)}}}catch(t){l.e(t)}finally{l.f()}return r}(t)}},mounted:function(){document.addEventListener("click",this.closeOutside)},beforeDestroy:function(){document.removeEventListener("click",this.closeOutside)}},f=(n(4731),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tree-select"},[e("div",{staticClass:"select-header"},[e("div",{staticClass:"input-wrapper",on:{click:function(e){e.stopPropagation(),t.isOpen=!t.isOpen}}},[0===t.selectedNodes.length?e("div",{staticClass:"placeholder"},[t._v("\n        "+t._s(t.placeholder)+"\n      ")]):e("div",{staticClass:"selected-tags"},t._l(t.selectedNodes,(function(n,o){return e("div",{key:n.id,staticClass:"selected-tag"},[e("span",{staticClass:"tag-text"},[t._v(t._s(n.name))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:function(e){return e.stopPropagation(),t.removeTag(n)}}})])})),0),t._v(" "),e("div",{staticClass:"input-actions"},[e("el-input",{staticClass:"filter-input",nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.handleDeleteKeydown.apply(null,arguments)}},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),e("i",{class:["el-icon-arrow-down",t.isOpen?"is-reverse":""]})],1)])]),t._v(" "),e("transition",{attrs:{name:"dropdown-fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],staticClass:"dropdown-container"},[e("div",{staticClass:"tree-container"},t._l(t.filteredTreeData,(function(n,o){return e("div",{key:o,staticClass:"tree-node"},[e("div",{staticClass:"node-content",class:{"node-parent":n.tags&&n.tags.length>0},on:{click:function(e){return t.handleNodeClick(n)}}},[e("i",{staticClass:"node-icon",class:[n.tags&&n.tags.length>0?t.expandedNodes.includes(n.id)?"el-icon-caret-bottom":"el-icon-caret-right":"no-icon"]}),t._v(" "),e("span",{staticClass:"node-label"},[t._v(t._s(n.name))])]),t._v(" "),e("transition",{attrs:{name:"expand"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:n.tags&&n.tags.length>0&&t.expandedNodes.includes(n.id),expression:"node.tags && node.tags.length > 0 && expandedNodes.includes(node.id)"}],staticClass:"node-children"},t._l(t.filterChildNodes(n.tags),(function(n,o){return e("div",{key:o,staticClass:"tree-node child-node"},[e("div",{staticClass:"node-content",class:{"node-parent":n.tags&&n.tags.length>0,"node-selected":t.isNodeSelected(n),"node-disabled":t.isMaxSelected&&!t.isNodeSelected(n)},on:{click:function(e){return t.handleNodeClick(n)}}},[e("span",{staticClass:"node-label"},[t._v(t._s(n.name))]),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isNodeSelected(n),expression:"isNodeSelected(childNode)"}],staticClass:"el-icon-check node-checkbox"})])])})),0)])],1)})),0),t._v(" "),e("transition",{attrs:{name:"fade"}},[0===t.filteredTreeData.length?e("div",{staticClass:"empty-result"},[e("span",[t._v(t._s(t.$t("NoSearchData")))])]):t._e()])],1)])],1)}),[],!1,null,"7168772d",null),m=component.exports,_=n(172),y=n(905),w=n(906),C=n(51),k=n(907),O=n(52),x=n(178),T=n(133),S=n(213),D=n(827),P=n(181),I=n(403),$=n(61),j=n(71),L=n(566),M=n(277),E=n.n(M),F=n(9),A=n(35),N=n.n(A),R=n(83),B=n(908),U={name:"SwtichWorkFlow",props:{currentWorkflowIndex:{type:Number,default:0},mainWorkflowName:{type:String,default:""},mainWorkflowId:{type:String,default:""},subWorkflowName:{type:String,default:""},subWorkflowId:{type:String,default:""}},components:{HistoryRecordModal:B.a},data:function(){return{workflowNameCopy:"副工作流名称",editIndex:null}},computed:{isEditMainWorkflow:function(){return 1==this.editIndex},isEditSubWorkflow:function(){return 2==this.editIndex}},methods:{switchWorkflow:function(t){this.editIndex||this.$emit("switchWorkflow",t)},editWorkflowName:function(t){this.editIndex=t,this.workflowNameCopy=1==t?this.mainWorkflowName:this.subWorkflowName},completeEditWorkflowName:function(){this.workflowNameCopy?(this.$emit("updateWorkflowName",this.workflowNameCopy,this.editIndex-1),this.editIndex=null):this.editIndex=null},openHistoryRecordModal:function(){this.$refs.historyRecordModalRef.openModal()},confirmSubWorkflow:function(t){this.$emit("confirmSubWorkflow",t)},deleteSubWorkflow:function(){var t=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("deleteSubWorkflow")}))}}},V=(n(4744),Object(f.a)(U,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workflow-selector"},[this.subWorkflowId?e("div",{staticClass:"tab-container"},[e("div",{staticClass:"workflow-item",class:{active:0==t.currentWorkflowIndex},on:{click:function(e){return t.switchWorkflow(0)}}},[t.isEditMainWorkflow?e("el-input",{attrs:{placeholder:t.$t("pleaseEnter")},on:{blur:t.completeEditWorkflowName},model:{value:t.workflowNameCopy,callback:function(e){t.workflowNameCopy=e},expression:"workflowNameCopy"}}):e("span",{staticClass:"workflow-item-title"},[t._v(t._s(t.mainWorkflowName))]),t._v(" "),t.isEditMainWorkflow?e("i",{staticClass:"iconfont icon-icon-event-confirm icon opt-icon",on:{click:function(e){return e.stopPropagation(),t.completeEditWorkflowName.apply(null,arguments)}}}):e("i",{staticClass:"el-icon-edit icon opt-icon",on:{click:function(e){return e.stopPropagation(),t.editWorkflowName(1)}}})],1),t._v(" "),e("div",{staticClass:"workflow-item",class:{active:1==t.currentWorkflowIndex,"sub-workflow":!t.isEditSubWorkflow},on:{click:function(e){return t.switchWorkflow(1)}}},[t.isEditSubWorkflow?e("el-input",{attrs:{placeholder:t.$t("pleaseEnter")},on:{blur:t.completeEditWorkflowName},model:{value:t.workflowNameCopy,callback:function(e){t.workflowNameCopy=e},expression:"workflowNameCopy"}}):e("span",{staticClass:"workflow-item-title"},[t._v(t._s(t.subWorkflowName))]),t._v(" "),t.isEditSubWorkflow?e("i",{staticClass:"iconfont icon-icon-event-confirm icon opt-icon",on:{click:function(e){return e.stopPropagation(),t.completeEditWorkflowName.apply(null,arguments)}}}):e("i",{staticClass:"el-icon-edit icon opt-icon",on:{click:function(e){return e.stopPropagation(),t.editWorkflowName(2)}}}),t._v(" "),t.isEditSubWorkflow?t._e():e("div",{staticClass:"right"},[e("i",{staticClass:"opt-icon el-icon-refresh",on:{click:function(e){return e.stopPropagation(),t.openHistoryRecordModal.apply(null,arguments)}}}),t._v(" "),e("i",{staticClass:"opt-icon el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.deleteSubWorkflow.apply(null,arguments)}}})])],1)]):e("div",{staticClass:"select-container"},[e("div",{staticClass:"workflow-item"},[e("span",{staticClass:"workflow-item-title"},[t._v(t._s(t.mainWorkflowName))])]),t._v(" "),e("div",{staticClass:"workflow-item add",on:{click:t.openHistoryRecordModal}},[e("el-tooltip",{attrs:{content:t.$t("app_publish_add_workflow_tip"),placement:"top"}},[e("div",{staticClass:"tooltip-content"},[e("i",{staticClass:"iconfont icon-add-icon"}),t._v(" "),e("span",{staticClass:"workflow-item-title"},[t._v(t._s(t.$t("app_publish_add_workflow")))])])])],1)]),t._v(" "),e("HistoryRecordModal",{ref:"historyRecordModalRef",attrs:{canExec:""},on:{loadJson:t.confirmSubWorkflow}})],1)}),[],!1,null,"0fffd424",null)),W=V.exports,H=(n(92),{name:"SelectInputParams",model:{prop:"visible"},props:{visible:{type:Boolean,default:!1},data:{type:Array,default:[]},selectedData:{type:Array,default:[]}},watch:{data:{handler:function(t){this.list=N()(t||[])},deep:!0}},computed:{options:function(){var t=[];return this.list.forEach((function(e){t=t.concat(e.options)})),t}},data:function(){return{list:[],keyword:"",autoExpandMatchedNodes:!0,activeNode:"",selectedParams:{seed:!1,step:!1}}},methods:{close:function(){this.$emit("update:visible",!1)},toggleNode:function(t){this.$set(t,"expanded",!t.expanded)},selectNode:function(option){this.$emit("comfirm",N()(option))},cancleNodeChecked:function(option){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0;i<this.options.length;i++){var e=this.options[i];if(e.key==option.key){this.$set(e,"checked",t);break}}},clearSearch:function(){this.keyword="",this.isSearching=!1,this.list=N()(this.data)},searchNode:function(){var t=this;if(this.keyword&&""!==this.keyword.trim()){var e=this.keyword.toLowerCase().trim();this.list=N()(this.data).filter((function(t){if(t.local_node_type&&t.local_node_type.toLowerCase().includes(e))return!0;if(t.title&&t.title.toLowerCase().includes(e))return!0;if(t.options&&t.options.length>0&&t.options.some((function(option){return option.local_field&&option.local_field.toLowerCase().includes(e)})))return!0;return!(!t.node_id||!t.node_id.toString().includes(e))})),this.list.forEach((function(e){t.$set(e,"expanded",!0),e.options.forEach((function(option){t.$set(option,"checked",!1),t.selectedData.find((function(t){return t.key==option.key}))&&t.$set(option,"checked",!0)}))}))}else this.list=N()(this.data)}}}),G=H,z=(n(4745),Object(f.a)(G,(function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"select-node"},[e("div",{staticClass:"head-area"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("workflow_choose_input_params")))]),t._v(" "),e("i",{staticClass:"iconfont icon-close",on:{click:t.close}})]),t._v(" "),e("div",{staticClass:"search-box"},[e("el-input",{attrs:{placeholder:t.$t("Search"),"prefix-icon":"el-icon-search",clearable:""},on:{input:t.searchNode,clear:t.clearSearch},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),e("div",{staticClass:"select-content"},[e("div",{staticClass:"node-list"},t._l(t.list,(function(n){return e("div",{key:n.node_id,staticClass:"node-item"},[e("div",{staticClass:"node-header",on:{click:function(e){return e.stopPropagation(),t.toggleNode(n)}}},[e("i",{staticClass:"el-icon-arrow-right",class:{"node-expanded":n.expanded}}),t._v(" "),e("span",{staticClass:"node-title"},[t._v("\n            "+t._s("[".concat(n.node_id,"] ").concat(n.local_node_type||n.node_type))+"\n            "),n.title?e("span",{staticClass:"node-title-desc"},[t._v(t._s("(".concat(n.title,")")))]):t._e()])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.expanded,expression:"item.expanded"}],staticClass:"node-content"},t._l(n.options,(function(option,n){return e("div",{key:"".concat(option.key),staticClass:"param-option"},[e("el-checkbox",{on:{change:function(e){return t.selectNode(option)}},model:{value:option.checked,callback:function(e){t.$set(option,"checked",e)},expression:"option.checked"}},[t._v("\n              "+t._s(option.local_field||option.field)+"\n            ")])],1)})),0)])})),0)])]):t._e()}),[],!1,null,"092732d1",null).exports),Y={name:"SelectInputParams",model:{prop:"visible"},props:{visible:{type:Boolean,default:!1},data:{type:Array,default:[]},selectedData:{type:Array,default:[]}},watch:{data:{handler:function(t){this.list=N()(t||[])},deep:!0}},data:function(){return{list:[],keyword:"",activeNode:"",selectedParams:{seed:!1,step:!1}}},methods:{close:function(){this.$emit("update:visible",!1)},toggleNode:function(t){this.$set(t,"expanded",!t.expanded)},selectNode:function(option){this.$emit("comfirm",N()(option))},cancleNodeChecked:function(option){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0;i<this.list.length;i++){var e=this.list[i];if(e.node_id==(null==option?void 0:option.node_id)&&e.node_type==(null==option?void 0:option.node_type)){this.$set(e,"checked",t);break}}},clearSearch:function(){this.keyword="",this.isSearching=!1,this.list=N()(this.data)},searchNode:function(){var t=this;if(this.keyword&&""!==this.keyword.trim()){var e=this.keyword.toLowerCase().trim();this.list=N()(this.data).filter((function(t){return!(!t.local_node_type||!t.local_node_type.toLowerCase().includes(e))||(!(!t.title||!t.title.toLowerCase().includes(e))||!(!t.node_id||!t.node_id.toString().includes(e)))})),this.list.forEach((function(e){t.$set(e,"checked",!1),t.selectedData.find((function(t){return t.node_id==e.node_id&&t.node_type==e.node_type}))&&t.$set(e,"checked",!0)}))}else this.list=N()(this.data)}}},J=Y,K=(n(4746),Object(f.a)(J,(function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"select-node"},[e("div",{staticClass:"head-area"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("workflow_choose_output_params")))]),t._v(" "),e("i",{staticClass:"iconfont icon-close",on:{click:t.close}})]),t._v(" "),e("div",{staticClass:"search-box"},[e("el-input",{attrs:{placeholder:t.$t("Search"),"prefix-icon":"el-icon-search",clearable:""},on:{input:t.searchNode,clear:t.clearSearch},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),e("div",{staticClass:"select-content"},[e("div",{staticClass:"node-list"},[e("div",{staticClass:"node-item"},[e("div",{staticClass:"node-content"},t._l(t.list,(function(n){return e("div",{key:"".concat(n.node_id,"-").concat(n.node_type),staticClass:"param-option"},[n.title?e("el-checkbox",{on:{change:function(e){return t.selectNode(n)}},model:{value:n.checked,callback:function(e){t.$set(n,"checked",e)},expression:"item.checked"}},[t._v("\n              "+t._s("[".concat(n.node_id,"]").concat(n.local_node_type||n.node_type,"(").concat(n.title,")"))+"\n            ")]):e("el-checkbox",{on:{change:function(e){return t.selectNode(n)}},model:{value:n.checked,callback:function(e){t.$set(n,"checked",e)},expression:"item.checked"}},[t._v("\n              "+t._s("[".concat(n.node_id,"]").concat(n.local_node_type||n.node_type))+"\n            ")])],1)})),0)])])])]):t._e()}),[],!1,null,"71f60569",null).exports),Q=n(39);function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt=F.s.reduce((function(t,e,n){return t[e]="",t}),{}),et={name:"InputNodeMultilingual",props:{visible:{type:Boolean,default:!1},data:{type:Array,default:[]},confirm:{type:Function,default:function(){}}},watch:{visible:{handler:function(t){var e;t?(this.tabs=N()(this.data),(null==this||null===(e=this.data)||void 0===e?void 0:e.length)&&this.toggleTab(this.tabs[0])):this.reset()}}},data:function(){return{loading:!1,tabs:[],activeTab:"",formData:{originText:"",langMap:N()(tt)}}},methods:{handleConfirm:function(){var t;if(null!==(t=this.tabs)&&void 0!==t&&t.length){for(var e=N()(this.tabs),i=0;i<e.length;i++){var n={},o=e[i].langMap,r=!1;for(var l in o)o[l]&&(r=!0,n[l]=o[l]);e[i].langMap=r?n:""}this.$emit("confirm",e),this.close()}},toggleTab:function(t){this.formData.originText=t.title,this.activeTab=t,this.$set(this.activeTab,"langMap",Z(Z({},N()(tt)),t.langMap||{}))},onTranslate:function(){var t,e=this,text=(null===(t=this.activeTab)||void 0===t?void 0:t.title)||this.formData.originText;text&&!this.loading&&(this.loading=!0,Object(Q.p)({text:text}).then((function(t){if(1e4==t.status.code){var n=t.data;e.formData.langMap=n,e.activeTab&&(e.activeTab.langMap=e.formData.langMap)}})).finally((function(){e.loading=!1})))},reset:function(){this.tabs=[],this.activeTab="",this.formData={originText:"",langMap:N()(tt)}},close:function(){this.reset(),this.$emit("update:visible",!1)}}},it=(n(4747),Object(f.a)(et,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{attrs:{"append-to-body":"",visible:n.visible,"show-close":!0,width:"1090px","custom-class":"translate-modal"},on:{"update:visible":function(t){n.visible=t},close:n.close}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"translate-modal-container"},[o("div",{staticClass:"translate-header"},[o("div",{staticClass:"title"},[o("span",{staticClass:"title"},[n._v(n._s("".concat(n.$t("workflow_multilingual_setting"))))]),n._v(" "),o("el-tooltip",{attrs:{content:n.$t("workflow_multilingual_tip"),placement:"top"}},[o("i",{staticClass:"el-icon-question"})])],1),n._v(" "),o("div",{staticClass:"close-btn",on:{click:n.close}},[o("i",{staticClass:"el-icon-close"})])]),n._v(" "),o("div",{staticClass:"translate-modal-main"},[o("div",{staticClass:"translate-modal-tab"},[o("div",{staticClass:"tab-head"},[o("div",{staticClass:"tab-title"},[n._v(n._s(n.$t("workflow_input_params")))])]),n._v(" "),o("div",{staticClass:"tab-list"},n._l(n.tabs,(function(t){return o("div",{key:t.key,staticClass:"tab-item",class:{active:n.activeTab.key==t.key},on:{click:function(e){return n.toggleTab(t)}}},[o("el-tooltip",{attrs:{content:t.title,placement:"top"}},[o("span",{staticClass:"tab-item-text"},[n._v(n._s(t.title))])])],1)})),0)]),n._v(" "),o("div",{staticClass:"translate-modal-content"},[o("div",{staticClass:"translate-original"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t("OriginalText")))]),n._v(" "),o("div",{staticClass:"translate-btn",on:{click:n.onTranslate}},[n._v("\n            "+n._s(n.$t("OneClickTranslation"))+"\n          ")]),n._v(" "),n.activeTab?o("el-input",{staticClass:"translate-modal-input",attrs:{type:"textarea",resize:"none",placeholder:n.$t("pleaseEnte")},model:{value:n.activeTab.title,callback:function(t){n.$set(n.activeTab,"title",t)},expression:"activeTab.title"}}):o("el-input",{staticClass:"translate-modal-input",attrs:{type:"textarea",resize:"none",placeholder:n.$t("pleaseEnte")},model:{value:n.formData.originText,callback:function(t){n.$set(n.formData,"originText",t)},expression:"formData.originText"}})],1),n._v(" "),o("div",{staticClass:"translate-content"},[null!==(t=n.activeTab)&&void 0!==t&&t.langMap?n._l(null===(e=n.activeTab)||void 0===e?void 0:e.langMap,(function(t,e){var r;return o("div",{key:e,staticClass:"translate-item"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t(e))+"1")]),n._v(" "),o("el-input",{staticClass:"translate-modal-input input-item",attrs:{type:"textarea",resize:"none",placeholder:n.$t("pleaseEnte")},model:{value:null===(r=n.activeTab)||void 0===r?void 0:r.langMap[e],callback:function(t){var o;n.$set(null===(o=n.activeTab)||void 0===o?void 0:o.langMap,e,t)},expression:"activeTab?.langMap[key]"}})],1)})):n._l(n.formData.langMap,(function(t,e){return o("div",{key:e,staticClass:"translate-item"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t(e)))]),n._v(" "),o("el-input",{staticClass:"translate-modal-input input-item",attrs:{type:"textarea",resize:"none",placeholder:n.$t("pleaseEnte")},model:{value:n.formData.langMap[e],callback:function(t){n.$set(n.formData.langMap,e,t)},expression:"formData.langMap[key]"}})],1)}))],2)])]),n._v(" "),o("div",{staticClass:"translate-footer flex-center"},[o("el-button",{staticClass:"cancel-btn",on:{click:n.close}},[n._v("\n        "+n._s(n.$t("Cancel"))+"\n      ")]),n._v(" "),o("el-button",{staticClass:"confirm-btn",attrs:{loading:n.loading},on:{click:n.handleConfirm}},[n._v("\n        "+n._s(n.$t("Confirm"))+"\n      ")])],1)])])}),[],!1,null,"038abae0",null).exports),nt=(n(73),n(113),n(10)),at=n(148),ot={name:"UploadImage",props:{limit:{type:Number,default:1},accept:{type:String,default:"image/*"},size:{type:Number,default:10485760},category:{type:Number,default:68}},data:function(){return{baseUploadConfig:{zipMaxSize:10,fileMaxSize:20,minWh:[10,10],maxWh:[1e4,1e4],minProportion:[0,0],maxProportion:[0,0],multiple:!1,limit:2,directUse:!1,other:{}},UPLOAD:new C.a({type:this.category}),loading:!1}},methods:{handleChange:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.target.files,e.loading=!0,n.next=4,Object(nt.b)(5,o,e.singleFileCheck);case 4:if(n.sent){n.next=8;break}return e.loading=!1,n.abrupt("return");case 8:e.uploadImageFile(o);case 9:case"end":return n.stop()}}),n)})))()},uploadImageFile:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(nt.b)(5,t,(function(t){return e.UPLOAD.startUpload(t,{category:e.category,size:t.size})})).finally((function(){e.loading=!1}));case 2:o=n.sent,e.$emit("change",o);case 4:case"end":return n.stop()}}),n)})))()},singleFileCheck:function(t){var e=this;return new Promise(function(){var n=Object(l.a)(regeneratorRuntime.mark((function n(o,r){var l,c,d,h,v,f,m,_,y,w,C,k,O,x,T,S;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.UPLOAD,l=e.baseUploadConfig,c=l.minWh,d=l.maxWh,h=l.minProportion,v=l.maxProportion,f=l.fileMaxSize,m=l.zipMaxSize,_=t.size/1024/1024,console.log("file",t),!(_>f)){n.next=8;break}return e.$message.error(e.$t("HttpErrorCode_30003")),r({file:t}),n.abrupt("return",!1);case 8:if(y=t,!("image/gif"===t.type||t.name.toLowerCase().endsWith(".gif")||_>m)){n.next=21;break}return n.prev=11,n.next=14,Object($.a)(y,1024*m*1024);case 14:y=n.sent,n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(11),r({file:t}),n.abrupt("return",!1);case 21:return n.next=23,e.checkImageSize(y);case 23:if(w=n.sent){n.next=27;break}return r({file:t}),n.abrupt("return",!1);case 27:C=w.width,k=w.height,O=[{check:Object(at.checkMinWh)(c,C,k),message:"imageRuleMinWh",params:{w:c[0],h:c[1]}},{check:Object(at.checkMaxWh)(d,C,k),message:"imageRuleMaxWh",params:{w:d[0],h:d[1]}},{check:Object(at.checkMinProportion)(h,C,k),message:"imagEaspectRatio",params:{num1:h.join(":"),num2:v.join(":")}},{check:Object(at.checkMaxProportion)(v,C,k),message:"imagEaspectRatio",params:{num1:v.join(":"),num2:h.join(":")}}],x=0,T=O;case 30:if(!(x<T.length)){n.next=39;break}if(!(S=T[x]).check){n.next=36;break}return e.$message.error(e.$t(S.message,S.params)),r({file:t}),n.abrupt("return",!1);case 36:x++,n.next=30;break;case 39:o({file:y,width:C,height:k});case 40:case"end":return n.stop()}}),n,null,[[11,17]])})));return function(t,e){return n.apply(this,arguments)}}())},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t=img.naturalWidth,n=img.naturalHeight;e({width:t,height:n})},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))}}},st=ot,lt=(n(4748),Object(f.a)(st,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"upload-image"},[e("input",{staticClass:"upload-image-input",attrs:{type:"file",multiple:t.limit>1,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),e("div",{staticClass:"upload-image-content"},[t._t("default")],2)])}),[],!1,null,"502f5cb0",null).exports),ct={name:"SelectInputParams",model:{prop:"visible"},components:{UploadImage:lt},props:{modelType:{type:String,default:""},showRefineSwitch:{type:Boolean,default:!1},showCustomTitle:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},visible:{type:Boolean,default:!1},data:{type:Object,default:{}}},watch:{data:{handler:function(t){this.innerChange?this.innerChange=!1:this.initData()},deep:!0},options:{handler:function(){},deep:!0}},data:function(){return{innerChange:!1,list:[],max:5,form:{}}},computed:{isVideoModelType:function(){return"video"==this.modelType}},methods:{initData:function(){var t,e,n;this.form=N()(this.data);var o=(null===(t=this.form)||void 0===t?void 0:t.example_text)||[];this.list=N()(o).map((function(t){return{content:t,id:Date.now()+"_"+Math.random().toString(36).slice(2,9)}}));var r=(null===(e=this.form)||void 0===e?void 0:e.refine_node_ids)||{};if(null!==(n=this.form)&&void 0!==n&&n.show_refine_switch&&null!=r&&r.length&&this.isVideoModelType){var l=r[0],c=l.node_id,d=l.node_type,h=l.field;this.$set(this.form,"refineNodeKey","".concat(c,"_").concat(d,"_").concat(h))}},close:function(){this.$emit("update:visible",!1)},addData:function(){this.list.length>=this.max?this.$message.warning(this.$t("workflow_clues_max",{max:this.max})):this.list.push({content:"",id:Date.now()+"_"+Math.random().toString(36).slice(2,9)})},deleteData:function(t){this.list=this.list.filter((function(e){return e.id!==t}));var e=this.list.filter((function(t){return t.content&&t.content.trim()})).map((function(t){return t.content}));this.updateData("example_text",N()(e))},changeData:function(){var t=this.list.filter((function(t){return t.content&&t.content.trim()})).map((function(t){return t.content}));this.updateData("example_text",N()(t))},updateData:function(t,data){this.$emit("change",t,data)},changeSwitch:function(){this.updateData("show_refine_switch",this.form.show_refine_switch),this.form.show_refine_switch||this.updateData("refine_node_ids",[])},selectNode:function(option){var t=[];this.form.refineNodeKey&&t.push({node_id:option.node_id,node_type:option.node_type,field:option.field}),this.updateData("refine_node_ids",t)},openUploadModal:function(){this.$refs.HyUploadMoaldRef.openModal()},handleSelectImg:function(data){var t;null!=data&&data.length&&(this.form.icon_image=data[0],this.updateData("icon_image",null===(t=this.form)||void 0===t?void 0:t.icon_image))},deleteIconImage:function(){var t;this.form.icon_image="",this.updateData("icon_image",null===(t=this.form)||void 0===t?void 0:t.icon_image)}}},ut=(n(4749),Object(f.a)(ct,(function(){var t,e,n,o=this,r=o._self._c;return o.visible?r("div",{staticClass:"node-prompt-container"},[r("div",{staticClass:"head-area"},[r("div",{staticClass:"title"},[o._v(o._s(o.$t("AdvancedConfig")))]),o._v(" "),r("i",{staticClass:"iconfont icon-close",on:{click:o.close}})]),o._v(" "),r("div",{staticClass:"main-content"},[o.showRefineSwitch?r("div",{staticClass:"label-head"},[r("div",{staticClass:"main"},[r("div",{staticClass:"label-title"},[o._v("\n          "+o._s(o.$t("PromptModify"))+"\n          "),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:o.$t("app_publish_prompt_polish_tip"),placement:"top"}},[r("i",{staticClass:"iconfont icon-icon-information1"})])],1),o._v(" "),r("div",{staticClass:"label-content"},[r("el-switch",{on:{change:o.changeSwitch},model:{value:o.form.show_refine_switch,callback:function(t){o.$set(o.form,"show_refine_switch",t)},expression:"form.show_refine_switch"}})],1)]),o._v(" "),o.form.show_refine_switch&&null!==(t=o.options)&&void 0!==t&&t.length&&o.isVideoModelType?[r("div",{staticClass:"label-desc"},[r("span",{staticClass:"require"},[o._v("*")]),o._v("\n          "+o._s(o.$t("app_publish_polish_relative_label"))+" "),r("br"),o._v(" "),r("div",{staticClass:"row"},[o._v("("+o._s(o.$t("app_publish_polish_relative_desc"))+")")])]),o._v(" "),r("div",{staticClass:"nodes"},o._l(o.options,(function(option,t){return r("div",{key:"".concat(option.key),staticClass:"image-node-option"},[r("el-radio",{attrs:{label:option.key},on:{change:function(t){return o.selectNode(option)}},model:{value:o.form.refineNodeKey,callback:function(t){o.$set(o.form,"refineNodeKey",t)},expression:"form.refineNodeKey"}},[option.title?[o._v("\n                "+o._s(option.title)+"\n              ")]:o.showCustomTitle&&option.originTitle?[o._v("\n                "+o._s("[".concat(option.node_id,"]").concat(option.local_node_type||option.node_type,"(").concat(o.item.originTitle,") - ").concat(option.local_field||option.field))+"\n              ")]:[o._v("\n                "+o._s("[".concat(option.node_id,"]").concat(option.local_node_type||option.node_type," - ").concat(option.local_field||option.field))+"\n              ")]],2)],1)})),0)]:o._e()],2):o._e(),o._v(" "),r("div",{staticClass:"label-head"},[r("div",{staticClass:"main"},[r("div",{staticClass:"label-title"},[o._v("\n          "+o._s(o.$t("workflow_example_clues"))+"\n          "),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:o.$t("workflow_clues_tip"),placement:"top"}},[r("i",{staticClass:"iconfont icon-icon-information1"})])],1)])]),o._v(" "),r("div",{staticClass:"prompt-content"},[o._l(o.list,(function(t){return r("div",{key:t.id,staticClass:"prompt-item"},[r("el-input",{staticClass:"prompt-item-textarea",attrs:{type:"textarea",placeholder:o.$t("PlsEnterPromptToCreate"),maxlength:"500",autosize:{minRows:2}},on:{change:function(t){return o.changeData()}},model:{value:t.content,callback:function(e){o.$set(t,"content",e)},expression:"item.content"}}),o._v(" "),r("div",{staticClass:"prompt-item-actions"},[r("div",{staticClass:"actions-btn",on:{click:function(e){return o.deleteData(t.id)}}},[r("i",{staticClass:"el-icon-delete"}),o._v(" "),r("span",[o._v(o._s(o.$t("Remove")))])])])],1)})),o._v(" "),r("el-button",{staticClass:"submit-btn",attrs:{plain:"",size:"small",disabled:o.list.length>=o.max},on:{click:o.addData}},[o._v("\n        "+o._s("".concat(o.$t("workflow_clues_add"),"(").concat(o.$t("workflow_clues_max",{count:o.max}),")"))+"\n      ")]),o._v(" "),r("div",{staticClass:"label-head mt-10"},[r("div",{staticClass:"main"},[r("div",{staticClass:"label-title"},[o._v("\n            "+o._s(o.$t("arguments_desc"))+"\n          ")]),o._v(" "),r("div",{staticClass:"label-content"},[r("el-switch",{on:{change:function(t){return o.updateData("show_icon_switch",t)}},model:{value:o.form.show_icon_switch,callback:function(t){o.$set(o.form,"show_icon_switch",t)},expression:"form.show_icon_switch"}})],1)])]),o._v(" "),o.form.show_icon_switch?[r("div",{staticClass:"prompt-item"},[r("el-input",{staticClass:"prompt-item-textarea",attrs:{type:"textarea",placeholder:o.$t("arguments_desc_placeholder"),maxlength:"200",autosize:{minRows:3}},on:{change:function(t){return o.updateData("icon_text",o.form.icon_text)}},model:{value:o.form.icon_text,callback:function(t){o.$set(o.form,"icon_text",t)},expression:"form.icon_text"}})],1),o._v(" "),r("div",{staticClass:"image-grid"},[null!==(e=o.form)&&void 0!==e&&e.icon_image?o._e():r("UploadImage",{staticClass:"upload-image-box",attrs:{category:68},on:{change:o.handleSelectImg}},[r("div",{staticClass:"image-item add-image"},[r("div",{staticClass:"add-image-content"},[r("div",{staticClass:"add-text"},[o._v(o._s(o.$t("addImageModel")))]),o._v(" "),r("div",{staticClass:"add-hint"},[o._v("("+o._s(o.$t("recommend_ratio",{ratio:"16:9"}))+")")])])])]),o._v(" "),null!==(n=o.form)&&void 0!==n&&n.icon_image?r("div",{staticClass:"image-item"},[r("div",{staticClass:"image-preview-container"},[r("img",{staticClass:"image-preview",attrs:{src:o.form.icon_image,alt:"icon-image"}})]),o._v(" "),r("div",{staticClass:"delete-btn-container"},[r("div",{staticClass:"delete-btn",on:{click:function(t){return o.deleteIconImage()}}},[o._v(o._s(o.$t("Remove")))])])]):o._e()],1)]:o._e()],2)])]):o._e()}),[],!1,null,"3497449c",null).exports);function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vt={name:"SelectInputParams",components:{HyUploadMoald:R.default,UploadImage:lt},model:{prop:"visible"},props:{showCustomTitle:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},visible:{type:Boolean,default:!1},data:{type:Object,default:function(){}}},watch:{data:{handler:function(t){this.initData()},deep:!0},options:{handler:function(t){this.initData()},deep:!0}},data:function(){return{optionList:[],max:5,settingData:{}}},methods:{initData:function(){var t,e=N()(this.data||{});this.settingData=ht(ht({},e),{},{example_image:(null==e?void 0:e.example_image)||[],show_reverse_switch:!!e.show_reverse_switch,reverse_model_type:e.reverse_model_type||""}),this.optionList=N()(this.options)||[];for(var n={},o=(null===(t=this.settingData)||void 0===t?void 0:t.reverse_node_ids)||[],i=0;i<this.optionList.length;i++){var option=this.optionList[i];this.$set(option,"checked",!1),n[option.key]=option}for(var r=0;r<o.length;r++){var l=o[r],c="".concat(l.node_id,"_").concat(l.node_type,"_").concat(l.field);n[c]&&this.$set(n[c],"checked",!0)}},close:function(){this.$emit("update:visible",!1)},openUploadModal:function(){this.settingData.example_image.length>=this.max?this.$message.warning(this.$t("workflow_example_image_add",{count:this.max})):this.$refs.HyUploadMoaldRef.openModal()},handleSelectImg:function(data){var t;data.length>this.max-this.settingData.example_image.length?this.$message.warning(this.$t("workflow_example_image_add",{count:this.max})):(this.settingData.example_image=this.settingData.example_image.concat(data.map((function(t){return t.url}))),this.handleChange("example_image",N()(null===(t=this.settingData)||void 0===t?void 0:t.example_image)))},deleteData:function(t){var e,n;null===(e=this.settingData)||void 0===e||e.example_image.splice(t,1),this.handleChange("example_image",N()(null===(n=this.settingData)||void 0===n?void 0:n.example_image))},handleSelectIconImg:function(data){null!=data&&data.length&&(this.settingData.icon_image=data[0],this.handleChange("icon_image",this.settingData.icon_image))},deleteIconImage:function(){var t;this.settingData.icon_image="",this.handleChange("icon_image",null===(t=this.settingData)||void 0===t?void 0:t.icon_image)},handleChange:function(t,data){this.$emit("change",t,data)},changeMode:function(){this.handleChange("reverse_model_type",this.settingData.reverse_model_type)},changeSwitch:function(t){this.handleChange("show_reverse_switch",this.settingData.show_reverse_switch),this.settingData.show_reverse_switch||this.handleChange("reverse_node_ids",[])},selectNode:function(){for(var t=[],i=0;i<this.optionList.length;i++){var e=this.optionList[i];e.checked&&t.push({node_id:e.node_id,node_type:e.node_type,field:e.field})}this.handleChange("reverse_node_ids",t)}}},ft=(n(4750),Object(f.a)(vt,(function(){var t,e,n,o,r,l,c=this,d=c._self._c;return c.visible?d("div",{staticClass:"node-prompt-container"},[d("div",{staticClass:"head-area"},[d("div",{staticClass:"title"},[c._v(c._s(c.$t("ExampleImages")))]),c._v(" "),d("i",{staticClass:"iconfont icon-close",on:{click:c.close}})]),c._v(" "),d("div",{staticClass:"main-content"},[null!==(t=c.optionList)&&void 0!==t&&t.length?d("div",{staticClass:"label-head"},[d("div",{staticClass:"main"},[d("div",{staticClass:"label-title"},[c._v("\n          "+c._s(c.$t("smart_prompt"))+"\n          "),d("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:c.$t("app_publish_smart_prompt_hover"),placement:"top"}},[d("i",{staticClass:"iconfont icon-icon-information1"})])],1),c._v(" "),d("div",{staticClass:"label-content"},[d("el-switch",{on:{change:c.changeSwitch},model:{value:c.settingData.show_reverse_switch,callback:function(t){c.$set(c.settingData,"show_reverse_switch",t)},expression:"settingData.show_reverse_switch"}})],1)]),c._v(" "),null!==(e=c.settingData)&&void 0!==e&&e.show_reverse_switch?[d("div",{staticClass:"label-desc"},[d("span",{staticClass:"require"},[c._v("*")]),c._v("\n          "+c._s(c.$t("ai_app_smart_prompt_mode_choose"))+"\n        ")]),c._v(" "),d("div",{staticClass:"nodes"},[d("div",{staticClass:"image-node-option"},[d("el-radio",{attrs:{label:"comfy_ui_image"},on:{change:c.changeMode},model:{value:c.settingData.reverse_model_type,callback:function(t){c.$set(c.settingData,"reverse_model_type",t)},expression:"settingData.reverse_model_type"}},[c._v("\n              "+c._s(c.$t("ai_app_smart_prompt_image_mode"))+"\n            ")]),c._v(" "),d("el-radio",{attrs:{label:"comfy_ui_video"},on:{change:c.changeMode},model:{value:c.settingData.reverse_model_type,callback:function(t){c.$set(c.settingData,"reverse_model_type",t)},expression:"settingData.reverse_model_type"}},[c._v("\n              "+c._s(c.$t("ai_app_smart_prompt_video_mode"))+"\n            ")])],1)]),c._v(" "),d("div",{staticClass:"label-desc"},[d("span",{staticClass:"require"},[c._v("*")]),c._v("\n          "+c._s(c.$t("app_publish_smart_prompt_valid"))+"\n        ")]),c._v(" "),d("div",{staticClass:"nodes"},c._l(c.optionList,(function(option,t){return d("div",{key:"".concat(option.key),staticClass:"image-node-option"},[d("el-checkbox",{attrs:{label:option.key},on:{change:c.selectNode},model:{value:option.checked,callback:function(t){c.$set(option,"checked",t)},expression:"option.checked"}},[option.title?[c._v("\n                "+c._s(option.title)+"\n              ")]:c.showCustomTitle&&option.originTitle?[c._v("\n                "+c._s("[".concat(option.node_id,"]").concat(option.local_node_type||option.node_type,"(").concat(c.item.originTitle,") - ").concat(option.local_field||option.field))+"\n              ")]:[c._v("\n                "+c._s("[".concat(option.node_id,"]").concat(option.local_node_type||option.node_type," - ").concat(option.local_field||option.field))+"\n              ")]],2)],1)})),0)]:c._e()],2):c._e(),c._v(" "),d("div",{staticClass:"label-head"},[d("div",{staticClass:"main"},[d("div",{staticClass:"label-title"},[c._v("\n          "+c._s(c.$t("ExampleImages"))+"\n          "),d("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:c.$t("workflow_example_image"),placement:"top"}},[d("i",{staticClass:"iconfont icon-icon-information1"})])],1)])]),c._v(" "),d("div",{staticClass:"prompt-content"},[d("div",{staticClass:"image-grid"},[(null===(n=c.settingData)||void 0===n||null===(n=n.example_image)||void 0===n?void 0:n.length)<c.max?d("div",{staticClass:"image-item add-image",on:{click:function(t){return c.openUploadModal("example_image")}}},[d("div",{staticClass:"add-image-content"},[d("div",{staticClass:"add-text"},[c._v(c._s(c.$t("addImageModel")))]),c._v(" "),d("div",{staticClass:"add-hint"},[c._v("("+c._s(c.$t("workflow_example_image_add",{count:c.max}))+")")])])]):c._e(),c._v(" "),c._l(null===(o=c.settingData)||void 0===o?void 0:o.example_image,(function(image,t){return d("div",{key:t,staticClass:"image-item"},[d("div",{staticClass:"image-preview-container"},[d("img",{staticClass:"image-preview",attrs:{src:image,alt:"example image"}})]),c._v(" "),d("div",{staticClass:"delete-btn-container"},[d("div",{staticClass:"delete-btn",on:{click:function(e){return c.deleteData(t)}}},[c._v(c._s(c.$t("Remove")))])])])}))],2)]),c._v(" "),d("div",{staticClass:"label-head"},[d("div",{staticClass:"main"},[d("div",{staticClass:"label-title"},[c._v("\n          "+c._s(c.$t("arguments_desc"))+"\n        ")]),c._v(" "),d("div",{staticClass:"label-content"},[d("el-switch",{on:{change:function(t){return c.handleChange("show_icon_switch",t)}},model:{value:c.settingData.show_icon_switch,callback:function(t){c.$set(c.settingData,"show_icon_switch",t)},expression:"settingData.show_icon_switch"}})],1)])]),c._v(" "),c.settingData.show_icon_switch?[d("div",{staticClass:"prompt-content"},[d("div",{staticClass:"prompt-item"},[d("el-input",{staticClass:"input-item-textarea",attrs:{type:"textarea",placeholder:c.$t("arguments_desc_placeholder"),maxlength:"200",autosize:{minRows:3}},on:{change:function(t){return c.handleChange("icon_text",c.settingData.icon_text)}},model:{value:c.settingData.icon_text,callback:function(t){c.$set(c.settingData,"icon_text",t)},expression:"settingData.icon_text"}})],1),c._v(" "),d("div",{staticClass:"image-grid"},[null!==(r=c.settingData)&&void 0!==r&&r.icon_image?c._e():d("UploadImage",{staticClass:"upload-image-box",attrs:{category:68},on:{change:c.handleSelectIconImg}},[d("div",{staticClass:"image-item add-image"},[d("div",{staticClass:"add-image-content"},[d("div",{staticClass:"add-text"},[c._v(c._s(c.$t("addImageModel")))]),c._v(" "),d("div",{staticClass:"add-hint"},[c._v("("+c._s(c.$t("recommend_ratio",{ratio:"16:9"}))+")")])])])]),c._v(" "),null!==(l=c.settingData)&&void 0!==l&&l.icon_image?d("div",{staticClass:"image-item mt-10"},[d("div",{staticClass:"image-preview-container"},[d("img",{staticClass:"image-preview",attrs:{src:c.settingData.icon_image,alt:"icon-image"}})]),c._v(" "),d("div",{staticClass:"delete-btn-container"},[d("div",{staticClass:"delete-btn",on:{click:function(t){return c.deleteIconImage()}}},[c._v(c._s(c.$t("Remove")))])])]):c._e()],1)])]:c._e()],2),c._v(" "),d("hy-upload-moald",{ref:"HyUploadMoaldRef",attrs:{category:20,isMultiSelect:!0,uploadObj:{multiple:!0,limit:c.max,directUse:!0},fileTypes:["image"]},on:{onConfirm:c.handleSelectImg}})],1):c._e()}),[],!1,null,"0de50348",null).exports),mt={name:"InputNodeSetting",components:{UploadImage:lt},model:{prop:"visible"},props:{visible:{type:Boolean,default:!1},data:{type:Object,default:{}}},watch:{data:{handler:function(t){this.initData()},deep:!0}},mounted:function(){this.initData()},data:function(){return{max:1,form:{}}},methods:{initData:function(){this.form=N()(this.data)},openUploadModal:function(){this.$refs.HyUploadMoaldRef.openModal()},handleSelectImg:function(data){var t;null!=data&&data.length&&(this.$set(this.form,"icon_image",data[0]),this.updateData("icon_image",null===(t=this.form)||void 0===t?void 0:t.icon_image))},deleteIconImage:function(){var t;this.form.icon_image="",this.updateData("icon_image",null===(t=this.form)||void 0===t?void 0:t.icon_image)},close:function(){this.$emit("update:visible",!1)},updateData:function(t,data){this.$emit("change",t,data)}}},gt=(n(4751),Object(f.a)(mt,(function(){var t,e,n=this,o=n._self._c;return n.visible?o("div",{staticClass:"node-prompt-container"},[o("div",{staticClass:"head-area"},[o("div",{staticClass:"title"},[n._v(n._s(n.$t("AdvancedConfig")))]),n._v(" "),o("i",{staticClass:"iconfont icon-close",on:{click:n.close}})]),n._v(" "),o("div",{staticClass:"main-content"},[o("div",{staticClass:"label-head"},[o("div",{staticClass:"main"},[o("div",{staticClass:"label-title"},[n._v("\n          "+n._s(n.$t("arguments_desc"))+"\n        ")]),n._v(" "),o("div",{staticClass:"label-content"},[o("el-switch",{on:{change:function(t){return n.updateData("show_icon_switch",t)}},model:{value:n.form.show_icon_switch,callback:function(t){n.$set(n.form,"show_icon_switch",t)},expression:"form.show_icon_switch"}})],1)])]),n._v(" "),n.form.show_icon_switch?[o("div",{staticClass:"input-item"},[o("el-input",{staticClass:"input-item-textarea",attrs:{type:"textarea",placeholder:n.$t("arguments_desc_placeholder"),maxlength:"200",autosize:{minRows:3}},on:{change:function(t){return n.updateData("icon_text",n.form.icon_text)}},model:{value:n.form.icon_text,callback:function(t){n.$set(n.form,"icon_text",t)},expression:"form.icon_text"}})],1),n._v(" "),o("div",{staticClass:"image-grid"},[null!==(t=n.form)&&void 0!==t&&t.icon_image?n._e():o("UploadImage",{staticClass:"upload-image-box",attrs:{category:68},on:{change:n.handleSelectImg}},[o("div",{staticClass:"image-item add-image"},[o("div",{staticClass:"add-image-content"},[o("div",{staticClass:"add-text"},[n._v(n._s(n.$t("addImageModel")))]),n._v(" "),o("div",{staticClass:"add-hint"},[n._v("("+n._s(n.$t("recommend_ratio",{ratio:"16:9"}))+")")])])])]),n._v(" "),null!==(e=n.form)&&void 0!==e&&e.icon_image?o("div",{staticClass:"image-item"},[o("div",{staticClass:"image-preview-container"},[o("img",{staticClass:"image-preview",attrs:{src:n.form.icon_image,alt:"icon-image"}})]),n._v(" "),o("div",{staticClass:"delete-btn-container"},[o("div",{staticClass:"delete-btn",on:{click:function(t){return n.deleteIconImage()}}},[n._v(n._s(n.$t("Remove")))])])]):n._e()],1)]:n._e()],2)]):n._e()}),[],!1,null,"0b7d3c4e",null).exports),_t={name:"SelectInputParams",props:{workflowData:{type:Object,default:function(){}},inputDataConfig:{type:Array,default:[]},outputDataConfig:{type:Array,default:[]},updateInputData:{type:Function,default:function(){}},updateOutputData:{type:Function,default:function(){}}},components:{selectInputNode:z,selectOutputNode:K,draggable:E.a,inputNodeMultilingual:it,inputNodePrompt:ut,inputNodeExampleImage:ft,inputNodeSetting:gt},data:function(){return{inputNodeVisible:!0,outputNodeVisible:!1,inputNodeMultilingualVisible:!1,inputData:[],outputData:[],dragIndex:0,showCustomTitle:!0,prompt:{visible:!1,data:{}},exampleImage:{visible:!1,data:{}},selectInputNodeSetting:{visible:!1,data:{}}}},computed:{imageInputNodeList:function(){return this.inputData.filter((function(t){return 2==t.type}))},textInputNodeList:function(){return this.inputData.filter((function(t){return 1==t.type&&1==t.value_type}))}},methods:{clearData:function(){this.inputNodeVisible=!0,this.outputNodeVisible=!1,this.inputNodeMultilingualVisible=!1,this.showCustomTitle=!0,this.dragIndex=0,this.prompt={visible:!1,data:{}},this.exampleImage={visible:!1,data:{}},this.selectInputNodeSetting={visible:!1,data:{}}},initData:function(t,e){this.clearData(),this.inputData=t,this.outputData=e},closeLeftComponent:function(){this.prompt={visible:!1,data:{}},this.exampleImage={visible:!1,data:{}},this.selectInputNodeSetting={visible:!1,data:{}},this.inputNodeVisible=!1,this.outputNodeVisible=!1},addInputParameter:function(){this.closeLeftComponent(),this.inputNodeVisible=!0},addOutputParameter:function(){this.closeLeftComponent(),this.outputNodeVisible=!0},openInputNodeMultilingual:function(){this.inputNodeMultilingualVisible=!0},openInputNodeSetting:function(t){return this.closeLeftComponent(),1==t.type&&1==t.value_type?(this.prompt.data=t||{},void(this.prompt.visible=!0)):2==t.type?(this.exampleImage.data=t||{},void(this.exampleImage.visible=!0)):(this.selectInputNodeSetting.data=t||{},void(this.selectInputNodeSetting.visible=!0))},dragstart:function(t){this.dragIndex=t},dragenter:function(t,e){if(t.preventDefault(),this.dragIndex!==e){var n=this.inputData[this.dragIndex];this.inputData.splice(this.dragIndex,1),this.inputData.splice(e,0,n),this.dragIndex=e,this.handleUpdateInputData()}},dragover:function(t,e){t.preventDefault()},handleUpdateInputData:function(){this.$emit("updateInputData",this.inputData)},handleUpdateOutputData:function(){this.$emit("updateOutputData",this.outputData)},inputParamComfirm:function(option){if(option.checked){this.doLogEvent("click_input_node","","on_comfyui_encapsulation_page");var t=[1,"1"].includes(option.type)?this.$t("pleaseEnte"):this.$t("Pls_select");option.originTitle=option.title,option.title="".concat(t).concat(option.local_field||option.field),this.inputData.push(option),this.handleUpdateInputData()}else this.deleteInputParam(option)},deleteInputParam:function(option){var t=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){for(var e=option.node_id,n=option.node_type,o=option.field,r=option.key,i=0;i<t.inputData.length;i++){var l=t.inputData[i];if(l.key!=r){var c=(null==l?void 0:l.reverse_node_ids)||[],d=c.findIndex((function(t){return t.node_id==e&&t.node_type==n&&t.field==o}));d>=0&&c.splice(d,1);var h=(null==l?void 0:l.refine_node_ids)||[];h.findIndex((function(t){return t.node_id==e&&t.node_type==n&&t.field==o}))>=0&&h.splice(d,1)}else t.$refs.selectInputNodeRef.cancleNodeChecked(l,!1),t.inputData.splice(i,1),--i}t.updateInputSetting(option),t.handleUpdateInputData()})).catch((function(e){console.log("e",e),t.$refs.selectInputNodeRef.cancleNodeChecked(option,!0)}))},outputParamComfirm:function(option){if(option.checked){this.doLogEvent("click_output_node","","on_comfyui_encapsulation_page");var t=[1,"1"].includes(option.type)?this.$t("pleaseEnte"):this.$t("Pls_select");option.originTitle=option.title,option.title="".concat(t).concat(option.field),this.outputData.push(option),this.handleUpdateOutputData()}else this.deleteOutputParam(option)},deleteOutputParam:function(option){var t=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){for(var i=0;i<t.outputData.length;i++){var e=t.outputData[i];if(e.node_id===(null==option?void 0:option.node_id)&&e.node_type===option.node_type){t.$refs.selectOutputNodeRef.cancleNodeChecked(e,!1),t.outputData.splice(i,1);break}}t.handleUpdateOutputData()})).catch((function(){t.$refs.selectOutputNodeRef.cancleNodeChecked(option,!0)}))},inputNodeMultilingualConfirm:function(data){this.inputData=data,this.handleUpdateInputData()},inputNodeSettingChange:function(t,e,data){var n;t&&null!==(n=this[t])&&void 0!==n&&null!==(n=n.data)&&void 0!==n&&n.key&&(console.log("panelType",t,e,data),this.$set(this[t].data,e,data),this.handleUpdateInputData())},updateInputSetting:function(option){var t,e=this.prompt.data;option.key==(null==e?void 0:e.key)&&(this.prompt.data={},this.prompt.visible=!1);var n=this.exampleImage.data;option.key==(null==n?void 0:n.key)&&(this.exampleImage.data={},this.exampleImage.visible=!1),option.key==(null===(t=this.selectInputNodeSetting.data)||void 0===t?void 0:t.key)&&(this.selectInputNodeSetting.data={},this.selectInputNodeSetting.visible=!1)},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"on_comfyui_project_publish_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)}}},yt=_t,bt=(n(4752),Object(f.a)(yt,(function(){var t,e,n,o=this,r=o._self._c;return r("div",{staticClass:"select-input-params"},[r("div",{staticClass:"content-area"},[r("div",{staticClass:"left-area"},[r("div",{staticClass:"top-checkbox"},[r("el-checkbox",{model:{value:o.showCustomTitle,callback:function(t){o.showCustomTitle=t},expression:"showCustomTitle"}},[o._v(o._s(o.$t("workFlow50")))]),o._v(" "),r("span",{staticClass:"more-info",on:{click:o.openInputNodeMultilingual}},[o._v(o._s(o.$t("Multilingual")))])],1),o._v(" "),r("div",{staticClass:"add-param-btn",on:{click:o.addInputParameter}},[r("span",[r("i",{staticClass:"iconfont icon-add-icon"}),o._v(o._s(o.$t("workflow_add_input_params")))])]),o._v(" "),r("div",{staticClass:"param-list"},[r("transition-group",{staticClass:"list",attrs:{name:"drag"}},o._l(o.inputData,(function(t,e){return r("div",{key:t.key,staticClass:"param-item",attrs:{draggable:!0},on:{dragenter:function(t){return o.dragenter(t,e)},dragover:function(t){return o.dragover(t,e)},dragstart:function(t){return o.dragstart(e)}}},[r("div",{staticClass:"param-item-handle"},[r("i",{staticClass:"el-icon-rank"})]),o._v(" "),r("div",{staticClass:"param-item-content"},[r("div",{staticClass:"input-box"},[r("el-input",{staticClass:"param-item-title",attrs:{"suffix-icon":"el-icon-edit",placeholder:o.$t("pleaseEnte"),clearable:""},on:{input:function(t){return o.handleUpdateInputData()}},model:{value:t.title,callback:function(e){o.$set(t,"title",e)},expression:"item.title"}})],1),o._v(" "),o.showCustomTitle&&t.originTitle?r("div",{staticClass:"param-item-desc"},[o._v("\n                "+o._s("[".concat(t.node_id,"]").concat(t.local_node_type||t.node_type,"(").concat(t.originTitle,") - ").concat(t.local_field||t.field))+"\n              ")]):r("div",{staticClass:"param-item-desc"},[o._v("\n                "+o._s("[".concat(t.node_id,"]").concat(t.local_node_type||t.node_type," - ").concat(t.local_field||t.field))+"\n              ")])]),o._v(" "),r("div",{staticClass:"param-item-actions"},[r("i",{staticClass:"iconfont icon-setting",on:{click:function(e){return o.openInputNodeSetting(t)}}}),o._v(" "),r("i",{staticClass:"el-icon-delete",on:{click:function(e){return o.deleteInputParam(t)}}})])])})),0)],1),o._v(" "),r("div",{staticClass:"add-output-btn",on:{click:o.addOutputParameter}},[r("span",[r("i",{staticClass:"iconfont icon-add-icon"}),o._v(o._s(o.$t("workflow_add_output_params")))])]),o._v(" "),o._l(o.outputData,(function(t,e){return r("div",{key:t.node_id+t.node_type,staticClass:"preview-item"},[r("div",{staticClass:"preview-item-content"},[o.showCustomTitle&&t.originTitle?r("div",{staticClass:"preview-item-title"},[o._v("\n            "+o._s("[".concat(t.node_id,"]").concat(t.local_node_type||t.node_type,"(").concat(t.title,")"))+"\n          ")]):r("div",{staticClass:"preview-item-title"},[o._v("\n            "+o._s("[".concat(t.node_id,"]").concat(t.local_node_type||t.node_type))+"\n          ")])]),o._v(" "),r("div",{staticClass:"preview-item-actions"},[r("i",{staticClass:"el-icon-delete",on:{click:function(e){return o.deleteOutputParam(t)}}})])])}))],2),o._v(" "),r("div",{staticClass:"right-area"},[r("select-input-node",{ref:"selectInputNodeRef",attrs:{data:o.inputDataConfig,selectedData:o.inputData,visible:o.inputNodeVisible},on:{"update:visible":function(t){o.inputNodeVisible=t},comfirm:o.inputParamComfirm}}),o._v(" "),r("input-node-multilingual",{attrs:{visible:o.inputNodeMultilingualVisible,data:o.inputData},on:{"update:visible":function(t){o.inputNodeMultilingualVisible=t},confirm:o.inputNodeMultilingualConfirm}}),o._v(" "),r("input-node-prompt",{attrs:{visible:o.prompt.visible,data:o.prompt.data||{},showCustomTitle:o.showCustomTitle,options:o.imageInputNodeList,showRefineSwitch:null===(t=o.workflowData)||void 0===t?void 0:t.show_refine_switch,modelType:null===(e=o.workflowData)||void 0===e?void 0:e.model_type},on:{"update:visible":function(t){return o.$set(o.prompt,"visible",t)},change:function(t,data){return o.inputNodeSettingChange("prompt",t,data)}}}),o._v(" "),r("input-node-example-image",{attrs:{modelType:null===(n=o.workflowData)||void 0===n?void 0:n.model_type,visible:o.exampleImage.visible,data:o.exampleImage.data||{},options:o.textInputNodeList},on:{"update:visible":function(t){return o.$set(o.exampleImage,"visible",t)},change:function(t,data){return o.inputNodeSettingChange("exampleImage",t,data)}}}),o._v(" "),r("input-node-setting",{attrs:{visible:o.selectInputNodeSetting.visible,data:o.selectInputNodeSetting.data||{}},on:{"update:visible":function(t){return o.$set(o.selectInputNodeSetting,"visible",t)},change:function(t,data){return o.inputNodeSettingChange("selectInputNodeSetting",t,data)}}}),o._v(" "),r("select-output-node",{ref:"selectOutputNodeRef",attrs:{data:o.outputDataConfig,selectedData:o.outputData,visible:o.outputNodeVisible},on:{"update:visible":function(t){o.outputNodeVisible=t},comfirm:o.outputParamComfirm}})],1)])])}),[],!1,null,"71c0a1dc",null).exports);function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var kt={name:"nodeParams",props:{workflowList:{type:Array,default:function(){return[]}},selectWorkflow:{type:Function,default:function(){}},deleteWorkflow:{type:Function,default:function(){}},updateWorkflow:{type:Function,default:function(){}}},components:{SwtichWorkFlow:W,SelectNodeParams:bt},data:function(){return{firstLoad:!1,currentWorkflowIndex:0,inputData:[],outputData:[],inputDataConfig:[],outputDataConfig:[]}},watch:{workflowList:{handler:function(t){!this.firstLoad&&this.handleDataConfig()},deep:!0},currentWorkflowIndex:{handler:function(t){this.handleDataConfig()}}},mounted:function(){this.handleDataConfig()},methods:{switchWorkflow:function(t){this.currentWorkflowIndex=t,this.$emit("switchWorkflow",t)},confirmSubWorkflow:function(t){this.switchWorkflow(1),this.$emit("selectWorkflow",1,t)},deleteSubWorkflow:function(){this.switchWorkflow(0),this.$emit("deleteWorkflow",1)},updateWorkflowName:function(t,e){this.$emit("updateWorkflow",e,"name",t)},handleDataConfig:function(){var t=this;if(this.workflowList.length){this.firstLoad=!0;var e={},n={},o={};this.inputData=[],this.outputData=[],this.inputDataConfig=[],this.outputDataConfig=[];var r=this.workflowList[this.currentWorkflowIndex],l=N()((null==r?void 0:r.inputs)||[]);l.forEach((function(t){var n;t.show_reverse_switch=!(null==t||null===(n=t.reverse_node_ids)||void 0===n||!n.length),e["".concat(t.node_id,"_").concat(t.node_type,"_").concat(t.field)]=t})),((null==r?void 0:r.outputs)||[]).forEach((function(t){n["".concat(t.node_id,"_").concat(t.node_type)]=t})),((null==r?void 0:r.input_title_lang)||[]).forEach((function(t){o["".concat(t.node_id,"_").concat(t.node_type,"_").concat(t.field)]=t.val||{}})),this.inputDataConfig=((null==r?void 0:r.apply_input_param)||[]).map((function(n){var r,l,c=Ct({},n);return c.node_id=null==n||null===(r=n.options)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.node_id,c.expanded=!1,null==n||null===(l=n.options)||void 0===l||l.forEach((function(option,r){0==r&&(c.node_id=null==option?void 0:option.node_id),option.local_node_type=null==n?void 0:n.local_node_type,option.node_type=null==n?void 0:n.node_type,option.key="".concat(option.node_id,"_").concat(option.node_type,"_").concat(option.field);var select=e[option.key];select&&(select.isSelect=!0,select.title=select.title||option.title,select.langMap=o[option.key]||"",select.key=option.key,select.node_type=null==option?void 0:option.node_type,select.local_node_type=null==option?void 0:option.local_node_type),t.$set(option,"checked",!!select)})),c})),this.outputDataConfig=((null==r?void 0:r.apply_output_param)||[]).map((function(e){var o=Ct({},e);o.key="".concat(e.node_id,"_").concat(e.node_type);var select=n[o.key];return select&&t.outputData.push(o),t.$set(o,"checked",!!select),o})),this.$set(this,"inputData",l.filter((function(t){return t.isSelect}))),this.$refs.selectNodeParamsRef.initData(this.inputData,this.outputData)}},updateOutputData:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$set(this,"outputData",data),this.$emit("updateWorkflow",this.currentWorkflowIndex,"outputs",data)},updateInputData:function(){var t=[],e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){var n;return e.langMap&&null!==(n=Object.keys(e.langMap))&&void 0!==n&&n.length&&t.push({node_id:e.node_id,node_type:e.node_type,field:e.field,val:e.langMap}),{desc:"",field:e.field,local_field:e.local_field,node_id:null==e?void 0:e.node_id,node_type:e.node_type,local_node_type:e.local_node_type,title:e.title,type:e.type,value_type:e.value_type,val:e.val,option:(null==e?void 0:e.option)||{},example_text:(null==e?void 0:e.example_text)||[],example_image:(null==e?void 0:e.example_image)||[],langMap:null==e?void 0:e.langMap,show_reverse_switch:null==e?void 0:e.show_reverse_switch,show_refine_switch:null==e?void 0:e.show_refine_switch,reverse_node_ids:null==e?void 0:e.reverse_node_ids,refine_node_ids:null==e?void 0:e.refine_node_ids,reverse_model_type:null==e?void 0:e.reverse_model_type,icon_text:null==e?void 0:e.icon_text,icon_image:null==e?void 0:e.icon_image,show_icon_switch:null==e?void 0:e.show_icon_switch}}));this.$emit("updateWorkflow",this.currentWorkflowIndex,"input_title_lang",t),this.$emit("updateWorkflow",this.currentWorkflowIndex,"inputs",e),this.$set(this,"inputData",e)}}},Ot=kt,xt=(n(4753),Object(f.a)(Ot,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{staticClass:"node-params"},[l("SwtichWorkFlow",{attrs:{currentWorkflowIndex:r.currentWorkflowIndex,mainWorkflowName:null===(t=r.workflowList)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.name,mainWorkflowId:null===(e=r.workflowList)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.id,subWorkflowName:null===(n=r.workflowList)||void 0===n||null===(n=n[1])||void 0===n?void 0:n.name,subWorkflowId:null===(o=r.workflowList)||void 0===o||null===(o=o[1])||void 0===o?void 0:o.id},on:{confirmSubWorkflow:r.confirmSubWorkflow,deleteSubWorkflow:r.deleteSubWorkflow,updateWorkflowName:r.updateWorkflowName,switchWorkflow:r.switchWorkflow}}),r._v(" "),l("SelectNodeParams",{ref:"selectNodeParamsRef",attrs:{currentWorkflowIndex:r.currentWorkflowIndex,selectedInputData:r.inputData,selectedOutputData:r.outputData,inputDataConfig:r.inputDataConfig,workflowData:r.workflowList[r.currentWorkflowIndex],outputDataConfig:r.outputDataConfig},on:{updateInputData:r.updateInputData,updateOutputData:r.updateOutputData}})],1)}),[],!1,null,"0b0713f6",null).exports),Tt=n(80);function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Pt=F.s.map((function(t){return{key:t,value:""}})),It={name:"aiappPublish",components:{publishTopBar:y.a,effectExampleItem:w.a,exampleImgList:k.a,SwipeableList:O.default,LoadingStatus:S.default,CodeViewer:D.a,Multilingual:L.default,draggable:E.a,ElImageViewer:_.a,HyUploadMoald:R.default,NodeParams:xt,TreeSelect:m},mixins:[I.videoCoverMixIn],provide:function(){return{top:this}},data:function(){return{typeOptions:[],bigImgDialogVisible:!1,viewBigImgType:"introduction",allowPublish:!0,allowPromotion:!0,activeImg:"",activeIndex:-1,categories:[],currentPageType:"publish",exampleItemLimit:10,titleMaxlength:80,descMaxLength:3e3,formData:{name:"",name_18n_lang:{},is_modify_name:!1,desc:"",desc_18n_lang:{},is_modify_desc:!1,samples:[],categories:[]},rules:{name:[{required:!0,message:this.$t("comfyUpLoad4"),trigger:["change","blur"]}],samples:[{required:!0,message:this.$t("workFlow30"),trigger:["change","blur"]}],categories:[{required:!0,message:this.$t("comfyUpLoad7"),trigger:["change","blur"]}]},loading:!1,imageLoading:!1,UPLOAD:new C.a({type:2}),itemScroll:null,itemScrollLeft:null,isSubmitSuccess:!1,workflowConfig:{},workflowInfo:null,isReady:!1,work_flow_id:"",template_id:"",fromPage:"",uploadingVideo:!1,isApp:0,dragIndex:0,workflowList:[],workFlowIndex:0}},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.work_flow_id=t.$route.params.id,t.template_id=(null===(n=t.$route.query)||void 0===n?void 0:n.template_id)||"",t.resetFormData(),e.next=5,t.getWorkflowConfig();case 5:if(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.template_id){e.next=10;break}return e.next=8,t.getWorkflowDetail("reedit",0,t.work_flow_id);case 8:e.next=12;break;case 10:return e.next=12,t.getWorkflowInfo(0,"");case 12:t.getNewTagList(),t.isReady=!0;case 14:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.fromPage="",this.isApp=0},computed:Dt(Dt({},Object(c.e)("user",["userInfo","cdnHost"])),{},{getBigImg:function(){var t=this.$i18n.locale;return["zhCN","en","ja"].includes(t)?"https://".concat(this.cdnHost,"/static/comfyui/").concat(this.viewBigImgType,"/web_").concat(t,".webp"):"https://".concat(this.cdnHost,"/static/comfyui/").concat(this.viewBigImgType,"/web_en.webp")},acceptImage:function(){return this.enableUploadVideo?".jpg,.jpeg,.png,.webp,.gif":".jpg,.jpeg,.png,.webp"},fileTypes:function(){return this.enableUploadVideo?["image","gif"]:["image"]},enableUploadVideo:function(){var t;return null==this||null===(t=this.workflowConfig)||void 0===t?void 0:t.enable_video_cover},getDynamicHref:function(){return function(t){var e="Terms"===t,n=this.$i18n.locale?this.$i18n.locale:"en";return Object(x.a)(n,e,this.$isChinaSite)}},getInputDataList:function(){var t,e=(null===(t=this.workflowList)||void 0===t||null===(t=t[this.workFlowIndex])||void 0===t?void 0:t.inputs)||[],n=this.$i18n.locale?this.$i18n.locale:"en";return(e||[]).map((function(t){var title=t.title;return t.langMap&&(title=t.langMap[n]||title),Dt(Dt({},t),{},{isPreview:!0,title:title})}))},workFlowTabList:function(){return this.workflowList.map((function(t){return{name:t.name,id:t.id}}))},isPackagePage:function(){return"package"===this.currentPageType},getImageUrl:function(){return function(t){var e=(null==t?void 0:t.url)||"";if([2,"2"].includes(null==t?void 0:t.type)&&null!=t&&t.url){e=t.url.replace(/\.(mp4)/g,"_low.webp")}return e}}}),methods:{dragstart:function(t){this.dragIndex=t},dragenter:function(t,e){if(t.preventDefault(),this.dragIndex!==e){var n=this.formData.samples[this.dragIndex];this.formData.samples.splice(this.dragIndex,1),this.formData.samples.splice(e,0,n),this.dragIndex=e}},dragover:function(t,e){t.preventDefault(),this.dragIndex=e},viewBigImage:function(t){this.viewBigImgType=t,this.bigImgDialogVisible=!0},goPlan:function(){this.$logEvent("log_actions",{operation:"click_creator_revenue_center"}),window.open(this.localePath("/creationCenter"),"_blank")},handleMultilingual:function(t){var e=t.type,data=t.data,n=data.lang,o=data.originText,r={};n.forEach((function(t){r[t.key]=t.value})),"workflowName"===e?(this.formData.is_modify_name=this.formData.name!==o,this.formData.name_18n_lang=r,this.formData.name=o):(this.formData.is_modify_desc=this.formData.desc!==o,this.formData.desc_18n_lang=r,this.formData.desc=o)},handleChangeName:function(){this.formData.is_modify_name=!0},handleChangeDesc:function(){this.formData.is_modify_desc=!0},getLang:function(t){var e=N()(Pt);return Object.keys(t).forEach((function(n){var o=e.findIndex((function(t){return t.key===n}));-1!==o?e[o].value=t[n]:e.push({key:n,value:t[n]})})),e},openTranslateModal:function(t){var e=this,n="workflowName"===t.type,o=[];o=n?this.getLang(this.formData.name_18n_lang):this.getLang(this.formData.desc_18n_lang),this.$refs.translateModal.open(Dt(Dt({},t),{},{originText:n?this.formData.name:this.formData.desc,lang:o,beforeValidate:function(t){return e.batchQuerySensitiveWords({items:[{texts:t.lang.map((function(t){return{text:t.value,category:"workflow_multilingual_setting",point_type:n?"app-encapsulation-app-name-multilingual-settings@description":"app-encapsulation-introduction-multilingual-settings@description"}})),type:F.e.TitleDescription}]})}}))},getWorkflowDetail:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,r={id:o,ver_no:arguments.length>3?arguments[3]:void 0},l={};if(this.loading=!0,"reedit"===t){var c=localStorage.getItem("settingValues");if(c){var d=JSON.parse(c)["Comfy.Locale"];l["Accept-Language"]=d||""}}Object(T.i)(r,{headers:l}).then((function(r){var l,c,d,h,data=(null==r?void 0:r.data)||{};if("add"==t)return e.$set(e.workflowList[n],"inputs",(null==data?void 0:data.inputs)||[]),e.$set(e.workflowList[n],"outputs",(null==data?void 0:data.outputs)||[]),e.$set(e.workflowList[n],"input_title_lang",[]),void(null===(d=e.$refs)||void 0===d||null===(d=d.nodeParamsRef)||void 0===d||d.handleDataConfig());if("third"==t)e.allowPromotion=1===(null==data?void 0:data.ad),e.$set(e.workflowList[n],"inputs",(null==data?void 0:data.inputs)||[]),e.$set(e.workflowList[n],"outputs",(null==data?void 0:data.outputs)||[]),e.$set(e.workflowList[n],"input_title_lang",[]),null===(h=e.$refs)||void 0===h||null===(h=h.nodeParamsRef)||void 0===h||h.handleDataConfig();else if("sub"==t){var v;e.$set(e.workflowList,n,{apply_input_param:(null==data?void 0:data.apply_input_param)||[],apply_output_param:(null==data?void 0:data.apply_output_param)||[],inputs:(null==data?void 0:data.inputs)||[],outputs:(null==data?void 0:data.outputs)||[],input_title_lang:(null==data?void 0:data.input_title_lang)||[],id:"edit",name:null==data||null===(v=data.ver_infos)||void 0===v||null===(v=v[n])||void 0===v?void 0:v.ver_no_name})}else{var f,m;0==n&&(e.workflowInfo=data),e.$set(e.workflowList,n,Dt(Dt({},data),{},{name:(null==data||null===(f=data.ver_infos)||void 0===f||null===(f=f[n])||void 0===f?void 0:f.ver_no_name)||(null==data?void 0:data.name)})),e.formData.desc_18n_lang=(null==data?void 0:data.desc_18n_lang)||{},e.formData.name_18n_lang=(null==data?void 0:data.name_18n_lang)||{},e.allowPromotion=1===(null==data||null===(m=data.permission)||void 0===m?void 0:m.ad)}null!=data&&null!==(l=data.ver_infos)&&void 0!==l&&null!==(l=l[1])&&void 0!==l&&l.ver_no&&["reedit","third"].includes(t)&&e.getWorkflowDetail("sub",1,o,data.ver_infos[1].ver_no),e.formData.name=null==data?void 0:data.name,e.formData.desc=((null==data?void 0:data.desc)||"").replace(/<br\s*\/?>/gi,"\r\n"),e.formData.samples=(null==data?void 0:data.samples)||[],e.categories=((null==data?void 0:data.categories)||[]).map((function(t){return{name:null==t?void 0:t.name,id:null==t?void 0:t.value}})),e.formData.categories=((null==data?void 0:data.categories)||[]).map((function(t){return null==t?void 0:t.value})).filter((function(t){return!!t})),e.allowPublish=2===(null==data||null===(c=data.permission)||void 0===c?void 0:c.primary),e.isApp=[3,4,"3","4"].includes(null==data?void 0:data.type)})).finally((function(){e.loading=!1}))},changeVal:function(){},getWorkflowInfo:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,o={};o.id=this.$route.params.id,n&&(o.id=n),this.loading=!0;var r=localStorage.getItem("settingValues"),l="";r&&(l=JSON.parse(r)["Comfy.Locale"]),Object(T.f)(o,{headers:{"Accept-Language":l||""}}).then((function(o){var r,l,c,d=(null==o?void 0:o.data)||{},h=null==o||null===(r=o.data)||void 0===r?void 0:r.data;try{h=JSON.parse(h)}catch(t){}var v,f,data=Dt(Dt({},d),{},{data:h});(t.$set(t.workflowList,e,Dt(Dt({},data),{},{name:(null==data||null===(l=data.ver_infos)||void 0===l||null===(l=l[e])||void 0===l?void 0:l.ver_no_name)||(null==data?void 0:data.name)})),0==e&&(t.workflowInfo=data),3===(null===(c=t.workflowInfo)||void 0===c?void 0:c.source))?t.getWorkflowDetail(n?"add":"third",e,null===(v=t.workflowInfo)||void 0===v?void 0:v.source_id):null===(f=t.$refs)||void 0===f||null===(f=f.nodeParamsRef)||void 0===f||f.handleDataConfig()})).finally((function(){t.loading=!1}))},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"on_comfyui_project_publish_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},handleChange:function(){this.doLogEvent("click_publish_to_community")},handlePromotionChange:function(){this.doLogEvent("click_allow_promotion","","on_comfyui_encapsulation_page")},handleChangePageType:function(t){var e;if(this.fromPage&&[this.fromPage].includes("workflow")){var n="";[this.fromPage].includes("workflow")&&(n="click_back_to_work_page"),[this.fromPage].includes("workFlowDetail")&&(n="click_back_to_publish_template_page"),n&&this.doLogEvent(n,"","on_comfyui_encapsulation_page")}(null===(e=window)||void 0===e?void 0:e.history.length)>2?this.$router.back():this.$router.push(this.localePath("/"))},handleRemoveImage:function(t){var e=this.formData.samples.findIndex((function(e){return t.url&&e.url===(null==t?void 0:t.url)}));this.formData.samples.length&&this.formData.samples.splice(e,1)},carouselChange:function(t){this.activeIndex=t,this.changeScroll()},imgItemChange:function(t){this.$refs.imgCnt.setActiveItem(t),this.changeScroll()},getItemScrollLeft:function(){var t=this;this.$nextTick((function(){t.$refs.listItem&&t.$refs.listItem.forEach((function(e){var n;null!==(n=e.classList)&&void 0!==n&&n.contains("imgActivate")&&(t.itemScrollLeft=e.getBoundingClientRect().left)}))}))},changeScroll:function(){var t=this;this.$nextTick((function(){t.$refs.listItem.forEach((function(e,n){e.classList.contains("imgActivate")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))}))},resetFormData:function(){this.isSubmitSuccess=!1,this.isApp=0},handleSelect:function(i){var t;this.activeImg=(null==this||null===(t=this.formData)||void 0===t?void 0:t.samples[i])||""},handleChangeTab:function(){var t=arguments,e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!0,"package"!==(o=t.length>0&&void 0!==t[0]?t[0]:"")){n.next=14;break}if(e.doLogEvent("click_publish","","on_comfyui_encapsulation_tab"),e.$refs.infoForm.validate((function(t){r=t})),r){n.next=7;break}return n.abrupt("return");case 7:return n.prev=7,e.loading=!0,n.next=11,e.batchQuerySensitiveWords({items:[{texts:[{text:e.formData.name,category:"app_name",point_type:"app-encapsulation-app-name@description"},{text:e.formData.desc,category:"desc",point_type:"app-encapsulation-introduction@description"}],type:F.e.TitleDescription}]});case 11:return n.prev=11,e.loading=!1,n.finish(11);case 14:e.currentPageType=o;case 15:case"end":return n.stop()}}),n,null,[[7,,11,14]])})))()},getNewTagList:function(){var t=this;Object(j.b)({code:"c3fb4c9d-2080-4062-8d9a-dc9098623787"}).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.typeOptions=null==e||null===(o=e.data)||void 0===o?void 0:o.items)}))},getWorkflowConfig:function(){var t=this;return Object(T.g)().then((function(e){var n=Dt(Dt({},t.workflowConfig),(null==e?void 0:e.data)||{});t.$set(t,"workflowConfig",n),window.workflowConfig=t.workflowConfig})).catch((function(t){}))},handleSelectImg:function(data){var t=data.map((function(t){return{url:t.url,width:t.width,height:t.height,type:3}})),e=[].concat(Object(o.a)(this.formData.samples),Object(o.a)(t)).slice(-10).reduce((function(t,e){return t.find((function(t){return t.url===e.url}))||t.push(e),t}),[]);this.formData.samples=e,this.$refs.infoForm.clearValidate("samples")},handleImageUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/webp"],l=["image/gif"].includes(t.type),!e.loading){n.next=5;break}return n.abrupt("return");case 5:if(e.enableUploadVideo&&r.push("image/gif"),r.includes(t.type)){n.next=9;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 9:if(!(c=t)||c.size){n.next=12;break}return n.abrupt("return",!1);case 12:if(!(l&&c.size/1024/1024>5)){n.next=15;break}return e.$message.warning(e.$t("UploadImageExceedCustomMB",{number:5})),n.abrupt("return",!1);case 15:if(l||!(c.size/1024/1024>10)){n.next=26;break}return n.prev=16,n.next=19,Object($.a)(c,10485760);case 19:c=n.sent,n.next=26;break;case 22:return n.prev=22,n.t0=n.catch(16),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 26:return n.next=28,e.checkImageSize(t);case 28:if(d=n.sent,e.base64RoleUrl=d.url||"",!e.imageLoading){n.next=32;break}return n.abrupt("return");case 32:return e.imageLoading=!0,o.startUpload(c,{category:20}).then((function(t){var n={width:d.width,height:d.height,type:3,url:t};e.formData.samples.length<e.exampleItemLimit&&(e.formData.samples.push(n),e.$refs.infoForm.clearValidate("samples")),e.imageLoading=!1})).catch((function(t){e.$message.error(e.$t("uploadError")),e.imageLoading=!1})),n.abrupt("return",!1);case 35:case"end":return n.stop()}}),n,null,[[16,22]])})))()},handleVideoUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.loading){n.next=2;break}return n.abrupt("return");case 2:if(e.uploadingVideo=!0,["video/mp4"].includes(t.type)){n.next=7;break}return e.uploadingVideo=!1,n.abrupt("return",e.$message.warning(e.$t("OnlySupportVideo")));case 7:if(o=t.size,!(o>5242880)){n.next=14;break}return e.$message.warning(e.$t("ExceedingNumberMB",{number:5})),e.uploadingVideo=!1,n.abrupt("return");case 14:return r=URL.createObjectURL(t),n.next=17,e.getVideoBasicInfo(r);case 17:return l=n.sent,URL.revokeObjectURL(r),e.handleUploadVideo(t,l),n.abrupt("return",!1);case 21:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};new P.a({file:t,category:56}).beforeUpload().then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(o){var r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o.url,l={width:null==n?void 0:n.width,height:null==n?void 0:n.height,duration:Math.ceil((null==n?void 0:n.duration)||0),type:2,url:r},e.formData.samples.length<e.exampleItemLimit&&(e.formData.samples.push(l),e.$refs.infoForm.clearValidate("samples")),e.uploadingVideo=!1;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.uploadingVideo=!1}))},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},submitData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,i,o,r,l,c,d,h,v,f,m,_,y,w,C,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isApp||"package"===t.currentPageType){e.next=3;break}return t.handleChangeTab("package"),e.abrupt("return");case 3:if(!t.loading&&!t.isSubmitSuccess){e.next=5;break}return e.abrupt("return");case 5:if("publish"===t.currentPageType&&t.doLogEvent("click_confirm_publish"),"package"===t.currentPageType&&t.doLogEvent("click_publish","","on_comfyui_encapsulation_page"),n=!0,t.$refs.infoForm.validate((function(t){n=t})),n){e.next=11;break}return e.abrupt("return");case 11:i=0;case 12:if(!(i<t.workflowList.length)){e.next=36;break}if(null!=(l=t.workflowList[i])&&null!==(o=l.outputs)&&void 0!==o&&o.length){e.next=17;break}return t.$message.warning(t.$t("workFlow42")),e.abrupt("return");case 17:c=null==l||null===(r=l.inputs)||void 0===r?void 0:r.filter((function(t){return 2==t.type})),d=0;case 19:if(!(d<(null==l||null===(h=l.inputs)||void 0===h?void 0:h.length))){e.next=33;break}if(v=l.inputs[d]||{},f=v.show_reverse_switch,m=v.reverse_node_ids,_=v.refine_node_ids,y=v.show_refine_switch,w=v.reverse_model_type,C=v.type,k=v.value_type,2!=C||!f||w){e.next=24;break}return t.$message.warning(t.$t("ai_app_smart_prompt_mode_choose")),e.abrupt("return");case 24:if(2!=C||!f||null!=m&&m.length){e.next=27;break}return t.$message.warning(t.$t("app_publish_smart_prompt_valid")),e.abrupt("return");case 27:if(1!=C||1!=k||!l.show_refine_switch||"video"!=l.model_type||!y||null!=_&&_.length||!c.length){e.next=30;break}return t.$message.warning(t.$t("app_publish_polish_relative_label")),e.abrupt("return");case 30:d++,e.next=19;break;case 33:i++,e.next=12;break;case 36:return e.next=38,t.dataSensitiveValid();case 38:t.postData();case 39:case"end":return e.stop()}}),e)})))()},dataSensitiveValid:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,r,l,c,i,d,h,v,f,title,m,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],r=[],l=[],c=[],i=0;i<t.workflowList.length;i++)for(d=t.workflowList[i],n.push({text:d.name,category:"workflow_name",point_type:"app-encapsulation-primary-secondary-workflowname@description"}),h=0;h<(null==d||null===(v=d.inputs)||void 0===v?void 0:v.length);h++)f=d.inputs[h]||{},title=f.title,m=f.example_text,_=void 0===m?[]:m,y=f.icon_text,r.push({text:title,category:"node_name",point_type:"app-encapsulation-custom-nodename@description"}),null!=_&&_.length&&(l=l.concat(null==_?void 0:_.map((function(text){return{text:text,category:"example_text",point_type:"app-encapsulation-advanced-settings@prompt"}})))),y&&c.push({text:y,category:"arguments_desc",point_type:"app-encapsulation-parameter@description"});return e.prev=5,t.loading=!0,e.next=9,t.batchQuerySensitiveWords({items:[{texts:[].concat(n,r,c),type:F.e.TitleDescription},{texts:Object(o.a)(l),type:F.e.GenerateCreate}]});case 9:return e.prev=9,t.loading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[5,,9,12]])})))()},postData:function(){var t,e,n=this,param={};this.loading=!0;for(var o=[],i=0;i<this.workflowList.length;i++){var r=this.workflowList[i],l=r.id;!this.template_id||0!=i&&"edit"!=r.id||(l=""),o.push({id:l,work_flow_name:r.name,input_title_lang:r.input_title_lang,outputs:r.outputs||[],inputs:r.inputs||[]})}param.work_flow_input_outputs=o,param.type="package"===this.currentPageType?2:1,param.ad=this.allowPromotion?1:2,param.id=this.workflowInfo.id,["",null,void 0].includes(this.template_id)&&(param.work_flow_id=this.work_flow_id);var c=this.formData,desc=c.desc,d=c.desc_18n_lang,h=c.is_modify_desc,v=c.name,f=c.name_18n_lang,m=c.is_modify_name,_=c.samples,y=c.categories;param.desc=(desc||"").replace(/\n/g,"<br>"),param.desc_18n_lang=d,param.is_modify_desc=h,param.name=v,param.name_18n_lang=f,param.is_modify_name=m,param.samples=_,param.publish=this.allowPublish?1:2,param.categories=y||[];var w,C=3===(null===(t=this.workflowInfo)||void 0===t?void 0:t.source)||this.template_id?T.o:T.n;3===(null===(e=this.workflowInfo)||void 0===e?void 0:e.source)&&(param.id=null===(w=this.workflowInfo)||void 0===w?void 0:w.source_id);C(param).then((function(t){var e;1e4===(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&(n.isSubmitSuccess=!0,n.$message.success(n.$t("CreativeCenterPopup30")),n.$router.push(n.localePath({path:"/personal",query:{tab:"WorkflowAIAPP"}})))})).finally((function(){n.loading=!1}))},selectWorkflow:function(t,e){this.deleteWorkflow(t),this.getWorkflowInfo(t,e)},deleteWorkflow:function(t){this.workflowList.splice(t,1)},updateWorkflow:function(t,e,n){this.workflowList[t]&&this.$set(this.workflowList[t],e,n)},switchWorkflow:function(t){var e;this.workFlowIndex=t,null===(e=this.$refs)||void 0===e||null===(e=e.codeViewerRef)||void 0===e||e.changeWorkflow(t)},changeWorkflow:function(t){this.workFlowIndex=t},batchQuerySensitiveWords:function(t){var e=this,n={app_name:"app_name",desc:"Introduction",workflow_name:"workflow_name",node_name:"node_name",example_text:"workflow_example_clues",arguments_desc:"arguments_desc",workflow_multilingual_setting:"workflow_multilingual_setting"};return new Promise((function(o,r){Object(Tt.b)(t).then((function(t){var l,data=(null==t?void 0:t.data)||{};if(1e4!==(null==t||null===(l=t.status)||void 0===l?void 0:l.code)&&r(!1),null!=data&&data.has_sensitive_word){var c=data.sensitive_categories||[];e.$message.error(e.$t("audio_Inpu_detection1",{X:e.$t(n[c[0]])})),r(!1)}else o(!0)})).catch((function(t){r(!1)}))}))}},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPage=(null==e?void 0:e.name)||""}))}},$t=It,jt=(n(4754),n(4755),Object(f.a)($t,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"p-aiapp-publish"},[e.isReady?[n("publish-top-bar",{attrs:{type:"aiapp",currentStep:e.isPackagePage?2:1},on:{changePageType:e.handleChangePageType}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],staticClass:"aiapp-publish-container"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"aiapp-publish-container-left"},[n("div",{staticClass:"publish-container-left-container"},[n("el-form",{ref:"infoForm",staticClass:"custom-form",attrs:{"label-position":"top",model:e.formData,rules:e.rules}},[n("el-form-item",{attrs:{label:e.$t("app_name"),prop:"name"}},[n("div",{staticClass:"translate-btn",on:{click:function(t){e.openTranslateModal({title:e.$t("app_name"),type:"workflowName"})}}},[e._v("\n                  "+e._s(e.$t("Multilingual"))+"\n                ")]),e._v(" "),n("el-input",{staticClass:"title-input",attrs:{placeholder:e.$t("WorkflowNameTip"),"show-word-limit":"",maxlength:e.titleMaxlength},on:{change:e.handleChangeName},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"desc"}},[n("template",{slot:"label"},[n("span",{staticClass:"big-img-icon-wrap"},[e._v("\n                    "+e._s(e.$t("Introduction"))+"\n                    "),n("i",{staticClass:"iconfont icon-help-icon big-img-icon",on:{click:function(t){return e.viewBigImage("introduction")}}})])]),e._v(" "),n("div",{staticClass:"translate-btn",on:{click:function(t){e.openTranslateModal({title:e.$t("Introduction"),type:"workflowDesc"})}}},[e._v("\n                  "+e._s(e.$t("Multilingual"))+"\n                ")]),e._v(" "),n("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:e.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:e.descMaxLength},on:{change:e.handleChangeDesc},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],2),e._v(" "),n("el-form-item",{attrs:{prop:"samples"}},[n("template",{slot:"label"},[n("span",{staticClass:"big-img-icon-wrap"},[e._v("\n                    "+e._s(e.$t("CoverImg"))+"\n                    "),n("i",{staticClass:"iconfont icon-help-icon big-img-icon",on:{click:function(t){return e.viewBigImage("cover")}}})])]),e._v(" "),n("div",{staticClass:"effect-example-upload-box"},[n("div",{staticClass:"upload-item-wrap"},[null!==(t=e.formData)&&void 0!==t&&null!==(t=t.samples)&&void 0!==t&&t.length?e._l(e.formData.samples,(function(t,o){return n("div",{key:t.url+o,staticClass:"effect-example-item-wrap",attrs:{draggable:!0},on:{dragenter:function(t){return e.dragenter(t,o)},dragover:function(t){return e.dragover(t,o)},dragstart:function(t){return e.dragstart(o)}}},[n("effect-example-item",{attrs:{source:t},on:{removeImage:function(t){return e.handleRemoveImage(t,o)}}})],1)})):e._e(),e._v(" "),e.formData.samples.length<10?n("div",{staticClass:"upload-item",on:{click:function(t){return e.$refs.HyUploadMoaldRef.openModal()}}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.imageLoading,expression:"imageLoading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleImageUpload,disabled:"",accept:e.acceptImage,"http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("UploadImg")))]),e._v(" "),n("div",{staticClass:"upload-item-text-tips"},[e._v(e._s(e.$t("ComfyuiUploadImgTips")))])])])],1):e._e(),e._v(" "),e.enableUploadVideo&&e.formData.samples.length<10?n("div",{staticClass:"upload-item"},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadingVideo,expression:"uploadingVideo"}],key:"videoUpload",ref:"videoUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleVideoUpload,disabled:e.uploadingVideo,accept:"video/mp4","http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("selectingMaterialsType3")))])])])],1):e._e()],2)])],2),e._v(" "),n("el-form-item",{attrs:{label:e.$t("categoryTags"),prop:"categories"}},[n("TreeSelect",{attrs:{treeData:e.typeOptions,categories:e.categories,placeholder:e.$t("TagsAssociationTips")},on:{change:e.handleChange},model:{value:e.formData.categories,callback:function(t){e.$set(e.formData,"categories",t)},expression:"formData.categories"}})],1)],1),e._v(" "),n("div",{staticClass:"bottom-btn-box"},[n("el-button",{staticClass:"publish-btn",attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.handleChangeTab("package")}}},[e._v(e._s(e.$t("NextStep"))+"\n              ")])],1)],1)]),e._v(" "),n("div",{staticClass:"aiapp-publish-container-right"},[n("div",{staticClass:"image-view-area",style:{width:"100%"}},[n("div",{staticClass:"imgInfo"},[n("el-carousel",{ref:"imgCnt",attrs:{autoplay:!1,arrow:"never","initial-index":e.activeIndex,"indicator-position":"none"},on:{change:function(t,n){return e.carouselChange(t)}}},e._l(e.formData.samples,(function(t,e){return n("el-carousel-item",{key:e},[[2,"2"].includes(null==t?void 0:t.type)?n("video",{staticClass:"img-info-video",style:{maxWidth:"100%",maxHeight:"100%"},attrs:{src:null==t?void 0:t.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):n("img",{attrs:{src:t.url||t.cover,alt:""}})])})),1)],1),e._v(" "),n("div",{staticClass:"imgList"},[n("swipeable-list",{attrs:{scrollLeftnum:e.itemScrollLeft,scrollChange:e.itemScroll,top:"0px",height:"100%",isShowIconBtn:!1,needInScroll:!0}},e._l(e.formData.samples,(function(t,o){return n("div",{key:o,ref:"listItem",refInFor:!0,staticClass:"imgItem",class:{imgActivate:o===e.activeIndex},on:{click:function(t){return e.imgItemChange(o)}}},[n("img",{attrs:{src:e.getImageUrl(t),alt:""}})])})),0)],1)])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"package"===e.currentPageType,expression:"currentPageType === 'package'"}],staticClass:"aiapp-publish-container aiapp-publish-container-package"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"aiapp-publish-container-left"},[n("div",{staticClass:"publish-container-left-container"},[n("NodeParams",{ref:"nodeParamsRef",attrs:{workflowList:e.workflowList},on:{selectWorkflow:e.selectWorkflow,deleteWorkflow:e.deleteWorkflow,updateWorkflow:e.updateWorkflow,switchWorkflow:e.switchWorkflow}})],1)]),e._v(" "),n("div",{staticClass:"aiapp-publish-container-right flex-package"},[n("div",{staticClass:"package-config-area"},[n("div",{staticClass:"package-config-area-header"},[n("span",{staticClass:"package-config-area-header-title"},[e._v(e._s(e.$t("workFlow40")))]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("AiappCodeViewerTip"),placement:"top"}},[n("span",{staticClass:"iconfont icon-help-icon aiapp-tips"})])],1),e._v(" "),n("code-viewer",{ref:"codeViewerRef",staticClass:"code-viewer",attrs:{"code-view-data":e.getInputDataList,"is-show-previte":!1,"work-flow-tab-list":e.workFlowTabList,index:e.workFlowIndex},on:{changeWorkflow:e.changeWorkflow}})],1)])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isPackagePage,expression:"isPackagePage"}],staticClass:"package-operate-bar"},[n("div",{staticClass:"package-operate-bar-left"},[n("div",{staticClass:"bottom-checkbox-wrap"},[n("p",{staticClass:"bottom-checkbox-wrap-text"},[e._v(e._s(e.$t("workFlow43")))]),e._v(" "),n("el-checkbox",{staticClass:"bottom-checkbox-wrap-motivating",on:{change:e.handlePromotionChange},model:{value:e.allowPromotion,callback:function(t){e.allowPromotion=t},expression:"allowPromotion"}},[n("span",[e._v(e._s(e.$t("JoinSeaart")))]),e._v(" "),n("span",{staticClass:"motivating-title",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.goPlan.apply(null,arguments)}}},[e._v(e._s(e.$t("motivatingTitle")))]),e._v(" "),n("span",[e._v(e._s(e.$t("DivideUpCash")))])]),e._v(" "),n("el-checkbox",{on:{change:e.handleChange},model:{value:e.allowPublish,callback:function(t){e.allowPublish=t},expression:"allowPublish"}},[e._v(e._s(e.$t("PublishAiappToCommunity")))])],1)]),e._v(" "),n("div",{staticClass:"package-operate-bar-right"},[n("el-button",{staticClass:"back-btn",attrs:{type:"primary"},on:{click:function(t){return e.handleChangeTab("publish")}}},[e._v(e._s(e.$t("PreNext")))]),e._v(" "),n("el-button",{staticClass:"publish-btn",attrs:{type:"primary",loading:e.loading,disabled:e.loading},on:{click:e.submitData}},[e._v(e._s(e.$t("releaseName"))+"\n          ")])],1)])]:n("LoadingStatus",{attrs:{bgColor:"#02050e"}}),e._v(" "),e.bigImgDialogVisible?n("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":function(){e.bigImgDialogVisible=!1},"url-list":[e.getBigImg]}}):e._e(),e._v(" "),n("Multilingual",{ref:"translateModal",on:{handleMultilingual:e.handleMultilingual}}),e._v(" "),n("HyUploadMoald",{ref:"HyUploadMoaldRef",attrs:{category:68,scene:"comfyui_green",isMultiSelect:!0,uploadObj:{multiple:!0,limit:e.exampleItemLimit,directUse:!0},fileTypes:e.fileTypes},on:{onConfirm:e.handleSelectImg}})],2)}),[],!1,null,"817a6cb2",null));e.default=jt.exports;installComponents(jt,{SwipeableList:n(52).default,LoadingStatus:n(213).default,Multilingual:n(566).default})},5739:function(t,e,n){"use strict";n.r(e);var o=n(2),r=(n(11),n(19),n(6),n(12),n(13),n(8),n(4),n(7),n(16),{name:"StateIcon",props:{state:{type:String,required:!0},stateData:{type:Object,default:function(){return{}}}},computed:{iconThemeClass:function(){return{processing:"theme-green",completed:"theme-green",threeds_verifying:"theme-blue",threeds_timeout:"theme-blue",threeds_failed:"theme-red",payment_blocked:"theme-red",payment_timeout:"theme-red",insufficient_funds:"theme-red",failed:"theme-red"}[this.state]||"theme-gray"},iconClass:function(){return{processing:"icon-anquan1",completed:"icon-anquan1",threeds_verifying:"icon-yanzheng",threeds_timeout:"icon-chaoshi",threeds_failed:"icon-tishi01",payment_blocked:"icon-tishi02",payment_timeout:"icon-tishi02",insufficient_funds:"icon-yuebuzu",failed:"icon-anquan1"}[this.state]||"icon-anquan1"}}}),l=(n(5597),n(0)),c=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"state-icon",class:t.iconThemeClass},[e("div",{staticClass:"concentric-circles"},[e("div",{staticClass:"circle circle-outer"}),t._v(" "),e("div",{staticClass:"circle circle-middle"}),t._v(" "),e("div",{staticClass:"circle circle-inner"},[e("i",{staticClass:"iconfont",class:t.iconClass})])])])}),[],!1,null,"02dc5755",null).exports,d={name:"StateTitle",props:{state:{type:String,required:!0},stateData:{type:Object,default:function(){return{}}}},computed:{titleKeyMap:function(){return{idle:"paying",processing:"paying",threeds_verifying:"verifying",threeds_timeout:"verificationTimeout",threeds_failed:"verificationFailed",payment_blocked:"unableToProcessDebit",payment_timeout:"paymentTimeout",insufficient_funds:"insufficientBalance",completed:"paying",failed:"unableToProcessDebit"}},descKeyMap:function(){return{idle:"paying",processing:"paying",threeds_verifying:"paying",threeds_timeout:"verificationTimeout",threeds_failed:"verificationTimeout",payment_blocked:"unableToProcessDebit",payment_timeout:"paymentTimeout",insufficient_funds:"unableToProcessDebit",completed:"paying",failed:"paying"}},stateTitle:function(){var t=this.titleKeyMap[this.state]||"paying",e="paymentStateTitle_".concat(t);return this.$t(e)},stateDescription:function(){var t=this.descKeyMap[this.state]||"paying",e="paymentStateDesc_".concat(t);return this.$t(e)}}},h=(n(5598),Object(l.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"state-title",class:"state-".concat(t.state)},[e("h2",{staticClass:"title"},[t._v(t._s(t.stateTitle))]),t._v(" "),t.stateDescription?e("p",{staticClass:"description"},[t._v(t._s(t.stateDescription))]):t._e()])}),[],!1,null,"16dfb750",null).exports),v=(n(18),n(31),{name:"PaymentProviders",props:{providers:{type:Array,default:function(){return[{name:"VISA",icon:"visa",imageClass:"visa-image"},{name:"MasterCard",icon:"mastercard",imageClass:"mastercard-image"},{name:"UnionPay",icon:"unionpay",imageClass:"unionpay-image"},{name:"SafeKey",icon:"safekey",imageClass:"safekey-image"},{name:"ProtectBuy",icon:"protectbuy",imageClass:"protectbuy-image"},{name:"JCB",icon:"jcb",imageClass:"jcb-image"},{name:"PCI",icon:"pci",imageClass:"pci-image"},{name:"APWG",icon:"apwg",imageClass:"apwg-image"}]}},currentProvider:{type:String,default:""}},computed:{firstRowProviders:function(){return this.providers.slice(0,4)},secondRowProviders:function(){return this.providers.slice(4,8)}},methods:{getProviderImage:function(t){try{return n(5708)("./".concat(t,".png"))}catch(e){return console.warn("Payment provider icon not found: ".concat(t)),""}}}}),f=(n(5599),Object(l.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"payment-providers"},[e("div",{staticClass:"providers-container"},[e("div",{staticClass:"providers-row"},t._l(t.firstRowProviders,(function(n,o){return e("div",{key:n.name+o,staticClass:"provider-item",class:{current:n.name===t.currentProvider}},[e("img",{staticClass:"provider-image",class:n.imageClass,attrs:{src:t.getProviderImage(n.icon),alt:n.name}})])})),0),t._v(" "),e("div",{staticClass:"providers-row"},t._l(t.secondRowProviders,(function(n,o){return e("div",{key:n.name+o,staticClass:"provider-item",class:{current:n.name===t.currentProvider}},[e("img",{staticClass:"provider-image",class:n.imageClass,attrs:{src:t.getProviderImage(n.icon),alt:n.name}})])})),0)])])}),[],!1,null,"5d5c3ea6",null).exports),m=n(25);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"StateActions",props:{state:{type:String,required:!0},stateData:{type:Object,default:function(){return{}}}},computed:{hasActions:function(){return this.leftAction||this.rightAction},leftAction:function(){return["threeds_timeout","threeds_failed","payment_blocked","payment_timeout","insufficient_funds","failed"].includes(this.state)?{key:"change-payment",label:this.$t("paymentStateAction_changePaymentMethod"),icon:"",loading:!1,disabled:!1}:null},rightAction:function(){var t={threeds_timeout:"revalidation",threeds_failed:"revalidation",payment_blocked:"replacementCard",payment_timeout:"continueToPay",insufficient_funds:"replacementCard",failed:"replacementCard"}[this.state];return t?{key:"retry",label:this.$t("paymentStateAction_".concat(t)),icon:"",loading:!1,disabled:!1}:null}},methods:{handleAction:Object(m.debounce)((function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trackButtonClick(t,e),this.$emit("action",t,y(y({},e),{},{state:this.state,stateData:this.stateData,timestamp:Date.now()}))}),300),trackButtonClick:function(t){var e,n,o,r,l,c,d,h,v="change-payment"===t?"left":"right",f={front_operation:"click",entity_name:"payment_state_action_".concat(t),entity_type:"payment_state_button",obj_info:{action_key:t,button_position:v,process_type:{processing:"processing",threeds_verifying:"threeds_verifying",threeds_timeout:"threeds_timeout",threeds_failed:"threeds_failed",payment_blocked:"payment_blocked",payment_timeout:"payment_timeout",insufficient_funds:"insufficient_funds"}[this.state]||this.state,from_state:(null===(e=this.stateData)||void 0===e?void 0:e.previousState)||"unknown",state_type:"intermediate",benefit_type:(null===(n=this.stateData)||void 0===n?void 0:n.benefit_type)||"unknown",order_id:(null===(o=this.stateData)||void 0===o?void 0:o.order_id)||(null===(r=this.stateData)||void 0===r?void 0:r.thirdOrderId)||"unknown",card_type:(null===(l=this.stateData)||void 0===l?void 0:l.card_type)||2,payment_method:(null===(c=this.stateData)||void 0===c?void 0:c.paymentMethod)||"unknown",button_text:"left"===v?(null===(d=this.leftAction)||void 0===d?void 0:d.label)||"unknown":(null===(h=this.rightAction)||void 0===h?void 0:h.label)||"unknown",timestamp:Date.now()}};this.$xyLogEvent(f)}}},C=w,k=(n(5600),Object(l.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"state-actions",class:"state-".concat(t.state)},[e("div",{staticClass:"actions-container"},[t.hasActions?e("div",{staticClass:"button-actions"},[t.leftAction?e("el-button",{staticClass:"action-button left-button",attrs:{loading:t.leftAction.loading,disabled:t.leftAction.disabled},on:{click:function(e){return t.handleAction(t.leftAction.key,t.leftAction.data)}}},[t.leftAction.icon?e("i",{class:t.leftAction.icon}):t._e(),t._v("\n        "+t._s(t.leftAction.label)+"\n      ")]):t._e(),t._v(" "),t.rightAction?e("el-button",{staticClass:"action-button right-button",attrs:{loading:t.rightAction.loading,disabled:t.rightAction.disabled},on:{click:function(e){return t.handleAction(t.rightAction.key,t.rightAction.data)}}},[t.rightAction.icon?e("i",{class:t.rightAction.icon}):t._e(),t._v("\n        "+t._s(t.rightAction.label)+"\n      ")]):t._e()],1):t._e()])])}),[],!1,null,"bab2907c",null).exports),O={name:"StateNotificationBanner",props:{message:{type:String,default:""}}};n(5601);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={name:"PaymentStateDisplay",components:{StateIcon:c,StateTitle:h,PaymentProviders:f,StateActions:k,StateNotificationBanner:Object(l.a)(O,(function(){var t=this,e=t._self._c;return t.message?e("div",{staticClass:"state-notification-banner banner-warning"},[e("div",{staticClass:"banner-content"},[t._m(0),t._v(" "),e("div",{staticClass:"banner-text"},[e("span",[t._v(t._s(t.message))])])])]):t._e()}),[function(){var t=this._self._c;return t("div",{staticClass:"banner-icon"},[t("i",{staticClass:"el-icon-warning-outline"})])}],!1,null,"167df910",null).exports},props:{currentState:{type:String,required:!0},stateData:{type:Object,default:function(){return{}}}},computed:{showNotification:function(){return"threeds_verifying"===this.currentState},showIcon:function(){return!0},showTitle:function(){return!0},showProviders:function(){return!0},showActions:function(){return["threeds_timeout","threeds_failed","payment_blocked","payment_timeout","insufficient_funds","failed"].includes(this.currentState)}},methods:{handleAction:function(t){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$emit("action",t,T(T({},data),{},{fromState:this.currentState,timestamp:Date.now()}))}}},D=S;n(5602);function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={name:"PaymentIntermediateDisplay",components:{PaymentStateDisplay:Object(l.a)(D,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"payment-state-display",class:"state-".concat(t.currentState)},[t.showNotification?e("div",{staticClass:"state-notification-section"},[e("StateNotificationBanner",{attrs:{message:t.stateData.notificationMessage}})],1):t._e(),t._v(" "),t.showIcon?e("div",{staticClass:"state-icon-section"},[e("StateIcon",{attrs:{state:t.currentState,"state-data":t.stateData}})],1):t._e(),t._v(" "),t.showTitle?e("div",{staticClass:"state-title-section"},[e("StateTitle",{attrs:{state:t.currentState,"state-data":t.stateData}})],1):t._e(),t._v(" "),t.showProviders?e("div",{staticClass:"payment-providers-section"},[e("PaymentProviders",{attrs:{"current-provider":t.stateData.currentProvider}})],1):t._e(),t._v(" "),t.showActions?e("div",{staticClass:"state-actions-section"},[e("StateActions",{attrs:{state:t.currentState,"state-data":t.stateData},on:{action:t.handleAction}})],1):t._e()])}),[],!1,null,"ef4e2720",null).exports},props:{currentState:{type:String,required:!0,default:"idle",validator:function(t){return["idle","processing","threeds_verifying","threeds_timeout","threeds_failed","payment_blocked","payment_timeout","insufficient_funds","completed","failed"].includes(t)}},stateData:{type:Object,default:function(){return{}}},debug:{type:Boolean,default:!1}},data:function(){return{}},computed:{stateClass:function(){return"state-".concat(this.currentState)},availableStates:function(){return[{value:"idle",label:"准备支付"},{value:"processing",label:"处理中"},{value:"threeds_verifying",label:"验证中"},{value:"threeds_timeout",label:"验证超时"},{value:"threeds_failed",label:"验证失败"},{value:"payment_blocked",label:"支付被阻"},{value:"payment_timeout",label:"支付超时"},{value:"insufficient_funds",label:"余额不足"},{value:"completed",label:"支付成功"},{value:"failed",label:"支付失败"}]}},methods:{handleAction:function(t){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.debug&&console.log("[PaymentIntermediateDisplay] 处理动作: ".concat(t),data),this.$emit(t,data)},trackStateExposure:function(t,e){var n={processing:"processing",threeds_verifying:"threeds_verifying",threeds_timeout:"threeds_timeout",threeds_failed:"threeds_failed",payment_blocked:"payment_blocked",payment_timeout:"payment_timeout",insufficient_funds:"insufficient_funds"};if(n[t]){var o,r,l,c,d,h={front_operation:"exposure",entity_name:"payment_intermediate_state",entity_type:"payment_state_exposure",obj_info:{process_type:n[t],from_state:e||"unknown",state_type:"intermediate",benefit_type:(null===(o=this.stateData)||void 0===o?void 0:o.benefit_type)||"unknown",order_id:(null===(r=this.stateData)||void 0===r?void 0:r.order_id)||(null===(l=this.stateData)||void 0===l?void 0:l.thirdOrderId)||"unknown",card_type:(null===(c=this.stateData)||void 0===c?void 0:c.card_type)||2,payment_method:(null===(d=this.stateData)||void 0===d?void 0:d.paymentMethod)||"unknown",timestamp:Date.now()}};this.debug&&(console.log("[PaymentIntermediateDisplay] 状态曝光打点数据:",h),"unknown"!==h.obj_info.order_id&&"pending"!==h.obj_info.order_id||(console.warn("[PaymentIntermediateDisplay] 警告：订单ID为非正常值:",h.obj_info.order_id),console.warn("[PaymentIntermediateDisplay] stateData:",this.stateData))),this.$xyLogEvent(h),this.debug&&console.log("[PaymentIntermediateDisplay] 状态曝光打点:",h)}},switchToState:function(t){this.debug&&console.log("[Debug] 切换状态: ".concat(this.currentState," -> ").concat(t));var e=I(I({},this.stateData),{},{timestamp:Date.now()});this.$emit("state-change",{from:this.currentState,to:t,data:e})}},mounted:function(){this.debug&&console.log("[PaymentIntermediateDisplay] 组件已挂载",{currentState:this.currentState,stateData:this.stateData})},watch:{currentState:function(t,e){this.debug&&console.log("[PaymentIntermediateDisplay] 状态变化: ".concat(e," -> ").concat(t)),this.trackStateExposure(t,e),this.$emit("state-change",{from:e,to:t,data:this.stateData})}}},j=$,L=(n(5603),Object(l.a)(j,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"payment-intermediate-display",class:t.stateClass},[e("div",{staticClass:"state-container"},[e("PaymentStateDisplay",{attrs:{"current-state":t.currentState,"state-data":t.stateData},on:{action:t.handleAction}}),t._v(" "),t.debug?e("div",{staticClass:"debug-info"},[e("details",[e("summary",[t._v("调试信息")]),t._v(" "),e("div",{staticClass:"debug-content"},[e("p",[e("strong",[t._v("当前状态:")]),t._v(" "+t._s(t.currentState))]),t._v(" "),t._m(0),t._v(" "),e("pre",[t._v(t._s(JSON.stringify(t.stateData,null,2)))]),t._v(" "),e("div",{staticClass:"state-switcher"},[t._m(1),t._v(" "),e("div",{staticClass:"state-buttons"},t._l(t.availableStates,(function(n){return e("el-button",{key:n.value,class:{"active-state":t.currentState===n.value},attrs:{type:t.currentState===n.value?"primary":"default",size:"mini"},on:{click:function(e){return t.switchToState(n.value)}}},[t._v("\n                "+t._s(n.label)+"\n              ")])})),1)])])])]):t._e()],1)])}),[function(){var t=this._self._c;return t("p",[t("strong",[this._v("状态数据:")])])},function(){var t=this._self._c;return t("p",[t("strong",[this._v("快速状态切换:")])])}],!1,null,"531b946e",null));e.default=L.exports},5744:function(t,e,n){"use strict";n.r(e);n(18);var o=n(14),r=n(2),l=(n(19),n(6),n(32),n(398),n(16),n(11),n(73),n(22),n(49),n(399),n(8),n(4),n(12),n(13),n(28),n(43),n(21),n(44),n(7),n(468)),c=n(1),d=n(379),h=n(201),v=n(894),f=n(912),m=n(606),_=(n(27),n(35)),y=n.n(_),w=n(913),C=n(139),k=n(36),O=n(64),x=n(10),T=n(9),S=n(184),D=n(515),P=(n(54),n(71)),I={name:"FunType",props:{typeArr:{type:Array,default:function(){return[]}},typeList:{type:Array,default:function(){return[]}},activeName:{type:String,default:""},getHref:{type:Function,default:function(){return""}}},filters:{thousandsSeparator:function(t){if("number"!=typeof t)return t;var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},formatNumber:function(t){return Object(x.p)(t)}},data:function(){return{}},methods:{checkType:function(t){this.$emit("checkType",t)}}},$=(n(4851),n(0)),j=Object($.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"funType"},t._l(t.typeList,(function(n,o){return e("a",{key:o,staticClass:"typeItem",class:{typeActivate:t.activeName==n.value},attrs:{"data-num":t._f("formatNumber")(n.num),href:t.getHref(n),"data-id":n.value},on:{click:function(e){return e.preventDefault(),t.checkType(n)}}},[t._v("\n    "+t._s(t.$t(n.name))+"\n  ")])})),0)}),[],!1,null,"baadba5a",null).exports,L={name:"PostArticleFilter",props:{queryParam:{type:Object,default:function(){return{}}},typeArr:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{handleFilter:function(t){this.$emit("handleFilter",t)},filterReset:function(){this.$emit("filterReset")}}},M=(n(4852),Object($.a)(L,(function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[e("div",{staticClass:"filter-content"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("Type")))]),t._v(" "),e("div",{staticClass:"filter"},t._l(t.typeArr,(function(n){var o,r;return e("div",{key:n.value,staticClass:"item-filter",class:{active:(null===(o=t.queryParam)||void 0===o?void 0:o.sub_channel)==n.value},on:{click:function(e){return t.handleFilter(n.value)}}},[(null===(r=t.queryParam)||void 0===r?void 0:r.sub_channel)==n.value?e("i",{staticClass:"el-icon-check"}):t._e(),t._v("\n        "+t._s(t.$t(n.key))+"\n      ")])})),0),t._v(" "),e("div",{staticClass:"filter-reset",on:{click:t.filterReset}},[t._v("\n      "+t._s(t.$t("resetSelection"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"filter-box",attrs:{slot:"reference"},slot:"reference"},[e("div",[e("i",{staticClass:"iconfont icon-a-filterIcon"}),t._v(" "),e("span",[t._v(t._s(t.$t("Filter")))])]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down"})])])}),[],!1,null,"2a64a933",null).exports),E={name:"PostModelFilter",props:{activeName:{type:String,default:""},baseModels:{type:Array,default:function(){return[]}},modelTypes:{type:Array,default:function(){return[]}},baseModelSelect:{type:Array,default:function(){return[]}},modelTypeSelect:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{lang:function(){return this.$i18n.locale}},methods:{onFilter:function(t,e){this.$emit("onFilter",t,e)},onFilterReset:function(){this.$emit("onFilterReset")}}},F=(n(4853),Object($.a)(E,(function(){var t,e,n,o,r=this,l=r._self._c;return l("el-popover",{directives:[{name:"show",rawName:"v-show",value:"model"==r.activeName||"lora"==r.activeName,expression:"activeName == 'model' || activeName == 'lora'"}],attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[l("div",{staticClass:"filterCnt"},["model"==r.activeName?l("div",[r.lang.includes("zh")?l("div",{staticClass:"filterTit"},[r._v("\n        "+r._s(r.$t("Model")+r.$t("Type"))+"\n      ")]):l("div",{staticClass:"filterTit"},[r._v(r._s(r.$t("Model")+" "+r.$t("Type")))]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.modelTypes,(function(t,e){return l("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.modelTypeSelect.includes(t)},on:{click:function(e){return r.onFilter(t,1)}}},[r.modelTypeSelect.includes(t)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s("TextualInversion"===t?r.$t("embedding1"):t))])])})),0)]):r._e(),r._v(" "),l("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[r._v(r._s(r.$t("BaseModel")))]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.baseModels,(function(t,e){return l("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.baseModelSelect.includes(t)},on:{click:function(e){return r.onFilter(t,2)}}},[r.baseModelSelect.includes(t)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s(t))])])})),0),r._v(" "),l("div",{staticClass:"filterReset graBorder",on:{click:r.onFilterReset}},[r._v("\n      "+r._s(r.$t("resetSelection"))+"\n    ")])]),r._v(" "),l("el-badge",{staticClass:"item",attrs:{slot:"reference",value:(null===(t=r.modelTypeSelect)||void 0===t?void 0:t.length)+(null===(e=r.baseModelSelect)||void 0===e?void 0:e.length),hidden:(null===(n=r.modelTypeSelect)||void 0===n?void 0:n.length)+(null===(o=r.baseModelSelect)||void 0===o?void 0:o.length)==0},slot:"reference"},[l("div",{staticClass:"filter-box"},[l("div",[l("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),l("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})])])],1)}),[],!1,null,"e25cb74c",null).exports),A={name:"WorkflowFilter",props:{checkRun:{type:Boolean,default:!1},nodeList:{type:Array,default:function(){return[]}}},computed:{localCheckRun:{get:function(){return this.value},set:function(t){this.$emit("update:checkRun",t)}}},data:function(){return{filterShow:!1,fliterLoading:!1,queryParam:{nodes_type:[]}}},methods:{handleInput:function(t){},onWorkfolwFilterReset:function(){this.$emit("onWorkfolwFilterReset")},remoteMethod:function(t){t&&(this.fliterLoading=!0)},nodeListChange:function(t){this.$emit("nodeListChange",t)},initGetList:function(){this.$emit("initGetList")}}},N=(n(4854),Object($.a)(A,(function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{placement:"bottom","popper-class":"comfyFilter",trigger:"click"},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[e("div",{staticClass:"filterCnt"},[e("el-checkbox",{on:{change:t.initGetList},model:{value:t.localCheckRun,callback:function(e){t.localCheckRun=e},expression:"localCheckRun"}},[t._v(t._s(t.$t("comfyFilter1")))]),t._v(" "),e("div",{staticClass:"filterTit"},[t._v(t._s(t.$t("comfyFilter3")))]),t._v(" "),e("el-select",{staticClass:"filterSelect",attrs:{"popper-class":"custom-select comfyFilter",filterable:"",remote:"",multiple:"",placeholder:t.$t("Pls_select"),"popper-append-to-body":!1,"remote-method":t.remoteMethod,loading:t.fliterLoading},on:{change:t.nodeListChange},model:{value:t.queryParam.nodes_type,callback:function(e){t.$set(t.queryParam,"nodes_type",e)},expression:"queryParam.nodes_type"}},t._l(t.nodeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1),t._v(" "),e("div",{staticClass:"filterReset graBorder",on:{click:t.onWorkfolwFilterReset}},[t._v("\n      "+t._s(t.$t("resetSelection"))+"\n    ")])],1),t._v(" "),e("div",{staticClass:"filter-box",attrs:{slot:"reference"},slot:"reference"},[e("div",[e("i",{staticClass:"iconfont icon-a-filterIcon"}),t._v(" "),e("span",[t._v(t._s(t.$t("Filter")))])]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down"})])])}),[],!1,null,"75e1731c",null).exports);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U={components:{TagList:d.default,WaterFallVue:h.default,stickyTab:v.default,myTags:f.a,SearchInput:m.default,recommendModelList:w.a,HyWaterfallFlowList:O.default,GenderSelect:l.default,FunType:j,PostArticleFilter:M,PostModelFilter:F,WorkflowFilter:N},filters:{thousandsSeparator:function(t){if("number"!=typeof t)return t;var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},formatNumber:function(t){return Object(x.p)(t)}},mounted:function(){this.getConfit(),this.initList(),this.getTagInfo(),this.resizeListener()},beforeDestroy:function(){console.log("页面销毁++++++++++"),Object(D.a)()},data:function(){return{COVER_URL:"https://image.cdn2.seaart.me/static/upload/20250605/bac19c12-1241-4704-9c46-92ce1136c24b.webp",TAG_ID:"seaart-official-curated",dotReportInfo:{category:"default",view_domain:"Tags",batch_id:""},activeName:"post",queryParam:{},filterShow:!1,fliterLoading:!1,list:[],nodeList:[],intNodeList:[],isLock:!1,isReq:!1,dialogVisible:!1,addLoading:!1,selectInfo:{ids:[]},isCheck:!1,tagInfoDetail:{},tagHoverStatus:!1,tagIndex:"",modelTypes:T.cb,baseModels:[],baseModelMap:{},modelTypeSelect:[],baseModelSelect:[],listReqFuns:{swiftapp:k.getWaterAiApp,model:k.getWaterfallModel,post:k.getWaterfallPost,cyberpub:k.getWaterCharacter},typeArr:[{key:"Graphics",value:"picture"},{key:"Article",value:"article"}]}},computed:B(B(B(B({},Object(c.e)("app",["tagHot","tagNew"])),Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("user",["adminOff","userInfo"])),{},{isShowGenderFilter:function(){return"cyberpub"===this.activeName&&!["recommend","recently"].includes(this.tagIndex)},statTotal:function(){var t,e=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{},n=e.num_of_model,o=void 0===n?0:n,r=e.num_of_post,l=void 0===r?0:r,c=e.num_of_swift_app,d=void 0===c?0:c,h=e.num_of_character,v=void 0===h?0:h,f=e.num_of_lora_train,m={num_of_model:o,num_of_post:l,num_of_swift_app:d,num_of_character:v,num_of_lora_train:void 0===f?0:f};return Object.keys(m).reduce((function(t,e){return t+m[e]}),0)||0},setTaginfo:function(){return this.tagInfoDetail||{}},renderList:function(){var t;return((null==this||null===(t=this.setTaginfo)||void 0===t?void 0:t.related_tags)||[]).map((function(t){return t.style={},t.style.url=t.cover||"",t.name=t.title||t.id,t}))},setTagShow:function(){var t=this,e=!0;return this.userInfo.tags&&this.userInfo.tags.length>0&&this.userInfo.tags.forEach((function(element){element.id==t.$route.params.tag&&(e=!1)})),e},typeList:function(){var t,e,n=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{},o=n.num_of_model,r=void 0===o?0:o,l=n.num_of_post,c=void 0===l?0:l,d=n.num_of_swift_app,h=void 0===d?0:d,v=n.num_of_character;return[{name:"post_n",value:"post",num:c},{name:"Tavern",value:"cyberpub",num:void 0===v?0:v},{name:"aiapply",value:"swiftapp",num:h},{name:"Model",value:"model",num:r+=(null===(e=this.tagInfoDetail)||void 0===e||null===(e=e.stat)||void 0===e?void 0:e.num_of_lora_train)||0}].filter((function(t){return t.num>0}))},checkRun:{get:function(){return 1===this.queryParam.run_available},set:function(t){this.queryParam.run_available=t?1:0}}}),created:function(){this.getBaseModels()},methods:B(B(B({},Object(c.d)("user",["SET_ACCOUNT_DATA"])),Object(c.b)("user",["setAdminOff"])),{},{resizeListener:function(){var t=this,e=document.documentElement,n=function(){var n=e.clientWidth;try{t.$refs.tagdetail.style.padding="72px ".concat(n*(100/1920)*.86,"px 0")}catch(t){}};document.addEventListener?window.addEventListener("resize",n,!1):window.attachEvent("onresize",n),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",n)}))},getBaseModels:function(){var t=this;Object(P.a)({scene:3}).then((function(e){var n;1e4===e.status.code&&(t.baseModels=(null===(n=e.data)||void 0===n||null===(n=n.base_model_select_options)||void 0===n?void 0:n.map((function(e){return t.baseModelMap[e.val]=e.vals||[],e.val})))||[])}))},changeGender:function(t){this.queryParam.genders=t?[t]:null,this.initGetList()},handleFilter:function(t){var e=this.tagInfoDetail,n=e.name,o=void 0===n?"":n,r=e.id,l=o||(void 0===r?"":r);this.$logEvent("log_actions",{operation:"click_post_filter_button",behavior_info:"on_tab_".concat(l,"_detail_page"),behavior_info_sub:t}),this.queryParam.sub_channel=t,this.initGetList()},filterReset:function(){this.queryParam.sub_channel="",this.initGetList()},onFilter:function(t,e){var n=this;this.isReq||(1==e?(this.modelTypeSelect.includes(t)?this.modelTypeSelect.forEach((function(e,o){e==t&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(t),this.$logEvent("log_actions",{operation:"click_filter",behavior_info:"on_homepage_model_tab",behavior_info_sub:this.modelTypeSelect||[]})):this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"==this.tagIndex&&(this.tagIndex="hot"),this.initGetList())},onWorkfolwFilterReset:function(){this.queryParam.tag="",this.queryParam.nodes_type=[],this.queryParam.run_available=0,this.initGetList()},getConfit:function(){var t,e=this;["workflow","swiftapp"].includes(this.activeName)&&(this.queryParam.run_available=0,this.fliterLoading||null!==(t=this.nodeList)&&void 0!==t&&t.length||(this.fliterLoading=!0,Object(S.b)().then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes,e.intNodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))))},getTagInfo:function(){var t=this,e={id:this.TAG_ID};Object(C.i)(e).then((function(e){var n;if([1e4,"10000"].includes(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var o=e.data||{};o.style={},o.style.url=t.COVER_URL,o.name=t.$t("seaart_official_selection"),t.tagInfoDetail=o}})).finally((function(){}))},remoteMethod:function(t){var e=this;t?(this.fliterLoading=!0,Object(S.e)({keyword:t}).then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))):this.nodeList=this.intNodeList},nodeListChange:function(t){this.queryParam.nodes_type=t,this.initGetList()},onFilterReset:function(){this.isReq||(this.modelTypeSelect=[],this.baseModelSelect=[],this.initGetList())},initList:function(){var t=this.list;this.setDefaultTab(),t.length&&(this.list=t.map((function(t){return t.status=1,t})))},setDefaultTab:function(){var t,e,n=this,o=(null===(t=this.typeList.find((function(t){return t.value===n.activeName})))||void 0===t?void 0:t.num)>0;if(console.log("this.typeList",this.typeList),!o||this.queryParam.gender){this.activeName=(null===(e=this.typeList.find((function(t){return t.num>0})))||void 0===e?void 0:e.value)||this.activeName||"post",console.log("this.activeName",this.activeName);var r=this.setTabParams();this.$set(this,"queryParam",r),this.initGetList()}},handleTimeCommand:function(t){this.$logEvent("log_actions",{operation:"click_".concat(t.name,"_filter"),behavior_info:"on_tags_detail_page"}),this.initGetList(),"All"!=t.name&&this.$logEvent("log_actions",{operation:" click_time_filter_button",behavior_info:t.name})},handleCommand:function(t){this.tagIndex=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_filter"),behavior_info:"on_tags_detail_page"}),this.initGetList()},toggleHoverStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tagHoverStatus=t},backTo:function(){window.history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/"))},checkType:function(t){this.isReq||this.activeName!==t.value&&(this.activeName=t.value,this.getConfit(),this.filterSearch({isTab:!0}),Object(D.b)(t.value,this),this.getList())},changeTags:function(t){this.$router.push(this.localePath(null==t?void 0:t.path))},initGetList:function(){this.list=[],this.isReq=!1,this.isLock=!1,this.queryParam.page=1,this.queryParam.offset=0,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var n=this.getReqParams(),r=this.listReqFuns[this.activeName];Object(D.c)(this.activeName,n,this);var l=function(t){try{return B(B({},t),{},{banner:{url:t.cover||"",nsfw:t.nsfw,width:t.cover_width,height:t.cover_height},status:1},"model"===e.activeName&&{name:t.art_model.name,type:t.art_model.type,base_model:t.art_model.base_model})}catch(e){return t}};r(n).then((function(n){if(1e4===n.status.code){var r=n.data,c=r.has_more,d=r.items,h=void 0===d?[]:d,v=r.offset;if(0!==h.length){e.isLock=!c;var f=(h||[]).map(l);e.list=t?[].concat(Object(o.a)(e.list),Object(o.a)(f)):f,e.queryParam.offset=v,e.queryParam.page++}else e.isReq=!1}})).catch((function(){})).finally((function(){e.isReq=!1}))}},setTabParams:function(t){return B(B({},y()(T.C[this.activeName]).params),{},{tag:this.$route.params.tag,page:1,page_size:50,order_by:""})},filterSearch:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isTab;this.isLock=!1,this.isReq=!1,delete this.queryParam.offset;var e=this.setTabParams(t);this.queryParam.page=1,this.$set(this,"queryParam",e),this.list=[]},getReqParams:function(){var t=this,e=B(B({},y()(this.queryParam)),{},{order_by:""}),n=this.modelTypeSelect,r=this.baseModelSelect;if(["model","lora"].includes(this.activeName)){var l=r;r&&r.length>0&&(l=r.flatMap((function(e){var n;return[e].concat(Object(o.a)((null===(n=t.baseModelMap)||void 0===n?void 0:n[e])||[]))}))),e.base_models=l,e.model_types=n.map((function(t,e){return"LoRA"==t?"LORA":t}))}else"artwork"==this.activeName&&(e.order_by="");return e.sub_channel=e.sub_channel?[e.sub_channel]:[],e.tag_ids=[this.TAG_ID],e.offset=e.offset?e.offset.toString():"",e}}),head:function(){var t;if(null===(t=this.tagInfoDetail)||void 0===t||!t.id)return{};var e=this.tagInfoDetail||{},n=e.title,o=e.id,r=e.stat,l=r.num_of_artwork,c=r.num_of_model,d=r.num_of_ebook,h=void 0===d?0:d,v=(e.related_tags||[]).map((function(t){return t.title})),f=this.$route,m=f.name,_=f.params,y=(m=m.split("___")[0]).includes("TagDetail")?(null==_?void 0:_.type)||"app":m,w=T.D.find((function(t){return t.name.includes(y)}))||{},title=w.title,desc=w.desc;title=this.$t("seaart_official_selection");var C=this.$t(desc,{name:n,wNum:"ai-novel"===y?h:l,mNum:c,link:v.toString()});return{title:title,meta:[{hid:"description",name:"description",content:C},{hid:"keywords",name:"keywords",content:n},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:C}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:this.$t("Home"),item:"https://www.seaart.ai"},{"@type":"ListItem",position:2,name:this.$t("AI_Explore"),item:"https://www.seaart.ai"+"/".concat(o,"?id=").concat(o)}]}}],__dangerouslyDisableSanitizers:["script"]}}},V=U,W=(n(4855),Object($.a)(V,(function(){var t=this,e=t._self._c;return e("div",{ref:"tagdetail",staticClass:"tagdetail"},[t.$route.query.isBack?t._e():e("div",{staticClass:"backIcon",on:{click:function(e){return e.stopPropagation(),t.backTo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"head"},[e("div",{staticClass:"head-bg"},[t.setTaginfo.style&&t.setTaginfo.style.url?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:t.setTaginfo.style.url}}):t._e()]),t._v(" "),e("div",{staticClass:"head-info"},[e("div",{staticClass:"user"},[e("div",{staticClass:"flex"},[t.setTaginfo.style&&t.setTaginfo.style.url?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:t.setTaginfo.style.url,alt:t.setTaginfo.name}}):t._e(),t._v(" "),e("div",{staticClass:"name-box"},[e("h1",[t._v(t._s(t.$t(t.setTaginfo.name)))]),t._v(" "),e("div",{staticClass:"work-num-show-box"},[e("div",{staticClass:"work-num-show-box-item"},[e("span",{staticClass:"work-num-show-box-item-num"},[t._v(t._s(t._f("thousandsSeparator")(t.statTotal)))]),t._v(" "),e("span",{staticClass:"work-num-show-box-item-text"},[t._v(t._s(t.$t("RelatedContent")))])])])])])])])]),t._v(" "),t.renderList&&t.renderList.length>0?e("div",{staticClass:"taglist"},[e("tag-list",{attrs:{active:t.$route.query.id,"use-new-tag":!0,"render-list":t.renderList,clickType:!1},on:{changeTags:t.changeTags}})],1):t._e(),t._v(" "),e("div",{staticClass:"funBar"},[e("fun-type",{attrs:{"type-list":t.typeList,"active-name":t.activeName},on:{checkType:t.checkType}}),t._v(" "),e("div",{staticClass:"Screening"},["post"==t.activeName?e("post-article-filter",{attrs:{"type-arr":t.typeArr,"query-param":t.queryParam,"active-name":t.activeName},on:{handleFilter:t.handleFilter,filterReset:t.filterReset}}):t._e(),t._v(" "),e("post-model-filter",{attrs:{"base-models":t.baseModels,"model-types":t.modelTypes,"base-model-select":t.baseModelSelect,"model-type-select":t.modelTypeSelect,"active-name":t.activeName},on:{onFilter:t.onFilter,onFilterReset:t.onFilterReset}}),t._v(" "),"workflow"==t.activeName?e("workflow-filter",{attrs:{"node-list":t.nodeList},on:{onWorkfolwFilterReset:t.onWorkfolwFilterReset,nodeListChange:t.nodeListChange},model:{value:t.checkRun,callback:function(e){t.checkRun=e},expression:"checkRun"}}):t._e(),t._v(" "),t.isShowGenderFilter?e("GenderSelect",{on:{onChangeGender:t.changeGender}}):t._e()],1)],1),t._v(" "),e("div",{ref:"wraper",staticClass:"ai-novel-list"},[e("HyWaterfallFlowList",{attrs:{list:t.list,isNovel:"ai-novel"===t.activeName,container:"wraper",fixedRatios:"artwork"!==t.activeName&&[260,346],waterAllListFn:function(){return t.list}},on:{load:function(e){return t.getList(!0)}}})],1),t._v(" "),e("my-tags",{model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}})],1)}),[],!1,null,"fcbc83ea",null));e.default=W.exports;installComponents(W,{TagList:n(379).default})},5745:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(16),n(22),n(18),n(24),n(4),n(1));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"NoticeTab",props:{activeTab:{type:Number,default:0},unRead:{type:Array,default:function(){return[]}}},computed:c(c({},Object(r.c)("chatgpt",["unreadMsgNum"])),{},{tabs:function(){return this.defaultTabs},unreadList:function(){return 0===this.unRead.length?[0,0,0,0]:this.unRead},unreadNum:function(){return function(t){return t>99?"99+":t}},numClass:function(){return function(t){return t?t<10&&t>0?"tab-round tab-basic":"tab-num tab-basic":""}}}),watch:{},data:function(){return{defaultTabs:[{name:"系统",lang:"noticeSystem",type:0,icon:"sound"},{name:"评论",lang:"noticeComment",type:1,icon:"messages"},{name:"赞和收藏",lang:"noticeLike",type:2,icon:"likeAndCollect"},{name:"新的关注",lang:"noticeFollow",type:3,icon:"follow2"}],readLoading:!1}},mounted:function(){},methods:c(c({},Object(r.b)("chatgpt",["setReadMsgAll"])),{},{handleTabClick:function(t,e){e!==this.activeTab&&this.$emit("changeTab",t,e),this.$emit("clickTab",t,e)},readAll:function(){var t=this;console.log("readAll"),0!==this.unreadMsgNum?(this.readLoading=!0,this.setReadMsgAll().then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("msgReadDone")),t.$emit("readAll"))})).finally((function(){t.readLoading=!1}))):this.$message.warning(this.$t("msgNoRead"))}})},h=(n(5188),n(0)),v=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice-tab flex flex-col"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("noticeCenter")))]),t._v(" "),e("div",{staticClass:"tabs flex flex-col justify-between"},[e("div",{staticClass:"all-tabs"},t._l(t.tabs,(function(n,i){return e("div",{key:"notice-type".concat(i),staticClass:"tab flex items-center justify-between",class:{active:t.activeTab===i},on:{click:function(e){return t.handleTabClick(n,i)}}},[e("div",{staticClass:"tab-left flex items-center"},[e("div",{staticClass:"tab-icon"},[n.icon?e("i",{staticClass:"iconfont icon",class:"icon-".concat(n.icon)}):t._e()]),t._v(" "),e("div",{staticClass:"tab-name"},[t._v(t._s(t.$t(n.lang)))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadList[i],expression:"unreadList[i]"}],class:t.numClass(t.unreadList[i])},[t._v(t._s(t.unreadNum(t.unreadList[i])))])])})),0),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.readLoading,expression:"readLoading"}],staticClass:"read-all flex justify-center items-center",on:{click:t.readAll}},[e("i",{staticClass:"el-icon-check"}),t._v("\n      "+t._s(t.$t("msgReadAll"))+"\n    ")])])])}),[],!1,null,"a71a2d6c",null).exports,f=n(14),m=(n(31),n(43),n(77),n(34)),_=n(10),y=n(53),w={name:"msgHead",props:{author:{type:Object,default:function(){}}},computed:{},data:function(){return{}},mounted:function(){},components:{BaseAvatar:y.default},methods:{}},C=(n(5189),Object(h.a)(w,(function(){var t,e=this,n=e._self._c;return null!==(t=e.author)&&void 0!==t&&t.id?n("div",{staticClass:"msg-head"},[n("div",{staticClass:"head-event"},[n("div",{staticClass:"head-start flex items-center"},[n("BaseAvatar",{attrs:{userData:e.author,size:24},nativeOn:{click:function(t){return t.stopPropagation(),e.$emit("toUser")}}}),e._v(" "),n("div",{staticClass:"msg-desc"},[e._t("desc")],2)],1)]),e._v(" "),n("span",{staticClass:"msg-content"},[e._t("detail")],2)]):e._e()}),[],!1,null,"6b6f76c6",null)),k=C.exports;installComponents(C,{BaseAvatar:n(53).default});var O=n(896);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={name:"NoticeItem",props:{message:{type:Object,default:function(){}}},components:{msgHead:k,NoticeTag:O.a},computed:T(T({},Object(r.c)("chatgpt",["unreadMsgNum"])),{},{msgSource:function(){var t,e,n,o,r={1:{type:1,lang:"taskTabTasks",from:"task",url:""},2:{type:2,lang:"Work",from:"work",url:"/explore/detail/"},3:{type:3,lang:"Model",from:"model",url:"/models/detail/"},4:{type:4,lang:"gather",from:"gallery",url:"/artWorkDetail/"},5:{type:5,lang:"Video",from:"video",url:"/video/"},6:{type:6,lang:"User",from:"user",url:"/user/"},7:{type:7,lang:"System",from:"system",url:""},8:{type:8,lang:"Board",from:"board",url:"/editBoard/detail/"},9:{type:9,lang:"WorkFlow",from:"workFlow",url:"/workFlowDetail/"},16:{type:16,lang:"Audio",from:"Audio",url:"/ai-audio/detail/"},19:{type:19,lang:"digitalHuman",from:"Character",url:"/cyberPubPage/"},20:{type:20,lang:"Swtft_App",from:"SwiftApp",url:"/workFlowAppDetail/"},21:{type:21,lang:"WorkFlow",from:"WorkFlow",url:"/workFlowDetail/"},22:{type:22,lang:"Article",from:"Article",url:"/articleDetail/"},23:{type:23,lang:"AiNovel",from:"AiNovel",url:"/novel/detail/"}};return null!==(t=this.message)&&void 0!==t&&t.components&&null!==(e=this.message)&&void 0!==e&&null!==(e=e.components[0])&&void 0!==e&&e.type?r[null===(n=this.message)||void 0===n||null===(n=n.components[0])||void 0===n?void 0:n.type]?r[null===(o=this.message)||void 0===o||null===(o=o.components[0])||void 0===o?void 0:o.type]:(console.log("no such msg type 1"),{type:7,lang:"System",from:"system",url:""}):(console.log("no such msg type 2"),{type:7,lang:"System",from:"system",url:""})},sourceId:function(){var t;return null===(t=this.message)||void 0===t||null===(t=t.components[0])||void 0===t?void 0:t.custom_id},eventType:function(){var t,e;return null!==(t=this.message)&&void 0!==t&&t.components?null===(e=this.message)||void 0===e||null===(e=e.components[0])||void 0===e?void 0:e.event:99},msgTitleImg:function(){var t,e;if(null!==(t=this.message)&&void 0!==t&&t.attachments&&null!==(e=this.message)&&void 0!==e&&null!==(e=e.attachments)&&void 0!==e&&e.length){for(var n,o=null===(n=this.message)||void 0===n?void 0:n.attachments,r={},i=0;i<o.length;i++){var l,c;"title"===(null===(l=o[i])||void 0===l?void 0:l.content_type)?r.title=o[i].title:"image"===(null===(c=o[i])||void 0===c?void 0:c.content_type)&&(r.url=o[i].url)}return r}return{}},author:function(){var t;return(null===(t=this.message)||void 0===t?void 0:t.author)||{}},msgMain:function(){var t,e,n,o,r,l={desc:"",content:(null===(t=this.message)||void 0===t?void 0:t.content)||"",title:(null===(e=this.msgTitleImg)||void 0===e?void 0:e.title)||"",showTitle:!0,showImg:!0};switch(this.eventType){case 1:l.showTitle=!0,l.showImg=!0,l.desc=this.$t("msgMainDescLike",{type:this.$t((null===(n=this.msgSource)||void 0===n?void 0:n.lang)||"Work")});break;case 2:l.showTitle=!0,l.showImg=!0,l.desc=this.$t("msgMainDescCollect",{type:this.$t((null===(o=this.msgSource)||void 0===o?void 0:o.lang)||"Work")});break;case 3:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescCom",{type:this.$t((null===(r=this.msgSource)||void 0===r?void 0:r.lang)||"Work")});break;case 4:l.showTitle=!1,l.showImg=!1,l.desc=this.$t("msgFollowTxt");break;case 5:case 6:case 8:case 10:case 11:case 99:break;case 7:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescReply");break;case 9:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescLikeComment");break;default:l.desc=""}return l},msgTime:function(){var t;return null!==(t=this.message)&&void 0!==t&&t.timestamp?this.formatDate(this.message.timestamp):""},isRead:function(){var t;return!0===(null===(t=this.message)||void 0===t?void 0:t.is_read)||0===this.unreadMsgNum},filterXss:function(){return function(t){return m.default.prototype.xss(t)}},isInteractionNotice:function(){return[1,2,3,4,7,9].includes(this.eventType)},isAuditNotice:function(){return[5,6].includes(this.eventType)},isReportNotice:function(){return[25,26,27].includes(this.eventType)},noticeTagType:function(){return this.isReportNotice?"notion_system_sub11":this.message.components[0].sub_type}}),data:function(){return{replaceImageType:_.K,errorTimes:0}},mounted:function(){},methods:{filterRichText:function(html){if(!html)return"";if("string"!=typeof html)return"";var t=document.createElement("div");return t.innerHTML=html,t.textContent||t.innerText||""},handleClickMsg:function(){!1===this.message.is_read&&this.$emit("setRead",this.message),this.openPage()},openPage:function(){var t,e,n,label,o=this;switch(this.eventType){case 1:case 2:case 3:case 7:case 9:if(this.msgSource.url){var path=this.msgSource.url+this.message.components[0].custom_id,r=this.$router.resolve({path:path});window.open(r.href,"_blank")}break;case 4:path="/user/".concat(this.sourceId),r=this.$router.resolve({path:path});window.open(r.href,"_blank");break;case 5:case 6:if(5===this.msgSource.type){var l=this.msgSource.url+this.message.components[0].custom_id,c=this.$router.resolve({path:l});window.open(c.href,"_blank")}break;case 8:case 10:case 11:case 14:case 17:case 18:case 19:case 25:case 26:case 27:case 99:var d={title:(null===(t=this.msgTitleImg)||void 0===t?void 0:t.title)||this.$t("noticeSystem"),content:this.message.content,time:this.message.timestamp};this.$emit("showSysUpdate",d);break;case 12:case 13:default:break;case 15:this.$emit("showSysUpdate",{title:(null===(e=this.msgTitleImg)||void 0===e?void 0:e.title)||this.$t("noticeSystem"),content:this.message.content,time:this.message.timestamp,linkList:this.convertComfyUiJumpLink()});break;case 20:this.$router.push({path:(n="/creationCenter",label=o.message.components[0].label,"get score"===label?"".concat(n,"/home"):"get earnings"===label||"get earnings 100"===label?"".concat(n,"/incomeCenterPoints"):n)})}},convertComfyUiJumpLink:function(){var t,e,n=this,o=null!==(t=this.message)&&void 0!==t&&null!==(t=t.attachments)&&void 0!==t&&t.length?null===(e=this.message)||void 0===e?void 0:e.attachments[0]:{},r=(null==o?void 0:o.custom_value)||{},l=r.application_ids,c=void 0===l?[]:l,d=r.workflow_ids,h=void 0===d?[]:d;return c=(c||[]).map((function(t){return"".concat(location.origin)+n.localePath("/workFlowAppDetail/".concat(t))})),h=(h||[]).map((function(t){return"".concat(location.origin)+n.localePath("/workFlowDetail/".concat(t))})),[].concat(Object(f.a)(c),Object(f.a)(h))},formatDate:function(t){var e,n;(null===(n=t=null===(e=t)||void 0===e?void 0:e.toString())||void 0===n?void 0:n.length)>13&&(t=t.slice(0,13));var o=new Date(Number(t)),r=o.getFullYear(),l=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),d=o.getHours().toString().padStart(2,"0"),h=o.getMinutes().toString().padStart(2,"0"),v=o.getSeconds().toString().padStart(2,"0");return Object(_.F)(o,new Date)?"".concat(d,":").concat(h,":").concat(v):"".concat(r,"/").concat(l,"/").concat(c," ").concat(d,":").concat(h,":").concat(v)},imgError:function(t){this.errorTimes+=1,this.errorTimes>3||(console.log("imgError",t),this.$refs.msgImg.src=t)},toUser:function(){var t=this.author.id,e=this.$router.resolve({path:"/user/"+t});window.open(e.href,"_blank")}}},D=(n(5190),Object(h.a)(S,(function(){var t,e,n,o,r,l,c,d,h,v,f,m,_=this,y=_._self._c;return _.message.id?y("div",{staticClass:"notice-item",on:{click:_.handleClickMsg}},[_.isInteractionNotice?[null!==(t=_.msgMain)&&void 0!==t&&t.desc?y("div",{staticClass:"item-content flex items-center"},[y("span",{staticClass:"item-content-main"},[y("msgHead",{attrs:{author:_.author},on:{toUser:_.toUser},scopedSlots:_._u([null!==(e=_.msgMain)&&void 0!==e&&e.desc?{key:"desc",fn:function(){var t;return[null!==(t=_.author)&&void 0!==t&&t.name?y("span",{staticClass:"name",on:{click:function(t){return t.stopPropagation(),_.toUser.apply(null,arguments)}}},[_._v(_._s(_.author.name))]):_._e(),_._v(" "),y("span",{staticClass:"desc"},[_._v(_._s(_.msgMain.desc))])]},proxy:!0}:null,null!==(n=_.msgMain)&&void 0!==n&&n.showTitle&&null!==(o=_.msgMain)&&void 0!==o&&o.title?{key:"detail",fn:function(){var t;return[_._v(" "+_._s(null===(t=_.msgMain)||void 0===t?void 0:t.title)+" ")]},proxy:!0}:null!==(r=_.msgMain)&&void 0!==r&&r.content?{key:"detail",fn:function(){var t;return[_._v(" "+_._s(null===(t=_.msgMain)||void 0===t?void 0:t.content)+" ")]},proxy:!0}:null],null,!0)}),_._v(" "),_.msgTime?y("span",{staticClass:"msg-time"},[_._v(_._s(_.msgTime))]):_._e()],1),_._v(" "),null!==(l=_.msgMain)&&void 0!==l&&l.showImg&&null!==(c=_.msgTitleImg)&&void 0!==c&&c.url?y("div",{staticClass:"item-content-img"},[y("img",{ref:"msgImg",attrs:{src:_.replaceImageType(_.msgTitleImg.url,"low"),alt:"msg-img"},on:{error:function(t){return _.imgError(_.msgTitleImg.url)}}})]):_._e(),_._v(" "),y("div",{staticClass:"other-read-status",class:{hide:_.isRead}})]):_._e()]:[_.isAuditNotice?y("div",{staticClass:"item-content"},[y("div",{staticClass:"sys-content-title sys-notice-title"},[y("notice-tag",{attrs:{type:_.message.components[0].sub_type}}),_._v(" "),y("span",{staticClass:"sys-content-title-text"},[_._v(_._s(5===_.eventType?_.$t("sysReviewSuccess"):_.$t("sysReviewFail")))]),_._v(" "),_.msgTime?y("span",{staticClass:"sys-content-title-time"},[_._v(_._s(_.msgTime))]):_._e(),_._v(" "),y("span",{staticClass:"read-status",class:{hide:_.isRead}})],1),_._v(" "),y("div",{staticClass:"main-content"},[_._v("\n        "+_._s(5===_.eventType?_.$t("sysReviewTextSuccess",{type:_.$t((null===(d=_.msgSource)||void 0===d?void 0:d.lang)||"Work")}):_.$t("sysReviewTextFail",{type:_.$t((null===(h=_.msgSource)||void 0===h?void 0:h.lang)||"Work")}))+"\n      ")])]):[20].includes(_.eventType)?y("div",{staticClass:"item-content"},[y("div",{staticClass:"sys-content-title sys-notice-title"},[y("notice-tag",{attrs:{type:_.message.components[0].sub_type}}),_._v(" "),null!==(v=_.msgTitleImg)&&void 0!==v&&v.title||!_.message.components?y("span",{staticClass:"sys-content-title-text"},[_._v("\n          "+_._s((null===(f=_.msgTitleImg)||void 0===f?void 0:f.title)||_.$t("noticeSystem"))+"\n        ")]):_._e(),_._v(" "),_.msgTime?y("span",{staticClass:"sys-content-title-time"},[_._v(_._s(_.msgTime))]):_._e(),_._v(" "),y("span",{staticClass:"read-status",class:{hide:_.isRead}})],1),_._v(" "),y("div",{staticClass:"main-content rich-text-wrap-2",domProps:{innerHTML:_._s(_.filterRichText(_.message.content))}})]):y("div",{staticClass:"item-content"},[y("div",{staticClass:"sys-content-title sys-notice-title"},[y("notice-tag",{attrs:{type:_.noticeTagType}}),_._v(" "),y("span",{staticClass:"sys-content-title-text"},[_._v("\n          "+_._s((null===(m=_.msgTitleImg)||void 0===m?void 0:m.title)||_.$t("notion_system_default_title"))+"\n        ")]),_._v(" "),_.msgTime?y("span",{staticClass:"sys-content-title-time"},[_._v(_._s(_.msgTime))]):_._e(),_._v(" "),y("span",{staticClass:"read-status",class:{hide:_.isRead}})],1),_._v(" "),y("div",{staticClass:"main-content rich-text-wrap-2",domProps:{innerHTML:_._s(_.filterRichText(_.message.content))}})])]],2):_._e()}),[],!1,null,"de6aa9fa",null)),P=D.exports,I=(n(28),n(44),n(1012),n(58)),$={name:"SystemMsg",props:{sysMsg:{type:Object,default:function(){}},showSys:{type:Boolean,default:!1}},computed:{},data:function(){return{}},methods:{formatTime:function(t){return t.length>13?Object(I.f)(t.slice(0,13)):Object(I.f)(t)},formatContent:function(content){return content?content=content.replaceAll("\n","<br/>"):""}}},j=(n(5191),Object(h.a)($,(function(){var t,e,n,o=this,r=o._self._c;return null!==(t=o.sysMsg)&&void 0!==t&&t.title&&o.showSys?r("div",{staticClass:"system-msg"},[r("div",{staticClass:"notice__title"},[o._v(o._s(o.sysMsg.title))]),o._v(" "),r("div",{staticClass:"notice__time"},[o._v(o._s(o.formatTime(o.sysMsg.time)))]),o._v(" "),r("div",{staticClass:"notice__content",domProps:{innerHTML:o._s(o.formatContent(o.sysMsg.content))}}),o._v(" "),null!==(e=o.sysMsg)&&void 0!==e&&null!==(e=e.linkList)&&void 0!==e&&e.length?r("div",{staticClass:"notice_comfy-ui-app"},o._l(null===(n=o.sysMsg)||void 0===n?void 0:n.linkList,(function(t){return r("a",{staticClass:"notice_comfy-ui-app-link",attrs:{href:t,target:"_blank"}},[o._v(o._s(t))])})),0):o._e()]):o._e()}),[],!1,null,"7ed2265a",null).exports),L=n(517);function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var F={name:"notice",props:{},components:{NoticeTab:v,NoticeItem:P,SystemMsg:j},computed:E(E({},Object(r.c)("chatgpt",["unreadMsgAll"])),{},{channelId:function(){return["int#sys","int#com","int#like&col","int#fol"][this.activeTab]},unReadList:function(){var t=this,e=["sys","com","likeCol","fol"].map((function(e){return t.unreadMsgAll[e]}));return console.log("unread",e),e},showMsg:function(){return function(t){var e,n;null!=t&&t.components&&null!=t&&null!==(e=t.components[0])&&void 0!==e&&e.type&&[9,"9"].includes(null==t||null===(n=t.components[0])||void 0===n?void 0:n.type);return!0}}}),data:function(){return{loading:!1,activeTab:0,messageList:[],sysMsg:{},showSys:!1,paramKeyMap:{}}},mounted:function(){this.initTab(),this.getAllUnread()},methods:E(E({},Object(r.b)("chatgpt",["getUnreadMsgNum","getMainMessage","setReadMsg"])),{},{initTab:function(){var t,e=null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.name;["0","1","2","3"].includes(e)&&(this.activeTab=Number(e)),this.getMessage(this.activeTab),this.$logEvent("log_actions",{operation:"notify_show",behavior_info:"detail_page"})},getAllUnread:function(){this.getUnreadMsgNum().then((function(t){var e;1e4===(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&console.log("unread all：",null==t?void 0:t.data)}))},getMessage:function(){var t=this,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={channel_id:this.channelId,page_size:20};if(e&&this.hasMore){var o=this.messageList[this.messageList.length-1],r=o?o.timestamp:"";r&&(n.time_from=r)}this.loading=!0,this.getMainMessage(n).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,l;t.hasMore=null==n||null===(r=n.data)||void 0===r?void 0:r.has_more;var c=(null==n||null===(l=n.data)||void 0===l?void 0:l.items)||[];t.messageList=e?t.messageList.concat(c):c,console.log("消息列表",t.messageList)}})).finally((function(){t.loading=!1}))},changeTab:function(t){console.log("changeTab",t);t[0];this.activeTab=t[1]||0,this.getMessage(this.activeTab)},handleScroll:function(){var t=this.$refs.noticeWindowContainer,e=this.$refs.noticeList;t.scrollTop+t.clientHeight>=e.clientHeight-50&&!this.loading&&this.moreMessage()},moreMessage:function(){console.log("scroll to more msg"),this.hasMore&&(console.log("get more msg"),this.getMessage(this.activeTab,!0))},readMsg:function(t){var e=this,n=[t.id],o={channel_id:this.channelId,ids:n};Object(L.d)(o).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){console.log("set as read success");var p={type:["sys","com","likeCol","fol"][e.activeTab],num:1};e.setReadMsg(p)}})),t.is_read=!0},clickMsg:function(){console.log("点击消息")},showSysUpdate:function(t){this.sysMsg=t,this.showSys=!0},backTo:function(){this.showSys?this.showSys=!1:window.history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/"))}})},A=F,N=(n(5192),Object(h.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice"},[e("div",{staticClass:"backIcon",on:{click:function(e){return e.stopPropagation(),t.backTo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"notice-content flex"},[[e("NoticeTab",{directives:[{name:"show",rawName:"v-show",value:!t.showSys,expression:"!showSys"}],attrs:{activeTab:t.activeTab,unRead:t.unReadList},on:{changeTab:function(e){return t.changeTab(arguments)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSys,expression:"!showSys"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"notice-window flex items-center justify-center"},[t.messageList.length>0?e("div",{ref:"noticeWindowContainer",staticClass:"notice-window-container w-full",on:{scroll:t.handleScroll}},[e("div",{ref:"noticeList",staticClass:"items flex flex-col"},t._l(t.messageList,(function(n,i){return e("div",{key:"notice-item".concat(i),staticClass:"notice-window-item w-full"},[n.id&&t.showMsg(n)?[e("NoticeItem",{attrs:{message:n},on:{setRead:function(e){return t.readMsg(e)},clickMsg:function(e){return t.clickMsg(e)},showSysUpdate:function(e){return t.showSysUpdate(e)}}})]:t._e()],2)})),0)]):t.loading?t._e():e("div",{staticClass:"no-messages flex flex-col items-center"},[e("div",{staticClass:"no-messages-icon"},[e("img",{attrs:{src:n(1066),alt:""}})]),t._v(" "),e("div",{staticClass:"no-messages-text"},[t._v(t._s(t.$t("noMessages")))])])])],t._v(" "),[e("SystemMsg",{attrs:{showSys:t.showSys,sysMsg:t.sysMsg}})]],2)])}),[],!1,null,"73239546",null));e.default=N.exports},5746:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(8);var o=n(3),r=n(2),l=(n(20),n(6),n(32),n(22),n(31),n(65),n(4),n(7),n(26),n(1)),c=n(126),d=n(127),h=n(607),v=n(14),f=n(68),m=(n(19),n(16),n(24),n(769),n(87)),_={name:"TierSelector",props:{availableTiers:{type:Array,required:!0,default:function(){return[]}},selectedTierId:{type:String,default:""},currentUserLevel:{type:Number,required:!0},recommendedTierId:{type:String,default:""},loading:{type:Boolean,default:!1}},data:function(){return{internalSelectedTierId:this.selectedTierId}},watch:{selectedTierId:function(t){this.internalSelectedTierId=t}},methods:{formatTierLabel:function(t){return{1:this.$t("ToB_beginnerPlan"),2:this.$t("StandardPlan"),3:this.$t("ToB_professionalPlan"),4:this.$t("MasterPlan")}[null==t?void 0:t.level]||"Invalid Tier"},handleTierChange:function(t){this.internalSelectedTierId=t,this.$emit("tier-change",t)},getTierNameClass:function(t){return{"current-tier":t.level===this.currentUserLevel,"selected-tier":t.id===this.internalSelectedTierId,"normal-tier":t.level>this.currentUserLevel&&t.id!==this.internalSelectedTierId}},shouldShowRecommendedIcon:function(t){return t.id===this.recommendedTierId&&t.level>this.currentUserLevel}}},y=(n(5573),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tier-selection-area flex_m"},[e("div",{staticClass:"upgrade-header flex_m"},[e("svg-icon",{staticClass:"upgrade-icon",attrs:{"icon-class":"lineChart"}}),t._v(" "),e("span",{staticClass:"upgrade-label"},[t._v(t._s(t.$t("upgrade_to")))])],1),t._v(" "),e("el-select",{staticClass:"tier-selector",attrs:{placeholder:t.$t("Pls_select"),disabled:t.loading,"popper-append-to-body":!1,"popper-class":"vip-upgrade-tier-dropdown","data-group":"vip-computing-upgrade","data-event":"change_tier_selection"},on:{change:t.handleTierChange},model:{value:t.internalSelectedTierId,callback:function(e){t.internalSelectedTierId=e},expression:"internalSelectedTierId"}},t._l(t.availableTiers,(function(n){return e("el-option",{key:n.id,attrs:{label:t.formatTierLabel(n),value:n.id,disabled:n.level<=t.currentUserLevel,"data-group":"vip-computing-upgrade","data-event":"select_tier_level_".concat(n.level)}},[e("div",{staticClass:"tier-option flex_lr_m"},[e("span",{staticClass:"tier-name",class:t.getTierNameClass(n)},[t._v("\n          "+t._s(t.formatTierLabel(n))+"\n        ")]),t._v(" "),n.id===t.internalSelectedTierId?e("div",{staticClass:"selected-icon"},[e("i",{staticClass:"el-icon-check"})]):t.shouldShowRecommendedIcon(n)?e("div",{staticClass:"recommended-icon"},[e("i",{staticClass:"el-icon-star-on"})]):t._e()])])})),1)],1)}),[],!1,null,"0fac4f27",null),w=component.exports;installComponents(component,{SvgIcon:n(115).default});var C={name:"ContentComparison",props:{selectedTier:{type:Object,default:null},contentCalculation:{type:Object,default:function(){return{videosPerDay:0,imagesPerDay:0,newEnergyPerDay:0,currentEnergyPerDay:0}}}}},k=(n(5574),Object(y.a)(C,(function(){var t=this,e=t._self._c;return t.selectedTier&&t.contentCalculation?e("div",{staticClass:"content-comparison"},[e("div",{staticClass:"stamina-display"},[e("div",{staticClass:"stamina-info flex_b"},[e("div",{staticClass:"stamina-icon"},[e("img",{staticClass:"stamina-icon-img w-full h-full",attrs:{src:n(1040),alt:"stamina"}})]),t._v(" "),e("div",{staticClass:"stamina-numbers flex_b"},[e("span",{staticClass:"new-stamina"},[t._v(t._s(t.contentCalculation.newEnergyPerDay))]),t._v(" "),e("span",{staticClass:"stamina-unit"},[t._v(t._s(t.$t("newShopTips15")))])])]),t._v(" "),e("div",{staticClass:"original-plan flex_m"},[e("span",{staticClass:"original-label"},[t._v(t._s(t.$t("originalPlan")))]),t._v(" "),e("span",{staticClass:"original-value"},[t._v(t._s(t.contentCalculation.currentEnergyPerDay)+" "+t._s(t.$t("newShopTips15")))])])]),t._v(" "),e("div",{staticClass:"content-calculation flex"},[t._v("\n    ≈\n    "),e("span",{staticClass:"calculation-text",domProps:{innerHTML:t._s(t.$t("videosAndImgs",{videosNum:t.contentCalculation.videosPerDay||0,imagesNum:t.contentCalculation.imagesPerDay||0}))}})])]):t._e()}),[],!1,null,"1569db4e",null).exports),O={name:"PriceCard",props:{selectedTier:{type:Object,default:null},priceData:{type:Object,default:null},priceLoading:{type:Boolean,default:!1},priceError:{type:Boolean,default:!1},shouldShowYearlyTotal:{type:Boolean,default:!1},subscriptionType:{type:String,required:!0,validator:function(t){return["monthly","yearly","weekly"].includes(t)}}},computed:{periodText:function(){return{monthly:this.$t("Month"),yearly:this.$t("Month"),weekly:this.$t("week")}[this.subscriptionType]||this.$t("Month")}}},x=(n(5575),Object(y.a)(O,(function(){var t=this,e=t._self._c;return t.selectedTier?e("div",{staticClass:"price-card"},[e("img",{staticClass:"price-card-bg w-full h-full",attrs:{src:"https://image.cdn2.seaart.me/20250610/25d29326-3c24-449d-bed0-50e32bd99ef3_high.webp",alt:"price card background"}}),t._v(" "),e("div",{staticClass:"recommended-badge"},[e("span",[t._v(t._s(t.$t("Recommend")))])]),t._v(" "),t.priceData&&!t.priceLoading?e("div",{staticClass:"price-display flex_col"},[e("div",{staticClass:"price-main-row flex_wrap"},[e("div",{staticClass:"price-main flex_b"},[e("span",{staticClass:"currency"},[t._v(t._s(t.priceData.currency||"$"))]),t._v(" "),e("span",{staticClass:"amount"},[t._v(t._s(t.priceData.amount||"0"))])]),t._v(" "),e("span",{staticClass:"period"},[t._v("/"+t._s(t.periodText))]),t._v(" "),t.shouldShowYearlyTotal?e("div",{staticClass:"yearly-total"},[e("span",[t._v(t._s(t.$t("Year"))+" "+t._s(t.priceData.currency||"$")+t._s(t.priceData.yearlyTotal))])]):t._e()]),t._v(" "),e("div",{staticClass:"upgrade-description"},[e("span",[t._v(t._s(t.$t("payDifferenceToUpgrade")))])])]):t.priceLoading?e("div",{staticClass:"price-loading-container flex_line_c"},[t._m(0)]):t.priceError?e("div",{staticClass:"price-error-container flex_line_c"},[t._m(1)]):t._e()]):t._e()}),[function(){var t=this._self._c;return t("div",{staticClass:"price-loading flex_c_m"},[t("i",{staticClass:"el-icon-loading"})])},function(){var t=this._self._c;return t("div",{staticClass:"price-error flex_line_c_m"},[t("span",[this._v("Error loading price")])])}],!1,null,"b84eb866",null).exports);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D=6,P=30,I={name:"VipComputingUpgrade",components:{TierSelector:w,ContentComparison:k,PriceCard:x},props:{userLevel:{type:Number,required:!0,validator:function(t){return Number.isInteger(t)&&t>=1}},subscriptionType:{type:String,required:!0,validator:function(t){return"string"==typeof t&&["monthly","yearly","weekly"].includes(t)}},recommendedTierId:{type:String,default:""},subscriptionData:{type:Object,default:function(){return{}},validator:function(t){if(!t||"object"!==Object(f.a)(t))return!1;return["month","year","week"].some((function(e){return t[e]&&Array.isArray(t[e])&&t[e].length>0}))}}},data:function(){return{selectedTierId:"",selectedTier:null,availableTiers:[],tiersLoading:!1,priceData:null,priceLoading:!1,priceError:!1,upgradeLoading:!1,priceCache:{}}},computed:S(S({},Object(l.e)("payment",["paymentInfo"])),{},{hasValidSubscriptionData:function(){return this.subscriptionData&&Object.keys(this.subscriptionData).length>0},contentCalculation:function(){var t;if(!this.selectedTier)return{videosPerDay:0,imagesPerDay:0,newEnergyPerDay:0,currentEnergyPerDay:0};var e=this.selectedTier.every_day_temp_coins||0,n=(null===(t=this.currentTierData)||void 0===t?void 0:t.every_day_temp_coins)||0;return{videosPerDay:Math.floor(e/P),imagesPerDay:Math.floor(e/D),newEnergyPerDay:e,currentEnergyPerDay:n}},shouldShowYearlyTotal:function(){return"yearly"===this.subscriptionType&&this.priceData&&!!this.priceData.yearlyTotal},currentTierData:function(){var t;if(null===(t=this.paymentInfo)||void 0===t||!t.recentPlan||!this.subscriptionData)return null;var e=this.paymentInfo.recentPlan,n=[].concat(Object(v.a)(this.subscriptionData.month||[]),Object(v.a)(this.subscriptionData.year||[]),Object(v.a)(this.subscriptionData.week||[])),o=n.find((function(t){return(null==t?void 0:t.id)===e}));if(!o){var r=e.split("_");if(r.length>=2){var l="".concat(r[0],"_").concat(r[1]);o=n.find((function(t){return(null==t?void 0:t.id)===l})),console.log("特殊订阅ID: ".concat(e," -> 标准ID: ").concat(l),o)}}return o||null}}),watch:{recommendedTierId:function(t){this.setRecommendedTier(t)},userLevel:function(){this.hasValidSubscriptionData&&this.loadAndFilterTiers()},subscriptionType:function(){this.hasValidSubscriptionData&&this.loadAndFilterTiers()}},mounted:function(){this.hasValidSubscriptionData&&this.loadAndFilterTiers(),this.$xyLogEvent({front_operation:"exposure",entity_name:"vip_non_caculate_uplevel",entity_type:"to_pay_pop_show",obj_id:"pop_1"})},beforeDestroy:function(){this.clearPriceCache()},methods:{loadAndFilterTiers:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.tiersLoading=!0,e.prev=1,t.subscriptionData){e.next=6;break}return console.warn("No subscription data available from props"),t.availableTiers=[],e.abrupt("return");case 6:n={monthly:"month",yearly:"year",weekly:"week"},o=t.subscriptionData[n[t.subscriptionType]]||[],t.availableTiers=o.filter((function(e){return null!=e&&e.level&&null!=e&&e.id?e.level>=t.userLevel&&e.level<=4:(console.warn("Invalid tier object:",e),!1)})),t.setDefaultSelectedTier(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Error in loadAndFilterTiers:",e.t0),t.$message.error(t.$t("failedToLoadTiers")),t.availableTiers=[];case 17:return e.prev=17,t.tiersLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,12,17,20]])})))()},setRecommendedTier:function(t){if(t&&0!==this.availableTiers.length){var e=this.availableTiers.find((function(e){return e.id===t}));e&&this.selectTier(e)}},setDefaultSelectedTier:function(){var t=this;if(0!==this.availableTiers.length){var e=this.recommendedTierId&&this.availableTiers.find((function(e){return e.id===t.recommendedTierId&&e.level>t.userLevel}));e||(e=this.availableTiers.find((function(e){return e.level>t.userLevel}))),e&&this.selectTier(e)}},selectTier:function(t){this.selectedTierId=t.id,this.selectedTier=t,this.loadPriceData()},handleTierChange:function(t){if(!t)return this.selectedTier=null,void(this.priceData=null);var e=this.availableTiers.find((function(e){return e.id===t}));e&&(this.selectTier(e),this.$emit("tier-selected",{tier:e,contentCalculation:this.contentCalculation}))},loadPriceData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectedTier){e.next=3;break}return console.warn("No selected tier for price calculation"),e.abrupt("return");case 3:if(n="".concat(t.selectedTier.id,"_").concat(t.$i18n.locale),!t.priceCache[n]){e.next=7;break}return t.priceData=t.priceCache[n],e.abrupt("return");case 7:return t.priceLoading=!0,t.priceError=!1,e.prev=9,e.next=12,Object(m.k)({is_cn:"zhCN"===t.$i18n.locale,product_id:t.selectedTier.id,type:"sub"});case 12:if(null!=(o=e.sent)&&o.data){e.next=15;break}throw new Error("Invalid response data structure");case 15:if(r=o.data,l=r.price_local,c=r.new_price_local,d=r.currency,!("number"!=typeof l||l<0)){e.next=18;break}throw new Error("Invalid price data");case 18:h=l,v=null,"yearly"===t.subscriptionType&&(h=(l/12).toFixed(2),v=l.toFixed(2)),t.priceData={amount:h,yearlyTotal:v,currency:d||"$",originalAmount:l,newPriceLocal:c},t.priceCache[n]=S({},t.priceData),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(9),console.error("Error loading price data:",e.t0),t.priceError=!0,t.$message.error(t.$t("ServerError"));case 30:return e.prev=30,t.priceLoading=!1,e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[9,25,30,33]])})))()},trackUpgradeClick:function(t){this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"vip_non_caculate_uplevel",obj_id:"pop_2",obj_info:{tier_id:t}})},handleUpgradeClick:function(){this.selectedTierId?(this.trackUpgradeClick(this.selectedTierId),this.upgradeLoading=!0,this.$emit("upgrade-confirmed",{selectedTier:this.selectedTier}),this.upgradeLoading=!1):this.$message.warning(this.$t("pleaseSelectTier"))},clearPriceCache:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var e="".concat(t,"_").concat(this.$i18n.locale);delete this.priceCache[e]}else this.priceCache={}},refreshPriceData:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.length>0&&void 0!==t[0]&&t[0]&&e.clearPriceCache(),n.next=4,e.loadPriceData();case 4:case"end":return n.stop()}}),n)})))()},refresh:function(){this.hasValidSubscriptionData&&this.loadAndFilterTiers()}}},$=I,j=(n(5576),Object(y.a)($,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"vip-computing-upgrade"},[e.tiersLoading||0===(null===(t=e.availableTiers)||void 0===t?void 0:t.length)?n("div",{staticClass:"loading-section text-center"},[e._m(0)]):n("div",{staticClass:"upgrade-main-container flex"},[n("div",{staticClass:"left-section"},[n("TierSelector",{attrs:{"available-tiers":e.availableTiers,"selected-tier-id":e.selectedTierId,"current-user-level":e.userLevel,"recommended-tier-id":e.recommendedTierId,loading:e.tiersLoading},on:{"tier-change":e.handleTierChange}}),e._v(" "),n("ContentComparison",{attrs:{"selected-tier":e.selectedTier,"content-calculation":e.contentCalculation}})],1),e._v(" "),n("div",{staticClass:"right-section flex_line_c"},[n("PriceCard",{attrs:{"selected-tier":e.selectedTier,"price-data":e.priceData,"price-loading":e.priceLoading,"price-error":e.priceError,"should-show-yearly-total":e.shouldShowYearlyTotal,"subscription-type":e.subscriptionType}}),e._v(" "),n("el-button",{staticClass:"upgrade-button",attrs:{type:"primary","data-group":"vip-computing-upgrade","data-event":"click_upgrade_confirm","data-tier-id":e.selectedTierId,loading:e.upgradeLoading,disabled:!e.selectedTierId||e.priceLoading},on:{click:e.handleUpgradeClick}},[e._v("\n        "+e._s(e.$t("UpgradeNow"))+"\n      ")])],1)]),e._v(" "),!e.tiersLoading&&e.availableTiers.length>0?n("div",{staticClass:"bottom-notice"},[n("div",{staticClass:"notice-content flex_c_m"},[e._m(1),e._v(" "),n("span",[e._v(e._s(e.$t("keepCurrentBenefits")))])])]):e._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"loading flex_line_c"},[t("i",{staticClass:"el-icon-loading"})])},function(){var t=this._self._c;return t("div",{staticClass:"notice-icon"},[t("i",{staticClass:"el-icon-circle-check"})])}],!1,null,"aa09dcec",null).exports);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={name:"VipComputingDialog",provide:function(){return{top:this}},components:{PaymentForm:c.a,RightPart:d.a,NumberTransition:h.default,VipComputingUpgrade:j},data:function(){return{isShowDialog:!1,showCloseBtn:!1,step:"inGoods",goodsId:"",isUpgrade:!1,defaultThirdType:0,goodsData:{data:[]},dotFrom:"vip_buy_calculate",title:this.$t("vipDialogComputedTit"),loading:!1,maxDiscount:"",isFromVideo:!1,currentQuantity:1,cardStyles:[{background:"linear-gradient(332deg, #FFFFFF 0%, #F4FFF9 100%), #FFFFFF",boxShadow:"0px 16px 16px -4px rgba(0,0,0,0.1)"},{background:"linear-gradient(332deg, #FFFFFF 0%, #EBF4FE 100%), #FFFFFF",boxShadow:"0px 16px 16px -4px rgba(0,0,0,0.1)"},{background:"linear-gradient(331deg, #FFFFFF 0%, #F3E7FF 100%), #FFFFFF",boxShadow:"0px 16px 16px -4px rgba(0,0,0,0.15)"}],recommendedTierId:"",subscriptionData:null}},mounted:function(){this.$EventBus.$on("showVipComputingDialog",this.show),this.loadSubscriptionData()},destroyed:function(){this.$EventBus.$off("showVipComputingDialog",this.show)},computed:M(M(M(M({},Object(l.e)("payment",["subThirdType","paymentInfo","retentionPopupEndTime","defaultCountdown","cachedSubscriptions","paymentGrayInfo"])),Object(l.c)("user",["userInfo"])),Object(l.e)("user",["cdnHost"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},isCountdownValid:function(){return this.retentionPopupEndTime>Date.now()},shouldShowUpgrade:function(){var t;return!0===(null===(t=this.paymentGrayInfo)||void 0===t?void 0:t.upgrade_popup)&&this.currentUserLevel>=1&&this.currentUserLevel<=3},currentUserLevel:function(){var t;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)||0},currentSubscriptionType:function(){var t,e=null===(t=this.paymentInfo)||void 0===t?void 0:t.payRange;return 2===e?"monthly":3===e?"yearly":4===e?"weekly":"yearly"},purchParams:function(){return this.isUpgrade?{}:{quantity:this.currentQuantity}}}),methods:M(M({},Object(l.b)("payment",["getSubUrlAndThirdType","getRetentionPopupTime","setRetentionPopupTime","getSubscriptionList","getCalculateList"])),{},{getBaseCredits:function(t){return t?(t.calculate_coins-t.give_calculate_coins)*t.quantity:0},getBonusCredits:function(t){return t?t.give_calculate_coins*t.quantity:0},getTotalCredits:function(t){return t?t.calculate_coins*t.quantity:0},getVideosCount:function(t){return t?Math.floor(t.calculate_coins*t.quantity/100):0},getGoodsList:function(){var t=this;this.loading=!0,this.getCalculateList().then((function(e){var n=e.data,o=(n.day,n.calculate);n.paid_coins,n.can_sign;if(null!=o&&o.length){var r=o.reduce((function(t,e){return Math.max(t,e.discount)}),0);t.maxDiscount=r?"".concat(r,"0% OFF"):""}t.maxDiscount="";var l,c=[];(c=(null===(l=t.paymentInfo)||void 0===l?void 0:l.totalRecharge)<50?[o[1],o[2],o[3]].filter(Boolean):[o[2],o[3],o[5]].filter(Boolean)).length<3&&o.length>=3&&(c=o.slice(0,3));var d=-1,h=0;c.forEach((function(t,e){var n,o=parseFloat((null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price)||0);o>h&&(h=o,d=e)})),t.goodsData.data=c.map((function(t,e){return M({cp_product_id:t.cp_product_id,btnLoad:!1,is_best_value:e===d,quantity:1},t)})),t.loading=!1})).catch((function(e){t.loading=!1}))},getPrice:function(t){var e,n,o=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency,r=null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price;return o+" "+(parseFloat(r)*t.quantity).toFixed(2)||""},getPriceOld:function(t){var e,n,o=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency,r=null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price_old;return o+" "+(parseFloat(r)*t.quantity).toFixed(2)||""},handleQuantityChange:function(t){t.quantity<1?t.quantity=1:t.quantity>99&&(t.quantity=99)},checkGoodsInfo:function(){this.getGoodsList()},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.title=e?this.$t(e):this.$t("vipDialogComputedTit"),this.isFromVideo=n.fromVideo||!1,this.checkGoodsInfo(),this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.isVip?"vip_buy_calculate":"not_vip_buy_calculate",behavior_info_sub:"pop_1",purchase_amount:1}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.isVip?"vip_buy_calculate":"not_vip_buy_calculate",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1",purchase_amount:1}}),this.isShowDialog=!0,this.showCloseBtn=!1;var o=setTimeout((function(){t.showCloseBtn=!0,clearTimeout(o)}),3e3)},close:function(){var t,e=this;null!==(t=this.userInfo)&&void 0!==t&&t.is_show_video_calculate&&this.getRetentionPopupTime().then((function(t){if(!t.valid){var n=Date.now()+60*e.defaultCountdown*1e3;e.setRetentionPopupTime(n)}e.$EventBus.$emit("showDialog",{name:"VipComputingDialogMini",data:{fromVideo:e.isFromVideo}}),e.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"svip_calculate_retain",behavior_info_sub:"pop_1"}),e.$xyLogEvent({front_operation:"exposure",entity_name:"svip_calculate_retain",entity_type:"to_pay_pop_show"})})),this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){this.isUpgrade=n;var o,r=this.goodsData.data.find((function(e){return e.cp_product_id===t}));this.currentQuantity=r?r.quantity:1,n?(o="vip_non_caculate_uplevel",this.dotFrom="vip_non_caculate_uplevel"):(o=this.isVip?"vip_buy_calculate":"not_vip_buy_calculate",this.dotFrom=o),this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:o,behavior_info_sub:"pop_2",purchase_amount:this.currentQuantity||1}),this.$xyLogEvent({front_operation:"exposure",entity_name:o,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2",purchase_amount:this.currentQuantity||1}}),this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}}))}},loadSubscriptionData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList();case 3:t.subscriptionData=t.cachedSubscriptions,t.generateRecommendedTierId(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load subscription data for upgrade module:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},generateRecommendedTierId:function(){var t=this.subscriptionData||{},e=t.recommend_level,n=t.recommend_level_type;if(e&&n&&this.subscriptionData){var o={monthly:"month",yearly:"year",weekly:"week"}[n];if(o){var r=(this.subscriptionData[o]||[]).find((function(t){return t.level===e}));this.recommendedTierId=(null==r?void 0:r.id)||""}else this.recommendedTierId=""}else this.recommendedTierId=""},handleTierSelected:function(data){var t;this.recommendedTierId=(null===(t=data.tier)||void 0===t?void 0:t.id)||""},handleUpgradeConfirmed:function(t){t.selectedTier&&this.subscriptionNow(t.selectedTier.id,!0)}})},F=E,A=(n(5577),Object(y.a)(F,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"vip-computing-dialog flex-center",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"data-group":"vip_computing_dialog"},on:{"update:visible":function(t){e.isShowDialog=t}}},["inGoods"===e.step?o("div",{staticClass:"goods-content",class:{"discount-active":e.maxDiscount,"has-upgrade":e.shouldShowUpgrade}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.showCloseBtn,expression:"showCloseBtn"}],staticClass:"close-icon flex-center",on:{click:e.close}},[o("i",{staticClass:"el-icon-close"})]),e._v(" "),o("div",{staticClass:"goods-head"},[o("div",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),o("div",{staticClass:"title-sub words-wrap",class:{"multi-line":e.isFromVideo}},[e._v("\n        "+e._s(e.isFromVideo?e.$t("vipDialogComputedTitSub2"):e.$t("credit_recharge_desc"))+"\n      ")])]),e._v(" "),e.shouldShowUpgrade?o("div",{staticClass:"upgrade-content",attrs:{"data-group":"vip-non-caculate-uplevel"}},[o("VipComputingUpgrade",{attrs:{"user-level":e.currentUserLevel,"subscription-type":e.currentSubscriptionType,"subscription-data":e.subscriptionData,"recommended-tier-id":e.recommendedTierId},on:{"tier-selected":e.handleTierSelected,"upgrade-confirmed":e.handleUpgradeConfirmed}}),e._v(" "),o("div",{staticClass:"upgrade-separator"},[o("div",{staticClass:"separator-line"},[o("span",{staticClass:"separator-text"},[e._v("// OR //")])])])],1):e._e(),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods",class:{"with-upgrade":e.shouldShowUpgrade}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"goods-all"},[e._l(null===(t=e.goodsData)||void 0===t?void 0:t.data,(function(t,r){return[o("div",{key:t.id,staticClass:"item-goods",style:e.cardStyles[r%e.cardStyles.length]},[o("client-only",[[t.give_calculate_coins||null!=t&&t.web_give_ratio?o("div",{staticClass:"discount-spacial"},[e._v("\n                  +"+e._s(null==t?void 0:t.web_give_ratio)+"%\n                ")]):e._e(),e._v(" "),t.discount?o("div",{staticClass:"half-discount flex-center",style:e.getBg},[e._v("\n                  "+e._s("".concat(t.discount,"0% OFF"))+"\n                ")]):e._e()]],2),e._v(" "),o("div",{staticClass:"goods-info"},[o("div",{staticClass:"goods-info-top flex-center"},[o("div",{staticClass:"num-detail"},[o("img",{staticClass:"credit-icon",attrs:{src:n(169),alt:"credit"}}),e._v(" "),o("span",{staticClass:"num-1"},[e._v(e._s(e.getBaseCredits(t)))]),e._v(" "),o("span",[e._v("+")]),e._v(" "),o("span",{staticClass:"num-2"},[e._v(e._s(e.getBonusCredits(t)))])])]),e._v(" "),o("div",{staticClass:"mall-Credit"},[o("span",{staticClass:"words"},[e._v("\n                  "+e._s(e.getTotalCredits(t))+"\n                ")]),e._v(" "),o("div",{staticClass:"total-label"},[e._v(e._s(e.$t("Total")))])])]),e._v(" "),o("div",{staticClass:"quantity-control"},[o("el-input-number",{attrs:{min:1,max:99,size:"medium"},on:{change:function(n){return e.handleQuantityChange(t)}},model:{value:t.quantity,callback:function(n){e.$set(t,"quantity",n)},expression:"item.quantity"}})],1),e._v(" "),o("el-button",{staticClass:"purchase-btn",class:{"gradient-btn":r===e.goodsData.data.length-1},attrs:{loading:t.btnLoad},on:{click:function(n){return e.subscriptionNow(t.cp_product_id,!1)}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.maxDiscount,expression:"maxDiscount"}],staticClass:"price-old"},[e._v(e._s(e.getPriceOld(t)))]),e._v(" "),o("span",{staticClass:"price-new"},[e._v(e._s(e.getPrice(t)))])]),e._v(" "),e.isFromVideo?o("div",{staticClass:"videos-count"},[e._v("\n              ≈"+e._s(e.getVideosCount(t))+" "+e._s(e.$t("SeaartLiteVideos"))+"\n            ")]):e._e()],1)]}))],2)])]):e._e(),e._v(" "),"inPay"===e.step?o("PaymentForm",{attrs:{defaultThirdType:e.defaultThirdType,initMount:!0,upgrade:e.isUpgrade,goodsId:e.goodsId,purchParams:e.purchParams,isSubscription:!1},on:{"in-pay-back":e.quitPay,"pay-success":function(t){e.isShowDialog=!1,e.step="inGoods"}}},[o("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):e._e()],1)}),[],!1,null,"5176d844",null));e.default=A.exports},5747:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(1)),c=(n(16),n(65),n(21),n(36)),d=n(579);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"ExpiringDialog",data:function(){return{headerImg:"https://image.cdn2.seaart.me/20250528/af597e2d-ba2c-4f6e-9056-ef48027ad0e1_high.webp",subtitleIcon:"https://image.cdn2.seaart.me/20250528/b83df5b8-1f2a-4c73-8082-6203da10a308_high.webp",discountBadgeIcon:"https://image.cdn2.seaart.me/20250528/b6be5731-e477-4b03-aefd-126b71d54993_high.webp",rightsCardNowBg:"https://image.cdn2.seaart.me/20250528/507ba27a-fbd3-4b99-b90d-4609868a8ead_high.webp",rightsArrow:"https://image.cdn2.seaart.me/20250528/c521fce9-5cbc-4b21-9557-f50ac12c0a11_high.webp",isShowDialog:!1,freeDailyCoins:130,remainingDays:0,loading:!1,goodsInfo:{},reviveData:null}},computed:v(v({},Object(l.e)("payment",["paymentInfo"])),{},{daysLeft:function(){return this.remainingDays>=0?this.remainingDays:0},productLevel:function(){var t;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)||""},period:function(){var t,e,n;return null!==(t=this.currentGoodsInfo)&&void 0!==t&&t.id?null!==(e=this.currentGoodsInfo)&&void 0!==e&&e.id.includes("year")?"year":null!==(n=this.currentGoodsInfo)&&void 0!==n&&n.id.includes("week")?"week":"Month":""},currency:function(){var t;return(null===(t=this.currentGoodsInfo)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)||"$"},originPrice:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;return p?0==p.price_old?"":"year"===this.period?(12*p.price_old).toFixed(2):p.price_old:""},price:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!p)return"";var e="year"===this.period?(12*p.price).toFixed(2):p.price;return e},discount:function(){var t;return(null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.discount)||30},downgradeList:function(){var t,e=(null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.every_day_temp_coins)||700,n=Math.floor(e/30),o="";o=1==this.productLevel?this.$t("revive_expiring_svip_quota",{imageNum:e,videoNum:n}):this.$t("revive_expiring_svip_quota_advanced",{videoNum:n});var r=Math.floor(this.freeDailyCoins/30);return[{key:"quota",before:o,after:this.$t("revive_expiring_svip_quota",{imageNum:this.freeDailyCoins,videoNum:r})},{key:"speed",before:this.$t("revive_expiring_svip_speed"),after:this.$t("revive_expiring_normal_speed")},{key:"quality",before:this.$t("revive_expiring_svip_quality"),after:this.$t("revive_expiring_normal_quality")},{key:"more",before:this.$t("revive_expiring_more_rights"),after:this.$t("revive_expiring_no_rights")}]},currentGoodsInfo:function(){return Object(d.a)(this.goodsInfo,this.paymentInfo)}}),watch:{paymentInfo:{handler:function(t){this.reviveData&&!this.isShowDialog&&t&&t.recentPlan&&t.subProductId&&this.doShowDialog(this.reviveData)},immediate:!0}},created:function(){this.getGoodsInfo()},methods:v(v({},Object(l.b)("payment",["getSubscriptionList"])),{},{show:function(data){var t,e;null!==(t=this.paymentInfo)&&void 0!==t&&t.recentPlan&&null!==(e=this.paymentInfo)&&void 0!==e&&e.subProductId?this.doShowDialog(data):this.reviveData=data},doShowDialog:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.remainingDays=data.remainingDays,e.next=3,t.getGoodsInfo();case 3:if(t.currentGoodsInfo&&0!==Object.keys(t.currentGoodsInfo).length){e.next=5;break}return e.abrupt("return");case 5:t.isShowDialog=!0,Object(c.markRevivePopup)(),t.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"invalid_activation",obj_info:{benefit_type:"invalid_activation_exposure_expiring"}});case 8:case"end":return e.stop()}}),e)})))()},handleClose:function(){var t;this.$emit("close",{discount:this.discount,goodsId:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id}),this.isShowDialog=!1,this.reviveData=null},handlePay:function(){var t,e;this.$emit("pay",{dotFrom:"invalid_activation",goodsId:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id}),this.isShowDialog=!1,this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show",entity_name:"invalid_activation",obj_info:{benefit_type:"invalid_activation_click_expiring",pay_package:null===(e=this.currentGoodsInfo)||void 0===e?void 0:e.id}})},getGoodsInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.getSubscriptionList();case 4:n=e.sent,o=n.data,r=((data=void 0===o?{}:o)||{}).free_daily_coins,l=void 0===r?130:r,t.freeDailyCoins=l,t.goodsInfo=data||{},e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t.goodsInfo={};case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})))()}}),beforeDestroy:function(){this.reviveData=null}},m=(n(5590),n(0)),_=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"revive-expiring-dialog dot-group",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1,"show-close":!1,modal:!1,width:"680px"},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"revive-dialog"},[e("div",{staticClass:"revive-dialog-bg"}),t._v(" "),e("div",{staticClass:"close-btn",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"revive-expiring-icon-wrapper"},[e("img",{staticClass:"revive-expiring-icon",attrs:{src:t.headerImg,alt:"SVIP Icon"}})]),t._v(" "),e("div",{staticClass:"dialog-header"},[t._v(t._s(t.$t("revive_expiring_title")))]),t._v(" "),e("div",{staticClass:"dialog-subtitle"},[e("img",{staticClass:"subtitle-icon-img",attrs:{src:t.subtitleIcon,alt:"time"}}),t._v(" "),t.daysLeft>0?e("span",{domProps:{innerHTML:t._s(t.$t("revive_expiring_sub",{days:t.daysLeft}))}}):e("span",{domProps:{innerHTML:t._s(t.$t("revive_expiring_today"))}})]),t._v(" "),e("div",{staticClass:"dialog-content"},[e("div",{staticClass:"discount-block"},[e("div",{staticClass:"discount-left"},[e("div",{staticClass:"price-row"},[e("span",{staticClass:"period"},[t._v(t._s(t.currency))]),t._v(" "),e("span",{staticClass:"current-price"},[t._v(t._s(t.price))]),t._v(" "),e("span",{staticClass:"period"},[t._v("/ "+t._s(t.$t(t.period)))])]),t._v(" "),t.originPrice?e("div",{staticClass:"origin-price"},[t._v("\n            "+t._s(t.currency)+t._s(t.originPrice)),e("span",{staticClass:"origin-period"},[t._v("/"+t._s(t.$t(t.period)))])]):t._e()]),t._v(" "),e("div",{staticClass:"discount-right"},[e("div",{staticClass:"discount-label"},[e("img",{staticClass:"discount-label-icon",attrs:{src:t.discountBadgeIcon,alt:"time"}}),t._v(" "),e("span",{staticClass:"discount-badge"},[t._v(t._s(t.discount)+"% OFF")])]),t._v(" "),e("div",{staticClass:"discount-title"},[t._v(t._s(t.$t("revive_expiring_lb1")))]),t._v(" "),e("div",{staticClass:"discount-desc"},[t._v(t._s(t.$t("revive_expiring_discount_desc",{discount:t.discount})))])])]),t._v(" "),e("div",{staticClass:"rights-block-title"},[e("i",{staticClass:"el-icon-warning-outline"}),t._v("\n        "+t._s(t.$t("revive_expiring_rights_will_downgrade"))+"\n      ")]),t._v(" "),e("div",{staticClass:"rights-block"},[e("div",{staticClass:"rights-card now"},[e("div",{staticClass:"rights-card-header now"},[t._v(t._s(t.$t("revive_expiring_rights_now")))]),t._v(" "),e("ul",t._l(t.downgradeList,(function(n){return e("li",{key:n.key},[e("span",[t._v(t._s(n.before))])])})),0),t._v(" "),e("img",{staticClass:"rights-card-bg",attrs:{src:t.rightsCardNowBg,alt:"now-bg"}})]),t._v(" "),e("div",{staticClass:"rights-arrow"},[e("img",{attrs:{src:t.rightsArrow,alt:"arrow"}})]),t._v(" "),e("div",{staticClass:"rights-card after"},[e("div",{staticClass:"rights-card-header after"},[t._v(t._s(t.$t("revive_expiring_rights_after")))]),t._v(" "),e("ul",t._l(t.downgradeList,(function(n){return e("li",{key:n.key},[e("span",[t._v(t._s(n.after))])])})),0)])]),t._v(" "),e("div",{staticClass:"dialog-footer"},[e("button",{staticClass:"cta-btn",attrs:{"data-event":"revive-expiring-renew-btn"},on:{click:t.handlePay}},[t._v("\n          "+t._s(t.$t("revive_expiring_renew_btn",{discount:t.discount}))+"\n          "),e("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})])])])])])}),[],!1,null,"34a619d4",null).exports;function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"ExpiredDialog",computed:w(w({},Object(l.e)("payment",["paymentInfo"])),{},{productLevel:function(){var t;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)||""},expiredDays:function(){return this.remainingDays<0?Math.abs(this.remainingDays):0},period:function(){var t,e,n;return null!==(t=this.currentGoodsInfo)&&void 0!==t&&t.id?null!==(e=this.currentGoodsInfo)&&void 0!==e&&e.id.includes("year")?"year":null!==(n=this.currentGoodsInfo)&&void 0!==n&&n.id.includes("week")?"week":"Month":""},currency:function(){var t;return(null===(t=this.currentGoodsInfo)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)||"$"},originPrice:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;return p?0==p.price_old?"":"year"===this.period?(12*p.price_old).toFixed(2):p.price_old:""},price:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!p)return"";var e="year"===this.period?(12*p.price).toFixed(2):p.price;return e},discount:function(){var t;return(null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.discount)||30},rightsList:function(){var t,e=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.every_day_temp_coins,n=Math.floor(e/30),desc=1==this.productLevel?this.$t("revive_expired_quota_desc",{imageNum:e,videoNum:n}):this.$t("revive_expiring_svip_quota_advanced",{videoNum:n});return[{key:"quota",title:this.$t("revive_expired_quota_title",{num:e}),desc:desc},{key:"speed",title:this.$t("revive_expired_speed_title"),desc:this.$t("revive_expired_speed_desc")},{key:"quality",title:this.$t("revive_expired_quality_title"),desc:this.$t("revive_expired_quality_desc")},{key:"more",title:this.$t("revive_expired_more_title"),desc:this.$t("revive_expired_more_desc")}]},isZhCN:function(){return"zhCN"===this.$i18n.locale},currentGoodsInfo:function(){return Object(d.a)(this.goodsInfo,this.paymentInfo)}}),data:function(){return{iconList:["https://image.cdn2.seaart.me/20250529/39ae1a35-7316-47c7-ab5c-3da7c7a45cdf_high.webp","https://image.cdn2.seaart.me/20250529/d8c189d4-edd4-45e5-a107-9b795907081c_high.webp","https://image.cdn2.seaart.me/20250529/84cc6d99-1c61-4fd9-be72-bfe9ddb41921_high.webp","https://image.cdn2.seaart.me/20250529/483730f5-b805-482e-8b9b-68acfb3fb8dc_high.webp"],headerImg:"https://image.cdn2.seaart.me/20250529/2081688c-c549-4a17-93ee-9372b35bce5c_high.webp",discountBadgeIcon:"https://image.cdn2.seaart.me/20250528/b6be5731-e477-4b03-aefd-126b71d54993_high.webp",isShowDialog:!1,remainingDays:0,loading:!1,goodsInfo:{},reviveData:null}},watch:{paymentInfo:{handler:function(t){this.reviveData&&!this.isShowDialog&&t&&t.recentPlan&&t.subProductId&&this.doShowDialog(this.reviveData)},immediate:!0}},created:function(){this.getGoodsInfo()},methods:w(w({},Object(l.b)("payment",["getSubscriptionList"])),{},{show:function(data){var t,e;null!==(t=this.paymentInfo)&&void 0!==t&&t.recentPlan&&null!==(e=this.paymentInfo)&&void 0!==e&&e.subProductId?this.doShowDialog(data):this.reviveData=data},doShowDialog:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.remainingDays=data.remainingDays,e.next=3,t.getGoodsInfo();case 3:if(t.currentGoodsInfo&&0!==Object.keys(t.currentGoodsInfo).length){e.next=5;break}return e.abrupt("return");case 5:t.isShowDialog=!0,Object(c.markRevivePopup)(),t.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"invalid_activation",obj_info:{benefit_type:"invalid_activation_exposure_expired"}});case 8:case"end":return e.stop()}}),e)})))()},handleClose:function(){var t;this.$emit("close",{freeDailyCoins:this.freeDailyCoins,goodsId:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id}),this.isShowDialog=!1,this.reviveData=null},handlePay:function(){var t,e;this.$emit("pay",{dotFrom:"invalid_activation",goodsId:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id}),this.isShowDialog=!1,this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show",entity_name:"invalid_activation",obj_info:{benefit_type:"invalid_activation_click_expired",pay_package:null===(e=this.currentGoodsInfo)||void 0===e?void 0:e.id}})},handleViewPlans:function(){this.$emit("view-plans"),this.isShowDialog=!1},getGoodsInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.getSubscriptionList();case 4:n=e.sent,o=n.data,r=((data=void 0===o?{}:o)||{}).free_daily_coins,l=void 0===r?130:r,t.freeDailyCoins=l,t.goodsInfo=data||{},e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t.goodsInfo={};case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})))()}}),beforeDestroy:function(){this.reviveData=null}},k=(n(5591),Object(m.a)(C,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"revive-expired-dialog dot-group",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"show-close":!1,width:"680px"},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"revive-dialog"},[e("div",{staticClass:"revive-dialog-bg"}),t._v(" "),e("div",{staticClass:"close-btn",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"dialog-header"},[e("div",{staticClass:"header-img"},[e("img",{attrs:{src:t.headerImg,alt:"SVIP"}})]),t._v(" "),e("div",{staticClass:"header-info",class:{"header-info-center":t.isZhCN}},[e("h2",[t._v(t._s(t.$t("revive_expired_title")))]),t._v(" "),e("div",{staticClass:"dialog-subtitle"},[e("i",{staticClass:"el-icon-warning-outline"}),t._v(" "),e("span",{domProps:{innerHTML:t._s(t.$t("revive_expired_sub",{days:t.expiredDays}))}})])])]),t._v(" "),e("div",{staticClass:"dialog-content"},[e("div",{staticClass:"discount-block"},[e("div",{staticClass:"discount-main"},[e("div",{staticClass:"discount-left"},[e("div",{staticClass:"price-row"},[e("span",{staticClass:"period"},[t._v(t._s(t.currency))]),t._v(" "),e("span",{staticClass:"current-price"},[t._v(t._s(t.price))]),t._v(" "),e("span",{staticClass:"period"},[t._v("/ "+t._s(t.$t(t.period)))])]),t._v(" "),t.originPrice?e("div",{staticClass:"origin-price"},[t._v("\n              "+t._s(t.currency)+t._s(t.originPrice)),e("span",{staticClass:"origin-period"},[t._v("/"+t._s(t.$t(t.period)))])]):t._e()]),t._v(" "),e("div",{staticClass:"discount-right"},[e("div",{staticClass:"discount-title"},[t._v(t._s(t.$t("revive_expired_discount_title")))]),t._v(" "),e("div",{staticClass:"discount-desc"},[t._v(t._s(t.$t("revive_expired_discount_desc")))])])]),t._v(" "),e("div",{staticClass:"discount-badge"},[e("img",{staticClass:"discount-label-icon",attrs:{src:t.discountBadgeIcon,alt:"time"}}),t._v(" "),e("span",[t._v(t._s(t.discount)+"% OFF")])])]),t._v(" "),e("div",{staticClass:"rights-block"},[e("div",{staticClass:"rights-grid"},t._l(t.rightsList,(function(n,o){return e("div",{key:n.key,staticClass:"rights-item"},[e("div",{staticClass:"icon-wrapper"},[e("img",{attrs:{src:t.iconList[o],alt:"icon"}})]),t._v(" "),e("div",{staticClass:"rights-info"},[e("div",{staticClass:"rights-title"},[t._v(t._s(n.title))]),t._v(" "),e("div",{staticClass:"rights-desc"},[t._v(t._s(n.desc))])])])})),0)])]),t._v(" "),e("div",{staticClass:"dialog-footer"},[e("button",{staticClass:"cta-btn",attrs:{"data-event":"revive-expired-recover-btn"},on:{click:t.handlePay}},[t._v("\n        "+t._s(t.$t("revive_expired_recover_btn"))+"\n        "),e("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("button",{staticClass:"plan-btn",attrs:{"data-event":"revive-expired-view-plans-btn"},on:{click:t.handleViewPlans}},[t._v("\n        "+t._s(t.$t("revive_expired_view_plans"))+"\n      ")])])])])}),[],!1,null,"dd6d2fd2",null).exports);n(26);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={name:"RetainNotifyBar",data:function(){return{visible:!1,currentIndex:0,timer:null,freeDailyCoins:130,duration:5e3,goodsId:"",autoCloseTimer:null}},computed:x(x({},Object(l.e)("payment",["paymentInfo"])),{},{texts:function(){return["revive_expired_notify_kind_tips_lb1","revive_expired_notify_kind_tips_lb2","revive_expired_notify_kind_tips_lb3"]},notifyDesc:function(){if("revive_expired_notify_kind_tips_lb1"===this.texts[this.currentIndex]){var t=Math.floor(this.freeDailyCoins/30);return this.$t("revive_expired_notify_kind_tips_lb1",{imageNum:this.freeDailyCoins,videoNum:t})}return this.$t(this.texts[this.currentIndex])}}),methods:{show:function(data){this.visible=!0,this.currentIndex=0,this.freeDailyCoins=data.freeDailyCoins,this.goodsId=data.goodsId,this.startLoop(),this.autoCloseTimer=setTimeout(this.close,this.duration),this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"invalid_activation_retention",obj_info:{benefit_type:"invalid_activation_retention_exposure_expired"}})},startLoop:function(){var t=this;this.clearLoop(),this.timer=setInterval((function(){t.currentIndex=(t.currentIndex+1)%t.texts.length}),1700)},clearLoop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},close:function(){this.clearLoop(),this.$emit("close"),this.visible=!1},onRestore:function(){this.clearLoop(),this.$emit("pay",{dotFrom:"invalid_activation_retention",goodsId:this.goodsId}),this.visible=!1,this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show",entity_name:"invalid_activation_retention",obj_info:{benefit_type:"invalid_activation_retention_click_expired",pay_package:this.goodsId}})}},beforeDestroy:function(){this.clearLoop(),this.autoCloseTimer&&(clearTimeout(this.autoCloseTimer),this.autoCloseTimer=null)}},S=(n(5592),Object(m.a)(T,(function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"slide-up-pop"}},[t.visible?e("div",{staticClass:"custom-notify-bar dot-group"},[e("div",{staticClass:"gradient-bar"}),t._v(" "),e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("div",{staticClass:"notify-text"},[e("div",{staticClass:"notify-title"},[t._v(t._s(t.$t("revive_expired_notify_kind_tips_title")))]),t._v(" "),e("div",{staticClass:"notify-desc"},[t._v(t._s(t.notifyDesc))])]),t._v(" "),e("button",{staticClass:"restore-btn",attrs:{"data-event":"revive-expired-recover-btn"},on:{click:t.onRestore}},[t._v("\n      "+t._s(t.$t("revive_expired_notify_restore_btn"))+"\n    ")]),t._v(" "),e("i",{staticClass:"el-icon-close close-btn",on:{click:t.close}})]):t._e()])}),[],!1,null,"291337ae",null).exports);function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var P={name:"ReviveRetainDialog",data:function(){return{visible:!1,discount:0,goodsId:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.e)("payment",["paymentInfo"])),methods:{show:function(data){this.visible=!0,this.discount=data.discount,this.goodsId=data.goodsId,this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"invalid_activation_retention",obj_info:{benefit_type:"invalid_activation_retention_exposure_expiring"}})},handlePay:function(){this.$emit("pay",{dotFrom:"invalid_activation_retention",pageFrom:"ExpiringRetainDialog",goodsId:this.goodsId}),this.visible=!1,this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show",entity_name:"invalid_activation_retention",obj_info:{benefit_type:"invalid_activation_retention_click_expiring",pay_package:this.goodsId}})},handleCancel:function(){this.$emit("close"),this.visible=!1},close:function(){this.$emit("close"),this.visible=!1}}},I=P,$=(n(5593),Object(m.a)(I,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"revive-retain-dialog dot-group",attrs:{visible:t.visible,width:"420px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"revive-retain-dialog-content"},[e("div",{staticClass:"revive-retain-dialog-bg"}),t._v(" "),e("div",{staticClass:"retain-icon"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/20250528/c6f61667-81f5-43f1-99ac-e8d522e1604f_high.webp",alt:"warn"}})]),t._v(" "),e("div",{staticClass:"dialog-header"},[e("h2",[t._v(t._s(t.$t("revive_retain_title")))])]),t._v(" "),e("div",{staticClass:"dialog-subtitle"},[e("div",[t._v("\n        "+t._s(t.$t("revive_retain_sub1",{discount:t.discount}))+"\n      ")]),t._v(" "),e("div",[t._v("\n        "+t._s(t.$t("revive_retain_sub2"))+"\n      ")])]),t._v(" "),e("div",{staticClass:"dialog-footer"},[e("button",{staticClass:"cta-btn",attrs:{"data-event":"revive-expiring-renew-btn"},on:{click:t.handlePay}},[t._v("\n        "+t._s(t.$t("revive_retain_pay_btn",{discount:t.discount}))+"\n      ")]),t._v(" "),e("button",{staticClass:"cancel-btn",attrs:{"data-event":"revive-expiring-cancel-btn"},on:{click:t.handleCancel}},[t._v("\n        "+t._s(t.$t("revive_retain_cancel_btn"))+"\n      ")])])])])}),[],!1,null,"9a59c3ca",null).exports),j=n(78),L=n(692);function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var F={name:"ReviveDialog",components:{ExpiringDialog:_,ExpiredDialog:k,ExpiredRetainNotify:S,ExpiringRetainDialog:$},data:function(){return{visible:!1,remainingDays:0}},computed:E(E({},Object(l.e)("payment",["paymentInfo"])),{},{status:function(){return this.remainingDays>=0?"expiring":"expired"}}),methods:E(E({},Object(l.b)("payment",["getSubscriptionList"])),{},{show:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(data&&void 0!==data.balance_day){e.next=3;break}return console.error("ReviveDialog: Invalid data parameter"),e.abrupt("return");case 3:t.remainingDays=data.balance_day,"expiring"===t.status?t.$refs.ExpiringRef.show({remainingDays:t.remainingDays}):t.$refs.ExpiredRef.show({remainingDays:t.remainingDays});case 5:case"end":return e.stop()}}),e)})))()},handleExpiringClose:function(t){var e=t.discount,n=t.goodsId;this.$refs.ExpiringRetainDialogRef.show({discount:e,goodsId:n})},handleExpiredClose:function(t){var e=t.freeDailyCoins,n=t.goodsId;this.$refs.ExpiredRetainNotifyRef.show({freeDailyCoins:e,goodsId:n})},handlePay:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dotFrom,o=e.pageFrom,r=e.goodsId;Object(L.a)().then((function(){t.$EventBus.$emit("showDialog",{name:"PaymentFormDialog",data:{id:r,quantity:1,dotFrom:n,pageFrom:o},props:{initMount:!0,isSubscription:"expired"===t.status}})})).catch((function(t){console.error("Failed to show PaymentFormDialog:",t)})),this.$emit("dismiss")},handleViewPlans:function(){this.$router.push("/mall"),this.$emit("dismiss")},handleExpiredRetainNotifyClose:function(){this.close()},handleExpiringRetainDialogClose:function(){this.close()},close:function(){this.$emit("close",j.a.REVIVE_DIALOG)}})},A=F,N=Object(m.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"revive-dialog-container"},[e("ExpiringDialog",{ref:"ExpiringRef",on:{close:t.handleExpiringClose,pay:t.handlePay}}),t._v(" "),e("ExpiredDialog",{ref:"ExpiredRef",on:{pay:t.handlePay,close:t.handleExpiredClose,"view-plans":t.handleViewPlans}}),t._v(" "),e("ExpiredRetainNotify",{ref:"ExpiredRetainNotifyRef",on:{close:t.handleExpiredRetainNotifyClose,pay:t.handlePay}}),t._v(" "),e("ExpiringRetainDialog",{ref:"ExpiringRetainDialogRef",on:{close:t.handleExpiringRetainDialogClose,pay:t.handlePay}})],1)}),[],!1,null,"1e7dd777",null);e.default=N.exports},5753:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(926)),l=(n(26),{name:"HomeToolkit",data:function(){return{left2ImgUrl:"https://image.cdn2.seaart.me/static/web/transfer/toolkit_left2.webp",left1ImgUrl:"https://image.cdn2.seaart.me/static/web/transfer/toolkit_left1.webp",centerImgUrl:"https://image.cdn2.seaart.me/static/web/transfer/toolkit_center.webp",right1ImgUrl:"https://image.cdn2.seaart.me/static/web/transfer/toolkit_right1.webp",right2ImgUrl:"https://image.cdn2.seaart.me/static/web/transfer/toolkit_right2.webp",scrollProgress:0,scrollStartThreshold:100,scrollEndThreshold:300,scrollTimer:null,lastProgress:-1,animationId:null,centerImg:null}},mounted:function(){var t=this;window.addEventListener("scroll",this.throttledHandleScroll),this.$nextTick((function(){t.centerImg=t.$el.querySelector(".home-toolkit__img--center")}))},beforeDestroy:function(){window.removeEventListener("scroll",this.throttledHandleScroll),this.scrollTimer&&clearTimeout(this.scrollTimer),this.animationId&&cancelAnimationFrame(this.animationId)},methods:{throttledHandleScroll:function(){var t=this;this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((function(){t.animationId&&cancelAnimationFrame(t.animationId),t.animationId=requestAnimationFrame((function(){t.handleScroll()}))}),50)},handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop,progress=0;progress=t<=this.scrollStartThreshold?0:t>=this.scrollEndThreshold?1:(t-this.scrollStartThreshold)/(this.scrollEndThreshold-this.scrollStartThreshold),progress=Math.round(100*progress)/100,Math.abs(progress-this.lastProgress)<.05||(this.scrollProgress=progress,this.lastProgress=progress,this.$el.style.setProperty("--scroll-progress",progress),this.centerImg&&(this.centerImg.style.alignSelf=progress>.5?"center":"flex-end"))}}}),c=(n(5528),n(0)),d=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-toolkit"},[e("div",{staticClass:"home-toolkit__img home-toolkit__img--left2"},[e("img",{attrs:{src:t.left2ImgUrl,alt:"toolkit-img"}})]),t._v(" "),e("div",{staticClass:"home-toolkit__img home-toolkit__img--left1"},[e("img",{attrs:{src:t.left1ImgUrl,alt:"toolkit-img"}})]),t._v(" "),e("div",{staticClass:"home-toolkit__img home-toolkit__img--center"},[e("img",{attrs:{src:t.centerImgUrl,alt:"toolkit-img"}})]),t._v(" "),e("div",{staticClass:"home-toolkit__img home-toolkit__img--right1"},[e("img",{attrs:{src:t.right1ImgUrl,alt:"toolkit-img"}})]),t._v(" "),e("div",{staticClass:"home-toolkit__img home-toolkit__img--right2"},[e("img",{attrs:{src:t.right2ImgUrl,alt:"toolkit-img"}})])])}),[],!1,null,"457443a9",null).exports,h=(n(11),n(6),n(12),n(13),n(8),n(4),n(7),n(2)),v=n(1);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var m={name:"HomeNavbar",computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(v.c)("user",["isLoggedIn"])),methods:{handleSignUp:function(){var t=this;this.isLoggedIn?this.$router.push("/"):this.$EventBus.$emit("openLoginDialog",{callBack:function(){t.$router.push("/")}})}}},_=m,y=(n(5529),Object(c.a)(_,(function(){var t=this,e=t._self._c;return e("nav",{staticClass:"home-navbar"},[e("div",{staticClass:"home-navbar__container"},[e("img",{staticClass:"home-navbar__logo",attrs:{src:"https://image.cdn2.seaart.me/static/web/transfer/logo.webp",alt:"SeaArt Logo"}}),t._v(" "),e("div",{staticClass:"home-navbar__links"},[e("a",{staticClass:"home-navbar__link",attrs:{href:"/create/image"}},[t._v(t._s(t.$t("imageGeneration")))]),t._v(" "),e("a",{staticClass:"home-navbar__link",attrs:{href:"/create/video"}},[t._v(t._s(t.$t("videoGeneration")))]),t._v(" "),e("a",{staticClass:"home-navbar__link",attrs:{href:"/swift_app"}},[t._v(t._s(t.$t("Swtft_App")))]),t._v(" "),e("a",{staticClass:"home-navbar__link",attrs:{href:"/aiChat"}},[t._v(t._s(t.$t("CreationCenterIntroduce6NumberPeople")))])]),t._v(" "),e("div",{staticClass:"home-navbar__btn double-border",on:{click:t.handleSignUp}},[e("div",{staticClass:"double-border__inner"},[t._v(t._s(t.$t("sign_up")))])])])])}),[],!1,null,"1a4535c2",null).exports),w=(n(72),n(69),n(24),n(40),n(152),{name:"HomeShowcase",props:{defaultIndex:{type:Number,default:0}},data:function(){return{currentIndex:this.defaultIndex,isDragging:!1,resizeHandler:null}},watch:{defaultIndex:function(t){this.currentIndex=t,this.scrollToActiveTab(t)}},computed:{tabList:function(){return[{title:this.$t("imageGeneration"),description:this.$t("home_short_panel_desc1"),image:"https://image.cdn2.seaart.me/static/web/transfer/swiper-img.webp",placeholder:"[示例大图占位]",link:"/create/image"},{title:this.$t("videoGeneration"),description:this.$t("home_short_panel_desc2"),image:"https://image.cdn2.seaart.me/static/web/transfer/swiper-video.webp",placeholder:"[视频生成示例]",link:"/create/video"},{title:this.$t("Swtft_App"),description:this.$t("XKLP_DESC003"),image:"https://image.cdn2.seaart.me/static/web/transfer/swiper-app.webp",placeholder:"[视频生成示例]",link:"/swift_app"},{title:this.$t("CreationCenterIntroduce6NumberPeople"),description:this.$t("home_short_panel_desc3"),image:"https://image.cdn2.seaart.me/static/web/transfer/swiper-character.webp",placeholder:"[数字人示例]",link:"/aiChat"}]}},mounted:function(){var t=this;this.initDragScroll(),this.initResizeHandler(),this.$nextTick((function(){setTimeout((function(){t.scrollToActiveTab(t.currentIndex)}),200)}))},beforeDestroy:function(){this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler)},methods:{initDragScroll:function(){var t=this,e=this.$el.querySelector(".home-tabs__nav");if(e){var n,o,r,l=!1,c=!1,d=null;e.addEventListener("mousedown",(function(h){l=!0,t.isDragging=!1,c=!1,n=h.pageX-e.offsetLeft,o=e.scrollLeft,r=Date.now(),d=h.target,e.style.cursor="grabbing",h.preventDefault()})),e.addEventListener("mousemove",(function(r){if(l){var d=r.pageX-e.offsetLeft-n;if(Math.abs(d)>5){t.isDragging=!0,c=!0,r.preventDefault();var h=o-d,v=e.scrollWidth-e.clientWidth,f=Math.max(0,Math.min(h,v));e.scrollLeft=f}}})),e.addEventListener("mouseup",(function(n){if(l=!1,e.style.cursor="grab",setTimeout((function(){t.isDragging=!1}),300),!c&&Date.now()-r<300){for(var o=d;o&&!o.classList.contains("home-tabs__item");)o=o.parentElement;if(o&&o.classList.contains("home-tabs__item")){var h=e.querySelectorAll(".home-tabs__item"),v=Array.from(h).indexOf(o);-1!==v&&t.handleTabClick(v)}}})),e.addEventListener("mouseleave",(function(){l=!1,e.style.cursor="grab",setTimeout((function(){t.isDragging=!1}),300)})),e.addEventListener("touchstart",(function(h){1===h.touches.length&&(l=!0,t.isDragging=!1,c=!1,n=h.touches[0].pageX-e.offsetLeft,o=e.scrollLeft,r=Date.now(),d=h.target)})),e.addEventListener("touchmove",(function(r){if(l&&1===r.touches.length){var d=r.touches[0].pageX-e.offsetLeft-n;if(Math.abs(d)>5){t.isDragging=!0,c=!0,r.preventDefault();var h=o-d,v=e.scrollWidth-e.clientWidth,f=Math.max(0,Math.min(h,v));e.scrollLeft=f}}})),e.addEventListener("touchend",(function(n){if(l=!1,setTimeout((function(){t.isDragging=!1}),300),!c&&Date.now()-r<300){for(var o=d;o&&!o.classList.contains("home-tabs__item");)o=o.parentElement;if(o&&o.classList.contains("home-tabs__item")){var h=e.querySelectorAll(".home-tabs__item"),v=Array.from(h).indexOf(o);-1!==v&&t.handleTabClick(v)}}}))}},scrollToActiveTab:function(t){var e=this;this.isDragging||this.$nextTick((function(){var n=e.$el.querySelector(".home-tabs__nav"),o=n.querySelectorAll(".home-tabs__item");if(n&&o[t]){var r=o[t],l=n.getBoundingClientRect(),c=r.getBoundingClientRect();if(0!==l.width&&0!==c.width){var d=c.left-l.left+n.scrollLeft,h=c.width,v=d-(l.width-h)/2,f=n.scrollWidth-n.clientWidth,m=Math.max(0,Math.min(v,f));Math.abs(n.scrollLeft-m)<10||n.scrollTo({left:m,behavior:"smooth"})}else setTimeout((function(){return e.scrollToActiveTab(t)}),100)}}))},handleTabClick:function(t){this.currentIndex=t,this.$refs.carousel.setActiveItem(t),this.scrollToActiveTab(t)},handleCarouselChange:function(t){var e=this;this.currentIndex=t,setTimeout((function(){e.scrollToActiveTab(t)}),100)},handleActionClick:function(t){t.link&&this.$router.push(t.link)},handlePrevClick:function(){this.$refs.carousel.prev()},handleNextClick:function(){this.$refs.carousel.next()},initResizeHandler:function(){var t=this,e=null;this.resizeHandler=function(){e&&clearTimeout(e),e=setTimeout((function(){t.scrollToActiveTab(t.currentIndex)}),300)},window.addEventListener("resize",this.resizeHandler)}}}),C=(n(5530),Object(c.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-showcase-wrapper"},[e("section",{staticClass:"home-tabs"},[e("div",{staticClass:"home-tabs__title"},[e("span",{staticClass:"highlight"},[t._v(t._s(t.$t("XKLP_MENU001")))]),t._v(" "),e("img",{staticClass:"toolkit-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/transfer/toolkit-icon.webp",alt:"",srcset:""}})]),t._v(" "),e("div",{staticClass:"home-tabs__nav"},t._l(t.tabList,(function(n,o){return e("span",{key:o,staticClass:"home-tabs__item",class:{"is-active":t.currentIndex===o}},[t._v("\n        "+t._s(n.title)+"\n      ")])})),0)]),t._v(" "),e("section",{staticClass:"home-showcase"},[e("el-carousel",{ref:"carousel",attrs:{autoplay:!0,"indicator-position":"none",arrow:"never","initial-index":t.currentIndex,height:"41.1vw"},on:{change:t.handleCarouselChange}},t._l(t.tabList,(function(n,o){return e("el-carousel-item",{key:o},[e("div",{staticClass:"carousel-content"},[e("div",{staticClass:"home-showcase__img"},[n.image?e("img",{attrs:{src:n.image,alt:n.title}}):e("div",{staticClass:"placeholder-img"},[t._v(t._s(n.placeholder||"[示例大图占位]"))])]),t._v(" "),e("div",{staticClass:"home-showcase__desc"},[e("div",{staticClass:"home-showcase__mask"}),t._v(" "),e("div",{staticClass:"home-showcase__content"},[e("div",{staticClass:"home-showcase__text-area",on:{click:function(e){return t.handleActionClick(n)}}},[e("div",{staticClass:"home-showcase__title"},[t._v(t._s(n.title))]),t._v(" "),e("div",{staticClass:"home-showcase__text"},[t._v(t._s(n.description))])]),t._v(" "),e("div",{staticClass:"home-showcase__btn",on:{click:function(e){return t.handleActionClick(n)}}},[e("img",{staticClass:"home-showcase__btn-img",attrs:{src:"https://image.cdn2.seaart.me/static/web/transfer/swiper_arrow_btn.webp",alt:"arrow"}})])])])])])})),1),t._v(" "),e("div",{staticClass:"custom-arrow custom-arrow--left",on:{click:t.handlePrevClick}}),t._v(" "),e("div",{staticClass:"custom-arrow custom-arrow--right",on:{click:t.handleNextClick}})],1)])}),[],!1,null,"3e181042",null).exports),k={name:"TransferpageHome",components:{FooterDisplay:r.a,HomeToolkit:d,HomeNavbar:y,HomeShowcase:C},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.app,o=t.redirect,!n.$cookies.get("T")){e.next=4;break}return e.abrupt("return",o("/"));case 4:return e.abrupt("return",{});case 5:case"end":return e.stop()}}),e)})))()},data:function(){return{}},methods:{handleToHome:function(){this.$router.push("/")}}},O=(n(5531),Object(c.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"transferpage-home-wrapper"},[e("HomeNavbar"),t._v(" "),e("div",{staticClass:"transferpage-home"},[e("section",{staticClass:"home-banner"},[e("div",{staticClass:"home-banner__content"},[e("h1",{staticClass:"home-banner__title"},[e("span",{staticClass:"highlight"},[t._v(t._s(t.$t("XKLP_TITLE001")))])]),t._v(" "),e("p",{staticClass:"home-banner__desc"},[t._v("\n          "+t._s(t.$t("XKLP_TEXT001"))+"\n        ")]),t._v(" "),e("div",{staticClass:"home-banner__btn",on:{click:t.handleToHome}},[e("div",{staticClass:"home-banner__btn-inner"},[e("img",{staticClass:"home-banner__btn-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/transfer/magic-icon.svg",alt:"",srcset:""}}),t._v("\n            "+t._s(t.$t("XKLP_BUTTON002"))+"\n          ")])])])]),t._v(" "),e("section",[e("HomeToolkit")],1)]),t._v(" "),e("HomeShowcase",{attrs:{defaultIndex:0}})],1)}),[],!1,null,"5a26d2b1",null));e.default=O.exports},5755:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(1),l=(n(24),n(87)),c={name:"PhotoSelector",props:{initIndex:{type:Number,default:0}},components:{},watch:{initIndex:{handler:function(t){this.selectIndex=t}}},computed:{currentItem:function(){return this.goodsList[this.selectIndex]}},data:function(){return{goodsList:[{id:"ai_photo_20",num:20,price:19.99},{id:"ai_photo_40",num:40,price:29.99},{id:"ai_photo_80",num:80,price:39.99}],selectIndex:this.initIndex}},mounted:function(){this.getGoodsList()},methods:{getGoodsList:function(){var t=this;Object(l.d)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.goodsList=null==e||null===(o=e.data)||void 0===o?void 0:o.list,t.$emit("select-item",t.currentItem.id))}))},selectItem:function(t,e){this.selectIndex=e,this.$emit("select-item",t.id)}}},d=(n(5579),n(0)),h=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"photo-selector"},[e("div",{staticClass:"head-title"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("chargePhotoDltTitle")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("chargePhotoDltSubTitle")))])]),t._v(" "),e("div",{staticClass:"select-container"},t._l(t.goodsList,(function(n,o){return e("div",{key:n.id+o,staticClass:"select-item",class:{active:t.selectIndex===o},on:{click:function(e){return t.selectItem(n,o)}}},[e("div",{staticClass:"indicator"},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.selectIndex===o,expression:"selectIndex === index"}],staticClass:"el-icon-check"})]),t._v(" "),e("div",{staticClass:"numbers-and-price"},[e("div",{staticClass:"numbers"},[t._v(t._s(t.$t("ImgsNumber",{num:n.num})))]),t._v(" "),e("div",{staticClass:"price"},[t._v("US$"+t._s(n.price)+" "+t._s(t.$t("payOneTime")))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:o>0,expression:"index > 0"}],staticClass:"float-tag"},[t._v("\n        "+t._s(1===o?t.$t("mostSelect"):t.$t("bestValue"))+"\n      ")])])})),0),t._v(" "),t._t("default")],2)}),[],!1,null,"3057ae3e",null).exports,v=(n(18),n(3)),f=(n(20),n(19),n(32),n(16),n(21),n(40),n(41),n(26),n(3438)),m=n(10);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w=n(505),C={name:"PaymentPhoto",inject:["top"],props:{initMount:{type:Boolean,default:!1},defaultThirdType:{type:[Number,String],default:9},disabledMethods:{type:Array,default:function(){return[]}},goodsId:{type:[Number,String],default:""},isFreeTry:{type:Boolean,default:!1},showFreeTry:{type:Boolean,default:!0},purchParams:{type:Object,default:function(){return{}}},upgrade:{type:[Number,Boolean],default:0},isSubscription:{type:Boolean,default:!0},btnLabel:{type:String,default:""},backToCheck:{type:Boolean,default:!1},from:{type:String,default:""},dom:{validator:function(t){return t instanceof HTMLDivElement},default:null}},components:{PaymentCheck:f.default},watch:{inPaymentForm:function(t){t&&this.$emit(t)}},computed:y(y(y({},Object(r.e)("payment",["paymentInfo","adyenFailed","adyenPaymenMethods"])),Object(r.e)("user",["userInfo"])),{},{pageLocation:function(){var t;return(null===(t=this.$route)||void 0===t?void 0:t.path)||"/"},$isChinaSite:function(){return!1},showBack:function(){return!0},allMethods:function(){var t=this,e=[{name:"Credit Card",i18n:"Credit Card",newWindow:!1,icon:"adyen-icon.png",type:9},{name:"AliPay",i18n:"alipay",newWindow:!1,icon:"alipay-icon.png",type:9},{name:"Google Pay",i18n:"Google Pay",newWindow:!1,icon:"googlepay-icon.png",type:9},{name:"PIX",i18n:"PIX",newWindow:!0,icon:"pix-icon.png",type:1},{name:"Paypal",i18n:"Paypal",newWindow:!0,icon:"paypal-icon.png",type:10}];return this.disabledMethods.length&&(e=e.filter((function(e){return!t.disabledMethods.includes(e.type)}))),this.isShowPayermax||(e=e.filter((function(t){return 1!==t.type}))),this.useTry&&(e=e.filter((function(t){return![1,10].includes(t.type)}))),this.isShowAlipay||(e=e.filter((function(t){return"AliPay"!==t.name}))),this.upgrade&&this.defaultThirdType&&(e=e.filter((function(e){return e.type===t.defaultThirdType})),8===this.defaultThirdType&&this.$message.warning(this.$t("bandStripe"))),e},creditCard:function(){return this.allMethods.find((function(t){return"Credit Card"===t.name}))},trueUpgrade:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)&&this.upgrade},btnTxt:function(){return this.isSubscription?"SubscribeNow":"businesSwiperBtn1"},isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")},isShowBillingAddress:function(){var t,e=null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code;return["US","UK","GB","CA"].includes(e)},isShowAlipay:function(){var t;return"CN"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isShowPayermax:function(){var t;return"BR"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isBindAdyen:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.bind_adyen},defaultThirdItem:function(){var t=this;if(this.defaultThirdType){if("string"==typeof this.defaultThirdType)return this.allMethods.find((function(e){return e.name===t.defaultThirdType}));if("number"==typeof this.defaultThirdType)return this.allMethods.find((function(e){return e.type===t.defaultThirdType}))}return this.creditCard||this.allMethods[0]}}),data:function(){return{AdyenCheckout:null,activeMethod:null,selectAdyenMethod:{brands:["visa","mc","cup","jcb"],name:"Credit Card",type:"scheme"},thirdOrderId:"",adyenComponent:null,adyenComponent2:null,adyenTempAction:null,adyenTempPayment:null,inPaymentForm:"in-form",qrCode:null,wechatBtnLoading:!1,wechatBtnDisabled:!1,useTry:!1,backToClose:!1,inCreating:!1,resultMethod:null}},mounted:function(){var t=this;if(this.loadAdyenCheckout(),Object(m.I)("https://cdn.jsdelivr.net/npm/@adyen/adyen-web@latest/dist/adyen.css"),this.useTry=this.isFreeTry&&"mall"!==this.from,this.adyenPaymenMethods||this.getAdyenPaymentMethod(),this.initMount){var e=this.allMethods.find((function(e){var n;return e.name===(null===(n=t.defaultThirdItem)||void 0===n?void 0:n.name)}));e||(e=this.creditCard),this.resultMethod=this.allMethods.find((function(t){return"Google Pay"===t.name})),e&&this.selectMethod(e)}},methods:y(y(y({},Object(r.b)("payment",["getPaymentInfo","setAdyenFailed","setSubThirdType","getAdyenPaymentMethod"])),Object(r.b)("user",["getAccountInfo"])),{},{loadAdyenCheckout:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.e(27).then(n.t.bind(null,6365,7));case 3:o=e.sent,t.AdyenCheckout=o.default,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load Adyen Checkout:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},initPayments:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.adyenPaymenMethods){e.next=3;break}return e.next=3,t.getAdyenPaymentMethod();case 3:case"end":return e.stop()}}),e)})))()},handleBack:function(){console.log("handleBack",this.inPaymentForm,this.backToClose),"in-waiting"===this.inPaymentForm&&(this.$refs.paymentCheck.getPaymentOnce(),this.$refs.paymentCheck.stopPoll()),this.backToCheck?this.$emit("in-pay-back"):("in-form"===this.inPaymentForm&&(this.resultMethod=this.allMethods.find((function(t){return"Google Pay"===t.name}))),"in-waiting"!==this.inPaymentForm||this.backToClose?(this.qrCode=null,this.$emit("in-pay-back"),this.$refs.paymentCheck.stopPoll()):this.inPaymentForm="in-form")},selectMethod:function(t){var e=t;"string"==typeof t&&(e=this.allMethods.find((function(i){return i.name===t})),this.resultMethod=e),console.log("selectMethod",e,this.adyenPaymenMethods),this.activeMethod=e,9===e.type&&this.startCheckout()},startCheckout:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("dom",t.dom),e.next=3,t.initPayments();case 3:return(o=null===(n=t.adyenPaymenMethods)||void 0===n?void 0:n.paymentMethods)&&(t.selectAdyenMethod=o.find((function(e){return e.name===t.activeMethod.name}))),console.log("this.selectAdyenMethod",t.selectAdyenMethod,t.AdyenCheckout),e.next=8,t.loadAdyenCheckout();case 8:if(t.AdyenCheckout&&t.selectAdyenMethod){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t.createAdyenCheckout();case 12:r=e.sent,t.adyenComponent=r.create("scheme",{hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress}),t.adyenComponent2=r.create("googlepay",{hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress,buttonType:"short",buttonColor:"white",buttonLocale:t.$i18n.locale||"en"}),t.adyenComponent.mount(t.$refs["adyen".concat(t.selectAdyenMethod.type)]),t.dom&&t.adyenComponent2.mount(t.dom);case 17:case"end":return e.stop()}}),e)})))()},createAdyenCheckout:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={locale:t.$i18n.locale,clientKey:"production".includes("production")?"live_Q2TOAFSMXNDDZIHVMRZZ3DRK2MGQQ6OX":"test_W6R5OPPNSJG2HNO2ZJ5DNOUORIJJY53E",environment:"production".includes("production")?"production":"test",showPayButton:!0,paymentMethodsResponse:t.adyenPaymenMethods,onPaymentCompleted:function(t,component){console.log("onPaymentCompleted result: "+t)},onSubmit:function(){var e=Object(v.a)(regeneratorRuntime.mark((function e(n,component){var o,r,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onSubmit:",n,component),t.adyenTempPayment=null==n||null===(o=n.data)||void 0===o?void 0:o.paymentMethod,p={adyen_payment_method:t.adyenTempPayment,browser_info:null==n||null===(r=n.data)||void 0===r?void 0:r.browserInfo,origin:null==n||null===(l=n.data)||void 0===l?void 0:l.origin},e.next=5,t.purchaseGoodsFun(9,y({},p));case 5:console.log("onSubmit: 创建完订单 adyenTempAction",t.adyenTempAction,"thirdOrderId",t.thirdOrderId),t.adyenTempAction&&component.handleAction(t.adyenTempAction);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onAdditionalDetails:function(e,component){var n;console.log("onAdditionalDetails:",e,component);var o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.details)||void 0===n?void 0:n.threeDSResult)||"";o&&t.checkThreeDResult(o)},onError:function(e,component){console.error("onError:",e.name,e.message,e.stack,component),t.reRenderAdyen()}},console.log("configuration",n),e.abrupt("return",new t.AdyenCheckout(n));case 3:case"end":return e.stop()}}),e)})))()},reRenderAdyen:function(){this.adyenComponent.unmount(),this.adyenComponent.mount(this.$refs["adyen".concat(this.selectAdyenMethod.type)])},purchaseGoodsFun:function(){var t=arguments,e=this;return Object(v.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h,v,f,m,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=t.length>0&&void 0!==t[0]?t[0]:9,d=t.length>1&&void 0!==t[1]?t[1]:{},!e.inCreating){n.next=4;break}return n.abrupt("return");case 4:if(e.$refs.paymentCheck.stopPoll(),!e.upgrade){n.next=9;break}if(!e.trueUpgrade){n.next=9;break}return e.setUpgrade(c),n.abrupt("return");case 9:if([6,8,9].includes(c)&&1!==(null===(o=e.paymentInfo)||void 0===o?void 0:o.purchaseType)&&e.isSubscription){if(v=l.p,h=y(y({cp_product_id:e.goodsId,with_trial:e.useTry,change_type:1,third_plat_type:c,page_location:e.pageLocation},e.purchParams),d),8===(null===(f=e.activeMethod)||void 0===f?void 0:f.type)){h.client_reference_id="";try{(_=Rewardful&&(null===(m=Rewardful)||void 0===m?void 0:m.referral)||"")&&(h.client_reference_id=_)}catch(t){console.log("Rewardful, error",t)}}}else v=l.o,h=y(y({cp_product_id:e.goodsId,os:"1",quantity:1,third_plat_type:c,page_location:e.pageLocation},e.purchParams),d);return(null==e||null===(r=e.top)||void 0===r?void 0:r.dotFrom)&&(h.from=e.top.dotFrom),5===c&&(e.wechatBtnLoading=!0),e.$emit("in-loading",!0),e.inCreating=!0,n.next=16,v(h).then((function(t){var n,o=t.data,r=o.PaymentUrl,l=o.ThirdOrderId,d=o.AdyenAction;if(9===(null===(n=e.activeMethod)||void 0===n?void 0:n.type)&&d){var h=JSON.parse(d),v=h.action,f=h.merchantReference;v?e.adyenTempAction=v:f?(e.thirdOrderId=f,e.$emit("check-payment-status",{type:9,order_id:f}),e.showWaitPayment()):console.log("create error, no action or merchantReference")}else if(r&&5!==c){e.thirdOrderId=l;var m=window.screen.height/2-300,_=window.screen.width/2-400;e.showWaitPayment(),window.open(r,"newWindow","height=600,width=800,top=".concat(m,",left=").concat(_))}else 5===c?(e.thirdOrderId=l,e.wechatBtnLoading=!1,e.wechatBtnDisabled=!0,setTimeout((function(){e.wechatBtnDisabled=!1}),3e5),e.appendQrCode(r)):console.log("create error, no PaymentUrl or AdyenAction")})).catch((function(t){var n;console.error("purchaseGoodsFun:",t),"Credit Card"===(null===(n=e.activeMethod)||void 0===n?void 0:n.name)&&(e.setAdyenFailed(),e.reRenderAdyen())})).finally((function(){e.inCreating=!1,e.$emit("in-loading",!1)}));case 16:case"end":return n.stop()}}),n)})))()},checkThreeDResult:function(t){var e=this,n={three_ds_result:t,adyen_payment_method:this.adyenTempPayment};Object(l.a)(n).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data.order_id;e.thirdOrderId=o,e.$emit("check-payment-status",{type:9,order_id:o}),e.showWaitPayment()}})).catch((function(t){console.log("checkThreeDs error",t),e.reRenderAdyen()}))},setUpgrade:function(t){var e,n=this;if(8!=t){var o={change_type:1,cp_product_id:null==this?void 0:this.goodsId,third_plat_type:t,page_location:this.pageLocation};(null==this||null===(e=this.top)||void 0===e?void 0:e.dotFrom)&&(o.from=this.top.dotFrom),Object(l.q)(o).then((function(t){var e=t.data,o=e.PaymentUrl;e.ThirdOrderId;o?window.open(o):(n.$message.success(n.$t("OperateSuccess")),n.$refs.paymentCheck.paySuccess())}))}else this.$message.warning(this.$t("bandStripe"))},paymentSuccess:function(){this.saveSubType(this.activeMethod.type),this.$emit("pay-success"),this.inPaymentForm="in-form",this.isYahoo},paymentError:function(t){var e=t.type;this.inPaymentForm="in-form",9===e&&this.reRenderAdyen()},saveSubType:function(t){var e,n;1!==(null===(e=this.paymentInfo)||void 0===e?void 0:e.purchaseType)&&this.isSubscription&&this.setSubThirdType(t),"Credit Card"===(null===(n=this.activeMethod)||void 0===n?void 0:n.name)&&this.getAccountInfo()},showWaitPayment:function(){this.inPaymentForm="in-waiting"},appendQrCode:function(t){var e=this;this.$refs.QRCodeContainer[0].innerHTML="",this.$nextTick((function(){var n=e.$refs.QRCodeContainer[0];e.qrCode=new w(n,{text:t,width:85,height:85}),e.$refs.paymentCheck.pollGetPaymentStatus(5)}))}})},k=C,O=(n(5581),n(5582),Object(d.a)(k,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{staticClass:"payment-content"},[r.$slots.default?l("div",{staticClass:"close-icon flex-center",on:{click:r.handleBack}},[l("i",{staticClass:"el-icon-close",class:{waiting:"in-waiting"===r.inPaymentForm}})]):r._e(),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"in-form"===r.inPaymentForm,expression:"inPaymentForm === 'in-form'"}],staticClass:"in-payment-content w-full flex"},[l("div",{staticClass:"left"},[l("div",{directives:[{name:"show",rawName:"v-show",value:r.showBack,expression:"showBack"}],staticClass:"back-to",on:{click:r.handleBack}},[l("i",{staticClass:"el-icon-arrow-left"}),r._v(r._s(r.$slots.default?r.$t("changePlan"):r.$t("Back"))+"\n      ")]),r._v(" "),r.activeMethod&&!r.$isChinaSite?l("div",{staticClass:"payment-form flex items-center"},[l("div",{directives:[{name:"show",rawName:"v-show",value:"Credit Card"===(null===(t=r.activeMethod)||void 0===t?void 0:t.name),expression:"activeMethod?.name === 'Credit Card'"}],ref:"adyenscheme",staticClass:"adyen-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"AliPay"===(null===(e=r.activeMethod)||void 0===e?void 0:e.name),expression:"activeMethod?.name === 'AliPay'"}],ref:"adyenalipay",staticClass:"alipay-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"Google Pay"===(null===(n=r.activeMethod)||void 0===n?void 0:n.name),expression:"activeMethod?.name === 'Google Pay'"}],ref:"adyengooglepay",staticClass:"googlepay-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:9!==(null===(o=r.activeMethod)||void 0===o?void 0:o.type),expression:"activeMethod?.type !== 9"}],staticClass:"other-payment flex items-center w-full"},[l("div",{staticClass:"other-payment-btn w-full",on:{click:function(t){var e;return r.purchaseGoodsFun(null===(e=r.activeMethod)||void 0===e?void 0:e.type)}}},[r._v("\n            "+r._s(r.btnLabel?r.$t(r.btnLabel):r.$t(r.btnTxt))+"\n          ")])])]):r._e()]),r._v(" "),r.$slots.default?l("div",{staticClass:"right"},[r._t("default")],2):r._e()]),r._v(" "),l("payment-check",{directives:[{name:"show",rawName:"v-show",value:"in-waiting"===r.inPaymentForm,expression:"inPaymentForm === 'in-waiting'"}],ref:"paymentCheck",attrs:{activeMethod:r.resultMethod,thirdOrderId:r.thirdOrderId},on:{success:r.paymentSuccess,paymentError:r.paymentError,back:r.handleBack}})],1)}),[],!1,null,"16a9f647",null).exports);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={name:"PhotoImage",props:{},computed:T(T({},Object(r.e)("user",["cdnHost"])),{},{backgroundImage:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241115/07e3651b-02c5-41f5-8886-042baf706b20.jpg)")}}}),data:function(){return{}},mounted:function(){},methods:{}};n(5583);function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I={name:"AiPhotoPayment",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,useFree:!1,btnLabel:"",dotFrom:"ai_profile_popup",taskId:"",styleNumber:0,renderDOM:null,successCallback:null}},components:{PhotoSelector:h,PaymentPhoto:O,PhotoImage:Object(d.a)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-image",style:t.backgroundImage},[e("div",{staticClass:"container"},[e("div",{staticClass:"text"},[e("div",{staticClass:"title"},[t._v("\n        "+t._s(t.$t("payPhotoTitle"))+"\n      ")]),t._v(" "),e("ul",{staticClass:"benefit"},[e("li",[t._v(t._s(t.$t("payPhotoSub1")))]),t._v(" "),e("li",[t._v(t._s(t.$t("payPhotoSub2")))])])])])])}),[],!1,null,"ab54041e",null).exports},mounted:function(){var t=this;this.$EventBus.$on("openAIPhotoPayment",(function(e,n,o){console.log("openAIPhotoPayment",e,n),t.taskId=e,t.styleNumber=n,t.isShowDialog=!0,t.successCallback=o,t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_ai_profile_generation_popup",behavior_info_sub:"pop_1"}),t.$xyLogEvent({front_operation:"exposure",entity_name:"on_ai_profile_generation_popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),t.$nextTick((function(){t.renderGooglePay()}))}))},beforeDestroy:function(){this.$EventBus.$off("openAIPhotoPayment")},computed:P(P(P(P(P({},Object(r.c)("payment",["paymentInfo"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.e)("user",["cdnHost"])),Object(r.e)("payment",["subThirdType"])),{},{imgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20241115/07e3651b-02c5-41f5-8886-042baf706b20.jpg")},initIndex:function(){return this.styleNumber<=4?0:this.styleNumber<=7?1:2}}),methods:P(P({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{renderGooglePay:function(){this.renderDOM=this.$refs.adyengooglepay,console.log("renderDOM",this.renderDOM,this.$refs.paymentPhoto),this.$refs.paymentPhoto.startCheckout(this.renderDOM)},close:function(){this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},selectPayment:function(t){console.log("name",t),this.$refs.paymentPhoto.selectMethod(t),this.step="inPay",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_ai_profile_generation_popup",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"on_ai_profile_generation_popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}})},handleSuccess:function(){this.successCallback&&this.successCallback(),this.isShowDialog=!1,this.step="inGoods"}})},$=(n(5584),Object(d.a)(I,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"ai-photo-payment-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1,"data-group":"ai_profile_generation_popup"},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("PhotoSelector",{directives:[{name:"show",rawName:"v-show",value:"inGoods"===t.step,expression:"step === 'inGoods'"}],attrs:{initIndex:t.initIndex},on:{"select-item":function(e){t.goodsId=e}}},[e("div",{staticClass:"payment-methods flex w-full justify-center"},[e("div",{staticClass:"credit-card btn",on:{click:function(e){return t.selectPayment("Credit Card")}}},[t._v("Credit Card")]),t._v(" "),e("div",{ref:"adyengooglepay",staticClass:"google-pay btn"})])]),t._v(" "),e("PaymentPhoto",{directives:[{name:"show",rawName:"v-show",value:"inPay"===t.step,expression:"step === 'inPay'"}],ref:"paymentPhoto",attrs:{defaultThirdType:"Credit Card",dom:t.renderDOM,disabledMethods:[1,4,5,8,10],initMount:!0,isSubscription:!1,upgrade:!1,goodsId:t.goodsId,purchParams:{task_id:t.taskId},btnLabel:t.btnLabel},on:{"in-waiting":function(e){t.step="inPay"},"in-pay-back":t.quitPay,"pay-success":t.handleSuccess}},[e("PhotoImage")],1),t._v(" "),"inGoods"===t.step?e("div",{staticClass:"left"},[e("div",{staticClass:"close-icon flex-center",on:{click:t.close}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("PhotoImage")],1):t._e()],1)}),[],!1,null,"4b27f1aa",null));e.default=$.exports},5756:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(19),n(28),n(44),n(90),n(557)),c=n(10),d=n(201),h={name:"ScrollWrapper",data:function(){return{scrollOffset:0,itemWidth:200,wrapperWidth:0,contentWidth:0}},computed:{isLeftDisabled:function(){return this.scrollOffset<=0},isRightDisabled:function(){return this.scrollOffset>=this.contentWidth-this.wrapperWidth}},mounted:function(){this.initContentWidth(),window.addEventListener("resize",this.initContentWidth)},unmounted:function(){window.removeEventListener("resize",this.initContentWidth)},methods:{initContentWidth:function(){this.itemWidth=this.$el.querySelector(".scroll-content > *").offsetWidth,this.wrapperWidth=this.$refs.scrollWrapper.offsetWidth;for(var t=this.$refs.scrollContent.children,e=0,i=0;i<t.length;i++)e+=t[i].offsetWidth+16;this.contentWidth=e,this.isRightDisabled&&this.contentWidth>this.wrapperWidth&&(this.scrollOffset=this.contentWidth-this.wrapperWidth)},scrollLeft:function(){this.scrollOffset-=4*(this.itemWidth+16),this.scrollOffset<0&&(this.scrollOffset=0),console.log("this.scrollLeft",this.scrollOffset)},scrollRight:function(){this.scrollOffset+=4*(this.itemWidth+16),this.scrollOffset>this.contentWidth-this.wrapperWidth&&(this.scrollOffset=this.contentWidth-this.wrapperWidth),console.log("this.scrollRight",this.scrollOffset)}}},v=(n(4805),n(0)),f=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"scroll"},[e("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper"},[e("div",{ref:"scrollContent",staticClass:"scroll-content",style:{transform:"translateX(".concat(-t.scrollOffset,"px)")}},[t._t("default")],2)]),t._v(" "),e("button",{staticClass:"scroll-btn flex justify-center items-center scroll-btn-left",class:{disabled:t.isLeftDisabled},attrs:{disabled:t.isLeftDisabled},on:{click:t.scrollLeft}},[e("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),e("button",{staticClass:"scroll-btn flex justify-center items-center scroll-btn-right",class:{disabled:t.isRightDisabled},attrs:{disabled:t.isRightDisabled},on:{click:t.scrollRight}},[e("i",{staticClass:"el-icon-arrow-right"})])])}),[],!1,null,"4b2de0e7",null).exports,m=n(909),_=(n(18),n(50),n(22),n(1));function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"FilterComponent",props:{top:{type:String,default:"70px"},showTitle:{type:Boolean,default:!0},title:{type:String,default:""},showTabs:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!0},showModelType:{type:Boolean,default:!1},showWorkOrModel:{type:Boolean,default:!1},tabs:{type:Array,default:null},exludeTabs:{type:Array,default:function(){return[]}},defaultTab:{type:String,default:"community"},buttons:{type:Array,default:null},excludeButtons:{type:Array,default:function(){return[]}},defaultButton:{type:String,default:"Hot"},isShowHomeTypeSelect:{type:Boolean,default:!1},disable:{type:Boolean,default:!1}},computed:w(w(w({},Object(_.c)("user",["isLoggedIn"])),Object(_.c)("creation",["studioStyle","lab_styles"])),{},{studioRenderList:function(){var t=this;return(this.lab_styles||[]).filter((function(t){return!(null!=t&&t.default)})).map((function(e){var n="labStyle_".concat(e.value.replace(/\s/g,""));return{label:t.$t(n)||e.value,id:e.value}}))},renderBtns:function(){return this.buttons||this.defaultButtons},activeButton:function(){return this.defaultButtons[this.activeIndex]}}),watch:{defaultButton:function(t){this.activeIndex=this.renderBtns.findIndex((function(e){return e.name===t}))||0}},mounted:function(){},data:function(){return{activeIndex:0,defaultButtons:[{name:this.$t("Trending"),value:"trend",icon:"recommend",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("Hot"),value:"hot",icon:"hot",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("New"),value:"new",icon:"new",color:"#8E9CB1",activeColor:"#e9b942"}],selectList:[]}},methods:w(w({},Object(_.d)("app",["setHomeType"])),{},{setDefaultSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.selectList=t||[]},onButtonClick:function(i){this.activeIndex=i;var button=this.defaultButtons[i],t={type:this.activeButton.value,styles:this.selectList||[]};this.$emit("paramsChange",t),this.$logEvent("log_actions",{operation:"click_studio_tags",behavior_info:button.value})},handleChange:function(){var t={type:this.activeButton.value,styles:this.selectList||[]};this.$emit("paramsChange",t)}})},k=C,O=(n(4808),n(4809),Object(v.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-studio-filter-component"},[e("el-row",{staticClass:"filter-buttons",class:{"show-buttons":t.showButtons,"not-login":!t.isLoggedIn},attrs:{type:"flex"}},[e("div",{staticClass:"filter-buttons-box"},t._l(t.renderBtns,(function(button,i){return e("button",{key:button.value,staticClass:"filter-button",class:{active:t.activeButton.value===button.value},attrs:{disabled:t.disable},on:{click:function(e){return t.onButtonClick(i)}}},[e("i",{staticClass:"iconfont filter-button-icon",class:"icon-".concat(button.icon)}),t._v(" "),e("span",{staticStyle:{"margin-left":"5px"}},[t._v(t._s(button.name))])])})),0)])],1)}),[],!1,null,"654b6b37",null).exports),x=n(25);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={name:"StudioIndex",components:{WaterFallVue:d.default,ScrollWrapper:f,studioImageInfo:m.a,FilterComponent:O},data:function(){return{replaceImageType:c.K,isLock:!1,isReq:!1,queryParam:{page:1,page_size:60,type:"trend"},list:[],studioList:[],debounceMethod:function(){},dotReportInfo:{category:"default",view_domain:"studio",batch_id:""}}},computed:S(S(S({},Object(_.e)("user",["adminOff"])),Object(_.c)("creation",["studioStyle"])),{},{isZhLang:function(){return this.$i18n.locale.startsWith("zh")}}),beforeDestroy:function(){this.debounceMethod=null},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.debounceMethod=Object(x.debounce)(t.handleFilterChange,600),null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.style_type&&(t.queryParam.styles=null!==(r=t.$route)&&void 0!==r&&null!==(r=r.query)&&void 0!==r&&r.style_type?[null===(l=t.$route)||void 0===l||null===(l=l.query)||void 0===l?void 0:l.style_type]:[],t.$router.replace({path:"/studio",query:{}})),t.getLabStyles(),null!=t&&null!==(o=t.studioStyle)&&void 0!==o&&o.length){e.next=6;break}return e.next=6,t.$store.dispatch("creation/getTaskOptionsInfo");case 6:try{t.$refs.studioFilter.setDefaultSelectList(t.queryParam.styles)}catch(t){}case 7:case"end":return e.stop()}}),e)})))()},methods:S(S({},Object(_.b)("user",["setAdminOff"])),{},{changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},dialogShow:function(t,e){this.$logEvent("log_actions",{operation:"click_style_on_studio",behavior_info:t.key}),this.$refs.imageInfo.show(e)},handleFilterChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.queryParam.type=(null==t?void 0:t.type)||this.queryParam.type,this.queryParam.styles=(null==t?void 0:t.styles)||this.queryParam.styles||[],this.queryParam.page=1,this.isLock=!1,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var param=Object.assign({},this.queryParam);Object(l.b)(param).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,l,c;if(e.isLock=!(null!=n&&null!==(r=n.data)&&void 0!==r&&r.has_more),t)e.list=e.list.concat((null==n||null===(l=n.data)||void 0===l?void 0:l.items)||[]);else e.list=[],e.$nextTick((function(){var t;e.list=null==n||null===(t=n.data)||void 0===t?void 0:t.items}));if(e.isReq=!1,1===e.queryParam.page)e.queryParam.time_to=null==n||null===(c=n.data)||void 0===c?void 0:c.time_ms;e.queryParam.page++}else e.isLock=!0})).catch((function(){e.isReq=!1}))}},getLabStyles:function(){var t=this;Object(l.a)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.studioList=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[],console.log("所有风格",t.studioList))}))},jumpToStyleList:function(){this.$router.push(this.localePath({path:"/studio/styleList"}))}}),head:function(){return{title:this.$t("StudioTitle"),meta:[{hid:"description",name:"description",content:this.$t("StudioDesc")},{hid:"keywords",name:"keywords",content:this.$t("StudioKeyword")},{hid:"og:title",name:"og:title",content:this.$t("StudioTitle")},{hid:"og:description",name:"og:description",content:this.$t("StudioDesc")}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,o=t.error,e.prev=1,e.next=4,n.$post("/api/v1/lab/artwork/list",{page:1,page_size:60,type:"trend"});case 4:return r=e.sent,l=r.data.items,e.abrupt("return",{list:l});case 9:e.prev=9,e.t0=e.catch(1),console.log("广场页-> asyncData错误啦：",e.t0),o({statusCode:404,message:e.t0});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}},P=D,I=(n(4810),Object(v.a)(P,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"studio-index"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"content"},[e("div",{staticClass:"title",class:{"s-font":t.isZhLang}},[t._v("\n      "+t._s(t.$t("StudioWorks"))+"\n    ")]),t._v(" "),e("div",{staticClass:"title-box"},[e("filter-component",{ref:"studioFilter",on:{paramsChange:t.debounceMethod}})],1),t._v(" "),e("div",{ref:"wraper",staticClass:"wraper"},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{type:"artwork",cols:5,container:"wraper",list:t.list,lazy:!0,dotReportInfo:t.dotReportInfo,alreadyNoMoreData:t.isLock},on:{load:function(e){return t.getList(!0)}}})],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isReq&&!t.list.length,expression:"!isReq && !list.length"}],staticClass:"no-data-text"},[t._v(t._s(t.$t("no_data")))])]),t._v(" "),e("studioImageInfo",{ref:"imageInfo",attrs:{list:t.studioList}})],1)}),[],!1,null,"00cbeaab",null));e.default=I.exports;installComponents(I,{FilterComponent:n(798).default})},5772:function(t,e,n){"use strict";n.r(e);n(16),n(18),n(21),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(31),n(28),n(44),n(73),n(22),n(10)),l=n(1),c=n(38);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"tavernTopBar",data:function(){return{formatNumberForeign:r.p,logoUrl:n(275),vipIconUrl:n(665),coins:[{name:"credit",icon:n(205),type:"calculateCoins",desc:"new_credit_desc"},{name:"stamina",icon:n(160),type:"tempCoins",desc:"new_stamina_desc"}]}},computed:h(h(h(h(h({},Object(l.e)("payment",["paymentInfo","activeState","liteActiveState"])),Object(l.e)("user",["userInfo"])),Object(l.c)("user",["isLoggedIn"])),Object(l.c)("character",["characterInfo"])),{},{isShowSameStyle:function(){var t;return this.characterInfo&&1===(null===(t=this.characterInfo)||void 0===t?void 0:t.allow_same)&&this.$route.name.includes("CharacterDetail")},isVip:function(){return this.activeState||this.liteActiveState},auto_tts:function(){var t;return(null===(t=this.userInfo)||void 0===t||null===(t=t.character_setting)||void 0===t?void 0:t.auto_tts)||0},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}}}),methods:h(h(h({},Object(l.b)("user",["getAccountInfo"])),Object(l.d)("user",["SET_USER_INFO"])),{},{toHome:function(){this.$router.push(this.localePath("/"))},goCreatedSame:function(t){var e;if(t){var n=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));if(this.isLoggedIn){this.$logEvent("log_actions",{operation:"click_create_the_same",behavior_info:"on_tavern_detail_page"});var o=null==this||null===(e=this.paymentInfo)||void 0===e?void 0:e.productLevel;this.$dotReport({action:"task",obj_no:this.characterInfo.id,obj_type:9,stat:this.characterInfo.stat,vip:o}),this.$router.push(n)}else this.$EventBus.$emit("openLoginDialog",{redirect:n})}},setAutoTts:function(t){var e=this,n=1===this.auto_tts?0:1;Object(c.ab)({gpt_model:"",auto_tts:n}).then((function(o){var r=JSON.parse(JSON.stringify(e.userInfo));r.character_setting.gpt_model=t,r.character_setting.auto_tts=n,e.SET_USER_INFO(r)}))},handleClickVoice:function(){this.setAutoTts()},openLogin:function(){this.$EventBus.$emit("openLoginDialog")},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),window.open("".concat(location.origin,"/mall"),"_blank")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")},toggleMenu:function(){this.$EventBus.$emit("$_toggleLeftMenu")}})},f=v,m=(n(5120),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-tavern-top-bar"},[e("div",{staticClass:"flex"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoggedIn,expression:"isLoggedIn"}],staticClass:"detail-menu-icon flex_c_m",on:{click:t.toggleMenu}},[e("i",{staticClass:"iconfont icon-menu"})]),t._v(" "),e("a",{staticClass:"tavern-top-bar-logo",attrs:{href:t.localePath("/")},on:{click:function(e){return e.preventDefault(),t.toHome.apply(null,arguments)}}},[e("img",{staticClass:"nav-logo-img",attrs:{src:n(315),alt:"SeaArt AI"}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoggedIn,expression:"isLoggedIn"}],staticClass:"tavern-top-bar-info"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSameStyle,expression:"isShowSameStyle"}],staticClass:"same-style",on:{click:function(e){var n;return e.stopPropagation(),e.preventDefault(),t.goCreatedSame(null===(n=t.characterInfo)||void 0===n?void 0:n.id)}}},[t._v("\n      "+t._s(t.$t("Remix"))+"\n    ")]),t._v(" "),t._e(),t._v(" "),e("div",{staticClass:"vip-info"},[t._l(t.coins,(function(n){return[e("div",{key:n.name,staticClass:"item-coin",class:n.name,attrs:{title:t.getCoinTitle(n)},on:{click:function(e){return t.toMall(n)}}},[e("img",{staticClass:"icon",attrs:{src:n.icon,alt:n.name}}),t._v(" "),e("div",{staticClass:"number"},[t._v("\n            "+t._s(t.formatNumberForeign(t.paymentInfo[n.type])||0)+"\n          ")])])]})),t._v(" "),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isVip,expression:"isVip"}],staticClass:"vip-icon",attrs:{src:t.vipIconUrl,alt:"vip-icon"},on:{click:function(e){return e.stopPropagation(),t.toMall.apply(null,arguments)}}})],2),t._v(" "),e("div",{staticClass:"user-info"},[e("client-only",[e("div",{staticClass:"avatar",class:[t.userInfo.head?"":"avatar-color"]},[t.userInfo.head?e("img",{attrs:{src:t.userInfo.head,alt:"avatar"}}):e("div",[t._v("\n            "+t._s(t.initials(t.userInfo.name?t.userInfo.name:t.userInfo.id))+"\n          ")])])])],1)]),t._v(" "),e("client-only",[t.isLoggedIn?t._e():e("div",{staticClass:"log-btn",on:{click:function(e){return e.stopPropagation(),t.openLogin()}}},[t._v(t._s(t.$t("Login")))])])],1)}),[],!1,null,"11d898f0",null);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"tavern",components:{tavernTopBar:component.exports},data:function(){return{tabs:[{path:"/cyberPubPage/new-character",name:"newCharacter",i18nKey:"tavern45",text:"Character",showSubscript:!1,leftIcon:"icon-add-icon",showTips:!0,logType:"click_character_tab"},{path:"/cyberPubPage/my-characters",name:"myCharacters",i18nKey:"tavern46",text:"My Characters",showSubscript:!1,showTips:!1,logType:"click_my_character_tab"}],activeTab:"tavernList",backgroundInfo:{url:"",width:0,height:0},discardUrl:"https://discord.com/invite/gUHDU644vU",isHideAiChat:!1}},computed:y(y(y({},Object(l.e)("payment",["activeState","liteActiveState"])),Object(l.c)("user",["isLoggedIn"])),{},{isShowTabs:function(){var t;return!((null===(t=this.$route)||void 0===t?void 0:t.name)||"").includes("CharacterDetail")},roleGuideHref1:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/2-seaart-ai-basic-function/2-8-cyberpub/how-to-create-your-own-character":"https://docs.seaart.ai/guide-1/ri-ben-yu/2-ji-ben-ji-neng/2-8-saibpabu/nokyarakutwosuru"},roleGuideHref2:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/2-seaart-ai-basic-function/2-8-cyberpub/character-description-writing-tips":"https://docs.seaart.ai/guide-1/ri-ben-yu/2-ji-ben-ji-neng/2-8-saibpabu/kyarakutnowokutamenohinto"},isVip:function(){return this.activeState||this.liteActiveState},dynamicBackground:function(){var t={};return this.backgroundInfo.url&&(t.backgroundImage="url('".concat(this.backgroundInfo.url,"')"),t.backgroundSize=(this.backgroundInfo.width,this.backgroundInfo.height,"contain")),t},dynamicBackgroundType2:function(){var t={};return this.backgroundInfo.url&&(t.backgroundImage="url('".concat(this.backgroundInfo.url,"')"),t.backgroundSize=(this.backgroundInfo.width,this.backgroundInfo.height,"cover")),t}}),watch:{$route:function(t,e){var n,o=this.getRouteBaseName();if(this.activeTab=["tavernList","tavernSearch"].includes(o)?"tavernList":o,e.name===t.name&&null!==(n=t.query)&&void 0!==n&&n.quickChat)return t.query.redirect?this.$router.replace(t.query.redirect):this.$router.replace(this.localePath("/")),!1;this.updateTavernBg()}},mounted:function(){this.activeTab=this.getElementsBefore(this.$route.name,"__"),this.isHideAiChat=location.origin.includes(".me"),this.isHideAiChat&&this.$router.replace(this.localePath("/"))},beforeDestroy:function(){this.backgroundInfo={url:"",width:0,height:0}},methods:{getElementsBefore:function(t,e){var n=t.indexOf(e);return-1===n?t:t.slice(0,n)},updateTavernBg:function(t){console.log("updateTavernBg: ",t);var e=t||{},n=e.backgroundUrl,o=void 0===n?"":n,r=e.width,l=void 0===r?0:r,c=e.height,d=void 0===c?0:c;this.$set(this.backgroundInfo,"url",o||""),this.$set(this.backgroundInfo,"width",l||0),this.$set(this.backgroundInfo,"height",d||0)},handClickTab:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"/cyberPubPage"===t.path||this.isLoggedIn?(this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:t.logType}),this.$set(this,"backgroundInfo",{url:"",width:0,height:0}),this.$router.push(this.localePath(t.path))):this.$EventBus.$emit("openLoginDialog")},goback:function(){this.$router.back()}}},C=w,k=(n(5121),n(5122),Object(m.a)(C,(function(){var t=this,e=t._self._c;return t.isHideAiChat?t._e():e("div",{staticClass:"p-tavern"},[e("div",{staticClass:"bg-container1",staticStyle:{opacity:"1",transform:"none"},style:t.dynamicBackgroundType2}),t._v(" "),e("div",{staticClass:"bg-container2 bg-tavern",staticStyle:{opacity:"1",transform:"none"},style:t.dynamicBackground}),t._v(" "),e("div",{staticClass:"tavern-top-bar container"},[e("tavern-top-bar")],1),t._v(" "),e("div",{staticClass:"main-container container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTabs,expression:"isShowTabs"}],staticClass:"tavern-tabs"},[e("i",{staticClass:"el-icon-back",on:{click:function(e){return e.stopPropagation(),t.goback.apply(null,arguments)}}}),t._v(" "),t._l(t.tabs,(function(n){return e("div",{key:n.path,staticClass:"tavern-tabs-item",class:[t.activeTab.includes(n.name)?"tavern-tabs-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handClickTab(n)}}},[e("div",{staticClass:"tavern-tabs-item-text"},[n.leftIcon?e("i",{staticClass:"iconfont tavern-tabs-item-left-icon",class:n.leftIcon}):t._e(),t._v(" "),"tavern"!==n.name||t.$route.params.id?[t._v("\n            "+t._s(t.$t(n.i18nKey))+"\n          ")]:e("h1",[t._v(t._s(t.$t(n.i18nKey)))]),t._v(" "),e("sup",{directives:[{name:"show",rawName:"v-show",value:n.showSubscript,expression:"tab.showSubscript"}],staticClass:"tavern-tabs-item-text-sub"},[t._v("beta")]),t._v(" "),n.showTips?e("el-popover",{attrs:{placement:"top-start",title:"",width:300,trigger:"hover","popper-class":"tavern-tab-popover","visible-arrow":!1}},[e("div",{staticClass:"content"},[e("p",{staticClass:"mb-2"},[t._v(t._s(t.$t("tavern40")))]),t._v(" "),e("ul",{staticClass:"mb-2 list-outside list-disc",staticStyle:{"padding-left":"20px"}},[e("li",[e("i18n",{attrs:{path:"tavern41",tag:!1}},[e("template",{slot:"name"},[e("a",{staticClass:"content-color",attrs:{href:t.roleGuideHref1,target:"_blank"}},[t._v(t._s(t.$t("tavern42")))])])],2)],1),t._v(" "),e("li",[e("a",{staticClass:"content-color",attrs:{href:t.roleGuideHref2,target:"_blank"}},[t._v(t._s(t.$t("tavern43")))])])]),t._v(" "),e("p",{staticClass:"mb-2"},[e("i18n",{attrs:{path:"tavern44",tag:!1}},[e("template",{slot:"name"},[e("a",{staticClass:"content-color",attrs:{href:t.discardUrl,target:"_blank"}},[t._v("Discord")])])],2)],1)]),t._v(" "),e("div",{staticClass:"tips-box",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-tagTips tips-box-icon"})])]):t._e()],2),t._v(" "),e("div",{staticClass:"tavern-tabs-item-line"})])}))],2),t._v(" "),e("div",{staticClass:"tavern-main-content"},[e("div",{staticClass:"tavern-main-content-inner"},[e("keep-alive",{attrs:{include:["tavernList"]}},[e("router-view",{on:{updateBg:t.updateTavernBg}})],1)],1)])])])}),[],!1,null,"7bf28d5b",null));e.default=k.exports},5773:function(t,e,n){"use strict";n.r(e);n(19),n(18),n(11),n(12),n(13);var o=n(30),r=n(14),l=n(3),c=n(2),d=(n(20),n(6),n(32),n(16),n(22),n(185),n(243),n(8),n(4),n(28),n(43),n(21),n(40),n(77),n(44),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(7),n(41),n(26),n(473)),h=n(411),v=n(920),f=n(71),m=n(9),_={props:{tabList:{type:Array,default:function(){return[]}},step:{type:String,default:"visualize"}},data:function(){return{}},methods:{handleNextStep:function(code){this.$emit("handleNextStep",code)}},computed:{activeComputed:function(){var t=this;return function(e){return t.step===e}}}},y=(n(5124),n(0)),w=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"new-character-tabs"},t._l(t.tabList,(function(n){return e("div",{key:n.code,staticClass:"tavern-tabs-item",class:{"new-character-tabs-item-active":t.activeComputed(n.code)},on:{click:function(e){return e.stopPropagation(),t.handleNextStep(n.code)}}},[e("div",{staticClass:"tavern-tabs-item-text"},[t._v("\n      "+t._s(t.$t(n.i18nKey)||n.name)+"\n    ")]),t._v(" "),e("div",{staticClass:"tavern-tabs-item-line"})])})),0)}),[],!1,null,"25c128be",null).exports,C=n(51),k=n(206),O=n(1),x=n(61),T=n(38),S=n(472),D=n(612),P=n(212);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var j={name:"NewCharacter",components:{TabBar:w,AiChatSoundItem:v.a,selectSoundModel:h.a,HyUploadBtn:S.default,AiChatTalkPopup:D.a,SetModelPopup:d.a,MyEditor:P.default},data:function(){return{modelsObj:{List:[],functionality_list:[],workflow_list:[]},genderList:[{i18nkey:"informationDialog6",value:"female"},{i18nkey:"informationDialog5",value:"male"},{i18nkey:"informationDialog7",value:"non_binary"},{i18nkey:"otherNoPeopel",value:"other"}],errorSubTitle:null,fieldErrors:{name:"",intro:"",first_msg:"",evaluation:"",personal:"",example:"",scene:""},value1:!1,sameModel:!1,autoModel:!1,createdLoading:!1,isShowUpload2:!0,createBtnDisabled:!1,accept:".jpg,.jpeg,.png,.webp",labelPosition:"top",createdByIntro:"",auditStatus:{isInCooldown:!1,cooldownEndTime:null,failureCount:0},cooldownTimer:null,saveTimer:null,isInitialized:!1,formData:Object(c.a)(Object(c.a)({gender:"",gpt_model:"",workflow_no:"",timbre_id:"",cover:{cover:"",cover_width:0,cover_height:0},name:"",intro:"",first_msg:"",evaluation:"",personal:"",dialog_example:"",scene:"",categories:[],publish_status:1,vision:{bg:{cover:"",cover_width:0,cover_height:0},character:{cover:"",cover_width:0,cover_height:0},mode:"normal"},same:1},"gender",""),"only_digital_lang_flow",0),introLimit:3500,personalLimit:2e4,firstMsgLimit:3e3,evaluationLimit:1500,sceneLimit:1500,dialogExampleLimit:2500,rules:{gender:[{required:!0,message:this.$t("characterSexSelect"),trigger:"change"}],name:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],intro:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],first_msg:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],personal:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],evaluation:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],categories:[{required:!0,message:this.$t("tavern55",{number:1}),trigger:["change","blur"]}]},tagList:[],isPostingBackground:!1,isBackgroundLoading:!1,isPostingCharacter:!1,isCharacterLoading:!1,UPLOAD:new C.a({type:24}),showImage:!1,isCoverLoading:!1,coverImageLoading:!1,popoverWidth:300,popoverTrigger:"hover",configurationFileUrl:"https://oobabooga.github.io/character-creator.html",importJsonError:[],isFormPosting:!1,detailInfo:null,detailInfoAuto:null,pageLoading:!1,base64RoleUrl:"",voiceObj:null,characterType:"entertainment",typeList:[{val:"entertainment",name:"EntertainmentCharacter",desc:"EntertainmentCharacterDesc"},{val:"tool",name:"ToolCharacter",desc:"ToolCharacterDesc"}],isHideAdvanced:!0,allowDirectLeave:!1}},watch:{detailInfo:{handler:function(t){this.SET_CHARACTER_INFO(t)},deep:!0,immediate:!0},characterType:{handler:function(t){this.formData.categories=[],this.getTagList(),this.formData.gpt_model=this.defaultChatModel},immediate:!0},formData:{handler:function(t){this.isShowUpload2=!t.cover.cover,this.isInitialized&&!this.isEditHandle&&this.debounceSaveFormData()},immediate:!0,deep:!0}},computed:$($($({},Object(O.e)("payment",["activeState","liteActiveState","paymentInfo"])),Object(O.c)("user",["isLoggedIn","isCompanyAccount","userInfo","characterSetting"])),{},{isShowVoiceFunction:function(){var t,e;return null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t||!t.id||1===(null===(e=this.detailInfo)||void 0===e?void 0:e.support_voice)},isShowModel:function(){return!this.isHideAdvanced&&(this.isEditHandle?!!this.isEditHandle&&[1].includes(null===(t=this.detailInfo)||void 0===t?void 0:t.character_type):"tool"===this.characterType);var t},isShowWorkflow:function(){var t,e;return!(null===(t=this.modelsObj.workflow_list)||void 0===t||!t.length||this.isHideAdvanced)&&(this.isEditHandle?!!this.isEditHandle&&[0,2].includes(null===(e=this.detailInfo)||void 0===e?void 0:e.character_type):"entertainment"===this.characterType)},currentModelObj:function(){var t,e,n=this,o="tool"===this.characterType?null===(t=this.modelsObj)||void 0===t?void 0:t.functionality_list:(null===(e=this.modelsObj)||void 0===e?void 0:e.List)||[];return o.length?this.formData.gpt_model?o.find((function(t){return t.gpt_model===n.formData.gpt_model}))||{}:o.find((function(t){return t.gpt_model===n.defaultChatModel}))||{}:{}},currentWorkflowId:function(){var t,e,n,o,r,l=(null===(t=this.detailInfo)||void 0===t?void 0:t.workflow_no)&&"-"!==(null===(e=this.detailInfo)||void 0===e?void 0:e.workflow_no)||!1;return 1!==(null===(n=this.characterSetting)||void 0===n?void 0:n.is_set_workflow)&&l?this.formData.workflow_no||(null===(o=this.detailInfo)||void 0===o?void 0:o.workflow_no)||this.defaultWorkflowNo||"":(null===(r=this.characterSetting)||void 0===r?void 0:r.workflow_no)||this.defaultWorkflowNo||""},currentWorkflowObj:function(){var t,e=this,n=(null===(t=this.modelsObj)||void 0===t?void 0:t.workflow_list)||[];return n.length&&n.find((function(t){return e.formData.workflow_no?t.workflow_no===e.formData.workflow_no:t.workflow_no===e.currentWorkflowId}))||{}},defaultWorkflowNo:function(){var t;return this.formData.workflow_no||(null===(t=this.modelsObj.workflow_list[0])||void 0===t?void 0:t.workflow_no)||""},defaultChatModel:function(){return"tool"===this.characterType?"Deepseek-v3":"GPT-35-Turbo-1106"},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},tagLabel:function(){var t=this,e=[];return this.formData.categories&&this.formData.categories.length&&this.tagList.length&&this.tagList.forEach((function(n){t.formData.categories.forEach((function(t){n.id===t&&e.push(n.title)}))})),e},isEditHandle:function(){var t;return(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id)&&!this.sameModel},isPublishDisabled:function(){return this.isFormPosting||this.auditStatus.isInCooldown},shouldShowCooldownTip:function(){return this.auditStatus.isInCooldown&&this.auditStatus.failureCount>=3}}),beforeDestroy:function(){this.clearTimer(),this.removePageLeaveListener()},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getModels();case 2:if(t.initAuditStatus(),1==t.$route.query.sameStyle&&(t.sameModel=!0),null===(n=t.$route)||void 0===n||null===(n=n.query)||void 0===n||!n.id){e.next=9;break}return e.next=7,t.getDetailInfo(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o?void 0:o.id);case 7:e.next=10;break;case 9:t.initData();case 10:t.isInitialized=!0,t.addPageLeaveListener();case 12:case"end":return e.stop()}}),e)})))()},beforeRouteLeave:function(t,e,n){this.isEditHandle?this.handleRouteLeave(t,e,n):n()},methods:$($({},Object(O.d)("character",["SET_CHARACTER_INFO"])),{},{initAuditStatus:function(){var t=this.getCurrentDateString(),e=this.getAuditDataFromStorage();e.lastResetDate===t?(e.cooldownEndTime&&new Date<new Date(e.cooldownEndTime)&&(this.auditStatus.isInCooldown=!0,this.auditStatus.cooldownEndTime=e.cooldownEndTime,this.startCooldownTimer()),this.auditStatus.failureCount=e.failureCount):this.resetAuditFailureCount()},getCurrentDateString:function(){var t=new Date;return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"))},getAuditDataFromStorage:function(){var t={failureCount:0,lastFailureTime:null,lastResetDate:this.getCurrentDateString(),cooldownEndTime:null};try{var e=localStorage.getItem("tavernAuditData");return e?$($({},t),JSON.parse(e)):t}catch(e){return console.error("获取审核数据失败:",e),t}},saveAuditDataToStorage:function(data){try{localStorage.setItem("tavernAuditData",JSON.stringify(data))}catch(t){console.error("保存审核数据失败:",t)}},recordAuditFailure:function(){var t=this.getAuditDataFromStorage();if(t.failureCount+=1,t.lastFailureTime=(new Date).toISOString(),t.lastResetDate=this.getCurrentDateString(),t.failureCount>=3){var e=new Date;e.setMinutes(e.getMinutes()+5),t.cooldownEndTime=e.toISOString(),this.auditStatus.isInCooldown=!0,this.auditStatus.cooldownEndTime=t.cooldownEndTime,this.startCooldownTimer()}this.auditStatus.failureCount=t.failureCount,this.saveAuditDataToStorage(t),this.showAuditFailureMessage()},resetAuditFailureCount:function(){var t={failureCount:0,lastFailureTime:null,lastResetDate:this.getCurrentDateString(),cooldownEndTime:null};this.auditStatus.failureCount=0,this.auditStatus.isInCooldown=!1,this.auditStatus.cooldownEndTime=null,this.saveAuditDataToStorage(t),this.cooldownTimer&&(clearInterval(this.cooldownTimer),this.cooldownTimer=null)},showAuditFailureMessage:function(){this.$xyLogEvent({front_operation:"exposure",entity_name:"character_review_rej_popup",entity_type:"to_confirm_pop_show"});var t=this.auditStatus.failureCount,e=this.$t("auditFailureMessage",{count:t})||"当前审核已被拒".concat(t,"次");this.$hyConfirm({width:"535px",title:this.$t("chara_review_rej_hint"),content:e,btnList:["confirm"]})},canPublish:function(){if(this.isFormPosting)return!1;if(this.auditStatus.isInCooldown){var t=this.getRemainingCooldownTime();if(t>0){var e=Math.ceil(t/6e4);return this.$message.warning(this.$t("auditCooldownWarning",{minutes:e})||"请等待".concat(e,"分钟后再试")),!1}this.auditStatus.isInCooldown=!1,this.auditStatus.cooldownEndTime=null}return!0},getRemainingCooldownTime:function(){return this.auditStatus.cooldownEndTime?new Date(this.auditStatus.cooldownEndTime).getTime()-(new Date).getTime():0},startCooldownTimer:function(){var t=this;this.cooldownTimer&&clearInterval(this.cooldownTimer),this.cooldownTimer=setInterval((function(){t.getRemainingCooldownTime()<=0&&(t.auditStatus.isInCooldown=!1,t.auditStatus.cooldownEndTime=null,clearInterval(t.cooldownTimer),t.cooldownTimer=null)}),1e3)},clearFieldErrors:function(){this.fieldErrors={name:"",intro:"",first_msg:"",evaluation:"",personal:"",example:"",scene:""}},saveFormData:function(){try{localStorage.setItem("tavernNewCharacterInfo",JSON.stringify(this.formData))}catch(t){console.error("保存表单数据失败:",t)}},clearTimer:function(){this.cooldownTimer&&(clearInterval(this.cooldownTimer),this.cooldownTimer=null),this.saveTimer&&(clearTimeout(this.saveTimer),this.saveTimer=null)},debounceSaveFormData:function(){var t=this;this.saveTimer&&clearTimeout(this.saveTimer),this.saveTimer=setTimeout((function(){t.saveFormData()}),500)},getModels:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,data,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(T.u)();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:n=e.t0,data=(o=n||{}).data,1e4===(null==(r=o.status)?void 0:r.code)&&(t.modelsObj=data),e.next=14;break;case 11:e.prev=11,e.t1=e.catch(0),console.error("获取模型列表报错",e.t1);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},selectModelCallback:function(t){this.formData.gpt_model=t.gpt_model||this.formData.gpt_model,this.$refs.selectChatModel.hide()},selectWorkflowCallback:function(t){console.log("选择模式",t),this.formData.workflow_no=t.workflow_no||this.formData.workflow_no,this.$refs.AiChatTalkPopup.hide()},handleSelectWorkflow:function(){this.$refs.AiChatTalkPopup.show(!1,{isCreatePage:!0,workflow_no:this.formData.workflow_no})},handleSelectModel:function(){this.$logEvent("log_actions",{operation:"click_default_chat_model",behavior_info:"on_tarven_create_page"}),this.$refs.selectChatModel.show(!1,{isCreatePage:!0,gpt_model:this.formData.gpt_model})},handleAdvanced:function(){this.isHideAdvanced=!this.isHideAdvanced},genderMap:function(t){var e=Object(c.a)({other:"characterSexDefault","":"characterSexDefault",female:"informationDialog6",male:"informationDialog5",non_binary:"informationDialog7"},"other","other");return e[t]?this.$t(e[t]):this.$t("other")},setSymbol:function(t,e){return t>1?e===t-1?"。":";":"。"},handleCreate:function(){this.$router.push(this.localePath("/ai-audio/train"))},handleDelTimObj:function(){this.voiceObj={},this.formData.timbre_id=""},getVoiceDetail:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("+"!==t.formData.timbre_id&&t.formData.timbre_id){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,Object(T.G)({id:t.formData.timbre_id});case 4:n=e.sent,o=n.status,data=n.data,1e4===o.code&&(t.voiceObj=data,t.voiceObj.cover=t.voiceObj.cover.url);case 7:case"end":return e.stop()}}),e)})))()},selectModel:function(t){this.voiceObj=t.timbre,this.voiceObj.cover=t.cover||"",this.formData.timbre_id=t.id,this.$refs.selectSoundModel.handleClose()},handleSelectSound:function(){this.$refs.selectSoundModel.openModal()},handleAiCreate:function(){var t=this;if(this.autoModel=!0,this.sameModel=!1,this.createBtnDisabled)this.$message.warning(this.$t("digitalHumanLoading"));else{if(!["",null,void 0].includes(this.formData.cover.cover)&&/^(http|https):\/\//.test(this.formData.cover.cover)){var e=["name","first_msg","evaluation","personal"].some((function(e){return""!==t.formData[e]}));this.formData.categories.length||e?this.$confirm(this.$t("digitalHumanTip"),this.$t("Tip"),{confirmButtonText:this.$t("digitalHumanConfirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.getDetailInfoByAuto()})).catch((function(t){console.log("err",t)})):this.getDetailInfoByAuto()}else this.$message.warning(this.$t("digitalHumanTost"))}},getDetailInfoByAuto:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData.cover.cover||"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.createdByIntro||"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tagList.length?this.tagList.map((function(t){return t.id})):[];if(e){this.clearFieldErrors();var r={url:e,intro:n,tag_ids:o};this.createBtnDisabled=!0,this.createdLoading=!0,this.getTagList(),Object(k.g)(r).then((function(e){var n,o,r;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code))return t.detailInfoAuto=null!=e&&e.data?e.data:null,t.voiceObj=(null==e||null===(r=e.data)||void 0===r?void 0:r.timbre)||null,t.errorSubTitle=null,void t.handleBackfillData("aiAuto");if(10618===(null==e||null===(o=e.status)||void 0===o?void 0:o.code)){var l,c,d=(null===(l=JSON.parse(null==e||null===(c=e.status)||void 0===c?void 0:c.msg))||void 0===l?void 0:l.sensitives)||[];return t.handleFieldErrors(d),void t.$message.error(t.$t("ContainsSensitiveWords"))}})).finally((function(){t.createBtnDisabled=!1,t.createdLoading=!1}))}},handleFieldErrors:function(t){var e=this;this.clearFieldErrors(),Array.isArray(t)&&0!==t.length&&t.forEach((function(t){var n=t.category,o=t.word;e.fieldErrors.hasOwnProperty(n)&&(e.fieldErrors[n]=o?e.$t("createCharError",{paramsKey:e.$t(m.N[n])||n,subKey:o}):e.$t("createCharacterTip2",{paramsKey:e.$t(m.N[n])||n}))}))},getDetailInfo:function(){var t=this,e={id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",not_check_sensitive:1};this.pageLoading=!0,Object(k.f)(e).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.detailInfo=null!=e&&e.data?e.data:null,t.handleBackfillData())})).finally((function(){t.pageLoading=!1}))},handleBackfillData:function(){var t,e,n,o,data={};(data="aiAuto"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"edit")?this.handleAutoData():this.handleDetails(),Object.assign(this.formData,data),null!==(t=this.formData)&&void 0!==t&&null!==(t=t.vision)&&void 0!==t&&null!==(t=t.bg)&&void 0!==t&&t.cover)&&this.$emit("updateTavernBg",{backgroundUrl:(null===(e=this.formData)||void 0===e||null===(e=e.vision)||void 0===e||null===(e=e.bg)||void 0===e?void 0:e.cover)||"",width:(null===(n=this.formData)||void 0===n||null===(n=n.vision)||void 0===n||null===(n=n.bg)||void 0===n?void 0:n.cover_width)||0,height:(null===(o=this.formData)||void 0===o||null===(o=o.vision)||void 0===o||null===(o=o.bg)||void 0===o?void 0:o.cover_height)||0});this.formData.timbre_id&&this.getVoiceDetail()},handleAutoData:function(){var t=this.detailInfoAuto||{},e=t.gender,n=void 0===e?"":e,o=t.allow_same,r=void 0===o?1:o,l=t.name,c=void 0===l?"":l,d=t.id,h=void 0===d?"":d,v=t.tag_ids,f=void 0===v?[]:v,m=t.evaluation,_=void 0===m?{title:""}:m,y=t.scene,w=void 0===y?{title:""}:y,C=t.intro,k=void 0===C?{title:""}:C,O=t.first_msg,x=void 0===O?{title:""}:O,T=t.dialog_example,S=void 0===T?{title:""}:T,D=t.personal,P=void 0===D?{title:""}:D,I=t.gpt_model,$=void 0===I?"":I,j=t.workflow_no,L=void 0===j?"":j,M=t.timbre,E=void 0===M?{id:""}:M;return{scene:this.handleTitle(w.title),evaluation:this.handleTitle(_.title),intro:this.handleTitle(k.title),first_msg:this.handleTitle(x.title),dialog_example:this.handleTitle(S.title),personal:this.handleTitle(P.title),categories:f,id:h,gender:n,name:c,same:r,timbre_id:(null==E?void 0:E.id)||"",gpt_model:$||this.defaultChatModel,workflow_no:L||this.defaultWorkflowNo}},handleDetails:function(){var t,e,n,o,l,c,d,h=this.detailInfo||{},v=h.gender,f=void 0===v?"":v,m=h.allow_same,_=void 0===m?1:m,y=h.categories,w=void 0===y?[]:y,C=h.cover,k=void 0===C?{}:C,O=h.evaluation,x=void 0===O?"":O,T=h.name,S=void 0===T?"":T,D=h.scene,P=void 0===D?"":D,I=h.vision,$=void 0===I?{}:I,j=h.intro,L=void 0===j?"":j,M=h.first_msg,E=void 0===M?"":M,F=h.dialog_example,A=void 0===F?"":F,N=h.personal,R=void 0===N?"":N,B=h.id,U=void 0===B?"":B,V=h.publish_status,W=void 0===V?1:V,H=h.is_deep_seek,G=void 0===H?0:H,z=h.gpt_model,Y=void 0===z?"":z,J=h.timbre_id,K=void 0===J?"":J,Q=h.workflow_no,X=void 0===Q?"":Q;this.characterType=G?"tool":"entertainment";var Z={only_digital_lang_flow:G,name:S,cover:{cover:(null==k?void 0:k.url)||"",cover_width:(null==k?void 0:k.width)||0,cover_height:(null==k?void 0:k.height)||0},vision:{bg:{cover:(null==$||null===(t=$.bg)||void 0===t?void 0:t.url)||"",cover_width:(null==$||null===(e=$.bg)||void 0===e?void 0:e.width)||0,cover_height:(null==$||null===(n=$.bg)||void 0===n?void 0:n.height)||0},character:{cover:(null==$||null===(o=$.character)||void 0===o?void 0:o.url)||"",cover_width:(null==$||null===(l=$.character)||void 0===l?void 0:l.width)||0,cover_height:(null==$||null===(c=$.character)||void 0===c?void 0:c.height)||0},mode:"normal"===(null==$?void 0:$.mode)&&null!=$&&null!==(d=$.character)&&void 0!==d&&d.cover?"advanced":null==$?void 0:$.mode},scene:this.handleTitle(P),evaluation:this.handleTitle(x),intro:this.handleTitle(L),first_msg:this.handleTitle(E),dialog_example:this.handleTitle(A),personal:this.handleTitle(R),categories:w.map((function(t){return t.id})),timbre_id:K,gender:f||"",gpt_model:Y||this.defaultChatModel,workflow_no:X||this.defaultWorkflowNo,publish_status:2===W?2:1,id:U,same:_||1},tt=w.map((function(t){return{id:t.id,title:t.name}}));return this.tagList=Object(r.a)(new Map([].concat(Object(r.a)(this.tagList),Object(r.a)(tt)).map((function(t){return[t.id,t]}))).values()),Z},handleTitle:function(t){return t?t.replace(/^\n+|\n+$/g,""):""},handleUploadJson:function(t){return"application/json"===t.type?(this.readFileContent(t),!1):(this.$message.error("Please upload a JSON file"),!1)},readFileContent:function(t){var e=this,n=new FileReader;n.onload=function(t){var content=t.target.result;e.parseJsonContent(content)},n.readAsText(t)},parseJsonContent:function(content){try{var t=JSON.parse(content);console.log(t),this.handleImportConfig(t)}catch(t){this.$message.error("Invalid JSON file")}},handleImportConfig:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=["dialog_example","scene"];this.importJsonError=[];for(var r=function(){var r=Object(o.a)(c[l],2),d=r[0],h=r[1],v="";(h||[]).some((function(n){return!["",void 0,null].includes(e[n])&&"[object String]"===Object.prototype.toString.call(e[n])&&(t.$set(t.formData,d,e[n]),v=e[n],!0)}))?t.$set(t.formData,d,v):!n.includes(d)&&t.importJsonError.push(h[0])},l=0,c=Object.entries({name:["name","char_name"],intro:["description"],personal:["char_persona"],evaluation:["creator_notes"],first_msg:["first_mes"],dialog_example:["mes_example","example_dialogue"],scene:["scenario","world_scenario"]});l<c.length;l++)r()},getTagList:function(){var t=this;Object(f.d)({show_area:"tool"===this.characterType?"tool_cyber_bar":"cyber_bar"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){e.title=e[m.r[t.$i18n.locale]]})),t.tagList=n.filter((function(t){return![void 0,""].includes(t.title)}))})).finally((function(){}))},initData:function(){var t=this.getCacheInfo()||{};this.$set(this,"formData",Object.assign(this.formData,t)),this.$refs.infoForm&&this.$refs.infoForm.clearValidate(),this.getVoiceDetail()},clearFormFields:function(){var t=this;this.$confirm(this.$t("tavern4"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e;if(t.createdByIntro="",t.clearFieldErrors(),null!=t&&null!==(e=t.formData)&&void 0!==e&&e.id)t.handleBackfillData();else{t.characterType="entertainment";Object.assign(t.formData,{name:"",gender:"",intro:"",first_msg:"",evaluation:"",personal:"",dialog_example:"",scene:"",categories:[],cover:{cover:"",cover_width:0,cover_height:0},only_digital_lang_flow:0,gpt_model:"",workflow_no:""}),t.importJsonError=[],t.base64RoleUrl=""}}))},handleCharacterLoad:function(){this.showImage=!0},handleCharacterLoadError:function(){this.showImage=!1},handleRoleCoverBeforeUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/gif","image/webp"],!e.isCoverLoading){n.next=4;break}return n.abrupt("return");case 4:if(r.includes(t.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 7:if(!(l=t)||l.size){n.next=10;break}return n.abrupt("return",!1);case 10:if(!(t.size/1024/1024>10)){n.next=21;break}return n.prev=11,n.next=14,Object(x.a)(t,10485760);case 14:l=n.sent,n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(11),console.error("Compression failed:",n.t0),n.abrupt("return");case 21:return n.next=23,e.checkImageSize(l);case 23:if(c=n.sent,e.formData.cover.cover=c.url||"",e.formData.cover.cover_width=c.realWidth||0,e.formData.cover.cover_height=c.realHeight||0,!e.isCoverLoading){n.next=29;break}return n.abrupt("return");case 29:return e.isCoverLoading=!0,o.startUpload(l).then((function(t){e.isCoverLoading=!1,e.coverImageLoading=!0,e.formData.cover.cover=t||""})).catch((function(t){e.isCoverLoading=!1,e.coverImageLoading=!1,e.formData.cover.cover="",e.formData.cover.cover_width=0,e.formData.cover.cover_height=0,e.$message.error(e.$t("uploadError"))})),n.abrupt("return",!1);case 32:case"end":return n.stop()}}),n,null,[[11,17]])})))()},uploadHandleConfirm:function(t){var e=Object(o.a)(t,1)[0];this.formData.cover.cover=e.url,this.formData.cover.cover_width=e.width,this.formData.cover.cover_height=e.height},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},updateSelectList:function(t){var e=t.type,n=void 0===e?"":e,o=t.url,r=void 0===o?"":o,l=t.width,c=void 0===l?0:l,d=t.height,h=void 0===d?0:d;if("background"===n)return this.isBackgroundLoading=!0,this.formData.vision.bg.cover=r||"",void this.$emit("updateBg",{backgroundUrl:r,width:c,height:h});"character"===n&&(this.isCharacterLoading=!0,this.showImage=!1,this.base64RoleUrl="",this.formData.vision.character.cover=r)},removeImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return["cover"].includes(t)?(this.formData.cover.cover="",this.formData.cover.cover_width=0,this.formData.cover.cover_height=0,void(this.coverImageLoading=!1)):["background"].includes(t)?(this.formData.vision.bg.cover="",this.formData.vision.bg.cover_width=0,this.formData.vision.bg.cover_height=0,this.isBackgroundLoading=!1,void this.$emit("updateBg",{backgroundUrl:"",type:1})):void(["character"].includes(t)&&(this.formData.vision.character.cover="",this.formData.vision.character.cover_width=0,this.formData.vision.character.cover_height=0,this.isCharacterLoading=!1,this.showImage=!1,this.base64RoleUrl=""))},handleImageLoad:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0,o=0;try{n=t.target.naturalWidth,o=t.target.naturalHeight}catch(t){}if(["background"].includes(e))return this.formData.vision.bg.cover_width=n||0,this.formData.vision.bg.cover_height=o||0,void(this.isBackgroundLoading=!1);["character"].includes(e)&&(this.formData.vision.character.cover_width=n||0,this.formData.vision.character.cover_height=o||0,this.isCharacterLoading=!1)},handleImageLoadError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["background"].includes(t)?this.isBackgroundLoading=!1:["character"].includes(t)&&(this.isCharacterLoading=!1)},changeClass:function(t){if(2===t&&!this.isVip)return this.formData.publish_status=1,void this.$EventBus.$emit("showBreakDialog","AIPersonTipWeb","basic");this.formData.publish_status=t},confirmPublish:function(){var t=this;if(this.canPublish()){this.clearFieldErrors();if(!["",null,void 0].includes(this.formData.cover.cover)&&/^(http|https):\/\//.test(this.formData.cover.cover)){var e=!0;if(this.$refs.infoForm.validate((function(t){e=t})),e){this.isFormPosting=!0,this.createdLoading=!0;var n=this.handleParams(this.sameModel?"create":this.isEditHandle&&!this.autoModel?"edit":"aiAuto")||{};n.only_digital_lang_flow="tool"===this.characterType?1:0,(this.sameModel?k.a:this.isEditHandle&&!this.autoModel?k.e:k.b)(n).then((function(e){var o,r,l,c,d;switch(null==e||null===(o=e.status)||void 0===o?void 0:o.code){case 1e4:t.errorSubTitle=null,t.resetAuditFailureCount(),t.$emit("updateBg",{backgroundUrl:"",width:0,height:0});var h=(null==e||null===(r=e.data)||void 0===r?void 0:r.id)||(null==n?void 0:n.id);h&&(t.allowDirectLeave=!0,t.$router.push(t.localePath("/aiChat/".concat(h)))),localStorage.removeItem("tavernNewCharacterInfo");break;case 10618:var v=(null===(l=JSON.parse(null==e||null===(c=e.status)||void 0===c?void 0:c.msg))||void 0===l?void 0:l.sensitives)||[];t.handleFieldErrors(v),t.$message.error(t.$t("ContainsSensitiveWords"));break;case 60004:t.recordAuditFailure();break;default:t.$message.error((null==e||null===(d=e.status)||void 0===d?void 0:d.msg)||t.$t("taskOperateFailed"))}})).finally((function(){t.createdLoading=!1,t.isFormPosting=!1}))}else this.$message.warning(this.$t("tavern33"))}else this.$message.warning(this.$t("digitalHumanTost"))}},getCacheInfo:function(){var t=localStorage.getItem("tavernNewCharacterInfo")||null;try{t=t?JSON.parse(t):null}catch(t){}return t},handleParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"edit",e=JSON.parse(JSON.stringify(this.formData));return e.permission={same:e.same,publish:e.publish_status},delete e.same,delete e.publish_status,"aiAuto"===t&&(e.tag_ids=e.categories,e.cover={url:this.formData.cover.cover,width:this.formData.cover.cover_width,height:this.formData.cover.cover_height}),"create"===t&&(e.cover={cover:this.formData.cover.cover,cover_width:this.formData.cover.cover_width,cover_height:this.formData.cover.cover_height}),e.ss=0,e},addPageLeaveListener:function(){window.addEventListener("beforeunload",this.handleBeforeUnload)},removePageLeaveListener:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(t){if(this.isEditHandle&&!this.allowDirectLeave)return t.preventDefault(),t.returnValue=this.$t("chara_edit_exit_hint")||"您有未保存的更改，确定要离开吗？",t.returnValue},handleRouteLeave:function(t,e,n){this.allowDirectLeave?n():this.$hyConfirm({width:"535px",title:this.$t("Tip"),content:this.$t("chara_edit_exit_hint")}).then((function(){n()})).catch((function(){n(!1)}))}})},L=j,M=(n(5126),n(5127),Object(y.a)(L,(function(){var t,e,n,o,r,l=this,c=l._self._c;return c("div",{directives:[{name:"loading",rawName:"v-loading",value:l.pageLoading,expression:"pageLoading"}],staticClass:"p-tavern-new-character"},[c("div",{staticClass:"p-tavern-new-character-container"},[c("div",{staticClass:"info-box"},[c("div",{staticClass:"tavern-new-character-scroll"},[c("div",{staticClass:"step-box"},[l.isEditHandle?l._e():c("div",{staticClass:"item-box"},[c("div",{staticClass:"title-box"},[c("div",{staticClass:"label"},[c("span",[l._v("*")]),l._v(l._s(l.$t("CharacterType")))]),l._v(" "),c("div",{staticClass:"name-tip",on:{click:function(t){return t.stopPropagation(),l.clearFormFields.apply(null,arguments)}}},[l._v("\n                "+l._s(l.$t(l.formData.id?"tavern53":"tavern52"))+"\n              ")])]),l._v(" "),c("div",{staticClass:"type-box"},l._l(l.typeList,(function(t){return c("div",{key:t.val,staticClass:"item-type",class:{active:l.characterType===t.val},on:{click:function(e){l.characterType=t.val}}},[c("div",{staticClass:"item-type-header"},[c("div",{staticClass:"item-type-name"},[l._v(l._s(l.$t(t.name)))]),l._v(" "),c("div",{staticClass:"item-type-selected flex-center",class:{active:l.characterType===t.val}},[c("i",{directives:[{name:"show",rawName:"v-show",value:l.characterType===t.val,expression:"characterType === item.val"}],staticClass:"iconfont icon-gou"})])]),l._v(" "),c("div",{staticClass:"item-type-desc"},[l._v(l._s(l.$t(t.desc)))])])})),0)]),l._v(" "),c("div",{staticClass:"item-box upload-box"},[c("div",{staticClass:"tips"},[c("div",{staticClass:"label"},[c("span",[l._v("*")]),l._v(l._s(l.$t("digitalHumanReference")))]),l._v(" "),c("div",{staticClass:"tip"},[l._v(l._s(l.$t("digitalHumanSizeTip")))])]),l._v(" "),c("div",{staticClass:"form-item"},[c("HyUploadBtn",{attrs:{boxw:"336px",boxh:"215px",category:24,isSingleSelect:"",coverImg:l.formData.cover.cover},on:{onConfirm:l.uploadHandleConfirm,onDelete:function(t){return l.removeImage("cover")}}})],1)]),l._v(" "),c("el-form",{staticClass:"custom-form custom-form-character",attrs:{"label-position":"top",model:l.formData}},[c("el-form-item",{attrs:{label:l.$t("roleGeneralization"),prop:"intro"}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("generalizationTip"),type:"textarea",autosize:{minRows:2,maxRows:3},"show-word-limit":"",maxlength:l.introLimit},model:{value:l.createdByIntro,callback:function(t){l.createdByIntro=t},expression:"createdByIntro"}})],1)],1)],1),l._v(" "),c("el-form",{ref:"infoForm",staticClass:"custom-form custom-form-character",attrs:{"label-position":"top",model:l.formData,rules:l.rules}},[c("el-form-item",{staticClass:"custom-name-form-item",attrs:{label:l.$t("AI_person_name"),prop:"name"}},[c("template",{slot:"label"},[c("div",{staticClass:"custom-label-name"},[c("span",[l._v(l._s(l.$t("AI_person_name")))]),l._v(" "),c("div",{staticClass:"auto-create-btn flex-center",on:{click:function(t){return t.stopPropagation(),l.handleAiCreate.apply(null,arguments)}}},[c("i",{staticClass:"iconfont icon-search-magic"}),l._v("\n                  "+l._s(l.$t("digitalHumanAiCreated"))+"\n                ")])])]),l._v(" "),c("div",{staticClass:"name-input-wrapper"},[c("el-input",{staticClass:"custom-name-form-item-input",attrs:{maxlength:40,"show-word-limit":""},model:{value:l.formData.name,callback:function(t){l.$set(l.formData,"name",t)},expression:"formData.name"}}),l._v(" "),l.fieldErrors.name?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.name))]):l._e()],1)],2),l._v(" "),c("el-form-item",{staticClass:"custom-name-form-item",attrs:{label:l.$t("gender"),prop:"gender"}},[c("el-select",{staticClass:"custom-name-form-item-input dark-select",attrs:{clearable:"",placeholder:l.$t("characterSexSelect"),"popper-class":"dark-select-popper"},model:{value:l.formData.gender,callback:function(t){l.$set(l.formData,"gender",t)},expression:"formData.gender"}},l._l(l.genderList,(function(t){return c("el-option",{key:t.name,attrs:{label:l.$t(t.i18nkey),value:t.value}})})),1)],1),l._v(" "),l.isShowVoiceFunction?c("el-form-item",{staticClass:"sound-form-item",attrs:{label:"",prop:"sound"}},[c("template",{slot:"label"},[c("div",{staticClass:"custom-label"},[c("span",{staticClass:"label"},[l._v(l._s(l.$t("sound")))]),l._v(" "),c("span",{staticClass:"btn",on:{click:l.handleCreate}},[l._v(l._s(l.$t("customCreated")))])])]),l._v(" "),c("div",{staticClass:"sound-select-item",on:{click:l.handleSelectSound}},[c("div",{staticClass:"sound-input",class:{active:null===(t=l.voiceObj)||void 0===t?void 0:t.name}},[l._v("\n                "+l._s((null===(e=l.voiceObj)||void 0===e?void 0:e.name)||l.$t("Pls_select"))+"\n              ")]),l._v(" "),c("div",{staticClass:"btn-box"},[c("i",{staticClass:"sound-input-btn el-icon-circle-plus-outline"})])])],2):l._e(),l._v(" "),c("AiChatSoundItem",{directives:[{name:"show",rawName:"v-show",value:(null===(n=l.voiceObj)||void 0===n?void 0:n.id)&&l.isShowVoiceFunction,expression:"voiceObj?.id && isShowVoiceFunction"}],staticClass:"custom-sound-item",attrs:{showHandle:!1,item:l.voiceObj}},[c("div",{staticClass:"cancel-box"},[c("i",{staticClass:"el-icon-close",on:{click:l.handleDelTimObj}})])]),l._v(" "),c("el-form-item",{staticClass:"first-msg",attrs:{label:l.$t("tavern10"),prop:"first_msg"}},[c("MyEditor",{ref:"firstMsgEditor",attrs:{defaultProps:{mode:"simple"},height:"auto",uploadCategory:24,customFileSelect:!0,toolbarConfig:{toolbarKeys:["bold","underline","italic","color","uploadImage","uploadVideo"]}},model:{value:l.formData.first_msg,callback:function(t){l.$set(l.formData,"first_msg",t)},expression:"formData.first_msg"}}),l._v(" "),l.fieldErrors.first_msg?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.first_msg))]):l._e()],1),l._v(" "),c("el-form-item",{attrs:{label:l.$t("tavern12"),prop:"evaluation"}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern13"),type:"textarea","show-word-limit":"",maxlength:l.evaluationLimit,autosize:{minRows:2}},model:{value:l.formData.evaluation,callback:function(t){l.$set(l.formData,"evaluation",t)},expression:"formData.evaluation"}}),l._v(" "),l.fieldErrors.evaluation?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.evaluation))]):l._e()],1),l._v(" "),c("el-form-item",{attrs:{label:l.$t("tavern6"),prop:"intro"}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern5"),type:"textarea","show-word-limit":"",autosize:{minRows:2},maxlength:l.personalLimit},model:{value:l.formData.intro,callback:function(t){l.$set(l.formData,"intro",t)},expression:"formData.intro"}}),l._v(" "),l.fieldErrors.intro?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.intro))]):l._e()],1),l._v(" "),c("el-form-item",{attrs:{label:l.$t("tavern8"),prop:"personal"}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern9"),type:"textarea","show-word-limit":"",autosize:{minRows:2},maxlength:l.personalLimit},model:{value:l.formData.personal,callback:function(t){l.$set(l.formData,"personal",t)},expression:"formData.personal"}}),l._v(" "),l.fieldErrors.personal?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.personal))]):l._e()],1),l._v(" "),c("div",{staticClass:"is-same-style"},[c("span",[l._v(l._s(l.$t("digitalHumanIsSame")))]),l._v(" "),c("el-switch",{attrs:{"active-value":1,"inactive-value":2},model:{value:l.formData.same,callback:function(t){l.$set(l.formData,"same",t)},expression:"formData.same"}})],1),l._v(" "),c("div",{staticClass:"form-label-item"},[c("div",{staticClass:"form-label-item-title"},[l._v(l._s(l.$t("PermissionSetting")))]),l._v(" "),c("div",{staticClass:"form-label-item-content"},[c("div",{staticClass:"class-tab"},[c("div",{staticClass:"flex-center",class:{active:1==l.formData.publish_status},on:{click:function(t){return l.changeClass(1)}}},[c("i",{staticClass:"iconfont icon-eye"}),l._v(l._s(l.$t("createSetting1"))+"\n                ")]),l._v(" "),c("div",{staticClass:"flex-center",class:{active:2==l.formData.publish_status},on:{click:function(t){return l.changeClass(2)}}},[c("i",{staticClass:"iconfont icon-eye-disable"}),l._v(l._s(l.$t("createSetting2"))),c("span")])])])]),l._v(" "),c("el-form-item",{attrs:{label:l.$t("tavern18"),prop:"categories"}},[c("template",{slot:"label"},[c("div",{staticClass:"custom-label"},[c("span",[l._v(l._s(l.$t("tavern18")))]),l._v(" "),c("el-popover",{attrs:{placement:"top-start",title:"",width:l.popoverWidth,trigger:l.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[c("div",{staticClass:"content"},[l._v("\n                    "+l._s(l.$t("tavern19"))+"\n                  ")]),l._v(" "),c("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),l._v(" "),c("client-only",[c("div",{staticClass:"category-box"},[c("el-checkbox-group",{staticClass:"category-box-grid",attrs:{min:0,max:7},model:{value:l.formData.categories,callback:function(t){l.$set(l.formData,"categories",t)},expression:"formData.categories"}},l._l(l.tagList,(function(t){return c("el-checkbox",{key:t.id,attrs:{label:t.id}},[l._v(l._s(t.title))])})),1),l._v(" "),c("div",{staticClass:"category-box-item"})],1)])],2),l._v(" "),c("div",{staticClass:"advanced-setttings flex-center",on:{click:l.handleAdvanced}},[c("i",{staticClass:"iconfont icon-gaojisheding"}),l._v(" "),c("span",[l._v(l._s(l.$t("AdvancedConfig")))]),l._v(" "),c("i",{staticClass:"arrow-icon el-icon-arrow-up",class:{reverse:l.isHideAdvanced}})]),l._v(" "),l.isShowModel?c("el-form-item",{attrs:{label:l.$t("setChatModel")}},[c("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern15"),type:"textarea","show-word-limit":""},model:{value:l.formData.gpt_model,callback:function(t){l.$set(l.formData,"gpt_model",t)},expression:"formData.gpt_model"}}),l._v(" "),c("div",{staticClass:"current-model-box",on:{click:l.handleSelectModel}},[c("div",{staticClass:"current-model-header"},[c("span",{staticClass:"current-model-name"},[l._v(l._s(l.$t(l.currentModelObj.title_key)))]),l._v(" "),c("i",{staticClass:"iconfont icon-select-model-icon"})]),l._v(" "),c("span",{staticClass:"current-model-desc"},[l._v(l._s(l.$t(l.currentModelObj.lang_key)))])])],1):l._e(),l._v(" "),l.isShowWorkflow?c("el-form-item",{attrs:{label:l.$t("setChatWorkflow")}},[c("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern15"),type:"textarea","show-word-limit":""},model:{value:l.formData.workflow_no,callback:function(t){l.$set(l.formData,"workflow_no",t)},expression:"formData.workflow_no"}}),l._v(" "),c("div",{staticClass:"current-model-box",on:{click:l.handleSelectWorkflow}},[c("div",{staticClass:"current-model-header"},[c("span",{staticClass:"current-model-name"},[l._v(l._s(l.$t(null===(o=l.currentWorkflowObj)||void 0===o?void 0:o.title_key)))]),l._v(" "),c("i",{staticClass:"iconfont icon-select-model-icon"})]),l._v(" "),c("span",{staticClass:"current-model-desc"},[l._v(l._s(l.$t(null===(r=l.currentWorkflowObj)||void 0===r?void 0:r.desc_key)))])])],1):l._e(),l._v(" "),l._e(),l._v(" "),c("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!l.isHideAdvanced,expression:"!isHideAdvanced"}],attrs:{label:l.$t("tavern14")}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern15"),type:"textarea","show-word-limit":"",maxlength:l.sceneLimit,autosize:{minRows:2}},model:{value:l.formData.scene,callback:function(t){l.$set(l.formData,"scene",t)},expression:"formData.scene"}}),l._v(" "),l.fieldErrors.scene?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.scene))]):l._e()],1),l._v(" "),c("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!l.isHideAdvanced,expression:"!isHideAdvanced"}],attrs:{label:l.$t("tavern16")}},[c("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:l.$t("tavern17"),type:"textarea","show-word-limit":"",maxlength:l.dialogExampleLimit,autosize:{minRows:2}},model:{value:l.formData.dialog_example,callback:function(t){l.$set(l.formData,"dialog_example",t)},expression:"formData.dialog_example"}}),l._v(" "),l.fieldErrors.example?c("div",{staticClass:"field-error-tip"},[l._v(l._s(l.fieldErrors.example))]):l._e()],1)],1),l._v(" "),c("div",{staticClass:"bottom-btn-box"},[l.shouldShowCooldownTip?c("div",{staticClass:"cooldown-tip"},[l._v(l._s(l.$t("chara_review_rej_waiting_hint2")))]):l._e(),l._v(" "),c("div",{staticClass:"bottom-btn-box-btn bottom-btn-box-bg",class:{disabled:l.isPublishDisabled},on:{click:function(t){return t.stopPropagation(),l.confirmPublish.apply(null,arguments)}}},[l._v("\n            "+l._s(l.$t("releaseName"))+"\n          ")])])],1)]),l._v(" "),l.createdLoading?c("div",{staticClass:"loading-overlay"},[c("div",{staticClass:"loading-content"},[c("i",{staticClass:"el-icon-loading loading-icon"}),l._v(" "),c("span",[l._v("\n          "+l._s(l.$t(l.isFormPosting?"UnderReviewPlsWait":"digitalHumanLoading"))+"\n        ")])])]):l._e()]),l._v(" "),c("selectSoundModel",{ref:"selectSoundModel",attrs:{selectList:l.formData.timbre_id?[l.formData.timbre_id]:[],item:l.voiceObj},on:{selectModel:l.selectModel}}),l._v(" "),c("SetModelPopup",{ref:"selectChatModel",attrs:{isDeepSeek:"tool"===l.characterType,"character-info":l.detailInfo},on:{selectModel:l.selectModelCallback}}),l._v(" "),c("AiChatTalkPopup",{ref:"AiChatTalkPopup",attrs:{"character-info":l.detailInfo},on:{selectModel:l.selectWorkflowCallback}})],1)}),[],!1,null,"deea66b0",null));e.default=M.exports;installComponents(M,{MyEditor:n(212).default})},5778:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(2),r=n(3),l=(n(19),n(16),n(8),n(4),n(21),n(20),n(886)),c=n(887),d=n(178),h={data:function(){return{}},computed:{getDynamicHref:function(){return function(t){var e="Terms"===t;return Object(d.a)("en",e,this.$isChinaSite)}}}},v=(n(5525),n(0)),f=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("el-row",{staticClass:"m-b-20",attrs:{type:"flex",justify:"space-between"}},[e("el-col",[e("span",{staticClass:"txt"},[t._v("By registering, you agree to our")]),t._v(" "),e("a",{staticClass:"color",attrs:{target:"“_blank”",href:t.getDynamicHref("Terms")}},[t._v(" Terms ")]),t._v(" "),e("span",{staticClass:"color"},[t._v("|")]),t._v(" "),e("a",{staticClass:"color",attrs:{target:"“_blank”",href:t.getDynamicHref("Privacy")}},[t._v(" Privacy Policy ")])])],1)],1)}),[],!1,null,"678a82a9",null).exports,m=n(926),_=n(797),y=n(1);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={name:"TransferPage",components:{GoogleLogin:l.default,FacebookLogin:c.default,Agreement:f,LoginPopup:_.default,FooterDisplay:m.a},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.app,o=t.redirect,!n.$cookies.get("T")){e.next=4;break}return e.abrupt("return",o("/"));case 4:return e.abrupt("return",{});case 5:case"end":return e.stop()}}),e)})))()},computed:C({},Object(y.c)("user",["isLoggedIn"])),data:function(){return{loginLoading:!1}},mounted:function(){},methods:{guestLogin:function(){this.$router.push("/")},discordLogin:function(){var t=this.userCode?"&state="+this.userCode:"&state=",source="|"+this.loginSource;this.showSampleMode&&(source="|simple_flow"),t+=source;var link="https://discord.com/oauth2/authorize?response_type=code&client_id=".concat("1090452818831347793","&scope=identify%20guilds.join&redirect_uri=").concat("https://www.seaart.ai/api/v1/account/notify/discord").concat(t);console.log("link",link),window.open(link,"_self")},phoneLogin:function(){var t=this;this.$refs.LoginPopup?this.$refs.LoginPopup.open({type:"phone",callBack:function(){t.$router.push("/")}}):console.error("LoginPopup ref not found")},emailLogin:function(){var t=this;this.$refs.LoginPopup?this.$refs.LoginPopup.open({type:"email",callBack:function(){t.$router.push("/")}}):console.error("LoginPopup ref not found")},loginByThird:function(t){console.log("loginByThird","--",t);var e=t.token,n=void 0===e?"":e,o=t.type,param={token:n,type:void 0===o?2:o};this.loginFun(param)},loginFun:function(param){var t=this;this.loginLoading=!0;var p=C({},param);p=Object.assign({},p,this.inviteCodeObj);var e=getBiliConfig(),n=e.track_id,o=e.creative_id;n&&(p.track_id=n),o&&(p.creative_id=o);var r=localStorage.getItem("from_url");p.from_url=r||"",login(p).then((function(e){var n,code=null==e||null===(n=e.status)||void 0===n?void 0:n.code;if(1e4===code){localStorage.removeItem("yahooFlag"),t.addMarketLogEvent(p);var o=e.data.account,r=o.status,l=o.device_code;if(3===r&&t.trackCompleteRegistration(e.data.account),![1,3].includes(r))return void t.$message.error(t.$t("AccountDisabled"));t.$logEvent("web_login"),l&&t.$cookies.set("deviceId",l),t.code&&localStorage.removeItem("inviteCode"),t.finalPage(r,e.data,null==param?void 0:param.type)}else Object.keys(t.errorCodeMap).includes(String(code))?(t.$message.error(t.$t(t.errorCodeMap[code])),40002===code&&(t.userCode="",removeUCode())):(2===(null==param?void 0:param.type)&&t.$refs.google.clearCookies(),t.$message.error(e.status.msg||t.$t("LoginFailed")))})).finally((function(){t.loginLoading=!1;try{var e,n;null===(e=t.$refs)||void 0===e||null===(e=e.google)||void 0===e||e.loadingGoogle.close(),null===(n=t.$refs)||void 0===n||null===(n=n.facebook)||void 0===n||n.loadingFacebook.close()}catch(t){}t.$router.push("/")}))}}},O=(n(5527),Object(v.a)(k,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loginLoading,expression:"loginLoading"}],staticClass:"transfer-page"},[e("div",{staticClass:"login-section"},[t._m(0),t._v(" "),e("Agreement",{attrs:{forceLang:"en"}}),t._v(" "),e("div",{staticClass:"login-options"},[e("GoogleLogin",{ref:"google",staticClass:"login-option",on:{loginGoogle:t.loginByThird}}),t._v(" "),e("div",{staticClass:"login-option",on:{click:t.discordLogin}},[e("div",{staticClass:"discord-btn"},[e("svg-icon",{attrs:{"icon-class":"login-discord"}}),t._v(" "),e("span",[t._v("Discord")])],1)]),t._v(" "),e("FacebookLogin",{ref:"facebook",staticClass:"login-option",on:{loginFacebook:t.loginByThird}}),t._v(" "),e("div",{staticClass:"login-option",on:{click:t.phoneLogin}},[t._m(1)]),t._v(" "),e("div",{staticClass:"login-option",on:{click:t.emailLogin}},[t._m(2)])],1),t._v(" "),t._m(3),t._v(" "),e("button",{staticClass:"guest-login",on:{click:t.guestLogin}},[t._v("Guest login")])],1),t._v(" "),e("div",{staticClass:"background-section"},[e("img",{staticClass:"background-image",attrs:{src:"https://image.cdn2.seaart.me/2025-06-19/d19sfo5e878c73a9na70/9a7e2bf84d691c0cc71b1b86586238ad_high.webp",alt:"Background"}}),t._v(" "),e("FooterDisplay")],1),t._v(" "),e("LoginPopup",{ref:"LoginPopup"})],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo-container"},[e("img",{staticClass:"logo",attrs:{src:"https://image.cdn2.seaart.me/static/web/transfer_head_logo.webp",alt:"Logo"}}),t._v(" "),e("h1",{staticClass:"title"},[t._v("Login/Register")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"phone-btn"},[e("img",{staticClass:"phone-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/transferpage_phone.webp",alt:"Phone"}}),t._v(" "),e("span",[t._v("Phone")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"email-btn"},[e("img",{staticClass:"email-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/transferpage_email.webp",alt:"Email"}}),t._v(" "),e("span",[t._v("Email")])])},function(){var t=this._self._c;return t("div",{staticClass:"divider"},[t("span",[this._v("OR")])])}],!1,null,"d5a695d2",null));e.default=O.exports;installComponents(O,{SvgIcon:n(115).default,LoginPopup:n(797).default})},5779:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(16),n(21),n(26),n(1)),l=(n(65),n(14)),c=(n(32),n(22),n(475));function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"UserBreak",inject:["top"],props:{isTrain:Boolean,reason:{type:String,default:""},selectedLevel:{type:String,default:"basic"},defaultLevel:{type:Array,default:function(){return["basic","standard","professional"]}}},components:{RightsComponent:c.a},data:function(){return{activeTab:"yearly",levelArr:[]}},mounted:function(){this.getGoodsData(),this.getUserStatus()},computed:h(h(h(h({},Object(r.e)("user",["cdnHost"])),Object(r.c)("unsubscribe",["prevPlanId","userFreeTryStatus","userPauseStatus"])),Object(r.e)("payment",["halfDiscountCountdown"])),{},{hiddenLevels:function(){var t=this;return["free","basic","standard","professional","master"].filter((function(e){return!t.defaultLevel.includes(e)}))},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},maxDiscount:function(){var t=this.levelArr.filter((function(t){return null==t?void 0:t.discount})).map((function(t){return t.discount}));return t.length?Math.max.apply(Math,Object(l.a)(t)):0},getDiscount:function(){var t="save20",e=this.levelArr.filter((function(i){return null==i?void 0:i.discount}));return null!=e&&e.length&&(t="save".concat(this.maxDiscount)),this.$t(t)},isMonthly:function(){return"monthly"===this.activeTab},isYearly:function(){return"yearly"===this.activeTab},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({basic:"ToB_beginnerPlan",standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[e])}},getBtnLabel:function(){var t=this,e=this.isYearly?"Upgrade20off":"SubscribeNow",n=this.levelArr.find((function(i){return i.label==t.selectedLevel})),o=this.isMonthly?null==n?void 0:n.monthly_id:null==n?void 0:n.yearly_id;return null!=n&&n.discount&&this.isYearly&&(e="Upgrade".concat(this.maxDiscount,"off")),this.prevPlanId!==o||2!==this.userFreeTryStatus&&!this.userPauseStatus||(e="PlanRecoveryNow"),this.$t(e)},getVipImgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20240430/5b9a424b-99e9-49f0-8a04-a1f56cfadb4b.webp")}}),methods:h(h(h({},Object(r.b)("unsubscribe",["getUserStatus"])),Object(r.b)("payment",["getSubscriptionList"])),{},{handleClose:function(){this.top.close()},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;this.getSubscriptionList().then((function(e){var n=e.data,data=void 0===n?{}:n;t.handleData(data)}))},handleData:function(data){var t=this,e=data||{},n=e.month,o=void 0===n?[]:n,r=e.year,l=(void 0===r?[]:r).map((function(t,e){return h(h({},t),{},{monthly_id:o[e].id,original_price:o[e].price,original_price_cn:o[e].price_cn})})),map=this.isTrain?{sub_yearly3:"professional",sub_yearly4:"master"}:{sub_yearly1:"basic",sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"master"};this.isTrain||(l=l.filter((function(e){return t.defaultLevel.includes(map[e.id])}))),this.levelArr=l.reduce((function(e,n){var o=n.id,r=n.monthly_id,l=n.price_month,c=n.original_price,d=n.price_month_cn,h=n.original_price_cn,v=n.price,f=n.price_cn,m=n.local_price_web,_=n.activity,y=n.discount,w={label:map[o],monthly_id:r,yearly_id:o,original_m_p_en:c,now_m_p_en:l,original_m_p_zh:h,now_m_p_zh:d,now_total_price_en:v,now_total_price_cn:f,now_m_p:null==m?void 0:m.price,original_m_p:null==m?void 0:m.price_old,monetaryUnit:null==m?void 0:m.currency,activity:_,discount:y};return t.isTrain?map.hasOwnProperty(o)&&("master"===t.selectedLevel&&"professional"===map[o]||e.push(w)):e.push(w),e}),[])},changeMethods:function(t){this.activeTab=t},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r;this.$emit("subscriptionNow",this.isMonthly?o:l,this.getBtnLabel)},changeLevel:function(t){this.$emit("changeLevel",t)}})},f=(n(5570),n(0)),m=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-break"},[e("div",{staticClass:"user-break-close flex-center",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"left",class:t.selectedLevel},[e("div",{staticClass:"left-title words-wrap"},[e("img",{attrs:{src:t.getVipImgUrl,alt:"vip icon"}}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(t.$t(t.reason)))])]),t._v(" "),e("div",{staticClass:"left-methods"},[e("div",{staticClass:"left-methods-monthly",class:{active:t.isMonthly},on:{click:function(e){return t.changeMethods("monthly")}}},[t._v("\n        "+t._s(t.$t("PayMonthly"))+"\n      ")]),t._v(" "),e("div",{staticClass:"left-methods-yearly",class:{active:t.isYearly},on:{click:function(e){return t.changeMethods("yearly")}}},[t._v("\n        "+t._s(t.$t("PayYearly"))+"\n        "),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isMonthly,expression:"isMonthly"}],staticClass:"icon",attrs:{src:t.getGif,alt:"icon"}}),t._v(" "),e("span",{staticClass:"discount"},[t._v("\n          "+t._s(t.getDiscount)+"\n        ")])])]),t._v(" "),e("div",{staticClass:"left-level"},t._l(t.levelArr,(function(n){var o,r,l;return e("div",{key:n.label,staticClass:"item-level",class:{active:t.selectedLevel===n.label},on:{click:function(e){return t.changeLevel(n.label)}}},[null!=n&&n.discount&&t.isYearly?e("div",{staticClass:"goods-discount flex-center",style:t.getBg},[t._v("\n          "+t._s("".concat(n.discount,"% OFF"))+"\n        ")]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:(null==n?void 0:n.discount)&&t.isYearly&&t.halfDiscountCountdown,expression:"item?.discount && isYearly && halfDiscountCountdown"}],staticClass:"countdown-box flex-center"},[e("span",[t._v(t._s(null===(o=t.halfDiscountCountdown)||void 0===o?void 0:o.hours))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(null===(r=t.halfDiscountCountdown)||void 0===r?void 0:r.minutes))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(null===(l=t.halfDiscountCountdown)||void 0===l?void 0:l.seconds))])]),t._v(" "),null!=n&&n.discount||!t.isYearly?t._e():e("div",{staticClass:"item-level-icon flex-center"},[e("i",{staticClass:"iconfont icon-sale"}),t._v(" "),e("span",[t._v(t._s(t.$t("MallTabTips1")))])]),t._v(" "),e("div",{staticClass:"item-level-label"},[t._v("\n          "+t._s(t.getLabel(n.label))+"\n        ")]),t._v(" "),t.isMonthly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n            "+t._s(null==n?void 0:n.monetaryUnit)+"\n          ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n            "+t._s(n.original_m_p)+"\n          ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n            "+t._s(t.$t("Month"))+"\n          ")])]):e("div",{staticClass:"item-level-price item-level-yearly"},[e("div",{staticClass:"top"},[e("span",{staticClass:"sign"},[t._v("\n              "+t._s(null==n?void 0:n.monetaryUnit)+"\n            ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n              "+t._s(n.now_m_p)+"\n            ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n              "+t._s(t.$t("Month"))+"\n            ")])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"now-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.now_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])]),t._v(" "),e("div",{staticClass:"original-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.original_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])])])])])})),0),t._v(" "),e("div",{staticClass:"left-more",on:{click:t.toMall}},[t._v("\n      "+t._s(t.$t("viewMore"))+"\n      "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("el-button",{staticClass:"left-btn",on:{click:t.subscriptionNow}},[t._v("\n      "+t._s(t.getBtnLabel)+"\n    ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("RightsComponent",{attrs:{selectedLevel:t.selectedLevel,hiddenItems:t.hiddenLevels}})],1)])}),[],!1,null,"b23b6192",null).exports,_=n(126),y=n(127),w=n(365),C=n(9);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={name:"BreakDialog",provide:function(){return{top:this}},data:function(){return{isTrain:!1,isShowDialog:!1,reason:"VipTip",selectedLevel:"basic",step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"",behavior_info:"",defaultLevel:[],logMap:{characterSettingVipDesc:"SpecificPop_Character_Model_Vip",FastQueueTipWeb:"SpecificPop_FastQueue",Queue5TipWeb:"SpecificPop_TaskFull",UnlimitedQueueTipWeb:"SpecificPop_UnlimitedQueue",PrivateWorkTipWeb:"SpecificPop_PrivateWork",DownloadLimitTipWeb:"SpecificPop_DownloadLimit",ExpireTimeTipWeb:"SpecificPop_ExpireTime",AddCanvasTipWeb:"SpecificPop_AddCanvas",CreateModeTypeTipWeb:"SpecificPop_CreateModeType",LoRALimit5TipWeb:"SpecificPop_LoRALimit5",SimpleLoRALimit5TipWeb:"SpecificPop_SimpleLoRALimit5",TrainLoraTipWeb:"SpecificPop_TrainLora",LoRATrainTipWeb:"SpecificPop_LoRATrain",AIPersonTipWeb:"SpecificPop_AIPerson",AiChatSendNotCoin:"SpecificPop_AIChat",PrivacyPortfolioTipWeb:"SpecificPop_PrivacyPortfolio",UpgradeWatermark:"SpecificPop_UpgradeWatermark",VipTip:"SpecificPop_Vip",VideoTimeExpand:"SpecificPop_Video_Extension_Popup"},isFirstOpen:!0}},components:{UserBreak:m,PaymentForm:_.a,RightPart:y.a,CustomModalDialog:w.default},mounted:function(){var t=this;this.$EventBus.$on("showBreakDialog",(function(e,n,o){var r,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["basic","standard","professional"],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if((null===(r=t.paymentGrayInfo)||void 0===r?void 0:r.new_card_benefit_popup)&&["PrivateWorkTipWeb","UnlimitedQueueTipWeb","UpgradeQualityModel","updateQualityTips","FastQueueTipWeb"].includes(e))t.$EventBus.$emit("showDialog",{name:"BreakDialogNew",data:{scene:e,level:n||"standard",behavior_info:o,dotFrom:c.dotFrom||t.logMap[e]||"",defaultLevel:l,extra:c}});else{var d=c.dotFrom;t.isTrain=["NoExpireTimeTipWeb2","NoExpireTimeTipWeb1"].includes(e),t.dotFrom=d||t.logMap[e]||"",t.behavior_info=o||t.logMap[e]||"SpecificPop_BreakDialog",t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:t.behavior_info,behavior_info_sub:"pop_1",position:n||""}),t.$xyLogEvent({front_operation:"exposure",entity_name:t.behavior_info,entity_type:"to_pay_pop_show",obj_info:{position:n||"",behavior_info_sub:"pop_1"}}),t.reason=e,t.selectedLevel=n,t.show(),t.defaultLevel=l}}))},destroyed:function(){this.$EventBus.$off("showBreakDialog")},computed:O(O(O({},Object(r.e)("payment",["subThirdType","paymentGrayInfo"])),Object(r.e)("user",["userInfo"])),{},{isT1Country:function(){var t;return C.qb.includes(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)}}),methods:O(O({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{handleDialogClosed:function(){this.selectedLevel="basic",this.isFirstOpen=!0},show:function(){var t=this;this.isShowDialog=!0,this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.userBreak)||void 0===e||e.getGoodsData()}))},close:function(){var t=this,e=setTimeout((function(){t.isShowDialog=!1,clearTimeout(e)}),10)},changeLevel:function(t){this.selectedLevel=t,this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.behavior_info,behavior_info_sub:"pop_1",position:t||""}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.behavior_info,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1",position:t||""}}),this.isTrain&&(this.reason="master"===this.selectedLevel?"NoExpireTimeTipWeb2":"NoExpireTimeTipWeb1")},quitPay:function(){this.step="inGoods"},handleBeforeLeave:function(){this.$refs.userBreak=null},subscriptionNow:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.logMap[this.reason]||"SpecificPop_BreakDialog",behavior_info_sub:"pop_2",position:this.selectedLevel||""}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.logMap[this.reason]||"SpecificPop_BreakDialog",entity_type:"to_pay_pop_show",obj_info:{position:this.selectedLevel||"",behavior_info_sub:"pop_2"}}),this.btnLabel=n,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}}))}})},T=x,S=Object(f.a)(T,(function(){var t=this,e=t._self._c;return e("CustomModalDialog",{ref:"modalDialog",attrs:{visible:t.isShowDialog,"custom-class":"break-dialog-custom","data-group":"break_dialog_custom_dialog"},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.handleDialogClosed,"before-leave":t.handleBeforeLeave}},["inGoods"===t.step&&t.isShowDialog?e("UserBreak",{ref:"userBreak",attrs:{reason:t.reason,isTrain:t.isTrain,defaultLevel:t.defaultLevel,selectedLevel:t.selectedLevel},on:{subscriptionNow:t.subscriptionNow,changeLevel:t.changeLevel}}):t._e(),t._v(" "),"inPay"===t.step&&t.isShowDialog?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,null,null);e.default=S.exports},5780:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(26),n(1)),l=(n(65),n(3)),c=n(14),d=(n(20),n(32),n(22),n(475));function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"UserUpgrade",inject:["top"],props:{reason:{type:String,default:""},selectedLevel:{type:String,default:"standard"},defaultLevel:{type:String,default:"standard"}},components:{RightsComponent:d.a},data:function(){return{levelArr:[]}},mounted:function(){this.getGoodsData(),this.getUserStatus()},computed:v(v(v(v(v({},Object(r.e)("user",["cdnHost"])),Object(r.c)("user",["isCompanyAccount"])),Object(r.e)("payment",["paymentInfo","halfDiscountCountdown"])),Object(r.c)("unsubscribe",["prevPlanId","userFreeTryStatus","userPauseStatus"])),{},{hiddenLevels:function(){return["free","basic"]},getVipImgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20240430/5b9a424b-99e9-49f0-8a04-a1f56cfadb4b.webp")},getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},isSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.purchaseType;return e&&2===n},isMonthly:function(){return 2===this.paymentInfo.payRange},isYearly:function(){return 3===this.paymentInfo.payRange||this.isOnlyVipLite||this.isOnlyVipCard},isOnlyVipLite:function(){var t=this.paymentInfo||{},e=t.activeState,n=t.liteActiveState;return!e&&!this.isCompanyAccount&&n},isOnlyVipCard:function(){var t=this.paymentInfo||{},e=t.activeState,n=t.liteActiveState,o=t.svipActiveState;return e&&!o&&!this.isCompanyAccount&&!n},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[e])}},maxDiscount:function(){var t=this.levelArr.filter((function(t){return null==t?void 0:t.discount})).map((function(t){return t.discount}));return t.length?Math.max.apply(Math,Object(c.a)(t)):0},getBtnLabel:function(){var t=this,e=this.isYearly?"Upgrade20off":"UpgradeNow",n=this.levelArr.find((function(i){return i.label==t.selectedLevel})),o=this.isMonthly?null==n?void 0:n.monthly_id:null==n?void 0:n.yearly_id;return null!=n&&n.discount&&this.isYearly&&(e="Upgrade".concat(this.maxDiscount,"off")),this.prevPlanId!==o||2!==this.userFreeTryStatus&&!this.userPauseStatus||(e="PlanRecoveryNow"),this.$t(e)}}),methods:v(v(v({},Object(r.b)("unsubscribe",["getUserStatus"])),Object(r.b)("payment",["getSubscriptionList"])),{},{handleClose:function(){this.top.close()},getGoodsData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList();case 3:n=e.sent,o=n.data,data=void 0===o?{}:o,t.handleData(data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch subscription data:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},handleData:function(data){var t=data||{},e=t.month,n=void 0===e?[]:e,o=t.year,r=(void 0===o?[]:o).map((function(t,e){return v(v({},t),{},{monthly_id:n[e].id,original_price:n[e].price,original_price_cn:n[e].price_cn})}));r.shift(),this.levelArr=r.map((function(t){var e=t.id,n=t.monthly_id,o=t.price_month,r=t.original_price,l=t.price_month_cn,c=t.original_price_cn,d=t.price,h=t.price_cn,v=t.local_price_web,f=t.activity;return{discount:t.discount,activity:f,label:{sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"master"}[e],monthly_id:n,yearly_id:e,original_m_p_en:r,now_m_p_en:o,original_m_p_zh:c,now_m_p_zh:l,now_total_price_en:d,now_total_price_cn:h,now_m_p:null==v?void 0:v.price,original_m_p:null==v?void 0:v.price_old,monetaryUnit:null==v?void 0:v.currency}}))},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r;this.$emit("subscriptionNow",this.isMonthly?o:l,this.getBtnLabel)},changeLevel:function(t){this.$emit("changeLevel",t)}})},m=(n(5571),n(0)),_=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-upgrade"},[e("div",{staticClass:"user-upgrade-close flex-center",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"left",class:t.selectedLevel},[e("div",{staticClass:"left-title words-wrap"},[e("img",{attrs:{src:t.getVipImgUrl,alt:"vip icon"}}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(t.$t(t.reason)))])]),t._v(" "),e("div",{staticClass:"left-level"},t._l(t.levelArr,(function(n){var o,r,l;return e("div",{directives:[{name:"show",rawName:"v-show",value:"professional"!=t.defaultLevel||"standard"!==n.label,expression:"defaultLevel == 'professional' ? item.label !== 'standard' : true"}],key:n.label,staticClass:"item-level",class:{active:t.selectedLevel==n.label},on:{click:function(e){return t.changeLevel(n.label)}}},[null!=n&&n.discount&&t.isYearly?e("div",{staticClass:"goods-discount flex-center",style:t.getBg},[t._v("\n          "+t._s("".concat(null==n?void 0:n.discount,"% OFF"))+"\n        ")]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:(null==n?void 0:n.discount)&&t.isYearly&&t.halfDiscountCountdown,expression:"item?.discount && isYearly && halfDiscountCountdown"}],staticClass:"countdown-box flex-center"},[e("span",[t._v(t._s(null===(o=t.halfDiscountCountdown)||void 0===o?void 0:o.hours))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(null===(r=t.halfDiscountCountdown)||void 0===r?void 0:r.minutes))]),t._v(" "),e("span",[t._v(":")]),t._v(" "),e("span",[t._v(t._s(null===(l=t.halfDiscountCountdown)||void 0===l?void 0:l.seconds))])]),t._v(" "),null!=n&&n.discount||!t.isYearly?t._e():e("div",{staticClass:"item-level-icon flex-center"},[e("i",{staticClass:"iconfont icon-sale"}),t._v(" "),e("span",[t._v(t._s(t.$t("MallTabTips1")))])]),t._v(" "),e("div",{staticClass:"item-level-label"},[t._v("\n          "+t._s(t.getLabel(n.label))+"\n        ")]),t._v(" "),t.isMonthly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n            "+t._s(null==n?void 0:n.monetaryUnit)+"\n          ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n            "+t._s(n.original_m_p)+"\n          ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n            "+t._s(t.$t("Month"))+"\n          ")])]):e("div",{staticClass:"item-level-price item-level-yearly"},[e("div",{staticClass:"top"},[e("span",{staticClass:"sign"},[t._v("\n              "+t._s(null==n?void 0:n.monetaryUnit)+"\n            ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n              "+t._s(n.now_m_p)+"\n            ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n              "+t._s(t.$t("Month"))+"\n            ")])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"now-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.now_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])]),t._v(" "),e("div",{staticClass:"original-price"},[e("span",{staticClass:"sign"},[t._v("\n                "+t._s(null==n?void 0:n.monetaryUnit)+"\n              ")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n                "+t._s((12*n.original_m_p).toFixed(2))+"\n              ")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n                "+t._s(t.$t("year"))+"\n              ")])])])])])})),0),t._v(" "),e("div",{staticClass:"left-more",on:{click:t.toMall}},[t._v("\n      "+t._s(t.$t("viewMore"))+"\n      "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("el-button",{staticClass:"left-btn",on:{click:t.subscriptionNow}},[t._v("\n      "+t._s(t.getBtnLabel)+"\n    ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("RightsComponent",{attrs:{selectedLevel:t.selectedLevel,hiddenItems:t.hiddenLevels}})],1)])}),[],!1,null,"58b73895",null).exports,y=n(126),w=n(127),C=n(365);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={name:"UpgradeDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,reason:"VipTip",selectedLevel:"standard",defaultLevel:"standard",step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"",isFirstOpen:!0,logMap:{NoExpireTimeTipWeb:"VipSpecificPop_ExpireTime",UnlimitedQueueTipWeb:"VipSpecificPop_UnlimitedQueue",LoRATrainQueVipTipWeb:"VipSpecificPop_LoRATrain",Queue10TipWeb:"VipSpecificPop_TaskFull",AddCanvas5TipWeb:"VipSpecificPop_AddCanvas5",AddCanvas10TipWeb:"VipSpecificPop_AddCanvas10",VipTip:"VipSpecificPop_Vip"},behavior_info:""}},components:{UserUpgrade:_,PaymentForm:y.a,RightPart:w.a,CustomModalDialog:C.default},mounted:function(){var t=this;this.$EventBus.$on("showUpgradeDialog",(function(title,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.dotFrom=n.dotFrom||t.logMap[title],t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:t.logMap[title]||"VipSpecificPop_Upgrade",behavior_info_sub:"pop_1"}),t.$xyLogEvent({front_operation:"exposure",entity_name:t.logMap[title]||"VipSpecificPop_Upgrade",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),t.reason=title,t.selectedLevel=e,t.defaultLevel=e,t.show()}))},beforeDestroy:function(){this.$EventBus.$off("showUpgradeDialog")},computed:O({},Object(r.e)("payment",["subThirdType"])),methods:O(O({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{handleDialogClosed:function(){this.isFirstOpen=!0},handleBeforeLeave:function(){this.$refs.userUpgrade=null},show:function(){var t=this;this.isShowDialog=!0,this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.userUpgrade)||void 0===e||e.getGoodsData()}))},close:function(){var t=this,e=setTimeout((function(){t.isShowDialog=!1,clearTimeout(e)}),10)},changeLevel:function(t){this.selectedLevel=t},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.behavior_info=this.logMap[this.reason]||"VipSpecificPop_Upgrade",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.behavior_info,behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.behavior_info,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}}),this.btnLabel=n,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}})),this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.behavior_info,behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.behavior_info,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}})}})},T=x,S=Object(m.a)(T,(function(){var t=this,e=t._self._c;return e("CustomModalDialog",{ref:"modalDialog",attrs:{visible:t.isShowDialog,"custom-class":"upgrade-dialog-custom","data-group":"upgrade_custom_dialog"},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.handleDialogClosed,"before-leave":t.handleBeforeLeave}},["inGoods"===t.step&&t.isShowDialog?e("UserUpgrade",{ref:"userUpgrade",attrs:{reason:t.reason,defaultLevel:t.defaultLevel,selectedLevel:t.selectedLevel},on:{changeLevel:t.changeLevel,subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step&&t.isShowDialog?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,upgrade:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,null,null);e.default=S.exports},5781:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(14),r=n(2),l=(n(16),n(22),n(24),n(8),n(43),n(68)),c=n(939),d=n(940),h={name:"SubscriptionCard",components:{EnergyInfo:c.a,FeatureItem:d.a},props:{levelData:{type:Object,required:!0},pricing:{type:Object,required:!0,validator:function(t){return"object"===Object(l.a)(t)&&null!==t&&"price"in t&&"currency"in t&&"dailyEnergyValue"in t&&"imageGenerationText"in t&&"videoGenerationText"in t}},levelType:{type:String,required:!0},periodDisplay:{type:String,required:!0},isSelected:{type:Boolean,default:!1},featuresConfig:{type:Array,required:!0}},computed:{},methods:{getFeatureText:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"i18nKey";if(!t[e])return"";var n=this.levelData.features[t.id];return"number"==typeof n?this.$t(t.i18nKey,{param:n}):this.$t(t[e])},featureEnabled:function(t){var e=this.levelData.features[t.id];return"boolean"==typeof e?e:"number"==typeof e}}},v=h,f=(n(5636),n(0)),m=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"subscription-card subscription-level",class:["".concat(t.levelType.toLowerCase()),{selected:t.isSelected}],on:{click:function(e){return t.$emit("select")}}},[t.levelData.isRecommended?e("div",{staticClass:"recommend-badge flex_c_m"},[e("img",{attrs:{width:"14",height:"14",src:"https://image.cdn2.seaart.me/static/upload/20250530/88cdad80-6be7-4c91-b540-7b9a7b1a8d09.png",loading:"lazy",alt:"recommend"}}),t._v(" "),e("span",[t._v(t._s(t.$t(t.levelData.i18nTagKey)))])]):t._e(),t._v(" "),e("div",{staticClass:"card-header"},[e("div",{staticClass:"level-badge-container"},[e("span",{staticClass:"level-badge"},[t._v(t._s(t.$t(t.levelData.i18nKey)||t.levelData.levelName))]),t._v(" "),t.pricing.discount?e("span",{staticClass:"discount-tag"},[t._v(t._s(t.pricing.discount))]):t._e()]),t._v(" "),e("div",{staticClass:"card-price"},[e("span",{staticClass:"price-currency"},[t._v(t._s(t.pricing.currency))]),t._v(" "),e("span",{staticClass:"price-value"},[t._v(t._s(t.pricing.price))]),t._v(" "),e("span",{staticClass:"price-period"},[t._v("/"+t._s(t.periodDisplay))]),t._v(" "),t.pricing.originalPrice?e("div",{staticClass:"original-price"},[t._v(t._s(t.pricing.currency)+t._s(t.pricing.originalPrice))]):t._e()])]),t._v(" "),t.pricing.energyInfo?e("EnergyInfo",{attrs:{"energy-value":t.pricing.energyInfo.value.toString(),"period-display":t.periodDisplay,"progress-percentage":t.pricing.energyInfo.progress,"image-num":t.pricing.imageGenerationText,"video-num":t.pricing.videoGenerationText}}):t._e(),t._v(" "),e("button",{staticClass:"level-button subscribe-button",on:{click:function(e){return t.$emit("subscribe")}}},[t._v(t._s(t.$t("SubscribeNow")))]),t._v(" "),e("div",{staticClass:"features-list"},[e("span",{staticClass:"first-line",domProps:{innerHTML:t._s(t.$t("staminaPerDay",{num:t.pricing.dailyEnergyValue}))}}),t._v(" "),t._l(t.featuresConfig,(function(n){return e("feature-item",{key:n.id,attrs:{text:t.getFeatureText(n),enabled:t.featureEnabled(n),tip:t.getFeatureText(n,"tipI18nKey")}})})),t._v(" "),e("feature-item",{key:"FreeComputingPower",attrs:{text:t.$t("freePowerForFirstCharge",{num:t.pricing.dailyEnergyValue}),enabled:!0}})],2)],1)}),[],!1,null,"2ff068da",null).exports,_=n(693),y=n(126),w=n(127),C=n(1),k=n(9);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={name:"SubscriptionSelectDialog",provide:function(){return{top:this}},components:{SubscriptionCard:m,PaymentForm:y.a,RightPart:w.a},data:function(){return{dialogVisible:!1,selectedPeriod:"yearly",selectedLevel:4,subscriptionData:null,subscriptionLevels:_.b,featuresList:_.a,dotFrom:"new_not_vip_insufficient_calculate_popup",step:"subscription",goodsId:"",defaultThirdType:0,btnLabel:"",pageFrom:"",currentSubscriptionData:null}},computed:x(x(x(x({},Object(C.e)("payment",["paymentGrayInfo","subThirdType"])),Object(C.c)("payment",["paymentInfo"])),Object(C.e)("user",["userInfo"])),{},{currentPeriodPlans:function(){if(!this.subscriptionData)return[];switch(this.selectedPeriod){case"weekly":return this.subscriptionData.week||[];case"monthly":return this.subscriptionData.month||[];case"yearly":return this.subscriptionData.year||[];default:return[]}},showWeekly:function(){var t,e;return!(null===(t=this.paymentGrayInfo)||void 0===t||!t.show_weekly)&&[2,3,6].includes(null===(e=this.paymentInfo)||void 0===e?void 0:e.userType)},periods:function(){return{yearly:{i18nKey:"PayYearly",discountValue:this.calculateMaxDiscount("year"),show:!0},monthly:{i18nKey:"PayMonthly",discountValue:this.calculateMaxDiscount("month"),show:!0},weekly:{i18nKey:"PayWeekly",discountValue:this.calculateMaxDiscount("week"),show:this.showWeekly}}},title:function(){return"break_dialog_new_more_plans"===this.dotFrom?{titleMain:this.$t("allMembershipPlans"),titleSub:this.$t("allMembershipPlansSub")}:{titleMain:this.$t("runningOutOfEnergy"),titleSub:this.$t("upgradeForMoreEnergy")}}}),methods:x(x({},Object(C.b)("payment",["getSubscriptionList","getSubUrlAndThirdType"])),{},{show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.pageFrom,o=void 0===n?"":n,r=e.step,l=void 0===r?"":r,c=e.pageFromData,d=void 0===c?{}:c,h=e.dotFrom,v=void 0===h?"":h;if(this.pageFrom=o,this.step=l||"subscription",this.dotFrom=v||"new_not_vip_insufficient_calculate_popup","payment"===l&&Object.keys(d).length>0)return this.dialogVisible=!0,void this.subscriptionNow({goods_id:d.goodsId,btnLabel:d.btnLabel||""});this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:this.dotFrom}),this.getSubscriptionList().then((function(e){var n,o,r,l;t.subscriptionData=null==e?void 0:e.data,t.dialogVisible=!0,null!==(n=t.subscriptionData)&&void 0!==n&&null!==(n=n.year)&&void 0!==n&&n.length?t.selectedPeriod="yearly":null!==(o=t.subscriptionData)&&void 0!==o&&null!==(o=o.month)&&void 0!==o&&o.length?t.selectedPeriod="monthly":null!==(r=t.subscriptionData)&&void 0!==r&&null!==(r=r.week)&&void 0!==r&&r.length&&(t.selectedPeriod="weekly"),t.selectedLevel=(null===(l=t.currentPeriodPlans[t.currentPeriodPlans.length-1])||void 0===l?void 0:l.level)||4}))},hide:function(){this.dialogVisible=!1,this.step="subscription",this.goodsId="",this.defaultThirdType=0,this.btnLabel="",this.currentSubscriptionData=null,this.dotFrom="new_not_vip_insufficient_calculate_popup"},closeDialog:function(){this.hide()},getLevelType:function(t){return{1:"basic",2:"standard",3:"professional",4:"master"}[t]||"basic"},getPeriodDisplay:function(t){return"weekly"===t?this.$t("week"):this.$t("Month")},calculateMediaCounts:function(t){var e,n=t.every_day_temp_coins;if("weekly"===this.selectedPeriod)e=7;else e=30;return{imageCount:n*e,videoCount:"weekly"===this.selectedPeriod?Math.floor(7*n/30):n}},getLevelData:function(t){var e=this.getLevelType(t.level),n=this.subscriptionLevels[e];this.calculateMediaCounts(t);return x(x({},n),{},{level:t.level,features:x(x({},n.features),{},{newShopTips8:t.run_limit||n.features.newShopTips8,FreeComputingPower:t.first_give_calculate_coins||n.features.FreeComputingPower}),isRecommended:4===t.level||n.isRecommended})},formatEnergyValue:function(t){return Object(k.T)(t)},getPricingData:function(t){var e,n,o,r=this.calculateMediaCounts(t);return{price:(null===(e=t.local_price_web)||void 0===e?void 0:e.price)||0,originalPrice:(null===(n=t.local_price_web)||void 0===n?void 0:n.price_old)||null,discount:t.discount?"-".concat(t.discount,"%"):null,currency:(null===(o=t.local_price_web)||void 0===o?void 0:o.currency)||"$",dailyEnergyValue:t.every_day_temp_coins,imageGenerationText:"".concat(r.imageCount),videoGenerationText:"".concat(r.videoCount),energyInfo:{value:this.formatEnergyValue(r.imageCount),progress:4===t.level?100:25*t.level-15}}},handleSubscribe:function(t){var e,n;this.$xyLogEvent({front_operation:"click",entity_type:"".concat(this.dotFrom,"_click_subscribe_button"),entity_name:"".concat(this.dotFrom,"_click"),obj_info:{pay_package:null==t?void 0:t.id,price:(null===(e=t.local_price_web)||void 0===e?void 0:e.price)||0,discount:t.discount||0,page_from:this.pageFrom,dot_from:this.dotFrom}}),this.currentSubscriptionData={level:t.level,period:this.selectedPeriod,planDetails:t};var o=null==t?void 0:t.id;this.subscriptionNow({goods_id:o,btnLabel:(null===(n=this.subscriptionLevels[this.getLevelType(t.level)])||void 0===n?void 0:n.levelName)||""})},calculateMaxDiscount:function(t){if(!this.subscriptionData||!this.subscriptionData[t]||!this.subscriptionData[t].length)return null;var e=this.subscriptionData[t].map((function(t){return Number(t.discount||0)})),n=Math.max.apply(Math,Object(o.a)(e));return n>0?n:null},subscriptionNow:function(t){var e=this,n=t.goods_id,o=t.btnLabel,r=void 0===o?"":o;this.btnLabel=r,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="payment"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="payment"}}))},quitPay:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("NotVipComputingStayDialog"===this.pageFrom&&e)return this.step="subscription",void this.hide();var n=null===(t=this.$refs.PaymentFormRef)||void 0===t?void 0:t.useTry,o="AwaitingOrderDialog"!==this.pageFrom;if(e&&!n&&o){var r,l=this.goodsId,c=this.btnLabel,d=this.defaultThirdType,h=null===(r=this.$refs.PaymentFormRef)||void 0===r?void 0:r.$options.propsData;this.hide();var v={name:"AwaitingOrderDialog",data:{id:l,sourceDialog:"SubscriptionSelectDialog",dotFrom:this.dotFrom,pageFromData:{btnLabel:c,goodsId:l,defaultThirdType:d},paymentFormProps:h}};this.$EventBus.$emit("showDialog",v)}else this.step="subscription"},handlePaySuccess:function(){this.hide()},checkAndShowRetentionPopup:function(){"new_not_vip_insufficient_calculate_popup"===this.dotFrom&&("AwaitingOrderDialog"!==this.pageFrom&&this.$EventBus.$emit("showDialog",{name:"NotVipComputingStayDialogV2"}))}})},S=T,D=(n(5637),Object(f.a)(S,(function(){var t=this,e=t._self._c;return e("el-dialog",{class:["subscription-dialog","flex-center",{"payment-step":"payment"===t.step}],attrs:{visible:t.dialogVisible,"show-close":!1,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"data-group":t.dotFrom},on:{"update:visible":function(e){t.dialogVisible=e},close:t.hide}},["subscription"===t.step?e("div",{staticClass:"select-content"},[e("div",{staticClass:"dialog-header"},[e("h2",{staticClass:"dialog-title"},[t._v(t._s(t.title.titleMain))]),t._v(" "),e("p",{staticClass:"dialog-subtitle"},[t._v(t._s(t.title.titleSub))])]),t._v(" "),e("div",{staticClass:"period-tabs"},t._l(t.periods,(function(n,o){return e("div",{directives:[{name:"show",rawName:"v-show",value:n.show,expression:"period.show"}],key:o,staticClass:"period-tab flex_c_m",class:{active:t.selectedPeriod===o},attrs:{"data-event":"click_period_"+o},on:{click:function(e){t.selectedPeriod=o}}},[t._v("\n        "+t._s(t.$t(n.i18nKey))+"\n        "),n.discountValue?e("span",{staticClass:"discount-tag",class:{"discount-tag-active":t.selectedPeriod===o}},[t._v("\n          -"+t._s(n.discountValue)+"%\n        ")]):t._e()])})),0),t._v(" "),e("div",{staticClass:"subscription-cards-container"},t._l(t.currentPeriodPlans,(function(n,o){var r;return e("subscription-card",{key:n.id+t.selectedPeriod,staticClass:"card-item",attrs:{"level-data":t.getLevelData(n),pricing:t.getPricingData(n),"level-type":t.getLevelType(n.level),"period-display":t.getPeriodDisplay(t.selectedPeriod),"is-selected":t.selectedLevel===n.level,"features-config":t.featuresList,"data-event":"click_subscribe_"+t.getLevelType(n.level),"data-info":JSON.stringify({pay_package:t.getLevelType(n.level),period:t.selectedPeriod,price:(null===(r=n.local_price_web)||void 0===r?void 0:r.price)||0,discount:n.discount||0}),"data-index":o},on:{select:function(e){t.selectedLevel=n.level},subscribe:function(e){return t.handleSubscribe(n)}}})})),1),t._v(" "),e("div",{staticClass:"dialog-close-btn",attrs:{"data-event":"click_close_subscription"},on:{click:t.closeDialog}},[e("i",{staticClass:"el-icon-close"})])]):t._e(),t._v(" "),"payment"===t.step?e("div",[e("PaymentForm",{ref:"PaymentFormRef",attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":t.handlePaySuccess}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1)],1):t._e()])}),[],!1,null,"162cba7a",null));e.default=D.exports},5782:function(t,e,n){"use strict";n.r(e);var o=n(3),r=n(14),l=n(2),c=(n(20),n(19),n(32),n(11),n(6),n(16),n(12),n(13),n(18),n(185),n(24),n(65),n(8),n(4),n(28),n(21),n(40),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(7),n(41),n(1)),d=n(87),h=[function(){var t=this._self._c;return t("div",{staticClass:"tag-icon flex_c_m"},[t("img",{staticClass:"credits-icon",attrs:{src:n(169),alt:"credits"}})])}],v={PERIODS:{WEEKLY:"weekly",MONTHLY:"monthly",YEARLY:"yearly"},LEVEL_MAP:{1:"ToB_beginnerPlan",2:"StandardPlan",3:"ToB_professionalPlan"},TIME_UNIT_MAP:{yearly:"timeUnitYear",monthly:"timeUnitMonth",weekly:"timeUnitWeek"},BILLING_TYPE_MAP:{yearly:"billedYearly",monthly:"billedMonthly",weekly:"billedWeekly"},DEFAULTS:{CURRENCY:"$",PLAN_LEVEL:"StandardPlan",PERIOD:"monthly"}},f={name:"PriceDetailsTable",props:{goodsId:{type:[String,Number],required:!0},currentProductInfo:{type:Object,default:function(){return null}},updatePriceData:{type:Object,default:function(){return{}}},isSubscription:{type:Boolean,default:!1},useTry:{type:Boolean,default:!1},upgrade:{type:[Number,Boolean],default:0},purchParams:{type:Object,default:function(){return{}}},isOneTimePurchase:{type:Boolean,default:!1},finalPaymentAmount:{type:Number,required:!0},currencySymbol:{type:String,default:"$"}},computed:{isComputeProduct:function(){var t=String(this.goodsId);return t.includes("calculate")&&/\d+/.test(t)},isTrialSubscription:function(){return this.useTry&&this.isSubscription},isUpgrade:function(){return this.upgrade&&this.updatePriceData&&Object.keys(this.updatePriceData).length>0},subscriptionPeriod:function(){var t=String(this.goodsId);return t.includes("weekly")?v.PERIODS.WEEKLY:t.includes("monthly")?v.PERIODS.MONTHLY:t.includes("yearly")||t.includes("year")?v.PERIODS.YEARLY:v.DEFAULTS.PERIOD},levelDisplay:function(){var t=this.currentProductInfo;if(!t||!t.level)return this.$t(v.DEFAULTS.PLAN_LEVEL);var e=t.level,n=v.LEVEL_MAP[e]||(e>=4?"MasterPlan":v.DEFAULTS.PLAN_LEVEL);return this.$t(n)},netPurchaseCoins:function(){var t;if(!this.isComputeProduct)return 0;var e=this.currentProductInfo;return(((null==e?void 0:e.calculate_coins)||0)-((null==e?void 0:e.give_calculate_coins)||0))*((null===(t=this.purchParams)||void 0===t?void 0:t.quantity)||1)},totalBonusCoins:function(){var t;if(!this.isComputeProduct)return 0;var e=this.currentProductInfo;return((null==e?void 0:e.give_calculate_coins)||0)*((null===(t=this.purchParams)||void 0===t?void 0:t.quantity)||1)},firstRowSubtitle:function(){if(this.isComputeProduct)return this.$t("excludingBonus");if(this.isTrialSubscription)return this.$t("trialEndsBilledYearly");if(this.isOneTimePurchase)return this.$t("oneTimePurchase");if(this.isSubscription||this.isUpgrade){var t=v.BILLING_TYPE_MAP[this.subscriptionPeriod]||v.BILLING_TYPE_MAP.monthly;return this.$t(t)}return this.$t("oneTimePurchase")},formattedFirstRowPrice:function(){var t,e;if(this.isComputeProduct)return this.formattedCurrentPrice;var n=this.currentProductInfo;if(!n)return"".concat(this.currencySymbol,"0.00");var o=(null===(t=n.local_price_web)||void 0===t?void 0:t.price_old)||n.price_old||(null===(e=n.local_price_web)||void 0===e?void 0:e.price)||n.price||0;return this.subscriptionPeriod===v.PERIODS.YEARLY&&(o*=12),"".concat(this.currencySymbol).concat(o.toFixed(2))},formattedCurrentPrice:function(){return"".concat(this.currencySymbol).concat(this.finalPaymentAmount.toFixed(2))},formattedDiscountAmount:function(){var t,e;if(this.isComputeProduct)return"".concat(this.currencySymbol,"0.00");var n=this.currentProductInfo;if(!n)return"".concat(this.currencySymbol,"0.00");var o=((null===(t=n.local_price_web)||void 0===t?void 0:t.price_old)||0)-((null===(e=n.local_price_web)||void 0===e?void 0:e.price)||0);if(this.subscriptionPeriod===v.PERIODS.YEARLY)o*=12;else if(!n.discount||0===n.discount)return"".concat(this.currencySymbol,"0.00");var r=Math.max(0,o);return r>0?"-".concat(this.currencySymbol).concat(r.toFixed(2)):"".concat(this.currencySymbol,"0.00")},discountPercentage:function(){var t=this.currentProductInfo;return t&&t.discount||0},shouldShowDiscountTag:function(){return this.discountPercentage>0||this.isTrialSubscription},shouldShowBonusTag:function(){return this.isComputeProduct&&this.totalBonusCoins>0},shouldShowUpgradeDeductionRow:function(){return this.isUpgrade&&this.updatePriceData.balance_local>0},formattedUpgradeDeductionAmount:function(){if(!this.isUpgrade)return"".concat(this.currencySymbol,"0.00");var t=this.updatePriceData.balance_local||0;return t>0?"-".concat(this.currencySymbol).concat(t.toFixed(2)):"".concat(this.currencySymbol,"0.00")}}},m=(n(5604),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"price-details-table"},[e("div",{staticClass:"table-row first-row flex_lr_m"},[e("div",{staticClass:"row-left flex_col gap-y-1"},[t.isComputeProduct?e("div",{staticClass:"row-title flex_m gap-x-2"},[e("img",{staticClass:"credits-icon",attrs:{src:n(169),alt:"算力"}}),t._v(" "),e("span",[t._v(t._s(t.netPurchaseCoins)+" "+t._s(t.$t("calculateCoins")))])]):e("div",{staticClass:"row-title"},[t._v(t._s(t.levelDisplay))]),t._v(" "),e("div",{staticClass:"row-subtitle"},[t._v(t._s(t.firstRowSubtitle))])]),t._v(" "),e("div",{staticClass:"row-right"},[e("span",{staticClass:"row-price text-right"},[t._v(t._s(t.formattedFirstRowPrice))])])]),t._v(" "),e("div",{staticClass:"table-row discount-row flex_lr_m"},[e("div",{staticClass:"row-left"},[e("div",{staticClass:"row-left-content flex_m gap-x-2"},[e("div",{staticClass:"row-title"},[t._v(t._s(t.$t("awaiting_order_dialog_lb6")))]),t._v(" "),t.shouldShowDiscountTag?e("div",{staticClass:"tag-style flex_b gap-x-1"},[e("div",{staticClass:"tag-icon flex_c_m"},[t.isTrialSubscription?e("svg-icon",{attrs:{"icon-class":"blue_time"}}):e("svg-icon",{attrs:{"icon-class":"blue_tag"}})],1),t._v(" "),t.isTrialSubscription?e("span",{staticClass:"tag-text text-right"},[t._v(t._s(t.$t("FreeToTry")))]):e("span",{staticClass:"tag-text text-right"},[t._v(t._s(t.$t("discount_off",{discount:t.discountPercentage})))])]):t._e(),t._v(" "),t.shouldShowBonusTag?e("div",{staticClass:"tag-style flex_b gap-x-1"},[t._m(0),t._v(" "),e("span",{staticClass:"tag-text text-right"},[t._v("+"+t._s(t.totalBonusCoins))])]):t._e()])]),t._v(" "),e("div",{staticClass:"row-right"},[e("span",{staticClass:"row-price discount-amount text-right"},[t._v(t._s(t.formattedDiscountAmount))])])]),t._v(" "),t.shouldShowUpgradeDeductionRow?e("div",{staticClass:"table-row upgrade-deduction-row flex_lr_m"},[e("div",{staticClass:"row-left"},[e("div",{staticClass:"row-title"},[t._v(t._s(t.$t("upgradeDeduction")))])]),t._v(" "),e("div",{staticClass:"row-right"},[e("span",{staticClass:"row-price deduction-amount text-right"},[t._v(t._s(t.formattedUpgradeDeductionAmount))])])]):t._e(),t._v(" "),e("div",{staticClass:"table-row total-row flex_lr_m"},[e("div",{staticClass:"row-left"},[e("div",{staticClass:"row-title"},[t._v(t._s(t.$t("totalPayableToday")))])]),t._v(" "),e("div",{staticClass:"row-right"},[e("span",{staticClass:"row-price total-price text-right"},[t._v(t._s(t.formattedCurrentPrice))])])])])}),h,!1,null,"5bc880f5",null),_=component.exports;function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}installComponents(component,{SvgIcon:n(115).default});var C={PERIODS:{WEEKLY:"weekly",MONTHLY:"monthly",YEARLY:"yearly"},LEVEL_MAP:{1:"ToB_beginnerPlan",2:"StandardPlan",3:"ToB_professionalPlan"},PERIOD_DISPLAY_MAP:{weekly:"planTypeWeek",monthly:"planTypeMonth",yearly:"planTypeYear"},TIME_UNIT_MAP:{yearly:"timeUnitYear",monthly:"timeUnitMonth",weekly:"timeUnitWeek"},BILLING_TYPE_MAP:{yearly:"billedYearly",monthly:"billedMonthly",weekly:"billedWeekly"},DEFAULTS:{CURRENCY:"$",PLAN_LEVEL:"StandardPlan",PERIOD:"monthly",USER_NAME:"USER"}},k={name:"PaymentRightInfo",components:{PriceDetailsTable:_},props:{goodsId:{type:[String,Number],required:!0},upgrade:{type:[Number,Boolean],default:0},useTry:{type:Boolean,default:!1},isSubscription:{type:Boolean,default:!1},context:{type:String,default:"payment",validator:function(t){return["payment","activation"].includes(t)}},purchParams:{type:Object,default:function(){return{}}},activeMethod:{type:Object,default:function(){return{}}},isOneTimePurchase:{type:Boolean,default:!1},apiParams:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,showPriceDetails:!1,securityItems:[{icon:"icon-ka",text:"cardSecureNotice",type:"secure"},{icon:"icon-shuju",text:"dataEncryptedNotice",type:"secure"},{icon:"icon-xinxi",text:"noSellCardInfoNotice",type:"secure"},{icon:"icon-quxiaodingyue",text:"unsubscribeNotice",type:"cancel"},{icon:"icon-ic_Safety",text:"securityNotice",type:"secure"}],subscriptionList:[],computeList:[],webTrialList:[],firstOfferList:[],masterMonthList:[],masterYearList:[],discountMonthList:[],discountYearList:[],updatePriceData:{},updatePriceLoading:!1}},computed:w(w(w({},Object(c.e)("user",["userInfo"])),Object(c.e)("payment",["paymentInfo","paymentGrayInfo"])),{},{allProductsMap:function(){var map=new Map;return this.computeList.forEach((function(t){null!=t&&t.cp_product_id&&map.set(t.cp_product_id,t),null!=t&&t.id&&map.set(t.id,t)})),[].concat(Object(r.a)(this.subscriptionList),Object(r.a)(this.webTrialList),Object(r.a)(this.firstOfferList),Object(r.a)(this.masterMonthList),Object(r.a)(this.masterYearList),Object(r.a)(this.discountMonthList),Object(r.a)(this.discountYearList)).forEach((function(t){null!=t&&t.id&&map.set(t.id,t)})),map},userName:function(){var t,e;return(null===(t=this.userInfo)||void 0===t?void 0:t.name)||(null===(e=this.userInfo)||void 0===e?void 0:e.id)||C.DEFAULTS.USER_NAME},currencySymbol:function(){var t;return(null===(t=this.updatePriceData)||void 0===t?void 0:t.currency)||this.currentPrice.currency},finalPaymentAmount:function(){var t;if(this.isTrialSubscription)return 0;if(this.isUpgrade)return this.updatePriceData.price_local||0;var e=this.currentProductInfo;if(!e)return 0;var n,o=(null===(t=e.local_price_web)||void 0===t?void 0:t.price)||e.price||0;return this.isComputeProduct?o*((null===(n=this.purchParams)||void 0===n?void 0:n.quantity)||1):this.subscriptionPeriod===C.PERIODS.YEARLY?12*o:o},isComputeProduct:function(){var t=String(this.goodsId);return t.includes("calculate")&&/\d+/.test(t)},isTrialSubscription:function(){return this.useTry&&this.isSubscription},isUpgrade:function(){return this.upgrade&&this.updatePriceData&&Object.keys(this.updatePriceData).length>0},subscriptionPeriod:function(){var t=String(this.goodsId);return t.includes("weekly")?C.PERIODS.WEEKLY:t.includes("monthly")?C.PERIODS.MONTHLY:t.includes("yearly")||t.includes("year")?C.PERIODS.YEARLY:C.DEFAULTS.PERIOD},periodDisplay:function(){var t=C.PERIOD_DISPLAY_MAP[this.subscriptionPeriod]||C.PERIOD_DISPLAY_MAP.monthly;return this.$t(t)},levelDisplay:function(){var t=this.currentProductInfo;if(!t||!t.level)return this.$t(C.DEFAULTS.PLAN_LEVEL);var e=t.level,n=C.LEVEL_MAP[e]||(e>=4?"MasterPlan":C.DEFAULTS.PLAN_LEVEL);return this.$t(n)},currentProductInfo:function(){return this.allProductsMap.get(this.goodsId)||null},productName:function(){if(this.isComputeProduct){var t,e=this.currentProductInfo,n=((null==e?void 0:e.calculate_coins)||0)*((null===(t=this.purchParams)||void 0===t?void 0:t.quantity)||1);return this.$t("computePowerServiceTitle",{num:n})}if(this.isSubscription||this.isUpgrade){if(this.isTrialSubscription)return this.$t("trialSubscriptionTitle",{planLevel:this.levelDisplay});if(this.isOneTimePurchase){var o=C.TIME_UNIT_MAP[this.subscriptionPeriod]||C.TIME_UNIT_MAP.monthly;return this.$t("oneTimePurchaseTitle",{planLevel:this.levelDisplay,timeUnit:this.$t(o)})}return this.$t("subscriptionTitle",{planLevel:this.levelDisplay,planYearOrMonth:this.periodDisplay})}var r=C.TIME_UNIT_MAP[this.subscriptionPeriod]||C.TIME_UNIT_MAP.monthly;return this.$t("oneTimePurchaseTitle",{planLevel:this.levelDisplay,timeUnit:this.$t(r)})},currentPrice:function(){var t,e,n,o,r=this.currentProductInfo;return r?this.isComputeProduct?{currency:(null===(n=r.local_price_web)||void 0===n?void 0:n.currency)||C.DEFAULTS.CURRENCY,price:(null===(o=r.local_price_web)||void 0===o?void 0:o.price)||r.price||0}:{currency:(null===(t=r.local_price_web)||void 0===t?void 0:t.currency)||C.DEFAULTS.CURRENCY,price:(null===(e=r.local_price_web)||void 0===e?void 0:e.price)||r.price||0}:{currency:C.DEFAULTS.CURRENCY,price:0}},formattedCurrentPrice:function(){return"".concat(this.currencySymbol).concat(this.finalPaymentAmount.toFixed(2))}}),watch:{useTry:{handler:function(t,e){t!==e&&this.loadProductData()},immediate:!1}},mounted:function(){this.initComponent(),this.trackExposure()},methods:w(w({initComponent:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.showPriceDetails=!1,e.next=3,t.loadProductData();case 3:case"end":return e.stop()}}),e)})))()},loadProductData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,t.upgrade&&(t.updatePriceData={}),n=[],!t.isSubscription&&t.isComputeProduct||n.push(t.getSubscriptionDataFromStore()),t.isComputeProduct&&n.push(t.getComputeList()),t.upgrade&&n.push(t.getUpgradePriceData()),e.next=9,Promise.all(n);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("加载商品数据失败:",e.t0);case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})))()}},Object(c.b)("payment",["getSubscriptionList","getCalculateList"])),{},{getSubscriptionDataFromStore:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,l,c,d,h,v,f,m,_,y,w,C,k,O,x,T,S,D,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList();case 3:n=e.sent,o=n.data,l=(data=void 0===o?{}:o).month,c=void 0===l?[]:l,d=data.year,h=void 0===d?[]:d,v=data.week,f=void 0===v?[]:v,m=data.web_trial,_=void 0===m?null:m,y=data.first_offer,w=void 0===y?[]:y,C=data.master_month,k=void 0===C?[]:C,O=data.master_year,x=void 0===O?[]:O,T=data.discount_month,S=void 0===T?[]:T,D=data.discount_year,P=void 0===D?[]:D,t.subscriptionList=[].concat(Object(r.a)(c),Object(r.a)(h),Object(r.a)(f)),t.webTrialList=_?[_]:[],t.firstOfferList=w||[],t.masterMonthList=k||[],t.masterYearList=x||[],t.discountMonthList=S||[],t.discountYearList=P||[],e.next=26;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("获取订阅列表失败:",e.t0),t.subscriptionList=[],t.webTrialList=[],t.firstOfferList=[],t.masterMonthList=[],t.masterYearList=[],t.discountMonthList=[],t.discountYearList=[];case 26:case"end":return e.stop()}}),e,null,[[0,16]])})))()},getComputeList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(Object.keys(t.apiParams).length>0)){e.next=8;break}return e.next=5,Object(d.f)(t.apiParams);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,t.getCalculateList();case 10:e.t0=e.sent;case 11:n=e.t0,o=n.data,r=(void 0===o?{}:o).calculate,l=void 0===r?[]:r,t.computeList=l,e.next=22;break;case 18:e.prev=18,e.t1=e.catch(0),console.error("获取算力列表失败:",e.t1),t.computeList=[];case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))()},getUpgradePriceData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.upgrade&&t.goodsId){e.next=2;break}return e.abrupt("return");case 2:return t.updatePriceLoading=!0,e.prev=3,e.next=6,Object(d.k)({is_cn:"zhCN"===t.$i18n.locale,product_id:t.goodsId,type:"sub"});case 6:null!=(n=e.sent)&&n.data&&(t.updatePriceData={price_local:n.data.price_local||0,new_price_local:n.data.new_price_local||0,balance_local:n.data.balance_local||0,currency:n.data.currency||C.DEFAULTS.CURRENCY}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("获取升级价格失败:",e.t0),t.updatePriceData={};case 14:return e.prev=14,t.updatePriceLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,10,14,17]])})))()},trackExposure:function(){try{var t={front_operation:"exposure",entity_name:"payment_right_info",entity_type:"component",obj_info:{goods_id:this.goodsId,benefit_type:this.getBenefitType()}};this.$xyLogEvent(t)}catch(t){console.error("PaymentRightInfo 曝光打点发送失败:",t)}},getBenefitType:function(){var t;return(null===(t=[{condition:this.isComputeProduct,type:"compute_purchase"},{condition:this.isSubscription&&this.useTry,type:"trial_subscription"},{condition:this.upgrade,type:"upgrade"},{condition:this.isOneTimePurchase,type:"one_time_purchase"},{condition:this.isSubscription,type:"".concat(this.subscriptionPeriod,"_subscription")}].find((function(t){return t.condition})))||void 0===t?void 0:t.type)||"unknown"},togglePriceDetails:function(){this.showPriceDetails=!this.showPriceDetails}})},O=(n(5605),Object(m.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"payment-right-info flex_col",attrs:{"data-context":t.context}},[e("div",{staticClass:"user-account-section"},[e("div",{staticClass:"account-container flex_lr_m"},[e("div",{staticClass:"user-icon-wrapper flex_m gap-x-2"},[t._m(0),t._v(" "),e("div",{staticClass:"account-text"},[t._v(t._s(t.$t("account")))])]),t._v(" "),e("div",{staticClass:"user-name-display flex1 text-center"},[t._v(t._s(t.userName))])])]),t._v(" "),e("div",{staticClass:"product-card"},[e("div",{staticClass:"product-title-wrapper flex_b"},[e("div",{staticClass:"product-title"},[t._v(t._s(t.productName))]),t._v(" "),e("div",{staticClass:"detail-toggle flex_m gap-x-1",on:{click:t.togglePriceDetails}},[e("span",{staticClass:"detail-text"},[t._v(t._s(t.$t("details")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down arrow-icon",class:{rotated:t.showPriceDetails}})])]),t._v(" "),e("transition",{attrs:{name:"slide-fade"}},[e("PriceDetailsTable",{directives:[{name:"show",rawName:"v-show",value:t.showPriceDetails,expression:"showPriceDetails"}],attrs:{goodsId:t.goodsId,currentProductInfo:t.currentProductInfo,updatePriceData:t.updatePriceData,isSubscription:t.isSubscription,useTry:t.useTry,upgrade:t.upgrade,purchParams:t.purchParams,isOneTimePurchase:t.isOneTimePurchase,finalPaymentAmount:t.finalPaymentAmount,currencySymbol:t.currencySymbol}})],1)],1),t._v(" "),e("div",{staticClass:"security-notice flex_col gap-y-3"},[e("div",{staticClass:"security-title"},[t._v(t._s(t.$t("cardProtectionTitle")))]),t._v(" "),t._l(t.securityItems,(function(n,o){return e("div",{key:o,staticClass:"security-item flex gap-x-3"},[e("div",{class:["security-icon",n.type,"flex_c_m","flex_shrink_0"]},[e("i",{class:["iconfont",n.icon]})]),t._v(" "),e("span",{staticClass:"security-text flex1"},[t._v(t._s(t.$t(n.text)))])])}))],2)])}),[function(){var t=this._self._c;return t("div",{staticClass:"user-icon flex_c_m"},[t("i",{staticClass:"iconfont icon-yonghuzhanghao"})])}],!1,null,"3f2649ca",null));e.default=O.exports},5788:function(t,e,n){"use strict";n.r(e);n(28),n(44),n(90);var o=n(557),r=n(10),l=n(909),c=n(25),d={name:"studioStyleList",components:{studioImageInfo:l.a},data:function(){return{list:[],baseShowNum:6}},computed:{isZhLang:function(){return this.$i18n.locale.startsWith("zh")},getBackground:function(){return function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{backgroundImage:"url(".concat(Object(r.K)(null==e||null===(t=e.cover)||void 0===t?void 0:t.url,"high"),")")}}}},mounted:function(){var t=this;this.getLabStyles(),this.debounceResize=Object(c.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){t.handleResize()}))},beforeDestroy:function(){window.removeEventListener("resize",this.debounceResize),this.debounceResize=null},methods:{handleResize:function(){try{var t=this.$refs.studioList.offsetWidth;console.log("实验室页面实际宽度变为：",t),this.computedBaseNum(t)}catch(t){}},computedBaseNum:function(t){try{var e=Math.floor((t-16)/278);t>=1534&&(e=6),t>1300&&t<1534&&(e=5),t>=1120&&t<=1300&&(e=5),t<1120&&(e=5),t<900&&(e=4),this.baseShowNum=isNaN(e)||e>=6?6:e}catch(t){}},getLabStyles:function(){var t=this;Object(o.a)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.list=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[],console.log("所有风格",t.list))}))},dialogShow:function(t,e){this.$logEvent("log_actions",{operation:"click_style_on_studio",behavior_info:t.key}),this.$refs.imageInfo.show(e)},backTo:function(){history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/studio"))}}},h=d,v=(n(4812),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("div",{ref:"studioList",staticClass:"p-studio-style-list"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"mobile-back-to",on:{click:function(e){return e.stopPropagation(),t.backTo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"studio-style-list-title"},[e("span",{staticClass:"studio-style-list-title-text"},[t._v(t._s(t.$t("AllStyle")))])]),t._v(" "),e("div",{staticClass:"studio-style-list",style:{gridTemplateColumns:"repeat(".concat(t.baseShowNum,", 1fr)")}},t._l(t.list,(function(n,o){var r;return e("div",{key:"".concat((null==n?void 0:n.art_id)+o),staticClass:"lab-item flex flex-col",on:{click:function(e){return t.dialogShow(n,o)}}},[1===(null==n||null===(r=n.cover)||void 0===r?void 0:r.nsfw)?e("div",{staticClass:"lab-img-content bg-nsfw"}):e("div",{staticClass:"lab-img-content",style:t.getBackground(n)}),t._v(" "),e("div",{staticClass:"lab-type flex flex-col"},[e("div",{staticClass:"lab-type-title"},[t._v(t._s(t.$t("labStyleType_".concat(null==n?void 0:n.key.replace(/\s/g,"")))))]),t._v(" "),e("div",{staticClass:"lab-type-text"},[t._v("\n          "+t._s(t.$t("labStyleTypeText_".concat(null==n?void 0:n.key.replace(/\s/g,""))))+"\n        ")])])])})),0),t._v(" "),e("studio-image-info",{ref:"imageInfo",attrs:{list:t.list}})],1)}),[],!1,null,"6ce2b759",null);e.default=component.exports},5792:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(3),l=(n(20),n(11),n(6),n(16),n(12),n(13),n(8),n(4),n(7),n(22),n(18),n(21),n(911)),c=n(10),d=n(9);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"TagInfo",components:{PageView:l.a},data:function(){return{tagInfoDetail:null,list:[],queryParam:{page:1,page_size:50,tag_ids:[],order_by:"hot"},activeName:"artwork",tagIndex:"hot",timeName:"All",weekHotTab:[],needRotate:!1}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,f,m,_,y,w,C,k,O,x,T,S,D,P,I,$,j,data,L,M,E,F,A,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.app,r=t.params,l=t.error,f=(h=r||{}).tag,m=h.type,_=void 0===m?"artwork":m,o.$cookies.get("T"),y=Object(c.C)(),w=y.startTimestamp,C=y.endTimestamp,e.prev=4,k=d.B[_],O=k.url,x=k.params,T=["post","artwork"],S=(null==x?void 0:x.order_by)||"hot",D=T.includes(_)?"week_".concat(S):S,P=T.includes(_)?w:null,I=T.includes(_)?C:null,$=v(v({tag_ids:[f],page:1,page_size:50},x),{},{order_by:D,time_from:P,time_to:I}),e.next=14,n.$post("/api/v1/tag/detail",{id:f||"landscape"});case 14:return j=e.sent,data=j.data,e.next=18,n.$post(O,$);case 18:return L=e.sent,M=L.data,F=(E=M||{}).items,A=E.offset,data&&(data.style={},data.style.url=data.cover||"",data.name=data.title||data.id),N=(F||[]).map((function(t){return t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.banner.replaceUrl=Object(c.K)(t.cover,"low"),t})),$.page++,$.offset=A,e.abrupt("return",{tagInfoDetail:data,list:N||[],queryParam:$,activeName:_,tagIndex:null==x?void 0:x.order_by,timeName:T.includes(_)?"week":"All",weekHotTab:T,needRotate:["ai lookbook"].includes(f)});case 28:e.prev=28,e.t0=e.catch(4),console.log("标签详情页-> asyncData错误啦：",e.t0),l({statusCode:404,message:e.t0});case 32:case"end":return e.stop()}}),e,null,[[4,28]])})))()}},m=n(0),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",[e("PageView",{attrs:{obj:{tagInfoDetail:t.tagInfoDetail,list:t.list,queryParam:t.queryParam,activeName:t.activeName,tagIndex:t.tagIndex,timeName:t.timeName,weekHotTab:t.weekHotTab,needRotate:t.needRotate}}})],1)}),[],!1,null,"c6f414b0",null);e.default=component.exports},5793:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(16),n(22),n(18),n(21),n(1)),c=n(911),d=n(10),h=n(9);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"TagDetail",components:{PageView:c.a},computed:f({},Object(l.c)("user",["userInfo"])),watch:{userInfo:{handler:function(t){var e;"cyberpub"===this.activeName&&(this.queryParam.gender=(null==t||null===(e=t.character_setting)||void 0===e?void 0:e.gender)||"")},deep:!0,immediate:!0}},data:function(){return{tagInfoDetail:null,list:[],queryParam:{page:1,page_size:50,tag_ids:[],order_by:"hot"},activeName:"artwork",tagIndex:"hot",timeName:"All",weekHotTab:[],needRotate:!1}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,v,m,_,y,w,C,k,O,x,T,S,D,P,I,$,j,data,L,M,E,F,A,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.app,r=t.params,l=t.error,v=(c=r||{}).tag,m=c.type,_=void 0===m?"artwork":m,o.$cookies.get("T"),y=Object(d.C)(),w=y.startTimestamp,C=y.endTimestamp,e.prev=4,k=h.B[_],O=k.url,x=k.params,T=["post","artwork"],S=(null==x?void 0:x.order_by)||"hot",D=T.includes(_)?"week_".concat(S):S,P=T.includes(_)?w:null,I=T.includes(_)?C:null,$=f(f({tag_ids:[v],tag:v,page:1,page_size:50},x),{},{order_by:D,sub_channel:"",time_from:P,time_to:I}),"ai-novel"===_&&($.tag_ids=[v]),e.next=15,n.$post("/api/v1/tag/detail",{id:v||"landscape"});case 15:return j=e.sent,data=j.data,e.next=19,n.$post(O,f(f({},$),{},{sub_channel:[]}));case 19:return L=e.sent,M=L.data,F=(E=M||{}).items,A=E.offset,data&&(data.style={},data.style.url=data.cover||"",data.name=data.title||data.id),N=(F||[]).map((function(t){return t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.banner.replaceUrl=Object(d.K)(t.cover,"low"),t})),$.page++,$.offset=A,console.log("list",N),e.abrupt("return",{tagInfoDetail:data,list:N||[],queryParam:$,activeName:_,tagIndex:null==x?void 0:x.order_by,timeName:T.includes(_)?"week":"All",weekHotTab:T,needRotate:["ai lookbook"].includes(v)});case 30:e.prev=30,e.t0=e.catch(4),console.log("标签详情页-> asyncData错误啦：",e.t0),l({statusCode:404,message:e.t0});case 34:case"end":return e.stop()}}),e,null,[[4,30]])})))()}},_=n(0),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e("PageView",{attrs:{obj:{tagInfoDetail:t.tagInfoDetail,list:t.list,queryParam:t.queryParam,activeName:t.activeName,tagIndex:t.tagIndex,timeName:t.timeName,weekHotTab:t.weekHotTab,needRotate:t.needRotate}}})],1)}),[],!1,null,"0a47ff60",null);e.default=component.exports},5808:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(14),r=n(2),l=(n(19),n(50),n(16),n(22),n(49),n(18),n(185),n(4),n(40),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(41),n(923)),c=n(3193),d=n(924),h=n(206),v=n(1),f=n(25);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={components:{tagList:l.a,RoleCardItem:d.a,recCyberBarItem:c.a},data:function(){return{loading:!1,list:[],queryParams:{order_by:"new",categories:[],page:1,page_size:30,offset:0,publish_status:1},noMore:!1,debounceHandleScroll:null,showEmpty:!1,debounceSearch:null}},created:function(){this.debounceSearch=Object(f.debounce)(this.handleSearch,600)},mounted:function(){this.debounceHandleScroll=Object(f.debounce)(this.handleScroll,600),this.getList()},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceSearch=null},computed:_(_({},Object(v.c)("user",["isLoggedIn"])),Object(v.e)("user",["userInfo"])),methods:{handleDelete:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm(this.$t("DelAiChatDesc"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.removeRole(e)}))},removeRole:function(t){var e=this;Object(h.c)({id:t.id}).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){e.handleSearch();var r=e.list.findIndex((function(e){return e.id===t.id}));-1!==r&&e.list.splice(r,1),e.$message.success(e.$t("deleteSuccess"))}}))},handleSearch:function(){this.queryParams.page=1,this.queryParams.offset=0,this.list=[],this.noMore=!1,this.getList()},handleScroll:function(){try{var t=this.$refs.scrollBar;try{if(0===t.scrollTop&&0===t.scrollHeight)return;var e=t.offsetHeight||0,n=t.scrollHeight-t.scrollTop-e;!this.loading&&!this.noMore&&this.queryParams.page>1&&t&&n<=200&&this.getList(!0)}catch(t){}}catch(t){}},getList:function(t){var e=this;if(this.isLoggedIn){var n=Object.assign({},this.queryParams);[null,void 0,""].includes(this.queryParams.offset)||(n.offset=this.queryParams.offset),this.loading=!0,Object(h.h)(n).then((function(n){var o,r,l,c=(null==n?void 0:n.data).items,d=void 0===c?[]:c;if(e.noMore=!(null!==(o=n.data)&&void 0!==o&&o.has_more),d.length>0&&(d=d.map((function(t){return _(_({},t),e.initItems(t))}))),t){var h=e.unionMerge(e.list,d,"id");e.list=e.list.concat(h)}else e.list=d;1===e.queryParams.page&&null!==(r=n.data)&&void 0!==r&&r.offset&&(e.queryParams.offset=(null===(l=n.data)||void 0===l?void 0:l.offset)||0);e.queryParams.page++})).finally((function(){e.loading=!1,e.showEmpty=!0}))}else this.$EventBus.$emit("openLoginDialog")},initItems:function(t){var e,n,o;return{character:{evaluation:t.evaluation,categories:t.categories,name:t.name},cover:null===(e=t.cover)||void 0===e?void 0:e.url,cover_height:null===(n=t.cover)||void 0===n?void 0:n.height,cover_width:null===(o=t.cover)||void 0===o?void 0:o.width,nsfw:2}},unionMerge:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",map=new Map(t.map((function(t){return[t[n],!0]})));return e.reduce((function(t,e){return map.has(e[n])?t:[].concat(Object(o.a)(t),[e])}),[])},changeClass:function(t){this.queryParams.publish_status!==t&&(this.queryParams.publish_status=t,this.debounceSearch&&this.debounceSearch())},updateSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queryParams.categories=t,this.debounceSearch&&this.debounceSearch()}}},w=y,C=(n(5132),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-character no-scrollbar"},[e("el-backtop",{attrs:{bottom:30,right:30,target:".my-character .aichat-list"}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"class-tab"},[e("div",{staticClass:"flex-center",class:{active:1===t.queryParams.publish_status},on:{click:function(e){return t.changeClass(1)}}},[e("i",{staticClass:"iconfont icon-eye"}),t._v(t._s(t.$t("createSetting1"))+"\n    ")]),t._v(" "),e("div",{staticClass:"flex-center",class:{active:2===t.queryParams.publish_status},on:{click:function(e){return t.changeClass(2)}}},[e("i",{staticClass:"iconfont icon-eye-disable"}),t._v(t._s(t.$t("createSetting2"))),e("span")])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"aichat-tags"},[e("tag-list",{on:{selectList:t.updateSelectList}})],1),t._v(" "),e("div",{ref:"scrollBar",staticClass:"aichat-list hide-scrollbar",attrs:{id:"myAiChat"},on:{scroll:t.debounceHandleScroll}},[t._l(t.list,(function(n){return e("recCyberBarItem",{key:null==n?void 0:n.id,attrs:{item:n,outerClass:"myAiChat"},on:{delete:t.handleDelete}})})),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showEmpty&&!t.loading&&!t.list.length,expression:"showEmpty && !loading && !list.length"}],staticClass:"list-empty-content"},[e("p",{staticClass:"list-empty-content-main-title"},[t._v(t._s(t.$t("tavern47")))]),t._v(" "),e("p",{staticClass:"list-empty-content-subtitle"},[t._v(t._s(t.$t("tavern48")))])])],2)],1)}),[],!1,null,"7d7e9bc1",null);e.default=component.exports;installComponents(component,{TagList:n(379).default})},5809:function(t,e,n){"use strict";n.r(e);n(18);var o=n(3),r=n(14),l=n(2),c=(n(20),n(19),n(32),n(50),n(11),n(6),n(16),n(22),n(49),n(185),n(4),n(12),n(13),n(8),n(28),n(21),n(40),n(44),n(7),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(41),n(52)),d=n(206),h=n(923),v=n(924),f=n(25),m=n(10);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var y={name:"tavernList",components:{tagList:h.a,roleCardItem:v.a,SwipeableList:c.default},data:function(){return{replaceImageType:m.K,loading:!1,roleList:[],lastChatParams:{page:1,page_size:100,with_latest_msg:1},hasMoreChat:!1,recentChatLoading:!1,showChatRoleEdit:!1,pageInfo:{page:1,pageSize:20,total:0},queryParams:{keyword:"",order_by:"hot",categories:[],page:1,page_size:30,offset:0},orderList:[{name:"最热",value:"hot",i18nKey:"Hot",iconClass:"hot",behavior_info:"click_hot"},{name:"最近",value:"new",i18nKey:"New",iconClass:"new",behavior_info:"click_new"}],timeName:"All",timeInit:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(m.B)().startTimestamp,endTime:Object(m.B)().endTimestamp},{name:"week",startTime:Object(m.C)().startTimestamp,endTime:Object(m.C)().endTimestamp},{name:"months",startTime:Object(m.A)().startTimestamp,endTime:Object(m.A)().endTimestamp}],list:[],enableNsfw:!1,inputBorderShow:!1,vipIconUrl:n(136),noMore:!1,debounceHandleScroll:function(){},debounceSearch:function(){},showEmpty:!1,defaultImageUrl:"https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp",scroll:0}},computed:{renderChatRoleList:function(){return this.roleList}},watch:{$route:{handler:function(t,e){var n=t.name,o=t.params.keyword;n.includes("tavernSearch")&&(this.queryParams.keyword=o.replace(/\-/g," "),this.handleSearch())}}},mounted:function(){this.debounceSearch=Object(f.debounce)(this.handleSearch,600),this.debounceHandleScroll=Object(f.debounce)(this.handleScroll,600),this.getRecentChatList()},activated:function(){this.restoreScroll()},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceSearch=null},methods:{getIconFn:function(){return this.showChatRoleEdit?"icon-tick":"icon-icon-edit1"},imgError:function(t,e,n){e?n&&(t.target.src=n):t.target.src=this.defaultImageUrl},restoreScroll:function(){var t=this;this.$nextTick((function(){t.$refs.scrollBar&&(t.$refs.scrollBar.scrollTop=t.scroll)}))},handleCheckBoxSearch:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_nsfw"}),this.debounceSearch&&this.debounceSearch()},handleInputSearch:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_search"}),this.debounceSearch&&this.debounceSearch()},handleQueryByTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{this.$refs.tagList.handleSelect({id:t})}catch(t){}},handleSearchChange:function(t){["",null,void 0].includes(t)&&this.debounceSearch&&this.debounceSearch()},getRecentChatList:function(){var t=this,e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.lastChatParams);this.recentChatLoading=!0,Object(d.i)(e).then((function(n){var o;if(t.hasMoreChat=null===(o=n.data)||void 0===o?void 0:o.has_more,e.page>1){var r,l=t.unionMerge(t.roleList,(null==n||null===(r=n.data)||void 0===r?void 0:r.items)||[],"session_id");t.roleList.concat(l)}else{var c;t.roleList=(null==n||null===(c=n.data)||void 0===c?void 0:c.items)||[]}})).finally((function(){t.recentChatLoading=!1}))},loadMoreChat:function(){this.lastChatParams.page++,this.getRecentChatList()},handleScroll:function(){try{var t=this.$refs.scrollBar;try{if(0===t.scrollTop&&0===t.scrollHeight)return;this.scroll=t.scrollTop;var e=t.offsetHeight||0,n=t.scrollHeight-t.scrollTop-e;!this.loading&&!this.noMore&&this.queryParams.page>1&&t&&n<=200&&this.getList(!0)}catch(t){}}catch(t){}},updateSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queryParams.categories=t,this.handleSearch()},handleDeleteRole:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm(this.$t("tavern1"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.removeRole(e),localStorage.removeItem("translate_".concat(e.session_id))}))},removeRole:function(t){var e=this;Object(d.d)({id:t.session_id}).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r=e.roleList.findIndex((function(e){return e.cover===t.cover}));-1!==r&&e.roleList.splice(r,1),e.$message.success(e.$t("deleteSuccess"))}}))},toggleEditStatus:function(){this.showChatRoleEdit=!this.showChatRoleEdit},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={page:this.queryParams.page,page_size:this.queryParams.page_size,categories:this.queryParams.categories,order_by:this.queryParams.order_by,keyword:this.queryParams.keyword,time_from:this.queryParams.time_from,time_to:this.queryParams.time_to};1===n.page||[null,void 0,""].includes(this.queryParams.offset)||(n.offset=this.queryParams.offset),this.loading=!0,Object(d.j)(n).then((function(n){var o,r,l;if(t.noMore=!(null!==(o=n.data)&&void 0!==o&&o.has_more),e){var c,d=t.unionMerge(t.list,(null==n||null===(c=n.data)||void 0===c?void 0:c.items)||[],"id");t.list=t.list.concat(d)}else{var h;t.list=(null==n||null===(h=n.data)||void 0===h?void 0:h.items)||[]}1===t.queryParams.page&&null!==(r=n.data)&&void 0!==r&&r.offset&&(t.queryParams.offset=(null===(l=n.data)||void 0===l?void 0:l.offset)||0);t.queryParams.page++})).finally((function(){t.loading=!1,t.showEmpty=!0}))},unionMerge:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",map=new Map(t.map((function(t){return[t[n],!0]})));return e.reduce((function(t,e){return map.has(e[n])?t:[].concat(Object(r.a)(t),[e])}),[])},handleSelectChange:function(t){var e=this.orderList.find((function(e){return e.value===t}));e&&null!=e&&e.behavior_info&&this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:null==e?void 0:e.behavior_info}),this.debounceSearch&&this.debounceSearch()},handleTimeCommand:function(t){var e={All:"click_all_time_filter",days:"click_day_filter",week:"click_week_filter",months:"click_month_filter"}[t.name];this.$logEvent("log_actions",{operation:e,behavior_info:"on_tavern_page"}),this.timeUpdate(),this.timeName=t.name,this.queryParams.time_from=t.startTime,this.queryParams.time_to=t.endTime,this.debounceSearch&&this.debounceSearch()},timeUpdate:function(){this.timeInit=[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(m.B)().startTimestamp,endTime:Object(m.B)().endTimestamp},{name:"week",startTime:Object(m.C)().startTimestamp,endTime:Object(m.C)().endTimestamp},{name:"months",startTime:Object(m.A)().startTimestamp,endTime:Object(m.A)().endTimestamp}]},handleSearch:function(){this.queryParams.page=1,this.queryParams.offset=0,this.list=[],this.noMore=!1,this.getList()},clearKeyword:function(){this.queryParams.keyword="",this.debounceSearch&&this.debounceSearch()},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),this.$router.push(this.localePath("/mall"))},toChat:function(t){var e=t.character_id,n=t.session_id;this.$router.replace(this.localePath("/aiChat/".concat(e,"?s_id=").concat(n)))}},head:function(){var title=this.$t("cyberPubHomeTitle"),t=this.$t("cyberPubHomeDesc");return{title:title,meta:[{hid:"description",name:"description",content:t},{hid:"keywords",name:"keywords",content:this.$t("CyberPubKeyword")},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:t}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,data,h,v,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,l=o.keyword,e.prev=2,c={order_by:"hot",page:1,page_size:30,categories:[],keyword:l?null==l?void 0:l.replace(/\-/g," "):""},e.next=6,n.$post("/api/v1/character/list",c);case 6:return d=e.sent,data=d.data,v=(h=data||{items:[],offset:0}).items,f=h.offset,c.page++,c.offset=f,console.log(c),e.abrupt("return",{list:v||[],queryParams:c});case 15:e.prev=15,e.t0=e.catch(2),console.log("数字人-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))()}},w=y,C=(n(5133),n(0)),component=Object(C.a)(w,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-tavern-list"},[n("el-backtop",{attrs:{bottom:30,right:30,target:".c-tavern-list .tavern-list-box"}},[n("i",{staticClass:"el-icon-top"})]),e._v(" "),n("div",{ref:"scrollBar",staticClass:"tavern-list-box no-scrollbar",on:{scroll:e.debounceHandleScroll}},[n("div",{directives:[{name:"show",rawName:"v-show",value:null===(t=e.roleList)||void 0===t?void 0:t.length,expression:"roleList?.length"}],staticClass:"tavern-last-chat-list"},[n("div",{staticClass:"tavern-list-title"},[e._v(e._s(e.$t("tavern50")))]),e._v(" "),n("div",{staticClass:"btn-box"},[n("div",{staticClass:"edit-btn",on:{click:function(t){return t.stopPropagation(),e.toggleEditStatus.apply(null,arguments)}}},[n("i",{staticClass:"iconfont edit-btn-icon",class:[e.getIconFn(),e.showChatRoleEdit?"edit-btn-icon-active":""]}),e._v(" "),n("span",{staticClass:"edit-btn-text",class:[e.showChatRoleEdit?"edit-btn-text-active":""]},[e._v(e._s(e.showChatRoleEdit?e.$t("Done"):e.$t("Edit")))])])]),e._v(" "),n("div",{staticClass:"tavern-last-chat-list-content"},[n("div",{staticClass:"last-chat-role-list-wrap"},[n("SwipeableList",{attrs:{top:"10px",height:"136px",listGap:"10px",bntTop:"-40px"}},[n("div",{staticClass:"last-chat-role-list-content"},e._l(e.renderChatRoleList,(function(t,o){var r,l;return n("div",{key:o,staticClass:"role-item-wrap"},[n("div",{staticClass:"role-item-content",on:{click:function(n){return e.toChat(t)}}},[n("div",{staticClass:"role-item-content-img"},[n("img",{staticClass:"art-work-card-image",attrs:{src:null!=t&&null!==(r=t.cover)&&void 0!==r&&r.cover?e.replaceImageType(null==t||null===(l=t.cover)||void 0===l?void 0:l.cover,"low"):e.defaultImageUrl,alt:"",onError:"{(e)=>imgError(e)}"}})]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showChatRoleEdit,expression:"showChatRoleEdit"}],staticClass:"role-item-delete-btn",on:{click:function(n){return n.stopPropagation(),e.handleDeleteRole(t)}}},[n("i",{staticClass:"el-icon-close"})])]),e._v(" "),n("div",{staticClass:"role-item-title"},[e._v(e._s(t.name))])])})),0)])],1)])]),e._v(" "),n("div",{staticClass:"tavern-role-list"},[n("div",{staticClass:"tavern-list-title tavern-list-title-2"},[e._v(e._s(e.$t("tavern51")))]),e._v(" "),n("div",{staticClass:"tavern-list-search-box",class:{"justify-end":e.queryParams.keyword}},[n("div",{directives:[{name:"show",rawName:"v-show",value:""===e.queryParams.keyword,expression:"queryParams.keyword === ''"}],staticClass:"tavern-list-search-box-left"},[n("el-select",{staticClass:"custom-select",staticStyle:{width:"110px"},attrs:{"popper-class":"custom-select",placeholder:e.$t("All")},on:{change:e.handleSelectChange},model:{value:e.queryParams.order_by,callback:function(t){e.$set(e.queryParams,"order_by",t)},expression:"queryParams.order_by"}},e._l(e.orderList,(function(t){return n("el-option",{key:t.value,attrs:{label:e.$t(t.i18nKey),value:t.value}})})),1),e._v(" "),n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleTimeCommand}},[n("div",{staticClass:"el-dropdown-link selectTime"},[n("div",[n("i",{staticClass:"el-icon-time"}),e._v(" "),n("span",[e._v(e._s(e.$t(e.timeName)))])]),e._v(" "),n("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.timeInit,(function(t,o){return n("el-dropdown-item",{key:o,attrs:{command:t}},[n("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[n("span",[e._v(e._s(e.$t(t.name)))])])])})),1)],1)],1),e._v(" "),n("div",{staticClass:"tavern-list-search-input",class:{inputBorder:e.inputBorderShow}},[n("i",{staticClass:"iconfont icon-min-search"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.queryParams.keyword,expression:"queryParams.keyword"}],attrs:{type:"text",placeholder:e.$t("tavern57")},domProps:{value:e.queryParams.keyword},on:{change:e.handleSearchChange,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputSearch.apply(null,arguments)},focus:function(t){e.inputBorderShow=!0},blur:function(t){e.inputBorderShow=!1},input:function(t){t.target.composing||e.$set(e.queryParams,"keyword",t.target.value)}}}),e._v(" "),e.queryParams.keyword?n("i",{staticClass:"el-icon-close",on:{click:e.clearKeyword}}):e._e()])]),e._v(" "),n("div",{staticClass:"tavern-list-tag-box"},[n("tag-list",{ref:"tagList",on:{selectList:e.updateSelectList}})],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tavern-list-content-wrap"},[n("div",{staticClass:"tavern-list-content"},[e._l(e.list,(function(t,i){return n("role-card-item",{key:i+t.id,attrs:{"card-info":t},on:{queryByTag:e.handleQueryByTag}})})),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmpty&&!e.loading&&!e.list.length,expression:"showEmpty && !loading && !list.length"}],staticClass:"list-empty-content"},[n("p",{staticClass:"list-empty-content-subtitle"},[e._v(e._s(e.$t("tavern49")))])])],2)])])]),e._v(" "),n("div",{staticClass:"tavern-list-box-bottom-mask"})],1)}),[],!1,null,"71abf070",null);e.default=component.exports;installComponents(component,{SwipeableList:n(52).default,TagList:n(379).default})},5821:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(26),n(127)),l=n(126),c=n(3436),d=n(300),h=n(1122),v=n(87),f={name:"GamePaymentFormDialog",provide:function(){return{top:this}},components:{RightPart:r.a,PaymentForm:l.a,PaymentStatusDialog2:c.default},computed:{btnLabel:function(){return this.$t("pay")}},data:function(){return{showPayment:!1,goodsId:"",loading:!1,intervalId:"",defaultOptions:{animationData:d},dotFrom:"game_page_pop",PAYMENT_TYPES:{PAYERMAX:1,ALIPAY:4,WECHAT:5,PAYPAL:6,SESSION:8,ADYEN:9,ORDER:10}}},mounted:function(){this.showPaymentFormDialog()},methods:{showPaymentFormDialog:function(){var t;this.goodsId=null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transaction_id,console.log("goodsId",this.goodsId),this.goodsId?this.showPayment=!0:this.isShowPaymentStatusDialog()},showLoading:function(t){this.loading=t},success:function(){this.$EventBus.$emit("getMallGoodsData")},quitPay:function(){this.$refs.paymentForm.inPaymentForm="in-form"},isShowPaymentStatusDialog:function(){var t=window.location.href,e=Object(h.a)(t),n=e.x_type,o=e.outTradeNo,r=e.token,l=e.out_trade_no,c=e.ba_token,d=e.session_id,v=e.adyen_order_id,f=e.orderNo,m=o||c||r||l||d||v||f,_=this.getPaymentType(e);"change-sub"!==n?_&&(this.loading=!0,this.showPayment=!1,this.pollGetPaymentStatus(_,m)):this.$message.success(this.$t("ChangeSubSuccess"))},getPaymentType:function(t){var e=t.outTradeNo,n=t.ba_token,o=t.token,r=t.out_trade_no,l=t.session_id,c=t.adyen_order_id,d=t.orderNo;return e?this.PAYMENT_TYPES.PAYERMAX:n||o?this.PAYMENT_TYPES.PAYPAL:r?this.PAYMENT_TYPES.ALIPAY:l?this.PAYMENT_TYPES.SESSION:c?this.PAYMENT_TYPES.ADYEN:d?this.PAYMENT_TYPES.ORDER:0},pollGetPaymentStatus:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,data;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(v.j)({third_type:t,order_id:e});case 3:if(r=o.sent,null==(data=r.data)||!data.is_paid){o.next=8;break}return n.handlePaymentSuccess(data),o.abrupt("return");case 8:n.intervalId=setTimeout((function(){n.pollGetPaymentStatus(t,e)}),2e3),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),n.handlePaymentError(o.t0);case 14:case"end":return o.stop()}}),o,null,[[0,11]])})))()},handlePaymentSuccess:function(data){var t=this;this.$nextTick((function(){t.$EventBus.$emit("openPaymentStatusDialog2",{data:data})})),clearTimeout(this.intervalId),this.loading=!1},handlePaymentError:function(t){clearTimeout(this.intervalId),console.error("支付状态查询失败:",t),this.$message.error(this.$t("payment.query_failed"))}}},m=(n(5491),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"PaymentFormDialog flex-center"},[t.loading?e("lottie",{staticClass:"loading-anime",attrs:{options:t.defaultOptions,height:110,width:110}}):t._e(),t._v(" "),t.showPayment?e("PaymentForm",{ref:"paymentForm",attrs:{thirdParty:!0,defaultThirdType:9,initMount:!0,btnLabel:t.btnLabel,goodsId:t.goodsId,showBack:!1,backToCheck:!0},on:{"pay-success":t.success,"in-pay-back":t.quitPay,"in-loading":function(e){return t.showLoading(e)}}}):t._e(),t._v(" "),t._e()],1)}),[],!1,null,"3605d998",null);e.default=component.exports},5859:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(7);var o=n(3),r=n(2),l=(n(20),n(32),n(16),n(24),n(8),n(4),n(21),n(26),n(1)),c=n(462),d=n(126),h=n(127),v=n(39),f=n(163),m=n(365),_=n(78);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"DailyDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,useFree:!1,btnLabel:"",dotFrom:"daily_pop",isFirstOpen:!0}},components:{UserDaily:c.a,PaymentForm:d.a,RightPart:h.a,CustomModalDialog:m.default},mounted:function(){var t=this;this.$EventBus.$on("checkDailyDialog",(function(){t.show("generate_pop")})),this.$EventBus.$on("openDailyDialog",(function(e){var n="createBanner"==e?"banner_task_daily_pop":"banner_home_daily_pop";t.dotFrom=n,t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:n,behavior_info_sub:"pop_1"}),t.$xyLogEvent({front_operation:"exposure",entity_name:n,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),t.isShowDialog=!0,t.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.userDaily)||void 0===e||e.getGoodsData()}))}))},beforeDestroy:function(){this.$EventBus.$off("checkDailyDialog"),this.$EventBus.$off("openDailyDialog")},computed:w(w(w(w({},Object(l.c)("payment",["paymentInfo"])),Object(l.c)("user",["isLoggedIn","isCompanyAccount"])),Object(l.e)("user",["userInfo"])),Object(l.e)("payment",["subThirdType"])),watch:{$route:{handler:function(t,e){var n=this,o=["cyberPub","ai-tools","workFlowAppDetail","loraTrainingEdit","editBoard","aiChat","ai-audio/create","ai-audio/train","novel/detail"].find((function(e){return t.fullPath.includes(e)}));o&&setTimeout((function(){n.show(o)}),1500)},immediate:!0},userInfo:{handler:function(t){var e;if(null!==(e=Object.keys(t))&&void 0!==e&&e.length){var n=(new Date).getTime()-(null==t?void 0:t.create_at)<1728e5;this.isNewUser=n}else this.isNewUser=!1},immediate:!0,deep:!0}},methods:w(w({},Object(l.b)("payment",["getSubUrlAndThirdType"])),{},{handleDialogClosed:function(){this.isFirstOpen=!0},handleBeforeLeave:function(){this.$refs.userDaily=null},show:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=t.length>0&&void 0!==t[0]?t[0]:"",e.isLoggedIn){n.next=3;break}return n.abrupt("return");case 3:if(!(null===_.b||void 0===_.b||null===(o=_.b.storage)||void 0===o?void 0:o.isPopupShownToday(null===_.a||void 0===_.a?void 0:_.a.HALF_PRICE))){n.next=6;break}return n.abrupt("return");case 6:if(d=!1,!["generate_pop","workFlowAppDetail","ai-tools","aiChat"].includes(c)){n.next=26;break}if(!(h=localStorage.getItem("user_type"))){n.next=15;break}(h=Number(h))>0&&(d=!0),n.next=26;break;case 15:return n.prev=15,n.next=18,Object(f.i)();case 18:m=n.sent,y=(null==m?void 0:m.data)||{},y.pop_type>0&&(d=!0),n.next=26;break;case 23:n.prev=23,n.t0=n.catch(15),console.log("error",n.t0);case 26:if(!((null===(r=e.paymentInfo)||void 0===r?void 0:r.activeState)||(null===(l=e.paymentInfo)||void 0===l?void 0:l.liteActiveState)||e.isCompanyAccount)&&!d){n.next=29;break}return n.abrupt("return");case 29:Object(v.g)({type:0}).then((function(t){(null==t?void 0:t.data)&&(e.isShowDialog=!0,e.dotFrom="daily_pop",e.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"daily_pop",behavior_info_sub:"pop_1"}),e.$xyLogEvent({front_operation:"exposure",entity_name:"daily_pop",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}))}));case 30:case"end":return n.stop()}}),n,null,[[15,23]])})))()},close:function(){var t=this,e=setTimeout((function(){t.isShowDialog=!1,clearTimeout(e),Object(v.g)({type:1})}),10)},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=t.goods_id,o=void 0===n?"":n,r=t.useFree,l=void 0!==r&&r,c=t.btnLabel,d=void 0===c?"":c;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.dotFrom||"daily_pop",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.dotFrom||"daily_pop",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}}),this.useFree=l,this.btnLabel=d,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=o,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=o,e.step="inPay"}}))}})},k=C,O=n(0),component=Object(O.a)(k,(function(){var t=this,e=t._self._c;return e("CustomModalDialog",{ref:"modalDialog",attrs:{visible:t.isShowDialog,"custom-class":"daily-dialog-custom","data-group":"daily_dialog_custom_dialog"},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.handleDialogClosed,"before-leave":t.handleBeforeLeave}},["inGoods"===t.step&&t.isShowDialog?e("UserDaily",{ref:"userDaily",attrs:{isNewUser:t.isNewUser},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step&&t.isShowDialog?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,disabledMethods:t.useFree?[1,10]:[],isFreeTry:t.useFree,initMount:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[t.useFree?[e("right-part",{attrs:{showBg:!1,showText:!1,showStep:!0,activation:!1,showAvatar:!0}})]:[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})]],2):t._e()],1)}),[],!1,null,null,null);e.default=component.exports},5860:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(4),n(7);var o=n(2),r=(n(8),n(26),n(1)),l=n(462),c=n(126),d=n(127);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"RenewalDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,defaultSelected:"basic",btnLabel:"",dotFrom:"vip_renewal",isFirstOpen:!0}},components:{UserDaily:l.a,PaymentForm:c.a,RightPart:d.a},mounted:function(){this.$EventBus.$on("showRenewalDialog",this.show)},beforeDestroy:function(){this.$EventBus.$off("showRenewalDialog",this.show)},computed:v(v(v({},Object(r.e)("payment",["subThirdType","paymentInfo"])),Object(r.c)("user",["isCompanyAccount"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)}}),watch:{paymentInfo:{handler:function(t){var e;if(null!==(e=Object.keys(t))&&void 0!==e&&e.length){var n=t.expiryTime,o=t.liteExpiryTime,r=t.activeState,l=t.liteActiveState,c=t.svipActiveState,d="vip_day_1"==t.vipType;if((r||l)&&!c&&!this.isCompanyAccount&&!d){var h=Math.max(n,o),v=(new Date).getTime(),f=864e5,m=h<v+2592e5,_=localStorage.getItem("renewalTime");if(m&&(!_||v-_>f))this.isShowDialog=!0,r&&!c&&!this.isCompanyAccount&&!l&&(this.defaultSelected="standard"),localStorage.setItem("renewalTime",v)}}},immediate:!0,deep:!0}},methods:v(v({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{handleDialogClosed:function(){this.isFirstOpen=!0},handleBeforeLeave:function(){this.$refs.userDaily=null},show:function(){var t=this;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"vip_renewal",behavior_info_sub:"pop_1"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"vip_renewal",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),this.isShowDialog=!0,this.$nextTick((function(){var e;null===(e=t.$refs)||void 0===e||null===(e=e.userDaily)||void 0===e||e.getGoodsData()}))},close:function(){var t=this,e=setTimeout((function(){t.isShowDialog=!1,clearTimeout(e)}),10)},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=t.goods_id,o=t.btnLabel,r=void 0===o?"":o;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"vip_renewal",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"vip_renewal",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}}),this.btnLabel=r,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}}))}})},m=(n(5572),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"renewal-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.handleDialogClosed}},[e("transition",{attrs:{name:"fade",mode:"out-in",appear:!0},on:{"before-leave":t.handleBeforeLeave}},["inGoods"===t.step&&t.isShowDialog?e("UserDaily",{ref:"userDaily",attrs:{title:"RenewalTitle",defaultSelected:t.defaultSelected},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step&&t.isShowDialog?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)],1)}),[],!1,null,"1c0b63d3",null);e.default=component.exports},5861:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(16),n(31),n(26),n(1)),l=n(462),c=n(126),d=n(127),h=n(365);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"NotVipComputingDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"not_vip_calculate",isFirstOpen:!0,pageFrom:""}},components:{UserDaily:l.a,PaymentForm:c.a,RightPart:d.a,CustomModalDialog:h.default},mounted:function(){this.$EventBus.$on("showNotVipComputingDialog",this.show)},beforeDestroy:function(){this.$EventBus.$off("showNotVipComputingDialog",this.show)},computed:f(f(f(f({},Object(r.e)("payment",["subThirdType","paymentGrayInfo"])),Object(r.c)("payment",["paymentInfo"])),Object(r.e)("user",["userInfo"])),{},{currentUserTierType:function(){var t;return null===(t=this.paymentInfo)||void 0===t?void 0:t.userType}}),methods:f(f({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.pageFrom,n=void 0===e?"":e,o=t.step,r=void 0===o?"":o,l=t.pageFromData,c=void 0===l?{}:l;this.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{pageFrom:n,step:r,pageFromData:c,dotFrom:"new_not_vip_insufficient_calculate_popup"}})},handleDialogClosed:function(){this.isFirstOpen=!0},handleBeforeLeave:function(){this.$refs.userDaily=null},close:function(){var t=this,e=setTimeout((function(){var n,o,r,l;if(t.isShowDialog=!1,clearTimeout(e),!((null===(n=t.paymentInfo)||void 0===n?void 0:n.activeState)||(null===(o=t.paymentInfo)||void 0===o?void 0:o.liteActiveState)||t.isCompanyAccount)&&(null===(r=t.userInfo)||void 0===r?void 0:r.create_at)>Date.now()-864e5)t.$EventBus.$emit("showDialog",{name:"TransferInPageDialog",data:{isNewUser:!0,countDown:10,retention:!0}});else{var c=(new Date).toISOString().slice(0,10);(null===(l=t.paymentGrayInfo)||void 0===l?void 0:l.retention_popup)&&[1,2,4].includes(t.currentUserTierType)&&localStorage.getItem("notVipComputingStayDialogLastShowTime")!==c&&"AwaitingOrderDialog"!==t.pageFrom&&(t.$EventBus.$emit("showDialog",{name:"NotVipComputingStayDialog"}),localStorage.setItem("notVipComputingStayDialogLastShowTime",c))}}),10)},quitPay:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"NotVipComputingStayDialog"===this.pageFrom&&t?(this.step="inGoods",void(this.isShowDialog=!1)):t&&!this.$refs.PaymentFormRef.useTry&&"AwaitingOrderDialog"!==this.pageFrom?(this.isShowDialog=!1,void this.$EventBus.$emit("showDialog",{name:"AwaitingOrderDialog",data:{id:this.goodsId,sourceDialog:"NotVipComputingDialog",dotFrom:this.dotFrom,pageFromData:{btnLabel:this.btnLabel,goodsId:this.goodsId,defaultThirdType:this.defaultThirdType},paymentFormProps:this.$refs.PaymentFormRef.$options.propsData}})):void(this.step="inGoods")},subscriptionNow:function(t){var e=this,n=t.goods_id,o=t.btnLabel,r=void 0===o?"":o;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"not_vip_calculate",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"not_vip_calculate",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}}),this.btnLabel=r,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}}))}})},_=m,y=n(0),component=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("CustomModalDialog",{ref:"modalDialog",attrs:{visible:t.isShowDialog,"custom-class":"not-vip-computing-dialog-custom","data-group":"not_vip_computing_dialog"},on:{"update:visible":function(e){t.isShowDialog=e},closed:t.handleDialogClosed,"before-leave":t.handleBeforeLeave}},["inGoods"===t.step&&t.isShowDialog?e("UserDaily",{ref:"userDaily",attrs:{title:"NotVipComputingTitle"},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step&&t.isShowDialog?e("PaymentForm",{ref:"PaymentFormRef",attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,null,null);e.default=component.exports},5862:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(14),r=n(68),l=n(3),c=n(2),d=(n(20),n(19),n(32),n(16),n(22),n(65),n(4),n(21),n(40),n(41),n(26),n(126)),h=n(127),v=n(39),f=n(9),m=n(1);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"ActivationDialog",provide:function(){return{top:this}},computed:y(y(y({},Object(m.e)("user",["userInfo"])),Object(m.e)("payment",["paymentGrayInfo"])),{},{isT1Country:function(){return this.userInfo&&this.userInfo.current_country_code?Array.isArray(f.qb)?f.qb.includes(this.userInfo.current_country_code):(console.warn("t1Countries is not properly defined"),!1):(console.warn("User country code not available, defaulting to non-T1"),!1)},currentPlan:function(){return this.isT1Country?"SVIPPlanStandard":"SVIPPlanBeginner"},currentGoodsId:function(){return this.isT1Country?"sub_yearly2_web_trial":"sub_yearly1"},yearlyFeeOld:function(){var t,e,n=(null===(t=this.goodsInfoCurrent)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)||"",o=null===(e=this.goodsInfoCurrent)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price;return!o||isNaN(o)?n+"0.00":n+(12*o).toFixed(2)},mounthFeeOld:function(){var t,e,n=(null===(t=this.goodsInfoCurrent)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)||"",o=null===(e=this.goodsInfoCurrent)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price;return!o||isNaN(o)?n+"0.00":n+o.toFixed(2)},shouldShowNewRightInfo:function(){var t;return!0===(null===(t=this.paymentGrayInfo)||void 0===t?void 0:t.checkout_popup)}}),data:function(){return{isShowDialog:!1,isShowClose:!1,terms:["ActivationTerms1","ActivationTerms2","ActivationTerms3","ActivationTerms4"],step:"inGoods",goodsInfoCurrent:{},unit:"",defaultThirdType:0,showRightPart:!0,dotFrom:"new_user_free_try",popupParam:f.fb,isFirstOpen:!0,fromPage:"",cachedYearList:null}},components:{PaymentForm:d.a,RightPart:h.a,PaymentRightInfo:function(){return Promise.all([n.e(2),n.e(4),n.e(1),n.e(15),n.e(11),n.e(10),n.e(13),n.e(0),n.e(7),n.e(14),n.e(3),n.e(5),n.e(6),n.e(12),n.e(9),n.e(8),n.e(16)]).then(n.bind(null,5782))}},mounted:function(){this.$EventBus.$on("showActivationDialog",this.show)},destroyed:function(){this.$EventBus.$off("showActivationDialog",this.show)},watch:{isShowDialog:{handler:function(t){var e=this;t?setTimeout((function(){e.isShowClose=!0}),3e3):this.isShowClose=!1},immediate:!0},currentGoodsId:{handler:function(t){this.isShowDialog&&t&&(this.cachedYearList?this.updateGoodsInfo(this.cachedYearList):this.getGoodsData())}}},methods:y(y({},Object(m.b)("payment",["getSubscriptionList","setActivationPopupEndTime","updateStoragePopupState"])),{},{show:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fromPage:null};this.isShowDialog=!0,this.fromPage=data.fromPage,this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"new_user_free_try",behavior_info_sub:"pop_1"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"new_user_free_try",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),this.getGoodsData()},getGoodsData:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList();case 3:if(n=e.sent,o=n.data,(data=void 0===o?{}:o)&&"object"===Object(r.a)(data)){e.next=8;break}return console.warn("Invalid subscription data received:",data),e.abrupt("return");case 8:t.handleYearlySub(data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Failed to fetch subscription data:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},handleYearlySub:function(t){var e=(null==t?void 0:t.year)||[],n=null==t?void 0:t.web_trial,r=Array.isArray(e)?e:[],l=n?[n]:[],c=[].concat(Object(o.a)(r),l);c.length>0?(this.cachedYearList=c,this.updateGoodsInfo(c)):console.warn("No valid subscription data available")},updateGoodsInfo:function(t){if(t&&Array.isArray(t)){var e=this.currentGoodsId;if(e){var n,o=t.find((function(t){return(null==t?void 0:t.id)===e}));if(o)this.goodsInfoCurrent=o,this.unit=(null==o||null===(n=o.local_price_web)||void 0===n?void 0:n.currency)||"",console.log("商品信息已更新",e,this.goodsInfoCurrent);else console.warn("updateGoodsInfo: Goods not found for ID:",e,"Available IDs:",t.map((function(t){return null==t?void 0:t.id}))),this.goodsInfoCurrent={id:e,local_price_web:{currency:"",price:0}},this.unit=""}else console.warn("updateGoodsInfo: No current goods ID available")}else console.warn("updateGoodsInfo: Invalid yearList provided",t)},handleDialogClosed:function(){this.isFirstOpen=!0},handleBeforeLeave:function(){this.$refs.PaymentFormRef=null},close:function(){var t=this;if(Object(v.g)({type:1}),this.showRightPart)var e=setTimeout((function(){if(t.isShowDialog=!1,"ActivationDailogTimerButton"!==t.fromPage){var n=Date.now()+3e5;t.setActivationPopupEndTime(n),t.updateStoragePopupState("ActivationDialog"),t.$logEvent("log_actions",{operation:"exposure",behavior_info:"try_subscription_floating_window"})}clearTimeout(e)}),10);else this.$refs.PaymentFormRef.handleBack()},tryNow:function(){this.step="inPay",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"new_user_free_try",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"new_user_free_try",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}})}})},C=w,k=(n(5578),n(0)),component=Object(k.a)(C,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"activation-dialog flex-center",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"z-index":e.popupParam.activation.z,"close-on-click-modal":!1,"close-on-press-escape":!1,"data-group":"activation_dialog"},on:{"update:visible":function(t){e.isShowDialog=t},closed:e.handleDialogClosed}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowClose,expression:"isShowClose"}],staticClass:"activation-dialog-close flex-center",on:{click:e.close}},[n("i",{staticClass:"el-icon-close"})]),e._v(" "),n("transition",{attrs:{name:"fade",mode:"out-in",appear:!0},on:{"before-leave":e.handleBeforeLeave}},[n("div",{key:"step-content"},["inGoods"===e.step&&e.isShowDialog?n("div",{staticClass:"left"},[n("div",{staticClass:"left-header"},[n("span",{staticClass:"left-header-free flex-center"},[n("i",{staticClass:"iconfont icon-icon-free"}),e._v(" "),n("span",[e._v(e._s(e.$t("Free")))])]),e._v(" "),n("span",{staticClass:"left-header-try"},[e._v(e._s(e.$t(e.isT1Country?"TryStandard":"TryBasic")))])]),e._v(" "),n("div",{staticClass:"left-desc"},e._l(e.terms,(function(t,o){return n("div",{key:"terms_".concat(o),staticClass:"item-terms"},[n("i",{staticClass:"el-icon-check"}),e._v(" "),n("span",[e._v(e._s(e.$t(t)))])])})),0),e._v(" "),null!==(t=e.goodsInfoCurrent)&&void 0!==t&&t.local_price_web?n("div",{staticClass:"left-tips"},[n("div",{staticClass:"item-tip"},[e._v(e._s(e.$t("ActivationTip1")))]),e._v(" "),n("div",{staticClass:"item-tip"},[e._v("\n            "+e._s(e.$t("ActivationTip2",{unitYear:e.yearlyFeeOld,unitMonth:e.mounthFeeOld,plan:e.$t(e.currentPlan)}))+"\n          ")])]):e._e(),e._v(" "),n("el-button",{staticClass:"left-btn",on:{click:e.tryNow}},[e._v("\n          "+e._s(e.$t("StartFreeTrial"))+"\n        ")])],1):e._e(),e._v(" "),"inPay"===e.step&&e.isShowDialog?n("PaymentForm",{ref:"PaymentFormRef",attrs:{defaultThirdType:e.defaultThirdType,disabledMethods:[1,10],initMount:!0,isFreeTry:!0,showFreeTry:!1,goodsId:e.currentGoodsId,purchParams:{},btnLabel:"StartFreeTrial"},on:{"in-pay-back":function(t){e.step="inGoods"},"in-waiting":function(t){e.showRightPart=!1},"in-form":function(t){e.showRightPart=!0},"pay-success":function(t){e.isShowDialog=!1,e.step="inGoods"}}}):e._e()],1)]),e._v(" "),e.showRightPart?[e.shouldShowNewRightInfo&&"inPay"===e.step?n("PaymentRightInfo",{attrs:{goodsId:e.currentGoodsId,upgrade:0,useTry:!0,isSubscription:!0,context:"activation",purchParams:{},activeMethod:{},isOneTimePurchase:!1}}):n("right-part",{attrs:{currency:e.unit,showBg:!1,showText:!1,showStep:!0,activation:"inGoods"===e.step,showAvatar:"inPay"===e.step,currentPlan:e.currentPlan}})]:e._e()],2)}),[],!1,null,"728610a8",null);e.default=component.exports},5863:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(4),n(7),n(448),n(47);var o=n(259),r=n.n(o),l=n(2),c=(n(16),n(8),n(21),n(1)),d=n(27),h=n(25),v=n(9);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var m=null,_={name:"GetSpecies",data:function(){return{dialogVisible:!1,getAwardTask:null,hasTaskBtn:!1,debounceGranted:Object(h.debounce)(this.rewardedSlot,500),popupParam:v.fb,isNotStrength:!1}},mounted:function(){var t=this;document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&t.hasCanRewardsFn()})),this.hasCanRewardsFn(),this.$EventBus.$on("hasCanRewards",this.hasCanRewardsFn),this.$EventBus.$on("userHasCanRewards",this.userHasCanRewards),this.$EventBus.$on("showRewardsModel",this.showRewardsModel)},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.c)("user",["isLoggedIn"])),methods:{hasCanRewardsFn:function(){},userHasCanRewards:function(){},showRewardsModel:function(t){t.call},getZeroTime:function(){return(new Date).getTime()+3e5},initAdVideo:function(){var param={pop1:"/29746187,23160701115/TW_seaart.ai_res_reward_reward",pop2:(m=window.googletag||{cmd:[]}).enums.OutOfPageFormat.REWARDED},t=m.defineOutOfPageSlot(param.pop1,param.pop2).addService(m.pubads());t.setForceSafeFrame(!0),m.pubads().enableAsyncRendering(),m.enableServices(),m.display(t)},rewardedSlot:function(){var t=this,param={from:this.$route.path.includes("eventCenter")?"video_task":"video_pop"};Object(d.yb)(param).then((function(e){var n=t.hasTaskBtn?"ClaimSucceess":"getDoubleReward";t.getAwardTask&&t.getAwardTask(),t.$message.success(t.$t(n)),m.destroySlots()})),this.isNotStrength&&(this.$logEvent("log_actions",{operation:"finish_watch_award_vedio",behavior_info:"on_low_energy_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"on_low_energy_pop",entity_type:"finish_watch_award_vedio"}))},openAdVideo:function(){var t=this,e=r.a.service(),n=this.$route.path.includes("eventCenter");this.initAdVideo(),m.cmd.push((function(){var o=m.pubads();o.addEventListener("rewardedSlotReady",(function r(l){o.removeEventListener("rewardedSlotReady",r),l.makeRewardedVisible(),t.$nextTick((function(){e.close()})),t.$logEvent("log_actions",{operation:"daily_award_vedio_play_success",behavior_info:n?"on_task_vedio_page":"on_all_daily_award_page"}),t.$xyLogEvent({front_operation:"click",entity_name:n?"on_task_vedio_page":"on_all_daily_award_page",entity_type:"daily_award_vedio_play_success"})})),o.addEventListener("rewardedSlotGranted",(function(e){t.debounceGranted();var n=t.$route.path.includes("incentiveTask");t.$logEvent("log_actions",{operation:"finish_watch_daily_award_vedio",behavior_info:"on_daily_award_pop",behavior_info_sub:n?"task_page":"homepage_pop"}),t.$xyLogEvent({front_operation:"click",entity_name:"on_daily_award_pop",entity_type:"finish_watch_daily_award_vedio",obj_info:{behavior_info_sub:n?"task_page":"homepage_pop"}})}));o.addEventListener("rewardedSlotClosed",(function t(){o.removeEventListener("rewardedSlotClosed",t),m.destroySlots()}));o.addEventListener("slotRenderEnded",(function r(l){o.removeEventListener("slotRenderEnded",r),l.isEmpty&&t.$nextTick((function(){e.close(),t.$logEvent("log_actions",{operation:"daily_award_vedio_play_fail",behavior_info:n?"on_task_vedio_page":"on_all_daily_award_page"}),t.$xyLogEvent({front_operation:"click",entity_name:n?"on_task_vedio_page":"on_all_daily_award_page",entity_type:"daily_award_vedio_play_fail"})}))}))}))},doubleRewards:function(){this.dialogVisible=!1;var t={message:this.$t("adloadinHome"),duration:5e3,type:"info"};this.$message(t),this.openAdVideo(),this.$logEvent("log_actions",{operation:"click_double_award",behavior_info:"on_daily_award_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"on_daily_award_pop",entity_type:"click_double_award"}),this.isNotStrength&&(this.$logEvent("log_actions",{operation:"click_get_award",behavior_info:"on_low_energy_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"on_low_energy_pop",entity_type:"click_get_award"}))},getRewardsOne:function(){this.dialogVisible=!1,this.$message.success(this.$t("ClaimSucceess")),this.$logEvent("log_actions",{operation:"click_get_award",behavior_info:"on_daily_award_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"click_get_award",entity_type:"on_daily_award_pop"})}}},y=_,w=(n(5585),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{staticClass:"my-trick-dialog",attrs:{visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"z-index":t.popupParam.advert.z,top:"0",width:"367px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"title-box flex_c"},[e("span",[t._v(t._s(t.isNotStrength?t.$t("notStrength"):t.$t("dayRewards")))])]),t._v(" "),e("div",{staticClass:"content-box",class:t.isNotStrength&&"not-rewards-con"},[t.isNotStrength?e("div",{staticClass:"look-adstrength"},[t._v("\n        "+t._s(t.$t("lookStrength",{num:100}))+"\n      ")]):t._e(),t._v(" "),t.isNotStrength?e("div",{staticClass:"close-btn flex_c_m",on:{click:function(e){t.dialogVisible=!1}}},[e("i",{staticClass:"iconfont icon-close"})]):t._e(),t._v(" "),e("div",{staticClass:"money-num flex_c_m"},[t._v("X100")]),t._v(" "),e("div",{staticClass:"move-btn flex_c_m",attrs:{id:"watchAdBtn"},on:{click:t.doubleRewards}},[e("i",{staticClass:"iconfont icon-a-icon_AIVideoGuide_selected"}),t._v(" "),e("span",[t._v(t._s(t.isNotStrength?t.$t("claimRewards"):t.$t("doubleRewards")))])]),t._v(" "),t.isNotStrength?t._e():e("div",{staticClass:"claim",on:{click:t.getRewardsOne}},[e("span",[t._v(t._s(t.$t("Claim")))])])])])],1)}),[],!1,null,"0d3d6b1f",null);e.default=component.exports},5865:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(20),n(16),n(31),n(24),n(21),n(1)),c=n(39),d=n(9),h=n(462),v=n(126),f=n(127),m=n(78);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"TransferInPageDialog",provide:function(){return{top:this}},props:{dialogZIndex:{type:Number,default:2e3}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,useFree:!1,isUpgrade:!1,btnLabel:"",dotFrom:"",defaultSelected:"",hiddenItems:["free","master"],withCover:!1,countDown:0}},components:{UserDaily:h.a,PaymentForm:v.a,RightPart:f.a},computed:y(y(y(y(y(y({},Object(l.c)("payment",["paymentInfo"])),Object(l.c)("user",["isLoggedIn","isCompanyAccount"])),Object(l.e)("user",["userInfo"])),Object(l.e)("payment",["subThirdType"])),Object(l.c)("unsubscribe",["prevPlanId","in3daysTrial"])),{},{isMonthly:function(){var t,e=this.prevPlanId||(null===(t=this.paymentInfo)||void 0===t?void 0:t.recentPlan);if(e)return e.includes("monthly")},isT1Country:function(){var t;return d.qb.includes(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount}}),destroyed:function(){this.countDown=0},methods:y(y(y({},Object(l.b)("payment",["getSubUrlAndThirdType","getPaymentInfo"])),Object(l.b)("unsubscribe",["getUserStatus"])),{},{show:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,d,h,v,f,m,_,y,w,C;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=(r=t.length>0&&void 0!==t[0]?t[0]:{}).isNewUser,d=void 0!==l&&l,h=r.countDown,v=void 0===h?0:h,f=r.retention,m=void 0!==f&&f,e.countDown=v||0,localStorage.removeItem("newUserSubscriptionInfo"),_=null===(o=e.paymentInfo)||void 0===o?void 0:o.productLevel){n.next=9;break}return n.next=8,e.getPaymentInfo();case 8:_=null===(y=e.paymentInfo)||void 0===y?void 0:y.productLevel;case 9:if(4!==_||!1!==e.isMonthly){n.next=11;break}return n.abrupt("return");case 11:if(null!==e.in3daysTrial){n.next=16;break}return n.next=14,e.getUserStatus();case 14:n.next=17;break;case 16:case 17:if(!e.in3daysTrial){n.next=20;break}return console.log("试用期间不展示"),n.abrupt("return");case 20:e.$nextTick((function(){var t;null===(t=e.$refs)||void 0===t||null===(t=t.userDaily)||void 0===t||t.getGoodsData()})),e.isNewUser=d,d?(e.useFree=!0,e.defaultSelected="standard",e.hiddenItems=["professional","master"],e.withCover=!1):(e.withCover=!0,e.isVip?(e.isUpgrade=!0,w=["free","basic","standard","professional","master"],4===_?(e.hiddenItems=["free","basic","standard","professional"],e.defaultSelected="master"):1===_?(e.hiddenItems=["free","basic"],e.defaultSelected="standard"):(C=e.isMonthly?0:1,e.hiddenItems=w.slice(0,_+C),e.defaultSelected=w[_+1])):(e.hiddenItems=["free","master"],Object(c.g)({type:1}))),e.isShowDialog=!0,e.dotFrom=d?"on_tourist_guide_newuser_popup":e.isVip?"on_tourist_guide_vip_popup":"on_tourist_guide_nonvip_popup",m&&(e.dotFrom="on_tourist_guide_newuser_retention_popup"),e.dotFrom+=e.isT1Country?"_t1":"_non_t1",e.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:e.dotFrom,behavior_info_sub:d?"pop_1":"tourist_guide"}),e.$xyLogEvent({front_operation:"exposure",entity_name:e.dotFrom,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:d?"pop_1":"tourist_guide"}});case 29:case"end":return n.stop()}}),n)})))()},hide:function(){this.isShowDialog=!1,this.step="inGoods"},close:function(){this.isShowDialog=!1,this.step="inGoods",this.withCover=!1,this.hiddenItems=["free","master"],this.$emit("close",m.a.NEW_USER_EXPOSURE)},quitPay:function(){this.step="inGoods"},clickCover:function(){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.dotFrom,behavior_info_sub:"pop_1"}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.dotFrom,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}})},subscriptionNow:function(t){var e=this,n=t.goods_id,o=void 0===n?"":n,r=t.useFree,l=void 0!==r&&r,c=t.btnLabel,d=void 0===c?"":c;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.dotFrom,behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:this.dotFrom,entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}}),!this.isNewUser&&(this.useFree=l),this.btnLabel=d,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=o,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=o,e.step="inPay"}}))}})},C=w,k=(n(5587),n(0)),component=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"transfer-in-page-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1,"z-index":t.dialogZIndex,"data-group":"transfer_in_page_dialog"},on:{"update:visible":function(e){t.isShowDialog=e},close:t.close}},["inGoods"===t.step?e("UserDaily",{ref:"userDaily",attrs:{isNewUser:t.isNewUser,forceFreeTry:t.isNewUser,replaceStandard:t.isNewUser,hideBasicYearlyTotal:t.isNewUser,needReverse:t.isNewUser,defaultSelected:t.defaultSelected,showSelectMethods:!1,hiddenItems:t.hiddenItems,withCover:t.withCover,hideMore:!0,countDown:t.countDown},on:{subscriptionNow:t.subscriptionNow,clickCover:t.clickCover}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,disabledMethods:t.useFree?[1,10]:[],isFreeTry:t.useFree,showFreeTry:!1,initMount:!0,upgrade:t.isUpgrade,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[t.useFree?[e("right-part",{attrs:{showBg:!1,showText:!1,showStep:!0,activation:!1,showAvatar:!0}})]:[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})]],2):t._e()],1)}),[],!1,null,"1065b691",null);e.default=component.exports},5867:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8);var o=n(3),r=n(2),l=(n(20),n(19),n(32),n(65),n(4),n(7),n(26),n(1)),c=n(36);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"DailyStaminaPopup",data:function(){return{topMenuHeight:0,membershipLevels:[{level:0,every_day_temp_coins:130},{level:1,every_day_temp_coins:300},{level:2,every_day_temp_coins:700},{level:3,every_day_temp_coins:2100},{level:4,every_day_temp_coins:3500}],yearList:[],notify:null}},computed:h(h(h({},Object(l.e)("user",["token","userInfo","cdnHost"])),Object(l.e)("payment",["paymentInfo"])),{},{currentSubProductInfo:function(){var t=this.paymentInfo,e=t.productLevel;return t.svipActiveState?this.membershipLevels.find((function(t){return t.level===e})):this.membershipLevels.find((function(t){return 0===t.level}))},dailyStamina:function(){return this.currentSubProductInfo&&this.currentSubProductInfo.every_day_temp_coins},isMasterLevel:function(){var t;return 4===(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)},paymentData:function(){var t=this.yearList||[];return Array.isArray(t)&&0!==t.length?t[0]:null},priceText:function(){var t,e,n,o;if(!this.paymentData)return"";var r=null!==(t=null===(e=this.paymentData)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price)&&void 0!==t?t:.13,l=null!==(n=null===(o=this.paymentData)||void 0===o||null===(o=o.local_price_web)||void 0===o?void 0:o.currency)&&void 0!==n?n:"$",c=r?(r/30).toFixed(2):"0.13";return"".concat(this.$t("daily_stamina_popup_desc",{unit:l,price:c})," &gt;&gt;&gt;")}}),watch:{token:function(t){t||this.handleClose()}},created:function(){this.handleSubscriptionData()},methods:h(h({},Object(l.b)("payment",["getSubscriptionList"])),{},{show:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.handleSubscriptionData();case 2:t.updateTopMenuHeight(),window.addEventListener("resize",t.updateTopMenuHeight),n=t.getUpgradeDescHtml(),o=t.getMessageHtml(n),t.notify=t.$notify({customClass:"fcm-in-page-notification daily-stamina-page-notification",dangerouslyUseHTMLString:!0,position:"top-right",duration:5e3,showClose:!0,message:o,offset:t.topMenuHeight||100,onClose:function(){t.$emit("close")}}),t.bindUpgradeHandler(),t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"energy_recovery_popup",behavior_info_sub:"pop_1"}),t.$xyLogEvent({front_operation:"exposure",entity_name:"energy_recovery_popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}),Object(c.markTempCoinsPopup)();case 11:case"end":return e.stop()}}),e)})))()},getUpgradeDescHtml:function(){return this.isMasterLevel||!this.priceText?"":'<div class="daily-stamina-popup-desc" onclick="window.__handleDailyStaminaUpgradeMall && window.__handleDailyStaminaUpgradeMall()">'.concat(this.priceText,"</div>")},getMessageHtml:function(t){return'\n        <div class="daily-stamina-popup-content">\n          <img class="daily-stamina-popup-icon" src="https://image.cdn2.seaart.me/20250522/ed2691bd-30b7-4168-9e96-05738061dff2_high.webp" />\n          <div class="daily-stamina-popup-texts">\n            <div class="daily-stamina-popup-title">\n              '.concat(this.$t("daily_stamina_popup_title"),'：<span class="daily-stamina-popup-stamina">').concat(this.dailyStamina,"</span>\n            </div>\n            ").concat(t,"\n          </div>\n        </div>\n      ")},bindUpgradeHandler:function(){var t=this;window.__handleDailyStaminaUpgradeMall=function(){t.handleUpgrade()}},updateTopMenuHeight:function(){var t=document.querySelector(".top-menu");if(t){var rect=t.getBoundingClientRect();this.topMenuHeight=rect.height+rect.top}},handleUpgrade:function(){var t=this;this.$router&&this.$router.push("/mall");var e=setTimeout((function(){t.handleClose(),clearTimeout(e)}),500);this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"energy_recovery_popup",behavior_info_sub:"pop_2"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"energy_recovery_popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2"}})},hide:function(){this.handleClose()},close:function(){this.handleClose()},handleClose:function(){this.notify.close(),this.notify=null,this.$emit("close")},handleSubscriptionData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSubscriptionList();case 3:n=e.sent,o=n.data,r=((data=void 0===o?{}:o)||{}).year,l=void 0===r?[]:r,t.membershipLevels=[{level:0,every_day_temp_coins:data.free_daily_coins}],l.forEach((function(e){t.membershipLevels.push(h({},e))})),t.yearList=l||[],e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Failed to fetch subscription data:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()}}),beforeDestroy:function(){window.removeEventListener("resize",this.updateTopMenuHeight)}},f=(n(5589),n(0)),component=Object(f.a)(v,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);e.default=component.exports},5868:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(8),n(7);var o=n(14),r=n(3),l=n(2),c=(n(19),n(6),n(4),n(20),n(1)),d=n(36),h=n(78),v=n(555),f=n.n(v),m=n(779),_=n.n(m);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"LikeCollectDialog",props:{dialogData:{type:Object,default:{}}},data:function(){return{hotPopupCntArr:[20,50,100,500],totalHotPopupCnt:20,imgUrl:"https://image.cdn2.seaart.me/static/upload/20250606/01ae3513-f0d0-4266-9d85-fd5ab5d2f33f.webp",topMenuHeight:0,notify:null}},computed:w({},Object(c.e)("user",["userInfo"])),methods:w(w({},Object(c.b)("payment",["getSubscriptionList"])),{},{show:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.setTotalHotPopupCnt(),!(t.totalHotPopupCnt<t.dialogData.hot_popup_cnt||-1===t.dialogData.hot_popup_cnt||0===t.dialogData.hot_popup_cnt)&&t.dialogData.hot_popup_cnt){e.next=4;break}return t.$emit("close",h.a.HOT_POPUP),e.abrupt("return",!1);case 4:t.updateTopMenuHeight(),window.addEventListener("resize",t.updateTopMenuHeight),n=t.getMessageHtml(),t.notify=t.$notify({customClass:"like-collect like-collect-notification",dangerouslyUseHTMLString:!0,position:"top-right",duration:5e3,showClose:!0,message:n,offset:t.topMenuHeight||100,onClose:function(){t.$emit("close",h.a.HOT_POPUP)}}),t.bindUpgradeHandler(),t.setPopupStatus();case 10:case"end":return e.stop()}}),e)})))()},setTotalHotPopupCnt:function(){var t=this.hotPopupCntArr,e=this.userInfo.colleted_cnt;this.totalHotPopupCnt=Math.max.apply(Math,Object(o.a)(t.filter((function(t){return e>=t}))))},setPopupStatus:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.getPopupStatus)({hot_popup_cnt:t.userInfo.colleted_cnt});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))()},getMessageHtml:function(){var t=this.$t("good_news_title",{icon:'<img src="'.concat(f.a,'" />'),num:this.totalHotPopupCnt}),e=this.$t("good_news_subtitle",{icon:'<img src="'.concat(_.a,'" />')});return'\n        <div class="like-collect-notification-content">\n          <div class="title">'.concat(t,'</div>\n          <div class="subtitle">').concat(e,'</div>\n          <img class="pic" src="').concat(this.imgUrl,'" />\n          <div class="generate-btn" onclick="window.__handleLikeCollectGenerate && window.__handleLikeCollectGenerate()">').concat(this.$t("go_to_post"),"</div>\n        </div>\n      ")},bindUpgradeHandler:function(){var t=this;window.__handleLikeCollectGenerate=function(){t.handleGenerate()}},updateTopMenuHeight:function(){var t=document.querySelector(".top-menu");if(t){var rect=t.getBoundingClientRect();this.topMenuHeight=rect.height+rect.top}},handleGenerate:function(){this.handleClose(),this.$EventBus.$emit("openContribution")},handleClose:function(){this.notify.close(),this.notify=null,this.$emit("close",h.a.HOT_POPUP)}}),beforeDestroy:function(){window.removeEventListener("resize",this.updateTopMenuHeight)}},k=(n(5594),n(0)),component=Object(k.a)(C,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);e.default=component.exports},5870:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(3),r=n(2),l=(n(19),n(22),n(20),n(1)),c=n(36),d=n(81),h=n(78),v=n(555),f=n.n(v);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"AwardDialog",props:{dialogData:{type:Array,default:[]}},data:function(){return{activityName:"",imgUrl:"https://image.cdn2.seaart.me/static/upload/20250606/01ae3513-f0d0-4266-9d85-fd5ab5d2f33f.webp",topMenuHeight:0,notify:null}},computed:_(_({},Object(l.e)("user",["userInfo"])),{},{activityData:function(){return this.dialogData[0]||{}}}),methods:_(_({},Object(l.b)("payment",["getSubscriptionList"])),{},{getDailyActivityName:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={date:t.activityData.activity_id},e.next=3,Object(d.l)(o);case 3:return r=e.sent,e.abrupt("return",(null==r||null===(n=r.data)||void 0===n||null===(n=n.theme_activity)||void 0===n?void 0:n.tag)||t.activityData.activity_name);case 5:case"end":return e.stop()}}),e)})))()},getCreativeContestName:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={activity_id:t.activityData.activity_id,activity_type:t.activityData.activity_type},e.next=3,Object(d.l)(o);case 3:return r=e.sent,e.abrupt("return",(null==r||null===(n=r.data)||void 0===n||null===(n=n.theme_activity)||void 0===n?void 0:n.title)||t.activityData.activity_id);case 5:case"end":return e.stop()}}),e)})))()},show:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.updateTopMenuHeight(),window.addEventListener("resize",t.updateTopMenuHeight),0!==t.activityData.activity_type){e.next=8;break}return e.next=5,t.getDailyActivityName();case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,t.getCreativeContestName();case 10:e.t0=e.sent;case 11:t.activityName=e.t0,n=t.getMessageHtml(),t.notify=t.$notify({customClass:"daily-challenge __award-daily-challenge-notification",dangerouslyUseHTMLString:!0,position:"top-right",duration:1e4,showClose:!0,message:n,offset:t.topMenuHeight||100,onClose:function(){t.$emit("close",h.a.AWARD)}}),t.bindUpgradeHandler(),t.setPopupStatus();case 16:case"end":return e.stop()}}),e)})))()},setPopupStatus:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.setActivityAwardPopupStatus)({activity_id_list:t.dialogData.map((function(t){return t.activity_id}))});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))()},getMessageHtml:function(){var t=this.$t("title_win_award"),e=this.activityName,n=this.$t("subtitle_win_award");return'\n        <div class="daily-challenge-notification-content">\n          <div class="title"><img src="'.concat(f.a,'" />').concat(t,'</div>\n          <div class="activity-name">').concat(e,'</div>\n          <div class="subtitle">').concat(n,'</div>\n          <img class="pic" src="').concat(this.imgUrl,'" />\n          <div class="generate-btn" onclick="window.__handleAwardGenerate && window.__handleAwardGenerate()">').concat(this.$t("claim_award"),"</div>\n        </div>\n      ")},bindUpgradeHandler:function(){var t=this;window.__handleAwardGenerate=function(){t.handleGenerate()}},updateTopMenuHeight:function(){var t=document.querySelector(".top-menu");if(t){var rect=t.getBoundingClientRect();this.topMenuHeight=rect.height+rect.top}},handleGenerate:function(){var t=this.activityData,e=t.activity_type,path="";0===e?path="/event-center/daily/"+t.activity_id:1===e&&(path="/event-center/activity/"+t.activity_id);var n=this.localePath(path),o=this.$router.resolve({path:n});window.open(o.href,"_blank"),this.handleClose()},handleClose:function(){this.notify.close(),this.notify=null,this.$emit("close",h.a.AWARD)}}),beforeDestroy:function(){window.removeEventListener("resize",this.updateTopMenuHeight),window.__handleAwardGenerate=null}},w=(n(5596),n(0)),component=Object(w.a)(y,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);e.default=component.exports},5871:function(t,e,n){"use strict";n.r(e);n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(14),r=n(2),l=(n(19),n(16),n(4),n(43),n(21),n(26),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"ActivationDialogInPage",computed:d(d(d(d({},Object(l.c)("user",["isLoggedIn"])),Object(l.e)("creation",["generateViewShow"])),Object(l.e)("user",["isLoginPopupOpen"])),Object(l.e)("payment",["paymentGrayInfo"])),data:function(){return{dialogVisible:!1,showCloseBtn:!1,countdownTimer:null,currentCountdownRoute:"",features:[{name:"imageGeneration",svip:this.$t("fullAccess"),basic:this.$t("limitedAccess")},{name:"videoGeneration",svip:!0,basic:!1},{name:"unlimitedCreation",svip:!0,basic:!1},{name:"fastQueue",svip:!0,basic:!1},{name:"qualityMode",svip:!0,basic:!1},{name:"runTenTasks",svip:!0,basic:!1},{name:"loraTrainingPriority",svip:!0,basic:!1},{name:"permanentHistory",svip:!0,basic:!1}]}},methods:{checkRouteCondition:function(){var t,e,n,r=this.$route.name,l=this.$route.path,c=["recommendPage","workFlowAppDetail","aiChat","ModelDetail","ArtWorkDetail","ArticleDetail"].concat(Object(o.a)(null!==(t=this.paymentGrayInfo)&&void 0!==t&&t.tourist_trial_popup?[]:["GeneratePage"])),d=["/workFlowAppDetail","/ai-tools","/aiChat","/explore/detail","/models/detail","/artWorkDetail","/articleDetail","/cyberPubPage"].concat(Object(o.a)(null!==(e=this.paymentGrayInfo)&&void 0!==e&&e.tourist_trial_popup?[]:["/create"])),h=c.some((function(t){return r&&r.includes(t)})),v=d.some((function(path){return l&&l.includes(path)}));return r&&r.includes("recommendPage")&&this.generateViewShow?!(null!==(n=this.paymentGrayInfo)&&void 0!==n&&n.tourist_trial_popup):h||v},shouldShowCloseButtonImmediately:function(){var t=this;return["ModelDetail","ArtWorkDetail","ExploreDetail","ArticleDetail","workFlowAppDetail","aiChat"].some((function(e){return t.$route.name&&t.$route.name.includes(e)}))},checkTimeLimit:function(){var t=localStorage.getItem("privilegeDialogLastShowTime");return!!t&&(Date.now()-parseInt(t))/36e5<24},showCloseButton:function(){var t=this;if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this.showCloseBtn=!0;else var e=setTimeout((function(){t.showCloseBtn=!0,clearTimeout(e)}),3e3)},logShowAction:function(){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_tourist_guide_pop"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"on_tourist_guide_pop",entity_type:"to_pay_pop_show"}),localStorage.setItem("privilegeDialogLastShowTime",Date.now().toString())},startCountdown:function(){var t=this;if(!this.dialogVisible&&this.currentCountdownRoute!==this.$route.name&&!this.isLoginPopupOpen){this.clearCountdown(),this.currentCountdownRoute=this.$route.name;this.generateViewShow;this.countdownTimer=setTimeout((function(){t.generateViewShow;!t.isLoggedIn&&!t.isLoginPopupOpen&&(t.dialogVisible=!0,t.logShowAction(),t.showCloseButton(t.shouldShowCloseButtonImmediately())),t.countdownTimer=null,t.currentCountdownRoute=""}),2e4)}},clearCountdown:function(){this.countdownTimer&&(clearTimeout(this.countdownTimer),this.countdownTimer=null)},show:function(data){if(console.log("[ActivationDialogInPage.vue] show:",data),!this.dialogVisible){if(!this.checkTimeLimit())return this.checkRouteCondition()?void this.startCountdown():(console.log("[ActivationDialogInPage.vue] 当前路由不在允许显示弹窗的列表中:",this.$route.name,this.$route.path),void this.clearCountdown());this.clearCountdown()}},hide:function(){this.showCloseBtn=!1,this.dialogVisible=!1,this.clearCountdown()},handleClose:function(){this.$logEvent("log_actions",{operation:"click_x_button",behavior_info:"on_tourist_guide_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"on_tourist_guide_pop",entity_type:"click_x_button"}),this.hide()},handleClaim:function(){var t={startTime:Date.now(),status:"active"};localStorage.setItem("newUserSubscriptionInfo",JSON.stringify(t)),this.$logEvent("log_actions",{operation:"click_now_for_free",behavior_info:"on_tourist_guide_pop"}),this.$xyLogEvent({front_operation:"click",entity_name:"on_tourist_guide_pop",entity_type:"click_now_for_free"}),this.$EventBus.$emit("openLoginDialog"),this.hide()}},beforeDestroy:function(){this.clearCountdown()}},v=h,f=(n(5610),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,width:"1000px","show-close":!1,"custom-class":"new-user-privilege-dialog","close-on-click-modal":!1,"data-group":"on_tourist_guide_pop"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.hide}},[e("div",{staticClass:"dialog-content"},[t.showCloseBtn?e("i",{staticClass:"el-icon-close close-btn",on:{click:t.handleClose}}):t._e(),t._v(" "),e("div",{staticClass:"header"},[e("div",{staticClass:"wave-bg"},[e("span",{staticClass:"wave-text"},[t._v(t._s(t.$t("congratulations")))])]),t._v(" "),e("div",{staticClass:"subtitle",domProps:{innerHTML:t._s(t.$t("freeTrialOffer"))}})]),t._v(" "),e("div",{staticClass:"comparison-table"},[e("div",{staticClass:"features-column"},[e("div",{staticClass:"column-title"},[t._v(t._s(t.$t("keyFeatures")))]),t._v(" "),t._l(t.features,(function(n,o){return e("div",{key:o,staticClass:"feature-item feature-name"},[t._v("\n          "+t._s(t.$t(n.name))+"\n        ")])}))],2),t._v(" "),e("div",{staticClass:"svip-column"},[e("div",{staticClass:"column-title flex_c_m"},[e("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250120/d24b07eb-fa21-4547-95ff-c8be2038f59f.png",alt:"vip-icon"}}),t._v("\n          "+t._s(t.$t("seaArtSvip"))+"\n        ")]),t._v(" "),t._l(t.features,(function(n,o){return e("div",{key:o,staticClass:"feature-item"},["boolean"==typeof n.svip?[e("i",{class:[n.svip?"el-icon-check":"el-icon-close","status-icon",{"is-true":n.svip}]})]:[t._v("\n            "+t._s(n.svip)+"\n          ")]],2)}))],2),t._v(" "),e("div",{staticClass:"basic-column"},[e("div",{staticClass:"column-title"},[t._v(t._s(t.$t("seaArtBasic")))]),t._v(" "),t._l(t.features,(function(n,o){return e("div",{key:o,staticClass:"feature-item"},["boolean"==typeof n.basic?[e("i",{class:[n.basic?"el-icon-check":"el-icon-close","status-icon",{"is-true":n.basic}]})]:[t._v("\n            "+t._s(n.basic)+"\n          ")]],2)}))],2)]),t._v(" "),e("el-button",{staticClass:"claim-button",attrs:{type:"primary"},on:{click:t.handleClaim}},[t._v(" "+t._s(t.$t("StartFreeTrial"))+" ")])],1)])}),[],!1,null,"2a2d6c6e",null);e.default=component.exports},5872:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8);var o=n(2),r=(n(65),n(4),n(43),n(77),n(7),n(26),n(1)),l=n(87),c=n(607),d=n(126),h=n(127),v=n(305);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"VipComputingDialogMini",provide:function(){return{top:this}},components:{NumberTransition:c.default,PaymentForm:d.a,RightPart:h.a},data:function(){return{shouldShowContainer:!1,isDialogVisible:!1,isRemoved:!1,isClosing:!1,closeTimers:[],closingStyle:{},goodsData:{data:[]},quantity:1,selectedItem:null,btnLoading:!1,isFromVideo:!1,countdownTimer:null,minutes:"04",seconds:"58",step:"inGoods",goodsId:"",defaultThirdType:0,dotFrom:"svip_calculate_retain_Popup",dialogZIndex:2e3}},computed:m(m(m(m({},Object(r.e)("payment",["subThirdType","paymentInfo","retentionPopupEndTime","defaultCountdown"])),Object(r.c)("user",["userInfo"])),Object(r.e)("user",["cdnHost"])),{},{isCountdownValid:function(){return this.retentionPopupEndTime>Date.now()},baseCredits:function(){return this.selectedItem?(this.selectedItem.calculate_coins-this.selectedItem.give_calculate_coins)*this.selectedItem.quantity:0},bonusCredits:function(){return this.selectedItem?this.selectedItem.give_calculate_coins*this.selectedItem.quantity:0},totalCredits:function(){return this.selectedItem?this.selectedItem.calculate_coins*this.selectedItem.quantity:0},videosCount:function(){return this.selectedItem?Math.floor(this.selectedItem.calculate_coins*this.quantity/100):0}}),mounted:function(){var t=this;this.initRetentionPopupTime().then((function(e){e.valid?t.startCountdown():t.setDefaultCountdown()}))},beforeDestroy:function(){this.countdownTimer&&clearInterval(this.countdownTimer),this.closeTimers.forEach((function(t){t&&clearTimeout(t)})),this.closeTimers=[]},methods:m(m(m({},Object(r.b)("payment",["getSubUrlAndThirdType","initRetentionPopupTime","getRetentionPopupTime","setRetentionPopupTime","clearRetentionPopupTime","updateStoragePopupState"])),Object(r.b)("user",["getAccountInfo"])),{},{show:function(){var t=this,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.updateStoragePopupState("VipComputingDialogMini"),this.isFromVideo=(null==data?void 0:data.fromVideo)||this.isFromVideo||!1,this.getProductList(),this.dialogZIndex=v.PopupManager.nextZIndex(),this.closeTimers.forEach((function(t){t&&clearTimeout(t)})),this.closeTimers=[],this.isRemoved=!1,this.isClosing=!1,this.closingStyle={},this.shouldShowContainer=!0,this.$nextTick((function(){var e=document.querySelector(".vip-computing-dialog-mini-container");e&&(e.style.zIndex=t.dialogZIndex),requestAnimationFrame((function(){t.isDialogVisible=!0,t.step="inGoods"}))})),this.isCountdownValid?this.startCountdown():this.getRetentionPopupTime().then((function(e){e.valid?t.startCountdown():t.setDefaultCountdown()})),this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"svip_calculate_retain_Popup",behavior_info_sub:"pop_1",purchase_amount:1}),this.$xyLogEvent({front_operation:"exposure",entity_name:"svip_calculate_retain_Popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1",purchase_amount:1}})},hide:function(){this.handleClose()},close:function(){this.handleClose()},handleClose:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isClosing&&this.shouldShowContainer){if(e)return this.closeTimers.forEach((function(t){t&&clearTimeout(t)})),this.closeTimers=[],this.isRemoved=!0,this.isDialogVisible=!1,this.shouldShowContainer=!1,void this.resetState();this.isClosing=!0,this.closeTimers.forEach((function(t){t&&clearTimeout(t)})),this.closeTimers=[],this.closingStyle={transform:"scale(0.1) translate(250%, 150%)",opacity:"0",pointerEvents:"none"};var n=setTimeout((function(){t.isRemoved=!0;var e=setTimeout((function(){t.isDialogVisible=!1;var e=setTimeout((function(){t.shouldShowContainer=!1,t.resetState()}),100);t.closeTimers.push(e)}),100);t.closeTimers.push(e)}),550);this.closeTimers.push(n)}},getProductList:function(){var t=this;Object(l.f)({type:"video_calculate"}).then((function(e){var n=e.data.calculate;if(n&&n.length>0){var o,r=(null===(o=t.paymentInfo)||void 0===o?void 0:o.totalRecharge)||0,l=1;r>=1e3?l=5:r>=300?l=4:r>=100?l=3:r>=50&&(l=2),l>=n.length&&(l=n.length-1),t.selectedItem=m(m({},n[l]),{},{quantity:t.quantity,btnLoad:!1})}})).catch((function(t){console.error("Error getting goods list:",t)}))},handleQuantityChange:function(t){this.quantity=t,this.selectedItem&&(this.selectedItem.quantity=t)},getPrice:function(t){var e,n;if(!t)return"";var o=null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency,r=null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price;return o+(parseFloat(r)*this.quantity).toFixed(2)||""},setDefaultCountdown:function(){var t=this,e=Date.now()+60*this.defaultCountdown*1e3;this.setRetentionPopupTime(e).then((function(){t.startCountdown()}))},startCountdown:function(){var t=this;this.countdownTimer&&clearInterval(this.countdownTimer),this.updateCountdown(),this.countdownTimer=setInterval((function(){t.updateCountdown()}),1e3)},updateCountdown:function(){if(!this.retentionPopupEndTime||this.retentionPopupEndTime<=Date.now())return this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null),this.minutes="00",this.seconds="00",void this.clearRetentionPopupTime();var t=this.retentionPopupEndTime-Date.now(),e=Math.max(0,Math.floor(t/1e3)),n=Math.floor(e/60),o=e%60;this.minutes=n.toString().padStart(2,"0"),this.seconds=o.toString().padStart(2,"0")},subscriptionNow:function(t){var e=this;t&&(this.btnLoading=!0,this.subThirdType?this.proceedToPayment(t,this.subThirdType):this.getSubUrlAndThirdType().then((function(n){var o,r;1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)?e.proceedToPayment(t,null===(r=n.data)||void 0===r?void 0:r.third_type):e.btnLoading=!1})).catch((function(){e.btnLoading=!1})))},proceedToPayment:function(t,e){this.goodsId=t,this.defaultThirdType=e,this.step="inPay",this.btnLoading=!1,this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"svip_calculate_retain_Popup",behavior_info_sub:"pop_2",purchase_amount:this.quantity||1}),this.$xyLogEvent({front_operation:"exposure",entity_name:"svip_calculate_retain_Popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_2",purchase_amount:this.quantity||1}})},quitPay:function(){this.step="inGoods"},handlePaymentSuccess:function(){this.handleClose(!0)},resetState:function(){this.isClosing=!1,this.isRemoved=!1,this.closingStyle={},this.step="inGoods",this.btnLoading=!1,this.goodsId="",this.defaultThirdType=0,this.quantity=1,this.getAccountInfo()}})},y=_,w=(n(5612),n(0)),component=Object(w.a)(y,(function(){var t,e,o,r,l,c=this,d=c._self._c;return c.shouldShowContainer?d("div",{staticClass:"vip-computing-dialog-mini-container",style:{zIndex:c.dialogZIndex},attrs:{"data-enent":"vip_computing_dialog_mini_container_dialog"}},[d("div",{staticClass:"vip-computing-dialog-mini flex-center",class:{"dialog-visible":c.isDialogVisible}},["inGoods"!==c.step||c.isRemoved?c._e():d("div",{class:["dialog-content",{"closing-animation":c.isClosing}],style:c.closingStyle},[d("div",{staticClass:"close-btn",on:{click:c.handleClose}},[d("i",{staticClass:"el-icon-close"})]),c._v(" "),d("div",{staticClass:"top-section"},[d("div",{staticClass:"bonus-title"},[d("div",{staticClass:"title"},[c._v(c._s(c.$t("BonusBoosted")))]),c._v(" "),d("div",{staticClass:"subtitle"},[c._v(c._s(c.$t("oneTimeTitle3")))])]),c._v(" "),d("div",{staticClass:"goods-card"},[null!==(t=c.selectedItem)&&void 0!==t&&t.web_give_ratio?d("div",{staticClass:"discount-badge"},[c._v("+"+c._s(null===(e=c.selectedItem)||void 0===e?void 0:e.web_give_ratio)+"%")]):c._e(),c._v(" "),d("div",{staticClass:"goods-info"},[d("div",{staticClass:"num-detail"},[d("img",{staticClass:"credit-icon",attrs:{src:n(169),alt:"credit"}}),c._v(" "),d("span",{staticClass:"num-1"},[c._v(c._s(c.baseCredits))]),c._v(" "),d("span",[c._v("+")]),c._v(" "),d("span",{staticClass:"num-2"},[c._v(c._s(c.bonusCredits))]),c._v(" "),null!==(o=c.selectedItem)&&void 0!==o&&o.web_old_give_ratio?d("div",{staticClass:"boost-badge"},[c._v("\n                "+c._s(null===(r=c.selectedItem)||void 0===r?void 0:r.web_old_give_ratio)+"%\n              ")]):c._e(),c._v(" "),null!==(l=c.selectedItem)&&void 0!==l&&l.web_give_ratio?d("img",{staticClass:"discount-arrow",attrs:{src:n(969)}}):c._e()])]),c._v(" "),d("div",{staticClass:"total-amount"},[d("div",{staticClass:"amount"},[c._v("\n              "+c._s(c.totalCredits)+"\n            ")]),c._v(" "),d("div",{staticClass:"total-label"},[c._v(c._s(c.$t("Total")))])]),c._v(" "),d("div",{staticClass:"quantity-control"},[d("el-input-number",{attrs:{min:1,max:99,size:"medium"},on:{change:c.handleQuantityChange},model:{value:c.quantity,callback:function(t){c.quantity=t},expression:"quantity"}})],1)])]),c._v(" "),d("div",{staticClass:"bottom-section"},[d("div",{staticClass:"timer-popup"},[d("span",{staticClass:"timer-text"},[c._v(c._s(c.$t("LimitedTimeOffer")))]),c._v(" "),d("div",{staticClass:"timer-blocks"},[d("div",{staticClass:"timer-block"},[c._v(c._s(c.minutes))]),c._v(" "),d("span",{staticClass:"timer-separator"},[c._v(":")]),c._v(" "),d("div",{staticClass:"timer-block"},[c._v(c._s(c.seconds))])])]),c._v(" "),d("el-button",{staticClass:"payment-button",attrs:{loading:c.btnLoading},on:{click:function(t){var e;return c.subscriptionNow(null===(e=c.selectedItem)||void 0===e?void 0:e.cp_product_id)}}},[d("span",{staticClass:"price"},[c._v(c._s(c.getPrice(c.selectedItem)))]),c._v(" "),c.isFromVideo?d("div",{staticClass:"videos-count"},[c._v("≈"+c._s(c.videosCount)+" "+c._s(c.$t("SeaartLiteVideos")))]):c._e()])],1)]),c._v(" "),"inPay"!==c.step||c.isRemoved?c._e():d("PaymentForm",{attrs:{defaultThirdType:c.defaultThirdType,initMount:!0,upgrade:!1,goodsId:c.goodsId,purchParams:{quantity:c.quantity},isSubscription:!1,apiParams:{type:"video_calculate"}},on:{"in-pay-back":c.quitPay,"pay-success":c.handlePaymentSuccess}},[d("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1)],1)]):c._e()}),[],!1,null,"5f9f08e4",null);e.default=component.exports},5874:function(t,e,n){"use strict";n.r(e);n(11),n(12),n(13),n(7);var o=n(14),r=n(3),l=n(2),c=(n(20),n(19),n(6),n(32),n(16),n(122),n(65),n(8),n(4),n(43),n(21),n(77),n(26),n(1)),d=n(305),h=n(87);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"AwaitingOrderDialog",provide:function(){return{top:this}},components:{},data:function(){return{loading:!1,shouldShowContainer:!1,isDialogVisible:!1,countdownTimer:null,minutes:"00",seconds:"00",milliseconds:"00",dialogZIndex:2e3,orderInfo:null,currentCycle:"",subscriptionList:{},calculateList:[],selectedGoodsInfo:{},pageFrom:"",sourceDialog:"",paymentFormProps:{},cycleList:[],localCountdownEndTime:null,currentLevelDiscounts:{},dotFrom:""}},computed:f(f({},Object(c.e)("payment",["paymentInfo","awaitingOrderPoppEndTime","defaultAwaitingOrderCountdown","halfDiscountCountdown","paymentGrayInfo"])),{},{getLabel:function(){var t=this;return function(e){return e?t.$t({1:"ToB_beginnerPlan",2:"StandardPlan",3:"ToB_professionalPlan",4:"MasterPlan"}[e]):""}},inSale:function(){var t,e;return(null===(t=this.selectedGoodsInfo)||void 0===t?void 0:t.discount)||(null===(e=this.selectedGoodsInfo)||void 0===e?void 0:e.is_first)},countdownTimeTxt:function(){return this.minutes+":"+this.seconds+":"+this.milliseconds},subscriptionGoodsNameTxt:function(){var t,e=this.selectedGoodsInfo;if(!e)return"";var n=this.getLabel(e.level)||"",o=null!==(t=e.every_day_temp_coins)&&void 0!==t?t:0,r=this.$t("tempCoins"),l=this.$t("Day");return"".concat(n,"SVIP (").concat(o).concat(r,"/").concat(l,")")},creditGoodsNameTxt:function(){var t,e,n,o=this.selectedGoodsInfo,r=this.orderInfo;if(!o||!r)return"";var l=null!==(t=o.calculate_coins)&&void 0!==t?t:0,c=null!==(e=o.give_calculate_coins)&&void 0!==e?e:0,d=null!==(n=r.quantity)&&void 0!==n?n:1,h=this.$t("coin"),v=this.$t("awaiting_order_dialog_lb11",{num:c}),f="";c>0&&(f="（".concat(v,"）"));var m="* ".concat(d);return"".concat(h,"+").concat(l).concat(f).concat(m)},totalPriceOld:function(){var t,e=null===(t=this.selectedGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!e)return"";var n="year"===this.currentCycle?(12*(null==e?void 0:e.price_old)).toFixed(2):null==e?void 0:e.price_old;return"".concat(null==e?void 0:e.currency).concat(n,"/").concat(this.getCycleTextTotal(this.currentCycle))},totalPrice:function(){var t,e=null===(t=this.selectedGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!e)return"";var n="year"===this.currentCycle?(12*(null==e?void 0:e.price)).toFixed(2):null==e?void 0:e.price;return"".concat(null==e?void 0:e.currency).concat(n,"/").concat(this.getCycleTextTotal(this.currentCycle))},getCreditTPrice:function(){var t,e=null===(t=this.selectedGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!e)return"-";var n=null==e?void 0:e.currency,o=(null==e?void 0:e.price)*this.orderInfo.quantity;return n+parseFloat(o).toFixed(2)},getTotalCredits:function(){var t,e;return 0===Object.keys(this.selectedGoodsInfo).length?"-":((null===(t=this.selectedGoodsInfo)||void 0===t?void 0:t.calculate_coins)-(null===(e=this.selectedGoodsInfo)||void 0===e?void 0:e.give_calculate_coins))*this.orderInfo.quantity}}),mounted:function(){window.addEventListener("beforeunload",this.handlePageRefresh)},beforeDestroy:function(){this.countdownTimer&&clearInterval(this.countdownTimer),window.removeEventListener("beforeunload",this.handlePageRefresh)},methods:f(f(f({},Object(c.b)("payment",["setAwaitingOrderPoppTime","clearAwaitingOrderPoppTime","getSubscriptionList","updateStoragePopupState","setPopupSource","getCalculateList"])),Object(c.d)("payment",["SET_AWAITING_ORDER_HAS_LOCAL_INFO"])),{},{show:function(){var t=this,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.orderInfo=f(f({},data),{},{goodsId:(null==data?void 0:data.cp_product_id)||(null==data?void 0:data.id),type:null!=data&&data.cp_product_id?"Credit":"Subscription"}),this.orderInfo.goodsId&&(this.currentCycle=this.getGoodsCycleById(this.orderInfo.goodsId),this.pageFrom=(null==data?void 0:data.pageFrom)||"",this.dotFrom=(null==data?void 0:data.dotFrom)||"",this.sourceDialog=(null==data?void 0:data.sourceDialog)||"",this.paymentFormProps=(null==data?void 0:data.paymentFormProps)||{},this.getGoodsListData(),this.dialogZIndex=d.PopupManager.nextZIndex(),this.shouldShowContainer=!0,this.$nextTick((function(){var e=document.querySelector(".awaiting-order-dialog-container");e&&(e.style.zIndex=t.dialogZIndex),requestAnimationFrame((function(){t.isDialogVisible=!0}))})),this.setDefaultCountdown(),document.body.style.overflow="hidden",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"cancel_pay_loading_popup",behavior_info_sub:"pop_1"}),this.$xyLogEvent({front_operation:"exposure",entity_name:"cancel_pay_loading_popup",entity_type:"to_pay_pop_show",obj_info:{behavior_info_sub:"pop_1"}}))},getGoodsListData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,v,f,m,_,y,w,C,k,O,x,T,S,D,P,I,$;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading=!0,n=t.orderInfo,o=n.goodsId,"Subscription"!==(r=n.type)){e.next=16;break}return c="not_vip_calculate"===t.dotFrom?h.n:t.getSubscriptionList,e.next=6,c();case 6:d=e.sent,v=d.data,m=(f=(void 0===v?{}:v)||{}).month,_=void 0===m?[]:m,y=f.year,w=void 0===y?[]:y,C=f.week,k=void 0===C?[]:C,t.subscriptionList={month:_,year:w,week:k},t.selectedGoodsInfo=t.subscriptionList[t.currentCycle].find((function(t){return t.id===o})),t.getCycleList(),null!==(l=t.selectedGoodsInfo)&&void 0!==l&&l.level&&(S=t.selectedGoodsInfo.level,t.currentLevelDiscounts={week:(null===(O=k.find((function(t){return t.level===S})))||void 0===O?void 0:O.discount)||0,month:(null===(x=_.find((function(t){return t.level===S})))||void 0===x?void 0:x.discount)||0,year:(null===(T=w.find((function(t){return t.level===S})))||void 0===T?void 0:T.discount)||0}),e.next=25;break;case 16:if("Credit"!==r){e.next=25;break}return e.next=19,t.getCalculateList();case 19:D=e.sent,P=D.data,I=((void 0===P?{}:P)||{}).calculate,$=void 0===I?[]:I,t.calculateList=$,t.selectedGoodsInfo=t.calculateList.find((function(t){return t.cp_product_id===o}));case 25:t.loading=!1;case 26:case"end":return e.stop()}}),e)})))()},hide:function(){this.handleClose()},close:function(){this.handleClose()},handleClose:function(){document.body.style.overflow="",this.isDialogVisible=!1,this.shouldShowContainer=!1,this.orderInfo=null,this.isExpanded=!1},handleMultipleClose:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("AwaitingOrderTimerButton"===t.pageFrom){e.next=13;break}return t.SET_AWAITING_ORDER_HAS_LOCAL_INFO(!1),e.next=4,t.$nextTick();case 4:return n=Object.keys(t.selectedGoodsInfo||{}).length?t.selectedGoodsInfo:t.orderInfo,localStorage.setItem("awaitingPaymentOrderInfo",JSON.stringify(f(f({},n),{},{quantity:t.orderInfo.quantity,paymentFormProps:t.paymentFormProps,dotFrom:t.dotFrom,sourceDialog:t.sourceDialog}))),e.next=8,t.setAwaitingOrderPoppTime(t.localCountdownEndTime);case 8:return t.updateStoragePopupState("AwaitingOrderDialog"),t.SET_AWAITING_ORDER_HAS_LOCAL_INFO(!0),t.toPageFrom(),t.handleClose(),e.abrupt("return");case 13:t.handleClose();case 14:case"end":return e.stop()}}),e)})))()},toPageFrom:function(){"AwaitingOrderTimerButton"!==this.pageFrom&&"NotVipComputingDialog"===this.sourceDialog&&this.$EventBus.$emit("showNotVipComputingDialog",{pageFrom:"AwaitingOrderDialog",step:"inGoods"})},setDefaultCountdown:function(){if("AwaitingOrderTimerButton"!==this.pageFrom){var t=Date.now()+60*this.defaultAwaitingOrderCountdown*1e3;this.localCountdownEndTime=t}else this.localCountdownEndTime=this.awaitingOrderPoppEndTime;this.startCountdown()},startCountdown:function(){var t=this;this.countdownTimer&&clearInterval(this.countdownTimer),this.updateCountdown(),this.countdownTimer=setInterval((function(){t.updateCountdown()}),100)},updateCountdown:function(){if(!this.localCountdownEndTime||this.localCountdownEndTime<=Date.now())return this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null),this.minutes="00",this.seconds="00",this.milliseconds="00",void this.clearAwaitingOrderPoppTime();var t=this.localCountdownEndTime-Date.now(),e=Math.max(0,Math.floor(t/1e3)),n=Math.floor(e/60),o=e%60,r=Math.floor(t%1e3/10);this.minutes=n.toString().padStart(2,"0"),this.seconds=o.toString().padStart(2,"0"),this.milliseconds=r.toString().padStart(2,"0")},goToPayment:function(){var t=this;this.$logEvent("log_actions",{operation:"click",behavior_info:"cancel_pay_loading_popup",behavior_info_sub:"pop_2"});var e={NotVipComputingDialog:function(){t.$EventBus.$emit("showNotVipComputingDialog",{pageFrom:"AwaitingOrderDialog",step:"inPay",pageFromData:f({},t.orderInfo.pageFromData)})},SubscriptionSelectDialog:function(){t.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{pageFrom:"AwaitingOrderDialog",step:"payment",pageFromData:{goodsId:t.orderInfo.goodsId,btnLabel:t.orderInfo.btnLabel||"",defaultThirdType:t.orderInfo.defaultThirdType||0},dotFrom:t.dotFrom}})},HalfDiscountDialogSelectLevel:function(){t.setPopupSource({from:"AwaitingOrderDialog",type:"half_discount_select_level",step:"inPay",pageFromData:f({},t.orderInfo.pageFromData)}),t.$EventBus.$emit("showHalfGoodsDialog",t.dotFrom,"new")}};if("AwaitingOrderTimerButton"!==this.pageFrom&&e[this.sourceDialog])return e[this.sourceDialog](),void this.handleClose();this.$EventBus.$emit("showDialog",{name:"PaymentFormDialog",data:f(f({},this.selectedGoodsInfo),{},{quantity:this.orderInfo.quantity,pageFrom:"AwaitingOrderDialog",dotFrom:this.dotFrom}),props:f({},this.paymentFormProps)}),this.handleClose()},getCycleList:function(){var t=this.paymentInfo,e=t.payRange,n=t.svipActiveState;try{var r,l=(this.paymentGrayInfo||{}).sub_type,c=void 0===l?[]:l,d=c;if(n){var h={1:c,2:["month","year"],3:["year"],4:c};e in h&&(d=c.filter((function(t){return h[e].includes(t)})))}var v={week:0,month:1,year:2};if(this.cycleList=Object(o.a)(d).sort((function(a,b){var t,e;return(null!==(t=v[a])&&void 0!==t?t:1/0)-(null!==(e=v[b])&&void 0!==e?e:1/0)})),null!==(r=this.paymentGrayInfo)&&void 0!==r&&r.show_weekly&&"not_vip_calculate"===this.dotFrom){var f,m,_=null===(f=this.selectedGoodsInfo)||void 0===f?void 0:f.level,y=null===(m=this.paymentInfo)||void 0===m?void 0:m.userType;2===y&&3===_||(3===y||6===y)&&(2===_||3===_)?this.cycleList.includes("week")||this.cycleList.unshift("week"):this.cycleList=this.cycleList.filter((function(t){return"week"!==t}))}["HalfDiscountDialogSelectLevel","HalfDiscountDialogRetentionDialog"].includes(this.sourceDialog)&&(this.cycleList=this.cycleList.filter((function(t){return"year"===t})))}catch(t){this.cycleList=[this.currentCycle]}},handleCycleChange:function(t){if(this.currentCycle!==t&&this.orderInfo){var e=this.selectedGoodsInfo.level,n=(this.subscriptionList[t]||[]).find((function(t){return t.level===e}));n&&(this.currentCycle=t,this.selectedGoodsInfo=f({},n))}},getCycleText:function(t){return this.$t("week"===t?"week":"Month")},getCycleTextTotal:function(t){return this.$t({week:"week",month:"Month",year:"year"}[t]||"")},getGoodsCycleById:function(t){return t?t.includes("week")?"week":t.includes("month")?"month":t.includes("year")?"year":"":""},handleCancelOrder:function(){"AwaitingOrderTimerButton"===this.pageFrom&&(this.clearAwaitingOrderPoppTime(),localStorage.removeItem("awaitingPaymentOrderInfo"),this.SET_AWAITING_ORDER_HAS_LOCAL_INFO(!1)),this.toPageFrom(),this.handleClose()},handlePageRefresh:function(){var t;(document.body.style.overflow="",this.isDialogVisible)&&(localStorage.setItem("awaitingPaymentOrderInfo",JSON.stringify(f(f({},Object.keys(this.selectedGoodsInfo||{}).length?this.selectedGoodsInfo:this.orderInfo),{},{quantity:null===(t=this.orderInfo)||void 0===t?void 0:t.quantity,paymentFormProps:this.paymentFormProps,dotFrom:this.dotFrom,sourceDialog:this.sourceDialog}))),this.localCountdownEndTime&&localStorage.setItem("awaiting_order_popp_end_time",this.localCountdownEndTime))}})},_=m,y=(n(5624),n(0)),component=Object(y.a)(_,(function(){var t,e,o,r,l,c,d,h,v,f,m,_,y,w,C,k=this,O=k._self._c;return k.shouldShowContainer?O("div",{staticClass:"awaiting-order-dialog-container",style:{zIndex:k.dialogZIndex}},[O("div",{staticClass:"awaiting-order-dialog flex-center",class:{"dialog-visible":k.isDialogVisible}},[O("div",{directives:[{name:"loading",rawName:"v-loading",value:k.loading,expression:"loading"}],staticClass:"dialog-content"},[O("div",{staticClass:"close-btn",on:{click:function(t){return k.handleMultipleClose()}}},[O("i",{staticClass:"el-icon-close"})]),k._v(" "),O("div",{staticClass:"top-section"},[O("div",{staticClass:"bonus-title"},[O("div",{staticClass:"title"},[k._v(k._s(k.$t("awaiting_order_dialog_title")))]),k._v(" "),"00"!==k.minutes||"00"!==k.seconds||"00"!==k.milliseconds?O("div",{staticClass:"subtitle",domProps:{innerHTML:k._s(k.$t("awaiting_order_dialog_sub_title",{time:k.countdownTimeTxt}))}}):k._e()]),k._v(" "),"Subscription"===(null===(t=k.orderInfo)||void 0===t?void 0:t.type)?O("div",{staticClass:"order-details"},[O("div",{staticClass:"info-card"},[O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb1"))+"：")]),k._v(" "),O("span",{staticClass:"value"},[k._v("\n                "+k._s(k.subscriptionGoodsNameTxt)+"\n              ")])]),k._v(" "),null!==(e=k.selectedGoodsInfo)&&void 0!==e&&null!==(e=e.local_price_web)&&void 0!==e&&e.price_old?O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb2"))+"：")]),k._v(" "),O("div",{staticClass:"value line-through"},[O("span",[k._v(k._s(null===(o=k.selectedGoodsInfo)||void 0===o||null===(o=o.local_price_web)||void 0===o?void 0:o.currency))]),k._v(" "),O("span",[k._v(k._s(null===(r=k.selectedGoodsInfo)||void 0===r||null===(r=r.local_price_web)||void 0===r?void 0:r.price_old)+"/"+k._s(k.getCycleText(k.currentCycle)))])])]):k._e(),k._v(" "),O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb3"))+"：")]),k._v(" "),O("div",{staticClass:"value"},[O("span",[k._v(k._s(null===(l=k.selectedGoodsInfo)||void 0===l||null===(l=l.local_price_web)||void 0===l?void 0:l.currency))]),k._v(" "),O("span",[k._v(k._s(null===(c=k.selectedGoodsInfo)||void 0===c||null===(c=c.local_price_web)||void 0===c?void 0:c.price)+"/"+k._s(k.getCycleText(k.currentCycle)))])])]),k._v(" "),O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb4"))+"：")]),k._v(" "),k.cycleList.length>0?O("div",{staticClass:"payment-cycle-buttons"},k._l(k.cycleList,(function(t){return O("span",{key:t,class:["cycle-button",{active:k.currentCycle===t}],on:{click:function(e){return k.handleCycleChange(t)}}},[k._v("\n                  "+k._s(k.$t("week"===t?"PayWeekly":"month"===t?"PayMonthly":"PayYearly"))+"\n                  "),k.currentLevelDiscounts[t]?O("span",[k._v(" "+k._s(k.currentLevelDiscounts[t])+"%OFF ")]):k._e()])})),0):k._e()]),k._v(" "),O("div",{staticClass:"info-row total-money"},["Subscription"===(null===(d=k.orderInfo)||void 0===d?void 0:d.type)?O("div",{staticClass:"final-price-summary"},[null!==(h=k.selectedGoodsInfo)&&void 0!==h&&null!==(h=h.local_price_web)&&void 0!==h&&h.price_old?O("span",{staticClass:"original-price"},[k._v("\n                  "+k._s(k.totalPriceOld)+"\n                ")]):k._e(),k._v(" "),O("span",{staticClass:"discounted-price"},[k._v(k._s(k.totalPrice))])]):k._e()])]),k._v(" "),k.inSale?O("div",{staticClass:"info-card"},[O("div",{staticClass:"info-row"},[O("div",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb5")))])]),k._v(" "),null!==(v=k.selectedGoodsInfo)&&void 0!==v&&v.discount?O("div",{staticClass:"sale-item"},[k._m(0),k._v(" "),O("div",{staticClass:"item-text"},[k._v(k._s(k.$t("awaiting_order_dialog_lb6")))]),k._v(" "),O("div",{staticClass:"item-value"},[k._v(k._s("".concat(null===(f=k.selectedGoodsInfo)||void 0===f?void 0:f.discount,"% OFF")))])]):k._e(),k._v(" "),null!==(m=k.selectedGoodsInfo)&&void 0!==m&&m.is_first?O("div",{staticClass:"sale-item"},[k._m(1),k._v(" "),O("div",{staticClass:"item-text"},[k._v(k._s(k.$t("awaiting_order_dialog_lb7")))]),k._v(" "),O("div",{staticClass:"item-value"},[k._v("\n                +"+k._s(null===(_=k.selectedGoodsInfo)||void 0===_?void 0:_.first_give_calculate_coins)+"\n                "),O("img",{attrs:{src:n(205),alt:""}})])]):k._e()]):k._e()]):"Credit"===(null===(y=k.orderInfo)||void 0===y?void 0:y.type)?O("div",{staticClass:"order-details"},[O("div",{staticClass:"info-card"},[O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb1"))+"：")]),k._v(" "),O("span",{staticClass:"value"},[k._v("\n                "+k._s(k.creditGoodsNameTxt)+"\n              ")])]),k._v(" "),O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("Purchase"))+"：")]),k._v(" "),O("span",{staticClass:"value"},[k._v(k._s(k.getTotalCredits))])]),k._v(" "),null!==(w=k.selectedGoodsInfo)&&void 0!==w&&w.give_calculate_coins?O("div",{staticClass:"info-row"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb8"))+"：")]),k._v(" "),O("span",{staticClass:"value bonus"},[k._v(k._s((null===(C=k.selectedGoodsInfo)||void 0===C?void 0:C.give_calculate_coins)*k.orderInfo.quantity))])]):k._e(),k._v(" "),O("div",{staticClass:"info-row total-money"},[O("span",{staticClass:"label"},[k._v(k._s(k.$t("awaiting_order_dialog_lb3"))+"：")]),k._v(" "),O("span",{staticClass:"value"},[k._v(" "+k._s(k.getCreditTPrice)+" ")])])])]):k._e()]),k._v(" "),O("div",{staticClass:"bottom-section"},[O("div",{staticClass:"action-buttons"},[O("el-button",{staticClass:"button",on:{click:k.handleCancelOrder}},[k._v(k._s(k.$t("Cancel")))]),k._v(" "),O("el-button",{staticClass:"button payment-button",on:{click:k.goToPayment}},[k._v("\n            "+k._s(k.$t("awaiting_order_dialog_btn"))+"\n          ")])],1)])])])]):k._e()}),[function(){var t=this._self._c;return t("div",{staticClass:"item-icon"},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250415/01c5247c-aa73-4ff1-bbc4-5cc0856bf575.png",alt:""}})])},function(){var t=this._self._c;return t("div",{staticClass:"item-icon"},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250415/cf4fe85b-79ff-4896-be7e-62782df331b5.png",alt:""}})])}],!1,null,"9a6de6c6",null);e.default=component.exports},5875:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),r=n(2),l=(n(20),n(19),n(32),n(16),n(65),n(4),n(21),n(26),n(305)),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"NotVipComputingStayDialog",data:function(){return{visible:!1,loading:!1,dialogZIndex:2e3,countdown:300,minCreations:1e3,maxCreations:5990,minSavings:100,midCreations:3e3,midSavings:1e3,maxSavings:9999,sliderValue:3e3,saveAmount:null,timer:null,currentGoodsInfo:{},exchangeRate:1}},computed:h(h({},Object(c.e)("payment",["paymentInfo","paymentGrayInfo"])),{},{currentUserTierType:function(){var t;return null===(t=this.paymentInfo)||void 0===t?void 0:t.userType},currentCycle:function(){var t,e;return null!==(t=this.currentGoodsInfo)&&void 0!==t&&t.id?null!==(e=this.currentGoodsInfo)&&void 0!==e&&e.id.includes("year")?"year":"Month":""},priceOld:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;return p?0==p.price_old?"":"year"===this.currentCycle?(12*p.price_old).toFixed(2):p.price_old:""},price:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!p)return"";var e="year"===this.currentCycle?(12*p.price).toFixed(2):p.price;return e},saveAmountText:function(){var t,e=null===(t=this.currentGoodsInfo)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency;return this.saveAmount?"".concat(e||"").concat(this.saveAmount,"+"):""}}),methods:h(h({},Object(c.b)("payment",["getSubscriptionList"])),{},{show:function(){this.visible=!0,this.countdown=300,this.sliderValue=3e3,this.calcSave(),this.startCountdown(),this.dialogZIndex=l.PopupManager.nextZIndex(),this.getGoodsInfo()},startCountdown:function(){var t=this;this.clearTimer(),this.timer=setInterval((function(){t.countdown>0?t.countdown--:t.close()}),1e3)},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},calcSave:function(){var t=this.sliderValue,s=0;s=t<=this.midCreations?this.minSavings+(this.midSavings-this.minSavings)*(t-this.minCreations)/(this.midCreations-this.minCreations):this.midSavings+(this.maxSavings-this.midSavings)*(t-this.midCreations)/(this.maxCreations-this.midCreations),this.saveAmount=(s*this.exchangeRate).toFixed(2)},close:function(){this.visible=!1,this.clearTimer()},getGoodsInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,r,l,c,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.getSubscriptionList();case 4:n=e.sent,o=n.data,data=void 0===o?{}:o,t.exchangeRate=(null==data?void 0:data.exchange_rate)||1,l=(r=data||{}).month,c=void 0===l?[]:l,d=r.year,h=void 0===d?[]:d,2==t.currentUserTierType?t.currentGoodsInfo=c.find((function(t){return"sub_monthly2"===t.id}))||{}:t.currentGoodsInfo=h.find((function(t){return"sub_yearly2"===t.id}))||{},e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t.currentGoodsInfo={};case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})))()},handleToPay:function(){var t;this.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{pageFrom:"NotVipComputingStayDialog",step:"payment",pageFromData:{goodsId:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id,dotFrom:"cancel_pay_loading_popup"}}}),this.close()}}),beforeDestroy:function(){this.clearTimer()}},f=(n(5625),n(0)),component=Object(f.a)(v,(function(){var t,e,n,o,r,l,c=this,d=c._self._c;return c.visible?d("div",{staticClass:"not-vip-computing-stay-dialog",style:{zIndex:c.dialogZIndex}},[d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.loading,expression:"loading"}],staticClass:"not-vip-computing-stay-dialog-content"},[d("div",{staticClass:"close-btn",on:{click:c.close}},[d("i",{staticClass:"el-icon-close"})]),c._v(" "),c._m(0),c._v(" "),d("div",{staticClass:"title"},[c._v(c._s(c.$t("not_vip_computing_dialog_lb1")))]),c._v(" "),d("div",{staticClass:"desc",domProps:{innerHTML:c._s(c.$t("not_vip_computing_dialog_lb2"))}}),c._v(" "),d("div",{staticClass:"slider-box"},[d("div",{staticClass:"slider-title"},[c._v(c._s(c.$t("not_vip_computing_dialog_lb3")))]),c._v(" "),d("div",{staticClass:"slider-save",domProps:{innerHTML:c._s(c.$t("not_vip_computing_dialog_lb4",{num:c.saveAmountText}))}}),c._v(" "),d("div",{staticClass:"slider-row"},[d("div",{staticClass:"slider-row-header"},[d("span",{staticClass:"slider-label"},[c._v(c._s(c.$t("not_vip_computing_dialog_lb5")))]),c._v(" "),d("span",{staticClass:"slider-value"},[c._v(c._s(c.sliderValue))])]),c._v(" "),d("el-slider",{staticClass:"custom-slider",attrs:{min:c.minCreations,max:c.maxCreations,step:1,"show-tooltip":!1},on:{input:c.calcSave},model:{value:c.sliderValue,callback:function(t){c.sliderValue=t},expression:"sliderValue"}})],1),c._v(" "),d("div",{staticClass:"feature-row"},[d("div",{staticClass:"feature-row-item"},[c._m(1),c._v(" "),d("span",{staticClass:"feature-row-item-text",domProps:{innerHTML:c._s(c.$t("not_vip_computing_dialog_lb6"))}}),c._v(" "),d("span",{staticClass:"svip-text"},[c._v("SVIP")])]),c._v(" "),d("div",{staticClass:"feature-row-item"},[c._m(2),c._v(" "),d("span",{staticClass:"feature-row-item-text",domProps:{innerHTML:c._s(c.$t("not_vip_computing_dialog_lb7"))}}),c._v(" "),d("span",{staticClass:"svip-text"},[c._v("SVIP")])])])]),c._v(" "),d("div",{staticClass:"price-row"},[d("div",{staticClass:"price"},[d("span",{staticClass:"currency"},[c._v(c._s(null===(t=c.currentGoodsInfo)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency))]),c._v(" "),d("span",{staticClass:"price-text"},[c._v(c._s(c.price))]),c._v(" "),d("span",{staticClass:"per"},[c._v("/"+c._s(c.$t(c.currentCycle)))])]),c._v(" "),c.priceOld?d("div",{staticClass:"origin"},[d("span",{staticClass:"currency"},[c._v(c._s(null===(e=c.currentGoodsInfo)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.currency))]),c._v(" "),d("span",{staticClass:"price-text"},[c._v(c._s(c.priceOld))]),c._v(" "),d("span",{staticClass:"per"},[c._v("/"+c._s(c.$t(c.currentCycle)))])]):c._e(),c._v(" "),d("div",{staticClass:"flash-sale"},[d("img",{attrs:{src:"https://image.cdn2.seaart.me/20250507/8da545ee-30f8-4462-b52e-19b5484d2aa3_high.webp",alt:"flash-sale"}}),c._v("\n        "+c._s(c.$t("not_vip_computing_dialog_lb8"))+"\n        "),d("span",{staticClass:"countdown"},[c._v(c._s(c.countdown)+"s")])])]),c._v(" "),d("button",{staticClass:"pay-btn",on:{click:c.handleToPay}},[c._v("\n      "+c._s(c.$t(null!==(n=c.currentGoodsInfo)&&void 0!==n&&n.discount?"not_vip_computing_dialog_lb9":"Upgrade",{discount:null===(o=c.currentGoodsInfo)||void 0===o?void 0:o.discount}))+"\n      "),d("span",{staticClass:"double-arrow"})]),c._v(" "),d("button",{staticClass:"bottom-btn",on:{click:c.close}},[d("div",{staticClass:"bottom-btn-text"},[c._v(c._s(c.$t("not_vip_computing_dialog_lb10")))]),c._v(" "),null!==(r=c.currentGoodsInfo)&&void 0!==r&&r.discount?d("div",{staticClass:"bottom-btn-subtext"},[c._v("\n        ( "+c._s(c.$t("not_vip_computing_dialog_lb11",{discount:null===(l=c.currentGoodsInfo)||void 0===l?void 0:l.discount}))+" )\n      ")]):c._e()])])]):c._e()}),[function(){var t=this._self._c;return t("div",{staticClass:"vip-icon"},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/20250507/9e323b7e-dc56-41e5-9129-261c4ce51a8c_high.webp",alt:"vip"}})])},function(){var t=this._self._c;return t("span",{staticClass:"icon"},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/20250507/b70b4b63-b23c-44ea-9b40-69d4f31b4123_high.webp",alt:"palette"}})])},function(){var t=this._self._c;return t("span",{staticClass:"icon"},[t("img",{attrs:{src:"https://image.cdn2.seaart.me/20250507/f7d844b0-625e-4a81-9c07-a841ef2aea8a_high.webp",alt:"lightning"}})])}],!1,null,"c0265134",null);e.default=component.exports},5876:function(t,e,n){"use strict";n.r(e);n(11),n(72),n(6),n(12),n(13),n(8),n(7);var o=n(14),r=n(3),l=n(2),c=(n(20),n(19),n(32),n(16),n(22),n(31),n(4),n(40),n(41),n(26),n(1)),d=n(126),h=n(127);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"GRechargeDialog",provide:function(){return{top:this}},components:{PaymentForm:d.a,RightPart:h.a},data:function(){return{visible:!1,contentVisible:!1,step:"inGoods",defaultThirdType:0,dotFrom:"unpaid_to_pay_popup",isAnimating:!1,isClosing:!1,features:[{title:this.$t("svip_feature_free_generation"),description:this.$t("svip_feature_no_energy"),icon:"https://image.cdn2.seaart.me/static/upload/20250514/83cc1487-80f0-475b-879e-5c6518af95ce.webp"},{title:this.$t("svip_feature_faster_channel"),description:this.$t("svip_feature_2x_speed"),icon:"https://image.cdn2.seaart.me/static/upload/20250514/5446c7e7-58ab-4fc4-9658-a2fa71e37732.webp"},{title:this.$t("svip_feature_higher_quality"),description:this.$t("svip_feature_more_exquisite"),icon:"https://image.cdn2.seaart.me/static/upload/20250514/eb7876fe-0c64-42f4-9f24-416380cc3ae2.webp"}],yearlySubList:[],imageResources:["https://image.cdn2.seaart.me/static/upload/20250514/95e274c2-bf6e-41bd-8771-72f403874a65.webp","https://image.cdn2.seaart.me/static/upload/20250514/3cef4ae3-85c3-4720-afff-b79aac6a4d0d.webp","https://image.cdn2.seaart.me/static/upload/20250514/83cc1487-80f0-475b-879e-5c6518af95ce.webp","https://image.cdn2.seaart.me/static/upload/20250514/5446c7e7-58ab-4fc4-9658-a2fa71e37732.webp","https://image.cdn2.seaart.me/static/upload/20250514/eb7876fe-0c64-42f4-9f24-416380cc3ae2.webp","https://image.cdn2.seaart.me/static/upload/20250514/5a93b871-6777-472b-a55b-45257e6e0448.webp","https://image.cdn2.seaart.me/static/upload/20250514/55ae4916-352e-459f-9eb4-7fc13989e07a.webp","https://image.cdn2.seaart.me/static/upload/20250514/adfdc16b-3865-4191-84f6-3d4e0c5ca906.webp","https://image.cdn2.seaart.me/static/upload/20250514/c68e5080-fbe3-4ee2-bf85-dbef34b8f633.webp","https://image.cdn2.seaart.me/20250514/86cb4e73-4277-47aa-b87a-f096d521c362_high.webp","https://image.cdn2.seaart.me/20250514/5fad1e89-00ba-4e2a-98f5-d7b8e32ed286.webp"]}},computed:f(f(f({},Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("payment",["paymentInfo","subThirdType"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},userLayer:function(){var t;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.userType)||""},productId:function(){return{1:"sub_yearly2",2:"sub_monthly2",4:"sub_yearly2"}[this.userLayer]||""},productObj:function(){var t=this;return this.yearlySubList.find((function(e){return e.id===t.productId}))},priceAndCurrency:function(){if(this.productObj){var t,e,n=null===(t=this.productObj.local_price_web)||void 0===t?void 0:t.price,o=null===(e=this.productObj.local_price_web)||void 0===e?void 0:e.currency;return"(".concat(o).concat(n,"/").concat(this.$t("Month"),")")}return""},isValidUserType:function(){return["1","2","4"].includes(String(this.userLayer))},shouldShowDialog:function(){return this.isLoggedIn&&!this.isVip&&!this.hasShownToday()&&this.isValidUserType}}),methods:f(f({},Object(c.b)("payment",["getPaymentInfo","getSubUrlAndThirdType","getSubscriptionList"])),{},{show:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("GRechargeDialog show triggered"),t.isLoggedIn){e.next=4;break}return console.log("User not logged in, dialog not shown"),e.abrupt("return");case 4:if(!t.isVip){e.next=7;break}return console.log("User is VIP, dialog not shown"),e.abrupt("return");case 7:if(t.isClosing=!1,!t.hasShownToday()){e.next=11;break}return console.log("Dialog already shown today, not showing again"),e.abrupt("return");case 11:if(t.shouldShowDialog){e.next=14;break}return console.log("User layer not valid for promotion, dialog not shown"),e.abrupt("return");case 14:t.$xyLogEvent&&t.$xyLogEvent({front_operation:"exposure",entity_name:"unpaid_to_pay_popup",entity_type:"creation_commercial_dialog",position:"unpaid_to_pay_popup",remark:"未付费推荐付费弹窗曝光"}),t.getSubscriptionList().then((function(e){var n,r,l=Array.isArray(null==e||null===(n=e.data)||void 0===n?void 0:n.year)?e.data.year:[],c=Array.isArray(null==e||null===(r=e.data)||void 0===r?void 0:r.month)?e.data.month:[];t.yearlySubList=[].concat(Object(o.a)(l),Object(o.a)(c))})),t.isAnimating=!1,t.contentVisible=!1,Promise.all([t.preloadImages(),t.createDelayPromise(3e3)]).then((function(){t.contentVisible=!0,t.visible=!0,t.$nextTick((function(){t.triggerAnimation()})),t.markShownToday()}));case 19:case"end":return e.stop()}}),e)})))()},createDelayPromise:function(t){return new Promise((function(e){setTimeout(e,t)}))},preloadImages:function(){var t=this.imageResources.map((function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){e()},img.onerror=function(){e()},img.src=t}))}));return Promise.all(t)},triggerAnimation:function(){var t=this;this.isAnimating=!1,requestAnimationFrame((function(){requestAnimationFrame((function(){t.isAnimating=!0}))}))},hide:function(){this.visible=!1,this.contentVisible=!1},handleClose:function(){var t=this;this.isClosing=!0;setTimeout((function(){var e;t.visible=!1,t.contentVisible=!1,t.$EventBus.$emit("commercialBannerSwitch",{mode:"countdown",duration:9e5,discount:(null===(e=t.productObj)||void 0===e?void 0:e.discount)||0})}),800)},handleClosed:function(){this.isAnimating=!1,this.contentVisible=!1,this.isClosing=!1},subscriptionNow:function(){var t=this;this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show_click_subscribe_button",entity_name:"unpaid_to_pay_popup_click",position:"unpaid_to_pay_popup",remark:"未付费推荐付费弹窗点击订阅按钮"}),this.subThirdType?(this.defaultThirdType=this.subThirdType,this.step="inPay"):this.getSubUrlAndThirdType().then((function(e){var n;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var data=e.data;t.defaultThirdType=null==data?void 0:data.third_type,t.step="inPay"}}))},hasShownToday:function(){var t=(new Date).toISOString().slice(0,10);return localStorage.getItem("generage_mall_popup")===t},markShownToday:function(){var t=(new Date).toISOString().slice(0,10);localStorage.setItem("generage_mall_popup",t)}}),watch:{visible:function(t){t||(this.contentVisible=!1)}}},_=(n(5626),n(0)),component=Object(_.a)(m,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{directives:[{name:"show",rawName:"v-show",value:n.contentVisible,expression:"contentVisible"}],staticClass:"creation-commercial-dialog flex_c_m",class:{"closing-animation":n.isClosing},attrs:{visible:n.visible,"show-close":!1,"close-on-click-modal":!1,"destroy-on-close":!1,"append-to-body":!0,modal:!1,"data-group":"unpaid_to_pay_popup"},on:{"update:visible":function(t){n.visible=t},closed:n.handleClosed}},["inGoods"===n.step?o("div",{staticClass:"dialog-content"},[o("div",{staticClass:"dialog-close",attrs:{"data-event":"click_close_unpaid_to_pay_popup"},on:{click:n.handleClose}},[o("i",{staticClass:"el-icon-close"})]),n._v(" "),o("div",{staticClass:"title-section"},[o("h1",{staticClass:"main-title"},[n._v(n._s(n.$t("svip_quick_results_title")))]),n._v(" "),o("div",{staticClass:"subtitle"},[o("span",[n._v(n._s(n.$t("svip_upgrade_now")))]),n._v(" "),o("span",{staticClass:"vip-badge"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/95e274c2-bf6e-41bd-8771-72f403874a65.webp",alt:"title-vip-badge",loading:"lazy",width:"32",height:"32"}})])])]),n._v(" "),o("div",{staticClass:"main-content"},[o("div",{staticClass:"features-section"},n._l(n.features,(function(t,e){return o("div",{key:e,staticClass:"feature-item"},[o("div",{staticClass:"crown-icon"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/3cef4ae3-85c3-4720-afff-b79aac6a4d0d.webp",alt:"top-right-crown",loading:"lazy",width:"26",height:"26"}})]),n._v(" "),o("div",{staticClass:"feature-icon"},[o("img",{attrs:{src:t.icon,alt:"feature-icon",loading:"lazy",width:"113",height:"60"}})]),n._v(" "),o("div",{staticClass:"feature-title"},[n._v(n._s(t.title))]),n._v(" "),o("div",{staticClass:"feature-desc"},[n._v("("+n._s(t.description)+")")])])})),0),n._v(" "),o("div",{staticClass:"speed-comparison-section"},[o("div",{staticClass:"speed-title"},[o("span",{staticClass:"normal-text"},[n._v(n._s(n.$t("normal")))]),n._v(" "),o("span",{staticClass:"vs-text"},[n._v("vs")]),n._v(" "),o("span",{staticClass:"svip-text"},[n._v("SVIP")]),n._v(" "),o("span",{staticClass:"title-extra"},[n._v(n._s(n.$t("svip_generation_speed")))])]),n._v(" "),o("div",{ref:"progressContainer",staticClass:"progress-container"},[o("div",{staticClass:"progress-bar-bg"}),n._v(" "),o("div",{staticClass:"progress-group normal",class:{animate:n.isAnimating}},[o("div",{staticClass:"progress-label"},[o("span",{staticClass:"label-text"},[n._v(n._s(n.$t("normal")))]),n._v(" "),o("span",{staticClass:"speed-value"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/5a93b871-6777-472b-a55b-45257e6e0448.webp",alt:"normal-char",loading:"lazy",width:"20",height:"20"}}),n._v("\n                1X\n              ")])]),n._v(" "),o("div",{staticClass:"progress-char"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/55ae4916-352e-459f-9eb4-7fc13989e07a.webp",alt:"normal-char",loading:"lazy",width:"60",height:"60"}})])]),n._v(" "),o("div",{staticClass:"progress-group rocket",class:{animate:n.isAnimating}},[o("div",{staticClass:"progress-label"},[o("span",{staticClass:"label-text"},[n._v("SVIP")]),n._v(" "),o("span",{staticClass:"speed-value"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/adfdc16b-3865-4191-84f6-3d4e0c5ca906.webp",alt:"fast-char",loading:"lazy",width:"20",height:"20"}}),n._v("\n                2X\n              ")])]),n._v(" "),o("div",{staticClass:"progress-char"},[o("img",{attrs:{src:"https://image.cdn2.seaart.me/static/upload/20250514/c68e5080-fbe3-4ee2-bf85-dbef34b8f633.webp",alt:"rocket-char",loading:"lazy",width:"140",height:"140"}}),n._v(" "),o("div",{staticClass:"rocket-wave"})])])])]),n._v(" "),o("div",{staticClass:"upgrade-section"},[o("button",{staticClass:"upgrade-button",attrs:{"data-event":"click_upgrade_btn_unpaid_to_pay_popup"},on:{click:n.subscriptionNow}},[o("span",{staticClass:"button-text"},[n._v(" "+n._s(n.$t("UpgradeNow"))+" "+n._s(n.priceAndCurrency))])]),n._v(" "),null!==(t=n.productObj)&&void 0!==t&&t.discount?o("div",{staticClass:"discount-label"},[n._v(n._s(null===(e=n.productObj)||void 0===e?void 0:e.discount)+"% OFF")]):n._e()])])]):n._e(),n._v(" "),"inPay"===n.step?o("PaymentForm",{attrs:{defaultThirdType:n.defaultThirdType,initMount:!0,upgrade:!1,goodsId:n.productId},on:{"in-pay-back":function(t){n.step="inGoods"},"pay-success":function(t){n.visible=!1,n.step="inGoods"}}},[o("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):n._e()],1)}),[],!1,null,"709d3639",null);e.default=component.exports},5877:function(t,e,n){"use strict";n.r(e);n(4),n(43),n(11),n(6),n(12),n(13),n(8);var o=n(68),r=n(2),l=(n(19),n(32),n(16),n(22),n(7),n(365)),c=n(126),d=n(127),h=n(939),v=n(940),f=n(1),m=n(693),_=n(9);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"BreakDialogNew",provide:function(){return{top:this}},components:{CustomModalDialog:l.default,PaymentForm:c.a,RightPart:d.a,EnergyInfo:h.a,FeatureItem:v.a},data:function(){return{isShowDialog:!1,currentScene:"PrivateWorkTipWeb",currentPlanType:"year",step:"subscription",videoLoadError:!1,videoLoaded:!1,goodsId:"",defaultThirdType:0,level:"standard",behavior_info:"",dotFrom:"new_card_benefit_popup",extra:{},defaultLevel:["basic","standard","professional"],subscriptionData:null,selectedLevel:2,logMap:{PrivateWorkTipWeb:"private_creation",UnlimitedQueueTipWeb:"free_creation",UpgradeQualityModel:"quality_mode",updateQualityTips:"quality_mode",FastQueueTipWeb:"fast_queue"},subscriptionLevels:m.b}},computed:w(w(w(w({},Object(f.e)("payment",["paymentGrayInfo","subThirdType"])),Object(f.c)("payment",["paymentInfo"])),Object(f.e)("user",["userInfo"])),{},{showWeekly:function(){var t,e;if(null===(t=this.paymentGrayInfo)||void 0===t||!t.show_weekly)return!1;return[2,3,6].includes(null===(e=this.paymentInfo)||void 0===e?void 0:e.userType)},planTabs:function(){var t=[{key:"year"},{key:"month"}];return this.showWeekly&&t.push({key:"weekly"}),t},currentPeriodPlans:function(){if(!this.subscriptionData)return[];switch(this.currentPlanType){case"weekly":return this.subscriptionData.week||[];case"month":return this.subscriptionData.month||[];case"year":return this.subscriptionData.year||[];default:return[]}},currentSelectedPlan:function(){var t,e,n=this;if(!this.subscriptionData)return null;var o=this.currentPeriodPlans.find((function(t){return t.level===n.selectedLevel}));if(!o)return null;var r=this.getLevelType(this.selectedLevel),l=this.subscriptionLevels[r];return w(w({},o),{},{features:w(w({},null==l?void 0:l.features),{},{newShopTips8:o.run_limit||(null==l||null===(t=l.features)||void 0===t?void 0:t.newShopTips8),FreeComputingPower:o.first_give_calculate_coins||(null==l||null===(e=l.features)||void 0===e?void 0:e.FreeComputingPower)})})},currentLevelType:function(){return this.getLevelType(this.selectedLevel)},videoSource:function(){return"https://image.cdn2.seaart.me/static/web_video/break_dialog/".concat(this.currentScene,".mp4")},imageSource:function(){return"https://image.cdn2.seaart.me/static/upload/20250603/c6bff058-5ae0-4013-87fe-d8c4992c9ba3.webp"},energyData:function(){if(!this.currentSelectedPlan)return{monthlyEnergy:0,currentLevel:"basic",imageCount:0,videoCount:0};var t,e=this.currentSelectedPlan.every_day_temp_coins||0;if("weekly"===this.currentPlanType)t=7;else t=30;var n=e*t,o="weekly"===this.currentPlanType?Math.floor(7*e/30):e;return{monthlyEnergy:n,currentLevel:this.currentLevelType,imageCount:n,videoCount:o}},getProgressPercentage:function(){return 25*this.selectedLevel},currentPlanFeatures:function(){var t;return(null===(t=this.currentSelectedPlan)||void 0===t?void 0:t.features)||{}},baseFeaturesConfig:function(){return m.a},optimizedFeaturesList:function(){if(!this.currentSelectedPlan)return[];var t=this.featuresTextMap,e=this.featuresEnabledMap;return this.baseFeaturesConfig.map((function(n){return{id:n.id,text:t[n.id],enabled:e[n.id],tip:t[n.tipI18nKey]||""}}))},featuresEnabledMap:function(){var t=this,e=this.currentPlanFeatures,n={};return this.baseFeaturesConfig.forEach((function(o){var r=e[o.id];n[o.id]=t.getFeatureEnabled(o,r)})),n},featuresTextMap:function(){var t=this,e=this.currentPlanFeatures,n={};return this.baseFeaturesConfig.forEach((function(o){var r=e[o.id];n[o.id]=t.getFeatureDisplayText(o,r),o.tipI18nKey&&(n[o.tipI18nKey]=t.getFeatureDisplayText(o,r,"tipI18nKey"))})),n},displayEnergyAmount:function(){var t;return(null===(t=this.currentSelectedPlan)||void 0===t?void 0:t.every_day_temp_coins)||300}}),methods:w(w({},Object(f.b)("payment",["getSubUrlAndThirdType","getSubscriptionList"])),{},{formatNumberToK:_.T,show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.scene,o=void 0===n?"PrivateWorkTipWeb":n,r=(e.level,e.behavior_info),l=void 0===r?"":r,c=(e.dotFrom,e.defaultLevel),d=void 0===c?["basic","standard","professional"]:c,h=e.extra,v=void 0===h?{}:h;this.currentScene=o,this.behavior_info=l,this.extra=v,this.defaultLevel=d,this.logDialogExposure(),this.getSubscriptionList().then((function(e){var n,o,r;t.subscriptionData=null==e?void 0:e.data,null!==(n=t.subscriptionData)&&void 0!==n&&null!==(n=n.year)&&void 0!==n&&n.length?t.currentPlanType="year":null!==(o=t.subscriptionData)&&void 0!==o&&null!==(o=o.month)&&void 0!==o&&o.length?t.currentPlanType="month":null!==(r=t.subscriptionData)&&void 0!==r&&null!==(r=r.week)&&void 0!==r&&r.length&&(t.currentPlanType="weekly"),t.setDefaultSelectedLevel("standard"),t.isShowDialog=!0}))},hide:function(){this.isShowDialog=!1,this.step="subscription",this.currentPlanType="year",this.videoLoadError=!1,this.videoLoaded=!1,this.goodsId="",this.defaultThirdType=0,this.level="standard",this.behavior_info="",this.dotFrom="new_card_benefit_popup",this.extra={},this.subscriptionData=null,this.selectedLevel=2,this.clearCache()},clearCache:function(){this._textCache&&(this._textCache={})},handleClose:function(){this.$xyLogEvent({front_operation:"click",entity_type:"new_card_benefit_popup_close",entity_name:"new_card_benefit_popup_click",obj_info:{benefit_type:this.getBenefitType()}}),this.hide()},switchPlanType:function(t){this.currentPlanType=t,this.setDefaultSelectedLevel(this.getLevelType(this.selectedLevel)),this.logPlanTypeSwitch(t)},handleVideoError:function(){this.videoLoadError=!0,this.videoLoaded=!1},handleVideoLoaded:function(){this.videoLoaded=!0,this.videoLoadError=!1},handleSubscribeNow:function(){if(this.currentSelectedPlan){var t=this.currentSelectedPlan.id,e=this.getLevelDisplayName(this.currentLevelType);this.subscriptionNow(t,e)}else console.error("No selected plan available")},subscriptionNow:function(t){var e,n,o=this;this.$xyLogEvent({front_operation:"click",entity_type:"new_card_benefit_popup_click_subscribe_button",entity_name:"new_card_benefit_popup_click",obj_info:{pay_package:t,benefit_type:this.getBenefitType(),price:(null===(e=this.currentSelectedPlan)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price)||0,discount:(null===(n=this.currentSelectedPlan)||void 0===n?void 0:n.discount)||0}}),this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="payment"):this.getSubUrlAndThirdType().then((function(e){var n;if(1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)){var data=e.data;o.defaultThirdType=null==data?void 0:data.third_type,o.goodsId=t,o.step="payment"}}))},handlePaySuccess:function(){this.isShowDialog=!1,this.step="subscription"},quitPay:function(){this.step="subscription"},showMorePlans:function(){this.$xyLogEvent({front_operation:"click",entity_type:"new_card_benefit_popup_more_plans",entity_name:"new_card_benefit_popup_click",obj_info:{benefit_type:this.getBenefitType(),current_level:this.currentLevelType,current_period:this.currentPlanType}}),this.$EventBus.$emit("showDialog",{name:"SubscriptionSelectDialog",data:{dotFrom:"break_dialog_new_more_plans"}}),this.hide()},logDialogExposure:function(){this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"new_card_benefit_popup",obj_info:{benefit_type:this.getBenefitType()}})},logPlanTypeSwitch:function(t){this.$xyLogEvent({front_operation:"click",entity_type:"new_card_benefit_popup_period_switch",entity_name:"new_card_benefit_popup_click",obj_info:{plan_type:t,benefit_type:this.getBenefitType(),from_period:this.currentPlanType,to_period:t}})},getPlanTypeName:function(t){return{year:this.$t("PayYearly"),month:this.$t("PayMonthly"),weekly:this.$t("PayWeekly")}[t]||t},getPeriodDisplayName:function(t){return"weekly"===t?this.$t("week"):this.$t("Month")},getLevelType:function(t){return{1:"basic",2:"standard",3:"professional",4:"master"}[t]||"standard"},getLevelDisplayName:function(t){return this.$t({basic:"ToB_beginnerPlan",standard:"StandardPlan",professional:"ToB_professionalPlan",master:"MasterPlan"}[t]||t)},getCurrentDiscount:function(){var t;return null!==(t=this.currentSelectedPlan)&&void 0!==t&&t.discount?this.$t("not_vip_computing_dialog_lb9",{discount:this.currentSelectedPlan.discount}):this.$t("SubscribeNow")},getFeatureDisplayText:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"i18nKey",l="".concat(t[r],"_").concat(Object(o.a)(e),"_").concat(e);return this._textCache||(this._textCache={}),this._textCache[l]?this._textCache[l]:(n="number"==typeof e?this.$t(t[r],{param:e}):this.$t(t[r]),this._textCache[l]=n,n)},getFeatureEnabled:function(t,e){return"boolean"==typeof e?e:"number"==typeof e},setDefaultSelectedLevel:function(t){var e,n={basic:1,standard:2,professional:3,master:4}[t]||2;this.currentPeriodPlans.find((function(t){return t.level===n}))?this.selectedLevel=n:this.selectedLevel=(null===(e=this.currentPeriodPlans[0])||void 0===e?void 0:e.level)||2},getPeriodDiscount:function(t){var e=this;if(!this.subscriptionData)return null;var n=[];switch(t){case"weekly":n=this.subscriptionData.week||[];break;case"month":n=this.subscriptionData.month||[];break;case"year":n=this.subscriptionData.year||[];break;default:return null}var o=n.find((function(t){return t.level===e.selectedLevel}));return(null==o?void 0:o.discount)||null},getBenefitType:function(){return this.logMap[this.currentScene]||"unknown"}}),beforeDestroy:function(){this.clearCache()}},k=C,O=(n(5638),n(0)),component=Object(O.a)(k,(function(){var t,e,n,o,r,l=this,c=l._self._c;return c("CustomModalDialog",{attrs:{visible:l.isShowDialog,"custom-class":"membership-subscription-dialog",dotFrom:l.dotFrom},on:{"update:visible":function(t){l.isShowDialog=t},closed:l.hide}},[c("div",{staticClass:"dialog-content"},["subscription"===l.step?c("div",{staticClass:"subscription-container"},[c("button",{staticClass:"close-button",on:{click:l.handleClose}},[c("i",{staticClass:"el-icon-close"})]),l._v(" "),c("div",{staticClass:"left-panel"},[c("div",{staticClass:"background-image",style:{backgroundImage:"url(".concat(l.imageSource,")")}}),l._v(" "),l.videoSource?c("video",{ref:"backgroundVideo",staticClass:"background-video",class:{"video-loaded":l.videoLoaded},attrs:{src:l.videoSource,autoplay:"",muted:"",loop:""},domProps:{muted:!0},on:{loadeddata:l.handleVideoLoaded,error:l.handleVideoError}}):l._e(),l._v(" "),c("div",{staticClass:"content-overlay"},[c("h1",{staticClass:"main-title"},[l._v(l._s(l.$t(l.currentScene+"New")))]),l._v(" "),c("p",{staticClass:"sub-title"},[l._v(l._s(l.$t(l.currentScene+"NewDesc")))])])]),l._v(" "),c("div",{staticClass:"right-panel"},[c("div",{staticClass:"panel-header"},[c("h2",{staticClass:"main-title"},[l._v(l._s(l.$t(l.currentScene+"Title")))]),l._v(" "),c("p",{staticClass:"sub-title"},[l._v(l._s(l.$t(l.currentScene+"SubTitle")))])]),l._v(" "),c("div",{staticClass:"plan-tabs"},l._l(l.planTabs,(function(t){return c("div",{key:t.key,staticClass:"tab-item",class:{active:l.currentPlanType===t.key},on:{click:function(e){return l.switchPlanType(t.key)}}},[c("span",{staticClass:"tab-text"},[l._v(l._s(l.getPlanTypeName(t.key)))]),l._v(" "),l.getPeriodDiscount(t.key)?c("span",{staticClass:"discount-badge"},[c("span",{staticClass:"badge-text"},[l._v(l._s(l.getPeriodDiscount(t.key))+"%")])]):l._e()])})),0),l._v(" "),c("div",{staticClass:"price-card subscription-level",class:l.currentLevelType},[c("div",{staticClass:"plan-info"},[c("h3",{staticClass:"plan-name level-badge"},[l._v(l._s(l.getLevelDisplayName(l.currentLevelType)))]),l._v(" "),c("div",{staticClass:"price-display"},[c("span",{staticClass:"currency"},[l._v(l._s((null===(t=l.currentSelectedPlan)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)||"$"))]),l._v(" "),c("span",{staticClass:"main-price"},[l._v(l._s((null===(e=l.currentSelectedPlan)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price)||"0"))]),l._v(" "),c("span",{staticClass:"period"},[l._v("/"+l._s(l.getPeriodDisplayName(l.currentPlanType)))]),l._v(" "),null!==(n=l.currentSelectedPlan)&&void 0!==n&&null!==(n=n.local_price_web)&&void 0!==n&&n.price_old?c("span",{staticClass:"original-price"},[l._v("\n                "+l._s((null===(o=l.currentSelectedPlan)||void 0===o||null===(o=o.local_price_web)||void 0===o?void 0:o.currency)||"$")+l._s(null===(r=l.currentSelectedPlan)||void 0===r||null===(r=r.local_price_web)||void 0===r?void 0:r.price_old)+"\n              ")]):l._e()])]),l._v(" "),c("EnergyInfo",{attrs:{"energy-value":l.formatNumberToK(l.energyData.monthlyEnergy),"period-display":l.getPeriodDisplayName(l.currentPlanType),"progress-percentage":l.getProgressPercentage,"image-num":l.energyData.imageCount.toString(),"video-num":l.energyData.videoCount.toString(),"show-generation-info-inline":!0}}),l._v(" "),c("div",{staticClass:"features-list"},[c("span",{staticClass:"first-line",domProps:{innerHTML:l._s(l.$t("staminaPerDay",{num:l.displayEnergyAmount}))}}),l._v(" "),l._l(l.optimizedFeaturesList,(function(t){return c("FeatureItem",{key:t.id,attrs:{text:t.text,enabled:t.enabled,tip:t.tip}})})),l._v(" "),c("FeatureItem",{key:"FreeComputingPower",attrs:{text:l.$t("freePowerForFirstCharge",{num:l.displayEnergyAmount}),enabled:!0}})],2),l._v(" "),c("div",{staticClass:"action-section"},[c("button",{staticClass:"primary-button level-button",on:{click:l.handleSubscribeNow}},[c("span",{staticClass:"button-text"},[l._v(l._s(l.getCurrentDiscount()))])]),l._v(" "),c("el-button",{staticClass:"secondary-link",attrs:{type:"text"},on:{click:l.showMorePlans}},[c("span",{staticClass:"link-text"},[l._v(l._s(l.$t("moreMembershipPlans")))]),l._v(" "),c("i",{staticClass:"el-icon-arrow-right"})])],1)],1)])]):l._e(),l._v(" "),"payment"===l.step?c("PaymentForm",{ref:"PaymentFormRef",attrs:{defaultThirdType:l.defaultThirdType,goodsId:l.goodsId},on:{"in-pay-back":l.quitPay,"pay-success":l.handlePaySuccess}},[c("RightPart",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):l._e()],1)])}),[],!1,null,"76d62c8c",null);e.default=component.exports},5878:function(t,e,n){"use strict";n.r(e);n(11),n(6),n(12),n(13),n(8),n(7);var o=n(3),r=n(2),l=(n(20),n(19),n(32),n(16),n(65),n(4),n(1));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"NotVipComputingStayDialogV2",data:function(){return{dialogVisible:!0,loading:!1,currentGoodsInfo:{},showBenefitList:!0,premiumFeatures:[{icon:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_ic_faster.webp",title:"notvip_computing_stay_v2_premium_features_lb1",bgImage:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_pic_card_01.webp",text:"notvip_computing_stay_v2_premium_features_lb1"},{icon:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_ic_higher.webp",title:"notvip_computing_stay_v2_premium_features_lb2",bgImage:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_pic_card_02.webp",text:"notvip_computing_stay_v2_premium_features_lb2"},{icon:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_ic_lock.webp",title:"notvip_computing_stay_v2_premium_features_lb3",bgImage:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_pic_card_03.webp",text:"notvip_computing_stay_v2_premium_features_lb3"},{icon:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_ic_models.webp",title:"notvip_computing_stay_v2_premium_features_lb4",bgImage:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_pic_card_04.webp",text:"notvip_computing_stay_v2_premium_features_lb4"}]}},computed:d(d({},Object(l.e)("payment",["paymentInfo"])),{},{imagesNum:function(){var t;return Math.floor((null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.every_day_temp_coins)/6)},videosNum:function(){var t;return Math.floor((null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.every_day_temp_coins)/30)},price:function(){var t,p=null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.local_price_web;if(!p)return"";var e=(12*p.price).toFixed(2),n=p.currency;return"".concat(n).concat(e)}}),mounted:function(){},methods:d(d({},Object(l.b)("payment",["getSubscriptionList"])),{},{show:function(){this.dialogVisible=!0,this.getGoodsInfo(),this.$xyLogEvent({front_operation:"exposure",entity_type:"to_pay_pop_show",entity_name:"not_vip_computing_stay_v2"})},handleClose:function(){this.dialogVisible=!1,this.showBenefitList=!0},handleTrialClick:function(){var t,e,n,o;this.$EventBus.$emit("showDialog",{name:"PaymentFormDialog",data:{id:null===(t=this.currentGoodsInfo)||void 0===t?void 0:t.id,quantity:1,dotFrom:"not_vip_computing_stay_v2",pageFrom:"NotVipComputingStayDialogV2"},props:{initMount:!0,isSubscription:!0}}),this.$xyLogEvent({front_operation:"click",entity_type:"to_pay_pop_show",entity_name:"not_vip_computing_stay_v2",obj_info:{pay_package:null===(e=this.currentGoodsInfo)||void 0===e?void 0:e.id,price:(null===(n=this.currentGoodsInfo)||void 0===n||null===(n=n.local_price_web)||void 0===n?void 0:n.price)||0,discount:(null===(o=this.currentGoodsInfo)||void 0===o?void 0:o.discount)||0,page_from:"NotVipComputingStayDialogV2",dot_from:"not_vip_computing_stay_v2"}}),this.handleClose()},getGoodsInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.getSubscriptionList();case 4:n=e.sent,o=n.data,r=((void 0===o?{}:o)||{}).year,l=void 0===r?[]:r,c=t.paymentInfo||{},d=c.country_level_product_id,h=c.country_level,d?t.currentGoodsInfo=l.find((function(t){return t.id===d})):h?(v=["S","A"].includes(h)?2:1,t.currentGoodsInfo=l.find((function(t){return t.level===v}))):t.currentGoodsInfo=l[1],e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t.currentGoodsInfo={};case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})))()}})},v=(n(5640),n(0)),component=Object(v.a)(h,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"not-vip-computing-stay-dialog-v2 dot-group",attrs:{visible:e.dialogVisible,"destroy-on-close":!0,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content",attrs:{"data-group":"not_vip_computing_stay_v2"}},[n("div",{staticClass:"dialog-bg"}),e._v(" "),n("div",{staticClass:"close-btn",attrs:{"data-event":"not_vip_computing_stay_v2_close"},on:{click:e.handleClose}},[n("i",{staticClass:"el-icon-close"})]),e._v(" "),n("div",{staticClass:"free-tag"},[n("img",{attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_free.webp",alt:"free"}})]),e._v(" "),n("h2",{staticClass:"title"},[e._v(e._s(e.$t("notvip_computing_stay_v2_title")))]),e._v(" "),n("div",{staticClass:"subtitle"},[n("img",{staticClass:"subtitle-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_lihua.webp",alt:"icon"}}),e._v(" "),n("span",[e._v(e._s(e.$t("notvip_computing_stay_v2_subtitle")))])]),e._v(" "),n("div",{staticClass:"benefits-container",class:{"show-benefit-detail":!e.showBenefitList}},[e.showBenefitList?[n("div",{staticClass:"benefit-item"},[n("img",{staticClass:"benefit-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_equity_icon_01.webp",alt:"vip"}}),e._v(" "),n("div",{staticClass:"benefit-text"},[n("h3",[e._v("\n              "+e._s(e.$t("notvip_computing_stay_v2_benefit1_title1"))+"\n              "),n("img",{staticClass:"advanced-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_advanced.webp",alt:"free","data-event":"not_vip_computing_stay_v2_benefit1_advanced"},on:{click:function(t){e.showBenefitList=!1}}})]),e._v(" "),n("p",[e._v(e._s(e.$t("notvip_computing_stay_v2_benefit1_desc1")))])])]),e._v(" "),n("div",{staticClass:"benefit-item"},[n("img",{staticClass:"benefit-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_equity_icon_02.webp",alt:"energy"}}),e._v(" "),n("div",{staticClass:"benefit-text"},[n("h3",{domProps:{innerHTML:e._s(e.$t("notvip_computing_stay_v2_benefit2_title2",{num:null===(t=e.currentGoodsInfo)||void 0===t?void 0:t.every_day_temp_coins}))}}),e._v(" "),n("p",{domProps:{innerHTML:e._s(e.$t("notvip_computing_stay_v2_benefit2_desc2",{num1:e.imagesNum,num2:e.videosNum}))}})])]),e._v(" "),n("div",{staticClass:"benefit-item"},[n("img",{staticClass:"benefit-icon",attrs:{src:"https://image.cdn2.seaart.me/static/web/trick/not_vip_stay_dialog_equity_icon_03.webp",alt:"time"}}),e._v(" "),n("div",{staticClass:"benefit-text"},[n("h3",[e._v(e._s(e.$t("notvip_computing_stay_v2_benefit3_title3")))]),e._v(" "),n("p",[e._v(e._s(e.$t("notvip_computing_stay_v2_benefit3_desc3")))])])])]:[n("div",{staticClass:"premium-features-title",attrs:{"data-event":"not_vip_computing_stay_v2_premium_features_title"},on:{click:function(t){e.showBenefitList=!0}}},[n("span",{staticClass:"premium-features-title-icon"},[n("i",{staticClass:"el-icon-arrow-left"})]),e._v(" "),n("span",[e._v(e._s(e.$t("notvip_computing_stay_v2_premium_features_title")))])]),e._v(" "),n("div",{staticClass:"premium-features"},e._l(e.premiumFeatures,(function(t,o){return n("div",{key:o,staticClass:"feature-card",style:{backgroundImage:"url(".concat(t.bgImage,")")}},[n("img",{attrs:{src:t.icon,alt:t.title}}),e._v(" "),n("div",{staticClass:"feature-title"},[e._v(e._s(e.$t(t.text)))])])})),0)]],2),e._v(" "),n("div",{staticClass:"warning-text"},[n("i",{staticClass:"el-icon-warning-outline"}),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.$t("notvip_computing_stay_v2_warning_text",{num:e.price}))}})]),e._v(" "),n("button",{staticClass:"trial-button",on:{click:e.handleTrialClick}},[e._v("\n      "+e._s(e.$t("notvip_computing_stay_v2_button_text"))+"\n      "),n("i",{staticClass:"el-icon-arrow-right"}),e._v(" "),n("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"749d9250",null);e.default=component.exports},619:function(t,e,n){"use strict";n(32),n(24),n(4);var o=n(591),r=n(97),l={name:"HistoryModel",components:{ImageHoverButtons:o.default,commonConfirmModal:r.default},props:{message:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},isCreatieFlow:{type:Boolean,default:!1}},data:function(){return{loading:!0,topButtons:[{code:"download",icon:"iconfont icon-Download",label:"Download",useText:!1,order:5,tips:"text_00193",show:!0,showTypeOptions:[],permissionKey:"supportDownload",category:[]},{code:"deleteSingleImg",icon:"iconfont icon-moveDeleteTask",label:"Delete",useText:!1,order:5,tips:"Delete",show:!1,showTypeOptions:[],permissionKey:"supportDelete",category:[]}]}},computed:{modelUrl:function(){var t,e=this.message.attachments;return(null===(t=(void 0===e?[]:e).find((function(t){return 3===t.sub_type})))||void 0===t?void 0:t.uri)||""},hoverModelUrl:function(){var t,e=this.message.attachments;return(null===(t=(void 0===e?[]:e).find((function(t){return 4===t.sub_type})))||void 0===t?void 0:t.uri)||""}},methods:{onLoad:function(){this.loading=!1},onError:function(){this.loading=!1,this.$message.error(this.$t("LoadFailed"))},viewModel:function(){this.$emit("view-model",this.message)},handleSave:function(){this.$message.warning(this.$t("SaveTips"))},handleButtonClick:function(data){var t=this,code=null==data?void 0:data.code;if("download"===code){var a=document.createElement("a");return a.href=this.message.url,a.download="model.glb",void a.click()}"deleteSingleImg"!==code||this.$refs.commonConfirmModal.show({subTitle:"deleteConfirm"}).then((function(){t.$emit("deleteSingleImg",t.operateNumber)})).catch((function(t){console.log("err",t)}))}}},c=(n(4382),n(0)),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-history-model"},[e("div",{staticClass:"attachments-wrap"},[e("div",{staticClass:"model-attachment-media"},[e("div",{staticClass:"model-content"},[e("div",{staticClass:"model-content-wrap"},[e("img",{staticClass:"media-model-img",class:[t.loading?"":"media-model-img-show",t.loading?"image-opacity-0":""],attrs:{src:t.modelUrl,alt:"model image",decoding:"async",loading:"lazy"},on:{load:t.onLoad,error:t.onError}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading-wrapper"},[e("div",{staticClass:"loading-wrapper-inner"},[e("span",{staticClass:"spinner",attrs:{role:"img","aria-label":t.$t("Loading")}},[t._m(0)])])]),t._v(" "),e("div",{staticClass:"hover-box",on:{click:t.viewModel}},[t.isCreatieFlow?e("ImageHoverButtons",{attrs:{topButtons:t.topButtons,hideBottomButtons:!0},on:{buttonClick:t.handleButtonClick}}):t._e(),t._v(" "),e("div",{staticClass:"mask-box"}),t._v(" "),t.hoverModelUrl?e("img",{staticClass:"hover-media-model-img",attrs:{src:t.hoverModelUrl,alt:"hover model image",decoding:"async",loading:"lazy"}}):t._e(),t._v(" "),t.isCreatieFlow?t._e():e("el-tooltip",{attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:t.$t("Save")}},[e("div",{staticClass:"save-btn",on:{click:function(e){return e.stopPropagation(),t.handleSave.apply(null,arguments)}}},[e("i",{staticClass:"iconfont icon-save"})])])],1)])])])]),t._v(" "),e("common-confirm-modal",{ref:"commonConfirmModal"})],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),this._v(" "),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"c7a9b1d0",null);e.a=component.exports},787:function(t,e,n){"use strict";(function(t){var o=n(3),r=(n(777),n(47),n(511)),l=n.n(r),c=(n(778),n(512)),d=n.n(c),h=(n(16),n(4),n(20),n(121)),v=n.n(h);e.a={name:"workflowVersionInfoModal",components:{ElCollapse:d.a,ElCollapseItem:l.a},data:function(){return{visible:!1,loading:!1,retryCount:0,templateData:"",activeNames:""}},methods:{openModal:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.visible=!0,null===(o=t)||void 0===o){n.next=7;break}return e.loading=!0,l=(null===(r=window.workflowConfig)||void 0===r?void 0:r.package_node_url)||"",n.next=6,e.loadJsonFile(l);case 6:e.loading=!1;case 7:case"end":return n.stop()}}),n)})))()},openFeedBack:function(){try{window.open("https://aihelp.net/questionnaire/#/?formId=c747d6af4c8c4e2b9e74d9bf606ac48f","_blank")}catch(t){}},loadJsonFile:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0].includes(r=t.length>0&&void 0!==t[0]?t[0]:"")){n.next=4;break}return e.loading=!1,n.abrupt("return");case 4:return n.next=6,v.a.getItem(r);case 6:if(!(l=n.sent)){n.next=11;break}return e.templateData=l||[],e.loading=!1,n.abrupt("return");case 11:return n.abrupt("return",fetch(r).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.templateData=data||[],!e.templateData){t.next=4;break}return t.next=4,v.a.setItem(r,e.templateData);case 4:e.loading=!1;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){0===e.retryCount?(e.loadJsonFile(r),e.retryCount++):e.$message.error(e.$t("ServerError"))})));case 12:case"end":return n.stop()}}),n)})))()},handleClose:function(){this.visible=!1},handleChange:function(){}}}}).call(this,n(245))},827:function(t,e,n){"use strict";n(11),n(6),n(12),n(13);var o=n(14),r=n(3),l=n(2),c=(n(20),n(19),n(32),n(22),n(18),n(24),n(65),n(8),n(4),n(28),n(140),n(44),n(7),n(26),n(1)),d=n(80),h=(n(72),n(89),n(69),n(40),n(41),n(16),n(31),n(43),n(21),n(90),n(92),n(819)),v=n(182);function f(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return m(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?m(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function m(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={inject:["top"],mixins:[h.promptPolishMixIn],components:{NodeTips:v.default},props:{itemData:{type:Object,default:function(){}},index:{type:Number,default:0},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{exampleText:[],isTextEllipsis:!1,randomLoading:!1,randomTimer:null,randomIndex:0,isRefined:!1}},mounted:function(){this.initExampleText(),this.checkTextEllipsis()},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},showBottomBtn:function(){var t;return this.itemData.val||(null===(t=this.exampleText)||void 0===t?void 0:t.length)||this.showRefineSwitch},showRefineSwitch:function(){return this.itemData.show_refine_switch&&(this.itemData.val&&this.itemData.val.length<=100&&!this.isRefined||this.itemData.isPreview)}},watch:{"itemData.title":{handler:function(){this.checkTextEllipsis()}},"itemData.example_text":{handler:function(t){this.initExampleText()}}},methods:{changeValue:function(t,source){"refine"!=source&&(this.isRefined=!1),this.top.changeVal(y(y({},this.idsObj),{},{val:t}),this.index)},getDecimalCount:function(t){var e=t.toString();return e.includes(".")?e.split(".")[1].length:0},formatStepPrecision:function(t,e){var n=Math.pow(10,t-1);return Number((Math.ceil(e*n)/n).toFixed(t))},initExampleText:function(){var t,e;null!==(t=this.itemData)&&void 0!==t&&null!==(t=t.example_text)&&void 0!==t&&t.length?this.exampleText=null===(e=this.itemData)||void 0===e?void 0:e.example_text.concat(this.itemData.val):this.exampleText=[]},generatePrompt:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.itemData.isPreview){if(n)return this.randomIndex=Math.floor(Math.random()*this.exampleText.length),void this.changeValue(this.exampleText[this.randomIndex]);this.$logEvent("log_actions",{operation:"click_random_prompt",behavior_info:"on_ai_app_detail_page",behavior_info_sub:(null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t?void 0:t.name)||""}),this.randomLoading=!0,clearTimeout(this.randomTimer),this.randomTimer=setTimeout((function(){e.randomIndex+=1,e.randomIndex>=e.exampleText.length&&(e.randomIndex=0),e.changeValue(e.exampleText[e.randomIndex]),e.randomLoading=!1}),300)}},refinePrompt:function(){var t,e;if(!this.itemData.isPreview){var n=this.top,o=n.workFlowAppData,r=void 0===o?{}:o,l=n.codeViewData,c=void 0===l?[]:l,d=n.workFlowIndex,h=void 0===d?0:d,v=n.workFlowTabList,f=void 0===v?[]:v,m=(null===(t=this.itemData)||void 0===t?void 0:t.refine_node_ids)||[],_=(null==m?void 0:m[0])||{},y=_.node_id,w=_.node_type,C=_.field,k=c.find((function(t){return t.node_id==y&&t.node_type==w&&t.field==C}))||{},O=this.itemData.val;"string"!=typeof O&&O&&(O=JSON.stringify(O)),this.getPromptPolish({prompt:O||"",template_id:r.id,ver_no:null===(e=f[h])||void 0===e?void 0:e.verNo,img_url:(null==k?void 0:k.val)||""})}},getPromptPolish:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v,m,_,y,w,C,line,text;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isPromptPolishing){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,e.isPromptPolishing=!0,n.next=6,fetch("/api/stream/tool/prompt/text",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",token:e.$cookies.get("T"),"Accept-Language":e.$cookies.get("lang")||navigator.language||navigator.browserLanguage,"X-Device-Id":e.$cookies.get("deviceId"),"X-App-Id":"web_global_seaart"},body:JSON.stringify(t)});case 6:o=n.sent,r=o.body.getReader(),l=new TextDecoder("utf-8"),c="",d="";case 11:return n.next=14,r.read();case 14:if(h=n.sent,v=h.done,m=h.value,!v){n.next=19;break}return n.abrupt("break",49);case 19:if(!(_=l.decode(m,{stream:!0})).includes('"code":10624')){n.next=23;break}return e.$message.error("".concat(e.$t("ai_app_use_count_limit"),"}")),n.abrupt("break",49);case 23:if(!_.includes('"code":20000')){n.next=26;break}return e.$EventBus.$emit("openLoginDialog"),n.abrupt("break",49);case 26:y=(c+=_).split("\n"),c=y.pop()||"",w=f(y),n.prev=30,w.s();case 32:if((C=w.n()).done){n.next=39;break}if(""!==(line=C.value).trim()){n.next=36;break}return n.abrupt("continue",37);case 36:if(line.startsWith("data: "))try{"---end---"!==(text=line.slice(6))&&(d+=text,e.changeValue(d,"refine"))}catch(t){console.error("解析数据失败:",t)}case 37:n.next=32;break;case 39:n.next=44;break;case 41:n.prev=41,n.t0=n.catch(30),w.e(n.t0);case 44:return n.prev=44,w.f(),n.finish(44);case 47:n.next=11;break;case 49:e.isPromptPolishing=!1,n.next=57;break;case 52:n.prev=52,n.t1=n.catch(2),console.error("获取智能提示失败",n.t1),e.$message.error("".concat(e.$t("comicPage17"))),e.isPromptPolishing=!1;case 57:case"end":return n.stop()}}),n,null,[[2,52],[30,41,44,47]])})))()},updatePrompt:function(t){this.isRefined=!0,this.changeValue(t,"refine")},checkTextEllipsis:function(){var t=this;this.$nextTick((function(){var e=t.$refs.titleRef;e&&(t.isTextEllipsis=e.scrollWidth>e.clientWidth)}))},deleteValue:function(){this.changeValue(""),this.$refs.textareaRef.focus()}},render:function(){var t,e=this,n=arguments[0],o=this.itemData,r=o.value_type,l=o.option||{},c=l.step,d=void 0===c?.1:c,h=l.min,f=void 0===h?0:h,m=l.max,_=void 0===m?100:m,y=l.accuracy,w=void 0===y?.1:y;w<this.getDecimalCount(d)&&(d=this.formatStepPrecision(w,d)),0!=w&&0!=d||(d=1);var C=n("div",{class:"input-field"},[n("div",{class:"input-field-top"},[n("div",{class:"input-field-top-left"},[n("el-tooltip",{attrs:{content:this.itemData.title,placement:"top",disabled:!this.isTextEllipsis,"open-delay":300}},[n("div",{class:"input-field-top-left-title",ref:"titleRef"},[this.itemData.title])]),n(v.default,{attrs:{itemData:this.itemData,currentWorkFlow:this.currentWorkFlow}})])]),n("div",{class:"input-field-content"},[n("el-input",{attrs:{disabled:this.itemData.isPreview,placeholder:"",type:"textarea",resize:"none",value:this.itemData.val},on:{input:this.changeValue},ref:"textareaRef"}),this.showBottomBtn&&n("div",{class:"option-box"},[n("div",{class:"left-btn"},[!(null===(t=this.exampleText)||void 0===t||!t.length)&&n("el-tooltip",{attrs:{content:this.$t("workflow_clues_hover_tip"),placement:"top"}},[n("div",{class:"option-btn",on:{click:function(){return e.generatePrompt(!1)}}},[n("i",{class:["iconfont icon-suijishushengcheng random-icon",this.randomLoading?"random-prompt-loading":""]}),n("div",{class:"option-btn-title"},[this.$t("Random")])])]),this.showRefineSwitch&&n("div",{class:"option-btn",attrs:{"data-group":"ai-app-code-viewer-input-field-refine","data-desc":"ai应用-文本输入组件-内容润色"},on:{click:function(){return e.refinePrompt()}}},[n("i",{class:["iconfont icon-gpt-advance random-icon",this.isPromptPolishing?"random-polish-loading":""]}),n("div",{class:"option-btn-title"},[this.$t("Ideate")])])]),n("i",{class:"el-icon-delete icon-option",attrs:{"data-group":"ai-app-code-viewer-input-field-delete","data-desc":"ai应用-文本输入组件-内容删除"},on:{click:this.deleteValue}})])])]),k=n("div",{class:"input-field number-input"},[n("div",{class:"number-input-box width-height-hundred"},[n("div",{class:"number-input-top"},[n("el-tooltip",{attrs:{content:this.itemData.title,placement:"top",disabled:!this.isTextEllipsis,"open-delay":300}},[n("div",{class:"number-input-title",ref:"titleRef"},[this.itemData.title])]),n(v.default,{attrs:{itemData:this.itemData,currentWorkFlow:this.currentWorkFlow}})]),n("el-input-number",{attrs:{disabled:this.itemData.isPreview,size:"small",step:d,precision:w,min:f,max:_,value:this.itemData.val},on:{change:this.changeValue}})])]);return 1==r?C:k}},C=w,k=(n(4732),n(0)),O=Object(k.a)(C,undefined,undefined,!1,null,"9caad91c",null).exports,x=n(30),T={components:{NodeTips:v.default},props:{itemData:{type:Object,default:function(){}},title:{type:String,default:""},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{isOpen:!0,scrollHeight:0,isTextEllipsis:!1}},mounted:function(){this.checkTextEllipsis(),this.updateScrollHeight()},computed:{getStyle:function(){return{maxHeight:this.isOpen?"".concat(this.scrollHeight+20,"px"):"0px",padding:this.isOpen?"10px 0":"0px",borderTop:this.isOpen?"1px solid rgba(255, 255, 255, 0.06)":"0"}}},watch:{title:{handler:function(){this.checkTextEllipsis()}}},methods:{handleClick:function(){this.isOpen=!this.isOpen,this.updateScrollHeight()},updateScrollHeight:function(){var t=this;this.$nextTick((function(){var e;t.scrollHeight=(null===(e=t.$refs.content)||void 0===e?void 0:e.scrollHeight)||0}))},checkTextEllipsis:function(){var t=this;this.$nextTick((function(){var e=t.$refs.titleRef;e&&(t.isTextEllipsis=e.scrollWidth>e.clientWidth)}))}}},S=(n(4733),Object(k.a)(T,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"collapse-components"},[e("div",{staticClass:"collapse-components-top",on:{click:t.handleClick}},[e("div",{staticClass:"collapse-components-top-left"},[e("el-tooltip",{attrs:{content:t.title,placement:"top",disabled:!t.isTextEllipsis,"open-delay":300}},[e("span",{ref:"titleRef",staticClass:"collapse-components-top-left-title overflow-ellipsis"},[t._v(t._s(t.title))])]),t._v(" "),e("NodeTips",{attrs:{itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}})],1),t._v(" "),e("i",{staticClass:"el-icon-arrow-down collapse-components-top-icon",class:{"is-open":t.isOpen}})]),t._v(" "),e("div",{ref:"content",staticClass:"collapse-components-content",style:t.getStyle},[t._t("default")],2)])}),[],!1,null,"2b730eab",null).exports),D=n(83),P=n(872),I=n(873),$=n(874),j=n(875);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={inject:["top"],props:{itemData:{type:Object,default:function(){}},storagekey:{type:String,default:""},index:{type:Number,default:0},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S,HyUploadMoald:D.default,GuestUpload:P.default,ExampleImage:I.default,ImageReversePrompt:$.default,MaskModal:j.default,NodeTips:v.default},data:function(){return{category:20,pendingFile:[],isPendingUpload:!1,height:64,isTextEllipsis:!1,isDragOver:!1}},computed:M(M({},Object(c.c)("user",["isLoggedIn"])),{},{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},enableMaskEdit:function(){var t=(this.itemData||{}).option,option=void 0===t?{}:t;return null==option?void 0:option.is_mask_draw},upModalObj:function(){var t;return{template_id:(null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t?void 0:t.id)||""}},showReverseSwitch:function(){var t;return!(null===(t=this.itemData)||void 0===t||null===(t=t.reverse_node_ids)||void 0===t||!t.length)}}),watch:{isLoggedIn:function(){this.uploadPendingFile()},"itemData.title":{handler:function(){this.checkTextEllipsis()}}},mounted:function(){this.handleDomResize(),this.uploadPendingFile()},methods:{changeValue:function(t){this.top.changeVal(M(M({},this.idsObj),{},{val:t}),this.index)},confirmMask:function(mask){this.changeValue(mask)},handleDomResize:function(){this.checkTextEllipsis()},checkTextEllipsis:function(){var t=this;this.$nextTick((function(){var e=t.$refs.titleRef;e&&(t.isTextEllipsis=e.scrollWidth>e.clientWidth)}))},reverrsePrompt:function(){var t;null===(t=this.$refs)||void 0===t||null===(t=t.imageReversePromptRef)||void 0===t||t.switchReverrsePrompt()},selectExampleImage:function(t){var e;this.isPendingUpload||(this.$logEvent("log_actions",{operation:"click_sample_image",behavior_info:"on_ai_app_detail_page",behavior_info_sub:(null===(e=this.top)||void 0===e||null===(e=e.workFlowAppData)||void 0===e?void 0:e.name)||""}),this.uploadHandleConfirm([{url:t}]))},reUpload:function(){this.isPendingUpload||(this.isLoggedIn?this.$refs.hyUploadMoald.openModal():this.$refs.guestUploadRef.reUpload())},handleUpload:function(){this.isPendingUpload||this.itemData.isPreview||this.$refs.hyUploadMoald.openModal()},openGenerateModal:function(){var t;this.enableMaskEdit&&(this.$logEvent("log_actions",{operation:"click_edit_mask",behavior_info:"on_app_detail_page"}),null===(t=this.$refs)||void 0===t||null===(t=t.maskModal)||void 0===t||t.show(this.itemData.val))},uploadHandleConfirm:function(t){var e=Object(x.a)(t,1)[0];this.changeValue(e.url)},handleDelete:function(){this.changeValue("")},uploadPendingFile:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn&&null!==(n=t.pendingFile)&&void 0!==n&&n.length){e.next=2;break}return e.abrupt("return");case 2:t.isPendingUpload=!0,t.$refs.guestUploadRef.handleChange(t.pendingFile[0],t.pendingFile.slice(0,1)),t.pendingFile=[];case 5:case"end":return e.stop()}}),e)})))()},uploadSuccess:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isPendingUpload=!1;var e=t.map((function(t){var e=t.url,n=t.width,o=t.height;return{id:"",url:e,width:n,height:o,info:{id:"",channel:"upload",cover:{url:e,width:n,height:o,img_category:20}}}}));this.isLoggedIn?this.$emit("uploadSuccess",e.map((function(t){return t.info.cover}))):this.storageTempData(e),this.uploadHandleConfirm(e)},onUploadFail:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isPendingUpload=!1,this.pendingFile=t},storageTempData:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]?t[0]:[],r=e.itemData,l=r.node_id,c=r.node_type,d=e.$route.params.id,h=localStorage.getItem("".concat(e.storagekey)),(v=h?JSON.parse(h):{})[d]||(v[d]=[]),null!=o&&o.length&&v[d].push({id:d,category:e.category,nodeId:l,nodeType:c,url:o[0].url,width:o[0].width,height:o[0].height}),localStorage.setItem("".concat(e.storagekey),JSON.stringify(v));case 8:case"end":return n.stop()}}),n)})))()},handleDragEnter:function(t){t.preventDefault(),t.stopPropagation(),this.isPendingUpload||this.itemData.isPreview||(this.isDragOver=!0)},handleDragLeave:function(t){t.preventDefault(),t.stopPropagation();var e=t.currentTarget,n=t.relatedTarget;n&&e.contains(n)||(this.isDragOver=!1)},handleDrop:function(t){if(t.preventDefault(),t.stopPropagation(),this.isDragOver=!1,!this.isPendingUpload&&!this.itemData.isPreview){var e=t.dataTransfer.files;if(e.length>0){var n=e[0];n.type.startsWith("image/")&&this.processDragFile(n)}}},processDragFile:function(t){if(t){var e={name:t.name,raw:t,percentage:0,status:"ready",uid:Date.now(),size:t.size};this.isPendingUpload=!0,this.$refs.guestUploadRef.handleChange(e,[e])}},handleFileChange:function(t){var e=t.target?t.target.files[0]:t;this.processDragFile(e)}}},F=E,A=(n(4734),n(4735),Object(k.a)(F,(function(){var t,e,n,o=this,r=o._self._c;return r("div",{staticClass:"image-field"},[r("div",{ref:"imageFieldTopRef",staticClass:"image-field-top"},[r("div",{staticClass:"image-field-top-left"},[r("el-tooltip",{attrs:{content:o.itemData.title,placement:"top",disabled:!o.isTextEllipsis,"open-delay":300}},[r("div",{ref:"titleRef",staticClass:"image-field-top-left-title"},[o._v("\n          "+o._s(o.itemData.title)+"\n        ")])]),o._v(" "),r("NodeTips",{attrs:{itemData:o.itemData,currentWorkFlow:o.currentWorkFlow}})],1),o._v(" "),r("el-tooltip",{attrs:{content:o.$t("ai_app_smart_prompt_tip"),placement:"top","open-delay":200}},[o.showReverseSwitch?r("div",{staticClass:"btn-area",attrs:{"data-group":"ai-app-smart-prompt","data-desc":"ai应用智能提示"},on:{click:o.reverrsePrompt}},[r("i",{staticClass:"iconfont icon-zhinengtishi"}),o._v(" "),r("span",[o._v(o._s(o.$t("smart_prompt")))])]):o._e()])],1),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.itemData.val,expression:"itemData.val"},{name:"loading",rawName:"v-loading",value:o.isPendingUpload,expression:"isPendingUpload"}],staticClass:"image-field-display"},[r("img",{staticClass:"img",class:[o.enableMaskEdit&&"cursor-pointer"],attrs:{src:o.itemData.val,alt:"image"},on:{click:function(t){return t.stopPropagation(),o.openGenerateModal.apply(null,arguments)}}}),o._v(" "),r("div",{staticClass:"handle-btn reupload-btn",on:{click:o.reUpload}},[r("Icon",{attrs:{name:"a-icon-reselectimg",size:"16",color:"#fff"}})],1),o._v(" "),r("div",{staticClass:"handle-btn delete-btn",on:{click:o.handleDelete}},[r("Icon",{attrs:{name:"a-pyDelete1",size:"18",color:"#fff"}})],1),o._v(" "),o.enableMaskEdit?r("span",{staticClass:"edit-mask-btn",on:{click:function(t){return t.stopPropagation(),o.openGenerateModal.apply(null,arguments)}}},[o._v(o._s(o.$t("EditMask")))]):o._e()]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!o.itemData.val,expression:"!itemData.val"}],staticClass:"image-field-upload-box"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isPendingUpload,expression:"isPendingUpload"},{name:"show",rawName:"v-show",value:o.isLoggedIn,expression:"isLoggedIn"}],staticClass:"pick-item",class:{"drag-over":o.isDragOver},on:{click:function(t){return t.stopPropagation(),o.handleUpload()},dragover:function(t){return t.preventDefault(),o.handleDragEnter.apply(null,arguments)},dragleave:function(t){return t.preventDefault(),o.handleDragLeave.apply(null,arguments)},drop:function(t){return t.preventDefault(),o.handleDrop.apply(null,arguments)}}},[r("input",{ref:"dragUploadInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".jpg,.png,.jpeg,.webp"},on:{change:o.handleFileChange}}),o._v(" "),r("i",{staticClass:"iconfont icon-Frame5"}),o._v(" "),r("div",{staticClass:"upload-item-text"},[o._v(o._s(o.$t("click_upload_or_drag")))])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!o.isLoggedIn,expression:"!isLoggedIn"}],staticClass:"pick-item"},[r("guest-upload",{ref:"guestUploadRef",attrs:{fileTypes:["image"],videoCategory:61,category:o.category,uploadObj:{other:o.upModalObj},storagekey:o.storagekey},on:{onUploadStart:function(t){o.isPendingUpload=!0},onUploadEnd:function(t){o.isPendingUpload=!1},onUploadSuccess:o.uploadSuccess,onUploadFail:o.onUploadFail}})],1)]),o._v(" "),o.showReverseSwitch?r("ImageReversePrompt",{ref:"imageReversePromptRef",attrs:{data:o.itemData}}):o._e(),o._v(" "),null!==(t=o.itemData)&&void 0!==t&&null!==(t=t.example_image)&&void 0!==t&&t.length?r("ExampleImage",{attrs:{data:null===(e=o.itemData)||void 0===e?void 0:e.example_image,value:null===(n=o.itemData)||void 0===n?void 0:n.val},on:{selected:o.selectExampleImage}}):o._e(),o._v(" "),r("HyUploadMoald",{ref:"hyUploadMoald",attrs:{"is-need-login":!1,category:20,isSingleSelect:"",uploadObj:{other:o.upModalObj},recentlyUsedQueryObj:o.upModalObj,personalWorksQueryObj:o.upModalObj},on:{onConfirm:o.uploadHandleConfirm}}),o._v(" "),r("MaskModal",{ref:"maskModal",on:{confirm:o.confirmMask}})],1)}),[],!1,null,"18b059c4",null)),N=A.exports,R=n(366),B=n(10);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var W={inject:["top"],props:{itemData:{type:Object,default:function(){}},workFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S,WorkflowStyleModal:R.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{"itemData.art_model":{handler:function(t){this.setArtModel()},deep:!0}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},mounted:function(){this.setArtModel()},methods:{setArtModel:function(){var t,e=(this.itemData||{}).art_model;e&&(this.displayData.name=null==e?void 0:e.name,this.displayData.url=null==e||null===(t=e.banner)||void 0===t?void 0:t.url,this.displayData.version_name=null==e?void 0:e.version_name)},changeUrl:function(t){return Object(B.K)(t,"high")},openModelSelect:function(){this.itemData.isPreview||this.$refs.workflowStyleModal.openModal({modelType:"Checkpoint"})},handleSelectModel:function(t){var e=t.info,n=e||{},o=n.id,r=void 0===o?"":o,l=n.name,c=void 0===l?"":l,d=n.model_ver_no,h=void 0===d?"":d,v=n.version_name,f=void 0===v?"":v,m=n.banner,_=void 0===m?{}:m,y="".concat(r,"@").concat(h);this.displayData={name:c,url:(null==_?void 0:_.url)||"",version_name:f},this.top.changeNodeProperty(this.idsObj,"art_model",e||{}),this.top.changeVal(V(V({},this.idsObj),{},{val:y})),this.$refs.collapse.updateScrollHeight()}}},H=(n(4736),Object(k.a)(W,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"checkpoint-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:e.itemData.title,itemData:e.itemData,workFlow:e.workFlow}},[e.itemData.val?n("div",{staticClass:"checkpoint-field-content"},[n("div",{staticClass:"checkpoint-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[e._v("\n          "+e._s(e.displayData.version_name)+"\n        ")]),e._v(" "),null!==(t=e.displayData)&&void 0!==t&&t.url?n("el-image",{attrs:{fit:"cover",src:e.changeUrl(e.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[e._v("\n          "+e._s(e.$t("EmptyBannerText"))+"\n        ")]),e._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:e.displayData.name}},[e._v("\n          "+e._s(e.displayData.name)+"\n        ")])],1),e._v(" "),n("div",{staticClass:"checkpoint-field-content-right flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),e._v(" "),n("span",{staticClass:"text"},[e._v(e._s(e.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),e._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:e.handleSelectModel}})],1)}),[],!1,null,"7331f0cd",null).exports);function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y={inject:["top"],props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S,WorkflowStyleModal:R.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{itemData:{handler:function(t){var e,n=(t||{}).art_model;n&&(this.displayData.name=null==n?void 0:n.name,this.displayData.url=null==n||null===(e=n.banner)||void 0===e?void 0:e.url,this.displayData.version_name=null==n?void 0:n.version_name)},deep:!0}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeUrl:function(t){return Object(B.K)(t,"high")},openModelSelect:function(){this.$refs.workflowStyleModal.openModal({modelType:"LORA"})},handleSelectModel:function(t){var e=t.info||{},n=e.id,o=void 0===n?"":n,r=e.name,l=void 0===r?"":r,c=e.model_ver_no,d=void 0===c?"":c,h=e.version_name,v=void 0===h?"":h,f=e.banner,m=void 0===f?{}:f,_="".concat(o,"@").concat(d);this.displayData={name:l,url:(null==m?void 0:m.url)||"",version_name:v},this.top.changeVal(z(z({},this.idsObj),{},{val:_})),this.$refs.collapse.updateScrollHeight()}}},J=(n(4737),Object(k.a)(Y,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"lora-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:e.itemData.title,itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}},[e.itemData.val?n("div",{staticClass:"lora-field-content"},[n("div",{staticClass:"lora-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[e._v("\n          "+e._s(e.displayData.version_name)+"\n        ")]),e._v(" "),null!==(t=e.displayData)&&void 0!==t&&t.url?n("el-image",{attrs:{fit:"cover",src:e.changeUrl(e.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[e._v("\n          "+e._s(e.$t("EmptyBannerText"))+"\n        ")]),e._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:e.displayData.name}},[e._v("\n          "+e._s(e.displayData.name)+"\n        ")])],1),e._v(" "),n("div",{staticClass:"lora-field-content-right flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),e._v(" "),n("span",{staticClass:"text"},[e._v(e._s(e.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),e._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:e.handleSelectModel}})],1)}),[],!1,null,"4da2c7dd",null).exports);function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var X={inject:["top"],props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S},data:function(){return{}},mounted:function(){},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeValue:function(t){this.top.changeVal(Q(Q({},this.idsObj),{},{val:t}))}}},Z=(n(4738),Object(k.a)(X,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider-field"},[e("CollapseComponent",{attrs:{title:t.itemData.title,itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}},[e("el-slider",{attrs:{disabled:t.itemData.isPreview,"show-input":"","show-input-controls":!1,value:t.itemData.val,min:t.itemData.option.min,max:t.itemData.option.max,step:t.itemData.option.step},on:{input:t.changeValue}})],1)],1)}),[],!1,null,"e41c32bc",null).exports);function tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var it={inject:["top"],components:{NodeTips:v.default},props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{isTextEllipsis:!1}},watch:{"itemData.title":{handler:function(){this.checkTextEllipsis()}}},mounted:function(){this.checkTextEllipsis()},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeValue:function(t){this.top.changeVal(et(et({},this.idsObj),{},{val:t}))},checkTextEllipsis:function(){var t=this;this.$nextTick((function(){var e=t.$refs.titleRef;e&&(t.isTextEllipsis=e.scrollWidth>e.clientWidth)}))}}},nt=(n(4739),Object(k.a)(it,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-field"},[e("div",{staticClass:"select-field-top"},[e("el-tooltip",{attrs:{content:t.itemData.title,placement:"top",disabled:!t.isTextEllipsis,"open-delay":300}},[e("div",{ref:"titleRef",staticClass:"select-field-top-title"},[t._v(t._s(t.itemData.title))])]),t._v(" "),e("NodeTips",{attrs:{itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}})],1),t._v(" "),e("el-select",{staticClass:"custom-select-transparent",attrs:{disabled:t.itemData.isPreview,"popper-class":"painting-board-select",value:t.itemData.val,"popper-append-to-body":!0},on:{change:t.changeValue}},t._l(t.itemData.option.values,(function(t){return e("el-option",{key:"key"+t,attrs:{label:t,value:t}})})),1)],1)}),[],!1,null,"153c71e8",null).exports);function at(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?at(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var st={inject:["top"],components:{NodeTips:v.default},props:{itemData:{type:Object,default:function(){}},currentWorkFlow:{type:Object,default:function(){}}},data:function(){return{seedMode:"random",numVal:{random:0,custom:0},isTextEllipsis:!1}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},isRandom:function(){return"random"===this.seedMode},seedPlsHd:function(){return this.isRandom?this.$t("RandomSeed"):this.$t("customSeed")},getVal:function(){var t=this.numVal,e=t.random,n=t.custom;return this.isRandom?e:n}},watch:{numVal:{handler:function(){this.top.changeVal(ot(ot({},this.idsObj),{},{val:this.getVal}))},deep:!0,immediate:!0},"itemData.title":{handler:function(){this.checkTextEllipsis()}}},mounted:function(){this.checkTextEllipsis()},methods:{initData:function(){this.numVal.random=this.getRandomSeed(),this.numVal.custom=this.getRandomSeed()},changeSeedMode:function(t){this.seedMode=t,this.isRandom?this.numVal.random=this.getRandomSeed():this.top.changeVal(ot(ot({},this.idsObj),{},{val:this.getVal}))},changeValue:function(t){this.isRandom?this.numVal.random=t:this.numVal.custom=t},getRandomSeed:function(){return Math.floor(4294967294*Math.random())+1},checkTextEllipsis:function(){var t=this;this.$nextTick((function(){var e=t.$refs.titleRef;e&&(t.isTextEllipsis=e.scrollWidth>e.clientWidth)}))}}},lt=(n(4740),Object(k.a)(st,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"seed-field"},[e("div",{staticClass:"seed-field-top"},[e("div",{staticClass:"seed-field-top-left"},[e("el-tooltip",{attrs:{content:t.itemData.title,placement:"top",disabled:!t.isTextEllipsis,"open-delay":300}},[e("div",{ref:"titleRef",staticClass:"seed-field-top-left-title"},[t._v(t._s(t.itemData.title))])]),t._v(" "),e("NodeTips",{attrs:{itemData:t.itemData,currentWorkFlow:t.currentWorkFlow}})],1),t._v(" "),e("div",{staticClass:"seed-field-top-switch"},[e("button",{staticClass:"switch-btn",class:{active:t.isRandom},on:{click:function(e){return t.changeSeedMode("random")}}},[t._v("\n        "+t._s(t.$t("Random"))+"\n      ")]),t._v(" "),e("button",{staticClass:"switch-btn",class:{active:!t.isRandom},on:{click:function(e){return t.changeSeedMode("custom")}}},[t._v("\n        "+t._s(t.$t("Customization"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"seed-field-content flex-center"},[e("el-input-number",{attrs:{placeholder:t.seedPlsHd,precision:0,controls:!1,min:-1,disabled:t.isRandom||t.itemData.isPreview,value:t.getVal},on:{input:t.changeValue}})],1)])}),[],!1,null,"0f0328c6",null).exports),ct=n(181);function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht={name:"VideoField",inject:["top"],props:{itemData:{type:Object,default:function(){return{}}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S},data:function(){return{uploading:!1,accept:"video/mp4"}},computed:pt(pt({},Object(c.c)("user",["isLoggedIn"])),{},{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}}),mounted:function(){},beforeDestroy:function(){},methods:{handleBeforeUpload:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["video/mp4"].includes(t.type)){n.next=4;break}return e.$message.error(e.$t("OnlySupportVideo")),n.abrupt("return");case 4:if(!(t.size/1024/1024>100)){n.next=8;break}return e.$message.error(e.$t("UploadImageExceedCustomMB",{number:100})),n.abrupt("return");case 8:return n.next=10,e.handleUploadVideo(t);case 10:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this;return this.uploading=!0,new ct.a({file:t,category:20,maxSize:104857600}).beforeUpload().then((function(t){var n=t.url,o=void 0===n?"":n;e.top.changeVal(pt(pt({},e.idsObj),{},{val:o})),e.uploading=!1})).catch((function(t){e.uploading=!1})).finally((function(){e.uploading=!1}))},handleDelete:function(){this.top.changeVal(pt(pt({},this.idsObj),{},{val:""}))}}},vt=(n(4741),Object(k.a)(ht,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"video-field"},[n("CollapseComponent",{attrs:{title:e.itemData.title,itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}},[e.itemData.val?n("div",{staticClass:"video-field-display"},[n("video",{ref:"mainVideo",staticClass:"video width-height-hundred",attrs:{autoplay:"",muted:"",loop:"",controls:!1,src:null===(t=e.itemData)||void 0===t?void 0:t.val},domProps:{muted:!0}}),e._v(" "),n("i",{staticClass:"iconfont delete-icon icon-shanchu",on:{click:e.handleDelete}})]):n("div",{staticClass:"video-field-upload-box"},[n("el-upload",{attrs:{action:"#",disabled:e.itemData.isPreview,"before-upload":e.handleBeforeUpload,"show-file-list":!1,accept:e.accept,"http-request":function(){}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"uploader"},[n("i",{staticClass:"el-icon-plus"})])])],1)])],1)}),[],!1,null,"4df31517",null).exports),ft=n(584),mt=n(289);function gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var yt={name:"AudioField",inject:["top"],props:{itemData:{type:Object,default:function(){return{}}},currentWorkFlow:{type:Object,default:function(){}}},components:{CollapseComponent:S,CAudio:mt.default},data:function(){return{uploading:!1,accept:"audio/mp3,audio/wav,audio/ogg,audio/aac,audio/mpeg,audio/flac"}},computed:_t(_t({},Object(c.c)("user",["isLoggedIn"])),{},{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}}),mounted:function(){},beforeDestroy:function(){},methods:{handleBeforeUpload:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["audio/mp3","audio/wav","audio/ogg","audio/aac","audio/mpeg","audio/flac"].includes(t.type)){n.next=4;break}return e.$message.error(e.$t("OnlySupportAudio")),n.abrupt("return");case 4:if(!(t.size/1024/1024>150)){n.next=8;break}return e.$message.error(e.$t("audioUploadMaxError")),n.abrupt("return");case 8:return n.next=10,e.handleUploadVideo(t);case 10:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this;return this.uploading=!0,new ft.a({file:t,category:59,maxSize:157286400}).beforeUpload().then((function(t){var n=t.url,o=void 0===n?"":n;e.top.changeVal(_t(_t({},e.idsObj),{},{val:o})),e.uploading=!1})).catch((function(t){e.uploading=!1})).finally((function(){e.uploading=!1}))},handleDelete:function(){this.top.changeVal(_t(_t({},this.idsObj),{},{val:""}))}}},bt=(n(4742),Object(k.a)(yt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"audio-field"},[n("CollapseComponent",{attrs:{title:e.itemData.title,itemData:e.itemData,currentWorkFlow:e.currentWorkFlow}},[e.itemData.val?n("div",{staticClass:"audio-field-display"},[n("CAudio",{attrs:{audio:{url:null===(t=e.itemData)||void 0===t?void 0:t.val},isShowDownload:!1}}),e._v(" "),n("div",{staticClass:"delete-icon-box flex-center",on:{click:e.handleDelete}},[n("i",{staticClass:"iconfont delete-icon icon-shanchu"})])],1):n("div",{staticClass:"audio-field-upload-box"},[n("el-upload",{attrs:{action:"#",disabled:e.itemData.isPreview,"before-upload":e.handleBeforeUpload,"show-file-list":!1,accept:e.accept,"http-request":function(){}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"uploader"},[n("i",{staticClass:"el-icon-plus"})])])],1)])],1)}),[],!1,null,"d4521fc4",null)),wt=bt.exports;installComponents(bt,{CAudio:n(289).default});var Ct=n(402),kt=n(412),Ot=n(626),xt=n(27),Tt=n(35),St=n.n(Tt);function Dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var It={name:"CodeViewer",mixins:[Ct.a],inject:["top"],props:{codeViewData:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},isCreate:{type:Boolean,default:!1},isShowPrevite:{type:Boolean,default:!1},workFlowTabList:{type:Array,default:function(){return[]}},currentWorkFlow:{type:Object,default:function(){}}},components:{InputField:O,ImageField:N,CheckpointField:H,LoraField:J,SliderField:Z,SelectField:nt,SeedField:lt,VideoField:vt,AudioField:wt,PreviteSwitchEle:kt.a,SwitchWorkFlowApp:Ot.default},data:function(){return{storagekey:"ai_app_field_guest",id:this.$route.params.id,index:0,isHavePendingTask:!1}},computed:Pt(Pt(Pt(Pt({},Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("payment",["paymentInfo"])),Object(c.e)("app",["ABInfo"])),{},{isControlGuest:function(){return"A"==this.ABInfo.ai_app_detail_related_works_login},getCodeStyle:function(){return{height:this.height}},isShowConsume:function(){var t;return 4==(null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.source)},isShowEstimateCoins:function(){var t=this.top||{},data=t.workFlowTabList[t.workFlowIndex];return 0!==(null==data?void 0:data.estimateCoins)},getEstimatedCost:function(){var t=this.codeViewData.find((function(t){var e=t.field,n=t.node_type;return"model"==e&&"SeaArtSD3"==n}));return"sd3-turbo"==(null==t?void 0:t.val)?30:45},getEstimateCoins:function(){var t;if(null!==(t=this.top)&&void 0!==t&&t.workFlowAppData){var e,n,o=this.top||{},r=o.workFlowTabList,l=o.workFlowIndex,c=o.workFlowList,d=r[l]||{},h=d.labels,v=d.estimateCoins,f=(null==c||null===(e=c[l])||void 0===e?void 0:e.inputs)||[],m=0;return null!=f&&f.length&&f.forEach((function(t){m+=t.estimateCoins||0})),{estimate_coins:m||v||0,discount:(null==h||null===(n=h[0])||void 0===n||null===(n=n.match(/^.*?%/))||void 0===n?void 0:n[0])||""}}return{estimate_coins:0,discount:""}},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount}}),watch:{isLoggedIn:function(){this.handleGuestStorageField(),this.handlePending()}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.handleGuestStorageField(),e.prev=1,e.next=4,t.loadCaptcha();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("Google Captcha failed to load or execute",e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))()},methods:{handlePending:function(){this.isHavePendingTask&&this.isLoggedIn&&(this.isHavePendingTask=!1,this.handleGenerate())},changeWorkflow:function(t){this.index=t,this.$emit("changeWorkflow",t)},handleGuestStorageField:function(){var t=this;if(this.isLoggedIn){var e=this.$route.params.id,n=localStorage.getItem("".concat(this.storagekey)),r=n?JSON.parse(n):{},l=[];for(var c in r){var d=St()(r[c])||[];l.push.apply(l,Object(o.a)(d)),delete r[c]}for(var h=function(){var input=t.codeViewData[i],n=input.node_id,o=input.node_type,r=l.find((function(t){return e===t.id&&t.nodeId===n&&t.nodeType===o}));if(!r||input.val)return 1;t.$set(input,"val",r.url)},i=0;i<this.codeViewData.length;i++)h();this.saveGuestStorageField(l.map((function(t){return{category:t.category,url:t.url,width:t.width,height:t.height}})),!0)}},saveGuestStorageField:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=t&&t.length){var o={items:t};Object(xt.b)(o).then((function(){n&&localStorage.removeItem("".concat(e.storagekey))}))}},fieldMap:function(){var t=this,e=this.$createElement;return this.codeViewData.map((function(n){var o=n.type,r=n.node_id,l=n.node_type,c=n.field,d="".concat(t.index,"_").concat(r,"_").concat(l,"_").concat(c),h=[e(O,{class:"item-component",attrs:{itemData:n,currentWorkFlow:t.currentWorkFlow,index:t.index},key:d}),e(N,{class:"item-component",attrs:{itemData:n,storagekey:t.storagekey,currentWorkFlow:t.currentWorkFlow,index:t.index},on:{uploadSuccess:t.saveGuestStorageField},key:d}),e(H,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d}),e(J,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d}),e(Z,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d}),e(nt,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d}),e(lt,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d,ref:"seedField"}),e(vt,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d}),e(wt,{class:"item-component",attrs:{currentWorkFlow:t.currentWorkFlow,itemData:n},key:d})];return(null==h?void 0:h[o-1])||""}))},checkAllFields:function(){var t=this;return new Promise((function(e,n){for(var o=[],r=!0,l=function(){var e=t.codeViewData[i],n=e.field,l=e.node_id,c=e.node_type,d=e.val,h=e.value_type,title=e.title;if(!d)return r=!1,setTimeout((function(){t.$message.warning(t.$t("collectCreate11",{name:"[".concat(title,"]")}))}),100*i),1;switch(h){case 1:d+="";break;case 2:d=Number(Math.round(d));break;case 3:d=Number(d)}o.push({field:n,node_id:l,node_type:c,val:d})},i=0;i<t.codeViewData.length;i++)l();r?e(o):n()}))},handleGenerate:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,h,v,f,m,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isCreate){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.checkAllFields();case 4:return v=e.sent,f=(null===(n=t.$route.params)||void 0===n?void 0:n.id)||"",e.next=8,t.updateCaptcha("cmfy_app");case 8:(null===(r=t.$refs)||void 0===r||null===(r=r.seedField)||void 0===r?void 0:r.isRandom)&&(null===(c=t.$refs)||void 0===c||null===(c=c.seedField)||void 0===c||c.changeSeedMode("random")),(m=JSON.parse(JSON.stringify(t.$parent.tabList)))[1].icon="el-icon-loading",t.$parent.tabList=m,_={apply_id:f,inputs:v,ver_no:1==t.index?null===(h=t.workFlowTabList)||void 0===h||null===(h=h[1])||void 0===h?void 0:h.verNo:void 0},t.captchaToken&&(_.g_recaptcha_token=t.captchaToken),t.isLoggedIn||(_.g_mode=1,t.$logEvent("log_actions",{operation:"click_generate",entity_type:t.isControlGuest?"new_artwork_login_restriction_removed":"old_artwork_login_restriction",behavior_info:"on_swift_ai_detail_page",behavior_info_sub:"guest_visit"})),Object(d.f)(_).then((function(e){var n,r=e.data,c=r.id,d=r.scene,h=void 0===d?"":d,code=e.status.code,v={70010:["showBreakDialog","VipTip","basic"],70039:["showVipComputingDialog","vipDialogComputedTit2",{fromVideo:"video_task_generate"===h}],80008:t.isVip?["showVipComputingDialog","",{fromVideo:"video_task_generate"===h}]:["showNotVipComputingDialog"]};if(code&&v[code])(n=t.$EventBus).$emit.apply(n,Object(o.a)(v[code]));else if(c){var m,_=[Object(l.a)(Object(l.a)({id:c,process:0,components:[],expiration_time:0,deduction_detail:{},create_at:0,creativity:{},status_desc:"waiting",status:1},"creativity",{name:null===(m=t.top)||void 0===m||null===(m=m.workFlowAppData)||void 0===m?void 0:m.name,id:f}),"speed_type",t.isVip?2:1)];t.$emit("createTask",_)}})).catch((function(e){2e4==e.code&&(t.isHavePendingTask=!0),console.log("err",e),t.$parent.tabList[1].icon=""}));case 16:case"end":return e.stop()}}),e)})))()}},render:function(){var t,e,n,o,r,l=this,c=arguments[0],d=c("el-tooltip",{class:"item",attrs:{effect:"dark",content:this.$t("workFlow31"),placement:"top"}},[c("span",{class:"el-icon-question generate-tips"})]),h=c("div",{class:"estimated-cost"},["(",this.$t("expend"),": ",this.getEstimatedCost," ",this.$t("coin"),")"]),v=c("div",{class:"estimate-coins"},[this.getEstimateCoins.discount?c("span",{class:"estimate-coins-sub"},[c("i",{class:"iconfont icon-trail-fast-queue estimate-coins-sub-icon"}),c("span",{class:"estimate-coins-sub-delete-text"},[(this.getEstimateCoins.estimate_coins/(1-parseFloat(this.getEstimateCoins.discount.replace("%",""))/100)).toFixed(2)]),c("span",{class:"estimate-coins-sub-normal-text"},[this.getEstimateCoins.estimate_coins])]):c("span",["(",this.$t("estimatedCost"),":",this.getEstimateCoins.estimate_coins,")"])]),f=function(t,e,text){if(e){var n={free:"free-guest-mode-badge",discount:"discount-badge"};return c("span",{class:n[t]},[c("span",{class:"".concat(n[t],"-text")},[text])])}},m=c("el-button",{class:"generate-btn flex-center",on:{click:this.handleGenerate},attrs:{"data-event":"ai-app-detail-generate-btn","data-group":"ai-app-detail","data-id":"".concat(null===(t=this.currentWorkFlow)||void 0===t?void 0:t.id,"@").concat(null===(e=this.currentWorkFlow)||void 0===e?void 0:e.ver_no),"data-desc":"ai应用创作按钮"}},[(o=((null===(n=l.top)||void 0===n?void 0:n.workFlowAppData)||{}).is_free_guest_mode,r=l.getEstimateCoins.discount,c("div",{class:"flex-center"},[f("free",o,l.$t("blog_try")),f("discount",l.isLoggedIn&&r,"".concat(r," Off")),c("span",{class:"txt"},[l.$t("Generate")]),l.isLoggedIn&&!l.isShowConsume&&(l.isShowEstimateCoins?v:d)])),this.isLoggedIn&&this.isShowConsume&&h]),_=c("el-tooltip",{class:"item",attrs:{effect:"dark",content:this.$t("ForReferenceOnly"),placement:"top"}},[c("el-button",{class:"generate-btn flex-center not-create"},[c("span",{class:"txt"},[this.$t("Generate")])])]);return c("div",{class:"code-viewer",style:this.getCodeStyle},[c("div",{class:"items-component width-height-hundred"},[this.workFlowTabList.length>1&&c(Ot.default,{attrs:{tabList:this.workFlowTabList},on:{change:this.changeWorkflow},model:{value:l.index,callback:function(t){l.index=t}}}),c(kt.a,{attrs:{isShowPrevite:this.isShowPrevite}}),this.fieldMap()]),this.isCreate?m:_])}},$t=It,jt=(n(4743),Object(k.a)($t,undefined,undefined,!1,null,"53387d78",null));e.a=jt.exports},896:function(t,e,n){"use strict";var o={name:"NoticeTag",props:{type:{type:String,default:""}},computed:{text:function(){return this.$t(this.type)||this.$t("noticeSystem")},tagStyle:function(){return{blue:{backgroundColor:"#233549",color:"#9dcef4"},red:{backgroundColor:"#342122",color:"#FF97A0"},pink:{backgroundColor:"#332b40",color:"#d0bfff"},green:{backgroundColor:"#273e30",color:"#c0e9c6"},yellow:{backgroundColor:"#453218",color:"#f1e6b5"}}[{notion_system_sub1:"blue",notion_system_sub2:"yellow",notion_system_sub3:"blue",notion_system_sub4:"green",notion_system_sub5:"pink",notion_system_sub6:"pink",notion_system_sub7:"green",notion_system_sub8:"yellow",notion_system_sub9:"red",notion_system_sub10:"red",notion_system_sub11:"red"}[this.type]||"blue"]}}},r=(n(3885),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"tag-item",style:t.tagStyle},[t._v(t._s(t.text))])])}),[],!1,null,"016d0ad0",null);e.a=component.exports},905:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=(n(73),n(22),n(24),n(1));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"publishTopBar",props:{type:{type:String,default:"workflow"},currentStep:{type:Number,default:2}},data:function(){return{stepList:[{value:1,text:this.$t("app_publish_step_one")},{value:2,text:this.$t("app_publish_step_two")}]}},computed:c(c({},Object(r.e)("user",["userInfo"])),Object(r.c)("user",["isLoggedIn"])),mounted:function(){},methods:{goPersonal:function(){window.open(this.localePath({path:"/personal",query:{tab:"WorkflowAIAPP"}}),"_blank")},handleViewTutorial:function(){window.open("https://docs.seaart.ai/seaart-comfyui-wiki/how-to-publish-as-an-ai-app","_blank")},backPreview:function(){this.$emit("changePageType","workflow")},openLogin:function(){this.$EventBus.$emit("openLoginDialog")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")}}},h=(n(4713),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-publish-top-bar"},[e("div",{staticClass:"publish-top-bar-title"},[e("div",{staticClass:"back-preview-btn",on:{click:function(e){return e.stopPropagation(),t.backPreview.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"publish-top-bar-title-text"},[t._v("\n      "+t._s("workflow"===t.type?t.$t("PublishAsWorkflow"):t.$t("PublishAsAiApp"))+"\n    ")])]),t._v(" "),"workflow"!==t.type?e("div",{staticClass:"steps"},[t._l(t.stepList,(function(n,o){return[e("div",{key:o,staticClass:"step-item",class:{"step-active":t.currentStep===n.value}},[e("div",{staticClass:"step-icon"},[t.currentStep>n.value?e("i",{staticClass:"el-icon-check"}):t._e(),t._v(" "),1==n.value&&t.currentStep>n.value?t._e():e("span",{staticClass:"step-number"},[t._v(t._s(o+1))])]),t._v(" "),e("div",{staticClass:"step-text"},[t._v(t._s(n.text))])]),t._v(" "),o<t.stepList.length-1?e("div",{staticClass:"step-line",class:{"step-line-active":t.currentStep>1}}):t._e()]}))],2):t._e(),t._v(" "),e("div",{staticClass:"right-info"},[e("div",{staticClass:"publish-tutorial",on:{click:t.handleViewTutorial}},[e("svg-icon",{staticClass:"icon-tutorial",attrs:{"icon-class":"icon_tutorial"}}),t._v("\n      "+t._s(t.$t("ViewTutorial"))+"\n    ")],1),t._v(" "),t.isLoggedIn?e("div",{staticClass:"tavern-top-bar-info"},[e("div",{staticClass:"user-info"},[e("client-only",[e("div",{staticClass:"avatar",class:[t.userInfo.head?"":"avatar-color"],on:{click:t.goPersonal}},[t.userInfo.head?e("img",{attrs:{src:t.userInfo.head,alt:"avatar"}}):e("div",[t._v("\n              "+t._s(t.initials(t.userInfo.name?t.userInfo.name:t.userInfo.id))+"\n            ")])])])],1)]):t._e(),t._v(" "),e("client-only",[t.isLoggedIn?t._e():e("div",{staticClass:"log-btn",on:{click:function(e){return e.stopPropagation(),t.openLogin()}}},[t._v(t._s(t.$t("Login")))])])],1)])}),[],!1,null,"442c6a60",null);e.a=component.exports;installComponents(component,{SvgIcon:n(115).default})},906:function(t,e,n){"use strict";n(16),n(28),n(44);var o={name:"effectExampleItem",props:{source:{type:Object,default:function(){return{}}}},computed:{getImageUrl:function(){var t,e,n,o=(null===(t=this.source)||void 0===t?void 0:t.url)||"";if([2,"2"].includes(null===(e=this.source)||void 0===e?void 0:e.type)&&null!==(n=this.source)&&void 0!==n&&n.url){o=this.source.url.replace(/\.(mp4)/g,"_low.webp")}return o}},data:function(){return{imageLoading:!1}},methods:{removeImage:function(){this.$emit("removeImage",this.source)},handleImageLoad:function(t){var e=0,n=0;try{e=t.target.naturalWidth,n=t.target.naturalHeight}catch(t){}this.$emit("updateInfo",{width:e,height:n})},handleImageLoadError:function(){this.imageLoading=!1}}},r=(n(4714),n(0)),component=Object(r.a)(o,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-work-flow-effect-example-item"},[[null!==(t=e.source)&&void 0!==t&&t.url?n("img",{attrs:{src:e.getImageUrl,alt:""},on:{load:e.handleImageLoad,error:e.handleImageLoadError}}):e._e()],e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.imageLoading,expression:"!imageLoading"}],staticClass:"el-image-viewer__close",on:{click:function(t){return t.stopPropagation(),e.removeImage.apply(null,arguments)}}},[n("i",{staticClass:"el-icon-close"})])],2)}),[],!1,null,"c8ca85d4",null);e.a=component.exports},907:function(t,e,n){"use strict";n(50),n(49),n(24),n(4);var o=n(206),r={name:"exampleImgList",props:{iconBntWidth:{type:Number,default:36},moveLeng:{type:Number,default:140},sourceList:{type:Array,default:function(){return[]}}},data:function(){return{list:[],selectList:[],isShowLeft:!0,isShowRight:!0,savedScrollLeft:0,activeIndex:0}},mounted:function(){var t=this;this.selectList=[],window.addEventListener("resize",this.setMoveBtnShow),this.$refs.scrollArea.addEventListener("scroll",this.setMoveBtnShow),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollArea.removeEventListener("scroll",t.setMoveBtnShow),window.removeEventListener("resize",t.setMoveBtnShow)}))},beforeDestroy:function(){this.loading=!1},updated:function(){var t=this;this.$nextTick((function(){t.setMoveBtnShow()}))},methods:{getList:function(){var t=this;this.loading=!0,Object(o.k)({}).then((function(e){var n=((null==e?void 0:e.data)||{}).items,o=void 0===n?[]:n;t.list=o&&Array.isArray(o)?o:[]})).finally((function(){t.loading=!1}))},handleSelect:function(){this.activeIndex++;var t=this.activeIndex>this.sourceList.length?0:this.activeIndex;this.$emit("changeSelect",t)},clearSelect:function(){this.selectList=[],this.$emit("selectList",this.selectList)},setMoveBtnShow:function(){var t,e,n=this.$refs.scrollArea||{};n<=(null===(t=this.$refs.tags)||void 0===t?void 0:t.offsetWidth)&&(this.isShowRight=!1),0===n.scrollLeft?this.isShowLeft=!1:this.isShowLeft=!0,Math.ceil(n.scrollLeft)+n.clientWidth>=n.scrollWidth?this.isShowRight=!1:this.isShowRight=!0,this.savedScrollLeft=null===(e=this.$refs.scrollArea)||void 0===e?void 0:e.scrollLeft},tagsMove:function(t){this.$refs.scrollArea.scrollBy({left:t,behavior:"smooth"}),this.setMoveBtnShow()}}},l=(n(4715),n(0)),component=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{ref:"tags",staticClass:"c-example-img-list"},[e("div",{staticClass:"swipeab-icon-box swipeab-icon-box-left",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove("-"+t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-left"})])]),t._v(" "),e("div",{ref:"scrollArea",staticClass:"scroll-area"},[e("div",{staticClass:"scroll-area-list"},t._l(t.sourceList,(function(n,o){return e("div",{key:o,staticClass:"tavern-tag-item",class:[t.activeIndex===o?"tavern-tag-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleSelect(n,o)}}},[e("img",{attrs:{src:n.url,alt:""}})])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowRight,expression:"isShowRight"}],staticClass:"swipeab-icon-box swipeab-icon-box-right",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove(t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"d230ea72",null);e.a=component.exports},908:function(t,e,n){"use strict";n(18);var o=n(14),r=(n(50),n(16),n(49),n(4),n(26),n(133)),l=n(57),c=n(25),d=(n(5694),{name:"historyRecordModal",props:{canExec:{type:Boolean,default:!1}},data:function(){return{visible:!1,list:[],hasMore:!0,loading:!1,debounceHandleScroll:null,showScroll:!0,activeId:"",nowTime:new Date}},computed:{formatDate:function(t){var e=this;return function(t){if(!t)return"";var n=new Date(t),o=e.nowTime.getTime()-n.getTime(),r=Math.floor(o/1e3),l=Math.floor(o/6e4),c=Math.floor(o/36e5),d=Math.floor(o/864e5);return r<60?e.$t("workFlow9",{num:r}):l<60?e.$t("workFlow6",{num:l}):c<24?e.$t("workFlow7",{num:c}):e.$t("workFlow8",{num:d})}}},mounted:function(){var t=this;this.interval=setInterval((function(){t.$set(t,"nowTime",new Date)}),6e4),this.initScrollBar(),this.debounceHandleScroll=Object(c.debounce)(this.handleScroll,600),this.getList()},beforeDestroy:function(){this.interval&&clearInterval(this.interval),this.debounceHandleScroll=null},methods:{openModal:function(){this.resetData(),this.getList(),this.visible=!0},handleSelect:function(t){!this.canExec||null!=t&&t.can_exec?(this.activeId=null==t?void 0:t.id,this.$emit("loadJson",this.activeId),this.handleClose()):this.$message.warning(this.$t("app_publish_add_workflow_valid"))},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},resetData:function(){this.list=[],this.loading=!1,this.hasMore=!0,this.activeId=""},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.update_at:"";this.getList(e)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={limit:20};["",null,void 0].includes(e)||(n.time_from=e),this.loading=!0,Object(r.e)(n).then((function(e){var r=(null==e?void 0:e.data)||{},c=r.items,d=void 0===c?[]:c,h=r.has_more,v=void 0===h||h;if(t.hasMore=v,null!=n&&n.time_from){var f,m,_=Object(l.objectArrayDeduplicationMerge)(t.list,d||[]),y=null===(f=t.$refs)||void 0===f||null===(f=f.scrollWrapper)||void 0===f?void 0:f.scrollHeight;(m=t.list).push.apply(m,Object(o.a)(_)),y&&_.length&&t.scrollToTop(y,"instant")}else t.list=Array.isArray(d)&&null!=d&&d.length?d:[],t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleClose:function(){this.visible=!1},handleDelete:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n&&(null==n?void 0:n.id)===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.workId)||this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){Object(r.c)({id:null==n?void 0:n.id}).then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var r=(e.list||[]).findIndex((function(t){return(null==t?void 0:t.id)===n.id}));e.list.splice(r,1),(null==n?void 0:n.id)===e.activeId&&(e.activeId=""),e.$emit("removeQuery",null==n?void 0:n.id)}}))})).catch((function(){}))},handleEdit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this;this.$prompt(this.$t("workFlow49"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"custom-confirm",inputValue:null==t?void 0:t.name,inputPlaceholder:e.$t("pleaseEnte")}).then((function(n){var o=n.value;e.handleEditTitle(t,o)})).catch((function(){}))},handleCopy:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n={action:3,id:e.id};return Object(r.q)(n).then((function(n){var o=((null==n?void 0:n.data)||{}).work_flow,r=void 0===o?null:o;r&&(r.node_num=e.node_num,t.list.unshift(r),t.$message.success(t.$t("CopySuccess")))})).finally((function(){}))},handleEditTitle:function(t,e){var n=this;if(e!==(null==t?void 0:t.name)&&!["",null,void 0].includes(e)){var o={id:t.id,name:e};Object(r.p)(o).then((function(o){var r;1e4===(null==o||null===(r=o.status)||void 0===r?void 0:r.code)&&(n.$set(t,"name",e),n.$message.success(n.$t("SuccessfullyModified")))}))}}}}),h=d,v=(n(4720),n(0)),component=Object(v.a)(h,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"workflow-history-record-modal",attrs:{title:t.$t("workFlow20"),visible:t.visible,width:"563px","before-close":t.handleClose,"append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"history-record-list",on:{scroll:t.debounceHandleScroll}},t._l(t.list,(function(n){var o,r;return e("div",{key:n.id,staticClass:"history-record-list-item",class:[(null==n?void 0:n.id)===t.activeId&&"history-record-list-item-active"],on:{click:function(e){return t.handleSelect(n)}}},[e("div",{staticClass:"history-record-list-item-left"},[e("div",{staticClass:"history-record-list-item-img"},[e("img",{attrs:{src:(null==n||null===(o=n.cover)||void 0===o?void 0:o.url)||"https://image.cdn2.seaart.ai/static/upload/20240316/b3b9ad7e-1ba1-467b-b48e-fe3b38719370_low.webp",alt:""}})]),t._v(" "),e("div",{staticClass:"list-item-content"},[e("div",{staticClass:"list-item-content-title"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"list-item-content-sub-title"},[e("span",{staticClass:"list-item-content-sub-title-1"},[t._v(t._s((null==n?void 0:n.node_num)||0)+" Nodes")]),t._v(" "),e("span",{staticClass:"list-item-content-sub-title-split"},[t._v("·")]),t._v(" "),e("span",{staticClass:"list-item-content-sub-title-2"},[t._v(t._s(t.formatDate(null==n?void 0:n.update_at)))])])])]),t._v(" "),(null==n?void 0:n.id)===(null===(r=t.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.workId)||t.canExec?t._e():e("div",{staticClass:"history-record-list-item-right"},[e("span",{staticClass:"el-icon-edit-outline operate-icon",on:{click:function(e){return e.stopPropagation(),t.handleEdit(n)}}}),t._v(" "),e("span",{staticClass:"el-icon-copy-document operate-icon",on:{click:function(e){return e.stopPropagation(),t.handleCopy(n)}}}),t._v(" "),e("span",{staticClass:"el-icon-delete delete-icon",on:{click:function(e){return e.stopPropagation(),t.handleDelete(n)}}})]),t._v(" "),t.canExec&&n.can_exec?e("div",{staticClass:"history-record-list-item-right"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleSelect(n)}}},[t._v(t._s(t.$t("workflow_clues_add")))])],1):t._e()])})),0)])}),[],!1,null,null,null);e.a=component.exports},909:function(t,e,n){"use strict";n(28),n(44),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(19),n(16),n(18),n(4),n(201)),l=n(316),c=n(10),d=n(1),h=n(635),v=n(557),f=n(75),m=n(9);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={mixins:[h.taskMixin],components:{WaterFallVue:r.default},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{replaceImageType:c.K,copyTextToClipboard:c.g,dialogVisible:!1,dataIndex:0,loading:!1,info:{},isI18nToggled:!1,rmdList:[],queryParam:{page:1,page_size:12,style:"",time_to:0},dotReportInfo:{category:"default",view_domain:"studio_style",batch_id:""}}},computed:y(y({},Object(d.c)("user",["isLoggedIn","userInfo","accountSettingsData"])),{},{setI18nPrompt:function(){var t=this.info.meta?this.info.meta.prompt:"",e=this.info.local_prompt;return this.isI18nToggled?e:t}}),watch:{dialogVisible:{handler:function(t){t||(this.info={},this.rmdList=[])}},accountSettingsData:{handler:function(t){this.isI18nToggled=!t.is_off_localization},deep:!0}},mounted:function(){this.isI18nToggled=!this.accountSettingsData.is_off_localization},methods:{jumpToStyleList:function(){var t;if(console.log(this.info,"this.info----"),!["",null,void 0].includes(null===(t=this.list[this.dataIndex])||void 0===t?void 0:t.key)){var e,n="".concat(location.origin,"/studio?style_type=").concat(null===(e=this.list[this.dataIndex])||void 0===e?void 0:e.key);window.open(n,"_blank")}},show:function(t){this.dialogVisible=!0,this.dataIndex=t,this.getDetail()},onTry:function(){if(this.isLoggedIn){this.dialogVisible=!1;var t=Object.assign({},this.info);t.logEventSource=Object(m.Y)(this.$route.name),this.$EventBus.$emit("openGenerate",{action:1,data:{source:t}})}else this.$EventBus.$emit("openLoginDialog")},changeData:function(t){"previous"==t&&(0==this.dataIndex?this.dataIndex=this.list.length-1:this.dataIndex=this.dataIndex-1),"next"==t&&(this.dataIndex==this.list.length-1?this.dataIndex=0:this.dataIndex=this.dataIndex+1),this.info={},this.rmdList=[],this.$nextTick((function(){Object(f.a)(document.body,"el-popup-parent--hidden")})),this.getDetail()},getDetail:function(){var t=this;this.loading||(this.loading=!0,Object(l.b)({id:this.list[this.dataIndex].art_id}).then((function(e){1e4===e.status.code&&(t.info=e.data,t.getList())})).finally((function(){t.loading=!1})))},getList:function(){var t,e=this;this.queryParam.style=null===(t=this.info)||void 0===t?void 0:t.style,Object(v.b)(this.queryParam).then((function(t){1e4===t.status.code&&(e.rmdList=t.data.items||[])}))},wordsCopy:function(){var t,e,n=null!==(t=this.info)&&void 0!==t&&t.meta?this.info.meta.prompt:"",o=null===(e=this.info)||void 0===e?void 0:e.local_prompt;this.copyTextToClipboard(this.isI18nToggled?o:n),this.$message.success(this.$t("CopySuccess"))},imgCanUpscale:function(){var t,e;return[null===(t=this.info)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.width,null===(e=this.info)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.height].every((function(t){return 2*t<=4096}))},handleQuickOperate:function(t){var e,n,o,r;if(this.isLoggedIn){this.dialogVisible=!1;var l={};switch(l.art_work_no=null!==(e=this.info)&&void 0!==e&&e.art_work_no?null===(n=this.info)||void 0===n?void 0:n.art_work_no:null===(o=this.info)||void 0===o?void 0:o.id,t){case"extra-upscale":this.imgCanUpscale?(l.action=6,this.fastOperateTask(l)):this.$message.warning(this.$t("ImageSizeExceedsError"));break;case"remove-background":l.action=7,l.removeBgUrl=(null===(r=this.info)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)||"",this.fastOperateTask(l)}}else this.$EventBus.$emit("openLoginDialog")}}},C=(n(4806),n(4807),n(0)),component=Object(C.a)(w,(function(){var t,e,n,o,r,l,c,d=this,h=d._self._c;return h("el-dialog",{attrs:{visible:d.dialogVisible,"custom-class":"studioImageInfo",fullscreen:!0,"show-close":!1},on:{"update:visible":function(t){d.dialogVisible=t}}},[h("div",{staticClass:"main"},[h("div",{staticClass:"changeBnt left",on:{click:function(t){return d.changeData("previous")}}},[h("i",{staticClass:"el-icon-arrow-left"})]),d._v(" "),h("div",{staticClass:"changeBnt right",on:{click:function(t){return d.changeData("next")}}},[h("i",{staticClass:"el-icon-arrow-right"})]),d._v(" "),h("div",{staticClass:"changeBnt"}),d._v(" "),h("div",{staticClass:"cnt"},[h("i",{staticClass:"el-icon-close",on:{click:function(t){d.dialogVisible=!1}}}),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.loading,expression:"loading"}],staticClass:"cntinfo"},[d.info.id?h("div",{staticClass:"img",class:{"bg-nsfw":1===(null===(t=d.info.banner)||void 0===t?void 0:t.nsfw)}},[h("div",{staticClass:"bntBng"}),d._v(" "),h("div",{staticClass:"bntBox"},[h("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:d.$t("ExtraUpscale"),placement:"top"}},[h("div",{staticClass:"bnts",on:{click:function(t){return d.handleQuickOperate("extra-upscale")}}},[h("i",{staticClass:"iconfont icon-upload-image-icon"})])]),d._v(" "),h("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:d.$t("RemoveBackground"),placement:"top"}},[h("div",{staticClass:"bnts",on:{click:function(t){return d.handleQuickOperate("remove-background")}}},[h("i",{staticClass:"iconfont icon-work-remove-background"})])])],1),d._v(" "),1!==(null===(e=d.info.banner)||void 0===e?void 0:e.nsfw)?h("el-image",{attrs:{src:d.replaceImageType(null===(n=d.info.banner)||void 0===n?void 0:n.url,"low"),fit:"cover","preview-src-list":[null===(o=d.info.banner)||void 0===o?void 0:o.url]}}):d._e()],1):d._e(),d._v(" "),d.info.id?h("div",{staticClass:"infos"},[h("div",{staticClass:"name"},[d._v("\n            "+d._s(d.$t("labStyleType_".concat(null===(r=d.list[d.dataIndex])||void 0===r||null===(r=r.key)||void 0===r?void 0:r.replace(/\s/g,""))))+"\n          ")]),d._v(" "),h("div",{staticClass:"line",staticStyle:{margin:"12px 0 0 0"}}),d._v(" "),h("div",{staticClass:"promptTit"},[d._v(d._s(d.$t("Prompt")))]),d._v(" "),h("div",{staticClass:"promptTxt"},[d._v(d._s(d.setI18nPrompt))]),d._v(" "),h("div",{staticClass:"bnt"},[h("div",{staticClass:"bntItem",on:{click:d.wordsCopy}},[h("i",{staticClass:"iconfont icon-copy"}),d._v(" "),h("span",[d._v(d._s(d.$t("CopyPrompts")))])]),d._v(" "),h("div",{staticClass:"bntItem",on:{click:function(t){d.isI18nToggled=!d.isI18nToggled}}},[h("i",{staticClass:"iconfont icon-i18n_prompt",staticStyle:{color:"#93a2b6","margin-right":"12px"}}),d._v(" "),h("span",[d._v(d._s(d.$t("translate")))])])]),d._v(" "),h("div",{staticClass:"line"}),d._v(" "),h("div",{staticClass:"otherInfo"},[h("div",{staticClass:"otherItem"},[h("div",[d._v(d._s(d.$t("Size")))]),d._v(" "),h("div",[d._v(d._s((null===(l=d.info.banner)||void 0===l?void 0:l.width)+"*"+(null===(c=d.info.banner)||void 0===c?void 0:c.height)))])]),d._v(" "),h("div",{staticClass:"otherItem"},[h("div",[d._v(d._s(d.$t("createModeTitle")))]),d._v(" "),h("div",[d._v(d._s(d.$t("studio")))])])]),d._v(" "),h("div",{staticClass:"tryBox"},[h("div",{staticClass:"try",on:{click:d.onTry}},[d._v(d._s(d.$t("studioTry")))])])]):d._e()]),d._v(" "),h("div",{staticClass:"recommend"},[d.rmdList.length>0?h("div",{staticClass:"tit"},[h("span",[d._v(d._s(d.$t("relatedRecommend")))]),h("span",{staticClass:"view-more",on:{click:function(t){return t.stopPropagation(),d.jumpToStyleList.apply(null,arguments)}}},[d._v(d._s(d.$t("more"))+" "),h("i",{staticClass:"el-icon-arrow-right"})])]):d._e(),d._v(" "),h("div",{ref:"wraperRmdList"},[h("WaterFallVue",{attrs:{type:"artwork",containerForImg:d.$refs.wraperRmdList,list:d.rmdList,dotReportInfo:d.dotReportInfo}})],1)])])])])}),[],!1,null,"47978bd9",null);e.a=component.exports},911:function(t,e,n){"use strict";n(16),n(31),n(18),n(21);var o=n(14),r=n(2),l=(n(19),n(6),n(32),n(398),n(11),n(73),n(22),n(49),n(399),n(8),n(4),n(12),n(13),n(28),n(43),n(44),n(7),n(468)),c=n(1),d=n(379),h=n(201),v=n(894),f=n(912),m=n(606),_=n(27),y=n(35),w=n.n(y),C=n(913),k=n(139),O=n(36),x=n(64),T=n(10),S=n(9),D=n(184),P=n(515),I=n(54),$=n(71);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M=Object(T.B)(),E=M.startTimestamp,F=M.endTimestamp,A=Object(T.C)(),N=A.startTimestamp,R=A.endTimestamp,B=Object(T.A)(),U=B.startTimestamp,V=B.endTimestamp,W={components:{TagList:d.default,WaterFallVue:h.default,stickyTab:v.default,myTags:f.a,SearchInput:m.default,recommendModelList:C.a,HyWaterfallFlowList:x.default,GenderSelect:l.default},filters:{thousandsSeparator:function(t){if("number"!=typeof t)return t;var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},formatNumber:function(t){return Object(T.p)(t)}},mounted:function(){var t,e,n,o=this;this.activeName=(null===(t=this.$route.params)||void 0===t?void 0:t.type)||"artwork",this.getConfit(),this.$logEvent("log_actions",{operation:"enter_tags_detail_page",behavior_info:"on_tags_detail_page",behavior_info_sub:null===(e=this.queryParam)||void 0===e?void 0:e.tag}),this.initList();var r=document.documentElement,l=function(){var t=r.clientWidth;try{o.$refs.tagdetail.style.padding="72px ".concat(t*(100/1920)*.86,"px 0")}catch(t){}};document.addEventListener?window.addEventListener("resize",l,!1):window.attachEvent("onresize",l),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",l)})),this.getTagInfo(null===(n=this.$router.query)||void 0===n?void 0:n.id)},beforeDestroy:function(){console.log("页面销毁++++++++++"),Object(P.a)()},props:{obj:{type:Object,default:function(){return{}}}},data:function(){return{dotReportInfo:{category:"default",view_domain:"Tags",batch_id:""},activeName:this.obj.activeName||"artwork",queryParam:this.obj.queryParam||{},filterShow:!1,fliterLoading:!1,list:this.obj.list||[],nodeList:[],intNodeList:[],isLock:!1,isReq:!1,dialogVisible:!1,addLoading:!1,selectInfo:{ids:[]},isCheck:!1,tagInfoDetail:this.obj.tagInfoDetail||null,tagHoverStatus:!1,collectBtnLoading:!1,reviewType:"artwork",timeName:this.obj.timeName||"All",timeTypeOption:[{name:"All",startTiem:null,endTime:null},{name:"days",startTiem:E,endTime:F},{name:"week",startTiem:N,endTime:R},{name:"months",startTiem:U,endTime:V}],tagIndex:this.obj.tagIndex||"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],modelTypes:S.cb,baseModels:[],baseModelMap:{},modelTypeSelect:[],baseModelSelect:[],listReqFuns:{artwork:O.getWaterHomeArtwork,model:O.getWaterfallModel,post:O.getWaterfallPost,workflow:O.getWaterfallWorkfolw,swiftapp:O.getWaterAiApp,cyberpub:O.getWaterCharacter,lora:O.getWaterfallLoraTrain,designtmp:O.getWaterfallDesignTemp,"ai-video":O.getWaterfallAiVideo,"ai-audio":O.getWaterfallAiAudio,"ai-novel":O.getWaterfallAiEbook},weekHotTab:this.obj.weekHotTab||[],needRotate:this.obj.needRotate||!1,typeArr:[{key:"Graphics",value:"picture"},{key:"Article",value:"article"}]}},computed:L(L(L(L({},Object(c.e)("app",["tagHot","tagNew"])),Object(c.c)("user",["isLoggedIn","isCompanyAccount"])),Object(c.e)("user",["adminOff","userInfo"])),{},{isShowGenderFilter:function(){return"cyberpub"===this.activeName&&!["recommend","recently"].includes(this.tagIndex)},lang:function(){return this.$i18n.locale},statTotal:function(){var t,e=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{};return Object.keys(e).reduce((function(t,n){return t+e[n]}),0)},collectIconClass:function(){return this.tagInfoDetail&&this.tagInfoDetail.is_collect?"icon-edit":"icon-collect"},collectText:function(){return this.tagInfoDetail&&this.tagInfoDetail.is_collect?this.$t("TagEdit"):this.$t("TagCollect")},setTaginfo:function(){return this.tagInfoDetail||{}},renderList:function(){var t;return((null==this||null===(t=this.setTaginfo)||void 0===t?void 0:t.related_tags)||[]).map((function(t){return t.style={},t.style.url=t.cover||"",t.name=t.title||t.id,t}))},setTagShow:function(){var t=this,e=!0;return this.userInfo.tags&&this.userInfo.tags.length>0&&this.userInfo.tags.forEach((function(element){element.id==t.$route.params.tag&&(e=!1)})),e},typeList:function(){var t,e=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{},n=e.num_of_artwork,o=void 0===n?0:n,r=e.num_of_model,l=void 0===r?0:r,c=e.num_of_post,d=void 0===c?0:c,h=e.num_of_swift_app,v=void 0===h?0:h,f=e.num_of_workflow,m=void 0===f?0:f,_=e.num_of_lora_train,y=void 0===_?0:_,w=e.num_of_design_template,C=e.num_of_character,k=void 0===C?0:C,O=e.num_of_ai_video,x=void 0===O?0:O,T=e.num_of_timbre,S=void 0===T?0:T,D=e.num_of_ebook;return[{name:"Work",value:"artwork",num:o},{name:"post_n",value:"post",num:d},{name:"Tavern",value:"cyberpub",num:k},{name:"aiVideName",value:"ai-video",num:x},{name:"AIAudio",value:"ai-audio",num:S},{name:"aiapply",value:"swiftapp",num:v},{name:"Model",value:"model",num:l},{name:"LoRATrain",value:"lora",num:y},{name:"designTemplate",value:"designtmp",num:w},{name:"WorkFlow",value:"workflow",num:m},{name:"aiNovelName",value:"ai-novel",num:void 0===D?0:D}].filter((function(t){return t.num>0}))},checkRun:{get:function(){return 1===this.queryParam.run_available},set:function(t){this.queryParam.run_available=t?1:0}},renderTypeOption:function(){var t=w()(this.typeOption);return["workflow","swiftapp","cyberpub"].includes(this.activeName)&&(t=t.filter((function(t){return"follows"!=t.id&&"recommend"!=t.id}))),t},hideTimeTypeOption:function(){return["recommend","follows"].includes(this.tagIndex)}}),created:function(){this.getBaseModels()},methods:L(L(L({},Object(c.d)("user",["SET_ACCOUNT_DATA"])),Object(c.b)("user",["setAdminOff"])),{},{getBaseModels:function(){var t=this;Object($.a)({scene:3}).then((function(e){var n;1e4===e.status.code&&(t.baseModels=(null===(n=e.data)||void 0===n||null===(n=n.base_model_select_options)||void 0===n?void 0:n.map((function(e){return t.baseModelMap[e.val]=e.vals||[],e.val})))||[])}))},changeGender:function(t){this.queryParam.gender=t,this.intList()},handleFilter:function(t){var e=this.tagInfoDetail,n=e.name,o=void 0===n?"":n,r=e.id,l=o||(void 0===r?"":r);this.$logEvent("log_actions",{operation:"click_post_filter_button",behavior_info:"on_tab_".concat(l,"_detail_page"),behavior_info_sub:t}),this.queryParam.sub_channel=t,this.intList()},filterReset:function(){this.queryParam.sub_channel="",this.intList()},onFilter:function(t,e){var n=this;this.isReq||(1==e?(this.modelTypeSelect.includes(t)?this.modelTypeSelect.forEach((function(e,o){e==t&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(t),this.$logEvent("log_actions",{operation:"click_filter",behavior_info:"on_homepage_model_tab",behavior_info_sub:this.modelTypeSelect||[]})):this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"==this.tagIndex&&(this.tagIndex="hot"),this.intList())},onWorkfolwFilterReset:function(){this.queryParam.tag="",this.queryParam.nodes_type=[],this.queryParam.run_available=0,this.intList()},getConfit:function(){var t,e=this;["workflow","swiftapp"].includes(this.activeName)&&(this.queryParam.run_available=0,this.fliterLoading||null!==(t=this.nodeList)&&void 0!==t&&t.length||(this.fliterLoading=!0,Object(D.b)().then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes,e.intNodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))))},remoteMethod:function(t){var e=this;t?(this.fliterLoading=!0,Object(D.e)({keyword:t}).then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))):this.nodeList=this.intNodeList},nodeListChange:function(t){this.$logEvent("log_actions",{operation:"click_node_on",behavior_info:"on_comfyui_landing_page",behavior_info_sub:t}),this.intList()},onFilterReset:function(){this.isReq||(this.modelTypeSelect=[],this.baseModelSelect=[],this.intList())},initList:function(){var t=this.list;this.setDefaultTab(),t.length&&(this.list=t.map((function(t){return t.status=1,t})))},setDefaultTab:function(){var t,e,n=this;if(!((null===(t=this.typeList.find((function(t){return t.value===n.activeName})))||void 0===t?void 0:t.num)>0)||this.queryParam.gender){this.activeName=(null===(e=this.typeList.find((function(t){return t.num>0})))||void 0===e?void 0:e.value)||this.obj.activeName||"artwork";var o=this.setTabParams();this.timeName=this.weekHotTab.includes(this.activeName)?"week":"All",this.$set(this,"queryParam",o),this.intList()}},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.tagIndex==n.id&&(e=n.icon)})),e},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.time_from=t.startTiem,this.queryParam.time_to=t.endTime,this.$logEvent("log_actions",{operation:"click_".concat(t.name,"_filter"),behavior_info:"on_tags_detail_page"}),this.intList(),"All"!=t.name&&this.$logEvent("log_actions",{operation:" click_time_filter_button",behavior_info:t.name})},handleCommand:function(t){this.tagIndex=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_filter"),behavior_info:"on_tags_detail_page"}),this.intList()},toggleHoverStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tagHoverStatus=t},handleCollect:function(){var t,e,n=this;if(this.$logEvent("log_actions",{operation:"click_collect_tags",behavior_info:"on_tags_detail_page",behavior_info_sub:null===(t=this.queryParam)||void 0===t?void 0:t.tag}),this.isLoggedIn){if(!this.collectBtnLoading)if(null!=this&&null!==(e=this.tagInfoDetail)&&void 0!==e&&e.is_collect)this.$router.push(this.localePath("/settings"));else{var o,r={};r.target_id=this.tagInfoDetail.id,r.target_type="tag";var l=null!=this&&null!==(o=this.tagInfoDetail)&&void 0!==o&&o.is_collect?k.k:k.a;this.collectBtnLoading=!0,l(r).then((function(t){var e,o,r=null!=n&&null!==(e=n.tagInfoDetail)&&void 0!==e&&e.is_collect?n.$t("CancelCollectedTips"):n.$t("TagCollectSuccess");[1e4,"10000"].includes(t.status.code)&&(n.$message.success(r),n.$set(n.tagInfoDetail,"is_collect",!(null!=n&&null!==(o=n.tagInfoDetail)&&void 0!==o&&o.is_collect)))})).finally((function(){n.collectBtnLoading=!1}))}}else this.$EventBus.$emit("openLoginDialog")},onPostBnt:function(){this.$logEvent("log_actions",{operation:"click_to_contribute"}),this.$EventBus.$emit("openContribution",{selectedData:[],types:[I.CONTRIBUTION_TYPE_ENUM.WORK],source:"tag"})},backTo:function(){window.history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/"))},checkType:function(t){var e;this.isReq||this.activeName!==t.value&&(this.activeName=t.value,this.$logEvent("log_actions",{operation:"click_".concat(null===(e=this.queryParam)||void 0===e?void 0:e.tag,"_tags_tab"),behavior_info:"on_tags_detail_page",behavior_info_sub:t.value}),this.getConfit(),this.filterSearch({isTab:!0}),Object(P.b)(t.value,this),this.getList())},changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},getTagInfo:function(t){var e=this,n={id:t||this.$route.params.tag||"landscape"};Object(k.i)(n).then((function(t){var n;if([1e4,"10000"].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data||{};o.style={},o.style.url=o.cover||"",o.name=o.title||o.id,e.tagInfoDetail=o}})).finally((function(){}))},handleBatchSetTag:function(){},handleGetCheckList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectInfo=t},addTgas:function(){var t=this;if(!this.addLoading){this.addLoading=!0;var e={id:this.setTaginfo.id,name:this.setTaginfo.name};Object(_.Jb)({tags:[e]}).then((function(e){if(1e4==e.status.code){var n=w()(t.userInfo);n.tags.push(t.setTaginfo),t.SET_ACCOUNT_DATA(n)}t.addLoading=!1})).catch((function(e){t.addLoading=!1}))}},changeTags:function(t){this.$logEvent("log_actions",{operation:"click_tags",behavior_info:t,behavior_info_sub:"tag_details"}),this.$router.push(this.localePath(null==t?void 0:t.path))},intList:function(){this.list=[],this.isReq=!1,this.isLock=!1,this.queryParam.page=1,this.queryParam.offset=0,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var n=this.getReqParams(),r=this.listReqFuns[this.activeName];Object(P.c)(this.activeName,n,this);var l=function(t){try{return L(L({},t),{},{banner:{url:t.cover||"",nsfw:t.nsfw,width:t.cover_width,height:t.cover_height},status:1},"model"===e.activeName&&{name:t.art_model.name,type:t.art_model.type,base_model:t.art_model.base_model})}catch(e){return t}};r(n).then((function(n){if(1e4===n.status.code){var r=n.data,c=r.has_more,d=r.items,h=void 0===d?[]:d,v=r.offset;if(0!==h.length){e.isLock=!c;var f=(h||[]).map(l);e.list=t?[].concat(Object(o.a)(e.list),Object(o.a)(f)):f,e.queryParam.offset=v,e.queryParam.page++}else e.isReq=!1}})).catch((function(){})).finally((function(){e.isReq=!1}))}},setTabParams:function(t){var e,n,o=w()(S.B[this.activeName]).params,r=(null==o?void 0:o.order_by)||(this.isLoggedIn?"top":"hot"),l=Object(T.C)(),c=l.startTimestamp,d=l.endTimestamp,h=this.weekHotTab.includes(this.activeName)?c:null,v=this.weekHotTab.includes(this.activeName)?d:null;"cyberpub"===this.activeName&&(o.gender=this.queryParam.gender||(null===(e=localStorage.getItem("userInfo"))||void 0===e||null===(e=e.character_setting)||void 0===e?void 0:e.gender)||(null===(n=this.userInfo)||void 0===n||null===(n=n.character_setting)||void 0===n?void 0:n.gender)||"");return L(L({},o),{},{tag:this.$route.params.tag,page:1,page_size:50,order_by:r,time_from:h,time_to:v})},filterSearch:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isTab;this.isLock=!1,this.isReq=!1,delete this.queryParam.offset;var e=this.setTabParams(t);this.queryParam.page=1,this.$set(this,"queryParam",e),this.list=[]},getReqParams:function(){var t=this,e=L(L({},w()(this.queryParam)),{},{order_by:this.tagIndex}),n=this.modelTypeSelect,r=this.baseModelSelect;if(["model","lora"].includes(this.activeName)){var l=r;r&&r.length>0&&(l=r.flatMap((function(e){var n;return[e].concat(Object(o.a)((null===(n=t.baseModelMap)||void 0===n?void 0:n[e])||[]))}))),e.base_models=l,e.model_types=n.map((function(t,e){return"LoRA"==t?"LORA":t}))}else"artwork"==this.activeName&&(e.order_by=this.tagIndex);var c={days:[E,F],week:[N,R],months:[U,V]};"All"===this.timeName?(delete e.time_from,delete e.time_to):(e.time_from=c[this.timeName][0],e.time_to=c[this.timeName][1]),delete e.time_from,delete e.time_to,e.sub_channel=e.sub_channel?[e.sub_channel]:[];return e.order_by="new"==this.tagIndex?"new":{days:"day_hot",week:"week_hot",months:"month_hot",All:"hot"}[this.timeName],e.tag_ids=[this.$route.params.tag],e.offset=e.offset?e.offset.toString():"",e},getHref:function(t){var e=this.$route.params.tag,n="artwork"===t.value?"":"/".concat(t.value),path="/tagInfo".concat(n,"/").concat(e);return this.localePath(path)}}),head:function(){var t;if(null===(t=this.tagInfoDetail)||void 0===t||!t.id)return{};var e=this.tagInfoDetail||{},n=e.title,o=e.id,r=e.stat,l=r.num_of_artwork,c=r.num_of_model,d=r.num_of_ebook,h=void 0===d?0:d,v=(e.related_tags||[]).map((function(t){return t.title})),f=this.$route,m=f.name,_=f.params,y=(m=m.split("___")[0]).includes("TagDetail")?(null==_?void 0:_.type)||"artwork":m,w=S.D.find((function(t){return t.name.includes(y)}))||{},title=w.title,desc=w.desc;title=this.$t(title,{name:n});var C=this.$t(desc,{name:n,wNum:"ai-novel"===y?h:l,mNum:c,link:v.toString()});return{title:title,meta:[{hid:"description",name:"description",content:C},{hid:"keywords",name:"keywords",content:n},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:C}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:this.$t("Home"),item:"https://www.seaart.ai"},{"@type":"ListItem",position:2,name:this.$t("AI_Explore"),item:"https://www.seaart.ai"+"/".concat(o,"?id=").concat(o)}]}}],__dangerouslyDisableSanitizers:["script"]}}},H=W,G=(n(4850),n(0)),component=Object(G.a)(H,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{ref:"tagdetail",staticClass:"tagdetail"},[r.$route.query.isBack?r._e():l("div",{staticClass:"backIcon",on:{click:function(t){return t.stopPropagation(),r.backTo.apply(null,arguments)}}},[l("i",{staticClass:"el-icon-back"})]),r._v(" "),l("el-backtop",{attrs:{bottom:30,right:30}},[l("i",{staticClass:"el-icon-top"})]),r._v(" "),l("div",{staticClass:"head"},[l("div",{staticClass:"head-bg"},[r.setTaginfo.style&&r.setTaginfo.style.url?l("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],attrs:{src:r.setTaginfo.style.url}}):r._e()]),r._v(" "),l("div",{staticClass:"head-info"},[l("div",{staticClass:"user"},[l("div",{staticClass:"flex"},[r.setTaginfo.style&&r.setTaginfo.style.url?l("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],attrs:{src:r.setTaginfo.style.url,alt:r.setTaginfo.name}}):r._e(),r._v(" "),l("div",{staticClass:"name-box"},[l("h1",[r._v(r._s(r.$t(r.setTaginfo.name)))]),r._v(" "),l("div",{staticClass:"work-num-show-box"},[l("div",{staticClass:"work-num-show-box-item"},[l("span",{staticClass:"work-num-show-box-item-num"},[r._v(r._s(r._f("thousandsSeparator")(r.statTotal)))]),r._v(" "),l("span",{staticClass:"work-num-show-box-item-text"},[r._v(r._s(r.$t("RelatedContent")))])])])])]),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:r.tagInfoDetail,expression:"tagInfoDetail"}],staticClass:"collect-box-2",on:{click:r.handleCollect}},[l("i",{staticClass:"iconfont collect-box-icon",class:r.collectIconClass}),r._v(" "),l("span",{staticClass:"collect-box-text"},[r._v(r._s(r.collectText))])])])])]),r._v(" "),r.renderList&&r.renderList.length>0?l("div",{staticClass:"taglist"},[l("tag-list",{attrs:{active:r.$route.query.id,"use-new-tag":!0,"render-list":r.renderList,clickType:!1},on:{changeTags:r.changeTags}})],1):r._e(),r._v(" "),l("div",{staticClass:"funBar"},[l("div",{staticClass:"funType"},r._l(r.typeList,(function(t,e){return l("a",{key:e,staticClass:"typeItem",class:{typeActivate:r.activeName==t.value},attrs:{"data-num":r._f("formatNumber")(t.num),href:r.getHref(t),"data-id":t.value},on:{click:function(e){return e.preventDefault(),r.checkType(t)}}},[r._v("\n        "+r._s(r.$t(t.name))+"\n      ")])})),0),r._v(" "),l("div",{staticClass:"Screening"},["post"==r.activeName?l("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[l("div",{staticClass:"filter-content"},[l("div",{staticClass:"title"},[r._v(r._s(r.$t("Type")))]),r._v(" "),l("div",{staticClass:"filter"},r._l(r.typeArr,(function(t){var e,n;return l("div",{key:t.value,staticClass:"item-filter",class:{active:(null===(e=r.queryParam)||void 0===e?void 0:e.sub_channel)==t.value},on:{click:function(e){return r.handleFilter(t.value)}}},[(null===(n=r.queryParam)||void 0===n?void 0:n.sub_channel)==t.value?l("i",{staticClass:"el-icon-check"}):r._e(),r._v("\n              "+r._s(r.$t(t.key))+"\n            ")])})),0),r._v(" "),l("div",{staticClass:"filter-reset",on:{click:r.filterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])]),r._v(" "),l("div",{staticClass:"filter-box",attrs:{slot:"reference"},slot:"reference"},[l("div",[l("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),l("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})])]):r._e(),r._v(" "),l("el-popover",{directives:[{name:"show",rawName:"v-show",value:"model"==r.activeName||"lora"==r.activeName,expression:"activeName == 'model' || activeName == 'lora'"}],attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[l("div",{staticClass:"filterCnt"},["model"==r.activeName?l("div",[r.lang.includes("zh")?l("div",{staticClass:"filterTit"},[r._v("\n              "+r._s(r.$t("Model")+r.$t("Type"))+"\n            ")]):l("div",{staticClass:"filterTit"},[r._v(r._s(r.$t("Model")+" "+r.$t("Type")))]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.modelTypes,(function(t,e){return l("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.modelTypeSelect.includes(t)},on:{click:function(e){return r.onFilter(t,1)}}},[r.modelTypeSelect.includes(t)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s("TextualInversion"===t?r.$t("embedding1"):t))])])})),0)]):r._e(),r._v(" "),l("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[r._v(r._s(r.$t("BaseModel")))]),r._v(" "),l("div",{staticClass:"filterList"},r._l(r.baseModels,(function(t,e){return l("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.baseModelSelect.includes(t)},on:{click:function(e){return r.onFilter(t,2)}}},[r.baseModelSelect.includes(t)?l("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),l("span",[r._v(r._s(t))])])})),0),r._v(" "),l("div",{staticClass:"filterReset graBorder",on:{click:r.onFilterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])]),r._v(" "),l("el-badge",{staticClass:"item",attrs:{slot:"reference",value:(null===(t=r.modelTypeSelect)||void 0===t?void 0:t.length)+(null===(e=r.baseModelSelect)||void 0===e?void 0:e.length),hidden:(null===(n=r.modelTypeSelect)||void 0===n?void 0:n.length)+(null===(o=r.baseModelSelect)||void 0===o?void 0:o.length)==0},slot:"reference"},[l("div",{staticClass:"filterBox"},[l("div",[l("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),l("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})])])],1),r._v(" "),l("el-popover",{directives:[{name:"show",rawName:"v-show",value:"workflow"==r.activeName,expression:"activeName == 'workflow'"}],attrs:{placement:"bottom","popper-class":"comfyFilter",trigger:"click"},model:{value:r.filterShow,callback:function(t){r.filterShow=t},expression:"filterShow"}},[l("div",{staticClass:"filterCnt"},[l("el-checkbox",{on:{change:r.intList},model:{value:r.checkRun,callback:function(t){r.checkRun=t},expression:"checkRun"}},[r._v(r._s(r.$t("comfyFilter1")))]),r._v(" "),l("div",{staticClass:"filterTit"},[r._v(r._s(r.$t("comfyFilter3")))]),r._v(" "),l("el-select",{staticClass:"filterSelect",attrs:{"popper-class":"custom-select comfyFilter",filterable:"",remote:"",multiple:"",placeholder:r.$t("Pls_select"),"popper-append-to-body":!1,"remote-method":r.remoteMethod,loading:r.fliterLoading},on:{change:r.nodeListChange},model:{value:r.queryParam.nodes_type,callback:function(t){r.$set(r.queryParam,"nodes_type",t)},expression:"queryParam.nodes_type"}},r._l(r.nodeList,(function(t){return l("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1),r._v(" "),l("div",{staticClass:"filterReset graBorder",on:{click:r.onWorkfolwFilterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])],1),r._v(" "),l("div",{staticClass:"filterBox",attrs:{slot:"reference"},slot:"reference"},[l("div",[l("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),l("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})])]),r._v(" "),r.isShowGenderFilter?l("GenderSelect",{on:{onChangeGender:r.changeGender}}):r._e(),r._v(" "),l("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:!r.hideTimeTypeOption,expression:"!hideTimeTypeOption"}],attrs:{trigger:"hover"},on:{command:r.handleTimeCommand}},[l("div",{staticClass:"el-dropdown-link selectTime"},[l("div",[l("i",{staticClass:"el-icon-time"}),r._v(" "),l("span",[r._v(r._s(r.$t(r.timeName)))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.timeTypeOption,(function(t,e){return l("el-dropdown-item",{key:e,attrs:{command:t}},[l("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[l("span",[r._v(r._s(r.$t(t.name)))])])])})),1)],1),r._v(" "),l("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleCommand}},[l("div",{staticClass:"el-dropdown-link"},[l("div",[l("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(r.setIcon())}),r._v(" "),l("span",[r._v(r._s(r.$t(r.tagIndex.charAt(0).toUpperCase()+r.tagIndex.slice(1))))])]),r._v(" "),l("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),l("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.renderTypeOption,(function(t,e){return l("el-dropdown-item",{key:e,attrs:{command:t.id}},[l("div",{staticClass:"el-dropdown-item"},[l("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),r._v(" "),l("span",[r._v(r._s(r.$t(t.name)))])])])})),1)],1)],1)]),r._v(" "),l("div",{ref:"wraper",staticClass:"ai-novel-list"},[l("HyWaterfallFlowList",{attrs:{list:r.list,isNovel:"ai-novel"===r.activeName,container:"wraper",fixedRatios:"artwork"!==r.activeName&&[260,346],waterAllListFn:function(){return r.list}},on:{load:function(t){return r.getList(!0)}}})],1),r._v(" "),l("my-tags",{model:{value:r.dialogVisible,callback:function(t){r.dialogVisible=t},expression:"dialogVisible"}})],1)}),[],!1,null,"4f558684",null);e.a=component.exports;installComponents(component,{TagList:n(379).default})},912:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8);var o=n(2),r=(n(49),n(4),n(7),n(1)),l=n(35),c=n.n(l),d=n(27);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={props:{value:{type:Boolean,default:!1}},computed:v(v({},Object(r.c)("user",["userInfo"])),{},{dialogVisible:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},setList:function(){return(c()(this.userInfo.tags)||[]).reverse()}}),data:function(){return{delLoading:!1}},methods:v(v({},Object(r.d)("user",["SET_ACCOUNT_DATA"])),{},{onClose:function(){this.$emit("close")},delTags:function(t){var e=this;if(!this.delLoading){this.delLoading=!0;var n={id:t.id,name:t.name};Object(d.Kb)({tags:[n]}).then((function(n){if(1e4==n.status.code){var o=c()(e.userInfo);o.tags.forEach((function(e,n){e.id==t.id&&o.tags.splice(n,1)})),e.SET_ACCOUNT_DATA(o)}e.delLoading=!1})).catch((function(t){e.delLoading=!1}))}}})},m=(n(4846),n(0)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("FavoriteTag"),visible:t.dialogVisible,top:"30vh",width:"508px","custom-class":"SaDialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.onClose}},[e("div",{staticClass:"main"},[e("ul",{ref:"list",staticClass:"list"},t._l(t.setList,(function(n,o){return e("li",{key:o},[e("span",[t._v(t._s(t.$t(n.name)))]),t._v(" "),e("i",{staticClass:"el-icon-delete-solid",on:{click:function(e){return t.delTags(n)}}})])})),0)])])}),[],!1,null,"57025b31",null);e.a=component.exports},913:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(7);var o=n(2),r=(n(22),n(4),n(26),n(36),n(63)),l=n(1),c=n(45),d=n(10),h=n(139);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var f={name:"recommendModelList",mixins:[c.a],components:{CollectPopover:r.default},props:{type:{type:String,default:"Checkpoint"},list:{type:Array,default:function(){return[]}},tag:{type:String,default:function(){return""}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["isLoggedIn","accountSettingsData"])),data:function(){return{replaceImageType:d.K,iconLoad:!1,modelList:[],isReq:!1,itemShow:!1,itemShowId:"",queryParam:{page:2,page_size:7,offset:0,tags:[],order_by:"new",model_type:"-"}}},watch:{list:{handler:function(t){this.modelList=t}}},created:function(){},methods:{goMore:function(t){this.$logEvent("log_actions",{operation:{LORA:" click_recommend_style_change",Checkpoint:"click_recommend_model_change"}[t]}),window.open("/explore?modelType=Checkpoint}&tag=".concat(this.$route.query.id),"_blank")},handleClick:function(t){var e=Object.assign({},t);this.$EventBus.$emit("openGenerate",{action:1,data:{source:e}})},goModel:function(t,e){"IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"modelName"!==t.target.className||window.open("/models/detail/"+(null==e?void 0:e.id),"_blank")},goUserPage:function(t){var e;window.open("/user/"+(null==t||null===(e=t.author)||void 0===e?void 0:e.id),"_blank")},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id},setIconLoad:function(){var t=this;this.iconLoad=!0,setTimeout((function(){t.iconLoad=!1}),500)},onChange:function(){this.setIconLoad(),this.getList()},getList:function(){var t=this;this.isReq||(this.isReq=!0,this.modelList=[],this.queryParam.tags=[this.$route.query.id||""],Object(h.g)(this.queryParam).then((function(e){1e4===e.status.code&&(t.queryParam.page++,e.data.has_more||(t.queryParam.page=1),t.modelList=(e.data.items||[]).map((function(t){try{t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height}catch(t){}return t})),1===t.queryParam.page&&(t.queryParam.offset=e.data.offset))})).finally((function(){t.isReq=!1})))}}},m=f,_=(n(4849),n(0)),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("div",{ref:"rmdModelList",staticClass:"rmdModelList"},[e("div",{staticClass:"title"},[e("div",{staticClass:"titleLeft",on:{click:function(e){return t.goMore(t.type)}}},[e("span",[t._v(t._s("Checkpoint"==t.type?t.$t("RmdModel"):t.$t("RmdLora")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("div",{staticClass:"changeit",on:{click:t.onChange}},[e("i",{staticClass:"iconfont icon-changeit",class:{iconLoad:t.iconLoad}}),t._v(" "),e("span",[t._v(t._s(t.$t("changeit")))])])]),t._v(" "),e("div",{staticClass:"list"},t._l(t.modelList,(function(n,o){var r,l,c,d,h,v,f,m;return e("a",{key:o,staticClass:"itme",attrs:{href:"/models/detail/"+(null==n?void 0:n.id)}},[e("div",{on:{click:function(e){return e.preventDefault(),t.goModel(e,n)}}},[e("div",{staticClass:"imgs",class:1===(null==n||null===(r=n.banner)||void 0===r?void 0:r.nsfw)?"bg-nsfw":""},[null!=n&&null!==(l=n.banner)&&void 0!==l&&l.url&&2===(null==n||null===(c=n.banner)||void 0===c?void 0:c.nsfw)?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null==n||null===(d=n.banner)||void 0===d?void 0:d.url,alt:""}}):e("div",{staticClass:"defTxt"},[t._v(t._s(t.$t("EmptyBannerText")))]),t._v(" "),t.isLoggedIn?e("div",{staticClass:"cltpop",style:{opacity:t.itemShow&&t.itemShowId==n.id?1:0}},[e("CollectPopover",{attrs:{type:"model",folder:n},on:{click:function(t){t.stopPropagation()},showChaneg:t.changeItemShow}})],1):t._e(),t._v(" "),t.isLoggedIn?e("div",{staticClass:"waterfall-hover-try",on:{click:function(e){return e.preventDefault(),t.handleClick(n)}}},[t._v(t._s(t.$t("Try")))]):t._e(),t._v(" "),t.isLoggedIn?e("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],class:t.setCollectData(n),on:{click:function(e){return e.preventDefault(),t.setCollect(n,"model")}}}):t._e()]),t._v(" "),e("div",{staticClass:"modelName"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"user",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goUserPage(n)}}},[e("div",{staticClass:"userImg"},[null!=n&&null!==(h=n.author)&&void 0!==h&&h.head?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null==n||null===(v=n.author)||void 0===v?void 0:v.head,alt:""}}):e("div",{staticClass:"defHead"},[t._v(t._s(null==n||null===(f=n.author)||void 0===f?void 0:f.name[0]))])]),t._v(" "),e("div",{staticClass:"userName"},[t._v(t._s(null==n||null===(m=n.author)||void 0===m?void 0:m.name))])])])])})),0)])}),[],!1,null,"988a3a94",null);e.a=component.exports;installComponents(component,{CollectPopover:n(63).default})},921:function(t,e,n){"use strict";n(6),n(4),n(11),n(12),n(13),n(8);var o=n(2),r=(n(19),n(24),n(7),n(25)),l=n(36),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var h={name:"pickWorkModal",components:{WaterFallVue:n(854).default},props:{maxNum:{type:Number,default:1},type:{type:String,default:"default"}},data:function(){return{visible:!1,loading:!1,list:[],noMore:!1,queryParam:{keyword:"",page:1,page_size:60,time_to:0,after:0},debounceHandleScroll:null,scrollTop:0,selectList:[],debounceHandleSearch:null,checkType:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.e)("user",["userInfo"])),mounted:function(){this.debounceHandleScroll=Object(r.debounce)(this.handleScroll,200),this.debounceHandleSearch=Object(r.debounce)(this.handleSearch,600)},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceHandleSearch=null},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.resetData(),this.getList(),this.selectList=t||[],this.checkType=e||"",this.visible=!0},handleClose:function(){this.visible=!1},resetData:function(){this.list=[],this.loading=!1,this.queryParam={keyword:"",page:1,page_size:60,time_to:0,after:0},this.scrollTop=0,this.noMore=!1,this.selectList=[],this.checkType=""},handleCancel:function(){this.visible=!1},handleSearch:function(){this.loading=!1,this.queryParam.page=1,this.noMore=!1,this.queryParam.time_to=0,this.queryParam.after=0,this.scrollTop=0,this.list=[],this.getList()},handleScroll:function(){var t=this.$refs.handleWorkScroll;this.scrollTop=t.scrollTop||0;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-50&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n=l.artworkList;this.queryParam.order_by="new",this.queryParam.artwork_types=[1,3],"animGen"===this.type&&(this.queryParam.artwork_types=[1]),"workFlowAppDetail"===this.type&&(this.queryParam.artwork_types=[1,3,4]),this.queryParam.type="bookmarks",this.queryParam.category=2;var o=this.queryParam;return new Promise((function(r,l){n(o).then((function(n){if(1e4===n.status.code){e.noMore=!n.data.has_more,e.list=t?e.list.concat(n.data.items||[]):n.data.items||[],1===o.page&&n.data.time_ms&&(o.time_to=n.data.time_ms);try{var l;if(n.data.items.length>0)e.queryParam.after=null===(l=n.data.items[n.data.items.length-1])||void 0===l||null===(l=l.folder_no)||void 0===l?void 0:l.collect_at}catch(t){}o.page++,r()}})).catch((function(t){l(t)})).finally((function(){e.loading=!1}))}))}},getCheckList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectList=[],(e.url||[]).forEach((function(n,o){t.selectList.push({url:n,id:(null==e?void 0:e.ids[o])||"",type:"check",info:null==e?void 0:e.info[o]})}))},handleConfirm:function(){if(this.selectList.length){var t=0,e=0;try{t=this.selectList[0].info.banner.width,e=this.selectList[0].info.banner.height}catch(t){}var n={background:1024,character:768}[this.checkType]||0;if(n&&[t,e].some((function(t){return t<n})))return this.$message.warning(this.$t("tavern38",{number:n})),!1;this.$emit("confirm",{url:this.selectList[0].url,type:this.checkType,width:t,height:e,urls:this.selectList}),this.handleClose()}else this.$message.warning(this.$t("selectOneWork"))}}},v=h,f=(n(5029),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return t.visible?e("el-dialog",{attrs:{visible:t.visible,"custom-class":"c-pick-work-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":"",center:""},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"pick-work-modal-header"},[e("div",{staticClass:"pick-work-modal-header-item"},[e("span",{staticClass:"header-item-text"},[t._v(t._s(t.$t("personalFeed")))]),t._v(" "),e("span",{staticClass:"el-icon-info header-item-text-tip"}),t._v(" "),e("span",{staticClass:"header-item-desc-text"},[t._v(t._s(t.$t("modelWorkDesc")))]),t._v(" "),e("span",{staticClass:"header-item-desc-text",staticStyle:{"margin-left":"8px"}},[t._v("("+t._s(t.selectList.length)+"/"+t._s(t.maxNum)+")")])]),t._v(" "),e("div",{staticClass:"pick-work-modal-header-item"},[e("div",{staticClass:"header-item-btn",on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("Done"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"pick-work-modal-body"},[e("div",{staticClass:"search-box"},[e("el-input",{staticClass:"search-box__search-input",attrs:{placeholder:t.$t("Search"),clearable:""},on:{change:t.debounceHandleSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.debounceHandleSearch.apply(null,arguments)}},model:{value:t.queryParam.keyword,callback:function(e){t.$set(t.queryParam,"keyword",e)},expression:"queryParam.keyword"}},[e("template",{slot:"suffix"},[e("i",{staticClass:"iconfont icon-search search-icon",on:{click:t.handleSearch}})])],2)],1),t._v(" "),e("div",{ref:"handleWorkScroll",staticClass:"handle-work-scroll-list",on:{scroll:t.debounceHandleScroll}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"wraper",staticClass:"wraper"},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{type:"artwork",cols:5,container:"wraper",list:"animGen"==t.type?t.list.filter((function(t){return"sdxl"!=t.channel&&"studio"!=t.channel&&6!=t.type})):t.list,lazy:!0,dislikeShow:!0,isCheck:!0,checkMax:t.maxNum,alreadyNoMoreData:t.noMore,scrollContainerClassName:"handle-work-scroll-list",scrollContentTop:t.scrollTop,selectList:t.selectList},on:{load:function(e){return t.getList(!0)},getChecList:t.getCheckList}})],1)])])]):t._e()}),[],!1,null,null,null);e.a=component.exports},923:function(t,e,n){"use strict";n(16),n(21),n(50),n(49),n(24),n(4),n(7);var o=n(9),r=n(71),l={name:"tagList",props:{iconBntWidth:{type:Number,default:36},moveLeng:{type:Number,default:400}},data:function(){return{list:[],selectList:[],isShowLeft:!1,isShowRight:!0,savedScrollLeft:0}},mounted:function(){var t=this;this.selectList=[],this.getList(),window.addEventListener("resize",this.setMoveBtnShow),this.$refs.scrollArea.addEventListener("scroll",this.setMoveBtnShow),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollArea.removeEventListener("scroll",t.setMoveBtnShow),window.removeEventListener("resize",t.setMoveBtnShow)}))},beforeDestroy:function(){this.loading=!1},updated:function(){var t=this;this.$nextTick((function(){t.setMoveBtnShow()}))},methods:{getList:function(){var t=this;this.loading=!0,Object(r.d)({show_area:"cyber_bar"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){e.title=e[o.r[t.$i18n.locale]]})),t.list=n})).finally((function(){t.loading=!1}))},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.loading&&(this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_tags",behavior_info_sub:t}),(this.list||[]).some((function(e){return e.id===t.id})))){var e=this.selectList.findIndex((function(e){return e===t.id}));if(-1!==e)this.selectList.splice(e,1);else{if(this.selectList.length>=10)return;this.selectList.push(t.id)}this.$emit("selectList",this.selectList)}},clearSelect:function(){this.selectList=[],this.$emit("selectList",this.selectList)},setMoveBtnShow:function(){var t,e,n=this.$refs.scrollArea||{};n<=(null===(t=this.$refs.tags)||void 0===t?void 0:t.offsetWidth)&&(this.isShowRight=!1),0===n.scrollLeft?this.isShowLeft=!1:this.isShowLeft=!0,Math.ceil(n.scrollLeft)+n.clientWidth>=n.scrollWidth?this.isShowRight=!1:this.isShowRight=!0,this.savedScrollLeft=null===(e=this.$refs.scrollArea)||void 0===e?void 0:e.scrollLeft},tagsMove:function(t){this.$refs.scrollArea.scrollBy({left:t,behavior:"smooth"}),this.setMoveBtnShow()}}},c=l,d=(n(5128),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{ref:"tags",staticClass:"c-tavern-tag-list"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowLeft,expression:"isShowLeft"}],staticClass:"swipeab-icon-box swipeab-icon-box-left",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove("-"+t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-left"})])]),t._v(" "),e("div",{ref:"scrollArea",staticClass:"scroll-area"},[e("div",{staticClass:"scroll-area-list"},[e("div",{key:"tavern_tag_",staticClass:"tavern-tag-item",class:[t.selectList.length?"":"tavern-tag-item-active"],on:{click:function(e){return e.stopPropagation(),t.clearSelect.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("tavern3"))+"\n      ")]),t._v(" "),t._l(t.list,(function(n){return e("div",{key:"tavern_tag_".concat(n.id),staticClass:"tavern-tag-item",class:[(t.selectList||[]).includes(n.id)?"tavern-tag-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleSelect(n)}}},[t._v("\n        "+t._s(n.title||n.id)+"\n      ")])}))],2)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowRight,expression:"isShowRight"}],staticClass:"swipeab-icon-box swipeab-icon-box-right",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove(t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"87ddf2dc",null);e.a=component.exports},924:function(t,e,n){"use strict";n(18),n(11),n(6),n(12),n(13),n(8),n(4),n(7);var o=n(2),r=n(10),l=n(257),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"roleCardItem",components:{AiChatReport:l.a},props:{isDel:{type:Boolean,default:!1},cardInfo:{type:Object,default:function(){return{}}},showShareBtn:{type:Boolean,default:!0}},computed:h(h({},Object(c.e)("user",["token"])),{},{isLoggedIn:function(){return this.token}}),data:function(){return{formatNumberForeign:r.p,replaceImageType:r.K,vipIconUrl:n(136),defaultImageUrl:"https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp"}},methods:{handleClickToDetails:function(){var t;this.$router.push(this.localePath("/cyberPubPage/".concat(null===(t=this.cardInfo)||void 0===t?void 0:t.id)))},otherUser:function(t){var e,n,path="/user/"+encodeURIComponent(t.author.id);(null===(e=this.userInfo)||void 0===e?void 0:e.id)==(null===(n=t.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},goCreatedSame:function(t){if(t){var e=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));this.isLoggedIn?this.$router.push(e):this.$EventBus.$emit("openLoginDialog",{redirect:e})}},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),window.open("".concat(location.origin,"/mall"),"_blank")},delCard:function(){this.$emit("delete",this.cardInfo)},goChat:function(){var t;this.$router.push(this.localePath("/aiChat/".concat(null===(t=this.cardInfo)||void 0===t?void 0:t.id)))},queryByTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("queryByTag",t.id)},moreActions:function(){if("report"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""))try{this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_report"}),this.$refs.AiChatReport.open()}catch(t){}},handleShare:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_share"});var t=location.origin;Object(r.g)(t+"/cyberPubPage/".concat(this.cardInfo.id)),this.$message.success(this.$t("CopiedURLToClipboard"))}}},f=v,m=(n(5131),n(0)),component=Object(m.a)(f,(function(){var t,e,n,o,r,l,c,d,h,v,f,m,_,y,w,C=this,k=C._self._c;return k("div",{staticClass:"c-role-card-item",on:{click:function(t){return t.stopPropagation(),C.goChat.apply(null,arguments)}}},[k("a",{attrs:{href:C.localePath("/cyberPubPage/".concat(null===(t=C.cardInfo)||void 0===t?void 0:t.id))}}),C._v(" "),k("div",{staticClass:"role-card-item-cover"},[k("div",{staticClass:"role-card-item-cover-image-box"},[k("el-image",{staticClass:"item-cover-img",attrs:{src:null!==(e=C.cardInfo)&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.url?C.replaceImageType(null===(n=C.cardInfo)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url,"low"):C.defaultImageUrl,lazy:""}},[k("template",{slot:"error"},[k("img",{staticClass:"item-cover-img",attrs:{src:null===(o=C.cardInfo)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.url,alt:""}})])],2),C._v(" "),k("img",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{src:C.replaceImageType(null===(r=C.cardInfo)||void 0===r||null===(r=r.cover)||void 0===r?void 0:r.url,"low"),alt:C.cardInfo.name}}),C._v(" "),k("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"msg-item-more-popover","visible-arrow":!1,width:"120",trigger:"hover"}},[k("div",{staticClass:"pop-btns flex"},[k("button",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),C.moreActions("report")}}},[k("span",{staticClass:"pop-btns-text"},[C._v(C._s(C.$t("Report")))]),C._v(" "),k("span",{staticClass:"pop-btns-icon"},[k("i",{staticClass:"iconfont icon-task-report-icon"})])])]),C._v(" "),k("div",{staticClass:"item-cover-operate",attrs:{slot:"reference"},slot:"reference"},[k("i",{staticClass:"iconfont icon-more"})])])],1)]),C._v(" "),k("div",{staticClass:"role-card-item-content"},[k("div",{staticClass:"card-info"},[k("div",{staticClass:"role-card-item-content-title"},[1===(null===(l=C.cardInfo)||void 0===l?void 0:l.allow_same)?[k("span",{staticClass:"item-content-title-text item-content-title-text-same",attrs:{title:null===(c=C.cardInfo)||void 0===c?void 0:c.name},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),C.handleClickToDetails.apply(null,arguments)}}},[C._v("\n            "+C._s(null===(d=C.cardInfo)||void 0===d?void 0:d.name)+"\n          ")]),C._v(" "),k("div",{staticClass:"same-style",on:{click:function(t){var e;return t.stopPropagation(),t.preventDefault(),C.goCreatedSame(null===(e=C.cardInfo)||void 0===e?void 0:e.id)}}},[C._v(C._s(C.$t("Remix")))])]:k("span",{staticClass:"item-content-title-text",attrs:{title:null===(h=C.cardInfo)||void 0===h?void 0:h.name},on:{click:function(t){return t.stopPropagation(),C.handleClickToDetails.apply(null,arguments)}}},[C._v("\n          "+C._s(null===(v=C.cardInfo)||void 0===v?void 0:v.name)+"\n        ")])],2),C._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[k("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[C._v(C._s(null===(f=C.cardInfo)||void 0===f?void 0:f.evaluation))]),C._v(" "),k("div",{staticClass:"role-card-item-content-subtitle"},[C._v("\n          "+C._s(null===(m=C.cardInfo)||void 0===m?void 0:m.evaluation)+"\n        ")])])],1),C._v(" "),k("div",{staticClass:"item-info"},[k("div",{staticClass:"item-content-tags"},C._l(C.cardInfo.categories,(function(t){return k("span",{key:t.id,staticClass:"item-content-tags-item",on:{click:function(e){return e.stopPropagation(),C.queryByTag(t)}}},[C._v(C._s(t.name))])})),0),C._v(" "),k("div",{staticClass:"item-content-bottom"},[k("div",{staticClass:"author-name ellipsis",attrs:{title:"by "+(null===(_=C.cardInfo)||void 0===_||null===(_=_.author)||void 0===_?void 0:_.name)},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),C.otherUser(C.cardInfo)}}},[C._v("\n          by "+C._s(null===(y=C.cardInfo)||void 0===y||null===(y=y.author)||void 0===y?void 0:y.name)+"\n        ")]),C._v(" "),k("div",{staticClass:"operate-btn-box"},[k("div",{staticClass:"operate-btn-item"},[k("i",{staticClass:"iconfont icon-comment operate-btn-item-icon"}),C._v(" "),k("span",{staticClass:"operate-btn-item-text"},[C._v(C._s(C.formatNumberForeign((null===(w=C.cardInfo)||void 0===w||null===(w=w.stat)||void 0===w?void 0:w.num_of_token)||0)))])]),C._v(" "),C.showShareBtn?k("div",{staticClass:"operate-btn-item",on:{click:function(t){return t.stopPropagation(),C.handleShare.apply(null,arguments)}}},[k("span",{staticClass:"iconfont icon-icon_share operate-btn-item-icon"}),C._v(" "),k("span",{staticClass:"operate-btn-item-text"},[C._v(C._s(C.$t("Share")))])]):C._e()])])]),C._v(" "),k("ai-chat-report",{ref:"AiChatReport",attrs:{"ai-chat-id":C.cardInfo.id}})],1),C._v(" "),k("i",{directives:[{name:"show",rawName:"v-show",value:C.isDel,expression:"isDel"}],staticClass:"el-icon-close close-btn",on:{click:function(t){return t.stopPropagation(),C.delCard.apply(null,arguments)}}})])}),[],!1,null,"4e079a07",null);e.a=component.exports},926:function(t,e,n){"use strict";n(736),n(47);var o=n(455),r={name:"FooterDisplay",components:{ElDivider:n.n(o).a},data:function(){return{}},mounted:function(){},methods:{}},l=(n(5526),n(0)),component=Object(l.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer dot-group flex flex-col"},[e("div",{staticClass:"bottom-line"},[e("div",[t._v("© 2025 SeaArt, Inc.")]),t._v(" "),e("div",{staticClass:"terms flex items-center"},[t._m(0),t._v(" "),e("el-divider",{staticStyle:{background:"#7d7d78"},attrs:{direction:"vertical"}}),t._v(" "),t._m(1),t._v(" "),e("el-divider",{staticStyle:{background:"#7d7d78"},attrs:{direction:"vertical"}}),t._v(" "),t._m(2)],1)])])}),[function(){var t=this._self._c;return t("span",[t("a",{attrs:{target:"_blank",href:"https://image.cdn2.seaart.ai/static/DMCA0305.html",rel:"nofollow"}},[this._v("Copyright Policy")])])},function(){var t=this._self._c;return t("span",[t("a",{attrs:{target:"_blank",href:"https://image.cdn2.seaart.ai/static/terms.html",rel:"nofollow"}},[this._v("Terms")])])},function(){var t=this._self._c;return t("span",[t("a",{attrs:{target:"_blank",rel:"nofollow",href:"https://image.cdn2.seaart.ai/static/privacy.html"}},[this._v("Privacy")])])}],!1,null,"2b8fac94",null);e.a=component.exports},939:function(t,e,n){"use strict";n(24);var o={name:"EnergyInfo",props:{energyValue:{type:String,required:!0},periodDisplay:{type:String,required:!0},progressPercentage:{type:Number,required:!0},imageNum:{type:String,required:!0},videoNum:{type:String,required:!0},showGenerationInfoInline:{type:Boolean,default:!1}}},r=(n(5634),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"energy-section"},[e("div",{staticClass:"energy-info",class:{"inline-layout":t.showGenerationInfoInline}},[e("div",{staticClass:"energy-left"},[e("img",{staticClass:"energy-icon",attrs:{loading:"lazy",src:n(160),alt:"energy",width:"24",height:"24"}}),t._v(" "),e("span",{staticClass:"energy-text"},[t._v("\n        +"+t._s(t.energyValue)+" "+t._s(t.$t("tempCoins"))+"\n        "),e("span",{staticClass:"light-text"},[t._v("/"+t._s(t.periodDisplay))])])]),t._v(" "),t.showGenerationInfoInline?e("div",{staticClass:"generation-info-inline"},[e("span",{domProps:{innerHTML:t._s(t.$t("mediaGenerationInfo",{imageNum:t.imageNum,videoNum:t.videoNum}))}})]):t._e()]),t._v(" "),e("div",{staticClass:"energy-progress"},[e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-fill",style:{width:"".concat(t.progressPercentage,"%")}})])]),t._v(" "),t.showGenerationInfoInline?t._e():e("div",{staticClass:"media-generation-info"},[e("span",{domProps:{innerHTML:t._s(t.$t("mediaGenerationInfo",{imageNum:t.imageNum,videoNum:t.videoNum}))}})])])}),[],!1,null,"22432dff",null);e.a=component.exports},940:function(t,e,n){"use strict";var o={name:"FeatureItem",props:{text:{type:String,required:!0},enabled:{type:Boolean,default:!0},tip:{type:String,default:""}}},r=(n(5635),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"feature-item",class:{disabled:!t.enabled}},[e("span",{staticClass:"feature-icon"},[t.enabled?e("i",{staticClass:"icon el-icon-check"}):e("i",{staticClass:"icon el-icon-close"})]),t._v(" "),e("span",{staticClass:"feature-text"},[t._v(t._s(t.text))]),t._v(" "),t.tip?e("el-tooltip",{attrs:{placement:"top",width:"200"},scopedSlots:t._u([{key:"content",fn:function(){return[e("p",{staticClass:"feature-tip-content"},[t._v("\n        "+t._s(t.tip)+"\n      ")])]},proxy:!0}],null,!1,4074810757)},[e("i",{staticClass:"iconfont icon-zhuyi feature-tip"})]):t._e()],1)}),[],!1,null,"4702fb61",null);e.a=component.exports},943:function(t,e,n){"use strict";n(31),n(24);var o={name:"ImageActionButtons",props:{visible:{type:Boolean,default:!0},buttons:{type:Array,default:function(){return[]}},maxVisibleButtons:{type:Number,default:3},iconStyle:{type:String,default:""},gap:{type:Number,default:10},iconFontsize:{type:String,default:""}},computed:{visibleButtons:function(){return this.buttons.slice(0,this.maxVisibleButtons)},hiddenButtons:function(){return this.buttons.length>this.maxVisibleButtons?this.buttons.slice(this.maxVisibleButtons):[]}},methods:{handleButtonClick:function(t){this.$emit("button-click",t)}}},r=(n(4705),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"image-action-buttons",style:{gap:t.gap+"px"}},[t.visible?e("div",{staticClass:"image-action-buttons-tab"},[t._l(t.visibleButtons,(function(n,o){return[e("el-tooltip",{attrs:{content:t.$t(n.label),placement:"top","open-delay":200}},[e("div",{key:n.code,class:["action-button",t.iconStyle],on:{click:function(e){return e.stopPropagation(),t.handleButtonClick(n)}}},[e("i",{class:[n.icon,t.iconFontsize]})])])]})),t._v(" "),t.hiddenButtons.length>0?e("div",{class:["action-button","more-button",t.iconStyle]},[e("el-popover",{attrs:{trigger:"hover",placement:"bottom-end","popper-class":"image-hover-more-menu-popover"}},[e("div",{staticClass:"more-menu"},t._l(t.hiddenButtons,(function(n){return e("el-tooltip",{key:n.type,attrs:{content:t.$t(n.label)||"","open-delay":200,placement:"left",effect:"light",disabled:!n.label,"popper-class":"task-image-viewer-popover"}},[e("div",{staticClass:"menu-item",attrs:{"data-group":"create-task-image-viewer","data-type":"detail-edit-button","data-id":n.code,"data-event":n.code,"data-desc":"创作流图片详情顶部按钮组"},on:{click:function(e){return e.stopPropagation(),t.handleButtonClick(n)}}},[e("i",{class:n.icon}),t._v(" "),e("span",[t._v(t._s(t.$t(n.label)))])])])})),1),t._v(" "),e("i",{staticClass:"el-icon-more",attrs:{slot:"reference"},slot:"reference"})])],1):t._e()],2):t._e(),t._v(" "),t._t("default")],2):t._e()}),[],!1,null,"0f44a2a4",null);e.a=component.exports}}]);